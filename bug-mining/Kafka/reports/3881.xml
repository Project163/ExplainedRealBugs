<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 17:39:54 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-17146] ZK to KRAFT migration stuck in pre-migration mode</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-17146</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;I&apos;m facing a migration from Zookeeper to KRAFT with Kafka 3.7.1 cluster. (EDIT: the same issue happens for version 3.7.0)&lt;/p&gt;

&lt;p&gt;I&apos;m using this configuration to allow SSL everywhere and, SCRAM authentication only for brokers and PLAIN authentication for controllers&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
listener.security.protocol.map=EXTERNAL_SASL:SASL_SSL,CONTROLLER:SASL_SSL


inter.broker.listener.name=EXTERNAL_SASL
sasl.enabled.mechanisms=SCRAM-SHA-512,PLAIN
sasl.mechanism=SCRAM-SHA-512
sasl.mechanism.controller.protocol=PLAIN
sasl.mechanism.inter.broker.protocol=SCRAM-SHA-512 &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The cluster has 3 brokers and 3 zookeeper nodes initially then a controllers cluster with 3 KRAFT controllers is configured and running in parallel as per documentation for the migration process.&lt;br/&gt;
I&#8217;ve started the migration with 3 controllers enrolled with SASL_SSL with PLAIN authentication and I already have a strange TRACE log:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver) &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;With later this message where KRAFT is waiting to brokers to connect&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
INFO [KRaftMigrationDriver id=1000] No brokers are known to KRaft, waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; brokers to register. (org.apache.kafka.metadata.migration.KRaftMigrationDriver) &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;As soon I start to reconfigure the brokers letting them to connect to the new controllers, all good in the KRAFT controllers with notifications that the KRAFT brokers were connecting correctly connected and enrolled&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
INFO [QuorumController id=1000] Replayed initial RegisterBrokerRecord &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; broker 1: RegisterBrokerRecord(brokerId=1, isMigratingZkBroker=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;, incarnationId=xxxxxx, brokerEpoch=2638, endPoints=[BrokerEndpoint(name=&lt;span class=&quot;code-quote&quot;&gt;&apos;EXTERNAL_SASL&apos;&lt;/span&gt;, host=&lt;span class=&quot;code-quote&quot;&gt;&apos;vmk-tdtkafka-01&apos;&lt;/span&gt;, port=9095, securityProtocol=3)], features=[BrokerFeature(name=&lt;span class=&quot;code-quote&quot;&gt;&apos;metadata.version&apos;&lt;/span&gt;, minSupportedVersion=19, maxSupportedVersion=19)], rack=&lt;span class=&quot;code-quote&quot;&gt;&apos;zur1&apos;&lt;/span&gt;, fenced=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;, inControlledShutdown=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;, logDirs=[xxxxxx]) (org.apache.kafka.controller.ClusterControlManager)
[...]
INFO [KRaftMigrationDriver id=1000] Still waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; ZK brokers [2, 3] to register with KRaft. (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
INFO [KRaftMigrationDriver id=1000] Still waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; ZK brokers [2] to register with KRaft. (org.apache.kafka.metadata.migration.KRaftMigrationDriver) &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;As soon the first broker is connected we start to get these info logs related to the migration process in the controller:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
INFO [QuorumController id=1000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
INFO [QuorumController id=1000] maybeFenceReplicas: event failed with NotControllerException in 355 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;but as well requests to autocreate topics that exist already, in loop every 30seconds, in the last broker restarted:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
INFO Sent auto-creation request &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; Set(_schemas) to the active controller. (kafka.server.DefaultAutoTopicCreationManager)
INFO Sent auto-creation request &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; Set(_schemas) to the active controller. (kafka.server.DefaultAutoTopicCreationManager)
INFO Sent auto-creation request &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; Set(_schemas) to the active controller. (kafka.server.DefaultAutoTopicCreationManager) &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Up to the moment we have a controller still in the old cluster (in the kafka brokers) everything runs fine. As soon the last node is restarted the things are going out of the rail. This last node never gets any partition assigned and the cluster stays forever in with under replicated partitions. This is the log from the last node register that should start the migration mode, but the cluster stays forever in &lt;b&gt;SYNC_KRAFT_TO_ZK&lt;/b&gt; state in &lt;b&gt;pre-migration&lt;/b&gt; mode.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
INFO [QuorumController id=1000] The request from broker 2 to unfence has been granted because it has caught up with the offset of its register broker record 4101
[...]
INFO [KRaftMigrationDriver id=1000] Ignoring image MetadataProvenance(lastContainedOffset=4127, lastContainedEpoch=5, lastContainedLogTimeMs=1721133091831) which does not contain a superset of the metadata in ZK. Staying in SYNC_KRAFT_TO_ZK until a newer image is loaded (org.apache.kafka.metadata.migration.KRaftMigrationDriver) &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The only way to recover the cluster is revert everything stopping clusters, removing&#160;/controller&#160;from zookeeper and restore the Zookeeper only configuration in the brokers. A cleanup of the controller is necessary too.&lt;/p&gt;

&lt;p&gt;The migration never starts and the controllers never understand that they have to migrate the data from Zookeeper. More than that, the new controller claims to be the CONTROLLER but it refuses to be it.&lt;/p&gt;</description>
                <environment>Virtual machines isolated: 3 VMs with Kafka brokers + 3 Zookeeper/KRAFT</environment>
        <key id="13586018">KAFKA-17146</key>
            <summary>ZK to KRAFT migration stuck in pre-migration mode</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="saimon46">Simone Brundu</reporter>
                        <labels>
                            <label>kraft</label>
                            <label>migration</label>
                            <label>zookeeper</label>
                    </labels>
                <created>Tue, 16 Jul 2024 15:42:01 +0000</created>
                <updated>Wed, 25 Sep 2024 06:12:22 +0000</updated>
                                            <version>3.7.0</version>
                    <version>3.7.1</version>
                                                    <component>controller</component>
                    <component>kraft</component>
                    <component>migration</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                                                                                <comments>
                            <comment id="17869445" author="davidarthur" created="Mon, 29 Jul 2024 19:37:34 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=saimon46&quot; class=&quot;user-hover&quot; rel=&quot;saimon46&quot;&gt;saimon46&lt;/a&gt; thanks for the report.&lt;/p&gt;

&lt;p&gt;&amp;gt; More than that, the new controller claims to be the CONTROLLER but it refuses to be it.&lt;/p&gt;

&lt;p&gt;This is by design, but the active KRaft controller should not stay in this state indefinitely. The KRaft controller will claim the ZK active controller role by writing its node ID into the /controller ZNode. It will then perform the migration of the metadata. There is a period of time where the active KRaft controller will be returning NOT_CONTROLLER to RPCs (while the migration is happening).&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Can you provide the full log for the active KRaft controller? If it&apos;s too large, just messages from KRaftMigrationDriver should shed some light on the situation.&#160;&lt;/p&gt;</comment>
                            <comment id="17869559" author="JIRAUSER306228" created="Tue, 30 Jul 2024 07:55:11 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=davidarthur&quot; class=&quot;user-hover&quot; rel=&quot;davidarthur&quot;&gt;davidarthur&lt;/a&gt;, the controller ZNode is written by the KRAFT controller actually, and all the Kafka brokers see one of the KRAFT nodes as controller. In fact to revert that state I have to delete that Znode manually from zookeeper to let reelect the controller internally in the Kafka cluster.&lt;/p&gt;

&lt;p&gt;The migration of the metadata never starts tho, the KRAFT controller data folder size is always small and in the logs this is what I have. I&apos;ve compressed the several verbose logs like this with &lt;span class=&quot;error&quot;&gt;&amp;#91;...&amp;#93;&lt;/span&gt;:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Here you are the full logs history &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
[2024-07-15 12:24:15,263] INFO Registered kafka:type=kafka.Log4jController MBean (kafka.utils.Log4jControllerRegistration$)
[2024-07-15 12:24:15,482] INFO Setting -D jdk.tls.rejectClientInitiatedRenegotiation=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt; to disable client-initiated TLS renegotiation (org.apache.zookeeper.common.X509Util)
[2024-07-15 12:24:15,598] INFO Registered signal handlers &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; TERM, INT, HUP (org.apache.kafka.common.utils.LoggingSignalHandler)
[2024-07-15 12:24:15,601] INFO [ControllerServer id=3000] Starting controller (kafka.server.ControllerServer)
[2024-07-15 12:24:15,935] INFO Updated connection-accept-rate max connection creation rate to 2147483647 (kafka.network.ConnectionQuotas)
[2024-07-15 12:24:15,983] INFO Successfully logged in. (org.apache.kafka.common.security.authenticator.AbstractLogin)
[2024-07-15 12:24:15,985] INFO Successfully logged in. (org.apache.kafka.common.security.authenticator.AbstractLogin)
[2024-07-15 12:24:16,581] INFO [SocketServer listenerType=CONTROLLER, nodeId=3000] Created data-plane acceptor and processors &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; endpoint : ListenerName(CONTROLLER) (kafka.network.SocketServer)
[2024-07-15 12:24:16,589] INFO authorizerStart completed &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; endpoint CONTROLLER. Endpoint is now READY. (org.apache.kafka.server.network.EndpointReadyFutures)
[2024-07-15 12:24:16,589] INFO [SharedServer id=3000] Starting SharedServer (kafka.server.SharedServer)
[2024-07-15 12:24:16,642] INFO [LogLoader partition=__cluster_metadata-0, dir=/data/kafka_controller] Loading producer state till offset 0 with message format version 2 (kafka.log.UnifiedLog$)
[2024-07-15 12:24:16,643] INFO [LogLoader partition=__cluster_metadata-0, dir=/data/kafka_controller] Reloading from producer snapshot and rebuilding producer state from offset 0 (kafka.log.UnifiedLog$)
[2024-07-15 12:24:16,643] INFO [LogLoader partition=__cluster_metadata-0, dir=/data/kafka_controller] Producer state recovery took 0ms &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; snapshot load and 0ms &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; segment recovery from offset 0 (kafka.log.UnifiedLog$)
[2024-07-15 12:24:16,677] INFO Initialized snapshots with IDs SortedSet() from /data/kafka_controller/__cluster_metadata-0 (kafka.raft.KafkaMetadataLog$)
[2024-07-15 12:24:16,765] INFO [raft-expiration-reaper]: Starting (kafka.raft.TimingWheelExpirationService$ExpiredOperationReaper)
[2024-07-15 12:24:16,896] INFO [RaftManager id=3000] Completed transition to Unattached(epoch=0, voters=[2000, 1000, 3000], electionTimeoutMs=1497) from &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; (org.apache.kafka.raft.QuorumState)
[2024-07-15 12:24:16,900] INFO [kafka-3000-raft-outbound-request-thread]: Starting (org.apache.kafka.raft.KafkaNetworkChannel$SendThread)
[2024-07-15 12:24:16,908] INFO [kafka-3000-raft-io-thread]: Starting (kafka.raft.KafkaRaftManager$RaftIoThread)
[2024-07-15 12:24:16,916] INFO [MetadataLoader id=3000] initializeNewPublishers: the loader is still catching up because we still don&apos;t know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2024-07-15 12:24:16,918] INFO [ControllerServer id=3000] Waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; controller quorum voters &lt;span class=&quot;code-keyword&quot;&gt;future&lt;/span&gt; (kafka.server.ControllerServer)
[2024-07-15 12:24:16,918] INFO [ControllerServer id=3000] Finished waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; controller quorum voters &lt;span class=&quot;code-keyword&quot;&gt;future&lt;/span&gt; (kafka.server.ControllerServer)
[2024-07-15 12:24:16,920] INFO [RaftManager id=3000] Registered the listener org.apache.kafka.image.loader.MetadataLoader@1400411440 (org.apache.kafka.raft.KafkaRaftClient)
[2024-07-15 12:24:16,963] INFO [QuorumController id=3000] Creating &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; QuorumController with clusterId C3XMGNcJTLagIoujP0wKXQ. ZK migration mode is enabled. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:24:16,963] INFO [RaftManager id=3000] Registered the listener org.apache.kafka.controller.QuorumController$QuorumMetaLogListener@1424301218 (org.apache.kafka.raft.KafkaRaftClient)
[2024-07-15 12:24:16,973] INFO [ZooKeeperClient KRaft Migration] Initializing a &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; session to vmk-tdtzoo-01.data.plabs.ch:2181,vmk-tdtzoo-02.data.plabs.ch:2181,vmk-tdtzoo-03.data.plabs.ch:2181. (kafka.zookeeper.ZooKeeperClient)
[2024-07-15 12:24:16,977] INFO Client environment:zookeeper.version=3.8.4-9316c2a7a97e1666d8f4593f34dd6fc36ecc436c, built on 2024-02-12 22:16 UTC (org.apache.zookeeper.ZooKeeper)
[2024-07-15 12:24:16,977] INFO Client environment:host.name=vmk-tdtzoo-03.plabs.ch (org.apache.zookeeper.ZooKeeper)
[2024-07-15 12:24:16,977] INFO Client environment:java.version=17.0.10 (org.apache.zookeeper.ZooKeeper)
[2024-07-15 12:24:16,977] INFO Client environment:java.vendor=Red Hat, Inc. (org.apache.zookeeper.ZooKeeper)
[2024-07-15 12:24:16,977] INFO Client environment:java.home=/usr/lib/jvm/java-17-openjdk-17.0.10.0.7-2.el8.x86_64 (org.apache.zookeeper.ZooKeeper)
[2024-07-15 12:24:16,977] INFO Client environment:java.&lt;span class=&quot;code-keyword&quot;&gt;class.&lt;/span&gt;path=/data/kafka_bin/bin/../libs/activation-1.1.1.jar:/data/kafka_bin/bin/../libs/aopalliance-repackaged-2.6.1.jar:/data/kafka_bin/bin/../libs/argparse4j-0.7.0.jar:/data/kafka_bin/bin/../libs/audience-annotations-0.12.0.jar:/data/kafka_bin/bin/../libs/caffeine-2.9.3.jar:/data/kafka_bin/bin/../libs/checker-qual-3.19.0.jar:/data/kafka_bin/bin/../libs/commons-beanutils-1.9.4.jar:/data/kafka_bin/bin/../libs/commons-cli-1.4.jar:/data/kafka_bin/bin/../libs/commons-collections-3.2.2.jar:/data/kafka_bin/bin/../libs/commons-digester-2.1.jar:/data/kafka_bin/bin/../libs/commons-io-2.11.0.jar:/data/kafka_bin/bin/../libs/commons-lang3-3.8.1.jar:/data/kafka_bin/bin/../libs/commons-logging-1.2.jar:/data/kafka_bin/bin/../libs/commons-validator-1.7.jar:/data/kafka_bin/bin/../libs/connect-api-3.7.1.jar:/data/kafka_bin/bin/../libs/connect-basic-auth-extension-3.7.1.jar:/data/kafka_bin/bin/../libs/connect-json-3.7.1.jar:/data/kafka_bin/bin/../libs/connect-mirror-3.7.1.jar:/data/kafka_bin/bin/../libs/connect-mirror-client-3.7.1.jar:/data/kafka_bin/bin/../libs/connect-runtime-3.7.1.jar:/data/kafka_bin/bin/../libs/connect-transforms-3.7.1.jar:/data/kafka_bin/bin/../libs/error_prone_annotations-2.10.0.jar:/data/kafka_bin/bin/../libs/hk2-api-2.6.1.jar:/data/kafka_bin/bin/../libs/hk2-locator-2.6.1.jar:/data/kafka_bin/bin/../libs/hk2-utils-2.6.1.jar:/data/kafka_bin/bin/../libs/jackson-annotations-2.16.2.jar:/data/kafka_bin/bin/../libs/jackson-core-2.16.2.jar:/data/kafka_bin/bin/../libs/jackson-databind-2.16.2.jar:/data/kafka_bin/bin/../libs/jackson-dataformat-csv-2.16.2.jar:/data/kafka_bin/bin/../libs/jackson-datatype-jdk8-2.16.2.jar:/data/kafka_bin/bin/../libs/jackson-jaxrs-base-2.16.2.jar:/data/kafka_bin/bin/../libs/jackson-jaxrs-json-provider-2.16.2.jar:/data/kafka_bin/bin/../libs/jackson-module-jaxb-annotations-2.16.2.jar:/data/kafka_bin/bin/../libs/jackson-module-scala_2.13-2.16.2.jar:/data/kafka_bin/bin/../libs/jakarta.activation-api-1.2.2.jar:/data/kafka_bin/bin/../libs/jakarta.annotation-api-1.3.5.jar:/data/kafka_bin/bin/../libs/jakarta.inject-2.6.1.jar:/data/kafka_bin/bin/../libs/jakarta.validation-api-2.0.2.jar:/data/kafka_bin/bin/../libs/jakarta.ws.rs-api-2.1.6.jar:/data/kafka_bin/bin/../libs/jakarta.xml.bind-api-2.3.3.jar:/data/kafka_bin/bin/../libs/javassist-3.29.2-GA.jar:/data/kafka_bin/bin/../libs/javax.activation-api-1.2.0.jar:/data/kafka_bin/bin/../libs/javax.annotation-api-1.3.2.jar:/data/kafka_bin/bin/../libs/javax.servlet-api-3.1.0.jar:/data/kafka_bin/bin/../libs/javax.ws.rs-api-2.1.1.jar:/data/kafka_bin/bin/../libs/jaxb-api-2.3.1.jar:/data/kafka_bin/bin/../libs/jersey-client-2.39.1.jar:/data/kafka_bin/bin/../libs/jersey-common-2.39.1.jar:/data/kafka_bin/bin/../libs/jersey-container-servlet-2.39.1.jar:/data/kafka_bin/bin/../libs/jersey-container-servlet-core-2.39.1.jar:/data/kafka_bin/bin/../libs/jersey-hk2-2.39.1.jar:/data/kafka_bin/bin/../libs/jersey-server-2.39.1.jar:/data/kafka_bin/bin/../libs/jetty-client-9.4.54.v20240208.jar:/data/kafka_bin/bin/../libs/jetty-continuation-9.4.54.v20240208.jar:/data/kafka_bin/bin/../libs/jetty-http-9.4.54.v20240208.jar:/data/kafka_bin/bin/../libs/jetty-io-9.4.54.v20240208.jar:/data/kafka_bin/bin/../libs/jetty-security-9.4.54.v20240208.jar:/data/kafka_bin/bin/../libs/jetty-server-9.4.54.v20240208.jar:/data/kafka_bin/bin/../libs/jetty-servlet-9.4.54.v20240208.jar:/data/kafka_bin/bin/../libs/jetty-servlets-9.4.54.v20240208.jar:/data/kafka_bin/bin/../libs/jetty-util-9.4.54.v20240208.jar:/data/kafka_bin/bin/../libs/jetty-util-ajax-9.4.54.v20240208.jar:/data/kafka_bin/bin/../libs/jline-3.25.1.jar:/data/kafka_bin/bin/../libs/jopt-simple-5.0.4.jar:/data/kafka_bin/bin/../libs/jose4j-0.9.4.jar:/data/kafka_bin/bin/../libs/jsr305-3.0.2.jar:/data/kafka_bin/bin/../libs/kafka_2.13-3.7.1.jar:/data/kafka_bin/bin/../libs/kafka-clients-3.7.1.jar:/data/kafka_bin/bin/../libs/kafka-group-coordinator-3.7.1.jar:/data/kafka_bin/bin/../libs/kafka-log4j-appender-3.7.1.jar:/data/kafka_bin/bin/../libs/kafka-metadata-3.7.1.jar:/data/kafka_bin/bin/../libs/kafka-raft-3.7.1.jar:/data/kafka_bin/bin/../libs/kafka-server-3.7.1.jar:/data/kafka_bin/bin/../libs/kafka-server-common-3.7.1.jar:/data/kafka_bin/bin/../libs/kafka-shell-3.7.1.jar:/data/kafka_bin/bin/../libs/kafka-storage-3.7.1.jar:/data/kafka_bin/bin/../libs/kafka-storage-api-3.7.1.jar:/data/kafka_bin/bin/../libs/kafka-streams-3.7.1.jar:/data/kafka_bin/bin/../libs/kafka-streams-examples-3.7.1.jar:/data/kafka_bin/bin/../libs/kafka-streams-scala_2.13-3.7.1.jar:/data/kafka_bin/bin/../libs/kafka-streams-test-utils-3.7.1.jar:/data/kafka_bin/bin/../libs/kafka-tools-3.7.1.jar:/data/kafka_bin/bin/../libs/kafka-tools-api-3.7.1.jar:/data/kafka_bin/bin/../libs/lz4-java-1.8.0.jar:/data/kafka_bin/bin/../libs/maven-artifact-3.8.8.jar:/data/kafka_bin/bin/../libs/metrics-core-2.2.0.jar:/data/kafka_bin/bin/../libs/metrics-core-4.1.12.1.jar:/data/kafka_bin/bin/../libs/netty-buffer-4.1.110.Final.jar:/data/kafka_bin/bin/../libs/netty-codec-4.1.110.Final.jar:/data/kafka_bin/bin/../libs/netty-common-4.1.110.Final.jar:/data/kafka_bin/bin/../libs/netty-handler-4.1.110.Final.jar:/data/kafka_bin/bin/../libs/netty-resolver-4.1.110.Final.jar:/data/kafka_bin/bin/../libs/netty-transport-4.1.110.Final.jar:/data/kafka_bin/bin/../libs/netty-transport-classes-epoll-4.1.110.Final.jar:/data/kafka_bin/bin/../libs/netty-transport-&lt;span class=&quot;code-keyword&quot;&gt;native&lt;/span&gt;-epoll-4.1.110.Final.jar:/data/kafka_bin/bin/../libs/netty-transport-&lt;span class=&quot;code-keyword&quot;&gt;native&lt;/span&gt;-unix-common-4.1.110.Final.jar:/data/kafka_bin/bin/../libs/opentelemetry-proto-1.0.0-alpha.jar:/data/kafka_bin/bin/../libs/osgi-resource-locator-1.0.3.jar:/data/kafka_bin/bin/../libs/paranamer-2.8.jar:/data/kafka_bin/bin/../libs/pcollections-4.0.1.jar:/data/kafka_bin/bin/../libs/plexus-utils-3.3.1.jar:/data/kafka_bin/bin/../libs/protobuf-java-3.23.4.jar:/data/kafka_bin/bin/../libs/reflections-0.10.2.jar:/data/kafka_bin/bin/../libs/reload4j-1.2.25.jar:/data/kafka_bin/bin/../libs/rocksdbjni-7.9.2.jar:/data/kafka_bin/bin/../libs/scala-collection-compat_2.13-2.10.0.jar:/data/kafka_bin/bin/../libs/scala-java8-compat_2.13-1.0.2.jar:/data/kafka_bin/bin/../libs/scala-library-2.13.12.jar:/data/kafka_bin/bin/../libs/scala-logging_2.13-3.9.4.jar:/data/kafka_bin/bin/../libs/scala-reflect-2.13.12.jar:/data/kafka_bin/bin/../libs/slf4j-api-1.7.36.jar:/data/kafka_bin/bin/../libs/slf4j-reload4j-1.7.36.jar:/data/kafka_bin/bin/../libs/snappy-java-1.1.10.5.jar:/data/kafka_bin/bin/../libs/swagger-annotations-2.2.8.jar:/data/kafka_bin/bin/../libs/trogdor-3.7.1.jar:/data/kafka_bin/bin/../libs/zookeeper-3.8.4.jar:/data/kafka_bin/bin/../libs/zookeeper-jute-3.8.4.jar:/data/kafka_bin/bin/../libs/zstd-jni-1.5.6-3.jar (org.apache.zookeeper.ZooKeeper)
[2024-07-15 12:24:16,977] INFO Client environment:java.library.path=/usr/java/packages/lib:/usr/lib64:/lib64:/lib:/usr/lib (org.apache.zookeeper.ZooKeeper)
[2024-07-15 12:24:16,978] INFO Client environment:java.io.tmpdir=/tmp (org.apache.zookeeper.ZooKeeper)
[2024-07-15 12:24:16,978] INFO Client environment:java.compiler=&amp;lt;NA&amp;gt; (org.apache.zookeeper.ZooKeeper)
[2024-07-15 12:24:16,978] INFO Client environment:os.name=Linux (org.apache.zookeeper.ZooKeeper)
[2024-07-15 12:24:16,978] INFO Client environment:os.arch=amd64 (org.apache.zookeeper.ZooKeeper)
[2024-07-15 12:24:16,978] INFO Client environment:os.version=4.18.0-477.15.1.el8_8.x86_64 (org.apache.zookeeper.ZooKeeper)
[2024-07-15 12:24:16,978] INFO Client environment:user.name=kafka (org.apache.zookeeper.ZooKeeper)
[2024-07-15 12:24:16,978] INFO Client environment:user.home=/home/kafka (org.apache.zookeeper.ZooKeeper)
[2024-07-15 12:24:16,978] INFO Client environment:user.dir=/ (org.apache.zookeeper.ZooKeeper)
[2024-07-15 12:24:16,978] INFO Client environment:os.memory.free=992MB (org.apache.zookeeper.ZooKeeper)
[2024-07-15 12:24:16,978] INFO Client environment:os.memory.max=1024MB (org.apache.zookeeper.ZooKeeper)
[2024-07-15 12:24:16,978] INFO Client environment:os.memory.total=1024MB (org.apache.zookeeper.ZooKeeper)
[2024-07-15 12:24:16,980] INFO Initiating client connection, connectString=vmk-tdtzoo-01.data.plabs.ch:2181,vmk-tdtzoo-02.data.plabs.ch:2181,vmk-tdtzoo-03.data.plabs.ch:2181 sessionTimeout=18000 watcher=kafka.zookeeper.ZooKeeperClient$ZooKeeperClientWatcher$@711d1a52 (org.apache.zookeeper.ZooKeeper)
[2024-07-15 12:24:16,982] INFO jute.maxbuffer value is 4194304 Bytes (org.apache.zookeeper.ClientCnxnSocket)
[2024-07-15 12:24:16,986] INFO zookeeper.request.timeout value is 0. feature enabled=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt; (org.apache.zookeeper.ClientCnxn)
[2024-07-15 12:24:16,991] INFO [ZooKeeperClient KRaft Migration] Waiting until connected. (kafka.zookeeper.ZooKeeperClient)
[2024-07-15 12:24:16,995] INFO Client successfully logged in. (org.apache.zookeeper.Login)
[2024-07-15 12:24:16,996] INFO Client will use DIGEST-MD5 as SASL mechanism. (org.apache.zookeeper.client.ZooKeeperSaslClient)
[2024-07-15 12:24:16,999] INFO Opening socket connection to server vmk-tdtzoo-02.data.plabs.ch/10.4.66.35:2181. (org.apache.zookeeper.ClientCnxn)
[2024-07-15 12:24:16,999] INFO SASL config status: Will attempt to SASL-authenticate using Login Context section &lt;span class=&quot;code-quote&quot;&gt;&apos;Client&apos;&lt;/span&gt; (org.apache.zookeeper.ClientCnxn)
[2024-07-15 12:24:17,001] INFO Socket connection established, initiating session, client: /10.4.66.37:47902, server: vmk-tdtzoo-02.data.plabs.ch/10.4.66.35:2181 (org.apache.zookeeper.ClientCnxn)
[2024-07-15 12:24:17,007] INFO Session establishment complete on server vmk-tdtzoo-02.data.plabs.ch/10.4.66.35:2181, session id = 0x203897d58b70043, negotiated timeout = 18000 (org.apache.zookeeper.ClientCnxn)
[2024-07-15 12:24:17,010] INFO [ZooKeeperClient KRaft Migration] Connected. (kafka.zookeeper.ZooKeeperClient)
[2024-07-15 12:24:17,017] INFO [MetadataLoader id=3000] initializeNewPublishers: the loader is still catching up because we still don&apos;t know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2024-07-15 12:24:17,028] INFO [ZooKeeperClient KRaft Migration] Closing. (kafka.zookeeper.ZooKeeperClient)
[2024-07-15 12:24:17,117] INFO [MetadataLoader id=3000] initializeNewPublishers: the loader is still catching up because we still don&apos;t know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2024-07-15 12:24:17,131] INFO Session: 0x203897d58b70043 closed (org.apache.zookeeper.ZooKeeper)
[2024-07-15 12:24:17,132] INFO EventThread shut down &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; session: 0x203897d58b70043 (org.apache.zookeeper.ClientCnxn)
[2024-07-15 12:24:17,133] INFO [ZooKeeperClient KRaft Migration] Closed. (kafka.zookeeper.ZooKeeperClient)
[2024-07-15 12:24:17,134] INFO [ZooKeeperClient KRaft Migration] Initializing a &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; session to vmk-tdtzoo-01.data.plabs.ch:2181,vmk-tdtzoo-02.data.plabs.ch:2181,vmk-tdtzoo-03.data.plabs.ch:2181/. (kafka.zookeeper.ZooKeeperClient)
[2024-07-15 12:24:17,134] INFO Initiating client connection, connectString=vmk-tdtzoo-01.data.plabs.ch:2181,vmk-tdtzoo-02.data.plabs.ch:2181,vmk-tdtzoo-03.data.plabs.ch:2181/ sessionTimeout=18000 watcher=kafka.zookeeper.ZooKeeperClient$ZooKeeperClientWatcher$@65bdd558 (org.apache.zookeeper.ZooKeeper)
[2024-07-15 12:24:17,134] INFO jute.maxbuffer value is 4194304 Bytes (org.apache.zookeeper.ClientCnxnSocket)
[2024-07-15 12:24:17,134] INFO zookeeper.request.timeout value is 0. feature enabled=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt; (org.apache.zookeeper.ClientCnxn)
[2024-07-15 12:24:17,135] INFO [ZooKeeperClient KRaft Migration] Waiting until connected. (kafka.zookeeper.ZooKeeperClient)
[2024-07-15 12:24:17,135] INFO Client successfully logged in. (org.apache.zookeeper.Login)
[2024-07-15 12:24:17,136] INFO Client will use DIGEST-MD5 as SASL mechanism. (org.apache.zookeeper.client.ZooKeeperSaslClient)
[2024-07-15 12:24:17,137] INFO Opening socket connection to server vmk-tdtzoo-01.data.plabs.ch/10.4.66.44:2181. (org.apache.zookeeper.ClientCnxn)
[2024-07-15 12:24:17,137] INFO SASL config status: Will attempt to SASL-authenticate using Login Context section &lt;span class=&quot;code-quote&quot;&gt;&apos;Client&apos;&lt;/span&gt; (org.apache.zookeeper.ClientCnxn)
[2024-07-15 12:24:17,137] INFO Socket connection established, initiating session, client: /10.4.66.37:44754, server: vmk-tdtzoo-01.data.plabs.ch/10.4.66.44:2181 (org.apache.zookeeper.ClientCnxn)
[2024-07-15 12:24:17,140] INFO Session establishment complete on server vmk-tdtzoo-01.data.plabs.ch/10.4.66.44:2181, session id = 0x105401993a1006b, negotiated timeout = 18000 (org.apache.zookeeper.ClientCnxn)
[2024-07-15 12:24:17,141] INFO [ZooKeeperClient KRaft Migration] Connected. (kafka.zookeeper.ZooKeeperClient)
[2024-07-15 12:24:17,181] INFO [controller-3000-ThrottledChannelReaper-Fetch]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2024-07-15 12:24:17,182] INFO [controller-3000-ThrottledChannelReaper-Produce]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2024-07-15 12:24:17,183] INFO [controller-3000-ThrottledChannelReaper-Request]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2024-07-15 12:24:17,191] INFO [controller-3000-ThrottledChannelReaper-ControllerMutation]: Starting (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2024-07-15 12:24:17,210] INFO [ExpirationReaper-3000-AlterAcls]: Starting (kafka.server.DelayedOperationPurgatory$ExpiredOperationReaper)
[2024-07-15 12:24:17,217] INFO [MetadataLoader id=3000] initializeNewPublishers: the loader is still catching up because we still don&apos;t know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2024-07-15 12:24:17,238] INFO [MetadataLoader id=3000] initializeNewPublishers: the loader is still catching up because we still don&apos;t know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2024-07-15 12:24:17,238] INFO [ControllerServer id=3000] Waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; the controller metadata publishers to be installed (kafka.server.ControllerServer)
[2024-07-15 12:24:17,238] INFO [ControllerServer id=3000] Finished waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; the controller metadata publishers to be installed (kafka.server.ControllerServer)
[2024-07-15 12:24:17,238] INFO [SocketServer listenerType=CONTROLLER, nodeId=3000] Enabling request processing. (kafka.network.SocketServer)
[2024-07-15 12:24:17,240] INFO Awaiting socket connections on 0.0.0.0:9093. (kafka.network.DataPlaneAcceptor)
[2024-07-15 12:24:17,254] INFO [KRaftMigrationDriver id=3000] Recovering migration state from ZK. Transitioned migration state from ZkMigrationLeadershipState{kraftControllerId=-1, kraftControllerEpoch=-1, kraftMetadataOffset=-1, kraftMetadataEpoch=-1, lastUpdatedTimeMs=-1, migrationZkVersion=-2, controllerZkEpoch=-1, controllerZkVersion=-2} to ZkMigrationLeadershipState{kraftControllerId=2000, kraftControllerEpoch=2142, kraftMetadataOffset=534009, kraftMetadataEpoch=2142, lastUpdatedTimeMs=1721037470273, migrationZkVersion=491092, controllerZkEpoch=-1, controllerZkVersion=-2} (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[2024-07-15 12:24:17,255] INFO [KRaftMigrationDriver id=3000] Initial migration of ZK metadata is done. (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[2024-07-15 12:24:17,255] INFO [KRaftMigrationDriver id=3000] 3000 transitioning from UNINITIALIZED to INACTIVE state (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[2024-07-15 12:24:17,255] INFO [MetadataLoader id=3000] initializeNewPublishers: the loader is still catching up because we still don&apos;t know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2024-07-15 12:24:17,302] INFO [ControllerServer id=3000] Waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; all of the authorizer futures to be completed (kafka.server.ControllerServer)
[2024-07-15 12:24:17,302] INFO [ControllerServer id=3000] Finished waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; all of the authorizer futures to be completed (kafka.server.ControllerServer)
[2024-07-15 12:24:17,303] INFO [ControllerServer id=3000] Waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; all of the SocketServer Acceptors to be started (kafka.server.ControllerServer)
[2024-07-15 12:24:17,303] INFO [ControllerServer id=3000] Finished waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; all of the SocketServer Acceptors to be started (kafka.server.ControllerServer)
[2024-07-15 12:24:17,303] INFO [ControllerRegistrationManager id=3000 incarnation=S-7yiG7fTzi4naF_fbEcJw] initialized channel manager. (kafka.server.ControllerRegistrationManager)
[2024-07-15 12:24:17,303] INFO [ControllerRegistrationManager id=3000 incarnation=S-7yiG7fTzi4naF_fbEcJw] maybeSendControllerRegistration: cannot register yet because the metadata version is still 3.0-IV1, which does not support KIP-919 controller registration. (kafka.server.ControllerRegistrationManager)
[2024-07-15 12:24:17,309] INFO [controller-3000-to-controller-registration-channel-manager]: Starting (kafka.server.NodeToControllerRequestThread)
[2024-07-15 12:24:17,309] INFO Kafka version: 3.7.1 (org.apache.kafka.common.utils.AppInfoParser)
[2024-07-15 12:24:17,310] INFO Kafka commitId: e2494e6ffb89f828 (org.apache.kafka.common.utils.AppInfoParser)
[2024-07-15 12:24:17,310] INFO Kafka startTimeMs: 1721046257306 (org.apache.kafka.common.utils.AppInfoParser)
[2024-07-15 12:24:17,311] INFO [KafkaRaftServer nodeId=3000] Kafka Server started (kafka.server.KafkaRaftServer)
[2024-07-15 12:24:17,356] INFO [MetadataLoader id=3000] initializeNewPublishers: the loader is still catching up because we still don&apos;t know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2024-07-15 12:24:17,456] INFO [MetadataLoader id=3000] initializeNewPublishers: the loader is still catching up because we still don&apos;t know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2024-07-15 12:24:17,556] INFO [MetadataLoader id=3000] initializeNewPublishers: the loader is still catching up because we still don&apos;t know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2024-07-15 12:24:17,657] INFO [MetadataLoader id=3000] initializeNewPublishers: the loader is still catching up because we still don&apos;t know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2024-07-15 12:24:17,758] INFO [MetadataLoader id=3000] initializeNewPublishers: the loader is still catching up because we still don&apos;t know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2024-07-15 12:24:17,858] INFO [MetadataLoader id=3000] initializeNewPublishers: the loader is still catching up because we still don&apos;t know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2024-07-15 12:24:17,958] INFO [MetadataLoader id=3000] initializeNewPublishers: the loader is still catching up because we still don&apos;t know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2024-07-15 12:24:18,059] INFO [MetadataLoader id=3000] initializeNewPublishers: the loader is still catching up because we still don&apos;t know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2024-07-15 12:24:18,159] INFO [MetadataLoader id=3000] initializeNewPublishers: the loader is still catching up because we still don&apos;t know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2024-07-15 12:24:18,260] INFO [MetadataLoader id=3000] initializeNewPublishers: the loader is still catching up because we still don&apos;t know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2024-07-15 12:24:18,274] INFO [RaftManager id=3000] Completed transition to CandidateState(localId=3000, epoch=1, retries=1, voteStates={2000=UNRECORDED, 1000=UNRECORDED, 3000=GRANTED}, highWatermark=Optional.empty, electionTimeoutMs=1692) from Unattached(epoch=0, voters=[2000, 1000, 3000], electionTimeoutMs=1497) (org.apache.kafka.raft.QuorumState)
[2024-07-15 12:24:18,275] INFO [QuorumController id=3000] In the &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; epoch 1, the leader is (none). (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:24:18,349] INFO [RaftManager id=3000] Node 2000 disconnected. (org.apache.kafka.clients.NetworkClient)
[2024-07-15 12:24:18,350] WARN [RaftManager id=3000] Connection to node 2000 (vmk-tdtzoo-02.data.plabs.ch/10.4.66.35:9093) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2024-07-15 12:24:18,356] INFO [RaftManager id=3000] Node 1000 disconnected. (org.apache.kafka.clients.NetworkClient)
[2024-07-15 12:24:18,356] WARN [RaftManager id=3000] Connection to node 1000 (vmk-tdtzoo-01.data.plabs.ch/10.4.66.44:9093) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2024-07-15 12:24:18,360] INFO [MetadataLoader id=3000] initializeNewPublishers: the loader is still catching up because we still don&apos;t know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2024-07-15 12:24:18,420] INFO [RaftManager id=3000] Node 1000 disconnected. (org.apache.kafka.clients.NetworkClient)
[2024-07-15 12:24:18,420] WARN [RaftManager id=3000] Connection to node 1000 (vmk-tdtzoo-01.data.plabs.ch/10.4.66.44:9093) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2024-07-15 12:24:18,422] INFO [RaftManager id=3000] Node 2000 disconnected. (org.apache.kafka.clients.NetworkClient)
[2024-07-15 12:24:18,422] WARN [RaftManager id=3000] Connection to node 2000 (vmk-tdtzoo-02.data.plabs.ch/10.4.66.35:9093) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2024-07-15 12:24:18,460] INFO [MetadataLoader id=3000] initializeNewPublishers: the loader is still catching up because we still don&apos;t know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2024-07-15 12:24:18,526] INFO [RaftManager id=3000] Node 2000 disconnected. (org.apache.kafka.clients.NetworkClient)
[2024-07-15 12:24:18,526] WARN [RaftManager id=3000] Connection to node 2000 (vmk-tdtzoo-02.data.plabs.ch/10.4.66.35:9093) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2024-07-15 12:24:18,547] INFO [RaftManager id=3000] Node 1000 disconnected. (org.apache.kafka.clients.NetworkClient)
[2024-07-15 12:24:18,547] WARN [RaftManager id=3000] Connection to node 1000 (vmk-tdtzoo-01.data.plabs.ch/10.4.66.44:9093) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2024-07-15 12:24:18,561] INFO [MetadataLoader id=3000] initializeNewPublishers: the loader is still catching up because we still don&apos;t know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2024-07-15 12:24:18,661] INFO [MetadataLoader id=3000] initializeNewPublishers: the loader is still catching up because we still don&apos;t know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2024-07-15 12:24:18,761] INFO [MetadataLoader id=3000] initializeNewPublishers: the loader is still catching up because we still don&apos;t know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2024-07-15 12:24:18,770] INFO [RaftManager id=3000] Node 2000 disconnected. (org.apache.kafka.clients.NetworkClient)
[2024-07-15 12:24:18,770] WARN [RaftManager id=3000] Connection to node 2000 (vmk-tdtzoo-02.data.plabs.ch/10.4.66.35:9093) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2024-07-15 12:24:18,792] INFO [RaftManager id=3000] Node 1000 disconnected. (org.apache.kafka.clients.NetworkClient)
[2024-07-15 12:24:18,792] WARN [RaftManager id=3000] Connection to node 1000 (vmk-tdtzoo-01.data.plabs.ch/10.4.66.44:9093) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2024-07-15 12:24:18,861] INFO [MetadataLoader id=3000] initializeNewPublishers: the loader is still catching up because we still don&apos;t know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2024-07-15 12:24:18,962] INFO [MetadataLoader id=3000] initializeNewPublishers: the loader is still catching up because we still don&apos;t know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2024-07-15 12:24:19,062] INFO [MetadataLoader id=3000] initializeNewPublishers: the loader is still catching up because we still don&apos;t know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2024-07-15 12:24:19,135] INFO [RaftManager id=3000] Node 1000 disconnected. (org.apache.kafka.clients.NetworkClient)
[2024-07-15 12:24:19,135] WARN [RaftManager id=3000] Connection to node 1000 (vmk-tdtzoo-01.data.plabs.ch/10.4.66.44:9093) could not be established. Node may not be available. (org.apache.kafka.clients.NetworkClient)
[2024-07-15 12:24:19,162] INFO [MetadataLoader id=3000] initializeNewPublishers: the loader is still catching up because we still don&apos;t know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2024-07-15 12:24:19,263] INFO [MetadataLoader id=3000] initializeNewPublishers: the loader is still catching up because we still don&apos;t know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2024-07-15 12:24:19,363] INFO [MetadataLoader id=3000] initializeNewPublishers: the loader is still catching up because we still don&apos;t know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2024-07-15 12:24:19,463] INFO [MetadataLoader id=3000] initializeNewPublishers: the loader is still catching up because we still don&apos;t know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2024-07-15 12:24:19,563] INFO [RaftManager id=3000] Vote request VoteRequestData(clusterId=&lt;span class=&quot;code-quote&quot;&gt;&apos;C3XMGNcJTLagIoujP0wKXQ&apos;&lt;/span&gt;, topics=[TopicData(topicName=&lt;span class=&quot;code-quote&quot;&gt;&apos;__cluster_metadata&apos;&lt;/span&gt;, partitions=[PartitionData(partitionIndex=0, candidateEpoch=1, candidateId=2000, lastOffsetEpoch=0, lastOffset=0)])]) with epoch 1 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2024-07-15 12:24:19,563] INFO [MetadataLoader id=3000] initializeNewPublishers: the loader is still catching up because we still don&apos;t know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2024-07-15 12:24:19,664] INFO [MetadataLoader id=3000] initializeNewPublishers: the loader is still catching up because we still don&apos;t know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2024-07-15 12:24:19,764] INFO [MetadataLoader id=3000] initializeNewPublishers: the loader is still catching up because we still don&apos;t know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2024-07-15 12:24:19,865] INFO [MetadataLoader id=3000] initializeNewPublishers: the loader is still catching up because we still don&apos;t know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2024-07-15 12:24:19,962] INFO [RaftManager id=3000] Election has timed out, backing off &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; 0ms before becoming a candidate again (org.apache.kafka.raft.KafkaRaftClient)
[2024-07-15 12:24:19,963] INFO [RaftManager id=3000] Re-elect as candidate after election backoff has completed (org.apache.kafka.raft.KafkaRaftClient)
[2024-07-15 12:24:19,965] INFO [MetadataLoader id=3000] initializeNewPublishers: the loader is still catching up because we still don&apos;t know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2024-07-15 12:24:19,965] INFO [RaftManager id=3000] Completed transition to CandidateState(localId=3000, epoch=2, retries=2, voteStates={2000=UNRECORDED, 1000=UNRECORDED, 3000=GRANTED}, highWatermark=Optional.empty, electionTimeoutMs=1051) from CandidateState(localId=3000, epoch=1, retries=1, voteStates={2000=REJECTED, 1000=UNRECORDED, 3000=GRANTED}, highWatermark=Optional.empty, electionTimeoutMs=1692) (org.apache.kafka.raft.QuorumState)
[2024-07-15 12:24:19,965] INFO [QuorumController id=3000] In the &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; epoch 2, the leader is (none). (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:24:19,979] INFO [RaftManager id=3000] Completed transition to Leader(localId=3000, epoch=2, epochStartOffset=0, highWatermark=Optional.empty, voterStates={2000=ReplicaState(nodeId=2000, endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;), 1000=ReplicaState(nodeId=1000, endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;), 3000=ReplicaState(nodeId=3000, endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;)}) from CandidateState(localId=3000, epoch=2, retries=2, voteStates={2000=GRANTED, 1000=UNRECORDED, 3000=GRANTED}, highWatermark=Optional.empty, electionTimeoutMs=1051) (org.apache.kafka.raft.QuorumState)
[2024-07-15 12:24:20,021] INFO [controller-3000-to-controller-registration-channel-manager]: Recorded &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; KRaft controller, from now on will use node vmk-tdtzoo-03.data.plabs.ch:9093 (id: 3000 rack: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) (kafka.server.NodeToControllerRequestThread)
[2024-07-15 12:24:20,065] INFO [MetadataLoader id=3000] initializeNewPublishers: the loader is still catching up because we still don&apos;t know the high water mark yet. (org.apache.kafka.image.loader.MetadataLoader)
[2024-07-15 12:24:20,073] INFO [RaftManager id=3000] High watermark set to LogOffsetMetadata(offset=1, metadata=Optional[(segmentBaseOffset=0,relativePositionInSegment=106)]) &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; the first time &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; epoch 2 based on indexOfHw 1 and voters [ReplicaState(nodeId=2000, endOffset=Optional[LogOffsetMetadata(offset=1, metadata=Optional[(segmentBaseOffset=0,relativePositionInSegment=106)])], lastFetchTimestamp=1721046260072, lastCaughtUpTimestamp=1721046260072, hasAcknowledgedLeader=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;), ReplicaState(nodeId=3000, endOffset=Optional[LogOffsetMetadata(offset=1, metadata=Optional[(segmentBaseOffset=0,relativePositionInSegment=106)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;), ReplicaState(nodeId=1000, endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;)] (org.apache.kafka.raft.LeaderState)
[2024-07-15 12:24:20,081] INFO [MetadataLoader id=3000] maybePublishMetadata(LOG_DELTA): The loader is still catching up because we have not loaded a controller record as of offset 0 and high water mark is 1 (org.apache.kafka.image.loader.MetadataLoader)
[2024-07-15 12:24:20,081] INFO [QuorumController id=3000] Becoming the active controller at epoch 2, next write offset 1. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:24:20,085] WARN [QuorumController id=3000] Performing controller activation. The metadata log appears to be empty. Appending 2 bootstrap record(s) in metadata transaction at metadata.version 3.7-IV4 from bootstrap source &lt;span class=&quot;code-quote&quot;&gt;&apos;the binary bootstrap metadata file: /data/kafka_controller/bootstrap.checkpoint&apos;&lt;/span&gt;. Putting the controller into pre-migration mode. No metadata updates will be allowed until the ZK metadata has been migrated. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:24:20,086] INFO [QuorumController id=3000] Replayed BeginTransactionRecord(name=&lt;span class=&quot;code-quote&quot;&gt;&apos;Bootstrap records&apos;&lt;/span&gt;) at offset 1. (org.apache.kafka.controller.OffsetControlManager)
[2024-07-15 12:24:20,087] INFO [QuorumController id=3000] Replayed a FeatureLevelRecord setting metadata version to 3.7-IV4 (org.apache.kafka.controller.FeatureControlManager)
[2024-07-15 12:24:20,088] INFO [QuorumController id=3000] Replayed UserScramCredentialRecord creating &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; entry &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; kafka_broker with mechanism SCRAM_SHA_512. (org.apache.kafka.controller.ScramControlManager)
[2024-07-15 12:24:20,088] INFO [QuorumController id=3000] Replayed a ZkMigrationStateRecord changing the migration state from NONE to PRE_MIGRATION. (org.apache.kafka.controller.FeatureControlManager)
[2024-07-15 12:24:20,089] INFO [QuorumController id=3000] Replayed EndTransactionRecord() at offset 5. (org.apache.kafka.controller.OffsetControlManager)
[2024-07-15 12:24:20,138] INFO [MetadataLoader id=3000] maybePublishMetadata(LOG_DELTA): The loader finished catching up to the current high water mark of 6 (org.apache.kafka.image.loader.MetadataLoader)
[2024-07-15 12:24:20,141] INFO [MetadataLoader id=3000] InitializeNewPublishers: initializing SnapshotGenerator with a snapshot at offset 5 (org.apache.kafka.image.loader.MetadataLoader)
[2024-07-15 12:24:20,141] INFO [MetadataLoader id=3000] InitializeNewPublishers: initializing KRaftMetadataCachePublisher with a snapshot at offset 5 (org.apache.kafka.image.loader.MetadataLoader)
[2024-07-15 12:24:20,141] INFO [MetadataLoader id=3000] InitializeNewPublishers: initializing FeaturesPublisher with a snapshot at offset 5 (org.apache.kafka.image.loader.MetadataLoader)
[2024-07-15 12:24:20,141] INFO [ControllerServer id=3000] Loaded &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; metadata Features(version=3.7-IV4, finalizedFeatures={metadata.version=19}, finalizedFeaturesEpoch=5). (org.apache.kafka.metadata.publisher.FeaturesPublisher)
[2024-07-15 12:24:20,141] INFO [MetadataLoader id=3000] InitializeNewPublishers: initializing ControllerRegistrationsPublisher with a snapshot at offset 5 (org.apache.kafka.image.loader.MetadataLoader)
[2024-07-15 12:24:20,141] INFO [MetadataLoader id=3000] InitializeNewPublishers: initializing ControllerRegistrationManager with a snapshot at offset 5 (org.apache.kafka.image.loader.MetadataLoader)
[2024-07-15 12:24:20,143] INFO [ControllerRegistrationManager id=3000 incarnation=S-7yiG7fTzi4naF_fbEcJw] sendControllerRegistration: attempting to send ControllerRegistrationRequestData(controllerId=3000, incarnationId=S-7yiG7fTzi4naF_fbEcJw, zkMigrationReady=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;, listeners=[Listener(name=&lt;span class=&quot;code-quote&quot;&gt;&apos;CONTROLLER&apos;&lt;/span&gt;, host=&lt;span class=&quot;code-quote&quot;&gt;&apos;0.0.0.0&apos;&lt;/span&gt;, port=9093, securityProtocol=3)], features=[Feature(name=&lt;span class=&quot;code-quote&quot;&gt;&apos;metadata.version&apos;&lt;/span&gt;, minSupportedVersion=1, maxSupportedVersion=19)]) (kafka.server.ControllerRegistrationManager)
[2024-07-15 12:24:20,149] INFO [MetadataLoader id=3000] InitializeNewPublishers: initializing DynamicConfigPublisher controller id=3000 with a snapshot at offset 5 (org.apache.kafka.image.loader.MetadataLoader)
[2024-07-15 12:24:20,150] INFO [MetadataLoader id=3000] InitializeNewPublishers: initializing DynamicClientQuotaPublisher controller id=3000 with a snapshot at offset 5 (org.apache.kafka.image.loader.MetadataLoader)
[2024-07-15 12:24:20,151] INFO [MetadataLoader id=3000] InitializeNewPublishers: initializing ScramPublisher controller id=3000 with a snapshot at offset 5 (org.apache.kafka.image.loader.MetadataLoader)
[2024-07-15 12:24:20,152] INFO [MetadataLoader id=3000] InitializeNewPublishers: initializing DelegationTokenPublisher controller id=3000 with a snapshot at offset 5 (org.apache.kafka.image.loader.MetadataLoader)
[2024-07-15 12:24:20,153] INFO [MetadataLoader id=3000] InitializeNewPublishers: initializing ControllerMetadataMetricsPublisher with a snapshot at offset 5 (org.apache.kafka.image.loader.MetadataLoader)
[2024-07-15 12:24:20,153] INFO [MetadataLoader id=3000] InitializeNewPublishers: initializing AclPublisher controller id=3000 with a snapshot at offset 5 (org.apache.kafka.image.loader.MetadataLoader)
[2024-07-15 12:24:20,154] INFO [MetadataLoader id=3000] InitializeNewPublishers: initializing KRaftMigrationDriver with a snapshot at offset 5 (org.apache.kafka.image.loader.MetadataLoader)
[2024-07-15 12:24:20,174] INFO [KRaftMigrationDriver id=3000] Became active migration driver. Transitioned migration state from ZkMigrationLeadershipState{kraftControllerId=2000, kraftControllerEpoch=2142, kraftMetadataOffset=534009, kraftMetadataEpoch=2142, lastUpdatedTimeMs=1721037470273, migrationZkVersion=491092, controllerZkEpoch=-1, controllerZkVersion=-2} to ZkMigrationLeadershipState{kraftControllerId=3000, kraftControllerEpoch=2, kraftMetadataOffset=534009, kraftMetadataEpoch=2142, lastUpdatedTimeMs=1721037470273, migrationZkVersion=491092, controllerZkEpoch=-1, controllerZkVersion=-2} (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[2024-07-15 12:24:20,174] INFO [KRaftMigrationDriver id=3000] 3000 transitioning from INACTIVE to WAIT_FOR_CONTROLLER_QUORUM state (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[2024-07-15 12:24:20,175] WARN [KRaftMigrationDriver id=3000] Still waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; all controller nodes ready to begin the migration. Not ready due to:No registration found &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; controller 2000 (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[2024-07-15 12:24:20,196] INFO [QuorumController id=3000] Replayed RegisterControllerRecord contaning ControllerRegistration(id=3000, incarnationId=S-7yiG7fTzi4naF_fbEcJw, zkMigrationReady=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;, listeners=[Endpoint(listenerName=&lt;span class=&quot;code-quote&quot;&gt;&apos;CONTROLLER&apos;&lt;/span&gt;, securityProtocol=SASL_SSL, host=&lt;span class=&quot;code-quote&quot;&gt;&apos;0.0.0.0&apos;&lt;/span&gt;, port=9093)], supportedFeatures={metadata.version: 1-19}). (org.apache.kafka.controller.ClusterControlManager)
[2024-07-15 12:24:20,233] INFO [ControllerRegistrationManager id=3000 incarnation=S-7yiG7fTzi4naF_fbEcJw] Our registration has been persisted to the metadata log. (kafka.server.ControllerRegistrationManager)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:24:20,233] WARN [KRaftMigrationDriver id=3000] Still waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; all controller nodes ready to begin the migration. Not ready due to:No registration found &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; controller 2000 (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[2024-07-15 12:24:20,234] INFO [ControllerRegistrationManager id=3000 incarnation=S-7yiG7fTzi4naF_fbEcJw] RegistrationResponseHandler: controller acknowledged ControllerRegistrationRequest. (kafka.server.ControllerRegistrationManager)
[2024-07-15 12:24:20,289] INFO [QuorumController id=3000] Replayed RegisterControllerRecord contaning ControllerRegistration(id=2000, incarnationId=Y-WaxNnwQBKMmLV11iB2-g, zkMigrationReady=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;, listeners=[Endpoint(listenerName=&lt;span class=&quot;code-quote&quot;&gt;&apos;CONTROLLER&apos;&lt;/span&gt;, securityProtocol=SASL_SSL, host=&lt;span class=&quot;code-quote&quot;&gt;&apos;0.0.0.0&apos;&lt;/span&gt;, port=9093)], supportedFeatures={metadata.version: 1-19}). (org.apache.kafka.controller.ClusterControlManager)
[2024-07-15 12:24:20,318] INFO [QuorumController id=3000] Replayed RegisterControllerRecord contaning ControllerRegistration(id=1000, incarnationId=AhUAIpm1RNuZFJeg70rwAw, zkMigrationReady=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;, listeners=[Endpoint(listenerName=&lt;span class=&quot;code-quote&quot;&gt;&apos;CONTROLLER&apos;&lt;/span&gt;, securityProtocol=SASL_SSL, host=&lt;span class=&quot;code-quote&quot;&gt;&apos;0.0.0.0&apos;&lt;/span&gt;, port=9093)], supportedFeatures={metadata.version: 1-19}). (org.apache.kafka.controller.ClusterControlManager)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:24:20,322] WARN [KRaftMigrationDriver id=3000] Still waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; all controller nodes ready to begin the migration. Not ready due to:No registration found &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; controller 1000 (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:24:20,351] INFO [KRaftMigrationDriver id=3000] Controller Quorum is ready &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; Zk to KRaft migration. Now waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; ZK brokers. (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[2024-07-15 12:24:20,351] INFO [KRaftMigrationDriver id=3000] 3000 transitioning from WAIT_FOR_CONTROLLER_QUORUM to WAIT_FOR_BROKERS state (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[2024-07-15 12:24:20,352] INFO [KRaftMigrationDriver id=3000] No brokers are known to KRaft, waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; brokers to register. (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[2024-07-15 12:24:20,452] INFO [KRaftMigrationDriver id=3000] No brokers are known to KRaft, waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; brokers to register. (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:24:20,655] INFO [KRaftMigrationDriver id=3000] No brokers are known to KRaft, waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; brokers to register. (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[2024-07-15 12:24:21,057] INFO [KRaftMigrationDriver id=3000] No brokers are known to KRaft, waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; brokers to register. (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:24:21,842] INFO [KRaftMigrationDriver id=3000] No brokers are known to KRaft, waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; brokers to register. (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:24:23,455] INFO [KRaftMigrationDriver id=3000] No brokers are known to KRaft, waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; brokers to register. (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:24:26,672] INFO [KRaftMigrationDriver id=3000] No brokers are known to KRaft, waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; brokers to register. (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:24:33,137] INFO [KRaftMigrationDriver id=3000] No brokers are known to KRaft, waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; brokers to register. (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:24:45,970] INFO [KRaftMigrationDriver id=3000] No brokers are known to KRaft, waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; brokers to register. (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:24:53,122] INFO [QuorumController id=3000] Replayed initial RegisterBrokerRecord &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; broker 1: RegisterBrokerRecord(brokerId=1, isMigratingZkBroker=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;, incarnationId=EFxMcC-_SOWO9Q-hT8Znnw, brokerEpoch=75, endPoints=[BrokerEndpoint(name=&lt;span class=&quot;code-quote&quot;&gt;&apos;EXTERNAL_SASL&apos;&lt;/span&gt;, host=&lt;span class=&quot;code-quote&quot;&gt;&apos;vmk-tdtkafka-01.data.plabs.ch&apos;&lt;/span&gt;, port=9095, securityProtocol=3)], features=[BrokerFeature(name=&lt;span class=&quot;code-quote&quot;&gt;&apos;metadata.version&apos;&lt;/span&gt;, minSupportedVersion=19, maxSupportedVersion=19)], rack=&lt;span class=&quot;code-quote&quot;&gt;&apos;zur1&apos;&lt;/span&gt;, fenced=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;, inControlledShutdown=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;, logDirs=[MExmWJgJsG-LTRcxY6eSqw]) (org.apache.kafka.controller.ClusterControlManager)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:24:53,142] INFO [KRaftMigrationDriver id=3000] Still waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; ZK brokers [2, 13] to register with KRaft. (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:24:53,654] INFO [QuorumController id=3000] The request from broker 1 to unfence has been granted because it has caught up with the offset of its register broker record 75. (org.apache.kafka.controller.BrokerHeartbeatManager)
[2024-07-15 12:24:53,660] INFO [QuorumController id=3000] Replayed BrokerRegistrationChangeRecord modifying the registration &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; broker 1: BrokerRegistrationChangeRecord(brokerId=1, brokerEpoch=75, fenced=-1, inControlledShutdown=0, logDirs=[]) (org.apache.kafka.controller.ClusterControlManager)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:24:53,694] INFO [KRaftMigrationDriver id=3000] Still waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; ZK brokers [2, 13] to register with KRaft. (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:25:02,658] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:25:02,659] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 271 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:25:12,712] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:25:12,712] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 415 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:25:22,722] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:25:22,722] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 144 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:25:32,731] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:25:32,731] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 206 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:25:42,739] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:25:42,739] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 190 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:25:52,748] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:25:52,748] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 141 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:25:53,695] INFO [KRaftMigrationDriver id=3000] Still waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; ZK brokers [2, 13] to register with KRaft. (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:26:02,756] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:26:02,756] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 145 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:26:12,763] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:26:12,763] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 156 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:26:22,771] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:26:22,771] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 142 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:26:32,779] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:26:32,779] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 167 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:26:42,787] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:26:42,787] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 149 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:26:52,794] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:26:52,795] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 148 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:26:53,695] INFO [KRaftMigrationDriver id=3000] Still waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; ZK brokers [2, 13] to register with KRaft. (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:27:02,803] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:27:02,803] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 117 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:27:12,812] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:27:12,812] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 125 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:27:22,822] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:27:22,822] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 124 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:27:32,829] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:27:32,829] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 140 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:27:42,836] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:27:42,836] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 104 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:27:52,844] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:27:52,844] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 158 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:27:53,479] INFO [KRaftMigrationDriver id=3000] Still waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; ZK brokers [2, 13] to register with KRaft. (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:28:02,852] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:28:02,853] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 511 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:28:12,859] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:28:12,859] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 226 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:28:22,867] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:28:22,867] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 115 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:28:32,875] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:28:32,875] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 113 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:28:42,884] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:28:42,884] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 181 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:28:52,893] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:28:52,893] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 133 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:28:53,478] INFO [KRaftMigrationDriver id=3000] Still waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; ZK brokers [2, 13] to register with KRaft. (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:29:02,902] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:29:02,902] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 113 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:29:12,909] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:29:12,910] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 94 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:29:22,919] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:29:22,919] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 201 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:29:32,926] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:29:32,926] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 131 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:29:42,933] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:29:42,933] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 114 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:29:52,940] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:29:52,941] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 122 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:29:53,478] INFO [KRaftMigrationDriver id=3000] Still waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; ZK brokers [2, 13] to register with KRaft. (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:30:02,949] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:30:02,949] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 118 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:30:12,958] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:30:12,958] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 185 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:30:22,966] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:30:22,966] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 242 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:30:32,974] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:30:32,974] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 136 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:30:42,985] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:30:42,986] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 130 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:30:52,993] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:30:52,993] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 120 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:30:53,478] INFO [KRaftMigrationDriver id=3000] Still waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; ZK brokers [2, 13] to register with KRaft. (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:31:03,001] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:31:03,001] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 172 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:31:13,008] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:31:13,008] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 175 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:31:23,022] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:31:23,022] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 163 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:31:33,030] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:31:33,030] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 336 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:31:43,042] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:31:43,042] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 240 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:31:52,381] INFO [KRaftMigrationDriver id=3000] Still waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; ZK brokers [2, 13] to register with KRaft. (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:31:53,050] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:31:53,051] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 249 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:32:03,058] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:32:03,059] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 296 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:32:13,068] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:32:13,068] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 123 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:32:23,076] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:32:23,076] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 189 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:32:33,083] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:32:33,083] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 222 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:32:43,092] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:32:43,092] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 230 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:32:51,324] INFO [KRaftMigrationDriver id=3000] Still waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; ZK brokers [2, 13] to register with KRaft. (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:32:53,099] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:32:53,099] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 214 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:33:03,107] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:33:03,107] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 169 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:33:13,115] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:33:13,115] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 137 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:33:23,123] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:33:23,123] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 146 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:33:33,131] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:33:33,131] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 230 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:33:43,138] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:33:43,139] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 214 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:33:50,954] INFO [KRaftMigrationDriver id=3000] Still waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; ZK brokers [2, 13] to register with KRaft. (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:33:53,146] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:33:53,146] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 217 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:34:03,153] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:34:03,153] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 151 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:34:13,160] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:34:13,160] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 214 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:34:20,210] INFO [RaftManager id=3000] Node 1000 disconnected. (org.apache.kafka.clients.NetworkClient)
[2024-07-15 12:34:20,213] INFO [RaftManager id=3000] Node 2000 disconnected. (org.apache.kafka.clients.NetworkClient)
[2024-07-15 12:34:20,351] INFO [NodeToControllerChannelManager id=3000 name=registration] Node 3000 disconnected. (org.apache.kafka.clients.NetworkClient)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:34:23,167] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:34:23,167] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 293 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:34:33,184] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:34:33,184] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 294 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:34:43,191] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:34:43,191] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 203 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:34:50,748] INFO [KRaftMigrationDriver id=3000] Still waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; ZK brokers [2, 13] to register with KRaft. (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:34:53,198] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:34:53,199] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 228 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:35:03,206] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:35:03,206] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 266 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:35:13,213] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:35:13,213] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 202 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:35:23,222] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:35:23,222] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 351 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:35:33,230] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:35:33,230] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 143 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:35:43,238] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:35:43,239] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 448 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:35:50,379] INFO [KRaftMigrationDriver id=3000] Still waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; ZK brokers [2, 13] to register with KRaft. (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:35:53,246] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:35:53,246] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 232 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:36:03,254] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:36:03,254] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 157 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:36:13,262] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:36:13,262] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 229 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:36:23,271] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:36:23,271] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 329 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:36:33,282] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:36:33,282] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 183 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:36:43,289] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:36:43,289] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 208 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:36:50,379] INFO [KRaftMigrationDriver id=3000] Still waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; ZK brokers [13] to register with KRaft. (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:36:53,297] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:36:53,297] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 213 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:36:57,226] INFO [QuorumController id=3000] Replayed initial RegisterBrokerRecord &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; broker 2: RegisterBrokerRecord(brokerId=2, isMigratingZkBroker=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;, incarnationId=K76970NORHm8oH0dyBXDnw, brokerEpoch=1524, endPoints=[BrokerEndpoint(name=&lt;span class=&quot;code-quote&quot;&gt;&apos;EXTERNAL_SASL&apos;&lt;/span&gt;, host=&lt;span class=&quot;code-quote&quot;&gt;&apos;vmk-tdtkafka-02.data.plabs.ch&apos;&lt;/span&gt;, port=9095, securityProtocol=3)], features=[BrokerFeature(name=&lt;span class=&quot;code-quote&quot;&gt;&apos;metadata.version&apos;&lt;/span&gt;, minSupportedVersion=19, maxSupportedVersion=19)], rack=&lt;span class=&quot;code-quote&quot;&gt;&apos;zur1&apos;&lt;/span&gt;, fenced=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;, inControlledShutdown=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;, logDirs=[Wo19fj0iIZO-tKBiNLM8MQ]) (org.apache.kafka.controller.ClusterControlManager)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:36:57,257] INFO [KRaftMigrationDriver id=3000] Still waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; ZK brokers [13] to register with KRaft. (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:36:57,632] INFO [QuorumController id=3000] The request from broker 2 to unfence has been granted because it has caught up with the offset of its register broker record 1524. (org.apache.kafka.controller.BrokerHeartbeatManager)
[2024-07-15 12:36:57,633] INFO [QuorumController id=3000] Replayed BrokerRegistrationChangeRecord modifying the registration &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; broker 2: BrokerRegistrationChangeRecord(brokerId=2, brokerEpoch=1524, fenced=-1, inControlledShutdown=0, logDirs=[]) (org.apache.kafka.controller.ClusterControlManager)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:36:57,664] INFO [KRaftMigrationDriver id=3000] Still waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; ZK brokers [13] to register with KRaft. (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:37:03,305] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:37:03,305] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 135 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:37:11,317] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:37:11,317] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 210 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:37:19,324] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:37:19,324] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 162 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:37:27,330] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:37:27,330] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 150 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:37:35,336] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:37:35,336] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 267 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:37:43,342] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:37:43,342] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 174 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:37:51,351] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:37:51,351] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 377 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:37:57,034] INFO [KRaftMigrationDriver id=3000] Still waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; ZK brokers [13] to register with KRaft. (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:37:59,356] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:37:59,357] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 150 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:38:07,362] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:38:07,362] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 195 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:38:15,368] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:38:15,368] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 163 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:38:23,375] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:38:23,375] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 136 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:38:31,380] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:38:31,381] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 228 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:38:39,386] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:38:39,386] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 119 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:38:47,392] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:38:47,393] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 143 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:38:55,400] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:38:55,400] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 133 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:38:57,034] INFO [KRaftMigrationDriver id=3000] Still waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; ZK brokers [13] to register with KRaft. (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:39:03,406] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:39:03,407] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 201 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:39:11,412] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:39:11,412] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 222 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:39:19,419] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:39:19,419] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 148 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:39:27,425] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:39:27,426] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 213 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:39:35,431] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:39:35,431] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 245 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:39:43,435] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:39:43,435] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 251 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:39:51,468] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:39:51,468] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 226 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:39:56,085] INFO [KRaftMigrationDriver id=3000] Still waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; ZK brokers [13] to register with KRaft. (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:39:59,472] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:39:59,473] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 314 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:40:07,476] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:40:07,476] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 109 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:40:15,480] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:40:15,480] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 321 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:40:23,484] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:40:23,484] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 244 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:40:31,489] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:40:31,489] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 210 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:40:39,493] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:40:39,494] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 169 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:40:47,512] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:40:47,512] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 192 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:40:54,916] INFO [KRaftMigrationDriver id=3000] Still waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; ZK brokers [13] to register with KRaft. (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:40:55,518] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:40:55,519] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 289 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:41:03,524] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:41:03,524] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 165 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:41:11,529] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:41:11,529] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 101 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:41:19,533] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:41:19,534] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 155 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:41:27,538] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:41:27,538] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 325 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:41:35,542] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:41:35,542] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 155 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:41:43,547] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:41:43,547] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 112 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:41:51,552] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:41:51,552] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 93 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:41:54,336] INFO [KRaftMigrationDriver id=3000] Still waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; ZK brokers [13] to register with KRaft. (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:41:59,557] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:41:59,557] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 151 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:42:07,562] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:42:07,562] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 212 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:42:15,566] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:42:15,567] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 139 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:42:23,571] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:42:23,571] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 117 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:42:31,575] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:42:31,575] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 128 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:42:39,579] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:42:39,579] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 108 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:42:47,587] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:42:47,587] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 117 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:42:54,055] INFO [KRaftMigrationDriver id=3000] Still waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; ZK brokers [13] to register with KRaft. (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:42:55,592] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:42:55,592] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 206 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:43:03,597] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:43:03,597] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 126 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:43:11,603] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:43:11,604] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 142 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:43:19,609] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:43:19,609] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 102 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:43:27,614] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:43:27,614] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 127 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:43:35,618] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:43:35,619] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 122 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:43:43,623] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:43:43,623] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 260 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:43:51,628] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:43:51,628] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 178 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:43:54,055] INFO [KRaftMigrationDriver id=3000] Still waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; ZK brokers [13] to register with KRaft. (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:43:59,633] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:43:59,633] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 149 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:44:06,123] INFO [QuorumController id=3000] Replayed initial RegisterBrokerRecord &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; broker 13: RegisterBrokerRecord(brokerId=13, isMigratingZkBroker=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;, incarnationId=cQ2nfHAmRfyEHJFWzmVGLw, brokerEpoch=2384, endPoints=[BrokerEndpoint(name=&lt;span class=&quot;code-quote&quot;&gt;&apos;EXTERNAL_SASL&apos;&lt;/span&gt;, host=&lt;span class=&quot;code-quote&quot;&gt;&apos;vmk-tdtkafka-03.data.plabs.ch&apos;&lt;/span&gt;, port=9095, securityProtocol=3)], features=[BrokerFeature(name=&lt;span class=&quot;code-quote&quot;&gt;&apos;metadata.version&apos;&lt;/span&gt;, minSupportedVersion=19, maxSupportedVersion=19)], rack=&lt;span class=&quot;code-quote&quot;&gt;&apos;zur1&apos;&lt;/span&gt;, fenced=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;, inControlledShutdown=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;, logDirs=[u-MWB8lcmJjwmrzrozZOIQ]) (org.apache.kafka.controller.ClusterControlManager)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:44:06,212] INFO [KRaftMigrationDriver id=3000] Zk brokers are registered and ready &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; migration (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[2024-07-15 12:44:06,212] INFO [KRaftMigrationDriver id=3000] 3000 transitioning from WAIT_FOR_BROKERS to BECOME_CONTROLLER state (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[2024-07-15 12:44:06,220] INFO KRaft controller 3000 overwriting /controller to become the active controller with ZK epoch 21. The previous controller was 2. (kafka.zk.KafkaZkClient)
[2024-07-15 12:44:06,255] INFO Successfully registered KRaft controller 3000 with ZK epoch 21 (kafka.zk.KafkaZkClient)
[2024-07-15 12:44:06,255] TRACE [KRaftMigrationDriver id=3000] Claiming ZK controller leadership. Transitioned migration state from ZkMigrationLeadershipState{kraftControllerId=3000, kraftControllerEpoch=2, kraftMetadataOffset=534009, kraftMetadataEpoch=2142, lastUpdatedTimeMs=1721037470273, migrationZkVersion=491092, controllerZkEpoch=-1, controllerZkVersion=-2} to ZkMigrationLeadershipState{kraftControllerId=3000, kraftControllerEpoch=2, kraftMetadataOffset=534009, kraftMetadataEpoch=2142, lastUpdatedTimeMs=1721037470273, migrationZkVersion=491092, controllerZkEpoch=21, controllerZkVersion=21} (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[2024-07-15 12:44:06,276] TRACE [KRaftMigrationDriver id=3000] Re-reading migration state. Kept migration state as ZkMigrationLeadershipState{kraftControllerId=3000, kraftControllerEpoch=2, kraftMetadataOffset=534009, kraftMetadataEpoch=2142, lastUpdatedTimeMs=1721037470273, migrationZkVersion=491092, controllerZkEpoch=21, controllerZkVersion=21} (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[2024-07-15 12:44:06,276] INFO [KRaftMigrationDriver id=3000] 3000 transitioning from BECOME_CONTROLLER to SYNC_KRAFT_TO_ZK state (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[2024-07-15 12:44:06,276] INFO [KRaftMigrationDriver id=3000] Ignoring image MetadataProvenance(lastContainedOffset=2384, lastContainedEpoch=2, lastContainedLogTimeMs=1721047446124) which does not contain a superset of the metadata in ZK. Staying in SYNC_KRAFT_TO_ZK until a newer image is loaded (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[2024-07-15 12:44:06,378] INFO [KRaftMigrationDriver id=3000] Ignoring image MetadataProvenance(lastContainedOffset=2384, lastContainedEpoch=2, lastContainedLogTimeMs=1721047446124) which does not contain a superset of the metadata in ZK. Staying in SYNC_KRAFT_TO_ZK until a newer image is loaded (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[2024-07-15 12:44:06,430] INFO [QuorumController id=3000] The request from broker 13 to unfence has been granted because it has caught up with the offset of its register broker record 2384. (org.apache.kafka.controller.BrokerHeartbeatManager)
[2024-07-15 12:44:06,431] INFO [QuorumController id=3000] Replayed BrokerRegistrationChangeRecord modifying the registration &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; broker 13: BrokerRegistrationChangeRecord(brokerId=13, brokerEpoch=2384, fenced=-1, inControlledShutdown=0, logDirs=[]) (org.apache.kafka.controller.ClusterControlManager)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:44:06,460] INFO [KRaftMigrationDriver id=3000] Ignoring image MetadataProvenance(lastContainedOffset=2385, lastContainedEpoch=2, lastContainedLogTimeMs=1721047446431) which does not contain a superset of the metadata in ZK. Staying in SYNC_KRAFT_TO_ZK until a newer image is loaded (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:44:06,856] INFO [KRaftMigrationDriver id=3000] Ignoring image MetadataProvenance(lastContainedOffset=2386, lastContainedEpoch=2, lastContainedLogTimeMs=1721047446545) which does not contain a superset of the metadata in ZK. Staying in SYNC_KRAFT_TO_ZK until a newer image is loaded (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:44:07,638] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:44:07,638] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 169 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:44:07,669] INFO [KRaftMigrationDriver id=3000] Ignoring image MetadataProvenance(lastContainedOffset=2388, lastContainedEpoch=2, lastContainedLogTimeMs=1721047447545) which does not contain a superset of the metadata in ZK. Staying in SYNC_KRAFT_TO_ZK until a newer image is loaded (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:44:09,252] INFO [KRaftMigrationDriver id=3000] Ignoring image MetadataProvenance(lastContainedOffset=2391, lastContainedEpoch=2, lastContainedLogTimeMs=1721047449046) which does not contain a superset of the metadata in ZK. Staying in SYNC_KRAFT_TO_ZK until a newer image is loaded (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:44:12,498] INFO [KRaftMigrationDriver id=3000] Ignoring image MetadataProvenance(lastContainedOffset=2397, lastContainedEpoch=2, lastContainedLogTimeMs=1721047452046) which does not contain a superset of the metadata in ZK. Staying in SYNC_KRAFT_TO_ZK until a newer image is loaded (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:44:15,431] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:44:15,431] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 184 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:44:19,017] INFO [KRaftMigrationDriver id=3000] Ignoring image MetadataProvenance(lastContainedOffset=2410, lastContainedEpoch=2, lastContainedLogTimeMs=1721047458548) which does not contain a superset of the metadata in ZK. Staying in SYNC_KRAFT_TO_ZK until a newer image is loaded (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:44:23,469] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:44:23,469] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 107 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:44:31,477] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:44:31,477] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 177 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:44:31,972] INFO [KRaftMigrationDriver id=3000] Ignoring image MetadataProvenance(lastContainedOffset=2436, lastContainedEpoch=2, lastContainedLogTimeMs=1721047471553) which does not contain a superset of the metadata in ZK. Staying in SYNC_KRAFT_TO_ZK until a newer image is loaded (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:44:39,484] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:44:39,484] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 659 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:44:47,491] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:44:47,491] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 200 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:44:55,500] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:44:55,500] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 706 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:44:57,321] INFO [KRaftMigrationDriver id=3000] Ignoring image MetadataProvenance(lastContainedOffset=2487, lastContainedEpoch=2, lastContainedLogTimeMs=1721047497062) which does not contain a superset of the metadata in ZK. Staying in SYNC_KRAFT_TO_ZK until a newer image is loaded (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:45:03,506] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:45:03,507] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 284 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:45:11,515] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:45:11,515] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 190 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:45:19,522] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:45:19,522] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 131 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:45:27,530] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:45:27,530] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 118 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:45:35,537] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:45:35,537] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 128 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:45:43,543] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:45:43,544] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 127 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:45:49,100] INFO [KRaftMigrationDriver id=3000] Ignoring image MetadataProvenance(lastContainedOffset=2590, lastContainedEpoch=2, lastContainedLogTimeMs=1721047548579) which does not contain a superset of the metadata in ZK. Staying in SYNC_KRAFT_TO_ZK until a newer image is loaded (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:45:51,551] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:45:51,551] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 336 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:45:59,558] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:45:59,558] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 110 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:46:07,568] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:46:07,568] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 122 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:46:15,574] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:46:15,574] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 138 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:46:23,584] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:46:23,584] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 325 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:46:31,620] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:46:31,620] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 304 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:46:39,625] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:46:39,625] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 77 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:46:47,630] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:46:47,630] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 73 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:46:48,590] INFO [KRaftMigrationDriver id=3000] Ignoring image MetadataProvenance(lastContainedOffset=2709, lastContainedEpoch=2, lastContainedLogTimeMs=1721047608098) which does not contain a superset of the metadata in ZK. Staying in SYNC_KRAFT_TO_ZK until a newer image is loaded (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:46:55,635] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:46:55,635] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 88 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:47:03,642] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:47:03,642] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 95 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:47:11,647] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:47:11,648] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 75 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:47:19,654] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:47:19,654] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 179 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:47:27,660] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:47:27,660] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 213 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:47:35,667] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:47:35,667] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 370 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:47:43,672] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:47:43,672] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 86 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:47:47,572] INFO [KRaftMigrationDriver id=3000] Ignoring image MetadataProvenance(lastContainedOffset=2827, lastContainedEpoch=2, lastContainedLogTimeMs=1721047667118) which does not contain a superset of the metadata in ZK. Staying in SYNC_KRAFT_TO_ZK until a newer image is loaded (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:47:51,679] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:47:51,679] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 139 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:47:59,685] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:47:59,685] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 141 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:48:07,691] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:48:07,691] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 148 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:48:15,697] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:48:15,697] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 191 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:48:23,704] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:48:23,704] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 153 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:48:31,710] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:48:31,710] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 115 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:48:39,715] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:48:39,715] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 126 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:48:47,572] INFO [KRaftMigrationDriver id=3000] Ignoring image MetadataProvenance(lastContainedOffset=2947, lastContainedEpoch=2, lastContainedLogTimeMs=1721047727142) which does not contain a superset of the metadata in ZK. Staying in SYNC_KRAFT_TO_ZK until a newer image is loaded (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:48:47,721] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:48:47,721] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 101 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:48:55,726] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:48:55,727] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 291 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:49:03,731] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:49:03,731] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 122 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:49:11,737] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:49:11,737] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 331 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:49:19,742] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:49:19,742] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 210 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:49:27,747] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:49:27,748] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 230 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:49:35,754] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:49:35,754] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 149 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:49:43,760] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:49:43,760] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 411 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:49:47,023] INFO [KRaftMigrationDriver id=3000] Ignoring image MetadataProvenance(lastContainedOffset=3066, lastContainedEpoch=2, lastContainedLogTimeMs=1721047786664) which does not contain a superset of the metadata in ZK. Staying in SYNC_KRAFT_TO_ZK until a newer image is loaded (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:49:51,767] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:49:51,767] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 149 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:49:59,772] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:49:59,772] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 103 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:50:07,778] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:50:07,779] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 249 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:50:15,784] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:50:15,784] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 197 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:50:23,791] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:50:23,791] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 115 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:50:31,798] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:50:31,798] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 120 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:50:39,803] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:50:39,803] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 104 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:50:47,023] INFO [KRaftMigrationDriver id=3000] Ignoring image MetadataProvenance(lastContainedOffset=3186, lastContainedEpoch=2, lastContainedLogTimeMs=1721047846685) which does not contain a superset of the metadata in ZK. Staying in SYNC_KRAFT_TO_ZK until a newer image is loaded (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:50:47,809] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:50:47,810] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 204 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:50:55,816] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:50:55,816] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 124 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:51:03,822] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:51:03,822] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 107 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:51:11,828] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:51:11,829] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 406 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:51:19,834] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:51:19,834] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 101 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:51:27,839] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:51:27,840] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 431 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:51:35,845] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:51:35,845] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 141 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:51:43,850] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:51:43,851] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 104 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:51:46,848] INFO [KRaftMigrationDriver id=3000] Ignoring image MetadataProvenance(lastContainedOffset=3306, lastContainedEpoch=2, lastContainedLogTimeMs=1721047906707) which does not contain a superset of the metadata in ZK. Staying in SYNC_KRAFT_TO_ZK until a newer image is loaded (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:51:51,856] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:51:51,856] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 124 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:51:59,861] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:51:59,861] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 129 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:52:07,866] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:52:07,867] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 169 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:52:15,871] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:52:15,872] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 156 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:52:23,877] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:52:23,877] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 164 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:52:31,883] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:52:31,883] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 108 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:52:39,889] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:52:39,889] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 287 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:52:46,848] INFO [KRaftMigrationDriver id=3000] Ignoring image MetadataProvenance(lastContainedOffset=3426, lastContainedEpoch=2, lastContainedLogTimeMs=1721047966728) which does not contain a superset of the metadata in ZK. Staying in SYNC_KRAFT_TO_ZK until a newer image is loaded (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:52:47,894] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:52:47,894] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 122 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:52:55,900] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:52:55,900] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 95 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:53:03,907] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:53:03,907] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 232 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:53:11,913] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:53:11,913] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 165 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:53:19,919] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:53:19,919] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 152 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:53:27,925] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:53:27,925] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 476 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:53:35,931] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:53:35,931] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 260 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:53:43,937] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:53:43,937] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 117 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:53:46,267] INFO [KRaftMigrationDriver id=3000] Ignoring image MetadataProvenance(lastContainedOffset=3544, lastContainedEpoch=2, lastContainedLogTimeMs=1721048025750) which does not contain a superset of the metadata in ZK. Staying in SYNC_KRAFT_TO_ZK until a newer image is loaded (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:53:51,943] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:53:51,943] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 122 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:53:59,948] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:53:59,948] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 105 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:54:07,953] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:54:07,953] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 181 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:54:15,959] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:54:15,960] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 300 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:54:23,965] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:54:23,965] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 115 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:54:31,971] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:54:31,971] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 123 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:54:39,976] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:54:39,976] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 120 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:54:45,436] INFO [KRaftMigrationDriver id=3000] Ignoring image MetadataProvenance(lastContainedOffset=3663, lastContainedEpoch=2, lastContainedLogTimeMs=1721048085272) which does not contain a superset of the metadata in ZK. Staying in SYNC_KRAFT_TO_ZK until a newer image is loaded (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:54:47,981] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:54:47,982] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 202 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:54:55,988] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:54:55,988] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 110 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:55:03,994] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:55:03,994] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 96 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:55:11,999] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:55:11,999] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 119 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:55:20,004] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:55:20,004] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 122 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:55:28,010] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:55:28,010] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 288 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:55:36,015] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:55:36,015] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 201 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:55:44,020] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:55:44,020] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 135 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:55:45,436] INFO [KRaftMigrationDriver id=3000] Ignoring image MetadataProvenance(lastContainedOffset=3783, lastContainedEpoch=2, lastContainedLogTimeMs=1721048145293) which does not contain a superset of the metadata in ZK. Staying in SYNC_KRAFT_TO_ZK until a newer image is loaded (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:55:52,025] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:55:52,025] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 120 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:55:55,986] WARN [RaftManager id=3000] Detected non-monotonic update of fetch offset from nodeId 13: 3791 -&amp;gt; 0 (org.apache.kafka.raft.LeaderState)
[2024-07-15 12:55:55,992] INFO [QuorumController id=3000] registerBroker: event failed with DuplicateBrokerRegistrationException in 145 microseconds. Exception message: Another broker is registered with that broker id. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:55:56,096] INFO [QuorumController id=3000] registerBroker: event failed with DuplicateBrokerRegistrationException in 91 microseconds. Exception message: Another broker is registered with that broker id. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:55:56,299] INFO [QuorumController id=3000] registerBroker: event failed with DuplicateBrokerRegistrationException in 66 microseconds. Exception message: Another broker is registered with that broker id. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:55:56,696] INFO [QuorumController id=3000] registerBroker: event failed with DuplicateBrokerRegistrationException in 75 microseconds. Exception message: Another broker is registered with that broker id. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:55:57,491] INFO [QuorumController id=3000] registerBroker: event failed with DuplicateBrokerRegistrationException in 125 microseconds. Exception message: Another broker is registered with that broker id. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:55:58,029] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:55:58,029] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 108 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:55:58,419] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:55:58,420] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 218 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:55:59,069] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:55:59,069] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 141 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:55:59,121] INFO [QuorumController id=3000] Replayed RegisterBrokerRecord establishing a &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; incarnation of broker 13: RegisterBrokerRecord(brokerId=13, isMigratingZkBroker=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;, incarnationId=NUqXKlgARfGzlk8PMR3spA, brokerEpoch=3811, endPoints=[BrokerEndpoint(name=&lt;span class=&quot;code-quote&quot;&gt;&apos;EXTERNAL_SASL&apos;&lt;/span&gt;, host=&lt;span class=&quot;code-quote&quot;&gt;&apos;vmk-tdtkafka-03.data.plabs.ch&apos;&lt;/span&gt;, port=9095, securityProtocol=3)], features=[BrokerFeature(name=&lt;span class=&quot;code-quote&quot;&gt;&apos;metadata.version&apos;&lt;/span&gt;, minSupportedVersion=19, maxSupportedVersion=19)], rack=&lt;span class=&quot;code-quote&quot;&gt;&apos;zur1&apos;&lt;/span&gt;, fenced=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;, inControlledShutdown=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;, logDirs=[u-MWB8lcmJjwmrzrozZOIQ]) (org.apache.kafka.controller.ClusterControlManager)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:55:59,151] INFO [KRaftMigrationDriver id=3000] Ignoring image MetadataProvenance(lastContainedOffset=3811, lastContainedEpoch=2, lastContainedLogTimeMs=1721048159122) which does not contain a superset of the metadata in ZK. Staying in SYNC_KRAFT_TO_ZK until a newer image is loaded (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[2024-07-15 12:55:59,157] INFO [QuorumController id=3000] The request from broker 13 to unfence has been granted because it has caught up with the offset of its register broker record 3811. (org.apache.kafka.controller.BrokerHeartbeatManager)
[2024-07-15 12:55:59,157] INFO [QuorumController id=3000] Replayed BrokerRegistrationChangeRecord modifying the registration &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; broker 13: BrokerRegistrationChangeRecord(brokerId=13, brokerEpoch=3811, fenced=-1, inControlledShutdown=0, logDirs=[]) (org.apache.kafka.controller.ClusterControlManager)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:55:59,187] INFO [KRaftMigrationDriver id=3000] Ignoring image MetadataProvenance(lastContainedOffset=3812, lastContainedEpoch=2, lastContainedLogTimeMs=1721048159157) which does not contain a superset of the metadata in ZK. Staying in SYNC_KRAFT_TO_ZK until a newer image is loaded (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:56:07,420] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:56:07,420] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 169 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:56:16,074] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:56:16,075] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 232 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:56:24,079] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:56:24,079] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 231 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:56:32,084] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:56:32,084] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 164 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:56:40,089] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:56:40,089] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 153 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:56:48,094] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:56:48,094] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 316 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:56:56,098] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:56:56,098] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 179 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:56:58,754] INFO [KRaftMigrationDriver id=3000] Ignoring image MetadataProvenance(lastContainedOffset=3931, lastContainedEpoch=2, lastContainedLogTimeMs=1721048218322) which does not contain a superset of the metadata in ZK. Staying in SYNC_KRAFT_TO_ZK until a newer image is loaded (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:57:04,104] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:57:04,104] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 207 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:57:12,109] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:57:12,109] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 217 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:57:20,114] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:57:20,114] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 168 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:57:28,121] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:57:28,122] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 191 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:57:36,126] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:57:36,126] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 134 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:57:44,131] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:57:44,131] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 126 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:57:52,135] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:57:52,136] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 201 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:57:58,754] INFO [KRaftMigrationDriver id=3000] Ignoring image MetadataProvenance(lastContainedOffset=4051, lastContainedEpoch=2, lastContainedLogTimeMs=1721048278344) which does not contain a superset of the metadata in ZK. Staying in SYNC_KRAFT_TO_ZK until a newer image is loaded (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:58:00,140] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:58:00,140] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 161 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:58:08,144] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:58:08,144] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 288 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:58:16,149] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:58:16,149] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 260 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:58:24,154] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:58:24,154] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 291 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:58:32,159] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:58:32,159] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 134 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:58:40,165] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:58:40,165] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 140 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:58:48,169] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:58:48,170] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 256 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:58:56,174] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:58:56,175] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 104 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:58:58,754] INFO [KRaftMigrationDriver id=3000] Ignoring image MetadataProvenance(lastContainedOffset=4171, lastContainedEpoch=2, lastContainedLogTimeMs=1721048338366) which does not contain a superset of the metadata in ZK. Staying in SYNC_KRAFT_TO_ZK until a newer image is loaded (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:59:04,180] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:59:04,180] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 154 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:59:12,184] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:59:12,184] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 269 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:59:20,188] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:59:20,188] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 153 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:59:28,192] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:59:28,193] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 283 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:59:36,197] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:59:36,197] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 212 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:59:44,201] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:59:44,201] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 139 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:59:52,205] INFO [QuorumController id=3000] Cannot run write operation maybeFenceReplicas in pre-migration mode. Returning NOT_CONTROLLER. (org.apache.kafka.controller.QuorumController)
[2024-07-15 12:59:52,206] INFO [QuorumController id=3000] maybeFenceReplicas: event failed with NotControllerException in 114 microseconds. Exception message: The controller is in pre-migration mode. (org.apache.kafka.controller.QuorumController)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 12:59:57,774] INFO [KRaftMigrationDriver id=3000] Ignoring image MetadataProvenance(lastContainedOffset=4289, lastContainedEpoch=2, lastContainedLogTimeMs=1721048397384) which does not contain a superset of the metadata in ZK. Staying in SYNC_KRAFT_TO_ZK until a newer image is loaded (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...]
[2024-07-15 xx:xx:xx,xxx] TRACE [KRaftMigrationDriver id=3000] Received metadata delta, but the controller is not in dual-write mode. Ignoring the change to be replicated to Zookeeper (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
[...] &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17869676" author="davidarthur" created="Tue, 30 Jul 2024 15:29:41 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=saimon46&quot; class=&quot;user-hover&quot; rel=&quot;saimon46&quot;&gt;saimon46&lt;/a&gt; by chance, did you previously attempt a migration on this cluster and revert it? It looks like the there is a mismatch between the state in the /migration ZNode and the controller.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;When the controller starts up, it reads the latest state of /migration from ZK. It appears that the migration was already completed&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
[2024-07-15 12:24:17,254] INFO [KRaftMigrationDriver id=3000] Recovering migration state from ZK. Transitioned migration state from ZkMigrationLeadershipState{kraftControllerId=-1, kraftControllerEpoch=-1, kraftMetadataOffset=-1, kraftMetadataEpoch=-1, lastUpdatedTimeMs=-1, migrationZkVersion=-2, controllerZkEpoch=-1, controllerZkVersion=-2} to ZkMigrationLeadershipState{kraftControllerId=2000, kraftControllerEpoch=2142, kraftMetadataOffset=534009, kraftMetadataEpoch=2142, lastUpdatedTimeMs=1721037470273, migrationZkVersion=491092, controllerZkEpoch=-1, controllerZkVersion=-2} (org.apache.kafka.metadata.migration.KRaftMigrationDriver)

[2024-07-15 12:24:17,255] INFO [KRaftMigrationDriver id=3000] Initial migration of ZK metadata is done. (org.apache.kafka.metadata.migration.KRaftMigrationDriver)  &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;However, when activating the controller, it sees that the local log is empty and so initializes itself in pre-migration mode&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
[2024-07-15 12:24:20,085] WARN [QuorumController id=3000] Performing controller activation. The metadata log appears to be empty. Appending 2 bootstrap record(s) in metadata transaction at metadata.version 3.7-IV4 from bootstrap source &lt;span class=&quot;code-quote&quot;&gt;&apos;the binary bootstrap metadata file: /data/kafka_controller/bootstrap.checkpoint&apos;&lt;/span&gt;. Putting the controller into pre-migration mode. No metadata updates will be allowed until the ZK metadata has been migrated. (org.apache.kafka.controller.QuorumController) &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Once KRaftMigrationDriver handles the leader event, it thinks the migration is already done based on the /migration state&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
[2024-07-15 12:44:06,255] TRACE [KRaftMigrationDriver id=3000] Claiming ZK controller leadership. Transitioned migration state from ZkMigrationLeadershipState{kraftControllerId=3000, kraftControllerEpoch=2, kraftMetadataOffset=534009, kraftMetadataEpoch=2142, lastUpdatedTimeMs=1721037470273, migrationZkVersion=491092, controllerZkEpoch=-1, controllerZkVersion=-2} to ZkMigrationLeadershipState{kraftControllerId=3000, kraftControllerEpoch=2, kraftMetadataOffset=534009, kraftMetadataEpoch=2142, lastUpdatedTimeMs=1721037470273, migrationZkVersion=491092, controllerZkEpoch=21, controllerZkVersion=21} (org.apache.kafka.metadata.migration.KRaftMigrationDriver)

...

[2024-07-15 12:44:06,276] INFO [KRaftMigrationDriver id=3000] 3000 transitioning from BECOME_CONTROLLER to SYNC_KRAFT_TO_ZK state (org.apache.kafka.metadata.migration.KRaftMigrationDriver)
 &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Transitioning directly from BECOME_CONTROLLER to SYNC_KRAFT_TO_ZK only happens when KRaftMigrationDriver sees that the migration is already complete.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Can you try reverting the migration and trying it again?&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Stop KRaft controllers&lt;/li&gt;
	&lt;li&gt;Delete the /controller ZNode&lt;/li&gt;
	&lt;li&gt;Delete the /migration ZNode&lt;/li&gt;
	&lt;li&gt;Reformat the KRaft controllers&lt;/li&gt;
	&lt;li&gt;Start KRaft controllers&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17869846" author="JIRAUSER306228" created="Wed, 31 Jul 2024 08:54:15 +0000"  >&lt;p&gt;Yes, I confirm that I tried multiple times to migrate the controllers and with several Kafka versions, but yes I was thinking, as reported here &lt;a href=&quot;https://kafka.apache.org/documentation/#kraft_zk_migration&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://kafka.apache.org/documentation/#kraft_zk_migration&lt;/a&gt;, that the rollback was enough with a simple delete of `/controller` instead no, `/migration` has to be dropped too. Maybe it makes sense update the docs about it &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;. The first migration that I tried then failed for some reason that is different.&lt;/p&gt;

&lt;p&gt;I&apos;m going to try remove the `/migration` too and retry the migration from scratch. I&apos;ll let you know what happens!&lt;/p&gt;</comment>
                            <comment id="17870234" author="githubbot" created="Thu, 1 Aug 2024 16:54:57 +0000"  >&lt;p&gt;mumrah opened a new pull request, #620:&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/kafka-site/pull/620&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka-site/pull/620&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;   When reverting the ZK migration, we must also remove the `/migration` ZNode in order to allow the migration to be re-attempted in the future.&lt;/p&gt;

</comment>
                            <comment id="17870433" author="githubbot" created="Fri, 2 Aug 2024 09:54:06 +0000"  >&lt;p&gt;showuon commented on code in PR #620:&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/kafka-site/pull/620#discussion_r1701620649&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka-site/pull/620#discussion_r1701620649&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;##########&lt;br/&gt;
38/ops.html:&lt;br/&gt;
##########&lt;br/&gt;
@@ -4105,7 +4105,10 @@ &amp;lt;h3&amp;gt;Reverting to ZooKeeper mode During the Migration&amp;lt;/h3&amp;gt;&lt;br/&gt;
             &amp;lt;/li&amp;gt;&lt;br/&gt;
             &amp;lt;li&amp;gt;&lt;br/&gt;
               Using &amp;lt;code&amp;gt;zookeeper-shell.sh&amp;lt;/code&amp;gt;, run &amp;lt;code&amp;gt;rmr /controller&amp;lt;/code&amp;gt; so that one&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;of the brokers can become the new old-style controller.&lt;br/&gt;
+              of the brokers can become the new old-style controller. Additionally, run&lt;br/&gt;
+              &amp;lt;code&amp;gt;get /migration&amp;lt;/code&amp;gt; followed by &amp;lt;code&amp;gt;rmr /migration&amp;lt;/code&amp;gt; to clear the&lt;br/&gt;
+              migration state from ZooKeeper. This will allow you to re-attempt the migration&lt;br/&gt;
+              in the future. The data read from &quot;/migration&quot; can be useful for debugging.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Review Comment:&lt;br/&gt;
   We also need to update it in L4147 (`Migrating brokers to KRaft` row) &lt;/p&gt;


</comment>
                            <comment id="17870579" author="ppatierno" created="Fri, 2 Aug 2024 15:40:14 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=saimon46&quot; class=&quot;user-hover&quot; rel=&quot;saimon46&quot;&gt;saimon46&lt;/a&gt; it&apos;s not clear to me, sorry for the stupid question, when you did the rollback and then tried to run the migration again.&lt;/p&gt;

&lt;p&gt;From the KRaft migration documentation you can see it says:&lt;/p&gt;

&lt;p&gt;&quot;After the migration has been finalized, it is not possible to revert back to ZooKeeper mode.&quot;&lt;/p&gt;

&lt;p&gt;So it means that when you completed the migration with the controllers not connected to ZooKeeper anymore (of course the same for the brokers) you cannot rollback to ZooKeeper.&lt;/p&gt;

&lt;p&gt;I am saying this because as part of our automation of KRaft migration within the Strimzi project (running Kafka on Kubernetes), I rolled back the migration from the point where controllers are still connected to ZooKeeper (which is your last chance), so coming back to a full ZooKeeper based cluster just deleting /controller znode and not the /migration one. Then I restarted the migration and it worked like a charm. I did this several times to be sure.&lt;/p&gt;

&lt;p&gt;In my tests, the /migration znode was just overwritten ... example ... after 1st migration then rollback&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

{&quot;version&quot;:0,&quot;kraft_metadata_offset&quot;:1182,&quot;kraft_controller_id&quot;:3,&quot;kraft_metadata_epoch&quot;:5,&quot;kraft_controller_epoch&quot;:5}

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;when starting the new migration&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

{&quot;version&quot;:0,&quot;kraft_metadata_offset&quot;:1211,&quot;kraft_controller_id&quot;:4,&quot;kraft_metadata_epoch&quot;:11,&quot;kraft_controller_epoch&quot;:11}</comment>
                            <comment id="17870865" author="githubbot" created="Sun, 4 Aug 2024 19:20:13 +0000"  >&lt;p&gt;chia7712 commented on code in PR #620:&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/kafka-site/pull/620#discussion_r1703359268&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka-site/pull/620#discussion_r1703359268&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;##########&lt;br/&gt;
38/ops.html:&lt;br/&gt;
##########&lt;br/&gt;
@@ -4105,7 +4105,10 @@ &amp;lt;h3&amp;gt;Reverting to ZooKeeper mode During the Migration&amp;lt;/h3&amp;gt;&lt;br/&gt;
             &amp;lt;/li&amp;gt;&lt;br/&gt;
             &amp;lt;li&amp;gt;&lt;br/&gt;
               Using &amp;lt;code&amp;gt;zookeeper-shell.sh&amp;lt;/code&amp;gt;, run &amp;lt;code&amp;gt;rmr /controller&amp;lt;/code&amp;gt; so that one&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;of the brokers can become the new old-style controller.&lt;br/&gt;
+              of the brokers can become the new old-style controller. Additionally, run&lt;br/&gt;
+              &amp;lt;code&amp;gt;get /migration&amp;lt;/code&amp;gt; followed by &amp;lt;code&amp;gt;rmr /migration&amp;lt;/code&amp;gt; to clear the&lt;br/&gt;
+              migration state from ZooKeeper. This will allow you to re-attempt the migration&lt;br/&gt;
+              in the future. The data read from &quot;/migration&quot; can be useful for debugging.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Review Comment:&lt;br/&gt;
   oh, I don&apos;t notice this comment. &lt;a href=&quot;https://github.com/apache/kafka/pull/16770&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/16770&lt;/a&gt; is merged. I will sync the changes back to kafka repo if it needs&lt;/p&gt;


</comment>
                            <comment id="17870867" author="githubbot" created="Sun, 4 Aug 2024 19:36:09 +0000"  >&lt;p&gt;ppatierno commented on code in PR #620:&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/kafka-site/pull/620#discussion_r1703365750&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka-site/pull/620#discussion_r1703365750&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;##########&lt;br/&gt;
38/ops.html:&lt;br/&gt;
##########&lt;br/&gt;
@@ -4105,7 +4105,10 @@ &amp;lt;h3&amp;gt;Reverting to ZooKeeper mode During the Migration&amp;lt;/h3&amp;gt;&lt;br/&gt;
             &amp;lt;/li&amp;gt;&lt;br/&gt;
             &amp;lt;li&amp;gt;&lt;br/&gt;
               Using &amp;lt;code&amp;gt;zookeeper-shell.sh&amp;lt;/code&amp;gt;, run &amp;lt;code&amp;gt;rmr /controller&amp;lt;/code&amp;gt; so that one&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;of the brokers can become the new old-style controller.&lt;br/&gt;
+              of the brokers can become the new old-style controller. Additionally, run&lt;br/&gt;
+              &amp;lt;code&amp;gt;get /migration&amp;lt;/code&amp;gt; followed by &amp;lt;code&amp;gt;rmr /migration&amp;lt;/code&amp;gt; to clear the&lt;br/&gt;
+              migration state from ZooKeeper. This will allow you to re-attempt the migration&lt;br/&gt;
+              in the future. The data read from &quot;/migration&quot; can be useful for debugging.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Review Comment:&lt;br/&gt;
   I have commented the corresponding JIRA to understand in which state the user rollbacks the cluster to restart the migration because I tried this scenario more times without deleting the /migration znode and it worked fine.&lt;/p&gt;


</comment>
                            <comment id="17871339" author="githubbot" created="Tue, 6 Aug 2024 13:34:31 +0000"  >&lt;p&gt;mumrah commented on code in PR #620:&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/kafka-site/pull/620#discussion_r1705552076&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka-site/pull/620#discussion_r1705552076&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;##########&lt;br/&gt;
38/ops.html:&lt;br/&gt;
##########&lt;br/&gt;
@@ -4105,7 +4105,10 @@ &amp;lt;h3&amp;gt;Reverting to ZooKeeper mode During the Migration&amp;lt;/h3&amp;gt;&lt;br/&gt;
             &amp;lt;/li&amp;gt;&lt;br/&gt;
             &amp;lt;li&amp;gt;&lt;br/&gt;
               Using &amp;lt;code&amp;gt;zookeeper-shell.sh&amp;lt;/code&amp;gt;, run &amp;lt;code&amp;gt;rmr /controller&amp;lt;/code&amp;gt; so that one&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;of the brokers can become the new old-style controller.&lt;br/&gt;
+              of the brokers can become the new old-style controller. Additionally, run&lt;br/&gt;
+              &amp;lt;code&amp;gt;get /migration&amp;lt;/code&amp;gt; followed by &amp;lt;code&amp;gt;rmr /migration&amp;lt;/code&amp;gt; to clear the&lt;br/&gt;
+              migration state from ZooKeeper. This will allow you to re-attempt the migration&lt;br/&gt;
+              in the future. The data read from &quot;/migration&quot; can be useful for debugging.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Review Comment:&lt;br/&gt;
   Thanks @showuon, added the second mention. I wonder why we have this duplication? &#129300; &lt;/p&gt;


</comment>
                            <comment id="17871342" author="davidarthur" created="Tue, 6 Aug 2024 13:39:48 +0000"  >&lt;p&gt;&amp;gt; deleting /controller znode and not the /migration one. Then I restarted the migration and it worked like a charm. I did this several times to be sure.&lt;/p&gt;

&lt;p&gt;I think you were lucky &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&#160;&lt;/p&gt;


&lt;p&gt;I haven&apos;t been able to confirm, but I think one of the recent fixes (&lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-16667&quot; title=&quot;KRaftMigrationDriver gets stuck after successive failovers&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-16667&quot;&gt;&lt;del&gt;KAFKA-16667&lt;/del&gt;&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-16563&quot; title=&quot;migration to KRaft hanging after MigrationClientException&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-16563&quot;&gt;&lt;del&gt;KAFKA-16563&lt;/del&gt;&lt;/a&gt;, or &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-16171&quot; title=&quot;Controller failover during ZK migration can prevent metadata updates to ZK brokers&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-16171&quot;&gt;&lt;del&gt;KAFKA-16171&lt;/del&gt;&lt;/a&gt;) may have caused a stale /migration ZNode to cause problems. Either way, the correct thing to do is to delete it before re-attempting the migration.&lt;/p&gt;</comment>
                            <comment id="17871359" author="githubbot" created="Tue, 6 Aug 2024 14:17:32 +0000"  >&lt;p&gt;chia7712 commented on code in PR #620:&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/kafka-site/pull/620#discussion_r1705624608&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka-site/pull/620#discussion_r1705624608&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;##########&lt;br/&gt;
38/ops.html:&lt;br/&gt;
##########&lt;br/&gt;
@@ -4105,7 +4105,10 @@ &amp;lt;h3&amp;gt;Reverting to ZooKeeper mode During the Migration&amp;lt;/h3&amp;gt;&lt;br/&gt;
             &amp;lt;/li&amp;gt;&lt;br/&gt;
             &amp;lt;li&amp;gt;&lt;br/&gt;
               Using &amp;lt;code&amp;gt;zookeeper-shell.sh&amp;lt;/code&amp;gt;, run &amp;lt;code&amp;gt;rmr /controller&amp;lt;/code&amp;gt; so that one&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;of the brokers can become the new old-style controller.&lt;br/&gt;
+              of the brokers can become the new old-style controller. Additionally, run&lt;br/&gt;
+              &amp;lt;code&amp;gt;get /migration&amp;lt;/code&amp;gt; followed by &amp;lt;code&amp;gt;rmr /migration&amp;lt;/code&amp;gt; to clear the&lt;br/&gt;
+              migration state from ZooKeeper. This will allow you to re-attempt the migration&lt;br/&gt;
+              in the future. The data read from &quot;/migration&quot; can be useful for debugging.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Review Comment:&lt;br/&gt;
   &amp;gt; I wonder why we have this duplication?&lt;/p&gt;

&lt;p&gt;   it seems we list all directions for reverting for each migration phase. That is a bit verbose, but they are useful. However, it is weird to use &quot;table format&quot; to display so much texts. Maybe we should to a bit refactor for it. Also, the same direction can have its hyperlink to be shared in different migration phase.&lt;/p&gt;


</comment>
                            <comment id="17871362" author="githubbot" created="Tue, 6 Aug 2024 14:45:52 +0000"  >&lt;p&gt;chia7712 commented on code in PR #620:&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/kafka-site/pull/620#discussion_r1705673008&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka-site/pull/620#discussion_r1705673008&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;##########&lt;br/&gt;
38/ops.html:&lt;br/&gt;
##########&lt;br/&gt;
@@ -4105,7 +4105,10 @@ &amp;lt;h3&amp;gt;Reverting to ZooKeeper mode During the Migration&amp;lt;/h3&amp;gt;&lt;br/&gt;
             &amp;lt;/li&amp;gt;&lt;br/&gt;
             &amp;lt;li&amp;gt;&lt;br/&gt;
               Using &amp;lt;code&amp;gt;zookeeper-shell.sh&amp;lt;/code&amp;gt;, run &amp;lt;code&amp;gt;rmr /controller&amp;lt;/code&amp;gt; so that one&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;of the brokers can become the new old-style controller.&lt;br/&gt;
+              of the brokers can become the new old-style controller. Additionally, run&lt;br/&gt;
+              &amp;lt;code&amp;gt;get /migration&amp;lt;/code&amp;gt; followed by &amp;lt;code&amp;gt;rmr /migration&amp;lt;/code&amp;gt; to clear the&lt;br/&gt;
+              migration state from ZooKeeper. This will allow you to re-attempt the migration&lt;br/&gt;
+              in the future. The data read from &quot;/migration&quot; can be useful for debugging.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Review Comment:&lt;br/&gt;
   I file jira for it (&lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-17271&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/KAFKA-17271&lt;/a&gt;)&lt;/p&gt;


</comment>
                            <comment id="17875518" author="JIRAUSER306228" created="Wed, 21 Aug 2024 14:38:46 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ppatierno&quot; class=&quot;user-hover&quot; rel=&quot;ppatierno&quot;&gt;ppatierno&lt;/a&gt; to answer your question, the migration was rolled back the first time when the brokers were still in Zookeeper mod. To let you understand I never put in the brokers the configuration line&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
process.roles=brokers
[...]&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;and never replaced &lt;em&gt;&lt;b&gt;broker.id&lt;/b&gt;&lt;/em&gt;&#160;with &lt;em&gt;&lt;b&gt;node.id&lt;/b&gt;&lt;/em&gt;.&lt;/p&gt;

&lt;p&gt;The migration I guess at that stage was happening creating the &lt;b&gt;/migration&lt;/b&gt; node in zookeeper but yes, the brokers were still in Zookeeper mode.&lt;/p&gt;</comment>
                            <comment id="17877059" author="JIRAUSER306228" created="Tue, 27 Aug 2024 15:08:21 +0000"  >&lt;p&gt;After retrying again the full migration, this time removing the &lt;b&gt;/migration&lt;/b&gt;&#160;path in zookeeper, everything went smooth without any issue! Migration completed without problems.&lt;/p&gt;

&lt;p&gt;Thanks a lot for your help!&lt;/p&gt;</comment>
                            <comment id="17879366" author="githubbot" created="Wed, 4 Sep 2024 20:07:24 +0000"  >&lt;p&gt;mjsax commented on PR #620:&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/kafka-site/pull/620#issuecomment-2329878059&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka-site/pull/620#issuecomment-2329878059&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;   @mumrah &lt;/p&gt;</comment>
                            <comment id="17884510" author="githubbot" created="Wed, 25 Sep 2024 06:12:22 +0000"  >&lt;p&gt;ppatierno commented on PR #620:&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/kafka-site/pull/620#issuecomment-2373117334&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka-site/pull/620#issuecomment-2373117334&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;   It&apos;s still not clear to me why this removal is needed. I ran migration then rollback the migration and so on several times without the need for deleting such znode.&lt;/p&gt;

</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 6 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1qdk8:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>