<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 17:25:53 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-10515] NPE: Foreign key join serde may not be initialized with default serde if application is distributed</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-10515</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;The fix of &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-9517&quot; title=&quot;KTable Joins Without Materialized Argument Yield Results That Further Joins NPE On&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-9517&quot;&gt;&lt;del&gt;KAFKA-9517&lt;/del&gt;&lt;/a&gt; fixed the initialization of the foreign key joins serdes for KStream applications that do not run distributed over multiple instances.&lt;/p&gt;

&lt;p&gt;However, if an application runs distributed over multiple instances, the foreign key join serdes may still not be initialized leading to the following NPE:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Encountered the following error during 
processing:java.lang.NullPointerException: null
	at 
org.apache.kafka.streams.kstream.internals.foreignkeyjoin.SubscriptionWrapperSerde$SubscriptionWrapperSerializer.serialize(SubscriptionWrapperSerde.java:85)
	at 
org.apache.kafka.streams.kstream.internals.foreignkeyjoin.SubscriptionWrapperSerde$SubscriptionWrapperSerializer.serialize(SubscriptionWrapperSerde.java:52)
	at 
org.apache.kafka.streams.state.internals.ValueAndTimestampSerializer.serialize(ValueAndTimestampSerializer.java:59)
	at 
org.apache.kafka.streams.state.internals.ValueAndTimestampSerializer.serialize(ValueAndTimestampSerializer.java:50)
	at 
org.apache.kafka.streams.state.internals.ValueAndTimestampSerializer.serialize(ValueAndTimestampSerializer.java:27)
	at 
org.apache.kafka.streams.state.StateSerdes.rawValue(StateSerdes.java:192)
	at 
org.apache.kafka.streams.state.internals.MeteredKeyValueStore.lambda$put$3(MeteredKeyValueStore.java:144)
	at 
org.apache.kafka.streams.processor.internals.metrics.StreamsMetricsImpl.maybeMeasureLatency(StreamsMetricsImpl.java:806)
	at 
org.apache.kafka.streams.state.internals.MeteredKeyValueStore.put(MeteredKeyValueStore.java:144)
	at 
org.apache.kafka.streams.processor.internals.ProcessorContextImpl$KeyValueStoreReadWriteDecorator.put(ProcessorContextImpl.java:487)
	at 
org.apache.kafka.streams.kstream.internals.foreignkeyjoin.SubscriptionStoreReceiveProcessorSupplier$1.process(SubscriptionStoreReceiveProcessorSupplier.java:102)
	at 
org.apache.kafka.streams.kstream.internals.foreignkeyjoin.SubscriptionStoreReceiveProcessorSupplier$1.process(SubscriptionStoreReceiveProcessorSupplier.java:55)
	at 
org.apache.kafka.streams.processor.internals.ProcessorNode.lambda$process$2(ProcessorNode.java:142)
	at 
org.apache.kafka.streams.processor.internals.metrics.StreamsMetricsImpl.maybeMeasureLatency(StreamsMetricsImpl.java:806)
	at 
org.apache.kafka.streams.processor.internals.ProcessorNode.process(ProcessorNode.java:142)
	at 
org.apache.kafka.streams.processor.internals.ProcessorContextImpl.forward(ProcessorContextImpl.java:201)
	at 
org.apache.kafka.streams.processor.internals.ProcessorContextImpl.forward(ProcessorContextImpl.java:180)
	at 
org.apache.kafka.streams.processor.internals.ProcessorContextImpl.forward(ProcessorContextImpl.java:133)
	at 
org.apache.kafka.streams.processor.internals.SourceNode.process(SourceNode.java:104)
	at 
org.apache.kafka.streams.processor.internals.StreamTask.lambda$process$3(StreamTask.java:383)
	at 
org.apache.kafka.streams.processor.internals.metrics.StreamsMetricsImpl.maybeMeasureLatency(StreamsMetricsImpl.java:806)
	at 
org.apache.kafka.streams.processor.internals.StreamTask.process(StreamTask.java:383)
	at 
org.apache.kafka.streams.processor.internals.AssignedStreamsTasks.process(AssignedStreamsTasks.java:475)
	at 
org.apache.kafka.streams.processor.internals.TaskManager.process(TaskManager.java:550)
	at 
org.apache.kafka.streams.processor.internals.StreamThread.runOnce(StreamThread.java:802)
	at 
org.apache.kafka.streams.processor.internals.StreamThread.runLoop(StreamThread.java:697)
	at 
org.apache.kafka.streams.processor.internals.StreamThread.run(StreamThread.java:670)&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This happens because the processors for foreign key joins will be distributed across multiple tasks. The serde will only be initialized with the default serde during the initialization of the task containing the sink node (&quot;subscription-registration-sink&quot;). So if the task containing the SubscriptionStoreReceiveProcessor (&quot;subscription-receive&quot;) is not assigned to the same instance as the task containing the sink node, a NPE will be thrown because the Serde of the state store used within the SubscriptionStoreReceiveProcessor is not initialized.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13328945">KAFKA-10515</key>
            <summary>NPE: Foreign key join serde may not be initialized with default serde if application is distributed</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="thorsten.hake">Thorsten Hake</assignee>
                                    <reporter username="thorsten.hake">Thorsten Hake</reporter>
                        <labels>
                    </labels>
                <created>Wed, 23 Sep 2020 08:50:33 +0000</created>
                <updated>Thu, 12 Nov 2020 10:35:29 +0000</updated>
                            <resolved>Tue, 20 Oct 2020 23:46:51 +0000</resolved>
                                    <version>2.5.1</version>
                    <version>2.6.0</version>
                                    <fixVersion>2.6.1</fixVersion>
                    <fixVersion>2.7.0</fixVersion>
                                    <component>streams</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="17201603" author="vvcephei" created="Thu, 24 Sep 2020 15:43:18 +0000"  >&lt;p&gt;Thanks for this report, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=thorsten.hake&quot; class=&quot;user-hover&quot; rel=&quot;thorsten.hake&quot;&gt;thorsten.hake&lt;/a&gt; !&lt;/p&gt;

&lt;p&gt;I&apos;ve just taken a look at the code and the stacktrace, and I see that your explanation is spot on.&lt;/p&gt;

&lt;p&gt;I&apos;ve gone ahead and marked the ticket as a blocker for the next release in each reported version, although the release managers may push back, since this is not a regression. Still, I think we should get it fixed asap.&lt;/p&gt;

&lt;p&gt;Would you like to submit a patch for this? No pressure; I just wanted to check if you were planning on claiming this one.&lt;/p&gt;

&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;-John&lt;/p&gt;</comment>
                            <comment id="17201735" author="thorsten.hake" created="Thu, 24 Sep 2020 19:17:23 +0000"  >&lt;p&gt;@&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=vvcephei&quot; class=&quot;user-hover&quot; rel=&quot;vvcephei&quot;&gt;vvcephei&lt;/a&gt; I would like to submit a patch. Thanks for asking &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="17201913" author="thorsten.hake" created="Fri, 25 Sep 2020 05:10:22 +0000"  >&lt;p&gt;I just submitted a PR for the trunk branch: &lt;a href=&quot;https://github.com/apache/kafka/pull/9338&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/9338&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17211170" author="vvcephei" created="Fri, 9 Oct 2020 16:55:17 +0000"  >&lt;p&gt;Thanks for the patch &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=thorsten.hake&quot; class=&quot;user-hover&quot; rel=&quot;thorsten.hake&quot;&gt;thorsten.hake&lt;/a&gt; ! I&apos;ll review it as soon as I can.&lt;/p&gt;

&lt;p&gt;By the way, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=bbejeck&quot; class=&quot;user-hover&quot; rel=&quot;bbejeck&quot;&gt;bbejeck&lt;/a&gt; is working on the release now and is following up on all blockers. I downgraded this to &quot;critical&quot; just because it doesn&apos;t meet the criteria of either being a regression in 2.7.0 or having a really destructive effect.&lt;/p&gt;

&lt;p&gt;I absolutely want to get it in to 2.7.0, though.&lt;/p&gt;

&lt;p&gt;Thanks!&lt;/p&gt;</comment>
                            <comment id="17218008" author="bbejeck" created="Tue, 20 Oct 2020 23:46:51 +0000"  >&lt;p&gt;Resolved via&#160;&lt;a href=&quot;https://github.com/apache/kafka/pull/9338&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/9338&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Merged to trunk and cherry-picked to 2.7&lt;/p&gt;</comment>
                            <comment id="17218346" author="vvcephei" created="Wed, 21 Oct 2020 15:25:39 +0000"  >&lt;p&gt;Removed the 2.6 and 2.5 fix versions until &lt;a href=&quot;https://github.com/apache/kafka/pull/9467&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/9467&lt;/a&gt; is merged and picked.&lt;/p&gt;</comment>
                            <comment id="17225532" author="vvcephei" created="Tue, 3 Nov 2020 16:33:03 +0000"  >&lt;p&gt;&lt;a href=&quot;https://github.com/apache/kafka/pull/9467&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/9467&lt;/a&gt; is merged to 2.6. There were also merge conflicts on 2.5, but there&apos;s no bugfix release proposed for 2.5 yet, so I decided just to leave it at 2.6/2.7/trunk.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13283769">KAFKA-9517</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 2 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0iu7c:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>