<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 16:57:47 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-4387] KafkaConsumer will enter an infinite loop if the polling thread is interrupted, and either commitSync or committed is called</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-4387</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;When the KafkaConsumer.commitSync method is called, the ConsumerNetworkClient.poll(RequestFuture&amp;lt;?&amp;gt; future) method will be called with a future that only finishes when the commit request completes, or the request times out.&lt;/p&gt;

&lt;p&gt;When the calling thread is interrupted, every call to the Selector underlying the ConsumerNetworkClient will return immediately, while thread interrupt state is not reset. The call to poll ends up looping until the request timeout, at which point it drops back out to ConsumerCoordinator.commitOffsetsSync which retries the request because TimeoutException is retriable. This repeats indefinitely. &lt;/p&gt;

&lt;p&gt;For the same reason as in &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-4375&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/KAFKA-4375&lt;/a&gt;, it is good if the KafkaConsumer can handle interrupts in a reasonable way, rather than having wakeup() be the only way to properly stop a consumer thread.&lt;/p&gt;

&lt;p&gt;I think making ConsumerNetworkClient.maybeTriggerWakeup() throw a WakeupException if the calling thread is interrupted makes sense, since an interrupted thread won&apos;t be making progress in polling due to the way Selector works, and KafkaConsumer users then don&apos;t have to handle wakeups and interrupts separately.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13018909">KAFKA-4387</key>
            <summary>KafkaConsumer will enter an infinite loop if the polling thread is interrupted, and either commitSync or committed is called</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="srdo">Stig Rohde D&#248;ssing</assignee>
                                    <reporter username="srdo">Stig Rohde D&#248;ssing</reporter>
                        <labels>
                    </labels>
                <created>Mon, 7 Nov 2016 17:54:21 +0000</created>
                <updated>Wed, 30 Nov 2016 04:22:26 +0000</updated>
                            <resolved>Wed, 30 Nov 2016 04:22:25 +0000</resolved>
                                    <version>0.10.0.1</version>
                                    <fixVersion>0.10.2.0</fixVersion>
                                    <component>clients</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="15644913" author="hachikuji" created="Mon, 7 Nov 2016 18:11:32 +0000"  >&lt;p&gt;I think it&apos;s reasonable to have KafkaConsumer handle interrupts, but it seems confusing to mix the behavior with wakeup(). It&apos;s not that much effort to handle both of them (especially with Java 7 multiple exception catching) and some users may really want to treat them differently. We already have &lt;tt&gt;org.apache.kafka.common.errors.InterruptException&lt;/tt&gt; which is raised from KafkaProducer, so maybe we could use it instead?&lt;/p&gt;</comment>
                            <comment id="15644936" author="srdo" created="Mon, 7 Nov 2016 18:19:07 +0000"  >&lt;p&gt;Fine by me. I&apos;ll make a PR for it shortly&lt;/p&gt;</comment>
                            <comment id="15645113" author="githubbot" created="Mon, 7 Nov 2016 19:14:06 +0000"  >&lt;p&gt;GitHub user srdo opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/2110&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/2110&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-4387&quot; title=&quot;KafkaConsumer will enter an infinite loop if the polling thread is interrupted, and either commitSync or committed is called&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-4387&quot;&gt;&lt;del&gt;KAFKA-4387&lt;/del&gt;&lt;/a&gt;: Fix KafkaConsumer not responding correctly to interrupts,&#8230;&lt;/p&gt;

&lt;p&gt;    ... throw InterruptException from blocking methods when interrupted&lt;/p&gt;

&lt;p&gt;    See &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-4387&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/KAFKA-4387&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/srdo/kafka&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/srdo/kafka&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-4387&quot; title=&quot;KafkaConsumer will enter an infinite loop if the polling thread is interrupted, and either commitSync or committed is called&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-4387&quot;&gt;&lt;del&gt;KAFKA-4387&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/2110.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/2110.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #2110&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit a3b8303bf33c24eb51130e1a4d1cd7d17771fecd&lt;br/&gt;
Author: Stig Rohde D&#248;ssing &amp;lt;sdo@it-minds.dk&amp;gt;&lt;br/&gt;
Date:   2016-11-07T19:09:22Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-4387&quot; title=&quot;KafkaConsumer will enter an infinite loop if the polling thread is interrupted, and either commitSync or committed is called&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-4387&quot;&gt;&lt;del&gt;KAFKA-4387&lt;/del&gt;&lt;/a&gt;: Fix KafkaConsumer not responding correctly to interrupts, throw InterruptException from blocking methods when interrupted&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15707489" author="githubbot" created="Wed, 30 Nov 2016 04:22:15 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/2110&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/2110&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15707490" author="hachikuji" created="Wed, 30 Nov 2016 04:22:26 +0000"  >&lt;p&gt;Issue resolved by pull request 2110&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/kafka/pull/2110&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/2110&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12769708">KAFKA-1894</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 50 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i360mf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>