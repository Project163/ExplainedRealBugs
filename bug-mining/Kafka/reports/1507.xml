<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 17:01:27 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-5150] LZ4 decompression is 4-5x slower than Snappy on small batches / messages</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-5150</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;I benchmarked RecordsIteratorDeepRecordsIterator instantiation on small batch sizes with small messages after observing some performance bottlenecks in the consumer. &lt;/p&gt;

&lt;p&gt;For batch sizes of 1 with messages of 100 bytes, LZ4 heavily underperforms compared to Snappy (see benchmark below). Most of our time is currently spent allocating memory blocks in KafkaLZ4BlockInputStream, due to the fact that we default to larger 64kB block sizes. Some quick testing shows we could improve performance by almost an order of magnitude for small batches and messages if we re-used buffers between instantiations of the input stream.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/xvrl/kafka/blob/small-batch-lz4-benchmark/clients/src/test/java/org/apache/kafka/common/record/DeepRecordsIteratorBenchmark.java#L86&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Benchmark Code&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Benchmark                                              (compressionType)  (messageSize)   Mode  Cnt       Score       Error  Units
DeepRecordsIteratorBenchmark.measureSingleMessage                    LZ4            100  thrpt   20   84802.279 &#177;  1983.847  ops/s
DeepRecordsIteratorBenchmark.measureSingleMessage                 SNAPPY            100  thrpt   20  407585.747 &#177;  9877.073  ops/s
DeepRecordsIteratorBenchmark.measureSingleMessage                   NONE            100  thrpt   20  579141.634 &#177; 18482.093  ops/s
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13068279">KAFKA-5150</key>
            <summary>LZ4 decompression is 4-5x slower than Snappy on small batches / messages</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="xvrl">Xavier L&#233;aut&#233;</assignee>
                                    <reporter username="xvrl">Xavier L&#233;aut&#233;</reporter>
                        <labels>
                    </labels>
                <created>Mon, 1 May 2017 23:44:34 +0000</created>
                <updated>Sat, 3 Jun 2017 01:08:54 +0000</updated>
                            <resolved>Thu, 1 Jun 2017 19:05:50 +0000</resolved>
                                    <version>0.8.2.2</version>
                    <version>0.9.0.1</version>
                    <version>0.10.2.1</version>
                    <version>0.11.0.0</version>
                                    <fixVersion>0.10.2.2</fixVersion>
                    <fixVersion>0.11.0.0</fixVersion>
                                    <component>consumer</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="15995673" author="githubbot" created="Wed, 3 May 2017 21:00:51 +0000"  >&lt;p&gt;GitHub user xvrl opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/2967&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/2967&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-5150&quot; title=&quot;LZ4 decompression is 4-5x slower than Snappy on small batches / messages&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-5150&quot;&gt;&lt;del&gt;KAFKA-5150&lt;/del&gt;&lt;/a&gt; reduce lz4 decompression overhead&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;reuse decompression buffers, keeping one per thread&lt;/li&gt;
	&lt;li&gt;switch lz4 input stream to operate directly on ByteBuffers&lt;/li&gt;
	&lt;li&gt;more tests with both compressible / incompressible data, multiple&lt;br/&gt;
      blocks, and various other combinations to increase code coverage&lt;/li&gt;
	&lt;li&gt;fixes bug that would cause EOFException instead of invalid block size&lt;br/&gt;
      for invalid incompressible blocks&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    Overall this improves LZ4 decompression performance by up to 23x for small batches.&lt;br/&gt;
    Most improvements are seen for batches of size 1 with messages on the order of ~100B.&lt;br/&gt;
    At least 10x improvements for for batch sizes of &amp;lt; 10 messages, with messages of &amp;lt; 10kB&lt;/p&gt;

&lt;p&gt;    See benchmark code and results here&lt;br/&gt;
    &lt;a href=&quot;https://gist.github.com/xvrl/05132e0643513df4adf842288be86efd&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gist.github.com/xvrl/05132e0643513df4adf842288be86efd&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/xvrl/kafka&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/xvrl/kafka&lt;/a&gt; kafka-5150&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/2967.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/2967.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #2967&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 0efc6e7f15b6994a6665da5975e69c77426cf904&lt;br/&gt;
Author: Xavier L&#233;aut&#233; &amp;lt;xavier@confluent.io&amp;gt;&lt;br/&gt;
Date:   2017-05-03T20:40:45Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-5150&quot; title=&quot;LZ4 decompression is 4-5x slower than Snappy on small batches / messages&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-5150&quot;&gt;&lt;del&gt;KAFKA-5150&lt;/del&gt;&lt;/a&gt; reduce lz4 decompression overhead&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;reuse decompression buffers, keeping one per thread&lt;/li&gt;
	&lt;li&gt;switch lz4 input stream to operate directly on ByteBuffers&lt;/li&gt;
	&lt;li&gt;more tests with both compressible / incompressible data, multiple&lt;br/&gt;
      blocks, and various other combinations to increase code coverage&lt;/li&gt;
	&lt;li&gt;fixes bug that would cause EOFException instead of invalid block size&lt;br/&gt;
      for invalid incompressible blocks&lt;/li&gt;
&lt;/ul&gt;


&lt;hr /&gt;</comment>
                            <comment id="15998617" author="xvrl" created="Fri, 5 May 2017 17:25:33 +0000"  >&lt;p&gt;I expanded the patch for this issue to also address the &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-4293&quot; title=&quot;ByteBufferMessageSet.deepIterator burns CPU catching EOFExceptions&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-4293&quot;&gt;KAFKA-4293&lt;/a&gt; and improve performance by up to 3x for legacy single message batches for other compression formats as well.&lt;/p&gt;</comment>
                            <comment id="15999059" author="xvrl" created="Fri, 5 May 2017 22:27:09 +0000"  >&lt;p&gt;I also have a versions of the same patch for 0.10.2.x in case someone is interested, or if we decide to do another 0.10.2.x release.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/kafka/compare/0.10.2...xvrl:kafka-5150-0.10?expand=1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/compare/0.10.2...xvrl:kafka-5150-0.10?expand=1&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16016146" author="githubbot" created="Thu, 18 May 2017 17:42:44 +0000"  >&lt;p&gt;GitHub user xvrl opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/3090&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/3090&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-5150&quot; title=&quot;LZ4 decompression is 4-5x slower than Snappy on small batches / messages&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-5150&quot;&gt;&lt;del&gt;KAFKA-5150&lt;/del&gt;&lt;/a&gt; reduce lz4 decompression overhead - Backport to 0.10.2.x&lt;/p&gt;



&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/xvrl/kafka&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/xvrl/kafka&lt;/a&gt; kafka-5150-0.10&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/3090.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/3090.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #3090&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 265ee89ec76b223eb97c6b364260443346e6dac1&lt;br/&gt;
Author: Xavier L&#233;aut&#233; &amp;lt;xavier@confluent.io&amp;gt;&lt;br/&gt;
Date:   2017-05-03T17:03:44Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-5150&quot; title=&quot;LZ4 decompression is 4-5x slower than Snappy on small batches / messages&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-5150&quot;&gt;&lt;del&gt;KAFKA-5150&lt;/del&gt;&lt;/a&gt; reduce lz4 decompression overhead&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;reuse decompression buffers, keeping one per thread&lt;/li&gt;
	&lt;li&gt;switch lz4 input stream to operate directly on ByteBuffers&lt;/li&gt;
	&lt;li&gt;more tests with both compressible / incompressible data, multiple&lt;br/&gt;
      blocks, and various other combinations to increase code coverage&lt;/li&gt;
	&lt;li&gt;fixes bug that would cause EOFException instead of invalid block size&lt;br/&gt;
      for invalid incompressible blocks&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;commit cef091d0353a8a1f45ac913750f1e0dba04d7ab1&lt;br/&gt;
Author: Xavier L&#233;aut&#233; &amp;lt;xavier@confluent.io&amp;gt;&lt;br/&gt;
Date:   2017-05-05T22:18:55Z&lt;/p&gt;

&lt;p&gt;    avoid exception when reaching end of batch&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="16028559" author="githubbot" created="Mon, 29 May 2017 18:44:23 +0000"  >&lt;p&gt;GitHub user ijuma opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/3164&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/3164&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-5150&quot; title=&quot;LZ4 decompression is 4-5x slower than Snappy on small batches / messages&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-5150&quot;&gt;&lt;del&gt;KAFKA-5150&lt;/del&gt;&lt;/a&gt;: Reduce lz4 decompression overhead (without thread local buffers)&lt;/p&gt;

&lt;p&gt;    Temporary PR that has additional changes over &lt;a href=&quot;https://github.com/apache/kafka/pull/2967&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/2967&lt;/a&gt; for comparison.&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/ijuma/kafka&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/ijuma/kafka&lt;/a&gt; kafka-5150-reduce-lz4-decompression-overhead&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/3164.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/3164.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #3164&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 950858e7fae838aecbf31c1ea201c3dbcd67a91d&lt;br/&gt;
Author: Xavier L&#233;aut&#233; &amp;lt;xavier@confluent.io&amp;gt;&lt;br/&gt;
Date:   2017-05-03T17:01:07Z&lt;/p&gt;

&lt;p&gt;    small batch decompression benchmark&lt;/p&gt;

&lt;p&gt;commit 0177665f3321e101ccbb2e95ec724125bf784e1c&lt;br/&gt;
Author: Xavier L&#233;aut&#233; &amp;lt;xavier@confluent.io&amp;gt;&lt;br/&gt;
Date:   2017-05-03T20:40:45Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-5150&quot; title=&quot;LZ4 decompression is 4-5x slower than Snappy on small batches / messages&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-5150&quot;&gt;&lt;del&gt;KAFKA-5150&lt;/del&gt;&lt;/a&gt; reduce lz4 decompression overhead&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;reuse decompression buffers, keeping one per thread&lt;/li&gt;
	&lt;li&gt;switch lz4 input stream to operate directly on ByteBuffers&lt;/li&gt;
	&lt;li&gt;more tests with both compressible / incompressible data, multiple&lt;br/&gt;
      blocks, and various other combinations to increase code coverage&lt;/li&gt;
	&lt;li&gt;fixes bug that would cause EOFException instead of invalid block size&lt;br/&gt;
      for invalid incompressible blocks&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;commit 7b553afdd7a6a7d39b122c503cd643b915b9f556&lt;br/&gt;
Author: Xavier L&#233;aut&#233; &amp;lt;xavier@confluent.io&amp;gt;&lt;br/&gt;
Date:   2017-05-04T17:26:52Z&lt;/p&gt;

&lt;p&gt;    remove unnecessary synchronized on reset/mark&lt;/p&gt;

&lt;p&gt;commit b4c46ac15aa25e2c8ea6bb9392d700b02b61fccd&lt;br/&gt;
Author: Xavier L&#233;aut&#233; &amp;lt;xavier@confluent.io&amp;gt;&lt;br/&gt;
Date:   2017-05-05T16:00:49Z&lt;/p&gt;

&lt;p&gt;    avoid exception when reaching end of batch&lt;/p&gt;

&lt;p&gt;commit 77e1a1d47f9060430257821704045353ec77a8d0&lt;br/&gt;
Author: Xavier L&#233;aut&#233; &amp;lt;xavier@confluent.io&amp;gt;&lt;br/&gt;
Date:   2017-05-18T16:47:01Z&lt;/p&gt;

&lt;p&gt;    remove reflection for LZ4 and add comments&lt;/p&gt;

&lt;p&gt;commit e3b68668b6b2e0057bcd9a3de24ab8fce774d8d5&lt;br/&gt;
Author: Ismael Juma &amp;lt;ismael@juma.me.uk&amp;gt;&lt;br/&gt;
Date:   2017-05-26T15:45:13Z&lt;/p&gt;

&lt;p&gt;    Simplify DataLogInputStream.nextBatch&lt;/p&gt;

&lt;p&gt;commit 213bb77b8a3862a325118492d658a4e58ffd3c29&lt;br/&gt;
Author: Ismael Juma &amp;lt;ismael@juma.me.uk&amp;gt;&lt;br/&gt;
Date:   2017-05-26T15:56:16Z&lt;/p&gt;

&lt;p&gt;    Minor comment improvement&lt;/p&gt;

&lt;p&gt;commit 9bd10361d70de837ccb58a82b356b402d28bb94f&lt;br/&gt;
Author: Ismael Juma &amp;lt;ismael@juma.me.uk&amp;gt;&lt;br/&gt;
Date:   2017-05-29T14:18:13Z&lt;/p&gt;

&lt;p&gt;    Minor tweaks in `DefaultRecord.readFrom`&lt;/p&gt;

&lt;p&gt;commit 178d4900a6c848a4f1b0aa0ae68aaa24885f36bc&lt;br/&gt;
Author: Ismael Juma &amp;lt;ismael@juma.me.uk&amp;gt;&lt;br/&gt;
Date:   2017-05-29T15:22:01Z&lt;/p&gt;

&lt;p&gt;    Cache decompression buffers in Fetcher instead of thread-locals&lt;/p&gt;

&lt;p&gt;    This means that this only benefits the consumer for now, which&lt;br/&gt;
    is the most important case. For the server, we should consider&lt;br/&gt;
    how this fits with KIP-72.&lt;/p&gt;

&lt;p&gt;commit c10b310cc13f5ec110cbaed8fb72f24774c2a2cd&lt;br/&gt;
Author: Ismael Juma &amp;lt;ismael@juma.me.uk&amp;gt;&lt;br/&gt;
Date:   2017-05-29T15:23:19Z&lt;/p&gt;

&lt;p&gt;    Tweaks to `KafkaLZ4*Stream` classes and `RecordBatchIterationBenchmark&lt;/p&gt;

&lt;p&gt;commit d93444c147430a62f5e9d16492ad14d2c6a0dd38&lt;br/&gt;
Author: Ismael Juma &amp;lt;ismael@juma.me.uk&amp;gt;&lt;br/&gt;
Date:   2017-05-29T18:18:23Z&lt;/p&gt;

&lt;p&gt;    Trivial style tweaks to KafkaLZ4Test&lt;/p&gt;

&lt;p&gt;commit 419500e848b943f20d9bce1790fe40e64080ae29&lt;br/&gt;
Author: Ismael Juma &amp;lt;ismael@juma.me.uk&amp;gt;&lt;br/&gt;
Date:   2017-05-29T18:38:55Z&lt;/p&gt;

&lt;p&gt;    Provide a `NO_CACHING` BufferSupplier&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="16030291" author="githubbot" created="Tue, 30 May 2017 22:42:39 +0000"  >&lt;p&gt;Github user ijuma closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/3164&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/3164&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16030468" author="githubbot" created="Wed, 31 May 2017 01:21:47 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/2967&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/2967&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16031486" author="githubbot" created="Wed, 31 May 2017 16:42:12 +0000"  >&lt;p&gt;GitHub user xvrl opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/3180&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/3180&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    MINOR: reuse decompression buffers in log cleaner&lt;/p&gt;

&lt;p&gt;    follow-up to &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-5150&quot; title=&quot;LZ4 decompression is 4-5x slower than Snappy on small batches / messages&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-5150&quot;&gt;&lt;del&gt;KAFKA-5150&lt;/del&gt;&lt;/a&gt;, reuse decompression buffers in the log cleaner thread.&lt;/p&gt;

&lt;p&gt;    @ijuma @hachikuji &lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/xvrl/kafka&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/xvrl/kafka&lt;/a&gt; logcleaner-decompression-buffers&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/3180.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/3180.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #3180&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit d37ef9dfe118ec62b4091a4db72558ccbe888fb8&lt;br/&gt;
Author: Xavier L&#233;aut&#233; &amp;lt;xavier@confluent.io&amp;gt;&lt;br/&gt;
Date:   2017-05-31T16:24:15Z&lt;/p&gt;

&lt;p&gt;    MINOR: reuse decompression buffers in log cleaner&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="16033501" author="ijuma" created="Thu, 1 Jun 2017 19:05:50 +0000"  >&lt;p&gt;Issue resolved by pull request 3090&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/kafka/pull/3090&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/3090&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16033516" author="githubbot" created="Thu, 1 Jun 2017 19:15:25 +0000"  >&lt;p&gt;Github user xvrl closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/3090&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/3090&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16035737" author="githubbot" created="Sat, 3 Jun 2017 01:08:54 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/3180&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/3180&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13011509">KAFKA-4293</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 24 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3ecan:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>