<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 16:53:27 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-3219] Long topic names mess up broker topic state</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-3219</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;Seems like the broker doesn&apos;t like topic names of 254 chars or more when creating using kafka-topics.sh --create.&lt;br/&gt;
The problem does not seem to arise when topic is created through automatic topic creation.&lt;/p&gt;

&lt;p&gt;How to reproduce:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;TOPIC=$(printf &lt;span class=&quot;code-quote&quot;&gt;&apos;d%.0s&apos;&lt;/span&gt; {1..254} ) ; bin/kafka-topics.sh --zookeeper 0 --create --topic $TOPIC --partitions 1 --replication-factor 1
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;[2016-02-06 22:00:01,943] INFO [ReplicaFetcherManager on broker 3] Removed fetcher &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; partitions [dddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd,0] (kafka.server.ReplicaFetcherManager)
[2016-02-06 22:00:01,944] ERROR [KafkaApi-3] Error when handling request {controller_id=3,controller_epoch=12,partition_states=[{topic=dddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd,partition=0,controller_epoch=12,leader=3,leader_epoch=0,isr=[3],zk_version=0,replicas=[3]}],live_leaders=[{id=3,host=eden,port=9093}]} (kafka.server.KafkaApis)
java.lang.NullPointerException
        at scala.collection.mutable.ArrayOps$ofRef$.length$extension(ArrayOps.scala:114)
        at scala.collection.mutable.ArrayOps$ofRef.length(ArrayOps.scala:114)
        at scala.collection.IndexedSeqOptimized$&lt;span class=&quot;code-keyword&quot;&gt;class.&lt;/span&gt;foreach(IndexedSeqOptimized.scala:32)
        at scala.collection.mutable.ArrayOps$ofRef.foreach(ArrayOps.scala:108)
        at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:771)
        at kafka.log.Log.loadSegments(Log.scala:138)
        at kafka.log.Log.&amp;lt;init&amp;gt;(Log.scala:92)
        at kafka.log.LogManager.createLog(LogManager.scala:357)
        at kafka.cluster.Partition.getOrCreateReplica(Partition.scala:96)
        at kafka.cluster.Partition$$anonfun$4$$anonfun$apply$2.apply(Partition.scala:176)
        at kafka.cluster.Partition$$anonfun$4$$anonfun$apply$2.apply(Partition.scala:176)
        at scala.collection.mutable.HashSet.foreach(HashSet.scala:79)
        at kafka.cluster.Partition$$anonfun$4.apply(Partition.scala:176)
        at kafka.cluster.Partition$$anonfun$4.apply(Partition.scala:170)
        at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:259)
        at kafka.utils.CoreUtils$.inWriteLock(CoreUtils.scala:267)
        at kafka.cluster.Partition.makeLeader(Partition.scala:170)
        at kafka.server.ReplicaManager$$anonfun$makeLeaders$4.apply(ReplicaManager.scala:696)
        at kafka.server.ReplicaManager$$anonfun$makeLeaders$4.apply(ReplicaManager.scala:695)
        at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
        at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
        at scala.collection.mutable.HashTable$&lt;span class=&quot;code-keyword&quot;&gt;class.&lt;/span&gt;foreachEntry(HashTable.scala:226)
        at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:39)
        at scala.collection.mutable.HashMap.foreach(HashMap.scala:98)
        at kafka.server.ReplicaManager.makeLeaders(ReplicaManager.scala:695)
        at kafka.server.ReplicaManager.becomeLeaderOrFollower(ReplicaManager.scala:641)
        at kafka.server.KafkaApis.handleLeaderAndIsrRequest(KafkaApis.scala:142)
        at kafka.server.KafkaApis.handle(KafkaApis.scala:79)
        at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
        at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:745)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12937470">KAFKA-3219</key>
            <summary>Long topic names mess up broker topic state</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="vahid">Vahid Hashemian</assignee>
                                    <reporter username="edenhill">Magnus Edenhill</reporter>
                        <labels>
                    </labels>
                <created>Mon, 8 Feb 2016 11:20:13 +0000</created>
                <updated>Fri, 10 Mar 2017 23:01:34 +0000</updated>
                            <resolved>Sat, 21 May 2016 03:57:14 +0000</resolved>
                                    <version>0.9.0.0</version>
                                    <fixVersion>0.10.0.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="15137518" author="vahid" created="Mon, 8 Feb 2016 19:27:18 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=edenhill&quot; class=&quot;user-hover&quot; rel=&quot;edenhill&quot;&gt;edenhill&lt;/a&gt; I tried the same command above on 0.9.0.0 release and could reproduce the problem. However, when I tried it on the trunk branch it worked fine. It seems it is fixed (perhaps along with some other defect). Could you please double check?&lt;/p&gt;</comment>
                            <comment id="15137686" author="vahid" created="Mon, 8 Feb 2016 21:08:13 +0000"  >&lt;p&gt;My apologies. I tried again, and noticed the null pointer exception in server.log. The topic is created though. This is the case for lengths 254 and 255.&lt;/p&gt;</comment>
                            <comment id="15137981" author="vahid" created="Mon, 8 Feb 2016 23:21:58 +0000"  >&lt;p&gt;This seems to be somehow related to folder name length limit which is 255.&lt;br/&gt;
When creating a topic a folder is created for each of its partitions under the &lt;tt&gt;kafka-logs&lt;/tt&gt; folder. The name of these folders is the topic name appended by a dash &lt;tt&gt;-&lt;/tt&gt;, appended by partition id (a number starting from 0). For a given topic name of 254, these folder names will be at least 256 characters long. Even though the topic is created no folder is created for partitions whose folder name length goes above 255. With a topic name of 253 characters long and 11 partitions the same issue occurs because for partition id 10 the folder would not be created.&lt;/p&gt;

&lt;p&gt;A potential fix would be to check for the combination of topic name and partition count and disallow combinations that lead to one or more partition folder names of 256 or more characters.&lt;/p&gt;

&lt;p&gt;Suggestions are welcome.&lt;/p&gt;</comment>
                            <comment id="15137998" author="ijuma" created="Mon, 8 Feb 2016 23:31:32 +0000"  >&lt;p&gt;Seems sensible to fail with a reasonable error if someone attempts to create a topic with a name that is too long. The original description says that this works fine with automatic topic creation. Is that really true?&lt;/p&gt;</comment>
                            <comment id="15138080" author="vahid" created="Tue, 9 Feb 2016 00:04:03 +0000"  >&lt;p&gt;I see similar behavior when producing a new topic of length 254. As soon as I send the first message to the topic I see the same exception in the log. Again the topic is there when I try a &lt;tt&gt;--list&lt;/tt&gt; option, but no partition folder is created for it. Consuming from the topic will also lead to errors.&lt;/p&gt;</comment>
                            <comment id="15138083" author="ijuma" created="Tue, 9 Feb 2016 00:05:18 +0000"  >&lt;p&gt;Makes sense, thanks.&lt;/p&gt;</comment>
                            <comment id="15141117" author="githubbot" created="Wed, 10 Feb 2016 16:41:55 +0000"  >&lt;p&gt;GitHub user vahidhashemian opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/898&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/898&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-3219&quot; title=&quot;Long topic names mess up broker topic state&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-3219&quot;&gt;&lt;del&gt;KAFKA-3219&lt;/del&gt;&lt;/a&gt;: Fix long topic name validation&lt;/p&gt;

&lt;p&gt;    This fixes an issue with long topic names by considering, during topic&lt;br/&gt;
    validation, the &apos;-&apos; and the partition id that is appended to the log&lt;br/&gt;
    folder created for each topic partition.&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/vahidhashemian/kafka&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/vahidhashemian/kafka&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-3219&quot; title=&quot;Long topic names mess up broker topic state&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-3219&quot;&gt;&lt;del&gt;KAFKA-3219&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/898.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/898.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #898&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 413f1f657b810032c94c8d59908e4bc5e39c26fe&lt;br/&gt;
Author: Vahid Hashemian &amp;lt;vahidhashemian@us.ibm.com&amp;gt;&lt;br/&gt;
Date:   2016-02-10T16:37:35Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-3219&quot; title=&quot;Long topic names mess up broker topic state&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-3219&quot;&gt;&lt;del&gt;KAFKA-3219&lt;/del&gt;&lt;/a&gt;: Fix long topic name validation&lt;/p&gt;

&lt;p&gt;    This fixes an issue with long topic names by considering, during topic&lt;br/&gt;
    validation, the &apos;-&apos; and the partition id that is appended to the log&lt;br/&gt;
    folder created for each topic partition.&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15207184" author="gwenshap" created="Tue, 22 Mar 2016 20:10:34 +0000"  >&lt;p&gt;Issue resolved by pull request 898&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/kafka/pull/898&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/898&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15207185" author="githubbot" created="Tue, 22 Mar 2016 20:10:34 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/898&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/898&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13048765">KAFKA-4858</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 34 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2sjtr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>