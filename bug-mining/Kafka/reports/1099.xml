<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 16:54:55 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-3840] OS auto tuning for socket buffer size in clients not allowed through configuration</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-3840</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-724&quot; title=&quot;Allow automatic socket.send.buffer from operating system&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-724&quot;&gt;&lt;del&gt;KAFKA-724&lt;/del&gt;&lt;/a&gt; added the following documentation for clients in order to provide OS auto tuning of socket buffer sizes:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;diff --git a/clients/src/main/java/org/apache/kafka/clients/CommonClientConfigs.java b/clients/src/main/java/org/apache/kafka/clients/CommonClientConfigs.java
index 750b8a1..3327815 100644
--- a/clients/src/main/java/org/apache/kafka/clients/CommonClientConfigs.java
+++ b/clients/src/main/java/org/apache/kafka/clients/CommonClientConfigs.java
@@ -43,10 +43,10 @@
     public static final String METADATA_MAX_AGE_DOC = &quot;The period of time in milliseconds after which we force a refresh of metadata even if we haven&apos;t seen any partition leadership changes to proactively discover any new brokers or partitions.&quot;;
 
     public static final String SEND_BUFFER_CONFIG = &quot;send.buffer.bytes&quot;;
-    public static final String SEND_BUFFER_DOC = &quot;The size of the TCP send buffer (SO_SNDBUF) to use when sending data.&quot;;
+    public static final String SEND_BUFFER_DOC = &quot;The size of the TCP send buffer (SO_SNDBUF) to use when sending data. If the value is -1, the OS default will be used.&quot;;
 
     public static final String RECEIVE_BUFFER_CONFIG = &quot;receive.buffer.bytes&quot;;
-    public static final String RECEIVE_BUFFER_DOC = &quot;The size of the TCP receive buffer (SO_RCVBUF) to use when reading data.&quot;;
+    public static final String RECEIVE_BUFFER_DOC = &quot;The size of the TCP receive buffer (SO_RCVBUF) to use when reading data. If the value is -1, the OS default will be used.&quot;;
 
     public static final String CLIENT_ID_CONFIG = &quot;client.id&quot;;
     public static final String CLIENT_ID_DOC = &quot;An id string to pass to the server when making requests. The purpose of this is to be able to track the source of requests beyond just ip/port by allowing a logical application name to be included in server-side request logging.&quot;;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Unfortunately, the value &lt;tt&gt;-1&lt;/tt&gt; is not allowed for clients configuration and the following exception is thrown:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Exception in thread &quot;main&quot; org.apache.kafka.common.config.ConfigException: Invalid value -1 for configuration receive.buffer.bytes: Value must be at least 0
    at org.apache.kafka.common.config.ConfigDef$Range.ensureValid(ConfigDef.java:308)
    at org.apache.kafka.common.config.ConfigDef.parse(ConfigDef.java:153)
    at org.apache.kafka.common.config.AbstractConfig.&amp;lt;init&amp;gt;(AbstractConfig.java:49)
    at org.apache.kafka.common.config.AbstractConfig.&amp;lt;init&amp;gt;(AbstractConfig.java:56)
    at org.apache.kafka.clients.producer.ProducerConfig.&amp;lt;init&amp;gt;(ProducerConfig.java:315)
    at org.apache.kafka.clients.producer.KafkaProducer.&amp;lt;init&amp;gt;(KafkaProducer.java:156)
    ...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This is caused by an &lt;tt&gt;atLeast(0)&lt;/tt&gt; validation in &lt;tt&gt;ProducerConfig.java&lt;/tt&gt; and &lt;tt&gt;ConsumerConfig.java&lt;/tt&gt;::&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;...
  .define(SEND_BUFFER_CONFIG, Type.INT, 128 * 1024, atLeast(0), Importance.MEDIUM, CommonClientConfigs.SEND_BUFFER_DOC)
  .define(RECEIVE_BUFFER_CONFIG, Type.INT, 32 * 1024, atLeast(0), Importance.MEDIUM, CommonClientConfigs.RECEIVE_BUFFER_DOC)
...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Note that the broker configuration for OS auto tuning is fine as there is no such checks in &lt;tt&gt;KafkaConfig.scala&lt;/tt&gt;.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12979178">KAFKA-3840</key>
            <summary>OS auto tuning for socket buffer size in clients not allowed through configuration</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="yabon">S&#233;bastien Launay</reporter>
                        <labels>
                    </labels>
                <created>Tue, 14 Jun 2016 22:27:34 +0000</created>
                <updated>Thu, 16 Jun 2016 12:39:22 +0000</updated>
                            <resolved>Thu, 16 Jun 2016 12:39:21 +0000</resolved>
                                                    <fixVersion>0.10.1.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="15330781" author="githubbot" created="Tue, 14 Jun 2016 22:33:06 +0000"  >&lt;p&gt;GitHub user slaunay opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/1507&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/1507&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-3840&quot; title=&quot;OS auto tuning for socket buffer size in clients not allowed through configuration&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-3840&quot;&gt;&lt;del&gt;KAFKA-3840&lt;/del&gt;&lt;/a&gt;; Allow clients default OS buffer sizes&lt;/p&gt;

&lt;p&gt;    Follow up on &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-724&quot; title=&quot;Allow automatic socket.send.buffer from operating system&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-724&quot;&gt;&lt;del&gt;KAFKA-724&lt;/del&gt;&lt;/a&gt; (#1469) to allow OS socket buffer sizes auto tuning for both the broker and the clients.&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/slaunay/kafka&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/slaunay/kafka&lt;/a&gt; enhancement/os-socket-buffer-size-tuning-for-clients&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/1507.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/1507.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #1507&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 3673696b5c3a6841f13cf13fdc77fb44ebb9b0e0&lt;br/&gt;
Author: Sebastien Launay &amp;lt;sebastien@opendns.com&amp;gt;&lt;br/&gt;
Date:   2016-06-14T22:28:20Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-3840&quot; title=&quot;OS auto tuning for socket buffer size in clients not allowed through configuration&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-3840&quot;&gt;&lt;del&gt;KAFKA-3840&lt;/del&gt;&lt;/a&gt;; Allow clients default OS buffer sizes&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15333684" author="githubbot" created="Thu, 16 Jun 2016 12:35:37 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/1507&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/1507&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15333696" author="ijuma" created="Thu, 16 Jun 2016 12:39:22 +0000"  >&lt;p&gt;Issue resolved by pull request 1507&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/kafka/pull/1507&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/1507&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310250" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10430"><![CDATA[Patch]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 22 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2zgrj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>