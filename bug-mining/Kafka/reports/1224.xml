<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 16:56:45 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-3175] topic not accessible after deletion even when delete.topic.enable is disabled</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-3175</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;The can be reproduced with the following steps.&lt;/p&gt;

&lt;p&gt;1. start ZK and 1 broker (with default delete.topic.enable=false)&lt;br/&gt;
2. create a topic test&lt;br/&gt;
bin/kafka-topics.sh --zookeeper localhost:2181 --create --topic test --partition 1 --replication-factor 1&lt;br/&gt;
3. delete topic test&lt;br/&gt;
bin/kafka-topics.sh --zookeeper localhost:2181 --delete --topic test&lt;br/&gt;
4. restart the broker&lt;/p&gt;

&lt;p&gt;Now topic test still shows up during topic description.&lt;br/&gt;
bin/kafka-topics.sh --zookeeper localhost:2181 --describe&lt;br/&gt;
Topic:test	PartitionCount:1	ReplicationFactor:1	Configs:&lt;br/&gt;
	Topic: test	Partition: 0	Leader: 0	Replicas: 0	Isr: 0&lt;/p&gt;

&lt;p&gt;However, one can&apos;t produce to this topic any more.&lt;br/&gt;
bin/kafka-console-producer.sh --broker-list localhost:9092 --topic test&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;2016-01-29 17:55:24,527&amp;#93;&lt;/span&gt; WARN Error while fetching metadata with correlation id 0 : &lt;/p&gt;
{test=LEADER_NOT_AVAILABLE} (org.apache.kafka.clients.NetworkClient)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;2016-01-29 17:55:24,725&amp;#93;&lt;/span&gt; WARN Error while fetching metadata with correlation id 1 : {test=LEADER_NOT_AVAILABLE}
&lt;p&gt; (org.apache.kafka.clients.NetworkClient)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;2016-01-29 17:55:24,828&amp;#93;&lt;/span&gt; WARN Error while fetching metadata with correlation id 2 : &lt;/p&gt;
{test=LEADER_NOT_AVAILABLE}
&lt;p&gt; (org.apache.kafka.clients.NetworkClient)&lt;/p&gt;</description>
                <environment></environment>
        <key id="12935325">KAFKA-3175</key>
            <summary>topic not accessible after deletion even when delete.topic.enable is disabled</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mgharat">Mayuresh Gharat</assignee>
                                    <reporter username="junrao">Jun Rao</reporter>
                        <labels>
                    </labels>
                <created>Sat, 30 Jan 2016 02:10:42 +0000</created>
                <updated>Tue, 22 Nov 2016 12:10:13 +0000</updated>
                            <resolved>Mon, 10 Oct 2016 21:08:04 +0000</resolved>
                                    <version>0.9.0.0</version>
                                    <fixVersion>0.10.2.0</fixVersion>
                                    <component>core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="15124643" author="junrao" created="Sat, 30 Jan 2016 02:19:30 +0000"  >&lt;p&gt;The issue is that during the controller failover, we call KafkaController.initializeTopicDeletion(), which reads the to be deleted topic test from ZK and uses it to initialize initialTopicsToBeDeleted in TopicDeletionManager without checking isDeleteTopicEnabled. Then, when the controller sends an UpdateMetadataRequest, ControllerBrokerRequestBatch.addUpdateMetadataRequestForBrokers() marks the topic as deleted. Then, the broker removes the topic from the metadata cache.&lt;/p&gt;

&lt;p&gt;To fix this, we will need to check isDeleteTopicEnabled when initializing TopicDeletionManager.&lt;/p&gt;</comment>
                            <comment id="15124681" author="mgharat" created="Sat, 30 Jan 2016 03:03:08 +0000"  >&lt;p&gt;I am just thinking we have that check in the TopicDeletionManager.start() and if the delete topic enable is set to false, DeleteTopicThread should not start.&lt;/p&gt;</comment>
                            <comment id="15124722" author="junrao" created="Sat, 30 Jan 2016 04:25:12 +0000"  >&lt;p&gt;It&apos;s already doing that. The problem is that initialTopicsToBeDeleted is added to topicsToBeDeleted without checking if delete topic is enabled or not.&lt;/p&gt;</comment>
                            <comment id="15126407" author="junrao" created="Mon, 1 Feb 2016 15:37:57 +0000"  >&lt;p&gt;Also, another thing is that if topic deletion is not enabled, the controller doesn&apos;t subscribe to the topic deletion path. This means that those to be deleted topics in the topic deletion path never get removed. If people enable topic deletion, those topics will be suddenly removed, which may be surprising. Perhaps we should let controller always subscribe to the topic deletion path, if topic deletion is not enabled, the controller can simply remove those to be deleted topics without doing any real work.&lt;/p&gt;</comment>
                            <comment id="15126711" author="mgharat" created="Mon, 1 Feb 2016 18:21:56 +0000"  >&lt;p&gt;I am thinking that once we detect that the delete topic is disabled, onController restart/shift we can remove the entries under /admin/delete_topic/.&lt;/p&gt;</comment>
                            <comment id="15127124" author="githubbot" created="Mon, 1 Feb 2016 21:55:56 +0000"  >&lt;p&gt;GitHub user MayureshGharat opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/846&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/846&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-3175&quot; title=&quot;topic not accessible after deletion even when delete.topic.enable is disabled&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-3175&quot;&gt;&lt;del&gt;KAFKA-3175&lt;/del&gt;&lt;/a&gt; : Topic not accessible after deletion even when delete.topic.enable is disabled&lt;/p&gt;

&lt;p&gt;    Remove topics under /admin/delete_topics path in zk if deleteTopic is disabled. The topic should never be enqueued for deletion.&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/MayureshGharat/kafka&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/MayureshGharat/kafka&lt;/a&gt; kafka-3175&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/846.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/846.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #846&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 48676b68df0f33c5c095c73002b7cca10b8a1402&lt;br/&gt;
Author: MayureshGharat &amp;lt;gharatmayuresh15@gmail.com&amp;gt;&lt;br/&gt;
Date:   2016-02-01T21:51:57Z&lt;/p&gt;

&lt;p&gt;    Remove topics under /admin/delete_topics path in zk if deleteTopic is disabled. The topic should never be enqueued for deletion&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15524915" author="githubbot" created="Tue, 27 Sep 2016 03:23:23 +0000"  >&lt;p&gt;GitHub user MayureshGharat opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/1913&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/1913&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-3175&quot; title=&quot;topic not accessible after deletion even when delete.topic.enable is disabled&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-3175&quot;&gt;&lt;del&gt;KAFKA-3175&lt;/del&gt;&lt;/a&gt; (Rebased) : topic not accessible after deletion even when delete.topic.enable is disabled&lt;/p&gt;

&lt;p&gt;    Rebased the patch with current trunk.&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/MayureshGharat/kafka&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/MayureshGharat/kafka&lt;/a&gt; kafka-3175_latest&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/1913.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/1913.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #1913&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 3b4412eb948318ac8fbea855ff52071bbb6f8fb3&lt;br/&gt;
Author: MayureshGharat &amp;lt;gharatmayuresh15@gmail.com&amp;gt;&lt;br/&gt;
Date:   2016-02-01T21:51:57Z&lt;/p&gt;

&lt;p&gt;    Remove topics under /admin/delete_topics path in zk if deleteTopic is disabled. The topic should never be enqueued for deletion&lt;/p&gt;

&lt;p&gt;commit 1bf29ae00da0eaa0044bdc1bb8dc6cc80ee90951&lt;br/&gt;
Author: MayureshGharat &amp;lt;gharatmayuresh15@gmail.com&amp;gt;&lt;br/&gt;
Date:   2016-03-11T17:25:32Z&lt;/p&gt;

&lt;p&gt;    Addressed Jun&apos;s comment to clean the zk state for a topic on cluster restart and delete topic disabled&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15563503" author="githubbot" created="Mon, 10 Oct 2016 21:07:17 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/kafka/pull/846&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/846&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15686567" author="ijuma" created="Tue, 22 Nov 2016 12:10:13 +0000"  >&lt;p&gt;I think this was only merged to trunk, so updated the fix version to be 0.10.2.0. Please let me know if I missed something.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                            <outwardlinks description="duplicates">
                                        <issuelink>
            <issuekey id="12999020">KAFKA-4074</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2s6mf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>jjkoshy</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>