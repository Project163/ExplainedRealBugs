<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 17:29:11 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-12487] Sink connectors do not work with the cooperative consumer rebalance protocol</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-12487</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;The &lt;tt&gt;ConsumerRebalanceListener&lt;/tt&gt; used by the framework to respond to rebalance events in consumer groups for sink tasks is hard-coded with the assumption that the consumer performs rebalances eagerly. In other words, it assumes that whenever &lt;tt&gt;onPartitionsRevoked&lt;/tt&gt; is called, all partitions have been revoked from that consumer, and whenever &lt;tt&gt;onPartitionsAssigned&lt;/tt&gt; is called, the partitions passed in to that method comprise the complete set of topic partitions assigned to that consumer.&lt;/p&gt;

&lt;p&gt;See the &lt;a href=&quot;https://github.com/apache/kafka/blob/b96fc7892f1e885239d3290cf509e1d1bb41e7db/connect/runtime/src/main/java/org/apache/kafka/connect/runtime/WorkerSinkTask.java#L669-L730&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;WorkerSinkTask.HandleRebalance class&lt;/a&gt;&#160;for the specifics.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;One issue&#160;this can cause is silently ignoring to-be-committed offsets provided by sink tasks, since the framework ignores offsets provided by tasks in their &lt;tt&gt;preCommit&lt;/tt&gt; method if it does not believe that the consumer for that task is currently assigned the topic partition for that offset. See these lines in the &lt;a href=&quot;https://github.com/apache/kafka/blob/b96fc7892f1e885239d3290cf509e1d1bb41e7db/connect/runtime/src/main/java/org/apache/kafka/connect/runtime/WorkerSinkTask.java#L429-L430&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;WorkerSinkTask::commitOffsets method&lt;/a&gt;&#160;for reference.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;This may not be the only issue caused by configuring a sink connector&apos;s consumer to use cooperative rebalancing. Rigorous unit and integration testing should be added before claiming that the Connect framework supports the use of cooperative consumers with sink connectors.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13365659">KAFKA-12487</key>
            <summary>Sink connectors do not work with the cooperative consumer rebalance protocol</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ChrisEgerton">Chris Egerton</assignee>
                                    <reporter username="ChrisEgerton">Chris Egerton</reporter>
                        <labels>
                    </labels>
                <created>Tue, 16 Mar 2021 23:17:24 +0000</created>
                <updated>Mon, 22 Nov 2021 21:37:50 +0000</updated>
                            <resolved>Wed, 10 Nov 2021 19:46:22 +0000</resolved>
                                    <version>2.4.2</version>
                    <version>2.5.2</version>
                    <version>2.6.2</version>
                    <version>2.7.1</version>
                    <version>2.8.0</version>
                    <version>3.0.0</version>
                                    <fixVersion>3.0.1</fixVersion>
                    <fixVersion>3.1.0</fixVersion>
                                    <component>connect</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                                                                                <comments>
                            <comment id="17319412" author="chrisegerton" created="Mon, 12 Apr 2021 12:14:34 +0000"  >&lt;p&gt;Based on recent &lt;a href=&quot;https://lists.apache.org/thread.html/%3CCAFLS_9gOHobj-had=7SVBibJTxfzKCuf7WM+shTL_aTvSeyq=g@mail.gmail.com%3E&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;KIP-726&lt;/a&gt;&#160;discussion, we&apos;ll also want to implement the&#160;&#160;&lt;a href=&quot;https://kafka.apache.org/27/javadoc/org/apache/kafka/clients/consumer/ConsumerRebalanceListener.html#onPartitionsLost-java.util.Collection-&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;ConsumerRebalanceListener::onPartitionsLost&lt;/a&gt; method in order to avoid task failures due to offset commit failures if/when the consumer rebalance protocol is automatically downgraded from &lt;tt&gt;COOPERATIVE&lt;/tt&gt; to &lt;tt&gt;EAGER&lt;/tt&gt;.&lt;/p&gt;</comment>
                            <comment id="17358311" author="showuon" created="Mon, 7 Jun 2021 02:44:28 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ChrisEgerton&quot; class=&quot;user-hover&quot; rel=&quot;ChrisEgerton&quot;&gt;ChrisEgerton&lt;/a&gt;, is there any update on this ticket? Do you think we can complete it by V3.0? (No push, just want to know the status.) Thank you.&lt;/p&gt;</comment>
                            <comment id="17362956" author="chrisegerton" created="Mon, 14 Jun 2021 13:21:58 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=showuon&quot; class=&quot;user-hover&quot; rel=&quot;showuon&quot;&gt;showuon&lt;/a&gt;--first off, congrats on the KIP! My PR has been reviewed and approved by a contributor and all that&apos;s left is for a committer to take a look. I hope we can get it merged in time for 3.0 but can&apos;t make any promises since it&apos;s out of my control. Perhaps &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kkonstantine&quot; class=&quot;user-hover&quot; rel=&quot;kkonstantine&quot;&gt;kkonstantine&lt;/a&gt;&#160;could take a look, since he voted on the KIP?&lt;/p&gt;</comment>
                            <comment id="17377785" author="kkonstantine" created="Fri, 9 Jul 2021 04:17:59 +0000"  >&lt;p&gt;Just a note that for tickets that need to target a specific version, it&apos;s highly recommended (if not necessary) to add the fix versions field. Marked the issue as blocker for 3.0 and will be taking a look before code freeze, which approaches quickly.&#160;&lt;/p&gt;</comment>
                            <comment id="17383609" author="kkonstantine" created="Mon, 19 Jul 2021 21:24:23 +0000"  >&lt;p&gt;Changing the default consumer protocol to be the cooperative protocol has been postponed for 3.1.0. Given that we are past the code freeze for 3.0, I&apos;m postponing this issue to 3.1.0 while keeping its blocker status for this release. The change is not trivial and would be good to have enough time to test before we release.&#160;&lt;/p&gt;</comment>
                            <comment id="17437340" author="dajac" created="Tue, 2 Nov 2021 13:01:33 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ChrisEgerton&quot; class=&quot;user-hover&quot; rel=&quot;ChrisEgerton&quot;&gt;ChrisEgerton&lt;/a&gt;&#160;Do we still plan to get this one in the 3.1 release? Based on the PR, it seems that we won&apos;t make it. Also, is it really a blocker?&lt;/p&gt;</comment>
                            <comment id="17438272" author="kkonstantine" created="Wed, 3 Nov 2021 19:52:47 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dajac&quot; class=&quot;user-hover&quot; rel=&quot;dajac&quot;&gt;dajac&lt;/a&gt;. I&apos;d like to complete another review pass this week and merge it as a patch that will go in to both 3.0 and 3.1 branches. My initial comments on the PR seem to have been addressed. Would that be ok with you?&lt;/p&gt;</comment>
                            <comment id="17438579" author="dajac" created="Thu, 4 Nov 2021 09:16:20 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kkonstantine&quot; class=&quot;user-hover&quot; rel=&quot;kkonstantine&quot;&gt;kkonstantine&lt;/a&gt;. My understanding of the issue is that we are fixing a bug here. Therefore, merging it to 3.1 and 3.0 is fine for me. Please correct if it is not a bug.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="13380878">KAFKA-12857</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="12310560">
                    <name>Problem/Incident</name>
                                            <outwardlinks description="causes">
                                        <issuelink>
            <issuekey id="13413254">KAFKA-13472</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13365079">KAFKA-12463</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13365385">KAFKA-12473</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 1 week, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0ov1s:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>