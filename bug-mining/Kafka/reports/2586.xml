<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 17:23:24 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-9793] Stream HandleAssignment should guarantee task close</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-9793</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;When triggering the `handleAssignment` call, if task preCommit throws, the doom-to-fail task shall not be closed, thus causing a RocksDB metrics recorder re-addition, which is fatal:&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;2020-03-31T16:50:43-07:00&amp;#93;&lt;/span&gt; (streams-soak-trunk-eos_soak_i-022f109d75764a250_streamslog) &lt;span class=&quot;error&quot;&gt;&amp;#91;2020-03-31 23:50:42,668&amp;#93;&lt;/span&gt; INFO &lt;span class=&quot;error&quot;&gt;&amp;#91;stream-soak-test-714fba71-3f5c-4418-8613-22d7b085949c-StreamThread-3&amp;#93;&lt;/span&gt; stream-thread &lt;span class=&quot;error&quot;&gt;&amp;#91;stream-soak-test-714fba71-3f5c-4418-8613-22d7b085949c-StreamThread-3&amp;#93;&lt;/span&gt; Handle new assignment with:&lt;/p&gt;

&lt;p&gt;&#160; &#160; &#160; &#160; New active tasks: &lt;span class=&quot;error&quot;&gt;&amp;#91;1_0, 0_1, 2_0&amp;#93;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&#160; &#160; &#160; &#160; New standby tasks: []&lt;/p&gt;

&lt;p&gt;&#160; &#160; &#160; &#160; Existing active tasks: &lt;span class=&quot;error&quot;&gt;&amp;#91;0_1, 1_0, 2_0, 3_1&amp;#93;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&#160; &#160; &#160; &#160; Existing standby tasks: [] (org.apache.kafka.streams.processor.internals.TaskManager)&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;2020-03-31T16:50:43-07:00&amp;#93;&lt;/span&gt; (streams-soak-trunk-eos_soak_i-022f109d75764a250_streamslog) &lt;span class=&quot;error&quot;&gt;&amp;#91;2020-03-31 23:50:42,671&amp;#93;&lt;/span&gt; INFO &lt;span class=&quot;error&quot;&gt;&amp;#91;stream-soak-test-714fba71-3f5c-4418-8613-22d7b085949c-StreamThread-3&amp;#93;&lt;/span&gt; stream-thread &lt;span class=&quot;error&quot;&gt;&amp;#91;stream-soak-test-714fba71-3f5c-4418-8613-22d7b085949c-StreamThread-3&amp;#93;&lt;/span&gt; task &lt;span class=&quot;error&quot;&gt;&amp;#91;3_1&amp;#93;&lt;/span&gt; Prepared clean close (org.apache.kafka.streams.processor.internals.StreamTask)&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;2020-03-31T16:50:43-07:00&amp;#93;&lt;/span&gt; (streams-soak-trunk-eos_soak_i-022f109d75764a250_streamslog) &lt;span class=&quot;error&quot;&gt;&amp;#91;2020-03-31 23:50:42,671&amp;#93;&lt;/span&gt; INFO &lt;span class=&quot;error&quot;&gt;&amp;#91;stream-soak-test-714fba71-3f5c-4418-8613-22d7b085949c-StreamThread-3&amp;#93;&lt;/span&gt; stream-thread &lt;span class=&quot;error&quot;&gt;&amp;#91;stream-soak-test-714fba71-3f5c-4418-8613-22d7b085949c-StreamThread-3&amp;#93;&lt;/span&gt; task &lt;span class=&quot;error&quot;&gt;&amp;#91;0_1&amp;#93;&lt;/span&gt; Prepared task for committing (org.apache.kafka.streams.processor.internals.StreamTask)&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;2020-03-31T16:50:43-07:00&amp;#93;&lt;/span&gt; (streams-soak-trunk-eos_soak_i-022f109d75764a250_streamslog) &lt;span class=&quot;error&quot;&gt;&amp;#91;2020-03-31 23:50:42,682&amp;#93;&lt;/span&gt; ERROR &lt;span class=&quot;error&quot;&gt;&amp;#91;stream-soak-test-714fba71-3f5c-4418-8613-22d7b085949c-StreamThread-3&amp;#93;&lt;/span&gt; stream-thread &lt;span class=&quot;error&quot;&gt;&amp;#91;stream-soak-test-714fba71-3f5c-4418-8613-22d7b085949c-StreamThread-3&amp;#93;&lt;/span&gt; task &lt;span class=&quot;error&quot;&gt;&amp;#91;1_0&amp;#93;&lt;/span&gt; Failed to flush state store logData10MinuteFinalCount-store:&#160; (org.apache.kafka.streams.processor.internals.ProcessorStateManager)&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;2020-03-31T16:50:43-07:00&amp;#93;&lt;/span&gt; (streams-soak-trunk-eos_soak_i-022f109d75764a250_streamslog) org.apache.kafka.streams.errors.TaskMigratedException: Error encountered sending record to topic windowed-node-counts for task 1_0 due to:&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;2020-03-31T16:50:43-07:00&amp;#93;&lt;/span&gt; (streams-soak-trunk-eos_soak_i-022f109d75764a250_streamslog) org.apache.kafka.common.errors.ProducerFencedException: Producer attempted an operation with an old epoch. Either there is a newer producer with the same transactionalId, or the producer&apos;s transaction has been expired by the broker.&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;2020-03-31T16:50:43-07:00&amp;#93;&lt;/span&gt; (streams-soak-trunk-eos_soak_i-022f109d75764a250_streamslog) Written offsets would not be recorded and no more records would be sent since the producer is fenced, indicating the task may be migrated out; it means all tasks belonging to this thread should be migrated.&lt;/p&gt;

&lt;p&gt;&#160; &#160; &#160; &#160; at org.apache.kafka.streams.processor.internals.RecordCollectorImpl.recordSendError(RecordCollectorImpl.java:202)&lt;/p&gt;

&lt;p&gt;&#160; &#160; &#160; &#160; at org.apache.kafka.streams.processor.internals.RecordCollectorImpl.lambda$send$0(RecordCollectorImpl.java:185)&lt;/p&gt;

&lt;p&gt;&#160; &#160; &#160; &#160; at org.apache.kafka.clients.producer.KafkaProducer$InterceptorCallback.onCompletion(KafkaProducer.java:1352)&lt;/p&gt;

&lt;p&gt;&#160; &#160; &#160; &#160; at org.apache.kafka.clients.producer.internals.ProducerBatch.completeFutureAndFireCallbacks(ProducerBatch.java:231)&lt;/p&gt;

&lt;p&gt;&#160; &#160; &#160; &#160; at org.apache.kafka.clients.producer.internals.ProducerBatch.abort(ProducerBatch.java:159)&lt;/p&gt;

&lt;p&gt;&#160; &#160; &#160; &#160; at org.apache.kafka.clients.producer.internals.RecordAccumulator.abortBatches(RecordAccumulator.java:768)&lt;/p&gt;

&lt;p&gt;&#160; &#160; &#160; &#160; at org.apache.kafka.clients.producer.internals.Sender.maybeAbortBatches(Sender.java:485)&lt;/p&gt;

&lt;p&gt;&#160; &#160; &#160; &#160; at org.apache.kafka.clients.producer.internals.Sender.runOnce(Sender.java:304)&lt;/p&gt;

&lt;p&gt;&#160; &#160; &#160; &#160; at org.apache.kafka.clients.producer.internals.Sender.run(Sender.java:240)&lt;/p&gt;

&lt;p&gt;&#160; &#160; &#160; &#160; at java.lang.Thread.run(Thread.java:748)&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;The correct solution is to wrap the whole code block by try-catch to avoid unexpected close failure.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13295416">KAFKA-9793</key>
            <summary>Stream HandleAssignment should guarantee task close</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="bchen225242">Boyang Chen</assignee>
                                    <reporter username="bchen225242">Boyang Chen</reporter>
                        <labels>
                    </labels>
                <created>Wed, 1 Apr 2020 04:44:56 +0000</created>
                <updated>Wed, 15 Apr 2020 15:14:47 +0000</updated>
                            <resolved>Wed, 15 Apr 2020 15:14:47 +0000</resolved>
                                    <version>2.6.0</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="17072392" author="githubbot" created="Wed, 1 Apr 2020 05:25:48 +0000"  >&lt;p&gt;abbccdda commented on pull request #8402: &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-9793&quot; title=&quot;Stream HandleAssignment should guarantee task close&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-9793&quot;&gt;&lt;del&gt;KAFKA-9793&lt;/del&gt;&lt;/a&gt;: Expand the try-catch for task commit in HandleAssignment&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/kafka/pull/8402&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/8402&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   As title suggests, we would like to broaden this check so that we don&apos;t fail to close a doom-to-cleanup task.&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;
		&lt;ol&gt;
			&lt;li&gt;Committer Checklist (excluded from commit message)&lt;/li&gt;
		&lt;/ol&gt;
		&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;[ ] Verify design and implementation&lt;/li&gt;
	&lt;li&gt;[ ] Verify test coverage and CI build status&lt;/li&gt;
	&lt;li&gt;[ ] Verify documentation (including upgrade notes)&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on to GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="17075880" author="githubbot" created="Sun, 5 Apr 2020 17:15:08 +0000"  >&lt;p&gt;guozhangwang commented on pull request #8402: &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-9793&quot; title=&quot;Stream HandleAssignment should guarantee task close&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-9793&quot;&gt;&lt;del&gt;KAFKA-9793&lt;/del&gt;&lt;/a&gt;: Expand the try-catch for task commit in HandleAssignment&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/kafka/pull/8402&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/8402&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on to GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="17075881" author="githubbot" created="Sun, 5 Apr 2020 17:15:11 +0000"  >&lt;p&gt;abbccdda commented on pull request #8402: &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-9793&quot; title=&quot;Stream HandleAssignment should guarantee task close&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-9793&quot;&gt;&lt;del&gt;KAFKA-9793&lt;/del&gt;&lt;/a&gt;: Expand the try-catch for task commit in HandleAssignment&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/kafka/pull/8402&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/8402&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   As title suggests, we would like to broaden this check so that we don&apos;t fail to close a doom-to-cleanup task.&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;
		&lt;ol&gt;
			&lt;li&gt;Committer Checklist (excluded from commit message)&lt;/li&gt;
		&lt;/ol&gt;
		&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;[ ] Verify design and implementation&lt;/li&gt;
	&lt;li&gt;[ ] Verify test coverage and CI build status&lt;/li&gt;
	&lt;li&gt;[ ] Verify documentation (including upgrade notes)&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on to GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="17076052" author="githubbot" created="Mon, 6 Apr 2020 05:50:31 +0000"  >&lt;p&gt;guozhangwang commented on pull request #8402: &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-9793&quot; title=&quot;Stream HandleAssignment should guarantee task close&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-9793&quot;&gt;&lt;del&gt;KAFKA-9793&lt;/del&gt;&lt;/a&gt;: Expand the try-catch for task commit in HandleAssignment&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/kafka/pull/8402&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/kafka/pull/8402&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on to GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 32 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0d5a8:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>