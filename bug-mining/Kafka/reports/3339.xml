<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 17:31:24 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[KAFKA-14208] KafkaConsumer#commitAsync throws unexpected WakeupException</title>
                <link>https://issues.apache.org/jira/browse/KAFKA-14208</link>
                <project id="12311720" key="KAFKA">Kafka</project>
                    <description>&lt;p&gt;We recently encountered a bug after upgrading Kafka client to 3.2.1 in Flink Kafka connector (&lt;a href=&quot;https://issues.apache.org/jira/browse/FLINK-29153&quot; title=&quot;KafkaConsumerThread should catch WakeupException when committing offsets&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FLINK-29153&quot;&gt;&lt;del&gt;FLINK-29153&lt;/del&gt;&lt;/a&gt;). Here&apos;s the exception:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
org.apache.kafka.common.errors.WakeupException
	at org.apache.kafka.clients.consumer.internals.ConsumerNetworkClient.maybeTriggerWakeup(ConsumerNetworkClient.java:514)
	at org.apache.kafka.clients.consumer.internals.ConsumerNetworkClient.poll(ConsumerNetworkClient.java:278)
	at org.apache.kafka.clients.consumer.internals.ConsumerNetworkClient.poll(ConsumerNetworkClient.java:236)
	at org.apache.kafka.clients.consumer.internals.ConsumerNetworkClient.poll(ConsumerNetworkClient.java:215)
	at org.apache.kafka.clients.consumer.internals.AbstractCoordinator.ensureCoordinatorReady(AbstractCoordinator.java:252)
	at org.apache.kafka.clients.consumer.internals.ConsumerCoordinator.coordinatorUnknownAndUnready(ConsumerCoordinator.java:493)
	at org.apache.kafka.clients.consumer.internals.ConsumerCoordinator.commitOffsetsAsync(ConsumerCoordinator.java:1055)
	at org.apache.kafka.clients.consumer.KafkaConsumer.commitAsync(KafkaConsumer.java:1573)
	at org.apache.flink.streaming.connectors.kafka.internals.KafkaConsumerThread.run(KafkaConsumerThread.java:226) &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;As &lt;tt&gt;WakeupException&lt;/tt&gt; is not listed in the JavaDoc of &lt;tt&gt;KafkaConsumer#commitAsync&lt;/tt&gt;, Flink Kafka connector doesn&apos;t catch the exception thrown directly from KafkaConsumer#commitAsync but handles all exceptions in the callback.&lt;/p&gt;

&lt;p&gt;I checked the source code and suspect this is caused by &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-13563&quot; title=&quot;FindCoordinatorFuture never get cleared in non-group mode( consumer#assign)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-13563&quot;&gt;&lt;del&gt;KAFKA-13563&lt;/del&gt;&lt;/a&gt;. Also we never had this exception in commitAsync when we used Kafka client 2.4.1 &amp;amp; 2.8.1.&#160;&lt;/p&gt;

&lt;p&gt;I&apos;m wondering if this is kind of breaking the public API as the WakeupException is not listed in JavaDoc, and maybe it&apos;s better to invoke the callback to handle the &lt;tt&gt;WakeupException&lt;/tt&gt; instead of throwing it directly from the method itself.&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13480622">KAFKA-14208</key>
            <summary>KafkaConsumer#commitAsync throws unexpected WakeupException</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="guozhang">Guozhang Wang</assignee>
                                    <reporter username="renqs">Qingsheng Ren</reporter>
                        <labels>
                    </labels>
                <created>Thu, 8 Sep 2022 10:22:21 +0000</created>
                <updated>Mon, 19 Sep 2022 08:53:47 +0000</updated>
                            <resolved>Tue, 13 Sep 2022 07:44:16 +0000</resolved>
                                    <version>3.2.1</version>
                                    <fixVersion>3.2.3</fixVersion>
                    <fixVersion>3.3.0</fixVersion>
                                    <component>clients</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="17602046" author="guozhang" created="Thu, 8 Sep 2022 23:53:59 +0000"  >&lt;p&gt;Hello Qingsheng, thanks for reporting this issue, and I looked at the source code and agree with you that it was introduced as part of &lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-13563&quot; title=&quot;FindCoordinatorFuture never get cleared in non-group mode( consumer#assign)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-13563&quot;&gt;&lt;del&gt;KAFKA-13563&lt;/del&gt;&lt;/a&gt;. I will try to fix this with a follow-up PR.&lt;/p&gt;</comment>
                            <comment id="17602574" author="guozhang" created="Fri, 9 Sep 2022 22:35:28 +0000"  >&lt;p&gt;I marked it as a blocker for 3.3.0 since it was a newly introduced regression. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jsancio&quot; class=&quot;user-hover&quot; rel=&quot;jsancio&quot;&gt;jsancio&lt;/a&gt; Let me know what do you think?&lt;/p&gt;</comment>
                            <comment id="17602575" author="jagsancio" created="Fri, 9 Sep 2022 22:43:17 +0000"  >&lt;p&gt;Okay. Thanks for the update. We have a few other blockers for 3.3 so we have time to get this merged and cherry picked.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 9 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z18ejs:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>