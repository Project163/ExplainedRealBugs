diff --git a/clients/src/main/java/org/apache/kafka/clients/NetworkClient.java b/clients/src/main/java/org/apache/kafka/clients/NetworkClient.java
index bd54a29ea9..8ab634db3c 100644
--- a/clients/src/main/java/org/apache/kafka/clients/NetworkClient.java
+++ b/clients/src/main/java/org/apache/kafka/clients/NetworkClient.java
@@ -559,7 +559,7 @@ public class NetworkClient implements KafkaClient {
         public boolean maybeHandleDisconnection(ClientRequest request) {
             ApiKeys requestKey = ApiKeys.forId(request.request().header().apiKey());
 
-            if (requestKey == ApiKeys.METADATA) {
+            if (requestKey == ApiKeys.METADATA && request.isInitiatedByNetworkClient()) {
                 Cluster cluster = metadata.fetch();
                 if (cluster.isBootstrapConfigured()) {
                     int nodeId = Integer.parseInt(request.request().destination());
diff --git a/clients/src/test/java/org/apache/kafka/clients/NetworkClientTest.java b/clients/src/test/java/org/apache/kafka/clients/NetworkClientTest.java
index 18f7ecb448..b55624079b 100644
--- a/clients/src/test/java/org/apache/kafka/clients/NetworkClientTest.java
+++ b/clients/src/test/java/org/apache/kafka/clients/NetworkClientTest.java
@@ -16,15 +16,6 @@
  */
 package org.apache.kafka.clients;
 
-import static org.junit.Assert.assertEquals;
-import static org.junit.Assert.assertFalse;
-import static org.junit.Assert.assertTrue;
-
-import java.nio.ByteBuffer;
-import java.util.Arrays;
-import java.util.Collections;
-import java.util.List;
-
 import org.apache.kafka.common.Cluster;
 import org.apache.kafka.common.Node;
 import org.apache.kafka.common.TopicPartition;
@@ -43,6 +34,15 @@ import org.apache.kafka.test.TestUtils;
 import org.junit.Before;
 import org.junit.Test;
 
+import java.nio.ByteBuffer;
+import java.util.Arrays;
+import java.util.Collections;
+import java.util.List;
+
+import static org.junit.Assert.assertEquals;
+import static org.junit.Assert.assertFalse;
+import static org.junit.Assert.assertTrue;
+
 public class NetworkClientTest {
 
     private final int requestTimeoutMs = 1000;
@@ -204,6 +204,26 @@ public class NetworkClientTest {
 
         assertEquals(reconnectBackoffMsTest, delay);
     }
+
+    @Test
+    public void testDisconnectDuringUserMetadataRequest() {
+        // this test ensures that the default metadata updater does not intercept a user-initiated
+        // metadata request when the remote node disconnects with the request in-flight.
+        awaitReady(client, node);
+        RequestHeader reqHeader = client.nextRequestHeader(ApiKeys.METADATA);
+
+        Struct req = new MetadataRequest(Collections.<String>emptyList()).toStruct();
+        RequestSend send = new RequestSend(node.idString(), reqHeader, req);
+        ClientRequest request = new ClientRequest(time.milliseconds(), true, send, null);
+        client.send(request, time.milliseconds());
+        client.poll(requestTimeoutMs, time.milliseconds());
+        assertEquals(1, client.inFlightRequestCount(node.idString()));
+
+        selector.close(node.idString());
+        List<ClientResponse> responses = client.poll(requestTimeoutMs, time.milliseconds());
+        assertEquals(1, responses.size());
+        assertTrue(responses.iterator().next().wasDisconnected());
+    }
     
     private static class TestCallbackHandler implements RequestCompletionHandler {
         public boolean executed = false;
