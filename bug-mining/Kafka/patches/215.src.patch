diff --git a/core/src/main/scala/kafka/server/KafkaApis.scala b/core/src/main/scala/kafka/server/KafkaApis.scala
index 9b97ca6709..c059981887 100644
--- a/core/src/main/scala/kafka/server/KafkaApis.scala
+++ b/core/src/main/scala/kafka/server/KafkaApis.scala
@@ -476,7 +476,7 @@ class KafkaApis(val requestChannel: RequestChannel,
     val responseInfo = offsetCommitRequest.requestInfo.map( t => {
       val topicDirs = new ZKGroupTopicDirs(offsetCommitRequest.groupId, t._1.topic)
       try {
-        if(t._2.metadata.length > config.offsetMetadataMaxSize) {
+        if(t._2.metadata != null && t._2.metadata.length > config.offsetMetadataMaxSize) {
           (t._1, ErrorMapping.OffsetMetadataTooLargeCode)
         } else {
           ZkUtils.updatePersistentPath(zkClient, topicDirs.consumerOffsetDir + "/" +
diff --git a/core/src/test/scala/unit/kafka/server/OffsetCommitTest.scala b/core/src/test/scala/unit/kafka/server/OffsetCommitTest.scala
index 48d56476f8..6989c95e61 100644
--- a/core/src/test/scala/unit/kafka/server/OffsetCommitTest.scala
+++ b/core/src/test/scala/unit/kafka/server/OffsetCommitTest.scala
@@ -171,4 +171,14 @@ class OffsetCommitTest extends JUnit3Suite with ZooKeeperTestHarness {
 
   }
 
+  @Test
+  def testNullMetadata() {
+    val topicAndPartition = TopicAndPartition("null-metadata", 0)
+    val commitRequest = OffsetCommitRequest("test-group", Map(topicAndPartition -> OffsetMetadataAndError(
+      offset=42L,
+      metadata=null
+    )))
+    val commitResponse = simpleConsumer.commitOffsets(commitRequest)
+    assertEquals(ErrorMapping.NoError, commitResponse.requestInfo.get(topicAndPartition).get)
+  }
 }
