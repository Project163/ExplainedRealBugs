diff --git a/core/src/main/scala/kafka/utils/ZkUtils.scala b/core/src/main/scala/kafka/utils/ZkUtils.scala
index 837b567414..e03893c7e7 100644
--- a/core/src/main/scala/kafka/utils/ZkUtils.scala
+++ b/core/src/main/scala/kafka/utils/ZkUtils.scala
@@ -903,10 +903,11 @@ class ZkUtils(val zkClient: ZkClient,
 
   def getAllPartitions(): Set[TopicAndPartition] = {
     val topics = getChildrenParentMayNotExist(BrokerTopicsPath)
-    if(topics == null) Set.empty[TopicAndPartition]
+    if (topics == null) Set.empty[TopicAndPartition]
     else {
       topics.flatMap { topic =>
-        getChildren(getTopicPartitionsPath(topic)).map(_.toInt).map(TopicAndPartition(topic, _))
+        // The partitions path may not exist if the topic is in the process of being deleted
+        getChildrenParentMayNotExist(getTopicPartitionsPath(topic)).map(_.toInt).map(TopicAndPartition(topic, _))
       }.toSet
     }
   }
diff --git a/core/src/test/scala/unit/kafka/utils/ZkUtilsTest.scala b/core/src/test/scala/unit/kafka/utils/ZkUtilsTest.scala
index db6202051a..1ad37fcaba 100755
--- a/core/src/test/scala/unit/kafka/utils/ZkUtilsTest.scala
+++ b/core/src/test/scala/unit/kafka/utils/ZkUtilsTest.scala
@@ -17,6 +17,7 @@
 
 package kafka.utils
 
+import kafka.common.TopicAndPartition
 import kafka.zk.ZooKeeperTestHarness
 import org.junit.Assert._
 import org.junit.Test
@@ -73,4 +74,14 @@ class ZkUtilsTest extends ZooKeeperTestHarness {
     val clusterId = "test"
     assertEquals(zkUtils.ClusterId.fromJson(zkUtils.ClusterId.toJson(clusterId)), clusterId)
   }
+
+  @Test
+  def testGetAllPartitionsTopicWithoutPartitions() {
+    val topic = "testtopic"
+    // Create a regular topic and a topic without any partitions
+    zkUtils.createPersistentPath(ZkUtils.getTopicPartitionPath(topic, 0))
+    zkUtils.createPersistentPath(ZkUtils.getTopicPath("nopartitions"))
+
+    assertEquals(Set(TopicAndPartition(topic, 0)), zkUtils.getAllPartitions())
+  }
 }
