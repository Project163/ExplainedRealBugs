diff --git a/gradle/findbugs-exclude.xml b/gradle/findbugs-exclude.xml
index eeea7fc04e..b0616a8e20 100644
--- a/gradle/findbugs-exclude.xml
+++ b/gradle/findbugs-exclude.xml
@@ -264,13 +264,6 @@ For a detailed description of findbugs bug categories, see http://findbugs.sourc
         <Bug pattern="EQ_COMPARETO_USE_OBJECT_EQUALS"/>
     </Match>
 
-    <Match>
-        <!-- TODO: fix this (see KAFKA-4996) -->
-        <Class name="org.apache.kafka.streams.state.internals.Segments"/>
-        <Method name="getOrCreateSegment"/>
-        <Bug pattern="AT_OPERATION_SEQUENCE_ON_CONCURRENT_ABSTRACTION"/>
-    </Match>
-
     <Match>
         <!-- TODO: fix this (see KAFKA-4996) -->
         <Or>
diff --git a/streams/src/main/java/org/apache/kafka/streams/state/internals/Segments.java b/streams/src/main/java/org/apache/kafka/streams/state/internals/Segments.java
index a02f87e103..3036f79bcd 100644
--- a/streams/src/main/java/org/apache/kafka/streams/state/internals/Segments.java
+++ b/streams/src/main/java/org/apache/kafka/streams/state/internals/Segments.java
@@ -77,16 +77,16 @@ class Segments {
             if (!isSegment(segment, segmentId)) {
                 cleanup(segmentId);
             }
-            if (!segments.containsKey(key)) {
-                Segment newSegment = new Segment(segmentName(segmentId), name, segmentId);
+            Segment newSegment = new Segment(segmentName(segmentId), name, segmentId);
+            Segment previousSegment = segments.putIfAbsent(key, newSegment);
+            if (previousSegment == null) {
                 newSegment.openDB(context);
-                segments.put(key, newSegment);
                 maxSegmentId = segmentId > maxSegmentId ? segmentId : maxSegmentId;
                 if (minSegmentId == Long.MAX_VALUE) {
                     minSegmentId = maxSegmentId;
                 }
             }
-            return segments.get(key);
+            return previousSegment == null ? newSegment : previousSegment;
         } else {
             return null;
         }
