diff --git a/core/src/main/java/kafka/log/remote/RemoteLogManager.java b/core/src/main/java/kafka/log/remote/RemoteLogManager.java
index e7ed9d599e..52fa8023f0 100644
--- a/core/src/main/java/kafka/log/remote/RemoteLogManager.java
+++ b/core/src/main/java/kafka/log/remote/RemoteLogManager.java
@@ -20,7 +20,6 @@ import com.yammer.metrics.core.Gauge;
 import kafka.cluster.EndPoint;
 import kafka.cluster.Partition;
 import kafka.log.UnifiedLog;
-import kafka.server.BrokerTopicMetrics;
 import kafka.server.BrokerTopicStats;
 import kafka.server.KafkaConfig;
 import kafka.server.StopPartition;
@@ -787,9 +786,9 @@ public class RemoteLogManager implements Closeable {
             long bytesLag = log.onlyLocalLogSegmentsSize() - log.activeSegment().size();
             String topic = topicIdPartition.topic();
             int partition = topicIdPartition.partition();
-            brokerTopicStats.topicStats(topic).recordRemoteCopyLagBytes(partition, bytesLag);
             long segmentsLag = log.onlyLocalLogSegmentsCount();
-            brokerTopicStats.topicStats(topic).recordRemoteCopyLagSegments(partition, segmentsLag);
+            brokerTopicStats.recordRemoteCopyLagBytes(topic, partition, bytesLag);
+            brokerTopicStats.recordRemoteCopyLagSegments(topic, partition, segmentsLag);
         }
 
         private Path toPathIfExists(File file) {
@@ -965,17 +964,17 @@ public class RemoteLogManager implements Closeable {
         }
 
         private void updateMetadataCountAndLogSizeWith(int metadataCount, long remoteLogSizeBytes) {
-            BrokerTopicMetrics brokerTopicMetrics = brokerTopicStats.topicStats(topicIdPartition.topic());
             int partition = topicIdPartition.partition();
-            brokerTopicMetrics.recordRemoteLogMetadataCount(partition, metadataCount);
-            brokerTopicMetrics.recordRemoteLogSizeBytes(partition, remoteLogSizeBytes);
+            String topic = topicIdPartition.topic();
+            brokerTopicStats.recordRemoteLogMetadataCount(topic, partition, metadataCount);
+            brokerTopicStats.recordRemoteLogSizeBytes(topic, partition, remoteLogSizeBytes);
         }
 
         private void updateRemoteDeleteLagWith(int segmentsLeftToDelete, long sizeOfDeletableSegmentsBytes) {
-            BrokerTopicMetrics brokerTopicMetrics = brokerTopicStats.topicStats(topicIdPartition.topic());
+            String topic = topicIdPartition.topic();
             int partition = topicIdPartition.partition();
-            brokerTopicMetrics.recordRemoteDeleteLagSegments(partition, segmentsLeftToDelete);
-            brokerTopicMetrics.recordRemoteDeleteLagBytes(partition, sizeOfDeletableSegmentsBytes);
+            brokerTopicStats.recordRemoteDeleteLagSegments(topic, partition, segmentsLeftToDelete);
+            brokerTopicStats.recordRemoteDeleteLagBytes(topic, partition, sizeOfDeletableSegmentsBytes);
         }
 
         void cleanupExpiredRemoteLogSegments() throws RemoteStorageException, ExecutionException, InterruptedException {
@@ -1175,7 +1174,8 @@ public class RemoteLogManager implements Closeable {
                         }
                     }
                 }
-                brokerTopicStats.topicStats(topicIdPartition.topic()).recordRemoteLogSizeComputationTime(topicIdPartition.partition(), time.milliseconds() - startTimeMs);
+
+                brokerTopicStats.recordRemoteLogSizeComputationTime(topicIdPartition.topic(), topicIdPartition.partition(), time.milliseconds() - startTimeMs);
 
                 // This is the total size of segments in local log that have their base-offset > local-log-start-offset
                 // and size of the segments in remote storage which have their end-offset < local-log-start-offset.
@@ -1665,15 +1665,27 @@ public class RemoteLogManager implements Closeable {
     }
 
     private void removeRemoteTopicPartitionMetrics(TopicIdPartition topicIdPartition) {
-        BrokerTopicMetrics topicMetrics = brokerTopicStats.topicStats(topicIdPartition.topic());
-        int partition = topicIdPartition.partition();
-        topicMetrics.removeRemoteCopyLagBytes(partition);
-        topicMetrics.removeRemoteCopyLagSegments(partition);
-        topicMetrics.removeRemoteDeleteLagBytes(partition);
-        topicMetrics.removeRemoteDeleteLagSegments(partition);
-        topicMetrics.removeRemoteLogMetadataCount(partition);
-        topicMetrics.removeRemoteLogSizeComputationTime(partition);
-        topicMetrics.removeRemoteLogSizeBytes(partition);
+        String topic = topicIdPartition.topic();
+        if (!brokerTopicStats.isTopicStatsExisted(topicIdPartition.topic())) {
+            // The topic metrics are already removed, removing this topic key from broker-level metrics
+            brokerTopicStats.removeBrokerLevelRemoteCopyLagBytes(topic);
+            brokerTopicStats.removeBrokerLevelRemoteCopyLagSegments(topic);
+            brokerTopicStats.removeBrokerLevelRemoteDeleteLagBytes(topic);
+            brokerTopicStats.removeBrokerLevelRemoteDeleteLagSegments(topic);
+            brokerTopicStats.removeBrokerLevelRemoteLogMetadataCount(topic);
+            brokerTopicStats.removeBrokerLevelRemoteLogSizeComputationTime(topic);
+            brokerTopicStats.removeBrokerLevelRemoteLogSizeBytes(topic);
+        } else {
+            int partition = topicIdPartition.partition();
+            // remove the partition metric values and update the broker-level metrics
+            brokerTopicStats.removeRemoteCopyLagBytes(topic, partition);
+            brokerTopicStats.removeRemoteCopyLagSegments(topic, partition);
+            brokerTopicStats.removeRemoteDeleteLagBytes(topic, partition);
+            brokerTopicStats.removeRemoteDeleteLagSegments(topic, partition);
+            brokerTopicStats.removeRemoteLogMetadataCount(topic, partition);
+            brokerTopicStats.removeRemoteLogSizeComputationTime(topic, partition);
+            brokerTopicStats.removeRemoteLogSizeBytes(topic, partition);
+        }
     }
 
     //Visible for testing
diff --git a/core/src/main/scala/kafka/server/KafkaRequestHandler.scala b/core/src/main/scala/kafka/server/KafkaRequestHandler.scala
index a350024610..d9a8a8315b 100755
--- a/core/src/main/scala/kafka/server/KafkaRequestHandler.scala
+++ b/core/src/main/scala/kafka/server/KafkaRequestHandler.scala
@@ -283,13 +283,14 @@ class BrokerTopicMetrics(name: Option[String], configOpt: java.util.Optional[Kaf
       meter()
   }
 
-  case class GaugeWrapper(metricType: String, brokerTopicAggregatedMetric: BrokerTopicAggregatedMetric) {
+  case class GaugeWrapper(metricType: String) {
     @volatile private var gaugeObject: Gauge[Long] = _
     final private val gaugeLock = new Object
+    final val aggregatedMetric = new AggregatedMetric()
 
     def gauge(): Gauge[Long] = gaugeLock synchronized {
       if (gaugeObject == null) {
-        gaugeObject = metricsGroup.newGauge(metricType, () => brokerTopicAggregatedMetric.value(), tags)
+        gaugeObject = metricsGroup.newGauge(metricType, () => aggregatedMetric.value(), tags)
       }
       return gaugeObject
     }
@@ -297,7 +298,7 @@ class BrokerTopicMetrics(name: Option[String], configOpt: java.util.Optional[Kaf
     def close(): Unit = gaugeLock synchronized {
       if (gaugeObject != null) {
         metricsGroup.removeMetric(metricType, tags)
-        brokerTopicAggregatedMetric.close()
+        aggregatedMetric.close()
         gaugeObject = null
       }
     }
@@ -346,14 +347,15 @@ class BrokerTopicMetrics(name: Option[String], configOpt: java.util.Optional[Kaf
         RemoteStorageMetrics.FAILED_REMOTE_DELETE_PER_SEC_METRIC.getName -> MeterWrapper(RemoteStorageMetrics.FAILED_REMOTE_DELETE_PER_SEC_METRIC.getName, "requests"),
         RemoteStorageMetrics.FAILED_BUILD_REMOTE_LOG_AUX_STATE_PER_SEC_METRIC.getName -> MeterWrapper(RemoteStorageMetrics.FAILED_BUILD_REMOTE_LOG_AUX_STATE_PER_SEC_METRIC.getName, "requests")
       ).asJava)
+
       metricGaugeTypeMap.putAll(Map(
-        RemoteStorageMetrics.REMOTE_COPY_LAG_BYTES_METRIC.getName -> GaugeWrapper(RemoteStorageMetrics.REMOTE_COPY_LAG_BYTES_METRIC.getName, new BrokerTopicAggregatedMetric),
-        RemoteStorageMetrics.REMOTE_COPY_LAG_SEGMENTS_METRIC.getName -> GaugeWrapper(RemoteStorageMetrics.REMOTE_COPY_LAG_SEGMENTS_METRIC.getName, new BrokerTopicAggregatedMetric),
-        RemoteStorageMetrics.REMOTE_DELETE_LAG_BYTES_METRIC.getName -> GaugeWrapper(RemoteStorageMetrics.REMOTE_DELETE_LAG_BYTES_METRIC.getName, new BrokerTopicAggregatedMetric),
-        RemoteStorageMetrics.REMOTE_DELETE_LAG_SEGMENTS_METRIC.getName -> GaugeWrapper(RemoteStorageMetrics.REMOTE_DELETE_LAG_SEGMENTS_METRIC.getName, new BrokerTopicAggregatedMetric),
-        RemoteStorageMetrics.REMOTE_LOG_METADATA_COUNT_METRIC.getName -> GaugeWrapper(RemoteStorageMetrics.REMOTE_LOG_METADATA_COUNT_METRIC.getName, new BrokerTopicAggregatedMetric),
-        RemoteStorageMetrics.REMOTE_LOG_SIZE_COMPUTATION_TIME_METRIC.getName -> GaugeWrapper(RemoteStorageMetrics.REMOTE_LOG_SIZE_COMPUTATION_TIME_METRIC.getName, new BrokerTopicAggregatedMetric),
-        RemoteStorageMetrics.REMOTE_LOG_SIZE_BYTES_METRIC.getName -> GaugeWrapper(RemoteStorageMetrics.REMOTE_LOG_SIZE_BYTES_METRIC.getName, new BrokerTopicAggregatedMetric)
+        RemoteStorageMetrics.REMOTE_COPY_LAG_BYTES_METRIC.getName -> GaugeWrapper(RemoteStorageMetrics.REMOTE_COPY_LAG_BYTES_METRIC.getName),
+        RemoteStorageMetrics.REMOTE_COPY_LAG_SEGMENTS_METRIC.getName -> GaugeWrapper(RemoteStorageMetrics.REMOTE_COPY_LAG_SEGMENTS_METRIC.getName),
+        RemoteStorageMetrics.REMOTE_DELETE_LAG_BYTES_METRIC.getName -> GaugeWrapper(RemoteStorageMetrics.REMOTE_DELETE_LAG_BYTES_METRIC.getName),
+        RemoteStorageMetrics.REMOTE_DELETE_LAG_SEGMENTS_METRIC.getName -> GaugeWrapper(RemoteStorageMetrics.REMOTE_DELETE_LAG_SEGMENTS_METRIC.getName),
+        RemoteStorageMetrics.REMOTE_LOG_METADATA_COUNT_METRIC.getName -> GaugeWrapper(RemoteStorageMetrics.REMOTE_LOG_METADATA_COUNT_METRIC.getName),
+        RemoteStorageMetrics.REMOTE_LOG_SIZE_COMPUTATION_TIME_METRIC.getName -> GaugeWrapper(RemoteStorageMetrics.REMOTE_LOG_SIZE_COMPUTATION_TIME_METRIC.getName),
+        RemoteStorageMetrics.REMOTE_LOG_SIZE_BYTES_METRIC.getName -> GaugeWrapper(RemoteStorageMetrics.REMOTE_LOG_SIZE_BYTES_METRIC.getName)
       ).asJava)
     })
 
@@ -406,93 +408,51 @@ class BrokerTopicMetrics(name: Option[String], configOpt: java.util.Optional[Kaf
 
   def invalidOffsetOrSequenceRecordsPerSec: Meter = metricTypeMap.get(BrokerTopicStats.InvalidOffsetOrSequenceRecordsPerSec).meter()
 
-  def recordRemoteCopyLagBytes(partition: Int, bytesLag: Long): Unit = {
-    val brokerTopicAggregatedMetric = metricGaugeTypeMap.get(RemoteStorageMetrics.REMOTE_COPY_LAG_BYTES_METRIC.getName).brokerTopicAggregatedMetric
-    brokerTopicAggregatedMetric.setPartitionMetricValue(partition, bytesLag)
-  }
-
-  def removeRemoteCopyLagBytes(partition: Int): Unit = {
-    val brokerTopicAggregatedMetric = metricGaugeTypeMap.get(RemoteStorageMetrics.REMOTE_COPY_LAG_BYTES_METRIC.getName).brokerTopicAggregatedMetric
-    brokerTopicAggregatedMetric.removePartition(partition)
+  def remoteCopyLagBytesAggrMetric(): AggregatedMetric = {
+    metricGaugeTypeMap.get(RemoteStorageMetrics.REMOTE_COPY_LAG_BYTES_METRIC.getName).aggregatedMetric
   }
 
   // Visible for testing
-  def remoteCopyLagBytes: Long = metricGaugeTypeMap.get(RemoteStorageMetrics.REMOTE_COPY_LAG_BYTES_METRIC.getName).brokerTopicAggregatedMetric.value()
-
-  def recordRemoteCopyLagSegments(partition: Int, segmentsLag: Long): Unit = {
-    val brokerTopicAggregatedMetric = metricGaugeTypeMap.get(RemoteStorageMetrics.REMOTE_COPY_LAG_SEGMENTS_METRIC.getName).brokerTopicAggregatedMetric
-    brokerTopicAggregatedMetric.setPartitionMetricValue(partition, segmentsLag)
-  }
+  def remoteCopyLagBytes: Long = remoteCopyLagBytesAggrMetric().value()
 
-  def removeRemoteCopyLagSegments(partition: Int): Unit = {
-    val brokerTopicAggregatedMetric = metricGaugeTypeMap.get(RemoteStorageMetrics.REMOTE_COPY_LAG_SEGMENTS_METRIC.getName).brokerTopicAggregatedMetric
-    brokerTopicAggregatedMetric.removePartition(partition)
+  def remoteCopyLagSegmentsAggrMetric(): AggregatedMetric = {
+    metricGaugeTypeMap.get(RemoteStorageMetrics.REMOTE_COPY_LAG_SEGMENTS_METRIC.getName).aggregatedMetric
   }
 
   // Visible for testing
-  def remoteCopyLagSegments: Long = metricGaugeTypeMap.get(RemoteStorageMetrics.REMOTE_COPY_LAG_SEGMENTS_METRIC.getName).brokerTopicAggregatedMetric.value()
-
-  def recordRemoteLogMetadataCount(partition: Int, count: Long): Unit = {
-    val brokerTopicAggregatedMetric = metricGaugeTypeMap.get(RemoteStorageMetrics.REMOTE_LOG_METADATA_COUNT_METRIC.getName).brokerTopicAggregatedMetric
-    brokerTopicAggregatedMetric.setPartitionMetricValue(partition, count)
-  }
+  def remoteCopyLagSegments: Long = remoteCopyLagSegmentsAggrMetric().value()
 
-  def removeRemoteLogMetadataCount(partition: Int): Unit = {
-    val brokerTopicAggregatedMetric = metricGaugeTypeMap.get(RemoteStorageMetrics.REMOTE_LOG_METADATA_COUNT_METRIC.getName).brokerTopicAggregatedMetric
-    brokerTopicAggregatedMetric.removePartition(partition)
+  def remoteLogMetadataCountAggrMetric(): AggregatedMetric = {
+    metricGaugeTypeMap.get(RemoteStorageMetrics.REMOTE_LOG_METADATA_COUNT_METRIC.getName).aggregatedMetric
   }
 
-  def remoteLogMetadataCount: Long = metricGaugeTypeMap.get(RemoteStorageMetrics.REMOTE_LOG_METADATA_COUNT_METRIC.getName).brokerTopicAggregatedMetric.value()
-
-  def recordRemoteLogSizeBytes(partition: Int, size: Long): Unit = {
-    val brokerTopicAggregatedMetric = metricGaugeTypeMap.get(RemoteStorageMetrics.REMOTE_LOG_SIZE_BYTES_METRIC.getName).brokerTopicAggregatedMetric
-    brokerTopicAggregatedMetric.setPartitionMetricValue(partition, size)
-  }
+  def remoteLogMetadataCount: Long = remoteLogMetadataCountAggrMetric().value()
 
-  def removeRemoteLogSizeBytes(partition: Int): Unit = {
-    val brokerTopicAggregatedMetric = metricGaugeTypeMap.get(RemoteStorageMetrics.REMOTE_LOG_SIZE_BYTES_METRIC.getName).brokerTopicAggregatedMetric
-    brokerTopicAggregatedMetric.removePartition(partition)
+  def remoteLogSizeBytesAggrMetric(): AggregatedMetric = {
+    metricGaugeTypeMap.get(RemoteStorageMetrics.REMOTE_LOG_SIZE_BYTES_METRIC.getName).aggregatedMetric
   }
 
-  def remoteLogSizeBytes: Long = metricGaugeTypeMap.get(RemoteStorageMetrics.REMOTE_LOG_SIZE_BYTES_METRIC.getName).brokerTopicAggregatedMetric.value()
-
-  def recordRemoteLogSizeComputationTime(partition: Int, timeSpent: Long): Unit = {
-    val brokerTopicAggregatedMetric = metricGaugeTypeMap.get(RemoteStorageMetrics.REMOTE_LOG_SIZE_COMPUTATION_TIME_METRIC.getName).brokerTopicAggregatedMetric
-    brokerTopicAggregatedMetric.setPartitionMetricValue(partition, timeSpent)
-  }
+  def remoteLogSizeBytes: Long = remoteLogSizeBytesAggrMetric().value()
 
-  def removeRemoteLogSizeComputationTime(partition: Int): Unit = {
-    val brokerTopicAggregatedMetric = metricGaugeTypeMap.get(RemoteStorageMetrics.REMOTE_LOG_SIZE_COMPUTATION_TIME_METRIC.getName).brokerTopicAggregatedMetric
-    brokerTopicAggregatedMetric.removePartition(partition)
+  def remoteLogSizeComputationTimeAggrMetric(): AggregatedMetric = {
+    metricGaugeTypeMap.get(RemoteStorageMetrics.REMOTE_LOG_SIZE_COMPUTATION_TIME_METRIC.getName).aggregatedMetric
   }
 
-  def remoteLogSizeComputationTime: Long = metricGaugeTypeMap.get(RemoteStorageMetrics.REMOTE_LOG_SIZE_COMPUTATION_TIME_METRIC.getName).brokerTopicAggregatedMetric.value()
-
-  def recordRemoteDeleteLagBytes(partition: Int, segmentsLag: Long): Unit = {
-    val brokerTopicAggregatedMetric = metricGaugeTypeMap.get(RemoteStorageMetrics.REMOTE_DELETE_LAG_BYTES_METRIC.getName).brokerTopicAggregatedMetric
-    brokerTopicAggregatedMetric.setPartitionMetricValue(partition, segmentsLag)
-  }
+  def remoteLogSizeComputationTime: Long = remoteLogSizeComputationTimeAggrMetric().value()
 
-  def removeRemoteDeleteLagBytes(partition: Int): Unit = {
-    val brokerTopicAggregatedMetric = metricGaugeTypeMap.get(RemoteStorageMetrics.REMOTE_DELETE_LAG_BYTES_METRIC.getName).brokerTopicAggregatedMetric
-    brokerTopicAggregatedMetric.removePartition(partition)
+  def remoteDeleteLagBytesAggrMetric(): AggregatedMetric = {
+    metricGaugeTypeMap.get(RemoteStorageMetrics.REMOTE_DELETE_LAG_BYTES_METRIC.getName).aggregatedMetric
   }
 
   // Visible for testing
-  def remoteDeleteLagBytes: Long = metricGaugeTypeMap.get(RemoteStorageMetrics.REMOTE_DELETE_LAG_BYTES_METRIC.getName).brokerTopicAggregatedMetric.value()
-
-  def recordRemoteDeleteLagSegments(partition: Int, segmentsLag: Long): Unit = {
-    val brokerTopicAggregatedMetric = metricGaugeTypeMap.get(RemoteStorageMetrics.REMOTE_DELETE_LAG_SEGMENTS_METRIC.getName).brokerTopicAggregatedMetric
-    brokerTopicAggregatedMetric.setPartitionMetricValue(partition, segmentsLag)
-  }
+  def remoteDeleteLagBytes: Long = remoteDeleteLagBytesAggrMetric().value()
 
-  def removeRemoteDeleteLagSegments(partition: Int): Unit = {
-    val brokerTopicAggregatedMetric = metricGaugeTypeMap.get(RemoteStorageMetrics.REMOTE_DELETE_LAG_SEGMENTS_METRIC.getName).brokerTopicAggregatedMetric
-    brokerTopicAggregatedMetric.removePartition(partition)
+  def remoteDeleteLagSegmentsAggrMetric(): AggregatedMetric = {
+    metricGaugeTypeMap.get(RemoteStorageMetrics.REMOTE_DELETE_LAG_SEGMENTS_METRIC.getName).aggregatedMetric
   }
 
   // Visible for testing
-  def remoteDeleteLagSegments: Long = metricGaugeTypeMap.get(RemoteStorageMetrics.REMOTE_DELETE_LAG_SEGMENTS_METRIC.getName).brokerTopicAggregatedMetric.value()
+  def remoteDeleteLagSegments: Long = remoteDeleteLagSegmentsAggrMetric().value()
 
   def remoteCopyBytesRate: Meter = metricTypeMap.get(RemoteStorageMetrics.REMOTE_COPY_BYTES_PER_SEC_METRIC.getName).meter()
 
@@ -529,20 +489,16 @@ class BrokerTopicMetrics(name: Option[String], configOpt: java.util.Optional[Kaf
   }
 }
 
-class BrokerTopicAggregatedMetric() {
-  private val partitionMetricValues = new ConcurrentHashMap[Int, Long]()
-
-  def setPartitionMetricValue(partition: Int, partitionValue: Long): Unit = {
-    partitionMetricValues.put(partition, partitionValue)
-  }
-
-  def removePartition(partition: Int): Option[Long] = {
-    Option.apply(partitionMetricValues.remove(partition))
-  }
-
-  def value(): Long = partitionMetricValues.values().stream().mapToLong(v => v).sum()
-
-  def close(): Unit = partitionMetricValues.clear()
+class AggregatedMetric {
+  // The map to store:
+  //   - per-partition value for topic-level metrics. The key will be the partition number
+  //   - per-topic value for broker-level metrics. The key will be the topic name
+  private val metricValues = new ConcurrentHashMap[String, Long]()
+  def setValue(key: String, value: Long): Unit = metricValues.put(key, value)
+  def removeKey(key: String): Option[Long] = Option.apply(metricValues.remove(key))
+  // Sum all values in the metricValues map
+  def value(): Long = metricValues.values().stream().mapToLong(v => v).sum()
+  def close(): Unit = metricValues.clear()
 }
 
 object BrokerTopicStats {
@@ -573,6 +529,9 @@ class BrokerTopicStats(configOpt: java.util.Optional[KafkaConfig] = java.util.Op
   private val stats = new Pool[String, BrokerTopicMetrics](Some(valueFactory))
   val allTopicsStats = new BrokerTopicMetrics(None, configOpt)
 
+  def isTopicStatsExisted(topic: String): Boolean =
+    stats.contains(topic)
+
   def topicStats(topic: String): BrokerTopicMetrics =
     stats.getAndMaybePut(topic)
 
@@ -659,6 +618,132 @@ class BrokerTopicStats(configOpt: java.util.Optional[KafkaConfig] = java.util.Op
     }
   }
 
+  // Update the broker-level all topic metric values so that we have a sample right for all topics metric after update of partition.
+  def recordRemoteCopyLagBytes(topic: String, partition: Int, value: Long): Unit = {
+    val topicMetric = topicStats(topic)
+    topicMetric.remoteCopyLagBytesAggrMetric().setValue(String.valueOf(partition), value)
+    allTopicsStats.remoteCopyLagBytesAggrMetric().setValue(topic, topicMetric.remoteCopyLagBytes)
+  }
+
+  // Update the broker-level all topic metric values so that we have a sample right for all topics metric after removal of partition.
+  def removeRemoteCopyLagBytes(topic: String, partition: Int): Unit = {
+    val topicMetric = topicStats(topic)
+    topicMetric.remoteCopyLagBytesAggrMetric().removeKey(String.valueOf(partition))
+    allTopicsStats.remoteCopyLagBytesAggrMetric().setValue(topic, topicMetric.remoteCopyLagBytes)
+  }
+
+  def removeBrokerLevelRemoteCopyLagBytes(topic: String): Unit = {
+    allTopicsStats.remoteCopyLagBytesAggrMetric().removeKey(topic)
+  }
+
+  // Update the broker-level all topic metric values so that we have a sample right for all topics metric after update of partition.
+  def recordRemoteCopyLagSegments(topic: String, partition: Int, value: Long): Unit = {
+    val topicMetric = topicStats(topic)
+    topicMetric.remoteCopyLagSegmentsAggrMetric().setValue(String.valueOf(partition), value)
+    allTopicsStats.remoteCopyLagSegmentsAggrMetric().setValue(topic, topicMetric.remoteCopyLagSegments)
+  }
+
+  // Update the broker-level all topic metric values so that we have a sample right for all topics metric after removal of partition.
+  def removeRemoteCopyLagSegments(topic: String, partition: Int): Unit = {
+    val topicMetric = topicStats(topic)
+    topicMetric.remoteCopyLagSegmentsAggrMetric().removeKey(String.valueOf(partition))
+    allTopicsStats.remoteCopyLagSegmentsAggrMetric().setValue(topic, topicMetric.remoteCopyLagSegments)
+  }
+
+  def removeBrokerLevelRemoteCopyLagSegments(topic: String): Unit = {
+    allTopicsStats.remoteCopyLagSegmentsAggrMetric().removeKey(topic)
+  }
+
+  // Update the broker-level all topic metric values so that we have a sample right for all topics metric after update of partition.
+  def recordRemoteDeleteLagBytes(topic: String, partition: Int, value: Long): Unit = {
+    val topicMetric = topicStats(topic)
+    topicMetric.remoteDeleteLagBytesAggrMetric().setValue(String.valueOf(partition), value)
+    allTopicsStats.remoteDeleteLagBytesAggrMetric().setValue(topic, topicMetric.remoteDeleteLagBytes)
+  }
+
+  // Update the broker-level all topic metric values so that we have a sample right for all topics metric after removal of partition.
+  def removeRemoteDeleteLagBytes(topic: String, partition: Int): Unit = {
+    val topicMetric = topicStats(topic)
+    topicMetric.remoteDeleteLagBytesAggrMetric().removeKey(String.valueOf(partition))
+    allTopicsStats.remoteDeleteLagBytesAggrMetric().setValue(topic, topicMetric.remoteDeleteLagBytes)
+  }
+
+  def removeBrokerLevelRemoteDeleteLagBytes(topic: String): Unit = {
+    allTopicsStats.remoteDeleteLagBytesAggrMetric().removeKey(topic)
+  }
+
+  // Update the broker-level all topic metric values so that we have a sample right for all topics metric after update of partition.
+  def recordRemoteDeleteLagSegments(topic: String, partition: Int, value: Long): Unit = {
+    val topicMetric = topicStats(topic)
+    topicMetric.remoteDeleteLagSegmentsAggrMetric().setValue(String.valueOf(partition), value)
+    allTopicsStats.remoteDeleteLagSegmentsAggrMetric().setValue(topic, topicMetric.remoteDeleteLagSegments)
+  }
+
+  // Update the broker-level all topic metric values so that we have a sample right for all topics metric after removal of partition.
+  def removeRemoteDeleteLagSegments(topic: String, partition: Int): Unit = {
+    val topicMetric = topicStats(topic)
+    topicMetric.remoteDeleteLagSegmentsAggrMetric().removeKey(String.valueOf(partition))
+    allTopicsStats.remoteDeleteLagSegmentsAggrMetric().setValue(topic, topicMetric.remoteDeleteLagSegments)
+  }
+
+  def removeBrokerLevelRemoteDeleteLagSegments(topic: String): Unit = {
+    allTopicsStats.remoteDeleteLagSegmentsAggrMetric().removeKey(topic)
+  }
+
+  // Update the broker-level all topic metric values so that we have a sample right for all topics metric after update of partition.
+  def recordRemoteLogMetadataCount(topic: String, partition: Int, value: Long): Unit = {
+    val topicMetric = topicStats(topic)
+    topicMetric.remoteLogMetadataCountAggrMetric().setValue(String.valueOf(partition), value)
+    allTopicsStats.remoteLogMetadataCountAggrMetric().setValue(topic, topicMetric.remoteLogMetadataCount)
+  }
+
+  // Update the broker-level all topic metric values so that we have a sample right for all topics metric after removal of partition.
+  def removeRemoteLogMetadataCount(topic: String, partition: Int): Unit = {
+    val topicMetric = topicStats(topic)
+    topicMetric.remoteLogMetadataCountAggrMetric().removeKey(String.valueOf(partition))
+    allTopicsStats.remoteLogMetadataCountAggrMetric().setValue(topic, topicMetric.remoteLogMetadataCount)
+  }
+
+  def removeBrokerLevelRemoteLogMetadataCount(topic: String): Unit = {
+    allTopicsStats.remoteLogMetadataCountAggrMetric().removeKey(topic)
+  }
+
+  // Update the broker-level all topic metric values so that we have a sample right for all topics metric after update of partition.
+  def recordRemoteLogSizeComputationTime(topic: String, partition: Int, value: Long): Unit = {
+    val topicMetric = topicStats(topic)
+    topicMetric.remoteLogSizeComputationTimeAggrMetric().setValue(String.valueOf(partition), value)
+    allTopicsStats.remoteLogSizeComputationTimeAggrMetric().setValue(topic, topicMetric.remoteLogSizeComputationTime)
+  }
+
+  // Update the broker-level all topic metric values so that we have a sample right for all topics metric after removal of partition.
+  def removeRemoteLogSizeComputationTime(topic: String, partition: Int): Unit = {
+    val topicMetric = topicStats(topic)
+    topicMetric.remoteLogSizeComputationTimeAggrMetric().removeKey(String.valueOf(partition))
+    allTopicsStats.remoteLogSizeComputationTimeAggrMetric().setValue(topic, topicMetric.remoteLogSizeComputationTime)
+  }
+
+  def removeBrokerLevelRemoteLogSizeComputationTime(topic: String): Unit = {
+    allTopicsStats.remoteLogSizeComputationTimeAggrMetric().removeKey(topic)
+  }
+
+  // Update the broker-level all topic metric values so that we have a sample right for all topics metric after update of partition.
+  def recordRemoteLogSizeBytes(topic: String, partition: Int, value: Long): Unit = {
+    val topicMetric = topicStats(topic)
+    topicMetric.remoteLogSizeBytesAggrMetric().setValue(String.valueOf(partition), value)
+    allTopicsStats.remoteLogSizeBytesAggrMetric().setValue(topic, topicMetric.remoteLogSizeBytes)
+  }
+
+  // Update the broker-level all topic metric values so that we have a sample right for all topics metric after removal of partition.
+  def removeRemoteLogSizeBytes(topic: String, partition: Int): Unit = {
+    val topicMetric = topicStats(topic)
+    topicMetric.remoteLogSizeBytesAggrMetric().removeKey(String.valueOf(partition))
+    allTopicsStats.remoteLogSizeBytesAggrMetric().setValue(topic, topicMetric.remoteLogSizeBytes)
+  }
+
+  def removeBrokerLevelRemoteLogSizeBytes(topic: String): Unit = {
+    allTopicsStats.remoteLogSizeBytesAggrMetric().removeKey(topic)
+  }
+
   def close(): Unit = {
     allTopicsStats.close()
     stats.values.foreach(_.close())
diff --git a/core/src/test/java/kafka/log/remote/RemoteLogManagerTest.java b/core/src/test/java/kafka/log/remote/RemoteLogManagerTest.java
index e77efb137d..193b5c15d6 100644
--- a/core/src/test/java/kafka/log/remote/RemoteLogManagerTest.java
+++ b/core/src/test/java/kafka/log/remote/RemoteLogManagerTest.java
@@ -177,6 +177,7 @@ public class RemoteLogManagerTest {
     private RemoteLogManager remoteLogManager = null;
 
     private final TopicIdPartition leaderTopicIdPartition = new TopicIdPartition(Uuid.randomUuid(), new TopicPartition("Leader", 0));
+    private final String leaderTopic = "Leader";
     private final TopicIdPartition followerTopicIdPartition = new TopicIdPartition(Uuid.randomUuid(), new TopicPartition("Follower", 0));
     private final Map<String, Uuid> topicIds = new HashMap<>();
     private final TopicPartition tp = new TopicPartition("TestTopic", 5);
@@ -211,7 +212,6 @@ public class RemoteLogManagerTest {
         remoteLogManagerConfig = createRLMConfig(props);
         brokerTopicStats = new BrokerTopicStats(Optional.of(KafkaConfig.fromProps(props)));
 
-        kafka.utils.TestUtils.clearYammerMetrics();
         remoteLogManager = new RemoteLogManager(remoteLogManagerConfig, brokerId, logDir, clusterId, time,
                 tp -> Optional.of(mockLog),
                 (topicPartition, offset) -> currentLogStartOffset.set(offset),
@@ -235,6 +235,7 @@ public class RemoteLogManagerTest {
             remoteLogManager.close();
             remoteLogManager = null;
         }
+        kafka.utils.TestUtils.clearYammerMetrics();
     }
 
     @Test
@@ -733,29 +734,39 @@ public class RemoteLogManagerTest {
 
         // before running tasks, the remote log manager tasks should be all idle and the remote log metadata count should be 0
         assertEquals(1.0, (double) yammerMetricValue("RemoteLogManagerTasksAvgIdlePercent"));
-        assertEquals(0, safeLongYammerMetricValue("RemoteLogMetadataCount,topic=" + leaderTopicIdPartition.topic()));
-        assertEquals(0, safeLongYammerMetricValue("RemoteLogSizeBytes,topic=" + leaderTopicIdPartition.topic()));
+        assertEquals(0, safeLongYammerMetricValue("RemoteLogMetadataCount,topic=" + leaderTopic));
+        assertEquals(0, safeLongYammerMetricValue("RemoteLogSizeBytes,topic=" + leaderTopic));
+        assertEquals(0, safeLongYammerMetricValue("RemoteLogMetadataCount"));
+        assertEquals(0, safeLongYammerMetricValue("RemoteLogSizeBytes"));
         remoteLogManager.onLeadershipChange(Collections.singleton(mockLeaderPartition), Collections.singleton(mockFollowerPartition), topicIds);
         assertTrue((double) yammerMetricValue("RemoteLogManagerTasksAvgIdlePercent") < 1.0);
 
         copyLogSegmentLatch.countDown();
 
         // Now, the `RemoteLogMetadataCount` should set to the expected value
-        TestUtils.waitForCondition(() -> safeLongYammerMetricValue("RemoteLogMetadataCount,topic=" + leaderTopicIdPartition.topic()) == segmentCount,
+        TestUtils.waitForCondition(() -> safeLongYammerMetricValue("RemoteLogMetadataCount,topic=" + leaderTopic) == segmentCount &&
+                        safeLongYammerMetricValue("RemoteLogMetadataCount") == segmentCount,
                 "Didn't show the expected RemoteLogMetadataCount metric value.");
 
         TestUtils.waitForCondition(
-                () -> 3072 == safeLongYammerMetricValue("RemoteLogSizeBytes,topic=" + leaderTopicIdPartition.topic()),
-                String.format("Expected to find 3072 for RemoteLogSizeBytes metric value, but found %d", safeLongYammerMetricValue("RemoteLogSizeBytes,topic=" + leaderTopicIdPartition.topic())));
+                () -> 3072 == safeLongYammerMetricValue("RemoteLogSizeBytes,topic=" + leaderTopic) &&
+                        3072 == safeLongYammerMetricValue("RemoteLogSizeBytes"),
+                String.format("Expected to find 3072 for RemoteLogSizeBytes metric value, but found %d for 'Leader' topic and %d for all topic",
+                        safeLongYammerMetricValue("RemoteLogSizeBytes,topic=" + leaderTopic),
+                        safeLongYammerMetricValue("RemoteLogSizeBytes")));
 
         remoteLogMetadataCountLatch.countDown();
 
-        TestUtils.waitForCondition(() -> safeLongYammerMetricValue("RemoteLogMetadataCount,topic=" + leaderTopicIdPartition.topic()) == 0,
+        TestUtils.waitForCondition(() -> safeLongYammerMetricValue("RemoteLogMetadataCount,topic=" + leaderTopic) == 0 &&
+                        safeLongYammerMetricValue("RemoteLogMetadataCount") == 0,
                 "Didn't reset to 0 for RemoteLogMetadataCount metric value when no remote log metadata.");
 
         TestUtils.waitForCondition(
-                () -> 0 == safeLongYammerMetricValue("RemoteLogSizeBytes,topic=" + leaderTopicIdPartition.topic()),
-                String.format("Didn't reset to 0 for RemoteLogSizeBytes metric value when no remote log metadata - %d.", safeLongYammerMetricValue("RemoteLogSizeBytes,topic=" + leaderTopicIdPartition.topic())));
+                () -> 0 == safeLongYammerMetricValue("RemoteLogSizeBytes,topic=" + leaderTopic) &&
+                        0 == safeLongYammerMetricValue("RemoteLogSizeBytes"),
+                String.format("Didn't reset to 0 for RemoteLogSizeBytes metric value when no remote log metadata - found %d for 'Leader' topic and %d for all topic.",
+                        safeLongYammerMetricValue("RemoteLogSizeBytes,topic=" + leaderTopic),
+                        safeLongYammerMetricValue("RemoteLogSizeBytes")));
     }
 
     @Test
@@ -861,28 +872,39 @@ public class RemoteLogManagerTest {
         when(mockLog.onlyLocalLogSegmentsCount()).thenReturn(1L);
 
         // before running tasks, the metric should not be registered
-        assertThrows(NoSuchElementException.class, () -> yammerMetricValue("RemoteCopyLagBytes"));
-        assertThrows(NoSuchElementException.class, () -> yammerMetricValue("RemoteCopyLagSegments"));
-        assertThrows(NoSuchElementException.class, () -> yammerMetricValue("RemoteLogSizeComputationTime"));
+        assertThrows(NoSuchElementException.class, () -> yammerMetricValue("RemoteCopyLagBytes,topic=" + leaderTopic));
+        assertThrows(NoSuchElementException.class, () -> yammerMetricValue("RemoteCopyLagSegments,topic=" + leaderTopic));
+        assertThrows(NoSuchElementException.class, () -> yammerMetricValue("RemoteLogSizeComputationTime,topic=" + leaderTopic));
+        // all topic metrics should be 0
+        assertEquals(0L, yammerMetricValue("RemoteCopyLagBytes"));
+        assertEquals(0L, yammerMetricValue("RemoteCopyLagSegments"));
+        assertEquals(0L, yammerMetricValue("RemoteLogSizeComputationTime"));
+
         remoteLogManager.onLeadershipChange(Collections.singleton(mockLeaderPartition), Collections.emptySet(), topicIds);
         TestUtils.waitForCondition(
-                () -> 75 == safeLongYammerMetricValue("RemoteCopyLagBytes"),
-                String.format("Expected to find 75 for RemoteCopyLagBytes metric value, but found %d", safeLongYammerMetricValue("RemoteCopyLagBytes")));
+                () -> 75 == safeLongYammerMetricValue("RemoteCopyLagBytes") && 75 == safeLongYammerMetricValue("RemoteCopyLagBytes,topic=" + leaderTopic),
+                String.format("Expected to find 75 for RemoteCopyLagBytes metric value, but found %d for topic 'Leader' and %d for all topics.",
+                        safeLongYammerMetricValue("RemoteCopyLagBytes,topic=" + leaderTopic),
+                        safeLongYammerMetricValue("RemoteCopyLagBytes")));
         TestUtils.waitForCondition(
-                () -> 1 == safeLongYammerMetricValue("RemoteCopyLagSegments"),
-                String.format("Expected to find 1 for RemoteCopyLagSegments metric value, but found %d", safeLongYammerMetricValue("RemoteCopyLagSegments")));
+                () -> 1 == safeLongYammerMetricValue("RemoteCopyLagSegments") && 1 == safeLongYammerMetricValue("RemoteCopyLagSegments,topic=" + leaderTopic),
+                String.format("Expected to find 1 for RemoteCopyLagSegments metric value, but found %d for topic 'Leader' and %d for all topics.",
+                        safeLongYammerMetricValue("RemoteCopyLagSegments,topic=" + leaderTopic),
+                        safeLongYammerMetricValue("RemoteCopyLagSegments")));
         // unlock copyLogSegmentData
         latch.countDown();
 
         TestUtils.waitForCondition(
-                () -> safeLongYammerMetricValue("RemoteLogSizeComputationTime") >= 1000,
-                String.format("Expected to find 1000 for RemoteLogSizeComputationTime metric value, but found %d", safeLongYammerMetricValue("RemoteLogSizeComputationTime")));
+                () -> safeLongYammerMetricValue("RemoteLogSizeComputationTime") >= 1000 && safeLongYammerMetricValue("RemoteLogSizeComputationTime,topic=" + leaderTopic) >= 1000,
+                String.format("Expected to find 1000 for RemoteLogSizeComputationTime metric value, but found %d for topic 'Leader' and %d for all topics.",
+                        safeLongYammerMetricValue("RemoteLogSizeComputationTime,topic=" + leaderTopic),
+                        safeLongYammerMetricValue("RemoteLogSizeComputationTime")));
         remoteLogSizeComputationTimeLatch.countDown();
     }
 
     private Object yammerMetricValue(String name) {
         Gauge gauge = (Gauge) KafkaYammerMetrics.defaultRegistry().allMetrics().entrySet().stream()
-                .filter(e -> e.getKey().getMBeanName().contains(name))
+                .filter(e -> e.getKey().getMBeanName().endsWith(name))
                 .findFirst()
                 .get()
                 .getValue();
@@ -1863,21 +1885,32 @@ public class RemoteLogManagerTest {
         doAnswer(ans -> {
             assertEquals(2048, safeLongYammerMetricValue("RemoteDeleteLagBytes"),
                 String.format("Expected to find 2048 for RemoteDeleteLagBytes metric value, but found %d", safeLongYammerMetricValue("RemoteDeleteLagBytes")));
+            assertEquals(2048, safeLongYammerMetricValue("RemoteDeleteLagBytes,topic=" + leaderTopic),
+                    String.format("Expected to find 2048 for RemoteDeleteLagBytes for 'Leader' topic metric value, but found %d", safeLongYammerMetricValue("RemoteDeleteLagBytes,topic=" + leaderTopic)));
             assertEquals(2, safeLongYammerMetricValue("RemoteDeleteLagSegments"),
                 String.format("Expected to find 2 for RemoteDeleteLagSegments metric value, but found %d", safeLongYammerMetricValue("RemoteDeleteLagSegments")));
+            assertEquals(2, safeLongYammerMetricValue("RemoteDeleteLagSegments,topic=" + leaderTopic),
+                    String.format("Expected to find 2 for RemoteDeleteLagSegments for 'Leader' topic metric value, but found %d", safeLongYammerMetricValue("RemoteDeleteLagSegments,topic=" + leaderTopic)));
             return Optional.empty();
         }).doAnswer(ans -> {
             assertEquals(1024, safeLongYammerMetricValue("RemoteDeleteLagBytes"),
                 String.format("Expected to find 1024 for RemoteDeleteLagBytes metric value, but found %d", safeLongYammerMetricValue("RemoteDeleteLagBytes")));
-            assertEquals(1, safeLongYammerMetricValue("RemoteDeleteLagSegments"),
-                String.format("Expected to find 1 for RemoteDeleteLagSegments metric value, but found %d", safeLongYammerMetricValue("RemoteDeleteLagSegments")));
+            assertEquals(1, safeLongYammerMetricValue("RemoteDeleteLagSegments,topic=" + leaderTopic),
+                String.format("Expected to find 1 for RemoteDeleteLagSegments for 'Leader' topic metric value, but found %d", safeLongYammerMetricValue("RemoteDeleteLagSegments,topic=" + leaderTopic)));
+            assertEquals(1024, safeLongYammerMetricValue("RemoteDeleteLagBytes"),
+                    String.format("Expected to find 1024 for RemoteDeleteLagBytes metric value, but found %d", safeLongYammerMetricValue("RemoteDeleteLagBytes")));
+            assertEquals(1, safeLongYammerMetricValue("RemoteDeleteLagSegments,topic=" + leaderTopic),
+                    String.format("Expected to find 1 for RemoteDeleteLagSegments for 'Leader' topic metric value, but found %d", safeLongYammerMetricValue("RemoteDeleteLagSegments,topic=" + leaderTopic)));
             return Optional.empty();
         }).when(remoteStorageManager).deleteLogSegmentData(any(RemoteLogSegmentMetadata.class));
 
         RemoteLogManager.RLMTask task = remoteLogManager.new RLMTask(leaderTopicIdPartition, 128);
 
-        assertThrows(NoSuchElementException.class, () -> yammerMetricValue("RemoteDeleteLagBytes"));
-        assertThrows(NoSuchElementException.class, () -> yammerMetricValue("RemoteDeleteLagSegments"));
+        assertEquals(0L, yammerMetricValue("RemoteDeleteLagBytes"));
+        assertEquals(0L, yammerMetricValue("RemoteDeleteLagSegments"));
+
+        assertEquals(0L, safeLongYammerMetricValue("RemoteDeleteLagBytes,topic=" + leaderTopic));
+        assertEquals(0L, safeLongYammerMetricValue("RemoteDeleteLagSegments,topic=" + leaderTopic));
 
         task.convertToLeader(0);
         task.cleanupExpiredRemoteLogSegments();
diff --git a/core/src/test/scala/kafka/server/KafkaRequestHandlerTest.scala b/core/src/test/scala/kafka/server/KafkaRequestHandlerTest.scala
index 13553c272c..ba584c9a6e 100644
--- a/core/src/test/scala/kafka/server/KafkaRequestHandlerTest.scala
+++ b/core/src/test/scala/kafka/server/KafkaRequestHandlerTest.scala
@@ -40,6 +40,13 @@ import java.util.concurrent.CompletableFuture
 import java.util.concurrent.atomic.AtomicInteger
 
 class KafkaRequestHandlerTest {
+  val props = kafka.utils.TestUtils.createDummyBrokerConfig()
+  props.setProperty(RemoteLogManagerConfig.REMOTE_LOG_STORAGE_SYSTEM_ENABLE_PROP, true.toString)
+  val brokerTopicStats = new BrokerTopicStats(java.util.Optional.of(KafkaConfig.fromProps(props)))
+  val topic = "topic"
+  val topic2 = "topic2"
+  val brokerTopicMetrics = brokerTopicStats.topicStats(topic)
+  val allTopicMetrics = brokerTopicStats.allTopicsStats
 
   @Test
   def testCallbackTiming(): Unit = {
@@ -188,11 +195,10 @@ class KafkaRequestHandlerTest {
   @ParameterizedTest
   @ValueSource(booleans = Array(true, false))
   def testTopicStats(systemRemoteStorageEnabled: Boolean): Unit = {
-    val topic = "topic"
     val props = kafka.utils.TestUtils.createDummyBrokerConfig()
     props.setProperty(RemoteLogManagerConfig.REMOTE_LOG_STORAGE_SYSTEM_ENABLE_PROP, systemRemoteStorageEnabled.toString)
     val brokerTopicStats = new BrokerTopicStats(java.util.Optional.of(KafkaConfig.fromProps(props)))
-    brokerTopicStats.topicStats(topic)
+    val brokerTopicMetrics = brokerTopicStats.topicStats(topic)
     val gaugeMetrics = Set(
       RemoteStorageMetrics.REMOTE_LOG_SIZE_COMPUTATION_TIME_METRIC.getName,
       RemoteStorageMetrics.REMOTE_COPY_LAG_BYTES_METRIC.getName,
@@ -206,19 +212,19 @@ class KafkaRequestHandlerTest {
     RemoteStorageMetrics.brokerTopicStatsMetrics.forEach(metric => {
       if (systemRemoteStorageEnabled) {
         if (!gaugeMetrics.contains(metric.getName)) {
-          assertTrue(brokerTopicStats.topicStats(topic).metricMap.contains(metric.getName), "the metric is missing: " + metric.getName)
+          assertTrue(brokerTopicMetrics.metricMap.contains(metric.getName), "the metric is missing: " + metric.getName)
         } else {
-          assertFalse(brokerTopicStats.topicStats(topic).metricMap.contains(metric.getName), "the metric should not appear: " + metric.getName)
+          assertFalse(brokerTopicMetrics.metricMap.contains(metric.getName), "the metric should not appear: " + metric.getName)
         }
       } else {
-        assertFalse(brokerTopicStats.topicStats(topic).metricMap.contains(metric.getName))
+        assertFalse(brokerTopicMetrics.metricMap.contains(metric.getName))
       }
     })
     gaugeMetrics.foreach(metricName => {
       if (systemRemoteStorageEnabled) {
-        assertTrue(brokerTopicStats.topicStats(topic).metricGaugeMap.contains(metricName), "The metric is missing:" + metricName)
+        assertTrue(brokerTopicMetrics.metricGaugeMap.contains(metricName), "The metric is missing:" + metricName)
       } else {
-        assertFalse(brokerTopicStats.topicStats(topic).metricGaugeMap.contains(metricName), "The metric should appear:" + metricName)
+        assertFalse(brokerTopicMetrics.metricGaugeMap.contains(metricName), "The metric should appear:" + metricName)
       }
     })
   }
@@ -245,329 +251,361 @@ class KafkaRequestHandlerTest {
   @ParameterizedTest
   @ValueSource(booleans = Array(true, false))
   def testSingularCopyLagBytesMetric(systemRemoteStorageEnabled: Boolean): Unit = {
-    val brokerTopicMetrics = setupBrokerTopicMetrics(systemRemoteStorageEnabled)
+    val props = kafka.utils.TestUtils.createDummyBrokerConfig()
+    props.setProperty(RemoteLogManagerConfig.REMOTE_LOG_STORAGE_SYSTEM_ENABLE_PROP, systemRemoteStorageEnabled.toString)
+    val brokerTopicStats = new BrokerTopicStats(java.util.Optional.of(KafkaConfig.fromProps(props)))
+    val brokerTopicMetrics = brokerTopicStats.topicStats(topic)
 
     if (systemRemoteStorageEnabled) {
-      brokerTopicMetrics.recordRemoteCopyLagBytes(0, 100);
-      brokerTopicMetrics.recordRemoteCopyLagBytes(1, 150);
-      brokerTopicMetrics.recordRemoteCopyLagBytes(2, 250);
+      brokerTopicStats.recordRemoteCopyLagBytes(topic, 0, 100)
+      brokerTopicStats.recordRemoteCopyLagBytes(topic, 1, 150)
+      brokerTopicStats.recordRemoteCopyLagBytes(topic, 2, 250)
       assertEquals(500, brokerTopicMetrics.remoteCopyLagBytes)
+      assertEquals(500, brokerTopicStats.allTopicsStats.remoteCopyLagBytes)
+      brokerTopicStats.recordRemoteCopyLagBytes(topic2, 0, 100)
+      assertEquals(600, brokerTopicStats.allTopicsStats.remoteCopyLagBytes)
     } else {
       assertEquals(None, brokerTopicMetrics.metricGaugeMap.get(RemoteStorageMetrics.REMOTE_COPY_LAG_BYTES_METRIC.getName))
+      assertEquals(None, brokerTopicStats.allTopicsStats.metricGaugeMap.get(RemoteStorageMetrics.REMOTE_COPY_LAG_BYTES_METRIC.getName))
     }
   }
 
   @Test
   def testMultipleCopyLagBytesMetrics(): Unit = {
-    val brokerTopicMetrics = setupBrokerTopicMetrics()
-
-    brokerTopicMetrics.recordRemoteCopyLagBytes(0, 1);
-    brokerTopicMetrics.recordRemoteCopyLagBytes(1, 2);
-    brokerTopicMetrics.recordRemoteCopyLagBytes(2, 3);
+    brokerTopicStats.recordRemoteCopyLagBytes(topic, 0, 1)
+    brokerTopicStats.recordRemoteCopyLagBytes(topic, 1, 2)
+    brokerTopicStats.recordRemoteCopyLagBytes(topic, 2, 3)
 
-    brokerTopicMetrics.recordRemoteCopyLagBytes(0, 4);
-    brokerTopicMetrics.recordRemoteCopyLagBytes(1, 5);
-    brokerTopicMetrics.recordRemoteCopyLagBytes(2, 6);
+    brokerTopicStats.recordRemoteCopyLagBytes(topic, 0, 4)
+    brokerTopicStats.recordRemoteCopyLagBytes(topic, 1, 5)
+    brokerTopicStats.recordRemoteCopyLagBytes(topic, 2, 6)
 
     assertEquals(15, brokerTopicMetrics.remoteCopyLagBytes)
+    assertEquals(15, allTopicMetrics.remoteCopyLagBytes)
+    brokerTopicStats.recordRemoteCopyLagBytes(topic2, 2, 5)
+    assertEquals(20, allTopicMetrics.remoteCopyLagBytes)
   }
 
   @Test
   def testCopyLagBytesMetricWithPartitionExpansion(): Unit = {
-    val brokerTopicMetrics = setupBrokerTopicMetrics()
-
-    brokerTopicMetrics.recordRemoteCopyLagBytes(0, 1);
-    brokerTopicMetrics.recordRemoteCopyLagBytes(1, 2);
+    brokerTopicStats.recordRemoteCopyLagBytes(topic, 0, 1)
+    brokerTopicStats.recordRemoteCopyLagBytes(topic, 1, 2)
 
     assertEquals(3, brokerTopicMetrics.remoteCopyLagBytes)
+    assertEquals(3, allTopicMetrics.remoteCopyLagBytes)
 
-    brokerTopicMetrics.recordRemoteCopyLagBytes(2, 3);
+    brokerTopicStats.recordRemoteCopyLagBytes(topic, 2, 3)
 
     assertEquals(6, brokerTopicMetrics.remoteCopyLagBytes)
+    assertEquals(6, allTopicMetrics.remoteCopyLagBytes)
+    brokerTopicStats.recordRemoteCopyLagBytes(topic2, 0, 1)
+    assertEquals(7, allTopicMetrics.remoteCopyLagBytes)
   }
 
   @Test
   def testCopyLagBytesMetricWithPartitionShrinking(): Unit = {
-    val brokerTopicMetrics = setupBrokerTopicMetrics()
-
-    brokerTopicMetrics.recordRemoteCopyLagBytes(0, 1);
-    brokerTopicMetrics.recordRemoteCopyLagBytes(1, 2);
+    brokerTopicStats.recordRemoteCopyLagBytes(topic, 0, 1)
+    brokerTopicStats.recordRemoteCopyLagBytes(topic, 1, 2)
 
     assertEquals(3, brokerTopicMetrics.remoteCopyLagBytes)
+    assertEquals(3, allTopicMetrics.remoteCopyLagBytes)
 
-    brokerTopicMetrics.removeRemoteCopyLagBytes(1);
+    brokerTopicStats.removeRemoteCopyLagBytes(topic, 1)
 
     assertEquals(1, brokerTopicMetrics.remoteCopyLagBytes)
+    assertEquals(1, allTopicMetrics.remoteCopyLagBytes)
+
+    brokerTopicStats.recordRemoteCopyLagBytes(topic2, 0, 1)
+    assertEquals(2, allTopicMetrics.remoteCopyLagBytes)
   }
 
   @Test
   def testCopyLagBytesMetricWithRemovingNonexistentPartitions(): Unit = {
-    val brokerTopicMetrics = setupBrokerTopicMetrics()
-
-    brokerTopicMetrics.recordRemoteCopyLagBytes(0, 1);
-    brokerTopicMetrics.recordRemoteCopyLagBytes(1, 2);
+    brokerTopicStats.recordRemoteCopyLagBytes(topic, 0, 1)
+    brokerTopicStats.recordRemoteCopyLagBytes(topic, 1, 2)
 
     assertEquals(3, brokerTopicMetrics.remoteCopyLagBytes)
+    assertEquals(3, allTopicMetrics.remoteCopyLagBytes)
 
-    brokerTopicMetrics.removeRemoteCopyLagBytes(3);
+
+    brokerTopicStats.removeRemoteCopyLagBytes(topic, 3)
 
     assertEquals(3, brokerTopicMetrics.remoteCopyLagBytes)
+    assertEquals(3, allTopicMetrics.remoteCopyLagBytes)
   }
 
   @Test
   def testCopyLagBytesMetricClear(): Unit = {
-    val brokerTopicMetrics = setupBrokerTopicMetrics()
-
-    brokerTopicMetrics.recordRemoteCopyLagBytes(0, 1);
-    brokerTopicMetrics.recordRemoteCopyLagBytes(1, 2);
+    brokerTopicStats.recordRemoteCopyLagBytes(topic, 0, 1)
+    brokerTopicStats.recordRemoteCopyLagBytes(topic, 1, 2)
 
     assertEquals(3, brokerTopicMetrics.remoteCopyLagBytes)
+    assertEquals(3, allTopicMetrics.remoteCopyLagBytes)
 
-    brokerTopicMetrics.close()
+    brokerTopicStats.close()
 
     assertEquals(0, brokerTopicMetrics.remoteCopyLagBytes)
+    assertEquals(0, allTopicMetrics.remoteCopyLagBytes)
+
+    brokerTopicStats.recordRemoteCopyLagBytes(topic2, 0, 1)
+    assertEquals(1, allTopicMetrics.remoteCopyLagBytes)
   }
 
   @Test
   def testMultipleCopyLagSegmentsMetrics(): Unit = {
-    val brokerTopicMetrics = setupBrokerTopicMetrics()
-
-    brokerTopicMetrics.recordRemoteCopyLagSegments(0, 1);
-    brokerTopicMetrics.recordRemoteCopyLagSegments(1, 2);
-    brokerTopicMetrics.recordRemoteCopyLagSegments(2, 3);
+    brokerTopicStats.recordRemoteCopyLagSegments(topic, 0, 1)
+    brokerTopicStats.recordRemoteCopyLagSegments(topic, 1, 2)
+    brokerTopicStats.recordRemoteCopyLagSegments(topic, 2, 3)
 
-    brokerTopicMetrics.recordRemoteCopyLagSegments(0, 4);
-    brokerTopicMetrics.recordRemoteCopyLagSegments(1, 5);
-    brokerTopicMetrics.recordRemoteCopyLagSegments(2, 6);
+    brokerTopicStats.recordRemoteCopyLagSegments(topic, 0, 4)
+    brokerTopicStats.recordRemoteCopyLagSegments(topic, 1, 5)
+    brokerTopicStats.recordRemoteCopyLagSegments(topic, 2, 6)
 
     assertEquals(15, brokerTopicMetrics.remoteCopyLagSegments)
+    assertEquals(15, allTopicMetrics.remoteCopyLagSegments)
+
+    brokerTopicStats.recordRemoteCopyLagSegments(topic2, 0, 1)
+    assertEquals(16, allTopicMetrics.remoteCopyLagSegments)
   }
 
   @Test
   def testCopyLagSegmentsMetricWithPartitionExpansion(): Unit = {
-    val brokerTopicMetrics = setupBrokerTopicMetrics()
-
-    brokerTopicMetrics.recordRemoteCopyLagSegments(0, 1);
-    brokerTopicMetrics.recordRemoteCopyLagSegments(1, 2);
+    brokerTopicStats.recordRemoteCopyLagSegments(topic, 0, 1)
+    brokerTopicStats.recordRemoteCopyLagSegments(topic, 1, 2)
 
     assertEquals(3, brokerTopicMetrics.remoteCopyLagSegments)
+    assertEquals(3, allTopicMetrics.remoteCopyLagSegments)
 
-    brokerTopicMetrics.recordRemoteCopyLagSegments(2, 3);
+    brokerTopicStats.recordRemoteCopyLagSegments(topic, 2, 3)
 
     assertEquals(6, brokerTopicMetrics.remoteCopyLagSegments)
+    assertEquals(6, allTopicMetrics.remoteCopyLagSegments)
   }
 
   @Test
   def testCopyLagSegmentsMetricWithPartitionShrinking(): Unit = {
-    val brokerTopicMetrics = setupBrokerTopicMetrics()
-
-    brokerTopicMetrics.recordRemoteCopyLagSegments(0, 1);
-    brokerTopicMetrics.recordRemoteCopyLagSegments(1, 2);
+    brokerTopicStats.recordRemoteCopyLagSegments(topic, 0, 1)
+    brokerTopicStats.recordRemoteCopyLagSegments(topic, 1, 2)
 
     assertEquals(3, brokerTopicMetrics.remoteCopyLagSegments)
+    assertEquals(3, allTopicMetrics.remoteCopyLagSegments)
 
-    brokerTopicMetrics.removeRemoteCopyLagSegments(1);
+    brokerTopicStats.removeRemoteCopyLagSegments(topic, 1)
 
     assertEquals(1, brokerTopicMetrics.remoteCopyLagSegments)
+    assertEquals(1, allTopicMetrics.remoteCopyLagSegments)
   }
 
   @Test
   def testCopyLagSegmentsMetricWithRemovingNonexistentPartitions(): Unit = {
-    val brokerTopicMetrics = setupBrokerTopicMetrics()
-
-    brokerTopicMetrics.recordRemoteCopyLagSegments(0, 1);
-    brokerTopicMetrics.recordRemoteCopyLagSegments(1, 2);
+    brokerTopicStats.recordRemoteCopyLagSegments(topic, 0, 1)
+    brokerTopicStats.recordRemoteCopyLagSegments(topic, 1, 2)
 
     assertEquals(3, brokerTopicMetrics.remoteCopyLagSegments)
+    assertEquals(3, allTopicMetrics.remoteCopyLagSegments)
 
-    brokerTopicMetrics.removeRemoteCopyLagSegments(3);
+    brokerTopicStats.removeRemoteCopyLagSegments(topic, 3)
 
     assertEquals(3, brokerTopicMetrics.remoteCopyLagSegments)
+    assertEquals(3, allTopicMetrics.remoteCopyLagSegments)
   }
 
   @Test
   def testCopyLagSegmentsMetricClear(): Unit = {
-    val brokerTopicMetrics = setupBrokerTopicMetrics()
-
-    brokerTopicMetrics.recordRemoteCopyLagSegments(0, 1);
-    brokerTopicMetrics.recordRemoteCopyLagSegments(1, 2);
+    brokerTopicStats.recordRemoteCopyLagSegments(topic, 0, 1)
+    brokerTopicStats.recordRemoteCopyLagSegments(topic, 1, 2)
 
     assertEquals(3, brokerTopicMetrics.remoteCopyLagSegments)
+    assertEquals(3, allTopicMetrics.remoteCopyLagSegments)
 
-    brokerTopicMetrics.close()
+    brokerTopicStats.close()
 
     assertEquals(0, brokerTopicMetrics.remoteCopyLagSegments)
+    assertEquals(0, allTopicMetrics.remoteCopyLagSegments)
+
   }
 
   @Test
   def testMultipleDeleteLagBytesMetrics(): Unit = {
-    val brokerTopicMetrics = setupBrokerTopicMetrics()
+    brokerTopicStats.recordRemoteDeleteLagBytes(topic, 0, 1)
+    brokerTopicStats.recordRemoteDeleteLagBytes(topic, 1, 2)
+    brokerTopicStats.recordRemoteDeleteLagBytes(topic, 2, 3)
 
-    brokerTopicMetrics.recordRemoteDeleteLagBytes(0, 1);
-    brokerTopicMetrics.recordRemoteDeleteLagBytes(1, 2);
-    brokerTopicMetrics.recordRemoteDeleteLagBytes(2, 3);
-
-    brokerTopicMetrics.recordRemoteDeleteLagBytes(0, 4);
-    brokerTopicMetrics.recordRemoteDeleteLagBytes(1, 5);
-    brokerTopicMetrics.recordRemoteDeleteLagBytes(2, 6);
+    brokerTopicStats.recordRemoteDeleteLagBytes(topic, 0, 4)
+    brokerTopicStats.recordRemoteDeleteLagBytes(topic, 1, 5)
+    brokerTopicStats.recordRemoteDeleteLagBytes(topic, 2, 6)
 
     assertEquals(15, brokerTopicMetrics.remoteDeleteLagBytes)
+    assertEquals(15, allTopicMetrics.remoteDeleteLagBytes)
+
+    brokerTopicStats.recordRemoteDeleteLagBytes(topic2, 0, 1)
+    assertEquals(16, allTopicMetrics.remoteDeleteLagBytes)
   }
 
   @Test
   def testDeleteLagBytesMetricWithPartitionExpansion(): Unit = {
-    val brokerTopicMetrics = setupBrokerTopicMetrics()
-
-    brokerTopicMetrics.recordRemoteDeleteLagBytes(0, 1);
-    brokerTopicMetrics.recordRemoteDeleteLagBytes(1, 2);
+    brokerTopicStats.recordRemoteDeleteLagBytes(topic, 0, 1)
+    brokerTopicStats.recordRemoteDeleteLagBytes(topic, 1, 2)
 
     assertEquals(3, brokerTopicMetrics.remoteDeleteLagBytes)
+    assertEquals(3, allTopicMetrics.remoteDeleteLagBytes)
 
-    brokerTopicMetrics.recordRemoteDeleteLagBytes(2, 3);
+    brokerTopicStats.recordRemoteDeleteLagBytes(topic, 2, 3)
 
     assertEquals(6, brokerTopicMetrics.remoteDeleteLagBytes)
+    assertEquals(6, allTopicMetrics.remoteDeleteLagBytes)
   }
 
   @Test
   def testDeleteLagBytesMetricWithPartitionShrinking(): Unit = {
-    val brokerTopicMetrics = setupBrokerTopicMetrics()
-
-    brokerTopicMetrics.recordRemoteDeleteLagBytes(0, 1);
-    brokerTopicMetrics.recordRemoteDeleteLagBytes(1, 2);
+    brokerTopicStats.recordRemoteDeleteLagBytes(topic, 0, 1)
+    brokerTopicStats.recordRemoteDeleteLagBytes(topic, 1, 2)
 
     assertEquals(3, brokerTopicMetrics.remoteDeleteLagBytes)
+    assertEquals(3, allTopicMetrics.remoteDeleteLagBytes)
 
-    brokerTopicMetrics.removeRemoteDeleteLagBytes(1);
+    brokerTopicStats.removeRemoteDeleteLagBytes(topic, 1)
 
     assertEquals(1, brokerTopicMetrics.remoteDeleteLagBytes)
+    assertEquals(1, allTopicMetrics.remoteDeleteLagBytes)
   }
 
   @Test
   def testDeleteLagBytesMetricWithRemovingNonexistentPartitions(): Unit = {
-    val brokerTopicMetrics = setupBrokerTopicMetrics()
-
-    brokerTopicMetrics.recordRemoteDeleteLagBytes(0, 1);
-    brokerTopicMetrics.recordRemoteDeleteLagBytes(1, 2);
+    brokerTopicStats.recordRemoteDeleteLagBytes(topic, 0, 1)
+    brokerTopicStats.recordRemoteDeleteLagBytes(topic, 1, 2)
 
     assertEquals(3, brokerTopicMetrics.remoteDeleteLagBytes)
+    assertEquals(3, allTopicMetrics.remoteDeleteLagBytes)
 
-    brokerTopicMetrics.removeRemoteDeleteLagBytes(3);
+    brokerTopicStats.removeRemoteDeleteLagBytes(topic, 3)
 
     assertEquals(3, brokerTopicMetrics.remoteDeleteLagBytes)
+    assertEquals(3, allTopicMetrics.remoteDeleteLagBytes)
   }
 
   @Test
   def testDeleteLagBytesMetricClear(): Unit = {
-    val brokerTopicMetrics = setupBrokerTopicMetrics()
-
-    brokerTopicMetrics.recordRemoteDeleteLagBytes(0, 1);
-    brokerTopicMetrics.recordRemoteDeleteLagBytes(1, 2);
+    brokerTopicStats.recordRemoteDeleteLagBytes(topic, 0, 1)
+    brokerTopicStats.recordRemoteDeleteLagBytes(topic, 1, 2)
 
     assertEquals(3, brokerTopicMetrics.remoteDeleteLagBytes)
+    assertEquals(3, allTopicMetrics.remoteDeleteLagBytes)
 
-    brokerTopicMetrics.close()
+    brokerTopicStats.close()
 
     assertEquals(0, brokerTopicMetrics.remoteDeleteLagBytes)
+    assertEquals(0, allTopicMetrics.remoteDeleteLagBytes)
   }
 
   @Test
   def testMultipleDeleteLagSegmentsMetrics(): Unit = {
-    val brokerTopicMetrics = setupBrokerTopicMetrics()
-
-    brokerTopicMetrics.recordRemoteDeleteLagSegments(0, 1);
-    brokerTopicMetrics.recordRemoteDeleteLagSegments(1, 2);
-    brokerTopicMetrics.recordRemoteDeleteLagSegments(2, 3);
+    brokerTopicStats.recordRemoteDeleteLagSegments(topic, 0, 1)
+    brokerTopicStats.recordRemoteDeleteLagSegments(topic, 1, 2)
+    brokerTopicStats.recordRemoteDeleteLagSegments(topic, 2, 3)
 
-    brokerTopicMetrics.recordRemoteDeleteLagSegments(0, 4);
-    brokerTopicMetrics.recordRemoteDeleteLagSegments(1, 5);
-    brokerTopicMetrics.recordRemoteDeleteLagSegments(2, 6);
+    brokerTopicStats.recordRemoteDeleteLagSegments(topic, 0, 4)
+    brokerTopicStats.recordRemoteDeleteLagSegments(topic, 1, 5)
+    brokerTopicStats.recordRemoteDeleteLagSegments(topic, 2, 6)
 
     assertEquals(15, brokerTopicMetrics.remoteDeleteLagSegments)
+    assertEquals(15, allTopicMetrics.remoteDeleteLagSegments)
+
+    brokerTopicStats.recordRemoteDeleteLagSegments(topic2, 1, 5)
+    assertEquals(20, allTopicMetrics.remoteDeleteLagSegments)
   }
 
   @Test
   def testDeleteLagSegmentsMetricWithPartitionExpansion(): Unit = {
-    val brokerTopicMetrics = setupBrokerTopicMetrics()
-
-    brokerTopicMetrics.recordRemoteDeleteLagSegments(0, 1);
-    brokerTopicMetrics.recordRemoteDeleteLagSegments(1, 2);
+    brokerTopicStats.recordRemoteDeleteLagSegments(topic, 0, 1)
+    brokerTopicStats.recordRemoteDeleteLagSegments(topic, 1, 2)
 
     assertEquals(3, brokerTopicMetrics.remoteDeleteLagSegments)
+    assertEquals(3, allTopicMetrics.remoteDeleteLagSegments)
 
-    brokerTopicMetrics.recordRemoteDeleteLagSegments(2, 3);
+    brokerTopicStats.recordRemoteDeleteLagSegments(topic, 2, 3)
 
     assertEquals(6, brokerTopicMetrics.remoteDeleteLagSegments)
+    assertEquals(6, allTopicMetrics.remoteDeleteLagSegments)
   }
 
   @Test
   def testDeleteLagSegmentsMetricWithPartitionShrinking(): Unit = {
-    val brokerTopicMetrics = setupBrokerTopicMetrics()
-
-    brokerTopicMetrics.recordRemoteDeleteLagSegments(0, 1);
-    brokerTopicMetrics.recordRemoteDeleteLagSegments(1, 2);
+    brokerTopicStats.recordRemoteDeleteLagSegments(topic, 0, 1)
+    brokerTopicStats.recordRemoteDeleteLagSegments(topic, 1, 2)
 
     assertEquals(3, brokerTopicMetrics.remoteDeleteLagSegments)
+    assertEquals(3, allTopicMetrics.remoteDeleteLagSegments)
 
-    brokerTopicMetrics.removeRemoteDeleteLagSegments(1);
+    brokerTopicStats.removeRemoteDeleteLagSegments(topic, 1)
 
     assertEquals(1, brokerTopicMetrics.remoteDeleteLagSegments)
+    assertEquals(1, allTopicMetrics.remoteDeleteLagSegments)
   }
 
   @Test
   def testDeleteLagSegmentsMetricWithRemovingNonexistentPartitions(): Unit = {
-    val brokerTopicMetrics = setupBrokerTopicMetrics()
-
-    brokerTopicMetrics.recordRemoteDeleteLagSegments(0, 1);
-    brokerTopicMetrics.recordRemoteDeleteLagSegments(1, 2);
+    brokerTopicStats.recordRemoteDeleteLagSegments(topic, 0, 1)
+    brokerTopicStats.recordRemoteDeleteLagSegments(topic, 1, 2)
 
     assertEquals(3, brokerTopicMetrics.remoteDeleteLagSegments)
+    assertEquals(3, allTopicMetrics.remoteDeleteLagSegments)
 
-    brokerTopicMetrics.removeRemoteDeleteLagSegments(3);
+    brokerTopicStats.removeRemoteDeleteLagSegments(topic, 3)
 
     assertEquals(3, brokerTopicMetrics.remoteDeleteLagSegments)
+    assertEquals(3, allTopicMetrics.remoteDeleteLagSegments)
   }
 
   @Test
   def testDeleteLagSegmentsMetricClear(): Unit = {
-    val brokerTopicMetrics = setupBrokerTopicMetrics()
-
-    brokerTopicMetrics.recordRemoteDeleteLagSegments(0, 1);
-    brokerTopicMetrics.recordRemoteDeleteLagSegments(1, 2);
+    brokerTopicStats.recordRemoteDeleteLagSegments(topic, 0, 1)
+    brokerTopicStats.recordRemoteDeleteLagSegments(topic, 1, 2)
 
     assertEquals(3, brokerTopicMetrics.remoteDeleteLagSegments)
+    assertEquals(3, allTopicMetrics.remoteDeleteLagSegments)
 
-    brokerTopicMetrics.close()
+    brokerTopicStats.close()
 
     assertEquals(0, brokerTopicMetrics.remoteDeleteLagSegments)
+    assertEquals(0, allTopicMetrics.remoteDeleteLagSegments)
   }
 
   @Test
   def testRemoteLogMetadataCount(): Unit = {
-    val brokerTopicMetrics = setupBrokerTopicMetrics()
-
     assertEquals(0, brokerTopicMetrics.remoteLogMetadataCount)
-    brokerTopicMetrics.recordRemoteLogMetadataCount(0, 1)
+    assertEquals(0, allTopicMetrics.remoteLogMetadataCount)
+    brokerTopicStats.recordRemoteLogMetadataCount(topic, 0, 1)
     assertEquals(1, brokerTopicMetrics.remoteLogMetadataCount)
+    assertEquals(1, allTopicMetrics.remoteLogMetadataCount)
 
-    brokerTopicMetrics.recordRemoteLogMetadataCount(1, 2)
-    brokerTopicMetrics.recordRemoteLogMetadataCount(2, 3)
+    brokerTopicStats.recordRemoteLogMetadataCount(topic, 1, 2)
+    brokerTopicStats.recordRemoteLogMetadataCount(topic, 2, 3)
     assertEquals(6, brokerTopicMetrics.remoteLogMetadataCount)
+    assertEquals(6, allTopicMetrics.remoteLogMetadataCount)
 
-    brokerTopicMetrics.close()
+    brokerTopicStats.close()
 
     assertEquals(0, brokerTopicMetrics.remoteLogMetadataCount)
+    assertEquals(0, allTopicMetrics.remoteLogMetadataCount)
   }
 
   @ParameterizedTest
   @ValueSource(booleans = Array(true, false))
   def testSingularLogSizeBytesMetric(systemRemoteStorageEnabled: Boolean): Unit = {
-    val brokerTopicMetrics = setupBrokerTopicMetrics(systemRemoteStorageEnabled)
-
+    val props = kafka.utils.TestUtils.createDummyBrokerConfig()
+    props.setProperty(RemoteLogManagerConfig.REMOTE_LOG_STORAGE_SYSTEM_ENABLE_PROP, systemRemoteStorageEnabled.toString)
+    val brokerTopicStats = new BrokerTopicStats(java.util.Optional.of(KafkaConfig.fromProps(props)))
+    val brokerTopicMetrics = brokerTopicStats.topicStats(topic)
     if (systemRemoteStorageEnabled) {
-      brokerTopicMetrics.recordRemoteLogSizeBytes(0, 100);
-      brokerTopicMetrics.recordRemoteLogSizeBytes(1, 150);
-      brokerTopicMetrics.recordRemoteLogSizeBytes(2, 250);
+      brokerTopicStats.recordRemoteLogSizeBytes(topic, 0, 100)
+      brokerTopicStats.recordRemoteLogSizeBytes(topic, 1, 150)
+      brokerTopicStats.recordRemoteLogSizeBytes(topic, 2, 250)
       assertEquals(500, brokerTopicMetrics.remoteLogSizeBytes)
+      assertEquals(500, brokerTopicStats.allTopicsStats.remoteLogSizeBytes)
+
+      brokerTopicStats.recordRemoteLogSizeBytes(topic2, 0, 100)
+      assertEquals(600, brokerTopicStats.allTopicsStats.remoteLogSizeBytes)
     } else {
       assertEquals(None, brokerTopicMetrics.metricGaugeMap.get(RemoteStorageMetrics.REMOTE_LOG_SIZE_BYTES_METRIC.getName))
     }
@@ -575,73 +613,72 @@ class KafkaRequestHandlerTest {
 
   @Test
   def testMultipleLogSizeBytesMetrics(): Unit = {
-    val brokerTopicMetrics = setupBrokerTopicMetrics()
+    brokerTopicStats.recordRemoteLogSizeBytes(topic, 0, 1)
+    brokerTopicStats.recordRemoteLogSizeBytes(topic, 1, 2)
+    brokerTopicStats.recordRemoteLogSizeBytes(topic, 2, 3)
 
-    brokerTopicMetrics.recordRemoteLogSizeBytes(0, 1);
-    brokerTopicMetrics.recordRemoteLogSizeBytes(1, 2);
-    brokerTopicMetrics.recordRemoteLogSizeBytes(2, 3);
-
-    brokerTopicMetrics.recordRemoteLogSizeBytes(0, 4);
-    brokerTopicMetrics.recordRemoteLogSizeBytes(1, 5);
-    brokerTopicMetrics.recordRemoteLogSizeBytes(2, 6);
+    brokerTopicStats.recordRemoteLogSizeBytes(topic, 0, 4)
+    brokerTopicStats.recordRemoteLogSizeBytes(topic, 1, 5)
+    brokerTopicStats.recordRemoteLogSizeBytes(topic, 2, 6)
 
     assertEquals(15, brokerTopicMetrics.remoteLogSizeBytes)
+    assertEquals(15, allTopicMetrics.remoteLogSizeBytes)
   }
 
   @Test
   def testLogSizeBytesMetricWithPartitionExpansion(): Unit = {
-    val brokerTopicMetrics = setupBrokerTopicMetrics()
-
-    brokerTopicMetrics.recordRemoteLogSizeBytes(0, 1);
-    brokerTopicMetrics.recordRemoteLogSizeBytes(1, 2);
+    brokerTopicStats.recordRemoteLogSizeBytes(topic, 0, 1)
+    brokerTopicStats.recordRemoteLogSizeBytes(topic, 1, 2)
 
     assertEquals(3, brokerTopicMetrics.remoteLogSizeBytes)
+    assertEquals(3, allTopicMetrics.remoteLogSizeBytes)
 
-    brokerTopicMetrics.recordRemoteLogSizeBytes(2, 3);
+    brokerTopicStats.recordRemoteLogSizeBytes(topic, 2, 3)
 
     assertEquals(6, brokerTopicMetrics.remoteLogSizeBytes)
+    assertEquals(6, allTopicMetrics.remoteLogSizeBytes)
   }
 
   @Test
   def testLogSizeBytesMetricWithPartitionShrinking(): Unit = {
-    val brokerTopicMetrics = setupBrokerTopicMetrics()
-
-    brokerTopicMetrics.recordRemoteLogSizeBytes(0, 1);
-    brokerTopicMetrics.recordRemoteLogSizeBytes(1, 2);
+    brokerTopicStats.recordRemoteLogSizeBytes(topic, 0, 1)
+    brokerTopicStats.recordRemoteLogSizeBytes(topic, 1, 2)
 
     assertEquals(3, brokerTopicMetrics.remoteLogSizeBytes)
+    assertEquals(3, allTopicMetrics.remoteLogSizeBytes)
 
-    brokerTopicMetrics.removeRemoteLogSizeBytes(1);
+    brokerTopicStats.removeRemoteLogSizeBytes(topic, 1)
 
     assertEquals(1, brokerTopicMetrics.remoteLogSizeBytes)
+    assertEquals(1, allTopicMetrics.remoteLogSizeBytes)
   }
 
   @Test
   def testLogSizeBytesMetricWithRemovingNonexistentPartitions(): Unit = {
-    val brokerTopicMetrics = setupBrokerTopicMetrics()
-
-    brokerTopicMetrics.recordRemoteLogSizeBytes(0, 1);
-    brokerTopicMetrics.recordRemoteLogSizeBytes(1, 2);
+    brokerTopicStats.recordRemoteLogSizeBytes(topic, 0, 1)
+    brokerTopicStats.recordRemoteLogSizeBytes(topic, 1, 2)
 
     assertEquals(3, brokerTopicMetrics.remoteLogSizeBytes)
+    assertEquals(3, allTopicMetrics.remoteLogSizeBytes)
 
-    brokerTopicMetrics.removeRemoteLogSizeBytes(3);
+    brokerTopicStats.removeRemoteLogSizeBytes(topic, 3)
 
     assertEquals(3, brokerTopicMetrics.remoteLogSizeBytes)
+    assertEquals(3, allTopicMetrics.remoteLogSizeBytes)
   }
 
   @Test
   def testLogSizeBytesMetricClear(): Unit = {
-    val brokerTopicMetrics = setupBrokerTopicMetrics()
-
-    brokerTopicMetrics.recordRemoteLogSizeBytes(0, 1);
-    brokerTopicMetrics.recordRemoteLogSizeBytes(1, 2);
+    brokerTopicStats.recordRemoteLogSizeBytes(topic, 0, 1)
+    brokerTopicStats.recordRemoteLogSizeBytes(topic, 1, 2)
 
     assertEquals(3, brokerTopicMetrics.remoteLogSizeBytes)
+    assertEquals(3, allTopicMetrics.remoteLogSizeBytes)
 
-    brokerTopicMetrics.close()
+    brokerTopicStats.close()
 
     assertEquals(0, brokerTopicMetrics.remoteLogSizeBytes)
+    assertEquals(0, allTopicMetrics.remoteLogSizeBytes)
   }
 
 }
diff --git a/core/src/test/scala/unit/kafka/server/ReplicaManagerTest.scala b/core/src/test/scala/unit/kafka/server/ReplicaManagerTest.scala
index 99b172ef93..f70965522c 100644
--- a/core/src/test/scala/unit/kafka/server/ReplicaManagerTest.scala
+++ b/core/src/test/scala/unit/kafka/server/ReplicaManagerTest.scala
@@ -144,7 +144,7 @@ class ReplicaManagerTest {
     metrics.close()
     // validate that the shutdown is working correctly by ensuring no lingering threads.
     // assert at the very end otherwise the other tear down steps will not be performed
-    TestUtils.assertNoNonDaemonThreads(this.getClass.getName)
+    TestUtils.assertNoNonDaemonThreadsWithWaiting(this.getClass.getName)
   }
 
   @Test
diff --git a/core/src/test/scala/unit/kafka/utils/TestUtils.scala b/core/src/test/scala/unit/kafka/utils/TestUtils.scala
index 880e4ab9da..ac51a770c9 100755
--- a/core/src/test/scala/unit/kafka/utils/TestUtils.scala
+++ b/core/src/test/scala/unit/kafka/utils/TestUtils.scala
@@ -1403,6 +1403,17 @@ object TestUtils extends Logging {
     assertEquals(0, threadCount, s"Found unexpected $threadCount NonDaemon threads=${nonDaemonThreads.map(t => t.getName).mkString(", ")}")
   }
 
+  // Some threads are closed, but the state didn't reflect in the JVM immediately, so add some wait time for it
+  def assertNoNonDaemonThreadsWithWaiting(threadNamePrefix: String, waitTimeMs: Long = 500L): Unit = {
+    var nonDemonThreads: mutable.Set[Thread] = mutable.Set.empty[Thread]
+    waitUntilTrue(() => {
+      nonDemonThreads = Thread.getAllStackTraces.keySet.asScala.filter { t =>
+        !t.isDaemon && t.isAlive && t.getName.startsWith(threadNamePrefix)
+      }
+      0 == nonDemonThreads.size
+    }, s"Found unexpected ${nonDemonThreads.size} NonDaemon threads=${nonDemonThreads.map(t => t.getName).mkString(", ")}", waitTimeMs)
+  }
+
   def numThreadsRunning(threadNamePrefix: String, isDaemon: Boolean): mutable.Set[Thread] = {
     Thread.getAllStackTraces.keySet.asScala.filter { t =>
       isDaemon && t.isAlive && t.getName.startsWith(threadNamePrefix)
