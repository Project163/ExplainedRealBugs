diff --git a/core/src/main/scala/kafka/producer/async/DefaultEventHandler.scala b/core/src/main/scala/kafka/producer/async/DefaultEventHandler.scala
index 1b622f89ff..6592544271 100644
--- a/core/src/main/scala/kafka/producer/async/DefaultEventHandler.scala
+++ b/core/src/main/scala/kafka/producer/async/DefaultEventHandler.scala
@@ -83,8 +83,8 @@ private[kafka] class DefaultEventHandler[T](val config: ProducerConfig,
               case _ =>
                 if(config.compressedTopics.contains(topicAndEvents._1._1)) {
                   if(logger.isTraceEnabled)
-                    logger.trace("Sending %d messages with compression %d to topic %s on partition %d"
-                      .format(topicAndEvents._2.size, topicAndEvents._1._1, topicAndEvents._1._2, config.compressionCodec.codec))
+                    logger.trace("Sending %d messages with compression codec %d to topic %s on partition %d"
+                      .format(topicAndEvents._2.size, config.compressionCodec.codec, topicAndEvents._1._1, topicAndEvents._1._2))
                   new ByteBufferMessageSet(config.compressionCodec, topicAndEvents._2: _*)
                 }
                 else {
diff --git a/core/src/main/scala/kafka/producer/async/ProducerSendThread.scala b/core/src/main/scala/kafka/producer/async/ProducerSendThread.scala
index 303b2f0668..6c40a6fd49 100644
--- a/core/src/main/scala/kafka/producer/async/ProducerSendThread.scala
+++ b/core/src/main/scala/kafka/producer/async/ProducerSendThread.scala
@@ -69,7 +69,7 @@ private[async] class ProducerSendThread[T](val threadName: String,
     var full: Boolean = false
 
     // drain the queue until you get a shutdown command
-    Stream.continually(queue.poll(scala.math.max(0, queueTime - (lastSend - SystemTime.milliseconds)), TimeUnit.MILLISECONDS))
+    Stream.continually(queue.poll(scala.math.max(0, (lastSend + queueTime) - SystemTime.milliseconds), TimeUnit.MILLISECONDS))
                       .takeWhile(item => if(item != null) item.getData != shutdownCommand else true).foreach {
       currentQueueItem =>
         val elapsed = (SystemTime.milliseconds - lastSend)
@@ -129,4 +129,4 @@ private[async] class ProducerSendThread[T](val threadName: String,
         logger.trace(event.getData.toString)
     }
   }
-}
\ No newline at end of file
+}
