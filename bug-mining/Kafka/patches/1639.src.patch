diff --git a/streams/src/main/java/org/apache/kafka/streams/state/internals/Segments.java b/streams/src/main/java/org/apache/kafka/streams/state/internals/Segments.java
index 77b92a55f9..9c8653afde 100644
--- a/streams/src/main/java/org/apache/kafka/streams/state/internals/Segments.java
+++ b/streams/src/main/java/org/apache/kafka/streams/state/internals/Segments.java
@@ -85,9 +85,7 @@ class Segments {
             if (previousSegment == null) {
                 newSegment.openDB(context);
                 maxSegmentId = segmentId > maxSegmentId ? segmentId : maxSegmentId;
-                if (minSegmentId == Long.MAX_VALUE) {
-                    minSegmentId = maxSegmentId;
-                }
+                minSegmentId = segmentId < minSegmentId ? segmentId : minSegmentId;
             }
             return previousSegment == null ? newSegment : previousSegment;
         } else {
diff --git a/streams/src/test/java/org/apache/kafka/streams/state/internals/SegmentsTest.java b/streams/src/test/java/org/apache/kafka/streams/state/internals/SegmentsTest.java
index aedf74be0e..9d367ebb51 100644
--- a/streams/src/test/java/org/apache/kafka/streams/state/internals/SegmentsTest.java
+++ b/streams/src/test/java/org/apache/kafka/streams/state/internals/SegmentsTest.java
@@ -166,6 +166,21 @@ public class SegmentsTest {
         assertEquals(2, segments.get(2).id);
     }
 
+    @Test
+    public void shouldGetSegmentsWithinTimeRangeOutOfOrder() throws Exception {
+        segments.getOrCreateSegment(4, context);
+        segments.getOrCreateSegment(2, context);
+        segments.getOrCreateSegment(0, context);
+        segments.getOrCreateSegment(1, context);
+        segments.getOrCreateSegment(3, context);
+
+        final List<Segment> segments = this.segments.segments(0, 2 * 60 * 1000);
+        assertEquals(3, segments.size());
+        assertEquals(0, segments.get(0).id);
+        assertEquals(1, segments.get(1).id);
+        assertEquals(2, segments.get(2).id);
+    }
+
     @Test
     public void shouldRollSegments() throws Exception {
         segments.getOrCreateSegment(0, context);
