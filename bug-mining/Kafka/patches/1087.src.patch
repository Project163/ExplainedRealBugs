diff --git a/streams/src/main/java/org/apache/kafka/streams/kstream/TimeWindows.java b/streams/src/main/java/org/apache/kafka/streams/kstream/TimeWindows.java
index e4ce88332e..001e92eaf6 100644
--- a/streams/src/main/java/org/apache/kafka/streams/kstream/TimeWindows.java
+++ b/streams/src/main/java/org/apache/kafka/streams/kstream/TimeWindows.java
@@ -99,9 +99,7 @@ public class TimeWindows extends Windows<TimeWindow> {
 
     @Override
     public Map<Long, TimeWindow> windowsFor(long timestamp) {
-        long enclosed = (size - 1) / advance;
-        long windowStart = Math.max(0, timestamp - timestamp % advance - enclosed * advance);
-
+        long windowStart = (Math.max(0, timestamp - this.size + this.advance) / this.advance) * this.advance;
         Map<Long, TimeWindow> windows = new HashMap<>();
         while (windowStart <= timestamp) {
             TimeWindow window = new TimeWindow(windowStart, windowStart + this.size);
diff --git a/streams/src/test/java/org/apache/kafka/streams/kstream/TimeWindowsTest.java b/streams/src/test/java/org/apache/kafka/streams/kstream/TimeWindowsTest.java
index e9ff235d48..62b12a9ff4 100644
--- a/streams/src/test/java/org/apache/kafka/streams/kstream/TimeWindowsTest.java
+++ b/streams/src/test/java/org/apache/kafka/streams/kstream/TimeWindowsTest.java
@@ -112,6 +112,14 @@ public class TimeWindowsTest {
         assertEquals(new TimeWindow(20L, 32L), matched.get(20L));
     }
 
+    @Test
+    public void windowsForBarelyOverlappingHoppingWindows() {
+        TimeWindows windows = TimeWindows.of(anyName, 6L).advanceBy(5L);
+        Map<Long, TimeWindow> matched = windows.windowsFor(7L);
+        assertEquals(1, matched.size());
+        assertEquals(new TimeWindow(5L, 11L), matched.get(5L));
+    }
+
     @Test
     public void windowsForTumblingWindows() {
         TimeWindows windows = TimeWindows.of(anyName, 12L);
