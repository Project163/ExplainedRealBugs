diff --git a/build.gradle b/build.gradle
index 75db84a62d..181e7b1d40 100644
--- a/build.gradle
+++ b/build.gradle
@@ -431,13 +431,14 @@ project(':clients') {
       def headRef = file("../.git/HEAD").text
       if (headRef.contains('ref: ')) {
         headRef = headRef.replaceAll('ref: ', '').trim()
-        commitId = file("../.git/$headRef").text.trim().take(takeFromHash)
+        if (file("../.git/$headRef").exists()) {
+          commitId = file("../.git/$headRef").text.trim().take(takeFromHash)
+        } 
       } else {
         commitId = headRef.trim().take(takeFromHash)
       }
-    } else {
-      commitId
-    }
+    } 
+    commitId
   }
 
   task createVersionFile(dependsOn: determineCommitId) {
