diff --git a/core/src/test/scala/unit/kafka/producer/ProducerTest.scala b/core/src/test/scala/unit/kafka/producer/ProducerTest.scala
index dc6a5ea4ab..7877da8a69 100644
--- a/core/src/test/scala/unit/kafka/producer/ProducerTest.scala
+++ b/core/src/test/scala/unit/kafka/producer/ProducerTest.scala
@@ -234,6 +234,7 @@ class ProducerTest extends JUnit3Suite with ZooKeeperTestHarness with Logging{
     // restart server 1
     server1.startup()
     TestUtils.waitUntilLeaderIsElectedOrChanged(zkClient, topic, 0)
+    TestUtils.waitUntilMetadataIsPropagated(servers, topic, 0)
 
     try {
       // cross check if broker 1 got the messages
