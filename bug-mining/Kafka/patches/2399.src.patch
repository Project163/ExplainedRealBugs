diff --git a/streams/src/main/java/org/apache/kafka/streams/processor/internals/StreamTask.java b/streams/src/main/java/org/apache/kafka/streams/processor/internals/StreamTask.java
index 8ddd6ba50e..ea08689f16 100644
--- a/streams/src/main/java/org/apache/kafka/streams/processor/internals/StreamTask.java
+++ b/streams/src/main/java/org/apache/kafka/streams/processor/internals/StreamTask.java
@@ -678,12 +678,17 @@ public class StreamTask extends AbstractTask implements ProcessorNodePunctuator
                 throw taskMigratedException;
             }
         } else {
-            maybeAbortTransactionAndCloseRecordCollector(isZombie);
+            // In the case of unclean close we still need to make sure all the stores are flushed before closing any
+            super.flushState();
+
+            if (eosEnabled) {
+                maybeAbortTransactionAndCloseRecordCollector(isZombie);
+            }
         }
     }
 
     private void maybeAbortTransactionAndCloseRecordCollector(final boolean isZombie) {
-        if (eosEnabled && !isZombie) {
+        if (!isZombie) {
             try {
                 if (transactionInFlight) {
                     producer.abortTransaction();
@@ -701,14 +706,12 @@ public class StreamTask extends AbstractTask implements ProcessorNodePunctuator
             }
         }
 
-        if (eosEnabled) {
-            try {
-                recordCollector.close();
-            } catch (final Throwable e) {
-                log.error("Failed to close producer due to the following error:", e);
-            } finally {
-                producer = null;
-            }
+        try {
+            recordCollector.close();
+        } catch (final Throwable e) {
+            log.error("Failed to close producer due to the following error:", e);
+        } finally {
+            producer = null;
         }
     }
 
