diff --git a/connect/runtime/src/main/java/org/apache/kafka/connect/runtime/ExactlyOnceWorkerSourceTask.java b/connect/runtime/src/main/java/org/apache/kafka/connect/runtime/ExactlyOnceWorkerSourceTask.java
index 428ad2fb07..d02a5f5428 100644
--- a/connect/runtime/src/main/java/org/apache/kafka/connect/runtime/ExactlyOnceWorkerSourceTask.java
+++ b/connect/runtime/src/main/java/org/apache/kafka/connect/runtime/ExactlyOnceWorkerSourceTask.java
@@ -280,18 +280,22 @@ class ExactlyOnceWorkerSourceTask extends AbstractWorkerSourceTask {
             });
         }
 
-        // Commit the transaction
-        // Blocks until all outstanding records have been sent and ack'd
-        try {
-            producer.commitTransaction();
-        } catch (Throwable t) {
-            log.error("{} Failed to commit producer transaction", ExactlyOnceWorkerSourceTask.this, t);
-            flushError.compareAndSet(null, t);
+        // Only commit the transaction if we were able to serialize the offsets.
+        // Otherwise, we may commit source records without committing their offsets
+        Throwable error = flushError.get();
+        if (error == null) {
+            try {
+                // Commit the transaction
+                // Blocks until all outstanding records have been sent and ack'd
+                producer.commitTransaction();
+            } catch (Throwable t) {
+                log.error("{} Failed to commit producer transaction", ExactlyOnceWorkerSourceTask.this, t);
+                flushError.compareAndSet(null, t);
+            }
+            transactionOpen = false;
         }
 
-        transactionOpen = false;
-
-        Throwable error = flushError.get();
+        error = flushError.get();
         if (error != null) {
             recordCommitFailure(time.milliseconds() - started, null);
             offsetWriter.cancelFlush();
diff --git a/connect/runtime/src/test/java/org/apache/kafka/connect/runtime/ExactlyOnceWorkerSourceTaskTest.java b/connect/runtime/src/test/java/org/apache/kafka/connect/runtime/ExactlyOnceWorkerSourceTaskTest.java
index 3cbc293eeb..e077cff912 100644
--- a/connect/runtime/src/test/java/org/apache/kafka/connect/runtime/ExactlyOnceWorkerSourceTaskTest.java
+++ b/connect/runtime/src/test/java/org/apache/kafka/connect/runtime/ExactlyOnceWorkerSourceTaskTest.java
@@ -678,7 +678,7 @@ public class ExactlyOnceWorkerSourceTaskTest {
     }
 
     @Test
-    public void testCommitFlushCallbackFailure() throws Exception {
+    public void testCommitFlushSyncCallbackFailure() throws Exception {
         Exception failure = new RecordTooLargeException();
         when(offsetWriter.willFlush()).thenReturn(true);
         when(offsetWriter.beginFlush()).thenReturn(true);
@@ -687,7 +687,26 @@ public class ExactlyOnceWorkerSourceTaskTest {
             callback.onCompletion(failure, null);
             return null;
         });
-        testCommitFailure(failure);
+        testCommitFailure(failure, false);
+    }
+
+    @Test
+    public void testCommitFlushAsyncCallbackFailure() throws Exception {
+        Exception failure = new RecordTooLargeException();
+        when(offsetWriter.willFlush()).thenReturn(true);
+        when(offsetWriter.beginFlush()).thenReturn(true);
+        // doFlush delegates its callback to the producer,
+        // which delays completing the callback until commitTransaction
+        AtomicReference<Callback<Void>> callback = new AtomicReference<>();
+        when(offsetWriter.doFlush(any())).thenAnswer(invocation -> {
+            callback.set(invocation.getArgument(0));
+            return null;
+        });
+        doAnswer(invocation -> {
+            callback.get().onCompletion(failure, null);
+            return null;
+        }).when(producer).commitTransaction();
+        testCommitFailure(failure, true);
     }
 
     @Test
@@ -696,10 +715,10 @@ public class ExactlyOnceWorkerSourceTaskTest {
         when(offsetWriter.willFlush()).thenReturn(true);
         when(offsetWriter.beginFlush()).thenReturn(true);
         doThrow(failure).when(producer).commitTransaction();
-        testCommitFailure(failure);
+        testCommitFailure(failure, true);
     }
 
-    private void testCommitFailure(Exception commitException) throws Exception {
+    private void testCommitFailure(Exception commitException, boolean executeCommit) throws Exception {
         createWorkerTask();
 
         // Unlike the standard WorkerSourceTask class, this one fails permanently when offset commits don't succeed
@@ -723,7 +742,9 @@ public class ExactlyOnceWorkerSourceTaskTest {
         verifySends();
         verifyPossibleTopicCreation();
         verify(producer).beginTransaction();
-        verify(producer).commitTransaction();
+        if (executeCommit) {
+            verify(producer).commitTransaction();
+        }
         verify(offsetWriter).cancelFlush();
 
         verifyPreflight();
