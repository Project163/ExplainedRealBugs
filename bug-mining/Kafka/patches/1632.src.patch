diff --git a/clients/src/test/java/org/apache/kafka/common/utils/ShellTest.java b/clients/src/test/java/org/apache/kafka/common/utils/ShellTest.java
index b032c0b9a2..d77f4d0284 100644
--- a/clients/src/test/java/org/apache/kafka/common/utils/ShellTest.java
+++ b/clients/src/test/java/org/apache/kafka/common/utils/ShellTest.java
@@ -66,7 +66,9 @@ public class ShellTest {
             Shell.execCommand("head", "-c", "0", NONEXISTENT_PATH);
             fail("Expected to get an exception when trying to head a nonexistent file");
         } catch (Shell.ExitCodeException e) {
-            assertTrue(e.getMessage().contains("No such file"));
+            String message = e.getMessage();
+            assertTrue("Unexpected error message '" + message + "'",
+                    message.contains("No such file") || message.contains("illegal byte count"));
         }
     }
 }
