diff --git a/connect/runtime/src/main/java/org/apache/kafka/connect/storage/OffsetUtils.java b/connect/runtime/src/main/java/org/apache/kafka/connect/storage/OffsetUtils.java
index 1d6632e60c..6c98f42792 100644
--- a/connect/runtime/src/main/java/org/apache/kafka/connect/storage/OffsetUtils.java
+++ b/connect/runtime/src/main/java/org/apache/kafka/connect/storage/OffsetUtils.java
@@ -115,8 +115,10 @@ public class OffsetUtils {
         }
 
         if (!(keyList.get(1) instanceof Map)) {
-            log.warn("Ignoring offset partition key with an unexpected format for the second element in the partition key list. " +
-                    "Expected type: {}, actual type: {}", Map.class.getName(), className(keyList.get(1)));
+            if (keyList.get(1) != null) {
+                log.warn("Ignoring offset partition key with an unexpected format for the second element in the partition key list. " +
+                        "Expected type: {}, actual type: {}", Map.class.getName(), className(keyList.get(1)));
+            }
             return;
         }
 
diff --git a/connect/runtime/src/test/java/org/apache/kafka/connect/storage/OffsetUtilsTest.java b/connect/runtime/src/test/java/org/apache/kafka/connect/storage/OffsetUtilsTest.java
index 06fb51d3ca..ba81a700b4 100644
--- a/connect/runtime/src/test/java/org/apache/kafka/connect/storage/OffsetUtilsTest.java
+++ b/connect/runtime/src/test/java/org/apache/kafka/connect/storage/OffsetUtilsTest.java
@@ -134,6 +134,16 @@ public class OffsetUtilsTest {
         }
     }
 
+    @Test
+    public void testProcessPartitionKeyNullPartition() {
+        try (LogCaptureAppender logCaptureAppender = LogCaptureAppender.createAndRegister(OffsetUtils.class)) {
+            Map<String, Set<Map<String, Object>>> connectorPartitions = new HashMap<>();
+            OffsetUtils.processPartitionKey(serializePartitionKey(Arrays.asList("connector-name", null)), new byte[0], CONVERTER, connectorPartitions);
+            assertEquals(Collections.emptyMap(), connectorPartitions);
+            assertEquals(0, logCaptureAppender.getMessages().size());
+        }
+    }
+
     private byte[] serializePartitionKey(Object key) {
         return CONVERTER.fromConnectData("", null, key);
     }
