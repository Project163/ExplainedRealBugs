diff --git a/tools/src/main/java/org/apache/kafka/tools/ProducerPerformance.java b/tools/src/main/java/org/apache/kafka/tools/ProducerPerformance.java
index f2ee53cb3f..6774f23511 100644
--- a/tools/src/main/java/org/apache/kafka/tools/ProducerPerformance.java
+++ b/tools/src/main/java/org/apache/kafka/tools/ProducerPerformance.java
@@ -329,12 +329,13 @@ public class ProducerPerformance {
         return parser;
     }
 
-    private static class Stats {
+    // Visible for testing
+    static class Stats {
         private long start;
         private long windowStart;
         private int[] latencies;
-        private int sampling;
-        private int iteration;
+        private long sampling;
+        private long iteration;
         private int index;
         private long count;
         private long bytes;
@@ -350,11 +351,10 @@ public class ProducerPerformance {
             this.start = System.currentTimeMillis();
             this.windowStart = System.currentTimeMillis();
             this.iteration = 0;
-            this.sampling = (int) (numRecords / Math.min(numRecords, 500000));
+            this.sampling = numRecords / Math.min(numRecords, 500000);
             this.latencies = new int[(int) (numRecords / this.sampling) + 1];
             this.index = 0;
             this.maxLatency = 0;
-            this.totalLatency = 0;
             this.windowCount = 0;
             this.windowMaxLatency = 0;
             this.windowTotalLatency = 0;
@@ -363,7 +363,7 @@ public class ProducerPerformance {
             this.reportingInterval = reportingInterval;
         }
 
-        public void record(int iter, int latency, int bytes, long time) {
+        public void record(long iter, int latency, int bytes, long time) {
             this.count++;
             this.bytes += bytes;
             this.totalLatency += latency;
@@ -440,11 +440,11 @@ public class ProducerPerformance {
 
     private static final class PerfCallback implements Callback {
         private final long start;
-        private final int iteration;
+        private final long iteration;
         private final int bytes;
         private final Stats stats;
 
-        public PerfCallback(int iter, long start, int bytes, Stats stats) {
+        public PerfCallback(long iter, long start, int bytes, Stats stats) {
             this.start = start;
             this.stats = stats;
             this.iteration = iter;
diff --git a/tools/src/test/java/org/apache/kafka/tools/ProducerPerformanceTest.java b/tools/src/test/java/org/apache/kafka/tools/ProducerPerformanceTest.java
index 4c479b6497..b8adf5d8eb 100644
--- a/tools/src/test/java/org/apache/kafka/tools/ProducerPerformanceTest.java
+++ b/tools/src/test/java/org/apache/kafka/tools/ProducerPerformanceTest.java
@@ -40,6 +40,7 @@ import static org.junit.jupiter.api.Assertions.assertEquals;
 import static org.junit.jupiter.api.Assertions.assertNotEquals;
 import static org.junit.jupiter.api.Assertions.assertNotNull;
 import static org.junit.jupiter.api.Assertions.assertThrows;
+import static org.junit.jupiter.api.Assertions.assertDoesNotThrow;
 import static org.mockito.ArgumentMatchers.any;
 import static org.mockito.Mockito.doReturn;
 import static org.mockito.Mockito.times;
@@ -174,4 +175,10 @@ public class ProducerPerformanceTest {
         assertNotNull(prop);
         assertEquals("perf-producer-client", prop.getProperty("client.id"));
     }
+
+    @Test
+    public void testStatsInitializationWithLargeNumRecords() throws Exception {
+        long numRecords = Long.MAX_VALUE;
+        assertDoesNotThrow(() -> new ProducerPerformance.Stats(numRecords, 5000));
+    }
 }
