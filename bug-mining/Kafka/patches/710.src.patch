diff --git a/clients/src/main/java/org/apache/kafka/common/network/Selector.java b/clients/src/main/java/org/apache/kafka/common/network/Selector.java
index 4aee214b24..aaf60c98c2 100644
--- a/clients/src/main/java/org/apache/kafka/common/network/Selector.java
+++ b/clients/src/main/java/org/apache/kafka/common/network/Selector.java
@@ -279,6 +279,7 @@ public class Selector implements Selectable {
                         } catch (InvalidReceiveException e) {
                             log.error("Invalid data received from " + transmissions.id + " closing connection", e);
                             close(transmissions.id);
+                            this.disconnected.add(transmissions.id);
                             throw e;
                         }
                         if (transmissions.receive.complete()) {
