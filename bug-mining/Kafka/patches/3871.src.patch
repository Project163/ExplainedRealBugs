diff --git a/clients/src/test/java/org/apache/kafka/common/network/EchoServer.java b/clients/src/test/java/org/apache/kafka/common/network/EchoServer.java
index 8ab50f6465..2375f95f61 100644
--- a/clients/src/test/java/org/apache/kafka/common/network/EchoServer.java
+++ b/clients/src/test/java/org/apache/kafka/common/network/EchoServer.java
@@ -89,6 +89,7 @@ class EchoServer extends Thread {
                 }
                 synchronized (sockets) {
                     if (closing) {
+                        socket.close();
                         break;
                     }
                     sockets.add(socket);
diff --git a/clients/src/test/java/org/apache/kafka/common/network/NioEchoServer.java b/clients/src/test/java/org/apache/kafka/common/network/NioEchoServer.java
index 42424a9dac..2509c0a1f8 100644
--- a/clients/src/test/java/org/apache/kafka/common/network/NioEchoServer.java
+++ b/clients/src/test/java/org/apache/kafka/common/network/NioEchoServer.java
@@ -362,12 +362,20 @@ public class NioEchoServer extends Thread {
         socketChannels.clear();
     }
 
+    public void closeNewChannels() throws IOException {
+        for (SocketChannel channel : newChannels) {
+            channel.close();
+        }
+        newChannels.clear();
+    }
+
     public void close() throws IOException, InterruptedException {
         this.serverSocketChannel.close();
         closeSocketChannels();
         Utils.closeQuietly(selector, "selector");
         acceptorThread.interrupt();
         acceptorThread.join();
+        closeNewChannels();
         interrupt();
         join();
     }
diff --git a/core/src/test/scala/unit/kafka/server/ServerShutdownTest.scala b/core/src/test/scala/unit/kafka/server/ServerShutdownTest.scala
index a141d96626..802b206e14 100644
--- a/core/src/test/scala/unit/kafka/server/ServerShutdownTest.scala
+++ b/core/src/test/scala/unit/kafka/server/ServerShutdownTest.scala
@@ -272,7 +272,9 @@ class ServerShutdownTest extends KafkaServerTestHarness {
       val receiveFuture = executor.submit(new Runnable {
         override def run(): Unit = {
           val socket = serverSocket.accept()
-          new DataInputStream(socket.getInputStream).readByte()
+          val inputStream = new DataInputStream(socket.getInputStream)
+          inputStream.readByte()
+          inputStream.close()
         }
       })
 
