diff --git a/connect/runtime/src/main/java/org/apache/kafka/connect/runtime/distributed/WorkerCoordinator.java b/connect/runtime/src/main/java/org/apache/kafka/connect/runtime/distributed/WorkerCoordinator.java
index 79940e0e70..a8ddbcc955 100644
--- a/connect/runtime/src/main/java/org/apache/kafka/connect/runtime/distributed/WorkerCoordinator.java
+++ b/connect/runtime/src/main/java/org/apache/kafka/connect/runtime/distributed/WorkerCoordinator.java
@@ -306,6 +306,9 @@ public class WorkerCoordinator extends AbstractCoordinator implements Closeable
             Measurable numConnectors = new Measurable() {
                 @Override
                 public double measure(MetricConfig config, long now) {
+                    if (assignmentSnapshot == null) {
+                        return 0.0;
+                    }
                     return assignmentSnapshot.connectors().size();
                 }
             };
@@ -313,6 +316,9 @@ public class WorkerCoordinator extends AbstractCoordinator implements Closeable
             Measurable numTasks = new Measurable() {
                 @Override
                 public double measure(MetricConfig config, long now) {
+                    if (assignmentSnapshot == null) {
+                        return 0.0;
+                    }
                     return assignmentSnapshot.tasks().size();
                 }
             };
