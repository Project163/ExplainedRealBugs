[{"id":15255160394,"node_id":"LE_lADOAJaD5s6d-Ki-zwAAAAONR0ZK","url":"https://api.github.com/repos/App-vNext/Polly/issues/events/15255160394","actor":{"login":"kmcclellan","id":43862801,"node_id":"MDQ6VXNlcjQzODYyODAx","avatar_url":"https://avatars.githubusercontent.com/u/43862801?v=4","gravatar_id":"","url":"https://api.github.com/users/kmcclellan","html_url":"https://github.com/kmcclellan","followers_url":"https://api.github.com/users/kmcclellan/followers","following_url":"https://api.github.com/users/kmcclellan/following{/other_user}","gists_url":"https://api.github.com/users/kmcclellan/gists{/gist_id}","starred_url":"https://api.github.com/users/kmcclellan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kmcclellan/subscriptions","organizations_url":"https://api.github.com/users/kmcclellan/orgs","repos_url":"https://api.github.com/users/kmcclellan/repos","events_url":"https://api.github.com/users/kmcclellan/events{/privacy}","received_events_url":"https://api.github.com/users/kmcclellan/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2024-11-11T20:27:56Z","label":{"name":"bug","color":"fc2929"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/App-vNext/Polly/issues/comments/2471678308","html_url":"https://github.com/App-vNext/Polly/issues/2375#issuecomment-2471678308","issue_url":"https://api.github.com/repos/App-vNext/Polly/issues/2375","id":2471678308,"node_id":"IC_kwDOAJaD5s6TUtFk","user":{"login":"quixoticaxis","id":14001556,"node_id":"MDQ6VXNlcjE0MDAxNTU2","avatar_url":"https://avatars.githubusercontent.com/u/14001556?v=4","gravatar_id":"","url":"https://api.github.com/users/quixoticaxis","html_url":"https://github.com/quixoticaxis","followers_url":"https://api.github.com/users/quixoticaxis/followers","following_url":"https://api.github.com/users/quixoticaxis/following{/other_user}","gists_url":"https://api.github.com/users/quixoticaxis/gists{/gist_id}","starred_url":"https://api.github.com/users/quixoticaxis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/quixoticaxis/subscriptions","organizations_url":"https://api.github.com/users/quixoticaxis/orgs","repos_url":"https://api.github.com/users/quixoticaxis/repos","events_url":"https://api.github.com/users/quixoticaxis/events{/privacy}","received_events_url":"https://api.github.com/users/quixoticaxis/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-11-12T22:05:04Z","updated_at":"2024-11-12T22:06:08Z","body":"I hit this issue today while writing tests for a class that uses Polly.\r\n\r\nI believe the policy should always throw `OperationCancelledException` when being stopped and provide some other means to get the outcome if the user needs it.\r\n\r\nFor example, this is how I start a background service that uses `HttpClient`:\r\n```csharp\r\npublic async override Task StartAsync(CancellationToken cancellationToken)\r\n{\r\n    var retryPipeline = new ResiliencePipelineBuilder()\r\n        .AddRetry(\r\n            new RetryStrategyOptions\r\n            {\r\n                ShouldHandle = new PredicateBuilder()\r\n                    .Handle<HttpRequestException>()\r\n                    .Handle<JsonException>()\r\n                    .Handle<OperationCanceledException>(\r\n                        exception => exception.CancellationToken != cancellationToken),\r\n                /* other settings */\r\n            }).Build();\r\n    /* some HttpClient usage managed by the pipeline */\r\n```\r\nLooks like the code above may throw: `HttpRequestException`, `JsonException`, `OperationCancelledException` because of timeout, and `OperationCancelledException` because of the service being stopped. Feels counter-intuitive.","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/App-vNext/Polly/issues/comments/2471678308/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"quixoticaxis","id":14001556,"node_id":"MDQ6VXNlcjE0MDAxNTU2","avatar_url":"https://avatars.githubusercontent.com/u/14001556?v=4","gravatar_id":"","url":"https://api.github.com/users/quixoticaxis","html_url":"https://github.com/quixoticaxis","followers_url":"https://api.github.com/users/quixoticaxis/followers","following_url":"https://api.github.com/users/quixoticaxis/following{/other_user}","gists_url":"https://api.github.com/users/quixoticaxis/gists{/gist_id}","starred_url":"https://api.github.com/users/quixoticaxis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/quixoticaxis/subscriptions","organizations_url":"https://api.github.com/users/quixoticaxis/orgs","repos_url":"https://api.github.com/users/quixoticaxis/repos","events_url":"https://api.github.com/users/quixoticaxis/events{/privacy}","received_events_url":"https://api.github.com/users/quixoticaxis/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/App-vNext/Polly/issues/comments/2472728421","html_url":"https://github.com/App-vNext/Polly/issues/2375#issuecomment-2472728421","issue_url":"https://api.github.com/repos/App-vNext/Polly/issues/2375","id":2472728421,"node_id":"IC_kwDOAJaD5s6TYtdl","user":{"login":"peter-csala","id":57183693,"node_id":"MDQ6VXNlcjU3MTgzNjkz","avatar_url":"https://avatars.githubusercontent.com/u/57183693?v=4","gravatar_id":"","url":"https://api.github.com/users/peter-csala","html_url":"https://github.com/peter-csala","followers_url":"https://api.github.com/users/peter-csala/followers","following_url":"https://api.github.com/users/peter-csala/following{/other_user}","gists_url":"https://api.github.com/users/peter-csala/gists{/gist_id}","starred_url":"https://api.github.com/users/peter-csala/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/peter-csala/subscriptions","organizations_url":"https://api.github.com/users/peter-csala/orgs","repos_url":"https://api.github.com/users/peter-csala/repos","events_url":"https://api.github.com/users/peter-csala/events{/privacy}","received_events_url":"https://api.github.com/users/peter-csala/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-11-13T07:53:39Z","updated_at":"2024-11-13T07:53:39Z","body":"I'm a bit busy this week but I can jump on this issue next week. @martincostello Can you please assign me to this ticket?","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/App-vNext/Polly/issues/comments/2472728421/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"peter-csala","id":57183693,"node_id":"MDQ6VXNlcjU3MTgzNjkz","avatar_url":"https://avatars.githubusercontent.com/u/57183693?v=4","gravatar_id":"","url":"https://api.github.com/users/peter-csala","html_url":"https://github.com/peter-csala","followers_url":"https://api.github.com/users/peter-csala/followers","following_url":"https://api.github.com/users/peter-csala/following{/other_user}","gists_url":"https://api.github.com/users/peter-csala/gists{/gist_id}","starred_url":"https://api.github.com/users/peter-csala/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/peter-csala/subscriptions","organizations_url":"https://api.github.com/users/peter-csala/orgs","repos_url":"https://api.github.com/users/peter-csala/repos","events_url":"https://api.github.com/users/peter-csala/events{/privacy}","received_events_url":"https://api.github.com/users/peter-csala/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":15278068151,"node_id":"MEE_lADOAJaD5s6d-Ki-zwAAAAOOpNG3","url":"https://api.github.com/repos/App-vNext/Polly/issues/events/15278068151","actor":{"login":"martincostello","id":1439341,"node_id":"MDQ6VXNlcjE0MzkzNDE=","avatar_url":"https://avatars.githubusercontent.com/u/1439341?v=4","gravatar_id":"","url":"https://api.github.com/users/martincostello","html_url":"https://github.com/martincostello","followers_url":"https://api.github.com/users/martincostello/followers","following_url":"https://api.github.com/users/martincostello/following{/other_user}","gists_url":"https://api.github.com/users/martincostello/gists{/gist_id}","starred_url":"https://api.github.com/users/martincostello/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/martincostello/subscriptions","organizations_url":"https://api.github.com/users/martincostello/orgs","repos_url":"https://api.github.com/users/martincostello/repos","events_url":"https://api.github.com/users/martincostello/events{/privacy}","received_events_url":"https://api.github.com/users/martincostello/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2024-11-13T07:53:40Z","performed_via_github_app":null},{"id":15278068165,"node_id":"SE_lADOAJaD5s6d-Ki-zwAAAAOOpNHF","url":"https://api.github.com/repos/App-vNext/Polly/issues/events/15278068165","actor":{"login":"martincostello","id":1439341,"node_id":"MDQ6VXNlcjE0MzkzNDE=","avatar_url":"https://avatars.githubusercontent.com/u/1439341?v=4","gravatar_id":"","url":"https://api.github.com/users/martincostello","html_url":"https://github.com/martincostello","followers_url":"https://api.github.com/users/martincostello/followers","following_url":"https://api.github.com/users/martincostello/following{/other_user}","gists_url":"https://api.github.com/users/martincostello/gists{/gist_id}","starred_url":"https://api.github.com/users/martincostello/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/martincostello/subscriptions","organizations_url":"https://api.github.com/users/martincostello/orgs","repos_url":"https://api.github.com/users/martincostello/repos","events_url":"https://api.github.com/users/martincostello/events{/privacy}","received_events_url":"https://api.github.com/users/martincostello/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2024-11-13T07:53:40Z","performed_via_github_app":null},{"id":15278098763,"node_id":"AE_lADOAJaD5s6d-Ki-zwAAAAOOpUlL","url":"https://api.github.com/repos/App-vNext/Polly/issues/events/15278098763","actor":{"login":"martincostello","id":1439341,"node_id":"MDQ6VXNlcjE0MzkzNDE=","avatar_url":"https://avatars.githubusercontent.com/u/1439341?v=4","gravatar_id":"","url":"https://api.github.com/users/martincostello","html_url":"https://github.com/martincostello","followers_url":"https://api.github.com/users/martincostello/followers","following_url":"https://api.github.com/users/martincostello/following{/other_user}","gists_url":"https://api.github.com/users/martincostello/gists{/gist_id}","starred_url":"https://api.github.com/users/martincostello/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/martincostello/subscriptions","organizations_url":"https://api.github.com/users/martincostello/orgs","repos_url":"https://api.github.com/users/martincostello/repos","events_url":"https://api.github.com/users/martincostello/events{/privacy}","received_events_url":"https://api.github.com/users/martincostello/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"assigned","commit_id":null,"commit_url":null,"created_at":"2024-11-13T07:56:02Z","assignee":{"login":"peter-csala","id":57183693,"node_id":"MDQ6VXNlcjU3MTgzNjkz","avatar_url":"https://avatars.githubusercontent.com/u/57183693?v=4","gravatar_id":"","url":"https://api.github.com/users/peter-csala","html_url":"https://github.com/peter-csala","followers_url":"https://api.github.com/users/peter-csala/followers","following_url":"https://api.github.com/users/peter-csala/following{/other_user}","gists_url":"https://api.github.com/users/peter-csala/gists{/gist_id}","starred_url":"https://api.github.com/users/peter-csala/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/peter-csala/subscriptions","organizations_url":"https://api.github.com/users/peter-csala/orgs","repos_url":"https://api.github.com/users/peter-csala/repos","events_url":"https://api.github.com/users/peter-csala/events{/privacy}","received_events_url":"https://api.github.com/users/peter-csala/received_events","type":"User","user_view_type":"public","site_admin":false},"performed_via_github_app":null},{"url":"https://api.github.com/repos/App-vNext/Polly/issues/comments/2478970458","html_url":"https://github.com/App-vNext/Polly/issues/2375#issuecomment-2478970458","issue_url":"https://api.github.com/repos/App-vNext/Polly/issues/2375","id":2478970458,"node_id":"IC_kwDOAJaD5s6TwhZa","user":{"login":"peter-csala","id":57183693,"node_id":"MDQ6VXNlcjU3MTgzNjkz","avatar_url":"https://avatars.githubusercontent.com/u/57183693?v=4","gravatar_id":"","url":"https://api.github.com/users/peter-csala","html_url":"https://github.com/peter-csala","followers_url":"https://api.github.com/users/peter-csala/followers","following_url":"https://api.github.com/users/peter-csala/following{/other_user}","gists_url":"https://api.github.com/users/peter-csala/gists{/gist_id}","starred_url":"https://api.github.com/users/peter-csala/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/peter-csala/subscriptions","organizations_url":"https://api.github.com/users/peter-csala/orgs","repos_url":"https://api.github.com/users/peter-csala/repos","events_url":"https://api.github.com/users/peter-csala/events{/privacy}","received_events_url":"https://api.github.com/users/peter-csala/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-11-15T14:12:50Z","updated_at":"2024-11-15T14:27:35Z","body":"Your observed behavior is due to the fact that the `Task.Delay` does not respect the cancellation token.\r\n\r\nIf it would respect:\r\n```cs\r\nawait Task.Delay(2000, cancellationToken);\r\n```\r\nthen the outputs will be consistent\r\n\r\n| Test case | Output |\r\n|--|--|\r\n| `await TestCancel(TimeSpan.FromSeconds(1));` | Attempt: 0 <br /> Execution was canceled. |\r\n| `await TestCancel(TimeSpan.FromSeconds(3));` | Attempt: 0 <br /> Execution was canceled. |\r\n| `await TestCancel(TimeSpan.FromSeconds(5));` | Attempt: 0 <br /> Attempt: 1<br />Execution was canceled. |\r\n| `await TestCancel(TimeSpan.FromSeconds(7));` | Attempt: 0 <br /> Attempt: 1<br />Execution was canceled. |\r\n\r\nI've created a simple dotnet fiddle for this: https://dotnetfiddle.net/fmvUFr","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/App-vNext/Polly/issues/comments/2478970458/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"peter-csala","id":57183693,"node_id":"MDQ6VXNlcjU3MTgzNjkz","avatar_url":"https://avatars.githubusercontent.com/u/57183693?v=4","gravatar_id":"","url":"https://api.github.com/users/peter-csala","html_url":"https://github.com/peter-csala","followers_url":"https://api.github.com/users/peter-csala/followers","following_url":"https://api.github.com/users/peter-csala/following{/other_user}","gists_url":"https://api.github.com/users/peter-csala/gists{/gist_id}","starred_url":"https://api.github.com/users/peter-csala/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/peter-csala/subscriptions","organizations_url":"https://api.github.com/users/peter-csala/orgs","repos_url":"https://api.github.com/users/peter-csala/repos","events_url":"https://api.github.com/users/peter-csala/events{/privacy}","received_events_url":"https://api.github.com/users/peter-csala/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/App-vNext/Polly/issues/comments/2478982071","html_url":"https://github.com/App-vNext/Polly/issues/2375#issuecomment-2478982071","issue_url":"https://api.github.com/repos/App-vNext/Polly/issues/2375","id":2478982071,"node_id":"IC_kwDOAJaD5s6TwkO3","user":{"login":"peter-csala","id":57183693,"node_id":"MDQ6VXNlcjU3MTgzNjkz","avatar_url":"https://avatars.githubusercontent.com/u/57183693?v=4","gravatar_id":"","url":"https://api.github.com/users/peter-csala","html_url":"https://github.com/peter-csala","followers_url":"https://api.github.com/users/peter-csala/followers","following_url":"https://api.github.com/users/peter-csala/following{/other_user}","gists_url":"https://api.github.com/users/peter-csala/gists{/gist_id}","starred_url":"https://api.github.com/users/peter-csala/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/peter-csala/subscriptions","organizations_url":"https://api.github.com/users/peter-csala/orgs","repos_url":"https://api.github.com/users/peter-csala/repos","events_url":"https://api.github.com/users/peter-csala/events{/privacy}","received_events_url":"https://api.github.com/users/peter-csala/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-11-15T14:14:38Z","updated_at":"2024-11-15T14:14:38Z","body":"> I hit this issue today while writing tests for a class that uses Polly.\r\n> \r\n> I believe the policy should always throw `OperationCancelledException` when being stopped and provide some other means to get the outcome if the user needs it.\r\n> \r\n> For example, this is how I start a background service that uses `HttpClient`:\r\n> \r\n> ...\r\n> \r\n> Looks like the code above may throw: `HttpRequestException`, `JsonException`, `OperationCancelledException` because of timeout, and `OperationCancelledException` because of the service being stopped. Feels counter-intuitive.\r\n\r\nCould you please share with us how do you use the pipeline?","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/App-vNext/Polly/issues/comments/2478982071/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"peter-csala","id":57183693,"node_id":"MDQ6VXNlcjU3MTgzNjkz","avatar_url":"https://avatars.githubusercontent.com/u/57183693?v=4","gravatar_id":"","url":"https://api.github.com/users/peter-csala","html_url":"https://github.com/peter-csala","followers_url":"https://api.github.com/users/peter-csala/followers","following_url":"https://api.github.com/users/peter-csala/following{/other_user}","gists_url":"https://api.github.com/users/peter-csala/gists{/gist_id}","starred_url":"https://api.github.com/users/peter-csala/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/peter-csala/subscriptions","organizations_url":"https://api.github.com/users/peter-csala/orgs","repos_url":"https://api.github.com/users/peter-csala/repos","events_url":"https://api.github.com/users/peter-csala/events{/privacy}","received_events_url":"https://api.github.com/users/peter-csala/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/App-vNext/Polly/issues/comments/2479061049","html_url":"https://github.com/App-vNext/Polly/issues/2375#issuecomment-2479061049","issue_url":"https://api.github.com/repos/App-vNext/Polly/issues/2375","id":2479061049,"node_id":"IC_kwDOAJaD5s6Tw3g5","user":{"login":"kmcclellan","id":43862801,"node_id":"MDQ6VXNlcjQzODYyODAx","avatar_url":"https://avatars.githubusercontent.com/u/43862801?v=4","gravatar_id":"","url":"https://api.github.com/users/kmcclellan","html_url":"https://github.com/kmcclellan","followers_url":"https://api.github.com/users/kmcclellan/followers","following_url":"https://api.github.com/users/kmcclellan/following{/other_user}","gists_url":"https://api.github.com/users/kmcclellan/gists{/gist_id}","starred_url":"https://api.github.com/users/kmcclellan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kmcclellan/subscriptions","organizations_url":"https://api.github.com/users/kmcclellan/orgs","repos_url":"https://api.github.com/users/kmcclellan/repos","events_url":"https://api.github.com/users/kmcclellan/events{/privacy}","received_events_url":"https://api.github.com/users/kmcclellan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-11-15T14:50:01Z","updated_at":"2024-11-15T14:50:01Z","body":"> Your observed behavior is due to the fact that the `Task.Delay` does not respect the cancellation token.\r\n\r\nObviously canceling the delay will cause the callback to throw. My example simulates the callback completing while the token is in the cancellation requested state. This is quite possible and needs to be handled correctly. Surfacing an outcome that _would have_ been retried is not expected cancellation behavior.\r\n","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/App-vNext/Polly/issues/comments/2479061049/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"kmcclellan","id":43862801,"node_id":"MDQ6VXNlcjQzODYyODAx","avatar_url":"https://avatars.githubusercontent.com/u/43862801?v=4","gravatar_id":"","url":"https://api.github.com/users/kmcclellan","html_url":"https://github.com/kmcclellan","followers_url":"https://api.github.com/users/kmcclellan/followers","following_url":"https://api.github.com/users/kmcclellan/following{/other_user}","gists_url":"https://api.github.com/users/kmcclellan/gists{/gist_id}","starred_url":"https://api.github.com/users/kmcclellan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kmcclellan/subscriptions","organizations_url":"https://api.github.com/users/kmcclellan/orgs","repos_url":"https://api.github.com/users/kmcclellan/repos","events_url":"https://api.github.com/users/kmcclellan/events{/privacy}","received_events_url":"https://api.github.com/users/kmcclellan/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/App-vNext/Polly/issues/comments/2479079894","html_url":"https://github.com/App-vNext/Polly/issues/2375#issuecomment-2479079894","issue_url":"https://api.github.com/repos/App-vNext/Polly/issues/2375","id":2479079894,"node_id":"IC_kwDOAJaD5s6Tw8HW","user":{"login":"kmcclellan","id":43862801,"node_id":"MDQ6VXNlcjQzODYyODAx","avatar_url":"https://avatars.githubusercontent.com/u/43862801?v=4","gravatar_id":"","url":"https://api.github.com/users/kmcclellan","html_url":"https://github.com/kmcclellan","followers_url":"https://api.github.com/users/kmcclellan/followers","following_url":"https://api.github.com/users/kmcclellan/following{/other_user}","gists_url":"https://api.github.com/users/kmcclellan/gists{/gist_id}","starred_url":"https://api.github.com/users/kmcclellan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kmcclellan/subscriptions","organizations_url":"https://api.github.com/users/kmcclellan/orgs","repos_url":"https://api.github.com/users/kmcclellan/repos","events_url":"https://api.github.com/users/kmcclellan/events{/privacy}","received_events_url":"https://api.github.com/users/kmcclellan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-11-15T14:57:54Z","updated_at":"2024-11-15T14:57:54Z","body":"Instead of:\r\n```csharp\r\nif (context.CancellationToken.IsCancellationRequested || isLastAttempt || !handle)\r\n{\r\n    return outcome;\r\n}\r\n```\r\n\r\nWe want:\r\n```csharp\r\nif (isLastAttempt || !handle)\r\n{\r\n    return outcome;\r\n}\r\n\r\ncontext.CancellationToken.ThrowIfCancellationRequested();\r\n```\r\n\r\nhttps://github.com/App-vNext/Polly/blob/7567acc330c9f74d6c7b14897a8ef4d15e9d475a/src/Polly.Core/Retry/RetryResilienceStrategy.cs#L70-73","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/App-vNext/Polly/issues/comments/2479079894/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"kmcclellan","id":43862801,"node_id":"MDQ6VXNlcjQzODYyODAx","avatar_url":"https://avatars.githubusercontent.com/u/43862801?v=4","gravatar_id":"","url":"https://api.github.com/users/kmcclellan","html_url":"https://github.com/kmcclellan","followers_url":"https://api.github.com/users/kmcclellan/followers","following_url":"https://api.github.com/users/kmcclellan/following{/other_user}","gists_url":"https://api.github.com/users/kmcclellan/gists{/gist_id}","starred_url":"https://api.github.com/users/kmcclellan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kmcclellan/subscriptions","organizations_url":"https://api.github.com/users/kmcclellan/orgs","repos_url":"https://api.github.com/users/kmcclellan/repos","events_url":"https://api.github.com/users/kmcclellan/events{/privacy}","received_events_url":"https://api.github.com/users/kmcclellan/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/App-vNext/Polly/issues/comments/2479535642","html_url":"https://github.com/App-vNext/Polly/issues/2375#issuecomment-2479535642","issue_url":"https://api.github.com/repos/App-vNext/Polly/issues/2375","id":2479535642,"node_id":"IC_kwDOAJaD5s6TyrYa","user":{"login":"quixoticaxis","id":14001556,"node_id":"MDQ6VXNlcjE0MDAxNTU2","avatar_url":"https://avatars.githubusercontent.com/u/14001556?v=4","gravatar_id":"","url":"https://api.github.com/users/quixoticaxis","html_url":"https://github.com/quixoticaxis","followers_url":"https://api.github.com/users/quixoticaxis/followers","following_url":"https://api.github.com/users/quixoticaxis/following{/other_user}","gists_url":"https://api.github.com/users/quixoticaxis/gists{/gist_id}","starred_url":"https://api.github.com/users/quixoticaxis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/quixoticaxis/subscriptions","organizations_url":"https://api.github.com/users/quixoticaxis/orgs","repos_url":"https://api.github.com/users/quixoticaxis/repos","events_url":"https://api.github.com/users/quixoticaxis/events{/privacy}","received_events_url":"https://api.github.com/users/quixoticaxis/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-11-15T17:33:29Z","updated_at":"2024-11-15T17:33:48Z","body":"> Could you please share with us how do you use the pipeline?\n\nI'll share the code a bit later, but the issue is, IMHO, perfectly summarized by @kmcclellan .","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/App-vNext/Polly/issues/comments/2479535642/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"quixoticaxis","id":14001556,"node_id":"MDQ6VXNlcjE0MDAxNTU2","avatar_url":"https://avatars.githubusercontent.com/u/14001556?v=4","gravatar_id":"","url":"https://api.github.com/users/quixoticaxis","html_url":"https://github.com/quixoticaxis","followers_url":"https://api.github.com/users/quixoticaxis/followers","following_url":"https://api.github.com/users/quixoticaxis/following{/other_user}","gists_url":"https://api.github.com/users/quixoticaxis/gists{/gist_id}","starred_url":"https://api.github.com/users/quixoticaxis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/quixoticaxis/subscriptions","organizations_url":"https://api.github.com/users/quixoticaxis/orgs","repos_url":"https://api.github.com/users/quixoticaxis/repos","events_url":"https://api.github.com/users/quixoticaxis/events{/privacy}","received_events_url":"https://api.github.com/users/quixoticaxis/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":15315677645,"node_id":"MEE_lADOAJaD5s6d-Ki-zwAAAAOQ4rHN","url":"https://api.github.com/repos/App-vNext/Polly/issues/events/15315677645","actor":{"login":"kmcclellan","id":43862801,"node_id":"MDQ6VXNlcjQzODYyODAx","avatar_url":"https://avatars.githubusercontent.com/u/43862801?v=4","gravatar_id":"","url":"https://api.github.com/users/kmcclellan","html_url":"https://github.com/kmcclellan","followers_url":"https://api.github.com/users/kmcclellan/followers","following_url":"https://api.github.com/users/kmcclellan/following{/other_user}","gists_url":"https://api.github.com/users/kmcclellan/gists{/gist_id}","starred_url":"https://api.github.com/users/kmcclellan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kmcclellan/subscriptions","organizations_url":"https://api.github.com/users/kmcclellan/orgs","repos_url":"https://api.github.com/users/kmcclellan/repos","events_url":"https://api.github.com/users/kmcclellan/events{/privacy}","received_events_url":"https://api.github.com/users/kmcclellan/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2024-11-15T17:33:30Z","performed_via_github_app":null},{"id":15315677660,"node_id":"SE_lADOAJaD5s6d-Ki-zwAAAAOQ4rHc","url":"https://api.github.com/repos/App-vNext/Polly/issues/events/15315677660","actor":{"login":"kmcclellan","id":43862801,"node_id":"MDQ6VXNlcjQzODYyODAx","avatar_url":"https://avatars.githubusercontent.com/u/43862801?v=4","gravatar_id":"","url":"https://api.github.com/users/kmcclellan","html_url":"https://github.com/kmcclellan","followers_url":"https://api.github.com/users/kmcclellan/followers","following_url":"https://api.github.com/users/kmcclellan/following{/other_user}","gists_url":"https://api.github.com/users/kmcclellan/gists{/gist_id}","starred_url":"https://api.github.com/users/kmcclellan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kmcclellan/subscriptions","organizations_url":"https://api.github.com/users/kmcclellan/orgs","repos_url":"https://api.github.com/users/kmcclellan/repos","events_url":"https://api.github.com/users/kmcclellan/events{/privacy}","received_events_url":"https://api.github.com/users/kmcclellan/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2024-11-15T17:33:30Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/App-vNext/Polly/issues/comments/2479632975","html_url":"https://github.com/App-vNext/Polly/issues/2375#issuecomment-2479632975","issue_url":"https://api.github.com/repos/App-vNext/Polly/issues/2375","id":2479632975,"node_id":"IC_kwDOAJaD5s6TzDJP","user":{"login":"quixoticaxis","id":14001556,"node_id":"MDQ6VXNlcjE0MDAxNTU2","avatar_url":"https://avatars.githubusercontent.com/u/14001556?v=4","gravatar_id":"","url":"https://api.github.com/users/quixoticaxis","html_url":"https://github.com/quixoticaxis","followers_url":"https://api.github.com/users/quixoticaxis/followers","following_url":"https://api.github.com/users/quixoticaxis/following{/other_user}","gists_url":"https://api.github.com/users/quixoticaxis/gists{/gist_id}","starred_url":"https://api.github.com/users/quixoticaxis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/quixoticaxis/subscriptions","organizations_url":"https://api.github.com/users/quixoticaxis/orgs","repos_url":"https://api.github.com/users/quixoticaxis/repos","events_url":"https://api.github.com/users/quixoticaxis/events{/privacy}","received_events_url":"https://api.github.com/users/quixoticaxis/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-11-15T18:05:15Z","updated_at":"2024-11-15T18:08:55Z","body":"First of all, another example, as a test:\r\n\r\n```csharp\r\n[Fact]\r\npublic async Task RetryShouldThrowOperationCancelledExceptionOnBeingCancelled()\r\n{\r\n    var pipeline = new ResiliencePipelineBuilder<int>()\r\n        .AddRetry(new()\r\n        {\r\n            UseJitter = false,\r\n            MaxRetryAttempts = 1_000,\r\n            Delay = TimeSpan.FromMilliseconds(1),\r\n            ShouldHandle = new PredicateBuilder<int>().Handle<InvalidOperationException>()\r\n        })\r\n        .Build();\r\n\r\n    using var stopper = new CancellationTokenSource();\r\n\r\n    int counter = 0;\r\n\r\n    int? result = null;\r\n\r\n    var exception = await Record.ExceptionAsync(\r\n        async () =>\r\n        {\r\n            result = await pipeline.ExecuteAsync(\r\n                async (token) =>\r\n                {\r\n                    await Task.Yield();\r\n                    ++counter;\r\n                    stopper.Cancel(); // cancellation happens\r\n\r\n                    if (counter < 500) // nearly at the same time\r\n                    {\r\n                        throw new InvalidOperationException(); // as failure\r\n                    }\r\n                    else\r\n                    {\r\n                        return 1;\r\n                    }\r\n                },\r\n                stopper.Token);\r\n        });\r\n\r\n    result.Should().BeNull(); // Passes\r\n    counter.Should().Be(1); // Passes\r\n    exception.Should().NotBeNull().And.BeOfType<OperationCanceledException>(); // Fails! But why does it return an outcome? I have a thousand attempts left\r\n}\r\n```","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/App-vNext/Polly/issues/comments/2479632975/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":1,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"quixoticaxis","id":14001556,"node_id":"MDQ6VXNlcjE0MDAxNTU2","avatar_url":"https://avatars.githubusercontent.com/u/14001556?v=4","gravatar_id":"","url":"https://api.github.com/users/quixoticaxis","html_url":"https://github.com/quixoticaxis","followers_url":"https://api.github.com/users/quixoticaxis/followers","following_url":"https://api.github.com/users/quixoticaxis/following{/other_user}","gists_url":"https://api.github.com/users/quixoticaxis/gists{/gist_id}","starred_url":"https://api.github.com/users/quixoticaxis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/quixoticaxis/subscriptions","organizations_url":"https://api.github.com/users/quixoticaxis/orgs","repos_url":"https://api.github.com/users/quixoticaxis/repos","events_url":"https://api.github.com/users/quixoticaxis/events{/privacy}","received_events_url":"https://api.github.com/users/quixoticaxis/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/App-vNext/Polly/issues/comments/2479651846","html_url":"https://github.com/App-vNext/Polly/issues/2375#issuecomment-2479651846","issue_url":"https://api.github.com/repos/App-vNext/Polly/issues/2375","id":2479651846,"node_id":"IC_kwDOAJaD5s6TzHwG","user":{"login":"quixoticaxis","id":14001556,"node_id":"MDQ6VXNlcjE0MDAxNTU2","avatar_url":"https://avatars.githubusercontent.com/u/14001556?v=4","gravatar_id":"","url":"https://api.github.com/users/quixoticaxis","html_url":"https://github.com/quixoticaxis","followers_url":"https://api.github.com/users/quixoticaxis/followers","following_url":"https://api.github.com/users/quixoticaxis/following{/other_user}","gists_url":"https://api.github.com/users/quixoticaxis/gists{/gist_id}","starred_url":"https://api.github.com/users/quixoticaxis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/quixoticaxis/subscriptions","organizations_url":"https://api.github.com/users/quixoticaxis/orgs","repos_url":"https://api.github.com/users/quixoticaxis/repos","events_url":"https://api.github.com/users/quixoticaxis/events{/privacy}","received_events_url":"https://api.github.com/users/quixoticaxis/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-11-15T18:15:39Z","updated_at":"2024-11-15T18:16:33Z","body":"Real code:\r\n```csharp\r\nvar retryPipeline = new ResiliencePipelineBuilder()\r\n    .AddRetry(\r\n        new RetryStrategyOptions\r\n        {\r\n            ShouldHandle = new PredicateBuilder()\r\n                .Handle<HttpRequestException>() // HTTP failure\r\n                .Handle<OperationCanceledException>( // HTTP timeout, not a cancellation\r\n                    exception => exception.CancellationToken != cancellationToken),\r\n            BackoffType = DelayBackoffType.Constant,\r\n            UseJitter = true,\r\n            MaxRetryAttempts = configuration.MaxRetryAttempts,\r\n            Delay = configuration.RetryPeriod,\r\n            OnRetry = HandleOnRetryCallback\r\n        }).Build();\r\n// ...       \r\nawait retryPipeline.ExecuteAsync(\r\n    async token => await fetcher.UpdateAsync(token), // uses HTTP client and JSON deserialization inside\r\n    cancellationToken);\r\n```\r\nThis code may throw `HttpRequestException`, `JsonException`, `OperationCanceledException` (which is a timeout) on cancellation. Or it may throw `OperationCanceledException` if it's currently in a \"waiting\" state.\r\n\r\nI use the following fix:\r\n```csharp\r\nasync Task RetryAndFixPollyExceptionsAsync(\r\n    ResiliencePipeline retryPipeline,\r\n    CancellationToken cancellationToken)\r\n{\r\n   try\r\n   {\r\n       await retryPipeline.ExecuteAsync(\r\n           async token => await fetcher.UpdateAsync(token),\r\n           cancellationToken);\r\n   }\r\n   catch (Exception caught) when (cancellationToken.IsCancellationRequested\r\n       && caught is HttpRequestException\r\n           or OperationCanceledException\r\n           or JsonException)\r\n   {\r\n       cancellationToken.ThrowIfCancellationRequested();\r\n   }\r\n}\r\n```\r\nwhich is a dirty hack, IMHO.","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/App-vNext/Polly/issues/comments/2479651846/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"quixoticaxis","id":14001556,"node_id":"MDQ6VXNlcjE0MDAxNTU2","avatar_url":"https://avatars.githubusercontent.com/u/14001556?v=4","gravatar_id":"","url":"https://api.github.com/users/quixoticaxis","html_url":"https://github.com/quixoticaxis","followers_url":"https://api.github.com/users/quixoticaxis/followers","following_url":"https://api.github.com/users/quixoticaxis/following{/other_user}","gists_url":"https://api.github.com/users/quixoticaxis/gists{/gist_id}","starred_url":"https://api.github.com/users/quixoticaxis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/quixoticaxis/subscriptions","organizations_url":"https://api.github.com/users/quixoticaxis/orgs","repos_url":"https://api.github.com/users/quixoticaxis/repos","events_url":"https://api.github.com/users/quixoticaxis/events{/privacy}","received_events_url":"https://api.github.com/users/quixoticaxis/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/App-vNext/Polly/issues/comments/2482312934","html_url":"https://github.com/App-vNext/Polly/issues/2375#issuecomment-2482312934","issue_url":"https://api.github.com/repos/App-vNext/Polly/issues/2375","id":2482312934,"node_id":"IC_kwDOAJaD5s6T9Rbm","user":{"login":"peter-csala","id":57183693,"node_id":"MDQ6VXNlcjU3MTgzNjkz","avatar_url":"https://avatars.githubusercontent.com/u/57183693?v=4","gravatar_id":"","url":"https://api.github.com/users/peter-csala","html_url":"https://github.com/peter-csala","followers_url":"https://api.github.com/users/peter-csala/followers","following_url":"https://api.github.com/users/peter-csala/following{/other_user}","gists_url":"https://api.github.com/users/peter-csala/gists{/gist_id}","starred_url":"https://api.github.com/users/peter-csala/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/peter-csala/subscriptions","organizations_url":"https://api.github.com/users/peter-csala/orgs","repos_url":"https://api.github.com/users/peter-csala/repos","events_url":"https://api.github.com/users/peter-csala/events{/privacy}","received_events_url":"https://api.github.com/users/peter-csala/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-11-18T08:52:46Z","updated_at":"2024-11-18T08:52:46Z","body":"Thank you @kmcclellan and @quixoticaxis for the input. I will start working on this today. I need to double check whether other strategies are impacted as well (like Timeout and Hedging). ","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/App-vNext/Polly/issues/comments/2482312934/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":1,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"peter-csala","id":57183693,"node_id":"MDQ6VXNlcjU3MTgzNjkz","avatar_url":"https://avatars.githubusercontent.com/u/57183693?v=4","gravatar_id":"","url":"https://api.github.com/users/peter-csala","html_url":"https://github.com/peter-csala","followers_url":"https://api.github.com/users/peter-csala/followers","following_url":"https://api.github.com/users/peter-csala/following{/other_user}","gists_url":"https://api.github.com/users/peter-csala/gists{/gist_id}","starred_url":"https://api.github.com/users/peter-csala/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/peter-csala/subscriptions","organizations_url":"https://api.github.com/users/peter-csala/orgs","repos_url":"https://api.github.com/users/peter-csala/repos","events_url":"https://api.github.com/users/peter-csala/events{/privacy}","received_events_url":"https://api.github.com/users/peter-csala/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":15330530636,"node_id":"MEE_lADOAJaD5s6d-Ki-zwAAAAORxVVM","url":"https://api.github.com/repos/App-vNext/Polly/issues/events/15330530636","actor":{"login":"quixoticaxis","id":14001556,"node_id":"MDQ6VXNlcjE0MDAxNTU2","avatar_url":"https://avatars.githubusercontent.com/u/14001556?v=4","gravatar_id":"","url":"https://api.github.com/users/quixoticaxis","html_url":"https://github.com/quixoticaxis","followers_url":"https://api.github.com/users/quixoticaxis/followers","following_url":"https://api.github.com/users/quixoticaxis/following{/other_user}","gists_url":"https://api.github.com/users/quixoticaxis/gists{/gist_id}","starred_url":"https://api.github.com/users/quixoticaxis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/quixoticaxis/subscriptions","organizations_url":"https://api.github.com/users/quixoticaxis/orgs","repos_url":"https://api.github.com/users/quixoticaxis/repos","events_url":"https://api.github.com/users/quixoticaxis/events{/privacy}","received_events_url":"https://api.github.com/users/quixoticaxis/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2024-11-18T08:52:47Z","performed_via_github_app":null},{"id":15330530655,"node_id":"SE_lADOAJaD5s6d-Ki-zwAAAAORxVVf","url":"https://api.github.com/repos/App-vNext/Polly/issues/events/15330530655","actor":{"login":"quixoticaxis","id":14001556,"node_id":"MDQ6VXNlcjE0MDAxNTU2","avatar_url":"https://avatars.githubusercontent.com/u/14001556?v=4","gravatar_id":"","url":"https://api.github.com/users/quixoticaxis","html_url":"https://github.com/quixoticaxis","followers_url":"https://api.github.com/users/quixoticaxis/followers","following_url":"https://api.github.com/users/quixoticaxis/following{/other_user}","gists_url":"https://api.github.com/users/quixoticaxis/gists{/gist_id}","starred_url":"https://api.github.com/users/quixoticaxis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/quixoticaxis/subscriptions","organizations_url":"https://api.github.com/users/quixoticaxis/orgs","repos_url":"https://api.github.com/users/quixoticaxis/repos","events_url":"https://api.github.com/users/quixoticaxis/events{/privacy}","received_events_url":"https://api.github.com/users/quixoticaxis/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2024-11-18T08:52:47Z","performed_via_github_app":null},{"id":15330530671,"node_id":"MEE_lADOAJaD5s6d-Ki-zwAAAAORxVVv","url":"https://api.github.com/repos/App-vNext/Polly/issues/events/15330530671","actor":{"login":"kmcclellan","id":43862801,"node_id":"MDQ6VXNlcjQzODYyODAx","avatar_url":"https://avatars.githubusercontent.com/u/43862801?v=4","gravatar_id":"","url":"https://api.github.com/users/kmcclellan","html_url":"https://github.com/kmcclellan","followers_url":"https://api.github.com/users/kmcclellan/followers","following_url":"https://api.github.com/users/kmcclellan/following{/other_user}","gists_url":"https://api.github.com/users/kmcclellan/gists{/gist_id}","starred_url":"https://api.github.com/users/kmcclellan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kmcclellan/subscriptions","organizations_url":"https://api.github.com/users/kmcclellan/orgs","repos_url":"https://api.github.com/users/kmcclellan/repos","events_url":"https://api.github.com/users/kmcclellan/events{/privacy}","received_events_url":"https://api.github.com/users/kmcclellan/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2024-11-18T08:52:47Z","performed_via_github_app":null},{"id":15330530681,"node_id":"SE_lADOAJaD5s6d-Ki-zwAAAAORxVV5","url":"https://api.github.com/repos/App-vNext/Polly/issues/events/15330530681","actor":{"login":"kmcclellan","id":43862801,"node_id":"MDQ6VXNlcjQzODYyODAx","avatar_url":"https://avatars.githubusercontent.com/u/43862801?v=4","gravatar_id":"","url":"https://api.github.com/users/kmcclellan","html_url":"https://github.com/kmcclellan","followers_url":"https://api.github.com/users/kmcclellan/followers","following_url":"https://api.github.com/users/kmcclellan/following{/other_user}","gists_url":"https://api.github.com/users/kmcclellan/gists{/gist_id}","starred_url":"https://api.github.com/users/kmcclellan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kmcclellan/subscriptions","organizations_url":"https://api.github.com/users/kmcclellan/orgs","repos_url":"https://api.github.com/users/kmcclellan/repos","events_url":"https://api.github.com/users/kmcclellan/events{/privacy}","received_events_url":"https://api.github.com/users/kmcclellan/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2024-11-18T08:52:47Z","performed_via_github_app":null},{"actor":{"login":"peter-csala","id":57183693,"node_id":"MDQ6VXNlcjU3MTgzNjkz","avatar_url":"https://avatars.githubusercontent.com/u/57183693?v=4","gravatar_id":"","url":"https://api.github.com/users/peter-csala","html_url":"https://github.com/peter-csala","followers_url":"https://api.github.com/users/peter-csala/followers","following_url":"https://api.github.com/users/peter-csala/following{/other_user}","gists_url":"https://api.github.com/users/peter-csala/gists{/gist_id}","starred_url":"https://api.github.com/users/peter-csala/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/peter-csala/subscriptions","organizations_url":"https://api.github.com/users/peter-csala/orgs","repos_url":"https://api.github.com/users/peter-csala/repos","events_url":"https://api.github.com/users/peter-csala/events{/privacy}","received_events_url":"https://api.github.com/users/peter-csala/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-11-18T11:27:37Z","updated_at":"2024-11-18T11:27:37Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/App-vNext/Polly/issues/2396","repository_url":"https://api.github.com/repos/App-vNext/Polly","labels_url":"https://api.github.com/repos/App-vNext/Polly/issues/2396/labels{/name}","comments_url":"https://api.github.com/repos/App-vNext/Polly/issues/2396/comments","events_url":"https://api.github.com/repos/App-vNext/Polly/issues/2396/events","html_url":"https://github.com/App-vNext/Polly/pull/2396","id":2668218823,"node_id":"PR_kwDOAJaD5s6CO7HT","number":2396,"title":"Handle CancellationToken for Retry","user":{"login":"peter-csala","id":57183693,"node_id":"MDQ6VXNlcjU3MTgzNjkz","avatar_url":"https://avatars.githubusercontent.com/u/57183693?v=4","gravatar_id":"","url":"https://api.github.com/users/peter-csala","html_url":"https://github.com/peter-csala","followers_url":"https://api.github.com/users/peter-csala/followers","following_url":"https://api.github.com/users/peter-csala/following{/other_user}","gists_url":"https://api.github.com/users/peter-csala/gists{/gist_id}","starred_url":"https://api.github.com/users/peter-csala/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/peter-csala/subscriptions","organizations_url":"https://api.github.com/users/peter-csala/orgs","repos_url":"https://api.github.com/users/peter-csala/repos","events_url":"https://api.github.com/users/peter-csala/events{/privacy}","received_events_url":"https://api.github.com/users/peter-csala/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2024-11-18T11:27:36Z","updated_at":"2025-01-11T12:41:17Z","closed_at":"2024-12-20T13:39:31Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"draft":false,"repository":{"id":9864166,"node_id":"MDEwOlJlcG9zaXRvcnk5ODY0MTY2","name":"Polly","full_name":"App-vNext/Polly","private":false,"owner":{"login":"App-vNext","id":9165070,"node_id":"MDEyOk9yZ2FuaXphdGlvbjkxNjUwNzA=","avatar_url":"https://avatars.githubusercontent.com/u/9165070?v=4","gravatar_id":"","url":"https://api.github.com/users/App-vNext","html_url":"https://github.com/App-vNext","followers_url":"https://api.github.com/users/App-vNext/followers","following_url":"https://api.github.com/users/App-vNext/following{/other_user}","gists_url":"https://api.github.com/users/App-vNext/gists{/gist_id}","starred_url":"https://api.github.com/users/App-vNext/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/App-vNext/subscriptions","organizations_url":"https://api.github.com/users/App-vNext/orgs","repos_url":"https://api.github.com/users/App-vNext/repos","events_url":"https://api.github.com/users/App-vNext/events{/privacy}","received_events_url":"https://api.github.com/users/App-vNext/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/App-vNext/Polly","description":"Polly is a .NET resilience and transient-fault-handling library that allows developers to express policies such as Retry, Circuit Breaker, Timeout, Bulkhead Isolation, and Fallback in a fluent and thread-safe manner. From version 6.0.1, Polly targets .NET Standard 1.1 and 2.0+.","fork":false,"url":"https://api.github.com/repos/App-vNext/Polly","forks_url":"https://api.github.com/repos/App-vNext/Polly/forks","keys_url":"https://api.github.com/repos/App-vNext/Polly/keys{/key_id}","collaborators_url":"https://api.github.com/repos/App-vNext/Polly/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/App-vNext/Polly/teams","hooks_url":"https://api.github.com/repos/App-vNext/Polly/hooks","issue_events_url":"https://api.github.com/repos/App-vNext/Polly/issues/events{/number}","events_url":"https://api.github.com/repos/App-vNext/Polly/events","assignees_url":"https://api.github.com/repos/App-vNext/Polly/assignees{/user}","branches_url":"https://api.github.com/repos/App-vNext/Polly/branches{/branch}","tags_url":"https://api.github.com/repos/App-vNext/Polly/tags","blobs_url":"https://api.github.com/repos/App-vNext/Polly/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/App-vNext/Polly/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/App-vNext/Polly/git/refs{/sha}","trees_url":"https://api.github.com/repos/App-vNext/Polly/git/trees{/sha}","statuses_url":"https://api.github.com/repos/App-vNext/Polly/statuses/{sha}","languages_url":"https://api.github.com/repos/App-vNext/Polly/languages","stargazers_url":"https://api.github.com/repos/App-vNext/Polly/stargazers","contributors_url":"https://api.github.com/repos/App-vNext/Polly/contributors","subscribers_url":"https://api.github.com/repos/App-vNext/Polly/subscribers","subscription_url":"https://api.github.com/repos/App-vNext/Polly/subscription","commits_url":"https://api.github.com/repos/App-vNext/Polly/commits{/sha}","git_commits_url":"https://api.github.com/repos/App-vNext/Polly/git/commits{/sha}","comments_url":"https://api.github.com/repos/App-vNext/Polly/comments{/number}","issue_comment_url":"https://api.github.com/repos/App-vNext/Polly/issues/comments{/number}","contents_url":"https://api.github.com/repos/App-vNext/Polly/contents/{+path}","compare_url":"https://api.github.com/repos/App-vNext/Polly/compare/{base}...{head}","merges_url":"https://api.github.com/repos/App-vNext/Polly/merges","archive_url":"https://api.github.com/repos/App-vNext/Polly/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/App-vNext/Polly/downloads","issues_url":"https://api.github.com/repos/App-vNext/Polly/issues{/number}","pulls_url":"https://api.github.com/repos/App-vNext/Polly/pulls{/number}","milestones_url":"https://api.github.com/repos/App-vNext/Polly/milestones{/number}","notifications_url":"https://api.github.com/repos/App-vNext/Polly/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/App-vNext/Polly/labels{/name}","releases_url":"https://api.github.com/repos/App-vNext/Polly/releases{/id}","deployments_url":"https://api.github.com/repos/App-vNext/Polly/deployments","created_at":"2013-05-05T04:40:04Z","updated_at":"2025-11-09T07:09:31Z","pushed_at":"2025-11-06T17:28:00Z","git_url":"git://github.com/App-vNext/Polly.git","ssh_url":"git@github.com:App-vNext/Polly.git","clone_url":"https://github.com/App-vNext/Polly.git","svn_url":"https://github.com/App-vNext/Polly","homepage":"https://www.thepollyproject.org","size":52503,"stargazers_count":14028,"watchers_count":14028,"language":"C#","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":true,"has_discussions":true,"forks_count":1263,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":7,"license":{"key":"bsd-3-clause","name":"BSD 3-Clause \"New\" or \"Revised\" License","spdx_id":"BSD-3-Clause","url":"https://api.github.com/licenses/bsd-3-clause","node_id":"MDc6TGljZW5zZTU="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["circuit-breaker","circuit-breaker-pattern","dotnet","fault-handler","resilience","resiliency-patterns","retry-strategies","transient-fault-handling"],"visibility":"public","forks":1263,"open_issues":7,"watchers":14028,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/App-vNext/Polly/pulls/2396","html_url":"https://github.com/App-vNext/Polly/pull/2396","diff_url":"https://github.com/App-vNext/Polly/pull/2396.diff","patch_url":"https://github.com/App-vNext/Polly/pull/2396.patch","merged_at":null},"body":"<!-- Thank you for contributing to Polly!  Open source is only as strong as its contributors. -->\r\n\r\n# Pull Request\r\n\r\n## The issue or feature being addressed\r\n\r\n#2375 \r\n\r\n## Details on the issue fix or feature implementation\r\n\r\n- Retry: handle cancelled `CancellationToken` as `OperationCanceledException`\r\n- Assessment\r\n  - Hedging: handles cancelled `CancellationToken` as `OperationCanceledException`\r\n  - Timeout: does not handle cancelled `CancellationToken` as `OperationCanceledException`\r\n    - We might want to tackle that as a separate PR \r\n\r\n## Confirm the following\r\n\r\n- [x]  I started this PR by branching from the head of the default branch\r\n- [x]  I have targeted the PR to merge into the default branch\r\n- [x]  I have included unit tests for the issue/feature\r\n- [x]  I have successfully run a local build\r\n","reactions":{"url":"https://api.github.com/repos/App-vNext/Polly/issues/2396/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/App-vNext/Polly/issues/2396/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"id":15508884243,"node_id":"MIE_lADOAJaD5s6d-Ki-zwAAAAOcZssT","url":"https://api.github.com/repos/App-vNext/Polly/issues/events/15508884243","actor":{"login":"martincostello","id":1439341,"node_id":"MDQ6VXNlcjE0MzkzNDE=","avatar_url":"https://avatars.githubusercontent.com/u/1439341?v=4","gravatar_id":"","url":"https://api.github.com/users/martincostello","html_url":"https://github.com/martincostello","followers_url":"https://api.github.com/users/martincostello/followers","following_url":"https://api.github.com/users/martincostello/following{/other_user}","gists_url":"https://api.github.com/users/martincostello/gists{/gist_id}","starred_url":"https://api.github.com/users/martincostello/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/martincostello/subscriptions","organizations_url":"https://api.github.com/users/martincostello/orgs","repos_url":"https://api.github.com/users/martincostello/repos","events_url":"https://api.github.com/users/martincostello/events{/privacy}","received_events_url":"https://api.github.com/users/martincostello/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"milestoned","commit_id":null,"commit_url":null,"created_at":"2024-12-03T12:21:48Z","milestone":{"title":"v8.5.1"},"performed_via_github_app":null},{"id":15732822893,"node_id":"UNE_lADOAJaD5s6d-Ki-zwAAAAOpv9Nt","url":"https://api.github.com/repos/App-vNext/Polly/issues/events/15732822893","actor":{"login":"peter-csala","id":57183693,"node_id":"MDQ6VXNlcjU3MTgzNjkz","avatar_url":"https://avatars.githubusercontent.com/u/57183693?v=4","gravatar_id":"","url":"https://api.github.com/users/peter-csala","html_url":"https://github.com/peter-csala","followers_url":"https://api.github.com/users/peter-csala/followers","following_url":"https://api.github.com/users/peter-csala/following{/other_user}","gists_url":"https://api.github.com/users/peter-csala/gists{/gist_id}","starred_url":"https://api.github.com/users/peter-csala/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/peter-csala/subscriptions","organizations_url":"https://api.github.com/users/peter-csala/orgs","repos_url":"https://api.github.com/users/peter-csala/repos","events_url":"https://api.github.com/users/peter-csala/events{/privacy}","received_events_url":"https://api.github.com/users/peter-csala/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"unassigned","commit_id":null,"commit_url":null,"created_at":"2024-12-20T13:40:18Z","assignee":{"login":"peter-csala","id":57183693,"node_id":"MDQ6VXNlcjU3MTgzNjkz","avatar_url":"https://avatars.githubusercontent.com/u/57183693?v=4","gravatar_id":"","url":"https://api.github.com/users/peter-csala","html_url":"https://github.com/peter-csala","followers_url":"https://api.github.com/users/peter-csala/followers","following_url":"https://api.github.com/users/peter-csala/following{/other_user}","gists_url":"https://api.github.com/users/peter-csala/gists{/gist_id}","starred_url":"https://api.github.com/users/peter-csala/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/peter-csala/subscriptions","organizations_url":"https://api.github.com/users/peter-csala/orgs","repos_url":"https://api.github.com/users/peter-csala/repos","events_url":"https://api.github.com/users/peter-csala/events{/privacy}","received_events_url":"https://api.github.com/users/peter-csala/received_events","type":"User","user_view_type":"public","site_admin":false},"performed_via_github_app":null},{"id":15892493839,"node_id":"DEME_lADOAJaD5s6d-Ki-zwAAAAOzRDYP","url":"https://api.github.com/repos/App-vNext/Polly/issues/events/15892493839","actor":{"login":"martincostello","id":1439341,"node_id":"MDQ6VXNlcjE0MzkzNDE=","avatar_url":"https://avatars.githubusercontent.com/u/1439341?v=4","gravatar_id":"","url":"https://api.github.com/users/martincostello","html_url":"https://github.com/martincostello","followers_url":"https://api.github.com/users/martincostello/followers","following_url":"https://api.github.com/users/martincostello/following{/other_user}","gists_url":"https://api.github.com/users/martincostello/gists{/gist_id}","starred_url":"https://api.github.com/users/martincostello/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/martincostello/subscriptions","organizations_url":"https://api.github.com/users/martincostello/orgs","repos_url":"https://api.github.com/users/martincostello/repos","events_url":"https://api.github.com/users/martincostello/events{/privacy}","received_events_url":"https://api.github.com/users/martincostello/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"demilestoned","commit_id":null,"commit_url":null,"created_at":"2025-01-11T12:41:55Z","milestone":{"title":"v8.5.1"},"performed_via_github_app":null},{"id":15984144031,"node_id":"REFE_lADOAJaD5s6d-Ki-zwAAAAO4uq6f","url":"https://api.github.com/repos/App-vNext/Polly/issues/events/15984144031","actor":{"login":"kmcclellan","id":43862801,"node_id":"MDQ6VXNlcjQzODYyODAx","avatar_url":"https://avatars.githubusercontent.com/u/43862801?v=4","gravatar_id":"","url":"https://api.github.com/users/kmcclellan","html_url":"https://github.com/kmcclellan","followers_url":"https://api.github.com/users/kmcclellan/followers","following_url":"https://api.github.com/users/kmcclellan/following{/other_user}","gists_url":"https://api.github.com/users/kmcclellan/gists{/gist_id}","starred_url":"https://api.github.com/users/kmcclellan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kmcclellan/subscriptions","organizations_url":"https://api.github.com/users/kmcclellan/orgs","repos_url":"https://api.github.com/users/kmcclellan/repos","events_url":"https://api.github.com/users/kmcclellan/events{/privacy}","received_events_url":"https://api.github.com/users/kmcclellan/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"b66ad706ddf5f89d3b029f30b5384e1f48192804","commit_url":"https://api.github.com/repos/kmcclellan/Polly/commits/b66ad706ddf5f89d3b029f30b5384e1f48192804","created_at":"2025-01-18T02:33:02Z","performed_via_github_app":null},{"actor":{"login":"kmcclellan","id":43862801,"node_id":"MDQ6VXNlcjQzODYyODAx","avatar_url":"https://avatars.githubusercontent.com/u/43862801?v=4","gravatar_id":"","url":"https://api.github.com/users/kmcclellan","html_url":"https://github.com/kmcclellan","followers_url":"https://api.github.com/users/kmcclellan/followers","following_url":"https://api.github.com/users/kmcclellan/following{/other_user}","gists_url":"https://api.github.com/users/kmcclellan/gists{/gist_id}","starred_url":"https://api.github.com/users/kmcclellan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kmcclellan/subscriptions","organizations_url":"https://api.github.com/users/kmcclellan/orgs","repos_url":"https://api.github.com/users/kmcclellan/repos","events_url":"https://api.github.com/users/kmcclellan/events{/privacy}","received_events_url":"https://api.github.com/users/kmcclellan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-01-18T02:54:54Z","updated_at":"2025-01-18T02:54:54Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/App-vNext/Polly/issues/2456","repository_url":"https://api.github.com/repos/App-vNext/Polly","labels_url":"https://api.github.com/repos/App-vNext/Polly/issues/2456/labels{/name}","comments_url":"https://api.github.com/repos/App-vNext/Polly/issues/2456/comments","events_url":"https://api.github.com/repos/App-vNext/Polly/issues/2456/events","html_url":"https://github.com/App-vNext/Polly/pull/2456","id":2796600716,"node_id":"PR_kwDOAJaD5s6IN1rJ","number":2456,"title":"Fix for retry cancellation","user":{"login":"kmcclellan","id":43862801,"node_id":"MDQ6VXNlcjQzODYyODAx","avatar_url":"https://avatars.githubusercontent.com/u/43862801?v=4","gravatar_id":"","url":"https://api.github.com/users/kmcclellan","html_url":"https://github.com/kmcclellan","followers_url":"https://api.github.com/users/kmcclellan/followers","following_url":"https://api.github.com/users/kmcclellan/following{/other_user}","gists_url":"https://api.github.com/users/kmcclellan/gists{/gist_id}","starred_url":"https://api.github.com/users/kmcclellan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kmcclellan/subscriptions","organizations_url":"https://api.github.com/users/kmcclellan/orgs","repos_url":"https://api.github.com/users/kmcclellan/repos","events_url":"https://api.github.com/users/kmcclellan/events{/privacy}","received_events_url":"https://api.github.com/users/kmcclellan/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":1189809074,"node_id":"MDU6TGFiZWwxMTg5ODA5MDc0","url":"https://api.github.com/repos/App-vNext/Polly/labels/bug%20fix","name":"bug fix","color":"fc2929","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/App-vNext/Polly/milestones/55","html_url":"https://github.com/App-vNext/Polly/milestone/55","labels_url":"https://api.github.com/repos/App-vNext/Polly/milestones/55/labels","id":12158580,"node_id":"MI_kwDOAJaD5s4AuYZ0","number":55,"title":"v8.5.2","description":"","creator":{"login":"martincostello","id":1439341,"node_id":"MDQ6VXNlcjE0MzkzNDE=","avatar_url":"https://avatars.githubusercontent.com/u/1439341?v=4","gravatar_id":"","url":"https://api.github.com/users/martincostello","html_url":"https://github.com/martincostello","followers_url":"https://api.github.com/users/martincostello/followers","following_url":"https://api.github.com/users/martincostello/following{/other_user}","gists_url":"https://api.github.com/users/martincostello/gists{/gist_id}","starred_url":"https://api.github.com/users/martincostello/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/martincostello/subscriptions","organizations_url":"https://api.github.com/users/martincostello/orgs","repos_url":"https://api.github.com/users/martincostello/repos","events_url":"https://api.github.com/users/martincostello/events{/privacy}","received_events_url":"https://api.github.com/users/martincostello/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":3,"state":"closed","created_at":"2025-01-13T18:02:11Z","updated_at":"2025-02-04T11:45:16Z","due_on":"2025-02-04T08:00:00Z","closed_at":"2025-02-04T11:45:03Z"},"comments":3,"created_at":"2025-01-18T02:54:53Z","updated_at":"2025-02-05T03:05:11Z","closed_at":"2025-02-04T08:43:29Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"draft":false,"repository":{"id":9864166,"node_id":"MDEwOlJlcG9zaXRvcnk5ODY0MTY2","name":"Polly","full_name":"App-vNext/Polly","private":false,"owner":{"login":"App-vNext","id":9165070,"node_id":"MDEyOk9yZ2FuaXphdGlvbjkxNjUwNzA=","avatar_url":"https://avatars.githubusercontent.com/u/9165070?v=4","gravatar_id":"","url":"https://api.github.com/users/App-vNext","html_url":"https://github.com/App-vNext","followers_url":"https://api.github.com/users/App-vNext/followers","following_url":"https://api.github.com/users/App-vNext/following{/other_user}","gists_url":"https://api.github.com/users/App-vNext/gists{/gist_id}","starred_url":"https://api.github.com/users/App-vNext/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/App-vNext/subscriptions","organizations_url":"https://api.github.com/users/App-vNext/orgs","repos_url":"https://api.github.com/users/App-vNext/repos","events_url":"https://api.github.com/users/App-vNext/events{/privacy}","received_events_url":"https://api.github.com/users/App-vNext/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/App-vNext/Polly","description":"Polly is a .NET resilience and transient-fault-handling library that allows developers to express policies such as Retry, Circuit Breaker, Timeout, Bulkhead Isolation, and Fallback in a fluent and thread-safe manner. From version 6.0.1, Polly targets .NET Standard 1.1 and 2.0+.","fork":false,"url":"https://api.github.com/repos/App-vNext/Polly","forks_url":"https://api.github.com/repos/App-vNext/Polly/forks","keys_url":"https://api.github.com/repos/App-vNext/Polly/keys{/key_id}","collaborators_url":"https://api.github.com/repos/App-vNext/Polly/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/App-vNext/Polly/teams","hooks_url":"https://api.github.com/repos/App-vNext/Polly/hooks","issue_events_url":"https://api.github.com/repos/App-vNext/Polly/issues/events{/number}","events_url":"https://api.github.com/repos/App-vNext/Polly/events","assignees_url":"https://api.github.com/repos/App-vNext/Polly/assignees{/user}","branches_url":"https://api.github.com/repos/App-vNext/Polly/branches{/branch}","tags_url":"https://api.github.com/repos/App-vNext/Polly/tags","blobs_url":"https://api.github.com/repos/App-vNext/Polly/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/App-vNext/Polly/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/App-vNext/Polly/git/refs{/sha}","trees_url":"https://api.github.com/repos/App-vNext/Polly/git/trees{/sha}","statuses_url":"https://api.github.com/repos/App-vNext/Polly/statuses/{sha}","languages_url":"https://api.github.com/repos/App-vNext/Polly/languages","stargazers_url":"https://api.github.com/repos/App-vNext/Polly/stargazers","contributors_url":"https://api.github.com/repos/App-vNext/Polly/contributors","subscribers_url":"https://api.github.com/repos/App-vNext/Polly/subscribers","subscription_url":"https://api.github.com/repos/App-vNext/Polly/subscription","commits_url":"https://api.github.com/repos/App-vNext/Polly/commits{/sha}","git_commits_url":"https://api.github.com/repos/App-vNext/Polly/git/commits{/sha}","comments_url":"https://api.github.com/repos/App-vNext/Polly/comments{/number}","issue_comment_url":"https://api.github.com/repos/App-vNext/Polly/issues/comments{/number}","contents_url":"https://api.github.com/repos/App-vNext/Polly/contents/{+path}","compare_url":"https://api.github.com/repos/App-vNext/Polly/compare/{base}...{head}","merges_url":"https://api.github.com/repos/App-vNext/Polly/merges","archive_url":"https://api.github.com/repos/App-vNext/Polly/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/App-vNext/Polly/downloads","issues_url":"https://api.github.com/repos/App-vNext/Polly/issues{/number}","pulls_url":"https://api.github.com/repos/App-vNext/Polly/pulls{/number}","milestones_url":"https://api.github.com/repos/App-vNext/Polly/milestones{/number}","notifications_url":"https://api.github.com/repos/App-vNext/Polly/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/App-vNext/Polly/labels{/name}","releases_url":"https://api.github.com/repos/App-vNext/Polly/releases{/id}","deployments_url":"https://api.github.com/repos/App-vNext/Polly/deployments","created_at":"2013-05-05T04:40:04Z","updated_at":"2025-11-09T07:09:31Z","pushed_at":"2025-11-06T17:28:00Z","git_url":"git://github.com/App-vNext/Polly.git","ssh_url":"git@github.com:App-vNext/Polly.git","clone_url":"https://github.com/App-vNext/Polly.git","svn_url":"https://github.com/App-vNext/Polly","homepage":"https://www.thepollyproject.org","size":52503,"stargazers_count":14028,"watchers_count":14028,"language":"C#","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":true,"has_discussions":true,"forks_count":1263,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":7,"license":{"key":"bsd-3-clause","name":"BSD 3-Clause \"New\" or \"Revised\" License","spdx_id":"BSD-3-Clause","url":"https://api.github.com/licenses/bsd-3-clause","node_id":"MDc6TGljZW5zZTU="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["circuit-breaker","circuit-breaker-pattern","dotnet","fault-handler","resilience","resiliency-patterns","retry-strategies","transient-fault-handling"],"visibility":"public","forks":1263,"open_issues":7,"watchers":14028,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/App-vNext/Polly/pulls/2456","html_url":"https://github.com/App-vNext/Polly/pull/2456","diff_url":"https://github.com/App-vNext/Polly/pull/2456.diff","patch_url":"https://github.com/App-vNext/Polly/pull/2456.patch","merged_at":"2025-02-04T08:43:29Z"},"body":"# Pull Request\r\n\r\n## The issue or feature being addressed\r\n\r\n[[Bug]: Inconsistent behavior when canceling a retry](https://github.com/App-vNext/Polly/issues/2375)\r\n\r\n## Details on the issue fix or feature implementation\r\n\r\nDespite how the conversations around [the previous attempt](https://github.com/App-vNext/Polly/pull/2396), only a small change is needed to make this work in a way that is coherent.\r\n\r\nNote my choice to avoid throwing until _after_ delay is calculated and the retry event is logged. I think this is most likely what a user will expect, since every failed attempt currently generates such a log, and the outcome was \"handled\" in the sense that it was prevented from surfacing.\r\n\r\nThis also takes care of @martintmk's concern about disposables, since `DisposeHelper` is also called before cancellation is acknowledged, just as though we were continuing with the retry. I've added an extra test case for this too.\r\n\r\n## Confirm the following\r\n\r\n- [X]  I started this PR by branching from the head of the default branch\r\n- [X]  I have targeted the PR to merge into the default branch\r\n- [X]  I have included unit tests for the issue/feature\r\n- [X]  I have successfully run a local build\r\n","reactions":{"url":"https://api.github.com/repos/App-vNext/Polly/issues/2456/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/App-vNext/Polly/issues/2456/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"id":16174431946,"node_id":"CE_lADOAJaD5s6d-Ki-zwAAAAPEEj7K","url":"https://api.github.com/repos/App-vNext/Polly/issues/events/16174431946","actor":{"login":"martincostello","id":1439341,"node_id":"MDQ6VXNlcjE0MzkzNDE=","avatar_url":"https://avatars.githubusercontent.com/u/1439341?v=4","gravatar_id":"","url":"https://api.github.com/users/martincostello","html_url":"https://github.com/martincostello","followers_url":"https://api.github.com/users/martincostello/followers","following_url":"https://api.github.com/users/martincostello/following{/other_user}","gists_url":"https://api.github.com/users/martincostello/gists{/gist_id}","starred_url":"https://api.github.com/users/martincostello/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/martincostello/subscriptions","organizations_url":"https://api.github.com/users/martincostello/orgs","repos_url":"https://api.github.com/users/martincostello/repos","events_url":"https://api.github.com/users/martincostello/events{/privacy}","received_events_url":"https://api.github.com/users/martincostello/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"closed","commit_id":"a953ba8119074d7f63cc69643d4ef1d1de52ee3f","commit_url":"https://api.github.com/repos/App-vNext/Polly/commits/a953ba8119074d7f63cc69643d4ef1d1de52ee3f","created_at":"2025-02-04T08:43:30Z","state_reason":null,"performed_via_github_app":null},{"id":16176692248,"node_id":"REFE_lADOAJaD5s6d-Ki-zwAAAAPENLwY","url":"https://api.github.com/repos/App-vNext/Polly/issues/events/16176692248","actor":{"login":"pull[bot]","id":39814207,"node_id":"MDM6Qm90Mzk4MTQyMDc=","avatar_url":"https://avatars.githubusercontent.com/in/12910?v=4","gravatar_id":"","url":"https://api.github.com/users/pull%5Bbot%5D","html_url":"https://github.com/apps/pull","followers_url":"https://api.github.com/users/pull%5Bbot%5D/followers","following_url":"https://api.github.com/users/pull%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/pull%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/pull%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pull%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/pull%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/pull%5Bbot%5D/repos","events_url":"https://api.github.com/users/pull%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/pull%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"a953ba8119074d7f63cc69643d4ef1d1de52ee3f","commit_url":"https://api.github.com/repos/skaschimer/Polly/commits/a953ba8119074d7f63cc69643d4ef1d1de52ee3f","created_at":"2025-02-04T11:20:04Z","performed_via_github_app":null},{"id":16177179346,"node_id":"MIE_lADOAJaD5s6d-Ki-zwAAAAPEPCrS","url":"https://api.github.com/repos/App-vNext/Polly/issues/events/16177179346","actor":{"login":"martincostello","id":1439341,"node_id":"MDQ6VXNlcjE0MzkzNDE=","avatar_url":"https://avatars.githubusercontent.com/u/1439341?v=4","gravatar_id":"","url":"https://api.github.com/users/martincostello","html_url":"https://github.com/martincostello","followers_url":"https://api.github.com/users/martincostello/followers","following_url":"https://api.github.com/users/martincostello/following{/other_user}","gists_url":"https://api.github.com/users/martincostello/gists{/gist_id}","starred_url":"https://api.github.com/users/martincostello/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/martincostello/subscriptions","organizations_url":"https://api.github.com/users/martincostello/orgs","repos_url":"https://api.github.com/users/martincostello/repos","events_url":"https://api.github.com/users/martincostello/events{/privacy}","received_events_url":"https://api.github.com/users/martincostello/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"milestoned","commit_id":null,"commit_url":null,"created_at":"2025-02-04T11:45:16Z","milestone":{"title":"v8.5.2"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/App-vNext/Polly/issues/comments/2633727055","html_url":"https://github.com/App-vNext/Polly/issues/2375#issuecomment-2633727055","issue_url":"https://api.github.com/repos/App-vNext/Polly/issues/2375","id":2633727055,"node_id":"IC_kwDOAJaD5s6c-3xP","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2025-02-04T12:13:47Z","updated_at":"2025-02-04T12:13:47Z","body":"Thanks for creating this issue @kmcclellan - the associated changes have been published as part of version 8.5.2 :package:, which is now available from NuGet.org :rocket:\n<!-- App-vNext/Polly/nuget-packages-published#2375 -->","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/App-vNext/Polly/issues/comments/2633727055/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":1,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":{"id":15368,"client_id":"Iv1.05c79e9ad1f6bdfa","slug":"github-actions","node_id":"MDM6QXBwMTUzNjg=","owner":{"login":"github","id":9919,"node_id":"MDEyOk9yZ2FuaXphdGlvbjk5MTk=","avatar_url":"https://avatars.githubusercontent.com/u/9919?v=4","gravatar_id":"","url":"https://api.github.com/users/github","html_url":"https://github.com/github","followers_url":"https://api.github.com/users/github/followers","following_url":"https://api.github.com/users/github/following{/other_user}","gists_url":"https://api.github.com/users/github/gists{/gist_id}","starred_url":"https://api.github.com/users/github/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github/subscriptions","organizations_url":"https://api.github.com/users/github/orgs","repos_url":"https://api.github.com/users/github/repos","events_url":"https://api.github.com/users/github/events{/privacy}","received_events_url":"https://api.github.com/users/github/received_events","type":"Organization","user_view_type":"public","site_admin":false},"name":"GitHub Actions","description":"Automate your workflow from idea to production","external_url":"https://help.github.com/en/actions","html_url":"https://github.com/apps/github-actions","created_at":"2018-07-30T09:30:17Z","updated_at":"2025-03-07T16:35:00Z","permissions":{"actions":"write","administration":"read","attestations":"write","checks":"write","contents":"write","deployments":"write","discussions":"write","issues":"write","merge_queues":"write","metadata":"read","models":"read","packages":"write","pages":"write","pull_requests":"write","repository_hooks":"write","repository_projects":"write","security_events":"write","statuses":"write","vulnerability_alerts":"read"},"events":["branch_protection_rule","check_run","check_suite","create","delete","deployment","deployment_status","discussion","discussion_comment","fork","gollum","issues","issue_comment","label","merge_group","milestone","page_build","project","project_card","project_column","public","pull_request","pull_request_review","pull_request_review_comment","push","registry_package","release","repository","repository_dispatch","status","watch","workflow_dispatch","workflow_run"]},"event":"commented","actor":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false}}]