diff --git a/plugins/providers/hyperv/scripts/import_vm.ps1 b/plugins/providers/hyperv/scripts/import_vm.ps1
index a994c1cfb..7232be56d 100644
--- a/plugins/providers/hyperv/scripts/import_vm.ps1
+++ b/plugins/providers/hyperv/scripts/import_vm.ps1
@@ -107,7 +107,6 @@ $secure_boot_enabled = (Select-Xml -xml $vmconfig -XPath "//secure_boot_enabled"
 
 $vm_params = @{
     Name = $vm_name
-    Generation = $generation
     NoVHD = $True
     MemoryStartupBytes = $MemoryStartupBytes
     SwitchName = $switchname
@@ -115,6 +114,11 @@ $vm_params = @{
     ErrorAction = "Stop"
 }
 
+# Generation parameter was added in ps v4
+if((get-command New-VM).Parameters.Keys.Contains("generation")) {
+    $vm_params.Generation = $generation
+}
+
 # Create the VM using the values in the hash map
 
 $vm = New-VM @vm_params
