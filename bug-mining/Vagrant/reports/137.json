{"url":"https://api.github.com/repos/hashicorp/vagrant/issues/10432","repository_url":"https://api.github.com/repos/hashicorp/vagrant","labels_url":"https://api.github.com/repos/hashicorp/vagrant/issues/10432/labels{/name}","comments_url":"https://api.github.com/repos/hashicorp/vagrant/issues/10432/comments","events_url":"https://api.github.com/repos/hashicorp/vagrant/issues/10432/events","html_url":"https://github.com/hashicorp/vagrant/issues/10432","id":382931518,"node_id":"MDU6SXNzdWUzODI5MzE1MTg=","number":10432,"title":"publish.rb:141:in `absolute_path': no implicit conversion of nil into String (TypeError)","user":{"login":"mcandre","id":5316,"node_id":"MDQ6VXNlcjUzMTY=","avatar_url":"https://avatars.githubusercontent.com/u/5316?v=4","gravatar_id":"","url":"https://api.github.com/users/mcandre","html_url":"https://github.com/mcandre","followers_url":"https://api.github.com/users/mcandre/followers","following_url":"https://api.github.com/users/mcandre/following{/other_user}","gists_url":"https://api.github.com/users/mcandre/gists{/gist_id}","starred_url":"https://api.github.com/users/mcandre/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mcandre/subscriptions","organizations_url":"https://api.github.com/users/mcandre/orgs","repos_url":"https://api.github.com/users/mcandre/repos","events_url":"https://api.github.com/users/mcandre/events{/privacy}","received_events_url":"https://api.github.com/users/mcandre/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":25816,"node_id":"MDU6TGFiZWwyNTgxNg==","url":"https://api.github.com/repos/hashicorp/vagrant/labels/bug","name":"bug","color":"e11d21","default":true,"description":null},{"id":283683436,"node_id":"MDU6TGFiZWwyODM2ODM0MzY=","url":"https://api.github.com/repos/hashicorp/vagrant/labels/has-pr","name":"has-pr","color":"fef2c0","default":false,"description":null},{"id":1140747579,"node_id":"MDU6TGFiZWwxMTQwNzQ3NTc5","url":"https://api.github.com/repos/hashicorp/vagrant/labels/vagrant%20cloud%20cli","name":"vagrant cloud cli","color":"6d9fce","default":false,"description":""}],"state":"closed","locked":true,"assignee":{"login":"briancain","id":810277,"node_id":"MDQ6VXNlcjgxMDI3Nw==","avatar_url":"https://avatars.githubusercontent.com/u/810277?v=4","gravatar_id":"","url":"https://api.github.com/users/briancain","html_url":"https://github.com/briancain","followers_url":"https://api.github.com/users/briancain/followers","following_url":"https://api.github.com/users/briancain/following{/other_user}","gists_url":"https://api.github.com/users/briancain/gists{/gist_id}","starred_url":"https://api.github.com/users/briancain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/briancain/subscriptions","organizations_url":"https://api.github.com/users/briancain/orgs","repos_url":"https://api.github.com/users/briancain/repos","events_url":"https://api.github.com/users/briancain/events{/privacy}","received_events_url":"https://api.github.com/users/briancain/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"briancain","id":810277,"node_id":"MDQ6VXNlcjgxMDI3Nw==","avatar_url":"https://avatars.githubusercontent.com/u/810277?v=4","gravatar_id":"","url":"https://api.github.com/users/briancain","html_url":"https://github.com/briancain","followers_url":"https://api.github.com/users/briancain/followers","following_url":"https://api.github.com/users/briancain/following{/other_user}","gists_url":"https://api.github.com/users/briancain/gists{/gist_id}","starred_url":"https://api.github.com/users/briancain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/briancain/subscriptions","organizations_url":"https://api.github.com/users/briancain/orgs","repos_url":"https://api.github.com/users/briancain/repos","events_url":"https://api.github.com/users/briancain/events{/privacy}","received_events_url":"https://api.github.com/users/briancain/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":{"url":"https://api.github.com/repos/hashicorp/vagrant/milestones/40","html_url":"https://github.com/hashicorp/vagrant/milestone/40","labels_url":"https://api.github.com/repos/hashicorp/vagrant/milestones/40/labels","id":3822546,"node_id":"MDk6TWlsZXN0b25lMzgyMjU0Ng==","number":40,"title":"2.2.3","description":"","creator":{"login":"chrisroberts","id":266674,"node_id":"MDQ6VXNlcjI2NjY3NA==","avatar_url":"https://avatars.githubusercontent.com/u/266674?v=4","gravatar_id":"","url":"https://api.github.com/users/chrisroberts","html_url":"https://github.com/chrisroberts","followers_url":"https://api.github.com/users/chrisroberts/followers","following_url":"https://api.github.com/users/chrisroberts/following{/other_user}","gists_url":"https://api.github.com/users/chrisroberts/gists{/gist_id}","starred_url":"https://api.github.com/users/chrisroberts/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chrisroberts/subscriptions","organizations_url":"https://api.github.com/users/chrisroberts/orgs","repos_url":"https://api.github.com/users/chrisroberts/repos","events_url":"https://api.github.com/users/chrisroberts/events{/privacy}","received_events_url":"https://api.github.com/users/chrisroberts/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":34,"state":"closed","created_at":"2018-11-14T19:23:29Z","updated_at":"2019-01-10T17:37:46Z","due_on":null,"closed_at":"2019-01-10T17:37:46Z"},"comments":3,"created_at":"2018-11-21T02:43:38Z","updated_at":"2020-03-28T02:18:25Z","closed_at":"2018-12-03T23:57:55Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Summary\r\n\r\n`vagrant cloud publish` produces two different errors:\r\n\r\n* When the local box filename is missing, publish.rb reveals an internal nil error. The CLI usage description and validation code should perhaps be updated to require the provider filename.\r\n* Even when the provider filename is provided, the `--description` is ignored in the resulting Vagrant Cloud page.\r\n\r\n### Vagrant version\r\n\r\n```console\r\n$ vagrant -v\r\nVagrant 2.2.1\r\n```\r\n\r\n### Host operating system\r\n\r\nmacOS 10.14 Mojave\r\n\r\n### Guest operating system\r\n\r\nDebian stretch\r\n\r\n### bootstrap.sh\r\n\r\n```sh\r\n#!/bin/sh\r\nsudo apt-get update &&\r\n    sudo apt-get install -y clang &&\r\n    sudo apt-get autoclean -y &&\r\n    sudo apt-get clean -y &&\r\n    sudo rm -rf /var/lib/apt/lists/* \\\r\n        /var/cache/apt/pkgcache.bin \\\r\n        /var/cache/apt/srcpkgcache.bin\r\n```\r\n\r\n### Vagrantfile\r\n\r\n```ruby\r\nVagrant.configure(\"2\") do |config|\r\n    config.vm.box = \"mcandre/debian-i386\"\r\n    config.vm.box_version = \"0.0.1\"\r\n\r\n    # Prepare for vagrant package\r\n    config.ssh.insert_key = false\r\n    config.vm.synced_folder \".\", \"/vagrant\", type: \"rsync\", disabled: true\r\n\r\n    config.vm.provision \"shell\", path: \"bootstrap.sh\"\r\nend\r\n```\r\n\r\n### Debug output\r\n\r\nhttps://gist.github.com/mcandre/aeb581b5c2d1cd5c4bb6e5e84a27ae3d\r\n\r\n### Expected behavior\r\n\r\nEither `vagrant cloud publish`... succeeds, or presents a clear error message about what the user needs to fix in order to be able to publish the box.\r\n\r\n### Actual behavior\r\n\r\nA strange `no implicit conversion of nil into String` error is presented during a method internal to Vagrant's publish.rb code.\r\n\r\nAlso, the previous description posted on Vagrant Cloud is now gone!\r\n\r\n> There isn't a description.\r\n\r\nhttps://app.vagrantup.com/mcandre/boxes/vagrant-debian-cpp-i386\r\n\r\nEvidently `vagrant cloud publish` did not fail atomically :/\r\n\r\n### Steps to reproduce\r\n\r\n```console\r\n$ git clone https://github.com/mcandre/vagrant-debian-cpp.git\r\n$ git checkout rake\r\n$ cd i386\r\n$ vagrant up\r\n$ vagrant package --output vagrant-debian-cpp-i386.box --vagrantfile export.Vagrantfile\r\n$ vagrant cloud publish <your-namespace-here>/vagrant-debian-cpp-i386 --force --release --description \"a Vagrant box for building C/C++ binaries for GNU/Linux (Debian) x86\" --short-description \"Source: https://github.com/mcandre/vagrant-debian-cpp\" 0.0.1 virtualbox\r\n```\r\n\r\n# Partial mitigation\r\n\r\nI am working around this by mindfully supplying a provider box filename:\r\n\r\n```console\r\n$ vagrant cloud publish mcandre/vagrant-debian-cpp-i386 \\\r\n    --force \\\r\n    --release \\\r\n    --description \"a Vagrant box for building C/C++ binaries for GNU/Linux (Debian) x86\" \\\r\n    --short-description \"Source: https://github.com/mcandre/vagrant-debian-cpp\" \\\r\n    0.0.1 \\\r\n    virtualbox \\\r\n    vagrant-debian-cpp-i386.box\r\n```\r\n\r\nThis appears to resolve the nil string error in publish.rb, uploading the box contents to Vagrant Cloud. However, the full description configuration continues to be dropped on Vagrant Cloud, displaying:\r\n\r\n> There isn't a description.\r\n\r\nhttps://app.vagrantup.com/mcandre/boxes/vagrant-debian-cpp-i386\r\n\r\nAm I doing something wrong?","closed_by":{"login":"briancain","id":810277,"node_id":"MDQ6VXNlcjgxMDI3Nw==","avatar_url":"https://avatars.githubusercontent.com/u/810277?v=4","gravatar_id":"","url":"https://api.github.com/users/briancain","html_url":"https://github.com/briancain","followers_url":"https://api.github.com/users/briancain/followers","following_url":"https://api.github.com/users/briancain/following{/other_user}","gists_url":"https://api.github.com/users/briancain/gists{/gist_id}","starred_url":"https://api.github.com/users/briancain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/briancain/subscriptions","organizations_url":"https://api.github.com/users/briancain/orgs","repos_url":"https://api.github.com/users/briancain/repos","events_url":"https://api.github.com/users/briancain/events{/privacy}","received_events_url":"https://api.github.com/users/briancain/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/hashicorp/vagrant/issues/10432/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/hashicorp/vagrant/issues/10432/timeline","performed_via_github_app":null,"state_reason":"completed"}