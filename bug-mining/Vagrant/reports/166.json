{"url":"https://api.github.com/repos/hashicorp/vagrant/issues/10895","repository_url":"https://api.github.com/repos/hashicorp/vagrant","labels_url":"https://api.github.com/repos/hashicorp/vagrant/issues/10895/labels{/name}","comments_url":"https://api.github.com/repos/hashicorp/vagrant/issues/10895/comments","events_url":"https://api.github.com/repos/hashicorp/vagrant/issues/10895/events","html_url":"https://github.com/hashicorp/vagrant/issues/10895","id":452436206,"node_id":"MDU6SXNzdWU0NTI0MzYyMDY=","number":10895,"title":"rsync-auto listener doesn't ignore .vagrant folder","user":{"login":"markvr","id":1990337,"node_id":"MDQ6VXNlcjE5OTAzMzc=","avatar_url":"https://avatars.githubusercontent.com/u/1990337?v=4","gravatar_id":"","url":"https://api.github.com/users/markvr","html_url":"https://github.com/markvr","followers_url":"https://api.github.com/users/markvr/followers","following_url":"https://api.github.com/users/markvr/following{/other_user}","gists_url":"https://api.github.com/users/markvr/gists{/gist_id}","starred_url":"https://api.github.com/users/markvr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/markvr/subscriptions","organizations_url":"https://api.github.com/users/markvr/orgs","repos_url":"https://api.github.com/users/markvr/repos","events_url":"https://api.github.com/users/markvr/events{/privacy}","received_events_url":"https://api.github.com/users/markvr/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":25816,"node_id":"MDU6TGFiZWwyNTgxNg==","url":"https://api.github.com/repos/hashicorp/vagrant/labels/bug","name":"bug","color":"e11d21","default":true,"description":null},{"id":1017385901,"node_id":"MDU6TGFiZWwxMDE3Mzg1OTAx","url":"https://api.github.com/repos/hashicorp/vagrant/labels/rsync-auto","name":"rsync-auto","color":"40b9c9","default":false,"description":""}],"state":"closed","locked":true,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/hashicorp/vagrant/milestones/43","html_url":"https://github.com/hashicorp/vagrant/milestone/43","labels_url":"https://api.github.com/repos/hashicorp/vagrant/milestones/43/labels","id":4093855,"node_id":"MDk6TWlsZXN0b25lNDA5Mzg1NQ==","number":43,"title":"2.2.5","description":"","creator":{"login":"chrisroberts","id":266674,"node_id":"MDQ6VXNlcjI2NjY3NA==","avatar_url":"https://avatars.githubusercontent.com/u/266674?v=4","gravatar_id":"","url":"https://api.github.com/users/chrisroberts","html_url":"https://github.com/chrisroberts","followers_url":"https://api.github.com/users/chrisroberts/followers","following_url":"https://api.github.com/users/chrisroberts/following{/other_user}","gists_url":"https://api.github.com/users/chrisroberts/gists{/gist_id}","starred_url":"https://api.github.com/users/chrisroberts/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chrisroberts/subscriptions","organizations_url":"https://api.github.com/users/chrisroberts/orgs","repos_url":"https://api.github.com/users/chrisroberts/repos","events_url":"https://api.github.com/users/chrisroberts/events{/privacy}","received_events_url":"https://api.github.com/users/chrisroberts/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":31,"state":"closed","created_at":"2019-02-27T18:22:57Z","updated_at":"2019-12-01T10:29:03Z","due_on":null,"closed_at":"2019-07-10T21:53:34Z"},"comments":6,"created_at":"2019-06-05T10:51:39Z","updated_at":"2020-01-28T02:37:34Z","closed_at":"2019-06-17T15:20:44Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Vagrant version\r\nVagrant 2.2.4\r\n\r\n\r\n### Host operating system\r\nWindows 10\r\n\r\n### Guest operating system\r\nCentOS 7\r\n\r\n### Vagrantfile\r\n```ruby\r\nVagrant.configure(\"2\") do |config|\r\n  config.vm.box = \"centos/7\"\r\n   config.vm.synced_folder \".\", \"/vagrant\", type: \"rsync\"\r\nend\r\n```\r\n\r\n\r\n### Debug output\r\nhttps://gist.github.com/markvr/34b54e7e4c53951949eb5a7039a9c371\r\n\r\n### Expected behavior\r\nVagrant shouldn't attempt to sync the .vagrant folder, which contains a VHD which is constantly changing.\r\n\r\nAlthough `.vagrant` is automatically excluded from the rsync options, the \"listener\" still includes it, which means it is constantly attempting to sync the VHD file.\r\n\r\n```\r\n=> default: Watching: C:/temp/vagrant\r\n INFO rsync-auto: Listening to paths: [\"C:/temp/vagrant\"]\r\n INFO rsync-auto: Ignoring 0 paths:                                             <----- doesn't ignore .vagrant\r\n INFO rsync-auto: Listening via: Listen::Adapter::Windows\r\n INFO rsync-auto: File change callback called!\r\n INFO rsync-auto:   - Modified: [\"C:/temp/vagrant/.vagrant/machines/default/hyperv/Virtual Hard Disks/disk.vhd\"]\r\n INFO rsync-auto:   - Added: []\r\n INFO rsync-auto:   - Removed: []\r\n...\r\nDEBUG ssh: Exit status: 0\r\n INFO subprocess: Starting process: [\"C:\\\\programs\\\\Vagrant-2.2.4\\\\embedded\\\\usr\\\\bin/rsync.EXE\", \"--verbose\", \"--archive\", \"--delete\", \"-z\", \"--copy-links\", \"--chmod=ugo=rwX\", \"--no-perms\", \"--no-owner\", \"--no-group\", \"--rsync-path\", \"sudo rsync\", \"-e\", \"ssh -p 22 -o LogLevel=FATAL    -o IdentitiesOnly=yes -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -i 'C:/temp/vagrant/.vagrant/machines/default/hyperv/private_key'\", \"--exclude\", \".vagrant/\", \"/cygdrive/c/temp/vagrant/\", \"vagrant@172.17.121.82:/vagrant\"]\r\nDEBUG subprocess: Selecting on IO\r\n```\r\n\r\n### Actual behavior\r\n\r\nConstantly attempts to sync `.vagrant` folder.\r\n\r\nStandard output continuously outputs the line:\r\n```[/c/t/vagrant] ==> default: Rsyncing folder: /cygdrive/c/temp/vagrant/ => /vagrant\r\n==> default: Rsyncing folder: /cygdrive/c/temp/vagrant/ => /vagrant\r\n==> default: Rsyncing folder: /cygdrive/c/temp/vagrant/ => /vagrant\r\n==> default: Rsyncing folder: /cygdrive/c/temp/vagrant/ => /vagrant\r\n==> default: Rsyncing folder: /cygdrive/c/temp/vagrant/ => /vagrant\r\n...\r\netc\r\n```\r\n\r\n\r\n### Steps to reproduce\r\nUse Vagrant file above.\r\nRun: `vagrant rsync-auto --debug`\r\n\r\n### References\r\nNo.","closed_by":{"login":"briancain","id":810277,"node_id":"MDQ6VXNlcjgxMDI3Nw==","avatar_url":"https://avatars.githubusercontent.com/u/810277?v=4","gravatar_id":"","url":"https://api.github.com/users/briancain","html_url":"https://github.com/briancain","followers_url":"https://api.github.com/users/briancain/followers","following_url":"https://api.github.com/users/briancain/following{/other_user}","gists_url":"https://api.github.com/users/briancain/gists{/gist_id}","starred_url":"https://api.github.com/users/briancain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/briancain/subscriptions","organizations_url":"https://api.github.com/users/briancain/orgs","repos_url":"https://api.github.com/users/briancain/repos","events_url":"https://api.github.com/users/briancain/events{/privacy}","received_events_url":"https://api.github.com/users/briancain/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/hashicorp/vagrant/issues/10895/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/hashicorp/vagrant/issues/10895/timeline","performed_via_github_app":null,"state_reason":"completed"}