{"url":"https://api.github.com/repos/hashicorp/vagrant/issues/12180","repository_url":"https://api.github.com/repos/hashicorp/vagrant","labels_url":"https://api.github.com/repos/hashicorp/vagrant/issues/12180/labels{/name}","comments_url":"https://api.github.com/repos/hashicorp/vagrant/issues/12180/comments","events_url":"https://api.github.com/repos/hashicorp/vagrant/issues/12180/events","html_url":"https://github.com/hashicorp/vagrant/issues/12180","id":805633745,"node_id":"MDU6SXNzdWU4MDU2MzM3NDU=","number":12180,"title":"vagrant up with Hyper-V fails when box was packaged from a VM that has more resources than available on current Machine.","user":{"login":"yetisir","id":13750247,"node_id":"MDQ6VXNlcjEzNzUwMjQ3","avatar_url":"https://avatars.githubusercontent.com/u/13750247?v=4","gravatar_id":"","url":"https://api.github.com/users/yetisir","html_url":"https://github.com/yetisir","followers_url":"https://api.github.com/users/yetisir/followers","following_url":"https://api.github.com/users/yetisir/following{/other_user}","gists_url":"https://api.github.com/users/yetisir/gists{/gist_id}","starred_url":"https://api.github.com/users/yetisir/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yetisir/subscriptions","organizations_url":"https://api.github.com/users/yetisir/orgs","repos_url":"https://api.github.com/users/yetisir/repos","events_url":"https://api.github.com/users/yetisir/events{/privacy}","received_events_url":"https://api.github.com/users/yetisir/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":54082731,"node_id":"MDU6TGFiZWw1NDA4MjczMQ==","url":"https://api.github.com/repos/hashicorp/vagrant/labels/enhancement","name":"enhancement","color":"207de5","default":true,"description":null},{"id":54083999,"node_id":"MDU6TGFiZWw1NDA4Mzk5OQ==","url":"https://api.github.com/repos/hashicorp/vagrant/labels/thinking","name":"thinking","color":"c7def8","default":false,"description":null},{"id":140639873,"node_id":"MDU6TGFiZWwxNDA2Mzk4NzM=","url":"https://api.github.com/repos/hashicorp/vagrant/labels/provider/hyperv","name":"provider/hyperv","color":"bfe5bf","default":false,"description":null}],"state":"closed","locked":true,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2021-02-10T15:47:55Z","updated_at":"2025-06-21T02:24:00Z","closed_at":"2025-05-21T16:25:36Z","author_association":"NONE","type":null,"active_lock_reason":"resolved","sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"When I package a Hyper-V Box on a machine with lots of resources (e.g. 50GB memory, 20 CPUs), I am unable to launch the instance on another machine with fewer resources, even if local resources are specified in the vagrantfile.\r\n\r\nIt seems that Vagrant packages the Hyper-V *.vcmx file in the box and uses that to launch the VM instance on the new machine. Vagrant subsequently modifies the Hyper-V resources according to the vagrantfile. This works great on the original machine where it can get past step 1, but on the new machine with fewer resources it cant get past step 1 and fails to launch the VM. I think the appropriate way to handle this would be to edit the *.vcmx file with the resource constraints before launching it. \r\n\r\nWorkaround for now is to just build the box with those resource constraints in mind.\r\n\r\n### Vagrant version\r\n2.2.14\r\n\r\n### Host operating system\r\nWindows10 20H2\r\n\r\n### Guest operating system\r\nWindows10 20H2\r\n\r\n###Vagrantfile\r\n\r\nVagrant.configure(\"2\") do |config|\r\n  ...\r\n  config.vm.provider \"hyperv\" do |hyperv|\r\n    hyperv.memory = memory * 1024\r\n    hyperv.maxmemory = max_memory * 1024\r\n    hyperv.cpus = cpus\r\n  end\r\n\r\nend\r\n\r\n### Error\r\nINFO interface: error: An error occurred while executing a PowerShell script. This error\r\nis shown below. Please read the error message and see if this is\r\na configuration error with your system. If it is not, then please\r\nreport a bug.\r\n\r\nScript: import_vm.ps1\r\nError:\r\n\r\n[\r\n    \"Memory virtual quantity above maximum.\",\r\n    \"Cannot assign the specified number of processors for virtual machine \\u0027Development Environment Version 1.2.9\\u0027 is out of range. The range is 1 through 4. (Virtual machine ID 420E68AF-BEBC-4762-B68F-3B141F171582)\"\r\n]\r\n\r\n### Expected behavior\r\n\r\nVagrant up launches a virtual machine with the Hyper-V provider with the resources specified in the vagrantfile.\r\n\r\n### Actual behavior\r\n\r\nVagrant up fails with above error message\r\n\r\n### Steps to reproduce\r\n\r\n1. Package vagrant box from Hyper-V VM with 50GB RAM on system with 64GB RAM.\r\n2. Transfer box to machine with 32GB RAM and specify in vagrantfile 16GB RAM to be used.\r\n\r\n","closed_by":{"login":"chrisroberts","id":266674,"node_id":"MDQ6VXNlcjI2NjY3NA==","avatar_url":"https://avatars.githubusercontent.com/u/266674?v=4","gravatar_id":"","url":"https://api.github.com/users/chrisroberts","html_url":"https://github.com/chrisroberts","followers_url":"https://api.github.com/users/chrisroberts/followers","following_url":"https://api.github.com/users/chrisroberts/following{/other_user}","gists_url":"https://api.github.com/users/chrisroberts/gists{/gist_id}","starred_url":"https://api.github.com/users/chrisroberts/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chrisroberts/subscriptions","organizations_url":"https://api.github.com/users/chrisroberts/orgs","repos_url":"https://api.github.com/users/chrisroberts/repos","events_url":"https://api.github.com/users/chrisroberts/events{/privacy}","received_events_url":"https://api.github.com/users/chrisroberts/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/hashicorp/vagrant/issues/12180/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/hashicorp/vagrant/issues/12180/timeline","performed_via_github_app":null,"state_reason":"completed"}