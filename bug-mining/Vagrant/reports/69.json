{"url":"https://api.github.com/repos/hashicorp/vagrant/issues/6825","repository_url":"https://api.github.com/repos/hashicorp/vagrant","labels_url":"https://api.github.com/repos/hashicorp/vagrant/issues/6825/labels{/name}","comments_url":"https://api.github.com/repos/hashicorp/vagrant/issues/6825/comments","events_url":"https://api.github.com/repos/hashicorp/vagrant/issues/6825/events","html_url":"https://github.com/hashicorp/vagrant/issues/6825","id":125552767,"node_id":"MDU6SXNzdWUxMjU1NTI3Njc=","number":6825,"title":"box add [name] [path] does not recognise metadata.json file on Windows when [path] contains a space","user":{"login":"dpad","id":848449,"node_id":"MDQ6VXNlcjg0ODQ0OQ==","avatar_url":"https://avatars.githubusercontent.com/u/848449?v=4","gravatar_id":"","url":"https://api.github.com/users/dpad","html_url":"https://github.com/dpad","followers_url":"https://api.github.com/users/dpad/followers","following_url":"https://api.github.com/users/dpad/following{/other_user}","gists_url":"https://api.github.com/users/dpad/gists{/gist_id}","starred_url":"https://api.github.com/users/dpad/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dpad/subscriptions","organizations_url":"https://api.github.com/users/dpad/orgs","repos_url":"https://api.github.com/users/dpad/repos","events_url":"https://api.github.com/users/dpad/events{/privacy}","received_events_url":"https://api.github.com/users/dpad/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":25816,"node_id":"MDU6TGFiZWwyNTgxNg==","url":"https://api.github.com/repos/hashicorp/vagrant/labels/bug","name":"bug","color":"e11d21","default":true,"description":null},{"id":139179672,"node_id":"MDU6TGFiZWwxMzkxNzk2NzI=","url":"https://api.github.com/repos/hashicorp/vagrant/labels/core","name":"core","color":"eb6420","default":false,"description":null},{"id":218286867,"node_id":"MDU6TGFiZWwyMTgyODY4Njc=","url":"https://api.github.com/repos/hashicorp/vagrant/labels/host/windows","name":"host/windows","color":"d4c5f9","default":false,"description":null}],"state":"closed","locked":true,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/hashicorp/vagrant/milestones/21","html_url":"https://github.com/hashicorp/vagrant/milestone/21","labels_url":"https://api.github.com/repos/hashicorp/vagrant/milestones/21/labels","id":2040489,"node_id":"MDk6TWlsZXN0b25lMjA0MDQ4OQ==","number":21,"title":"2.0","description":"Issues related to 2.0 ","creator":{"login":"chrisroberts","id":266674,"node_id":"MDQ6VXNlcjI2NjY3NA==","avatar_url":"https://avatars.githubusercontent.com/u/266674?v=4","gravatar_id":"","url":"https://api.github.com/users/chrisroberts","html_url":"https://github.com/chrisroberts","followers_url":"https://api.github.com/users/chrisroberts/followers","following_url":"https://api.github.com/users/chrisroberts/following{/other_user}","gists_url":"https://api.github.com/users/chrisroberts/gists{/gist_id}","starred_url":"https://api.github.com/users/chrisroberts/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chrisroberts/subscriptions","organizations_url":"https://api.github.com/users/chrisroberts/orgs","repos_url":"https://api.github.com/users/chrisroberts/repos","events_url":"https://api.github.com/users/chrisroberts/events{/privacy}","received_events_url":"https://api.github.com/users/chrisroberts/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":124,"state":"closed","created_at":"2016-09-30T16:45:35Z","updated_at":"2017-09-11T22:06:07Z","due_on":null,"closed_at":"2017-09-11T22:06:07Z"},"comments":4,"created_at":"2016-01-08T06:40:25Z","updated_at":"2020-04-02T02:07:46Z","closed_at":"2017-04-20T23:10:01Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"This is happening on 1.8.1, Windows. Related to https://github.com/mitchellh/vagrant/issues/3201\n\nI have two folders, \"C:/boxes\" and \"C:/box es\", each containing an identical \"metadata.json\" file, describing the versions of a base box. In Windows, on the command line, running the following commands results in only the path without a space working: \n\n```\nC:\\>vagrant box add test \"C:\\boxes\\metadata.json\"\n==> box: Loading metadata for box 'C:\\boxes\\metadata.json'\n    box: URL: file://C:/boxes/metadata.json\nThe box you're adding has a name different from the name you\nrequested. [this is fine, it means it has read the json file correctly]\n```\n\n```\nC:\\>vagrant box add test \"C:\\box es\\metadata.json\"\n==> box: Box file was not detected as metadata. Adding it directly...\n==> box: Adding box 'test' (v0) for provider:\n    box: Unpacking necessary files from: file://C:/box%20es/metadata.json\n    box: Progress: 100% (Rate: 254/s, Estimated time remaining: 0:00:01)\nThe box failed to unpackage properly. Please verify that the box\nfile you're trying to add is not corrupted and try again. The\noutput from attempting to unpackage (if any):\n\nbsdtar.EXE: Error opening archive: Unrecognized archive format\n```\n\nThis is obviously some issue to do with the escaping of spaces into %20s, which is required for URI handling, but then there appears to be some issue in doing a File.open() on those URIs with escaped spaces. I'd be willing to guess the problem happens in https://github.com/mitchellh/vagrant/blob/master/lib/vagrant/action/builtin/box_add.rb .\n\nThere doesn't appear to be any other way of escaping the space from the command line (like adding the %20, or %%20, or ^%20, or whatever other methods of escaping) since these all get further escaped for the URI.\n","closed_by":{"login":"chrisroberts","id":266674,"node_id":"MDQ6VXNlcjI2NjY3NA==","avatar_url":"https://avatars.githubusercontent.com/u/266674?v=4","gravatar_id":"","url":"https://api.github.com/users/chrisroberts","html_url":"https://github.com/chrisroberts","followers_url":"https://api.github.com/users/chrisroberts/followers","following_url":"https://api.github.com/users/chrisroberts/following{/other_user}","gists_url":"https://api.github.com/users/chrisroberts/gists{/gist_id}","starred_url":"https://api.github.com/users/chrisroberts/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chrisroberts/subscriptions","organizations_url":"https://api.github.com/users/chrisroberts/orgs","repos_url":"https://api.github.com/users/chrisroberts/repos","events_url":"https://api.github.com/users/chrisroberts/events{/privacy}","received_events_url":"https://api.github.com/users/chrisroberts/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/hashicorp/vagrant/issues/6825/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/hashicorp/vagrant/issues/6825/timeline","performed_via_github_app":null,"state_reason":"completed"}