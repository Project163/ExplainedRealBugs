{"url":"https://api.github.com/repos/hashicorp/vagrant/issues/13371","repository_url":"https://api.github.com/repos/hashicorp/vagrant","labels_url":"https://api.github.com/repos/hashicorp/vagrant/issues/13371/labels{/name}","comments_url":"https://api.github.com/repos/hashicorp/vagrant/issues/13371/comments","events_url":"https://api.github.com/repos/hashicorp/vagrant/issues/13371/events","html_url":"https://github.com/hashicorp/vagrant/issues/13371","id":2208538468,"node_id":"I_kwDOAAdaUM6Do59k","number":13371,"title":"Docker Provider driver.rb fails with `block in network_defined?': undefined method `size' for nil:NilClass (NoMethodError) ","user":{"login":"tomjn","id":58855,"node_id":"MDQ6VXNlcjU4ODU1","avatar_url":"https://avatars.githubusercontent.com/u/58855?v=4","gravatar_id":"","url":"https://api.github.com/users/tomjn","html_url":"https://github.com/tomjn","followers_url":"https://api.github.com/users/tomjn/followers","following_url":"https://api.github.com/users/tomjn/following{/other_user}","gists_url":"https://api.github.com/users/tomjn/gists{/gist_id}","starred_url":"https://api.github.com/users/tomjn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tomjn/subscriptions","organizations_url":"https://api.github.com/users/tomjn/orgs","repos_url":"https://api.github.com/users/tomjn/repos","events_url":"https://api.github.com/users/tomjn/events{/privacy}","received_events_url":"https://api.github.com/users/tomjn/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":4812910683,"node_id":"LA_kwDOAAdaUM8AAAABHt8wWw","url":"https://api.github.com/repos/hashicorp/vagrant/labels/waiting-intake","name":"waiting-intake","color":"d4c5f9","default":false,"description":""}],"state":"closed","locked":true,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2024-03-26T15:12:35Z","updated_at":"2024-08-10T02:13:54Z","closed_at":"2024-07-10T23:42:13Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":"resolved","sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"<!--\r\nPlease note that the Vagrant issue tracker is reserved for bug reports. For general usage questions, please use\r\nHashiCorp Discuss, https://discuss.hashicorp.com/c/vagrant/.\r\n\r\nWhen you submit a bug report, please provide the minimal configuration and required information necessary to reliably reproduce the issue. It\r\nshould include a basic Vagrantfile.\r\n\r\nThank you!\r\n-->\r\n\r\nWhen provisioning VVV using Docker as a provider it fails nearly immediately with the following error:\r\n\r\n```\r\n/opt/vagrant/embedded/gems/gems/vagrant-2.4.1/plugins/providers/docker/driver.rb:352:in `block in network_defined?': undefined method `size' for nil:NilClass (NoMethodError)\r\n\r\n          if (config.size > 0 &&\r\n                    ^^^^^\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/plugins/providers/docker/driver.rb:350:in `each'\r\n```\r\n\r\n### Debug output\r\n\r\nhttps://gist.github.com/tomjn/92ed3f0dcbfb47c6c2bd6d24af2b6620\r\n\r\n<details>\r\n<summary>CLI output and command:</summary>\r\n\r\n```\r\n❯ vagrant up --provision --provider=\"docker\"\r\n__ __ __ __\r\n\\ V\\ V\\ V / v3.13 Ruby:3.1.4, Path:\"/Users/tomjn/vvv-local\"\r\n \\_/\\_/\\_/  git::develop(c4250187)\r\n\r\nPlatform: darwin shell:/bin/zsh shared_db_folder_disabled\r\nVagrant: v2.4.1, parallels: v19.3.0\r\n\r\nDocs:       https://varyingvagrantvagrants.org/\r\nContribute: https://github.com/varying-vagrant-vagrants/vvv\r\nDashboard:  http://vvv.test\r\n\r\nBringing machine 'default' up with 'docker' provider...\r\n==> default: Creating and configuring docker networks...\r\n/opt/vagrant/embedded/gems/gems/vagrant-2.4.1/plugins/providers/docker/driver.rb:352:in `block in network_defined?': undefined method `size' for nil:NilClass (NoMethodError)\r\n\r\n          if (config.size > 0 &&\r\n                    ^^^^^\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/plugins/providers/docker/driver.rb:350:in `each'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/plugins/providers/docker/driver.rb:350:in `network_defined?'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/plugins/providers/docker/action/prepare_networks.rb:140:in `process_private_network'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/plugins/providers/docker/action/prepare_networks.rb:343:in `block (3 levels) in call'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/plugins/providers/docker/action/prepare_networks.rb:333:in `each'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/plugins/providers/docker/action/prepare_networks.rb:333:in `each_with_index'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/plugins/providers/docker/action/prepare_networks.rb:333:in `block (2 levels) in call'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/lib/vagrant/environment.rb:649:in `lock'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/plugins/providers/docker/action/prepare_networks.rb:331:in `block in call'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/plugins/providers/docker/action/prepare_networks.rb:330:in `synchronize'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/plugins/providers/docker/action/prepare_networks.rb:330:in `call'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/lib/vagrant/action/warden.rb:38:in `call'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/plugins/providers/docker/action/prepare_nfs_settings.rb:18:in `call'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/lib/vagrant/action/warden.rb:38:in `call'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/lib/vagrant/action/builtin/synced_folders.rb:90:in `call'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/lib/vagrant/action/warden.rb:38:in `call'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/lib/vagrant/action/builtin/delayed.rb:22:in `call'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/lib/vagrant/action/warden.rb:38:in `call'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/lib/vagrant/action/builtin/synced_folder_cleanup.rb:31:in `call'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/lib/vagrant/action/warden.rb:38:in `call'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/plugins/synced_folders/nfs/action_cleanup.rb:28:in `call'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/lib/vagrant/action/warden.rb:38:in `call'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/plugins/providers/docker/action/prepare_nfs_valid_ids.rb:17:in `call'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/lib/vagrant/action/warden.rb:38:in `call'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/plugins/providers/docker/action/host_machine_sync_folders.rb:26:in `call'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/lib/vagrant/action/warden.rb:38:in `call'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/plugins/providers/docker/action/host_machine_build_dir.rb:22:in `call'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/lib/vagrant/action/warden.rb:38:in `call'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/lib/vagrant/action/warden.rb:117:in `block in finalize_action'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/lib/vagrant/action/warden.rb:38:in `call'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/plugins/providers/docker/action/init_state.rb:18:in `call'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/lib/vagrant/action/warden.rb:38:in `call'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/lib/vagrant/action/warden.rb:117:in `block in finalize_action'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/lib/vagrant/action/warden.rb:38:in `call'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/lib/vagrant/action/builder.rb:183:in `call'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/lib/vagrant/action/runner.rb:104:in `block in run'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/lib/vagrant/util/busy.rb:22:in `busy'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/lib/vagrant/action/runner.rb:104:in `run'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/lib/vagrant/action/builtin/call.rb:56:in `call'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/lib/vagrant/action/warden.rb:38:in `call'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/lib/vagrant/action/warden.rb:117:in `block in finalize_action'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/lib/vagrant/action/warden.rb:38:in `call'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/lib/vagrant/action/builtin/provision.rb:83:in `call'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/lib/vagrant/action/warden.rb:38:in `call'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/lib/vagrant/action/warden.rb:117:in `block in finalize_action'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/lib/vagrant/action/warden.rb:38:in `call'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/lib/vagrant/action/builder.rb:183:in `call'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/lib/vagrant/action/runner.rb:104:in `block in run'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/lib/vagrant/util/busy.rb:22:in `busy'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/lib/vagrant/action/runner.rb:104:in `run'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/lib/vagrant/action/builtin/call.rb:56:in `call'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/lib/vagrant/action/warden.rb:38:in `call'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/lib/vagrant/action/warden.rb:117:in `block in finalize_action'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/lib/vagrant/action/warden.rb:38:in `call'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/lib/vagrant/action/builder.rb:183:in `call'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/lib/vagrant/action/runner.rb:104:in `block in run'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/lib/vagrant/util/busy.rb:22:in `busy'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/lib/vagrant/action/runner.rb:104:in `run'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/lib/vagrant/action/builtin/call.rb:56:in `call'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/lib/vagrant/action/warden.rb:38:in `call'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/lib/vagrant/action/warden.rb:117:in `block in finalize_action'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/lib/vagrant/action/warden.rb:38:in `call'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/plugins/providers/docker/action/destroy_build_image.rb:46:in `call'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/lib/vagrant/action/warden.rb:38:in `call'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/lib/vagrant/action/builtin/handle_box.rb:28:in `call'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/lib/vagrant/action/warden.rb:38:in `call'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/lib/vagrant/action/warden.rb:117:in `block in finalize_action'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/lib/vagrant/action/warden.rb:38:in `call'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/lib/vagrant/action/builder.rb:183:in `call'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/lib/vagrant/action/runner.rb:104:in `block in run'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/lib/vagrant/util/busy.rb:22:in `busy'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/lib/vagrant/action/runner.rb:104:in `run'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/lib/vagrant/action/builtin/call.rb:56:in `call'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/lib/vagrant/action/warden.rb:38:in `call'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/plugins/providers/docker/action/host_machine.rb:21:in `call'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/lib/vagrant/action/warden.rb:38:in `call'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/lib/vagrant/action/builtin/config_validate.rb:28:in `call'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/lib/vagrant/action/warden.rb:38:in `call'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/lib/vagrant/action/warden.rb:117:in `block in finalize_action'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/lib/vagrant/action/warden.rb:38:in `call'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/lib/vagrant/action/builtin/handle_box.rb:28:in `call'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/lib/vagrant/action/warden.rb:38:in `call'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/lib/vagrant/action/warden.rb:117:in `block in finalize_action'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/lib/vagrant/action/warden.rb:38:in `call'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/lib/vagrant/action/builder.rb:183:in `call'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/lib/vagrant/action/runner.rb:104:in `block in run'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/lib/vagrant/util/busy.rb:22:in `busy'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/lib/vagrant/action/runner.rb:104:in `run'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/lib/vagrant/action/builtin/call.rb:56:in `call'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/lib/vagrant/action/warden.rb:38:in `call'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/lib/vagrant/action/builtin/delayed.rb:22:in `call'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/lib/vagrant/action/warden.rb:38:in `call'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/lib/vagrant/action/builder.rb:183:in `call'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/lib/vagrant/action/runner.rb:104:in `block in run'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/lib/vagrant/util/busy.rb:22:in `busy'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/lib/vagrant/action/runner.rb:104:in `run'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/lib/vagrant/machine.rb:247:in `action_raw'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/lib/vagrant/machine.rb:216:in `block in action'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/lib/vagrant/environment.rb:649:in `lock'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/lib/vagrant/machine.rb:202:in `call'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/lib/vagrant/machine.rb:202:in `action'\r\n\tfrom /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/lib/vagrant/batch_action.rb:89:in `block (2 levels) in run'\r\n```\r\n</details>\r\n\r\n### Expected behavior\r\n\r\nI expected a container and provisioners to run\r\n\r\n### Actual behavior\r\n\r\nA fatal error in the ruby vagrant plugin before the machine could be setup, and no new containers in Docker\r\n\r\n### Reproduction information \r\n\r\n#### Vagrant version\r\n\r\n```sh\r\n❯ vagrant -v\r\nVagrant 2.4.1\r\n```\r\n\r\n#### Host operating system\r\n\r\nMacOS 14.1.1 Arm64\r\n\r\n#### Guest operating system\r\n\r\nUbuntu 20 Arm64\r\n\r\n#### Steps to reproduce\r\n\r\n1. `vagrant up --provision --provider=\"docker\"\r\n\r\n#### Vagrantfile\r\n\r\n<details>\r\n\r\n```ruby\r\n# frozen_string_literal: true\r\n\r\n# -*- mode: ruby -*-\r\n# vi: set ft=ruby ts=2 sw=2 et:\r\n\r\nVAGRANTFILE_API_VERSION = \"2\"\r\n\r\nVagrant.require_version '>= 2.2.4'\r\nrequire 'yaml'\r\nrequire 'fileutils'\r\nrequire 'pathname'\r\nrequire 'socket'\r\n\r\ndef sudo_warnings\r\n  red = \"\\033[38;5;9m\" # 124m\"\r\n  creset = \"\\033[0m\"\r\n  puts \"#{red}┌-──────────────────────────────────────────────────────────────────────────────┐#{creset}\"\r\n  puts \"#{red}│                                                                               │#{creset}\"\r\n  puts \"#{red}│  ⚠ DANGER DO NOT USE SUDO ⚠                                                   │#{creset}\"\r\n  puts \"#{red}│                                                                               │#{creset}\"\r\n  puts \"#{red}│ ! ▄▀▀▀▄▄▄▄▄▄▄▀▀▀▄ !  You should never use sudo or root with vagrant.          │#{creset}\"\r\n  puts \"#{red}│  !█▒▒░░░░░░░░░▒▒█    It causes lots of problems :(                            │#{creset}\"\r\n  puts \"#{red}│    █░░█░▄▄░░█░░█ !                                                            │#{creset}\"\r\n  puts \"#{red}│     █░░█░░█░▄▄█    ! We're really sorry but you may need to do painful        │#{creset}\"\r\n  puts \"#{red}│  !  ▀▄░█░░██░░█      cleanup commands to fix this.                            │#{creset}\"\r\n  puts \"#{red}│                                                                               │#{creset}\"\r\n  puts \"#{red}│  If vagrant does not work for you without sudo, open a GitHub issue instead   │#{creset}\"\r\n  puts \"#{red}│  In the future, this warning will halt provisioning to prevent new users      │#{creset}\"\r\n  puts \"#{red}│  making this mistake.                                                         │#{creset}\"\r\n  puts \"#{red}│                                                                               │#{creset}\"\r\n  puts \"#{red}│  ⚠ DANGER SUDO DETECTED!                                                      │#{creset}\"\r\n  puts \"#{red}│                                                                               │#{creset}\"\r\n  puts \"#{red}│  In the future the VVV team will be making it harder to use VVV with sudo.    │#{creset}\"\r\n  puts \"#{red}│  We will require a config option so that users can do data recovery, and      │#{creset}\"\r\n  puts \"#{red}│  disable sites and the dashboard.                                             │#{creset}\"\r\n  puts \"#{red}│                                                                               │#{creset}\"\r\n  puts \"#{red}│  DO NOT USE SUDO, use ctrl+c/cmd+c and cancel this command ASAP!!!            │#{creset}\"\r\n  puts \"#{red}│                                                                               │#{creset}\"\r\n  puts \"#{red}└───────────────────────────────────────────────────────────────────────────────┘#{creset}\"\r\n  # exit\r\nend\r\n\r\nvagrant_dir = __dir__\r\nshow_logo = false\r\nbranch_c = \"\\033[38;5;6m\" # 111m\"\r\nred = \"\\033[38;5;9m\" # 124m\"\r\ngreen = \"\\033[1;38;5;2m\" # 22m\"\r\nblue = \"\\033[38;5;4m\" # 33m\"\r\npurple = \"\\033[38;5;5m\" # 129m\"\r\ndocs = \"\\033[0m\"\r\nyellow = \"\\033[38;5;3m\" # 136m\"\r\nyellow_underlined = \"\\033[4;38;5;3m\" # 136m\"\r\nurl = yellow_underlined\r\ncreset = \"\\033[0m\"\r\n\r\nversion = '?'\r\nFile.open(\"#{vagrant_dir}/version\", 'r') do |f|\r\n  version = f.read\r\n  version = version.gsub(\"\\n\", '')\r\nend\r\n\r\nunless Vagrant::Util::Platform.windows?\r\n  if Process.uid == 0\r\n    sudo_warnings\r\n  end\r\nend\r\n\r\nunless Vagrant::Util::Platform.windows?\r\n  if Process.uid == 0\r\n    puts \" \"\r\n    puts \"#{red} ⚠ DANGER VAGRANT IS RUNNING AS ROOT/SUDO, DO NOT USE SUDO ⚠#{creset}\"\r\n    puts \" \"\r\n  end\r\nend\r\n\r\n# whitelist when we show the logo, else it'll show on global Vagrant commands\r\nshow_logo = true if %w[up resume status provision reload].include? ARGV[0]\r\nshow_logo = false if ENV['VVV_SKIP_LOGO']\r\n\r\n# Show the initial splash screen\r\nif show_logo\r\n  git_or_zip = 'zip-no-vcs'\r\n  branch = ''\r\n  commit = ''\r\n  if File.directory?(\"#{vagrant_dir}/.git\")\r\n    git_or_zip = 'git::'\r\n    branch = `git --git-dir=\"#{vagrant_dir}/.git\" --work-tree=\"#{vagrant_dir}\" rev-parse --abbrev-ref HEAD`\r\n    branch = branch.chomp(\"\\n\"); # remove trailing newline so it doesn't break the ascii art\r\n    commit = `git --git-dir=\"#{vagrant_dir}/.git\" --work-tree=\"#{vagrant_dir}\" rev-parse --short HEAD`\r\n    commit = '(' + commit.chomp(\"\\n\") + ')'; # remove trailing newline so it doesn't break the ascii art\r\n  end\r\n\r\n  splashfirst = <<~HEREDOC\r\n    \\033[1;38;5;196m#{red}__ #{green}__ #{blue}__ __\r\n    #{red}\\\\ V#{green}\\\\ V#{blue}\\\\ V / #{purple}v#{version} #{purple}Ruby:#{RUBY_VERSION}, Path:\"#{vagrant_dir}\"\r\n    #{red} \\\\_/#{green}\\\\_/#{blue}\\\\_/  #{creset}#{branch_c}#{git_or_zip}#{branch}#{commit}#{creset}\r\n\r\n  HEREDOC\r\n  puts splashfirst\r\nend\r\n\r\n# Load the config file before the second section of the splash screen\r\n\r\n# Perform file migrations from older versions\r\nvvv_config_file = File.join(vagrant_dir, 'config/config.yml')\r\nunless File.file?(vvv_config_file)\r\n  old_vvv_config = File.join(vagrant_dir, 'vvv-custom.yml')\r\n  if File.file?(old_vvv_config)\r\n    puts \"#{yellow}Migrating #{red}vvv-custom.yml#{yellow} to #{green}config/config.yml#{yellow}\\nIMPORTANT NOTE: Make all modifications to #{green}config/config.yml#{yellow}.#{creset}\\n\\n\"\r\n    FileUtils.mv(old_vvv_config, vvv_config_file)\r\n  else\r\n    puts \"#{yellow}Copying #{red}config/default-config.yml#{yellow} to #{green}config/config.yml#{yellow}\\nIMPORTANT NOTE: Make all modifications to #{green}config/config.yml#{yellow} in future so that they are not lost when VVV updates.#{creset}\\n\\n\"\r\n    FileUtils.cp(File.join(vagrant_dir, 'config/default-config.yml'), vvv_config_file)\r\n  end\r\nend\r\n\r\nold_db_backup_dir = File.join(vagrant_dir, 'database/backups/')\r\nnew_db_backup_dir = File.join(vagrant_dir, 'database/sql/backups/')\r\nif (File.directory?(old_db_backup_dir) == true) && (File.directory?(new_db_backup_dir) == false)\r\n  puts 'Moving db backup directory into database/sql/backups'\r\n  FileUtils.mv(old_db_backup_dir, new_db_backup_dir)\r\nend\r\n\r\nbegin\r\n  vvv_config = YAML.load_file(vvv_config_file)\r\n  unless vvv_config['sites'].is_a? Hash\r\n    vvv_config['sites'] = {}\r\n\r\n    puts \"#{red}config/config.yml is missing a sites section.#{creset}\\n\\n\"\r\n  end\r\nrescue StandardError => e\r\n  puts \"#{red}config/config.yml isn't a valid YAML file.#{creset}\\n\\n\"\r\n  puts \"#{red}VVV cannot be executed!#{creset}\\n\\n\"\r\n\r\n  warn e.message\r\n  exit\r\nend\r\n\r\nvvv_config['hosts'] = [] unless vvv_config['hosts'].is_a? Hash\r\n\r\nvvv_config['hosts'] += ['vvv.test']\r\n\r\nvvv_config['sites'].each do |site, args|\r\n  if args.is_a? String\r\n    repo = args\r\n    args = {}\r\n    args['repo'] = repo\r\n  end\r\n\r\n  args = {} unless args.is_a? Hash\r\n\r\n  defaults = {}\r\n  defaults['repo'] = false\r\n  defaults['vm_dir'] = \"/srv/www/#{site}\"\r\n  defaults['local_dir'] = File.join(vagrant_dir, 'www', site)\r\n  defaults['branch'] = 'master'\r\n  defaults['skip_provisioning'] = false\r\n  defaults['allow_customfile'] = false\r\n  defaults['nginx_upstream'] = 'php'\r\n  defaults['hosts'] = []\r\n\r\n  vvv_config['sites'][site] = defaults.merge(args)\r\n\r\n  unless vvv_config['sites'][site]['skip_provisioning']\r\n    site_host_paths = Dir.glob(Array.new(4) { |i| vvv_config['sites'][site]['local_dir'] + '/*' * (i + 1) + '/vvv-hosts' })\r\n    vvv_config['sites'][site]['hosts'] += site_host_paths.map do |path|\r\n      lines = File.readlines(path).map(&:chomp)\r\n      lines.grep(/\\A[^#]/)\r\n    end.flatten\r\n    if vvv_config['sites'][site]['hosts'].is_a? Array\r\n      vvv_config['hosts'] += vvv_config['sites'][site]['hosts']\r\n    else\r\n      vvv_config['hosts'] += [\"#{site}.test\"]\r\n    end\r\n  end\r\n  vvv_config['sites'][site].delete('hosts')\r\nend\r\n\r\nif vvv_config['extension-sources'].is_a? Hash\r\n  vvv_config['extension-sources'].each do |name, args|\r\n    next unless args.is_a? String\r\n\r\n    repo = args\r\n    args = {}\r\n    args['repo'] = repo\r\n    args['branch'] = 'master'\r\n\r\n    vvv_config['extension-sources'][name] = args\r\n  end\r\nelse\r\n  vvv_config['extension-sources'] = {}\r\nend\r\n\r\nvvv_config['dashboard'] = {} unless vvv_config['dashboard']\r\ndashboard_defaults = {}\r\ndashboard_defaults['repo'] = 'https://github.com/Varying-Vagrant-Vagrants/dashboard.git'\r\ndashboard_defaults['branch'] = 'master'\r\nvvv_config['dashboard'] = dashboard_defaults.merge(vvv_config['dashboard'])\r\n\r\nunless vvv_config['extension-sources'].key?('core')\r\n  vvv_config['extension-sources']['core'] = {}\r\n  vvv_config['extension-sources']['core']['repo'] = 'https://github.com/Varying-Vagrant-Vagrants/vvv-utilities.git'\r\n  vvv_config['extension-sources']['core']['branch'] = 'master'\r\nend\r\n\r\nvvv_config['utilities'] = {} unless vvv_config['utilities'].is_a? Hash\r\nvvv_config['utility-sources'] = {} unless vvv_config['utility-sources'].is_a? Hash\r\nvvv_config['extension-sources'] = {} unless vvv_config['extension-sources'].is_a? Hash\r\nvvv_config['extensions'] = {} unless vvv_config['extensions'].is_a? Hash\r\n\r\nvvv_config['vm_config'] = {} unless vvv_config['vm_config'].is_a? Hash\r\n\r\nvvv_config['general'] = {} unless vvv_config['general'].is_a? Hash\r\n\r\ndefaults = {}\r\ndefaults['memory'] = 2048\r\ndefaults['cores'] = 1\r\ndefaults['provider'] = 'virtualbox'\r\n\r\n# if Arm default to docker\r\nif Etc.uname[:version].include? 'ARM64'\r\n  defaults['provider'] = 'docker'\r\nend\r\n\r\n# This should rarely be overridden, so it's not included in the config/default-config.yml file.\r\ndefaults['private_network_ip'] = '192.168.56.4'\r\n\r\nvvv_config['vm_config'] = defaults.merge(vvv_config['vm_config'])\r\nvvv_config['hosts'] = vvv_config['hosts'].uniq\r\n\r\nvvv_config['vagrant-plugins'] = {} unless vvv_config['vagrant-plugins']\r\n\r\n# Early mapping of the hosts to be added.\r\nvvv_config['utilities'].each do |name, extensions|\r\n  extensions = {} unless extensions.is_a? Array\r\n  extensions.each do |extension|\r\n    if extension == 'tideways'\r\n      vvv_config['hosts'] += ['tideways.vvv.test']\r\n      vvv_config['hosts'] += ['xhgui.vvv.test']\r\n    end\r\n  end\r\nend\r\nvvv_config['extensions'].each do |name, extensions|\r\n  extensions = {} unless extensions.is_a? Array\r\n  extensions.each do |extension|\r\n    if extension == 'tideways'\r\n      vvv_config['hosts'] += ['tideways.vvv.test']\r\n      vvv_config['hosts'] += ['xhgui.vvv.test']\r\n    end\r\n  end\r\nend\r\n\r\n# Create a global variable to use in functions and classes\r\n$vvv_config = vvv_config\r\n\r\n# Show the second splash screen section\r\n\r\nif show_logo\r\n  platform = [ Vagrant::Util::Platform.platform]\r\n  if Vagrant::Util::Platform.windows?\r\n    platform << 'windows '\r\n    platform << 'wsl ' if Vagrant::Util::Platform.wsl?\r\n    platform << 'msys ' if Vagrant::Util::Platform.msys?\r\n    platform << 'cygwin ' if Vagrant::Util::Platform.cygwin?\r\n    if Vagrant::Util::Platform.windows_hyperv_enabled?\r\n      platform << 'HyperV-Enabled '\r\n    end\r\n    platform << 'HyperV-Admin ' if Vagrant::Util::Platform.windows_hyperv_admin?\r\n    if Vagrant::Util::Platform.windows_admin?\r\n      platform << 'HasWinAdminPriv '\r\n    else\r\n      platform << 'missingWinAdminPriv ' unless Vagrant::Util::Platform.windows_admin?\r\n    end\r\n  else\r\n    platform << 'shell:' + ENV['SHELL'] if ENV['SHELL']\r\n    platform << 'systemd ' if Vagrant::Util::Platform.systemd?\r\n  end\r\n\r\n  platform << 'vagrant-hostmanager' if Vagrant.has_plugin?('vagrant-hostmanager')\r\n  platform << 'vagrant-hostsupdater' if Vagrant.has_plugin?('vagrant-hostsupdater')\r\n  platform << 'vagrant-goodhosts' if Vagrant.has_plugin?('vagrant-goodhosts')\r\n  platform << 'vagrant-vbguest' if Vagrant.has_plugin?('vagrant-vbguest')\r\n  platform << 'vagrant-disksize' if Vagrant.has_plugin?('vagrant-disksize')\r\n\r\n  platform << 'CaseSensitiveFS' if Vagrant::Util::Platform.fs_case_sensitive?\r\n  unless Vagrant::Util::Platform.terminal_supports_colors?\r\n    platform << 'monochrome-terminal'\r\n  end\r\n\r\n  if defined? vvv_config['vm_config']['wordcamp_contributor_day_box']\r\n    if vvv_config['vm_config']['wordcamp_contributor_day_box'] == true\r\n      platform << 'contributor_day_box'\r\n    end\r\n  end\r\n\r\n  if defined? vvv_config['vm_config']['box']\r\n    unless vvv_config['vm_config']['box'].nil?\r\n      puts \"Custom Box: Box overridden via config/config.yml , this won't take effect until a destroy + reprovision happens\"\r\n      platform << 'box_override:' + vvv_config['vm_config']['box']\r\n    end\r\n  end\r\n\r\n  if defined? vvv_config['general']['db_share_type']\r\n    if vvv_config['general']['db_share_type'] != true\r\n      platform << 'shared_db_folder_disabled'\r\n    else\r\n      platform << 'shared_db_folder_enabled'\r\n    end\r\n  else\r\n    platform << 'shared_db_folder_default'\r\n  end\r\n\r\n  provider_version = '??'\r\n\r\n  provider_meta = nil\r\n\r\n  case vvv_config['vm_config']['provider']\r\n  when 'virtualbox'\r\n    provider_meta = VagrantPlugins::ProviderVirtualBox::Driver::Meta.new()\r\n    provider_version = provider_meta.version\r\n  when 'parallels'\r\n    provider_version = '?'\r\n    if defined? VagrantPlugins::Parallels\r\n      provider_meta = VagrantPlugins::Parallels::Driver::Meta.new()\r\n      provider_version = provider_meta.version\r\n    end\r\n  when 'vmware'\r\n    provider_version = '??'\r\n  when 'hyperv'\r\n    provider_version = 'n/a'\r\n  when 'docker'\r\n    provider_version = VagrantPlugins::DockerProvider::Driver.new.execute(\"docker\", \"-v\").gsub(\"Docker version \", \"\")\r\n  else\r\n    provider_version = '??'\r\n  end\r\n\r\n  splashsecond = <<~HEREDOC\r\n    #{yellow}Platform: #{yellow}#{platform.join(' ')}\r\n    #{green}Vagrant: #{green}v#{Vagrant::VERSION}, #{blue}#{vvv_config['vm_config']['provider']}: #{blue}v#{provider_version}\r\n\r\n    #{docs}Docs:       #{url}https://varyingvagrantvagrants.org/\r\n    #{docs}Contribute: #{url}https://github.com/varying-vagrant-vagrants/vvv\r\n    #{docs}Dashboard:  #{url}http://vvv.test#{creset}\r\n\r\n  HEREDOC\r\n  puts splashsecond\r\nend\r\n\r\nif defined? vvv_config['vm_config']['provider']\r\n  # Override or set the vagrant provider.\r\n  ENV['VAGRANT_DEFAULT_PROVIDER'] = vvv_config['vm_config']['provider']\r\nend\r\n\r\nENV['LC_ALL'] = 'en_US.UTF-8'\r\n\r\nVagrant.configure(VAGRANTFILE_API_VERSION) do |config|\r\n  # VirtualBox\r\n  config.vm.provider :virtualbox do |v|\r\n    unless Vagrant::Util::Platform.windows?\r\n      if Process.uid == 0\r\n        machine_id_file=Pathname.new(\".vagrant/machines/default/virtualbox/id\")\r\n        unless machine_id_file.exist?()\r\n          puts \"#{red} ⚠ DANGER VAGRANT IS RUNNING AS ROOT/SUDO, DO NOT USE SUDO ⚠#{creset}\"\r\n          puts \" ! VVV has detected that the VM has not been created yet, and is running as root/sudo.\"\r\n          puts \" ! Do not use sudo with VVV, do not run VVV as a root user. Aborting.\"\r\n          abort( \"Aborting Vagrant command to prevent a critical mistake, do not use sudo/root with VVV.\" )\r\n        end\r\n      end\r\n    end\r\n\r\n    v.customize ['modifyvm', :id, '--uartmode1', 'file', File.join(vagrant_dir, 'log/ubuntu-cloudimg-console.log')]\r\n    v.customize ['modifyvm', :id, '--memory', vvv_config['vm_config']['memory']]\r\n    v.customize ['modifyvm', :id, '--cpus', vvv_config['vm_config']['cores']]\r\n    v.customize ['modifyvm', :id, '--natdnshostresolver1', 'on']\r\n    v.customize ['modifyvm', :id, '--natdnsproxy1', 'on']\r\n\r\n    # see https://github.com/hashicorp/vagrant/issues/7648\r\n    v.customize ['modifyvm', :id, '--cableconnected1', 'on']\r\n\r\n    v.customize ['modifyvm', :id, '--rtcuseutc', 'on']\r\n    v.customize ['modifyvm', :id, '--audio', 'none']\r\n    v.customize ['modifyvm', :id, '--paravirtprovider', 'kvm']\r\n\r\n    # https://github.com/laravel/homestead/pull/63\r\n    v.customize ['modifyvm', :id, '--ostype', 'Ubuntu_64']\r\n\r\n    v.customize ['setextradata', :id, 'VBoxInternal2/SharedFoldersEnableSymlinksCreate//srv/www', '1']\r\n    v.customize ['setextradata', :id, 'VBoxInternal2/SharedFoldersEnableSymlinksCreate//srv/config', '1']\r\n\r\n    # Set the box name in VirtualBox to match the working directory.\r\n    v.name = File.basename(vagrant_dir) + '_' + (Digest::SHA256.hexdigest vagrant_dir)[0..10]\r\n  end\r\n\r\n  # Configuration options for the Parallels provider.\r\n  config.vm.provider :parallels do |v|\r\n    v.customize ['set', :id, '--longer-battery-life', 'off']\r\n    v.memory = vvv_config['vm_config']['memory']\r\n    v.cpus = vvv_config['vm_config']['cores']\r\n  end\r\n\r\n  # Configuration options for the VMware Desktop provider.\r\n  config.vm.provider :vmware_desktop do |v|\r\n    v.vmx['memsize'] = vvv_config['vm_config']['memory']\r\n    v.vmx['numvcpus'] = vvv_config['vm_config']['cores']\r\n  end\r\n\r\n  # Configuration options for Hyper-V provider.\r\n  config.vm.provider :hyperv do |v|\r\n    v.memory = vvv_config['vm_config']['memory']\r\n    v.cpus = vvv_config['vm_config']['cores']\r\n    v.linked_clone = true\r\n  end\r\n\r\n  # Auto Download Vagrant plugins, supported from Vagrant 2.2.0\r\n  unless Vagrant.has_plugin?('vagrant-hostsupdater') && Vagrant.has_plugin?('vagrant-goodhosts') && Vagrant.has_plugin?('vagrant-hostsmanager')\r\n    if File.file?(File.join(vagrant_dir, 'vagrant-goodhosts.gem'))\r\n      system('vagrant plugin install ' + File.join(vagrant_dir, 'vagrant-goodhosts.gem'))\r\n      File.delete(File.join(vagrant_dir, 'vagrant-goodhosts.gem'))\r\n      puts \"#{yellow}VVV needed to install the vagrant-goodhosts plugin which is now installed. Please run the requested command again.#{creset}\"\r\n      exit\r\n    else\r\n      config.vagrant.plugins = ['vagrant-goodhosts']\r\n    end\r\n  end\r\n\r\n  # The vbguest plugin has issues for some users, so we're going to disable it for now\r\n  config.vbguest.auto_update = false if Vagrant.has_plugin?('vagrant-vbguest')\r\n\r\n  # SSH Agent Forwarding\r\n  #\r\n  # Enable agent forwarding on vagrant ssh commands. This allows you to use ssh keys\r\n  # on your host machine inside the guest. See the manual for `ssh-add`.\r\n  config.ssh.forward_agent = true\r\n\r\n  # SSH Key Insertion\r\n  #\r\n  # This is disabled, we had several contributors who ran into issues.\r\n  # See: https://github.com/Varying-Vagrant-Vagrants/VVV/issues/1551\r\n  config.ssh.insert_key = false\r\n  config.vm.box_check_update = false\r\n\r\n  # The Parallels Provider uses a different naming scheme.\r\n  config.vm.provider :parallels do |_v, override|\r\n    override.vm.box = 'bento/ubuntu-20.04'\r\n\r\n    # Vagrant currently runs under Rosetta on M1 devices. As a result,\r\n    # this seems to be the most reliable way to detect whether or not we're\r\n    # running under ARM64.\r\n    if Etc.uname[:version].include? 'ARM64'\r\n      override.vm.box = 'bento/ubuntu-20.04-arm64'\r\n    end\r\n  end\r\n\r\n  # The VMware Desktop Provider uses a different naming scheme.\r\n  config.vm.provider :vmware_desktop do |v, override|\r\n    override.vm.box = 'bento/ubuntu-20.04'\r\n    v.gui = false\r\n  end\r\n\r\n  # Hyper-V uses a different base box.\r\n  config.vm.provider :hyperv do |_v, override|\r\n    override.vm.box = 'bento/ubuntu-20.04'\r\n  end\r\n\r\n  # Docker use image.\r\n  config.vm.provider :docker do |d, override|\r\n    d.image = 'pentatonicfunk/vagrant-ubuntu-base-images:20.04'\r\n    d.has_ssh = true\r\n    d.ports =  [ \"80:80\" ] # HTTP\r\n    d.ports += [ \"443:443\" ] # HTTPS\r\n    d.ports += [ \"3306:3306\" ] # MySQL\r\n    d.ports += [ \"8025:8025\" ] # Mailhog\r\n\r\n    ## Fix goodhosts aliases format for docker\r\n    override.goodhosts.aliases = { '127.0.0.1' => vvv_config['hosts'], '::1' => vvv_config['hosts'] }\r\n  end\r\n\r\n  # Virtualbox.\r\n  config.vm.provider :virtualbox do |_v, override|\r\n    # Default Ubuntu Box\r\n    #\r\n    # This box is provided by Bento boxes via vagrantcloud.com and is a nicely sized\r\n    # box containing the Ubuntu 20.04 Focal 64 bit release. Once this box is downloaded\r\n    # to your host computer, it is cached for future use under the specified box name.\r\n    override.vm.box = 'bento/ubuntu-20.04'\r\n\r\n    # If we're at a contributor day, switch the base box to the prebuilt one\r\n    if defined? vvv_config['vm_config']['wordcamp_contributor_day_box']\r\n      if vvv_config['vm_config']['wordcamp_contributor_day_box'] == true\r\n        override.vm.box = 'vvv/contribute'\r\n      end\r\n    end\r\n  end\r\n\r\n  if defined? vvv_config['vm_config']['box']\r\n    unless vvv_config['vm_config']['box'].nil?\r\n      config.vm.box = vvv_config['vm_config']['box']\r\n    end\r\n  end\r\n\r\n  config.vm.hostname = 'vvv'\r\n\r\n  # Specify disk size\r\n  #\r\n  # If the Vagrant plugin disksize (https://github.com/sprotheroe/vagrant-disksize) is\r\n  # installed, the following will automatically configure your local machine's disk size\r\n  # to be the specified size. This plugin only works on VirtualBox.\r\n  #\r\n  # Warning: This plugin only resizes up, not down, so don't set this to less than 10GB,\r\n  # and if you need to downsize, be sure to destroy and reprovision.\r\n  #\r\n  if !vvv_config['vagrant-plugins']['disksize'].nil? && defined?(Vagrant::Disksize)\r\n    config.vm.provider :virtualbox do |_v, override|\r\n      override.disksize.size = vvv_config['vagrant-plugins']['disksize']\r\n    end\r\n    if Etc.uname[:version].include? 'ARM64'\r\n      puts \"WARNING: Vagrant disksize requires VirtualBox and is incompatible with Arm devices, uninstall immediatley\"\r\n    end\r\n  end\r\n\r\n  # Private Network (default)\r\n  #\r\n  # A private network is created by default. This is the IP address through which your\r\n  # host machine will communicate to the guest. In this default configuration, the virtual\r\n  # machine will have an IP address of 192.168.56.4 and a virtual network adapter will be\r\n  # created on your host machine with the IP of 192.168.50.1 as a gateway.\r\n  #\r\n  # Access to the guest machine is only available to your local host. To provide access to\r\n  # other devices, a public network should be configured or port forwarding enabled.\r\n  #\r\n  # Note: If your existing network is using the 192.168.56.x subnet, this default IP address\r\n  # should be changed. If more than one VM is running through VirtualBox, including other\r\n  # Vagrant machines, different subnets should be used for each.\r\n  #\r\n  config.vm.network :private_network, id: 'vvv_primary', ip: vvv_config['vm_config']['private_network_ip']\r\n\r\n  config.vm.provider :hyperv do |_v, override|\r\n    override.vm.network :private_network, id: 'vvv_primary', ip: nil\r\n  end\r\n\r\n  # Public Network (disabled)\r\n  #\r\n  # Using a public network rather than the default private network configuration will allow\r\n  # access to the guest machine from other devices on the network. By default, enabling this\r\n  # line will cause the guest machine to use DHCP to determine its IP address. You will also\r\n  # be prompted to choose a network interface to bridge with during `vagrant up`.\r\n  #\r\n  # Please see VVV and Vagrant documentation for additional details.\r\n  #\r\n  # config.vm.network :public_network\r\n\r\n  # Port Forwarding (disabled)\r\n  #\r\n  # This network configuration works alongside any other network configuration in Vagrantfile\r\n  # and forwards any requests to port 8080 on the local host machine to port 80 in the guest.\r\n  #\r\n  # Port forwarding is a first step to allowing access to outside networks, though additional\r\n  # configuration will likely be necessary on our host machine or router so that outside\r\n  # requests will be forwarded from 80 -> 8080 -> 80.\r\n  #\r\n  # Please see VVV and Vagrant documentation for additional details.\r\n  #\r\n  # config.vm.network \"forwarded_port\", guest: 80, host: 8080\r\n\r\n  # Drive mapping\r\n  #\r\n  # The following config.vm.synced_folder settings will map directories in your Vagrant\r\n  # virtual machine to directories on your local machine. Once these are mapped, any\r\n  # changes made to the files in these directories will affect both the local and virtual\r\n  # machine versions. Think of it as two different ways to access the same file. When the\r\n  # virtual machine is destroyed with `vagrant destroy`, your files will remain in your local\r\n  # environment.\r\n\r\n  # Disable the default synced folder to avoid overlapping mounts\r\n  config.vm.synced_folder '.', '/vagrant', disabled: true\r\n  config.vm.provision 'file', source: \"#{vagrant_dir}/version\", destination: '/home/vagrant/version'\r\n\r\n  # /srv/database/\r\n  #\r\n  # If a database directory exists in the same directory as your Vagrantfile,\r\n  # a mapped directory inside the VM will be created that contains these files.\r\n  # This directory is used to maintain default database scripts as well as backed\r\n  # up MariaDB/MySQL dumps (SQL files) that are to be imported automatically on vagrant up\r\n  config.vm.synced_folder 'database/sql/', '/srv/database'\r\n  use_db_share = false\r\n\r\n  if defined? vvv_config['general']['db_share_type']\r\n    use_db_share = vvv_config['general']['db_share_type'] == true\r\n  end\r\n  if use_db_share == true\r\n    # Map the MySQL Data folders on to mounted folders so it isn't stored inside the VM\r\n    config.vm.synced_folder 'database/data/', '/var/lib/mysql', create: true, owner: 9001, group: 9001, mount_options: ['dmode=775', 'fmode=664']\r\n\r\n    # The Parallels Provider does not understand \"dmode\"/\"fmode\" in the \"mount_options\" as\r\n    # those are specific to Virtualbox. The folder is therefore overridden with one that\r\n    # uses corresponding Parallels mount options.\r\n    config.vm.provider :parallels do |_v, override|\r\n      override.vm.synced_folder 'database/data/', '/var/lib/mysql', create: true, owner: 9001, group: 9001, mount_options: [ 'share' ]\r\n    end\r\n    # Neither does the HyperV provider\r\n    config.vm.provider :hyperv do |_v, override|\r\n      override.vm.synced_folder 'database/data/', '/var/lib/mysql', create: true, owner: 9001, group: 9001, mount_options: ['dir_mode=0775', 'file_mode=0664']\r\n    end\r\n  end\r\n\r\n  # /srv/config/\r\n  #\r\n  # If a server-conf directory exists in the same directory as your Vagrantfile,\r\n  # a mapped directory inside the VM will be created that contains these files.\r\n  # This directory is currently used to maintain various config files for php and\r\n  # nginx as well as any pre-existing database files.\r\n  config.vm.synced_folder 'config/', '/srv/config'\r\n\r\n  # /srv/config/\r\n  #\r\n  # Map the provision folder so that extensions and provisioners can access helper scripts\r\n  config.vm.synced_folder 'provision/', '/srv/provision'\r\n\r\n  # /srv/certificates\r\n  #\r\n  # This is a location for the TLS certificates to be accessible inside the VM\r\n  config.vm.synced_folder 'certificates/', '/srv/certificates', create: true\r\n\r\n  # /var/log/\r\n  #\r\n  # If a log directory exists in the same directory as your Vagrantfile, a mapped\r\n  # directory inside the VM will be created for some generated log files.\r\n  config.vm.synced_folder 'log/memcached', '/var/log/memcached', owner: 'root', create: true, group: 'root', mount_options: ['dmode=777', 'fmode=666']\r\n  config.vm.synced_folder 'log/nginx', '/var/log/nginx', owner: 'root', create: true, group: 'root', mount_options: ['dmode=777', 'fmode=666']\r\n  config.vm.synced_folder 'log/php', '/var/log/php', create: true, owner: 'root', group: 'root', mount_options: ['dmode=777', 'fmode=666']\r\n  config.vm.synced_folder 'log/provisioners', '/var/log/provisioners', create: true, owner: 'root', group: 'root', mount_options: ['dmode=777', 'fmode=666']\r\n\r\n  # /srv/www/\r\n  #\r\n  # If a www directory exists in the same directory as your Vagrantfile, a mapped directory\r\n  # inside the VM will be created that acts as the default location for nginx sites. Put all\r\n  # of your project files here that you want to access through the web server\r\n  config.vm.synced_folder 'www/', '/srv/www', owner: 'vagrant', group: 'www-data', mount_options: ['dmode=775', 'fmode=774']\r\n\r\n  vvv_config['sites'].each do |site, args|\r\n    next if args['skip_provisioning']\r\n    if args['local_dir'] != File.join(vagrant_dir, 'www', site)\r\n      config.vm.synced_folder args['local_dir'], args['vm_dir'], owner: 'vagrant', group: 'www-data', mount_options: ['dmode=775', 'fmode=774']\r\n    end\r\n  end\r\n\r\n  # The Parallels Provider does not understand \"dmode\"/\"fmode\" in the \"mount_options\" as\r\n  # those are specific to Virtualbox. The folder is therefore overridden with one that\r\n  # uses corresponding Parallels mount options.\r\n  config.vm.provider :parallels do |_v, override|\r\n    override.vm.synced_folder 'www/', '/srv/www', owner: 'vagrant', group: 'www-data', mount_options: [ 'share' ]\r\n\r\n    override.vm.synced_folder 'log/memcached', '/var/log/memcached', owner: 'root', create: true, group: 'root', mount_options: [ 'share' ]\r\n    override.vm.synced_folder 'log/nginx', '/var/log/nginx', owner: 'root', create: true, group: 'root', mount_options: [ 'share' ]\r\n    override.vm.synced_folder 'log/php', '/var/log/php', create: true, owner: 'root', group: 'root', mount_options: [ 'share' ]\r\n    override.vm.synced_folder 'log/provisioners', '/var/log/provisioners', create: true, owner: 'root', group: 'root', mount_options: [ 'share' ]\r\n\r\n    if use_db_share == true\r\n      # Map the MySQL Data folders on to mounted folders so it isn't stored inside the VM\r\n      override.vm.synced_folder 'database/data/', '/var/lib/mysql', create: true, owner: 112, group: 115, mount_options: [ 'share' ]\r\n    end\r\n\r\n    vvv_config['sites'].each do |site, args|\r\n      next if args['skip_provisioning']\r\n      if args['local_dir'] != File.join(vagrant_dir, 'www', site)\r\n        override.vm.synced_folder args['local_dir'], args['vm_dir'], owner: 'vagrant', group: 'www-data', mount_options: [ 'share' ]\r\n      end\r\n    end\r\n  end\r\n\r\n  # The Hyper-V Provider does not understand \"dmode\"/\"fmode\" in the \"mount_options\" as\r\n  # those are specific to Virtualbox. Furthermore, the normal shared folders need to be\r\n  # replaced with SMB shares. Here we switch all the shared folders to us SMB and then\r\n  # override the www folder with options that make it Hyper-V compatible.\r\n  config.vm.provider :hyperv do |v, override|\r\n    v.vmname = File.basename(vagrant_dir) + '_' + (Digest::SHA256.hexdigest vagrant_dir)[0..10]\r\n\r\n    override.vm.synced_folder 'www/', '/srv/www', owner: 'vagrant', group: 'www-data', mount_options: ['dir_mode=0775', 'file_mode=0774']\r\n\r\n    if use_db_share == true\r\n      # Map the MySQL Data folders on to mounted folders so it isn't stored inside the VM\r\n      override.vm.synced_folder 'database/data/', '/var/lib/mysql', create: true, owner: 112, group: 115, mount_options: ['dir_mode=0775', 'file_mode=0664']\r\n    end\r\n\r\n    override.vm.synced_folder 'log/memcached', '/var/log/memcached', owner: 'root', create: true, group: 'root', mount_options: ['dir_mode=0777', 'file_mode=0666']\r\n    override.vm.synced_folder 'log/nginx', '/var/log/nginx', owner: 'root', create: true, group: 'root', mount_options: ['dir_mode=0777', 'file_mode=0666']\r\n    override.vm.synced_folder 'log/php', '/var/log/php', create: true, owner: 'root', group: 'root', mount_options: ['dir_mode=0777', 'file_mode=0666']\r\n    override.vm.synced_folder 'log/provisioners', '/var/log/provisioners', create: true, owner: 'root', group: 'root', mount_options: ['dir_mode=0777', 'file_mode=0666']\r\n\r\n    vvv_config['sites'].each do |site, args|\r\n      next if args['skip_provisioning']\r\n      if args['local_dir'] != File.join(vagrant_dir, 'www', site)\r\n        override.vm.synced_folder args['local_dir'], args['vm_dir'], owner: 'vagrant', group: 'www-data', mount_options: ['dir_mode=0775', 'file_mode=0774']\r\n      end\r\n    end\r\n  end\r\n\r\n  # The VMware Provider does not understand \"dmode\"/\"fmode\" in the \"mount_options\" as\r\n  # those are specific to Virtualbox. The folder is therefore overridden with one that\r\n  # uses corresponding VMware mount options.\r\n  config.vm.provider :vmware_desktop do |_v, override|\r\n    override.vm.synced_folder 'www/', '/srv/www', owner: 'vagrant', group: 'www-data', mount_options: ['umask=002']\r\n\r\n    override.vm.synced_folder 'log/memcached', '/var/log/memcached', owner: 'root', create: true, group: 'root', mount_options: ['umask=000']\r\n    override.vm.synced_folder 'log/nginx', '/var/log/nginx', owner: 'root', create: true, group: 'root', mount_options: ['umask=000']\r\n    override.vm.synced_folder 'log/php', '/var/log/php', create: true, owner: 'root', group: 'root', mount_options: ['umask=000']\r\n    override.vm.synced_folder 'log/provisioners', '/var/log/provisioners', create: true, owner: 'root', group: 'root', mount_options: ['umask=000']\r\n\r\n    if use_db_share == true\r\n      # Map the MySQL Data folders on to mounted folders so it isn't stored inside the VM\r\n      override.vm.synced_folder 'database/data/', '/var/lib/mysql', create: true, owner: 112, group: 115, mount_options: ['umask=000']\r\n    end\r\n\r\n    vvv_config['sites'].each do |site, args|\r\n      next if args['skip_provisioning']\r\n      if args['local_dir'] != File.join(vagrant_dir, 'www', site)\r\n        override.vm.synced_folder args['local_dir'], args['vm_dir'], owner: 'vagrant', group: 'www-data', mount_options: ['umask=002']\r\n      end\r\n    end\r\n  end\r\n\r\n  # Customfile - POSSIBLY UNSTABLE\r\n  #\r\n  # Use this to insert your own additional Vagrant config lines. Helpful\r\n  # for mapping additional drives. If a file 'Customfile' exists in the same directory\r\n  # as this Vagrantfile, it will be evaluated as ruby inline as it loads.\r\n  #\r\n  # Note that if you find yourself using a Customfile for anything crazy or specifying\r\n  # different provisioning, then you may want to consider a new Vagrantfile entirely.\r\n  if File.exist?(File.join(vagrant_dir, 'Customfile'))\r\n    puts \" ⚠ ! Running additional Vagrant code in Customfile located at #{File.join(vagrant_dir, 'Customfile')}\\n\"\r\n    puts \" ⚠ ! Official support is not provided for this feature, it is assumed you are proficient with vagrant\\n\\n\"\r\n    eval(IO.read(File.join(vagrant_dir, 'Customfile')), binding)\r\n    puts \" ⚠ ! Finished running Customfile, resuming normal vagrantfile execution\\n\\n\"\r\n  end\r\n\r\n  vvv_config['sites'].each do |site, args|\r\n    next unless args['allow_customfile']\r\n\r\n    paths = Dir[File.join(args['local_dir'], '**', 'Customfile')]\r\n    paths.each do |file|\r\n      puts \" ⚠ ! Running additional site customfile at #{file}\\n\"\r\n      puts \" ⚠ ! Official support is not provided for this feature.\\n\\n\"\r\n      eval(IO.read(file), binding)\r\n      puts \" ⚠ ! Finished running Customfile, resuming normal vagrantfile execution\\n\\n\"\r\n    end\r\n  end\r\n\r\n  # Provisioning\r\n  #\r\n  # Process one or more provisioning scripts depending on the existence of custom files.\r\n\r\n  unless Vagrant::Util::Platform.windows?\r\n    if Process.uid == 0\r\n      # the VM should know if vagrant was ran by a root user or using sudo\r\n      config.vm.provision \"flag-root-vagrant-command\", type: 'shell', keep_color: true, inline: \"mkdir -p /vagrant && touch /vagrant/provisioned_as_root\"\r\n    end\r\n  end\r\n\r\n  long_provision_bear = <<~HTML\r\n  #{blue}#{creset}\r\n  #{blue}    ▄▀▀▀▄▄▄▄▄▄▄▀▀▀▄    ▄   ▄    #{green}A full provision will take a bit.#{creset}\r\n  #{blue}    █▒▒░░░░░░░░░▒▒█   █   █     #{green}Sit back, relax, and have some tea.#{creset}\r\n  #{blue}     █░░█░░░░░█░░█   ▀   ▀      #{creset}\r\n  #{blue}  ▄▄  █░░░▀█▀░░░█   █▀▀▀▀▀▀█    #{green}If you didn't want to provision you can#{creset}\r\n  #{blue} █░░█ ▀▄░░░░░░░▄▀▄▀▀█      █    #{green}turn VVV on with 'vagrant up'.#{creset}\r\n  #{blue}───────────────────────────────────────────────────────────────────────#{creset}\r\n  HTML\r\n\r\n  # Changed the message here because it's going to show the first time you do vagrant up, which might be confusing\r\n  config.vm.provision \"pre-provision-script\", type: 'shell', keep_color: true, inline: \"echo \\\"#{long_provision_bear}\\\"\"\r\n\r\n  # provison-pre.sh acts as a pre-hook to our default provisioning script. Anything that\r\n  # should run before the shell commands laid out in provision.sh (or your provision-custom.sh\r\n  # file) should go in this script. If it does not exist, no extra provisioning will run.\r\n  if File.exist?(File.join(vagrant_dir, 'provision', 'provision-pre.sh'))\r\n    config.vm.provision 'pre', type: 'shell', keep_color: true, path: File.join('provision', 'provision-pre.sh'), env: { \"VVV_LOG\" => \"pre\" }\r\n  end\r\n\r\n  # provision.sh or provision-custom.sh\r\n  #\r\n  # By default, Vagrantfile is set to use the provision.sh bash script located in the\r\n  # provision directory. If it is detected that a provision-custom.sh script has been\r\n  # created, that is run as a replacement. This is an opportunity to replace the entirety\r\n  # of the provisioning provided by default.\r\n  if File.exist?(File.join(vagrant_dir, 'provision', 'provision-custom.sh'))\r\n    config.vm.provision 'custom', type: 'shell', keep_color: true, path: File.join('provision', 'provision-custom.sh'), env: { \"VVV_LOG\" => \"main-custom\" }\r\n  else\r\n    config.vm.provision 'default', type: 'shell', keep_color: true, path: File.join('provision', 'provision.sh'), env: { \"VVV_LOG\" => \"main\" }\r\n  end\r\n\r\n  config.vm.provision 'tools', type: 'shell', keep_color: true, path: File.join('provision', 'provision-tools.sh'), env: { \"VVV_LOG\" => \"tools\" }\r\n\r\n  # Provision the dashboard that appears when you visit vvv.test\r\n  config.vm.provision 'dashboard',\r\n                      type: 'shell',\r\n                      keep_color: true,\r\n                      path: File.join('provision', 'provision-dashboard.sh'),\r\n                      args: [\r\n                        vvv_config['dashboard']['repo'],\r\n                        vvv_config['dashboard']['branch']\r\n                      ],\r\n                      env: { \"VVV_LOG\" => \"dashboard\" }\r\n\r\n  vvv_config['utility-sources'].each do |name, args|\r\n    config.vm.provision \"extension-source-#{name}\",\r\n                        type: 'shell',\r\n                        keep_color: true,\r\n                        path: File.join('provision', 'provision-extension-source.sh'),\r\n                        args: [\r\n                          name,\r\n                          args['repo'].to_s,\r\n                          args['branch']\r\n                        ],\r\n                        env: { \"VVV_LOG\" => \"extension-source-#{name}\" }\r\n  end\r\n  vvv_config['extension-sources'].each do |name, args|\r\n    config.vm.provision \"extension-source-#{name}\",\r\n                        type: 'shell',\r\n                        keep_color: true,\r\n                        path: File.join('provision', 'provision-extension-source.sh'),\r\n                        args: [\r\n                          name,\r\n                          args['repo'].to_s,\r\n                          args['branch']\r\n                        ],\r\n                        env: { \"VVV_LOG\" => \"extension-source-#{name}\" }\r\n  end\r\n\r\n  vvv_config['utilities'].each do |name, extensions|\r\n    extensions = {} unless extensions.is_a? Array\r\n    extensions.each do |extension|\r\n      config.vm.provision \"extension-#{name}-#{extension}\",\r\n                          type: 'shell',\r\n                          keep_color: true,\r\n                          path: File.join('provision', 'provision-extension.sh'),\r\n                          args: [\r\n                            name,\r\n                            extension\r\n                          ],\r\n                          env: { \"VVV_LOG\" => \"extension-#{name}-#{extension}\" }\r\n    end\r\n  end\r\n  vvv_config['extensions'].each do |name, extensions|\r\n    extensions = {} unless extensions.is_a? Array\r\n    extensions.each do |extension|\r\n      config.vm.provision \"extension-#{name}-#{extension}\",\r\n                          type: 'shell',\r\n                          keep_color: true,\r\n                          path: File.join('provision', 'provision-extension.sh'),\r\n                          args: [\r\n                            name,\r\n                            extension\r\n                          ],\r\n                          env: { \"VVV_LOG\" => \"extension-#{name}-#{extension}\" }\r\n    end\r\n  end\r\n\r\n  vvv_config['sites'].each do |site, args|\r\n    next if args['skip_provisioning']\r\n\r\n    config.vm.provision \"site-#{site}\",\r\n                        type: 'shell',\r\n                        keep_color: true,\r\n                        path: File.join('provision', 'provision-site.sh'),\r\n                        args: [\r\n                          site,\r\n                          args['repo'].to_s,\r\n                          args['branch'],\r\n                          args['vm_dir'],\r\n                          args['skip_provisioning'].to_s,\r\n                          args['nginx_upstream']\r\n                        ],\r\n                        env: { \"VVV_LOG\" => \"site-#{site}\" }\r\n  end\r\n\r\n  # provision-post.sh acts as a post-hook to the default provisioning. Anything that should\r\n  # run after the shell commands laid out in provision.sh or provision-custom.sh should be\r\n  # put into this file. This provides a good opportunity to install additional packages\r\n  # without having to replace the entire default provisioning script.\r\n  if File.exist?(File.join(vagrant_dir, 'provision', 'provision-post.sh'))\r\n    config.vm.provision 'post', type: 'shell', keep_color: true, path: File.join('provision', 'provision-post.sh'), env: { \"VVV_LOG\" => \"post\" }\r\n  end\r\n\r\n  config.vm.provision \"post-provision-script\", type: 'shell', keep_color: true, path: File.join( 'config/homebin', 'vagrant_provision' ), env: { \"VVV_LOG\" => \"post-provision-script\" }\r\n\r\n  # Local Machine Hosts\r\n  #\r\n  # If the Vagrant plugin goodhosts (https://github.com/goodhosts/vagrant/) is\r\n  # installed, the following will automatically configure your local machine's hosts file to\r\n  # be aware of the domains specified below. Watch the provisioning script as you may need to\r\n  # enter a password for Vagrant to access your hosts file.\r\n  #\r\n  # By default, we'll include the domains set up by VVV through the vvv-hosts file\r\n  # located in the www/ directory and in config/config.yml.\r\n  #\r\n\r\n  if config.vagrant.plugins.include? 'vagrant-goodhosts'\r\n    config.goodhosts.aliases = vvv_config['hosts']\r\n    config.goodhosts.remove_on_suspend = true\r\n\r\n    # goodhosts already disables clean by default, but lets enforce this at both ends\r\n    config.goodhosts.disable_clean = true\r\n  elsif config.vagrant.plugins.include? 'vagrant-hostsmanager'\r\n    config.hostmanager.aliases = vvv_config['hosts']\r\n    config.hostmanager.enabled = true\r\n    config.hostmanager.manage_host = true\r\n    config.hostmanager.manage_guest = true\r\n    config.hostmanager.ignore_private_ip = false\r\n    config.hostmanager.include_offline = true\r\n  elsif config.vagrant.plugins.include? 'vagrant-hostsupdater'\r\n    # Pass the found host names to the hostsupdater plugin so it can perform magic.\r\n    config.hostsupdater.aliases = vvv_config['hosts']\r\n    config.hostsupdater.remove_on_suspend = true\r\n  elsif %w[up halt resume suspend status provision reload].include? ARGV[0]\r\n    puts \"\"\r\n    puts \" X ! There is no hosts file vagrant plugin installed!\"\r\n    puts \" X You need the vagrant-goodhosts plugin (or HostManager/ HostsUpdater ) for domains to work in the browser\"\r\n    puts \" X Run 'vagrant plugin install --local' to fix this.\"\r\n    puts \"\"\r\n  end\r\n\r\n  # Vagrant Triggers\r\n  #\r\n  # We run various scripts on Vagrant state changes like `vagrant up`, `vagrant halt`,\r\n  # `vagrant suspend`, and `vagrant destroy`\r\n  #\r\n  # These scripts are run on the host machine, so we use `vagrant ssh` to tunnel back\r\n  # into the VM and execute things. By default, each of these scripts calls db_backup\r\n  # to create backups of all current databases. This can be overridden with custom\r\n  # scripting. See the individual files in config/homebin/ for details.\r\n  unless Vagrant::Util::Platform.windows?\r\n    if Process.uid == 0\r\n      config.trigger.after :all do |trigger|\r\n        trigger.name = 'Do not use sudo'\r\n        trigger.ruby do |env,machine|\r\n          sudo_warnings\r\n        end\r\n      end\r\n    end\r\n  end\r\n\r\n  config.trigger.after :up do |trigger|\r\n    trigger.name = 'VVV Post-Up'\r\n    trigger.run_remote = { inline: '/srv/config/homebin/vagrant_up' }\r\n    trigger.on_error = :continue\r\n  end\r\n  config.trigger.before :reload do |trigger|\r\n    trigger.name = 'VVV Pre-Reload'\r\n    trigger.run_remote = { inline: '/srv/config/homebin/vagrant_halt' }\r\n    trigger.on_error = :continue\r\n  end\r\n  config.trigger.after :reload do |trigger|\r\n    trigger.name = 'VVV Post-Reload'\r\n    trigger.run_remote = { inline: '/srv/config/homebin/vagrant_up' }\r\n    trigger.on_error = :continue\r\n  end\r\n  config.trigger.before :halt do |trigger|\r\n    trigger.name = 'VVV Pre-Halt'\r\n    trigger.run_remote = { inline: '/srv/config/homebin/vagrant_halt' }\r\n    trigger.on_error = :continue\r\n  end\r\n  config.trigger.before :suspend do |trigger|\r\n    trigger.name = 'VVV Pre-Suspend'\r\n    trigger.run_remote = { inline: '/srv/config/homebin/vagrant_suspend' }\r\n    trigger.on_error = :continue\r\n  end\r\n  config.trigger.before :destroy do |trigger|\r\n    trigger.name = 'VVV Pre-Destroy'\r\n    trigger.run_remote = { inline: '/srv/config/homebin/vagrant_destroy' }\r\n    trigger.on_error = :continue\r\n  end\r\nend\r\n\r\n```\r\n\r\n</details>\r\n\r\n> Always start with a minimal Vagrantfile and include only the relevant configuration\r\nto reproduce the reported behavior.\r\n\r\n_WIP_\r\n","closed_by":{"login":"chrisroberts","id":266674,"node_id":"MDQ6VXNlcjI2NjY3NA==","avatar_url":"https://avatars.githubusercontent.com/u/266674?v=4","gravatar_id":"","url":"https://api.github.com/users/chrisroberts","html_url":"https://github.com/chrisroberts","followers_url":"https://api.github.com/users/chrisroberts/followers","following_url":"https://api.github.com/users/chrisroberts/following{/other_user}","gists_url":"https://api.github.com/users/chrisroberts/gists{/gist_id}","starred_url":"https://api.github.com/users/chrisroberts/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chrisroberts/subscriptions","organizations_url":"https://api.github.com/users/chrisroberts/orgs","repos_url":"https://api.github.com/users/chrisroberts/repos","events_url":"https://api.github.com/users/chrisroberts/events{/privacy}","received_events_url":"https://api.github.com/users/chrisroberts/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/hashicorp/vagrant/issues/13371/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/hashicorp/vagrant/issues/13371/timeline","performed_via_github_app":null,"state_reason":"completed"}