{"url":"https://api.github.com/repos/hashicorp/vagrant/issues/7119","repository_url":"https://api.github.com/repos/hashicorp/vagrant","labels_url":"https://api.github.com/repos/hashicorp/vagrant/issues/7119/labels{/name}","comments_url":"https://api.github.com/repos/hashicorp/vagrant/issues/7119/comments","events_url":"https://api.github.com/repos/hashicorp/vagrant/issues/7119/events","html_url":"https://github.com/hashicorp/vagrant/issues/7119","id":139298273,"node_id":"MDU6SXNzdWUxMzkyOTgyNzM=","number":7119,"title":"Private network down after reload","user":{"login":"larsch","id":15712,"node_id":"MDQ6VXNlcjE1NzEy","avatar_url":"https://avatars.githubusercontent.com/u/15712?v=4","gravatar_id":"","url":"https://api.github.com/users/larsch","html_url":"https://github.com/larsch","followers_url":"https://api.github.com/users/larsch/followers","following_url":"https://api.github.com/users/larsch/following{/other_user}","gists_url":"https://api.github.com/users/larsch/gists{/gist_id}","starred_url":"https://api.github.com/users/larsch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/larsch/subscriptions","organizations_url":"https://api.github.com/users/larsch/orgs","repos_url":"https://api.github.com/users/larsch/repos","events_url":"https://api.github.com/users/larsch/events{/privacy}","received_events_url":"https://api.github.com/users/larsch/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":true,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2016-03-08T14:56:31Z","updated_at":"2020-04-05T02:17:37Z","closed_at":"2016-03-08T18:55:50Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"From the debug log: Vagrant attempts to re-configure and enable the private network:\n\n```\n INFO ssh: Execute: ip link set enp0s8 down && netctl start enp0s8 && netctl enable enp0s8 (sudo=true)\nDEBUG ssh: stderr: <3>A unit file for profile 'enp0s8' already exists\n```\n\nThis does not put the device into the UP state since it was already started at boot by netctl. Device remains in DOWN state and can't be pinged or otherwise used. Running `netctl restart enp0s8` manually brings the device to the UP state. This seem to be safe to run even if not already started.\n\nSide-issue: If you change the private network configuration and then reload the machine, the configuration is not applied until the next reboot/reload (since netctl is already running when Vagrant runs `netctl start enp0s8`).\n### Vagrant version\n\n1.8.1\n### Host operating system\n\nMicrosoft Windows [Version 10.0.10586]\n### Guest operating system\n\nArch Linux (32-bit)\n### Vagrantfile\n\n``` ruby\n...\nvm.vm.network(:private_network, ip: \"192.168.12.2\")\n```\n### Debug output\n\nhttps://gist.github.com/larsch/4e3e592c2ed2be744e36\n### Expected behavior\n\nenp0s8 should be in state UP after boot\n### Actual behavior\n\nenp0s8 is in state DOWN after boot\n\n```\n# ip l\n...\n3: enp0s8: <BROADCAST,MULTICAST> mtu 1500 qdisc fq_codel state DOWN mode DEFAULT group default qlen 1000\n    link/ether 08:00:27:03:38:9d brd ff:ff:ff:ff:ff:ff \n```\n### Steps to reproduce\n\nvagrant up\n### References\n\nIn [GH-5737], it was changed to enable the adapter. Before this change, it would work (Vagrant would manually start the device on each boot). After this change, it is already starts so `netctl start` does nothing. [GH-5737] talks about the device not getting up after a (non-Vagrant) restart. That would kind of be expected behaviour to me (It's the same for shared folders for example, they don't come up unless you restart with `vagrant reload`).\n","closed_by":{"login":"sethvargo","id":408570,"node_id":"MDQ6VXNlcjQwODU3MA==","avatar_url":"https://avatars.githubusercontent.com/u/408570?v=4","gravatar_id":"","url":"https://api.github.com/users/sethvargo","html_url":"https://github.com/sethvargo","followers_url":"https://api.github.com/users/sethvargo/followers","following_url":"https://api.github.com/users/sethvargo/following{/other_user}","gists_url":"https://api.github.com/users/sethvargo/gists{/gist_id}","starred_url":"https://api.github.com/users/sethvargo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sethvargo/subscriptions","organizations_url":"https://api.github.com/users/sethvargo/orgs","repos_url":"https://api.github.com/users/sethvargo/repos","events_url":"https://api.github.com/users/sethvargo/events{/privacy}","received_events_url":"https://api.github.com/users/sethvargo/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/hashicorp/vagrant/issues/7119/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/hashicorp/vagrant/issues/7119/timeline","performed_via_github_app":null,"state_reason":"completed"}