{"url":"https://api.github.com/repos/hashicorp/vagrant/issues/9433","repository_url":"https://api.github.com/repos/hashicorp/vagrant","labels_url":"https://api.github.com/repos/hashicorp/vagrant/issues/9433/labels{/name}","comments_url":"https://api.github.com/repos/hashicorp/vagrant/issues/9433/comments","events_url":"https://api.github.com/repos/hashicorp/vagrant/issues/9433/events","html_url":"https://github.com/hashicorp/vagrant/issues/9433","id":293756782,"node_id":"MDU6SXNzdWUyOTM3NTY3ODI=","number":9433,"title":"Cannot ignore new Windows 10 built-in SSH client in Vagrant 2.0.2","user":{"login":"jstangroome","id":148754,"node_id":"MDQ6VXNlcjE0ODc1NA==","avatar_url":"https://avatars.githubusercontent.com/u/148754?v=4","gravatar_id":"","url":"https://api.github.com/users/jstangroome","html_url":"https://github.com/jstangroome","followers_url":"https://api.github.com/users/jstangroome/followers","following_url":"https://api.github.com/users/jstangroome/following{/other_user}","gists_url":"https://api.github.com/users/jstangroome/gists{/gist_id}","starred_url":"https://api.github.com/users/jstangroome/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jstangroome/subscriptions","organizations_url":"https://api.github.com/users/jstangroome/orgs","repos_url":"https://api.github.com/users/jstangroome/repos","events_url":"https://api.github.com/users/jstangroome/events{/privacy}","received_events_url":"https://api.github.com/users/jstangroome/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":218286867,"node_id":"MDU6TGFiZWwyMTgyODY4Njc=","url":"https://api.github.com/repos/hashicorp/vagrant/labels/host/windows","name":"host/windows","color":"d4c5f9","default":false,"description":null},{"id":443894440,"node_id":"MDU6TGFiZWw0NDM4OTQ0NDA=","url":"https://api.github.com/repos/hashicorp/vagrant/labels/communicator/ssh","name":"communicator/ssh","color":"006b75","default":false,"description":null}],"state":"closed","locked":true,"assignee":{"login":"chrisroberts","id":266674,"node_id":"MDQ6VXNlcjI2NjY3NA==","avatar_url":"https://avatars.githubusercontent.com/u/266674?v=4","gravatar_id":"","url":"https://api.github.com/users/chrisroberts","html_url":"https://github.com/chrisroberts","followers_url":"https://api.github.com/users/chrisroberts/followers","following_url":"https://api.github.com/users/chrisroberts/following{/other_user}","gists_url":"https://api.github.com/users/chrisroberts/gists{/gist_id}","starred_url":"https://api.github.com/users/chrisroberts/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chrisroberts/subscriptions","organizations_url":"https://api.github.com/users/chrisroberts/orgs","repos_url":"https://api.github.com/users/chrisroberts/repos","events_url":"https://api.github.com/users/chrisroberts/events{/privacy}","received_events_url":"https://api.github.com/users/chrisroberts/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"chrisroberts","id":266674,"node_id":"MDQ6VXNlcjI2NjY3NA==","avatar_url":"https://avatars.githubusercontent.com/u/266674?v=4","gravatar_id":"","url":"https://api.github.com/users/chrisroberts","html_url":"https://github.com/chrisroberts","followers_url":"https://api.github.com/users/chrisroberts/followers","following_url":"https://api.github.com/users/chrisroberts/following{/other_user}","gists_url":"https://api.github.com/users/chrisroberts/gists{/gist_id}","starred_url":"https://api.github.com/users/chrisroberts/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chrisroberts/subscriptions","organizations_url":"https://api.github.com/users/chrisroberts/orgs","repos_url":"https://api.github.com/users/chrisroberts/repos","events_url":"https://api.github.com/users/chrisroberts/events{/privacy}","received_events_url":"https://api.github.com/users/chrisroberts/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":{"url":"https://api.github.com/repos/hashicorp/vagrant/milestones/30","html_url":"https://github.com/hashicorp/vagrant/milestone/30","labels_url":"https://api.github.com/repos/hashicorp/vagrant/milestones/30/labels","id":3151648,"node_id":"MDk6TWlsZXN0b25lMzE1MTY0OA==","number":30,"title":"2.0.4","description":"","creator":{"login":"briancain","id":810277,"node_id":"MDQ6VXNlcjgxMDI3Nw==","avatar_url":"https://avatars.githubusercontent.com/u/810277?v=4","gravatar_id":"","url":"https://api.github.com/users/briancain","html_url":"https://github.com/briancain","followers_url":"https://api.github.com/users/briancain/followers","following_url":"https://api.github.com/users/briancain/following{/other_user}","gists_url":"https://api.github.com/users/briancain/gists{/gist_id}","starred_url":"https://api.github.com/users/briancain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/briancain/subscriptions","organizations_url":"https://api.github.com/users/briancain/orgs","repos_url":"https://api.github.com/users/briancain/repos","events_url":"https://api.github.com/users/briancain/events{/privacy}","received_events_url":"https://api.github.com/users/briancain/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":32,"state":"closed","created_at":"2018-02-28T20:12:27Z","updated_at":"2018-04-24T18:26:26Z","due_on":null,"closed_at":"2018-04-24T18:26:26Z"},"comments":7,"created_at":"2018-02-02T02:55:14Z","updated_at":"2020-03-30T01:56:13Z","closed_at":"2018-04-04T23:05:18Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Vagrant version\r\nVagrant 2.0.2\r\n\r\n### Host operating system\r\nWindows 10 x64 version 1709 (OS Build 16299.214)\r\nalso: VirtualBox 5.2.6 r120293\r\n```\r\nC:\\Windows\\System32\\OpenSSH\\ssh.exe -V\r\nOpenSSH_7.5p1, without OpenSSL\r\n```\r\n\r\n### Guest operating system\r\nUbuntu 14.04\r\n\r\n### Vagrantfile\r\nThe result of `vagrant init ubuntu/trusty` is sufficient.\r\n\r\n### Expected behavior\r\n`vagrant ssh` should succeed.\r\n\r\n### Actual behavior\r\n`vagrant ssh` returned error:\r\n```\r\nvagrant@127.0.0.1: Permission denied (publickey).\r\n```\r\n\r\n### Steps to reproduce\r\n1. [Install Windows 10 OpenSSH beta](https://blogs.msdn.microsoft.com/powershell/2017/12/15/using-the-openssh-beta-in-windows-10-fall-creators-update-and-windows-server-1709/)\r\n1. Open default shell (PowerShell) via Win+X, i. Also reproducible with `cmd.exe` shell.\r\n1. `vagrant init ubuntu/trusty`\r\n1. `vagrant up`\r\n1. `vagrant ssh`\r\n\r\n### References\r\n\r\nWith increased verbosity (eg `vagrant ssh -- -vvv`) the output shows:\r\n```\r\nLoad key \"./.vagrant/machines/section/virtualbox/private_key\": invalid format.\r\n```\r\n\r\nThis `Load key ... invalid format` error is most likely a bug with Windows 10's OpenSSH Beta, possibly related to only ed25519 keys currently being supported: https://github.com/PowerShell/Win32-OpenSSH/issues/973#issuecomment-349065648\r\n\r\nHowever, I cannot easily coerce Vagrant to use its embedded SSH client instead since this change:\r\nhttps://github.com/hashicorp/vagrant/issues/9143#issuecomment-361635432\r\n\r\nI'd hoped `VAGRANT_PREFER_SYSTEM_BIN=0 vagrant ssh` or `VAGRANT_PREFER_SYSTEM_BIN=false vagrant ssh` would work but it didn't.\r\n\r\nModifying the PATH to exclude `C:\\Windows\\System32\\OpenSSH` resolves the issue. Using a Cygwin shell with its own SSH client also resolves the issue.\r\n\r\nUninstalling the Windows 10 SSH beta also resolves the issue.\r\n\r\nWould be great if Vagrant 2.0.2 can be forced to use embedded SSH via vargant-specific environment variable command line parameter or even if Vagrant could generate ed25519 SSH keys.","closed_by":{"login":"chrisroberts","id":266674,"node_id":"MDQ6VXNlcjI2NjY3NA==","avatar_url":"https://avatars.githubusercontent.com/u/266674?v=4","gravatar_id":"","url":"https://api.github.com/users/chrisroberts","html_url":"https://github.com/chrisroberts","followers_url":"https://api.github.com/users/chrisroberts/followers","following_url":"https://api.github.com/users/chrisroberts/following{/other_user}","gists_url":"https://api.github.com/users/chrisroberts/gists{/gist_id}","starred_url":"https://api.github.com/users/chrisroberts/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chrisroberts/subscriptions","organizations_url":"https://api.github.com/users/chrisroberts/orgs","repos_url":"https://api.github.com/users/chrisroberts/repos","events_url":"https://api.github.com/users/chrisroberts/events{/privacy}","received_events_url":"https://api.github.com/users/chrisroberts/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/hashicorp/vagrant/issues/9433/reactions","total_count":9,"+1":9,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/hashicorp/vagrant/issues/9433/timeline","performed_via_github_app":null,"state_reason":"completed"}