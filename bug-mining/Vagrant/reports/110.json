{"url":"https://api.github.com/repos/hashicorp/vagrant/issues/8959","repository_url":"https://api.github.com/repos/hashicorp/vagrant","labels_url":"https://api.github.com/repos/hashicorp/vagrant/issues/8959/labels{/name}","comments_url":"https://api.github.com/repos/hashicorp/vagrant/issues/8959/comments","events_url":"https://api.github.com/repos/hashicorp/vagrant/issues/8959/events","html_url":"https://github.com/hashicorp/vagrant/issues/8959","id":256463808,"node_id":"MDU6SXNzdWUyNTY0NjM4MDg=","number":8959,"title":"Use, at minimum, SMBv2 when mounting Windows host synced folders.","user":{"login":"rhencke","id":178348,"node_id":"MDQ6VXNlcjE3ODM0OA==","avatar_url":"https://avatars.githubusercontent.com/u/178348?v=4","gravatar_id":"","url":"https://api.github.com/users/rhencke","html_url":"https://github.com/rhencke","followers_url":"https://api.github.com/users/rhencke/followers","following_url":"https://api.github.com/users/rhencke/following{/other_user}","gists_url":"https://api.github.com/users/rhencke/gists{/gist_id}","starred_url":"https://api.github.com/users/rhencke/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rhencke/subscriptions","organizations_url":"https://api.github.com/users/rhencke/orgs","repos_url":"https://api.github.com/users/rhencke/repos","events_url":"https://api.github.com/users/rhencke/events{/privacy}","received_events_url":"https://api.github.com/users/rhencke/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":218284952,"node_id":"MDU6TGFiZWwyMTgyODQ5NTI=","url":"https://api.github.com/repos/hashicorp/vagrant/labels/synced-folders/smb","name":"synced-folders/smb","color":"fef2c0","default":false,"description":null},{"id":218286867,"node_id":"MDU6TGFiZWwyMTgyODY4Njc=","url":"https://api.github.com/repos/hashicorp/vagrant/labels/host/windows","name":"host/windows","color":"d4c5f9","default":false,"description":null}],"state":"closed","locked":true,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2017-09-09T20:27:08Z","updated_at":"2020-01-28T02:41:43Z","closed_at":"2018-04-26T21:48:02Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"[Microsoft is removing support for SMBv1 from Windows.](https://support.microsoft.com/en-us/help/4034314/smbv1-is-not-installed-by-default-in-windows-10-rs3-and-windows-server)\r\n\r\nCurrently, though Vagrant will only attempt a mount with SMBv1, as this is the default behavior with `mount -t cifs`.  Going forward, on newer versions of Windows, this will always fail by default.\r\n\r\nThe fix is to specify a minimum protocol version of 2.0 when mounting.  SMBv2 is supported in Windows Vista Service Pack 1, and Windows Server 2008 or higher.  If backwards compatibility with earlier versions of Windows is important, Vagrant could attempt mounting with protocol version 2.0 first, dropping back to 1.0 if support is not present.\r\n\r\n### Vagrant version\r\nVagrant 2.0.0\r\n\r\n### Host operating system\r\nWindows 10 - Version 1703 (OS Build 16251.0)\r\n\r\n### Guest operating system\r\nDebian Stretch (generic/debian9)\r\n\r\n### Vagrantfile\r\n```ruby\r\nVagrant.configure(\"2\") do |config|\r\n  config.vm.box = \"generic/debian9\"\r\n  config.vm.synced_folder \".\", \"/vagrant\"\r\n  # Note: A successful mount can be achieved by specifying:\r\n  # config.vm.synced_folder \".\", \"/vagrant\", mount_options: [\"vers=2.0\"]\r\nend\r\n```\r\n\r\n### Debug output\r\nhttps://gist.github.com/rhencke/5e58e291607d0f0bf6544342ba349cb8\r\n\r\n(For comparison, here is a log showing how a successful mount can be achieved with the additional mount options described above: https://gist.github.com/rhencke/11f8dff86d719e9386941dd653e8a117 )\r\n\r\n### Expected behavior\r\nThe mount was successfully achieved when running `mount -t cifs`.\r\n\r\n### Actual behavior\r\nThe mount failed when running `mount -t cifs`, claiming `mount error(112): Host is down`.  However, the actual error is due to use of an unsupported protocol.\r\n\r\n### Steps to reproduce\r\n1. On a Windows 10 computer, version 1703 (OS Build 16251.0):\r\n  a. Enable Hyper-V\r\n  b. Install Vagrant 2.0.0\r\n2. Create a Vagrantfile, containing the example mentioned previously\r\n3. `vagrant up`\r\n\r\n### References\r\nThis issue seems strongly related:\r\n- https://github.com/mitchellh/vagrant/issues/7559\r\n","closed_by":{"login":"chrisroberts","id":266674,"node_id":"MDQ6VXNlcjI2NjY3NA==","avatar_url":"https://avatars.githubusercontent.com/u/266674?v=4","gravatar_id":"","url":"https://api.github.com/users/chrisroberts","html_url":"https://github.com/chrisroberts","followers_url":"https://api.github.com/users/chrisroberts/followers","following_url":"https://api.github.com/users/chrisroberts/following{/other_user}","gists_url":"https://api.github.com/users/chrisroberts/gists{/gist_id}","starred_url":"https://api.github.com/users/chrisroberts/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chrisroberts/subscriptions","organizations_url":"https://api.github.com/users/chrisroberts/orgs","repos_url":"https://api.github.com/users/chrisroberts/repos","events_url":"https://api.github.com/users/chrisroberts/events{/privacy}","received_events_url":"https://api.github.com/users/chrisroberts/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/hashicorp/vagrant/issues/8959/reactions","total_count":4,"+1":4,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/hashicorp/vagrant/issues/8959/timeline","performed_via_github_app":null,"state_reason":"completed"}