{"url":"https://api.github.com/repos/hashicorp/vagrant/issues/9763","repository_url":"https://api.github.com/repos/hashicorp/vagrant","labels_url":"https://api.github.com/repos/hashicorp/vagrant/issues/9763/labels{/name}","comments_url":"https://api.github.com/repos/hashicorp/vagrant/issues/9763/comments","events_url":"https://api.github.com/repos/hashicorp/vagrant/issues/9763/events","html_url":"https://github.com/hashicorp/vagrant/issues/9763","id":319821103,"node_id":"MDU6SXNzdWUzMTk4MjExMDM=","number":9763,"title":"vagrant debian guest stuck after setting hostname","user":{"login":"asoki","id":1533751,"node_id":"MDQ6VXNlcjE1MzM3NTE=","avatar_url":"https://avatars.githubusercontent.com/u/1533751?v=4","gravatar_id":"","url":"https://api.github.com/users/asoki","html_url":"https://github.com/asoki","followers_url":"https://api.github.com/users/asoki/followers","following_url":"https://api.github.com/users/asoki/following{/other_user}","gists_url":"https://api.github.com/users/asoki/gists{/gist_id}","starred_url":"https://api.github.com/users/asoki/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/asoki/subscriptions","organizations_url":"https://api.github.com/users/asoki/orgs","repos_url":"https://api.github.com/users/asoki/repos","events_url":"https://api.github.com/users/asoki/events{/privacy}","received_events_url":"https://api.github.com/users/asoki/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":25816,"node_id":"MDU6TGFiZWwyNTgxNg==","url":"https://api.github.com/repos/hashicorp/vagrant/labels/bug","name":"bug","color":"e11d21","default":true,"description":null},{"id":157557761,"node_id":"MDU6TGFiZWwxNTc1NTc3NjE=","url":"https://api.github.com/repos/hashicorp/vagrant/labels/guest/debian","name":"guest/debian","color":"5319e7","default":false,"description":null},{"id":283683436,"node_id":"MDU6TGFiZWwyODM2ODM0MzY=","url":"https://api.github.com/repos/hashicorp/vagrant/labels/has-pr","name":"has-pr","color":"fef2c0","default":false,"description":null},{"id":425128607,"node_id":"MDU6TGFiZWw0MjUxMjg2MDc=","url":"https://api.github.com/repos/hashicorp/vagrant/labels/networking","name":"networking","color":"0e8a16","default":false,"description":null}],"state":"closed","locked":true,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/hashicorp/vagrant/milestones/35","html_url":"https://github.com/hashicorp/vagrant/milestone/35","labels_url":"https://api.github.com/repos/hashicorp/vagrant/milestones/35/labels","id":3326171,"node_id":"MDk6TWlsZXN0b25lMzMyNjE3MQ==","number":35,"title":"2.2","description":"","creator":{"login":"gildegoma","id":434654,"node_id":"MDQ6VXNlcjQzNDY1NA==","avatar_url":"https://avatars.githubusercontent.com/u/434654?v=4","gravatar_id":"","url":"https://api.github.com/users/gildegoma","html_url":"https://github.com/gildegoma","followers_url":"https://api.github.com/users/gildegoma/followers","following_url":"https://api.github.com/users/gildegoma/following{/other_user}","gists_url":"https://api.github.com/users/gildegoma/gists{/gist_id}","starred_url":"https://api.github.com/users/gildegoma/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gildegoma/subscriptions","organizations_url":"https://api.github.com/users/gildegoma/orgs","repos_url":"https://api.github.com/users/gildegoma/repos","events_url":"https://api.github.com/users/gildegoma/events{/privacy}","received_events_url":"https://api.github.com/users/gildegoma/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":61,"closed_issues":58,"state":"closed","created_at":"2018-05-07T16:19:16Z","updated_at":"2023-12-12T11:43:26Z","due_on":null,"closed_at":"2022-08-22T14:35:13Z"},"comments":24,"created_at":"2018-05-03T08:00:36Z","updated_at":"2020-03-29T02:08:03Z","closed_at":"2018-10-18T15:57:36Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Vagrant version\r\nVagrant 2.0.4 (2.0.3, 2.1.0)\r\nvagrant-vmware-fusion (5.0.4)\r\n\r\n\r\n### Host operating system\r\nmacOS 10.13.4 (17E199)\r\nrunning VMWare Fusion Professional Version 10.1.1 (7520154)\r\n\r\n### Guest operating system\r\ndebian wheezy\r\n\r\n### Vagrantfile\r\n```ruby\r\nVagrant.configure(2) do |config|\r\n  config.vm.define 'foodev' do |foo_config|\r\n    foo_config.vm.box = 'foo'\r\n    foo_config.vm.box_url = 'file:///redacted-path/debian-7.7-64bit.box'\r\n    foo_config.vm.host_name = 'foodev'\r\n    foo_config.vm.network \"private_network\", ip: \"192.168.116.80\"\r\n    foo_config.vm.synced_folder \"./\",\"/foo-server/foo-code/foo-trunk\", id:\"foodev-code-sync\", type:\"nfs\", mount_options: [\"actimeo=2\"]\r\n    foo_config.vm.provision \"shell\", path: \"vagrant_config/foodev_provisioner.sh\"\r\n    #foo_config.ssh.insert_key = false\r\n    foo_config.ssh.private_key_path=\"~/.vagrant_pk/vagrant.foo.redacted.tld_id_rsa\"\r\n    foo_config.vm.provider \"vmware_fusion\" do |v|\r\n      v.vmx['displayname'] = 'foo-Trunk foo (Linux)'\r\n      v.vmx[\"memsize\"] = \"8192\"\r\n      v.vmx[\"numvcpus\"] = \"4\"\r\n      v.gui = true\r\n    end\r\n  end\r\nend\r\n```\r\n\r\n### Debug output\r\n[https://gist.github.com/asoki/c2d95a3fb243a4bb3d6cb149c62758cc#file-vagrant-debug-log](https://gist.github.com/asoki/c2d95a3fb243a4bb3d6cb149c62758cc#file-vagrant-debug-log)\r\n\r\n\r\n### Expected behavior\r\nthe machine should boot\r\n\r\n### Actual behavior\r\nVagrant get stuck after setting the hostname. (btw, this machine did booted yesterday without any problems and was shut down with vagrant halt)\r\nInspecting the booted machine reveals, that none of the both network interfaces has an ip.\r\nThe last log entry in the syslog is:\r\n```\r\nMay  3 08:55:57 foodev acpid: waiting for events: event logging is off\r\nMay  3 08:55:57 foodev dhclient: DHCPREQUEST on eth0 to 255.255.255.255 port 67\r\nMay  3 08:55:57 foodev dhclient: DHCPOFFER from 192.168.116.254\r\nMay  3 08:55:57 foodev dhclient: DHCPACK from 192.168.116.254\r\nMay  3 08:55:57 foodev dhclient: bound to 192.168.116.181 -- renewal in 701 seconds.\r\nMay  3 08:55:57 foodev kernel: [    7.820405] NET: Registered protocol family 39\r\nMay  3 08:55:57 foodev ManagementAgentHost[2912]: Initializing ManagementAgentHost\r\nMay  3 08:56:01 foodev dhclient: DHCPRELEASE on eth0 to 192.168.116.254 port 67\r\nMay  3 08:56:01 foodev dhclient: DHCPRELEASE on eth1 to 192.168.116.254 port 67\r\nMay  3 08:56:01 foodev dhclient: No broadcast interfaces found - exiting.\r\nMay  3 08:56:07 foodev kernel: [   17.167601] eth0: no IPv6 routers present\r\nMay  3 08:56:07 foodev kernel: [   17.303035] eth1: no IPv6 routers present\r\nMay  3 09:07:38 foodev dhclient: DHCPREQUEST on eth0 to 192.168.116.254 port 67\r\nMay  3 09:07:38 foodev dhclient: send_packet: Network is unreachable\r\nMay  3 09:07:38 foodev dhclient: send_packet: please consult README file regarding broadcast address.\r\nMay  3 09:07:42 foodev dhclient: DHCPREQUEST on eth0 to 192.168.116.254 port 67\r\nMay  3 09:07:42 foodev dhclient: send_packet: Network is unreachable\r\nMay  3 09:07:42 foodev dhclient: send_packet: please consult README file regarding broadcast address.\r\nMay  3 09:07:53 foodev dhclient: DHCPREQUEST on eth0 to 192.168.116.254 port 67\r\nMay  3 09:07:53 foodev dhclient: send_packet: Network is unreachable\r\n...\r\n```\r\n\r\ncat /etc/network/interfaces:\r\n```\r\n# This file describes the network interfaces available on your system\r\n# and how to activate them. For more information, see interfaces(5).\r\n\r\n# The loopback network interface\r\nauto lo\r\niface lo inet loopback\r\n\r\n# The primary network interface\r\nallow-hotplug eth0\r\niface eth0 inet dhcp\r\n#VAGRANT-BEGIN\r\n# The contents below are automatically generated by Vagrant. Do not modify.\r\nauto eth1\r\niface eth1 inet static\r\n      address 192.168.116.80\r\n      netmask 255.255.255.0\r\n#VAGRANT-END\r\n```\r\nexecuting the following three commands on the console, while vagrant is stuck and writing:\r\n```\r\nDEBUG ssh: stderr: 41e57d38-b4f7-4e46-9c38-13873d338b86-vagrant-ssh\r\nDEBUG ssh: Sending SSH keep-alive...\r\n```\r\nbrings the machine up after 10-30 seconds:\r\n```\r\nsudo ifdown eth0\r\nsudo ifup eth0\r\nsudo /etc/init.d/ssh restart\r\n```\r\n(eth0 gets immediately a new ip after ifup)\r\n\r\nthe debug protocol of the manually fixed run is here:\r\n[https://gist.github.com/asoki/ea953f25df939bf2825c6b9dad5012f8#file-vagrant-debug-manually-fixed-log](https://gist.github.com/asoki/ea953f25df939bf2825c6b9dad5012f8#file-vagrant-debug-manually-fixed-log)\r\n\r\n### Steps to reproduce\r\n1. vagrant up foodev\r\n\r\n### References\r\n- GH-1974\r\n","closed_by":{"login":"briancain","id":810277,"node_id":"MDQ6VXNlcjgxMDI3Nw==","avatar_url":"https://avatars.githubusercontent.com/u/810277?v=4","gravatar_id":"","url":"https://api.github.com/users/briancain","html_url":"https://github.com/briancain","followers_url":"https://api.github.com/users/briancain/followers","following_url":"https://api.github.com/users/briancain/following{/other_user}","gists_url":"https://api.github.com/users/briancain/gists{/gist_id}","starred_url":"https://api.github.com/users/briancain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/briancain/subscriptions","organizations_url":"https://api.github.com/users/briancain/orgs","repos_url":"https://api.github.com/users/briancain/repos","events_url":"https://api.github.com/users/briancain/events{/privacy}","received_events_url":"https://api.github.com/users/briancain/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/hashicorp/vagrant/issues/9763/reactions","total_count":3,"+1":3,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/hashicorp/vagrant/issues/9763/timeline","performed_via_github_app":null,"state_reason":"completed"}