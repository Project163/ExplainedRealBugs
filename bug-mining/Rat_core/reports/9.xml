<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:23:53 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[RAT-81] MalformedInputException thrown when RAT tries reading file</title>
                <link>https://issues.apache.org/jira/browse/RAT-81</link>
                <project id="12310750" key="RAT">Apache RAT</project>
                    <description>&lt;p&gt;To reproduce, set the platform default locale to something that indicates UTF-8 file encoding.&lt;br/&gt;
This causes code in (for example) org.apache.rat.document.impl.FileDocument which return FileReader to set up RAT to use a reader which is using the platform default character encoding (in this case UTF-8).&lt;/p&gt;

&lt;p&gt;If the file being processed is not encoded in this , it is possible that the reader will read some data which is &quot;invalid&quot; UTF-8 encodings, which causes the reader to throw a MalformedInputException error.&lt;/p&gt;

&lt;p&gt;One case we found:&lt;/p&gt;

&lt;p&gt;The file being examined had invalid UTF-8 encodings.  First, Rat ran the BinaryGuesser - but that returned false because it attempted to read the first 100 or so chars, and got a &quot;MalformedInputException&quot; instead, so the try/catch block just ended up returning &quot;false&quot; (not binary).  Then the HeaderChecker tried to read the file to check the header, and got this same exception - but this time, it made RAT fail.&lt;/p&gt;

&lt;p&gt;Here&apos;s the last part of the stack trace:&lt;/p&gt;

&lt;p&gt;Caused by: org.apache.rat.report.RatReportFailedException: Analysis failed&lt;br/&gt;
    at org.apache.rat.report.xml.XmlReport.report(XmlReport.java:66)&lt;br/&gt;
    at org.apache.rat.mp.FilesReportable.run(FilesReportable.java:69)&lt;br/&gt;
    at org.apache.rat.Report.report(Report.java:292)&lt;br/&gt;
    at org.apache.rat.Report.report(Report.java:272)&lt;br/&gt;
    at org.apache.rat.mp.AbstractRatMojo.createReport(AbstractRatMojo.java:341)&lt;br/&gt;
    ... 23 more&lt;br/&gt;
Caused by: org.apache.rat.document.RatDocumentAnalysisException: Cannot analyse header&lt;br/&gt;
    at org.apache.rat.report.analyser.DocumentHeaderAnalyser.analyse(DocumentHeaderAnalyser.java:54)&lt;br/&gt;
    at org.apache.rat.document.impl.util.DocumentAnalyserMultiplexer.analyse(DocumentAnalyserMultiplexer.java:37)&lt;br/&gt;
    at org.apache.rat.document.impl.util.ConditionalAnalyser.matches(ConditionalAnalyser.java:44)&lt;br/&gt;
    at org.apache.rat.document.impl.util.ConditionalAnalyser.analyse(ConditionalAnalyser.java:50)&lt;br/&gt;
    at org.apache.rat.report.xml.XmlReport.report(XmlReport.java:64)&lt;br/&gt;
    ... 27 more&lt;br/&gt;
Caused by: org.apache.rat.analysis.RatHeaderAnalysisException: Cannot read header for /home/tgoetz/tmp/uimaj-2.3.1/uimaj-core/src/test/resources/pearTests/encodingTests/UTF16_with_signature.xml&lt;br/&gt;
    at org.apache.rat.report.analyser.HeaderCheckWorker.read(HeaderCheckWorker.java:96)&lt;br/&gt;
    at org.apache.rat.report.analyser.DocumentHeaderAnalyser.analyse(DocumentHeaderAnalyser.java:50)&lt;br/&gt;
    ... 31 more&lt;br/&gt;
Caused by: sun.io.MalformedInputException&lt;br/&gt;
    at sun.io.ByteToCharUTF8.convert(ByteToCharUTF8.java:294)&lt;br/&gt;
    at sun.nio.cs.StreamDecoder$ConverterSD.convertInto(StreamDecoder.java:316)&lt;br/&gt;
    at sun.nio.cs.StreamDecoder$ConverterSD.implRead(StreamDecoder.java:366)&lt;br/&gt;
    at sun.nio.cs.StreamDecoder.read(StreamDecoder.java:252)&lt;br/&gt;
    at java.io.InputStreamReader.read(InputStreamReader.java:212)&lt;br/&gt;
    at java.io.BufferedReader.fill(BufferedReader.java:157)&lt;br/&gt;
    at java.io.BufferedReader.readLine(BufferedReader.java:320)&lt;br/&gt;
    at java.io.BufferedReader.readLine(BufferedReader.java:383)&lt;br/&gt;
    at org.apache.rat.report.analyser.HeaderCheckWorker.readLine(HeaderCheckWorker.java:111)&lt;br/&gt;
    at org.apache.rat.report.analyser.HeaderCheckWorker.read(HeaderCheckWorker.java:89)&lt;br/&gt;
    ... 32 more &lt;/p&gt;

&lt;p&gt;Work-around: mark these files for explicit exclusion.&lt;/p&gt;

&lt;p&gt;Fix: change the binaryguesser to read the files in binary (not assuming any character coding) and operate with that data.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Linux (Ubuntu) on x86, running with &quot;default&quot; file encoding set to UTF-8&lt;/p&gt;</environment>
        <key id="12492906">RAT-81</key>
            <summary>MalformedInputException thrown when RAT tries reading file</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="claude">Claude Warren</assignee>
                                    <reporter username="schor">Marshall Schor</reporter>
                        <labels>
                    </labels>
                <created>Fri, 10 Dec 2010 03:44:12 +0000</created>
                <updated>Thu, 9 Oct 2025 10:29:40 +0000</updated>
                            <resolved>Mon, 18 Nov 2024 17:22:37 +0000</resolved>
                                    <version>0.6</version>
                    <version>0.7</version>
                    <version>0.11</version>
                                    <fixVersion>0.17</fixVersion>
                                    <component>core engine</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                                                            <comments>
                            <comment id="13065883" author="bodewig" created="Fri, 15 Jul 2011 12:14:48 +0000"  >&lt;p&gt;I think it depends on the java VM as well, I don&apos;t seem to get the MalformedInputException on my Ubuntu box using OpenJDK6.&lt;/p&gt;

&lt;p&gt;svn revision 1147110 contains an attempt at a testcase but it cannot assert anything since the precondition (there is a MIE) is never true for me.&lt;/p&gt;

&lt;p&gt;I think I know how to fix the problem using NIO but so far am reluctant as I don&apos;t have a good way to regression test it.&lt;/p&gt;
</comment>
                            <comment id="13066586" author="bodewig" created="Sun, 17 Jul 2011 05:07:19 +0000"  >&lt;p&gt;svn revision 1147525 now contains the NIO based code which I think should mark the files as binary for you.  It would be good if you could verify for me whether RAT&apos;s trunk behaves as desired now.&lt;/p&gt;</comment>
                            <comment id="13071547" author="bodewig" created="Wed, 27 Jul 2011 06:26:06 +0000"  >&lt;p&gt;Let&apos;s be optimistic and assume it is fixed, please reopen if the problem pops up again once 0.8 has been released.&lt;/p&gt;</comment>
                            <comment id="14135412" author="sebb@apache.org" created="Tue, 16 Sep 2014 13:25:14 +0000"  >&lt;p&gt;It does not seem right to me to mark XML files with invalid contents as binary.&lt;br/&gt;
Binary implies that the file does not need a license, but that is not the case.&lt;/p&gt;

&lt;p&gt;Such files should still have a valid license (unless excluded), so RAT should report the file as unreadable or similar.&lt;/p&gt;</comment>
                            <comment id="14135430" author="sebb@apache.org" created="Tue, 16 Sep 2014 13:37:06 +0000"  >&lt;p&gt;Also I&apos;m not sure that the test files do have any errors in them&lt;/p&gt;</comment>
                            <comment id="17898881" author="claudenw" created="Sat, 16 Nov 2024 14:21:42 +0000"  >&lt;p&gt;I duplicated the issue in an integration test in V0.17 and applied a fix.&#160; We now properly detect the encoding (in most cases) and will read the file with the proper encoding so they are not detected as binary and are not marked as not having a license provided we can get the encoding and they have a valid license in them.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Fix in in PR #395&lt;/p&gt;</comment>
                            <comment id="17899203" author="jira-bot" created="Mon, 18 Nov 2024 17:21:08 +0000"  >&lt;p&gt;Commit 0a9559e1d8726ba16c933ec560f7e5d42400360e in creadur-rat&apos;s branch refs/heads/master from Claude Warren&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=creadur-rat.git;h=0a9559e1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=creadur-rat.git;h=0a9559e1&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/RAT-81&quot; title=&quot;MalformedInputException thrown when RAT tries reading file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;RAT-81&quot;&gt;&lt;del&gt;RAT-81&lt;/del&gt;&lt;/a&gt;: Fixed encoding issue causing text files to not be read properly (#395)&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Fixed encoding issue where text files not in UTF-8 encoding would not be properly.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Change adds charset to the metadata when it can be discovered.  If not UTF8 is returned.&lt;/p&gt;

&lt;p&gt;Added integration test &lt;a href=&quot;https://issues.apache.org/jira/browse/RAT-81&quot; title=&quot;MalformedInputException thrown when RAT tries reading file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;RAT-81&quot;&gt;&lt;del&gt;RAT-81&lt;/del&gt;&lt;/a&gt; to show reading of UTF8 and IBM037 encoding works.&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Minor fixes&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/RAT-81&quot; title=&quot;MalformedInputException thrown when RAT tries reading file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;RAT-81&quot;&gt;&lt;del&gt;RAT-81&lt;/del&gt;&lt;/a&gt;: Add changelog about encoding bugfix&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;added logging and removed dead code&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;fix for &lt;a href=&quot;https://issues.apache.org/jira/browse/RAT-96&quot; title=&quot;Check source files for unexpected encodings&quot; class=&quot;issue-link&quot; data-issue-key=&quot;RAT-96&quot;&gt;&lt;del&gt;RAT-96&lt;/del&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Added mediaType and encoding attributes to XML output.&lt;br/&gt;
Added updated DefaultAnalyserFactoryTests to account for change&lt;br/&gt;
Added integration tests for &lt;a href=&quot;https://issues.apache.org/jira/browse/RAT-147&quot; title=&quot;binary guesser design improvement&quot; class=&quot;issue-link&quot; data-issue-key=&quot;RAT-147&quot;&gt;&lt;del&gt;RAT-147&lt;/del&gt;&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/browse/RAT-211&quot; title=&quot;Generated rat-output.xml must be well-formed, even if BinaryGuesser fails&quot; class=&quot;issue-link&quot; data-issue-key=&quot;RAT-211&quot;&gt;&lt;del&gt;RAT-211&lt;/del&gt;&lt;/a&gt; based on code in DefaultAnalyserFactoryTests&lt;br/&gt;
Updated ReportTest to add dependencies and package jar to classpath for test.&lt;br/&gt;
Fixed testing issues in Ant unit caused by addition of mediatype and attributes.&lt;br/&gt;
renamed reportTest directories to use a &apos;_&apos; rather than a &apos;-&apos; to account for java package names.&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/RAT-81&quot; title=&quot;MalformedInputException thrown when RAT tries reading file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;RAT-81&quot;&gt;&lt;del&gt;RAT-81&lt;/del&gt;&lt;/a&gt;: groovify the test code, minor fixes&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/RAT-81&quot; title=&quot;MalformedInputException thrown when RAT tries reading file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;RAT-81&quot;&gt;&lt;del&gt;RAT-81&lt;/del&gt;&lt;/a&gt;: Add mediaType and encoding to RAT report, minor fixes&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;---------&lt;/p&gt;

&lt;p&gt;Co-authored-by: P. Ottlinger &amp;lt;pottlinger@apache.org&amp;gt;&lt;br/&gt;
Co-authored-by: P. Ottlinger &amp;lt;ottlinger@users.noreply.github.com&amp;gt;&lt;/p&gt;</comment>
                            <comment id="17899208" author="claudenw" created="Mon, 18 Nov 2024 17:22:37 +0000"  >&lt;p&gt;fixed in PR 395&lt;/p&gt;</comment>
                            <comment id="17900639" author="jira-bot" created="Sat, 23 Nov 2024 20:13:25 +0000"  >&lt;p&gt;Commit 0a9559e1d8726ba16c933ec560f7e5d42400360e in creadur-rat&apos;s branch refs/heads/feature/&lt;a href=&quot;https://issues.apache.org/jira/browse/RAT-397&quot; title=&quot;Migrate webpage to newer site-plugin/compatible skins&quot; class=&quot;issue-link&quot; data-issue-key=&quot;RAT-397&quot;&gt;&lt;del&gt;RAT-397&lt;/del&gt;&lt;/a&gt; from Claude Warren&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=creadur-rat.git;h=0a9559e1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=creadur-rat.git;h=0a9559e1&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/RAT-81&quot; title=&quot;MalformedInputException thrown when RAT tries reading file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;RAT-81&quot;&gt;&lt;del&gt;RAT-81&lt;/del&gt;&lt;/a&gt;: Fixed encoding issue causing text files to not be read properly (#395)&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Fixed encoding issue where text files not in UTF-8 encoding would not be properly.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Change adds charset to the metadata when it can be discovered.  If not UTF8 is returned.&lt;/p&gt;

&lt;p&gt;Added integration test &lt;a href=&quot;https://issues.apache.org/jira/browse/RAT-81&quot; title=&quot;MalformedInputException thrown when RAT tries reading file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;RAT-81&quot;&gt;&lt;del&gt;RAT-81&lt;/del&gt;&lt;/a&gt; to show reading of UTF8 and IBM037 encoding works.&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Minor fixes&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/RAT-81&quot; title=&quot;MalformedInputException thrown when RAT tries reading file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;RAT-81&quot;&gt;&lt;del&gt;RAT-81&lt;/del&gt;&lt;/a&gt;: Add changelog about encoding bugfix&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;added logging and removed dead code&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;fix for &lt;a href=&quot;https://issues.apache.org/jira/browse/RAT-96&quot; title=&quot;Check source files for unexpected encodings&quot; class=&quot;issue-link&quot; data-issue-key=&quot;RAT-96&quot;&gt;&lt;del&gt;RAT-96&lt;/del&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Added mediaType and encoding attributes to XML output.&lt;br/&gt;
Added updated DefaultAnalyserFactoryTests to account for change&lt;br/&gt;
Added integration tests for &lt;a href=&quot;https://issues.apache.org/jira/browse/RAT-147&quot; title=&quot;binary guesser design improvement&quot; class=&quot;issue-link&quot; data-issue-key=&quot;RAT-147&quot;&gt;&lt;del&gt;RAT-147&lt;/del&gt;&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/browse/RAT-211&quot; title=&quot;Generated rat-output.xml must be well-formed, even if BinaryGuesser fails&quot; class=&quot;issue-link&quot; data-issue-key=&quot;RAT-211&quot;&gt;&lt;del&gt;RAT-211&lt;/del&gt;&lt;/a&gt; based on code in DefaultAnalyserFactoryTests&lt;br/&gt;
Updated ReportTest to add dependencies and package jar to classpath for test.&lt;br/&gt;
Fixed testing issues in Ant unit caused by addition of mediatype and attributes.&lt;br/&gt;
renamed reportTest directories to use a &apos;_&apos; rather than a &apos;-&apos; to account for java package names.&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/RAT-81&quot; title=&quot;MalformedInputException thrown when RAT tries reading file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;RAT-81&quot;&gt;&lt;del&gt;RAT-81&lt;/del&gt;&lt;/a&gt;: groovify the test code, minor fixes&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/RAT-81&quot; title=&quot;MalformedInputException thrown when RAT tries reading file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;RAT-81&quot;&gt;&lt;del&gt;RAT-81&lt;/del&gt;&lt;/a&gt;: Add mediaType and encoding to RAT report, minor fixes&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;---------&lt;/p&gt;

&lt;p&gt;Co-authored-by: P. Ottlinger &amp;lt;pottlinger@apache.org&amp;gt;&lt;br/&gt;
Co-authored-by: P. Ottlinger &amp;lt;ottlinger@users.noreply.github.com&amp;gt;&lt;/p&gt;</comment>
                            <comment id="18028669" author="hugo.hirsch" created="Thu, 9 Oct 2025 10:29:40 +0000"  >&lt;p&gt;Prepare for release of 0.17 and close resolved issues properly.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12730700">SAMZA-357</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                            <subtask id="12518823">RAT-96</subtask>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>66820</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0zpj3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>206438</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>