<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:23:59 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[RAT-138] RAT runs very slowly on some input</title>
                <link>https://issues.apache.org/jira/browse/RAT-138</link>
                <project id="12310750" key="RAT">Apache RAT</project>
                    <description>&lt;p&gt;Commons IO discovered that mvn site was spending a lot of time running RAT 0.9. Reverting to 0.8 fixes the problem.&lt;br/&gt;
Turns out that certain files seem to cause RAT to chew CPU in the Pattern.matcher; here is a sample stack trace from a thread dump:&lt;/p&gt;

&lt;p&gt;&quot;main&quot; prio=6 tid=0x003c8c00 nid=0xa4c runnable &lt;span class=&quot;error&quot;&gt;&amp;#91;0x00a5e000&amp;#93;&lt;/span&gt;&lt;br/&gt;
   java.lang.Thread.State: RUNNABLE&lt;br/&gt;
        at java.util.regex.Pattern$Curly.match0(Pattern.java:4166)&lt;br/&gt;
        at java.util.regex.Pattern$Curly.match(Pattern.java:4132)&lt;br/&gt;
        at java.util.regex.Matcher.match(Matcher.java:1221)&lt;br/&gt;
        at java.util.regex.Matcher.matches(Matcher.java:559)&lt;br/&gt;
        at org.apache.rat.analysis.license.FullTextMatchingLicense.match(FullTextMatchingLicense.java:79)&lt;br/&gt;
        at org.apache.rat.analysis.util.HeaderMatcherMultiplexer.match(HeaderMatcherMultiplexer.java:42)&lt;br/&gt;
        at org.apache.rat.analysis.HeaderCheckWorker.readLine(HeaderCheckWorker.java:113)&lt;br/&gt;
        at org.apache.rat.analysis.HeaderCheckWorker.read(HeaderCheckWorker.java:84)&lt;br/&gt;
        at org.apache.rat.analysis.DocumentHeaderAnalyser.analyse(DocumentHeaderAnalyser.java:43)&lt;br/&gt;
        at org.apache.rat.analysis.DefaultAnalyserFactory$DefaultAnalyser.analyse(DefaultAnalyserFactory.java:60)&lt;br/&gt;
        at org.apache.rat.document.impl.util.DocumentAnalyserMultiplexer.analyse(DocumentAnalyserMultiplexer.java:37)&lt;br/&gt;
        at org.apache.rat.report.claim.util.ClaimReporterMultiplexer.report(ClaimReporterMultiplexer.java:42)&lt;br/&gt;
        at org.apache.rat.mp.FilesReportable.run(FilesReportable.java:68)&lt;br/&gt;
        at org.apache.rat.Report.report(Report.java:393)&lt;br/&gt;
        at org.apache.rat.Report.report(Report.java:373)&lt;br/&gt;
        at org.apache.rat.mp.AbstractRatMojo.createReport(AbstractRatMojo.java:462)&lt;br/&gt;
        at org.apache.rat.mp.RatReportMojo.createReport(RatReportMojo.java:148)&lt;br/&gt;
        at org.apache.rat.mp.RatReportMojo.generate(RatReportMojo.java:310)&lt;br/&gt;
        at org.apache.rat.mp.RatReportMojo.execute(RatReportMojo.java:210)&lt;/p&gt;

&lt;p&gt;I assume there must be a problem with one of the REs which is triggering lots of backtracking when applied to files under site-content/, which is a working copy of:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://svn.apache.org/repos/infra/websites/production/commons/content/proper/commons-io&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/repos/infra/websites/production/commons/content/proper/commons-io&lt;/a&gt;&lt;br/&gt;
Last Changed Rev: 861378&lt;/p&gt;

&lt;p&gt;This directory should not have been included in the RAT scan, but the files don&apos;t cause problems for RAT 0.8.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12647655">RAT-138</key>
            <summary>RAT runs very slowly on some input</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="sebb">Sebb</reporter>
                        <labels>
                            <label>perfomance</label>
                            <label>regression</label>
                    </labels>
                <created>Wed, 15 May 2013 01:27:58 +0000</created>
                <updated>Tue, 9 Jun 2015 10:23:41 +0000</updated>
                            <resolved>Sun, 19 May 2013 19:03:56 +0000</resolved>
                                    <version>0.8</version>
                    <version>0.9</version>
                                    <fixVersion>0.10</fixVersion>
                                    <component>core engine</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="13657801" author="sebb@apache.org" created="Wed, 15 May 2013 01:48:02 +0000"  >&lt;p&gt;Seems to be just the Javadocs that causes the problem.&lt;/p&gt;

&lt;p&gt;The following file (amongst others) causes the spinning to occur:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://svn.apache.org/repos/infra/websites/production/commons/content/proper/commons-io/apidocs/index-all.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/repos/infra/websites/production/commons/content/proper/commons-io/apidocs/index-all.html&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13657810" author="sebb@apache.org" created="Wed, 15 May 2013 02:16:25 +0000"  >&lt;p&gt;Looking at the code for FullTextMatchingLicense I wonder whether regexes are needed at all?&lt;/p&gt;

&lt;p&gt;Only letters and digits are kept from the pattern, so it cannot contain any RE meta-characters.&lt;/p&gt;

&lt;p&gt;AFAICT, one could just convert the pattern and text to lower case and then use String.contains() which is going to be much faster.&lt;/p&gt;</comment>
                            <comment id="13657822" author="sebb@apache.org" created="Wed, 15 May 2013 02:39:21 +0000"  >&lt;p&gt;Looks like GeneratedLicenseNotRequired does not need to use regexes either - it does not even use case-insensitive matching.&lt;/p&gt;</comment>
                            <comment id="13660995" author="sebb@apache.org" created="Fri, 17 May 2013 20:02:10 +0000"  >&lt;p&gt;Seems the problem is related to the length of the file being read, if the file does not contain a matching string it has to be read to the end.&lt;br/&gt;
Javadocs are generally long and don&apos;t contain matching strings.&lt;br/&gt;
Not yet clear why 0.8 did not suffer from this problem.&lt;/p&gt;
</comment>
                            <comment id="13661069" author="sebb@apache.org" created="Fri, 17 May 2013 21:37:13 +0000"  >&lt;p&gt;Seems it is mainly the extra matchers that are being run; 0.9 additionally runs:&lt;/p&gt;

&lt;p&gt;GPL1License&lt;br/&gt;
GPL2License&lt;br/&gt;
GPL3License&lt;br/&gt;
MITLicense&lt;/p&gt;

&lt;p&gt;These are all FullTextMatchers which currently use regexes unnecessarily.&lt;/p&gt;</comment>
                            <comment id="13661134" author="sebb@apache.org" created="Fri, 17 May 2013 23:05:18 +0000"  >&lt;p&gt;Actually, the issue seems to be multi-line matching.&lt;/p&gt;

&lt;p&gt;The OASIS license matcher looks for the initial copyright line, and only then tries using the full text matcher.&lt;/p&gt;

&lt;p&gt;If the copyright line is not present in a file, it&apos;s very quick to scan.&lt;br/&gt;
However, if the OASIS copyright line is present, but the rest of the license is not, then the matching is very slow, even in 0.8.&lt;/p&gt;

&lt;p&gt;It helps to use String.contains rather than regexes, but that does not entirely solve the slowness.&lt;br/&gt;
The technique used in FullTextMatchingLicense is clearly not very efficient.&lt;/p&gt;

&lt;p&gt;I think the problem is that the text buffer keeps getting bigger even if there is no chance of a match for the first part of the license, so matching gets more and more expensive. The OASIS code avoids this for valid licences, but allows the initial Copyright to be far away from the rest of the license (which is why it is slow if that is missing)&lt;/p&gt;

&lt;p&gt;If the initial line is not immediately followed by the rest of the license, then it should be possible to restart looking for the first line. However the entire buffer cannot be discarded without first checking whether the first line has been seen again already. This is unlikely, but possible.&lt;/p&gt;</comment>
                            <comment id="13661378" author="sebb@apache.org" created="Sat, 18 May 2013 15:41:58 +0000"  >&lt;p&gt;URL: &lt;a href=&quot;http://svn.apache.org/r1484128&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/r1484128&lt;/a&gt;&lt;br/&gt;
Log:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/RAT-138&quot; title=&quot;RAT runs very slowly on some input&quot; class=&quot;issue-link&quot; data-issue-key=&quot;RAT-138&quot;&gt;&lt;del&gt;RAT-138&lt;/del&gt;&lt;/a&gt; RAT runs very slowly on some input&lt;br/&gt;
Use String matching by default rather than building patterns&lt;/p&gt;

&lt;p&gt;Modified:&lt;br/&gt;
    creadur/rat/trunk/apache-rat-core/src/main/java/org/apache/rat/analysis/generation/GeneratedLicenseNotRequired.java&lt;/p&gt;</comment>
                            <comment id="13661470" author="sebb@apache.org" created="Sun, 19 May 2013 02:27:22 +0000"  >&lt;p&gt;URL: &lt;a href=&quot;http://svn.apache.org/r1484131&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/r1484131&lt;/a&gt;&lt;br/&gt;
Log:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/RAT-138&quot; title=&quot;RAT runs very slowly on some input&quot; class=&quot;issue-link&quot; data-issue-key=&quot;RAT-138&quot;&gt;&lt;del&gt;RAT-138&lt;/del&gt;&lt;/a&gt; RAT runs very slowly on some input&lt;br/&gt;
Use String matching rather than building patterns&lt;br/&gt;
This improves performance somewhat, but is still inefficient&lt;/p&gt;</comment>
                            <comment id="13661471" author="sebb@apache.org" created="Sun, 19 May 2013 02:28:06 +0000"  >&lt;p&gt;URL: &lt;a href=&quot;http://svn.apache.org/r1484209&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/r1484209&lt;/a&gt;&lt;br/&gt;
Log:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/RAT-138&quot; title=&quot;RAT runs very slowly on some input&quot; class=&quot;issue-link&quot; data-issue-key=&quot;RAT-138&quot;&gt;&lt;del&gt;RAT-138&lt;/del&gt;&lt;/a&gt; RAT runs very slowly on some input&lt;br/&gt;
Ensure buffer only grows sufficiently large to allow a match&lt;br/&gt;
Speeds up processing considerably&lt;/p&gt;

&lt;p&gt;Modified:&lt;br/&gt;
    creadur/rat/trunk/apache-rat-core/src/main/java/org/apache/rat/analysis/license/FullTextMatchingLicense.java&lt;/p&gt;</comment>
                            <comment id="13661549" author="sebb@apache.org" created="Sun, 19 May 2013 12:33:20 +0000"  >&lt;p&gt;Same problem applies to AppliedApacheSoftwareLicense20.&lt;/p&gt;

&lt;p&gt;This detects the copyright header and then buffers everything until it matches the rest of the license.&lt;/p&gt;

&lt;p&gt;This could use the same approach as the FullText case.&lt;/p&gt;</comment>
                            <comment id="13661626" author="sebb@apache.org" created="Sun, 19 May 2013 19:03:56 +0000"  >&lt;p&gt;Hopefully that&apos;s the last such class with problems:&lt;/p&gt;

&lt;p&gt;URL: &lt;a href=&quot;http://svn.apache.org/r1484335&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/r1484335&lt;/a&gt;&lt;br/&gt;
Log:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/RAT-138&quot; title=&quot;RAT runs very slowly on some input&quot; class=&quot;issue-link&quot; data-issue-key=&quot;RAT-138&quot;&gt;&lt;del&gt;RAT-138&lt;/del&gt;&lt;/a&gt; RAT runs very slowly on some input&lt;br/&gt;
Fix AppliedApacheSoftwareLicense&lt;/p&gt;

&lt;p&gt;Added:&lt;br/&gt;
    creadur/rat/trunk/apache-rat-core/src/test/resources/appliedASL20/&lt;br/&gt;
    creadur/rat/trunk/apache-rat-core/src/test/resources/appliedASL20/bad/&lt;br/&gt;
    creadur/rat/trunk/apache-rat-core/src/test/resources/appliedASL20/bad/aasl20bad1.txt   (with props)&lt;br/&gt;
    creadur/rat/trunk/apache-rat-core/src/test/resources/appliedASL20/bad/aasl20bad2.txt   (with props)&lt;br/&gt;
    creadur/rat/trunk/apache-rat-core/src/test/resources/appliedASL20/good/&lt;br/&gt;
    creadur/rat/trunk/apache-rat-core/src/test/resources/appliedASL20/good/aasl20good1.txt   (with props)&lt;br/&gt;
Modified:&lt;br/&gt;
    creadur/rat/trunk/apache-rat-core/src/main/java/org/apache/rat/analysis/license/AppliedApacheSoftwareLicense20.java&lt;br/&gt;
    creadur/rat/trunk/apache-rat-core/src/test/java/org/apache/rat/analysis/license/AppliedApacheSoftwareLicense20Test.java&lt;/p&gt;</comment>
                            <comment id="14578669" author="hudson" created="Tue, 9 Jun 2015 10:23:41 +0000"  >&lt;p&gt;SUCCESS: Integrated in tobago-trunk #1386 (See &lt;a href=&quot;https://builds.apache.org/job/tobago-trunk/1386/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/tobago-trunk/1386/&lt;/a&gt;)&lt;br/&gt;
updated rat-plugin to fix slowness (see &lt;a href=&quot;https://issues.apache.org/jira/browse/RAT-138&quot; title=&quot;RAT runs very slowly on some input&quot; class=&quot;issue-link&quot; data-issue-key=&quot;RAT-138&quot;&gt;&lt;del&gt;RAT-138&lt;/del&gt;&lt;/a&gt;) (deki: &lt;a href=&quot;http://svn.apache.org/viewvc/?view=rev&amp;amp;rev=1684365&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc/?view=rev&amp;amp;rev=1684365&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/myfaces/tobago/trunk/pom.xml&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>328011</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 23 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1klef:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>328355</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>