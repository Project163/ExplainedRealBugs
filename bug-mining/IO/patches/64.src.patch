diff --git a/src/java/org/apache/commons/io/FilenameUtils.java b/src/java/org/apache/commons/io/FilenameUtils.java
index 509524bef..8cbc9ca14 100644
--- a/src/java/org/apache/commons/io/FilenameUtils.java
+++ b/src/java/org/apache/commons/io/FilenameUtils.java
@@ -1264,6 +1264,9 @@ public static boolean wildcardMatch(String filename, String wildcardMatcher, IOC
                 if (wcs[wcsIdx].equals("?")) {
                     // ? so move to next text char
                     textIdx++;
+                    if (textIdx > filename.length()) {
+                        break;
+                    }
                     anyChars = false;
                     
                 } else if (wcs[wcsIdx].equals("*")) {
diff --git a/src/test/org/apache/commons/io/FilenameUtilsWildcardTestCase.java b/src/test/org/apache/commons/io/FilenameUtilsWildcardTestCase.java
index 514c12f41..acba4c1db 100644
--- a/src/test/org/apache/commons/io/FilenameUtilsWildcardTestCase.java
+++ b/src/test/org/apache/commons/io/FilenameUtilsWildcardTestCase.java
@@ -182,6 +182,30 @@ public void testMatch2() {
         assertMatch("log.log.abc.log.abc.d", "*log?abc?d", true);
     }
 
+    /**
+     * See https://issues.apache.org/jira/browse/IO-246
+     */
+    public void test_IO_246() {
+
+        // Tests for "*?"
+        assertMatch("aaa", "*?", false);
+
+        // Tests for "?*"
+        assertMatch("",    "?*",   false);
+        assertMatch("a",   "a?*",  false);
+        assertMatch("aa",  "aa?*", false);
+        assertMatch("a",   "?*",   true);
+        assertMatch("aa",  "?*",   true);
+        assertMatch("aaa", "?*",   true);
+
+        // Test ending on "?"
+        assertMatch("",    "?", false);
+        assertMatch("a",   "a?", false);
+        assertMatch("aa",  "aa?", false);
+        assertMatch("aab", "aa?", true);
+        assertMatch("aaa", "*a", true);
+    }
+
     public void testLocaleIndependence() {
         Locale orig = Locale.getDefault();
 
