<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 18:29:45 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[IO-639] ReversedLinesFileReader does not read first line if it&apos;s empty</title>
                <link>https://issues.apache.org/jira/browse/IO-639</link>
                <project id="12310477" key="IO">Commons IO</project>
                    <description>&lt;p&gt;ReversedLinesFileReader does not seem to read the first if the the line is empty. Consider the content of a file:&lt;/p&gt;


&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
\n
test\n
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;where the first line is simple a newline character. If ReversedLinesFileReader is used to read the file in reverse, then only the 2nd line is read - in the subsequent call, &lt;tt&gt;::readLine&lt;/tt&gt; return null.&lt;/p&gt;

&lt;p&gt;Here is a Java test that was tried:&lt;/p&gt;


&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;ReversedFileReaderTest {

    @ParameterizedTest
    @MethodSource(&lt;span class=&quot;code-quote&quot;&gt;&quot;contentAndExpectedProvider&quot;&lt;/span&gt;)
    void testReadLineInReverse_givenTwoLines(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; content, List&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt; expected)
            &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException {

        File file = Files.newTemporaryFile();
        java.nio.file.Files.write(Path.of(file.getPath()), content.getBytes());

        List&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt; lines = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ArrayList&amp;lt;&amp;gt;();

        &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; (ReversedLinesFileReader fileReader = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ReversedLinesFileReader(file,
                StandardCharsets.UTF_8)) {

            &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; line;
            &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; ((line = fileReader.readLine()) != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
                lines.add(line);
            }
        }

        assertThat(lines).isEqualTo(expected);
    }

    &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; Stream&amp;lt;Arguments&amp;gt; contentAndExpectedProvider() {
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; Stream.of(
                arguments(&lt;span class=&quot;code-quote&quot;&gt;&quot;the\ntest\n&quot;&lt;/span&gt;, Arrays.asList(&lt;span class=&quot;code-quote&quot;&gt;&quot;test&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;the&quot;&lt;/span&gt;)),
                arguments(&lt;span class=&quot;code-quote&quot;&gt;&quot;\ntest\n&quot;&lt;/span&gt;, Arrays.asList(&lt;span class=&quot;code-quote&quot;&gt;&quot;test&quot;&lt;/span&gt;, &quot;&quot;)),
                arguments(&lt;span class=&quot;code-quote&quot;&gt;&quot;\n\ntest\n&quot;&lt;/span&gt;, Arrays.asList(&lt;span class=&quot;code-quote&quot;&gt;&quot;test&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;&quot;, &quot;&lt;/span&gt;&quot;)),
                arguments(&lt;span class=&quot;code-quote&quot;&gt;&quot;\n\n&quot;&lt;/span&gt;, Arrays.asList(&lt;span class=&quot;code-quote&quot;&gt;&quot;&quot;, &quot;&lt;/span&gt;&quot;)),
                arguments(&lt;span class=&quot;code-quote&quot;&gt;&quot;\n&quot;&lt;/span&gt;, Arrays.asList(&quot;&quot;))
        );
    }
}

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;


&lt;p&gt;Only the first test case runs. All the last four fails&lt;/p&gt;</description>
                <environment></environment>
        <key id="13270241">IO-639</key>
            <summary>ReversedLinesFileReader does not read first line if it&apos;s empty</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="saadlu">Mashrur Mia</reporter>
                        <labels>
                    </labels>
                <created>Sat, 23 Nov 2019 12:21:32 +0000</created>
                <updated>Sun, 6 Apr 2025 20:24:12 +0000</updated>
                                            <version>2.6</version>
                                                        <due></due>
                            <votes>1</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="17556373" author="garydgregory" created="Mon, 20 Jun 2022 13:20:00 +0000"  >&lt;p&gt;This example does not compile. It is best to provide a PR on GitHub.&lt;/p&gt;</comment>
                            <comment id="17818508" author="elharo" created="Mon, 19 Feb 2024 15:39:55 +0000"  >&lt;p&gt;I can confirm this issue. I do not yet have a fix for it. The code is too clever by half. &lt;/p&gt;</comment>
                            <comment id="17818513" author="elharo" created="Mon, 19 Feb 2024 15:46:49 +0000"  >&lt;p&gt;slightly simpler case that repros this is a file that contains a line break and nothing else:&lt;/p&gt;


&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;    @Test
    public void testLineBreakOnly() throws IOException, URISyntaxException {
        File file = File.createTempFile(&quot;foo&quot;, &quot;txt&quot;);
        Files.write(file.toPath(), &quot;\n&quot;.getBytes(StandardCharsets.ISO_8859_1));
        try (ReversedLinesFileReader reversedLinesFileReader = new ReversedLinesFileReader(file, BLOCK_SIZE,
                StandardCharsets.ISO_8859_1.name())) {
            assertEqualsAndNoLineBreaks(&quot;&quot;, reversedLinesFileReader.readLine());
        } finally {
            file.delete();
        }
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

</comment>
                            <comment id="17941381" author="garydgregory" created="Sun, 6 Apr 2025 13:46:15 +0000"  >&lt;p&gt;The current code is quite complex. I think some better building blocks would help:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;A &lt;tt&gt;ReverseInputStream&lt;/tt&gt; based on a &lt;tt&gt;RandomAccessFile&lt;/tt&gt; being the lowest building block&lt;/li&gt;
	&lt;li&gt;A &lt;tt&gt;ReverseBufferedReader&lt;/tt&gt; composing a &lt;tt&gt;ReverseInputStream&lt;/tt&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Then either:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;The current &lt;tt&gt;ReversedLinesFileReader&lt;/tt&gt; composes a &lt;tt&gt;ReverseBufferedReader&lt;/tt&gt;, or&lt;/li&gt;
	&lt;li&gt;The current &lt;tt&gt;ReversedLinesFileReader&lt;/tt&gt; to compose a &lt;tt&gt;ReverseInputStream&lt;/tt&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17941414" author="elharo" created="Sun, 6 Apr 2025 20:24:12 +0000"  >&lt;p&gt;I&apos;m not sure basing  ReverseInputStream on RandomAccessFile will work, but as long as it&apos;s a package private implementation detail, whatever works and passes the tests is fine. &lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            30 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z08xy0:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>