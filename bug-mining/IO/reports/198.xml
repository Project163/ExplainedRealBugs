<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 18:27:04 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[IO-528] Tailer.run race condition runaway logging</title>
                <link>https://issues.apache.org/jira/browse/IO-528</link>
                <project id="12310477" key="IO">Commons IO</project>
                    <description>&lt;p&gt;`Tailer.run` has a race condition that can have serious effects. &lt;/p&gt;

&lt;p&gt;The `run()` method has two while loops. The first waits till the file exists and the second loop reads lines from the file doing some file rotation checking on the way.  If the file is deleted while the second loop is in progress then the loop goes crazy logging warnings that look like this:&lt;/p&gt;

&lt;p&gt;`&lt;br/&gt;
Dec 06, 2016 1:02:18 AM com.github.davidmoten.logan.LogFile$1 fileRotated&lt;br/&gt;
INFO: file rotated&lt;br/&gt;
Dec 06, 2016 1:02:18 AM com.github.davidmoten.logan.LogFile$1 fileNotFound&lt;br/&gt;
WARNING: file not found&lt;br/&gt;
Dec 06, 2016 1:02:18 AM com.github.davidmoten.logan.LogFile$1 fileRotated&lt;br/&gt;
INFO: file rotated&lt;br/&gt;
Dec 06, 2016 1:02:18 AM com.github.davidmoten.logan.LogFile$1 fileNotFound&lt;br/&gt;
WARNING: file not found&lt;br/&gt;
Dec 06, 2016 1:02:18 AM com.github.davidmoten.logan.LogFile$1 fileRotated&lt;br/&gt;
INFO: file rotated&lt;br/&gt;
Dec 06, 2016 1:02:18 AM com.github.davidmoten.logan.LogFile$1 fileNotFound&lt;br/&gt;
WARNING: file not found&lt;br/&gt;
Dec 06, 2016 1:02:18 AM com.github.davidmoten.logan.LogFile$1 fileRotated&lt;br/&gt;
INFO: file rotated&lt;br/&gt;
Dec 06, 2016 1:02:18 AM com.github.davidmoten.logan.LogFile$1 fileNotFound&lt;br/&gt;
WARNING: file not found&lt;br/&gt;
`&lt;/p&gt;

&lt;p&gt;In our case this had serious effects. The file being tailed was deleted by another process and all available disk space was rapidly used up by the logging. This crashed a system.&lt;/p&gt;

&lt;p&gt;The fix is to put a sleep after the call to `fileNotFound()`.&lt;/p&gt;

&lt;p&gt;This problem was raised in &lt;a href=&quot;https://issues.apache.org/jira/browse/IO-398&quot; title=&quot;listener.fileRotated() will be invoked more than one time in a real rotate activity&quot; class=&quot;issue-link&quot; data-issue-key=&quot;IO-398&quot;&gt;&lt;del&gt;IO-398&lt;/del&gt;&lt;/a&gt; three years ago but no change was made to the code base.&lt;/p&gt;

&lt;p&gt;PR submitted via github repo.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13039382">IO-528</key>
            <summary>Tailer.run race condition runaway logging</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="pascalschumacher">Pascal Schumacher</assignee>
                                    <reporter username="davidmoten2">Dave Moten</reporter>
                        <labels>
                    </labels>
                <created>Wed, 1 Feb 2017 04:18:41 +0000</created>
                <updated>Fri, 20 Oct 2017 06:49:07 +0000</updated>
                            <resolved>Sun, 23 Apr 2017 09:35:21 +0000</resolved>
                                    <version>2.5</version>
                                    <fixVersion>2.6</fixVersion>
                                    <component>Utilities</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="15848000" author="githubbot" created="Wed, 1 Feb 2017 04:20:30 +0000"  >&lt;p&gt;GitHub user davidmoten opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/commons-io/pull/29&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/commons-io/pull/29&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/IO-528&quot; title=&quot;Tailer.run race condition runaway logging&quot; class=&quot;issue-link&quot; data-issue-key=&quot;IO-528&quot;&gt;&lt;del&gt;IO-528&lt;/del&gt;&lt;/a&gt; fix Tailer.run race condition runaway logging&lt;/p&gt;

&lt;p&gt;    `Tailer.run` has a race condition that can have serious effects. &lt;/p&gt;

&lt;p&gt;    The `run()` method has two while loops. The first waits till the file exists and the second loop reads lines from the file doing some file rotation checking on the way.  If the file is deleted while the second loop is in progress then the loop goes crazy logging warnings that look like this:&lt;/p&gt;

&lt;p&gt;    `&lt;br/&gt;
    Dec 06, 2016 1:02:18 AM com.github.davidmoten.logan.LogFile$1 fileRotated&lt;br/&gt;
    INFO: file rotated&lt;br/&gt;
    Dec 06, 2016 1:02:18 AM com.github.davidmoten.logan.LogFile$1 fileNotFound&lt;br/&gt;
    WARNING: file not found&lt;br/&gt;
    Dec 06, 2016 1:02:18 AM com.github.davidmoten.logan.LogFile$1 fileRotated&lt;br/&gt;
    INFO: file rotated&lt;br/&gt;
    Dec 06, 2016 1:02:18 AM com.github.davidmoten.logan.LogFile$1 fileNotFound&lt;br/&gt;
    WARNING: file not found&lt;br/&gt;
    Dec 06, 2016 1:02:18 AM com.github.davidmoten.logan.LogFile$1 fileRotated&lt;br/&gt;
    INFO: file rotated&lt;br/&gt;
    Dec 06, 2016 1:02:18 AM com.github.davidmoten.logan.LogFile$1 fileNotFound&lt;br/&gt;
    WARNING: file not found&lt;br/&gt;
    Dec 06, 2016 1:02:18 AM com.github.davidmoten.logan.LogFile$1 fileRotated&lt;br/&gt;
    INFO: file rotated&lt;br/&gt;
    Dec 06, 2016 1:02:18 AM com.github.davidmoten.logan.LogFile$1 fileNotFound&lt;br/&gt;
    WARNING: file not found&lt;br/&gt;
    `&lt;/p&gt;

&lt;p&gt;    In our case this had serious effects. The file being tailed was deleted by another process and all available disk space was rapidly used up by the logging. This crashed a system.&lt;/p&gt;

&lt;p&gt;    The fix is to put a sleep after the call to `fileNotFound()`.&lt;/p&gt;

&lt;p&gt;    I haven&apos;t made a unit test because reliably triggering this problem would involve a major refactor of the `run` method to make it testable.&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/davidmoten/commons-io&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/davidmoten/commons-io&lt;/a&gt; fix-tailer-race-condition&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/commons-io/pull/29.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/commons-io/pull/29.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #29&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit b6c13341564475f4b804ec8e46f665211236b7f7&lt;br/&gt;
Author: Dave Moten &amp;lt;davidmoten@gmail.com&amp;gt;&lt;br/&gt;
Date:   2017-02-01T03:54:00Z&lt;/p&gt;

&lt;p&gt;    fix Tailer.run race condition runaway logging&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15848001" author="davidmoten2" created="Wed, 1 Feb 2017 04:20:50 +0000"  >&lt;p&gt;Github PR: &lt;a href=&quot;https://github.com/apache/commons-io/pull/29&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/commons-io/pull/29&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15980343" author="githubbot" created="Sun, 23 Apr 2017 09:32:37 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/commons-io/pull/29&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/commons-io/pull/29&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="13057073">IO-530</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12667999">IO-398</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 29 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i39g93:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>