<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 18:27:59 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[IO-714] ReaderInputStream does not call CharsetEncoder.flush(...)</title>
                <link>https://issues.apache.org/jira/browse/IO-714</link>
                <project id="12310477" key="IO">Commons IO</project>
                    <description>&lt;p&gt;As defined by the &lt;tt&gt;CharsetEncoder&lt;/tt&gt; &lt;a href=&quot;https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/nio/charset/CharsetEncoder.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;documentation&lt;/a&gt; the &lt;em&gt;encoding operation&lt;/em&gt; consists of:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;(reset)&lt;/li&gt;
	&lt;li&gt;encode&lt;/li&gt;
	&lt;li&gt;flush&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;However, &lt;tt&gt;org.apache.commons.io.input.ReaderInputStream&lt;/tt&gt; does not call &lt;tt&gt;flush&lt;/tt&gt;. This leads to incorrect results for charsets whose &lt;tt&gt;flush&lt;/tt&gt; method appends additional bytes.&lt;/p&gt;

&lt;p&gt;Example:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-comment&quot;&gt;// Charset whose CharsetEncoder.flush(...) puts bytes
&lt;/span&gt;Charset charset = Charset.forName(&lt;span class=&quot;code-quote&quot;&gt;&quot;Cp930&quot;&lt;/span&gt;);

&lt;span class=&quot;code-comment&quot;&gt;// \u0391: Causes CharsetEncoder.flush(...) to put additional bytes
&lt;/span&gt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; s = &lt;span class=&quot;code-quote&quot;&gt;&quot;\u0391&quot;&lt;/span&gt;;

&lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt;[] expected = s.getBytes(charset);
&lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt;[] actual;
&lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; (InputStream in = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ReaderInputStream(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; StringReader(s), charset)) {
    actual = IOUtils.toByteArray(in);
}

&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!Arrays.equals(expected, actual)) {
    &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; AssertionError(&lt;span class=&quot;code-quote&quot;&gt;&quot;\n  Expected: &quot;&lt;/span&gt; + Arrays.toString(expected) + &lt;span class=&quot;code-quote&quot;&gt;&quot;\n  Actual:   &quot;&lt;/span&gt; + Arrays.toString(actual));
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Also make sure to check the result of &lt;tt&gt;flush()&lt;/tt&gt; because &lt;tt&gt;OVERFLOW&lt;/tt&gt; as result is possible. In theory &lt;tt&gt;isError() == true&lt;/tt&gt; might be possible as well, but I don&apos;t think any of charset implementations currently return that.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13356348">IO-714</key>
            <summary>ReaderInputStream does not call CharsetEncoder.flush(...)</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="Marcono1234">Marcono1234</reporter>
                        <labels>
                    </labels>
                <created>Wed, 3 Feb 2021 02:59:54 +0000</created>
                <updated>Sun, 11 Sep 2022 13:56:58 +0000</updated>
                            <resolved>Sat, 16 Oct 2021 18:49:53 +0000</resolved>
                                    <version>2.8.0</version>
                                    <fixVersion>2.12.0</fixVersion>
                                    <component>Streams/Writers</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="4800">1h 20m</timespent>
                                <comments>
                            <comment id="17285950" author="garydgregory" created="Wed, 17 Feb 2021 16:20:46 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Marcono1234&quot; class=&quot;user-hover&quot; rel=&quot;Marcono1234&quot;&gt;Marcono1234&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Thank you for your report.&lt;br/&gt;
Feel free to provide a PR on GitHub with tests &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="17291878" author="marcono1234" created="Fri, 26 Feb 2021 18:59:21 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ggregory&quot; class=&quot;user-hover&quot; rel=&quot;ggregory&quot;&gt;ggregory&lt;/a&gt;, I &lt;em&gt;might&lt;/em&gt; give it a try, though not sure how soon. Will that require me to sign the Apache CLA in case I submit the pull request on GitHub?&lt;/p&gt;</comment>
                            <comment id="17291913" author="garydgregory" created="Fri, 26 Feb 2021 20:39:50 +0000"  >&lt;p&gt;You do not need an CLA for a &quot;simple&quot; PR, but if you plan on continuing to contribute or your work is not trivial, then an CLA is best.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17292009" author="marcono1234" created="Sat, 27 Feb 2021 01:53:51 +0000"  >&lt;p&gt;What exactly is a &quot;simple&quot; PR? I am not very keen on signing the CLA; but please don&apos;t bother changing your CLA process. I had a similar situation with the Eclipse Foundation where they even simplified their CLA process, but in the end still required to (indirectly) publicly provide personal data.&lt;/p&gt;</comment>
                            <comment id="17292018" author="garydgregory" created="Sat, 27 Feb 2021 04:24:49 +0000"  >&lt;p&gt;IANAL but I see this as:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Part of the issue is on whose behalf you would be providing contributions, as an individual or as part as a job you are doing for a company.&lt;/li&gt;
	&lt;li&gt;If you care about the legal health of a project and the ASF, you&apos;d sign the appropriate paperwork.&#160;&lt;/li&gt;
	&lt;li&gt;Please read &lt;a href=&quot;http://www.apache.org/licenses/contributor-agreements.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/contributor-agreements.html&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;I am sure you noticed the use of the word &quot;desires&quot; which you should balance with any of your own desires for the health of the ASF.&lt;/li&gt;
	&lt;li&gt;So it&apos;s up to you. I don&apos;t have any stats as to how many PR contributors have a CLA on file.&lt;/li&gt;
	&lt;li&gt;WRT &quot;simple&quot;, well, that&apos;s a bit subjective but if you were to provide some clever algorithm or a &quot;large&quot; quantity of behavioral changes (as opposed to automated source change a la Eclipse clean ups) then someone would suggest that a CLA would be appropriate.&#160;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;HTH.&lt;/p&gt;</comment>
                            <comment id="17427133" author="zhigang_wang" created="Mon, 11 Oct 2021 13:40:42 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ggregory&quot; class=&quot;user-hover&quot; rel=&quot;ggregory&quot;&gt;ggregory&lt;/a&gt;&#160;Submitting a patch for the issue. Could you please take a look and let me know if need adaptation? Thanks!&lt;br/&gt;
&lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/13034791/13034791_0001-Fixed-ReaderInputStream-not-calling-CharsetEncoder.f.patch&quot; title=&quot;0001-Fixed-ReaderInputStream-not-calling-CharsetEncoder.f.patch attached to IO-714&quot;&gt;0001-Fixed-ReaderInputStream-not-calling-CharsetEncoder.f.patch&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;&lt;/p&gt;</comment>
                            <comment id="17427238" author="garydgregory" created="Mon, 11 Oct 2021 16:49:31 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=zhigang_wang&quot; class=&quot;user-hover&quot; rel=&quot;zhigang_wang&quot;&gt;zhigang_wang&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Please provide this as a PR on GitHub so we can see if all the builds pass.&lt;/p&gt;</comment>
                            <comment id="17427290" author="zhigang_wang" created="Mon, 11 Oct 2021 18:01:44 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ggregory&quot; class=&quot;user-hover&quot; rel=&quot;ggregory&quot;&gt;ggregory&lt;/a&gt;&#160;Thanks for the feedback. Here is the PR:&#160;&lt;a href=&quot;https://github.com/apache/commons-io/pull/283&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/commons-io/pull/283&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17429606" author="garydgregory" created="Sat, 16 Oct 2021 18:50:26 +0000"  >&lt;p&gt;I merged the PR is to git master. Please verify and close.&lt;/p&gt;

&lt;p&gt;G.&lt;/p&gt;</comment>
                            <comment id="17429608" author="zhigang_wang" created="Sat, 16 Oct 2021 19:17:14 +0000"  >&lt;p&gt;It looks good, thanks!&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13481017">IO-780</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="13034791" name="0001-Fixed-ReaderInputStream-not-calling-CharsetEncoder.f.patch" size="4105" author="zhigang_wang" created="Mon, 11 Oct 2021 13:40:32 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 3 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0nads:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>