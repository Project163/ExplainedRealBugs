<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 18:29:12 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[IO-818] NullInputStream breaks InputStream&apos;s read method contract</title>
                <link>https://issues.apache.org/jira/browse/IO-818</link>
                <project id="12310477" key="IO">Commons IO</project>
                    <description>&lt;p&gt;A java.io.InputStream instance&apos;s read(...) method will always return -1 after it reaches its end.&lt;/p&gt;

&lt;p&gt;&#160;&lt;br/&gt;
However, after a NullInputStream instance reaches its end, if you call its read(...) method again, you&apos;ll get IOException with message &lt;tt&gt;Read after end of file&lt;/tt&gt;. It&apos;s document says&lt;font color=&quot;#de350b&quot;&gt; the read(...) method should return -1 if the end of file has been reached and throwEofException is set to false&lt;/font&gt;. However, its code doesn&apos;t check throwEofException flag before it throws the IOException:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;public int read() throws IOException {
    if (eof) {
       throw new IOException(&quot;Read after end of file&quot;);
    }
    ....
}&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;I&apos;m not sure whether its read method should strictly follow what InputStream does, i.e., always return -1 after it reaches end, or should it check throwEofException flag before it throws an IOException.&lt;/p&gt;

&lt;p&gt;Following is a snippet that can reproduce this problem:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;import org.apache.commons.io.input.NullInputStream;

import java.io.ByteArrayInputStream;
import java.io.InputStream;

public class InputStreamTest {

    private static void testOneStream(InputStream inputStream) throws Exception {
        final byte[] buffer = new byte[4096];
        int readLen;
        while ((readLen = inputStream.read(buffer)) != -1) {
            // do nothing
        }
        readLen = inputStream.read(buffer);
        if (readLen != -1) {
            throw new Exception(&quot;Failed to read after reaching the end of the stream.&quot;);
        }
    }

    public static void main(String[] args) {
        try { // Test ByteArrayInputStream
            final InputStream byteArrayInputStream = new ByteArrayInputStream(new byte[1024]);
            testOneStream(byteArrayInputStream);
            System.out.println(&quot;ByteArrayInputStream succeeded.&quot;);
        } catch (Exception e) {
            System.out.println(&quot;ByteArrayInputStream failed&quot;);
        }
        try { //Test NullInputStream
            final InputStream nullInputStream = new NullInputStream(1024, true, false);
            testOneStream(nullInputStream);
            System.out.println(&quot;NullInputStream succeeded.&quot;);
        } catch (Exception e) {
            System.out.println(&quot;NullInputStream failed&quot;);
        }
    }
}&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment>&lt;p&gt;JDK 17.0&lt;/p&gt;

&lt;p&gt;Apache commons-io-2.13.0, but it looks like this apply to 2.15.0 too.&lt;/p&gt;</environment>
        <key id="13555860">IO-818</key>
            <summary>NullInputStream breaks InputStream&apos;s read method contract</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="liuxinx615">X Liu</reporter>
                        <labels>
                    </labels>
                <created>Fri, 27 Oct 2023 17:08:49 +0000</created>
                <updated>Wed, 27 Dec 2023 14:20:00 +0000</updated>
                            <resolved>Wed, 27 Dec 2023 14:19:34 +0000</resolved>
                                    <version>2.13.0</version>
                                    <fixVersion>2.16.0</fixVersion>
                                    <component>Streams/Writers</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="17800783" author="garydgregory" created="Wed, 27 Dec 2023 14:19:10 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=liuxinx615&quot; class=&quot;user-hover&quot; rel=&quot;liuxinx615&quot;&gt;liuxinx615&lt;/a&gt;&#160;&lt;/p&gt;

&lt;p&gt;Thank you for your report.&lt;/p&gt;

&lt;p&gt;This is fixed in git master and snapshot builds: The value of &lt;tt&gt;throwEofException&lt;/tt&gt; is now taken into account.&lt;/p&gt;

&lt;p&gt;Please verify and close this ticket if appropriate for your use case.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 45 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1l8vs:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>