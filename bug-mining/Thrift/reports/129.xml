<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 07:55:09 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[THRIFT-417] BufferedTransport can enter an infinite loop</title>
                <link>https://issues.apache.org/jira/browse/THRIFT-417</link>
                <project id="12310800" key="THRIFT">Thrift</project>
                    <description>&lt;p&gt;I&apos;m not 100% sure of the circumstances yet, but it looks like if you ask BufferedTransport to read 0 bytes, you will enter an infinite loop. This may be particularly related to using the BinaryProtocolAccelerated protocol.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12421801">THRIFT-417</key>
            <summary>BufferedTransport can enter an infinite loop</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="bryanduxbury">Bryan Duxbury</assignee>
                                    <reporter username="bryanduxbury">Bryan Duxbury</reporter>
                        <labels>
                    </labels>
                <created>Wed, 1 Apr 2009 17:42:31 +0000</created>
                <updated>Wed, 1 Apr 2009 20:10:28 +0000</updated>
                            <resolved>Wed, 1 Apr 2009 20:10:28 +0000</resolved>
                                                    <fixVersion>0.1</fixVersion>
                                    <component>Ruby - Library</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12694651" author="bryanduxbury" created="Wed, 1 Apr 2009 18:06:29 +0000"  >&lt;p&gt;Ok, I think I&apos;ve resolved the issue, at least partially. It comes down to the fact that the pure-ruby binary protocol was calling &quot;read_all&quot; on its transport, while the thrift_native version was calling &quot;read&quot;. I&apos;m still not 100% sure how this lead to an infinite loop, but hey, it was happening and now it&apos;s not. &lt;/p&gt;

&lt;p&gt;What I do know is that zero-length strings on the wire would cause BinaryProtocolAccelerated to lock up the process trying to do reads. Switching from read to read_all makes the problem go away. I should also note that FramedTransport isn&apos;t affected by this issue, and a bare Socket will throw an exception when you ask to read 0 bytes.&lt;/p&gt;

&lt;p&gt;One thing we might want to consider is evaluating the contract of our read methods. Should read(0) be a valid request? If so what should it return? It seems to me in scenarios where you might call read(0), you could just check if it&apos;s zero and skip the read. Not sure it&apos;ll make it that much cleaner, though.&lt;/p&gt;

&lt;p&gt;Anyways, this patch contains the fix to the thrift_native READ macro. It also adds 6 new test cases to the shared binary protocol specs, which required some reorganization in DebugProtoTest.thrift. Finally, there is some minor cleanup in binary_protocol_accelerated.c, removing some commented code and using the native method table for one of the methods that was mistakenly omitted. &lt;/p&gt;</comment>
                            <comment id="12694701" author="kclark" created="Wed, 1 Apr 2009 19:15:38 +0000"  >&lt;p&gt;I&apos;m getting a failure from java due to the mods on test/DebugProtoTest.thrift. Are you seeing the same thing?&lt;/p&gt;</comment>
                            <comment id="12694702" author="bryanduxbury" created="Wed, 1 Apr 2009 19:21:50 +0000"  >&lt;p&gt;Oops on the java build. This fixes that.&lt;/p&gt;</comment>
                            <comment id="12694705" author="kclark" created="Wed, 1 Apr 2009 19:26:46 +0000"  >&lt;p&gt;Looks good to me, apart from the Java error.&lt;/p&gt;

&lt;p&gt;Re: read(0). I&apos;d say it should just skip. It &lt;b&gt;could&lt;/b&gt; be an error, but more likely just a zero length string, and special casing that seems strange.&lt;/p&gt;</comment>
                            <comment id="12694711" author="bryanduxbury" created="Wed, 1 Apr 2009 20:10:28 +0000"  >&lt;p&gt;Committed.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12404370" name="thrift-417-v2.patch" size="8339" author="bryanduxbury" created="Wed, 1 Apr 2009 19:21:50 +0000"/>
                            <attachment id="12404360" name="thrift-417.patch" size="7447" author="bryanduxbury" created="Wed, 1 Apr 2009 18:06:29 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>38507</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            16 years, 34 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310041" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Patch Info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10042"><![CDATA[Patch Available]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i16f4n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>245583</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>