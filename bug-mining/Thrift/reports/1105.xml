<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 08:15:13 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[THRIFT-2817] TSimpleJSONProtocol reads beyond end of message</title>
                <link>https://issues.apache.org/jira/browse/THRIFT-2817</link>
                <project id="12310800" key="THRIFT">Thrift</project>
                    <description>&lt;p&gt;The TSimpleJSONProtocol reads beyond end of message, which prevent processing the message until more data arrives.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/thrift/pull/264&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/264&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;EDIT: New pull request here:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/thrift/pull/273&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/273&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="12755151">THRIFT-2817</key>
            <summary>TSimpleJSONProtocol reads beyond end of message</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jensg">Jens Geyer</assignee>
                                    <reporter username="cvlchinet">Chi Vinh Le</reporter>
                        <labels>
                    </labels>
                <created>Thu, 13 Nov 2014 20:25:44 +0000</created>
                <updated>Tue, 21 Apr 2015 07:06:15 +0000</updated>
                            <resolved>Tue, 18 Nov 2014 21:22:04 +0000</resolved>
                                                    <fixVersion>0.9.3</fixVersion>
                                    <component>Go - Library</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                                                            <comments>
                            <comment id="14211245" author="githubbot" created="Thu, 13 Nov 2014 20:26:57 +0000"  >&lt;p&gt;Github user cvlchinet commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/264#issuecomment-62960161&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/264#issuecomment-62960161&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Alright, working on it.&lt;/p&gt;</comment>
                            <comment id="14211421" author="githubbot" created="Thu, 13 Nov 2014 22:57:10 +0000"  >&lt;p&gt;Github user cvlchinet commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/264#issuecomment-62982101&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/264#issuecomment-62982101&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Ok I checked the options to write a test.&lt;br/&gt;
    It is quite complicated, because this bug only occurs when using real sockets.&lt;br/&gt;
    So when using a Buffer for the tests it won&apos;t work.&lt;br/&gt;
    I don&apos;t see a straightforward to write a mock either.&lt;br/&gt;
    An integration test, would catch it immediately.&lt;br/&gt;
    I see the lib has some kind of integration tests? right? &lt;br/&gt;
    I couldn&apos;t find out yet, how they work though.&lt;br/&gt;
    Is there a integration test concept?&lt;/p&gt;

</comment>
                            <comment id="14212789" author="githubbot" created="Fri, 14 Nov 2014 20:37:24 +0000"  >&lt;p&gt;Github user Jens-G commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/264#issuecomment-63125348&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/264#issuecomment-63125348&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Have a look at the `multiplexed_protocol_test.go` file for an example how to achieve that. &lt;/p&gt;</comment>
                            <comment id="14213702" author="githubbot" created="Sat, 15 Nov 2014 17:26:38 +0000"  >&lt;p&gt;Github user cvlchinet commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/264#issuecomment-63180271&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/264#issuecomment-63180271&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Any build files to create the dependencies? Or do I have to do it by hand?&lt;/p&gt;</comment>
                            <comment id="14213756" author="githubbot" created="Sat, 15 Nov 2014 20:56:23 +0000"  >&lt;p&gt;Github user Jens-G commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/264#issuecomment-63192311&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/264#issuecomment-63192311&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    The usual makefiles, or what do you mean? &lt;/p&gt;</comment>
                            <comment id="14215320" author="githubbot" created="Mon, 17 Nov 2014 22:35:33 +0000"  >&lt;p&gt;GitHub user cvlchinet opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/273&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/273&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Fixes &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-2817&quot; title=&quot;TSimpleJSONProtocol reads beyond end of message&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-2817&quot;&gt;&lt;del&gt;THRIFT-2817&lt;/del&gt;&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-2839&quot; title=&quot;TFramedTransport read bug&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-2839&quot;&gt;&lt;del&gt;THRIFT-2839&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Current implementation of json protocols uses buffer peeks extensively.&lt;br/&gt;
    But in certain situations this causes the buffer to read beyond the json message,&lt;br/&gt;
    which stalls the whole connection. (&lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-2817&quot; title=&quot;TSimpleJSONProtocol reads beyond end of message&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-2817&quot;&gt;&lt;del&gt;THRIFT-2817&lt;/del&gt;&lt;/a&gt;)&lt;/p&gt;

&lt;p&gt;    To test this fix I ported the integration tests from the nodejs thrift library to go.&lt;br/&gt;
    Those are comprehensive integration tests that tests the whole thrift stack.&lt;br/&gt;
    The tests revealed another problem in TFramedTransport.&lt;/p&gt;

&lt;p&gt;    When calling TFramedTransport.Read, it should return remaining bytes,&lt;br/&gt;
    but it doesn&apos;t when passing a []byte that is bigger than the current frame_size. (&lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-2839&quot; title=&quot;TFramedTransport read bug&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-2839&quot;&gt;&lt;del&gt;THRIFT-2839&lt;/del&gt;&lt;/a&gt;)&lt;/p&gt;

&lt;p&gt;    This PR fixes &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-2817&quot; title=&quot;TSimpleJSONProtocol reads beyond end of message&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-2817&quot;&gt;&lt;del&gt;THRIFT-2817&lt;/del&gt;&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-2839&quot; title=&quot;TFramedTransport read bug&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-2839&quot;&gt;&lt;del&gt;THRIFT-2839&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/cvlchinet/thrift&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/cvlchinet/thrift&lt;/a&gt; go-fix-json&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/273.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/273.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #273&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 550bb2d92cd7eb256a96d435cbc1f69437fe902b&lt;br/&gt;
Author: Chi Vinh Le &amp;lt;cvl@chinet.info&amp;gt;&lt;br/&gt;
Date:   2014-11-17T22:19:04Z&lt;/p&gt;

&lt;p&gt;    Smarter buffer peeking for json protocols&lt;/p&gt;

&lt;p&gt;commit 7f16c1dda2405029bf64e99312852d0740000d44&lt;br/&gt;
Author: Chi Vinh Le &amp;lt;cvl@chinet.info&amp;gt;&lt;br/&gt;
Date:   2014-11-17T22:19:42Z&lt;/p&gt;

&lt;p&gt;    Fix bug in TFramedTransport&lt;/p&gt;

&lt;p&gt;commit 7710d32ee10136365f0cbe65c28e6565298f6b60&lt;br/&gt;
Author: Chi Vinh Le &amp;lt;cvl@chinet.info&amp;gt;&lt;br/&gt;
Date:   2014-11-17T22:20:25Z&lt;/p&gt;

&lt;p&gt;    Add comprehensive integration tests for the whole stack&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="14215322" author="githubbot" created="Mon, 17 Nov 2014 22:37:28 +0000"  >&lt;p&gt;Github user cvlchinet commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/264#issuecomment-63389816&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/264#issuecomment-63389816&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    New PR.&lt;br/&gt;
    See: &lt;a href=&quot;https://github.com/apache/thrift/pull/273&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/273&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14215323" author="githubbot" created="Mon, 17 Nov 2014 22:37:35 +0000"  >&lt;p&gt;Github user cvlchinet closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/264&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/264&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14216810" author="jensg" created="Tue, 18 Nov 2014 21:22:04 +0000"  >&lt;p&gt;Committed, thanks!&lt;/p&gt;</comment>
                            <comment id="14216851" author="hudson" created="Tue, 18 Nov 2014 21:47:13 +0000"  >&lt;p&gt;SUCCESS: Integrated in Thrift #1362 (See &lt;a href=&quot;https://builds.apache.org/job/Thrift/1362/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Thrift/1362/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-2817&quot; title=&quot;TSimpleJSONProtocol reads beyond end of message&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-2817&quot;&gt;&lt;del&gt;THRIFT-2817&lt;/del&gt;&lt;/a&gt; Smarter buffer peeking for json protocols (jensg: rev 2f971e8f742fcaa0c84cfcc4f02eb844123e5819)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;lib/go/thrift/json_protocol.go&lt;/li&gt;
	&lt;li&gt;lib/go/thrift/simple_json_protocol_test.go&lt;/li&gt;
	&lt;li&gt;lib/go/thrift/simple_json_protocol.go&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14216901" author="githubbot" created="Tue, 18 Nov 2014 22:10:25 +0000"  >&lt;p&gt;Github user cvlchinet commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/273#issuecomment-63554886&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/273#issuecomment-63554886&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Commited.&lt;/p&gt;</comment>
                            <comment id="14216903" author="githubbot" created="Tue, 18 Nov 2014 22:10:26 +0000"  >&lt;p&gt;Github user cvlchinet closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/273&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/273&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14501818" author="githubbot" created="Sun, 19 Apr 2015 11:51:10 +0000"  >&lt;p&gt;Github user bivas commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/273#issuecomment-94269795&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/273#issuecomment-94269795&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    We&apos;re still experiencing read errors with this fix merged (`Not enough frame size 4085 to read 4096 bytes`)&lt;/p&gt;

&lt;p&gt;    The commit is missing a `return` statement in case of `framesize` smaller than the `buffer` and `err == nil ` looks strange&lt;/p&gt;


</comment>
                            <comment id="14501857" author="jensg" created="Sun, 19 Apr 2015 14:10:40 +0000"  >&lt;p&gt;Could you provide a PR addressing these issues? Thanks!&lt;/p&gt;</comment>
                            <comment id="14501976" author="githubbot" created="Sun, 19 Apr 2015 15:18:21 +0000"  >&lt;p&gt;Github user Jens-G commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/273#issuecomment-94287436&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/273#issuecomment-94287436&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @bivas Could you provide a PR addressing these issues? Thanks!&lt;/p&gt;</comment>
                            <comment id="14502461" author="githubbot" created="Mon, 20 Apr 2015 07:24:08 +0000"  >&lt;p&gt;Github user bivas commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/273#issuecomment-94379082&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/273#issuecomment-94379082&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @Jens-G unfortunately, no. Was pointing this out so maybe @wingedkiwi can have a quick look (and maybe a fix) on this issue.&lt;/p&gt;</comment>
                            <comment id="14504467" author="githubbot" created="Tue, 21 Apr 2015 07:06:15 +0000"  >&lt;p&gt;Github user wingedkiwi commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/273#issuecomment-94660628&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/273#issuecomment-94660628&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    I&apos;m turning my attention to thrift again in a few weeks. Then I can have a look. &lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                            <subtask id="12756207">THRIFT-2841</subtask>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 31 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i22ci7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>