<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 08:01:39 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[THRIFT-857] tests run by &quot;make install&quot; fail if generators are disabled</title>
                <link>https://issues.apache.org/jira/browse/THRIFT-857</link>
                <project id="12310800" key="THRIFT">Thrift</project>
                    <description>&lt;p&gt;configuring with generators disabled (configure --disable-gen-java, for example) produces a failed build because the tests run by &quot;make install&quot; require the java, cpp, rb, perl, csharp, and js generators.  &lt;/p&gt;

&lt;p&gt;I would personally favor either removing those --disble-gen options altogether, or adding a warning message in the configure --help output that disabling those generators is not recommended/will cause test failure.&lt;/p&gt;</description>
                <environment>&lt;p&gt;mac os&lt;/p&gt;</environment>
        <key id="12471958">THRIFT-857</key>
            <summary>tests run by &quot;make install&quot; fail if generators are disabled</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jfarrell">Jake Farrell</assignee>
                                    <reporter username="lowekamp">Bruce Lowekamp</reporter>
                        <labels>
                    </labels>
                <created>Wed, 18 Aug 2010 23:36:02 +0000</created>
                <updated>Wed, 21 Sep 2011 00:40:45 +0000</updated>
                            <resolved>Wed, 21 Sep 2011 00:15:47 +0000</resolved>
                                    <version>0.4</version>
                                    <fixVersion>0.8</fixVersion>
                                    <component>Test Suite</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="12900168" author="bryanduxbury" created="Thu, 19 Aug 2010 04:52:34 +0000"  >&lt;p&gt;I would be in favor of removing the -&lt;del&gt;disable-gen&lt;/del&gt;* options. It seems to me like there is very little benefit to offering this feature. What&apos;s even the objective, making the compiler build faster?&lt;/p&gt;

&lt;p&gt;Anyone else want to weigh in?&lt;/p&gt;</comment>
                            <comment id="12900333" author="dreiss" created="Thu, 19 Aug 2010 16:14:26 +0000"  >&lt;p&gt;&amp;gt; What&apos;s even the objective, making the compiler build faster?&lt;br/&gt;
I don&apos;t really remember.  That&apos;s certainly one benefit.  I&apos;d be fine with getting rid of it if it is causing problems, but I&apos;d rather figure out if we can get &quot;make install&quot; to work without them.&lt;/p&gt;</comment>
                            <comment id="12900354" author="lowekamp" created="Thu, 19 Aug 2010 16:52:56 +0000"  >&lt;p&gt;I submitted a &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-859&quot; title=&quot;Allow py:twisted to be generated in different namespace than py&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-859&quot;&gt;&lt;del&gt;THRIFT-859&lt;/del&gt;&lt;/a&gt; (with patch) that proposes reverting the check that caused this problem in the first place.&lt;/p&gt;

&lt;p&gt;t_program.h was revised to include (everything but the last namespace&lt;span class=&quot;error&quot;&gt;&amp;#91;language&amp;#93;&lt;/span&gt;=namespace assignment:&lt;/p&gt;


&lt;p&gt;  void set_namespace(std::string language, std::string name_space) {&lt;br/&gt;
    t_generator_registry::gen_map_t my_copy = t_generator_registry::get_generator_map();&lt;/p&gt;

&lt;p&gt;    t_generator_registry::gen_map_t::iterator it;&lt;br/&gt;
    it=my_copy.find(language);&lt;/p&gt;

&lt;p&gt;    if (it == my_copy.end()) {&lt;br/&gt;
      if (language != &quot;smalltalk.prefix&quot; &amp;amp;&amp;amp; language != &quot;smalltalk.package&quot; &amp;amp;&amp;amp; language != &quot;py.twisted&quot;) &lt;/p&gt;
{
        throw &quot;No generator named &apos;&quot; + language + &quot;&apos; could be found!&quot;;
      }
&lt;p&gt;    }&lt;br/&gt;
    namespaces_&lt;span class=&quot;error&quot;&gt;&amp;#91;language&amp;#93;&lt;/span&gt; = name_space;&lt;br/&gt;
  }&lt;/p&gt;



&lt;p&gt;Not only does this blow up when a generator is disabled, but it also&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;prevents anyone from adding a new sub-namespace without modifying this code, as with smalltalk.prefix and smalltalk.package&lt;/li&gt;
	&lt;li&gt;actually skips the check it&apos;s intended to do in the smalltalk case, i.e. you can declare a smalltalk.prefix namespace without having the smalltalk generator enabled&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;We ran into this because we had a mod to declare a separate namespace for py.twisted, which is what I&apos;m about to put an issue in for.&lt;/p&gt;

&lt;p&gt;Now, if it&apos;s really important to check that the generator is there for a namespace declaration, then the &lt;b&gt;right&lt;/b&gt; way to do this is to take the base language name, check that there&apos;s a generator for it, then if there&apos;s a sub-language (smalltalk.package or py.twisted) call into the generator to see if it recognizes the declaration.&lt;/p&gt;

&lt;p&gt;That seems like a lot of effort to put the support into every generator for relatively little benefit.  I care a lot more about whether there&apos;s a missing namespace declaration for a language I&apos;m trying to generate than if there&apos;s a namespace declaration for a language I&apos;m not trying to generate.&lt;/p&gt;

&lt;p&gt;So as part of &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-859&quot; title=&quot;Allow py:twisted to be generated in different namespace than py&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-859&quot;&gt;&lt;del&gt;THRIFT-859&lt;/del&gt;&lt;/a&gt;, I think we should just revert the change to t_program.h, allow any namespace declaration to be made, and let the generator report an error if it&apos;s unhappy with there not being a namespace, etc.&lt;/p&gt;
</comment>
                            <comment id="12900461" author="bryanduxbury" created="Thu, 19 Aug 2010 21:11:01 +0000"  >&lt;p&gt;To take a step back, do we really want to support arbitrary sub-namespace specifications? If a lot of languages are going to be doing this, then I think we should make it some part of the overall generator spec. That way, we can eliminate the special cases.&lt;/p&gt;

&lt;p&gt;I think that having the check is a really useful piece of functionality. It keeps you from making silly mistakes and banging your head against a wall due to a typo, which is something I think the compiler should readily support. &lt;/p&gt;</comment>
                            <comment id="12900482" author="dreiss" created="Thu, 19 Aug 2010 21:54:27 +0000"  >&lt;p&gt;&amp;gt; If a lot of languages are going to be doing this, then I think we should make it some part of the overall generator spec. That way, we can eliminate the special cases. &lt;br/&gt;
Yeah, I actually hated that part of your patch.  I&apos;ve got a plan to allow generators to register the namespaces they use, but that doesn&apos;t solve the problem of compiling out generators or someone publishing a new .thrift file with (say) namespace as3 and someone else wanting to generate java code for it with an older version of thrift that doesn&apos;t support as3.  Maybe we should just make it a warning instead of an error?&lt;/p&gt;</comment>
                            <comment id="12900486" author="bryanduxbury" created="Thu, 19 Aug 2010 21:58:46 +0000"  >&lt;p&gt;I could be convinced to make it a warning, but in my experience, warnings get ignored.&lt;/p&gt;</comment>
                            <comment id="12900505" author="lowekamp" created="Thu, 19 Aug 2010 22:40:30 +0000"  >&lt;p&gt;This adds a method to check if a sub-namespace is supported by a generator, called via the generator_factory.  It provides an implementation for the smalltalk generator.  I&apos;m not sure of that implementation.  Looking at t_st_generator, it was referencing smalltalk.prefix and smalltalk.category, whereas t_program.h was referencing prefix and module.  I went with what was in t_st_generator, but I won&apos;t claim to have looked at it enough to be sure that&apos;s right.&lt;/p&gt;

&lt;p&gt;The patch now has the effect that a namespace declaration is rejected if the generator is not present or if the sub-namespace declaration isn&apos;t supported by a present generator.&lt;/p&gt;

&lt;p&gt;I&apos;m not completely sure I think a warning wouldn&apos;t be better if the generator isn&apos;t present at all.&lt;/p&gt;

&lt;p&gt;Minimally tested, but seems to work.&lt;/p&gt;</comment>
                            <comment id="12900764" author="bryanduxbury" created="Fri, 20 Aug 2010 16:44:15 +0000"  >&lt;p&gt;That patch looked great, so I committed it. However, I don&apos;t think we&apos;ve addressed the problem actually raised in this issue yet, so I&apos;m going to leave it open.&lt;/p&gt;</comment>
                            <comment id="12915433" author="lowekamp" created="Mon, 27 Sep 2010 19:00:29 +0000"  >&lt;p&gt;Ran into this problem again testing some of the new code in other issues.   Wrote this to restrict the test for namespace declarations to only check the namespace if the generator has been requested on the command line.  Very minimal testing, but it worked in getting the build to finish with only the cpp generator built.&lt;/p&gt;</comment>
                            <comment id="13104241" author="jfarrell" created="Wed, 14 Sep 2011 04:28:25 +0000"  >&lt;p&gt;Bryan, saw this ticket and wanted to wrap it up. Attached is a patch with removes the -&lt;del&gt;disable-gen&lt;/del&gt;${cpp,java,etc.} from configure and forces the generator to include all available t_*_generator.cc files. Thoughts?&lt;/p&gt;</comment>
                            <comment id="13109073" author="bryanduxbury" created="Tue, 20 Sep 2011 23:11:15 +0000"  >&lt;p&gt;Looks good to me, go ahead and commit it.&lt;/p&gt;</comment>
                            <comment id="13109122" author="jfarrell" created="Wed, 21 Sep 2011 00:15:47 +0000"  >&lt;p&gt;Committed&lt;/p&gt;</comment>
                            <comment id="13109137" author="hudson" created="Wed, 21 Sep 2011 00:40:45 +0000"  >&lt;p&gt;Integrated in Thrift #272 (See &lt;a href=&quot;https://builds.apache.org/job/Thrift/272/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Thrift/272/&lt;/a&gt;)&lt;br/&gt;
    Thrift-857: tests run by &quot;make install&quot; fail if generators are disabled&lt;br/&gt;
Client: build&lt;br/&gt;
Patch: jfarrell&lt;/p&gt;

&lt;p&gt;removes --enable-gen* from configure and adds all generators by default.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                            <outwardlinks description="blocks">
                                        <issuelink>
            <issuekey id="12472023">THRIFT-859</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12455742" name="check-requested-generator.patch" size="2920" author="lowekamp" created="Mon, 27 Sep 2010 19:00:29 +0000"/>
                            <attachment id="12452585" name="generator-subnamespace.patch" size="3684" author="lowekamp" created="Thu, 19 Aug 2010 22:40:30 +0000"/>
                            <attachment id="12494377" name="thrift-857.patch" size="6289" author="jfarrell" created="Wed, 14 Sep 2011 04:28:25 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>59949</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 10 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i16cfb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>245145</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>