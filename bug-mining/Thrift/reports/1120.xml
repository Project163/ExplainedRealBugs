<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 08:15:26 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[THRIFT-2844] Nodejs support broken when running under Browserify</title>
                <link>https://issues.apache.org/jira/browse/THRIFT-2844</link>
                <project id="12310800" key="THRIFT">Thrift</project>
                    <description>&lt;p&gt;When running under Browserify, the NodeJS binding fails when using the HTTP transport. This happens because Browserify is returning the response as a Uint8Array rather than a Buffer. The fix is straightforward: in response.on(&apos;data&apos;, wrap any Uint8Arrays in a buffer so the types are as expected.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Browserify&lt;/p&gt;</environment>
        <key id="12756655">THRIFT-2844</key>
            <summary>Nodejs support broken when running under Browserify</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="codesf">Randy Abernethy</assignee>
                                    <reporter username="cameronr">Cameron Ring</reporter>
                        <labels>
                    </labels>
                <created>Thu, 20 Nov 2014 08:55:52 +0000</created>
                <updated>Mon, 26 Jan 2015 02:26:40 +0000</updated>
                            <resolved>Tue, 2 Dec 2014 13:48:23 +0000</resolved>
                                    <version>0.9.2</version>
                                    <fixVersion>0.9.3</fixVersion>
                                    <component>Node.js - Library</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="14219149" author="githubbot" created="Thu, 20 Nov 2014 09:05:00 +0000"  >&lt;p&gt;Github user cameronr commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/251#issuecomment-63778908&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/251#issuecomment-63778908&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    jira issue created.&lt;/p&gt;

&lt;p&gt;    yes, Browserify returns Uint8arrays, not a generic ArrayBuffer. you can see the code here:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/substack/http-browserify/blob/master/lib/response.js#L108&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/substack/http-browserify/blob/master/lib/response.js#L108&lt;/a&gt;&lt;/p&gt;
</comment>
                            <comment id="14219190" author="githubbot" created="Thu, 20 Nov 2014 09:54:32 +0000"  >&lt;p&gt;Github user cvlchinet commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/251#issuecomment-63784793&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/251#issuecomment-63784793&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Ok thanks for clarifying &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="14223043" author="cvlchinet" created="Mon, 24 Nov 2014 15:18:24 +0000"  >&lt;p&gt;Can someone from the THRIFT team have an eye on this?&lt;/p&gt;</comment>
                            <comment id="14224147" author="codesf" created="Tue, 25 Nov 2014 07:32:17 +0000"  >&lt;p&gt;Hello Chi,&lt;/p&gt;

&lt;p&gt;I can get to this faster if a patch or pull request that applies to the current master branch is provided. &lt;/p&gt;

&lt;p&gt;Best,&lt;br/&gt;
Randy&lt;/p&gt;</comment>
                            <comment id="14224219" author="githubbot" created="Tue, 25 Nov 2014 08:26:22 +0000"  >&lt;p&gt;Github user cameronr commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/251#issuecomment-64324675&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/251#issuecomment-64324675&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    ah crap, messed up while updating to the recent changes. will close this PR and open a new one with the appropriate changes&lt;/p&gt;</comment>
                            <comment id="14224230" author="githubbot" created="Tue, 25 Nov 2014 08:34:07 +0000"  >&lt;p&gt;GitHub user cameronr opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/287&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/287&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-2844&quot; title=&quot;Nodejs support broken when running under Browserify&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-2844&quot;&gt;&lt;del&gt;THRIFT-2844&lt;/del&gt;&lt;/a&gt;: Nodejs support broken when running under Browserify  &lt;/p&gt;

&lt;p&gt;    Updated PR based on the current master branch&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/cameronr/thrift&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/cameronr/thrift&lt;/a&gt; browserify&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/287.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/287.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #287&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit c65947ea4c08d7cdf07174e4b2a4197c08165cf6&lt;br/&gt;
Author: Cameron Ring &amp;lt;cameron@cs.stanford.edu&amp;gt;&lt;br/&gt;
Date:   2014-11-02T09:17:49Z&lt;/p&gt;

&lt;p&gt;    Add support for Browserify&lt;/p&gt;

&lt;p&gt;    When running under Browserify, response.on(&apos;data&apos;) may be called with a&lt;br/&gt;
    string or an array buffer (not just with a Buffer). Wrap those types in&lt;br/&gt;
    a buffer so that response.on(&apos;end&apos;) is able to process the data&lt;br/&gt;
    correctly.&lt;/p&gt;

&lt;p&gt;commit 1aae4cc1c649e891cd18d4b2931fc588225008af&lt;br/&gt;
Author: Cameron Ring &amp;lt;cameron@cs.stanford.edu&amp;gt;&lt;br/&gt;
Date:   2014-11-02T09:25:38Z&lt;/p&gt;

&lt;p&gt;    Add support for setting responseType&lt;/p&gt;

&lt;p&gt;    It&apos;s convenient to be able to set the expected response type for the&lt;br/&gt;
    XHR, particularly when receiving binary data.&lt;/p&gt;

&lt;p&gt;commit 761662e5a95ce1d8f65fe690676484691cbd02c8&lt;br/&gt;
Author: Cameron Ring &amp;lt;cameron@cs.stanford.edu&amp;gt;&lt;br/&gt;
Date:   2014-11-02T09:32:41Z&lt;/p&gt;

&lt;p&gt;    update comment about Browserify and types&lt;/p&gt;

&lt;p&gt;commit 3113434508cb973a170d990d6794284280fa6a3e&lt;br/&gt;
Author: Cameron Ring &amp;lt;cameron@cs.stanford.edu&amp;gt;&lt;br/&gt;
Date:   2014-11-13T23:25:46Z&lt;/p&gt;

&lt;p&gt;    add IE8 support and fix bug with writing&lt;/p&gt;

&lt;p&gt;    IE8 doesn&apos;t have ArrayBuffer types, so use Object.prototype.toString&lt;br/&gt;
    instead to detect the typed array buffer.&lt;/p&gt;

&lt;p&gt;    Fix writing binary data when running under Browserify&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="14228452" author="cvlchinet" created="Fri, 28 Nov 2014 18:22:43 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=codesf&quot; class=&quot;user-hover&quot; rel=&quot;codesf&quot;&gt;codesf&lt;/a&gt; Cameron did that, so you should take a look, before the master gets ahead again&lt;/p&gt;</comment>
                            <comment id="14230124" author="codesf" created="Mon, 1 Dec 2014 17:54:24 +0000"  >&lt;p&gt;Hey Chi/Cameron,&lt;/p&gt;

&lt;p&gt;First thanks for the patch. Will be nice to get the kinks out of the Thrift Node.js/Browserify combo.&lt;/p&gt;

&lt;p&gt;I have one concern with the current implementation. It adds responseType to the nodeOptions object. This object is passed to Node and should only contain legal Node.js input. I do not think responseType is a current Node.js http.request() option. So if we were to add responseType I suspect it would belong in the Thrift ConnectOptions object (of which nodeOptions is an attribute). That said, responseType doesn&apos;t appear to be used anywhere in the Thrift library, this being the case I suggest we omit it. &lt;/p&gt;

&lt;p&gt;If you guys are ok with the attached patch I will commit it. If there are still issues outstanding, let me know. Please note that I am running the Node tests (and the JS grunt tests) and have made no effort to verify correct operation under Browserify. Would be nice to add a Browserify test at some point.&lt;/p&gt;

&lt;p&gt;Best,&lt;br/&gt;
Randy&lt;/p&gt;</comment>
                            <comment id="14230996" author="cameronr" created="Tue, 2 Dec 2014 05:07:15 +0000"  >&lt;p&gt;Randy, thanks for looking into this!&lt;/p&gt;

&lt;p&gt;On, responseType, it&apos;s used by &lt;a href=&quot;https://github.com/substack/http-browserify/blob/master/lib/request.js&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http-browserify/lib/request.js&lt;/a&gt;:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (params.responseType) &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; { xhr.responseType = params.responseType }
    &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (e) {}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Setting the response type is very helpful for returning binary data (otherwise it might be misinterpreted as a string with a charset). I&apos;m not sure how to pass it down to the browserify implementation of the http module using a mechanism other than params (without breaking the interface). If you have any suggestions, I&apos;m all ears.&lt;/p&gt;

&lt;p&gt;Adding some browserify unit tests would be great. I&apos;ll look into adding that if I have some time.&lt;/p&gt;

&lt;p&gt;thanks,&lt;br/&gt;
cam&lt;/p&gt;</comment>
                            <comment id="14231438" author="codesf" created="Tue, 2 Dec 2014 13:07:11 +0000"  >&lt;p&gt;Hey Cam,&lt;/p&gt;

&lt;p&gt;Thanks for the Browserify education. I suppose if Node.js ever develops an interface conflict with Browserify responseType there will be plenty of people raising the issue. I&apos;ll add the code that forwards the responseType on back in and commit the patch.&lt;/p&gt;

&lt;p&gt;Best,&lt;br/&gt;
Randy&lt;/p&gt;</comment>
                            <comment id="14231456" author="codesf" created="Tue, 2 Dec 2014 13:20:29 +0000"  >&lt;p&gt;responseType added back (also some white space and type-o cleanup)&lt;/p&gt;</comment>
                            <comment id="14231485" author="codesf" created="Tue, 2 Dec 2014 13:48:23 +0000"  >&lt;p&gt;committed&lt;/p&gt;</comment>
                            <comment id="14231527" author="hudson" created="Tue, 2 Dec 2014 14:16:45 +0000"  >&lt;p&gt;SUCCESS: Integrated in Thrift #1383 (See &lt;a href=&quot;https://builds.apache.org/job/Thrift/1383/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Thrift/1383/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-2844&quot; title=&quot;Nodejs support broken when running under Browserify&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-2844&quot;&gt;&lt;del&gt;THRIFT-2844&lt;/del&gt;&lt;/a&gt;:Add Browserify support to node (ra: rev 878483759c55365ef5da07ad8915e9a8e4af88d9)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;lib/nodejs/lib/thrift/protocol.js&lt;/li&gt;
	&lt;li&gt;lib/nodejs/lib/thrift/http_connection.js&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14231569" author="cvlchinet" created="Tue, 2 Dec 2014 14:58:59 +0000"  >&lt;p&gt;Thanks to both of you &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="14231816" author="cameronr" created="Tue, 2 Dec 2014 17:49:25 +0000"  >&lt;p&gt;awesome, thanks so much!&lt;/p&gt;</comment>
                            <comment id="14232088" author="githubbot" created="Tue, 2 Dec 2014 20:28:17 +0000"  >&lt;p&gt;Github user cvlchinet commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/251#issuecomment-65298557&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/251#issuecomment-65298557&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Usually you should be the one, with closing rights.&lt;/p&gt;</comment>
                            <comment id="14232408" author="githubbot" created="Wed, 3 Dec 2014 00:59:37 +0000"  >&lt;p&gt;Github user cameronr commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/251#issuecomment-65335108&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/251#issuecomment-65335108&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    oh, i&apos;m stupid &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="14232409" author="githubbot" created="Wed, 3 Dec 2014 00:59:38 +0000"  >&lt;p&gt;Github user cameronr closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/251&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/251&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14232411" author="githubbot" created="Wed, 3 Dec 2014 01:01:38 +0000"  >&lt;p&gt;Github user cameronr commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/287#issuecomment-65335299&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/287#issuecomment-65335299&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    merged as part of 878483759c55365ef5da07ad8915e9a8e4af88d9&lt;/p&gt;</comment>
                            <comment id="14232412" author="githubbot" created="Wed, 3 Dec 2014 01:01:39 +0000"  >&lt;p&gt;Github user cameronr closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/287&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/287&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12684647" name="0001-browserify-update-for-ArrayBuffer.patch" size="3682" author="codesf" created="Tue, 2 Dec 2014 13:20:29 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 51 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310041" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Patch Info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10042"><![CDATA[Patch Available]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i22lj3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>