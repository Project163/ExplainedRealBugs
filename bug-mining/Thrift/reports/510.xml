<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 08:02:25 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[THRIFT-1400] Ruby native extension aborts with __stack_chk_fail in OSX</title>
                <link>https://issues.apache.org/jira/browse/THRIFT-1400</link>
                <project id="12310800" key="THRIFT">Thrift</project>
                    <description>&lt;p&gt;get_field_value and set_field_value in struct.c apparently allocate one less byte than is required when building the field name, which I guess it works most of the time everywhere since there is nothing else in the stack, but OSX+clang appear to be serious about it.&lt;/p&gt;

&lt;p&gt;My patch follows the rationale that RSTRING_LEN does not include the 0-ended length, and apparently in Ruby 1.9(.3?) RSTRING_PTR is not zero-terminated, so I add one extra byte to the char[] and fix the passed buffer length to be actually the string length plus the extra byte for the zero.&lt;/p&gt;

&lt;p&gt;Stack trace:&lt;/p&gt;

&lt;p&gt;#0  0x00007fff9504bce2 in __pthread_kill ()&lt;br/&gt;
#1  0x00007fff93d617d2 in pthread_kill ()&lt;br/&gt;
#2  0x00007fff93d52b4a in __abort ()&lt;br/&gt;
#3  0x00007fff93d4f070 in __stack_chk_fail ()&lt;br/&gt;
#4  0x000000010077a417 in set_field_value (obj=&amp;lt;value temporarily unavailable, due to optimizations&amp;gt;, field_name=&amp;lt;value temporarily unavailable, due to optimizations&amp;gt;, value=&amp;lt;value temporarily unavailable, due to optimizations&amp;gt;) at struct.c:426&lt;br/&gt;
#5  0x0000000100779141 in rb_thrift_struct_read (self=4306092880, protocol=4306073480) at struct.c:592&lt;br/&gt;
#6  0x0000000100779cb9 in read_anything (protocol=4306073480, ttype=&amp;lt;value temporarily unavailable, due to optimizations&amp;gt;, field_info=&amp;lt;value temporarily unavailable, due to optimizations&amp;gt;) at struct.c:469&lt;br/&gt;
#7  0x0000000100779a5a in read_anything (protocol=4306073480, ttype=&amp;lt;value temporarily unavailable, due to optimizations&amp;gt;, field_info=4304975600) at struct.c:522&lt;br/&gt;
#8  0x0000000100779132 in rb_thrift_struct_read (self=4306096120, protocol=4306073480) at struct.c:592&lt;br/&gt;
#9  0x0000000100779cb9 in read_anything (protocol=4306073480, ttype=&amp;lt;value temporarily unavailable, due to optimizations&amp;gt;, field_info=&amp;lt;value temporarily unavailable, due to optimizations&amp;gt;) at struct.c:469&lt;br/&gt;
#10 0x0000000100779132 in rb_thrift_struct_read (self=4306097000, protocol=4306073480) at struct.c:592&lt;br/&gt;
#11 0x000000010013e7c5 in vm_call_cfunc &lt;span class=&quot;error&quot;&gt;&amp;#91;inlined&amp;#93;&lt;/span&gt; () at /Users/ccm/.rvm/src/ruby-1.9.3-rc1/vm_insnhelper.c:404&lt;br/&gt;
#12 0x000000010013e7c5 in vm_call_method (th=0x100301b10, cfp=0x1004ffb30, num=1, blockptr=0x0, flag=&amp;lt;value temporarily unavailable, due to optimizations&amp;gt;, id=&amp;lt;value temporarily unavailable, due to optimizations&amp;gt;, me=&amp;lt;value temporarily unavailable, due to optimizations&amp;gt;, recv=&amp;lt;value temporarily unavailable, due to optimizations&amp;gt;) at vm_insnhelper.c:534&lt;br/&gt;
#13 0x000000010012f5ee in vm_exec_core (th=0x100301b10, initial=&amp;lt;value temporarily unavailable, due to optimizations&amp;gt;) at vm.inc:1015&lt;br/&gt;
#14 0x0000000100138c94 in vm_exec (th=0x100301b10) at vm.c:1220&lt;br/&gt;
#15 0x00000001001395ab in rb_iseq_eval_main (iseqval=4304251720) at vm.c:1461&lt;br/&gt;
#16 0x000000010003701f in ruby_exec_internal (n=&amp;lt;value temporarily unavailable, due to optimizations&amp;gt;) at eval.c:204&lt;br/&gt;
#17 0x0000000100036f67 in ruby_run_node (n=0x1008dab48) at eval.c:251&lt;br/&gt;
#18 0x0000000100000edf in main (argc=2, argv=0x7fff5fbff838) at main.c:38&lt;/p&gt;</description>
                <environment>&lt;p&gt;Mac OSX 10.7.2&lt;br/&gt;
Xcode 4.2&lt;br/&gt;
MRI 1.9.3-rc1 built with clang, 64 bit&lt;/p&gt;</environment>
        <key id="12528336">THRIFT-1400</key>
            <summary>Ruby native extension aborts with __stack_chk_fail in OSX</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="carloscm">Carlos Carrasco</assignee>
                                    <reporter username="carloscm">Carlos Carrasco</reporter>
                        <labels>
                    </labels>
                <created>Fri, 21 Oct 2011 23:23:55 +0000</created>
                <updated>Mon, 24 Oct 2011 17:48:18 +0000</updated>
                            <resolved>Mon, 24 Oct 2011 17:29:18 +0000</resolved>
                                    <version>0.7</version>
                    <version>0.8</version>
                                    <fixVersion>0.8</fixVersion>
                                    <component>Ruby - Library</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="13134268" author="bryanduxbury" created="Mon, 24 Oct 2011 17:29:18 +0000"  >&lt;p&gt;I just committed this to trunk. Thanks Carlos!&lt;/p&gt;</comment>
                            <comment id="13134286" author="hudson" created="Mon, 24 Oct 2011 17:48:18 +0000"  >&lt;p&gt;Integrated in Thrift #305 (See &lt;a href=&quot;https://builds.apache.org/job/Thrift/305/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Thrift/305/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-1400&quot; title=&quot;Ruby native extension aborts with __stack_chk_fail in OSX&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-1400&quot;&gt;&lt;del&gt;THRIFT-1400&lt;/del&gt;&lt;/a&gt;. rb: Ruby native extension aborts with __stack_chk_fail in OSX&lt;/p&gt;

&lt;p&gt;bryanduxbury : &lt;a href=&quot;http://svn.apache.org/viewvc/?view=rev&amp;amp;rev=1188248&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc/?view=rev&amp;amp;rev=1188248&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/thrift/trunk/lib/rb/ext/struct.c&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12500266" name="fix-field-value-buf.diff" size="1102" author="carloscm" created="Fri, 21 Oct 2011 23:24:21 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>113449</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 5 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310041" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Patch Info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10042"><![CDATA[Patch Available]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i08413:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>45252</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>