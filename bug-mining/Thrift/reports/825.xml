<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 08:09:47 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[THRIFT-2139] MSVC 2012 Error - Cannot compile due to BoostThreadFactory</title>
                <link>https://issues.apache.org/jira/browse/THRIFT-2139</link>
                <project id="12310800" key="THRIFT">Thrift</project>
                    <description>&lt;p&gt;Errors given are:&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;error C2664: &apos;std::thread::id::id(const std::thread &amp;amp;)&apos; : cannot convert parameter 1 from &apos;boost::thread::id&apos; to &apos;const std::thread &amp;amp;&apos;	C:\Users\chris\Desktop\workspace\build\thrift\thrift-0.9.1\lib\cpp\src\thrift\concurrency\BoostThreadFactory.cpp	101	1	libthrift&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;error C2664: &apos;std::thread::id::id(const std::thread &amp;amp;)&apos; : cannot convert parameter 1 from &apos;boost::thread::id&apos; to &apos;const std::thread &amp;amp;&apos;	C:\Users\chris\Desktop\workspace\build\thrift\thrift-0.9.1\lib\cpp\src\thrift\concurrency\BoostThreadFactory.cpp	165	1	libthrift&lt;/p&gt;&lt;/blockquote&gt;</description>
                <environment>&lt;p&gt;MSVC 2012 x64&lt;/p&gt;</environment>
        <key id="12664626">THRIFT-2139</key>
            <summary>MSVC 2012 Error - Cannot compile due to BoostThreadFactory</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="chris5287">Chris Stylianou</reporter>
                        <labels>
                            <label>c++</label>
                            <label>msvc</label>
                            <label>thrift</label>
                    </labels>
                <created>Tue, 20 Aug 2013 15:27:56 +0000</created>
                <updated>Sat, 5 Oct 2013 01:43:26 +0000</updated>
                            <resolved>Fri, 27 Sep 2013 15:49:41 +0000</resolved>
                                    <version>0.9.1</version>
                                    <fixVersion>0.9.2</fixVersion>
                                    <component>C++ - Library</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="13745064" author="ben.craig" created="Tue, 20 Aug 2013 15:37:45 +0000"  >&lt;p&gt;If you are building with msvc 2012, then you should not compile BoostThreadFactory.  Compile StdThreadFactory instead.&lt;/p&gt;</comment>
                            <comment id="13745070" author="chris5287" created="Tue, 20 Aug 2013 15:43:40 +0000"  >&lt;p&gt;I pretty sure I am, as this is set automatically in &quot;config.h&quot;:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-comment&quot;&gt;// use std::thread in MSVC11 (2012) or newer
&lt;/span&gt;#&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; _MSC_VER &amp;gt;= 1700
#  define USE_STD_THREAD 1
&lt;span class=&quot;code-comment&quot;&gt;// otherwise use boost threads
&lt;/span&gt;#&lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt;
#  define USE_BOOST_THREAD 1
#endif
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13745076" author="ben.craig" created="Tue, 20 Aug 2013 15:48:45 +0000"  >&lt;p&gt;config.h determines which thread implementation is used by Thread.h and PlatformThreadFactory.h.  It doesn&apos;t change which .cpp files are in your vcxproj.  Removing BoostThreadFactory from your project should correct the problem.&lt;/p&gt;</comment>
                            <comment id="13745084" author="chris5287" created="Tue, 20 Aug 2013 15:54:48 +0000"  >&lt;p&gt;Ah okay, is this something that can be fixed in &quot;lib\cpp\libthrift.vcxproj&quot; which is provided in the thrift package?&lt;/p&gt;</comment>
                            <comment id="13745089" author="ben.craig" created="Tue, 20 Aug 2013 16:00:05 +0000"  >&lt;p&gt;It could be.  To properly fix it, we would need to provide a different set of solutions and projects for each supported compiler.  That is possible, but someone would need to contribute a patch.&lt;/p&gt;</comment>
                            <comment id="13745370" author="chris5287" created="Tue, 20 Aug 2013 20:31:05 +0000"  >&lt;p&gt;Ah okay, is there another ticket open to handle the creation of these solutions/projects? Also, there are other outstanding errors in the current vcproj files that need resolving (See &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-1847&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/THRIFT-1847&lt;/a&gt;)&lt;/p&gt;</comment>
                            <comment id="13745420" author="ben.craig" created="Tue, 20 Aug 2013 20:59:42 +0000"  >&lt;p&gt;None that I know of.&lt;/p&gt;</comment>
                            <comment id="13772823" author="aloukissas" created="Fri, 20 Sep 2013 07:05:11 +0000"  >&lt;p&gt;Just ran into this problem and there are 2 fixes required for this:&lt;/p&gt;

&lt;p&gt;1. Include StdThreadFactory.cpp into the list of compiled files in libthrift.vcxproj&lt;br/&gt;
2. Conditionally compile either BoostThreadFactory or StdThreadFactory, based on what config.h points to. My solution was to guard both files with the corresponding #ifdef.&lt;/p&gt;

&lt;p&gt;Finally, to build for MSVC2012, you can just pass the /p:PlatformToolset=v110 in your MSBuild invocation. I can provide the simple patch for 1,2 above.&lt;/p&gt;</comment>
                            <comment id="13772849" author="aloukissas" created="Fri, 20 Sep 2013 07:34:53 +0000"  >&lt;p&gt;the attached patch &lt;em&gt;should&lt;/em&gt; fix this bug; please confirm&lt;/p&gt;</comment>
                            <comment id="13774735" author="ben.craig" created="Mon, 23 Sep 2013 17:09:36 +0000"  >&lt;p&gt;The patch looks reasonable, but I haven&apos;t had a chance to test it yet.  I hope to test and commit it by the end of the week.&lt;/p&gt;</comment>
                            <comment id="13775592" author="aloukissas" created="Mon, 23 Sep 2013 19:38:06 +0000"  >&lt;p&gt;Great- let me know if you need help testing or update to the patch. In my test, I converted the projects (automatically) to MSVC2012 but I suspect you can skip this step and pass /p:PlatformToolset=v110 if you build from cmdline using MSBuild.&lt;/p&gt;</comment>
                            <comment id="13780033" author="ben.craig" created="Fri, 27 Sep 2013 15:49:41 +0000"  >&lt;p&gt;Committed.  Thanks Alex!&lt;/p&gt;

&lt;p&gt;Minor issue for future patches.  It appears you generated the diff from the lib directory.  In the future, please generate the patch from the root directory.&lt;/p&gt;

&lt;p&gt;There is one minor tradeoff with this patch that I am deeming acceptable.  Building the static library now generates a linker warning that the unused thread factory doesn&apos;t have any symbols in it.  I think this warning is preferable to having multiple projects, or more complicated project magic, at least for now.&lt;/p&gt;</comment>
                            <comment id="13780051" author="aloukissas" created="Fri, 27 Sep 2013 16:12:01 +0000"  >&lt;p&gt;Great thanks!&lt;/p&gt;

&lt;p&gt;Btw, the patch was not from the lib directory, rather it was generated from the root with --no-prefix option. I usually prefer this so that I patch with -p0 from the root directory.&lt;/p&gt;

&lt;p&gt;The warning you mention is fixable, with conditional compilation of either of the two thread factory sources. I know how to do this, just let me know what&apos;s the preferred way of dealing with it (in my projects I rely on an env variable for this conditional).&lt;/p&gt;</comment>
                            <comment id="13780100" author="hudson" created="Fri, 27 Sep 2013 17:07:08 +0000"  >&lt;p&gt;SUCCESS: Integrated in Thrift #921 (See &lt;a href=&quot;https://builds.apache.org/job/Thrift/921/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Thrift/921/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-2139&quot; title=&quot;MSVC 2012 Error - Cannot compile due to BoostThreadFactory&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-2139&quot;&gt;&lt;del&gt;THRIFT-2139&lt;/del&gt;&lt;/a&gt;: MSVC 2012 Error - Cannot compile due to BoostThreadFactory (bencraig: rev aea8bfe0f0c0544fd59819d9696747ecaeacb4f7)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;lib/cpp/libthrift.vcxproj&lt;/li&gt;
	&lt;li&gt;lib/cpp/src/thrift/concurrency/BoostThreadFactory.cpp&lt;/li&gt;
	&lt;li&gt;lib/cpp/libthrift.vcxproj.filters&lt;/li&gt;
	&lt;li&gt;lib/cpp/src/thrift/concurrency/StdThreadFactory.cpp&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12604211" name="THRIFT-2139.patch" size="3469" author="aloukissas" created="Fri, 20 Sep 2013 07:34:53 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>344569</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 8 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1nf53:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>344869</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>