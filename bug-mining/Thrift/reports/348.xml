<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 07:58:52 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[THRIFT-807] JavaScript: Initialization of Base Types with 0 instead of null</title>
                <link>https://issues.apache.org/jira/browse/THRIFT-807</link>
                <project id="12310800" key="THRIFT">Thrift</project>
                    <description>&lt;p&gt;I had a problem with the exception avaliable on the tutorial. &lt;br/&gt;
i32 calculate(1:i32 logid, 2:Work w) throws (1:InvalidOperation ouch),&lt;/p&gt;

&lt;p&gt;It couldn&apos;t be thrown because initialization of numeric base types is done with 0 instead of null and the checks do compare against null.&lt;br/&gt;
This was not visible with the Tests provided with first patch for JavaScript bindings above, the ThriftTest.thrift definition does not have a combination of a base type return value and an exception.&lt;/p&gt;

&lt;p&gt;I&apos;ve made a patch that initializes the base types I16,I32, I64 and DOUBLE with null. This could probably solve other issues as well&lt;/p&gt;

&lt;p&gt;Regards&lt;/p&gt;

&lt;p&gt;Roger&lt;/p&gt;</description>
                <environment></environment>
        <key id="12467366">THRIFT-807</key>
            <summary>JavaScript: Initialization of Base Types with 0 instead of null</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="roger">Roger Meier</assignee>
                                    <reporter username="roger">Roger Meier</reporter>
                        <labels>
                    </labels>
                <created>Fri, 18 Jun 2010 18:13:09 +0000</created>
                <updated>Thu, 2 May 2013 02:29:33 +0000</updated>
                            <resolved>Fri, 15 Oct 2010 19:14:30 +0000</resolved>
                                    <version>0.3</version>
                                    <fixVersion>0.6</fixVersion>
                                    <component>JavaScript - Compiler</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="12880272" author="roger.meier" created="Fri, 18 Jun 2010 18:14:18 +0000"  >&lt;p&gt;patch added&lt;/p&gt;</comment>
                            <comment id="12880673" author="jordo" created="Sun, 20 Jun 2010 20:56:34 +0000"  >&lt;p&gt;The problem I had was not with a numeric return value, but rather a boolean value. &lt;br/&gt;
Does you patch fix both?&lt;/p&gt;</comment>
                            <comment id="12880701" author="tjake" created="Mon, 21 Jun 2010 01:21:55 +0000"  >&lt;p&gt;Thanks for catching this Roger.  I&apos;ll take a look&lt;/p&gt;</comment>
                            <comment id="12883769" author="tjake" created="Wed, 30 Jun 2010 02:51:31 +0000"  >&lt;p&gt;I took a look and I don&apos;t think this will work. We would need to initialize all types to null including maps and arrays.  I tried doing this and the test fails since struct maps now aren&apos;t initialized.&lt;/p&gt;

&lt;p&gt;I think we need to return null on an error, but haven&apos;t had a chance to see where this would be possible in the generated code.&lt;/p&gt;</comment>
                            <comment id="12883797" author="roger.meier" created="Wed, 30 Jun 2010 06:11:23 +0000"  >&lt;p&gt;I absolutly agree, all types should be initialized to null.(or undefined?)&lt;/p&gt;

&lt;p&gt;I propose to start extending ThriftTest.thrift with additional test cases as described above.&lt;/p&gt;

&lt;p&gt;I&apos;m ready to prepare a patch for that!&lt;br/&gt;
Are functions with all types as return value and one exception sufficient?&lt;br/&gt;
Or do we need an additional set with two exceptions?&lt;/p&gt;
</comment>
                            <comment id="12887095" author="roger.meier" created="Sat, 10 Jul 2010 21:51:01 +0000"  >&lt;p&gt;v2 patch Initializes all Types with null, expect void and obj type&lt;/p&gt;</comment>
                            <comment id="12891337" author="roger.meier" created="Thu, 22 Jul 2010 21:09:54 +0000"  >&lt;p&gt;I&apos;m not sure if that&apos;s a JavaScript issue, probably I did not understand the real problem before!&lt;/p&gt;

&lt;p&gt;Due to the fact, that all Languages supported by Thrift do initialize types, objects, etc. in a different ways, the base types might be initialized correctly by setting them to 0. =&amp;gt; null is a JavaScript specific thing!&lt;/p&gt;

&lt;p&gt;I think it is required to extend the &lt;a href=&quot;http://wiki.apache.org/thrift/ThriftTypes]&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;[ThriftTypes&lt;/a&gt; Definition by enforcing default values for all ThriftTypes. So that not initialized Types or Objects are absolutely the same on wire.&lt;/p&gt;

</comment>
                            <comment id="12905347" author="bryanduxbury" created="Thu, 2 Sep 2010 00:40:46 +0000"  >&lt;p&gt;What&apos;s the word on the latest rev of this patch? Is it ready to go?&lt;/p&gt;</comment>
                            <comment id="12905356" author="tjake" created="Thu, 2 Sep 2010 00:50:49 +0000"  >&lt;p&gt;no, not yet&lt;/p&gt;</comment>
                            <comment id="12906325" author="roger.meier" created="Sun, 5 Sep 2010 06:39:41 +0000"  >&lt;p&gt;I applied that patch on my current trunk version again.&lt;/p&gt;

&lt;p&gt;The js unit test has still the same results, but with v2 patch the tutorial example mentioned above works, especially the exception.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;var&lt;/span&gt; work = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Work()
work.op = Operation.DIVIDE;
work.num1 = $(&lt;span class=&quot;code-quote&quot;&gt;&quot;#num1&quot;&lt;/span&gt;).val();
work.num2 = $(&lt;span class=&quot;code-quote&quot;&gt;&quot;#num2&quot;&lt;/span&gt;).val();
    
&lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt;{
  result = client.calculate(1, work);
  $(&lt;span class=&quot;code-quote&quot;&gt;&apos;#result&apos;&lt;/span&gt;).val(result);
  $(&lt;span class=&quot;code-quote&quot;&gt;&apos;#result&apos;&lt;/span&gt;).css(&lt;span class=&quot;code-quote&quot;&gt;&apos;color&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;black&apos;&lt;/span&gt;);
} &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt;(ouch) {
  $(&lt;span class=&quot;code-quote&quot;&gt;&apos;#result&apos;&lt;/span&gt;).val(ouch.why);
  $(&lt;span class=&quot;code-quote&quot;&gt;&apos;#result&apos;&lt;/span&gt;).css(&lt;span class=&quot;code-quote&quot;&gt;&apos;color&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;red&apos;&lt;/span&gt;);
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="12906384" author="roger.meier" created="Sun, 5 Sep 2010 20:44:17 +0000"  >&lt;p&gt;I just made a new ticket for adding the tutorial example I made, see &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-893&quot; title=&quot;add JavaScript to the tutorial examples&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-893&quot;&gt;&lt;del&gt;THRIFT-893&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12921354" author="roger.meier" created="Fri, 15 Oct 2010 13:34:44 +0000"  >&lt;p&gt;rebased patch, could someone please verify?&lt;/p&gt;</comment>
                            <comment id="12921443" author="bryanduxbury" created="Fri, 15 Oct 2010 17:10:07 +0000"  >&lt;p&gt;Looks good to me, commit it.&lt;/p&gt;</comment>
                            <comment id="12921505" author="roger.meier" created="Fri, 15 Oct 2010 19:14:30 +0000"  >&lt;p&gt;committed &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/check.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                                                <inwardlinks description="is depended upon by">
                                        <issuelink>
            <issuekey id="12473350">THRIFT-893</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12447485" name="THRIFT-807_initialize_with_null.patch" size="649" author="roger" created="Fri, 18 Jun 2010 18:14:18 +0000"/>
                            <attachment id="12449171" name="THRIFT-807_initialize_with_null.v2.patch" size="1352" author="roger" created="Sat, 10 Jul 2010 21:51:01 +0000"/>
                            <attachment id="12457258" name="THRIFT-807_initialize_with_null.v3.patch" size="1353" author="roger" created="Fri, 15 Oct 2010 13:34:44 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>186959</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 years, 6 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310041" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Patch Info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10042"><![CDATA[Patch Available]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i16dlb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>245334</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>