<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 08:14:05 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[THRIFT-2680] c_glib: ThriftFramedTransport fails when peer unexpectedly closes connection</title>
                <link>https://issues.apache.org/jira/browse/THRIFT-2680</link>
                <project id="12310800" key="THRIFT">Thrift</project>
                    <description>&lt;p&gt;Working on the integration test suite for c_glib exposed a problem with ThriftFramedTransport: If the peer closes the connection unexpectedly, &lt;tt&gt;thrift_framed_transport_read_frame&lt;/tt&gt; will fail with either a critical GLib warning or a segmentation fault.&lt;/p&gt;

&lt;p&gt;The attached patches fix this issue. The changes are, in order:&lt;/p&gt;

&lt;p&gt;1. Add a suitable test case to &lt;tt&gt;testframedtransport.c&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;2. Modify &lt;tt&gt;thrift_framed_transport_read_frame&lt;/tt&gt; and &lt;tt&gt;thrift_framed_transport_read_frame_slow&lt;/tt&gt; so they check for and respond to errors returned from other Thrift methods. Additionally, &lt;tt&gt;thrift_framed_transport_read_frame_slow&lt;/tt&gt; should now always return -1 in case of read error, which includes &quot;successfully&quot; reading zero bytes from the peer (which generally indicates a prematurely closed connection).&lt;/p&gt;

&lt;p&gt;I&apos;ve also taken the liberty of gently rewriting &lt;tt&gt;thrift_framed_transport_read_frame&lt;/tt&gt; so it&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Correctly uses an unsigned integer variable to hold the frame&apos;s size,&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;Uses &lt;tt&gt;thrift_transport_...&lt;/tt&gt; functions to invoke class methods instead of the rather brittle practice of dereferencing class members directly, and&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;Accurately reports success or failure.&lt;/li&gt;
&lt;/ul&gt;
</description>
                <environment>&lt;p&gt;Fedora 20 64-bit on x86_64&lt;/p&gt;</environment>
        <key id="12737293">THRIFT-2680</key>
            <summary>c_glib: ThriftFramedTransport fails when peer unexpectedly closes connection</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="roger">Roger Meier</assignee>
                                    <reporter username="simonsouth">Simon South</reporter>
                        <labels>
                            <label>c_glib</label>
                            <label>library</label>
                    </labels>
                <created>Thu, 28 Aug 2014 03:07:46 +0000</created>
                <updated>Wed, 5 Nov 2014 04:49:10 +0000</updated>
                            <resolved>Mon, 1 Sep 2014 18:22:20 +0000</resolved>
                                    <version>0.9.1</version>
                                    <fixVersion>0.9.2</fixVersion>
                                    <component>C glib - Library</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="14117617" author="roger.meier" created="Mon, 1 Sep 2014 18:22:20 +0000"  >&lt;p&gt;Thanks Simon!&lt;/p&gt;</comment>
                            <comment id="14117666" author="hudson" created="Mon, 1 Sep 2014 19:56:42 +0000"  >&lt;p&gt;SUCCESS: Integrated in Thrift #1267 (See &lt;a href=&quot;https://builds.apache.org/job/Thrift/1267/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Thrift/1267/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-2680&quot; title=&quot;c_glib: ThriftFramedTransport fails when peer unexpectedly closes connection&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-2680&quot;&gt;&lt;del&gt;THRIFT-2680&lt;/del&gt;&lt;/a&gt; c_glib: ThriftFramedTransport fails when peer unexpectedly closes connection (roger: rev 7fa9848b85479f81767a36a96e7e9805683015d4)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;lib/c_glib/src/thrift/c_glib/transport/thrift_framed_transport.c&lt;/li&gt;
	&lt;li&gt;lib/c_glib/test/testframedtransport.c&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14117691" author="hudson" created="Mon, 1 Sep 2014 20:40:09 +0000"  >&lt;p&gt;FAILURE: Integrated in Thrift-Test #15 (See &lt;a href=&quot;https://builds.apache.org/job/Thrift-Test/15/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Thrift-Test/15/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-2680&quot; title=&quot;c_glib: ThriftFramedTransport fails when peer unexpectedly closes connection&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-2680&quot;&gt;&lt;del&gt;THRIFT-2680&lt;/del&gt;&lt;/a&gt; c_glib: ThriftFramedTransport fails when peer unexpectedly closes connection (roger: rev 7fa9848b85479f81767a36a96e7e9805683015d4)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;lib/c_glib/src/thrift/c_glib/transport/thrift_framed_transport.c&lt;/li&gt;
	&lt;li&gt;lib/c_glib/test/testframedtransport.c&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14197589" author="hudson" created="Wed, 5 Nov 2014 04:49:10 +0000"  >&lt;p&gt;SUCCESS: Integrated in Thrift #1331 (See &lt;a href=&quot;https://builds.apache.org/job/Thrift/1331/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Thrift/1331/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-2680&quot; title=&quot;c_glib: ThriftFramedTransport fails when peer unexpectedly closes connection&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-2680&quot;&gt;&lt;del&gt;THRIFT-2680&lt;/del&gt;&lt;/a&gt; c_glib: ThriftFramedTransport fails when peer unexpectedly closes connection (roger: rev 7fa9848b85479f81767a36a96e7e9805683015d4)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;lib/c_glib/src/thrift/c_glib/transport/thrift_framed_transport.c&lt;/li&gt;
	&lt;li&gt;lib/c_glib/test/testframedtransport.c&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310040">
                    <name>Required</name>
                                                                <inwardlinks description="is required by">
                                        <issuelink>
            <issuekey id="12738040">THRIFT-2685</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12664812" name="thrift-2680-1-c_glib-test-framed-transport-read-after-peer-close.patch" size="3354" author="simonsouth" created="Thu, 28 Aug 2014 03:09:41 +0000"/>
                            <attachment id="12664813" name="thrift-2680-2-c_glib-framed-transport-handle-closed-connection-gracefully.patch" size="3332" author="simonsouth" created="Thu, 28 Aug 2014 03:09:41 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 3 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310041" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Patch Info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10042"><![CDATA[Patch Available]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1zfav:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>