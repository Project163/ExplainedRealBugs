<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 08:11:06 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[THRIFT-2359] TBufferedTransport doesn&apos;t clear it&apos;s buffer on a failed flush call</title>
                <link>https://issues.apache.org/jira/browse/THRIFT-2359</link>
                <project id="12310800" key="THRIFT">Thrift</project>
                    <description>&lt;p&gt;On flush in the php implementation of the TBufferedTransport it doesn&apos;t clear the internal buffer before calling the underlying write function. However the write function in TBufferedTransport does.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;&quot;&gt;&lt;b&gt;TBufferedTransport.php&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; function write($buf) {
    $&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;-&amp;gt;wBuf_ .= $buf;
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (TStringFuncFactory::create()-&amp;gt;strlen($&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;-&amp;gt;wBuf_) &amp;gt;= $&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;-&amp;gt;wBufSize_) {
      $out = $&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;-&amp;gt;wBuf_;

      &lt;span class=&quot;code-comment&quot;&gt;// Note that we clear the internal wBuf_ prior to the underlying write
&lt;/span&gt;      &lt;span class=&quot;code-comment&quot;&gt;// to ensure we&apos;re in a sane state (i.e. internal buffer cleaned)
&lt;/span&gt;      &lt;span class=&quot;code-comment&quot;&gt;// &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; the underlying write &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; up an exception
&lt;/span&gt;      $&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;-&amp;gt;wBuf_ = &apos;&apos;;
      $&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;-&amp;gt;transport_-&amp;gt;write($out);
    }
  }

  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; function flush() {
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (TStringFuncFactory::create()-&amp;gt;strlen($&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;-&amp;gt;wBuf_) &amp;gt; 0) {
      $&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;-&amp;gt;transport_-&amp;gt;write($&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;-&amp;gt;wBuf_);
      $&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;-&amp;gt;wBuf_ = &apos;&apos;;
    }
    $&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;-&amp;gt;transport_-&amp;gt;flush();
  }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;If a write on the underlying transport fails when we call flush, the internal buffer won&apos;t be cleared.&lt;br/&gt;
This causes some interesting issues when this happens. If you happen to call the same function twice (first call fails to write, but the second one succeeds), it will call the function on the server with the data provided in the first call, rather than your current call.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12694609">THRIFT-2359</key>
            <summary>TBufferedTransport doesn&apos;t clear it&apos;s buffer on a failed flush call</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jensg">Jens Geyer</assignee>
                                    <reporter username="solarnz">Chris Trotman</reporter>
                        <labels>
                            <label>easyfix</label>
                    </labels>
                <created>Tue, 11 Feb 2014 22:40:46 +0000</created>
                <updated>Sat, 22 Feb 2014 00:45:19 +0000</updated>
                            <resolved>Tue, 18 Feb 2014 20:57:33 +0000</resolved>
                                    <version>0.9.1</version>
                                    <fixVersion>0.9.2</fixVersion>
                                    <component>PHP - Library</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="13903502" author="jensg" created="Mon, 17 Feb 2014 20:59:48 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=solarnz&quot; class=&quot;user-hover&quot; rel=&quot;solarnz&quot;&gt;solarnz&lt;/a&gt;, &lt;/p&gt;

&lt;p&gt;if that&apos;s such an &quot;easyfix&quot;, I&apos;d love to review and commit your patch &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;/p&gt;

&lt;p&gt;What do you think?&lt;/p&gt;

</comment>
                            <comment id="13903675" author="solarnz" created="Tue, 18 Feb 2014 01:26:14 +0000"  >&lt;p&gt;Here is the patch &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13904576" author="jensg" created="Tue, 18 Feb 2014 20:57:33 +0000"  >&lt;p&gt;+1 and committed. &lt;br/&gt;
Thank you, Chris!&lt;/p&gt;</comment>
                            <comment id="13904711" author="hudson" created="Tue, 18 Feb 2014 22:28:28 +0000"  >&lt;p&gt;FAILURE: Integrated in Thrift #1047 (See &lt;a href=&quot;https://builds.apache.org/job/Thrift/1047/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Thrift/1047/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-2359&quot; title=&quot;TBufferedTransport doesn&amp;#39;t clear it&amp;#39;s buffer on a failed flush call&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-2359&quot;&gt;&lt;del&gt;THRIFT-2359&lt;/del&gt;&lt;/a&gt; TBufferedTransport doesn&apos;t clear it&apos;s buffer on a failed flush call (jensg: rev 8c1779d6712f102f2844621508e9f445540be7d2)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;lib/php/lib/Thrift/Transport/TBufferedTransport.php&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12629456" name="thrift-2359-fix-flush-in-tbufferedtransport-php.patch" size="1289" author="solarnz" created="Tue, 18 Feb 2014 01:26:14 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>373117</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 40 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310041" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Patch Info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10042"><![CDATA[Patch Available]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1satj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>373418</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>