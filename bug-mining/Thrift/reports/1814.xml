<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 08:27:40 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[THRIFT-4334] Perl indentation incorrect when defaulting field attribute to a struct</title>
                <link>https://issues.apache.org/jira/browse/THRIFT-4334</link>
                <project id="12310800" key="THRIFT">Thrift</project>
                    <description>&lt;p&gt;Improper indentation is used when defaulting an attribute in a struct to another struct or hash:&lt;/p&gt;

&lt;p&gt;See the following example thrift&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;struct &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; {
  1: map&amp;lt;string, string&amp;gt; hashWithDefault = {&lt;span class=&quot;code-quote&quot;&gt;&quot;foo&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;bar&quot;&lt;/span&gt;}
  2: list&amp;lt;string&amp;gt; arrayWithDefault = [&lt;span class=&quot;code-quote&quot;&gt;&quot;foo&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;bar&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;baz&quot;&lt;/span&gt;]
}
struct OtherObject {
  1: &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; objectWithDefault = {&lt;span class=&quot;code-quote&quot;&gt;&quot;hashWithDefault&quot;&lt;/span&gt;: {&lt;span class=&quot;code-quote&quot;&gt;&quot;baz&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;bat&quot;&lt;/span&gt;}, &lt;span class=&quot;code-quote&quot;&gt;&quot;arrayWithDefault&quot;&lt;/span&gt;: [&lt;span class=&quot;code-quote&quot;&gt;&quot;a&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;b&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;c&quot;&lt;/span&gt;]}
  2: string primitiveStringType
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Object constructor: &lt;em&gt;This uses improper indentation when specifying the hash keys to use in the initialization of hashWithDefault and arrayWithDefault, but the indentation is returned to the correct level afterwards&lt;/em&gt;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;;
use base qw(&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;::Accessor);
&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;-&amp;gt;mk_accessors( qw( hashWithDefault arrayWithDefault ) );

sub &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; {
  my $classname = shift;
  my $self      = {};
  my $vals      = shift || {};
  $self-&amp;gt;{hashWithDefault} = {
&lt;span class=&quot;code-quote&quot;&gt;&quot;foo&quot;&lt;/span&gt; =&amp;gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;bar&quot;&lt;/span&gt;,
};
  $self-&amp;gt;{arrayWithDefault} = [
&lt;span class=&quot;code-quote&quot;&gt;&quot;foo&quot;&lt;/span&gt;,
&lt;span class=&quot;code-quote&quot;&gt;&quot;bar&quot;&lt;/span&gt;,
&lt;span class=&quot;code-quote&quot;&gt;&quot;baz&quot;&lt;/span&gt;,
];
  &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (UNIVERSAL::isa($vals,&lt;span class=&quot;code-quote&quot;&gt;&apos;HASH&apos;&lt;/span&gt;)) {
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (defined $vals-&amp;gt;{hashWithDefault}) {
      $self-&amp;gt;{hashWithDefault} = $vals-&amp;gt;{hashWithDefault};
    }
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (defined $vals-&amp;gt;{arrayWithDefault}) {
      $self-&amp;gt;{arrayWithDefault} = $vals-&amp;gt;{arrayWithDefault};
    }
  }
  &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; bless ($self, $classname);
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;OtherObject constructor: &lt;em&gt;This uses improper indentation when specifying the hash keys to use in the initialization of Object, but the indentation is NOT returned to the correct level afterwards&lt;/em&gt;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt; OtherObject;
use base qw(&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;::Accessor);
OtherObject-&amp;gt;mk_accessors( qw( objectWithDefault primitiveStringType ) );

sub &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; {
  my $classname = shift;
  my $self      = {};
  my $vals      = shift || {};
  $self-&amp;gt;{objectWithDefault} = undef;
  $self-&amp;gt;{primitiveStringType} = undef;
  $self-&amp;gt;{objectWithDefault} = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;({
&lt;span class=&quot;code-quote&quot;&gt;&quot;hashWithDefault&quot;&lt;/span&gt; =&amp;gt; {
&lt;span class=&quot;code-quote&quot;&gt;&quot;baz&quot;&lt;/span&gt; =&amp;gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;bat&quot;&lt;/span&gt;,
},
&lt;span class=&quot;code-quote&quot;&gt;&quot;arrayWithDefault&quot;&lt;/span&gt; =&amp;gt; [
&lt;span class=&quot;code-quote&quot;&gt;&quot;a&quot;&lt;/span&gt;,
&lt;span class=&quot;code-quote&quot;&gt;&quot;b&quot;&lt;/span&gt;,
&lt;span class=&quot;code-quote&quot;&gt;&quot;c&quot;&lt;/span&gt;,
],
});
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (UNIVERSAL::isa($vals,&lt;span class=&quot;code-quote&quot;&gt;&apos;HASH&apos;&lt;/span&gt;)) {
      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (defined $vals-&amp;gt;{objectWithDefault}) {
        $self-&amp;gt;{objectWithDefault} = $vals-&amp;gt;{objectWithDefault};
      }
      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (defined $vals-&amp;gt;{primitiveStringType}) {
        $self-&amp;gt;{primitiveStringType} = $vals-&amp;gt;{primitiveStringType};
      }
    }
    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; bless ($self, $classname);
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Since this indentation bug is additive, every struct in the file that default instantiates a struct in its constructor will offset the indentation to the right by one level.&lt;/p&gt;

&lt;p&gt;The cause of this bug looks to be in &lt;b&gt;t_perl_generator::render_const_value()&lt;/b&gt;, which does not &lt;b&gt;indent()&lt;/b&gt; the keys set in the sub-object constructors. It also does not set &lt;b&gt;indent_down()&lt;/b&gt; at the end of instantiating the object.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13103063">THRIFT-4334</key>
            <summary>Perl indentation incorrect when defaulting field attribute to a struct</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="5" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.svg">Trivial</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jking3">James E. King III</assignee>
                                    <reporter username="bforbis">Brian Forbis</reporter>
                        <labels>
                    </labels>
                <created>Mon, 18 Sep 2017 20:11:15 +0000</created>
                <updated>Thu, 14 Dec 2017 13:55:21 +0000</updated>
                            <resolved>Mon, 25 Sep 2017 03:35:22 +0000</resolved>
                                    <version>0.10.0</version>
                                    <fixVersion>0.11.0</fixVersion>
                                    <component>Perl - Compiler</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="16178324" author="githubbot" created="Sun, 24 Sep 2017 19:25:55 +0000"  >&lt;p&gt;GitHub user bforbis opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/1373&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/1373&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-4334&quot; title=&quot;Perl indentation incorrect when defaulting field attribute to a struct&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-4334&quot;&gt;&lt;del&gt;THRIFT-4334&lt;/del&gt;&lt;/a&gt;: Fix perl indentation for default attribute values&lt;/p&gt;



&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/bforbis/thrift&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/bforbis/thrift&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-4334&quot; title=&quot;Perl indentation incorrect when defaulting field attribute to a struct&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-4334&quot;&gt;&lt;del&gt;THRIFT-4334&lt;/del&gt;&lt;/a&gt;-perl-indentation&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/1373.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/1373.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #1373&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit acb7b85b1639f4c7455772c37a33b6c437d0a7cd&lt;br/&gt;
Author: Brian Forbis &amp;lt;bforbis@athenahealth.com&amp;gt;&lt;br/&gt;
Date:   2017-09-23T05:06:08Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-4334&quot; title=&quot;Perl indentation incorrect when defaulting field attribute to a struct&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-4334&quot;&gt;&lt;del&gt;THRIFT-4334&lt;/del&gt;&lt;/a&gt;: Fix perl indentation for default attribute values of array / hashes / objects&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="16178325" author="githubbot" created="Sun, 24 Sep 2017 19:26:31 +0000"  >&lt;p&gt;Github user bforbis commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/1373&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/1373&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    I didn&apos;t see a testing infrastructure for testing the perl compiler, but I have put reproduction steps in the description of the associated JIRA ticket&lt;/p&gt;</comment>
                            <comment id="16178358" author="githubbot" created="Sun, 24 Sep 2017 20:29:06 +0000"  >&lt;p&gt;Github user jeking3 commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/1373&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/1373&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Please change the branch target to apache/master.&lt;/p&gt;</comment>
                            <comment id="16178485" author="githubbot" created="Mon, 25 Sep 2017 03:34:00 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/1373&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/1373&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16178486" author="jking3" created="Mon, 25 Sep 2017 03:35:22 +0000"  >&lt;p&gt;Committed - thanks.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13106951">THRIFT-4355</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 8 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3k7fb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>