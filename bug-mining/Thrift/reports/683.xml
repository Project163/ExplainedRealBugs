<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 08:06:37 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[THRIFT-1805] Thrift should not swallow ALL exceptions</title>
                <link>https://issues.apache.org/jira/browse/THRIFT-1805</link>
                <project id="12310800" key="THRIFT">Thrift</project>
                    <description>&lt;p&gt;In Thrift 0.8.0, Thrift generated Java code did not swallow application exceptions. As a result of &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-1658&quot; title=&quot;Java thrift server is not throwing TApplicationException&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-1658&quot;&gt;&lt;del&gt;THRIFT-1658&lt;/del&gt;&lt;/a&gt;, this behavior changed in 0.9.0 and now the generated code swallows ALL application exceptions (via ProcessFunction). Apparently this was the behavior in Thrift 0.6.0 and while I see the rationale, it is breaking our applications.&lt;/p&gt;

&lt;p&gt;Our code relies on the fact that exceptions can propagate outside of Thrift for certain things (e.g., to aggressively drop connections for clients that send invalid/malformed requests). ProcessFunction makes it near impossible to do this &amp;#8211; not only does it swallow the exception, it also loses all information about the original exception and just writes out a generic TApplicationException.&lt;/p&gt;

&lt;p&gt;IMO ProcessFunction should only catch TException. If the application code wants to use other exceptions for some reason (in particular, Errors and RuntimeExceptions), Thrift shouldn&apos;t prevent that.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12625186">THRIFT-1805</key>
            <summary>Thrift should not swallow ALL exceptions</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ctubbsii">Christopher Tubbs</assignee>
                                    <reporter username="diwaker">Diwaker Gupta</reporter>
                        <labels>
                    </labels>
                <created>Mon, 24 Dec 2012 18:19:43 +0000</created>
                <updated>Fri, 1 Mar 2019 01:12:41 +0000</updated>
                            <resolved>Tue, 28 Feb 2017 04:41:54 +0000</resolved>
                                    <version>0.9</version>
                                    <fixVersion>0.11.0</fixVersion>
                                    <component>Java - Compiler</component>
                    <component>Java - Library</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>11</watches>
                                                                                                                <comments>
                            <comment id="13545493" author="roger.meier" created="Sun, 6 Jan 2013 21:07:19 +0000"  >&lt;p&gt;Only catch TException via ProcessFunction makes sense.&lt;/p&gt;

&lt;p&gt;Java has several issues when I run the cross language test suite(&lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-847&quot; title=&quot;Test Framework harmonization across all languages&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-847&quot;&gt;&lt;del&gt;THRIFT-847&lt;/del&gt;&lt;/a&gt;)&lt;br/&gt;
see ThriftTest.thrift and test/test.sh&lt;/p&gt;

&lt;p&gt;could you have a look at the existing testException Method and provide a patch for this as well?&lt;br/&gt;
&lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=thrift.git;a=blob;f=lib/java/test/org/apache/thrift/server/ServerTestBase.java&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=thrift.git;a=blob;f=lib/java/test/org/apache/thrift/server/ServerTestBase.java&lt;/a&gt;;&lt;/p&gt;


</comment>
                            <comment id="13559155" author="diwaker" created="Mon, 21 Jan 2013 22:06:23 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=roger.meier&quot; class=&quot;user-hover&quot; rel=&quot;roger.meier&quot;&gt;roger.meier&lt;/a&gt;, I was able to run the Java unit tests successfully without any problems. I don&apos;t see why my suggested change should have any impact on ServerTestBase.testException. I&apos;m now trying to run the integration test but they have other issues on OS X (no &lt;tt&gt;timeout&lt;/tt&gt; command, for instance) because of which I&apos;m unable to verify.&lt;/p&gt;</comment>
                            <comment id="13559159" author="diwaker" created="Mon, 21 Jan 2013 22:10:12 +0000"  >&lt;p&gt;Also available at &lt;a href=&quot;https://github.com/maginatics/thrift/tree/feature/THRIFT-1805&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/maginatics/thrift/tree/feature/THRIFT-1805&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13560977" author="roger.meier" created="Wed, 23 Jan 2013 19:20:29 +0000"  >&lt;p&gt;Thanks Gupta!&lt;br/&gt;
committed.&lt;/p&gt;</comment>
                            <comment id="13561073" author="hudson" created="Wed, 23 Jan 2013 20:43:53 +0000"  >&lt;p&gt;Integrated in Thrift #619 (See &lt;a href=&quot;https://builds.apache.org/job/Thrift/619/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Thrift/619/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-1805&quot; title=&quot;Thrift should not swallow ALL exceptions&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-1805&quot;&gt;&lt;del&gt;THRIFT-1805&lt;/del&gt;&lt;/a&gt; Thrift should not swallow ALL exceptions (Revision 7b96b2249a43ae75b48e0aba7e8beffc67b32d93)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
roger : &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=thrift.git&amp;amp;a=commit&amp;amp;h=7b96b2249a43ae75b48e0aba7e8beffc67b32d93&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=thrift.git&amp;amp;a=commit&amp;amp;h=7b96b2249a43ae75b48e0aba7e8beffc67b32d93&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;lib/java/src/org/apache/thrift/ProcessFunction.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14042756" author="ctubbsii" created="Tue, 24 Jun 2014 22:00:59 +0000"  >&lt;p&gt;Contrary to the description and intent of this issue, it seems that this breaks things for users expecting consistent behavior with 0.9.0 (and 0.6.0 and earlier), and actually causes thrift to hide exception information from the client.&lt;/p&gt;

&lt;p&gt;The expected behavior was that unknown server-side errors would result in a TApplicationException.INTERNAL_ERROR, but now it just closes the connection and the client sees a network exception (TTransportException) instead, which a reasonable client might just conclude was a temporary network hiccup and retry.&lt;/p&gt;</comment>
                            <comment id="14042803" author="ctubbsii" created="Tue, 24 Jun 2014 22:44:12 +0000"  >&lt;p&gt;After some further investigation, it looks like the problem is worse than it looked. This patch left no mechanism to even get an application&apos;s TException to the ProcessFunction class where this would be wrapped. The only way it looks to preserve the behavior of clients being aware of server-side errors is to write a separate user exception class, to be serialized on the wire, which breaks the wire compatibility between 0.9.0 and 0.9.1 (as I understand it).&lt;/p&gt;</comment>
                            <comment id="14043430" author="ben.craig" created="Wed, 25 Jun 2014 13:22:21 +0000"  >&lt;p&gt;Adding an exception to a class doesn&apos;t break the wire format, but it probably doesn&apos;t do what you want either.  Exceptions in the .thrift file are treated similarly to optional members of a struct.  It will get serialized across, but if the receiver isn&apos;t expecting it, the receiver will discard it.&lt;/p&gt;

&lt;p&gt;As to Christopher&apos;s problem, I can see reasonable arguments for either behavior (close socket on error vs. send TApplicationException on error).  My general preference is to close the socket on errors, but maybe it would make sense to provide a constructor arg or codegen flag to let people choose.&lt;/p&gt;</comment>
                            <comment id="15033849" author="kturner" created="Tue, 1 Dec 2015 15:18:38 +0000"  >&lt;p&gt;Just want to chime in and explain Accumulo&apos;s use case.  Accumulo relied on TApplicationException in the following way.&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;When Accumulo client code saw a TApplicationException it assumed an unexpected server side error had occurred and propogated this to the user by throwing an AccumuloServerException.&lt;/li&gt;
	&lt;li&gt;When Accumulo client code saw a TTransportException, it assumed some sort of network problem occurred or a tablet server died.  In this case Accumulo client code will automatically retry w/o the user ever being aware.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;This change in behavior was very disruptive for Accumulo.  We worked around it, but just ran into an issue with our work around for the one-way method case. See &lt;a href=&quot;https://issues.apache.org/jira/browse/ACCUMULO-4065&quot; title=&quot;Oneway Thrift calls leave message on client&amp;#39;s InputStream&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ACCUMULO-4065&quot;&gt;&lt;del&gt;ACCUMULO-4065&lt;/del&gt;&lt;/a&gt; if interested and a &lt;a href=&quot;https://github.com/apache/accumulo/pull/56&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;proposed work around&lt;/a&gt;.  &lt;/p&gt;</comment>
                            <comment id="15036776" author="ctubbsii" created="Wed, 2 Dec 2015 22:31:42 +0000"  >&lt;p&gt;Over a year later and this issue is still affecting us. I think this was quite an annoying regression. TApplicationException served an important role on the client side... similar to an HTTP 5xx error vs. other HTTP errors. Collapsing them, as this seems to do, makes workarounds to recreate that behavior pretty cumbersome.&lt;/p&gt;</comment>
                            <comment id="15043579" author="roger.meier" created="Sat, 5 Dec 2015 23:55:42 +0000"  >&lt;p&gt;You are welcome to help improving Java within Thrift, patches or verification of available patches are very welcome. Also overall code quality fixes for the Java code base.&lt;/p&gt;</comment>
                            <comment id="15047344" author="ctubbsii" created="Tue, 8 Dec 2015 19:37:38 +0000"  >&lt;p&gt;I&apos;m not sure it&apos;s a matter of just improving through patches/testing/QA fixes. I think it&apos;s also a matter of PMC direction to determine some guidelines on behavior for the code, so it doesn&apos;t regress every time somebody has a new use case. Patches can be evaluated against those guidelines.&lt;/p&gt;

&lt;p&gt;In this case, for example, there was a regression introduced, which had occurred and been fixed before (&lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-1658&quot; title=&quot;Java thrift server is not throwing TApplicationException&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-1658&quot;&gt;&lt;del&gt;THRIFT-1658&lt;/del&gt;&lt;/a&gt;). Examining the code, there appears to have been a conscious decision at one point to create two classes of exceptions, yet the regression overruled this prior decision. That shouldn&apos;t have happened if that decision had been encapsulated into some guidelines for expected behavior.&lt;/p&gt;

&lt;p&gt;In other cases, regressions have flip-flopped (&lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-2173&quot; title=&quot;Move FrameBuffer creation to a factory method for cusomization&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-2173&quot;&gt;&lt;del&gt;THRIFT-2173&lt;/del&gt;&lt;/a&gt; and related) several times, each time the patch being accepted without much question, even though it reversed a prior decision.&lt;/p&gt;

&lt;p&gt;In addition to patches/testing/QA, I think the Thrift PMC could help this situation by making some decisions for the project going forward, to increase stability. Some such things:&lt;/p&gt;

&lt;p&gt;1. Adopt Semantic Versioning with a well-defined public API which addresses libraries, the IDL, and generated code.&lt;br/&gt;
2. Adopt a policy for maintaining on-the-wire compatibility in terms of the versioning scheme chosen.&lt;br/&gt;
3. When a change in behavior causes problems and a decision must be made, document the behavior which was decided upon (even if it&apos;s just a comment in the code), so that future patches do not reverse prior decisions, without some degree of oversight.&lt;/p&gt;

&lt;p&gt;These aren&apos;t foolproof, but some guidelines for the direction of the project could help contributors make higher quality contributions.&lt;/p&gt;</comment>
                            <comment id="15047410" author="elserj" created="Tue, 8 Dec 2015 20:20:42 +0000"  >&lt;p&gt;Roger&apos;s comment really hits the nail on the head:&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;You are welcome to help improving Java within Thrift&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ctubbsii&quot; class=&quot;user-hover&quot; rel=&quot;ctubbsii&quot;&gt;ctubbsii&lt;/a&gt;, I think all of the things you suggested could still be driven by someone carrying the torch. It&apos;s not like there are examples where Thrift knowingly denied things that would have helped the points you outlined.&lt;/p&gt;

&lt;p&gt;It&apos;s a priority to you (us, depending on the hat I&apos;m wearing). If we want to see action, maybe we are the ones who need to push for the good changes you outlined.&lt;/p&gt;</comment>
                            <comment id="15047459" author="ctubbsii" created="Tue, 8 Dec 2015 21:03:00 +0000"  >&lt;p&gt;Sure, I definitely think a regular contributor could carry this torch, but I just mean that some of the decision-making needs to be done by the PMC. Regular contributors can ask for Semantic Versioning, but cannot establish that as a policy for the project. That&apos;s the job of the PMC.&lt;/p&gt;

&lt;p&gt;Thrift has been very welcoming of contributions, but that can also be part of the problem: contributions which are mutually exclusive are both welcomed and accepted, and behavior flip-flops between versions. At some point, the PMC needs to make a decision about which behavior is the desired behavior, in order to guide future contributions.&lt;/p&gt;</comment>
                            <comment id="15049363" author="roger.meier" created="Wed, 9 Dec 2015 20:42:46 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=elserj&quot; class=&quot;user-hover&quot; rel=&quot;elserj&quot;&gt;elserj&lt;/a&gt;, you are right. It is up to you to show interest and contribute on the Java part of Thrift. There are not that many patches and improvement coming in for Java nowadays. Managing every api change within PMC is not ideal as we do not have enough Java stakeholders there. We need to discuss these topics within Jira or the dev mailing list to get some more Java people involved.&lt;br/&gt;
There are many other projects out there using Thrift without the Apache sister projects and they use other languages such as go, nodejs, c++. I would really like to have more involvement of Apache sister projects and I guess most of them depend on Java and they should integrate very smooth.&lt;/p&gt;</comment>
                            <comment id="15140585" author="nsuke" created="Wed, 10 Feb 2016 09:54:23 +0000"  >&lt;p&gt;It seems that other languages including C++, Go, C#, Node.js, Ruby and Haskell catche all errors and send exceptions back to the client.&lt;br/&gt;
I think the default behavior at least should be the same as other implementations.&lt;/p&gt;

&lt;p&gt;If we want to preserve the current behavior, an option may be added to TProcessor and its derived types, for example.&lt;/p&gt;

&lt;p&gt;BTW, Java async processor is also problematic. It truly swallows everything and does not even bother disconnecting.&lt;/p&gt;</comment>
                            <comment id="15143431" author="jensg" created="Thu, 11 Feb 2016 20:19:56 +0000"  >&lt;blockquote&gt;
&lt;p&gt;It seems that other languages including C++, Go, C#, Node.js, Ruby and Haskell catche all errors and send exceptions back to the client.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;There has been some discussion around this but in my humble personal opinion this should be the default. I don&apos;t want anybody to crash my server or to hard-drop the connection just because some edge case in some arbitrary routine is not properly handled (which in real life happens) and throws. &lt;/p&gt;

&lt;p&gt;I also can&apos;t see the value in being required otherwise to add that very same code to every single interface method implementation by hand if I don&apos;t want the default crashy behaviour. That&apos;s why I use a framework and a code generator in the first place, isn&apos;t it? And as it turned out, some other people seem to have the same view of things.&lt;/p&gt;</comment>
                            <comment id="15143433" author="jensg" created="Thu, 11 Feb 2016 20:20:55 +0000"  >&lt;p&gt;Of course, just swallowing and telling clients &quot;all is rosy over here&quot; is not an option. There&apos;s no doubt about that.&lt;/p&gt;</comment>
                            <comment id="15143491" author="ctubbsii" created="Thu, 11 Feb 2016 20:53:59 +0000"  >&lt;p&gt;The original design (since version 0.2, &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-378&quot; title=&quot;Java servers do not turn internal errors into thrift exceptions&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-378&quot;&gt;&lt;del&gt;THRIFT-378&lt;/del&gt;&lt;/a&gt;) did seem to provide a useful exception back to the clients (TApplicationException), which was clearly distinguishable from intended exceptions sent from the server created by the user, and also easily distinguishable from client-side exceptions due to, say, temporary network errors. I really liked how that original behavior worked, but it has flip-flopped with &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-447&quot; title=&quot;Make an abstract base Client class so we can generate less code&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-447&quot;&gt;&lt;del&gt;THRIFT-447&lt;/del&gt;&lt;/a&gt; in 0.7, &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-1658&quot; title=&quot;Java thrift server is not throwing TApplicationException&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-1658&quot;&gt;&lt;del&gt;THRIFT-1658&lt;/del&gt;&lt;/a&gt; in 0.9, &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-1805&quot; title=&quot;Thrift should not swallow ALL exceptions&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-1805&quot;&gt;&lt;del&gt;THRIFT-1805&lt;/del&gt;&lt;/a&gt; in 0.9.1.&lt;/p&gt;

&lt;p&gt;I&apos;m not sure the framework should catch server-side Errors (those can&apos;t really be handled reliably, but an argument could be made for a best-effort attempt to let the client know anyway)... but server-side RuntimeExceptions, yeah, that&apos;d be very helpful helpful for the framework to turn into TApplicationExceptions like it was intended to do since 0.2/&lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-378&quot; title=&quot;Java servers do not turn internal errors into thrift exceptions&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-378&quot;&gt;&lt;del&gt;THRIFT-378&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="15143766" author="nsuke" created="Fri, 12 Feb 2016 00:19:53 +0000"  >&lt;p&gt;Should have noted here: I&apos;ve proposed a policy for TProcessor exception handling in &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-3607&quot; title=&quot;Unify exception handling policy of TProcessor&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-3607&quot;&gt;THRIFT-3607&lt;/a&gt; .&lt;br/&gt;
If everyone is happy with it, the plan is to update cross language tests, after that we have a consensus on Java sync processor here.&lt;/p&gt;

&lt;p&gt;The current behavior does give more control to users if (and only if) they&apos;re implementing custom servers.&lt;br/&gt;
To me, this extra control should be added on top of &quot;standard&quot; behavior if at all, that is to send TApplicationException back.&lt;br/&gt;
An example is TTransport::getOrigin method in C++ that gets clients&apos; address.&lt;br/&gt;
It opens a possibility for users&apos; applications to, e.g., accumulate statistics on which client causes errors and prohibit them using external proxy etc.&lt;br/&gt;
So the bottom line is that, in my opinion, we can remove the current behavior but be open to alternative suggestions that does not modify the default behavior.&lt;/p&gt;</comment>
                            <comment id="15144629" author="jensg" created="Fri, 12 Feb 2016 14:32:01 +0000"  >&lt;p&gt;Not sure if we really talk about the same. I am also not only talking about Java, so I have a slight problem with what could be the &quot;current behaviour&quot;. &lt;/p&gt;

&lt;p&gt;What I mean is the &quot;last line of defense&quot;, if you will. There is no doubt that in an ideal world any exception would be properly caught, but, unfortunately, in real life things happen. I talk about the additional code in the processor implementation that ensures that any uncaught exception does not blow up the server or unexpectedly drop the connection. &lt;/p&gt;

&lt;p&gt;First, if some call is able to achieve this, even by accident, this is the way to the next &quot;Limit recursion depth to 64&quot; issue. Second, dropping a connection because the server (not the client!) has an implementation bug and thus crashes under some otherwise legitimate circumstances, is somewhat unexpected to the well-behaving client. &lt;/p&gt;

&lt;p&gt;Anyone is free to catch exceptions at any place and add whatever code is needed to keep &quot;statistics on which client causes errors&quot; (again, it doesn&apos;t have to be the client where the problem is). But *&lt;b&gt;that&apos;s really an addon functionality&lt;/b&gt;* and if I don&apos;t install such an feature, I still don&apos;t want anybody to be able to DOS my server simply by calling a buggy  piece of implementation. &lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;&lt;br/&gt;
we can remove the current behavior but be open to alternative suggestions that does not modify the default behavior.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Just for the records: What is *&lt;b&gt;current&lt;/b&gt;* and what is *&lt;b&gt;default&lt;/b&gt;* behaviour?&lt;/p&gt;
</comment>
                            <comment id="15145837" author="nsuke" created="Sat, 13 Feb 2016 06:39:48 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jensg&quot; class=&quot;user-hover&quot; rel=&quot;jensg&quot;&gt;jensg&lt;/a&gt; sorry that was indeed vague.&lt;br/&gt;
&quot;current&quot; -&amp;gt; current Java behavior that only catches TException&lt;br/&gt;
&quot;default&apos; -&amp;gt; sending back TApplicationException generally, and potentially what is described in &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-3607&quot; title=&quot;Unify exception handling policy of TProcessor&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-3607&quot;&gt;THRIFT-3607&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;So we&apos;re basically talking about the same.&lt;br/&gt;
Slightly difference is about TTransportException caused by disconnect where the processor have no means to send an exception back any more and rather needs to quit promptly.&lt;/p&gt;

&lt;p&gt;Many TProcessor implementations try to send errors through broken transport *&lt;b&gt;outside&lt;/b&gt;* try blocks in such occasions.&lt;br/&gt;
It naturally results in another TTransportException from the now-broken transport, but typically it does not kill the server but only the processor object/thread.&lt;br/&gt;
Some implementations specifically rethrow TTransportException and only catch the other errors.&lt;br/&gt;
I found the latter preferrable to the former and it&apos;s where my view is slightly different from your view on &quot;last line of defense&quot;:&lt;br/&gt;
here, I&apos;m not seeking to ensure catch-all behavior, based on an observation that current servers are surviving TTransportExceptions just fine.&lt;/p&gt;

&lt;p&gt;Thinking about it, the current proposal at least needs to additionally allow &quot;catch TTransportException and gracefully exit&quot; behavior, as it can be even better than explicit rethrow.&lt;br/&gt;
You may still prefer making it TProcessor&apos;s clear responsibility to handle all exceptions, though.&lt;/p&gt;

&lt;p&gt;So far, I&apos;ll change my proposal to only specify mappings from &quot;handler errors&quot; to &quot;observable behaviors from client&quot;, leaving it to the implementation how to do that, i.e.:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;TApplicationException -&amp;gt; see the message and the type as thrown, not hidden by INTERNAL_ERROR&lt;/li&gt;
	&lt;li&gt;TTransportException -&amp;gt; connection is either already broken or newly broken&lt;/li&gt;
	&lt;li&gt;other -&amp;gt; TApplicationException(INTERNAL_ERROR)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Further feedback is very much appreciated, from Jens or anyone else.&lt;/p&gt;</comment>
                            <comment id="15146005" author="jensg" created="Sat, 13 Feb 2016 14:52:44 +0000"  >&lt;p&gt;I said very intentionally &quot;&lt;b&gt;last&lt;/b&gt; line of defense&quot; and &quot;catch &lt;b&gt;uncaught&lt;/b&gt; errors&quot;. There is no need to handle things again that are already properly handled. Bottom line =&amp;gt; +1&lt;/p&gt;</comment>
                            <comment id="15860648" author="githubbot" created="Fri, 10 Feb 2017 03:58:01 +0000"  >&lt;p&gt;GitHub user ctubbsii opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/1186&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/1186&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-1805&quot; title=&quot;Thrift should not swallow ALL exceptions&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-1805&quot;&gt;&lt;del&gt;THRIFT-1805&lt;/del&gt;&lt;/a&gt; Provide option for handling RTEs&lt;/p&gt;

&lt;p&gt;    Adds a Java option to the generator to generate code which lets Thrift&lt;br/&gt;
    handle RuntimeExceptions from a service, and present them as&lt;br/&gt;
    TApplicationException to the client.&lt;/p&gt;

&lt;p&gt;    This addresses a back-and-forth debate over the expected behavior of&lt;br/&gt;
    this in Java services, and the resulting breakage, as described in&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-1805&quot; title=&quot;Thrift should not swallow ALL exceptions&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-1805&quot;&gt;&lt;del&gt;THRIFT-1805&lt;/del&gt;&lt;/a&gt; and related issues, by making the behavior configurable.&lt;/p&gt;

&lt;p&gt;    Throwable types are not handled, because it is generally ill-advised to&lt;br/&gt;
    handle Error types within a Java application. So, this only allows&lt;br/&gt;
    configuration of handling RuntimeException.&lt;/p&gt;

&lt;p&gt;    This patch preserves current behavior as the default, and works with&lt;br/&gt;
    previously generated code.&lt;/p&gt;

&lt;p&gt;    This patch does not affect AsyncProcessFunction exception handling.&lt;/p&gt;

&lt;p&gt;    Related JIRAs: &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-378&quot; title=&quot;Java servers do not turn internal errors into thrift exceptions&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-378&quot;&gt;&lt;del&gt;THRIFT-378&lt;/del&gt;&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-1658&quot; title=&quot;Java thrift server is not throwing TApplicationException&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-1658&quot;&gt;&lt;del&gt;THRIFT-1658&lt;/del&gt;&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-1805&quot; title=&quot;Thrift should not swallow ALL exceptions&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-1805&quot;&gt;&lt;del&gt;THRIFT-1805&lt;/del&gt;&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-3607&quot; title=&quot;Unify exception handling policy of TProcessor&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-3607&quot;&gt;THRIFT-3607&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/ctubbsii/thrift&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/ctubbsii/thrift&lt;/a&gt; handle-runtimeexceptions&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/1186.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/1186.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #1186&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 48ee27b210edf2d92af2f5060820d77ca0898aff&lt;br/&gt;
Author: Christopher Tubbs &amp;lt;ctubbsii@apache.org&amp;gt;&lt;br/&gt;
Date:   2017-02-10T03:32:00Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-1805&quot; title=&quot;Thrift should not swallow ALL exceptions&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-1805&quot;&gt;&lt;del&gt;THRIFT-1805&lt;/del&gt;&lt;/a&gt; Provide option for handling RTEs&lt;/p&gt;

&lt;p&gt;    Adds a Java option to the generator to generate code which lets Thrift&lt;br/&gt;
    handle RuntimeExceptions from a service, and present them as&lt;br/&gt;
    TApplicationException to the client.&lt;/p&gt;

&lt;p&gt;    This addresses a back-and-forth debate over the expected behavior of&lt;br/&gt;
    this in Java services, and the resulting breakage, as described in&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-1805&quot; title=&quot;Thrift should not swallow ALL exceptions&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-1805&quot;&gt;&lt;del&gt;THRIFT-1805&lt;/del&gt;&lt;/a&gt; and related issues, by making the behavior configurable.&lt;/p&gt;

&lt;p&gt;    Throwable types are not handled, because it is generally ill-advised to&lt;br/&gt;
    handle Error types within a Java application. So, this only allows&lt;br/&gt;
    configuration of handling RuntimeException.&lt;/p&gt;

&lt;p&gt;    This patch preserves current behavior as the default, and works with&lt;br/&gt;
    previously generated code.&lt;/p&gt;

&lt;p&gt;    This patch does not affect AsyncProcessFunction exception handling.&lt;/p&gt;

&lt;p&gt;    Related JIRAs: &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-378&quot; title=&quot;Java servers do not turn internal errors into thrift exceptions&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-378&quot;&gt;&lt;del&gt;THRIFT-378&lt;/del&gt;&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-1658&quot; title=&quot;Java thrift server is not throwing TApplicationException&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-1658&quot;&gt;&lt;del&gt;THRIFT-1658&lt;/del&gt;&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-1805&quot; title=&quot;Thrift should not swallow ALL exceptions&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-1805&quot;&gt;&lt;del&gt;THRIFT-1805&lt;/del&gt;&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-3607&quot; title=&quot;Unify exception handling policy of TProcessor&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-3607&quot;&gt;THRIFT-3607&lt;/a&gt;&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15860657" author="githubbot" created="Fri, 10 Feb 2017 04:01:29 +0000"  >&lt;p&gt;Github user ctubbsii commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/1186&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/1186&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    I&apos;m not familiar enough with Thrift&apos;s testing framework to add tests, but this works tested locally.&lt;br/&gt;
    I don&apos;t know if this makes sense for other languages, but it seems to make a lot of sense for Java.&lt;/p&gt;</comment>
                            <comment id="15861445" author="githubbot" created="Fri, 10 Feb 2017 15:53:25 +0000"  >&lt;p&gt;Github user keith-turner commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/1186#discussion_r100562753&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/1186#discussion_r100562753&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: compiler/cpp/src/thrift/generate/t_java_generator.cc &amp;#8212;&lt;br/&gt;
    @@ -91,6 +92,8 @@ class t_java_generator : public t_oop_generator &lt;/p&gt;
{
             reuse_objects_ = true;
           }
&lt;p&gt; else if( iter-&amp;gt;first.compare(&quot;option_type&quot;) == 0) &lt;/p&gt;
{
             use_option_type_ = true;
    +      }
&lt;p&gt; else if( iter-&amp;gt;first.compare(&quot;handle_runtime_exceptions&quot;) == 0) {&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    I think the behavior of this java generator option be documented.  Where should it be documented?&lt;/p&gt;</comment>
                            <comment id="15861460" author="githubbot" created="Fri, 10 Feb 2017 16:05:47 +0000"  >&lt;p&gt;Github user jeking3 commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/1186#discussion_r100565597&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/1186#discussion_r100565597&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: compiler/cpp/src/thrift/generate/t_java_generator.cc &amp;#8212;&lt;br/&gt;
    @@ -91,6 +92,8 @@ class t_java_generator : public t_oop_generator &lt;/p&gt;
{
             reuse_objects_ = true;
           }
&lt;p&gt; else if( iter-&amp;gt;first.compare(&quot;option_type&quot;) == 0) &lt;/p&gt;
{
             use_option_type_ = true;
    +      }
&lt;p&gt; else if( iter-&amp;gt;first.compare(&quot;handle_runtime_exceptions&quot;) == 0) {&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    Yep, should be added to the structure at the end of the file at the very least.&lt;/p&gt;

&lt;p&gt;    It would be nice to have more comprehensive documentation on the java options for the compiler in the java runtime readme, perhaps... but getting it into the compiler&apos;s --help output is required as stated above.&lt;/p&gt;</comment>
                            <comment id="15861584" author="githubbot" created="Fri, 10 Feb 2017 17:46:23 +0000"  >&lt;p&gt;Github user Jens-G commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/1186#discussion_r100586356&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/1186#discussion_r100586356&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: compiler/cpp/src/thrift/generate/t_java_generator.cc &amp;#8212;&lt;br/&gt;
    @@ -3527,6 +3531,11 @@ void t_java_generator::generate_process_function(t_service* tservice, t_function&lt;br/&gt;
       indent(f_service_) &amp;lt;&amp;lt; &quot;  return &quot; &amp;lt;&amp;lt; ((tfunction-&amp;gt;is_oneway()) ? &quot;true&quot; : &quot;false&quot;) &amp;lt;&amp;lt; &quot;;&quot; &amp;lt;&amp;lt; endl;&lt;br/&gt;
       indent(f_service_) &amp;lt;&amp;lt; &quot;}&quot; &amp;lt;&amp;lt; endl &amp;lt;&amp;lt; endl;&lt;/p&gt;

&lt;p&gt;    +  indent(f_service_) &amp;lt;&amp;lt; &quot;@Override&quot; &amp;lt;&amp;lt; endl;&lt;br/&gt;
    +  indent(f_service_) &amp;lt;&amp;lt; &quot;protected boolean handleRuntimeExceptions() &lt;/p&gt;
{&quot; &amp;lt;&amp;lt; endl;
    +  indent(f_service_) &amp;lt;&amp;lt; &quot;  return &quot; &amp;lt;&amp;lt; ((handle_runtime_exceptions_) ? &quot;true&quot; : &quot;false&quot;) &amp;lt;&amp;lt; &quot;;&quot; &amp;lt;&amp;lt; endl;
    +  indent(f_service_) &amp;lt;&amp;lt; &quot;}
&lt;p&gt;&quot; &amp;lt;&amp;lt; endl &amp;lt;&amp;lt; endl;&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    why not simply `return handle_runtime_exceptions_`?&lt;/p&gt;</comment>
                            <comment id="15861586" author="githubbot" created="Fri, 10 Feb 2017 17:47:33 +0000"  >&lt;p&gt;Github user Jens-G commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/1186#discussion_r100586606&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/1186#discussion_r100586606&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: compiler/cpp/src/thrift/generate/t_java_generator.cc &amp;#8212;&lt;br/&gt;
    @@ -91,6 +92,8 @@ class t_java_generator : public t_oop_generator &lt;/p&gt;
{
             reuse_objects_ = true;
           }
&lt;p&gt; else if( iter-&amp;gt;first.compare(&quot;option_type&quot;) == 0) &lt;/p&gt;
{
             use_option_type_ = true;
    +      }
&lt;p&gt; else if( iter-&amp;gt;first.compare(&quot;handle_runtime_exceptions&quot;) == 0) {&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    We implemented similar behaviour for other languages, IIRC one was Ruby. &lt;/p&gt;</comment>
                            <comment id="15861593" author="jensg" created="Fri, 10 Feb 2017 17:51:42 +0000"  >&lt;p&gt;&amp;gt; why not simply `return handle_runtime_exceptions_`?&lt;/p&gt;

&lt;p&gt;Because it would be wrong. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="15861847" author="githubbot" created="Fri, 10 Feb 2017 21:01:15 +0000"  >&lt;p&gt;Github user ctubbsii commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/1186#discussion_r100623293&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/1186#discussion_r100623293&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: compiler/cpp/src/thrift/generate/t_java_generator.cc &amp;#8212;&lt;br/&gt;
    @@ -91,6 +92,8 @@ class t_java_generator : public t_oop_generator &lt;/p&gt;
{
             reuse_objects_ = true;
           }
&lt;p&gt; else if( iter-&amp;gt;first.compare(&quot;option_type&quot;) == 0) &lt;/p&gt;
{
             use_option_type_ = true;
    +      }
&lt;p&gt; else if( iter-&amp;gt;first.compare(&quot;handle_runtime_exceptions&quot;) == 0) {&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    Updated PR with additional commit with --help doc.&lt;/p&gt;</comment>
                            <comment id="15864163" author="githubbot" created="Mon, 13 Feb 2017 18:33:49 +0000"  >&lt;p&gt;Github user keith-turner commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/1186#discussion_r100861533&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/1186#discussion_r100861533&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: compiler/cpp/src/thrift/generate/t_java_generator.cc &amp;#8212;&lt;br/&gt;
    @@ -5265,6 +5274,9 @@ THRIFT_REGISTER_GENERATOR(&lt;br/&gt;
         &quot;    android_legacy:  Do not use java.io.IOException(throwable) (available for Android 2.3 and &quot;&lt;br/&gt;
         &quot;above).\n&quot;&lt;br/&gt;
         &quot;    option_type:     Wrap optional fields in an Option type.\n&quot;&lt;br/&gt;
    +    &quot;    handle_runtime_exceptions:\n&quot;&lt;br/&gt;
    +    &quot;                     Generated services will handle RuntimeException as &quot;&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    I think the following documentation gives users a little more insight into what this option does.  Is there a length limit?  I was trying to make the following short. &lt;br/&gt;
    ```&lt;br/&gt;
    Adjust how server handles RuntimeException (RE). Default is to close connection on RE. This enables sending TApplicationException on RE.&lt;br/&gt;
    ```&lt;/p&gt;</comment>
                            <comment id="15864250" author="githubbot" created="Mon, 13 Feb 2017 19:18:49 +0000"  >&lt;p&gt;Github user ctubbsii commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/1186#discussion_r100873930&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/1186#discussion_r100873930&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: compiler/cpp/src/thrift/generate/t_java_generator.cc &amp;#8212;&lt;br/&gt;
    @@ -5265,6 +5274,9 @@ THRIFT_REGISTER_GENERATOR(&lt;br/&gt;
         &quot;    android_legacy:  Do not use java.io.IOException(throwable) (available for Android 2.3 and &quot;&lt;br/&gt;
         &quot;above).\n&quot;&lt;br/&gt;
         &quot;    option_type:     Wrap optional fields in an Option type.\n&quot;&lt;br/&gt;
    +    &quot;    handle_runtime_exceptions:\n&quot;&lt;br/&gt;
    +    &quot;                     Generated services will handle RuntimeException as &quot;&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    The output of `thrift --help` is already quite long, so I don&apos;t think an extra line or two is going to matter. What probably matters more is brevity and formatting for readability.&lt;/p&gt;

&lt;p&gt;    How about simply: `Send TApplicationException to clients when RuntimeException occurs on the server` ?&lt;/p&gt;</comment>
                            <comment id="15864270" author="githubbot" created="Mon, 13 Feb 2017 19:27:01 +0000"  >&lt;p&gt;Github user keith-turner commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/1186#discussion_r100875982&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/1186#discussion_r100875982&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: compiler/cpp/src/thrift/generate/t_java_generator.cc &amp;#8212;&lt;br/&gt;
    @@ -5265,6 +5274,9 @@ THRIFT_REGISTER_GENERATOR(&lt;br/&gt;
         &quot;    android_legacy:  Do not use java.io.IOException(throwable) (available for Android 2.3 and &quot;&lt;br/&gt;
         &quot;above).\n&quot;&lt;br/&gt;
         &quot;    option_type:     Wrap optional fields in an Option type.\n&quot;&lt;br/&gt;
    +    &quot;    handle_runtime_exceptions:\n&quot;&lt;br/&gt;
    +    &quot;                     Generated services will handle RuntimeException as &quot;&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    I like that.  I was also trying to document what the default behavior is.  When someone is trying to make decision about enabling the option, its nice to know what not enabling it means.&lt;/p&gt;</comment>
                            <comment id="15864471" author="githubbot" created="Mon, 13 Feb 2017 21:22:00 +0000"  >&lt;p&gt;Github user ctubbsii commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/1186#discussion_r100901172&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/1186#discussion_r100901172&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: compiler/cpp/src/thrift/generate/t_java_generator.cc &amp;#8212;&lt;br/&gt;
    @@ -5265,6 +5274,9 @@ THRIFT_REGISTER_GENERATOR(&lt;br/&gt;
         &quot;    android_legacy:  Do not use java.io.IOException(throwable) (available for Android 2.3 and &quot;&lt;br/&gt;
         &quot;above).\n&quot;&lt;br/&gt;
         &quot;    option_type:     Wrap optional fields in an Option type.\n&quot;&lt;br/&gt;
    +    &quot;    handle_runtime_exceptions:\n&quot;&lt;br/&gt;
    +    &quot;                     Generated services will handle RuntimeException as &quot;&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    I think it&apos;d be hard to properly explain the TTransportException the client will experience otherwise, in a short usage text.&lt;/p&gt;</comment>
                            <comment id="15864504" author="jking3" created="Mon, 13 Feb 2017 21:44:40 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jensg&quot; class=&quot;user-hover&quot; rel=&quot;jensg&quot;&gt;jensg&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=nsuke&quot; class=&quot;user-hover&quot; rel=&quot;nsuke&quot;&gt;nsuke&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=roger.meier&quot; class=&quot;user-hover&quot; rel=&quot;roger.meier&quot;&gt;roger.meier&lt;/a&gt; given you had significant input to this one, you should consider reviewing the solution and approve the pull request on github if you would like it to merge.  There have been two approvals already.&lt;/p&gt;</comment>
                            <comment id="15864547" author="githubbot" created="Mon, 13 Feb 2017 22:07:41 +0000"  >&lt;p&gt;Github user keith-turner commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/1186#discussion_r100911117&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/1186#discussion_r100911117&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: compiler/cpp/src/thrift/generate/t_java_generator.cc &amp;#8212;&lt;br/&gt;
    @@ -5265,6 +5274,9 @@ THRIFT_REGISTER_GENERATOR(&lt;br/&gt;
         &quot;    android_legacy:  Do not use java.io.IOException(throwable) (available for Android 2.3 and &quot;&lt;br/&gt;
         &quot;above).\n&quot;&lt;br/&gt;
         &quot;    option_type:     Wrap optional fields in an Option type.\n&quot;&lt;br/&gt;
    +    &quot;    handle_runtime_exceptions:\n&quot;&lt;br/&gt;
    +    &quot;                     Generated services will handle RuntimeException as &quot;&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    I don&apos;t think we need to mention anything about the client side w.r.t to TTransportException.  Saying anything about the client side is hard because of all the different language implementations.  &lt;/p&gt;

&lt;p&gt;    However this code is focused on generating a java server, so we can say what the java server will do.  The java server will either send TApplicationException or close the connection depending on this setting.&lt;/p&gt;</comment>
                            <comment id="15864602" author="githubbot" created="Mon, 13 Feb 2017 22:36:07 +0000"  >&lt;p&gt;Github user ctubbsii commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/1186#discussion_r100917042&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/1186#discussion_r100917042&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: compiler/cpp/src/thrift/generate/t_java_generator.cc &amp;#8212;&lt;br/&gt;
    @@ -5265,6 +5274,9 @@ THRIFT_REGISTER_GENERATOR(&lt;br/&gt;
         &quot;    android_legacy:  Do not use java.io.IOException(throwable) (available for Android 2.3 and &quot;&lt;br/&gt;
         &quot;above).\n&quot;&lt;br/&gt;
         &quot;    option_type:     Wrap optional fields in an Option type.\n&quot;&lt;br/&gt;
    +    &quot;    handle_runtime_exceptions:\n&quot;&lt;br/&gt;
    +    &quot;                     Generated services will handle RuntimeException as &quot;&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    Okay, I updated the docs based on my simplified wording above, but also with an explanation of the default behavior.&lt;/p&gt;</comment>
                            <comment id="15877115" author="jking3" created="Wed, 22 Feb 2017 00:45:20 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jensg&quot; class=&quot;user-hover&quot; rel=&quot;jensg&quot;&gt;jensg&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=nsuke&quot; class=&quot;user-hover&quot; rel=&quot;nsuke&quot;&gt;nsuke&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=roger.meier&quot; class=&quot;user-hover&quot; rel=&quot;roger.meier&quot;&gt;roger.meier&lt;/a&gt; could one (or more, of course!) of you review the current pull request which completed CI testing successfully?  There was a lot of discussion on this and I don&apos;t want to merge it until at least one of you has a chance to review and approve.  &lt;a href=&quot;https://github.com/apache/thrift/pull/1186&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/1186&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15879666" author="ctubbsii" created="Thu, 23 Feb 2017 01:38:46 +0000"  >&lt;p&gt;In Accumulo, I added a test, &quot;ThriftBehaviorIT.java&quot; which uses a bi-directional in-memory transport to test exception handling behavior in Thrift, using our internal &quot;RpcWrapper&quot; to wrap the service processor and catch RuntimeExceptions.&lt;br/&gt;
(contained in this commit: &lt;a href=&quot;https://github.com/apache/accumulo/commit/86e6fb44bbf59109a61b159d2bd3bcd0fcfdfa9f&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/accumulo/commit/86e6fb44bbf59109a61b159d2bd3bcd0fcfdfa9f&lt;/a&gt;)&lt;/p&gt;

&lt;p&gt;I&apos;d like the test (or something like it) to be adapted to prevent regressions in Thrift directly. I might even be willing to work on it. However, the current behavior is undefined when the server encounters a RuntimeException, and undefined behavior is untestable. I&apos;m not sure a regression test even makes sense unless the most recent regression is also reverted back to a well-defined behavior.&lt;/p&gt;</comment>
                            <comment id="15879717" author="githubbot" created="Thu, 23 Feb 2017 02:05:46 +0000"  >&lt;p&gt;Github user jeking3 commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/1186&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/1186&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    My guess is there would be fairly easy ways to unit test this behavior so it doesn&apos;t need to be an integration test.  Also, +1 for using the term Mocket.  Love that.&lt;/p&gt;</comment>
                            <comment id="15887241" author="githubbot" created="Tue, 28 Feb 2017 04:40:28 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/1186&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/1186&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15887242" author="jking3" created="Tue, 28 Feb 2017 04:41:55 +0000"  >&lt;p&gt;Committed - thanks.&lt;/p&gt;</comment>
                            <comment id="16071299" author="githubbot" created="Sat, 1 Jul 2017 15:39:49 +0000"  >&lt;p&gt;Github user Jens-G commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/1186&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/1186&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @ctubbsii: Could you please have a look at &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-4239&quot; title=&quot;Latest thrift breaks java build with handleRuntimeExceptions&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-4239&quot;&gt;&lt;del&gt;THRIFT-4239&lt;/del&gt;&lt;/a&gt;(&lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-4239)?&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/THRIFT-4239)?&lt;/a&gt; Not sure if it has sth. to do with your patch, but it came up while looking for the cause, so maybe you do have some input.&lt;/p&gt;</comment>
                            <comment id="16072796" author="githubbot" created="Mon, 3 Jul 2017 18:19:07 +0000"  >&lt;p&gt;Github user ctubbsii commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/1186&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/1186&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @Jens-G I will look and comment on &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-4239&quot; title=&quot;Latest thrift breaks java build with handleRuntimeExceptions&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-4239&quot;&gt;&lt;del&gt;THRIFT-4239&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                            <outwardlinks description="blocks">
                                        <issuelink>
            <issuekey id="12938135">THRIFT-3607</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12600206">THRIFT-1658</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12723489">ACCUMULO-2950</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12944984">THRIFT-3680</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13152287">THRIFT-4556</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12938135">THRIFT-3607</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="12310050">
                    <name>Regression</name>
                                            <outwardlinks description="breaks">
                                        <issuelink>
            <issuekey id="12945175">THRIFT-3686</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12723034">ACCUMULO-2935</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12565865" name="THRIFT-1805.patch" size="1068" author="diwaker" created="Mon, 21 Jan 2013 22:10:12 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>301728</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 20 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i16w07:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>248317</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>