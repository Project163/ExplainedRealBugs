<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 08:16:59 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[THRIFT-3088] TThreadPoolServer with Sasl auth may leak CLOSE_WAIT socket</title>
                <link>https://issues.apache.org/jira/browse/THRIFT-3088</link>
                <project id="12310800" key="THRIFT">Thrift</project>
                    <description>&lt;p&gt;Start TThreadPoolServer to server with TSaslServerTransport.Factory as transportFactory. While using nc to test the specified port whether reachable, it will leak CLOSE_WAIT socket.That&apos;s because nc will close socket at once while successful connect TThreadPoolServer, but the server still try using sasl protocol to build an inputTransport which of course failed at once. However inputTransport is null which makes it can&apos;t close socket properly which lead to CLOSE_WAIT socket.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12819592">THRIFT-3088</key>
            <summary>TThreadPoolServer with Sasl auth may leak CLOSE_WAIT socket</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="punwinger">Winger Pun</reporter>
                        <labels>
                    </labels>
                <created>Thu, 9 Apr 2015 07:18:24 +0000</created>
                <updated>Wed, 5 Apr 2017 17:17:46 +0000</updated>
                            <resolved>Sun, 12 Apr 2015 15:47:31 +0000</resolved>
                                    <version>0.9</version>
                                    <fixVersion>0.9.3</fixVersion>
                                    <component>Java - Library</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="14486930" author="githubbot" created="Thu, 9 Apr 2015 08:01:09 +0000"  >&lt;p&gt;GitHub user punwinger opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/432&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/432&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-3088&quot; title=&quot;TThreadPoolServer with Sasl auth may leak CLOSE_WAIT socket&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-3088&quot;&gt;&lt;del&gt;THRIFT-3088&lt;/del&gt;&lt;/a&gt; TThreadPoolServer with Sasl auth may leak CLOSE_WAIT socket&lt;/p&gt;

&lt;p&gt;    Start TThreadPoolServer to server with TSaslServerTransport.Factory as transportFactory. While using nc to test the specified port whether reachable, it will leak CLOSE_WAIT socket.That&apos;s because nc will close socket at once while successful connect TThreadPoolServer, but the server still try using sasl protocol to build an inputTransport which of course failed at once. However inputTransport is null which makes it can&apos;t close socket properly which lead to CLOSE_WAIT socket.&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/punwinger/thrift&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/punwinger/thrift&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-3088&quot; title=&quot;TThreadPoolServer with Sasl auth may leak CLOSE_WAIT socket&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-3088&quot;&gt;&lt;del&gt;THRIFT-3088&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/432.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/432.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #432&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit c6067aabe8d1c209020633bb20a3d3144559a917&lt;br/&gt;
Author: Winger Pun &amp;lt;punyj177@gmail.com&amp;gt;&lt;br/&gt;
Date:   2015-04-09T07:56:54Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-3088&quot; title=&quot;TThreadPoolServer with Sasl auth may leak CLOSE_WAIT socket&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-3088&quot;&gt;&lt;del&gt;THRIFT-3088&lt;/del&gt;&lt;/a&gt; TThreadPoolServer with Sasl auth may leak CLOSE_WAIT socket&lt;/p&gt;

&lt;p&gt;    TThreadPoolServer with Sasl auth may leak CLOSE_WAIT socket&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="14491538" author="roger.meier" created="Sun, 12 Apr 2015 15:47:31 +0000"  >&lt;p&gt;committed&lt;/p&gt;</comment>
                            <comment id="14491561" author="hudson" created="Sun, 12 Apr 2015 16:26:52 +0000"  >&lt;p&gt;SUCCESS: Integrated in Thrift #1502 (See &lt;a href=&quot;https://builds.apache.org/job/Thrift/1502/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Thrift/1502/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-3088&quot; title=&quot;TThreadPoolServer with Sasl auth may leak CLOSE_WAIT socket&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-3088&quot;&gt;&lt;del&gt;THRIFT-3088&lt;/del&gt;&lt;/a&gt; TThreadPoolServer with Sasl auth may leak CLOSE_WAIT socket (roger: rev b1a35da9168cca5a7524ab9814161f024da145df)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;lib/java/src/org/apache/thrift/server/TThreadPoolServer.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14494708" author="githubbot" created="Tue, 14 Apr 2015 19:24:46 +0000"  >&lt;p&gt;Github user jeking3 commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/432#discussion_r28361223&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/432#discussion_r28361223&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: lib/java/src/org/apache/thrift/server/TThreadPoolServer.java &amp;#8212;&lt;br/&gt;
    @@ -303,6 +303,10 @@ public void run() {&lt;br/&gt;
           if (outputTransport != null) &lt;/p&gt;
{
             outputTransport.close();
           }
&lt;p&gt;    +&lt;br/&gt;
    +      if (client_.isOpen()) {&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    This was also addressed in &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-3083&quot; title=&quot;C++ Consolidate server processing loops in TSimpleServer, TThreadedServer, TThreadPoolServer&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-3083&quot;&gt;&lt;del&gt;THRIFT-3083&lt;/del&gt;&lt;/a&gt; where the Simple, Threaded, and ThreadPool server serve() routine was consolidated; some servers closed the client and some did not.&lt;/p&gt;</comment>
                            <comment id="14494994" author="githubbot" created="Tue, 14 Apr 2015 22:02:52 +0000"  >&lt;p&gt;Github user jeking3 commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/432#discussion_r28375520&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/432#discussion_r28375520&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: lib/java/src/org/apache/thrift/server/TThreadPoolServer.java &amp;#8212;&lt;br/&gt;
    @@ -303,6 +303,10 @@ public void run() {&lt;br/&gt;
           if (outputTransport != null) &lt;/p&gt;
{
             outputTransport.close();
           }
&lt;p&gt;    +&lt;br/&gt;
    +      if (client_.isOpen()) {&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    Does TSimpleServer in java need the same change?&lt;/p&gt;</comment>
                            <comment id="14531152" author="githubbot" created="Wed, 6 May 2015 18:38:52 +0000"  >&lt;p&gt;Github user jeking3 commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/432#issuecomment-99567451&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/432#issuecomment-99567451&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    This was committed on Apr 12 and can be closed, however please check the TServer variants in Java and see that they use the same logic to close all resources.&lt;/p&gt;</comment>
                            <comment id="15385821" author="jking3" created="Wed, 20 Jul 2016 13:04:54 +0000"  >&lt;p&gt;The pull request for this issue is still open - please close it.&lt;/p&gt;</comment>
                            <comment id="15952539" author="githubbot" created="Sun, 2 Apr 2017 05:50:37 +0000"  >&lt;p&gt;Github user jeking3 commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/432&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/432&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @jfarrell this can be closed - it was fixed a while back.&lt;/p&gt;</comment>
                            <comment id="15957262" author="githubbot" created="Wed, 5 Apr 2017 17:17:46 +0000"  >&lt;p&gt;Github user jfarrell closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/432&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/432&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 32 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2d0p3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>