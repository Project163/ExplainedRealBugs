<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 07:56:39 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[THRIFT-562] Java is inconsistent checking for required fields</title>
                <link>https://issues.apache.org/jira/browse/THRIFT-562</link>
                <project id="12310800" key="THRIFT">Thrift</project>
                    <description>&lt;p&gt;In several places, the java generator does things like&lt;/p&gt;

&lt;p&gt;    // Most existing Thrift code does not use isset or optional/required,&lt;br/&gt;
    // so we treat &quot;default&quot; fields as required.&lt;br/&gt;
    bool is_optional = (*m_iter)-&amp;gt;get_req() == t_field::T_OPTIONAL;&lt;/p&gt;

&lt;p&gt;but it doesn&apos;t do so consistently.  This replaces the remaining == REQUIRED checks with != OPTIONAL to also include fields in the DEFAULT state.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12433083">THRIFT-562</key>
            <summary>Java is inconsistent checking for required fields</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jbellis">Jonathan Ellis</assignee>
                                    <reporter username="jbellis">Jonathan Ellis</reporter>
                        <labels>
                    </labels>
                <created>Fri, 14 Aug 2009 15:33:40 +0000</created>
                <updated>Tue, 1 Nov 2011 02:52:01 +0000</updated>
                            <resolved>Thu, 20 Aug 2009 01:00:45 +0000</resolved>
                                                    <fixVersion>0.2</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="12743402" author="jbellis" created="Fri, 14 Aug 2009 20:03:48 +0000"  >&lt;p&gt;new patch series attached.&lt;/p&gt;

&lt;p&gt;0001 cleans up the boilerplate struct creation by moving common test code into StructFactory.&lt;br/&gt;
0002 makes the change to the compiler and adds required fields to CompactProtoTestStruct&lt;/p&gt;

&lt;p&gt;This reveals a bug in the generated equals() methods:&lt;/p&gt;

&lt;p&gt;      // TODO equals is broken when List&amp;lt;array&amp;gt; is involved, since AbstractList.equals(Object o)&lt;br/&gt;
      // calls o.equals, but for arrays that is just == which will never work when you are&lt;br/&gt;
      // comparing pre- and post- serialized versions.  You need to use Arrays.equals instead.&lt;br/&gt;
      // So, here I have special-cased CPTS to avoid failing the test b/c of this bug.&lt;/p&gt;

&lt;p&gt;(I&apos;m fine with adding the required fields, but I submit that fixing this too is &lt;em&gt;really&lt;/em&gt; outside the scope of this ticket.)&lt;/p&gt;</comment>
                            <comment id="12743405" author="dreiss" created="Fri, 14 Aug 2009 20:07:14 +0000"  >&lt;p&gt;That would be &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-226&quot; title=&quot;Collections with binary keys or values break equals()&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-226&quot;&gt;&lt;del&gt;THRIFT-226&lt;/del&gt;&lt;/a&gt;, I believe.&lt;/p&gt;</comment>
                            <comment id="12743436" author="bryanduxbury" created="Fri, 14 Aug 2009 20:47:01 +0000"  >&lt;p&gt;How does StructFactory differ in purpose from Fixtures?&lt;/p&gt;</comment>
                            <comment id="12743450" author="jbellis" created="Fri, 14 Aug 2009 21:16:35 +0000"  >&lt;p&gt;Hmm, I suppose it doesn&apos;t.  I will re-patch.&lt;/p&gt;</comment>
                            <comment id="12743458" author="jbellis" created="Fri, 14 Aug 2009 21:42:10 +0000"  >&lt;p&gt;new patches attached, using existing Fixtures class.&lt;/p&gt;</comment>
                            <comment id="12745262" author="bryanduxbury" created="Thu, 20 Aug 2009 01:00:45 +0000"  >&lt;p&gt;I just committed the second version of this patch. Thanks Jonathan!&lt;/p&gt;</comment>
                            <comment id="12747062" author="dreiss" created="Mon, 24 Aug 2009 20:51:38 +0000"  >&lt;p&gt;Sorry I&apos;m a little late to the party, but I&apos;m really confused by this patch.  &quot;default&quot; fields are not meant to be required.  They are always sent when writing, but not required when reading.  The idea here is that we give as much information to the remote peer as we can, but if they do not know about a certain field, we don&apos;t complain that they don&apos;t send it to us.  As far as I can tell, this is what the old behavior was, so I think this patch should be reverted.  If you want Thrift to verify that a field is present, you should mark it required.  Thoughts?&lt;/p&gt;</comment>
                            <comment id="12748523" author="jbellis" created="Thu, 27 Aug 2009 19:33:26 +0000"  >&lt;p&gt;this patch has the side effect of making validate() mandate the presence of exceptions which breaks all kinds of stuff when java is the client language.  we should probably revert it.&lt;/p&gt;</comment>
                            <comment id="12748524" author="jbellis" created="Thu, 27 Aug 2009 19:33:54 +0000"  >&lt;p&gt;(leaving 01 should be ok though.)&lt;/p&gt;</comment>
                            <comment id="12748554" author="dreiss" created="Thu, 27 Aug 2009 20:28:44 +0000"  >&lt;p&gt;Reverted.  Java tests still pass.  Feel free to reopen if you want to discuss this further.&lt;/p&gt;</comment>
                            <comment id="12748850" author="hudson" created="Fri, 28 Aug 2009 15:08:48 +0000"  >&lt;p&gt;Integrated in Cassandra #180 (See &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Cassandra/180/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Cassandra/180/&lt;/a&gt;)&lt;br/&gt;
    bump thrift version to 808609 to fix regression from .  patch by jbellis for &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-387&quot; title=&quot;Upgrade to Thrift 2009-08-19+ and introduce dependency on slf4j&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-387&quot;&gt;&lt;del&gt;CASSANDRA-387&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12750112" author="jbellis" created="Tue, 1 Sep 2009 21:32:12 +0000"  >&lt;p&gt;what about members of structs autogenerated for method params?  can we make those &quot;required&quot; rather than &quot;default&quot;?&lt;/p&gt;</comment>
                            <comment id="12750119" author="dreiss" created="Tue, 1 Sep 2009 21:39:56 +0000"  >&lt;p&gt;No.  One of the key design goals of Thrift is that you can add new parameters without doing a synchronized rollout.  They just show up as default values on the server if the client doesn&apos;t send them.  You can set the default in the IDL, if you want.&lt;/p&gt;</comment>
                            <comment id="12750124" author="jbellis" created="Tue, 1 Sep 2009 21:48:31 +0000"  >&lt;p&gt;No.   Most thrift compilers don&apos;t do anything useful with default values, and most of my parameters don&apos;t have a sensible default value anyway.&lt;/p&gt;

&lt;p&gt;Manually adding &quot;required&quot; in method params yields &lt;span class=&quot;error&quot;&gt;&amp;#91;WARNING:/home/jonathan/projects/cassandra/git-trunk/interface/cassandra.thrift:113&amp;#93;&lt;/span&gt; required keyword is ignored in argument lists.&lt;/p&gt;

&lt;p&gt;This is broken.&lt;/p&gt;</comment>
                            <comment id="12750132" author="dreiss" created="Tue, 1 Sep 2009 22:03:13 +0000"  >&lt;p&gt;It is &lt;b&gt;probably&lt;/b&gt; save to revert the part of r665255 that blocks the required keyword.  We were more concerned with people misinterpreting &quot;optional&quot;.  I just haven&apos;t thought through all of the implications yet.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                            <outwardlinks description="blocks">
                                        <issuelink>
            <issuekey id="12430972">CASSANDRA-308</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12416561" name="562.patch" size="2368" author="jbellis" created="Fri, 14 Aug 2009 15:34:10 +0000"/>
                            <attachment id="12416616" name="ASF.LICENSE.NOT.GRANTED--0001-THRIFT-562-make-tests-actually-use-Fixtures.txt" size="15602" author="jbellis" created="Fri, 14 Aug 2009 21:41:19 +0000"/>
                            <attachment id="12416599" name="ASF.LICENSE.NOT.GRANTED--0001-THRIFT-562-move-boilerplate-into-StructFactory.txt" size="12267" author="jbellis" created="Fri, 14 Aug 2009 19:59:40 +0000"/>
                            <attachment id="12416617" name="ASF.LICENSE.NOT.GRANTED--0002-assume-optional-required-for-java-null-checking.txt" size="5190" author="jbellis" created="Fri, 14 Aug 2009 21:41:19 +0000"/>
                            <attachment id="12416600" name="ASF.LICENSE.NOT.GRANTED--0002-assume-optional-required-for-null-checking.txt" size="6177" author="jbellis" created="Fri, 14 Aug 2009 19:59:40 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>186740</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            16 years, 13 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310041" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Patch Info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10042"><![CDATA[Patch Available]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i16bkv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>245008</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>