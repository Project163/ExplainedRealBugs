<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 07:57:49 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[THRIFT-664] Ruby extension fails to build with Ruby 1.9.1</title>
                <link>https://issues.apache.org/jira/browse/THRIFT-664</link>
                <project id="12310800" key="THRIFT">Thrift</project>
                    <description>&lt;p&gt;The have_func(&apos;strlcpy&apos;, &apos;string.h&apos;) call in lib/rb/ext/extconf.rb is broken in Ruby 1.9.1.  The check always succeeds because Ruby now includes strlcpy in /usr/include/ruby-1.9.1/ruby/missing.h as long as HAVE_STRLCPY is undefined and the Ruby headers are always included by have_func.  The call in extconf.rb finds the function and sets the HAVE_STRLCPY macro for the Makefile.  /lib/rb/ext/struct.c then fails to build because neither the included strlcpy or the strlcpy provided by Ruby are used when HAVE_STRLCPY is set.&lt;/p&gt;

&lt;p&gt;Removing the have_func line from lib/rb/ext/extconf.rb and the definition of strlcpy in lib/rb/ext/struct.c fixes the build.&lt;/p&gt;</description>
                <environment>&lt;p&gt;OS: archlinux&lt;br/&gt;
Ruby: ruby 1.9.1p376 (2009-12-07 revision 26041) &lt;span class=&quot;error&quot;&gt;&amp;#91;x86_64-linux&amp;#93;&lt;/span&gt;&lt;/p&gt;</environment>
        <key id="12444279">THRIFT-664</key>
            <summary>Ruby extension fails to build with Ruby 1.9.1</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="chittoor">Rajesh Malepati</assignee>
                                    <reporter username="byronclark">Byron Clark</reporter>
                        <labels>
                    </labels>
                <created>Mon, 28 Dec 2009 23:41:24 +0000</created>
                <updated>Thu, 6 Oct 2011 20:33:12 +0000</updated>
                            <resolved>Wed, 11 Aug 2010 18:39:33 +0000</resolved>
                                    <version>0.2</version>
                                    <fixVersion>0.4</fixVersion>
                                    <component>Ruby - Library</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="12794966" author="bryanduxbury" created="Mon, 28 Dec 2009 23:47:05 +0000"  >&lt;p&gt;Does this break the 1.8 build?&lt;/p&gt;</comment>
                            <comment id="12794972" author="byronclark" created="Tue, 29 Dec 2009 00:17:03 +0000"  >&lt;p&gt;The changes I made to build with 1.9.1 defintely break the 1.8.x build.&lt;/p&gt;</comment>
                            <comment id="12896407" author="chittoor" created="Sun, 8 Aug 2010 20:41:26 +0000"  >&lt;p&gt;Attaching patch against trunk. Ruby extension builds fine for me against 1.8.6/7 and 1.9.1/2 with this patch.&lt;/p&gt;</comment>
                            <comment id="12896408" author="chittoor" created="Sun, 8 Aug 2010 21:03:26 +0000"  >&lt;p&gt;Looks like &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-605&quot; title=&quot;error compiling struct.c with ruby 1.9&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-605&quot;&gt;&lt;del&gt;THRIFT-605&lt;/del&gt;&lt;/a&gt; also reports the same issue.&lt;/p&gt;</comment>
                            <comment id="12896590" author="bryanduxbury" created="Mon, 9 Aug 2010 15:30:00 +0000"  >&lt;p&gt;What does this change do?&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Index: compact_protocol.c
===================================================================
--- compact_protocol.c	(revision 983480)
+++ compact_protocol.c	(working copy)
@@ -20,8 +20,8 @@
 #include &amp;lt;ruby.h&amp;gt;
 #include &amp;lt;stdbool.h&amp;gt;
 #include &amp;lt;stdint.h&amp;gt;
-#include &amp;lt;constants.h&amp;gt;
-#include &amp;lt;struct.h&amp;gt;
+#include &lt;span class=&quot;code-quote&quot;&gt;&quot;constants.h&quot;&lt;/span&gt;
+#include &lt;span class=&quot;code-quote&quot;&gt;&quot;struct.h&quot;&lt;/span&gt;
 #include &lt;span class=&quot;code-quote&quot;&gt;&quot;macros.h&quot;&lt;/span&gt;
 
 #define LAST_ID(obj) FIX2INT(rb_ary_pop(rb_ivar_get(obj, last_field_id)))
@@ -458,7 +458,7 @@
     
     &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (modifier == 0) {
       &lt;span class=&quot;code-comment&quot;&gt;// not a delta. look ahead &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; the zigzag varint field id.
&lt;/span&gt;-      LAST_ID(self);
+      (void) LAST_ID(self);
       field_id = read_i16(self);
     } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
       &lt;span class=&quot;code-comment&quot;&gt;// has a delta. add the delta to the last read field id.&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="12896603" author="chittoor" created="Mon, 9 Aug 2010 16:18:07 +0000"  >&lt;p&gt;The addition of (void) is to suppress another failure with -Werror on GCC 4.5 (Just letting the compiler know that we want to discard the return value and that it&apos;s not an error)&lt;/p&gt;

&lt;p&gt;I also recommend adding -pedantic -std=c99 to the CFLAGS as struct.c uses variable sized arrays and most of the C files have C++ style comments.&lt;/p&gt;

&lt;p&gt;The rest is just &amp;lt;&amp;gt; --&amp;gt; &quot;&quot; conversion on non-standard header inclusion.&lt;/p&gt;</comment>
                            <comment id="12897376" author="bryanduxbury" created="Wed, 11 Aug 2010 18:39:33 +0000"  >&lt;p&gt;OK, great. I just committed this patch. Thanks Rajesh!&lt;/p&gt;</comment>
                            <comment id="13122258" author="levmatta" created="Thu, 6 Oct 2011 20:33:12 +0000"  >&lt;p&gt;I am having the following problem on Ubuntu 11.10, with ruby 1.9.2-p290 (using RVM):&lt;/p&gt;


&lt;blockquote&gt;
&lt;p&gt;Installing thrift (0.7.0) with native extensions&lt;br/&gt;
Gem::Installer::ExtensionBuildError: ERROR: Failed to build gem native extension.&lt;/p&gt;

&lt;p&gt;        /usr/share/ruby-rvm/rubies/ruby-1.9.2-p290/bin/ruby extconf.rb&lt;br/&gt;
checking for strlcpy() in string.h... no&lt;br/&gt;
creating Makefile&lt;/p&gt;

&lt;p&gt;make&lt;br/&gt;
gcc -I. -I/usr/share/ruby-rvm/rubies/ruby-1.9.2-p290/include/ruby-1.9.1/x86_64-linux -I/usr/share/ruby-rvm/rubies/ruby-1.9.2-p290/include/ruby-1.9.1/ruby/backward -I/usr/share/ruby-rvm/rubies/ruby-1.9.2-p290/include/ruby-1.9.1 -I.   -fPIC -g -O2 -Wall -Werror  -o protocol.o -c protocol.c&lt;br/&gt;
gcc -I. -I/usr/share/ruby-rvm/rubies/ruby-1.9.2-p290/include/ruby-1.9.1/x86_64-linux -I/usr/share/ruby-rvm/rubies/ruby-1.9.2-p290/include/ruby-1.9.1/ruby/backward -I/usr/share/ruby-rvm/rubies/ruby-1.9.2-p290/include/ruby-1.9.1 -I.   -fPIC -g -O2 -Wall -Werror  -o struct.o -c struct.c&lt;br/&gt;
struct.c:28:1: error: static declaration of &#8216;strlcpy&#8217; follows non-static declaration&lt;br/&gt;
/usr/share/ruby-rvm/rubies/ruby-1.9.2-p290/include/ruby-1.9.1/ruby/missing.h:157:20: note: previous declaration of &#8216;strlcpy&#8217; was here&lt;br/&gt;
make: *** &lt;span class=&quot;error&quot;&gt;&amp;#91;struct.o&amp;#93;&lt;/span&gt; Error 1&lt;/p&gt;


&lt;p&gt;Gem files will remain installed in /usr/share/ruby-rvm/gems/ruby-1.9.2-p290@agg/gems/thrift-0.7.0 for inspection.&lt;br/&gt;
Results logged to /usr/share/ruby-rvm/gems/ruby-1.9.2-p290@agg/gems/thrift-0.7.0/ext/gem_make.out&lt;br/&gt;
An error occured while installing thrift (0.7.0), and Bundler cannot continue.&lt;br/&gt;
Make sure that `gem install thrift -v &apos;0.7.0&apos;` succeeds before bundling.&lt;br/&gt;
developer2@developer2-umanni:~/Projects/Agg$ gem install thrift -v &apos;0.7.0&lt;br/&gt;
&amp;gt; ^C&lt;br/&gt;
developer2@developer2-umanni:~/Projects/Agg$ gem install thrift -v=0.7.0&lt;br/&gt;
/usr/share/ruby-rvm/rubies/ruby-1.9.2-p290/bin/gem:4: warning: Insecure world writable dir /usr/share/ruby-rvm in PATH, mode 040777&lt;br/&gt;
Building native extensions.  This could take a while...&lt;br/&gt;
ERROR:  Error installing thrift:&lt;br/&gt;
    ERROR: Failed to build gem native extension.&lt;/p&gt;

&lt;p&gt;        /usr/share/ruby-rvm/rubies/ruby-1.9.2-p290/bin/ruby extconf.rb&lt;br/&gt;
checking for strlcpy() in string.h... no&lt;br/&gt;
creating Makefile&lt;/p&gt;

&lt;p&gt;make&lt;br/&gt;
gcc -I. -I/usr/share/ruby-rvm/rubies/ruby-1.9.2-p290/include/ruby-1.9.1/x86_64-linux -I/usr/share/ruby-rvm/rubies/ruby-1.9.2-p290/include/ruby-1.9.1/ruby/backward -I/usr/share/ruby-rvm/rubies/ruby-1.9.2-p290/include/ruby-1.9.1 -I.   -fPIC -g -O2 -Wall -Werror  -o protocol.o -c protocol.c&lt;br/&gt;
gcc -I. -I/usr/share/ruby-rvm/rubies/ruby-1.9.2-p290/include/ruby-1.9.1/x86_64-linux -I/usr/share/ruby-rvm/rubies/ruby-1.9.2-p290/include/ruby-1.9.1/ruby/backward -I/usr/share/ruby-rvm/rubies/ruby-1.9.2-p290/include/ruby-1.9.1 -I.   -fPIC -g -O2 -Wall -Werror  -o struct.o -c struct.c&lt;br/&gt;
struct.c:28:1: error: static declaration of &#8216;strlcpy&#8217; follows non-static declaration&lt;br/&gt;
/usr/share/ruby-rvm/rubies/ruby-1.9.2-p290/include/ruby-1.9.1/ruby/missing.h:157:20: note: previous declaration of &#8216;strlcpy&#8217; was here&lt;br/&gt;
make: *** &lt;span class=&quot;error&quot;&gt;&amp;#91;struct.o&amp;#93;&lt;/span&gt; Error 1&lt;/p&gt;


&lt;p&gt;Gem files will remain installed in /usr/share/ruby-rvm/gems/ruby-1.9.2-p290@agg/gems/thrift-0.7.0 for inspection.&lt;br/&gt;
Results logged to /usr/share/ruby-rvm/gems/ruby-1.9.2-p290@agg/gems/thrift-0.7.0/ext/gem_make.out&lt;/p&gt;&lt;/blockquote&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12451534" name="ruby19-build-fix.patch" size="1343" author="chittoor" created="Sun, 8 Aug 2010 20:41:26 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>49781</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 7 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i16cen:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>245142</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>