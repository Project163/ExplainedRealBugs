<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 08:12:32 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[THRIFT-2009] Go redeclaration error</title>
                <link>https://issues.apache.org/jira/browse/THRIFT-2009</link>
                <project id="12310800" key="THRIFT">Thrift</project>
                    <description>&lt;p&gt;The following IDL code works perfectly with other languages:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;namespace * Test

struct Project {
  1 : required string projectID
}

struct NewProject {
  1 : required string name
}

service Sample {
  Project CreateNewProject( 1: NewProject project) 
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The result I get here is&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;gen-go\Test\Sample.go:455: missing argument to conversion to NewProject: NewProject()&lt;br/&gt;
gen-go\Test\ttypes.go:191: NewProject redeclared in this block&lt;br/&gt;
        previous declaration at gen-go\Test\ttypes.go:25&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Seems as if the generated NewProject() method conflicts with the struct name. As my Go knowledge is somewhat limited, I&apos;m not sure about whether or not this issue blocks the acceptance of &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-1980&quot; title=&quot;Modernize Go tooling, fix go client libary.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-1980&quot;&gt;&lt;del&gt;THRIFT-1980&lt;/del&gt;&lt;/a&gt;, so I created a new ticket. &lt;/p&gt;</description>
                <environment></environment>
        <key id="12651873">THRIFT-2009</key>
            <summary>Go redeclaration error</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jensg">Jens Geyer</assignee>
                                    <reporter username="jensg">Jens Geyer</reporter>
                        <labels>
                    </labels>
                <created>Sat, 8 Jun 2013 17:45:34 +0000</created>
                <updated>Fri, 8 Dec 2017 21:18:44 +0000</updated>
                            <resolved>Tue, 1 Apr 2014 19:30:36 +0000</resolved>
                                                    <fixVersion>0.9.2</fixVersion>
                                    <component>Go - Compiler</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="13681586" author="jensg" created="Wed, 12 Jun 2013 20:18:11 +0000"  >&lt;p&gt;Solved with &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-2012&quot; title=&quot;Modernizing Go &quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-2012&quot;&gt;&lt;del&gt;THRIFT-2012&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13682608" author="jensg" created="Thu, 13 Jun 2013 19:33:19 +0000"  >&lt;p&gt;Corection: It&apos;s not solved, it is still there. My testcase was wrong.&lt;/p&gt;</comment>
                            <comment id="13719495" author="nairboon" created="Thu, 25 Jul 2013 10:59:55 +0000"  >&lt;p&gt;this happens in Go because in the other languages we don&apos;t use a NewStructName() identifier to create a new object. &lt;/p&gt;

&lt;p&gt;But go does not allow two types with the same identifier: &lt;blockquote&gt;&lt;p&gt; Given a set of identifiers, an identifier is called unique if it is different from every other in the set. Two identifiers are different if they are spelled differently, or if they appear in different packages and are not exported. Otherwise, they are the same. &lt;/p&gt;&lt;/blockquote&gt;&lt;/p&gt;

&lt;p&gt;a solution would be to rename the NewStruct function to something else like CreateStruct&lt;/p&gt;</comment>
                            <comment id="13720051" author="jensg" created="Thu, 25 Jul 2013 20:55:50 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=nairboon&quot; class=&quot;user-hover&quot; rel=&quot;nairboon&quot;&gt;nairboon&lt;/a&gt;,&lt;/p&gt;

&lt;p&gt;that&apos;s basically what I said, it conflicts with the Name. It is however very unlikely that chooosing a different name will solve the underlying issue. It may then work for this special case, but create another new one, where it doesn&apos;t work. &lt;/p&gt;

&lt;p&gt;And the main issue is caused by the fact, that in essence different namespaces were mixed: the identifiers coming from the IDL, and the names that are added by compiler/library or convention, plus the identifiers that are part of the normal Go infrastructure, like reserved keywords or the like. The good news (ok, not really good) is: To some extent, all languages are facing similar problems. &lt;/p&gt;

&lt;p&gt;One proposal could be to actively detect such problems in the compiler and do some name mangling, like adding an underscore. That is no bullet-proof way either, but it will help in most cases.&lt;/p&gt;

&lt;p&gt;BTW, I didn&apos;t make up this test case, it hit me while trying a real-world example.&lt;/p&gt;</comment>
                            <comment id="13951609" author="jensg" created="Fri, 28 Mar 2014 23:55:16 +0000"  >&lt;p&gt;&lt;a href=&quot;http://www.golangpatterns.info/object-oriented/constructors&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.golangpatterns.info/object-oriented/constructors&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13956940" author="jensg" created="Tue, 1 Apr 2014 19:30:36 +0000"  >&lt;p&gt;Committed.&lt;/p&gt;</comment>
                            <comment id="13957159" author="hudson" created="Tue, 1 Apr 2014 23:46:29 +0000"  >&lt;p&gt;SUCCESS: Integrated in Thrift #1106 (See &lt;a href=&quot;https://builds.apache.org/job/Thrift/1106/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Thrift/1106/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-2009&quot; title=&quot;Go redeclaration error&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-2009&quot;&gt;&lt;del&gt;THRIFT-2009&lt;/del&gt;&lt;/a&gt; Go redeclaration error (jensg: rev 5d1521225bb2a484d1f8cb395dc7f779e63f8bb0)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;compiler/cpp/src/generate/t_go_generator.cc&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13974138" author="zariel" created="Fri, 18 Apr 2014 14:50:18 +0000"  >&lt;p&gt;This change causes service methods which begin with New to be escaped, for instance.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;service Test {
    void NewToken()
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Generates&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;type Test &lt;span class=&quot;code-keyword&quot;&gt;interface&lt;/span&gt; {
    NewToken_()
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;In reality I think this escaping should only happen for top level type definitions.&lt;/p&gt;</comment>
                            <comment id="13974835" author="jensg" created="Sat, 19 Apr 2014 11:51:01 +0000"  >&lt;p&gt;I think you&apos;re right. Do you have a patch ready?&lt;/p&gt;</comment>
                            <comment id="13974878" author="zariel" created="Sat, 19 Apr 2014 14:34:04 +0000"  >&lt;p&gt;Not yet, I think we should change publicize to have an arg to indicate to escape &apos;new&apos; like we do with is_args_or_result, but I&apos;ve yet to find all the places where this needs to be escaped, its more complicated than just escaping all the calls to publicize.&lt;/p&gt;

&lt;p&gt;Should we escape IDL generated types (such as New&amp;lt;struct&amp;gt;) or the users type names (struct NewTest{})?&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310460">
                    <name>Child-Issue</name>
                                            <outwardlinks description="is a parent of">
                                        <issuelink>
            <issuekey id="13123088">THRIFT-4410</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12651892">THRIFT-2012</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12649549">THRIFT-1980</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12637672" name="thrift-2009_redeclaration_error.patch" size="8380" author="jensg" created="Sat, 29 Mar 2014 23:07:19 +0000"/>
                            <attachment id="12637673" name="thrift-2009_testcase.thrift" size="886" author="jensg" created="Sat, 29 Mar 2014 23:07:19 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>332197</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 31 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310041" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Patch Info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10042"><![CDATA[Patch Available]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1lb3j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>332526</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>