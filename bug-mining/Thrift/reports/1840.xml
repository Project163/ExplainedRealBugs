<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 08:27:58 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[THRIFT-4403] thrift.js: Incorrect usage of &apos;this&apos; in TWebSocketTransport.__onOpen</title>
                <link>https://issues.apache.org/jira/browse/THRIFT-4403</link>
                <project id="12310800" key="THRIFT">Thrift</project>
                    <description>&lt;p&gt;Inside the forEach callback &apos;this&apos; will be the global object, not the transport object, as the implementation seems to assume.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13122564">THRIFT-4403</key>
            <summary>thrift.js: Incorrect usage of &apos;this&apos; in TWebSocketTransport.__onOpen</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jking3">James E. King III</assignee>
                                    <reporter username="bananer">Philip Frank</reporter>
                        <labels>
                    </labels>
                <created>Mon, 4 Dec 2017 12:29:36 +0000</created>
                <updated>Thu, 27 Dec 2018 15:25:07 +0000</updated>
                            <resolved>Mon, 4 Dec 2017 16:04:31 +0000</resolved>
                                                    <fixVersion>0.12.0</fixVersion>
                                    <component>JavaScript - Library</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="16276713" author="githubbot" created="Mon, 4 Dec 2017 12:32:40 +0000"  >&lt;p&gt;GitHub user bananer opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/1437&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/1437&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-4403&quot; title=&quot;thrift.js: Incorrect usage of &amp;#39;this&amp;#39; in TWebSocketTransport.__onOpen&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-4403&quot;&gt;&lt;del&gt;THRIFT-4403&lt;/del&gt;&lt;/a&gt;: Fix incorrect usage of &apos;this&apos;&lt;/p&gt;



&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/bananer/thrift&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/bananer/thrift&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-4403&quot; title=&quot;thrift.js: Incorrect usage of &amp;#39;this&amp;#39; in TWebSocketTransport.__onOpen&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-4403&quot;&gt;&lt;del&gt;THRIFT-4403&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/1437.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/1437.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #1437&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit b55a32939a250a4c04d64d6b1821fc766944d444&lt;br/&gt;
Author: Philip Frank &amp;lt;ich@philipfrank.de&amp;gt;&lt;br/&gt;
Date:   2017-12-04T12:29:58Z&lt;/p&gt;

&lt;p&gt;    Fix incorrect usage of &apos;this&apos;&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="16276714" author="bananer" created="Mon, 4 Dec 2017 12:33:00 +0000"  >&lt;p&gt;Fix: &lt;a href=&quot;https://github.com/apache/thrift/pull/1437&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/1437&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16276857" author="githubbot" created="Mon, 4 Dec 2017 14:36:05 +0000"  >&lt;p&gt;Github user jeking3 commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/1437&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/1437&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Great - I am going to see if this resolves any of the cross test known failures.&lt;/p&gt;</comment>
                            <comment id="16276874" author="githubbot" created="Mon, 4 Dec 2017 14:44:37 +0000"  >&lt;p&gt;Github user jeking3 commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/1437#discussion_r154666904&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/1437#discussion_r154666904&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: lib/js/src/thrift.js &amp;#8212;&lt;br/&gt;
    @@ -599,8 +599,8 @@ Thrift.TWebSocketTransport.prototype = {&lt;br/&gt;
               //If the user made calls before the connection was fully&lt;br/&gt;
               //open, send them now&lt;br/&gt;
               this.send_pending.forEach(function(elem) {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;this.socket.send(elem.buf);&lt;/li&gt;
	&lt;li&gt;this.callbacks.push((function() {&lt;br/&gt;
    +             self.socket.send(elem.buf);
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    On line 597, self is set to be equal to this, so what does this change actually do?&lt;/p&gt;</comment>
                            <comment id="16276885" author="githubbot" created="Mon, 4 Dec 2017 14:50:03 +0000"  >&lt;p&gt;Github user bananer commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/1437#discussion_r154668539&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/1437#discussion_r154668539&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: lib/js/src/thrift.js &amp;#8212;&lt;br/&gt;
    @@ -599,8 +599,8 @@ Thrift.TWebSocketTransport.prototype = {&lt;br/&gt;
               //If the user made calls before the connection was fully&lt;br/&gt;
               //open, send them now&lt;br/&gt;
               this.send_pending.forEach(function(elem) {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;this.socket.send(elem.buf);&lt;/li&gt;
	&lt;li&gt;this.callbacks.push((function() {&lt;br/&gt;
    +             self.socket.send(elem.buf);
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    In short, `this` inside of a `function()` in JavaScript is not transferred reliably from outer scopes. Try setting a breakpoint at this line and you will see that `self` and `this` are different things here.&lt;/p&gt;

&lt;p&gt;    It&apos;s a bit of a race condition to have this block actually execute, but calling a service method right after opening the transport crashed here repeatedly in firefox.&lt;/p&gt;

&lt;p&gt;    Long version: &lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/this&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/this&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16276902" author="githubbot" created="Mon, 4 Dec 2017 15:02:19 +0000"  >&lt;p&gt;Github user jeking3 commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/1437#discussion_r154672290&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/1437#discussion_r154672290&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: lib/js/src/thrift.js &amp;#8212;&lt;br/&gt;
    @@ -599,8 +599,8 @@ Thrift.TWebSocketTransport.prototype = {&lt;br/&gt;
               //If the user made calls before the connection was fully&lt;br/&gt;
               //open, send them now&lt;br/&gt;
               this.send_pending.forEach(function(elem) {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;this.socket.send(elem.buf);&lt;/li&gt;
	&lt;li&gt;this.callbacks.push((function() {&lt;br/&gt;
    +             self.socket.send(elem.buf);
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    Perhaps line 597 should be removed then?&lt;/p&gt;</comment>
                            <comment id="16276906" author="githubbot" created="Mon, 4 Dec 2017 15:04:05 +0000"  >&lt;p&gt;Github user jeking3 commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/1437#discussion_r154672797&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/1437#discussion_r154672797&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: lib/js/src/thrift.js &amp;#8212;&lt;br/&gt;
    @@ -599,8 +599,8 @@ Thrift.TWebSocketTransport.prototype = {&lt;br/&gt;
               //If the user made calls before the connection was fully&lt;br/&gt;
               //open, send them now&lt;br/&gt;
               this.send_pending.forEach(function(elem) {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;this.socket.send(elem.buf);&lt;/li&gt;
	&lt;li&gt;this.callbacks.push((function() {&lt;br/&gt;
    +             self.socket.send(elem.buf);
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    I&apos;m running through cross tests to see if this resolves anything we know failed in the past.&lt;/p&gt;</comment>
                            <comment id="16276934" author="githubbot" created="Mon, 4 Dec 2017 15:26:16 +0000"  >&lt;p&gt;Github user jeking3 commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/1437#discussion_r154679526&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/1437#discussion_r154679526&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: lib/js/src/thrift.js &amp;#8212;&lt;br/&gt;
    @@ -599,8 +599,8 @@ Thrift.TWebSocketTransport.prototype = {&lt;br/&gt;
               //If the user made calls before the connection was fully&lt;br/&gt;
               //open, send them now&lt;br/&gt;
               this.send_pending.forEach(function(elem) {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;this.socket.send(elem.buf);&lt;/li&gt;
	&lt;li&gt;this.callbacks.push((function() {&lt;br/&gt;
    +             self.socket.send(elem.buf);
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    We don&apos;t run &quot;js&quot; through cross test right now. :|&lt;/p&gt;</comment>
                            <comment id="16276990" author="jking3" created="Mon, 4 Dec 2017 16:04:31 +0000"  >&lt;p&gt;Committed - thanks!&lt;/p&gt;</comment>
                            <comment id="16276991" author="githubbot" created="Mon, 4 Dec 2017 16:04:33 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/1437&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/1437&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 50 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3nhx3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>