<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 08:27:45 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[THRIFT-4362] Missing size-check can lead to huge memory allocation</title>
                <link>https://issues.apache.org/jira/browse/THRIFT-4362</link>
                <project id="12310800" key="THRIFT">Thrift</project>
                    <description>&lt;p&gt;In some cases the method &lt;tt&gt;org.apache.thrift.protocol.TBinaryProtocol.readStringBody(int size)&lt;/tt&gt; gets called with a &quot;size&quot; parameter that has not been validated by the existing method &lt;tt&gt;checkStringReadLength(int size)&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;This is true if the method is called by &lt;tt&gt;readMessageBegin()&lt;/tt&gt; of the same class. The method &lt;tt&gt;readString()&lt;/tt&gt; checks the size correctly before calling &lt;tt&gt;readStringBody(int size)&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;Since the methods &lt;tt&gt;readStringBody(int size)&lt;/tt&gt; and &lt;tt&gt;readMessageBegin()&lt;/tt&gt; are public, there may be other callers who don&apos;t check the size correctly.&lt;/p&gt;

&lt;p&gt;We encountered this issue in production several times. Because of this we are currently using our own patched version of libthrift-0.9.3. The patch is attached, but it is surely not the best solution, because with this patch the size may be checked twice, depending on the caller.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13108357">THRIFT-4362</key>
            <summary>Missing size-check can lead to huge memory allocation</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jking3">James E. King III</assignee>
                                    <reporter username="ChristianCiach">Christian Ciach</reporter>
                        <labels>
                    </labels>
                <created>Tue, 10 Oct 2017 18:05:00 +0000</created>
                <updated>Thu, 14 Dec 2017 13:55:02 +0000</updated>
                            <resolved>Wed, 25 Oct 2017 12:42:05 +0000</resolved>
                                    <version>0.9.3</version>
                    <version>0.10.0</version>
                                    <fixVersion>0.11.0</fixVersion>
                                    <component>Java - Library</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="16210988" author="jking3" created="Thu, 19 Oct 2017 13:04:10 +0000"  >&lt;p&gt;Thanks for the patch, once the CI build is stable again (hopefully today) I will submit a pull request on your behalf unless you want to do it yourself.&lt;/p&gt;</comment>
                            <comment id="16212477" author="christianciach" created="Fri, 20 Oct 2017 10:35:28 +0000"  >&lt;p&gt;Do you think I can submit this patch as-is or do you have any suggestions for improvement?&lt;/p&gt;

&lt;p&gt;Edit: As mentioned, with my patch the size may be checked multiple times. So I think it&apos;s a good idea to remove the other calls to the size-check method.&lt;/p&gt;</comment>
                            <comment id="16216453" author="githubbot" created="Tue, 24 Oct 2017 07:29:31 +0000"  >&lt;p&gt;GitHub user ChristianCiach opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/1398&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/1398&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-4362&quot; title=&quot;Missing size-check can lead to huge memory allocation&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-4362&quot;&gt;&lt;del&gt;THRIFT-4362&lt;/del&gt;&lt;/a&gt; check &quot;read length&quot; in readStringBody(int)&lt;/p&gt;

&lt;p&gt;    This fixes &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-4362&quot; title=&quot;Missing size-check can lead to huge memory allocation&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-4362&quot;&gt;&lt;del&gt;THRIFT-4362&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;    If possible, please port this fix to previous versions. &lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/ChristianCiach/thrift&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/ChristianCiach/thrift&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-4362&quot; title=&quot;Missing size-check can lead to huge memory allocation&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-4362&quot;&gt;&lt;del&gt;THRIFT-4362&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/1398.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/1398.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #1398&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 37dfb6cfda585aec82226f62814eb00ed609c3fe&lt;br/&gt;
Author: christianc &amp;lt;christian.ciach@energymeteo.de&amp;gt;&lt;br/&gt;
Date:   2017-10-24T07:25:20Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-4362&quot; title=&quot;Missing size-check can lead to huge memory allocation&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-4362&quot;&gt;&lt;del&gt;THRIFT-4362&lt;/del&gt;&lt;/a&gt; check &quot;read length&quot; in readStringBody(int)&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="16218514" author="githubbot" created="Wed, 25 Oct 2017 12:34:35 +0000"  >&lt;p&gt;Github user jeking3 commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/1398&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/1398&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    We don&apos;t re-release previous versions.  You will need to apply the patch to your own copy of a previous version.&lt;/p&gt;</comment>
                            <comment id="16218530" author="jking3" created="Wed, 25 Oct 2017 12:42:05 +0000"  >&lt;p&gt;Committed - thanks.&lt;/p&gt;</comment>
                            <comment id="16218532" author="githubbot" created="Wed, 25 Oct 2017 12:42:09 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/1398&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/1398&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16218838" author="githubbot" created="Wed, 25 Oct 2017 15:00:37 +0000"  >&lt;p&gt;Github user ChristianCiach commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/1398&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/1398&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    So there won&apos;t be a version 0.9.4 or 0.10.1?&lt;/p&gt;</comment>
                            <comment id="16218845" author="githubbot" created="Wed, 25 Oct 2017 15:03:19 +0000"  >&lt;p&gt;Github user jeking3 commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/1398&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/1398&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    We only have resources on this project to handle one release stream (and even then it&apos;s a challenge), so we&apos;re starting the process of making 0.11.0 with all the changes since 0.10.0 right now.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12891315" name="check-size.patch" size="703" author="ChristianCiach" created="Tue, 10 Oct 2017 18:07:39 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310250" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10430"><![CDATA[Patch]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 3 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310041" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Patch Info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10042"><![CDATA[Patch Available]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3l3e7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>