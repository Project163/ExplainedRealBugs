<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 08:33:49 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[THRIFT-5411]  Catch SocketTimeoutException in TIOStreamTransport read</title>
                <link>https://issues.apache.org/jira/browse/THRIFT-5411</link>
                <project id="12310800" key="THRIFT">Thrift</project>
                    <description>&lt;p&gt;Hi,&lt;/p&gt;

&lt;p&gt;There is an issue in thrift library.&lt;/p&gt;

&lt;p&gt;From thrift version 0.12.0, we see some unwanted logs in our application logs as below:&lt;/p&gt;

&lt;p&gt;1620367702942&lt;span class=&quot;error&quot;&gt;&amp;#91;20210507 11:38:22&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;TThreadPoolServer$WorkerProcess::run&amp;#93;&lt;/span&gt; May 07, 2021 11:38:22 AM org.apache.thrift.server.TThreadPoolServer$WorkerProcess run&lt;br/&gt;
SEVERE: Thrift Error occurred during processing of message.&lt;br/&gt;
org.apache.thrift.transport.TTransportException: java.net.SocketTimeoutException: Read timed out&lt;br/&gt;
 at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:178)&lt;br/&gt;
 at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109)&lt;br/&gt;
 at org.apache.thrift.transport.layered.TFramedTransport.readFrame(TFramedTransport.java:138)&lt;br/&gt;
 at org.apache.thrift.transport.layered.TFramedTransport.read(TFramedTransport.java:106)&lt;br/&gt;
 at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109)&lt;br/&gt;
 at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463)&lt;br/&gt;
 at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361)&lt;br/&gt;
 at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244)&lt;br/&gt;
 at org.apache.thrift.TBaseProcessor.process(TBaseProcessor.java:27)&lt;br/&gt;
 at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)&lt;br/&gt;
 at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)&lt;br/&gt;
 at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)&lt;br/&gt;
 at java.lang.Thread.run(Thread.java:748)&lt;br/&gt;
Caused by: java.net.SocketTimeoutException: Read timed out&lt;br/&gt;
 at java.net.SocketInputStream.socketRead0(Native Method)&lt;br/&gt;
 at java.net.SocketInputStream.socketRead(SocketInputStream.java:116)&lt;br/&gt;
 at java.net.SocketInputStream.read(SocketInputStream.java:171)&lt;br/&gt;
 at java.net.SocketInputStream.read(SocketInputStream.java:141)&lt;br/&gt;
 at java.io.BufferedInputStream.fill(BufferedInputStream.java:246)&lt;br/&gt;
 at java.io.BufferedInputStream.read1(BufferedInputStream.java:286)&lt;br/&gt;
 at java.io.BufferedInputStream.read(BufferedInputStream.java:345)&lt;br/&gt;
 at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:176)&lt;br/&gt;
 ... 12 more&lt;/p&gt;

&lt;p&gt;org.apache.thrift.transport.TTransportException: java.net.SocketTimeoutException: Read timed out&lt;br/&gt;
 at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:178)&lt;br/&gt;
 at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109)&lt;br/&gt;
 at org.apache.thrift.transport.layered.TFramedTransport.readFrame(TFramedTransport.java:138)&lt;br/&gt;
 at org.apache.thrift.transport.layered.TFramedTransport.read(TFramedTransport.java:106)&lt;br/&gt;
 at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109)&lt;br/&gt;
 at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463)&lt;br/&gt;
 at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361)&lt;br/&gt;
 at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244)&lt;br/&gt;
 at org.apache.thrift.TBaseProcessor.process(TBaseProcessor.java:27)&lt;br/&gt;
 at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)&lt;br/&gt;
 at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)&lt;br/&gt;
 at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)&lt;br/&gt;
 at java.lang.Thread.run(Thread.java:748)&lt;br/&gt;
Caused by: java.net.SocketTimeoutException: Read timed out&lt;br/&gt;
 at java.net.SocketInputStream.socketRead0(Native Method)&lt;br/&gt;
 at java.net.SocketInputStream.socketRead(SocketInputStream.java:116)&lt;br/&gt;
 at java.net.SocketInputStream.read(SocketInputStream.java:171)&lt;br/&gt;
 at java.net.SocketInputStream.read(SocketInputStream.java:141)&lt;br/&gt;
 at java.io.BufferedInputStream.fill(BufferedInputStream.java:246)&lt;br/&gt;
 at java.io.BufferedInputStream.read1(BufferedInputStream.java:286)&lt;br/&gt;
 at java.io.BufferedInputStream.read(BufferedInputStream.java:345)&lt;br/&gt;
 at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:176)&lt;br/&gt;
 ... 12 more&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;The exception is printed from TTheadPoolServer.java class as a non ignorable exception. But as per our analysis, the above exception is not creating any impact to us. And, it gets printed so many time in our application logs, which causes confusion to users.&lt;/p&gt;

&lt;p&gt;We have no control to avoid printing of this exception in our application.&lt;/p&gt;

&lt;p&gt;Please let me know if thrift can ignore this exception so that it will not be printed.&lt;/p&gt;

&lt;p&gt;If possible, please share the thrift version also, so that we can plan accordingly.&lt;/p&gt;

&lt;p&gt;Let me know if any further information is required.&lt;/p&gt;

&lt;p&gt;Best Regards&lt;/p&gt;

&lt;p&gt;Isha&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13378009">THRIFT-5411</key>
            <summary> Catch SocketTimeoutException in TIOStreamTransport read</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="belugabehr">David Mollitor</assignee>
                                    <reporter username="isha.sardana">Isha</reporter>
                        <labels>
                    </labels>
                <created>Wed, 12 May 2021 06:05:40 +0000</created>
                <updated>Wed, 18 May 2022 21:14:11 +0000</updated>
                            <resolved>Wed, 18 May 2022 21:14:11 +0000</resolved>
                                    <version>0.14.1</version>
                                    <fixVersion>0.15.0</fixVersion>
                                    <component>Java - Library</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="6000">1h 40m</timespent>
                                <comments>
                            <comment id="17343332" author="fishywang" created="Wed, 12 May 2021 16:03:52 +0000"  >&lt;p&gt;Hi,&lt;/p&gt;

&lt;p&gt;In the &quot;Affected Version/s&quot; field you filled in &quot;0.14.1&quot;, but in the description you said you are running 0.12.0. Can you clarify which version does this affect?&lt;/p&gt;</comment>
                            <comment id="17343692" author="isha.sardana" created="Thu, 13 May 2021 04:08:28 +0000"  >&lt;p&gt;Hi,&lt;/p&gt;

&lt;p&gt;We have tried with all versions as mentioned below:&lt;/p&gt;

&lt;p&gt;0.12.0&lt;/p&gt;

&lt;p&gt;0.13.0&lt;/p&gt;

&lt;p&gt;0.14.1&lt;/p&gt;

&lt;p&gt;On all these versions, we see this exception.&lt;/p&gt;

&lt;p&gt;Before version 0.12.0, the exception was not coming.&lt;/p&gt;

&lt;p&gt;Hope it is clear now.&lt;/p&gt;

&lt;p&gt;Best Regards&lt;/p&gt;

&lt;p&gt;Isha&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17350925" author="isha.sardana" created="Tue, 25 May 2021 09:06:47 +0000"  >&lt;p&gt;Hi,&lt;/p&gt;

&lt;p&gt;Please share update on this issue.&lt;/p&gt;

&lt;p&gt;Waiting for reply.&lt;/p&gt;

&lt;p&gt;Best Regards&lt;/p&gt;

&lt;p&gt;Isha&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17351121" author="fishywang" created="Tue, 25 May 2021 15:07:12 +0000"  >&lt;p&gt;There&apos;s no update. I don&apos;t believe anyone is looking into it. I just noticed some inconsistency in your original issue report so asked for some clarification (in case this is something as simple as just upgrade to the latest version). I was not really looking into this issue.&lt;/p&gt;</comment>
                            <comment id="17351601" author="isha.sardana" created="Wed, 26 May 2021 07:47:27 +0000"  >&lt;p&gt;Can you please let me know where I can raise the issue so that somebody can look into it.&lt;/p&gt;</comment>
                            <comment id="17351756" author="fishywang" created="Wed, 26 May 2021 12:36:17 +0000"  >&lt;p&gt;do your clients use connection pool? if they use client pools (put the connection back into the pool after finished requests, rather than close the connections) this is usually normal because idle client connections will cause the server to have socket read timeouts. the solution to that is to either don&apos;t set socket read time out on the server, or set the socket read timeout longer than your client&apos;s pool ttl settings.&lt;/p&gt;</comment>
                            <comment id="17351786" author="belugabehr" created="Wed, 26 May 2021 13:30:24 +0000"  >&lt;p&gt;Hello.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;I don&apos;t personally like having the underlying framework swallow errors.&#160; It can make troubleshooting very difficult.&#160; However, as the code currently is written, this error should be ignored from logging as it is certainly a form of &quot;TIMED_OUT&quot; exception.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/thrift/blob/63d114de97f8ddb67c1fb33d75ccb91a3b487b92/lib/java/src/org/apache/thrift/server/TThreadPoolServer.java#L276-L293&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/blob/63d114de97f8ddb67c1fb33d75ccb91a3b487b92/lib/java/src/org/apache/thrift/server/TThreadPoolServer.java#L276-L293&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;I have provided a pull request to catch this specific exception and identify it appropriately as &quot;TIMED_OUT&quot;, however, I would suggest you seek to determine the cause of this timeout in your environment.&lt;/p&gt;</comment>
                            <comment id="17357099" author="isha.sardana" created="Fri, 4 Jun 2021 06:15:57 +0000"  >&lt;p&gt;To fix this issue, we are proposing below solution:&lt;/p&gt;

&lt;p&gt;in class &lt;a href=&quot;https://gerrit-epk.seli.gic.ericsson.se/c/luva/air/+/798093/1/3rd-thrift/src/org/apache/thrift/transport/TIOStreamTransport.java&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;TIOStreamTransport.java &lt;/a&gt;::read(byte[] buf, int off, int len) method, we can make below change (in red colour)&lt;/p&gt;

&lt;p&gt;public int read(byte[] buf, int off, int len) throws TTransportException {&lt;br/&gt;
 if (inputStream_ == null) &lt;/p&gt;
{
 throw new TTransportException(TTransportException.NOT_OPEN, &quot;Cannot read from null inputStream&quot;);
 }
&lt;p&gt; int bytesRead;&lt;br/&gt;
 try &lt;/p&gt;
{
 bytesRead = inputStream_.read(buf, off, len);
 }
&lt;p&gt;catch (IOException iox)&lt;br/&gt;
 {&lt;br/&gt;
 &lt;font color=&quot;#de350b&quot;&gt;&lt;b&gt;if(iox instanceof SocketTimeoutException)&lt;/b&gt;&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;#de350b&quot;&gt; &lt;b&gt;{&lt;/b&gt;&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;#de350b&quot;&gt; &lt;b&gt;throw new TTransportException(TTransportException.TIMED_OUT, iox);&lt;/b&gt;&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;#de350b&quot;&gt; &lt;b&gt;}&lt;/b&gt;&lt;/font&gt;&lt;br/&gt;
 throw new TTransportException(TTransportException.UNKNOWN, iox);&lt;br/&gt;
 }&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;This is the place from where exception in thrown. Since in above scenario, we are getting SocketTimeoutException, but we are currently throwing it as an unknown exception, thats why it is not ignored. We can change it to throw timeout exception, so that it will be ignored.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Please check and let us know if it can be fixed in coming release of thrift.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Best Regards&lt;/p&gt;

&lt;p&gt;Isha&lt;/p&gt;</comment>
                            <comment id="17539037" author="slachiewicz" created="Wed, 18 May 2022 19:40:26 +0000"  >&lt;p&gt;already merged into v.0.15 with &lt;a href=&quot;https://github.com/apache/thrift/commit/be20ad7e08fab200391e3eab41acde9da2a4fd07&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/commit/be20ad7e08fab200391e3eab41acde9da2a4fd07&lt;/a&gt;&#160;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 25 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0qyh4:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>