<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 07:59:05 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[THRIFT-979] ruby bindings used to work on jruby</title>
                <link>https://issues.apache.org/jira/browse/THRIFT-979</link>
                <project id="12310800" key="THRIFT">Thrift</project>
                    <description>&lt;p&gt;The current ruby bindings do not work on JRuby do to the use of mkmf in the build. It used to be that on jruby, the build would just skip over the extconf.rb step and only install the pure ruby code. (See the current version up on &amp;lt;&lt;a href=&quot;http://github.com/fauna/thrift&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://github.com/fauna/thrift&lt;/a&gt;&amp;gt;.&lt;/p&gt;

&lt;p&gt;I&apos;ve been fighting with rubygems to figure out why I can&apos;t make this work like I was able to with 0.2. Unfortunately, I&apos;m at my limit, so here&apos;s just the bug. Help appreciated.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12478930">THRIFT-979</key>
            <summary>ruby bindings used to work on jruby</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jmhodges">Jeff Hodges</assignee>
                                    <reporter username="jmhodges">Jeff Hodges</reporter>
                        <labels>
                    </labels>
                <created>Tue, 2 Nov 2010 20:32:01 +0000</created>
                <updated>Wed, 17 Nov 2010 22:48:57 +0000</updated>
                            <resolved>Wed, 17 Nov 2010 22:48:57 +0000</resolved>
                                    <version>0.5</version>
                                    <fixVersion>0.6</fixVersion>
                                    <component>Ruby - Library</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="12927595" author="kclark" created="Tue, 2 Nov 2010 21:07:28 +0000"  >&lt;p&gt;Does the right thing happen (no Makefile generation, no compilation) if you wrap the extconf.rb in an `if RUBY_ENGINE != jruby`? (I&apos;m not sure if that&apos;s the right RUBY_ENGINE value - you should double check).&lt;/p&gt;</comment>
                            <comment id="12927613" author="jmhodges" created="Tue, 2 Nov 2010 21:24:04 +0000"  >&lt;p&gt;That was the deal I was trying. No clue why it doesn&apos;t seem to work.&lt;/p&gt;

&lt;p&gt;This is what extconf.rb looks like locally:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;unless RUBY_ENGINE =~ /jruby/
  require &lt;span class=&quot;code-quote&quot;&gt;&apos;mkmf&apos;&lt;/span&gt;

  $CFLAGS = &lt;span class=&quot;code-quote&quot;&gt;&quot;-g -O2 -Wall -Werror&quot;&lt;/span&gt;

  have_func(&lt;span class=&quot;code-quote&quot;&gt;&quot;strlcpy&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;string.h&quot;&lt;/span&gt;)

  create_makefile &lt;span class=&quot;code-quote&quot;&gt;&apos;thrift_native&apos;&lt;/span&gt;
end
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Output I get from that is the usual &quot;Failed to build gem native extension&quot;. This reproducible on your end?&lt;/p&gt;</comment>
                            <comment id="12927625" author="kclark" created="Tue, 2 Nov 2010 21:40:33 +0000"  >&lt;p&gt;I&apos;ll take a look when I get home and have a unix machine in front of me. Let me know if you manage to track it down in the meantime.&lt;/p&gt;

&lt;p&gt;Any idea what&apos;s failing? The automake stuff or the gem stuff?&lt;/p&gt;</comment>
                            <comment id="12927899" author="kclark" created="Wed, 3 Nov 2010 16:50:27 +0000"  >&lt;p&gt;Just an update - I&apos;ve got dependency issues on the machine I was using for dev. Will try to resolve.&lt;/p&gt;</comment>
                            <comment id="12928003" author="jmhodges" created="Wed, 3 Nov 2010 21:03:15 +0000"  >&lt;p&gt;With debug, it seems that rubygems is expecting a makefile to be made but is not seeing it. Perhaps, this only worked in the 0.2 branch because an old makefile was still being packaged up?&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Building &lt;span class=&quot;code-keyword&quot;&gt;native&lt;/span&gt; extensions.  This could take a &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt;...
Exception `Gem::InstallError&apos; at /Users/jhodges/.rvm/rubies/jruby-1.5.3/lib/ruby/site_ruby/1.8/rubygems/ext/builder.rb:16 - Makefile not found:

/Users/jhodges/.rvm/rubies/jruby-1.5.3/bin/jruby extconf.rb

Exception `Gem::Installer::ExtensionBuildError&apos; at /Users/jhodges/.rvm/rubies/jruby-1.5.3/lib/ruby/site_ruby/1.8/rubygems/installer.rb:482 - ERROR: Failed to build gem &lt;span class=&quot;code-keyword&quot;&gt;native&lt;/span&gt; extension.

/Users/jhodges/.rvm/rubies/jruby-1.5.3/bin/jruby extconf.rb


Gem files will remain installed in /Users/jhodges/.rvm/gems/jruby-1.5.3/gems/thrift-0.5.1 &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; inspection.
Results logged to /Users/jhodges/.rvm/gems/jruby-1.5.3/gems/thrift-0.5.1/ext/gem_make.out

ERROR:  Error installing pkg/thrift-0.5.1.gem:
	ERROR: Failed to build gem &lt;span class=&quot;code-keyword&quot;&gt;native&lt;/span&gt; extension.

/Users/jhodges/.rvm/rubies/jruby-1.5.3/bin/jruby extconf.rb


Gem files will remain installed in /Users/jhodges/.rvm/gems/jruby-1.5.3/gems/thrift-0.5.1 &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; inspection.
Results logged to /Users/jhodges/.rvm/gems/jruby-1.5.3/gems/thrift-0.5.1/ext/gem_make.out
Exception `Gem::SystemExitException&apos; at /Users/jhodges/.rvm/rubies/jruby-1.5.3/lib/ruby/site_ruby/1.8/rubygems/commands/install_command.rb:171 - Exiting RubyGems with exit_code 1
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="12928005" author="kclark" created="Wed, 3 Nov 2010 21:11:50 +0000"  >&lt;p&gt;Ahh, that&apos;d make sense. Could you try having the JRuby guard output a Makefile with stubbed out targets? Might be enough to fake it out.&lt;/p&gt;

&lt;p&gt;Soon as I have it reproing at home, I&apos;ll do the same.&lt;/p&gt;</comment>
                            <comment id="12930258" author="chriskite" created="Tue, 9 Nov 2010 19:47:29 +0000"  >&lt;p&gt;I am able to reproduce this issue with JRuby 1.5.3 and Thrift 0.5.0. &lt;/p&gt;

&lt;p&gt;However, if I first build against MRI 1.9.2 to generate a Makefile and then comment out extconf.rb, the JRuby gem builds and installs correctly. &lt;/p&gt;</comment>
                            <comment id="12932325" author="jmhodges" created="Tue, 16 Nov 2010 03:41:55 +0000"  >&lt;p&gt;This patch implements the &quot;okay, fine, we&apos;ll make a Makefile even though we don&apos;t need it&quot; fix to the extconf.rb call for JRuby. Fixes this ticket.&lt;/p&gt;</comment>
                            <comment id="12932688" author="jmhodges" created="Tue, 16 Nov 2010 22:19:51 +0000"  >&lt;p&gt;Er, wrong diff. One moment.&lt;/p&gt;</comment>
                            <comment id="12932695" author="jmhodges" created="Tue, 16 Nov 2010 22:27:32 +0000"  >&lt;p&gt;Corrected patch for jruby support.&lt;/p&gt;</comment>
                            <comment id="12933180" author="kclark" created="Wed, 17 Nov 2010 21:52:57 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="12933192" author="bryanduxbury" created="Wed, 17 Nov 2010 22:13:05 +0000"  >&lt;p&gt;This patch doesn&apos;t apply for me against the current Thrift trunk. It looks like a diff on a previous diff.&lt;/p&gt;</comment>
                            <comment id="12933207" author="jmhodges" created="Wed, 17 Nov 2010 22:27:33 +0000"  >&lt;p&gt;Diffing against trunk. Yeesh.&lt;/p&gt;</comment>
                            <comment id="12933213" author="bryanduxbury" created="Wed, 17 Nov 2010 22:37:01 +0000"  >&lt;p&gt;Hm:&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;bryanduxbury rb&amp;#93;&lt;/span&gt;$pwd&lt;br/&gt;
/Users/bryanduxbury/projects/thrift/thrift-trunk/lib/rb&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;bryanduxbury rb&amp;#93;&lt;/span&gt;$ruby -v&lt;br/&gt;
ruby 1.8.6 (2010-01-11 patchlevel 388) &lt;span class=&quot;error&quot;&gt;&amp;#91;i686-darwin10.4.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;bryanduxbury rb&amp;#93;&lt;/span&gt;$ruby ext/extconf.rb&lt;br/&gt;
ext/extconf.rb:20: uninitialized constant RUBY_ENGINE (NameError)&lt;/p&gt;&lt;/blockquote&gt;</comment>
                            <comment id="12933219" author="jmhodges" created="Wed, 17 Nov 2010 22:44:02 +0000"  >&lt;p&gt;Swear to god, I&apos;m not a total idiot.&lt;/p&gt;</comment>
                            <comment id="12933221" author="bryanduxbury" created="Wed, 17 Nov 2010 22:48:57 +0000"  >&lt;p&gt;Awesome, that version worked. I just committed this. Thanks for your persistence and responsiveness.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12459735" name="THRIFT-979-2.patch" size="373" author="jmhodges" created="Tue, 16 Nov 2010 22:27:31 +0000"/>
                            <attachment id="12459839" name="THRIFT-979-3.patch" size="581" author="jmhodges" created="Wed, 17 Nov 2010 22:27:33 +0000"/>
                            <attachment id="12459841" name="THRIFT-979-4.patch" size="606" author="jmhodges" created="Wed, 17 Nov 2010 22:44:02 +0000"/>
                            <attachment id="12459675" name="THRIFT-979.patch" size="340" author="jmhodges" created="Tue, 16 Nov 2010 03:41:55 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>187098</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 years, 1 week, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i16dfb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>245307</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>