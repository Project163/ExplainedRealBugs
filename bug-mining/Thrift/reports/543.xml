<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 08:03:43 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[THRIFT-1433] TServerSocket fix for MSVC</title>
                <link>https://issues.apache.org/jira/browse/THRIFT-1433</link>
                <project id="12310800" key="THRIFT">Thrift</project>
                    <description>&lt;p&gt;The changes to compile the Thrift library for Visual Studio #ifdef&apos;d out the bind section in TServerSocket.cpp. This prevented TSimpleServer, TThreadedServer and anything that uses TServerSocket transport from functioning.  The server side reports the following error due to &apos;bind&apos; being skipped:&lt;br/&gt;
TSimpleServer::run() listen(): Could not listen: errno = 10022&lt;/p&gt;

&lt;p&gt;The bind overload unfortunately results in a conflict with Microsoft&apos;s libraries. TServerSocket uses namespace std which pulls in the tr1 overloads of bind. The template definitions seem to always &apos;win&apos; over any other overloads. I was unsuccessful creating an overload of bind in the windows config.h file so had to #ifdef the bind call. Microsoft is aware of the issue:&lt;br/&gt;
&lt;a href=&quot;http://connect.microsoft.com/VisualStudio/feedback/details/500364/how-to-avoid-conflicts-between-tr1-bind-and-winsock-bind-function&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://connect.microsoft.com/VisualStudio/feedback/details/500364/how-to-avoid-conflicts-between-tr1-bind-and-winsock-bind-function&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;It does the job though I&apos;m not too proud of using #ifdefs. One possible way around this is to declare a wrapper function as such in config.h:&lt;/p&gt;

&lt;p&gt;inline int thriftbind(SOCKET socket, sockaddr* name, int namelen)&lt;br/&gt;
{&lt;br/&gt;
    return ::bind(socket, name, namelen);&lt;br/&gt;
}&lt;/p&gt;

&lt;p&gt;The Unix-style version would need to be declared in the appropriate file as well.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Windows Visual Studio 2010&lt;/p&gt;</environment>
        <key id="12532207">THRIFT-1433</key>
            <summary>TServerSocket fix for MSVC</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="peace">Peace C</reporter>
                        <labels>
                            <label>TServerSocket,</label>
                            <label>bind,</label>
                            <label>socket,</label>
                    </labels>
                <created>Mon, 21 Nov 2011 20:19:53 +0000</created>
                <updated>Fri, 27 Jan 2012 04:49:56 +0000</updated>
                            <resolved>Thu, 8 Dec 2011 20:44:29 +0000</resolved>
                                    <version>0.8</version>
                                    <fixVersion>0.9</fixVersion>
                                    <component>C++ - Library</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="13154457" author="peace" created="Mon, 21 Nov 2011 20:28:42 +0000"  >&lt;p&gt;TServerSocket patch for Visual Studio&lt;/p&gt;</comment>
                            <comment id="13154474" author="peace" created="Mon, 21 Nov 2011 20:41:23 +0000"  >&lt;p&gt;Correction: TThreadedServer is not yet included in the MSVC project.  TThreadPoolServer is supported and now works with this patch.&lt;/p&gt;</comment>
                            <comment id="13154579" author="peace" created="Mon, 21 Nov 2011 22:06:42 +0000"  >&lt;p&gt;Another thought &amp;#8211;  if ::bind works under Unix-style OS&apos;s, we could forgo the #ifdef around that line. The net change could be as follows for all platforms:&lt;/p&gt;

&lt;p&gt;(Old)&lt;br/&gt;
bind(serverSocket_, res-&amp;gt;ai_addr, res-&amp;gt;ai_addrlen)&lt;/p&gt;

&lt;p&gt;(New)&lt;br/&gt;
::bind(serverSocket_, res-&amp;gt;ai_addr, res-&amp;gt;ai_addrlen)&lt;/p&gt;</comment>
                            <comment id="13165143" author="roger.meier" created="Thu, 8 Dec 2011 10:43:55 +0000"  >&lt;p&gt;Thanks Peace&lt;/p&gt;

&lt;p&gt;could you recreate the patch &lt;span class=&quot;error&quot;&gt;&amp;#91;^TServerSocket_bind_alternate2.patch&amp;#93;&lt;/span&gt; please, it does not apply anymore to trunk&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;git apply TServerSocket_bind_alternate2.patch
TServerSocket_bind_alternate2.patch:9: trailing whitespace.
      if (0 == ::bind(serverSocket_, (struct sockaddr *) &amp;amp;address, len)) {
TServerSocket_bind_alternate2.patch:14: trailing whitespace.
#else
TServerSocket_bind_alternate2.patch:15: trailing whitespace.
    GlobalOutput.perror(&quot;TSocket::open() Unix Domain socket path not supported on windows&quot;, -99);
TServerSocket_bind_alternate2.patch:16: trailing whitespace.
    throw TTransportException(TTransportException::NOT_OPEN, &quot; Unix Domain socket path not supported&quot;);
TServerSocket_bind_alternate2.patch:17: trailing whitespace.
#endif
error: patch failed: lib/cpp/src/transport/TServerSocket.cpp:310
error: lib/cpp/src/transport/TServerSocket.cpp: patch does not apply
error: patch failed: lib/cpp/src/windows/config.h:72
error: lib/cpp/src/windows/config.h: patch does not apply
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Thanks!&lt;br/&gt;
Roger&lt;/p&gt;
</comment>
                            <comment id="13165444" author="peace" created="Thu, 8 Dec 2011 19:12:10 +0000"  >&lt;p&gt;Roger - Attached is an updated patch. Hope it works!&lt;/p&gt;

&lt;p&gt;(TServerSocket patch uses ::bind for all platforms instead of #ifdef&apos;s for Windows vs Unix)&lt;/p&gt;</comment>
                            <comment id="13165543" author="roger.meier" created="Thu, 8 Dec 2011 20:44:29 +0000"  >&lt;p&gt;I did not recognize... patch had wrong line endings (windows = CR+LF) instead of LF &lt;/p&gt;

&lt;p&gt;patch converted and committed&lt;/p&gt;</comment>
                            <comment id="13165689" author="hudson" created="Thu, 8 Dec 2011 23:44:57 +0000"  >&lt;p&gt;Integrated in Thrift #355 (See &lt;a href=&quot;https://builds.apache.org/job/Thrift/355/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Thrift/355/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-1433&quot; title=&quot;TServerSocket fix for MSVC&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-1433&quot;&gt;&lt;del&gt;THRIFT-1433&lt;/del&gt;&lt;/a&gt; TServerSocket fix for MSVC&lt;br/&gt;
Patch: Peace C&lt;/p&gt;

&lt;p&gt;roger : &lt;a href=&quot;http://svn.apache.org/viewvc/?view=rev&amp;amp;rev=1212109&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc/?view=rev&amp;amp;rev=1212109&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/thrift/trunk/lib/cpp/src/transport/TServerSocket.cpp&lt;/li&gt;
	&lt;li&gt;/thrift/trunk/lib/cpp/src/windows/config.h&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12504547" name="TServerSocket_bind.patch" size="2132" author="peace" created="Mon, 21 Nov 2011 20:28:42 +0000"/>
                            <attachment id="12506644" name="TServerSocket_bind_12-8-2011.patch" size="1863" author="peace" created="Thu, 8 Dec 2011 19:12:10 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>217943</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 50 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310041" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Patch Info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10042"><![CDATA[Patch Available]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i083wn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>45232</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>