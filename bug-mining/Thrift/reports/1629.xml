<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 08:24:41 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[THRIFT-3848] As an implementer of a perl socket server, I do not want to have to remember to ignore SIGCHLD for it to work properly</title>
                <link>https://issues.apache.org/jira/browse/THRIFT-3848</link>
                <project id="12310800" key="THRIFT">Thrift</project>
                    <description>&lt;p&gt;In a project I work on, we use a perl thrift server as a mock to simulate something in production.  A C++ client connects, makes a call, and disconnects.  The perl server is a forking server.&lt;/p&gt;

&lt;p&gt;I found that if I do not explicity ignore SIGCHLD, I can accept one connection and process it, but when it disconnects, the subsequent accept call is interrupted by a SIGCHLD and results in a useless handle that can_read says cannot be read.  This puts Server.pm into an infinite accept/read/fail loop.  The serve() method of the ForkingServer needs to explicitly ignore SIGCHLD to work properly.&lt;/p&gt;

&lt;p&gt;I&apos;ve observed this behavior as far back as thrift-0.8.0 up through 0.9.3.&lt;/p&gt;

&lt;p&gt;The workaround is to add the following code before calling serve():&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;$SIG{CHLD} = &lt;span class=&quot;code-quote&quot;&gt;&apos;IGNORE&apos;&lt;/span&gt;;&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment>&lt;p&gt;Ubuntu 14.04, perl forking server, C++ client&lt;/p&gt;</environment>
        <key id="12975217">THRIFT-3848</key>
            <summary>As an implementer of a perl socket server, I do not want to have to remember to ignore SIGCHLD for it to work properly</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jking3">James E. King III</assignee>
                                    <reporter username="jking3">James E. King III</reporter>
                        <labels>
                    </labels>
                <created>Thu, 2 Jun 2016 16:15:59 +0000</created>
                <updated>Thu, 2 Feb 2017 18:12:41 +0000</updated>
                            <resolved>Sun, 17 Jul 2016 16:10:23 +0000</resolved>
                                    <version>0.8</version>
                    <version>0.9</version>
                    <version>0.9.1</version>
                    <version>0.9.2</version>
                    <version>0.9.3</version>
                                    <fixVersion>0.10.0</fixVersion>
                                    <component>Perl - Library</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="15312572" author="jking3" created="Thu, 2 Jun 2016 16:20:15 +0000"  >&lt;p&gt;Found this while root causing the issue:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://stackoverflow.com/questions/7662711/perl-forked-socket-server-stops-accepting-connections-when-a-client-disconnects&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://stackoverflow.com/questions/7662711/perl-forked-socket-server-stops-accepting-connections-when-a-client-disconnects&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15367792" author="githubbot" created="Fri, 8 Jul 2016 15:05:54 +0000"  >&lt;p&gt;GitHub user jeking3 opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/1040&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/1040&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-3848&quot; title=&quot;As an implementer of a perl socket server, I do not want to have to remember to ignore SIGCHLD for it to work properly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-3848&quot;&gt;&lt;del&gt;THRIFT-3848&lt;/del&gt;&lt;/a&gt;: Perl ForkingServer must ignore SIGCHLD to avoid infinite loop&lt;/p&gt;



&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/jeking3/thrift&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/jeking3/thrift&lt;/a&gt; defect/&lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-3848&quot; title=&quot;As an implementer of a perl socket server, I do not want to have to remember to ignore SIGCHLD for it to work properly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-3848&quot;&gt;&lt;del&gt;THRIFT-3848&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/1040.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/1040.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #1040&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 1bc6497f502d45e3483c851f95fd6feff2cbf9a2&lt;br/&gt;
Author: Jim King &amp;lt;jim.king@simplivity.com&amp;gt;&lt;br/&gt;
Date:   2016-07-07T01:50:23Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-3848&quot; title=&quot;As an implementer of a perl socket server, I do not want to have to remember to ignore SIGCHLD for it to work properly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-3848&quot;&gt;&lt;del&gt;THRIFT-3848&lt;/del&gt;&lt;/a&gt;: Perl ForkingServer must ignore SIGCHLD to avoid infinite loop&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15368755" author="githubbot" created="Fri, 8 Jul 2016 23:54:15 +0000"  >&lt;p&gt;Github user jeking3 commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/1040&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/1040&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Rebased on master to fix the TServerIntegrationTest hang.&lt;/p&gt;</comment>
                            <comment id="15369199" author="jking3" created="Sat, 9 Jul 2016 17:06:22 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jensg&quot; class=&quot;user-hover&quot; rel=&quot;jensg&quot;&gt;jensg&lt;/a&gt; is there a way to kick a rebuild on the Travis CI job?  I only changed one line of code in a perl module, so it shouldn&apos;t have failed the way it did.  Also it needs a code review.&lt;/p&gt;</comment>
                            <comment id="15381407" author="githubbot" created="Sun, 17 Jul 2016 16:01:19 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/1040&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/1040&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15381408" author="jensg" created="Sun, 17 Jul 2016 16:10:23 +0000"  >&lt;p&gt;Committed, thanks Jim.&lt;/p&gt;</comment>
                            <comment id="15850122" author="jking3" created="Thu, 2 Feb 2017 16:26:11 +0000"  >&lt;p&gt;It&apos;s funny, but a project I work on changed to relies on SIGCHLD with recent code changes, and uses the ForkingServer, and this fix broke that behavior.  Sadly, without this change the thrift server implementation goes into a loop and consumes a lot of CPU.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310050">
                    <name>Regression</name>
                                            <outwardlinks description="breaks">
                                        <issuelink>
            <issuekey id="13039902">THRIFT-4065</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 41 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2ywdj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>