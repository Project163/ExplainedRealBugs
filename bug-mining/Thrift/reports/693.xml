<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 08:07:07 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[THRIFT-1318] Incorrect syntax for struct with enum property and default value when value is negative</title>
                <link>https://issues.apache.org/jira/browse/THRIFT-1318</link>
                <project id="12310800" key="THRIFT">Thrift</project>
                    <description>&lt;p&gt;If I have a struct with a property of type enum with a default value specified, and the default value is negative, then the code generated is incorrect and has a syntax error.&lt;/p&gt;

&lt;p&gt;E.G. thrift file like this:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;enum&lt;/span&gt; ReturnType {
    SuccessTypeA = 2
    SuccessUnknownType = 1,
    FailUnknown = -1,
    OtherFailure = -2
}

struct ReturnInformation {
	1: required ReturnType RetType = ReturnType.FailUnknown;
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Generates a constructor like this:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; MatchInformation() {
      &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;._MatchType = (MatchTypes)-1;
    }

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;which fails with an exception &quot;To cast a negative value, you must enclose the value in parentheses&quot;.&lt;/p&gt;

&lt;p&gt;I have updated the code to always put the enum constant value in parentheses (positive or negative), but need to get the compiler built and tested before I can submit a patch. Any chance someone could do this for me?&lt;br/&gt;
&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;
</description>
                <environment>&lt;p&gt;Windows 7 / .net 4.0&lt;/p&gt;</environment>
        <key id="12520990">THRIFT-1318</key>
            <summary>Incorrect syntax for struct with enum property and default value when value is negative</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jensg">Jens Geyer</assignee>
                                    <reporter username="slimunholyone">Thunder Stumpges</reporter>
                        <labels>
                    </labels>
                <created>Wed, 31 Aug 2011 23:50:12 +0000</created>
                <updated>Fri, 22 Mar 2013 18:10:22 +0000</updated>
                            <resolved>Sun, 10 Mar 2013 17:08:47 +0000</resolved>
                                    <version>0.7</version>
                                                    <component>C# - Compiler</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>4</watches>
                                    <workratio workratioPercent="0"/>
                                    <progress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                    <timeoriginalestimate seconds="3600">1h</timeoriginalestimate>
                            <timeestimate seconds="3600">1h</timeestimate>
                                        <comments>
                            <comment id="13095040" author="slimunholyone" created="Thu, 1 Sep 2011 01:09:24 +0000"  >&lt;p&gt;Added patch file. Pretty confident this will work! Have NOT gotten the code to build however due to my not having an environment set up to compile the project. Any chance someone could take this for me and run with it??!&lt;/p&gt;</comment>
                            <comment id="13095089" author="slimunholyone" created="Thu, 1 Sep 2011 03:02:23 +0000"  >&lt;p&gt;Got my environment to build the compiler and in testing realized I updated &apos;render_const_value&apos; but not &apos;print_const_value&apos; and the latter was in use when making the default constructor. I believe the fix is applicable to &apos;render_const_value&apos; as well so I left it. The new patch should be correct and works great for me!&lt;/p&gt;</comment>
                            <comment id="13595161" author="slimunholyone" created="Wed, 6 Mar 2013 21:56:45 +0000"  >&lt;p&gt;Been a long time now, any chance someone could look at this? I have to manually re-apply this patch each time I upgrade versions, and it seems like a simple fix.&lt;/p&gt;</comment>
                            <comment id="13595241" author="jensg" created="Wed, 6 Mar 2013 22:56:52 +0000"  >&lt;p&gt;Ok, I will, but tomorrow.&lt;/p&gt;</comment>
                            <comment id="13596535" author="jensg" created="Thu, 7 Mar 2013 23:12:09 +0000"  >&lt;p&gt;I had some difficulties applying your old SVN patch. I finally came up with this solution which is IMHO much better, as it makes more sense to write the assignments as &lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.property = MyEnumType.SomeValue;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;instead of the C-ish casting style like&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.property = (MyEnumType)(-42);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;And since it seems not to be possible to assign values other than the IDL-defined enum values, there is no reason left to use the cast.&lt;/p&gt;</comment>
                            <comment id="13596554" author="slimunholyone" created="Thu, 7 Mar 2013 23:27:44 +0000"  >&lt;p&gt;Thanks, your solution is great. I simply was trying to change as little as possible to keep it working &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; Appreciate the attention to this!&lt;/p&gt;</comment>
                            <comment id="13598311" author="jensg" created="Sun, 10 Mar 2013 17:08:47 +0000"  >&lt;p&gt;Committed.&lt;/p&gt;</comment>
                            <comment id="13598366" author="hudson" created="Sun, 10 Mar 2013 20:06:16 +0000"  >&lt;p&gt;Integrated in Thrift #629 (See &lt;a href=&quot;https://builds.apache.org/job/Thrift/629/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Thrift/629/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-1318&quot; title=&quot;Incorrect syntax for struct with enum property and default value when value is negative&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-1318&quot;&gt;&lt;del&gt;THRIFT-1318&lt;/del&gt;&lt;/a&gt; Incorrect syntax for struct with enum property and default value when value is negative (Revision b3fb3e60925089b6d4c672d7d2cff76a94303b6a)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
jensg : &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=thrift.git&amp;amp;a=commit&amp;amp;h=b3fb3e60925089b6d4c672d7d2cff76a94303b6a&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=thrift.git&amp;amp;a=commit&amp;amp;h=b3fb3e60925089b6d4c672d7d2cff76a94303b6a&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;compiler/cpp/src/generate/t_csharp_generator.cc&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12492568" name="NegativeEnumConstant.patch" size="1097" author="slimunholyone" created="Thu, 1 Sep 2011 03:02:23 +0000"/>
                            <attachment id="12572636" name="THRIFT-1318_Incorrect_syntax_for_struct_with_enum_property_and_default_value_when_value_is_negative_rev2.patch" size="3099" author="jensg" created="Thu, 7 Mar 2013 23:12:09 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>62970</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 37 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310041" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Patch Info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10042"><![CDATA[Patch Available]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i14itb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>234511</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>