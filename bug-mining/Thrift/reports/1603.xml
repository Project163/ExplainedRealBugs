<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 08:24:16 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[THRIFT-3790] Fix Delphi named pipe client to use timeout even when pipe doesn&apos;t yet exist</title>
                <link>https://issues.apache.org/jira/browse/THRIFT-3790</link>
                <project id="12310800" key="THRIFT">Thrift</project>
                    <description>&lt;p&gt;In the Delphi test code, the test client closes the connection and then immediately reopens it.  However, it takes a small amount of time for the server to tear down the connection and then rebuild it.  In that time, the client has issued an Open() call on the pipe client when the server hasn&apos;t yet recreated the pipe.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12959827">THRIFT-3790</key>
            <summary>Fix Delphi named pipe client to use timeout even when pipe doesn&apos;t yet exist</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="KyleJ61782">Kyle Johnson</assignee>
                                    <reporter username="KyleJ61782">Kyle Johnson</reporter>
                        <labels>
                    </labels>
                <created>Mon, 18 Apr 2016 23:40:43 +0000</created>
                <updated>Sat, 20 Feb 2021 15:27:38 +0000</updated>
                            <resolved>Wed, 20 Apr 2016 10:50:57 +0000</resolved>
                                                    <fixVersion>0.10.0</fixVersion>
                                    <component>Delphi - Library</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="15246777" author="kylej61782" created="Mon, 18 Apr 2016 23:43:45 +0000"  >&lt;p&gt;Here is the patch that fixes the closing and immediate reopening issue exposed by the Delphi test client.  This causes the entire timeout to be used in attempting to connect to the named pipe server, even if the pipe hasn&apos;t yet been created by the server.&lt;/p&gt;</comment>
                            <comment id="15248673" author="jensg" created="Tue, 19 Apr 2016 21:21:16 +0000"  >&lt;p&gt;The timeout calculation in the loop is ... interesting. At least the impl does not match the comment.&lt;/p&gt;</comment>
                            <comment id="15248724" author="jensg" created="Tue, 19 Apr 2016 21:41:19 +0000"  >&lt;p&gt;&lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12799601/12799601_0002-THRIFT-3790-Fix-Delphi-named-pipe-client-to-use-time.patch&quot; title=&quot;0002-THRIFT-3790-Fix-Delphi-named-pipe-client-to-use-time.patch attached to THRIFT-3790&quot;&gt;Committed version&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;&lt;/p&gt;</comment>
                            <comment id="15248725" author="jensg" created="Tue, 19 Apr 2016 21:42:09 +0000"  >&lt;p&gt;Committed, thanks!&lt;/p&gt;</comment>
                            <comment id="15248745" author="kylej61782" created="Tue, 19 Apr 2016 21:49:29 +0000"  >&lt;p&gt;Grabbed the timeout algo from the ReadDirect code.  Works well enough to ensure a delay approximate to the timeout (close enough, anyway).  If the wait fails it will do so either immediately or after the timeout.  If it&apos;s after the timeout, it&apos;s just done and the exception is thrown (because ERROR_FILE_NOT_FOUND fails immediately).  If it fails immediately and it&apos;s for something other than the pipe not being created, then we throw the exception.  Really the only time it ends up using the delay is when the pipe hasn&apos;t been created.&lt;/p&gt;</comment>
                            <comment id="15248754" author="kylej61782" created="Tue, 19 Apr 2016 21:52:28 +0000"  >&lt;p&gt;Much better implementation.  Thanks.  Kind of braindead code on my part.  &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="15249573" author="jensg" created="Wed, 20 Apr 2016 09:53:20 +0000"  >&lt;p&gt;That breaks existing code. We have a use case where we want to fail the code FAST on non-existing pipes. The previous implementation did exactly that.&lt;/p&gt;</comment>
                            <comment id="15249592" author="jensg" created="Wed, 20 Apr 2016 10:12:34 +0000"  >&lt;p&gt;I have a patch.&lt;/p&gt;</comment>
                            <comment id="15249637" author="jensg" created="Wed, 20 Apr 2016 10:50:57 +0000"  >&lt;p&gt;Committed. &lt;/p&gt;

&lt;p&gt;I added a separate timeout for open, the default is - for compatibility reasons - very low. Either case, WaitNamedPipe() is at least called once.&lt;/p&gt;</comment>
                            <comment id="15249663" author="kylej61782" created="Wed, 20 Apr 2016 11:18:35 +0000"  >&lt;p&gt;How should the test case be handled, then?  In the test handler, right after the client has the server throw an unhandled exception, the test client closes and reopens the connection.  Perhaps put a retry loop of some sort in there?&lt;/p&gt;</comment>
                            <comment id="15250142" author="jensg" created="Wed, 20 Apr 2016 15:59:54 +0000"  >&lt;p&gt;That&apos;s why I made it two parameters. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="15250159" author="kylej61782" created="Wed, 20 Apr 2016 16:10:40 +0000"  >&lt;p&gt;Adding test client fix to use the new pipe open timeout.  Done and done.  &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="15253195" author="hudson" created="Fri, 22 Apr 2016 02:18:24 +0000"  >&lt;p&gt;SUCCESS: Integrated in Thrift-precommit #438 (See &lt;a href=&quot;https://builds.apache.org/job/Thrift-precommit/438/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Thrift-precommit/438/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-3790&quot; title=&quot;Fix Delphi named pipe client to use timeout even when pipe doesn&amp;#39;t yet exist&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-3790&quot;&gt;&lt;del&gt;THRIFT-3790&lt;/del&gt;&lt;/a&gt; Fix Delphi named pipe client to use timeout even when pipe (jensg: &lt;a href=&quot;https://github.com/apache/thrift/commit/b89b5b9d03f322043f70c552b1a56b5fdb57ef84&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/commit/b89b5b9d03f322043f70c552b1a56b5fdb57ef84&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;lib/delphi/src/Thrift.Transport.Pipes.pas&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-3790&quot; title=&quot;Fix Delphi named pipe client to use timeout even when pipe doesn&amp;#39;t yet exist&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-3790&quot;&gt;&lt;del&gt;THRIFT-3790&lt;/del&gt;&lt;/a&gt; Fix Delphi named pipe client to use timeout even when pipe (jensg: &lt;a href=&quot;https://github.com/apache/thrift/commit/653f0de4813ed3cbff508a735ad77b03f4fb1c84&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/commit/653f0de4813ed3cbff508a735ad77b03f4fb1c84&lt;/a&gt;)&lt;/li&gt;
	&lt;li&gt;lib/delphi/src/Thrift.Transport.Pipes.pas&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-3790&quot; title=&quot;Fix Delphi named pipe client to use timeout even when pipe doesn&amp;#39;t yet exist&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-3790&quot;&gt;&lt;del&gt;THRIFT-3790&lt;/del&gt;&lt;/a&gt; Fix Delphi named pipe client to use timeout even when pipe (jensg: &lt;a href=&quot;https://github.com/apache/thrift/commit/ae985dda55418c6524da5dd7e6a466fc8d1656a8&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/commit/ae985dda55418c6524da5dd7e6a466fc8d1656a8&lt;/a&gt;)&lt;/li&gt;
	&lt;li&gt;lib/delphi/test/TestClient.pas&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12799720" name="0001-THRIFT-3790-Fix-Delphi-named-pipe-client-to-use-time.patch" size="5504" author="jensg" created="Wed, 20 Apr 2016 10:49:31 +0000"/>
                            <attachment id="12799601" name="0002-THRIFT-3790-Fix-Delphi-named-pipe-client-to-use-time.patch" size="2279" author="jensg" created="Tue, 19 Apr 2016 21:41:19 +0000"/>
                            <attachment id="12799775" name="THRIFT-3790-Test-client-fix.patch" size="555" author="KyleJ61782" created="Wed, 20 Apr 2016 16:10:40 +0000"/>
                            <attachment id="12799386" name="THRIFT-3790-fix-for-closing-and-reopening-client-pipe-connection.patch" size="1692" author="KyleJ61782" created="Mon, 18 Apr 2016 23:43:45 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310250" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10430"><![CDATA[Patch]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 30 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310041" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Patch Info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10042"><![CDATA[Patch Available]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2waif:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>