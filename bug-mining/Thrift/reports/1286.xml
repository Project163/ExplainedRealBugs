<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 08:19:24 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[THRIFT-3225] Fix TPipeServer unpredictable behavior on interrupt()</title>
                <link>https://issues.apache.org/jira/browse/THRIFT-3225</link>
                <project id="12310800" key="THRIFT">Thrift</project>
                    <description>&lt;p&gt;If TPipeServer::interrupt() is invoked from other thread than the thread that is blocked on TPipeServer::serve() the handle may be closed by interrupting thread while still used by servicing thread.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Windows&lt;/p&gt;</environment>
        <key id="12843162">THRIFT-3225</key>
            <summary>Fix TPipeServer unpredictable behavior on interrupt()</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="pjanicki">Pawe&#322; Janicki</assignee>
                                    <reporter username="pjanicki">Pawe&#322; Janicki</reporter>
                        <labels>
                            <label>patch</label>
                    </labels>
                <created>Tue, 7 Jul 2015 11:21:44 +0000</created>
                <updated>Tue, 21 Jul 2015 02:21:16 +0000</updated>
                            <resolved>Thu, 16 Jul 2015 13:14:59 +0000</resolved>
                                    <version>0.9.2</version>
                                    <fixVersion>0.9.3</fixVersion>
                                    <component>C++ - Library</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="14617321" author="ben.craig" created="Tue, 7 Jul 2015 20:26:45 +0000"  >&lt;p&gt;-1&lt;/p&gt;

&lt;p&gt;close() doesn&apos;t need to be / shouldn&apos;t be thread safe, and this patch doesn&apos;t solve the race condition.  The &apos;other&apos; thread should be calling interrupt() on the pipe, then let the main server thread close the pipe when it is complete.&lt;/p&gt;

&lt;p&gt;Closing a transport that is currently in use is an anti-pattern.  You wouldn&apos;t delete memory while it is in use.  You shouldn&apos;t close a transport while it is in use.  This &apos;mostly&apos; works for sockets, but only &apos;mostly&apos;.&lt;/p&gt;</comment>
                            <comment id="14617324" author="jensg" created="Tue, 7 Jul 2015 20:28:12 +0000"  >&lt;p&gt;Committed, thanks for catching this!&lt;/p&gt;

&lt;p&gt;PS: The patch didn&apos;t apply cleanly against master HEAD without some manual intervention. Next time please make sure patches are rebased properly. We also accept pull requests (hint-hint &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;).&lt;/p&gt;</comment>
                            <comment id="14617327" author="jensg" created="Tue, 7 Jul 2015 20:29:32 +0000"  >&lt;p&gt;True. But that implies that the whole design is broken. Feel free to reopen, I saw your reply too late. Sorry.&lt;/p&gt;</comment>
                            <comment id="14617329" author="ben.craig" created="Tue, 7 Jul 2015 20:30:10 +0000"  >&lt;p&gt;doh!  please back this out.  I&apos;m reviewing some of the other pipe patches in the mean time.&lt;/p&gt;</comment>
                            <comment id="14617341" author="jensg" created="Tue, 7 Jul 2015 20:35:14 +0000"  >&lt;p&gt;Reverted.&lt;/p&gt;</comment>
                            <comment id="14617380" author="hudson" created="Tue, 7 Jul 2015 20:50:50 +0000"  >&lt;p&gt;SUCCESS: Integrated in Thrift #1594 (See &lt;a href=&quot;https://builds.apache.org/job/Thrift/1594/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Thrift/1594/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-3225&quot; title=&quot;Fix TPipeServer unpredictable behavior on interrupt()&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-3225&quot;&gt;&lt;del&gt;THRIFT-3225&lt;/del&gt;&lt;/a&gt; Fix TPipeServer unpredictable behavior on close (jensg: rev f48588f124fb8636f94bf23d098d4483f077e2de)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;lib/cpp/src/thrift/transport/TPipeServer.cpp&lt;br/&gt;
Revert &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-3225&quot; title=&quot;Fix TPipeServer unpredictable behavior on interrupt()&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-3225&quot;&gt;&lt;del&gt;THRIFT-3225&lt;/del&gt;&lt;/a&gt; Fix TPipeServer unpredictable behavior on close&quot; (jensg: rev 17044564494a4e6354a49670c281555f9704ecc1)&lt;/li&gt;
	&lt;li&gt;lib/cpp/src/thrift/transport/TPipeServer.cpp&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14620025" author="pjanicki" created="Thu, 9 Jul 2015 07:14:24 +0000"  >&lt;p&gt;I rebased to latest master.&lt;br/&gt;
The patch 0001 is to be abadoned then.&lt;/p&gt;

&lt;p&gt;Changed description. (for future: Should I open new issue and abadon this or update this issue, if changed the issue description?)&lt;/p&gt;

&lt;p&gt;There is similiar problem with interrupt() then.&lt;br/&gt;
The handle may be closed by interrupting thread while still used by servicing thread.&lt;/p&gt;
</comment>
                            <comment id="14620144" author="pjanicki" created="Thu, 9 Jul 2015 08:49:24 +0000"  >&lt;p&gt;Attached patch 0002&lt;/p&gt;</comment>
                            <comment id="14621624" author="ben.craig" created="Fri, 10 Jul 2015 02:27:39 +0000"  >&lt;p&gt;This might be right.  I&apos;m going to try to dig up (and main line) some TPipe tests.  I&apos;ll then stare at the code some more.  At first glance though, it seems reasonable.&lt;/p&gt;</comment>
                            <comment id="14621951" author="pjanicki" created="Fri, 10 Jul 2015 08:09:24 +0000"  >&lt;p&gt;Are there any existing tests for NamedPipes? Now I&apos;m writing my own ad-hoc tests.&lt;/p&gt;

&lt;p&gt;The implementation seems to have very low coverage.&lt;/p&gt;</comment>
                            <comment id="14623326" author="jensg" created="Sat, 11 Jul 2015 09:24:18 +0000"  >&lt;p&gt;Not really, no. Could be worth to include them into the cross test. &lt;/p&gt;

&lt;p&gt;We don&apos;t have that much languages with Anon/Named Pipes support yet, but since they are just great for Windows-based programs, I expect to get more support for them sooner or later. Today we have them in C++, C# and Delphi - the latter not being covered by the cross test at all, unfortunately. But that&apos;s another story.&lt;/p&gt;</comment>
                            <comment id="14629697" author="ben.craig" created="Thu, 16 Jul 2015 13:14:48 +0000"  >&lt;p&gt;Resolved in the same patch as &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-3224&quot; title=&quot;Fix TNamedPipeServer unpredictable behavior on accept&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-3224&quot;&gt;&lt;del&gt;THRIFT-3224&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12743944" name="0001-THRIFT-3225.-cpp-Fix-TPipeServer-unpredictable-behav.patch" size="1061" author="pjanicki" created="Tue, 7 Jul 2015 11:33:12 +0000"/>
                            <attachment id="12744453" name="0002-THRIFT-3225.-cpp-Fix-TPipeServer-unpredictable-behav.patch" size="1872" author="pjanicki" created="Thu, 9 Jul 2015 08:52:08 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310250" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10430"><![CDATA[Patch]]></customfieldvalue>
    <customfieldvalue key="10431"><![CDATA[Important]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 18 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310041" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Patch Info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10042"><![CDATA[Patch Available]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2gxmv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>