<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 07:54:53 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[THRIFT-391] Memory leak in fastbinary</title>
                <link>https://issues.apache.org/jira/browse/THRIFT-391</link>
                <project id="12310800" key="THRIFT">Thrift</project>
                    <description>&lt;p&gt;When a struct has a map member, fastbinary.binary_encode leaks memory.&lt;/p&gt;

&lt;p&gt;Use testmem.tar.gz app to recreate the problem.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;# tar xzf testmem.tar.gz
# cd testmem
# ./testmem fast
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;As this is running, use top or pidstat to view the memory consumed by the process. Hit CTRL-C to stop. On my system it steadily increases.&lt;/p&gt;

&lt;p&gt;To compare the results using the &apos;default&apos; encoding technique (using pure Python TBinaryProtocol), run testmem as follows:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;# ./testmem &lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Note (again, using top, pidstat, etc.) that the memory used is constant.&lt;/p&gt;

&lt;p&gt;It appears that the &apos;map&apos; member triggers this. E.g. string, int members do not cause the leak.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Linux 2.6.21 (Debian)&lt;/p&gt;</environment>
        <key id="12419165">THRIFT-391</key>
            <summary>Memory leak in fastbinary</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="shigin">Alexander Shigin</assignee>
                                    <reporter username="gar1t">Garrett Smith</reporter>
                        <labels>
                    </labels>
                <created>Sat, 21 Mar 2009 20:47:59 +0000</created>
                <updated>Tue, 24 Mar 2009 01:41:11 +0000</updated>
                            <resolved>Tue, 24 Mar 2009 01:41:11 +0000</resolved>
                                                    <fixVersion>0.1</fixVersion>
                                    <component>Python - Library</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12688077" author="gar1t" created="Sat, 21 Mar 2009 20:51:03 +0000"  >&lt;p&gt;Refer to issue description for instructions on using this file.&lt;/p&gt;</comment>
                            <comment id="12688113" author="shigin" created="Sun, 22 Mar 2009 10:14:04 +0000"  >&lt;p&gt;It seems the patch solves the problem. &lt;/p&gt;

&lt;p&gt;Can anyone review it? David, I think we can solve the problem by eliminating Py_INCREF (there is your TODO), but i am not guru of python c-api.&lt;/p&gt;</comment>
                            <comment id="12688119" author="ahfeel" created="Sun, 22 Mar 2009 11:00:48 +0000"  >&lt;p&gt;I&apos;m not a python c-api pro, but the patch looks obvious and correct. I think the Py_INCREF / DECREF should be kept here to avoid unsafe garbage collection in multithreaded environment. So, lgtm, +1.&lt;/p&gt;</comment>
                            <comment id="12688378" author="kclark" created="Mon, 23 Mar 2009 18:57:17 +0000"  >&lt;p&gt;Ok, if there&apos;s no objection today, I&apos;ll push the patch.&lt;/p&gt;</comment>
                            <comment id="12688527" author="kclark" created="Tue, 24 Mar 2009 01:41:11 +0000"  >&lt;p&gt;Pushed in 757634.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12403376" name="testmem.tar.gz" size="1815" author="gar1t" created="Sat, 21 Mar 2009 20:51:03 +0000"/>
                            <attachment id="12403379" name="thrift-fastbinary-leak.patch" size="410" author="shigin" created="Sun, 22 Mar 2009 10:14:04 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>186595</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            16 years, 36 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310041" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Patch Info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10042"><![CDATA[Patch Available]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i14pnz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>235623</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>