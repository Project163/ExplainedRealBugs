<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 08:10:18 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[THRIFT-2219] Thrift gem fails to build on OS X Mavericks with 1.9.3 rubies</title>
                <link>https://issues.apache.org/jira/browse/THRIFT-2219</link>
                <project id="12310800" key="THRIFT">Thrift</project>
                    <description>&lt;p&gt;(Preface, this issue is for the unreleased OS X Mavericks, so understand if it&apos;s not fixable now, just wanted to bring it up.)&lt;/p&gt;

&lt;p&gt;I&apos;m unable install the 0.9.1 thrift gem on my GM OS X Mavericks system with ruby 1.9.3-p448. I get the error `extconf.rb:25: Use RbConfig instead of obsolete and deprecated Config.` along with some strlcopy errors. &lt;/p&gt;

&lt;p&gt;Strack trace is at (&lt;a href=&quot;https://gist.github.com/chrismanderson/6834809&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gist.github.com/chrismanderson/6834809&lt;/a&gt;)&lt;/p&gt;

&lt;p&gt;Oddly, I CAN install the 0.9.1 gem with both 2.0.0-p247 and ree-1.8.7-2011.12. I also tried 1.9.3-p194 and p429 and got the same error.&lt;/p&gt;</description>
                <environment>&lt;p&gt;OS X Mavericks (GM), ruby 1.9.3-p448 built with rbenv/ruby-build&lt;/p&gt;</environment>
        <key id="12672435">THRIFT-2219</key>
            <summary>Thrift gem fails to build on OS X Mavericks with 1.9.3 rubies</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jfarrell">Jake Farrell</assignee>
                                    <reporter username="chrismanderson">Chris Anderson</reporter>
                        <labels>
                    </labels>
                <created>Sat, 5 Oct 2013 00:05:12 +0000</created>
                <updated>Tue, 7 Jan 2014 04:53:52 +0000</updated>
                            <resolved>Tue, 7 Jan 2014 03:53:44 +0000</resolved>
                                    <version>0.9.1</version>
                                    <fixVersion>0.9.2</fixVersion>
                                    <component>Ruby - Library</component>
                        <due></due>
                            <votes>5</votes>
                                    <watches>8</watches>
                                                                                                                <comments>
                            <comment id="13788533" author="ccutrer" created="Mon, 7 Oct 2013 20:34:07 +0000"  >&lt;p&gt;note that Mavericks is now GM, so essentially released&lt;/p&gt;</comment>
                            <comment id="13795166" author="chrismanderson" created="Tue, 15 Oct 2013 13:15:10 +0000"  >&lt;p&gt;Did a little more digging - on a fresh 10.9 system, with only rbenv, ruby-build, and 1.9.3-p448 installed via homebrew, the gem builds. Once you install the Xcode command line tools however, the install fails with the above error. GCC looks to be the same version before/after, so something else is gumming up the works.&lt;/p&gt;</comment>
                            <comment id="13801459" author="nham" created="Tue, 22 Oct 2013 04:19:48 +0000"  >&lt;p&gt;The issue is that in Mavericks, strlcpy is now defined as a macro if you install the SDK. This conflicts with the duplicate declaration of strlcpy as a function in strlcpy.h. The fix should be simple: don&apos;t re-declare the strlcpy prototype in strlcpy.h. Just remove that line, since &amp;lt;string.h&amp;gt; is guaranteed to have declared strlcpy declared already--this is tested for already in lib/rb/ext/extconf.rb via the call to have_func(&quot;strlcpy&quot;, &quot;string.h&quot;).&lt;/p&gt;

&lt;p&gt;As a temporary fix for folks using gems, you can try setting the #define&apos;ing the _FORTIFY_SOURCE macro to 0 to make strlcpy a function rather than a macro:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;$ gem install thrift -- --with-cppflags=&apos;-D_FORTIFY_SOURCE=0&apos;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;or if you&apos;re using bundler, you can set the cflags for thrift locally via:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;$ bundle config build.thrift --with-cppflags=&apos;-D_FORTIFY_SOURCE=0&apos;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The workaround uses with-cppflags rather than with-cflags since since thrift&apos;s extconf.rb overwrites the $cflags global with its own stuff, but leaves $cppflags alone. Ruby&apos;s mkmf.rb passes both $cflags and $cppflags along to the compiler so this slightly hacky workaround seems to work.&lt;/p&gt;</comment>
                            <comment id="13806364" author="mroth" created="Sun, 27 Oct 2013 15:59:15 +0000"  >&lt;p&gt;Ben Nham&apos;s hack works!&lt;/p&gt;</comment>
                            <comment id="13838345" author="antifuchs" created="Tue, 3 Dec 2013 23:47:08 +0000"  >&lt;p&gt;Looks like Ben Nham&apos;s diagnosis is correct: The declaration of strlcpy there causes badness. Removing that #else branch on the strlcpy.h ifdef seems to do the trick. This is essentially the same change as &lt;a href=&quot;https://github.com/nearbuy/thrift/commit/b20535e9d58e0f099338f690bab856ceb0041e63&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/nearbuy/thrift/commit/b20535e9d58e0f099338f690bab856ceb0041e63&lt;/a&gt;, but I decided to remove the now-useless #else as well.&lt;/p&gt;

&lt;p&gt;I tested this in 10.9 and on Linux, and the gem builds there. I&apos;ll test on 10.7 later today (as soon as I get access to a machine running it); I hope that will give us enough certainty this is the correct change to make.&lt;/p&gt;

&lt;p&gt;(This is my first submission to the Apache JIRA; please let me know if I screwed anything up &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;)&lt;/p&gt;</comment>
                            <comment id="13863792" author="antifuchs" created="Tue, 7 Jan 2014 01:47:21 +0000"  >&lt;p&gt;I just tested the previous patch on 10.7 and discovered it was reversed. Oops. Attaching a patch that goes in the correct direction.&lt;/p&gt;

&lt;p&gt;In my tests works on both 10.9 and 10.7. I hope we can get this committed so the next release comes with a ruby gem that can be installed on 10.9.&lt;/p&gt;</comment>
                            <comment id="13863871" author="jfarrell" created="Tue, 7 Jan 2014 03:29:04 +0000"  >&lt;p&gt;removing the extern is not the correct approach due to systems that may have strlcpy already defined, and using _FORTIFY_SOURCE=0 in the cpp flags is a hacky workaround. instead i would like to see us use the __has_builtin macro to check and see if strlcpy is a builtin and if not then include the extern strlcopy&lt;/p&gt;

&lt;p&gt;#if !__has_builtin(strlcpy)&lt;br/&gt;
extern size_t strlcpy(char *, const char *, size_t);&lt;br/&gt;
#endif&lt;/p&gt;

&lt;p&gt;tested on mav and verifying this works on centos, ubuntu and and windows and then will commit&lt;/p&gt;</comment>
                            <comment id="13863883" author="jfarrell" created="Tue, 7 Jan 2014 03:53:44 +0000"  >&lt;p&gt;commit 05f37f1&lt;/p&gt;</comment>
                            <comment id="13863904" author="hudson" created="Tue, 7 Jan 2014 04:53:52 +0000"  >&lt;p&gt;SUCCESS: Integrated in Thrift #986 (See &lt;a href=&quot;https://builds.apache.org/job/Thrift/986/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Thrift/986/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-2219&quot; title=&quot;Thrift gem fails to build on OS X Mavericks with 1.9.3 rubies&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-2219&quot;&gt;&lt;del&gt;THRIFT-2219&lt;/del&gt;&lt;/a&gt;: Thrift gem fails to build on OS X Mavericks (jfarrell: rev 05f37f1917bfa89d5862e4e45896bc6e28d8fa51)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;lib/rb/ext/strlcpy.h&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12672688">THRIFT-2222</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12621735" name="thrift-2219-no-strlcpy-redeclaration_2.patch" size="314" author="antifuchs" created="Tue, 7 Jan 2014 01:47:21 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>352062</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 46 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1op7r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>352350</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>