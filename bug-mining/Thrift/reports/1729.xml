<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 08:26:30 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[THRIFT-4029] Accelerated protocols do not build from thrift-py 0.10.0 on PyPI</title>
                <link>https://issues.apache.org/jira/browse/THRIFT-4029</link>
                <project id="12310800" key="THRIFT">Thrift</project>
                    <description>&lt;p&gt;The thrift 0.10.0 distribution on PyPI does not include extension headers and a C++ (template) file, preventing the accelerated protocols from being built.  &lt;tt&gt;pip install&lt;/tt&gt; reports a brief error:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Running thrift-0.10.0/setup.py -q bdist_egg --dist-dir /tmp/easy_install-bVU8VN/thrift-0.10.0/egg-dist-tmp-ghJzGL
cc1plus: warning: command line option &#8216;-Wstrict-prototypes&#8217; is valid &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; C/ObjC but not &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; C++
src/ext/module.cpp:21:19: fatal error: types.h: No such file or directory
 #include &lt;span class=&quot;code-quote&quot;&gt;&quot;types.h&quot;&lt;/span&gt;
                   ^
compilation terminated.
()
********************************************************************************
An error occurred &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; trying to compile with the C extension enabled
Attempting to build without the extension now
********************************************************************************
()
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The list of files that is not included in the distribution is as follows.  In addition to the headers and source file mentioned above, there&apos;s a Windows compatibility header missing and a couple of test files missing.  It looks like there was a file extension filter (accidentally) applied to the C++ files at least:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;src/ext/binary.h
src/ext/compact.h
src/ext/endian.h
src/ext/protocol.h
src/ext/protocol.tcc
src/ext/types.h
compat/win32/stdint.h
test/_import_local_thrift.py
test/thrift_json.py
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jfarrell&quot; class=&quot;user-hover&quot; rel=&quot;jfarrell&quot;&gt;jfarrell&lt;/a&gt; were you who made the release?  Is it possible to hotfix?  My team has been waiting on the release of the accelerated compact protocol for a while, this discovery is saddening for us.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13034658">THRIFT-4029</key>
            <summary>Accelerated protocols do not build from thrift-py 0.10.0 on PyPI</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jking3">James E. King III</assignee>
                                    <reporter username="cjmay">Chandler May</reporter>
                        <labels>
                    </labels>
                <created>Fri, 13 Jan 2017 14:10:22 +0000</created>
                <updated>Thu, 14 Dec 2017 13:54:56 +0000</updated>
                            <resolved>Fri, 10 Mar 2017 11:25:36 +0000</resolved>
                                    <version>0.10.0</version>
                                    <fixVersion>0.11.0</fixVersion>
                                    <component>Python - Library</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="15821932" author="jfarrell" created="Fri, 13 Jan 2017 16:00:52 +0000"  >&lt;p&gt;Not sure why `python setup.py sdist` is not including the headers as the include_dirs is listed for the extension, nothing new occurring here as far as the steps used to package and push that artifact. Does using a MANIFEST.in with the following fix the issue for you? If so we could look at getting that fixed&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;graft src
graft compat
graft tests
global-exclude __pycache__
global-exclude *.py[co]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="15822573" author="anatolikus" created="Sat, 14 Jan 2017 00:40:46 +0000"  >&lt;p&gt;I see the same issue at Arch Linux&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;==&amp;gt; Starting build()...
running build
running build_py
running build_ext
building &lt;span class=&quot;code-quote&quot;&gt;&apos;thrift.protocol.fastbinary&apos;&lt;/span&gt; extension
gcc -pthread -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -march=x86-64 -mtune=&lt;span class=&quot;code-keyword&quot;&gt;generic&lt;/span&gt; -O2 -pipe -fstack-protector-strong -D_FORTIFY_SOURCE=2 -fPIC -Isrc -I/usr/include/python3.6m -c src/ext/module.cpp -o build/temp.linux-x86_64-3.6/src/ext/module.o
cc1plus: warning: command line option &#8216;-Wstrict-prototypes&#8217; is valid &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; C/ObjC but not &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; C++
src/ext/module.cpp:21:19: fatal error: types.h: No such file or directory
 #include &lt;span class=&quot;code-quote&quot;&gt;&quot;types.h&quot;&lt;/span&gt;
                   ^
compilation terminated.

********************************************************************************
An error occurred &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; trying to compile with the C extension enabled
Attempting to build without the extension now
********************************************************************************
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;


&lt;p&gt;What I see is that it only includes directory `src` but the header file is located under `src/ext`.&lt;/p&gt;</comment>
                            <comment id="15822948" author="jfarrell" created="Sat, 14 Jan 2017 20:53:38 +0000"  >&lt;p&gt;Uploaded a new package which has the headers in it. It is a zip instead of a tar.gz due to the awful behavior of pypi not allowing multiple uploads of the same named packages &lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Submitting dist/thrift-0.10.0.tar.gz to https:&lt;span class=&quot;code-comment&quot;&gt;//pypi.python.org/pypi
&lt;/span&gt;Upload failed (400): This filename has previously been used, you should use a different version.
error: Upload failed (400): This filename has previously been used, you should use a different version.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="15822950" author="jsirois" created="Sat, 14 Jan 2017 21:01:20 +0000"  >&lt;p&gt;This really is the behavior you want - mutable artifacts cause no end of debugging grief. It&apos;s really a good prompt to release 0.10.1 - difficulty or ease of this aside. Having one good and 1 bad version of the same artifact seems like it&apos;s also asking for debugging trouble and confusion for users.&lt;/p&gt;</comment>
                            <comment id="15823166" author="cjmay" created="Sun, 15 Jan 2017 15:23:25 +0000"  >&lt;p&gt;The new zip distribution works for me.&lt;/p&gt;</comment>
                            <comment id="15895464" author="githubbot" created="Sat, 4 Mar 2017 02:54:35 +0000"  >&lt;p&gt;Github user jeking3 commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/1206&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/1206&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    If the build fails try using this technique to kick another if you think it was environmental:&lt;/p&gt;

&lt;p&gt;    git commit --amend&lt;br/&gt;
      don&apos;t change anything, just save.  This makes a new identical commit with a new hash.&lt;br/&gt;
    git push -u origin &amp;lt;branch name&amp;gt; --force&lt;br/&gt;
      overwrites the previous push and kicks another build&lt;/p&gt;

&lt;p&gt;    Thanks.&lt;/p&gt;</comment>
                            <comment id="15898401" author="jking3" created="Mon, 6 Mar 2017 23:45:55 +0000"  >&lt;p&gt;This build passed CI however I&apos;m not a python packaging SME.  Could someone tell me if the pull request resolves the issue and should be merged?&lt;/p&gt;</comment>
                            <comment id="15901840" author="cjmay" created="Wed, 8 Mar 2017 19:31:28 +0000"  >&lt;p&gt;Dunno if I consider myself a SME but I believe the build works.  I am attaching a bash script that fails before the patch and works after it, demonstrating the patch&apos;s resolution of the packaging issue.  It would be fantastic if this could be added as an integration test (in a greatly cleaned-up form), but I haven&apos;t looked at the Python test framework in a while so I&apos;m not sure what the best way is to do that.&lt;/p&gt;</comment>
                            <comment id="15901843" author="cjmay" created="Wed, 8 Mar 2017 19:32:37 +0000"  >&lt;p&gt;Test of accelerated protocol packaging issue.  When run from the top of the thrift repository, this script fails before the patch is applied and succeeds after the patch is applied.&lt;/p&gt;</comment>
                            <comment id="15904925" author="jking3" created="Fri, 10 Mar 2017 11:22:23 +0000"  >&lt;p&gt;Thanks, I am going to commit this.&lt;/p&gt;</comment>
                            <comment id="15904932" author="githubbot" created="Fri, 10 Mar 2017 11:25:42 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/1206&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/1206&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12856858" name="test-thrift.bash" size="904" author="cjmay" created="Wed, 8 Mar 2017 19:32:37 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 36 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i38o0f:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>