<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 08:22:34 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[THRIFT-3545] Container type literals do not compile</title>
                <link>https://issues.apache.org/jira/browse/THRIFT-3545</link>
                <project id="12310800" key="THRIFT">Thrift</project>
                    <description>&lt;p&gt;Default values and constants of container type (array, dictionary, and set) do not compile. Semicolons are missing, and sets are missing an opening square bracket.&lt;/p&gt;

&lt;p&gt;I will provide a patch/pull request for this issue.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12929677">THRIFT-3545</key>
            <summary>Container type literals do not compile</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="christorogers">Christopher Rogers</assignee>
                                    <reporter username="christorogers">Christopher Rogers</reporter>
                        <labels>
                    </labels>
                <created>Wed, 13 Jan 2016 03:43:36 +0000</created>
                <updated>Sat, 20 Feb 2021 15:27:12 +0000</updated>
                            <resolved>Fri, 18 Mar 2016 17:54:25 +0000</resolved>
                                                    <fixVersion>0.10.0</fixVersion>
                                    <component>Cocoa - Compiler</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="15095557" author="githubbot" created="Wed, 13 Jan 2016 03:53:42 +0000"  >&lt;p&gt;GitHub user ChristopherRogers opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/790&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/790&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-3545&quot; title=&quot;Container type literals do not compile&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-3545&quot;&gt;&lt;del&gt;THRIFT-3545&lt;/del&gt;&lt;/a&gt; Cocoa: Container type literals do not compile&lt;/p&gt;



&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/ChristopherRogers/thrift&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/ChristopherRogers/thrift&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-3545&quot; title=&quot;Container type literals do not compile&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-3545&quot;&gt;&lt;del&gt;THRIFT-3545&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/790.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/790.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #790&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 1600191b1847ed06e77ab7ca501ce3747ae66212&lt;br/&gt;
Author: Christopher Rogers &amp;lt;christopher.rogers@linecorp.com&amp;gt;&lt;br/&gt;
Date:   2016-01-13T03:52:41Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-3545&quot; title=&quot;Container type literals do not compile&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-3545&quot;&gt;&lt;del&gt;THRIFT-3545&lt;/del&gt;&lt;/a&gt; Cocoa: Container type literals do not compile&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15098572" author="jensg" created="Thu, 14 Jan 2016 18:24:44 +0000"  >&lt;p&gt;Committed.&lt;/p&gt;</comment>
                            <comment id="15098573" author="githubbot" created="Thu, 14 Jan 2016 18:24:46 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/790&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/790&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15103799" author="githubbot" created="Sun, 17 Jan 2016 17:32:55 +0000"  >&lt;p&gt;Github user kdubb commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/790#issuecomment-172355763&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/790#issuecomment-172355763&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Have these changes been tested with nested containers?  I don&apos;t think they will work.&lt;/p&gt;

&lt;p&gt;    My apologies for being late to the party.  I am only scanning my thrift email intermittently lately.&lt;/p&gt;</comment>
                            <comment id="15103806" author="githubbot" created="Sun, 17 Jan 2016 17:41:24 +0000"  >&lt;p&gt;Github user kdubb commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/790#issuecomment-172357126&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/790#issuecomment-172357126&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @ChristopherRogers Can you provide an example of what does not compile for you?&lt;/p&gt;
</comment>
                            <comment id="15103849" author="githubbot" created="Sun, 17 Jan 2016 18:30:31 +0000"  >&lt;p&gt;Github user kdubb commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/790#issuecomment-172362021&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/790#issuecomment-172362021&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    These do work with nested types so my hunch was wrong on that but with the current code (including your PR) it now has awkward extra semi-colons; so my munch was somewhat correct that they appear unnecessary&lt;/p&gt;

&lt;p&gt;    The NSSet missing a single brace was correct. I don&apos;t know why you switched it to the longer syntax when you could have just added a brace.&lt;/p&gt;

&lt;p&gt;    It seems to me the issue was only to do with set literals and could have been solved with a single character change (adding a brace). Is there some other place I am missing where semi-colons are not added? If so I cannot seem to find it. &lt;/p&gt;

&lt;p&gt;    Currently as generated...&lt;br/&gt;
    ```objc&lt;br/&gt;
      NSDictionary&amp;lt;NSString *, NSString *&amp;gt; * tmp0 = @&lt;/p&gt;
{@&quot;new&quot;: @&quot;world&quot;}
&lt;p&gt;;&lt;br/&gt;
      MapConst = @&lt;/p&gt;
{@&quot;hello&quot;: tmp0}
&lt;p&gt;;&lt;br/&gt;
    ;&lt;/p&gt;

&lt;p&gt;      NSSet&amp;lt;NSString *&amp;gt; * tmp1 = [&lt;span class=&quot;error&quot;&gt;&amp;#91;NSSet alloc&amp;#93;&lt;/span&gt; initWithArray:@&lt;span class=&quot;error&quot;&gt;&amp;#91;@&amp;quot;hello&amp;quot;&amp;#93;&lt;/span&gt;];&lt;br/&gt;
      SetConst = [&lt;span class=&quot;error&quot;&gt;&amp;#91;NSSet alloc&amp;#93;&lt;/span&gt; initWithArray:@&lt;span class=&quot;error&quot;&gt;&amp;#91;tmp1&amp;#93;&lt;/span&gt;];&lt;br/&gt;
    ;&lt;/p&gt;

&lt;p&gt;      NSArray&amp;lt;NSString *&amp;gt; * tmp2 = @&lt;span class=&quot;error&quot;&gt;&amp;#91;@&amp;quot;hello&amp;quot;&amp;#93;&lt;/span&gt;;&lt;br/&gt;
      ArrayConst = @&lt;span class=&quot;error&quot;&gt;&amp;#91;tmp2&amp;#93;&lt;/span&gt;;&lt;br/&gt;
    ;&lt;br/&gt;
    ```&lt;/p&gt;</comment>
                            <comment id="15103863" author="githubbot" created="Sun, 17 Jan 2016 18:57:54 +0000"  >&lt;p&gt;Github user kdubb commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/790#issuecomment-172365685&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/790#issuecomment-172365685&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @ChristopherRogers Please check #797 and see if it produces working code for you as well.&lt;/p&gt;</comment>
                            <comment id="15105465" author="githubbot" created="Mon, 18 Jan 2016 16:05:15 +0000"  >&lt;p&gt;Github user ChristopherRogers commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/790#issuecomment-172571012&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/790#issuecomment-172571012&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Ah, my apologies for the extra semicolons. It was missing semicolons in the default init methods where a collection type had a default value.&lt;/p&gt;

&lt;p&gt;    I believe this semicolon problem is due to discrepancies in how the caller of this method assumes code will be generated--with semicolons and line breaks or not. I think if the call sites were to be cleaned up the ugliness would go away. I believe I checked them but I might&apos;ve overlooked them. I&apos;ll give it another look again later too.&lt;/p&gt;

&lt;p&gt;    The NSSet change should&apos;ve been in another PR, I admit, but it was for performance reasons (since one of Thrift&apos;s main goals is performance). I believe that optimized ARC code cannot cancel out the autorelease that setWithArray makes because Foundation isn&apos;t using ARC itself (I think, but it&apos;s worth testing.) Even if it could I think it&apos;s still faster to not have to have it back out of autoreleasing. I considered changing it to the initWithObjects variant but it seemed a little too drastic and needs performance testing. &lt;/p&gt;</comment>
                            <comment id="15105476" author="githubbot" created="Mon, 18 Jan 2016 16:18:20 +0000"  >&lt;p&gt;Github user ChristopherRogers commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/790#issuecomment-172575020&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/790#issuecomment-172575020&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Also, I just remembered from an old version of Xcode that even the @[]/@{} syntax used autorelease (probably to easily codegen in both ARC and MRC) but that might&apos;ve changed since then, and I might&apos;ve been looking at a non-optimized build.&lt;/p&gt;</comment>
                            <comment id="15105788" author="githubbot" created="Mon, 18 Jan 2016 20:32:13 +0000"  >&lt;p&gt;Github user kdubb commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/790#issuecomment-172646482&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/790#issuecomment-172646482&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    I am fairly sure that #797 fixes the line breaks and semi-colons in the proper way. So, just check it with your code to make sure.&lt;/p&gt;

&lt;p&gt;    As far as performance of ARC I will just say that you attempt to be micro optimizing code that is about to, or just has, sent data over a network connection. Any thought to the nanosecond of time ARC &lt;b&gt;may&lt;/b&gt; (and most likely doesn&apos;t) add is not something we should be concerned about. Finally, this code initializes static constants so discussing performance at all is unnecessary. &lt;/p&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12931798">THRIFT-3559</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 44 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2r7tj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>