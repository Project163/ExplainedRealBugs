<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 08:13:15 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[THRIFT-2194] Node: Not actually prepending residual data in TFramedTransport.receiver</title>
                <link>https://issues.apache.org/jira/browse/THRIFT-2194</link>
                <project id="12310800" key="THRIFT">Thrift</project>
                    <description>&lt;p&gt;I am seeing an issue where we are creating a Buffer of larger than 1GB so v8 crashes with a fatal exception:&lt;br/&gt;
FATAL ERROR: v8::Object::SetIndexedPropertiesToExternalArrayData() length exceeds max acceptable value.&lt;/p&gt;

&lt;p&gt;I believe this is due to the fact that we don&apos;t actually copy the residual data into the data buffer before reading it, so when we go to create the new frame buffer, we are using the result of binary.readI32(data, 0). Because the residual data isn&apos;t there, we create an overly large int and cause the crash.&lt;/p&gt;

&lt;p&gt;I&apos;m seeing this bug in node-thrift 0.9.0, but the bug seems like it would still exist in the latest version. I&apos;m also using node 0.6.17.&lt;/p&gt;

&lt;p&gt;This looks like it could be related to &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-1754&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/THRIFT-1754&lt;/a&gt;, but I haven&apos;t looked into that too much.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12669347">THRIFT-2194</key>
            <summary>Node: Not actually prepending residual data in TFramedTransport.receiver</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="jirwin">Justin Gallardo</reporter>
                        <labels>
                    </labels>
                <created>Wed, 18 Sep 2013 22:18:17 +0000</created>
                <updated>Fri, 27 Jun 2014 21:00:08 +0000</updated>
                            <resolved>Fri, 13 Dec 2013 23:41:44 +0000</resolved>
                                    <version>0.9</version>
                                    <fixVersion>0.9.2</fixVersion>
                                    <component>Node.js - Library</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="13771315" author="jirwin" created="Wed, 18 Sep 2013 22:20:59 +0000"  >&lt;p&gt;The actual output when I see this error occur:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Expecting &amp;gt; 4 bytes, found only 3
FATAL ERROR: v8::Object::SetIndexedPropertiesToExternalArrayData() length exceeds max acceptable value
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13848053" author="jirwin" created="Fri, 13 Dec 2013 23:25:33 +0000"  >&lt;p&gt;I&apos;ve been running this fix in production for a few months now, and I haven&apos;t seen this crasher again. It also seemed to fix a couple of the other random thrift crashers I was experiencing.&lt;/p&gt;</comment>
                            <comment id="13848067" author="jensg" created="Fri, 13 Dec 2013 23:41:44 +0000"  >&lt;p&gt;+1 and committed. &lt;br/&gt;
Thanks Justin!&lt;/p&gt;</comment>
                            <comment id="13848171" author="hudson" created="Sat, 14 Dec 2013 02:42:51 +0000"  >&lt;p&gt;SUCCESS: Integrated in Thrift #952 (See &lt;a href=&quot;https://builds.apache.org/job/Thrift/952/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Thrift/952/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-2194&quot; title=&quot;Node: Not actually prepending residual data in TFramedTransport.receiver&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-2194&quot;&gt;&lt;del&gt;THRIFT-2194&lt;/del&gt;&lt;/a&gt; Node: Not actually prepending residual data in TFramedTransport.receiver (jensg: rev 2c4f306b0a93454b7e18aa425e4e8f7f4f9ef4f5)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;lib/nodejs/lib/thrift/transport.js&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14046394" author="wadey" created="Fri, 27 Jun 2014 21:00:08 +0000"  >&lt;p&gt;This fix was accidentally reverted by &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-2205&quot; title=&quot;Node.js Test Server to support test.js JavaScript Browser test and sundry fixes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-2205&quot;&gt;&lt;del&gt;THRIFT-2205&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;I have restored it and fixed a few more issues in this patch: &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-2591&quot; title=&quot;TFramedTransport does not handle payloads split across packets correctly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-2591&quot;&gt;&lt;del&gt;THRIFT-2591&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12603925" name="THRIFT-2194.patch" size="452" author="jirwin" created="Wed, 18 Sep 2013 22:19:02 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>349279</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 21 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310041" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Patch Info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10042"><![CDATA[Patch Available]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1o84v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>349577</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>