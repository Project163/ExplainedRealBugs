<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 08:05:41 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[THRIFT-1707] [ruby] Adjust server_spec.rb for RSpec 2.11.x and Ruby 1.9.3</title>
                <link>https://issues.apache.org/jira/browse/THRIFT-1707</link>
                <project id="12310800" key="THRIFT">Thrift</project>
                    <description>&lt;p&gt;The message expectations in RSpec 2.11.x don&apos;t seem to work consistently on Ruby 1.9.x when Threads are used. This is causing a problem in a few tests in server_spec.rb.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12609943">THRIFT-1707</key>
            <summary>[ruby] Adjust server_spec.rb for RSpec 2.11.x and Ruby 1.9.3</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="nbeyer">Nathan Beyer</assignee>
                                    <reporter username="nbeyer_cerner">Nathan Beyer</reporter>
                        <labels>
                    </labels>
                <created>Tue, 2 Oct 2012 17:35:19 +0000</created>
                <updated>Tue, 23 Dec 2014 20:15:17 +0000</updated>
                            <resolved>Sat, 6 Oct 2012 00:27:36 +0000</resolved>
                                                    <fixVersion>0.9</fixVersion>
                                    <component>Ruby - Library</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="13467907" author="nbeyer_cerner" created="Tue, 2 Oct 2012 17:58:52 +0000"  >&lt;p&gt;&lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12547410/12547410_THRIFT-1707-rewrite-server-spec.patch&quot; title=&quot;THRIFT-1707-rewrite-server-spec.patch attached to THRIFT-1707&quot;&gt;THRIFT-1707-rewrite-server-spec.patch&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;Refactor ThreadPoolServer specs to allow message expectations to work across Threads on Ruby 1.9.3. Some additionally refactoring to use the latest RSpec conventions and a bit more tweaking.&lt;/p&gt;</comment>
                            <comment id="13468255" author="jfarrell" created="Wed, 3 Oct 2012 01:52:26 +0000"  >&lt;p&gt;Patch causes tests to fail for ruby 1.8.7&lt;/p&gt;

&lt;p&gt;Finished in 3.01 seconds&lt;br/&gt;
355 examples, 2 failures, 1 pending&lt;/p&gt;

&lt;p&gt;Failed examples:&lt;/p&gt;

&lt;p&gt;rspec ./spec/server_spec.rb:102 # Server Thrift::ThreadPoolServer should serve inside a thread&lt;br/&gt;
rspec ./spec/server_spec.rb:110 # Server Thrift::ThreadPoolServer should avoid running the server twice when retrying rescuable_serve&lt;/p&gt;</comment>
                            <comment id="13468348" author="nbeyer_cerner" created="Wed, 3 Oct 2012 05:08:18 +0000"  >&lt;p&gt;Can you give me more details on the environment you tested on? OS and full Ruby version, please.&lt;/p&gt;

&lt;p&gt;I tested this on OS X 10.8 with Ruby 1.9.3-p194 and 1.8.7-p370 as built with RVM and the tests passed fine. Note: I had to remove the CFLAGS setting in extconf.rb as that fails native compilation on Ruby 1.9.3.&lt;/p&gt;</comment>
                            <comment id="13470573" author="nbeyer_cerner" created="Fri, 5 Oct 2012 19:12:44 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jfarrell&quot; class=&quot;user-hover&quot; rel=&quot;jfarrell&quot;&gt;jfarrell&lt;/a&gt; I&apos;ve tried this patch on Ruby 1.8.7-p370 (via RVM) and Ruby 1.9.3-p194 (via RVM) on OS X Mountain Lion and it works fine. I&apos;ve also tried this patch on Ruby 1.8.7-p370 (via RVM) and Ruby 1.9.3-p194 (via RVM) on Ubuntu 12.04.1 and it works fine as well.&lt;/p&gt;

&lt;p&gt;What did you use to get the failure mentioned above?&lt;/p&gt;</comment>
                            <comment id="13470812" author="jfarrell" created="Sat, 6 Oct 2012 00:27:36 +0000"  >&lt;p&gt;Was testing on OS X Snow Leopard with default ruby version ruby 1.8.7 (2010-01-10 patchlevel 249) &lt;span class=&quot;error&quot;&gt;&amp;#91;universal-darwin11.0&amp;#93;&lt;/span&gt;. &lt;/p&gt;

&lt;p&gt;Full error was:&lt;br/&gt;
 1) Server Thrift::ThreadPoolServer should serve inside a thread&lt;br/&gt;
     Failure/Error: Unable to find matching line from backtrace&lt;br/&gt;
     NameError:&lt;br/&gt;
       undefined method `__rspec_original_dup&apos; for class `Thrift::ThreadPoolServer&apos;&lt;/p&gt;

&lt;p&gt;I traced it back to rspec 2.11.0 issue &lt;a href=&quot;https://github.com/rspec/rspec-mocks/issues/168&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/rspec/rspec-mocks/issues/168&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Converting to &apos;rspec&apos;, &apos;~&amp;gt; 2.10.0&apos; fixes this and then your patch runs perfectly. Committed with gemspec change back to rspec 2.10.0&lt;/p&gt;</comment>
                            <comment id="13470829" author="nbeyer" created="Sat, 6 Oct 2012 00:54:43 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jfarrell&quot; class=&quot;user-hover&quot; rel=&quot;jfarrell&quot;&gt;jfarrell&lt;/a&gt; In looking at this issue &lt;a href=&quot;https://github.com/rspec/rspec-mocks/issues/168&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/rspec/rspec-mocks/issues/168&lt;/a&gt;, I suspect it worked fine for me because my Gemfile.lock has an updated version of rspec-mock that&apos;s fixed (2.11.1+). Can you look at your Gemfile.lock to see what version it&apos;s at? If it&apos;s old. Can you try running &apos;bundle update&apos; to re-resolve the dependencies and get the latest rspec-mock and try this again?&lt;/p&gt;</comment>
                            <comment id="13470869" author="hudson" created="Sat, 6 Oct 2012 02:20:53 +0000"  >&lt;p&gt;Integrated in Thrift #548 (See &lt;a href=&quot;https://builds.apache.org/job/Thrift/548/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Thrift/548/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-1707&quot; title=&quot;[ruby] Adjust server_spec.rb for RSpec 2.11.x and Ruby 1.9.3&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-1707&quot;&gt;&lt;del&gt;THRIFT-1707&lt;/del&gt;&lt;/a&gt;: Adjust server_spec.rb for RSpec 2.11.x and Ruby 1.9.3&lt;br/&gt;
Client: rb&lt;br/&gt;
Patch: Nathan Beyer&lt;/p&gt;

&lt;p&gt;The message expectations in RSpec 2.11.x don&apos;t seem to work consistently on Ruby 1.9.x when Threads are used. This is causing a problem in a few tests in server_spec.rb. (Revision 1394868)&lt;/p&gt;

&lt;p&gt;     Result = ABORTED&lt;br/&gt;
jfarrell : &lt;a href=&quot;http://svn.apache.org/viewvc/?view=rev&amp;amp;rev=1394868&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc/?view=rev&amp;amp;rev=1394868&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/thrift/trunk/lib/rb/spec/server_spec.rb&lt;/li&gt;
	&lt;li&gt;/thrift/trunk/lib/rb/thrift.gemspec&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10020">
                    <name>Cloners</name>
                                                                <inwardlinks description="is cloned by">
                                        <issuelink>
            <issuekey id="12763542">THRIFT-2913</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12547410" name="THRIFT-1707-rewrite-server-spec.patch" size="3614" author="nbeyer_cerner" created="Tue, 2 Oct 2012 17:58:52 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>244066</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 7 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310041" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Patch Info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10042"><![CDATA[Patch Available]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i05glb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>29785</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>