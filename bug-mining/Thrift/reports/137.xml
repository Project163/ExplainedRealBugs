<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 07:55:15 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[THRIFT-356] Python tests fail</title>
                <link>https://issues.apache.org/jira/browse/THRIFT-356</link>
                <project id="12310800" key="THRIFT">Thrift</project>
                    <description>&lt;p&gt;The python tests are failing on trunk. Test output attached.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12416150">THRIFT-356</key>
            <summary>Python tests fail</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dreiss">David Reiss</assignee>
                                    <reporter username="kclark">Kevin Clark</reporter>
                        <labels>
                    </labels>
                <created>Wed, 4 Mar 2009 21:07:33 +0000</created>
                <updated>Tue, 1 Nov 2011 02:52:00 +0000</updated>
                            <resolved>Tue, 7 Apr 2009 20:51:44 +0000</resolved>
                                                    <fixVersion>0.1</fixVersion>
                                    <component>Python - Library</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="12678941" author="esteve" created="Wed, 4 Mar 2009 21:44:53 +0000"  >&lt;p&gt;I think this is due to the last change in &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-242&quot; title=&quot;Python struct constructors are clunky and error-prone&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-242&quot;&gt;&lt;del&gt;THRIFT-242&lt;/del&gt;&lt;/a&gt; to render_constant_value. I&apos;ll try to submit a patch tomorrow.&lt;/p&gt;</comment>
                            <comment id="12678961" author="esteve" created="Wed, 4 Mar 2009 22:24:28 +0000"  >&lt;p&gt;It looks like I was wrong, the problem is due to something else. I&apos;ll have a deeper look tomorrow.&lt;/p&gt;</comment>
                            <comment id="12679146" author="shigin" created="Thu, 5 Mar 2009 10:39:28 +0000"  >&lt;p&gt;It&apos;s &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-162&quot; title=&quot;Thrift structures are unhashable, preventing them from being used as set elements&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-162&quot;&gt;&lt;del&gt;THRIFT-162&lt;/del&gt;&lt;/a&gt; problem. I don&apos;t know how to fix it.&lt;/p&gt;</comment>
                            <comment id="12679273" author="esteve" created="Thu, 5 Mar 2009 18:07:53 +0000"  >&lt;p&gt;Not only that, but these will fail as well (DebugProtoTest.thrift):&lt;/p&gt;

&lt;p&gt;  // collections as keys&lt;br/&gt;
  44: map&amp;lt;list&amp;lt;byte&amp;gt;, byte&amp;gt;       list_byte_map = &lt;/p&gt;
{[1, 2, 3] : 1, [0, 1] : 2, [] : 0}
&lt;p&gt;;&lt;br/&gt;
  45: map&amp;lt;set&amp;lt;byte&amp;gt;, byte&amp;gt;        set_byte_map = &lt;/p&gt;
{[1, 2, 3] : 1, [0, 1] : 2, [] : 0}
&lt;p&gt;;&lt;br/&gt;
  46: map&amp;lt;map&amp;lt;byte,byte&amp;gt;, byte&amp;gt;   map_byte_map = {{1 : 1} : 1, &lt;/p&gt;
{2 : 2}
&lt;p&gt; : 2, {} : 0};&lt;/p&gt;

&lt;p&gt;the first error (Empty) is because Thrift defines _&lt;em&gt;eq&lt;/em&gt;_ and _&lt;em&gt;neq&lt;/em&gt;&lt;em&gt;, but not __hash&lt;/em&gt;_ (because Thrift structures are mutable). I don&apos;t know how to fix it and the other tests without making Empty immutable and introducing tuples and a special immutable dict type.&lt;/p&gt;

&lt;p&gt;The problem is that I only got immutability working on new-style classes (&lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-162&quot; title=&quot;Thrift structures are unhashable, preventing them from being used as set elements&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-162&quot;&gt;&lt;del&gt;THRIFT-162&lt;/del&gt;&lt;/a&gt;). I&apos;d argue for defaulting to new style classes and making old style ones optional, since we&apos;re already missing a lot of features because of that. I remember we discussed about new-style vs old-style classes in the past:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://mail-archives.apache.org/mod_mbox/incubator-thrift-dev/200810.mbox/%3C200810181852.55216.esteve@sindominio.net%3E&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://mail-archives.apache.org/mod_mbox/incubator-thrift-dev/200810.mbox/%3C200810181852.55216.esteve@sindominio.net%3E&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I still think new-style classes + slots make a lot of sense and their performance can only get better through time (see 2.5 vs 2.6).&lt;/p&gt;</comment>
                            <comment id="12688525" author="kclark" created="Tue, 24 Mar 2009 01:39:44 +0000"  >&lt;p&gt;This really &lt;b&gt;needs&lt;/b&gt; to be fixed before 0.1&lt;/p&gt;</comment>
                            <comment id="12688648" author="esteve" created="Tue, 24 Mar 2009 11:35:23 +0000"  >&lt;p&gt;Sorry for the slow response. I agree that it must be fixed before 0.1, but it involves some changes in other parts of the Python generator that may break compatibility. The only way to actually fix those errors  is to implement hashable/immutable types (&lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-162&quot; title=&quot;Thrift structures are unhashable, preventing them from being used as set elements&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-162&quot;&gt;&lt;del&gt;THRIFT-162&lt;/del&gt;&lt;/a&gt;), but I haven&apos;t found a way to implement them in old-style classes. That&apos;s why I argued to remove old-style classes entirely and support new-style ones only.&lt;/p&gt;</comment>
                            <comment id="12694742" author="bryanduxbury" created="Wed, 1 Apr 2009 21:06:11 +0000"  >&lt;p&gt;What are we going to do with this issue? It seems to be one of the few remaining blockers.&lt;/p&gt;</comment>
                            <comment id="12694777" author="dreiss" created="Wed, 1 Apr 2009 21:56:01 +0000"  >&lt;p&gt;We have a fix for &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-162&quot; title=&quot;Thrift structures are unhashable, preventing them from being used as set elements&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-162&quot;&gt;&lt;del&gt;THRIFT-162&lt;/del&gt;&lt;/a&gt;.  I was just hoping for it to get a little more review.&lt;/p&gt;</comment>
                            <comment id="12694792" author="esteve" created="Wed, 1 Apr 2009 22:22:49 +0000"  >&lt;p&gt;But &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-162&quot; title=&quot;Thrift structures are unhashable, preventing them from being used as set elements&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-162&quot;&gt;&lt;del&gt;THRIFT-162&lt;/del&gt;&lt;/a&gt; depends on &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-301&quot; title=&quot;Add a create() class method for factory-like instantiation&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-301&quot;&gt;&lt;del&gt;THRIFT-301&lt;/del&gt;&lt;/a&gt;, or did you manage to get it working without adding a factory method?&lt;/p&gt;</comment>
                            <comment id="12694798" author="dreiss" created="Wed, 1 Apr 2009 22:28:45 +0000"  >&lt;p&gt;Well, all that is needed for the tests to pass is for constants to work, not reading.&lt;/p&gt;</comment>
                            <comment id="12695627" author="dreiss" created="Fri, 3 Apr 2009 22:40:52 +0000"  >&lt;p&gt;This short-term fix (which only depends on the fix for &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-427&quot; title=&quot;print_const_value is broken in the compiler for Java&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-427&quot;&gt;&lt;del&gt;THRIFT-427&lt;/del&gt;&lt;/a&gt; to avoid breaking the Java tests) allows us to get &quot;make check&quot; working again without making any permanent decisions on &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-162&quot; title=&quot;Thrift structures are unhashable, preventing them from being used as set elements&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-162&quot;&gt;&lt;del&gt;THRIFT-162&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="12696591" author="kclark" created="Tue, 7 Apr 2009 16:12:16 +0000"  >&lt;p&gt;@David: Would it be reasonable to apply and resolve this for the release, and push 162 to 0.2? My main goal was to get make check working again, so I can run tests when I&apos;m testing patches.&lt;/p&gt;</comment>
                            <comment id="12696723" author="dreiss" created="Tue, 7 Apr 2009 20:18:59 +0000"  >&lt;p&gt;IMO, yes.  I&apos;d like Bryan to sign off on this and 427 if possible.&lt;/p&gt;</comment>
                            <comment id="12696737" author="bryanduxbury" created="Tue, 7 Apr 2009 20:44:10 +0000"  >&lt;p&gt;I am way +1 on the change to the CompactProtoTestStruct constant. &lt;/p&gt;</comment>
                            <comment id="12696757" author="esteve" created="Tue, 7 Apr 2009 21:07:17 +0000"  >&lt;p&gt;I&apos;m sorry for being so quiet these days. I agree with Kevin to push 162 to 0.2, adding support for immutable types is a nice feature, but I don&apos;t think we can ship Thrift 0.1 without reviewing it appropriately (sorry again, I&apos;ll try to review it ASAP).&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12422020">THRIFT-427</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12404606" name="ASF.LICENSE.NOT.GRANTED--0002-THRIFT-356.-Improve-CompactProtocolTestStruct.patch" size="9757" author="dreiss" created="Fri, 3 Apr 2009 22:38:51 +0000"/>
                            <attachment id="12401463" name="py_test_failure.txt" size="25232" author="kclark" created="Wed, 4 Mar 2009 21:07:50 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>186566</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            16 years, 34 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i16blz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>245013</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>