<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 08:01:15 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[THRIFT-1328] TBaseHelper.toString(...) appends ByteBuffer data outside of valid buffer range</title>
                <link>https://issues.apache.org/jira/browse/THRIFT-1328</link>
                <project id="12310800" key="THRIFT">Thrift</project>
                    <description>&lt;p&gt;I have a Thrift struct T which declares a binary field f3 after two other fields f1 and f2. After successful deserialization of a T instance, f3 references a ByteBuffer which wraps the raw byte[] containing all T instance data and has position and limit set to scope reads to valid f3 bytes. This is great because it means less copying of raw byte[] data.&lt;/p&gt;

&lt;p&gt;However, TBaseHelper.toString(ByteBuffer bb, StringBuilder sb) uses Buffer.array() and Buffer.arrayOffset() to read f3 data, causing it to append bytes to sb which lie outside f3&apos;s valid range in the backing byte[].&lt;/p&gt;

&lt;p&gt;It seems like this logic is also present in latest version of TBaseHelper: &lt;a href=&quot;http://svn.apache.org/viewvc/thrift/trunk/lib/java/src/org/apache/thrift/TBaseHelper.java?revision=1038833&amp;amp;view=markup#l223&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc/thrift/trunk/lib/java/src/org/apache/thrift/TBaseHelper.java?revision=1038833&amp;amp;view=markup#l223&lt;/a&gt;&lt;/p&gt;</description>
                <environment>&lt;p&gt;Java 1.6, Mac OSX 10.6.8 64-bit&lt;/p&gt;</environment>
        <key id="12521516">THRIFT-1328</key>
            <summary>TBaseHelper.toString(...) appends ByteBuffer data outside of valid buffer range</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="hazen">Andy Schlaikjer</assignee>
                                    <reporter username="hazen">Andy Schlaikjer</reporter>
                        <labels>
                    </labels>
                <created>Wed, 7 Sep 2011 00:46:14 +0000</created>
                <updated>Wed, 7 Sep 2011 18:48:41 +0000</updated>
                            <resolved>Wed, 7 Sep 2011 18:13:45 +0000</resolved>
                                    <version>0.5</version>
                                    <fixVersion>0.8</fixVersion>
                                    <component>Java - Library</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="13099143" author="bryanduxbury" created="Wed, 7 Sep 2011 17:49:03 +0000"  >&lt;p&gt;Good catch, Andy. However, your fix has a hole in it. If the ByteBuffer has a nonzero arrayOffset (as it would after, say, a slice() call), then you&apos;ll be reading from before the beginning of the buffer. All we need to do is offset all the indices by arrayOffset() and we should be fine. Do you want to take a crack at another version?&lt;/p&gt;</comment>
                            <comment id="13099158" author="hazen" created="Wed, 7 Sep 2011 18:05:52 +0000"  >&lt;p&gt;Bryan, please see second attached patch for proper arrayOffset handling. Thanks for your correction!&lt;/p&gt;</comment>
                            <comment id="13099164" author="bryanduxbury" created="Wed, 7 Sep 2011 18:13:45 +0000"  >&lt;p&gt;Awesome, this is perfect. Thanks for the prompt revision (and for including unit tests)!&lt;/p&gt;</comment>
                            <comment id="13099197" author="hudson" created="Wed, 7 Sep 2011 18:48:41 +0000"  >&lt;p&gt;Integrated in Thrift #252 (See &lt;a href=&quot;https://builds.apache.org/job/Thrift/252/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Thrift/252/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-1328&quot; title=&quot;TBaseHelper.toString(...) appends ByteBuffer data outside of valid buffer range&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-1328&quot;&gt;&lt;del&gt;THRIFT-1328&lt;/del&gt;&lt;/a&gt;. java: TBaseHelper.toString(...) appends ByteBuffer data outside of valid buffer range&lt;/p&gt;

&lt;p&gt;This patch now correctly considers both arrayOffset and position when determining how to access the backing array of a buffer.&lt;/p&gt;

&lt;p&gt;Patch: Andy Schlaikjer&lt;/p&gt;

&lt;p&gt;bryanduxbury : &lt;a href=&quot;http://svn.apache.org/viewvc/?view=rev&amp;amp;rev=1166292&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc/?view=rev&amp;amp;rev=1166292&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/thrift/trunk/lib/java/src/org/apache/thrift/TBaseHelper.java&lt;/li&gt;
	&lt;li&gt;/thrift/trunk/lib/java/test/org/apache/thrift/TestTBaseHelper.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12493352" name="fix-bytebuffer-access-02.patch" size="2035" author="hazen" created="Wed, 7 Sep 2011 18:04:42 +0000"/>
                            <attachment id="12493281" name="fix-bytebuffer-access.patch" size="1794" author="hazen" created="Wed, 7 Sep 2011 06:20:27 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>44236</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 11 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310041" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Patch Info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10042"><![CDATA[Patch Available]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0846f:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>45276</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>