<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 07:56:21 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[THRIFT-378] Java servers do not turn internal errors into thrift exceptions</title>
                <link>https://issues.apache.org/jira/browse/THRIFT-378</link>
                <project id="12310800" key="THRIFT">Thrift</project>
                    <description>&lt;p&gt;Occasionally a service will produce a runtime exception because of a problem in the environment or simply a bug.&lt;/p&gt;

&lt;p&gt;By default this means clients will error out trying to read a response.  This is confusing because it is not obvious that the problem was with the server, let alone what the problem actually was.&lt;/p&gt;

&lt;p&gt;One workaround might be to add an InternalError exception and declare every method to throw that, but this would require wrapping each method implementation on the server with a try/catch/throw block, which is ugly and repetitive (especially if there are other try/catch blocks nested) &amp;#8211; exactly the sort of code that Thrift is good at automating away.&lt;/p&gt;

&lt;p&gt;I think the right fix would be for the server to catch runtime exceptions in the generated process methods and send back a TApplicationException.  This is what some other servers (e.g., Erlang) already do.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12417103">THRIFT-378</key>
            <summary>Java servers do not turn internal errors into thrift exceptions</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jbellis">Jonathan Ellis</assignee>
                                    <reporter username="jbellis">Jonathan Ellis</reporter>
                        <labels>
                    </labels>
                <created>Tue, 17 Mar 2009 22:34:38 +0000</created>
                <updated>Tue, 1 Nov 2011 02:54:07 +0000</updated>
                            <resolved>Wed, 17 Jun 2009 16:44:00 +0000</resolved>
                                                    <fixVersion>0.2</fixVersion>
                                    <component>Java - Compiler</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="12688483" author="bryanduxbury" created="Tue, 24 Mar 2009 00:06:30 +0000"  >&lt;p&gt;How about we make a new TUnexpectedException (TException subclass) that we can throw in these scenarios? &lt;/p&gt;</comment>
                            <comment id="12688802" author="jbellis" created="Tue, 24 Mar 2009 19:13:56 +0000"  >&lt;p&gt;I suppose that would work.&lt;/p&gt;

&lt;p&gt;What are the semantics of TApplicationException?  Why is that not appropriate?&lt;/p&gt;

&lt;p&gt;(Asking to understand, not to argue.)&lt;/p&gt;</comment>
                            <comment id="12688805" author="jbellis" created="Tue, 24 Mar 2009 19:15:42 +0000"  >&lt;p&gt;looking at TAE, it seems like&lt;/p&gt;

&lt;p&gt;  public static final int INTERNAL_ERROR=6;&lt;/p&gt;

&lt;p&gt;would fit right in.&lt;/p&gt;</comment>
                            <comment id="12688816" author="bryanduxbury" created="Tue, 24 Mar 2009 19:33:56 +0000"  >&lt;p&gt;I guess it&apos;s true that the hierarchy/purpose of our exceptions are a little muddy right now. Someone else opened an issue or at least wrote the list about the confusing state of exception classes across the different langauges; maybe we should actually take a look at that?&lt;/p&gt;</comment>
                            <comment id="12688836" author="jbellis" created="Tue, 24 Mar 2009 19:59:50 +0000"  >&lt;p&gt;I checked and could not find any such issue.  To my knowledge, the ASF lists are not easily searchable (one more thing that sucks about ASF).&lt;/p&gt;

&lt;p&gt;The more I think about this the more I think TApplicationException.INTERNAL_ERROR is the way to go.  The reason is, all client code already has this as a preamble:&lt;/p&gt;

&lt;p&gt;{{      &lt;br/&gt;
    if (msg.type == TMessageType.EXCEPTION) &lt;/p&gt;
{
        TApplicationException x = TApplicationException.read(iprot_);
        iprot_.readMessageEnd();
        throw x;
    }
&lt;p&gt;}}&lt;/p&gt;

&lt;p&gt;So it would fit in with the existing machinery to handle UNKNOWN_METHOD et al.&lt;/p&gt;</comment>
                            <comment id="12688837" author="jbellis" created="Tue, 24 Mar 2009 20:01:06 +0000"  >&lt;p&gt;trying again w/ the code fragment ...&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;      if (msg.type == TMessageType.EXCEPTION) &lt;/p&gt;
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {        TApplicationException x = TApplicationException.read(iprot_);        iprot_.readMessageEnd();        throw x;      }&lt;/span&gt; &lt;/div&gt;&lt;/blockquote&gt;</comment>
                            <comment id="12688838" author="jbellis" created="Tue, 24 Mar 2009 20:01:49 +0000"  >&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (msg.type == TMessageType.EXCEPTION) {
        TApplicationException x = TApplicationException.read(iprot_);
        iprot_.readMessageEnd();
        &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; x;
      }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="12688855" author="euphoria" created="Tue, 24 Mar 2009 20:38:01 +0000"  >&lt;p&gt;I think Bryan is probably talking about &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-237&quot; title=&quot;Update Exception class generation to TException decendent&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-237&quot;&gt;&lt;del&gt;THRIFT-237&lt;/del&gt;&lt;/a&gt; ?&lt;br/&gt;
Edit: oops.&lt;/p&gt;</comment>
                            <comment id="12701196" author="jbellis" created="Tue, 21 Apr 2009 16:40:07 +0000"  >&lt;p&gt;add TApplicationException.INTERNAL_ERROR.  return that when a service method throws an unexpected exception.&lt;/p&gt;

&lt;p&gt;IMO this is the right way to go because it is backwards compatible with old thrift clients as well as non-Java clients that do not know about INTERNAL_ERROR (because the client doesn&apos;t actually care about the enum value).  Tested with a Python client; worked fine.&lt;/p&gt;

&lt;p&gt;This is orthogonal to the issue of what the proper exception hierarchy should be (no new exception types are introduced).&lt;/p&gt;</comment>
                            <comment id="12702689" author="hudson" created="Sat, 25 Apr 2009 12:32:18 +0000"  >&lt;p&gt;Integrated in Cassandra #43 (See &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Cassandra/43/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Cassandra/43/&lt;/a&gt;)&lt;br/&gt;
    return empty lists instead of raising an error where applicable; otherwise, use&lt;br/&gt;
NotFoundError instead of CassandraException.  rely on  to report internal errors.&lt;br/&gt;
also, add field numbers to work around thrift bug generating python code.&lt;br/&gt;
patch by jbellis; reviewed by Jun Rao for #66&lt;/p&gt;</comment>
                            <comment id="12703379" author="jbellis" created="Mon, 27 Apr 2009 21:12:21 +0000"  >&lt;p&gt;v2 logs the exception to server log via log4j as well as sending it to the client&lt;/p&gt;</comment>
                            <comment id="12703642" author="hudson" created="Tue, 28 Apr 2009 13:47:04 +0000"  >&lt;p&gt;Integrated in Cassandra #51 (See &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Cassandra/51/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Cassandra/51/&lt;/a&gt;)&lt;br/&gt;
    upgrade to latest  patch&lt;/p&gt;</comment>
                            <comment id="12703711" author="bryanduxbury" created="Tue, 28 Apr 2009 16:40:14 +0000"  >&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;+  indent(f_service_) &amp;lt;&amp;lt; &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Logger LOGGER = Logger.getLogger(Processor.&lt;span class=&quot;code-keyword&quot;&gt;class.&lt;/span&gt;getName());&quot;&lt;/span&gt; &amp;lt;&amp;lt; endl;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Won&apos;t this always return &quot;org.apache.thrift.Processor&quot;? I think we&apos;d prefer to actually print the current Processor class.&lt;/p&gt;</comment>
                            <comment id="12703713" author="bryanduxbury" created="Tue, 28 Apr 2009 16:40:53 +0000"  >&lt;p&gt;Oops, misread. Please disregard last comment.&lt;/p&gt;</comment>
                            <comment id="12720751" author="bryanduxbury" created="Wed, 17 Jun 2009 16:44:00 +0000"  >&lt;p&gt;I just committed this. Thanks for contributing (and hounding me to commit)!&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                            <outwardlinks description="blocks">
                                        <issuelink>
            <issuekey id="12422387">CASSANDRA-66</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12406572" name="thrift-378-v2.patch" size="2836" author="jbellis" created="Mon, 27 Apr 2009 21:12:21 +0000"/>
                            <attachment id="12406041" name="thrift-378.patch" size="1989" author="jbellis" created="Tue, 21 Apr 2009 16:40:07 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>186584</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            16 years, 23 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i16a3b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>244767</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>