<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 08:21:17 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[THRIFT-3370] errno extern variable redefined. Not compiling for Android</title>
                <link>https://issues.apache.org/jira/browse/THRIFT-3370</link>
                <project id="12310800" key="THRIFT">Thrift</project>
                    <description>&lt;p&gt;It seems that the definition of errno we are using on the c_glib transport is not 100% correct. While it&apos;s ok for ISO C99 compilers it fails under Android. &lt;/p&gt;

&lt;p&gt;My opinion is that Android is behaving incorrectly here but I cannot be sure until I check with you. &lt;/p&gt;

&lt;p&gt;In the thrift_socket.c an thrift_server_socket.c implementations there&apos;s a errno variable declared.&lt;/p&gt;

&lt;p&gt;/* for errors coming from socket() and connect() */&lt;br/&gt;
extern int errno;&lt;/p&gt;

&lt;p&gt;This variable is redefined in the ndk of the in the file arch-arm/usr/include/errno.h &lt;br/&gt;
I don&apos;t know why. &lt;/p&gt;

&lt;p&gt;/* a macro expanding to the errno l-value */&lt;br/&gt;
#define  errno   (*__errno())&lt;/p&gt;

&lt;p&gt;So the compilation fails because redefined. &lt;/p&gt;

&lt;p&gt;Commenting out the extern definition on these files it compiles, it was tested and it works. But I don&apos;t know how this can work since the definition of errno on the files change from int to pointer. &lt;/p&gt;

&lt;p&gt;Can someone comment this please?&lt;/p&gt;




</description>
                <environment></environment>
        <key id="12903317">THRIFT-3370</key>
            <summary>errno extern variable redefined. Not compiling for Android</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="gad">Gonzalo Aguilar</assignee>
                                    <reporter username="gad">Gonzalo Aguilar</reporter>
                        <labels>
                            <label>build</label>
                            <label>c</label>
                            <label>easyfix</label>
                    </labels>
                <created>Thu, 8 Oct 2015 09:59:49 +0000</created>
                <updated>Mon, 7 Mar 2016 20:33:35 +0000</updated>
                            <resolved>Wed, 21 Oct 2015 14:45:18 +0000</resolved>
                                    <version>0.9.3</version>
                                    <fixVersion>0.10.0</fixVersion>
                                    <component>C glib - Library</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="14948622" author="dandl" created="Thu, 8 Oct 2015 13:06:07 +0000"  >&lt;p&gt;Looks like Thrift is in the wrong. The C standard says:&lt;/p&gt;

&lt;p&gt;&quot;If a macro definition is suppressed in order to access an actual object, or a program&lt;br/&gt;
defines an identifier with the name errno, the behavior is undefined.&quot;&lt;/p&gt;

&lt;p&gt;IOW a program should use errno.h and not define an identifier called errno itself.&lt;/p&gt;

&lt;p&gt;Fix is to delete the extern, add errno.h, then do what it takes to make stuff work again.&lt;/p&gt;</comment>
                            <comment id="14948896" author="gad" created="Thu, 8 Oct 2015 15:55:38 +0000"  >&lt;p&gt;Hi I have already fixed and tested on x86_64, i386 and android and it seems it&apos;s okay. I will submit a patch. &lt;/p&gt;

&lt;p&gt;Best regards,&lt;/p&gt;</comment>
                            <comment id="14949777" author="githubbot" created="Fri, 9 Oct 2015 02:16:37 +0000"  >&lt;p&gt;GitHub user gadLinux opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/638&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/638&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Fix problem on #&lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-3370&quot; title=&quot;errno extern variable redefined. Not compiling for Android&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-3370&quot;&gt;&lt;del&gt;THRIFT-3370&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    This comments out the line with the extern of errno so we can reenable if someone complains about it.&lt;br/&gt;
    Compiled against x86_64, i686 and arm android and it worked.&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/gadLinux/thrift&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/gadLinux/thrift&lt;/a&gt; thrift-3370&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/638.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/638.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #638&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit ea3eb6442923d28ee15767be4f827362e814e8ab&lt;br/&gt;
Author: Gonzalo Aguilar Delgado &amp;lt;gaguilar@level2crm.com&amp;gt;&lt;br/&gt;
Date:   2015-10-09T02:14:59Z&lt;/p&gt;

&lt;p&gt;    Fix problem on #&lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-3370&quot; title=&quot;errno extern variable redefined. Not compiling for Android&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-3370&quot;&gt;&lt;del&gt;THRIFT-3370&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="14958123" author="nsuke" created="Thu, 15 Oct 2015 01:15:15 +0000"  >&lt;p&gt;We can just remove those 2 lines IMO.&lt;br/&gt;
Given the discussion, I don&apos;t see any possibility where anyone needs to re-enable it in the future.&lt;/p&gt;

&lt;p&gt;&quot;man errno&quot; does provide an idea behind the extern declaration but strongly discourages it too.&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;It was common in traditional C to declare errno manually (i.e., extern int errno) instead of including &amp;lt;errno.h&amp;gt;.  &lt;b&gt;Do not do this&lt;/b&gt;.  It will not work with modern versions of the C library.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;If you&apos;re unsure about the type of errno, we can safely assume it&apos;s a plain int:&lt;br/&gt;
the defined expression is dereferencing an int pointer returned by __errno() function call.&lt;/p&gt;</comment>
                            <comment id="14967236" author="githubbot" created="Wed, 21 Oct 2015 14:42:18 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/638&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/638&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14967241" author="nsuke" created="Wed, 21 Oct 2015 14:43:47 +0000"  >&lt;p&gt;Committed with the above modification.&lt;br/&gt;
Thanks !&lt;/p&gt;</comment>
                            <comment id="14967316" author="hudson" created="Wed, 21 Oct 2015 15:26:52 +0000"  >&lt;p&gt;SUCCESS: Integrated in Thrift #1695 (See &lt;a href=&quot;https://builds.apache.org/job/Thrift/1695/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Thrift/1695/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-3370&quot; title=&quot;errno extern variable redefined. Not compiling for Android&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-3370&quot;&gt;&lt;del&gt;THRIFT-3370&lt;/del&gt;&lt;/a&gt; errno extern variable redefined. Not compiling for Android (nsuke: rev b343feee0d048e214c93bd78560af9185531c094)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;lib/c_glib/src/thrift/c_glib/transport/thrift_socket.c&lt;/li&gt;
	&lt;li&gt;lib/c_glib/src/thrift/c_glib/transport/thrift_server_socket.c&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15182876" author="githubbot" created="Mon, 7 Mar 2016 11:03:54 +0000"  >&lt;p&gt;GitHub user gadLinux opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/929&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/929&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Fix problem on #&lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-3370&quot; title=&quot;errno extern variable redefined. Not compiling for Android&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-3370&quot;&gt;&lt;del&gt;THRIFT-3370&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    This is a rebased master of the thrift-3370.&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/gadLinux/thrift&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/gadLinux/thrift&lt;/a&gt; thrift-3370&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/929.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/929.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #929&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 0a85d968a4407fe5f3ab4bb63420dbd5574490e9&lt;br/&gt;
Author: Gonzalo Aguilar Delgado &amp;lt;gaguilar@level2crm.com&amp;gt;&lt;br/&gt;
Date:   2015-10-09T02:14:59Z&lt;/p&gt;

&lt;p&gt;    Fix problem on #&lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-3370&quot; title=&quot;errno extern variable redefined. Not compiling for Android&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-3370&quot;&gt;&lt;del&gt;THRIFT-3370&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15182910" author="hudson" created="Mon, 7 Mar 2016 11:49:32 +0000"  >&lt;p&gt;SUCCESS: Integrated in Thrift-precommit #272 (See &lt;a href=&quot;https://builds.apache.org/job/Thrift-precommit/272/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Thrift-precommit/272/&lt;/a&gt;)&lt;br/&gt;
Fix problem on #&lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-3370&quot; title=&quot;errno extern variable redefined. Not compiling for Android&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-3370&quot;&gt;&lt;del&gt;THRIFT-3370&lt;/del&gt;&lt;/a&gt; (gaguilar: &lt;a href=&quot;https://github.com/apache/thrift/commit/0a85d968a4407fe5f3ab4bb63420dbd5574490e9&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/commit/0a85d968a4407fe5f3ab4bb63420dbd5574490e9&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;lib/c_glib/src/thrift/c_glib/transport/thrift_server_socket.c&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15183281" author="githubbot" created="Mon, 7 Mar 2016 17:10:24 +0000"  >&lt;p&gt;Github user nsuke commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/929#issuecomment-193350469&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/929#issuecomment-193350469&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @gadLinux the patch is already &lt;span class=&quot;error&quot;&gt;&amp;#91;merged&amp;#93;&lt;/span&gt;(b343feee0d048e214c93bd78560af9185531c094) but without the comment, as noted in the JIRA issue.&lt;/p&gt;</comment>
                            <comment id="15183649" author="githubbot" created="Mon, 7 Mar 2016 20:33:35 +0000"  >&lt;p&gt;Github user gadLinux commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/929#issuecomment-193436915&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/929#issuecomment-193436915&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Hi @nsuke, &lt;/p&gt;

&lt;p&gt;    I see I just rebased everything in case it was not. I close this then.&lt;/p&gt;</comment>
                            <comment id="15183650" author="githubbot" created="Mon, 7 Mar 2016 20:33:35 +0000"  >&lt;p&gt;Github user gadLinux closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/929&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/929&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 37 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2mqtr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>