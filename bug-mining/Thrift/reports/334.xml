<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 07:58:42 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[THRIFT-787] Enums are not read correctly</title>
                <link>https://issues.apache.org/jira/browse/THRIFT-787</link>
                <project id="12310800" key="THRIFT">Thrift</project>
                    <description>&lt;p&gt;The Haskell (and OCaml) generators emit incorrect code for enum deserilalization. The value counter is not reset to -1 before the deserialization function is generated.&lt;/p&gt;</description>
                <environment>&lt;p&gt;All platforms&lt;/p&gt;</environment>
        <key id="12465191">THRIFT-787</key>
            <summary>Enums are not read correctly</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="clavoie">Christian Lavoie</assignee>
                                    <reporter username="seliopou">Spiros Eliopoulos</reporter>
                        <labels>
                    </labels>
                <created>Sat, 22 May 2010 16:43:04 +0000</created>
                <updated>Mon, 27 Sep 2010 23:38:44 +0000</updated>
                            <resolved>Mon, 27 Sep 2010 23:38:44 +0000</resolved>
                                    <version>0.1</version>
                                    <fixVersion>0.5</fixVersion>
                                    <component>Haskell - Compiler</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12870308" author="seliopou" created="Sat, 22 May 2010 16:48:17 +0000"  >&lt;p&gt;This patch fixes this issue.&lt;/p&gt;</comment>
                            <comment id="12914898" author="clavoie" created="Sun, 26 Sep 2010 01:20:20 +0000"  >&lt;p&gt;Actually, this is now handled in parse/t_enum.*, the resolve_values call. It&apos;s implemented redundantly in (as far as I can tell) all generators the same way:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt; 286   for (c_iter = constants.begin(); c_iter != constants.end(); ++c_iter) {
 287     if ((*c_iter)-&amp;gt;has_value()) {
 288       value = (*c_iter)-&amp;gt;get_value();
 289     } else {
 290       ++value; // THIS WILL NEVER EXECUTE
 291     }
 292     string name = capitalize((*c_iter)-&amp;gt;get_name());
 293 
 294     f_types_ &amp;lt;&amp;lt;
 295       indent() &amp;lt;&amp;lt; name &amp;lt;&amp;lt; &quot; -&amp;gt; &quot; &amp;lt;&amp;lt; value &amp;lt;&amp;lt; endl;
 296   }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;(or the appropriate variant thereof)&lt;/p&gt;

&lt;p&gt;So this patch is now redundant (thanks to resolve_values, the else branch of that if statement is never taken in the generators). Cleanup patch incoming as soon as I have a setup where I can run tests.&lt;/p&gt;</comment>
                            <comment id="12914903" author="clavoie" created="Sun, 26 Sep 2010 02:12:57 +0000"  >&lt;p&gt;Haven&apos;t tested this yet, but reading the code produced by the compiler, it all looks &apos;obviously correct&apos; to me (keep in mind I don&apos;t speak as3, cocoa, csharp, erl, php, st or xsd fluently).&lt;/p&gt;

&lt;p&gt;I should be able test about half the generators first hand this week, if nobody beats me to it.&lt;/p&gt;</comment>
                            <comment id="12915455" author="clavoie" created="Mon, 27 Sep 2010 20:05:24 +0000"  >&lt;p&gt;I generated code with all generators, using a simplistic enum:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;enum&lt;/span&gt; MyEnum {
  ZERO,
  ONE,
  THREE = 3,
  FOUR,
  FORTYTWO = 42,
  FORTYTHREE,
  TWELVE = 12,
  THIRTEEN
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;9050e1c444bb9ec823857e68f1ea3c6e  tmp-without-787/gen-as3/MyEnum.as
e364dd1d37f48f5ee49898273d583ac3  tmp-without-787/gen-cocoa/test.h
13353d093c7fbfb6d34e18c5e209834e  tmp-without-787/gen-cocoa/test.m
0e35d18e6b3d161050416ef65f589a7b  tmp-without-787/gen-cpp/test_constants.cpp
0305410c79ead19f7a21da83005bbc4d  tmp-without-787/gen-cpp/test_constants.h
d614d268bf718712f9857febe59a87a5  tmp-without-787/gen-cpp/test_types.cpp
f4202dd6e56eb234e9ff319fd5248b58  tmp-without-787/gen-cpp/test_types.h
44537aa869bdf2c22d2a40427eb7bfbb  tmp-without-787/gen-csharp/MyEnum.cs
5cc5162f68c30a8ff998f0ba28afd1ec  tmp-without-787/gen-erl/test_constants.hrl
01ea91d8c4d3ba7fe0c4568aecf66636  tmp-without-787/gen-erl/test_types.erl
80fcb1e546073b806fc1676176330477  tmp-without-787/gen-erl/test_types.hrl
515131db34af21096383eadc718905ab  tmp-without-787/gen-hs/Test_Consts.hs
c65c348912562e58a25d4448b5881f06  tmp-without-787/gen-hs/Test_Types.hs
7de88e95d2037748dd0f3917b5645265  tmp-without-787/gen-html/index.html
c6e33f8d8d4b88f37d666ed8392d24cb  tmp-without-787/gen-html/style.css
6d86e7f688a70ab75289fbfe14f67f39  tmp-without-787/gen-html/test.html
53183bfed8fb46399da51ad849758e4e  tmp-without-787/gen-java/MyEnum.java
1f32e388a639a566394a1f6611cebea6  tmp-without-787/gen-javame/MyEnum.java
ae31c442df8f2982efbd3bbcbf6c6ddd  tmp-without-787/gen-js/test_types.js
ad2f732e3f82c4d02baf90b5800ed4b0  tmp-without-787/gen-ocaml/test_consts.ml
27a042e3e8a036dbcb374a8103ea7d35  tmp-without-787/gen-ocaml/test_types.ml
0e2fe71b03b241ff4c2b5c1a4b36e208  tmp-without-787/gen-ocaml/test_types.mli
de37caf4bb38ca4399b31850dddcd0ec  tmp-without-787/gen-perl/Constants.pm
07be59e6b0ce725187869ebc1d2c9a14  tmp-without-787/gen-perl/Types.pm
fd9fd449f522a983f545d3dbb038ad4b  tmp-without-787/gen-php/test/test_types.php
d41d8cd98f00b204e9800998ecf8427e  tmp-without-787/gen-py/__init__.py
fcb6376ae0410613e38952e6b0395814  tmp-without-787/gen-py/test/__init__.py
14e2d529821f06f285353a86634e673b  tmp-without-787/gen-py/test/constants.py
94c4a93659d81bc9b48ad2519ea9a37f  tmp-without-787/gen-py/test/ttypes.py
8096a712cd33880d33dca92b11671472  tmp-without-787/gen-rb/test_constants.rb
28a82f55b1a1d74e5e7882292f1eab8b  tmp-without-787/gen-rb/test_types.rb
76c2d5049d0c0b0df90cec6760815ecb  tmp-without-787/gen-st/test.st
718d8596a14d123d83afb0d5d6d6fd96  tmp-without-787/gen-xsd/test_xsd.php
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Then again, after apply my v2 patch:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;9050e1c444bb9ec823857e68f1ea3c6e  tmp-with-787/gen-as3/MyEnum.as
e364dd1d37f48f5ee49898273d583ac3  tmp-with-787/gen-cocoa/test.h
13353d093c7fbfb6d34e18c5e209834e  tmp-with-787/gen-cocoa/test.m
0e35d18e6b3d161050416ef65f589a7b  tmp-with-787/gen-cpp/test_constants.cpp
0305410c79ead19f7a21da83005bbc4d  tmp-with-787/gen-cpp/test_constants.h
d614d268bf718712f9857febe59a87a5  tmp-with-787/gen-cpp/test_types.cpp
f4202dd6e56eb234e9ff319fd5248b58  tmp-with-787/gen-cpp/test_types.h
44537aa869bdf2c22d2a40427eb7bfbb  tmp-with-787/gen-csharp/MyEnum.cs
5cc5162f68c30a8ff998f0ba28afd1ec  tmp-with-787/gen-erl/test_constants.hrl
01ea91d8c4d3ba7fe0c4568aecf66636  tmp-with-787/gen-erl/test_types.erl
80fcb1e546073b806fc1676176330477  tmp-with-787/gen-erl/test_types.hrl
515131db34af21096383eadc718905ab  tmp-with-787/gen-hs/Test_Consts.hs
c65c348912562e58a25d4448b5881f06  tmp-with-787/gen-hs/Test_Types.hs
7de88e95d2037748dd0f3917b5645265  tmp-with-787/gen-html/index.html
c6e33f8d8d4b88f37d666ed8392d24cb  tmp-with-787/gen-html/style.css
6d86e7f688a70ab75289fbfe14f67f39  tmp-with-787/gen-html/test.html
53183bfed8fb46399da51ad849758e4e  tmp-with-787/gen-java/MyEnum.java
1f32e388a639a566394a1f6611cebea6  tmp-with-787/gen-javame/MyEnum.java
ae31c442df8f2982efbd3bbcbf6c6ddd  tmp-with-787/gen-js/test_types.js
ad2f732e3f82c4d02baf90b5800ed4b0  tmp-with-787/gen-ocaml/test_consts.ml
27a042e3e8a036dbcb374a8103ea7d35  tmp-with-787/gen-ocaml/test_types.ml
0e2fe71b03b241ff4c2b5c1a4b36e208  tmp-with-787/gen-ocaml/test_types.mli
de37caf4bb38ca4399b31850dddcd0ec  tmp-with-787/gen-perl/Constants.pm
07be59e6b0ce725187869ebc1d2c9a14  tmp-with-787/gen-perl/Types.pm
fd9fd449f522a983f545d3dbb038ad4b  tmp-with-787/gen-php/test/test_types.php
d41d8cd98f00b204e9800998ecf8427e  tmp-with-787/gen-py/__init__.py
fcb6376ae0410613e38952e6b0395814  tmp-with-787/gen-py/test/__init__.py
14e2d529821f06f285353a86634e673b  tmp-with-787/gen-py/test/constants.py
94c4a93659d81bc9b48ad2519ea9a37f  tmp-with-787/gen-py/test/ttypes.py
8096a712cd33880d33dca92b11671472  tmp-with-787/gen-rb/test_constants.rb
28a82f55b1a1d74e5e7882292f1eab8b  tmp-with-787/gen-rb/test_types.rb
e74e255a131e643e8a887efcebe31156  tmp-with-787/gen-st/test.st
718d8596a14d123d83afb0d5d6d6fd96  tmp-with-787/gen-xsd/test_xsd.php
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;They&apos;re the same files, so the patch is clearly a no-op from that perspective. Also, I read through the generated code, it is &quot;obviously correct&quot;, meaning that &lt;tt&gt;ZERO&lt;/tt&gt; matches with &lt;tt&gt;0&lt;/tt&gt;, &lt;tt&gt;THIRTEEN&lt;/tt&gt; with &lt;tt&gt;13&lt;/tt&gt;, ... in all generated code. Diff&apos;ing leads to the same conclusion:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;
$ diff --recursive tmp-with*
diff --recursive tmp-with-787/gen-st/test.st tmp-without-787/gen-st/test.st
15c15
&amp;lt; !Test class methodsFor: &apos;as yet uncategorized&apos; stamp: &apos;thrift 09/27/2010 15:57&apos;!
---
&amp;gt; !Test class methodsFor: &apos;as yet uncategorized&apos; stamp: &apos;thrift 09/27/2010 15:54&apos;!
19c19
&amp;lt; !Test class methodsFor: &apos;as yet uncategorized&apos; stamp: &apos;thrift 09/27/2010 15:57&apos;!
---
&amp;gt; !Test class methodsFor: &apos;as yet uncategorized&apos; stamp: &apos;thrift 09/27/2010 15:54&apos;!
23c23
&amp;lt; !Test class methodsFor: &apos;as yet uncategorized&apos; stamp: &apos;thrift 09/27/2010 15:57&apos;!
---
&amp;gt; !Test class methodsFor: &apos;as yet uncategorized&apos; stamp: &apos;thrift 09/27/2010 15:54&apos;!
27c27
&amp;lt; !Test class methodsFor: &apos;as yet uncategorized&apos; stamp: &apos;thrift 09/27/2010 15:57&apos;!
---
&amp;gt; !Test class methodsFor: &apos;as yet uncategorized&apos; stamp: &apos;thrift 09/27/2010 15:54&apos;!
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The only difference is some timestamp in the st generator.&lt;/p&gt;</comment>
                            <comment id="12915545" author="bryanduxbury" created="Mon, 27 Sep 2010 23:38:44 +0000"  >&lt;p&gt;I just committed this. There were a few other little blobs of calls to the has_value() method in as3, python, and cpp compilers that seemed superfluous, so I whacked those too. Thanks for the patch, Christian!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12445238" name="0001--THRIFT-787-Fix-bug-in-enum-deserialization.patch" size="1439" author="seliopou" created="Sat, 22 May 2010 16:48:17 +0000"/>
                            <attachment id="12455585" name="v2-thrift-read-enums-cleanup.patch" size="17920" author="clavoie" created="Sun, 26 Sep 2010 02:12:57 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>186940</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 years, 9 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i16dpj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>245353</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>