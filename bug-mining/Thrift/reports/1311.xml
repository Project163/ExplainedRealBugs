<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 08:19:39 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[THRIFT-3241] fatal error: runtime: cannot map pages in arena address space</title>
                <link>https://issues.apache.org/jira/browse/THRIFT-3241</link>
                <project id="12310800" key="THRIFT">Thrift</project>
                    <description>&lt;p&gt;Passing huge strings to a Go server may produce a fatal exit with an OOM error. Main problem is that &lt;a href=&quot;#!msg/golang-nuts/jMpUBTkif3s/Luhrm0ZnHQcJ&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;OOM errors are not recoverable by design&lt;/a&gt; in Go.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;fatal error: runtime: cannot map pages in arena address space

runtime stack:
runtime.SysMap(0x3e7e0000, 0xb0d0000, 0xcfe01, 0x8172d8)
        c:/go/src/runtime/mem_windows.c:131 +0x7f
runtime.MHeap_SysAlloc(0x81a0c0, 0xb0d0000, 0xfffffffe)
        c:/go/src/runtime/malloc.c:284 +0xf1
runtime.MHeap_Alloc(0x81a0c0, 0x5861, 0x0, 0x12360001, 0x12368640)
        c:/go/src/runtime/mheap.c:240 +0x66

goroutine 390 [running]:
runtime.switchtoM()
        c:/go/src/runtime/asm_386.s:208 fp=0x1241fb70 sp=0x1241fb6c
runtime.mallocgc(0xb0c000b, 0x0, 0x3, 0x12356960)
        c:/go/src/runtime/malloc.go:199 +0x7d3 fp=0x1241fbc8 sp=0x1241fb70
runtime.rawstring(0xb0c000b, 0x0, 0x0, 0x0, 0x0, 0x0)
        c:/go/src/runtime/string.go:195 +0x88 fp=0x1241fbe0 sp=0x1241fbc8
runtime.slicebytetostring(0x1dbcc000, 0xb0c000b, 0xb0c000b, 0x0, 0x0)
        c:/go/src/runtime/string.go:69 +0x38 fp=0x1241fc28 sp=0x1241fbe0
thrift.(*TBinaryProtocol).readStringBody(0x12418c40, 0xb0c000b, 0x0, 0x0, 0x0, 0x0)
        C:/Test/src/thrift/binary_protocol.go:483 +0x150 fp=0x1241fc70 sp=0x1241fc28
thrift.(*TBinaryProtocol).ReadString(0x12418c40, 0x0, 0x0, 0x0, 0x0)
        C:/Test/src/thrift/binary_protocol.go:437 +0xc6 fp=0x1241fc94 sp=0x1241fc70
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12844595">THRIFT-3241</key>
            <summary>fatal error: runtime: cannot map pages in arena address space</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jensg">Jens Geyer</assignee>
                                    <reporter username="jensg">Jens Geyer</reporter>
                        <labels>
                    </labels>
                <created>Mon, 13 Jul 2015 09:44:58 +0000</created>
                <updated>Fri, 31 Jul 2015 21:41:16 +0000</updated>
                            <resolved>Sun, 26 Jul 2015 00:31:05 +0000</resolved>
                                    <version>0.9.2</version>
                                    <fixVersion>0.9.3</fixVersion>
                                    <component>Go - Library</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="14641584" author="jensg" created="Sat, 25 Jul 2015 13:39:36 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=beberg&quot; class=&quot;user-hover&quot; rel=&quot;beberg&quot;&gt;beberg&lt;/a&gt;, do you have any idea how to overcome that? I mean we could add some sanity checking on the string length, but that sounds a bit heuristic to me. OTOH I have no other idea how to overcome that one.&lt;/p&gt;</comment>
                            <comment id="14641726" author="beberg" created="Sat, 25 Jul 2015 17:08:05 +0000"  >&lt;p&gt;It is by design, and is considered a production issue.&lt;/p&gt;

&lt;p&gt;1. Run with X memory.&lt;br/&gt;
2. Max out the load, and observe memory use.&lt;br/&gt;
3. Use less memory the next run if there is significant unused memory, more if they are OOM&apos;ing.&lt;br/&gt;
4. If you cannot raise memory, lower the concurrency per server.&lt;/p&gt;

&lt;p&gt;Steps 1-3 are completely automated in Google production systems and elsewhere.&lt;/p&gt;

&lt;p&gt;So in Thrift what&apos;s important is exposing the concurrency limits in all pool/async implementations. In Go LimitListener is useful.&lt;/p&gt;</comment>
                            <comment id="14641800" author="githubbot" created="Sun, 26 Jul 2015 00:08:59 +0000"  >&lt;p&gt;GitHub user Jens-G opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/564&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/564&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-3241&quot; title=&quot;fatal error: runtime: cannot map pages in arena address space&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-3241&quot;&gt;&lt;del&gt;THRIFT-3241&lt;/del&gt;&lt;/a&gt; fatal error: runtime: cannot map pages in arena address s&#8230;&lt;/p&gt;

&lt;p&gt;    &#8230;pace&lt;/p&gt;

&lt;p&gt;    Client: Go&lt;br/&gt;
    Patch: Jens Geyer&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/Jens-G/thrift&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/Jens-G/thrift&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-3241&quot; title=&quot;fatal error: runtime: cannot map pages in arena address space&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-3241&quot;&gt;&lt;del&gt;THRIFT-3241&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/564.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/564.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #564&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit f51eab2dc67a9cd61303f4a0ed9dc54fe59fb2ad&lt;br/&gt;
Author: Jens Geyer &amp;lt;jensg@apache.org&amp;gt;&lt;br/&gt;
Date:   2015-07-25T23:25:23Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-3241&quot; title=&quot;fatal error: runtime: cannot map pages in arena address space&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-3241&quot;&gt;&lt;del&gt;THRIFT-3241&lt;/del&gt;&lt;/a&gt; fatal error: runtime: cannot map pages in arena address space&lt;br/&gt;
    Client: Go&lt;br/&gt;
    Patch: Jens Geyer&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="14641806" author="jensg" created="Sun, 26 Jul 2015 00:21:26 +0000"  >&lt;p&gt;Note: The behaviour is unfortunately by design with Go.  The only solution is to &lt;b&gt;consequently use framed transport&lt;/b&gt; which avoids the issue by means of the included frame size.&lt;/p&gt;</comment>
                            <comment id="14641808" author="githubbot" created="Sun, 26 Jul 2015 00:30:14 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/564&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/564&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14641810" author="jensg" created="Sun, 26 Jul 2015 00:31:06 +0000"  >&lt;p&gt;Committed.&lt;/p&gt;</comment>
                            <comment id="14641812" author="hudson" created="Sun, 26 Jul 2015 00:51:14 +0000"  >&lt;p&gt;SUCCESS: Integrated in Thrift #1623 (See &lt;a href=&quot;https://builds.apache.org/job/Thrift/1623/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Thrift/1623/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-3241&quot; title=&quot;fatal error: runtime: cannot map pages in arena address space&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-3241&quot;&gt;&lt;del&gt;THRIFT-3241&lt;/del&gt;&lt;/a&gt; fatal error: runtime: cannot map pages in arena address space (jensg: rev ca8469ec578b13524e387782e7ee72d4150ab542)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;lib/go/thrift/transport.go&lt;/li&gt;
	&lt;li&gt;lib/go/thrift/iostream_transport.go&lt;/li&gt;
	&lt;li&gt;lib/go/thrift/ssl_socket.go&lt;/li&gt;
	&lt;li&gt;lib/go/thrift/memory_buffer.go&lt;/li&gt;
	&lt;li&gt;lib/go/thrift/framed_transport.go&lt;/li&gt;
	&lt;li&gt;lib/go/thrift/compact_protocol.go&lt;/li&gt;
	&lt;li&gt;lib/go/thrift/rich_transport.go&lt;/li&gt;
	&lt;li&gt;lib/go/thrift/socket.go&lt;/li&gt;
	&lt;li&gt;lib/go/thrift/binary_protocol.go&lt;/li&gt;
	&lt;li&gt;lib/go/thrift/buffered_transport.go&lt;/li&gt;
	&lt;li&gt;lib/go/thrift/http_client.go&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 17 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2h65r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>