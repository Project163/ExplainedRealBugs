<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 08:35:37 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[THRIFT-5892] PY_SSIZE_T_CLEAN error in some environments</title>
                <link>https://issues.apache.org/jira/browse/THRIFT-5892</link>
                <project id="12310800" key="THRIFT">Thrift</project>
                    <description>&lt;p&gt;The error described in &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-5488&quot; title=&quot;SystemError when using fast binary or compact protocol in python 3.10 &quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-5488&quot;&gt;&lt;del&gt;THRIFT-5488&lt;/del&gt;&lt;/a&gt; comes up in some environments even after the original fix. I could reproduce this on a chainguard based docked image (GCC 15), while on my Ubuntu desktop things worked well (GCC 9) . I don&apos;t know the exact cause of the different behavior, on guess is the different GCC version&lt;br/&gt;
Other info on the environment:&lt;br/&gt;
Python: 3.11.13&lt;br/&gt;
Thrift: 0.16 / 0.22 / master (probably all versions between but I didn&apos;t try)&lt;/p&gt;

&lt;p&gt;Adding #define PY_SSIZE_T_CLEAN to &lt;a href=&quot;https://github.com/apache/thrift/blob/master/lib/py/src/ext/module.cpp&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/blob/master/lib/py/src/ext/module.cpp&lt;/a&gt; before including Python.h solved the issue.&lt;/p&gt;

&lt;p&gt;The issue was discover in &lt;a href=&quot;https://github.com/cloudera/impyla&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/cloudera/impyla&lt;/a&gt; which tries to use the native binary protocol module:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&amp;gt;&amp;gt;&amp;gt; from impala.dbapi &lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; connect
&amp;gt;&amp;gt;&amp;gt; con=connect(host=...)
&amp;gt;&amp;gt;&amp;gt; cur=con.cursor()
Traceback (most recent call last):
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;&amp;lt;stdin&amp;gt;&quot;&lt;/span&gt;, line 1, in &amp;lt;module&amp;gt;
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/tmp/impala-test-3/lib/python3.11/site-packages/impala/hiveserver2.py&quot;&lt;/span&gt;, line 129, in cursor
    session = self.service.open_session(user, configuration)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/tmp/impala-test-3/lib/python3.11/site-packages/impala/hiveserver2.py&quot;&lt;/span&gt;, line 1189, in open_session
    resp = self._rpc(&lt;span class=&quot;code-quote&quot;&gt;&apos;OpenSession&apos;&lt;/span&gt;, req, True)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/tmp/impala-test-3/lib/python3.11/site-packages/impala/hiveserver2.py&quot;&lt;/span&gt;, line 1082, in _rpc
    response = self._execute(func_name, request, retry_on_http_error)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/tmp/impala-test-3/lib/python3.11/site-packages/impala/hiveserver2.py&quot;&lt;/span&gt;, line 1100, in _execute
    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; func(request)
           ^^^^^^^^^^^^^
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/tmp/impala-test-3/lib/python3.11/site-packages/impala/_thrift_gen/TCLIService/TCLIService.py&quot;&lt;/span&gt;, line 196, in OpenSession
    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; self.recv_OpenSession()
           ^^^^^^^^^^^^^^^^^^^^^^^
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/tmp/impala-test-3/lib/python3.11/site-packages/impala/_thrift_gen/TCLIService/TCLIService.py&quot;&lt;/span&gt;, line 215, in recv_OpenSession
    result.read(iprot)
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/tmp/impala-test-3/lib/python3.11/site-packages/impala/_thrift_gen/TCLIService/TCLIService.py&quot;&lt;/span&gt;, line 1415, in read
    iprot._fast_decode(self, iprot, [self.__class__, self.thrift_spec])
SystemError: PY_SSIZE_T_CLEAN macro must be defined &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&apos;#&apos;&lt;/span&gt; formats
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13628921">THRIFT-5892</key>
            <summary>PY_SSIZE_T_CLEAN error in some environments</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="3" iconUrl="https://issues.apache.org/jira/images/icons/statuses/inprogress.png" description="This issue is being actively worked on at the moment by the assignee.">In Progress</status>
                    <statusCategory id="4" key="indeterminate" colorName="yellow"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="csringhofer">Csaba Ringhofer</assignee>
                                    <reporter username="csringhofer">Csaba Ringhofer</reporter>
                        <labels>
                    </labels>
                <created>Mon, 15 Sep 2025 09:54:11 +0000</created>
                <updated>Wed, 17 Sep 2025 01:29:11 +0000</updated>
                                            <version>0.16.0</version>
                    <version>0.22.0</version>
                                    <fixVersion>0.23.0</fixVersion>
                                    <component>Python - Library</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="1200">20m</timespent>
                                    <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13416853">THRIFT-5488</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_12314421" key="com.atlassian.jira.plugin.system.customfieldtypes:labels">
                        <customfieldname>Language</customfieldname>
                        <customfieldvalues>
                                        <label>python</label>
    
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1xp0g:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>