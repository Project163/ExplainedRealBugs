<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 08:32:53 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[THRIFT-5136] Fix memory leak in thrift_multiplexed_processor_process_impl()</title>
                <link>https://issues.apache.org/jira/browse/THRIFT-5136</link>
                <project id="12310800" key="THRIFT">Thrift</project>
                    <description>&lt;p&gt;The memory leak was triggered on calling thrift_multiplexed_processor_process_impl().&lt;br/&gt;
The variable stored_message_protocol has been malloced, but it hasn&apos;t been freed.&lt;br/&gt;
Release it directly, there will be other problems. The reason for the problems is that&lt;br/&gt;
it will double free fname. The stored message protocol should copy the fname, so we can&lt;br/&gt;
free it.&lt;/p&gt;

&lt;p&gt;Leak:&lt;br/&gt;
Direct leak of 1848 byte(s) in 33 object(s) allocated from:&lt;br/&gt;
 #0 0x7f2d37eb7ae8 in __interceptor_malloc (/usr/lib64/libasan.so.5+0xefae8)&lt;br/&gt;
 #1 0x7f2d36ee61d5 in g_malloc (/usr/lib64/libglib-2.0.so.0+0x531d5)&lt;br/&gt;
 #2 0x7f2d36efde06 in g_slice_alloc (/usr/lib64/libglib-2.0.so.0+0x6ae06)&lt;br/&gt;
 #3 0x7f2d36efe44c in g_slice_alloc0 (/usr/lib64/libglib-2.0.so.0+0x6b44c)&lt;br/&gt;
 #4 0x7f2d37951849 in g_type_create_instance gtype.c:1848&lt;br/&gt;
 #5 0x7f2d37933fc7 in g_object_new_internal gobject.c:1799&lt;br/&gt;
 #6 0x7f2d37935f4d in g_object_new_valist (/usr/lib64/libgobject-2.0.so.0+0x17f4d)&lt;br/&gt;
 #7 0x7f2d379362ac in g_object_new (/usr/lib64/libgobject-2.0.so.0+0x182ac)&lt;br/&gt;
 #8 0x7f2d37b8a1b6 in thrift_multiplexed_processor_process_impl src/thrift/c_glib/processor/thrift_multiplexed_processor.c:138&lt;br/&gt;
 #9 0x7f2d37bad7bb in thrift_simple_server_serve src/thrift/c_glib/server/thrift_simple_server.c:58&lt;br/&gt;
 #10 0x7f2d37bac644 in thrift_server_serve src/thrift/c_glib/server/thrift_server.c:108&lt;br/&gt;
 #11 0x409341 in main src/test_server.c:278&lt;br/&gt;
 #12 0x7f2d366ca872 in __libc_start_main (/usr/lib64/libc.so.6+0x23872)&lt;br/&gt;
 #13 0x404a1d in _start (/mnt/hgfs/share/thrift-0.13.0/test/c_glib/.libs/lt-test_server+0x404a1d)&lt;/p&gt;

&lt;p&gt;Indirect leak of 256 byte(s) in 1 object(s) allocated from:&lt;br/&gt;
 #0 0x7f2d37eb7f28 in __interceptor_realloc (/usr/lib64/libasan.so.5+0xeff28)&lt;br/&gt;
 #1 0x7f2d36ee628d in g_realloc (/usr/lib64/libglib-2.0.so.0+0x5328d)&lt;br/&gt;
 #2 0x7f2d36eb1728 in g_array_maybe_expand garray.c:794&lt;br/&gt;
 #3 0x7f2d36eb1ae9 in g_array_append_vals (/usr/lib64/libglib-2.0.so.0+0x1eae9)&lt;br/&gt;
 #4 0x7f2d36eb2e0c in g_byte_array_append (/usr/lib64/libglib-2.0.so.0+0x1fe0c)&lt;br/&gt;
 #5 0x7f2d37ba7068 in thrift_buffered_transport_read_slow src/thrift/c_glib/transport/thrift_buffered_transport.c:122&lt;br/&gt;
 #6 0x7f2d37ba729e in thrift_buffered_transport_read src/thrift/c_glib/transport/thrift_buffered_transport.c:152&lt;br/&gt;
 #7 0x7f2d37b9f9e4 in thrift_transport_real_read_all src/thrift/c_glib/transport/thrift_transport.c:122&lt;br/&gt;
 #8 0x7f2d37b9f8cd in thrift_transport_read_all src/thrift/c_glib/transport/thrift_transport.c:92&lt;br/&gt;
 #9 0x7f2d37b957a6 in thrift_binary_protocol_read_binary src/thrift/c_glib/protocol/thrift_binary_protocol.c:841&lt;br/&gt;
 #10 0x7f2d37b8fc1b in thrift_protocol_decorator_read_binary src/thrift/c_glib/protocol/thrift_protocol_decorator.c:477&lt;br/&gt;
 #11 0x7f2d37b8c4b2 in thrift_protocol_read_binary src/thrift/c_glib/protocol/thrift_protocol.c:418&lt;br/&gt;
 #12 0x4740ca in t_test_thrift_test_test_binary_args_read gen-c_glib/t_test_thrift_test_types.c:13562&lt;br/&gt;
 #13 0x7f2d37b87865 in thrift_struct_read src/thrift/c_glib/thrift_struct.c:30&lt;br/&gt;
 #14 0x42c257 in t_test_thrift_test_processor_process_test_binary gen-c_glib/t_test_thrift_test.c:5665&lt;br/&gt;
 #15 0x43412c in t_test_thrift_test_processor_dispatch_call gen-c_glib/t_test_thrift_test.c:7178&lt;br/&gt;
 #16 0x7f2d37b892f0 in thrift_dispatch_processor_process src/thrift/c_glib/processor/thrift_dispatch_processor.c:56&lt;br/&gt;
 #17 0x7f2d37b8a250 in thrift_multiplexed_processor_process_impl src/thrift/c_glib/processor/thrift_multiplexed_processor.c:149&lt;br/&gt;
 #18 0x7f2d37bad7bb in thrift_simple_server_serve src/thrift/c_glib/server/thrift_simple_server.c:58&lt;br/&gt;
 #19 0x7f2d37bac644 in thrift_server_serve src/thrift/c_glib/server/thrift_server.c:108&lt;br/&gt;
 #20 0x409341 in main src/test_server.c:278&lt;br/&gt;
 #21 0x7f2d366ca872 in __libc_start_main (/usr/lib64/libc.so.6+0x23872)&lt;br/&gt;
 #22 0x404a1d in _start (/mnt/hgfs/share/thrift-0.13.0/test/c_glib/.libs/lt-test_server+0x404a1d)&lt;/p&gt;

&lt;p&gt;Indirect leak of 56 byte(s) in 1 object(s) allocated from:&lt;br/&gt;
 #0 0x7f2d37eb7ae8 in __interceptor_malloc (/usr/lib64/libasan.so.5+0xefae8)&lt;br/&gt;
 #1 0x7f2d36ee61d5 in g_malloc (/usr/lib64/libglib-2.0.so.0+0x531d5)&lt;br/&gt;
 #2 0x7f2d36efde06 in g_slice_alloc (/usr/lib64/libglib-2.0.so.0+0x6ae06)&lt;br/&gt;
 #3 0x7f2d36efe44c in g_slice_alloc0 (/usr/lib64/libglib-2.0.so.0+0x6b44c)&lt;br/&gt;
 #4 0x7f2d37951849 in g_type_create_instance gtype.c:1848&lt;br/&gt;
 #5 0x7f2d37933fc7 in g_object_new_internal gobject.c:1799&lt;br/&gt;
 #6 0x7f2d37935f4d in g_object_new_valist (/usr/lib64/libgobject-2.0.so.0+0x17f4d)&lt;br/&gt;
 #7 0x7f2d379362ac in g_object_new (/usr/lib64/libgobject-2.0.so.0+0x182ac)&lt;br/&gt;
 #8 0x7f2d37b9ff3f in thrift_buffered_transport_factory_get_transport src/thrift/c_glib/transport/thrift_buffered_transport_factory.c:35&lt;br/&gt;
 #9 0x7f2d37bad52c in thrift_simple_server_serve src/thrift/c_glib/server/thrift_simple_server.c:46&lt;br/&gt;
 #10 0x7f2d37bac644 in thrift_server_serve src/thrift/c_glib/server/thrift_server.c:108&lt;br/&gt;
 #11 0x409341 in main src/test_server.c:278&lt;br/&gt;
 #12 0x7f2d366ca872 in __libc_start_main (/usr/lib64/libc.so.6+0x23872)&lt;br/&gt;
 #13 0x404a1d in _start (/mnt/hgfs/share/thrift-0.13.0/test/c_glib/.libs/lt-test_server+0x404a1d)&lt;/p&gt;

&lt;p&gt;Indirect leak of 40 byte(s) in 1 object(s) allocated from:&lt;br/&gt;
 #0 0x7f2d37eb7ae8 in __interceptor_malloc (/usr/lib64/libasan.so.5+0xefae8)&lt;br/&gt;
 #1 0x7f2d36ee61d5 in g_malloc (/usr/lib64/libglib-2.0.so.0+0x531d5)&lt;br/&gt;
 #2 0x7f2d36efde06 in g_slice_alloc (/usr/lib64/libglib-2.0.so.0+0x6ae06)&lt;br/&gt;
 #3 0x7f2d36eb1894 in g_array_sized_new (/usr/lib64/libglib-2.0.so.0+0x1e894)&lt;br/&gt;
 #4 0x7f2d37ba7cf7 in thrift_buffered_transport_init src/thrift/c_glib/transport/thrift_buffered_transport.c:266&lt;br/&gt;
 #5 0x7f2d379518e9 in g_type_create_instance gtype.c:1866&lt;br/&gt;
 #6 0x7f2d37933fc7 in g_object_new_internal gobject.c:1799&lt;br/&gt;
 #7 0x7f2d37935f4d in g_object_new_valist (/usr/lib64/libgobject-2.0.so.0+0x17f4d)&lt;br/&gt;
 #8 0x7f2d379362ac in g_object_new (/usr/lib64/libgobject-2.0.so.0+0x182ac)&lt;br/&gt;
 #9 0x7f2d37b9ff3f in thrift_buffered_transport_factory_get_transport src/thrift/c_glib/transport/thrift_buffered_transport_factory.c:35&lt;br/&gt;
 #10 0x7f2d37bad52c in thrift_simple_server_serve src/thrift/c_glib/server/thrift_simple_server.c:46&lt;br/&gt;
 #11 0x7f2d37bac644 in thrift_server_serve src/thrift/c_glib/server/thrift_server.c:108&lt;br/&gt;
 #12 0x409341 in main src/test_server.c:278&lt;br/&gt;
 #13 0x7f2d366ca872 in __libc_start_main (/usr/lib64/libc.so.6+0x23872)&lt;br/&gt;
 #14 0x404a1d in _start (/mnt/hgfs/share/thrift-0.13.0/test/c_glib/.libs/lt-test_server+0x404a1d)&lt;/p&gt;

&lt;p&gt;Indirect leak of 40 byte(s) in 1 object(s) allocated from:&lt;br/&gt;
 #0 0x7f2d37eb7ae8 in __interceptor_malloc (/usr/lib64/libasan.so.5+0xefae8)&lt;br/&gt;
 #1 0x7f2d36ee61d5 in g_malloc (/usr/lib64/libglib-2.0.so.0+0x531d5)&lt;br/&gt;
 #2 0x7f2d36efde06 in g_slice_alloc (/usr/lib64/libglib-2.0.so.0+0x6ae06)&lt;br/&gt;
 #3 0x7f2d36eb1894 in g_array_sized_new (/usr/lib64/libglib-2.0.so.0+0x1e894)&lt;br/&gt;
 #4 0x7f2d37ba7d2c in thrift_buffered_transport_init src/thrift/c_glib/transport/thrift_buffered_transport.c:267&lt;br/&gt;
 #5 0x7f2d379518e9 in g_type_create_instance gtype.c:1866&lt;br/&gt;
 #6 0x7f2d37933fc7 in g_object_new_internal gobject.c:1799&lt;br/&gt;
 #7 0x7f2d37935f4d in g_object_new_valist (/usr/lib64/libgobject-2.0.so.0+0x17f4d)&lt;br/&gt;
 #8 0x7f2d379362ac in g_object_new (/usr/lib64/libgobject-2.0.so.0+0x182ac)&lt;br/&gt;
 #9 0x7f2d37b9ff3f in thrift_buffered_transport_factory_get_transport src/thrift/c_glib/transport/thrift_buffered_transport_factory.c:35&lt;br/&gt;
 #10 0x7f2d37bad52c in thrift_simple_server_serve src/thrift/c_glib/server/thrift_simple_server.c:46&lt;br/&gt;
 #11 0x7f2d37bac644 in thrift_server_serve src/thrift/c_glib/server/thrift_server.c:108&lt;br/&gt;
 #12 0x409341 in main src/test_server.c:278&lt;br/&gt;
 #13 0x7f2d366ca872 in __libc_start_main (/usr/lib64/libc.so.6+0x23872)&lt;br/&gt;
 #14 0x404a1d in _start (/mnt/hgfs/share/thrift-0.13.0/test/c_glib/.libs/lt-test_server+0x404a1d)&lt;/p&gt;

&lt;p&gt;Indirect leak of 32 byte(s) in 1 object(s) allocated from:&lt;br/&gt;
 #0 0x7f2d37eb7ae8 in __interceptor_malloc (/usr/lib64/libasan.so.5+0xefae8)&lt;br/&gt;
 #1 0x7f2d36ee61d5 in g_malloc (/usr/lib64/libglib-2.0.so.0+0x531d5)&lt;br/&gt;
 #2 0x7f2d36efde06 in g_slice_alloc (/usr/lib64/libglib-2.0.so.0+0x6ae06)&lt;br/&gt;
 #3 0x7f2d36efe44c in g_slice_alloc0 (/usr/lib64/libglib-2.0.so.0+0x6b44c)&lt;br/&gt;
 #4 0x7f2d37951849 in g_type_create_instance gtype.c:1848&lt;br/&gt;
 #5 0x7f2d37933fc7 in g_object_new_internal gobject.c:1799&lt;br/&gt;
 #6 0x7f2d37935f4d in g_object_new_valist (/usr/lib64/libgobject-2.0.so.0+0x17f4d)&lt;br/&gt;
 #7 0x7f2d379362ac in g_object_new (/usr/lib64/libgobject-2.0.so.0+0x182ac)&lt;br/&gt;
 #8 0x7f2d37b979b8 in thrift_binary_protocol_factory_get_protocol src/thrift/c_glib/protocol/thrift_binary_protocol_factory.c:30&lt;br/&gt;
 #9 0x7f2d37bad670 in thrift_simple_server_serve src/thrift/c_glib/server/thrift_simple_server.c:52&lt;br/&gt;
 #10 0x7f2d37bac644 in thrift_server_serve src/thrift/c_glib/server/thrift_server.c:108&lt;br/&gt;
 #11 0x409341 in main src/test_server.c:278&lt;br/&gt;
 #12 0x7f2d366ca872 in __libc_start_main (/usr/lib64/libc.so.6+0x23872)&lt;br/&gt;
 #13 0x404a1d in _start (/mnt/hgfs/share/thrift-0.13.0/test/c_glib/.libs/lt-test_server+0x404a1d)&lt;/p&gt;</description>
                <environment></environment>
        <key id="13290359">THRIFT-5136</key>
            <summary>Fix memory leak in thrift_multiplexed_processor_process_impl()</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="wangyunjian">wangyunjian</assignee>
                                    <reporter username="wangyunjian">wangyunjian</reporter>
                        <labels>
                    </labels>
                <created>Sun, 8 Mar 2020 09:26:27 +0000</created>
                <updated>Thu, 11 Feb 2021 22:27:09 +0000</updated>
                            <resolved>Wed, 2 Sep 2020 06:55:18 +0000</resolved>
                                                    <fixVersion>0.14.0</fixVersion>
                                    <component>C glib - Library</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="4800">1h 20m</timespent>
                                <comments>
                            <comment id="17169260" author="zeshuai007" created="Sat, 1 Aug 2020 09:25:00 +0000"  >&lt;p&gt;Hi,guys.I checked the code. I find that when (retval != 0) and (stored_message_protocol == NULL), it will double free  fname. I think changing the code from &quot;gint32 seqid, result;&quot; to &quot;gint32 seqid, result=0;&quot; in line 75 can also fix the bug.I&apos;m not sure it would be better.&lt;/p&gt;</comment>
                            <comment id="17189021" author="jensg" created="Wed, 2 Sep 2020 06:57:56 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=zeshuai007&quot; class=&quot;user-hover&quot; rel=&quot;zeshuai007&quot;&gt;zeshuai007&lt;/a&gt; I saw your comment too late.&lt;/p&gt;

&lt;p&gt;But he also added the strdup() shouldn&apos;t that do the trick?&lt;/p&gt;

&lt;p&gt;=&amp;gt; Please advise.&lt;/p&gt;

&lt;p&gt;@both: Feel free to reopen and add anlother patch or whatever you think makes sense&lt;/p&gt;</comment>
                            <comment id="17189055" author="zeshuai007" created="Wed, 2 Sep 2020 07:55:29 +0000"  >&lt;p&gt; This pr can indeed repair the double free problem.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310250" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10430"><![CDATA[Patch]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 11 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0caqw:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>