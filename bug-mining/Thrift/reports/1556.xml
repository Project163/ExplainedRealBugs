<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 08:23:36 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[THRIFT-3709] Comment syntax can produce broken code</title>
                <link>https://issues.apache.org/jira/browse/THRIFT-3709</link>
                <project id="12310800" key="THRIFT">Thrift</project>
                    <description>&lt;p&gt;Somewhere between 85650612e15c79c79e470553d3779d18f755150c and 6ec6860801bdc87236e636add071c4faa2ac7e4b the handling of comments was changed. This change appears to have removed support for the syntax &lt;tt&gt;/** Comment **/&lt;/tt&gt;. In particular, the comment-end token can&apos;t have more than one asterisk.&lt;/p&gt;

&lt;p&gt;However, it is possible to &quot;trick&quot; the parser by having multiple comments:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;struct Thing {
  &lt;span class=&quot;code-comment&quot;&gt;/** This is a comment */&lt;/span&gt;
  1: required string id,
  &lt;span class=&quot;code-comment&quot;&gt;/** This is also a comment **/&lt;/span&gt;
  2: required string typeId,
  &lt;span class=&quot;code-comment&quot;&gt;/** Yet another comment! */&lt;/span&gt;
  3: required i32 endTimestamp
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;In this case, the IDL file will parse correctly but will produce broken code, at least in the case of the Java compiler. Here is the relevant part of the generated file, first from the older commit (functional), then from master (broken).&lt;/p&gt;

&lt;p&gt;&lt;b&gt;older commit (expected result)&lt;/b&gt;&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;  /**
   * This is a comment
   */
  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; id; &lt;span class=&quot;code-comment&quot;&gt;// required
&lt;/span&gt;  /**
   * This is also a comment *
   */
  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; typeId; &lt;span class=&quot;code-comment&quot;&gt;// required
&lt;/span&gt;  /**
   * Yet another comment!
   */
  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; endTimestamp; &lt;span class=&quot;code-comment&quot;&gt;// required&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;b&gt;current master (broken)&lt;/b&gt;&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;  /**
   * This is a comment
   */
  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; id; &lt;span class=&quot;code-comment&quot;&gt;// required
&lt;/span&gt;  /**
   * This is also a comment **/
   * 2: required string typeId,
   * /** Yet another comment!
   */
  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; endTimestamp; &lt;span class=&quot;code-comment&quot;&gt;// required&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The line &lt;tt&gt;* 2: required string typeId,&lt;/tt&gt; lives outside the comment so the code fails to compile.&lt;/p&gt;

&lt;p&gt;For my part, I&apos;ll modify my IDL files to only use the single-asterisk syntax. However, I would expect generation to fail similarly to how it does with a single &lt;tt&gt;/** Comment **/&lt;/tt&gt; (with a maybe-not-totally-helpful &quot;unexpected token&quot; error)&lt;/p&gt;</description>
                <environment></environment>
        <key id="12947073">THRIFT-3709</key>
            <summary>Comment syntax can produce broken code</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jensg">Jens Geyer</assignee>
                                    <reporter username="tdavis">Tom Davis</reporter>
                        <labels>
                    </labels>
                <created>Fri, 4 Mar 2016 19:46:20 +0000</created>
                <updated>Sat, 20 Feb 2021 15:27:11 +0000</updated>
                            <resolved>Sun, 6 Mar 2016 23:21:00 +0000</resolved>
                                                    <fixVersion>0.10.0</fixVersion>
                                    <component>Compiler (General)</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="15181820" author="jensg" created="Sat, 5 Mar 2016 19:02:02 +0000"  >&lt;p&gt;Not sure, but there&apos;s a chance that I broke it with &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-3501&quot; title=&quot;Forward slash in comment causes compiler error&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-3501&quot;&gt;&lt;del&gt;THRIFT-3501&lt;/del&gt;&lt;/a&gt;. I&apos;ll take a look at it.&lt;/p&gt;</comment>
                            <comment id="15182369" author="githubbot" created="Sun, 6 Mar 2016 22:26:34 +0000"  >&lt;p&gt;GitHub user Jens-G opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/928&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/928&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-3709&quot; title=&quot;Comment syntax can produce broken code&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-3709&quot;&gt;&lt;del&gt;THRIFT-3709&lt;/del&gt;&lt;/a&gt; Comment syntax can produce broken code&lt;/p&gt;

&lt;p&gt;    Client: Compiler(general)&lt;br/&gt;
    Patch: Jens Geyer&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/Jens-G/thrift&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/Jens-G/thrift&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-3709&quot; title=&quot;Comment syntax can produce broken code&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-3709&quot;&gt;&lt;del&gt;THRIFT-3709&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/928.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/928.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #928&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit c33d8ced73c65975706321eb3391cadbb9542532&lt;br/&gt;
Author: Jens Geyer &amp;lt;jensg@apache.org&amp;gt;&lt;br/&gt;
Date:   2016-03-06T18:14:41Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-3709&quot; title=&quot;Comment syntax can produce broken code&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-3709&quot;&gt;&lt;del&gt;THRIFT-3709&lt;/del&gt;&lt;/a&gt; Comment syntax can produce broken code&lt;br/&gt;
    Client: Compiler(general)&lt;br/&gt;
    Patch: Jens Geyer&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15182390" author="hudson" created="Sun, 6 Mar 2016 23:10:52 +0000"  >&lt;p&gt;SUCCESS: Integrated in Thrift-precommit #271 (See &lt;a href=&quot;https://builds.apache.org/job/Thrift-precommit/271/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Thrift-precommit/271/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-3709&quot; title=&quot;Comment syntax can produce broken code&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-3709&quot;&gt;&lt;del&gt;THRIFT-3709&lt;/del&gt;&lt;/a&gt; Comment syntax can produce broken code Client: (jensg: &lt;a href=&quot;https://github.com/apache/thrift/commit/c33d8ced73c65975706321eb3391cadbb9542532&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/commit/c33d8ced73c65975706321eb3391cadbb9542532&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;compiler/cpp/compiler.vcxproj&lt;/li&gt;
	&lt;li&gt;compiler/cpp/src/thriftl.ll&lt;/li&gt;
	&lt;li&gt;test/DocTest.thrift&lt;/li&gt;
	&lt;li&gt;compiler/cpp/compiler.vcxproj.filters&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15182393" author="jensg" created="Sun, 6 Mar 2016 23:21:00 +0000"  >&lt;p&gt;Committed.&lt;/p&gt;</comment>
                            <comment id="15182398" author="githubbot" created="Sun, 6 Mar 2016 23:25:30 +0000"  >&lt;p&gt;Github user Jens-G closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/928&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/928&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15183172" author="tdavis" created="Mon, 7 Mar 2016 15:57:48 +0000"  >&lt;p&gt;Thanks, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jensg&quot; class=&quot;user-hover&quot; rel=&quot;jensg&quot;&gt;jensg&lt;/a&gt;!&lt;/p&gt;</comment>
                            <comment id="15187383" author="hudson" created="Wed, 9 Mar 2016 16:50:35 +0000"  >&lt;p&gt;SUCCESS: Integrated in Thrift-precommit #290 (See &lt;a href=&quot;https://builds.apache.org/job/Thrift-precommit/290/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Thrift-precommit/290/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-3709&quot; title=&quot;Comment syntax can produce broken code&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-3709&quot;&gt;&lt;del&gt;THRIFT-3709&lt;/del&gt;&lt;/a&gt; Comment syntax can produce broken code Client: (jensg: &lt;a href=&quot;https://github.com/apache/thrift/commit/775671aea41ea55427dd78d7ce68e282cc9b8487&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/commit/775671aea41ea55427dd78d7ce68e282cc9b8487&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;test/DocTest.thrift&lt;/li&gt;
	&lt;li&gt;compiler/cpp/src/thriftl.ll&lt;/li&gt;
	&lt;li&gt;compiler/cpp/compiler.vcxproj&lt;/li&gt;
	&lt;li&gt;compiler/cpp/compiler.vcxproj.filters&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12923867">THRIFT-3501</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12928002">THRIFT-3528</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12791679" name="THRIFT-3709-Comment-syntax-can-produce-broken-code.patch" size="7648" author="jensg" created="Sun, 6 Mar 2016 18:12:08 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 36 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310041" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Patch Info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10042"><![CDATA[Patch Available]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2u69j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>