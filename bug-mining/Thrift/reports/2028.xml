<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 08:31:19 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[THRIFT-4989] Run time exception when using TCompactProtocol</title>
                <link>https://issues.apache.org/jira/browse/THRIFT-4989</link>
                <project id="12310800" key="THRIFT">Thrift</project>
                    <description>&lt;p&gt;When serialising a struct using the TCompactProtocol we have discovered a run-time error on line&#160;&lt;a href=&quot;https://github.com/apache/thrift/blob/08a6eb6e1f21aa15682e414e124d7ee1a51a39c7/lib/swift/Sources/TCompactProtocol.swift#L474&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/blob/08a6eb6e1f21aa15682e414e124d7ee1a51a39c7/lib/swift/Sources/TCompactProtocol.swift#L474&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;The Swift implementation of TCompactProtocol assumes that the properties of autogenerated classes for Thrift Structs will be ordered by field key, but the current behaviour of the generator preserves the order from the original thrift definitions&#160; These are not required to be ordered by field key.&lt;/p&gt;

&lt;p&gt;Either the Swift lib needs to check for out-of-order properties, or the generator should order properties.&#160; Since the generator is only executed once and the Swift lib runs every time a message is serialised, I think it makes more sense to make this change in the generator.&lt;/p&gt;

&lt;p&gt;&#160;I&apos;ve made the necessary change, and will soon open a PR.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13265739">THRIFT-4989</key>
            <summary>Run time exception when using TCompactProtocol</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="davidfurey">David Furey</assignee>
                                    <reporter username="davidfurey">David Furey</reporter>
                        <labels>
                    </labels>
                <created>Fri, 1 Nov 2019 10:29:24 +0000</created>
                <updated>Thu, 11 Feb 2021 22:27:44 +0000</updated>
                            <resolved>Sat, 2 Nov 2019 14:04:44 +0000</resolved>
                                    <version>0.13.0</version>
                                    <fixVersion>0.14.0</fixVersion>
                                    <component>Swift - Compiler</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="1200">20m</timespent>
                                <comments>
                            <comment id="16964810" author="jensg" created="Fri, 1 Nov 2019 12:54:01 +0000"  >&lt;blockquote&gt;&lt;p&gt; The Swift implementation of TCompactProtocol assumes that the properties of autogenerated classes for Thrift Structs will be ordered by field key &lt;span class=&quot;error&quot;&gt;&amp;#91;...&amp;#93;&lt;/span&gt; &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I&apos;d say that reyling on &lt;b&gt;any&lt;/b&gt; particular field order is - at best - relying on undocumented/undefined behaviour. I&apos;d even go further and say it is a bug, since other language bindings may not follow such assumptions today and/or in the future..&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Either the Swift lib needs to check for out-of-order properties, or the generator should order properties.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;There is no &quot;correct&quot; order. If the Swift library does order fields in a special way for performance reasons or the like, that is perfectly fine. But one should not assume any other language binding does it the same way or does it at all. &lt;/p&gt;

&lt;p&gt;TL&amp;amp;DR: Its not about the question which order is correct, &lt;b&gt;rather we should question assuming any order&lt;/b&gt; and fix that.&lt;/p&gt;

</comment>
                            <comment id="16964847" author="davidfurey" created="Fri, 1 Nov 2019 13:57:36 +0000"  >&lt;p&gt;Since the Swift library will only ever be serialising data based on classes generated by the thrift swift compiler, I think it reasonable for the Swift library to rely on the properties being in a particular order order for writes.&lt;/p&gt;

&lt;p&gt;The Java language binding sends fields in ascending order by key/id regardless of what order they are in the original thrift definition file.&lt;/p&gt;

&lt;p&gt;I haven&apos;t tested, but I think the Swift library supports fields in any order when deserialising TCompactProtocol, so it should not have no compatibility issue if there are other language bindings that send data with a different ordering.&lt;/p&gt;</comment>
                            <comment id="16965383" author="jensg" created="Sat, 2 Nov 2019 14:04:44 +0000"  >&lt;p&gt;Committed, thanks!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 2 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z08660:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>