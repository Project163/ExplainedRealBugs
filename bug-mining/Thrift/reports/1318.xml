<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 08:19:47 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[THRIFT-3273] c_glib: Generated code tries to convert between function and void pointers</title>
                <link>https://issues.apache.org/jira/browse/THRIFT-3273</link>
                <project id="12310800" key="THRIFT">Thrift</project>
                    <description>&lt;p&gt;In code generated by the compiler for C (GLib), a service&apos;s processor class incorrectly treats function and void pointers as interchangeable: When adding to the &lt;tt&gt;process_map&lt;/tt&gt; hash table it supplies a pointer to a function, while &lt;tt&gt;g_hash_table_insert&lt;/tt&gt; expects a &lt;tt&gt;gpointer&lt;/tt&gt; (effectively &lt;tt&gt;void *&lt;/tt&gt;) to a data object.&lt;/p&gt;

&lt;p&gt;ISO C explicitly forbids this conversion as it is not compatible with all architectures, and with its &lt;tt&gt;-pedantic&lt;/tt&gt; option enabled gcc will generate warnings like&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;gen-c_glib/calculator.c: In function &lt;span class=&quot;code-quote&quot;&gt;&apos;calculator_processor_init&apos;&lt;/span&gt;:
gen-c_glib/calculator.c:1231:24: warning: ISO C forbids passing argument 3 of &lt;span class=&quot;code-quote&quot;&gt;&apos;g_hash_table_insert&apos;&lt;/span&gt; between function pointer and &lt;span class=&quot;code-quote&quot;&gt;&apos;void *&apos;&lt;/span&gt; [-Wpedantic]
                        calculator_processor_process_ping);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The compiler needs to be fixed so the code it generates does not try to use function pointers where data (void) pointers are expected.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Fedora 22 (gcc 5.1.1) on x86_64&lt;/p&gt;</environment>
        <key id="12849627">THRIFT-3273</key>
            <summary>c_glib: Generated code tries to convert between function and void pointers</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="simonsouth">Simon South</assignee>
                                    <reporter username="simonsouth">Simon South</reporter>
                        <labels>
                            <label>c_glib</label>
                            <label>compiler</label>
                    </labels>
                <created>Tue, 28 Jul 2015 14:27:15 +0000</created>
                <updated>Sat, 1 Aug 2015 10:55:27 +0000</updated>
                            <resolved>Wed, 29 Jul 2015 22:31:18 +0000</resolved>
                                    <version>0.9.3</version>
                                    <fixVersion>0.9.3</fixVersion>
                                    <component>C glib - Compiler</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="14644464" author="githubbot" created="Tue, 28 Jul 2015 14:44:14 +0000"  >&lt;p&gt;Github user simonsouth closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/567&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/567&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14644472" author="githubbot" created="Tue, 28 Jul 2015 14:48:36 +0000"  >&lt;p&gt;GitHub user simonsouth opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/568&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/568&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    c_glib: Compiler: Do not try to convert between function, void pointers&lt;/p&gt;

&lt;p&gt;    This patch corrects &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-3273&quot; title=&quot;c_glib: Generated code tries to convert between function and void pointers&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-3273&quot;&gt;&lt;del&gt;THRIFT-3273&lt;/del&gt;&lt;/a&gt; by introducing the notion of a &quot;processing-function definition&quot;, a structure that associates the name of a service method with the processing function that processes invocations of it. This places the function&apos;s pointer within a data object, which can then safely be added to the process_map hash table.&lt;/p&gt;

&lt;p&gt;    Defining an array of processing-function definitions for each processor also allows its instance initializer to be simplified as the process_map table can now be loaded with just a loop.&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/simonsouth/thrift&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/simonsouth/thrift&lt;/a&gt; thrift-3273-c_glib-generated-code-tries-to-convert-function-void-pointers&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/568.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/568.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #568&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 84353197a98a3fa3e64529f10e975e86b51a84ec&lt;br/&gt;
Author: Simon South &amp;lt;ssouth@simonsouth.com&amp;gt;&lt;br/&gt;
Date:   2015-07-28T14:12:26Z&lt;/p&gt;

&lt;p&gt;    c_glib: Compiler: Do not try to convert between function, void pointers&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="14645042" author="jensg" created="Tue, 28 Jul 2015 21:05:50 +0000"  >&lt;p&gt;While revieweing the changes in the compiler code I found some funny constants in the code (they already existed before):&lt;/p&gt;

&lt;p&gt;@line 1972: the number &lt;tt&gt;23&lt;/tt&gt; is added to some string length - Illuminati, anyone?&lt;br/&gt;
@line 2386 args_indent = indent() + string(53, &apos; &apos;); - why &lt;tt&gt;53&lt;/tt&gt; and not &lt;tt&gt;42&lt;/tt&gt;?&lt;/p&gt;

&lt;p&gt;Maybe these numbers should be given some descriptive names on occasion. &lt;/p&gt;</comment>
                            <comment id="14645090" author="jensg" created="Tue, 28 Jul 2015 21:40:00 +0000"  >&lt;p&gt;I get this with the tutorial (just the first thing I tried)&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;gen-c_glib/calculator.c: In function &lt;span class=&quot;code-quote&quot;&gt;&apos;calculator_processor_init&apos;&lt;/span&gt;:
gen-c_glib/calculator.c:1280:3: error: &lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt;&apos;&lt;/span&gt; loop initial declarations are only allowed in C99 mode
   &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (guint index = 0; index &amp;lt; 4; index += 1)
   ^
gen-c_glib/calculator.c:1280:3: note: use option -std=c99 or -std=gnu99 to compile your code
Makefile:613: recipe &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; target &lt;span class=&quot;code-quote&quot;&gt;&apos;gen-c_glib/calculator.lo&apos;&lt;/span&gt; failed
make[1]: *** [gen-c_glib/calculator.lo] Error 1
make[1]: Leaving directory &lt;span class=&quot;code-quote&quot;&gt;&apos;/home/jens/Arbeitsfl&#228;che/Thrift/tutorial/c_glib&apos;&lt;/span&gt;
Makefile:501: recipe &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; target &lt;span class=&quot;code-quote&quot;&gt;&apos;all&apos;&lt;/span&gt; failed
make: *** [all] Error 2
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14645098" author="simonsouth" created="Tue, 28 Jul 2015 21:45:48 +0000"  >&lt;p&gt;Bah. I specifically checked for this. Why is C99 mode enabled for me and not for you? (Does the project actually specify anywhere what language standards are assumed?)&lt;/p&gt;

&lt;p&gt;I&apos;ll change this back and... update the pull request or create a new one, whichever Github allows.&lt;/p&gt;</comment>
                            <comment id="14645100" author="simonsouth" created="Tue, 28 Jul 2015 21:48:32 +0000"  >&lt;p&gt;Noted. These numbers (which I admit seem a bit magical) represent the number of spaces to offset a line of code, which is determined by the line of code output immediately before it. This is so things like vertical lists of function parameters are lined up correctly.&lt;/p&gt;

&lt;p&gt;I&apos;ll think about how I can make this clearer (without adding calls to &lt;tt&gt;strlen&lt;/tt&gt;).&lt;/p&gt;</comment>
                            <comment id="14645111" author="jensg" created="Tue, 28 Jul 2015 22:00:01 +0000"  >&lt;p&gt;You can update the branch and push. It will even trigger another Travis build.&lt;/p&gt;

&lt;p&gt;Re c99 mode: I only call &lt;tt&gt;make &amp;amp;&amp;amp; make check&lt;/tt&gt; - nothing special. The only non-standard thing I use is a manually built boost library. And it is a 32 bit system.&lt;/p&gt;

</comment>
                            <comment id="14646071" author="simonsouth" created="Wed, 29 Jul 2015 14:05:09 +0000"  >&lt;p&gt;I&apos;ve updated the branch and this should compile for you now.&lt;/p&gt;</comment>
                            <comment id="14646820" author="githubbot" created="Wed, 29 Jul 2015 22:03:24 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/568&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/568&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14646862" author="jensg" created="Wed, 29 Jul 2015 22:31:18 +0000"  >&lt;p&gt;Committed, many thanks.&lt;/p&gt;</comment>
                            <comment id="14646883" author="hudson" created="Wed, 29 Jul 2015 22:51:44 +0000"  >&lt;p&gt;SUCCESS: Integrated in Thrift #1627 (See &lt;a href=&quot;https://builds.apache.org/job/Thrift/1627/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Thrift/1627/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-3273&quot; title=&quot;c_glib: Generated code tries to convert between function and void pointers&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-3273&quot;&gt;&lt;del&gt;THRIFT-3273&lt;/del&gt;&lt;/a&gt; c_glib: Generated code tries to convert between function and void pointers (jensg: rev 46ab187bb5d42e18b0112af9184f71cb896e9f2f)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;compiler/cpp/src/generate/t_c_glib_generator.cc&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12850764">THRIFT-3284</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                                                <inwardlinks description="is depended upon by">
                                        <issuelink>
            <issuekey id="12848731">THRIFT-3260</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310250" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10430"><![CDATA[Patch]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 16 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310041" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Patch Info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10042"><![CDATA[Patch Available]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2i0q7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>