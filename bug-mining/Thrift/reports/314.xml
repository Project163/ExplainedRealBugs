<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 07:58:26 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[THRIFT-544] multiple enums with the same key generate invalid code</title>
                <link>https://issues.apache.org/jira/browse/THRIFT-544</link>
                <project id="12310800" key="THRIFT">Thrift</project>
                    <description>&lt;p&gt;The current generator produces multiple -define statements with the same name, which isn&apos;t valid erlang code (and also isn&apos;t valid semantically if we want two different values).&lt;/p&gt;


&lt;div class=&quot;code panel&quot; style=&quot;border-style: solid;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;border-bottom-style: solid;&quot;&gt;&lt;b&gt;EnumTest.thrift&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;enum&lt;/span&gt; MyType1 {
  A = 0,
  B = 1
}

&lt;span class=&quot;code-keyword&quot;&gt;enum&lt;/span&gt; MyType2 {
  A = 2,
  C = 4
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;produces:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-style: solid;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;border-bottom-style: solid;&quot;&gt;&lt;b&gt;enumTest_types.hrl&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;-ifndef(_enumTest_types_included).
-define(_enumTest_types_included, yeah).

-define(enumTest_A, 0).
-define(enumTest_B, 1).

-define(enumTest_A, 2).
-define(enumTest_C, 4).

-endif.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;In the patched version, it produces this:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-style: solid;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;border-bottom-style: solid;&quot;&gt;&lt;b&gt;enumTest_types.hrl&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;-ifndef(_enumTest_types_included).
-define(_enumTest_types_included, yeah).

-define(enumTest_MyType1_A, 0).
-define(enumTest_MyType1_B, 1).

-define(enumTest_MyType2_A, 2).
-define(enumTest_MyType2_C, 4).

-endif.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12431030">THRIFT-544</key>
            <summary>multiple enums with the same key generate invalid code</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="coshx">Ben Taitelbaum</assignee>
                                    <reporter username="coshx">Ben Taitelbaum</reporter>
                        <labels>
                    </labels>
                <created>Tue, 21 Jul 2009 15:00:39 +0000</created>
                <updated>Fri, 10 Sep 2010 17:04:55 +0000</updated>
                            <resolved>Thu, 5 Aug 2010 23:24:18 +0000</resolved>
                                    <version>0.2</version>
                                    <fixVersion>0.4</fixVersion>
                                    <component>Compiler (General)</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="12733653" author="coshx" created="Tue, 21 Jul 2009 15:02:43 +0000"  >&lt;p&gt;This fixes the issue, although it does change the names defined, so it may break existing code, but I can&apos;t see any other way around this.&lt;/p&gt;</comment>
                            <comment id="12733734" author="dreiss" created="Tue, 21 Jul 2009 17:29:55 +0000"  >&lt;p&gt;This is an error in C as well, which is what Thrift&apos;s enums are based on.  So I think the real solution is to throw an error at code generation time.&lt;/p&gt;</comment>
                            <comment id="12733749" author="tlipcon" created="Tue, 21 Jul 2009 17:53:15 +0000"  >&lt;p&gt;I agree with David here - the breaking of backwards compatibility seems like too much to me to be worth it.&lt;/p&gt;

&lt;p&gt;On the other hand, I might support a patch which changes enum generation in erlang to use atoms like &apos;A&apos; and &apos;B&apos; instead of -defines at all. It&apos;s more erlangy - the bindings use -defines here for historical reasons. Since I&apos;m no longer an active user of the bindings, though, I&apos;ll defer to Eugene, Chris, and David (or anyone else who uses them and wants to pipe up) for whether they think that&apos;s a good idea.&lt;/p&gt;</comment>
                            <comment id="12739899" author="coshx" created="Thu, 6 Aug 2009 05:11:39 +0000"  >&lt;p&gt;Here&apos;s a really simple patch that prevents multiple constants with the same name.&lt;/p&gt;</comment>
                            <comment id="12740150" author="bryanduxbury" created="Thu, 6 Aug 2009 16:55:32 +0000"  >&lt;p&gt;I didn&apos;t try it out, but its very simple and looks good to me. +1&lt;/p&gt;</comment>
                            <comment id="12740160" author="dreiss" created="Thu, 6 Aug 2009 17:24:53 +0000"  >&lt;p&gt;I think the patch is correct, but the argument for correctness is very complicated because constants_&lt;span class=&quot;error&quot;&gt;&amp;#91;name&amp;#93;&lt;/span&gt; is a mutating operation that creates an entry if the &quot;name&quot; key is not present.  I&apos;d much prefer the condition be &quot;constants_.find(name) != constants.end()&quot;&lt;/p&gt;</comment>
                            <comment id="12895872" author="bryanduxbury" created="Thu, 5 Aug 2010 23:24:18 +0000"  >&lt;p&gt;I made the change that David suggested and committed this.&lt;/p&gt;</comment>
                            <comment id="12908092" author="dreiss" created="Fri, 10 Sep 2010 17:04:55 +0000"  >&lt;p&gt;This was committed as r982825.  It doesn&apos;t show up in the &quot;all&quot; tab because it was committed with a tag of &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-554&quot; title=&quot;Perl improper namespace check for exception handling and writeMessageEnd missing on processor calls&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-554&quot;&gt;&lt;del&gt;THRIFT-554&lt;/del&gt;&lt;/a&gt;&quot;.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12414107" name="thrift-544_add_enum_name_to_enum_keys.patch" size="608" author="coshx" created="Tue, 21 Jul 2009 15:02:43 +0000"/>
                            <attachment id="12415696" name="thrift-544_prevent_redefining_consts.patch" size="534" author="coshx" created="Thu, 6 Aug 2009 05:11:39 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>186724</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 years, 11 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310041" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Patch Info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10042"><![CDATA[Patch Available]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i16dtz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>245373</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>