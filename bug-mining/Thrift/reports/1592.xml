<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 08:24:06 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[THRIFT-3778] go client can not pass method parameter to server of other language if no field_id is given</title>
                <link>https://issues.apache.org/jira/browse/THRIFT-3778</link>
                <project id="12310800" key="THRIFT">Thrift</project>
                    <description>&lt;p&gt;go client can not pass method parameter to java server&lt;/p&gt;

&lt;p&gt;for example message.thrift&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-style: solid;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;border-bottom-style: solid;&quot;&gt;&lt;b&gt;message.thrift&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;namespace java test
namespace csharp test
namespace go test
struct Message
{
    1: string text
}
service MessageProcessor {
    void process(Message message);
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;We generated messageprocess.go as golang client and MessageProcessor.java as java server&lt;br/&gt;
When go client send service method arguments &quot;process_args&quot;, 1 is sent as the field_id of struct &quot;message&quot;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-style: solid;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;border-bottom-style: solid;&quot;&gt;&lt;b&gt;messageprocessor.go&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;func (p *MessageProcessorProcessArgs) Write(oprot thrift.TProtocol) error {
  &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; err := oprot.WriteStructBegin(&lt;span class=&quot;code-quote&quot;&gt;&quot;process_args&quot;&lt;/span&gt;); err != nil {
    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; thrift.PrependError(fmt.Sprintf(&lt;span class=&quot;code-quote&quot;&gt;&quot;%T write struct begin error: &quot;&lt;/span&gt;, p), err)
  }
  &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; err := p.writeField_1(oprot); err != nil {
    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; err
  }
  ...
}

func (p *MessageProcessorProcessArgs) writeField_1(oprot thrift.TProtocol) (err error) {
  &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; err := oprot.WriteFieldBegin(&lt;span class=&quot;code-quote&quot;&gt;&quot;message&quot;&lt;/span&gt;, thrift.STRUCT, 1); err != nil {
    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; thrift.PrependError(fmt.Sprintf(&lt;span class=&quot;code-quote&quot;&gt;&quot;%T write field begin error 1:message: &quot;&lt;/span&gt;, p), err)
  }
  ...
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;When java server try to receive service method arguments &quot;process_args&quot;, -1 is marked as the field_id of struct &quot;message&quot;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-style: solid;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;border-bottom-style: solid;&quot;&gt;&lt;b&gt;MessageProcessor.java&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;  &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;process_argsStandardScheme &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; StandardScheme&amp;lt;process_args&amp;gt; {
  ...
  iprot.readStructBegin();
  &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; (&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;)
  {
    schemeField = iprot.readFieldBegin();
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (schemeField.type == org.apache.thrift.protocol.TType.STOP) { 
      &lt;span class=&quot;code-keyword&quot;&gt;break&lt;/span&gt;;
    }
    &lt;span class=&quot;code-keyword&quot;&gt;switch&lt;/span&gt; (schemeField.id) {
      &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt; -1: &lt;span class=&quot;code-comment&quot;&gt;// MESSAGE
&lt;/span&gt;      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (schemeField.type == org.apache.thrift.protocol.TType.STRUCT) {
        struct.message = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Message();
        struct.message.read(iprot);
        struct.setMessageIsSet(&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;);
      } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; { 
        org.apache.thrift.protocol.TProtocolUtil.skip(iprot, schemeField.type);
      }
      &lt;span class=&quot;code-keyword&quot;&gt;break&lt;/span&gt;;
      &lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;:
        org.apache.thrift.protocol.TProtocolUtil.skip(iprot, schemeField.type);
    }
    iprot.readFieldEnd();
  }
  iprot.readStructEnd();
  ...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Because of this, we always receive NULL &quot;message&quot; in java server.&lt;br/&gt;
Compared to some other language implementation, I think it&apos;s a thrift go generator problem.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12956083">THRIFT-3778</key>
            <summary>go client can not pass method parameter to server of other language if no field_id is given</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ggndnn">Guo</assignee>
                                    <reporter username="ggndnn">Guo</reporter>
                        <labels>
                    </labels>
                <created>Tue, 5 Apr 2016 07:43:52 +0000</created>
                <updated>Fri, 22 Apr 2016 19:51:00 +0000</updated>
                            <resolved>Tue, 5 Apr 2016 23:09:30 +0000</resolved>
                                    <version>0.9.3</version>
                                    <fixVersion>0.11.0</fixVersion>
                                    <component>Go - Compiler</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="15225858" author="githubbot" created="Tue, 5 Apr 2016 08:06:39 +0000"  >&lt;p&gt;GitHub user ggndnn opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/978&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/978&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-3778&quot; title=&quot;go client can not pass method parameter to server of other language if no field_id is given&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-3778&quot;&gt;&lt;del&gt;THRIFT-3778&lt;/del&gt;&lt;/a&gt; go client can not pass method parameter to server&lt;/p&gt;



&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/ggndnn/thrift&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/ggndnn/thrift&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-3778&quot; title=&quot;go client can not pass method parameter to server of other language if no field_id is given&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-3778&quot;&gt;&lt;del&gt;THRIFT-3778&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/978.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/978.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #978&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit e3921fb22fe395470ce69ec7ae115822a7bf5e00&lt;br/&gt;
Author: guo &amp;lt;ggndnn@163.com&amp;gt;&lt;br/&gt;
Date:   2016-04-05T07:48:25Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-3778&quot; title=&quot;go client can not pass method parameter to server of other language if no field_id is given&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-3778&quot;&gt;&lt;del&gt;THRIFT-3778&lt;/del&gt;&lt;/a&gt; go client can not pass method parameter to server of other language&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15227278" author="jensg" created="Tue, 5 Apr 2016 22:35:22 +0000"  >&lt;p&gt;The first thing I see is this:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;$ thrift -gen go -gen csharp test.thrift
[WARNING:test.thrift:9] No field key specified &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; message, resulting protocol may have conflicts or not be backwards compatible!
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Recommended fix:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;service MessageProcessor {
    void process(1: Message message);  &lt;span class=&quot;code-comment&quot;&gt;// added 1 (field ID)
&lt;/span&gt;}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="15227312" author="githubbot" created="Tue, 5 Apr 2016 23:00:35 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/978&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/978&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15227525" author="ggndnn" created="Wed, 6 Apr 2016 01:32:38 +0000"  >&lt;p&gt;I get it, thanks&lt;/p&gt;</comment>
                            <comment id="15240937" author="hudson" created="Thu, 14 Apr 2016 10:27:46 +0000"  >&lt;p&gt;FAILURE: Integrated in Thrift-precommit #408 (See &lt;a href=&quot;https://builds.apache.org/job/Thrift-precommit/408/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Thrift-precommit/408/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-3778&quot; title=&quot;go client can not pass method parameter to server of other language if no field_id is given&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-3778&quot;&gt;&lt;del&gt;THRIFT-3778&lt;/del&gt;&lt;/a&gt; go client can not pass method parameter to server of other (jensg: &lt;a href=&quot;https://github.com/apache/thrift/commit/717334816de896acc5dac3f787d64b52e033b38f&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/commit/717334816de896acc5dac3f787d64b52e033b38f&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;compiler/cpp/src/generate/t_go_generator.cc&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 31 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2vnfj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>