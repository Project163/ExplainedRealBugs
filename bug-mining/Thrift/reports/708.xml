<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 08:07:49 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[THRIFT-1846] Restore socket.h header to support builds with Android NDK</title>
                <link>https://issues.apache.org/jira/browse/THRIFT-1846</link>
                <project id="12310800" key="THRIFT">Thrift</project>
                    <description>&lt;p&gt;Unlike every other rational un.h that I&apos;ve seen, the sys/un.h (actually linux/un.h) distributed with the Android NDK doesn&apos;t define sa_family_t or include another header that does. Removal of socket.h in &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-1740&quot; title=&quot;Make C++ library build on OS X and iOS&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-1740&quot;&gt;&lt;del&gt;THRIFT-1740&lt;/del&gt;&lt;/a&gt; broke the Android build.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Building with Android Linux NDK R8D (and, it looks like, all previous NDKs)&lt;/p&gt;</environment>
        <key id="12629721">THRIFT-1846</key>
            <summary>Restore socket.h header to support builds with Android NDK</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="nicolastr">Nicolas Tr&#233;segnie</assignee>
                                    <reporter username="nater">Nate Rosenblum</reporter>
                        <labels>
                    </labels>
                <created>Tue, 29 Jan 2013 16:34:43 +0000</created>
                <updated>Sat, 20 Feb 2021 15:26:50 +0000</updated>
                            <resolved>Sat, 8 Jun 2013 03:15:46 +0000</resolved>
                                    <version>0.9</version>
                                    <fixVersion>0.9.1</fixVersion>
                                    <component>C++ - Library</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="13565504" author="ben.craig" created="Tue, 29 Jan 2013 16:40:12 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-1740&quot; title=&quot;Make C++ library build on OS X and iOS&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-1740&quot;&gt;&lt;del&gt;THRIFT-1740&lt;/del&gt;&lt;/a&gt; moved the #include from the .cpp to the .h.  Why isn&apos;t TSocket.h&apos;s inclusion of sys/socket.h not working for you?&lt;/p&gt;

&lt;p&gt;Also, sorry about my patch for &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-1740&quot; title=&quot;Make C++ library build on OS X and iOS&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-1740&quot;&gt;&lt;del&gt;THRIFT-1740&lt;/del&gt;&lt;/a&gt; causing you so many problems.  Seems that no matter how many platforms I build for, some other OS does things in a different strange way.&lt;/p&gt;</comment>
                            <comment id="13565525" author="nater" created="Tue, 29 Jan 2013 16:58:50 +0000"  >&lt;p&gt;Well, I build on OSX &amp;amp; IOS as well, so all in all THRIFT 1740 is a net positive &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;I did not look carefully at the changes involving socket.h in that patch, sorry. The .cpp file includes Android&apos;s weird un.h before pulling in TSocket.h, which is why the build is broken. If you want, I can push a new patch that moves un.h into the header. LMK&lt;/p&gt;</comment>
                            <comment id="13565529" author="ben.craig" created="Tue, 29 Jan 2013 17:06:42 +0000"  >&lt;p&gt;The original patch is fine.  I foolishly assumed that TSocket.cpp included TSocket.h very early in the file, as opposed to being one of the last #includes.&lt;/p&gt;

&lt;p&gt;If you were going to try an alternative patch, I would try moving the #include &quot;TSocket.h&quot; so that it immediately follows the #include &amp;lt;config.h&amp;gt;&lt;/p&gt;</comment>
                            <comment id="13576236" author="nicolastr" created="Tue, 12 Feb 2013 00:13:41 +0000"  >&lt;p&gt;In the Android NDK, there is a missing include in un.h, that&apos;s why &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=nater&quot; class=&quot;user-hover&quot; rel=&quot;nater&quot;&gt;nater&lt;/a&gt; got an error. Before &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-1740&quot; title=&quot;Make C++ library build on OS X and iOS&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-1740&quot;&gt;&lt;del&gt;THRIFT-1740&lt;/del&gt;&lt;/a&gt;, socket.h was included before un.h as a workaround (or maybe juste by chance).&lt;/p&gt;

&lt;p&gt;The socket.h should be re-added to the .cpp and also removed from the .h to avoid hidden dependencies. If it&apos;s a problem when building for iOS, whe should discuss it.&lt;/p&gt;</comment>
                            <comment id="13576247" author="nicolastr" created="Tue, 12 Feb 2013 00:26:29 +0000"  >&lt;p&gt;Patch proposed: socket-include-moved-back-to-cpp.patch&lt;/p&gt;

&lt;p&gt;This patch move the &amp;lt;sys/socket.h&amp;gt; include from TSocket.h to the .cpp to minimize the risk of hidden dependencies.&lt;/p&gt;

&lt;p&gt;In the .cpp, the include is placed before the &amp;lt;sys/un.h&amp;gt; include to allow thrift to compile with the Android NDK&lt;/p&gt;</comment>
                            <comment id="13576342" author="ben.craig" created="Tue, 12 Feb 2013 03:20:41 +0000"  >&lt;p&gt;Just make sure that sockaddr, sockaddr_in, sockaddr_in6, addrinfo, timespec, and timeval all have their appropriate headers included on all platforms.  You don&apos;t want to force other clients to include headers in a specific order.&lt;/p&gt;</comment>
                            <comment id="13617948" author="jfarrell" created="Sat, 30 Mar 2013 01:35:40 +0000"  >&lt;p&gt;Nate, did you get a chance to test the patch and verify that it does not introduce new issues as you saw with &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-1740&quot; title=&quot;Make C++ library build on OS X and iOS&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-1740&quot;&gt;&lt;del&gt;THRIFT-1740&lt;/del&gt;&lt;/a&gt; ?&lt;/p&gt;</comment>
                            <comment id="13618999" author="nater" created="Mon, 1 Apr 2013 18:16:21 +0000"  >&lt;p&gt;Jake, seems like clang builds happily against the new patch. Ship it!&lt;/p&gt;</comment>
                            <comment id="13619414" author="jfarrell" created="Tue, 2 Apr 2013 01:40:54 +0000"  >&lt;p&gt;Committed, thanks for the patch&lt;/p&gt;</comment>
                            <comment id="13620451" author="hudson" created="Wed, 3 Apr 2013 00:40:03 +0000"  >&lt;p&gt;Integrated in Thrift #641 (See &lt;a href=&quot;https://builds.apache.org/job/Thrift/641/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Thrift/641/&lt;/a&gt;)&lt;br/&gt;
    Thrift-1846:Restore socket.h header to support builds with Android NDK (Revision c613cd2d9bc01ee4eb43a3d40a8691c736f7a316)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;/p&gt;</comment>
                            <comment id="13641172" author="bmorishita" created="Wed, 24 Apr 2013 23:35:59 +0000"  >&lt;p&gt;Thanks for the patch.&lt;/p&gt;

&lt;p&gt;For reference, I discovered that this issue will be fixed on the android side as described here:&lt;br/&gt;
&lt;a href=&quot;https://android-review.googlesource.com/#/c/55031/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://android-review.googlesource.com/#/c/55031/&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;https://android-review.googlesource.com/#/c/55031/2/ndk/platforms/android-3/include/sys/un.h&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://android-review.googlesource.com/#/c/55031/2/ndk/platforms/android-3/include/sys/un.h&lt;/a&gt; &lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12633806">THRIFT-1865</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12566997" name="0001-Restore-socket.h-include-to-support-Android-builds.patch" size="981" author="nater" created="Tue, 29 Jan 2013 16:35:15 +0000"/>
                            <attachment id="12568909" name="socket-include-moved-back-to-cpp.patch" size="799" author="nicolastr" created="Tue, 12 Feb 2013 00:26:29 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>310217</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 30 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310041" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Patch Info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10042"><![CDATA[Patch Available]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1hjd3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>310562</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>