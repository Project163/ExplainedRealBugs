<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 08:32:17 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[THRIFT-5172] NetStd TBaseClient open output transport multiple times</title>
                <link>https://issues.apache.org/jira/browse/THRIFT-5172</link>
                <project id="12310800" key="THRIFT">Thrift</project>
                    <description>&lt;p&gt;When I have some network issues to connect to my Thrift server, it tries many attempts to connect to it. &lt;del&gt;After a while, I get a &quot;OutOfMemory&quot; Exception. EDIT: unrelated to this issue.&lt;/del&gt;&lt;/p&gt;

&lt;p&gt;I read that it may be related to too many sockets opened.&lt;/p&gt;

&lt;p&gt;Looking quickly at the code in .NET Standard:&lt;/p&gt;

&lt;p&gt;TBaseClient&lt;/p&gt;

&lt;p&gt;public virtual async Task OpenTransportAsync(CancellationToken cancellationToken)&lt;br/&gt;
 {&lt;br/&gt;
 if (!_inputProtocol.Transport.IsOpen)&lt;/p&gt;

{ await _inputProtocol.Transport.OpenAsync(cancellationToken); }

&lt;p&gt;if (!&lt;b&gt;_inputProtocol&lt;/b&gt;.Transport.IsOpen)&lt;/p&gt;

{ await _outputProtocol.Transport.OpenAsync(cancellationToken); }

&lt;p&gt;}&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;This last check seems a bad copy/paste and should probably be&lt;/p&gt;

&lt;p&gt;if (!&lt;b&gt;_outputProtocol&lt;/b&gt;.Transport.IsOpen)&lt;/p&gt;

&lt;p&gt;Otherwise, we indeed get the transport on the output protocol getting opened many times!&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;I just proposed a pull request with the fix.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13297090">THRIFT-5172</key>
            <summary>NetStd TBaseClient open output transport multiple times</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="EricBl">Eric Bl&#233;her</assignee>
                                    <reporter username="EricBl">Eric Bl&#233;her</reporter>
                        <labels>
                            <label>patch</label>
                    </labels>
                <created>Wed, 8 Apr 2020 13:47:07 +0000</created>
                <updated>Thu, 11 Feb 2021 22:26:03 +0000</updated>
                            <resolved>Thu, 9 Apr 2020 19:25:44 +0000</resolved>
                                    <version>0.13.0</version>
                                    <fixVersion>0.14.0</fixVersion>
                                    <component>netstd - Library</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                    <workratio workratioPercent="0"/>
                                    <progress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                    <timeoriginalestimate seconds="300">5m</timeoriginalestimate>
                            <timeestimate seconds="300">5m</timeestimate>
                                        <comments>
                            <comment id="17079006" author="jensg" created="Thu, 9 Apr 2020 07:23:09 +0000"  >&lt;p&gt;A transport should not be able to be opened multiple times (unless Open() does really nothing), we even have a nice exception code for this. &lt;/p&gt;

&lt;p&gt;Maybe there&apos;s a check missing?&lt;/p&gt;

&lt;p&gt;In case of OOMs it could also be some IDisposable class not being disposed properly.&lt;/p&gt;

&lt;p&gt;Oh, and we accept pull requests &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="17079110" author="ericbl" created="Thu, 9 Apr 2020 09:39:49 +0000"  >&lt;p&gt;Looking further in some TTransport implementations, the Open implementation prevents to be called twice:&lt;/p&gt;

&lt;p&gt;if&#160;(IsOpen)&#160; &#160; &#160; &#160; &#160; { &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;throw&#160;new&#160;TTransportException(TTransportException.ExceptionType.AlreadyOpen,&#160;&quot;Socket&#160;already&#160;connected&quot;); &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;}&lt;/p&gt;

&lt;p&gt;so the&#160;wrong code in TBaseClient should come here, and is probably not related to the OutOfMemory Exception I got.&lt;/p&gt;

&lt;p&gt;But anyway, the proposed pull request is still valid, even if without consequences.&lt;/p&gt;</comment>
                            <comment id="17079959" author="jensg" created="Thu, 9 Apr 2020 19:26:11 +0000"  >&lt;p&gt;Good catch!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310250" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10430"><![CDATA[Patch]]></customfieldvalue>
    <customfieldvalue key="10431"><![CDATA[Important]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 31 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310041" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Patch Info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10042"><![CDATA[Patch Available]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0deu0:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>