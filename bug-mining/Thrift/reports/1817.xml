<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 08:27:41 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[THRIFT-4331] C++: TSSLSockets bug in handling huge messages, bug in handling polling</title>
                <link>https://issues.apache.org/jira/browse/THRIFT-4331</link>
                <project id="12310800" key="THRIFT">Thrift</project>
                    <description>&lt;p&gt;The TSSLSocket class did not handle large messages, because a underlying TCP socket may signal bytes received, while SSL_read() may not have bytes available. After maxretries (5) the function returned -1, which got interpreted as unsigned integer for read bytes.&lt;/p&gt;

&lt;p&gt;Futher the waitForEvent methode, did only set THRIFT_POLLIN or THRIFT_POLLOUT, but it gets used where SSL needs to send AND receive bytes for some operations (like close). So in the case of write wanted, THRIFT_POLLIN is also set to cover these read/write operations.&lt;/p&gt;

&lt;p&gt;Pullrequest for master and 0.10.0 branch will follow.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13102528">THRIFT-4331</key>
            <summary>C++: TSSLSockets bug in handling huge messages, bug in handling polling</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jking3">James E. King III</assignee>
                                    <reporter username="martinhaimberger">Martin Haimberger</reporter>
                        <labels>
                    </labels>
                <created>Fri, 15 Sep 2017 11:02:15 +0000</created>
                <updated>Tue, 18 Dec 2018 16:24:03 +0000</updated>
                            <resolved>Fri, 6 Oct 2017 12:23:56 +0000</resolved>
                                    <version>0.10.0</version>
                                    <fixVersion>0.11.0</fixVersion>
                                    <component>C++ - Library</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="16167719" author="martinhaimberger" created="Fri, 15 Sep 2017 11:11:01 +0000"  >&lt;p&gt;patches for master and 0.10.0&lt;/p&gt;</comment>
                            <comment id="16167724" author="githubbot" created="Fri, 15 Sep 2017 11:16:40 +0000"  >&lt;p&gt;GitHub user MartinHaimberger opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/1363&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/1363&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-4331&quot; title=&quot;C++: TSSLSockets bug in handling huge messages, bug in handling polling&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-4331&quot;&gt;&lt;del&gt;THRIFT-4331&lt;/del&gt;&lt;/a&gt; - C++: TSSLSocket fixes&lt;/p&gt;

&lt;p&gt;    fixed issue with large messages, where waitForEvent was called&lt;br/&gt;
    mutliple times waiting for SSL_read() to get bytes and running&lt;br/&gt;
    in the retry timeout.&lt;/p&gt;

&lt;p&gt;    fixed issue where poll was not using the right flags.&lt;/p&gt;

&lt;p&gt;    Fixes issue &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-4331&quot; title=&quot;C++: TSSLSockets bug in handling huge messages, bug in handling polling&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-4331&quot;&gt;&lt;del&gt;THRIFT-4331&lt;/del&gt;&lt;/a&gt; on master.&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/MartinHaimberger/thrift&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/MartinHaimberger/thrift&lt;/a&gt; master&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/1363.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/1363.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #1363&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 3e6e271dedbbb46f1a45f5e5d0b56bddf1589764&lt;br/&gt;
Author: Martin Haimberger &amp;lt;martin.haimberger@thincast.com&amp;gt;&lt;br/&gt;
Date:   2017-09-15T11:03:27Z&lt;/p&gt;

&lt;p&gt;    C++: TSSLSocket fixes&lt;/p&gt;

&lt;p&gt;    fixed issue with large messages, where waitForEvent was called&lt;br/&gt;
    mutliple times waiting for SSL_read() to get bytes and running&lt;br/&gt;
    in the retry timeout.&lt;/p&gt;

&lt;p&gt;    fixed issue where poll was not using the right flags.&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="16168275" author="githubbot" created="Fri, 15 Sep 2017 18:04:59 +0000"  >&lt;p&gt;Github user jeking3 commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/1363#discussion_r139214105&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/1363#discussion_r139214105&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: lib/cpp/src/thrift/transport/TSSLSocket.cpp &amp;#8212;&lt;br/&gt;
    @@ -759,7 +775,9 @@ unsigned int TSSLSocket::waitForEvent(bool wantRead) {&lt;br/&gt;
       struct THRIFT_POLLFD fds&lt;span class=&quot;error&quot;&gt;&amp;#91;2&amp;#93;&lt;/span&gt;;&lt;br/&gt;
       memset(fds, 0, sizeof(fds));&lt;br/&gt;
       fds&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;.fd = fdSocket;&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;fds&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;.events = wantRead ? THRIFT_POLLIN : THRIFT_POLLOUT;&lt;br/&gt;
    +  // use POLLIN also on write operations too, this is needed for operations&lt;br/&gt;
    +  // which requires read and write on the socket.
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    Interesting, what&apos;s an example of this?&lt;/p&gt;</comment>
                            <comment id="16168276" author="githubbot" created="Fri, 15 Sep 2017 18:05:47 +0000"  >&lt;p&gt;Github user jeking3 commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/1362&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/1362&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    We don&apos;t retroactively fix branches; the community might be interested in this but as a pull request it won&apos;t be merged.  @jfarrell this can be closed.&lt;/p&gt;</comment>
                            <comment id="16169312" author="githubbot" created="Sun, 17 Sep 2017 14:16:34 +0000"  >&lt;p&gt;Github user MartinHaimberger commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/1363#discussion_r139311583&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/1363#discussion_r139311583&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: lib/cpp/src/thrift/transport/TSSLSocket.cpp &amp;#8212;&lt;br/&gt;
    @@ -759,7 +775,9 @@ unsigned int TSSLSocket::waitForEvent(bool wantRead) {&lt;br/&gt;
       struct THRIFT_POLLFD fds&lt;span class=&quot;error&quot;&gt;&amp;#91;2&amp;#93;&lt;/span&gt;;&lt;br/&gt;
       memset(fds, 0, sizeof(fds));&lt;br/&gt;
       fds&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;.fd = fdSocket;&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;fds&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;.events = wantRead ? THRIFT_POLLIN : THRIFT_POLLOUT;&lt;br/&gt;
    +  // use POLLIN also on write operations too, this is needed for operations&lt;br/&gt;
    +  // which requires read and write on the socket.
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    hi jeking3,&lt;/p&gt;

&lt;p&gt;    the comment may not be perfect, but SSL operations, like SSL_connect or SSL_shutdown (where this function is also used) need to perform write and read operations on the socket and we dont know where we are so we need to listen on both socket events.&lt;/p&gt;

&lt;p&gt;    I could also introduce a new function parameter for that.&lt;/p&gt;</comment>
                            <comment id="16169711" author="githubbot" created="Mon, 18 Sep 2017 07:52:16 +0000"  >&lt;p&gt;Github user MartinHaimberger closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/1362&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/1362&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16174832" author="githubbot" created="Thu, 21 Sep 2017 14:17:41 +0000"  >&lt;p&gt;Github user jeking3 commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/1363&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/1363&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    If you could do me a favor and rebase on the current master, I finally got all the CI build issues resolved so I&apos;d like to see a clean build before I merge.  There are some minor formatting (indentation) issues as well.&lt;/p&gt;</comment>
                            <comment id="16183521" author="jking3" created="Thu, 28 Sep 2017 01:03:12 +0000"  >&lt;p&gt;If you could do me a favor and rebase on the current master, I finally got all the CI build issues resolved so I&apos;d like to see a clean build before I merge. There are some minor formatting (indentation) issues as well.&lt;/p&gt;</comment>
                            <comment id="16186540" author="githubbot" created="Fri, 29 Sep 2017 21:45:08 +0000"  >&lt;p&gt;Github user jeking3 commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/1363&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/1363&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @MartinHaimberger If you could do me a favor and rebase on the current master, I finally got all the CI build issues resolved so I&apos;d like to see a clean build before I merge. There are some minor formatting (indentation) issues as well.&lt;/p&gt;</comment>
                            <comment id="16194269" author="githubbot" created="Fri, 6 Oct 2017 08:00:30 +0000"  >&lt;p&gt;Github user MartinHaimberger commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/1363&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/1363&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    rebased and indentations should be fixed&lt;/p&gt;</comment>
                            <comment id="16194528" author="jking3" created="Fri, 6 Oct 2017 12:23:56 +0000"  >&lt;p&gt;Committed - thanks.&lt;/p&gt;</comment>
                            <comment id="16194529" author="githubbot" created="Fri, 6 Oct 2017 12:24:12 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/1363&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/1363&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="13110955">THRIFT-4366</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12887317" name="0.10.0-THRIFT-4331.patch" size="5084" author="martinhaimberger" created="Fri, 15 Sep 2017 11:10:45 +0000"/>
                            <attachment id="12887318" name="master-THRIFT-4331.patch" size="4787" author="martinhaimberger" created="Fri, 15 Sep 2017 11:10:45 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310250" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10430"><![CDATA[Patch]]></customfieldvalue>
    <customfieldvalue key="10431"><![CDATA[Important]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 6 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310041" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Patch Info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10042"><![CDATA[Patch Available]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3k45r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>