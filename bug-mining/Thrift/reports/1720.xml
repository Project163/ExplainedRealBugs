<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 08:26:23 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[THRIFT-4011] Sets of Thrift structs generate Go code that can&apos;t be serialized to JSON</title>
                <link>https://issues.apache.org/jira/browse/THRIFT-4011</link>
                <project id="12310800" key="THRIFT">Thrift</project>
                    <description>&lt;p&gt;Consider the following structs:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;struct Foo {
  1: optional string foo
}

struct Bar {
  1: optional set&amp;lt;Foo&amp;gt; foos
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This compiles into the following Go code:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;type Bar struct {
	Foos map[*Foo]struct{} `thrift:&lt;span class=&quot;code-quote&quot;&gt;&quot;foos,1&quot;&lt;/span&gt; db:&lt;span class=&quot;code-quote&quot;&gt;&quot;foos&quot;&lt;/span&gt; json:&lt;span class=&quot;code-quote&quot;&gt;&quot;foos,omitempty&quot;&lt;/span&gt;`
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Even though the generated code has tags for JSON support, Bar can&apos;t be serialized to JSON:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;json: unsupported type: map[*Foo]struct {}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;One solution would be to use slices, not maps, for Thrift sets. Thoughts?&lt;/p&gt;</description>
                <environment></environment>
        <key id="13029765">THRIFT-4011</key>
            <summary>Sets of Thrift structs generate Go code that can&apos;t be serialized to JSON</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dcelasun">Duru Can Celasun</assignee>
                                    <reporter username="dcelasun">Duru Can Celasun</reporter>
                        <labels>
                    </labels>
                <created>Wed, 21 Dec 2016 14:27:48 +0000</created>
                <updated>Thu, 14 Dec 2017 13:55:03 +0000</updated>
                            <resolved>Tue, 21 Feb 2017 21:39:12 +0000</resolved>
                                                    <fixVersion>0.11.0</fixVersion>
                                    <component>Go - Compiler</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="15767957" author="jensg" created="Wed, 21 Dec 2016 19:39:55 +0000"  >&lt;p&gt;Patches are welcome &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="15768040" author="calcifer" created="Wed, 21 Dec 2016 20:06:56 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jensg&quot; class=&quot;user-hover&quot; rel=&quot;jensg&quot;&gt;jensg&lt;/a&gt; I could send a patch that uses slices for Thrift&apos;s sets and lists, but that would be backwards incompatible with all the generated Go code out there. But this would be for master, not 0.9.3, so maybe that&apos;s acceptable. What do you think? If that is indeed acceptible I&apos;m willing to work on a patch.&lt;/p&gt;

&lt;p&gt;Another concern is that, while slices are good for representing lists, Go doesn&apos;t have any data structures for sets. For emulating sets, I think we have 2 options:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Use map&lt;span class=&quot;error&quot;&gt;&amp;#91;X&amp;#93;&lt;/span&gt;struct{} for sets where X is NOT a pointer. This would ensure uniqueness, but it wouldn&apos;t solve the JSON issue. json.Marshal would succeed, but the output would be wrong.&lt;/li&gt;
	&lt;li&gt;Use slices. In the Thrift library, before serialization, iterate through the slice and panic if there are duplicates.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;So the only real option is #2. Thoughts? &lt;/p&gt;</comment>
                            <comment id="15772460" author="jensg" created="Fri, 23 Dec 2016 10:02:16 +0000"  >&lt;p&gt;Agree to #2. Not sure about the panic, but yes, give it a try.&lt;/p&gt;</comment>
                            <comment id="15823094" author="githubbot" created="Sun, 15 Jan 2017 10:05:32 +0000"  >&lt;p&gt;GitHub user dcelasun opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/1156&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/1156&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-4011&quot; title=&quot;Sets of Thrift structs generate Go code that can&amp;#39;t be serialized to JSON&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-4011&quot;&gt;&lt;del&gt;THRIFT-4011&lt;/del&gt;&lt;/a&gt; Use slices for Thrift sets&lt;/p&gt;

&lt;p&gt;    As discussed in &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-4011&quot; title=&quot;Sets of Thrift structs generate Go code that can&amp;#39;t be serialized to JSON&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-4011&quot;&gt;&lt;del&gt;THRIFT-4011&lt;/del&gt;&lt;/a&gt;(&lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-4011&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/THRIFT-4011&lt;/a&gt;), this commit changes the Go generator to use slices, instead of maps for Thrift sets.&lt;/p&gt;

&lt;p&gt;    I&apos;ve specifically didn&apos;t touch the Go library since there was no agreement on panicking for duplicates. We have three options:&lt;/p&gt;

&lt;p&gt;    1. Leave it as is and add documentation stating deduplication is the caller&apos;s responsibility.&lt;br/&gt;
    2. Silently deduplicate before serialization.&lt;br/&gt;
    3. panic on duplicates.&lt;/p&gt;

&lt;p&gt;    2 and 3 probably requires &lt;span class=&quot;error&quot;&gt;&amp;#91;`reflect.DeepEqual`&amp;#93;&lt;/span&gt;(&lt;a href=&quot;https://golang.org/pkg/reflect/#DeepEqual&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://golang.org/pkg/reflect/#DeepEqual&lt;/a&gt;), which is not ideal.&lt;/p&gt;

&lt;p&gt;    @Jens-G Thoughts?&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/dcelasun/thrift&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/dcelasun/thrift&lt;/a&gt; master&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/1156.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/1156.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #1156&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 0e2e8c0b041300dafff641e19848a1e46df32bc6&lt;br/&gt;
Author: D. Can Celasun &amp;lt;dcelasun@gmail.com&amp;gt;&lt;br/&gt;
Date:   2017-01-15T09:53:19Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-4011&quot; title=&quot;Sets of Thrift structs generate Go code that can&amp;#39;t be serialized to JSON&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-4011&quot;&gt;&lt;del&gt;THRIFT-4011&lt;/del&gt;&lt;/a&gt; Use slices for Thrift sets&lt;/p&gt;

&lt;p&gt;    This commit changes the Go generator to use slices, instead of maps for Thrift sets.&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15823148" author="githubbot" created="Sun, 15 Jan 2017 14:24:27 +0000"  >&lt;p&gt;Github user Jens-G commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/1156&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/1156&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;http://thrift.apache.org/docs/types&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://thrift.apache.org/docs/types&lt;/a&gt; states that (as one would expect) a Thrift map is defined as &quot;A map of *&lt;b&gt;strictly unique keys&lt;/b&gt;* to values. Translates to an STL map, Java HashMap, PHP associative array, Python/Ruby dictionary, etc.&quot;. &lt;/p&gt;

&lt;p&gt;    Given that, I would say it could be one option to error, when the user inserts a duplicate. On the other hand, in that case the better option could be to simply replace the current value. &lt;/p&gt;

&lt;p&gt;    But *&lt;b&gt;what should not happen is that serialized data come in with duplicated keys&lt;/b&gt;*. That would be clearly an error as it is a violation of the rule above. In that case it might be absolutely ok to return some kind of error.&lt;/p&gt;

&lt;p&gt;    Re `panic()`, from my understanding of Go that&apos;s not the idiomatic way to go, since everything form tha above is an easily recoverable error.&lt;/p&gt;

&lt;p&gt;    Further reading:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;&lt;a href=&quot;https://blog.golang.org/error-handling-and-go&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://blog.golang.org/error-handling-and-go&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://golang.org/doc/effective_go.html#panic&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://golang.org/doc/effective_go.html#panic&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;http://stackoverflow.com/questions/28472922/when-to-use-os-exit-and-panic-in-golang&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://stackoverflow.com/questions/28472922/when-to-use-os-exit-and-panic-in-golang&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

</comment>
                            <comment id="15823163" author="githubbot" created="Sun, 15 Jan 2017 15:15:48 +0000"  >&lt;p&gt;Github user dcelasun commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/1156&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/1156&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Hey @Jens-G, I&apos;m not sure I follow you, what does this have anything to do with maps? Assuming you meant sets, the docs say:&lt;/p&gt;

&lt;p&gt;    &amp;gt; An unordered set of unique elements. Translates to an STL set, Java HashSet, set in Python, etc. Note: PHP does not support sets, so it is treated similar to a List&lt;/p&gt;

&lt;p&gt;    Similar to PHP, Go does not have a native type for sets, so the best thing to do is to treat it similar to a list.&lt;/p&gt;

&lt;p&gt;    &amp;gt; Given that, I would say it could be one option to error, when the user inserts a duplicate.&lt;/p&gt;

&lt;p&gt;    This is not possible, because the caller doesn&apos;t &quot;insert&quot; anything, they simply return a slice. Consider the following:&lt;/p&gt;

&lt;p&gt;    ```thrift&lt;br/&gt;
    service Foo &lt;/p&gt;
{
        set&amp;lt;string&amp;gt; bar() throws (1: Something error)
    }
&lt;p&gt;    ```&lt;/p&gt;

&lt;p&gt;    This generates an interface called `Foo` with the following method:&lt;/p&gt;

&lt;p&gt;    ```go&lt;br/&gt;
    type Foo interface &lt;/p&gt;
{
        Bar() ([]string, error)
    }
&lt;p&gt;    ```&lt;/p&gt;

&lt;p&gt;    So the user simply returns a string slice, the Thrift library has no control over it. Once `Foo` returns, it&apos;s too late for Thrift itself to return an error, only panic. Speaking of which, panicking in case of **&lt;b&gt;programmer error&lt;/b&gt;** is very common and idiomatic in Go. The standard library is full of such panics (e.g search for &quot;misuse&quot; &lt;span class=&quot;error&quot;&gt;&amp;#91;here&amp;#93;&lt;/span&gt;(&lt;a href=&quot;https://golang.org/src/sync/waitgroup.go&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://golang.org/src/sync/waitgroup.go&lt;/a&gt;)). I would consider returning a non-unique slice for a Thrift set a programming error (and hence deserving a panic), but if you disagree, I can update the PR with deduplication in the library.&lt;/p&gt;</comment>
                            <comment id="15823384" author="githubbot" created="Mon, 16 Jan 2017 02:43:55 +0000"  >&lt;p&gt;Github user Jens-G commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/1156&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/1156&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Oopsie. After I read the word &quot;map&quot; above I must have been mentally switched to maps somehow.  My mistake.&lt;/p&gt;

&lt;p&gt;    Nevertheless what I said about panic and errors in general above still holds true. At this time we have exactly 0 (zero) panics in the code under /lib/go/thrift. So I would argue that introducing a panic at least breaks the usual patterns of that library.&lt;/p&gt;

&lt;p&gt;    &amp;gt;  Speaking of which, panicking in case of programmer error is very common and idiomatic in Go. The standard library is full of such panics &lt;/p&gt;

&lt;p&gt;    Put four Go experts together and you get five opinions, all idiomatic. Especially about the high and lofty Go error handling design principles:&lt;/p&gt;

&lt;p&gt;    &amp;gt; In Go, error handling is important. *&lt;b&gt;The language&apos;s design and conventions encourage you to explicitly check for errors&lt;/b&gt;* where they occur (as distinct from the convention in other languages of throwing exceptions and sometimes catching them). &lt;/p&gt;

&lt;p&gt;    Or mostly assigning them to `_` as many people do in Go. That&apos;s for the &quot;encourage you to explicitly check for errors&quot; part. In contrast, an exception must be caught, not only &quot;sometimes&quot;, because there is no other error handling option. &lt;/p&gt;

&lt;p&gt;    &amp;gt; The decision to not include exceptions in Go is an example of its *&lt;b&gt;simplicity&lt;/b&gt;* and orthogonality. Using multiple return values and a simple convention, *&lt;b&gt;Go solves the problem&lt;/b&gt;* of letting programmers know when things have gone wrong and *&lt;b&gt;reserves panic for the truly exceptional&lt;/b&gt;*.&lt;/p&gt;

&lt;p&gt;    I can&apos;t see any &quot;simplicity&quot; in replacing exceptions by panics, &quot;encouraging&quot; error handling by leading people into misusing the `_` operator and at the same time claiming &quot;&lt;b&gt;this time, we get it right&lt;/b&gt;&quot;. Go&apos;s error handling is FUBAR from the beginning to the end. Good intentions, absolutely, but the implementation .... All personal opinion, of course, &lt;/p&gt;

</comment>
                            <comment id="15823547" author="githubbot" created="Mon, 16 Jan 2017 07:00:24 +0000"  >&lt;p&gt;Github user dcelasun commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/1156&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/1156&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;gt; Good intentions, absolutely, but the implementation ..&lt;/p&gt;

&lt;p&gt;    FWIW, I agree. However, we still need a solution and as I explained above, we don&apos;t have a way of returning an error here. That leaves us with silent deduplication (during serialization) in lib/go/thrift. Are you OK with that?&lt;/p&gt;</comment>
                            <comment id="15823690" author="githubbot" created="Mon, 16 Jan 2017 09:39:13 +0000"  >&lt;p&gt;Github user Jens-G commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/1156&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/1156&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    +1&lt;/p&gt;

&lt;p&gt;    Sent from mobile device, please ignore spelling mistakes.&lt;br/&gt;
    ________________________________&lt;br/&gt;
    Von: Duru Can Celasun&lt;br/&gt;
    Gesendet: 16.01.2017 08:00&lt;br/&gt;
    An: apache/thrift&lt;br/&gt;
    Cc: Jens Geyer; Mention&lt;br/&gt;
    Betreff: Re: &lt;span class=&quot;error&quot;&gt;&amp;#91;apache/thrift&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-4011&quot; title=&quot;Sets of Thrift structs generate Go code that can&amp;#39;t be serialized to JSON&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-4011&quot;&gt;&lt;del&gt;THRIFT-4011&lt;/del&gt;&lt;/a&gt; Use slices for Thrift sets (#1156)&lt;/p&gt;


&lt;p&gt;    Good intentions, absolutely, but the implementation ..&lt;/p&gt;

&lt;p&gt;    FWIW, I agree. However, we still need a solution and as I explained above, we don&apos;t have a way of returning an error here. That leaves us with silent deduplication (during serialization) in lib/go/thrift. Are you OK with that?&lt;/p&gt;

&lt;p&gt;    -&lt;br/&gt;
    You are receiving this because you were mentioned.&lt;br/&gt;
    Reply to this email directly, view it on GitHub&amp;lt;&lt;a href=&quot;https://github.com/apache/thrift/pull/1156#issuecomment-272787325&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/1156#issuecomment-272787325&lt;/a&gt;&amp;gt;, or mute the thread&amp;lt;&lt;a href=&quot;https://github.com/notifications/unsubscribe-auth/AFkH7U-4jT-CNWuziuVaqCK6G_FWI8Koks5rSxWOgaJpZM4Lj4Hw&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/notifications/unsubscribe-auth/AFkH7U-4jT-CNWuziuVaqCK6G_FWI8Koks5rSxWOgaJpZM4Lj4Hw&lt;/a&gt;&amp;gt;.&lt;/p&gt;
</comment>
                            <comment id="15838271" author="githubbot" created="Wed, 25 Jan 2017 18:08:14 +0000"  >&lt;p&gt;Github user jeking3 commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/1156#discussion_r97841167&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/1156#discussion_r97841167&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: lib/go/test/tests/thrifttest_handler.go &amp;#8212;&lt;br/&gt;
    @@ -96,7 +96,7 @@ func (p *ThriftTestHandler) TestStringMap(thing map&lt;span class=&quot;error&quot;&gt;&amp;#91;string&amp;#93;&lt;/span&gt;string) (r map[string&lt;br/&gt;
     	return thing, nil&lt;br/&gt;
     }&lt;/p&gt;

&lt;p&gt;    -func (p *ThriftTestHandler) TestSet(thing map&lt;span class=&quot;error&quot;&gt;&amp;#91;int32&amp;#93;&lt;/span&gt;struct{}) (r map&lt;span class=&quot;error&quot;&gt;&amp;#91;int32&amp;#93;&lt;/span&gt;struct{}, err error) {&lt;br/&gt;
    +func (p *ThriftTestHandler) TestSet(thing []int32) (r []int32, err error) {&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    This looks like a breaking change; any generated go implementation&apos;s handler will need to change.  How will this be communicated?  What happens to existing handlers that implement the older method?&lt;/p&gt;</comment>
                            <comment id="15838285" author="githubbot" created="Wed, 25 Jan 2017 18:17:34 +0000"  >&lt;p&gt;Github user dcelasun commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/1156#discussion_r97843055&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/1156#discussion_r97843055&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: lib/go/test/tests/thrifttest_handler.go &amp;#8212;&lt;br/&gt;
    @@ -96,7 +96,7 @@ func (p *ThriftTestHandler) TestStringMap(thing map&lt;span class=&quot;error&quot;&gt;&amp;#91;string&amp;#93;&lt;/span&gt;string) (r map[string&lt;br/&gt;
     	return thing, nil&lt;br/&gt;
     }&lt;/p&gt;

&lt;p&gt;    -func (p *ThriftTestHandler) TestSet(thing map&lt;span class=&quot;error&quot;&gt;&amp;#91;int32&amp;#93;&lt;/span&gt;struct{}) (r map&lt;span class=&quot;error&quot;&gt;&amp;#91;int32&amp;#93;&lt;/span&gt;struct{}, err error) {&lt;br/&gt;
    +func (p *ThriftTestHandler) TestSet(thing []int32) (r []int32, err error) {&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    Yes, this is a breaking change which was originally discussed in &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-4011&quot; title=&quot;Sets of Thrift structs generate Go code that can&amp;#39;t be serialized to JSON&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-4011&quot;&gt;&lt;del&gt;THRIFT-4011&lt;/del&gt;&lt;/a&gt;; I only started working on this PR after I was given the go ahead.&lt;/p&gt;

&lt;p&gt;    &amp;gt; How will this be communicated?&lt;/p&gt;

&lt;p&gt;    I would imagine posts to the mailing lists and an announcement on the website, several weeks in advance of a new release?&lt;/p&gt;

&lt;p&gt;    &amp;gt; What happens to existing handlers that implement the older method?&lt;/p&gt;

&lt;p&gt;    Compiling IDLs with this patch will change the signature of any RPC or struct in the generated Go code, so it&apos;s very easy to catch at compile time and make the changes.&lt;/p&gt;</comment>
                            <comment id="15838409" author="githubbot" created="Wed, 25 Jan 2017 19:26:43 +0000"  >&lt;p&gt;Github user jeking3 commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/1156#discussion_r97858435&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/1156#discussion_r97858435&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: lib/go/test/tests/thrifttest_handler.go &amp;#8212;&lt;br/&gt;
    @@ -96,7 +96,7 @@ func (p *ThriftTestHandler) TestStringMap(thing map&lt;span class=&quot;error&quot;&gt;&amp;#91;string&amp;#93;&lt;/span&gt;string) (r map[string&lt;br/&gt;
     	return thing, nil&lt;br/&gt;
     }&lt;/p&gt;

&lt;p&gt;    -func (p *ThriftTestHandler) TestSet(thing map&lt;span class=&quot;error&quot;&gt;&amp;#91;int32&amp;#93;&lt;/span&gt;struct{}) (r map&lt;span class=&quot;error&quot;&gt;&amp;#91;int32&amp;#93;&lt;/span&gt;struct{}, err error) {&lt;br/&gt;
    +func (p *ThriftTestHandler) TestSet(thing []int32) (r []int32, err error) {&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    As long as it is a compile time failure if someone doesn&apos;t change it, that&apos;s good.  In C++ (C+&lt;ins&gt;03, or C&lt;/ins&gt;+11 without the &quot;override&quot; keyword being used) if you change the signature of a virtual method, anything that overrides it will silently define a new method instead of overriding what you want.  It&apos;s pretty messy.&lt;/p&gt;</comment>
                            <comment id="15847478" author="githubbot" created="Tue, 31 Jan 2017 20:43:14 +0000"  >&lt;p&gt;Github user Jens-G commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/1156&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/1156&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Hi @dcelasun,any news? In caseyou&apos;re donw with it, could you rebase the PR to trigger a new Travis build?&lt;/p&gt;</comment>
                            <comment id="15847491" author="githubbot" created="Tue, 31 Jan 2017 20:53:39 +0000"  >&lt;p&gt;Github user dcelasun commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/1156&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/1156&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Hey @Jens-G sorry, I didn&apos;t have time to finish this up just yet. The lib part of the PR is still missing, but I&apos;ll be doing that in a few days. I&apos;ll rebase, push and let you know.&lt;/p&gt;</comment>
                            <comment id="15847498" author="githubbot" created="Tue, 31 Jan 2017 20:56:49 +0000"  >&lt;p&gt;Github user Jens-G commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/1156&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/1156&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Ok, all fine. Don&apos;t panic &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="15854483" author="jking3" created="Mon, 6 Feb 2017 18:21:23 +0000"  >&lt;p&gt;This was described as a breaking change.  I am doing something similar for perl, switching the type for a set to Set::Scalar.  I want to remain backwards compatible as an option while having the new behavior the default, and I was going to add a compiler option like &lt;tt&gt;--gen perl:hash_sets&lt;/tt&gt; to make it use hashes like it always has.  Do we need a go compiler option here to emit backwards-compatible or new code here depending?&lt;/p&gt;</comment>
                            <comment id="15857894" author="githubbot" created="Wed, 8 Feb 2017 12:05:33 +0000"  >&lt;p&gt;Github user dcelasun commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/1156&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/1156&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    I finally hade some time to take a look at this. Duplicate detection is now implemented with `reflect.DeepEqual`. It isn&apos;t really ideal, but Go lacks a way of defining equality for arbitrary types, so this is the only possible implementation that supports `set&amp;lt;T&amp;gt;` for any `T`.&lt;/p&gt;</comment>
                            <comment id="15858111" author="githubbot" created="Wed, 8 Feb 2017 15:20:06 +0000"  >&lt;p&gt;Github user jeking3 commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/1156#discussion_r100088653&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/1156#discussion_r100088653&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: lib/go/test/tests/thrifttest_driver.go &amp;#8212;&lt;br/&gt;
    @@ -162,7 +162,7 @@ func (p *ThriftTestDriver) Start() &lt;/p&gt;
{
     		t.Fatal(&quot;TestStringMap failed&quot;)
     	}

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;setTestInput := map&lt;span class=&quot;error&quot;&gt;&amp;#91;int32&amp;#93;&lt;/span&gt;struct{}{1: {}, 2: {}, 3: {}}&lt;br/&gt;
    +	setTestInput := []int32
{1, 2, 3}
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    Syntax looks much better than before.&lt;/p&gt;</comment>
                            <comment id="15858121" author="githubbot" created="Wed, 8 Feb 2017 15:24:50 +0000"  >&lt;p&gt;Github user dcelasun commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/1156#discussion_r100089847&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/1156#discussion_r100089847&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: lib/go/test/tests/thrifttest_driver.go &amp;#8212;&lt;br/&gt;
    @@ -162,7 +162,7 @@ func (p *ThriftTestDriver) Start() &lt;/p&gt;
{
     		t.Fatal(&quot;TestStringMap failed&quot;)
     	}

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;setTestInput := map&lt;span class=&quot;error&quot;&gt;&amp;#91;int32&amp;#93;&lt;/span&gt;struct{}{1: {}, 2: {}, 3: {}}&lt;br/&gt;
    +	setTestInput := []int32
{1, 2, 3}
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    Yeah, it&apos;s also finally serializable to JSON for non-primitive types.&lt;/p&gt;</comment>
                            <comment id="15863449" author="githubbot" created="Mon, 13 Feb 2017 10:37:33 +0000"  >&lt;p&gt;Github user dcelasun commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/1156&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/1156&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @Jens-G Squashed commits and rebased from master.&lt;/p&gt;</comment>
                            <comment id="15873145" author="githubbot" created="Sat, 18 Feb 2017 12:50:13 +0000"  >&lt;p&gt;Github user Jens-G commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/1156&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/1156&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    ```&lt;br/&gt;
    src/common/clientserver_test.go:61: cannot use handler (type *MockThriftTest) as type thrifttest.ThriftTest in argument to GetServerParams:&lt;br/&gt;
    	*MockThriftTest does not implement thrifttest.ThriftTest (wrong type for TestSet method)&lt;br/&gt;
    		have TestSet(map&lt;span class=&quot;error&quot;&gt;&amp;#91;int32&amp;#93;&lt;/span&gt;struct {}) (map&lt;span class=&quot;error&quot;&gt;&amp;#91;int32&amp;#93;&lt;/span&gt;struct {}, error)&lt;br/&gt;
    		want TestSet([]int32) ([]int32, error)&lt;br/&gt;
    src/common/clientserver_test.go:226: cannot use s (type map&lt;span class=&quot;error&quot;&gt;&amp;#91;int32&amp;#93;&lt;/span&gt;struct {}) as type []int32 in argument to client.TestSet&lt;br/&gt;
    FAIL	common &lt;span class=&quot;error&quot;&gt;&amp;#91;build failed&amp;#93;&lt;/span&gt;&lt;br/&gt;
    make&lt;span class=&quot;error&quot;&gt;&amp;#91;2&amp;#93;&lt;/span&gt;: *** &lt;span class=&quot;error&quot;&gt;&amp;#91;check&amp;#93;&lt;/span&gt; Error 2&lt;br/&gt;
    make&lt;span class=&quot;error&quot;&gt;&amp;#91;2&amp;#93;&lt;/span&gt;: Leaving directory `/thrift/src/test/go&apos;&lt;br/&gt;
    make&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;: *** &lt;span class=&quot;error&quot;&gt;&amp;#91;check-recursive&amp;#93;&lt;/span&gt; Error 1&lt;br/&gt;
    make&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;: Leaving directory `/thrift/src/test&apos;&lt;br/&gt;
    make: *** &lt;span class=&quot;error&quot;&gt;&amp;#91;check-recursive&amp;#93;&lt;/span&gt; Error 1&lt;/p&gt;

&lt;p&gt;    ```&lt;/p&gt;</comment>
                            <comment id="15873147" author="githubbot" created="Sat, 18 Feb 2017 12:56:47 +0000"  >&lt;p&gt;Github user dcelasun commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/1156&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/1156&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Whoops, I must have missed that one. Should be fixed now.&lt;/p&gt;</comment>
                            <comment id="15874483" author="githubbot" created="Mon, 20 Feb 2017 12:51:33 +0000"  >&lt;p&gt;Github user dcelasun commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/1156&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/1156&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @Jens-G All tests green and rebased from master.&lt;/p&gt;</comment>
                            <comment id="15875530" author="githubbot" created="Tue, 21 Feb 2017 07:41:08 +0000"  >&lt;p&gt;Github user Jens-G commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/1156&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/1156&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Ok, thanks.&lt;/p&gt;</comment>
                            <comment id="15876766" author="githubbot" created="Tue, 21 Feb 2017 21:33:45 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/1156&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/1156&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15876770" author="jensg" created="Tue, 21 Feb 2017 21:39:12 +0000"  >&lt;p&gt;Committed, thanks.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310361">
                    <name>Blocked</name>
                                            <outwardlinks description="Blocked">
                                        <issuelink>
            <issuekey id="13087824">THRIFT-4255</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="12310010">
                    <name>Incorporates</name>
                                            <outwardlinks description="incorporates">
                                        <issuelink>
            <issuekey id="12945596">THRIFT-3700</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 39 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i37vmf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>