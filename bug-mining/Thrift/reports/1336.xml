<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 08:20:44 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[THRIFT-3302] Go JSON protocol should encode Thrift byte type as signed integer string</title>
                <link>https://issues.apache.org/jira/browse/THRIFT-3302</link>
                <project id="12310800" key="THRIFT">Thrift</project>
                    <description>&lt;h3&gt;&lt;a name=&quot;Problem&quot;&gt;&lt;/a&gt;Problem&lt;/h3&gt;

&lt;p&gt;Go implementation of JSON and simple JSON protocols encode Thrift byte type field as unsigned 8bit integer.&lt;/p&gt;

&lt;p&gt;i.e. -1 is encoded to &quot;255&quot; by Go implementation while &quot;-1&quot; by others like C++, Java and Python.&lt;/p&gt;

&lt;h3&gt;&lt;a name=&quot;Reproduce&quot;&gt;&lt;/a&gt;Reproduce&lt;/h3&gt;

&lt;p&gt;Cross test with go server and py client (JSON protocols of course).&lt;br/&gt;
(like &quot;expected -127 but got 129&quot;)&lt;/p&gt;

&lt;p&gt;Static-typed clients (such as C++ and Java) are not likely to notice the difference because of integer overflow.&lt;/p&gt;

&lt;h3&gt;&lt;a name=&quot;Fix&quot;&gt;&lt;/a&gt;Fix&lt;/h3&gt;

&lt;p&gt;Explicitly convert the unsigned 8-bit value back to signed one in JSON protocols before converting to text.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12858114">THRIFT-3302</key>
            <summary>Go JSON protocol should encode Thrift byte type as signed integer string</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="nsuke">Nobuaki Sukegawa</assignee>
                                    <reporter username="nsuke">Nobuaki Sukegawa</reporter>
                        <labels>
                    </labels>
                <created>Sun, 23 Aug 2015 06:31:27 +0000</created>
                <updated>Tue, 15 Sep 2015 19:53:41 +0000</updated>
                            <resolved>Sat, 5 Sep 2015 11:16:39 +0000</resolved>
                                                    <fixVersion>0.9.3</fixVersion>
                                    <component>Go - Library</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="14708311" author="githubbot" created="Sun, 23 Aug 2015 07:06:31 +0000"  >&lt;p&gt;GitHub user nsuke opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/591&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/591&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-3302&quot; title=&quot;Go JSON protocol should encode Thrift byte type as signed integer string&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-3302&quot;&gt;&lt;del&gt;THRIFT-3302&lt;/del&gt;&lt;/a&gt; Go JSON protocol should encode Thrift byte type as signed&#8230;&lt;/p&gt;

&lt;p&gt;    &#8230; integer string&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/nsuke/thrift&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/nsuke/thrift&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-3302&quot; title=&quot;Go JSON protocol should encode Thrift byte type as signed integer string&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-3302&quot;&gt;&lt;del&gt;THRIFT-3302&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/591.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/591.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #591&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 3d8f4ce9de6dec201e115af3dabf8d9f7402371e&lt;br/&gt;
Author: Nobuaki Sukegawa &amp;lt;nsukeg@gmail.com&amp;gt;&lt;br/&gt;
Date:   2015-08-23T03:34:31Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-3302&quot; title=&quot;Go JSON protocol should encode Thrift byte type as signed integer string&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-3302&quot;&gt;&lt;del&gt;THRIFT-3302&lt;/del&gt;&lt;/a&gt; Go JSON protocol should encode Thrift byte type as signed integer string&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="14721580" author="jensg" created="Sun, 30 Aug 2015 16:13:43 +0000"  >&lt;p&gt;Correct. I&apos;ll look at it, thanks!&lt;/p&gt;</comment>
                            <comment id="14729656" author="jensg" created="Thu, 3 Sep 2015 19:44:04 +0000"  >&lt;p&gt;Why don&apos;t we change the &lt;tt&gt;WriteByte(byte)&lt;/tt&gt; methods into &lt;tt&gt;WriteByte(int8)&lt;/tt&gt; while we&apos;re at it? All Thrift integers are &lt;a href=&quot;https://thrift.apache.org/docs/types&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;always signed by definition&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="14731885" author="nsuke" created="Sat, 5 Sep 2015 08:49:15 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jensg&quot; class=&quot;user-hover&quot; rel=&quot;jensg&quot;&gt;jensg&lt;/a&gt;, yes, casting in generated code then casting back in protocols is awkward and a little hacky.&lt;/p&gt;

&lt;p&gt;I updated the pull request to change the signature.&lt;br/&gt;
Both &lt;tt&gt;make check&lt;/tt&gt; and &lt;tt&gt;make cross&lt;/tt&gt; should run fine with this.&lt;/p&gt;

&lt;p&gt;Note that I only changed signatures of protocol API, but not ones of transport API because&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;The knowledge of Thrift byte type is specific to protocols. Transports does not necessarily need to know it.&lt;/li&gt;
	&lt;li&gt;Many Go standard lib types used in transports have &lt;tt&gt;Read/WriteByte(byte)&lt;/tt&gt; so we cannot completely unify the signature anyway.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14731886" author="nsuke" created="Sat, 5 Sep 2015 08:49:43 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jensg&quot; class=&quot;user-hover&quot; rel=&quot;jensg&quot;&gt;jensg&lt;/a&gt;, yes, casting in generated code then casting back in protocols is awkward and a little hacky.&lt;/p&gt;

&lt;p&gt;I updated the pull request to change the signature.&lt;br/&gt;
Both &lt;tt&gt;make check&lt;/tt&gt; and &lt;tt&gt;make cross&lt;/tt&gt; should run fine with this.&lt;/p&gt;

&lt;p&gt;Note that I only changed signatures of protocol API, but not ones of transport API because&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;The knowledge of Thrift byte type is specific to protocols. Transports does not necessarily need to know it.&lt;/li&gt;
	&lt;li&gt;Many Go standard lib types used in transports have &lt;tt&gt;Read/WriteByte(byte)&lt;/tt&gt; so we cannot completely unify the signature anyway.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14731927" author="githubbot" created="Sat, 5 Sep 2015 10:51:38 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/591&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/591&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14731934" author="jensg" created="Sat, 5 Sep 2015 11:16:39 +0000"  >&lt;p&gt;Committed, thank you!&lt;/p&gt;</comment>
                            <comment id="14731935" author="hudson" created="Sat, 5 Sep 2015 11:18:25 +0000"  >&lt;p&gt;SUCCESS: Integrated in Thrift #1651 (See &lt;a href=&quot;https://builds.apache.org/job/Thrift/1651/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Thrift/1651/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-3302&quot; title=&quot;Go JSON protocol should encode Thrift byte type as signed integer string&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-3302&quot;&gt;&lt;del&gt;THRIFT-3302&lt;/del&gt;&lt;/a&gt; Go JSON protocol should encode Thrift byte type as signed integer string (jensg: rev 5bc8b5a3a5da507b6f87436ca629be664496a69f)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;lib/go/thrift/json_protocol.go&lt;/li&gt;
	&lt;li&gt;lib/go/thrift/simple_json_protocol.go&lt;/li&gt;
	&lt;li&gt;lib/go/thrift/debug_protocol.go&lt;/li&gt;
	&lt;li&gt;lib/go/thrift/serializer_types_test.go&lt;/li&gt;
	&lt;li&gt;lib/go/thrift/simple_json_protocol_test.go&lt;/li&gt;
	&lt;li&gt;lib/go/thrift/protocol_test.go&lt;/li&gt;
	&lt;li&gt;lib/go/thrift/protocol.go&lt;/li&gt;
	&lt;li&gt;lib/go/thrift/binary_protocol.go&lt;/li&gt;
	&lt;li&gt;lib/go/thrift/json_protocol_test.go&lt;/li&gt;
	&lt;li&gt;lib/go/test/tests/protocol_mock.go&lt;/li&gt;
	&lt;li&gt;test/known_failures_Linux.json&lt;/li&gt;
	&lt;li&gt;lib/go/thrift/compact_protocol.go&lt;/li&gt;
	&lt;li&gt;compiler/cpp/src/generate/t_go_generator.cc&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 11 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310041" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Patch Info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10042"><![CDATA[Patch Available]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2j97b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>