<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 08:18:40 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[THRIFT-1248] pointer subtraction in TMemoryBuffer relies on undefined behavior</title>
                <link>https://issues.apache.org/jira/browse/THRIFT-1248</link>
                <project id="12310800" key="THRIFT">Thrift</project>
                    <description>&lt;p&gt;The ensureCanWrite function in TMemoryBuffer currently &quot;rebases&quot; the buffer pointers by subtracting the original buffer pointer from the pointer newly returned by realloc. While this seems to work fine on my linux setup(I couldn&apos;t force a reproducer), pointer subtraction between pointers that we allocated separately is an undefined operation.&lt;/p&gt;

&lt;p&gt;I have run into problems with this on platforms other than linux.&lt;/p&gt;

&lt;p&gt;I am attaching a patch that removes the undefined operation.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12515774">THRIFT-1248</key>
            <summary>pointer subtraction in TMemoryBuffer relies on undefined behavior</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jking3">James E. King III</assignee>
                                    <reporter username="fanatoly">Anatoly Fayngelerin</reporter>
                        <labels>
                    </labels>
                <created>Fri, 29 Jul 2011 13:39:40 +0000</created>
                <updated>Fri, 6 May 2016 22:30:17 +0000</updated>
                            <resolved>Sun, 10 May 2015 12:45:47 +0000</resolved>
                                    <version>0.5</version>
                                    <fixVersion>0.9.3</fixVersion>
                                    <component>C++ - Library</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="13679012" author="jensg" created="Sun, 9 Jun 2013 11:27:22 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=fanatoly&quot; class=&quot;user-hover&quot; rel=&quot;fanatoly&quot;&gt;fanatoly&lt;/a&gt;, &lt;br/&gt;
I see the point. Could you please&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;rebase the patch to current trunk&lt;/li&gt;
	&lt;li&gt;have a look whether wBound_ is really calculated correctly after your modifications being applied?&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Thank you!&lt;/p&gt;</comment>
                            <comment id="14155414" author="jensg" created="Wed, 1 Oct 2014 20:10:56 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=fanatoly&quot; class=&quot;user-hover&quot; rel=&quot;fanatoly&quot;&gt;fanatoly&lt;/a&gt;,&lt;/p&gt;

&lt;p&gt;any progress on this?&lt;/p&gt;</comment>
                            <comment id="14537156" author="githubbot" created="Sun, 10 May 2015 12:09:34 +0000"  >&lt;p&gt;GitHub user jeking3 opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/486&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/486&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-1248&quot; title=&quot;pointer subtraction in TMemoryBuffer relies on undefined behavior&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-1248&quot;&gt;&lt;del&gt;THRIFT-1248&lt;/del&gt;&lt;/a&gt; fix TMemoryBuffer pointer arithmetic and add unit test&lt;/p&gt;



&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/jeking3/thrift&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/jeking3/thrift&lt;/a&gt; bugfix/&lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-1248&quot; title=&quot;pointer subtraction in TMemoryBuffer relies on undefined behavior&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-1248&quot;&gt;&lt;del&gt;THRIFT-1248&lt;/del&gt;&lt;/a&gt;-pointer-arithmetic&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/486.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/486.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #486&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 379f6857f087c87a60a933028549534b06a1371b&lt;br/&gt;
Author: Jim King &amp;lt;jim.king@simplivity.com&amp;gt;&lt;br/&gt;
Date:   2015-05-10T12:08:18Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-1248&quot; title=&quot;pointer subtraction in TMemoryBuffer relies on undefined behavior&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-1248&quot;&gt;&lt;del&gt;THRIFT-1248&lt;/del&gt;&lt;/a&gt; fix TMemoryBuffer pointer arithmetic and add unit test&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="14537163" author="githubbot" created="Sun, 10 May 2015 12:45:45 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/486&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/486&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14537173" author="hudson" created="Sun, 10 May 2015 13:36:41 +0000"  >&lt;p&gt;SUCCESS: Integrated in Thrift #1541 (See &lt;a href=&quot;https://builds.apache.org/job/Thrift/1541/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Thrift/1541/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-1248&quot; title=&quot;pointer subtraction in TMemoryBuffer relies on undefined behavior&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-1248&quot;&gt;&lt;del&gt;THRIFT-1248&lt;/del&gt;&lt;/a&gt; fix TMemoryBuffer pointer arithmetic and add unit test (roger: rev 6077481139933b927397c7da0088aa4678f9fb3c)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;lib/cpp/src/thrift/transport/TBufferTransports.cpp&lt;/li&gt;
	&lt;li&gt;lib/cpp/test/TMemoryBufferTest.cpp&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15274846" author="githubbot" created="Fri, 6 May 2016 22:30:17 +0000"  >&lt;p&gt;Github user HuaisiXu commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/486#issuecomment-217579196&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/486#issuecomment-217579196&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Could you describe the bug? We saw a heap corruption bug that may be caused by Thrift. We see wBound_ is less than wBase_ in core dump.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12488206" name="0_7_0_ptrdiff.patch" size="1008" author="fanatoly" created="Fri, 29 Jul 2011 13:40:07 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>65060</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 28 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310041" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Patch Info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10042"><![CDATA[Patch Available]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i14i9z:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>234424</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>