<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 08:29:17 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[THRIFT-4289] Thrift RSpec test suite fails with Ruby 2.4.x due to Fixnum deprecation</title>
                <link>https://issues.apache.org/jira/browse/THRIFT-4289</link>
                <project id="12310800" key="THRIFT">Thrift</project>
                    <description>&lt;h3&gt;&lt;a name=&quot;Stepstoreproduce%3A&quot;&gt;&lt;/a&gt;Steps to reproduce:&lt;/h3&gt;
&lt;p&gt;1) Install ruby 2.4.x&lt;br/&gt;
2) Build Thrift with `./bootstrap.sh`, `./configure`, `make`, and `sudo make install`&lt;/p&gt;

&lt;h3&gt;&lt;a name=&quot;TheRSpecsuitewillfail3errors%3A&quot;&gt;&lt;/a&gt;The RSpec suite will fail 3 errors:&lt;/h3&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Failures:

  1) Struct Thrift::Struct should support optional type-checking in Thrift::Struct.new
     Failure/Error: lambda { SpecNamespace::Hello.new(:greeting =&amp;gt; 3) }.should raise_error(Thrift::TypeError, &quot;Expected Types::STRING, received Fixnum for field greeting&quot;)
       expected Thrift::TypeError with &quot;Expected Types::STRING, received Fixnum for field greeting&quot;, got #&amp;lt;Thrift::TypeError: Expected Types::STRING, received Integer for field greeting&amp;gt; with backtrace:
         # ./lib/thrift/types.rb:69:in `check_type&apos;
         # ./lib/thrift/struct.rb:42:in `block in initialize&apos;
         # ./lib/thrift/struct.rb:38:in `each&apos;
         # ./lib/thrift/struct.rb:38:in `initialize&apos;
         # ./spec/struct_spec.rb:230:in `new&apos;
         # ./spec/struct_spec.rb:230:in `block (4 levels) in &amp;lt;top (required)&amp;gt;&apos;
         # ./spec/struct_spec.rb:230:in `block (3 levels) in &amp;lt;top (required)&amp;gt;&apos;
     # ./spec/struct_spec.rb:230:in `block (3 levels) in &amp;lt;top (required)&amp;gt;&apos;

  2) Struct Thrift::Struct should support optional type-checking in field accessors
     Failure/Error: lambda { hello.greeting = 3 }.should raise_error(Thrift::TypeError, &quot;Expected Types::STRING, received Fixnum for field greeting&quot;)
       expected Thrift::TypeError with &quot;Expected Types::STRING, received Fixnum for field greeting&quot;, got #&amp;lt;Thrift::TypeError: Expected Types::STRING, received Integer for field greeting&amp;gt; with backtrace:
         # ./lib/thrift/types.rb:69:in `check_type&apos;
         # ./lib/thrift/struct.rb:157:in `block in field_accessor&apos;
         # ./spec/struct_spec.rb:241:in `block (4 levels) in &amp;lt;top (required)&amp;gt;&apos;
         # ./spec/struct_spec.rb:241:in `block (3 levels) in &amp;lt;top (required)&amp;gt;&apos;
     # ./spec/struct_spec.rb:241:in `block (3 levels) in &amp;lt;top (required)&amp;gt;&apos;

  3) Thrift::Types type checking should give the Thrift::TypeError a readable message
     Failure/Error: lambda { Thrift.check_type(3, {:type =&amp;gt; Thrift::Types::STRING}, :foo) }.should raise_error(Thrift::TypeError, msg)
       expected Thrift::TypeError with &quot;Expected Types::STRING, received Fixnum for field foo&quot;, got #&amp;lt;Thrift::TypeError: Expected Types::STRING, received Integer for field foo&amp;gt; with backtrace:
         # ./lib/thrift/types.rb:69:in `check_type&apos;
         # ./spec/types_spec.rb:101:in `block (4 levels) in &amp;lt;top (required)&amp;gt;&apos;
         # ./spec/types_spec.rb:101:in `block (3 levels) in &amp;lt;top (required)&amp;gt;&apos;
     # ./spec/types_spec.rb:101:in `block (3 levels) in &amp;lt;top (required)&amp;gt;&apos;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;h3&gt;&lt;a name=&quot;Cause&quot;&gt;&lt;/a&gt;Cause&lt;/h3&gt;
&lt;p&gt;Starting in Ruby 2.4, ::Fixnum is deprecated. See &lt;a href=&quot;https://bugs.ruby-lang.org/issues/12005&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://bugs.ruby-lang.org/issues/12005&lt;/a&gt;&lt;/p&gt;

&lt;h4&gt;&lt;a name=&quot;Solution&quot;&gt;&lt;/a&gt;Solution&lt;/h4&gt;
&lt;p&gt;In lib/rb/spec/struct_spec.rb, change&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;lambda { SpecNamespace::Hello.new(:greeting =&amp;gt; 3) }.should raise_error(Thrift::TypeError, &quot;Expected Types::STRING, received Fixnum for field greeting&quot;)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;to&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;lambda { SpecNamespace::Hello.new(:greeting =&amp;gt; 3) }.should raise_error(Thrift::TypeError, &quot;Expected Types::STRING, received Integer for field greeting&quot;)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;and&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;lambda { hello.greeting = 3 }.should raise_error(Thrift::TypeError, &quot;Expected Types::STRING, received Fixnum for field greeting&quot;)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;to&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;lambda { hello.greeting = 3 }.should raise_error(Thrift::TypeError, &quot;Expected Types::STRING, received Integer for field greeting&quot;)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;In lib/rb/spec/types_spec.rb, change:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;msg = &quot;Expected Types::STRING, received Fixnum for field foo&quot;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;to&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;msg = &quot;Expected Types::STRING, received Integer for field foo&quot;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;and&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;msg = &quot;Expected Types::STRING, received Fixnum for field foo.element&quot;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;to&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;msg = &quot;Expected Types::STRING, received Integer for field foo.element&quot;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;RSpec suite will then pass, and `sudo make install` will exit successfully.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Thrift v0.10.0&lt;br/&gt;
ruby 2.4.0p0&lt;br/&gt;
CentOS Linux (3.10.0-514.26.2.el7.x86_64) 7&lt;/p&gt;</environment>
        <key id="13096180">THRIFT-4289</key>
            <summary>Thrift RSpec test suite fails with Ruby 2.4.x due to Fixnum deprecation</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jking3">James E. King III</assignee>
                                    <reporter username="jerzygangi">JJ Gangi</reporter>
                        <labels>
                    </labels>
                <created>Sat, 19 Aug 2017 02:04:36 +0000</created>
                <updated>Thu, 27 Dec 2018 15:25:10 +0000</updated>
                            <resolved>Sun, 10 Jun 2018 20:44:17 +0000</resolved>
                                    <version>0.10.0</version>
                                    <fixVersion>0.12.0</fixVersion>
                                    <component>Ruby - Compiler</component>
                    <component>Ruby - Library</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="16133877" author="jerzygangi" created="Sat, 19 Aug 2017 02:07:07 +0000"  >&lt;p&gt;FYI &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jfarrell&quot; class=&quot;user-hover&quot; rel=&quot;jfarrell&quot;&gt;jfarrell&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=roger.meier&quot; class=&quot;user-hover&quot; rel=&quot;roger.meier&quot;&gt;roger.meier&lt;/a&gt; since you are the two committers on these RSpec files.&lt;/p&gt;</comment>
                            <comment id="16176603" author="jking3" created="Fri, 22 Sep 2017 15:52:46 +0000"  >&lt;p&gt;Would you be able to submit a github pull request for this?&lt;/p&gt;</comment>
                            <comment id="16507416" author="jking3" created="Sun, 10 Jun 2018 15:09:46 +0000"  >&lt;p&gt;I am going to apply this, I just ran into it when updating to Ubuntu Bionic.&lt;/p&gt;</comment>
                            <comment id="16507502" author="jking3" created="Sun, 10 Jun 2018 20:44:52 +0000"  >&lt;p&gt;This patch broke backwards compatibility; I adjusted it to work for Ruby &amp;lt; 2.4 and &amp;gt;= 2.4&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12882708" name="thrift-4289.patch" size="2151" author="jerzygangi" created="Sat, 19 Aug 2017 02:05:16 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310250" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10430"><![CDATA[Patch]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 23 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310041" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Patch Info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10042"><![CDATA[Patch Available]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3j1qv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>