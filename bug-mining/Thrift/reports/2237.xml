<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 08:34:45 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[THRIFT-5666] lib: cpp: build fails when non-standard sys/poll.h is not present</title>
                <link>https://issues.apache.org/jira/browse/THRIFT-5666</link>
                <project id="12310800" key="THRIFT">Thrift</project>
                    <description>&lt;p&gt;Multiple errors of this form when &lt;b&gt;HAVE_POLL_H&lt;/b&gt; is defined but &lt;b&gt;HAVE_SYS_POLL_H&lt;/b&gt; is not defined. Technically, the correct dependency here should be &lt;b&gt;HAVE_POLL_H&lt;/b&gt;, because that is the actual header in &lt;a href=&quot;https://pubs.opengroup.org/onlinepubs/9699919799/basedefs/poll.h.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;the POSIX spec&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
/Users/cfriedt/workspace/zephyrproject/modules/lib/thrift/.upstream/lib/cpp/src/thrift/transport/TServerSocket.cpp: In member function &lt;span class=&quot;code-quote&quot;&gt;&apos;virtual std::shared_ptr&amp;lt;apache::thrift::transport::TTransport&amp;gt; apache::thrift::transport::TServerSocket::acceptImpl()&apos;&lt;/span&gt;:
/Users/cfriedt/workspace/zephyrproject/modules/lib/thrift/.upstream/lib/cpp/src/thrift/transport/TServerSocket.cpp:597:24: error: elements of array &lt;span class=&quot;code-quote&quot;&gt;&apos;apache::thrift::transport::TServerSocket::acceptImpl()::pollfd fds [2]&apos;&lt;/span&gt; have incomplete type
&#160; 597 | &#160; struct THRIFT_POLLFD fds[2];
&#160; &#160; &#160; | &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;^~~
/Users/cfriedt/workspace/zephyrproject/modules/lib/thrift/.upstream/lib/cpp/src/thrift/transport/TServerSocket.cpp:597:24: error: storage size of &lt;span class=&quot;code-quote&quot;&gt;&apos;fds&apos;&lt;/span&gt; isn&apos;t known
In file included from /Users/cfriedt/workspace/zephyrproject/modules/lib/thrift/.upstream/lib/cpp/src/thrift/transport/TServerSocket.cpp:50:
/Users/cfriedt/workspace/zephyrproject/modules/lib/thrift/.upstream/lib/cpp/src/thrift/transport/PlatformSocket.h:123:26: error: &lt;span class=&quot;code-quote&quot;&gt;&apos;POLLIN&apos;&lt;/span&gt; was not declared in &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; scope
&#160; 123 | # &#160;define THRIFT_POLLIN &#160;POLLIN
&#160; &#160; &#160; | &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;^~~~~~
/Users/cfriedt/workspace/zephyrproject/modules/lib/thrift/.upstream/lib/cpp/src/thrift/transport/TServerSocket.cpp:605:21: note: in expansion of macro &lt;span class=&quot;code-quote&quot;&gt;&apos;THRIFT_POLLIN&apos;&lt;/span&gt;
&#160; 605 | &#160; &#160; fds[0].events = THRIFT_POLLIN;
&#160; &#160; &#160; | &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ^~~~~~~~~~~~~
/Users/cfriedt/workspace/zephyrproject/modules/lib/thrift/.upstream/lib/cpp/src/thrift/transport/PlatformSocket.h:121:23: error: &lt;span class=&quot;code-quote&quot;&gt;&apos;poll&apos;&lt;/span&gt; was not declared in &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; scope; did you mean &lt;span class=&quot;code-quote&quot;&gt;&apos;k_poll&apos;&lt;/span&gt;?
&#160; 121 | # &#160;define THRIFT_POLL poll
&#160; &#160; &#160; | &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ^~~~
/Users/cfriedt/workspace/zephyrproject/modules/lib/thrift/.upstream/lib/cpp/src/thrift/transport/TServerSocket.cpp:614:15: note: in expansion of macro &lt;span class=&quot;code-quote&quot;&gt;&apos;THRIFT_POLL&apos;&lt;/span&gt;
&#160; 614 | &#160; &#160; &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; ret = THRIFT_POLL(fds, 2, accTimeout_);
&#160; &#160; &#160; | &#160; &#160; &#160; &#160; &#160; &#160; &#160; ^~~~~~~~~~~&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Looks as though it affects the following files, and the problem is obvious (they don&apos;t include the correct header &lt;b&gt;&amp;lt;poll.h&amp;gt;&lt;/b&gt;).&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;lib/cpp/src/thrift/transport/TNonblockingServerSocket.cpp&lt;/li&gt;
	&lt;li&gt;lib/cpp/src/thrift/transport/TSSLSocket.cpp&lt;/li&gt;
	&lt;li&gt;lib/cpp/src/thrift/transport/TServerSocket.cpp&lt;/li&gt;
	&lt;li&gt;lib/cpp/src/thrift/transport/TSocket.cpp&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;The &lt;b&gt;sys/poll.h&lt;/b&gt;&#160;header is not actually where &lt;b&gt;poll(2)&lt;/b&gt; must be defined according to &lt;a href=&quot;https://pubs.opengroup.org/onlinepubs/9699919799/basedefs/poll.h.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;the POSIX spec&lt;/a&gt;, but the sources above seem to assume that.&lt;/p&gt;

&lt;p&gt;However, we shouldn&apos;t simply erase use of &lt;b&gt;sys/poll.h&lt;/b&gt; everywhere. There may be the case where some non-POSIX compliant platform uses that instead of &lt;b&gt;&amp;lt;poll.h&amp;gt;&lt;/b&gt;.&lt;/p&gt;

&lt;p&gt;PR is here&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/thrift/pull/2723&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/2723&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13493502">THRIFT-5666</key>
            <summary>lib: cpp: build fails when non-standard sys/poll.h is not present</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="5" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.svg">Trivial</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="cfriedt">Christopher Friedt</assignee>
                                    <reporter username="cfriedt">Christopher Friedt</reporter>
                        <labels>
                    </labels>
                <created>Fri, 28 Oct 2022 16:22:53 +0000</created>
                <updated>Sun, 20 Nov 2022 11:04:06 +0000</updated>
                                                                            <component>C++ - Library</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="3000">50m</timespent>
                                        <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 2 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1alm8:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>