<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 08:08:02 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[THRIFT-1850] make check hangs on TSocket tests in TransportTest.cpp</title>
                <link>https://issues.apache.org/jira/browse/THRIFT-1850</link>
                <project id="12310800" key="THRIFT">Thrift</project>
                    <description>&lt;p&gt;On the systems noted with trunk rev 3a67c2f &lt;br/&gt;
   TEST_BLOCKING_BEHAVIOR(CoupledFDTransports) and&lt;br/&gt;
   TEST_BLOCKING_BEHAVIOR(CoupledSocketTransports) in&lt;br/&gt;
   lib/cpp/test/TransportTest.cpp (around line 850) &lt;br/&gt;
produce timeout alarms with the warning: &lt;br/&gt;
   &quot;Timeout alarm expired; attempting to unblock transport&quot; &lt;br/&gt;
and then the 4th (and 8th) TEST_RW(CoupledSocketTransports,...) hangs indefinitely due to a blocking socket write. Some others have noticed this:&lt;br/&gt;
   &lt;a href=&quot;http://stackoverflow.com/questions/13147105/thrfit-make-check-stuck&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://stackoverflow.com/questions/13147105/thrfit-make-check-stuck&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I have attached a patch that sets a timeout on the TSocket in question allowing transport reads to take place when the socket layer refuses to write. It appears trunk revision 0c025e8f reduced the socket_max_outstanding on the two problem tests to 400 in order to repair this (which I assume it did at the time). I do not think this is needed with the attached patch and have reverted to the symbolic socket_max_outstanding value. &lt;/p&gt;

&lt;p&gt;The two TEST_BLOCKING_BEHAVIOR timeouts still alarm but the tests appear to run as they were meant to with this patch on all three systems I have tested. This is my first contribution, please let me know if it is off base in any way.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Mint 14 x64 and Centos 6.3 x64 and x86 &lt;span class=&quot;error&quot;&gt;&amp;#91;Web Server Profile&amp;#93;&lt;/span&gt; with clean install and minimum Thrift support added for C++&lt;/p&gt;</environment>
        <key id="12631038">THRIFT-1850</key>
            <summary>make check hangs on TSocket tests in TransportTest.cpp</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="roger">Roger Meier</assignee>
                                    <reporter username="codesf">Randy Abernethy</reporter>
                        <labels>
                    </labels>
                <created>Wed, 6 Feb 2013 10:42:16 +0000</created>
                <updated>Sat, 20 Feb 2021 15:27:09 +0000</updated>
                            <resolved>Sat, 8 Jun 2013 03:15:47 +0000</resolved>
                                    <version>0.9</version>
                                    <fixVersion>0.9.1</fixVersion>
                                    <component>Test Suite</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="13572325" author="codesf" created="Wed, 6 Feb 2013 10:44:21 +0000"  >&lt;p&gt;patch for TransportTest.cpp hang&lt;/p&gt;</comment>
                            <comment id="13640221" author="henrique" created="Wed, 24 Apr 2013 08:30:12 +0000"  >&lt;p&gt;Hi Randy,&lt;br/&gt;
Thanks a lot for the patch. I can also reproduce this but apparently it run smoothly on the Jenkins build servers, so I&apos;m not really sure why it hangs there.&lt;br/&gt;
Perhaps someone else has a better idea?&lt;/p&gt;</comment>
                            <comment id="13646453" author="roger.meier" created="Wed, 1 May 2013 08:12:32 +0000"  >&lt;p&gt;did a test with this patch on travis-ci ... and it works&lt;br/&gt;
see &lt;a href=&quot;https://travis-ci.org/bufferoverflow/thrift/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://travis-ci.org/bufferoverflow/thrift/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13648789" author="roger.meier" created="Fri, 3 May 2013 20:41:05 +0000"  >&lt;p&gt;thank!&lt;/p&gt;

&lt;p&gt;committed&lt;br/&gt;
;-r&lt;/p&gt;</comment>
                            <comment id="13661723" author="hudson" created="Mon, 20 May 2013 03:13:10 +0000"  >&lt;p&gt;Integrated in Thrift #646 (See &lt;a href=&quot;https://builds.apache.org/job/Thrift/646/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Thrift/646/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-1850&quot; title=&quot;make check hangs on TSocket tests in TransportTest.cpp&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-1850&quot;&gt;&lt;del&gt;THRIFT-1850&lt;/del&gt;&lt;/a&gt; make check hangs on TSocket tests in TransportTest.cpp (Revision 967600ef4f09445d9dbb6654dca8d235d9d65f5b)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
roger : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;lib/cpp/test/TransportTest.cpp&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12568199" name="0001-TSocket-TransportTest.cpp-hang.patch" size="2099" author="codesf" created="Wed, 6 Feb 2013 10:44:21 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>311534</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 27 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310041" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Patch Info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10042"><![CDATA[Patch Available]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1hrhj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>311880</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>