<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 08:22:04 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[THRIFT-3433] Doubles aren&apos;t interpreted correctly</title>
                <link>https://issues.apache.org/jira/browse/THRIFT-3433</link>
                <project id="12310800" key="THRIFT">Thrift</project>
                    <description>&lt;p&gt;When reading in a string-to-double map from the identical file using the Compact protocol, Python gives the correct values:&lt;/p&gt;

&lt;p&gt;...&lt;br/&gt;
u&apos;roh&apos;: -12.012431158160835&lt;br/&gt;
...&lt;/p&gt;

&lt;p&gt;but Haskell is totally off:&lt;/p&gt;

&lt;p&gt;...&lt;br/&gt;
(&quot;roh&quot;,6.355136015066463e-157)&lt;br/&gt;
...&lt;/p&gt;

&lt;p&gt;The funny thing is, if I read it into Haskell (and the numbers are all off), then write it out to another file, that file still has correct numbers when loaded into Python.  So it seems that the raw information is being (de)serialized correctly at the bit-level, but Haskell isn&apos;t interpreting it as a double the same way as Python...&lt;/p&gt;</description>
                <environment></environment>
        <key id="12914553">THRIFT-3433</key>
            <summary>Doubles aren&apos;t interpreted correctly</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="nsuke">Nobuaki Sukegawa</assignee>
                                    <reporter username="tlippy01">Tom Lippincott</reporter>
                        <labels>
                    </labels>
                <created>Thu, 19 Nov 2015 17:13:06 +0000</created>
                <updated>Wed, 6 Jan 2016 02:06:08 +0000</updated>
                            <resolved>Thu, 10 Dec 2015 17:19:40 +0000</resolved>
                                    <version>0.9.3</version>
                                    <fixVersion>0.10.0</fixVersion>
                                    <component>Haskell - Library</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="15014116" author="tlippy01" created="Thu, 19 Nov 2015 18:39:52 +0000"  >&lt;p&gt;Also: it seems to work as expected for JSON and Binary protocols (not 100% positive though).  So maybe something specific to the Compact protocol.  Is there some sort of regression test for consistency between different protocols, or even better, between languages?&lt;/p&gt;</comment>
                            <comment id="15014277" author="tlippy01" created="Thu, 19 Nov 2015 20:15:01 +0000"  >&lt;p&gt;One more point: the Compact protocol works fine &lt;b&gt;within&lt;/b&gt; Haskell, i.e. I can correctly write then read doubles using Haskell on both ends, the problem comes when interoperating with Python (and probably other languages).&lt;/p&gt;</comment>
                            <comment id="15014286" author="jensg" created="Thu, 19 Nov 2015 20:19:17 +0000"  >&lt;p&gt;The  byte order is wrong. Interpreting the first double as bytes and swapping all bytes leads me exactly to the second number:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;before -1.20124311581608E+0001
after   6.35513601506646E-0157
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="15018591" author="tlippy01" created="Fri, 20 Nov 2015 19:22:02 +0000"  >&lt;p&gt;Is this definitely a problem with the Haskell implementation?  I ask because apparently we had a similar issue with Python a while back, and I want to be sure I&apos;m not mixing an old version of Python Thrift by accident etc.&lt;/p&gt;

&lt;p&gt;Assuming it&apos;s on the Haskell side, I could take a shot at fixing it.&lt;/p&gt;

&lt;p&gt;-Tom&lt;/p&gt;</comment>
                            <comment id="15018625" author="jensg" created="Fri, 20 Nov 2015 19:38:49 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-110&quot; title=&quot;A more compact format &quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-110&quot;&gt;&lt;del&gt;THRIFT-110&lt;/del&gt;&lt;/a&gt; holds &lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12398366/compact-proto-spec-2.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;the spec for compact&lt;/a&gt;. For double it only says:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;  =&amp;gt; (8-&lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I would interpret that as &quot;double like in binary protocol&quot;, hence in network-byte-order. &lt;a href=&quot;https://wiki.apache.org/thrift/New_compact_binary_protocol&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;In the old wiki there&apos;s some more information&lt;/a&gt;. If in doubt, Java and Ruby are the ones part of the original implementation, so they probably represent the current law.&lt;/p&gt;</comment>
                            <comment id="15020727" author="nsuke" created="Sat, 21 Nov 2015 22:18:58 +0000"  >&lt;p&gt;Only checked C++, Java, Python and Haskell but it seems Compact double is little endian.&lt;br/&gt;
(Haskell alone is doing it in big endian)&lt;/p&gt;</comment>
                            <comment id="15022792" author="tlippy01" created="Mon, 23 Nov 2015 19:18:47 +0000"  >&lt;p&gt;It looks like when building a compact double, Haskell uses doubleBE, and when parsing one, it uses bsToDouble, which assumes big endian input, and checks the local machine&apos;s ordering for whether it needs to swap it to little endian (see the def of bsToDouble in Protocol.hs).  It says big endian is &quot;network order&quot;, which I guess Thrift...doesn&apos;t use?  I think the fix is pretty straightforward in either case, but I&apos;d rather someone more familiar and capable of verifying all of this do it...&lt;/p&gt;</comment>
                            <comment id="15047197" author="githubbot" created="Tue, 8 Dec 2015 18:26:58 +0000"  >&lt;p&gt;GitHub user nsuke opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/736&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/736&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-3433&quot; title=&quot;Doubles aren&amp;#39;t interpreted correctly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-3433&quot;&gt;&lt;del&gt;THRIFT-3433&lt;/del&gt;&lt;/a&gt; Doubles aren&apos;t interpreted correctly&lt;/p&gt;



&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/nsuke/thrift&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/nsuke/thrift&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-3433&quot; title=&quot;Doubles aren&amp;#39;t interpreted correctly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-3433&quot;&gt;&lt;del&gt;THRIFT-3433&lt;/del&gt;&lt;/a&gt;_&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/736.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/736.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #736&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 72d11132c8c1ee8a22ad5c2fb8da47b8e30c809e&lt;br/&gt;
Author: Nobuaki Sukegawa &amp;lt;nsuke@apache.org&amp;gt;&lt;br/&gt;
Date:   2015-12-08T18:22:35Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-3433&quot; title=&quot;Doubles aren&amp;#39;t interpreted correctly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-3433&quot;&gt;&lt;del&gt;THRIFT-3433&lt;/del&gt;&lt;/a&gt; Doubles aren&apos;t interpreted correctly&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15047444" author="githubbot" created="Tue, 8 Dec 2015 20:54:08 +0000"  >&lt;p&gt;Github user bufferoverflow commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/736#issuecomment-163014841&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/736#issuecomment-163014841&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    :+1: tested on Debian Jessie amd64&lt;/p&gt;</comment>
                            <comment id="15051274" author="githubbot" created="Thu, 10 Dec 2015 17:16:30 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/736&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/736&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15051281" author="nsuke" created="Thu, 10 Dec 2015 17:19:40 +0000"  >&lt;p&gt;Committed, thanks Roger for testing&lt;/p&gt;</comment>
                            <comment id="15051341" author="hudson" created="Thu, 10 Dec 2015 17:49:01 +0000"  >&lt;p&gt;SUCCESS: Integrated in Thrift #1764 (See &lt;a href=&quot;https://builds.apache.org/job/Thrift/1764/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Thrift/1764/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-3433&quot; title=&quot;Doubles aren&amp;#39;t interpreted correctly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-3433&quot;&gt;&lt;del&gt;THRIFT-3433&lt;/del&gt;&lt;/a&gt; Doubles aren&apos;t interpreted correctly Client: Haskell Patch: (nsuke: rev 7c7d679a127ed5157464b061a7f9bfd40ad2f1fa)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;lib/hs/src/Thrift/Protocol.hs&lt;/li&gt;
	&lt;li&gt;lib/hs/Makefile.am&lt;/li&gt;
	&lt;li&gt;lib/hs/test/CompactSpec.hs&lt;/li&gt;
	&lt;li&gt;lib/hs/test/BinarySpec.hs&lt;/li&gt;
	&lt;li&gt;lib/hs/src/Thrift/Transport/Memory.hs&lt;/li&gt;
	&lt;li&gt;lib/hs/README.md&lt;/li&gt;
	&lt;li&gt;lib/hs/src/Thrift/Protocol/Compact.hs&lt;/li&gt;
	&lt;li&gt;lib/hs/CMakeLists.txt&lt;/li&gt;
	&lt;li&gt;lib/hs/test/Spec.hs&lt;/li&gt;
	&lt;li&gt;lib/hs/LICENSE&lt;/li&gt;
	&lt;li&gt;lib/hs/Thrift.cabal&lt;/li&gt;
	&lt;li&gt;lib/hs/TODO&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 49 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2onkf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>