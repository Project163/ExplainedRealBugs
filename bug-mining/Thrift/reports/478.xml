<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 08:01:07 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[THRIFT-1184] event_base memory freeing by class TNonblockingServer</title>
                <link>https://issues.apache.org/jira/browse/THRIFT-1184</link>
                <project id="12310800" key="THRIFT">Thrift</project>
                    <description>&lt;p&gt;The TNonblockingServer::eventBase_ pointer is assigned&lt;br/&gt;
by method TNonblockingServer::registerEvents()&lt;br/&gt;
so the libevent events are added to the proper libevent event base.&lt;/p&gt;

&lt;p&gt;Currently the TNonblockingServer destructor unconditionally&lt;br/&gt;
calls event_base_free(eventBase_) to free the eventBase_ memory.&lt;/p&gt;

&lt;p&gt;In certain cases the libevent event base might be allocated and&lt;br/&gt;
deallocated by a third-party software that uses Thrift, so it is&lt;br/&gt;
not appropriate for the TNonblockingServer destructor to unconditionally&lt;br/&gt;
call event_base_free(eventBase_).&lt;/p&gt;

&lt;p&gt;Please see attached patch for a possible solution:&lt;br/&gt;
add an optional bool argument to method TNonblockingServer::registerEvents():&lt;br/&gt;
the value of that flag controls whether the TNonblockingServer destructor&lt;br/&gt;
should call event_base_free(eventBase_).&lt;/p&gt;

&lt;p&gt;The argument is optional, and defaults to true (i.e, event_base_free(eventBase_)&lt;br/&gt;
is called) for API (and behavior) backward compatibility.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12508668">THRIFT-1184</key>
            <summary>event_base memory freeing by class TNonblockingServer</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="pavlin">Pavlin Radoslavov</assignee>
                                    <reporter username="pavlin">Pavlin Radoslavov</reporter>
                        <labels>
                            <label>libevent</label>
                    </labels>
                <created>Sun, 29 May 2011 21:27:03 +0000</created>
                <updated>Thu, 8 Dec 2011 10:23:44 +0000</updated>
                            <resolved>Tue, 2 Aug 2011 23:41:08 +0000</resolved>
                                                                    <component>C++ - Library</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="13040880" author="pavlin" created="Sun, 29 May 2011 21:29:31 +0000"  >&lt;p&gt;A patch to address the issue of freeing the event_base memory.&lt;/p&gt;</comment>
                            <comment id="13055730" author="nhed" created="Mon, 27 Jun 2011 20:18:53 +0000"  >&lt;p&gt;+1 I think the feature of running TNonBlocking on an existing event_base is an important one, if there are any users that run this in a scenario that is not run-forever then this would be a show-stopper for them&lt;/p&gt;</comment>
                            <comment id="13078512" author="roger.meier" created="Tue, 2 Aug 2011 23:41:08 +0000"  >&lt;p&gt;This makes sense, Thanks Pavlin!&lt;br/&gt;
=&amp;gt; committed!&lt;/p&gt;</comment>
                            <comment id="13078531" author="hudson" created="Wed, 3 Aug 2011 00:28:41 +0000"  >&lt;p&gt;Integrated in Thrift #209 (See &lt;a href=&quot;https://builds.apache.org/job/Thrift/209/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Thrift/209/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-1184&quot; title=&quot;event_base memory freeing by class TNonblockingServer&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-1184&quot;&gt;&lt;del&gt;THRIFT-1184&lt;/del&gt;&lt;/a&gt; event_base memory freeing by class TNonblockingServer&lt;br/&gt;
adds option to use existing event base&lt;br/&gt;
Patch: Pavlin Radoslavov&lt;/p&gt;

&lt;p&gt;roger : &lt;a href=&quot;http://svn.apache.org/viewvc/?view=rev&amp;amp;rev=1153307&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc/?view=rev&amp;amp;rev=1153307&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/thrift/trunk/lib/cpp/src/server/TNonblockingServer.h&lt;/li&gt;
	&lt;li&gt;/thrift/trunk/lib/cpp/src/server/TNonblockingServer.cpp&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13165136" author="roger.meier" created="Thu, 8 Dec 2011 10:21:45 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-1442&quot; title=&quot;TNonblockingServer: Refactor to allow multiple IO Threads&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-1442&quot;&gt;&lt;del&gt;THRIFT-1442&lt;/del&gt;&lt;/a&gt; reverts this!&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12533535">THRIFT-1442</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12480803" name="thrift1184_eventbase_free.patch" size="2657" author="pavlin" created="Sun, 29 May 2011 21:29:31 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>66457</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 50 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310041" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Patch Info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10042"><![CDATA[Patch Available]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i084gf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>45321</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>