<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 08:26:46 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[THRIFT-4159] Building tests fails on MSYS2 (MinGW64) due to a (small?) linker error</title>
                <link>https://issues.apache.org/jira/browse/THRIFT-4159</link>
                <project id="12310800" key="THRIFT">Thrift</project>
                    <description>&lt;p&gt;When I build thrift in static mode with cmake, and I enable BUILD_TESTING,&lt;br/&gt;
I get a linker error:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Scanning dependencies of target SecurityTest
[ 65%] Building CXX object lib/cpp/test/CMakeFiles/SecurityTest.dir/SecurityTest.cpp.obj
[ 66%] Linking CXX executable ../../../bin/SecurityTest.exe
../../libthrift.a(TServerSocket.cpp.obj):TServerSocket.cpp:(.text+0xcb3): undefined reference to `apache::thrift::transport::TWinsockSingleton::create()&apos;
../../libthrift.a(TServerSocket.cpp.obj):TServerSocket.cpp:(.text+0xcc8): undefined reference to `thrift_socketpair(&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;, unsigned &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt;*)&apos;
../../libthrift.a(TServerSocket.cpp.obj):TServerSocket.cpp:(.text+0xcf8): undefined reference to `thrift_socketpair(&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;, unsigned &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt;*)&apos;
../../libthrift.a(TServerSocket.cpp.obj):TServerSocket.cpp:(.text+0xfa3): undefined reference to `thrift_fcntl&apos;
../../libthrift.a(TServerSocket.cpp.obj):TServerSocket.cpp:(.text+0xfc0): undefined reference to `thrift_fcntl&apos;
../../libthrift.a(TServerSocket.cpp.obj):TServerSocket.cpp:(.text+0x1127): undefined reference to `thrift_sleep(unsigned &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)&apos;
../../libthrift.a(TServerSocket.cpp.obj):TServerSocket.cpp:(.text+0x200c): undefined reference to `thrift_poll&apos;
../../libthrift.a(TServerSocket.cpp.obj):TServerSocket.cpp:(.text+0x212e): undefined reference to `thrift_fcntl&apos;
../../libthrift.a(TServerSocket.cpp.obj):TServerSocket.cpp:(.text+0x214a): undefined reference to `thrift_fcntl&apos;
../../libthrift.a(TSSLSocket.cpp.obj):TSSLSocket.cpp:(.text+0x211e): undefined reference to `thrift_poll&apos;
../../libthrift.a(TSSLSocket.cpp.obj):TSSLSocket.cpp:(.text+0x21cd): undefined reference to `thrift_poll&apos;
../../libthrift.a(TSSLSocket.cpp.obj):TSSLSocket.cpp:(.text+0x4a1a): undefined reference to `thrift_fcntl&apos;
../../libthrift.a(TSSLSocket.cpp.obj):TSSLSocket.cpp:(.text+0x4a36): undefined reference to `thrift_fcntl&apos;
../../libthrift.a(TSSLSocket.cpp.obj):TSSLSocket.cpp:(.text+0x58da): undefined reference to `thrift_fcntl&apos;
../../libthrift.a(TSSLSocket.cpp.obj):TSSLSocket.cpp:(.text+0x58f6): undefined reference to `thrift_fcntl&apos;
../../libthrift.a(TOutput.cpp.obj):TOutput.cpp:(.text+0x54): undefined reference to `thrift_ctime_r(&lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;const&lt;/span&gt;*, &lt;span class=&quot;code-object&quot;&gt;char&lt;/span&gt;*)&apos;
../../libthrift.a(TSocket.cpp.obj):TSocket.cpp:(.text+0x1e76): undefined reference to `thrift_poll&apos;
../../libthrift.a(TSocket.cpp.obj):TSocket.cpp:(.text+0x25a0): undefined reference to `thrift_fcntl&apos;
../../libthrift.a(TSocket.cpp.obj):TSocket.cpp:(.text+0x25c5): undefined reference to `thrift_fcntl&apos;
../../libthrift.a(TSocket.cpp.obj):TSocket.cpp:(.text+0x26ee): undefined reference to `thrift_poll&apos;
../../libthrift.a(TSocket.cpp.obj):TSocket.cpp:(.text+0x2749): undefined reference to `thrift_fcntl&apos;
../../libthrift.a(TSocket.cpp.obj):TSocket.cpp:(.text+0x2a0a): undefined reference to `thrift_fcntl&apos;
../../libthrift.a(TSocket.cpp.obj):TSocket.cpp:(.text+0x35f1): undefined reference to `apache::thrift::transport::TWinsockSingleton::create()&apos;
../../libthrift.a(TSocket.cpp.obj):TSocket.cpp:(.text+0x3a44): undefined reference to `thrift_gettimeofday(timeval*, timezone*)&apos;
../../libthrift.a(TSocket.cpp.obj):TSocket.cpp:(.text+0x3aaf): undefined reference to `thrift_poll&apos;
../../libthrift.a(TSocket.cpp.obj):TSocket.cpp:(.text+0x3cfc): undefined reference to `thrift_gettimeofday(timeval*, timezone*)&apos;
../../libthrift.a(TSocket.cpp.obj):TSocket.cpp:(.text+0x3d3f): undefined reference to `thrift_usleep(unsigned &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)&apos;
../../libthrift.a(TSocket.cpp.obj):TSocket.cpp:(.text+0x6443): undefined reference to `apache::thrift::transport::TWinsockSingleton::create()&apos;
collect2.exe: error: ld returned 1 exit status
make[2]: *** [lib/cpp/test/CMakeFiles/SecurityTest.dir/build.make:116: bin/SecurityTest.exe] Error 1
make[1]: *** [CMakeFiles/Makefile2:1269: lib/cpp/test/CMakeFiles/SecurityTest.dir/all] Error 2
make: *** [Makefile:161: all] Error 2
==&amp;gt; ERROR: A failure occurred in build().
    Aborting...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Typically this comes from the fact that MSYS2 is more picky about undefined&lt;br/&gt;
symbols than other platforms are. The symbols look a bit like they would&lt;br/&gt;
be defined in a basic thrift library. Could you please check if the tests&lt;br/&gt;
must link the thrift libraries and/or if a library may be missing there?&lt;/p&gt;</description>
                <environment>&lt;p&gt;MSYS2 MinGW64 compiler gcc-6.3&lt;/p&gt;</environment>
        <key id="13060981">THRIFT-4159</key>
            <summary>Building tests fails on MSYS2 (MinGW64) due to a (small?) linker error</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jking3">James E. King III</assignee>
                                    <reporter username="emmenlau">Mario Emmenlauer</reporter>
                        <labels>
                    </labels>
                <created>Sun, 2 Apr 2017 15:16:21 +0000</created>
                <updated>Sat, 20 Feb 2021 15:27:53 +0000</updated>
                            <resolved>Sat, 8 Apr 2017 04:32:21 +0000</resolved>
                                                    <fixVersion>0.11.0</fixVersion>
                                    <component>Build Process</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="15952751" author="jking3" created="Sun, 2 Apr 2017 16:23:27 +0000"  >&lt;p&gt;The Appveyor builds run every build using MSYS2/MinGW64.  Could you take a look at a successful build like &lt;a href=&quot;https://ci.appveyor.com/project/ApacheSoftwareFoundation/thrift/build/1.0.0-dev.1139&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://ci.appveyor.com/project/ApacheSoftwareFoundation/thrift/build/1.0.0-dev.1139&lt;/a&gt; and see if following how that build works answers your question?&lt;/p&gt;</comment>
                            <comment id="15961403" author="emmenlau" created="Fri, 7 Apr 2017 20:41:47 +0000"  >&lt;p&gt;I checked, but sadly it does not help. I tried now various build options from your MSYS2 and MinGW&lt;br/&gt;
appveyor configs, but I always end up with the same linker error from above. Is it possible that my&lt;br/&gt;
MSYS2 is newer, or some other difference in the environment?&lt;/p&gt;</comment>
                            <comment id="15961414" author="emmenlau" created="Fri, 7 Apr 2017 20:48:36 +0000"  >&lt;p&gt;Aha. In lib/cpp/CMakeLists.txt it reads:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (WIN32 AND NOT MSYS)
    list(APPEND thriftcpp_SOURCES
        src/thrift/windows/TWinsockSingleton.cpp
        src/thrift/windows/SocketPair.cpp
        src/thrift/windows/GetTimeOfDay.cpp
        src/thrift/windows/WinFcntl.cpp
    )
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;So this seems to disable src/thrift/windows/WinFcntl.cpp on MSYS2. The functions that are missing for me are&lt;br/&gt;
mostly (possibly all?) defined in this WinFcntl.cpp. Should this possibly be enabled on MSYS2, or why is it&lt;br/&gt;
disabled?&lt;/p&gt;</comment>
                            <comment id="15961456" author="emmenlau" created="Fri, 7 Apr 2017 21:20:01 +0000"  >&lt;p&gt;Ok I can confirm that when I modify in lib/cpp/CMakeLists.txt:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;-&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (WIN32 AND NOT MSYS)
+&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (WIN32)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;then the thrift build works on Windows 7 with MSYS2 x86 and x64 successfully.&lt;br/&gt;
I did not go far beyond the build and running the test suite, that both work.&lt;/p&gt;</comment>
                            <comment id="15961460" author="emmenlau" created="Fri, 7 Apr 2017 21:24:58 +0000"  >&lt;p&gt;See &lt;a href=&quot;https://github.com/apache/thrift/pull/1248&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/1248&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15962078" author="emmenlau" created="Sun, 9 Apr 2017 09:15:58 +0000"  >&lt;p&gt;Thanks! I have made an &quot;official&quot; MSYS2 package for thrift now. Once the PR is merged, thrift&lt;br/&gt;
binary can be installed via pacman. PR here: &lt;a href=&quot;https://github.com/Alexpux/MINGW-packages/pull/2379&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/Alexpux/MINGW-packages/pull/2379&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 32 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3d3vz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>