<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 08:26:29 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[THRIFT-4031] Go plugin generates invalid code for lists of typedef&apos;ed built-in types</title>
                <link>https://issues.apache.org/jira/browse/THRIFT-4031</link>
                <project id="12310800" key="THRIFT">Thrift</project>
                    <description>&lt;p&gt;Reproduction:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;mkdir /tmp/bug
cd /tmp/bug
cat &amp;gt;test.thrift &amp;lt;&amp;lt;EOF
typedef i32 foo

struct s {
 1:list&amp;lt;foo&amp;gt; a
}
EOF
mkdir _build
thrift -out _build --gen go:&lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt;=pkg -r test.thrift
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Then try to compile the resulting &lt;tt&gt;go build _build/pkg/test.go&lt;/tt&gt; and you&apos;ll get:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;_build/pkg/test.go:81: cannot use _elem0 (type int32) as type Foo in append
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Here&apos;s the generated code with line numbers and a couple comments I added:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;     67 func (p *S)  ReadField1(iprot thrift.TProtocol) error {
     68   _, size, err := iprot.ReadListBegin()
     69   &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; err != nil {
     70     &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; thrift.PrependError(&lt;span class=&quot;code-quote&quot;&gt;&quot;error reading list begin: &quot;&lt;/span&gt;, err)
     71   }
     72   tSlice := make([]Foo, 0, size)  &lt;span class=&quot;code-comment&quot;&gt;// The slice contain Foo values
&lt;/span&gt;     73   p.A =  tSlice
     74   &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; i := 0; i &amp;lt; size; i ++ {
     75 &lt;span class=&quot;code-keyword&quot;&gt;var&lt;/span&gt; _elem0 int32
     76     &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; v, err := iprot.ReadI32(); err != nil {
     77     &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; thrift.PrependError(&lt;span class=&quot;code-quote&quot;&gt;&quot;error reading field 0: &quot;&lt;/span&gt;, err)
     78 } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
     79     _elem0 = v
     80 }
     81     p.A = append(p.A, _elem0)  &lt;span class=&quot;code-comment&quot;&gt;// Here the code should &lt;span class=&quot;code-keyword&quot;&gt;do&lt;/span&gt; append(p.A, Foo(_elem0))
&lt;/span&gt;     82   }
     83   &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; err := iprot.ReadListEnd(); err != nil {
     84     &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; thrift.PrependError(&lt;span class=&quot;code-quote&quot;&gt;&quot;error reading list end: &quot;&lt;/span&gt;, err)
     85   }
     86   &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; nil
     87 }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This was working fine with 0.9.3 so this is a regression in 0.10.0.  With 0.9.3 the slice &lt;tt&gt;tSlice&lt;/tt&gt; is a &lt;tt&gt;[]int32&lt;/tt&gt;, as opposed to a &lt;tt&gt;[]Foo&lt;/tt&gt;.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Thrift version 0.10.0&lt;br/&gt;
go version go1.7.4 linux/386&lt;/p&gt;</environment>
        <key id="13034976">THRIFT-4031</key>
            <summary>Go plugin generates invalid code for lists of typedef&apos;ed built-in types</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dcelasun">Duru Can Celasun</assignee>
                                    <reporter username="tsuna">Benoit Sigoure</reporter>
                        <labels>
                    </labels>
                <created>Sat, 14 Jan 2017 22:03:00 +0000</created>
                <updated>Thu, 14 Dec 2017 13:54:54 +0000</updated>
                            <resolved>Sat, 4 Mar 2017 13:14:43 +0000</resolved>
                                    <version>0.10.0</version>
                                    <fixVersion>0.11.0</fixVersion>
                                    <component>Go - Compiler</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="15876861" author="calcifer" created="Tue, 21 Feb 2017 22:19:14 +0000"  >&lt;p&gt;Seems this was intentional: &lt;a href=&quot;https://github.com/apache/thrift/commit/12d430e723b020f7a8ce42a40c19edf88f948367&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/commit/12d430e723b020f7a8ce42a40c19edf88f948367&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Does it compile fine if you revert that commit?&lt;/p&gt;</comment>
                            <comment id="15876901" author="tsuna" created="Tue, 21 Feb 2017 22:42:24 +0000"  >&lt;p&gt;For the example &lt;tt&gt;.thrift&lt;/tt&gt; file that I provided, the code compile fines before this commit, but breaks after that commit.  I imagine the commit intended to fix something but broke something else in the process.&lt;/p&gt;</comment>
                            <comment id="15876908" author="calcifer" created="Tue, 21 Feb 2017 22:45:52 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jensg&quot; class=&quot;user-hover&quot; rel=&quot;jensg&quot;&gt;jensg&lt;/a&gt; that commit was a while ago, but do you remember why that was necessary? Maybe it can be reverted?&lt;/p&gt;</comment>
                            <comment id="15879218" author="jensg" created="Wed, 22 Feb 2017 20:59:11 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tsuna&quot; class=&quot;user-hover&quot; rel=&quot;tsuna&quot;&gt;tsuna&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;For the example .thrift file that I provided, the code compile fines before this commit, but breaks after that commit. I imagine the commit intended to fix something but broke something else in the process.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Why don&apos;t we add it to the usual tests?&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=calcifer&quot; class=&quot;user-hover&quot; rel=&quot;calcifer&quot;&gt;calcifer&lt;/a&gt;&lt;br/&gt;
That commit belongs to &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-2955&quot; title=&quot;Using list of typedefs does not compile on Go&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-2955&quot;&gt;&lt;del&gt;THRIFT-2955&lt;/del&gt;&lt;/a&gt;. I have to admit that I am not that deep into the subtleties of how these two (three?) issues are affecting each other. If you guys come to some solution that makes everybody happy (including myself) I will commit it. Does that sound like a plan to you?&lt;/p&gt;

</comment>
                            <comment id="15879228" author="calcifer" created="Wed, 22 Feb 2017 21:05:27 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jensg&quot; class=&quot;user-hover&quot; rel=&quot;jensg&quot;&gt;jensg&lt;/a&gt; Sounds like a plan. I&apos;ll take a shot at this over the weekend and if I end up with something decent, I&apos;ll post a PR and we can discuss it further.&lt;/p&gt;</comment>
                            <comment id="15894165" author="githubbot" created="Fri, 3 Mar 2017 11:15:40 +0000"  >&lt;p&gt;GitHub user dcelasun opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/1207&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/1207&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-4031&quot; title=&quot;Go plugin generates invalid code for lists of typedef&amp;#39;ed built-in types&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-4031&quot;&gt;&lt;del&gt;THRIFT-4031&lt;/del&gt;&lt;/a&gt;: Fix invalid Go code generation for list of typedef&apos;ed types&lt;/p&gt;

&lt;p&gt;    This commit reverts 12d430e723b020f7a8ce42a40c19edf88f948367 which caused invalid code to be generated for certain types.&lt;/p&gt;

&lt;p&gt;    See &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-4031&quot; title=&quot;Go plugin generates invalid code for lists of typedef&amp;#39;ed built-in types&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-4031&quot;&gt;&lt;del&gt;THRIFT-4031&lt;/del&gt;&lt;/a&gt; for details.&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/dcelasun/thrift&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/dcelasun/thrift&lt;/a&gt; master&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/1207.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/1207.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #1207&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit c5609762b717db771985c8d3f74befda3764d180&lt;br/&gt;
Author: D. Can Celasun &amp;lt;can@dcc.im&amp;gt;&lt;br/&gt;
Date:   2017-03-03T11:03:24Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-4031&quot; title=&quot;Go plugin generates invalid code for lists of typedef&amp;#39;ed built-in types&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-4031&quot;&gt;&lt;del&gt;THRIFT-4031&lt;/del&gt;&lt;/a&gt;: Fix invalid code generation for list of typedef&apos;ed built-in types&lt;/p&gt;

&lt;p&gt;    This commit reverts 12d430e723b020f7a8ce42a40c19edf88f948367 which&lt;br/&gt;
    caused invalid code to be generated for certain types.&lt;/p&gt;

&lt;p&gt;    See &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-4031&quot; title=&quot;Go plugin generates invalid code for lists of typedef&amp;#39;ed built-in types&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-4031&quot;&gt;&lt;del&gt;THRIFT-4031&lt;/del&gt;&lt;/a&gt; for details.&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15895670" author="jensg" created="Sat, 4 Mar 2017 13:14:43 +0000"  >&lt;p&gt;Committed.&lt;/p&gt;</comment>
                            <comment id="15895671" author="githubbot" created="Sat, 4 Mar 2017 13:14:50 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/thrift/pull/1207&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/thrift/pull/1207&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                            <outwardlinks description="depends upon">
                                        <issuelink>
            <issuekey id="12770661">THRIFT-2955</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 37 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i38pyv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>