<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 07:58:48 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[THRIFT-932] Haskell tests need to be run through &apos;make check&apos; (and probably &apos;cabal check&apos;) too</title>
                <link>https://issues.apache.org/jira/browse/THRIFT-932</link>
                <project id="12310800" key="THRIFT">Thrift</project>
                    <description>&lt;p&gt;Currently Haskell tests are run through an annoying pair of shell scripts, and leave the server running after being executed.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Mac OS X 10.6, latest haskell platform, ghc 6.12.3&lt;/p&gt;

&lt;p&gt;Darwin 10.4.0 Darwin Kernel Version 10.4.0: Fri Apr 23 18:28:53 PDT 2010; root:xnu-1504.7.4~1/RELEASE_I386 i386&lt;br/&gt;
The Glorious Glasgow Haskell Compilation System, version 6.12.3&lt;/p&gt;</environment>
        <key id="12475267">THRIFT-932</key>
            <summary>Haskell tests need to be run through &apos;make check&apos; (and probably &apos;cabal check&apos;) too</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="clavoie">Christian Lavoie</assignee>
                                    <reporter username="clavoie">Christian Lavoie</reporter>
                        <labels>
                    </labels>
                <created>Tue, 28 Sep 2010 01:20:38 +0000</created>
                <updated>Wed, 6 Oct 2010 00:12:47 +0000</updated>
                            <resolved>Wed, 6 Oct 2010 00:12:47 +0000</resolved>
                                    <version>0.6</version>
                                    <fixVersion>0.6</fixVersion>
                                    <component>Haskell - Library</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="12915582" author="clavoie" created="Tue, 28 Sep 2010 01:25:45 +0000"  >&lt;p&gt;This fix a few annoyances with the current tests:&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;Two scripts to run to run the tests&lt;/li&gt;
	&lt;li&gt;The server bits are left running and need to be Ctrl-C&apos;ed&lt;/li&gt;
	&lt;li&gt;Specifying where to find the &lt;tt&gt;thrift&lt;/tt&gt; binary THRIFT_BIN is needed (or the code needs to be compiled and installed first, so that it&apos;s in your path)&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;After this patch, tests can be run thusly:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;$ for TEST in ConstantsDemo DebugProtoTest ThriftTest ; do echo -------------------------------- $TEST -------------------------------- ; ./run-test.sh $TEST; done &amp;gt;&amp;amp; out
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;See &apos;out&apos; file for a sample output; not pretty, but works.&lt;/p&gt;

&lt;p&gt;This could be committed as is (I could even be convinced it&apos;s good enough for 0.5), but is NOT enough to fix this bug.&lt;/p&gt;</comment>
                            <comment id="12917882" author="clavoie" created="Tue, 5 Oct 2010 05:24:57 +0000"  >&lt;p&gt;Same as v1, re-synced to HEAD. Apply with &lt;tt&gt;patch -p0 -E&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;As it stands, it doesn&apos;t fix this bug, but it&apos;s self-contained and makes it much easier to run haskell tests. It&apos;s a great first step; next steps ought to be simple mucking around with autotools. Before:&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;run/helper scripts don&apos;t give useful info when reporting &apos;user errors&apos;&lt;/li&gt;
	&lt;li&gt;Tests are split in two: Server, Client. The server needs to be started first, and is then left running after tests&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;After:&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;Tests are combined/self-contained (each test is a process talking to itself through a TCP socket) that correctly exits after running&lt;/li&gt;
	&lt;li&gt;There&apos;s a single run script&lt;/li&gt;
	&lt;li&gt;run script has improved error messages&lt;/li&gt;
	&lt;li&gt;run script defaults to the thrift binary compiled in the current source directory instead of those in PATH&lt;/li&gt;
&lt;/ol&gt;
</comment>
                            <comment id="12918150" author="clavoie" created="Tue, 5 Oct 2010 20:34:13 +0000"  >&lt;p&gt;Superset of v2 patch &amp;#8211; this has all the same features as v2, and as a bonus hooks both &lt;tt&gt;cabal check&lt;/tt&gt; and running the tests to &lt;tt&gt;make check&lt;/tt&gt;.&lt;/p&gt;</comment>
                            <comment id="12918324" author="bryanduxbury" created="Tue, 5 Oct 2010 23:39:39 +0000"  >&lt;p&gt;Feel like this is ready to be commmitted?&lt;/p&gt;</comment>
                            <comment id="12918328" author="clavoie" created="Tue, 5 Oct 2010 23:44:55 +0000"  >&lt;p&gt;It works for me, and v3 is a full resolution of the bug.&lt;/p&gt;

&lt;p&gt;The only caveat is the dependency on the &lt;tt&gt;http&lt;/tt&gt;, &lt;tt&gt;binary&lt;/tt&gt; and &lt;tt&gt;network&lt;/tt&gt; packages that aren&apos;t part of the std install; but if you can make it work on your machine, do please commit, yes. Easiest path to making it work:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;sudo cabal install http binary network
cd $REPOS
./configure
make check
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;If you don&apos;t like using root powers:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;cabal --user install http binary network
cd $REPOS
CABAL_CONFIGURE_FLAGS=&quot;--user&quot; ./configure
make check
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="12918346" author="bryanduxbury" created="Wed, 6 Oct 2010 00:12:47 +0000"  >&lt;p&gt;I just committed this. Thanks for the patch, Christian!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12456431" name="haskell-tests.log" size="89635" author="clavoie" created="Tue, 5 Oct 2010 20:34:13 +0000"/>
                            <attachment id="12455790" name="out" size="8561" author="clavoie" created="Tue, 28 Sep 2010 01:25:45 +0000"/>
                            <attachment id="12455789" name="v1-simplify-haskell-tests.hs" size="42223" author="clavoie" created="Tue, 28 Sep 2010 01:25:45 +0000"/>
                            <attachment id="12456365" name="v2-simplify-haskell-tests.patch" size="42596" author="clavoie" created="Tue, 5 Oct 2010 05:24:57 +0000"/>
                            <attachment id="12456430" name="v3-haskell-tests-through-make-check.patch" size="45328" author="clavoie" created="Tue, 5 Oct 2010 20:34:13 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>187063</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 years, 8 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i16dnr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>245345</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>