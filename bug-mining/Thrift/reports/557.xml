<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 08:04:29 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[THRIFT-1267] Node.js can&apos;t throw exceptions. </title>
                <link>https://issues.apache.org/jira/browse/THRIFT-1267</link>
                <project id="12310800" key="THRIFT">Thrift</project>
                    <description>&lt;p&gt;There is no way as far as I can tell for node.js servers to throw thrift exceptions.&lt;/p&gt;

&lt;p&gt;I have made a patch to allow it to throw exceptions. It lets the node.js server implementation give params directly to the result object, thereby being able to specify the exception. It doesn&apos;t affect normal (non exception) return data.&lt;/p&gt;

&lt;p&gt;Test case: &lt;a href=&quot;https://gist.github.com/1151782&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gist.github.com/1151782&lt;/a&gt;&lt;br/&gt;
Install thrift module &quot;npm install thrift&quot;, generate thrift &quot;thrift --gen js:node test.thrift&quot; and run server then client.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12519133">THRIFT-1267</key>
            <summary>Node.js can&apos;t throw exceptions. </summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="henrique">Henrique Mendonca</assignee>
                                    <reporter username="cypres">Hans Duedal</reporter>
                        <labels>
                            <label>compiler</label>
                            <label>javascript</label>
                            <label>node</label>
                            <label>nodejs</label>
                    </labels>
                <created>Wed, 17 Aug 2011 15:31:21 +0000</created>
                <updated>Sun, 15 Apr 2012 12:21:33 +0000</updated>
                            <resolved>Thu, 12 Jan 2012 21:38:58 +0000</resolved>
                                    <version>0.7</version>
                                    <fixVersion>0.9</fixVersion>
                                    <component>JavaScript - Compiler</component>
                    <component>Node.js - Compiler</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="13086388" author="cypres" created="Wed, 17 Aug 2011 15:32:54 +0000"  >&lt;p&gt;Applies to both 0.7.x and trunk atm.&lt;/p&gt;</comment>
                            <comment id="13086436" author="wadey" created="Wed, 17 Aug 2011 16:34:00 +0000"  >&lt;p&gt;I wonder if we should instead make a backwards incompatible change for the 0.8 release and change the callback style to match the rest of Node.js: callback(err, result). instead of the current: callback(result).&lt;/p&gt;</comment>
                            <comment id="13089710" author="pquerna" created="Tue, 23 Aug 2011 20:06:42 +0000"  >&lt;p&gt;+1 to incompatible change to use the node.js style of callback(err, result);  All of our existing code uses this style, and it is essential when dealing with async handlers in a service.&lt;/p&gt;</comment>
                            <comment id="13089730" author="wadey" created="Tue, 23 Aug 2011 20:32:32 +0000"  >&lt;p&gt;It looks like Russell Haering has a good example of how this should look:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://gist.github.com/1098395&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gist.github.com/1098395&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I&apos;ll start working on a patch for this next week if no-one jumps in.&lt;/p&gt;</comment>
                            <comment id="13091052" author="cypres" created="Thu, 25 Aug 2011 14:57:26 +0000"  >&lt;p&gt;New patch, with callback(err, result) instead. &lt;br/&gt;
Updated gist:1151782 usecase also.&lt;br/&gt;
Should support syntax from gist:1098395 (Russel Haering) as well.&lt;/p&gt;

&lt;p&gt;Implemented it using instanceof and early returns. What do you think?&lt;/p&gt;</comment>
                            <comment id="13098859" author="cypres" created="Wed, 7 Sep 2011 11:33:34 +0000"  >&lt;p&gt;New version. The previous one didn&apos;t get the namespace right for exceptions that where included from other files.&lt;/p&gt;</comment>
                            <comment id="13118876" author="vicapow" created="Sat, 1 Oct 2011 18:41:50 +0000"  >&lt;p&gt;I&apos;m new to this project but this is a show stopper for Node.JS usage. I dont consider it a priority to support backwards compatibility with the old mechanism or waiting until 0.8 release to commit this fix.&lt;/p&gt;</comment>
                            <comment id="13144682" author="jfarrell" created="Sat, 5 Nov 2011 13:25:40 +0000"  >&lt;p&gt;Hans, can you please add the test cases into the lib/test for this&lt;/p&gt;</comment>
                            <comment id="13183175" author="henrique" created="Tue, 10 Jan 2012 10:08:51 +0000"  >&lt;p&gt;I was trying to extend Roger&apos;s new test.sh to use a nodejs server but I noticed that the compiler wasn&apos;t working any more... no exceptions, namespaces, etc. I&apos;ve also create a first draft of a test server (see attached &lt;b&gt;test/nodejs/server.js&lt;/b&gt;)&lt;br/&gt;
under thrift/test run:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;../compiler/cpp/thrift --gen js:node -o ./nodejs ThriftTest.thrift
export NODE_PATH=../lib/nodejs/lib/thrift/
node nodejs/server.js
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I had to re-base this old patch &apos;thrift-1267-callback-ns-fix.patch&apos; and make some other small changes. Please someone have a look/test and commit this. Otherwise we won&apos;t be able to use nodejs.&lt;/p&gt;

&lt;p&gt;That&apos;s what I was trying to archive, if anyone wants to have a look, I think there is still something missing since it doesn&apos;t seem to close the stream properly... (I only see the first test)&lt;br/&gt;
&lt;b&gt;test/test.sh:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;do_test &lt;span class=&quot;code-quote&quot;&gt;&quot;cpp-nodejs&quot;&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;binary&quot;&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;buffered-ip&quot;&lt;/span&gt; \
        &lt;span class=&quot;code-quote&quot;&gt;&quot;cpp/TestClient&quot;&lt;/span&gt; \
        &lt;span class=&quot;code-quote&quot;&gt;&quot;node nodejs/server.js&quot;&lt;/span&gt; \
        &lt;span class=&quot;code-quote&quot;&gt;&quot;1&quot;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Thanks&lt;/p&gt;</comment>
                            <comment id="13183570" author="roger.meier" created="Tue, 10 Jan 2012 21:11:59 +0000"  >&lt;p&gt;Would be great to add all that stuff!&lt;br/&gt;
I&apos;m currently not familiar with node...&lt;/p&gt;

&lt;p&gt;I have the same issue with the testcase, just shows the first test case.&lt;br/&gt;
The other thing is, that the &lt;span class=&quot;error&quot;&gt;&amp;#91;^THRIFT-1267-ns-fixes.patch&amp;#93;&lt;/span&gt; breaks the examples located at lib/nodejs/examples/&lt;/p&gt;
</comment>
                            <comment id="13184390" author="henrique" created="Wed, 11 Jan 2012 20:59:55 +0000"  >&lt;p&gt;OK thanks for the feedback Roger,&lt;br/&gt;
a line too much in the compiler and the client were outdated (see comments above). The example should work again now.&lt;/p&gt;

&lt;p&gt;I&apos;m also adding the 4 files I have under test/nodejs, including a package.json but it wasn&apos;t tested with npm.&lt;/p&gt;

&lt;p&gt;The client.js is just a start, it only test a 12 of the services and it would look a lot nicer with qunit, but it&apos;d add a dependency...&lt;/p&gt;

&lt;p&gt;From these few unit tests we can see already that a lot of stuff is not working as it should, e.g. int64 (negative and large values), maps and services with exceptions only work partially (app. exceptions come as &apos;null&apos; and nothing comes back on success)&lt;/p&gt;

&lt;p&gt;Anyway, I think that&apos;s an improvement already.&lt;/p&gt;




</comment>
                            <comment id="13185259" author="roger.meier" created="Thu, 12 Jan 2012 21:38:58 +0000"  >&lt;p&gt;Yes, this is a improvement =&amp;gt; committed!&lt;br/&gt;
Thanks Henrique!&lt;/p&gt;</comment>
                            <comment id="13185320" author="hudson" created="Thu, 12 Jan 2012 23:00:55 +0000"  >&lt;p&gt;Integrated in Thrift #385 (See &lt;a href=&quot;https://builds.apache.org/job/Thrift/385/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Thrift/385/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-1267&quot; title=&quot;Node.js can&amp;#39;t throw exceptions. &quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-1267&quot;&gt;&lt;del&gt;THRIFT-1267&lt;/del&gt;&lt;/a&gt; Node.js can&apos;t throw exceptions&lt;br/&gt;
Patch: Henrique Mendonca&lt;/p&gt;

&lt;p&gt;roger : &lt;a href=&quot;http://svn.apache.org/viewvc/?view=rev&amp;amp;rev=1230797&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc/?view=rev&amp;amp;rev=1230797&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/thrift/trunk/.gitignore&lt;/li&gt;
	&lt;li&gt;/thrift/trunk/compiler/cpp/src/generate/t_js_generator.cc&lt;/li&gt;
	&lt;li&gt;/thrift/trunk/configure.ac&lt;/li&gt;
	&lt;li&gt;/thrift/trunk/lib/nodejs/examples/Makefile&lt;/li&gt;
	&lt;li&gt;/thrift/trunk/lib/nodejs/examples/server.js&lt;/li&gt;
	&lt;li&gt;/thrift/trunk/lib/nodejs/examples/server_multitransport.js&lt;/li&gt;
	&lt;li&gt;/thrift/trunk/test/Makefile.am&lt;/li&gt;
	&lt;li&gt;/thrift/trunk/test/nodejs&lt;/li&gt;
	&lt;li&gt;/thrift/trunk/test/nodejs/Makefile.am&lt;/li&gt;
	&lt;li&gt;/thrift/trunk/test/nodejs/client.js&lt;/li&gt;
	&lt;li&gt;/thrift/trunk/test/nodejs/package.json&lt;/li&gt;
	&lt;li&gt;/thrift/trunk/test/nodejs/server.js&lt;/li&gt;
	&lt;li&gt;/thrift/trunk/test/test.sh&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310010">
                    <name>Incorporates</name>
                                            <outwardlinks description="incorporates">
                                        <issuelink>
            <issuekey id="12503783">THRIFT-1134</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12510246" name="Makefile" size="1027" author="henrique" created="Wed, 11 Jan 2012 20:59:55 +0000"/>
                            <attachment id="12510247" name="THRIFT-1267-ex-ns-fixes+tests.patch" size="7633" author="henrique" created="Wed, 11 Jan 2012 20:59:55 +0000"/>
                            <attachment id="12510245" name="client.js" size="4121" author="henrique" created="Wed, 11 Jan 2012 20:59:55 +0000"/>
                            <attachment id="12490664" name="nodejs-exception.patch" size="1334" author="cypres" created="Wed, 17 Aug 2011 15:32:54 +0000"/>
                            <attachment id="12510243" name="package.json" size="847" author="henrique" created="Wed, 11 Jan 2012 20:59:55 +0000"/>
                            <attachment id="12510244" name="server.js" size="5571" author="henrique" created="Wed, 11 Jan 2012 20:59:55 +0000"/>
                            <attachment id="12493302" name="thrift-1267-callback-ns-fix.patch" size="2139" author="cypres" created="Wed, 7 Sep 2011 11:33:33 +0000"/>
                            <attachment id="12491642" name="thrift-1267-callback.patch" size="2145" author="cypres" created="Thu, 25 Aug 2011 14:57:26 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>8.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>42950</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 45 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310041" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Patch Info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10042"><![CDATA[Patch Available]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i083rr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>45210</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>