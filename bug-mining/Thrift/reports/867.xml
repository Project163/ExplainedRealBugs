<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 08:10:17 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[THRIFT-2285] TJsonProtocol implementation for Java doesn&apos;t allow a slash (/) to be escaped (\/)</title>
                <link>https://issues.apache.org/jira/browse/THRIFT-2285</link>
                <project id="12310800" key="THRIFT">Thrift</project>
                    <description>&lt;p&gt;We have PHP frontend and Java backend. Thrift is used for interaction between the two, entities are serialized and deserialized using TJsonProtocol.&lt;/p&gt;

&lt;p&gt;Whenever a string in a thrift entity contains a slash &quot;/&quot;, PHP&apos;s implementation, that uses &lt;tt&gt;json_encode&lt;/tt&gt; under the hood, escapes it:&lt;/p&gt;

&lt;p&gt;&quot;Translation eng/rus&quot; =&amp;gt; &quot;Translation eng\/rus&quot;. So the payload may look like this:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;{&quot;1&quot;:{&quot;str&quot;:&quot;Translation  rus\/eng&quot;}}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;(assuming that the entity only has this one string property)&lt;/p&gt;

&lt;p&gt;Java cannot handle this input and fails with:&lt;/p&gt;

&lt;p&gt;org.apache.thrift.protocol.TProtocolException: Expected control char&lt;/p&gt;

&lt;p&gt;Java does not allow a slash to be escaped. &lt;br/&gt;
Thrift version is 0.9.1&lt;/p&gt;

&lt;p&gt;Any advice on what to do for a temporary solution? Should we fix Java side or PHP side? &lt;/p&gt;

&lt;p&gt;As per json.org, a slash CAN be escaped. To me it looks more like Java is not standard compliant in this case. At the same time, however, I don&apos;t like the ambiguity of the standard allowing both unescaped and escaped slash.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12683899">THRIFT-2285</key>
            <summary>TJsonProtocol implementation for Java doesn&apos;t allow a slash (/) to be escaped (\/)</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jensg">Jens Geyer</assignee>
                                    <reporter username="lcf">Alexander Steshenko</reporter>
                        <labels>
                    </labels>
                <created>Tue, 10 Dec 2013 19:21:01 +0000</created>
                <updated>Sun, 23 Feb 2014 18:46:04 +0000</updated>
                            <resolved>Sun, 23 Feb 2014 18:46:04 +0000</resolved>
                                                    <fixVersion>0.9.2</fixVersion>
                                    <component>Java - Library</component>
                    <component>JavaME - Library</component>
                    <component>PHP - Library</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                                                            <comments>
                            <comment id="13844646" author="jensg" created="Tue, 10 Dec 2013 20:43:13 +0000"  >&lt;p&gt;How about fixing the JSON readers &lt;b&gt;only&lt;/b&gt; (all affected languages), so they are able to process both variants? The wire format would be left untouched.&lt;/p&gt;</comment>
                            <comment id="13856587" author="jensg" created="Wed, 25 Dec 2013 12:52:30 +0000"  >&lt;p&gt;The best way to spread errors is copy and paste - or duplicating the algorithm in another language &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; However, makes it easy to fix them all&lt;/p&gt;</comment>
                            <comment id="13856590" author="jensg" created="Wed, 25 Dec 2013 13:04:18 +0000"  >&lt;p&gt;The patch fixes Java, Javame and PHP&lt;/p&gt;</comment>
                            <comment id="13856905" author="roger.meier" created="Thu, 26 Dec 2013 15:18:05 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="13856967" author="jensg" created="Thu, 26 Dec 2013 18:03:57 +0000"  >&lt;p&gt;Thanks, committed.&lt;/p&gt;</comment>
                            <comment id="13856977" author="hudson" created="Thu, 26 Dec 2013 18:14:59 +0000"  >&lt;p&gt;FAILURE: Integrated in Thrift #958 (See &lt;a href=&quot;https://builds.apache.org/job/Thrift/958/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Thrift/958/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-2285&quot; title=&quot;TJsonProtocol implementation for Java doesn&amp;#39;t allow a slash (/) to be escaped (\/)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-2285&quot;&gt;&lt;del&gt;THRIFT-2285&lt;/del&gt;&lt;/a&gt; TJsonProtocol implementation for Java/JavaMe/PHP doesn&apos;t allow a slash &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/check.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; to be escaped (\/) (jensg: rev 797595049274b9085385de5ef402075f6fc3de56)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;lib/javame/src/org/apache/thrift/protocol/TJSONProtocol.java&lt;/li&gt;
	&lt;li&gt;lib/java/src/org/apache/thrift/protocol/TJSONProtocol.java&lt;/li&gt;
	&lt;li&gt;lib/php/lib/Thrift/Protocol/TJSONProtocol.php&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13885597" author="lcf" created="Wed, 29 Jan 2014 18:04:31 +0000"  >&lt;p&gt;I&apos;m re-opening this issue to get some attention. Please close it again, if it&apos;s not important enough or I&apos;m breaking some workflow with this.&lt;/p&gt;

&lt;p&gt;The change done to PHP&apos;s library doesn&apos;t do anything: the variable &lt;tt&gt;$ESCAPE_CHARS&lt;/tt&gt; is not used anywhere. Instead json_encode and json_decode built-in functions are used.&lt;/p&gt;

&lt;p&gt;Now JAVA can understand PHP and this is good enough for now, but ideally, the JSON should be the same whatever language&apos;s library has generated it.&lt;/p&gt;</comment>
                            <comment id="13885738" author="jensg" created="Wed, 29 Jan 2014 20:09:11 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lcf&quot; class=&quot;user-hover&quot; rel=&quot;lcf&quot;&gt;lcf&lt;/a&gt;,&lt;/p&gt;

&lt;p&gt;feel free to submit a patch cleaning up the code. I have only modified things that already existed. If the stuff is not used at all, it should be removed. And it should probably be a new ticket.&lt;/p&gt;
</comment>
                            <comment id="13909841" author="jfarrell" created="Sun, 23 Feb 2014 18:46:04 +0000"  >&lt;p&gt;Closing this as the issues described have been resolved. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lcf&quot; class=&quot;user-hover&quot; rel=&quot;lcf&quot;&gt;lcf&lt;/a&gt; can you please open a new issue for the further work/investigation on this topic&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12620422" name="THRIFT-2285_JSON_forward_slash_solidus_decoding_java-javame-php.patch" size="2726" author="jensg" created="Wed, 25 Dec 2013 13:04:18 +0000"/>
                    </attachments>
                <subtasks>
                            <subtask id="12686348">THRIFT-2297</subtask>
                            <subtask id="12686349">THRIFT-2298</subtask>
                            <subtask id="12686350">THRIFT-2299</subtask>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>362971</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 39 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1qkfz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>363277</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>