<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 08:05:50 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[THRIFT-1414] bufferoverflow in c_glib buffered transport/socket client</title>
                <link>https://issues.apache.org/jira/browse/THRIFT-1414</link>
                <project id="12310800" key="THRIFT">Thrift</project>
                    <description>&lt;p&gt;Quote of comment in source:&lt;br/&gt;
-----------------------------------------------&lt;br/&gt;
if the buffer is still smaller than what we&lt;br/&gt;
want to read, then just read it directly.&lt;br/&gt;
-----------------------------------------------&lt;/p&gt;

&lt;p&gt;But the code reading into the tempdata with size of the buffer and reading all data into this.&lt;br/&gt;
file: lib/c_glib/transport/thrift_buffered_transport.c line 74/98&lt;/p&gt;


&lt;p&gt;Also if the buffer is still bigger that what we want to read, then reading the buffer size.&lt;br/&gt;
But recv blocks than and waiting of data if there nothing to read after the receiving data len.&lt;br/&gt;
file: lib/c_glib/transport/thrift_buffered_transport.c line 118&lt;/p&gt;

&lt;p&gt;i attached a patch that fix this problems but i dont know if all of this is correct.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Server running on Windows 7 SP1 64bit based on csharp.&lt;br/&gt;
Client running on Ubuntu 11.04 Server 64 bit (fresh install) based on c_glib.&lt;br/&gt;
svn rev: 1190015M&lt;/p&gt;</environment>
        <key id="12529415">THRIFT-1414</key>
            <summary>bufferoverflow in c_glib buffered transport/socket client</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="-nighty-">Christian Zimnick</reporter>
                        <labels>
                    </labels>
                <created>Sun, 30 Oct 2011 17:33:57 +0000</created>
                <updated>Wed, 24 Oct 2012 18:52:15 +0000</updated>
                            <resolved>Wed, 17 Oct 2012 22:06:17 +0000</resolved>
                                    <version>0.7</version>
                                                    <component>C glib - Library</component>
                        <due></due>
                            <votes>3</votes>
                                    <watches>6</watches>
                                    <workratio workratioPercent="0"/>
                                    <progress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                    <timeoriginalestimate seconds="600">10m</timeoriginalestimate>
                            <timeestimate seconds="600">10m</timeestimate>
                                        <comments>
                            <comment id="13471310" author="roger.meier" created="Sun, 7 Oct 2012 20:05:51 +0000"  >&lt;p&gt;duplicate was fixed: &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-1654&quot; title=&quot;c_glib thrift_socket_read() returns corrupted data&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-1654&quot;&gt;&lt;del&gt;THRIFT-1654&lt;/del&gt;&lt;/a&gt; &lt;/p&gt;</comment>
                            <comment id="13474920" author="andris" created="Fri, 12 Oct 2012 09:44:06 +0000"  >&lt;p&gt;Can you tell where is this fix ? Cannot find it in trunk yet.&lt;/p&gt;</comment>
                            <comment id="13475046" author="jfarrell" created="Fri, 12 Oct 2012 14:58:39 +0000"  >&lt;p&gt;Andris, not sure why the status was changed not his ticket without the patch being added. Can you please rebase the patch against trunk. thanks&lt;/p&gt;</comment>
                            <comment id="13475051" author="andris" created="Fri, 12 Oct 2012 15:04:29 +0000"  >&lt;p&gt;The patch was contributed by Christian Zimnick.&lt;/p&gt;</comment>
                            <comment id="13477702" author="mikeg" created="Wed, 17 Oct 2012 07:49:44 +0000"  >&lt;p&gt;The attached patch can be applied to 0.9.0.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;--- thrift-0.9.0/lib/c_glib/src/thrift/transport/thrift_socket.c.orig	2012-10-17 09:15:16.000000000 +0200
+++ thrift-0.9.0/lib/c_glib/src/thrift/transport/thrift_socket.c	2012-10-17 09:15:48.000000000 +0200
@@ -129,7 +129,7 @@
 
   &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; (got &amp;lt; len)
   {
-    ret = recv (socket-&amp;gt;sd, buf, len, 0);
+    ret = recv (socket-&amp;gt;sd, buf+got, len-got, 0);
     &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (ret &amp;lt; 0)
     {
       g_set_error (error, THRIFT_TRANSPORT_ERROR,
--- thrift-0.9.0/lib/c_glib/src/thrift/transport/thrift_buffered_transport.c.orig	2012-10-17 09:16:07.000000000 +0200
+++ thrift-0.9.0/lib/c_glib/src/thrift/transport/thrift_buffered_transport.c	2012-10-17 09:17:26.000000000 +0200
@@ -71,7 +71,7 @@
   ThriftBufferedTransport *t = THRIFT_BUFFERED_TRANSPORT (transport);
   guint32 want = len;
   guint32 got = 0;
-  guchar tmpdata[t-&amp;gt;r_buf_size];
+  guchar tmpdata[len];
   guint32 have = t-&amp;gt;r_buf-&amp;gt;len;
 
   &lt;span class=&quot;code-comment&quot;&gt;// we shouldn&lt;span class=&quot;code-quote&quot;&gt;&apos;t hit &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; unless the buffer doesn&apos;&lt;/span&gt;t have enough to read
&lt;/span&gt;@@ -101,7 +101,7 @@
   } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
     got += THRIFT_TRANSPORT_GET_CLASS (t-&amp;gt;transport)-&amp;gt;read (t-&amp;gt;transport,
                                                             tmpdata,
-                                                            t-&amp;gt;r_buf_size,
+                                                            want,
                                                             error);
     t-&amp;gt;r_buf = g_byte_array_append (t-&amp;gt;r_buf, tmpdata, got);
     

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13478443" author="roger.meier" created="Wed, 17 Oct 2012 22:06:17 +0000"  >&lt;p&gt;thanks!&lt;/p&gt;</comment>
                            <comment id="13478600" author="hudson" created="Thu, 18 Oct 2012 02:09:26 +0000"  >&lt;p&gt;Integrated in Thrift #566 (See &lt;a href=&quot;https://builds.apache.org/job/Thrift/566/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Thrift/566/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-1414&quot; title=&quot;bufferoverflow in c_glib buffered transport/socket client&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-1414&quot;&gt;&lt;del&gt;THRIFT-1414&lt;/del&gt;&lt;/a&gt; bufferoverflow in c_glib buffered transport/socket client &lt;br/&gt;
Patch: Christian Zimnick (Revision 1399452)&lt;/p&gt;

&lt;p&gt;     Result = ABORTED&lt;br/&gt;
roger : &lt;a href=&quot;http://svn.apache.org/viewvc/?view=rev&amp;amp;rev=1399452&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc/?view=rev&amp;amp;rev=1399452&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/thrift/trunk/lib/c_glib/src/thrift/transport/thrift_buffered_transport.c&lt;/li&gt;
	&lt;li&gt;/thrift/trunk/lib/c_glib/src/thrift/transport/thrift_socket.c&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12600025">THRIFT-1654</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12501520" name="THRIFT-1414.patch" size="1774" author="-nighty-" created="Sun, 30 Oct 2011 17:36:13 +0000"/>
                            <attachment id="12549460" name="thrift-0.9.0-c_glib-jira1414.patch" size="1412" author="mikeg" created="Wed, 17 Oct 2012 07:49:44 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>215275</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 5 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310041" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Patch Info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10042"><![CDATA[Patch Available]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i05xc7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>32500</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>