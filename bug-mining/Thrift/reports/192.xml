<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 07:56:35 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[THRIFT-547] Thrift deserializer hangs when deserializing empty string</title>
                <link>https://issues.apache.org/jira/browse/THRIFT-547</link>
                <project id="12310800" key="THRIFT">Thrift</project>
                    <description>&lt;p&gt;Expect this to throw an error on empty strings and any other strings that cannot be deserialized. Here is some code to reproduce:&lt;/p&gt;

&lt;p&gt;require &apos;thrift&apos;&lt;br/&gt;
class MyClass&lt;br/&gt;
  include ::Thrift::Struct&lt;br/&gt;
  FIELDS = {}&lt;br/&gt;
  def struct_fields; FIELDS; end&lt;br/&gt;
  def validate; end&lt;br/&gt;
end&lt;br/&gt;
deserializer = Thrift::Deserializer.new(Thrift::CompactProtocolFactory.new)&lt;br/&gt;
deserializer.deserialize(MyClass.new, &apos;&apos;) ###### hangs &lt;/p&gt;</description>
                <environment>&lt;p&gt;ruby 1.8.6&lt;/p&gt;</environment>
        <key id="12431098">THRIFT-547</key>
            <summary>Thrift deserializer hangs when deserializing empty string</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="bryanduxbury">Bryan Duxbury</assignee>
                                    <reporter username="dayo">Dayo Esho</reporter>
                        <labels>
                    </labels>
                <created>Wed, 22 Jul 2009 01:32:35 +0000</created>
                <updated>Tue, 1 Nov 2011 02:54:21 +0000</updated>
                            <resolved>Fri, 31 Jul 2009 18:53:51 +0000</resolved>
                                    <version>0.1</version>
                                                    <component>Ruby - Library</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12736693" author="bryanduxbury" created="Wed, 29 Jul 2009 16:30:27 +0000"  >&lt;p&gt;This patch solves the problem. If the MemoryBuffer can&apos;t return the number of bytes requested, you get an EOFError now, which prevents the endless looping.&lt;/p&gt;</comment>
                            <comment id="12737007" author="kclark" created="Thu, 30 Jul 2009 05:51:50 +0000"  >&lt;p&gt;There&apos;s a ruby-debug require in base_transport_spec that needs to be removed. &lt;/p&gt;

&lt;p&gt;Also, I think maybe we&apos;re raising too early. I think if you ask for more data than exists, the data that can be fetched should be returned, just like transports on the wire. Once we get to 0 bytes though, I agree, we should be raising. eg: &lt;/p&gt;

&lt;p&gt;assume transport has &quot;foobar&quot; in it &lt;/p&gt;

&lt;p&gt;@transport.read(10) # =&amp;gt; &quot;foobar&quot; &lt;br/&gt;
@transport.available == 0 # =&amp;gt; true &lt;br/&gt;
@transport.read(10) # raises &lt;/p&gt;

&lt;p&gt;That way if a user is just asking for the most data they&apos;d like to store (just give me up to 1k, 4k, etc) things work as expected, but once the buffer is empty we get the exception that&apos;s expected. What do you think?&lt;/p&gt;</comment>
                            <comment id="12737150" author="bryanduxbury" created="Thu, 30 Jul 2009 15:55:32 +0000"  >&lt;p&gt;I see what you are saying. I&apos;m thinking it&apos;s just not really useful in this circumstance though. All Thrift transports are tailor-made for serialization and deserialization, and Thrift structs don&apos;t just pull in a big blob of data from a memory transport - they get exactly the number of bytes they expect to be there. The first time there is an underrun, it&apos;s fatal. If we raised only once there was finally exactly zero bytes available, it wouldn&apos;t change anything. The error would just come on the second iteration of read_all instead of the first.&lt;/p&gt;</comment>
                            <comment id="12737318" author="kclark" created="Thu, 30 Jul 2009 21:57:48 +0000"  >&lt;p&gt;Yeah, the goal is that it doesn&apos;t, functionally, change anything, but the behavior is more consistent with the other transports.&lt;/p&gt;

&lt;p&gt;But that&apos;s not a blocker for me. I think it&apos;s more important to get the patch in. I&apos;d +1 it post ruby-debug removal if you feel strongly about it.&lt;/p&gt;</comment>
                            <comment id="12737658" author="bryanduxbury" created="Fri, 31 Jul 2009 18:53:51 +0000"  >&lt;p&gt;Ok, I removed the ruby-debug require and committed. Thanks for the review. I hope the way I fixed this issue won&apos;t come up again &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12414921" name="thrift-547.patch" size="8883" author="bryanduxbury" created="Wed, 29 Jul 2009 16:30:27 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>38641</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            16 years, 17 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310041" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Patch Info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10042"><![CDATA[Patch Available]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i169pr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>244706</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>