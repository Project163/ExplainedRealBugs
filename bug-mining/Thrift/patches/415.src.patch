diff --git a/lib/js/test/build.xml b/lib/js/test/build.xml
index bfb9e271e..c1a17e896 100644
--- a/lib/js/test/build.xml
+++ b/lib/js/test/build.xml
@@ -36,13 +36,17 @@
   <property name="thrift.compiler" location="${thrift.dir}/compiler/cpp/thrift" />
 
   <!-- take ivy from java, test depends anyway on java! -->
-  <property name="ivy.dir" location="${thrift.java.dir}/build/ivy" />
+  <property name="ivy.dir" location="${build}/ivy" />
   <property name="ivy.lib.dir" location="${ivy.dir}/lib" />
 
   <path id="libs.classpath">
-    <pathelement path="${thrift.java.dir}/libthrift.jar" />
-    <pathelement path="${thrift.java.dir}/libthrift-test.jar" />
-    <fileset dir="${thrift.java.dir}/build/ivy/lib">
+    <fileset dir="${thrift.java.dir}/build/">
+      <include name="*.jar" />
+    </fileset>
+    <fileset dir="${thrift.java.dir}/build/lib">
+      <include name="*.jar" />
+    </fileset>
+    <fileset dir="${ivy.lib.dir}/">
       <include name="*.jar" />
     </fileset>
   </path>
@@ -56,12 +60,12 @@
     <fail>
       <condition>
         <not>
-          <resourcecount count="1">
-            <fileset id="fs" dir="${thrift.java.dir}" includes="libthrift.jar"/>
+          <resourcecount count="2">
+            <fileset id="fs" dir="${thrift.java.dir}/build" includes="libthrift*.jar"/>
           </resourcecount>
         </not>
       </condition>
-      You need libthrift.jar located at
+      You need libthrift*.jar and libthrift*test.jar located at
       ${thrift.java.dir}
       Did you compile Thrift Java library and its test suite by "ant compile-test"?
     </fail>
@@ -69,7 +73,7 @@
       <condition>
         <not>
           <resourcecount count="1">
-            <fileset id="fs" dir="${ivy.dir}" includes="ivy-2*.jar"/>
+            <fileset id="fs" dir="${thrift.java.dir}/build/tools" includes="ivy-2*.jar"/>
           </resourcecount>
         </not>
       </condition>
@@ -172,7 +176,7 @@
     <typedef uri="antlib:org.apache.ivy.ant" onerror="fail"
       loaderRef="ivyLoader">
       <classpath>
-        <fileset dir="${ivy.dir}">
+        <fileset dir="${thrift.java.dir}/build/tools">
           <include name="ivy-2.*.jar" />
         </fileset>
       </classpath>
