diff --git a/lib/php/src/ext/thrift_protocol/php_thrift_protocol.cpp b/lib/php/src/ext/thrift_protocol/php_thrift_protocol.cpp
index 253026d57..3e32cb927 100644
--- a/lib/php/src/ext/thrift_protocol/php_thrift_protocol.cpp
+++ b/lib/php/src/ext/thrift_protocol/php_thrift_protocol.cpp
@@ -177,7 +177,7 @@ public:
 
   void write(const char* data, size_t len) {
     if ((len + buffer_used) > buffer_size) {
-      flush();
+      internalFlush();
     }
     if (len > buffer_size) {
       directWrite(data, len);
@@ -218,15 +218,18 @@ public:
   }
 
   void flush() {
-    if (buffer_used) {
+    internalFlush();
+    directFlush();
+  }
+
+protected:
+  void internalFlush() {
+     if (buffer_used) {
       directWrite(buffer, buffer_used);
       buffer_ptr = buffer;
       buffer_used = 0;
     }
-    directFlush();
   }
-
-protected:
   void directFlush() {
     zval ret;
     ZVAL_NULL(&ret);
