diff --git a/lib/cpp/src/thrift/transport/TSSLSocket.cpp b/lib/cpp/src/thrift/transport/TSSLSocket.cpp
index 682f63c33..b9a8d8e96 100644
--- a/lib/cpp/src/thrift/transport/TSSLSocket.cpp
+++ b/lib/cpp/src/thrift/transport/TSSLSocket.cpp
@@ -124,6 +124,7 @@ void cleanupOpenSSL() {
   CRYPTO_set_dynlock_create_callback(NULL);
   CRYPTO_set_dynlock_lock_callback(NULL);
   CRYPTO_set_dynlock_destroy_callback(NULL);
+  sk_SSL_COMP_free(SSL_COMP_get_compression_methods());
   CRYPTO_cleanup_all_ex_data();
   ERR_free_strings();
   EVP_cleanup();
