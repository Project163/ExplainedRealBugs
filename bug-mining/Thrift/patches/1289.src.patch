diff --git a/lib/cpp/src/thrift/transport/TSSLSocket.cpp b/lib/cpp/src/thrift/transport/TSSLSocket.cpp
index 622dfa422..ecc7896c9 100644
--- a/lib/cpp/src/thrift/transport/TSSLSocket.cpp
+++ b/lib/cpp/src/thrift/transport/TSSLSocket.cpp
@@ -581,6 +581,7 @@ int TSSLSocketFactory::passwordCallback(char* password, int size, int, void* dat
     length = size;
   }
   strncpy(password, userPassword.c_str(), length);
+  userPassword.assign(userPassword.size(), '*');
   return length;
 }
 
