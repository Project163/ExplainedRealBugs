diff --git a/lib/d/src/thrift/async/libevent.d b/lib/d/src/thrift/async/libevent.d
index 967c41fa0..2cf0d3ca5 100644
--- a/lib/d/src/thrift/async/libevent.d
+++ b/lib/d/src/thrift/async/libevent.d
@@ -392,7 +392,7 @@ private:
       TAsyncEventReason.NORMAL;
     (*(cast(TSocketEventListener*)arg))(reason);
     GC.removeRange(arg);
-    clear(arg);
+    destroy(arg);
     free(arg);
   }
 
@@ -402,7 +402,7 @@ private:
     assert(flags & EV_TIMEOUT);
     (*(cast(void delegate()*)arg))();
     GC.removeRange(arg);
-    clear(arg);
+    destroy(arg);
     free(arg);
   }
 
@@ -443,7 +443,7 @@ private:
 private {
   timeval toTimeval(const(Duration) dur) {
     timeval tv = {tv_sec: cast(int)dur.total!"seconds"(),
-      tv_usec: dur.fracSec.usecs};
+      tv_usec: dur.total!"usecs"};
     return tv;
   }
 
diff --git a/lib/d/src/thrift/codegen/base.d b/lib/d/src/thrift/codegen/base.d
index 9061d0bf3..0e943352d 100644
--- a/lib/d/src/thrift/codegen/base.d
+++ b/lib/d/src/thrift/codegen/base.d
@@ -48,6 +48,7 @@ import std.traits : BaseTypeTuple, isPointer, isSomeFunction, PointerTarget,
 import thrift.base;
 import thrift.internal.codegen;
 import thrift.protocol.base;
+import thrift.util.hashset;
 
 /*
  * Thrift struct/service meta data, which is used to store information from
@@ -420,7 +421,7 @@ mixin template TStructHelpers(alias fieldMetaData = cast(TFieldMeta[])null) if (
       return (cast()super).opEquals(other);
     }
 
-    size_t toHash() const {
+    override size_t toHash() const {
       return thriftToHashImpl();
     }
   } else {
@@ -469,8 +470,8 @@ mixin template TStructHelpers(alias fieldMetaData = cast(TFieldMeta[])null) if (
 
   private size_t thriftToHashImpl() const @trusted nothrow {
     size_t hash = 0;
-    foreach (name; FieldNames!This) {
-      auto val = mixin("this." ~ name);
+    foreach (i, _; this.tupleof) {
+      auto val = this.tupleof[i];
       hash += typeid(val).getHash(&val);
     }
     return hash;
diff --git a/lib/d/src/thrift/internal/ssl.d b/lib/d/src/thrift/internal/ssl.d
index 63a0a2b3b..3af54b582 100644
--- a/lib/d/src/thrift/internal/ssl.d
+++ b/lib/d/src/thrift/internal/ssl.d
@@ -179,7 +179,7 @@ Exception getSSLException(string location = null, string clientFile = __FILE__,
   Exception exception;
 
   void initMessage() {
-    message.clear();
+    message.destroy();
     hadMessage = false;
     if (!location.empty) {
       message ~= location;
diff --git a/lib/d/src/thrift/protocol/json.d b/lib/d/src/thrift/protocol/json.d
index e89aee14e..ed8f9c0b9 100644
--- a/lib/d/src/thrift/protocol/json.d
+++ b/lib/d/src/thrift/protocol/json.d
@@ -61,7 +61,7 @@ final class TJsonProtocol(Transport = TTransport) if (
   }
 
   void reset() {
-    contextStack_.clear();
+    destroy(contextStack_);
     context_ = new Context();
     reader_ = new LookaheadReader(trans_);
   }
diff --git a/lib/d/src/thrift/transport/file.d b/lib/d/src/thrift/transport/file.d
index cb8bcd75f..04d34ac85 100644
--- a/lib/d/src/thrift/transport/file.d
+++ b/lib/d/src/thrift/transport/file.d
@@ -847,7 +847,7 @@ private {
         (immutable(ubyte)[] data) {
           while (errorOpening) {
             logError("Writer thread going to sleep for %s Âµs due to IO errors",
-              ioErrorSleepDuration.fracSec.usecs);
+              ioErrorSleepDuration.total!"usecs");
 
             // Sleep for ioErrorSleepDuration, being ready to be interrupted
             // by shutdown requests.
diff --git a/lib/d/src/thrift/transport/ssl.d b/lib/d/src/thrift/transport/ssl.d
index c1eab25dc..a78a2edbc 100644
--- a/lib/d/src/thrift/transport/ssl.d
+++ b/lib/d/src/thrift/transport/ssl.d
@@ -518,7 +518,7 @@ private:
       const(char)* file, int line)
     {
       GC.removeRange(l);
-      clear(cast(Mutex)l);
+      destroy(cast(Mutex)l);
       free(l);
     }
 
diff --git a/lib/d/test/async_test.d b/lib/d/test/async_test.d
index f1a0cf315..fb765ad6e 100644
--- a/lib/d/test/async_test.d
+++ b/lib/d/test/async_test.d
@@ -130,7 +130,7 @@ void main(string[] args) {
   }
 
   auto managers = new TLibeventAsyncManager[managerCount];
-  scope (exit) foreach (ref m; managers) clear(m);
+  scope (exit) foreach (ref m; managers) destroy(m);
 
   auto clientsThreads = new ThreadGroup;
   foreach (managerIndex, ref manager; managers) {
diff --git a/lib/d/test/thrift_test_server.d b/lib/d/test/thrift_test_server.d
index 1608a57c5..b55b7fc9e 100644
--- a/lib/d/test/thrift_test_server.d
+++ b/lib/d/test/thrift_test_server.d
@@ -86,6 +86,11 @@ class TestHandler : ThriftTest {
     return thing;
   }
 
+  override bool testBool(bool thing) {
+    if (trace_) writefln("testBool(\"%s\")", thing);
+    return thing;
+  }
+
   override Xtruct testStruct(ref const(Xtruct) thing) {
     if (trace_) writefln("testStruct({\"%s\", %s, %s, %s})",
       thing.string_thing, thing.byte_thing, thing.i32_thing, thing.i64_thing);
diff --git a/lib/d/test/transport_test.d b/lib/d/test/transport_test.d
index 09bf6fd68..623e03f0e 100644
--- a/lib/d/test/transport_test.d
+++ b/lib/d/test/transport_test.d
@@ -144,7 +144,7 @@ class CoupledWrapperTransports(WrapperTransport, InnerCoupledTransports) if (
   }
 
   ~this() {
-    clear(inner_);
+    destroy(inner_);
   }
 
 private:
