diff --git a/lib/rb/lib/thrift/client.rb b/lib/rb/lib/thrift/client.rb
index 8f9b96a98..997923ae2 100644
--- a/lib/rb/lib/thrift/client.rb
+++ b/lib/rb/lib/thrift/client.rb
@@ -12,7 +12,12 @@ module Thrift
       args.each do |k, v|
         data.send("#{k.to_s}=", v)
       end
-      data.write(@oprot)
+      begin
+        data.write(@oprot)
+      rescue StandardError => e
+        @oprot.trans.close
+        raise e
+      end
       @oprot.write_message_end
       @oprot.trans.flush
     end
diff --git a/lib/rb/spec/client_spec.rb b/lib/rb/spec/client_spec.rb
index b92bbec4e..980552beb 100644
--- a/lib/rb/spec/client_spec.rb
+++ b/lib/rb/spec/client_spec.rb
@@ -65,5 +65,17 @@ class ThriftClientSpec < Spec::ExampleGroup
       end
       lambda { @client.receive_message(nil) }.should raise_error(StandardError)
     end
+
+    it "should close the transport if an error occurs while sending a message" do
+      @prot.stub!(:write_message_begin)
+      @prot.should_not_receive(:write_message_end)
+      mock_args = mock("#<TestMessage_args:mock>")
+      mock_args.should_receive(:write).with(@prot).and_raise(StandardError)
+      trans = mock("MockTransport")
+      @prot.stub!(:trans).and_return(trans)
+      trans.should_receive(:close)
+      klass = mock("TestMessage_args", :new => mock_args)
+      lambda { @client.send_message("testMessage", klass) }.should raise_error(StandardError)
+    end
   end
 end
