diff --git a/lib/rb/lib/thrift/transport/socket.rb b/lib/rb/lib/thrift/transport/socket.rb
index 77abdc3c7..6b648cfc5 100644
--- a/lib/rb/lib/thrift/transport/socket.rb
+++ b/lib/rb/lib/thrift/transport/socket.rb
@@ -35,6 +35,8 @@ module Thrift
       begin
         @handle.write(str)
       rescue StandardError
+        @handle.close
+        @handle = nil
         raise TransportException.new(TransportException::NOT_OPEN)
       end
     end
@@ -47,6 +49,8 @@ module Thrift
           data = @handle.read(sz)
         end
       rescue StandardError => e
+        @handle.close
+        @handle = nil
         raise TransportException.new(TransportException::NOT_OPEN, e.message)
       end
       if (data.nil? or data.length == 0)
diff --git a/lib/rb/spec/socket_spec.rb b/lib/rb/spec/socket_spec.rb
index 4d129b048..4f5868b68 100644
--- a/lib/rb/spec/socket_spec.rb
+++ b/lib/rb/spec/socket_spec.rb
@@ -6,6 +6,7 @@ class ThriftSocketSpec < Spec::ExampleGroup
   before(:each) do
     @socket = Socket.new
     @handle = mock("Handle")
+    @handle.stub!(:close)
   end
 
   describe Socket do
@@ -68,14 +69,12 @@ class ThriftSocketSpec < Spec::ExampleGroup
     end
 
     it "should declare itself as closed when it has an error" do
-      pending do
-        TCPSocket.should_receive(:new).and_return(@handle)
-        @socket.open
-        @handle.should_receive(:write).with("fail").and_raise(StandardError)
-        @socket.should be_open
-        lambda { @socket.write("fail") }.should raise_error
-        @socket.should_not be_open
-      end
+      TCPSocket.should_receive(:new).and_return(@handle)
+      @socket.open
+      @handle.should_receive(:write).with("fail").and_raise(StandardError)
+      @socket.should be_open
+      lambda { @socket.write("fail") }.should raise_error
+      @socket.should_not be_open
     end
   end
 
