diff --git a/lib/cpp/src/thrift/server/TServer.cpp b/lib/cpp/src/thrift/server/TServer.cpp
index f4ce7441b..5e82ce687 100755
--- a/lib/cpp/src/thrift/server/TServer.cpp
+++ b/lib/cpp/src/thrift/server/TServer.cpp
@@ -32,6 +32,7 @@
 
 namespace apache { namespace thrift { namespace server {
 
+#ifdef HAVE_SYS_RESOURCE_H
 int increase_max_fds(int max_fds=(1<<24))  {
   struct rlimit fdmaxrl;
 
@@ -43,5 +44,6 @@ int increase_max_fds(int max_fds=(1<<24))  {
 
   return static_cast<int>(fdmaxrl.rlim_cur);
 }
+#endif
 
 }}} // apache::thrift::server
diff --git a/lib/cpp/src/thrift/server/TServer.h b/lib/cpp/src/thrift/server/TServer.h
index c9e88b183..7f718da53 100644
--- a/lib/cpp/src/thrift/server/TServer.h
+++ b/lib/cpp/src/thrift/server/TServer.h
@@ -307,8 +307,9 @@ public:
  * for the current process and all of its children.
  * By default, tries to increase it to as much as 2^24.
  */
+#ifdef HAVE_SYS_RESOURCE_H
  int increase_max_fds(int max_fds=(1<<24));
-
+#endif
 
 }}} // apache::thrift::server
 
