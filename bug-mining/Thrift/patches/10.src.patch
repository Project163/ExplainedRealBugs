diff --git a/lib/rb/lib/thrift/transport.rb b/lib/rb/lib/thrift/transport.rb
index 3ea6ee08e..36492dd75 100644
--- a/lib/rb/lib/thrift/transport.rb
+++ b/lib/rb/lib/thrift/transport.rb
@@ -90,6 +90,7 @@ module Thrift
     end
 
     def close
+      flush
       @transport.close
     end
 
@@ -102,9 +103,12 @@ module Thrift
     end
 
     def flush
-      @transport.write(@wbuf)
+      if @wbuf != ''
+        @transport.write(@wbuf)
+        @wbuf = ''
+      end
+      
       @transport.flush
-      @wbuf = ''
     end
   end
   deprecate_class! :TBufferedTransport => BufferedTransport
diff --git a/lib/rb/spec/transport_spec.rb b/lib/rb/spec/transport_spec.rb
index 5d5c92f79..44d0508a3 100644
--- a/lib/rb/spec/transport_spec.rb
+++ b/lib/rb/spec/transport_spec.rb
@@ -52,6 +52,7 @@ class ThriftTransportSpec < Spec::ExampleGroup
       trans = mock("Transport")
       trans.should_receive(:open?).ordered.and_return("+ open?")
       trans.should_receive(:open).ordered.and_return("+ open")
+      trans.should_receive(:flush).ordered # from the close
       trans.should_receive(:close).ordered.and_return("+ close")
       trans.should_receive(:read).with(217).ordered.and_return("+ read")
       btrans = BufferedTransport.new(trans)
@@ -81,7 +82,22 @@ class ThriftTransportSpec < Spec::ExampleGroup
       trans.should_receive(:write).with("one/two/three/")
       trans.stub!(:flush)
       btrans.flush
-      trans.should_receive(:write).with("")
+      # Nothing to flush with no data
+      btrans.flush
+    end
+    
+    it "should flush on close" do
+      trans = mock("Transport")
+      trans.should_receive(:close)
+      btrans = BufferedTransport.new(trans)
+      btrans.should_receive(:flush)
+      btrans.close
+    end
+    
+    it "should not write to socket if there's no data" do
+      trans = mock("Transport")
+      trans.should_receive(:flush)
+      btrans = BufferedTransport.new(trans)
       btrans.flush
     end
   end
