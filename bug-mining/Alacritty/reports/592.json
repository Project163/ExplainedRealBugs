{"url":"https://api.github.com/repos/alacritty/alacritty/issues/7753","repository_url":"https://api.github.com/repos/alacritty/alacritty","labels_url":"https://api.github.com/repos/alacritty/alacritty/issues/7753/labels{/name}","comments_url":"https://api.github.com/repos/alacritty/alacritty/issues/7753/comments","events_url":"https://api.github.com/repos/alacritty/alacritty/issues/7753/events","html_url":"https://github.com/alacritty/alacritty/issues/7753","id":2143238897,"node_id":"I_kwDOAxkop85_vzrx","number":7753,"title":"A way to know exit code after `alacritty_terminal::tty::Shell::new` finishes","user":{"login":"SomeoneToIgnore","id":2690773,"node_id":"MDQ6VXNlcjI2OTA3NzM=","avatar_url":"https://avatars.githubusercontent.com/u/2690773?v=4","gravatar_id":"","url":"https://api.github.com/users/SomeoneToIgnore","html_url":"https://github.com/SomeoneToIgnore","followers_url":"https://api.github.com/users/SomeoneToIgnore/followers","following_url":"https://api.github.com/users/SomeoneToIgnore/following{/other_user}","gists_url":"https://api.github.com/users/SomeoneToIgnore/gists{/gist_id}","starred_url":"https://api.github.com/users/SomeoneToIgnore/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SomeoneToIgnore/subscriptions","organizations_url":"https://api.github.com/users/SomeoneToIgnore/orgs","repos_url":"https://api.github.com/users/SomeoneToIgnore/repos","events_url":"https://api.github.com/users/SomeoneToIgnore/events{/privacy}","received_events_url":"https://api.github.com/users/SomeoneToIgnore/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":327960157,"node_id":"MDU6TGFiZWwzMjc5NjAxNTc=","url":"https://api.github.com/repos/alacritty/alacritty/labels/enhancement","name":"enhancement","color":"84b6eb","default":true,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2024-02-19T22:34:07Z","updated_at":"2024-03-09T11:32:33Z","closed_at":"2024-03-09T11:32:33Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"I use `alacritty_terminal::tty::Shell::new` options when creating `tty::new` for some bash-like command.\r\nIt works well, shows command's output in the terminal and sends `Event::Exit` after the command finishes execution, but there seems to be no way to know what is the `ExitStatus` of that command?\r\n\r\nThere's a way to get a reference to a `Child` via `Pty::child` (https://docs.rs/alacritty_terminal/latest/alacritty_terminal/tty/struct.Pty.html#method.child)\r\nbut the pty itself has to be moved into the `EventLoop` in order to init the terminal:\r\nhttps://docs.rs/alacritty_terminal/latest/alacritty_terminal/event_loop/struct.EventLoop.html#method.new and the `Child` is not `Clone`.\r\n\r\nI could get child's pid, but using `libc` on that pid as\r\n```rust\r\nfn get_exit_code(pid: u32) -> Option<i32> {\r\n    let mut status = 0;\r\n    let waitpid_result = unsafe { libc::waitpid(pid as libc::pid_t, &mut status, libc::WNOHANG) };\r\n    if waitpid_result == -1 {\r\n        None\r\n    } else {\r\n        if libc::WIFEXITED(status) {\r\n            Some(libc::WEXITSTATUS(status))\r\n        } else if libc::WIFSIGNALED(status) {\r\n            None\r\n        } else {\r\n            None\r\n        }\r\n    }\r\n}\r\n```\r\ndoes not seem to yield any result, I get `None`.\r\n\r\nIs there a way to know the `ExitStatus` of that bash-like command? \r\nIf not, would it be appropriate to add a way to do so? Should it be a field in the `Event::Exit` or is there a better way to design this?","closed_by":{"login":"kchibisov","id":27620401,"node_id":"MDQ6VXNlcjI3NjIwNDAx","avatar_url":"https://avatars.githubusercontent.com/u/27620401?v=4","gravatar_id":"","url":"https://api.github.com/users/kchibisov","html_url":"https://github.com/kchibisov","followers_url":"https://api.github.com/users/kchibisov/followers","following_url":"https://api.github.com/users/kchibisov/following{/other_user}","gists_url":"https://api.github.com/users/kchibisov/gists{/gist_id}","starred_url":"https://api.github.com/users/kchibisov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kchibisov/subscriptions","organizations_url":"https://api.github.com/users/kchibisov/orgs","repos_url":"https://api.github.com/users/kchibisov/repos","events_url":"https://api.github.com/users/kchibisov/events{/privacy}","received_events_url":"https://api.github.com/users/kchibisov/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/alacritty/alacritty/issues/7753/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/alacritty/alacritty/issues/7753/timeline","performed_via_github_app":null,"state_reason":"completed"}