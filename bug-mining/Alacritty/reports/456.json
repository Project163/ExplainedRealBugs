{"url":"https://api.github.com/repos/alacritty/alacritty/issues/5542","repository_url":"https://api.github.com/repos/alacritty/alacritty","labels_url":"https://api.github.com/repos/alacritty/alacritty/issues/5542/labels{/name}","comments_url":"https://api.github.com/repos/alacritty/alacritty/issues/5542/comments","events_url":"https://api.github.com/repos/alacritty/alacritty/issues/5542/events","html_url":"https://github.com/alacritty/alacritty/issues/5542","id":1025430175,"node_id":"I_kwDOAxkop849HtKf","number":5542,"title":"problems with OSC 4 and 104","user":{"login":"skyfaller","id":80093,"node_id":"MDQ6VXNlcjgwMDkz","avatar_url":"https://avatars.githubusercontent.com/u/80093?v=4","gravatar_id":"","url":"https://api.github.com/users/skyfaller","html_url":"https://github.com/skyfaller","followers_url":"https://api.github.com/users/skyfaller/followers","following_url":"https://api.github.com/users/skyfaller/following{/other_user}","gists_url":"https://api.github.com/users/skyfaller/gists{/gist_id}","starred_url":"https://api.github.com/users/skyfaller/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/skyfaller/subscriptions","organizations_url":"https://api.github.com/users/skyfaller/orgs","repos_url":"https://api.github.com/users/skyfaller/repos","events_url":"https://api.github.com/users/skyfaller/events{/privacy}","received_events_url":"https://api.github.com/users/skyfaller/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":327960158,"node_id":"MDU6TGFiZWwzMjc5NjAxNTg=","url":"https://api.github.com/repos/alacritty/alacritty/labels/help%20wanted","name":"help wanted","color":"159818","default":true,"description":null},{"id":446259857,"node_id":"MDU6TGFiZWw0NDYyNTk4NTc=","url":"https://api.github.com/repos/alacritty/alacritty/labels/D%20-%20easy","name":"D - easy","color":"c2e0c6","default":false,"description":null},{"id":750311104,"node_id":"MDU6TGFiZWw3NTAzMTExMDQ=","url":"https://api.github.com/repos/alacritty/alacritty/labels/B%20-%20missing%20feature","name":"B - missing feature","color":"c6071e","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":7,"created_at":"2021-10-13T16:00:27Z","updated_at":"2022-01-20T23:57:59Z","closed_at":"2022-01-20T23:57:59Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"[Documentation claims that OSC 4 and OSC 104 are supported](https://github.com/alacritty/alacritty/blob/master/docs/escape_support.md). However, testing reveals some issues.\r\n\r\nIf the OSC is fully supported, we should be able to query the state of colors. Here's a working query using OSC 11:\r\n```\r\n> echo -ne '\\e]11;?\\a'; cat\r\n^[]11;rgb:ffff/ffff/ffff^G^C⏎  \r\n```\r\nThat tells me I have a white background.\r\n\r\nAttempting to learn the state of a color in my color palette using OSC 4 does not work, however:\r\n```\r\n> echo -ne '\\e]4;1;?\\a'; cat\r\n^C⏎ \r\n```\r\nNo information is returned. And in the log, we see:\r\n> [2021-10-13 11:37:43.348998800] [DEBUG] [alacritty_terminal] [unhandled osc_dispatch]: [['4',],['1',],['?',],] at line 947\r\n\r\nStrangely, we are able to change the colors with OSC 4:\r\n```\r\n> printf '\\e]4;3;#490101\\a'\r\n```\r\nThat sets my dark yellow to a dark red, easy to see with e.g. `neofetch`.\r\n\r\nHowever, attempting to undo this with OSC 104 does not work:\r\n```\r\n> printf '\\e]104;\\a'\r\n```\r\nMy yellow remains red. The log reports:\r\n> [2021-10-13 11:45:18.472954361] [DEBUG] [alacritty_terminal] [unhandled osc_dispatch]: [['1','0','4',],[],] at line 947\r\n\r\nUsing a different ending has no effect on results:\r\n```\r\n> echo -ne '\\e]11;?\\e\\\\'; cat\r\n^[]11;rgb:ffff/ffff/ffff^[\\^C⏎     \r\n> echo -ne '\\e]4;1;?\\e\\\\'; cat\r\n^C⏎\r\n```\r\n\r\nI should be able to query my color palette with OSC 4, and reset my color palette using OSC 104. Currently I can only use OSC 4 to change colors. The above commands work fine in other shells such as iTerm2 or Foot. Similar commands for OSC 10, 11, 110, and 111 all work in Alacritty as expected.\r\n\r\n### System\r\n\r\nOS: macOS Catalina 10.15.7\r\nVersion: alacritty 0.9.0 (fed349a)\r\n\r\nOS: Manjaro ARM Linux\r\nVersion: alacritty 0.10.0-dev (b6e05d2d)\r\nDE: Wayland, sway\r\n\r\n### Logs\r\n\r\n> alacritty -vv\r\nCreated log file at \"/tmp/Alacritty-25654.log\"\r\n[2021-10-13 11:36:58.858691035] [INFO ] [alacritty] Welcome to Alacritty\r\n[2021-10-13 11:36:58.858972769] [INFO ] [alacritty] Configuration files loaded from:\r\n                                                      \"/home/nelson/.config/alacritty/alacritty.yml\"\r\n[2021-10-13 11:36:58.900859460] [DEBUG] [crossfont] Loaded Face Face { ft_face: Font Face: Regular, load_flags: TARGET_LIGHT, render_mode: \"Normal\", lcd_filter: 1 }\r\n[2021-10-13 11:36:58.910606092] [DEBUG] [alacritty] Estimated DPR: 1\r\n[2021-10-13 11:36:58.910720127] [DEBUG] [alacritty] Estimated window size: None\r\n[2021-10-13 11:36:58.910755125] [DEBUG] [alacritty] Estimated cell size: 9 x 20\r\n[2021-10-13 11:36:59.019037732] [INFO ] [alacritty] Device pixel ratio: 1\r\n[2021-10-13 11:36:59.049712562] [INFO ] [alacritty] Initializing glyph cache...\r\n[2021-10-13 11:36:59.054074182] [DEBUG] [crossfont] Loaded Face Face { ft_face: Font Face: Regular, load_flags: TARGET_LIGHT, render_mode: \"Normal\", lcd_filter: 1 }\r\n[2021-10-13 11:36:59.063504963] [DEBUG] [crossfont] Loaded Face Face { ft_face: Font Face: Bold, load_flags: TARGET_LIGHT, render_mode: \"Normal\", lcd_filter: 1 }\r\n[2021-10-13 11:36:59.073139607] [DEBUG] [crossfont] Loaded Face Face { ft_face: Font Face: Italic, load_flags: TARGET_LIGHT, render_mode: \"Normal\", lcd_filter: 1 }\r\n[2021-10-13 11:36:59.082763169] [DEBUG] [crossfont] Loaded Face Face { ft_face: Font Face: Bold Italic, load_flags: TARGET_LIGHT, render_mode: \"Normal\", lcd_filter: 1 }\r\n[2021-10-13 11:36:59.430697721] [INFO ] [alacritty] ... finished initializing glyph cache in 0.380882498s\r\n[2021-10-13 11:36:59.430961080] [INFO ] [alacritty] Cell size: 9 x 20\r\n[2021-10-13 11:36:59.431031076] [INFO ] [alacritty] Padding: 4 x 10\r\n[2021-10-13 11:36:59.431070157] [INFO ] [alacritty] Width: 800, Height: 600\r\n[2021-10-13 11:36:59.434250888] [INFO ] [alacritty] PTY dimensions: 29 x 88\r\n[2021-10-13 11:36:59.452195504] [INFO ] [alacritty] Initialisation complete\r\n[2021-10-13 11:36:59.481600616] [DEBUG] [alacritty_terminal] New num_cols is 105 and num_lines is 51\r\n[2021-10-13 11:36:59.490114743] [INFO ] [alacritty] Padding: 5 x 7\r\n[2021-10-13 11:36:59.490217112] [INFO ] [alacritty] Width: 956, Height: 1035\r\n[2021-10-13 11:36:59.645425319] [DEBUG] [alacritty_terminal] [unhandled osc_dispatch]: [['5','0',],['c','o','l','o','r','s','=','l','i','g','h','t',],] at line 947\r\n[2021-10-13 11:37:05.464752222] [DEBUG] [crossfont] Loaded Face Face { ft_face: Font Face: Regular, load_flags: TARGET_LIGHT, render_mode: \"Normal\", lcd_filter: 1 }\r\n[2021-10-13 11:37:43.348998800] [DEBUG] [alacritty_terminal] [unhandled osc_dispatch]: [['4',],['1',],['?',],] at line 947\r\n[2021-10-13 11:45:18.472954361] [DEBUG] [alacritty_terminal] [unhandled osc_dispatch]: [['1','0','4',],[],] at line 947\r\n","closed_by":{"login":"chrisduerr","id":8886672,"node_id":"MDQ6VXNlcjg4ODY2NzI=","avatar_url":"https://avatars.githubusercontent.com/u/8886672?v=4","gravatar_id":"","url":"https://api.github.com/users/chrisduerr","html_url":"https://github.com/chrisduerr","followers_url":"https://api.github.com/users/chrisduerr/followers","following_url":"https://api.github.com/users/chrisduerr/following{/other_user}","gists_url":"https://api.github.com/users/chrisduerr/gists{/gist_id}","starred_url":"https://api.github.com/users/chrisduerr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chrisduerr/subscriptions","organizations_url":"https://api.github.com/users/chrisduerr/orgs","repos_url":"https://api.github.com/users/chrisduerr/repos","events_url":"https://api.github.com/users/chrisduerr/events{/privacy}","received_events_url":"https://api.github.com/users/chrisduerr/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/alacritty/alacritty/issues/5542/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/alacritty/alacritty/issues/5542/timeline","performed_via_github_app":null,"state_reason":"completed"}