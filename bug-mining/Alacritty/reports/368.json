{"url":"https://api.github.com/repos/alacritty/alacritty/issues/4530","repository_url":"https://api.github.com/repos/alacritty/alacritty","labels_url":"https://api.github.com/repos/alacritty/alacritty/issues/4530/labels{/name}","comments_url":"https://api.github.com/repos/alacritty/alacritty/issues/4530/comments","events_url":"https://api.github.com/repos/alacritty/alacritty/issues/4530/events","html_url":"https://github.com/alacritty/alacritty/issues/4530","id":758088159,"node_id":"MDU6SXNzdWU3NTgwODgxNTk=","number":4530,"title":"[WIP] aarch64/Apple Silicon/M1 support","user":{"login":"Byron","id":63622,"node_id":"MDQ6VXNlcjYzNjIy","avatar_url":"https://avatars.githubusercontent.com/u/63622?v=4","gravatar_id":"","url":"https://api.github.com/users/Byron","html_url":"https://github.com/Byron","followers_url":"https://api.github.com/users/Byron/followers","following_url":"https://api.github.com/users/Byron/following{/other_user}","gists_url":"https://api.github.com/users/Byron/gists{/gist_id}","starred_url":"https://api.github.com/users/Byron/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Byron/subscriptions","organizations_url":"https://api.github.com/users/Byron/orgs","repos_url":"https://api.github.com/users/Byron/repos","events_url":"https://api.github.com/users/Byron/events{/privacy}","received_events_url":"https://api.github.com/users/Byron/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":638282629,"node_id":"MDU6TGFiZWw2MzgyODI2Mjk=","url":"https://api.github.com/repos/alacritty/alacritty/labels/A%20-%20deps","name":"A - deps","color":"fef2c0","default":false,"description":null},{"id":1954290149,"node_id":"MDU6TGFiZWwxOTU0MjkwMTQ5","url":"https://api.github.com/repos/alacritty/alacritty/labels/C%20-%20waiting%20on%20dependency","name":"C - waiting on dependency","color":"2fb56d","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2020-12-07T01:40:33Z","updated_at":"2021-01-09T20:21:51Z","closed_at":"2020-12-11T00:40:33Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"Currently Alacritty (latest master) doesn't compile on Apple Silicon, this ticket attempts to collect all issues and their solutions or tracking tickets.\r\n\r\n### System\r\n\r\nOS: macOS aarch64\r\nVersion: master\r\n\r\n### Issues to resolve\r\n\r\nWhen building, be sure to not build through `tmux` (even if it's an ARM application), as this seems to switch to INTEL toolchains somehow which often makes running build commands fail. What works for me is vanilla iTerm.\r\n\r\n* [ ] upgrade to unreleased `winit` 0.24 via new version of `glutin` ([winit tracking ticket](https://github.com/rust-windowing/winit/issues/1789), _with patches to make it work locally_)\r\n* [ ] Fix build errors coming from latest `glutin` version with breaking changes\r\n* [ ] Apply the patch (see details) to build with the latest `glutin` crate (at least to match what I have locally which may not be what `glutin` ends up looking like.\r\n\r\nWith the fixes above, `alacritty` builds on Apple Silicon.\r\n\r\n```\r\n➜  alacritty git:(master) ✗ file /Applications/Alacritty.app/Contents/MacOS/alacritty\r\n/Applications/Alacritty.app/Contents/MacOS/alacritty: Mach-O 64-bit executable arm64\r\n```\r\n\r\nNow that `alacritty` is an ARM app, there is no problems in running build commands anymore either.\r\n\r\n<details>\r\n\r\nThis is verified to apply on  9e71002e40d5487c6fa2571a3a3c4f5c8f679334 \r\n\r\n```diff\r\ndiff --git a/alacritty/src/event.rs b/alacritty/src/event.rs\r\nindex 8ecf6f0..0048e9f 100644\r\n--- a/alacritty/src/event.rs\r\n+++ b/alacritty/src/event.rs\r\n@@ -19,7 +19,7 @@ use std::time::{Duration, Instant};\r\n use glutin::dpi::PhysicalSize;\r\n use glutin::event::{ElementState, Event as GlutinEvent, ModifiersState, MouseButton, WindowEvent};\r\n use glutin::event_loop::{ControlFlow, EventLoop, EventLoopProxy, EventLoopWindowTarget};\r\n-use glutin::platform::desktop::EventLoopExtDesktop;\r\n+use glutin::platform::desktop::EventLoopExtRunReturn;\r\n #[cfg(all(feature = \"wayland\", not(any(target_os = \"macos\", windows))))]\r\n use glutin::platform::unix::EventLoopWindowTargetExtUnix;\r\n use log::info;\r\ndiff --git a/alacritty/src/window.rs b/alacritty/src/window.rs\r\nindex 953fffd..093c465 100644\r\n--- a/alacritty/src/window.rs\r\n+++ b/alacritty/src/window.rs\r\n@@ -27,7 +27,8 @@ use std::fmt::{self, Display, Formatter};\r\n use glutin::dpi::{PhysicalPosition, PhysicalSize};\r\n use glutin::event_loop::EventLoop;\r\n #[cfg(target_os = \"macos\")]\r\n-use glutin::platform::macos::{RequestUserAttentionType, WindowBuilderExtMacOS, WindowExtMacOS};\r\n+use glutin::platform::macos::{WindowBuilderExtMacOS, WindowExtMacOS};\r\n+use glutin::window::UserAttentionType;\r\n #[cfg(windows)]\r\n use glutin::platform::windows::IconExtWindows;\r\n use glutin::window::{CursorIcon, Fullscreen, Window as GlutinWindow, WindowBuilder, WindowId};\r\n@@ -339,7 +340,7 @@ impl Window {\r\n             return;\r\n         }\r\n \r\n-        self.window().request_user_attention(RequestUserAttentionType::Critical);\r\n+        self.window().request_user_attention(Some(UserAttentionType::Critical));\r\n     }\r\n \r\n     #[cfg(any(windows, not(any(feature = \"x11\", target_os = \"macos\"))))]\r\n```\r\n","closed_by":{"login":"chrisduerr","id":8886672,"node_id":"MDQ6VXNlcjg4ODY2NzI=","avatar_url":"https://avatars.githubusercontent.com/u/8886672?v=4","gravatar_id":"","url":"https://api.github.com/users/chrisduerr","html_url":"https://github.com/chrisduerr","followers_url":"https://api.github.com/users/chrisduerr/followers","following_url":"https://api.github.com/users/chrisduerr/following{/other_user}","gists_url":"https://api.github.com/users/chrisduerr/gists{/gist_id}","starred_url":"https://api.github.com/users/chrisduerr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chrisduerr/subscriptions","organizations_url":"https://api.github.com/users/chrisduerr/orgs","repos_url":"https://api.github.com/users/chrisduerr/repos","events_url":"https://api.github.com/users/chrisduerr/events{/privacy}","received_events_url":"https://api.github.com/users/chrisduerr/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/alacritty/alacritty/issues/4530/reactions","total_count":27,"+1":20,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":7,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/alacritty/alacritty/issues/4530/timeline","performed_via_github_app":null,"state_reason":"completed"}