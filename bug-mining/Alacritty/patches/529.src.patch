diff --git a/.github/workflows/release.yml b/.github/workflows/release.yml
index 98903798..ccf10322 100644
--- a/.github/workflows/release.yml
+++ b/.github/workflows/release.yml
@@ -48,14 +48,12 @@ jobs:
           ./.github/workflows/upload_asset.sh \
             ./Alacritty-${GITHUB_REF##*/}-portable.exe $GITHUB_TOKEN
       - name: Install WiX
-        run: nuget install WiX
+        run: dotnet tool install --global wix --version 4.0.1
       - name: Crate msi installer
         run: |
-          ./WiX.*/tools/candle.exe -nologo -arch "x64" -ext WixUIExtension -ext WixUtilExtension \
-            -out "./alacritty.wixobj" "alacritty/windows/wix/alacritty.wxs"
-          ./WiX.*/tools/light.exe -nologo -ext WixUIExtension -ext WixUtilExtension \
-            -out "./Alacritty-${GITHUB_REF##*/}-installer.msi" -sice:ICE61 -sice:ICE91 \
-            "./alacritty.wixobj"
+          wix extension add WixToolset.UI.wixext WixToolset.Util.wixext
+          wix build -arch "x64" -ext WixToolset.UI.wixext -ext WixToolset.Util.wixext \
+          -out "./Alacritty-${GITHUB_REF##*/}-installer.msi" "alacritty/windows/wix/alacritty.wxs"
       - name: Upload msi installer
         run: |
           ./.github/workflows/upload_asset.sh \
diff --git a/alacritty/windows/wix/alacritty.wxs b/alacritty/windows/wix/alacritty.wxs
index 7470b121..be81b8cb 100644
--- a/alacritty/windows/wix/alacritty.wxs
+++ b/alacritty/windows/wix/alacritty.wxs
@@ -1,64 +1,51 @@
-<?xml version="1.0" encoding="windows-1252"?>
-<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi" xmlns:util="http://schemas.microsoft.com/wix/UtilExtension">
-    <Product Name="Alacritty" Id="*" UpgradeCode="87c21c74-dbd5-4584-89d5-46d9cd0c40a7" Language="1033" Codepage="1252" Version="0.13.0-dev" Manufacturer="Alacritty">
-        <Package InstallerVersion="200" Compressed="yes" InstallScope="perMachine"/>
-        <MajorUpgrade AllowSameVersionUpgrades="yes" DowngradeErrorMessage="A newer version of [ProductName] is already installed."/>
-        <Icon Id="AlacrittyIco" SourceFile=".\alacritty\windows\alacritty.ico"/>
-        <WixVariable Id="WixUILicenseRtf" Value=".\alacritty\windows\wix\license.rtf"/>
-        <Property Id="ARPPRODUCTICON" Value="AlacrittyIco"/>
-        <MediaTemplate EmbedCab="yes"/>
-        <UIRef Id="WixUI_Minimal"/>
-
-        <Feature Id="ProductFeature" Title="ConsoleApp" Level="1">
-            <ComponentRef Id="AlacrittyExe"/>
-            <ComponentRef Id="AlacrittyShortcut"/>
-            <ComponentRef Id="ModifyPathEnv"/>
-            <ComponentRef Id="ContextMenu"/>
-        </Feature>
-
-        <!-- Create directories -->
-        <Directory Id="TARGETDIR" Name="SourceDir">
-            <Directory Id="ProgramFiles64Folder">
-                <Directory Id="AlacrittyProgramFiles" Name="Alacritty"/>
-            </Directory>
-            <Directory Id="ProgramMenuFolder">
-                <Directory Id="AlacrittyProgramMenu" Name="Alacritty"/>
-            </Directory>
-        </Directory>
-
-        <!-- Application binaries -->
-        <DirectoryRef Id="AlacrittyProgramFiles">
-            <Component Id="AlacrittyExe" Guid="*">
-                <File Id="AlacrittyExeFile" Source=".\target\release\alacritty.exe" Name="alacritty.exe" KeyPath="yes"/>
-            </Component>
-        </DirectoryRef>
-
-        <DirectoryRef Id="AlacrittyProgramMenu">
-            <!-- Application shortcut -->
-            <Component Id="AlacrittyShortcut" Guid="aa36e61a-23cd-4383-b744-2f78e912f0dc">
-                <Shortcut Id="AlacrittyShortcutFile" Name="Alacritty" Description="A cross-platform, GPU-accelerated terminal emulator" Target="[AlacrittyProgramFiles]alacritty.exe"/>
-                <RemoveFolder Id="AlacrittyProgramMenu" On="uninstall"/>
-                <RegistryValue Root="HKCU" Key="Software\Microsoft\Alacritty" Name="installed" Type="integer" Value="1" KeyPath="yes"/>
-            </Component>
-        </DirectoryRef>
-
-        <DirectoryRef Id="AlacrittyProgramFiles">
-            <!-- Add to PATH -->
-            <Component Id="ModifyPathEnv" Guid="edf0b679-9eb6-46f7-a5d1-5160f30acb34" KeyPath="yes">
-                <Environment Id="PathEnv" Value="[AlacrittyProgramFiles]" Name="PATH" Permanent="no" Part="first" Action="set" System="yes"/>
-            </Component>
-        </DirectoryRef>
-
-        <DirectoryRef Id="TARGETDIR">
-            <!-- Add context menu -->
-            <Component Id="ContextMenu" Guid="449f9121-f7b9-41fe-82da-52349ea8ff91">
-                <RegistryKey Root="HKCU" Key="Software\Classes\Directory\Background\shell\Open Alacritty here\command">
-                    <RegistryValue Type="string" Value="[AlacrittyProgramFiles]alacritty.exe" KeyPath="yes"/>
-                </RegistryKey>
-                <RegistryKey Root="HKCU" Key="Software\Classes\Directory\Background\shell\Open Alacritty here">
-                    <RegistryValue Type="string" Name="Icon" Value="[AlacrittyProgramFiles]alacritty.exe"/>
-                </RegistryKey>
-            </Component>
-        </DirectoryRef>
-    </Product>
+ï»¿<Wix xmlns="http://wixtoolset.org/schemas/v4/wxs" xmlns:ui="http://wixtoolset.org/schemas/v4/wxs/ui">
+   <Package Name="Alacritty" UpgradeCode="87c21c74-dbd5-4584-89d5-46d9cd0c40a7" Language="1033" Codepage="1252" Version="0.13.0-dev" Manufacturer="Alacritty" InstallerVersion="200">
+      <MajorUpgrade AllowSameVersionUpgrades="yes" DowngradeErrorMessage="A newer version of [ProductName] is already installed." />
+      <Icon Id="AlacrittyIco" SourceFile=".\alacritty\windows\alacritty.ico" />
+      <WixVariable Id="WixUILicenseRtf" Value=".\alacritty\windows\wix\license.rtf" />
+      <Property Id="ARPPRODUCTICON" Value="AlacrittyIco" />
+      <MediaTemplate EmbedCab="yes" />
+      <ui:WixUI Id="WixUI_Minimal" />
+      <Feature Id="ProductFeature" Title="ConsoleApp" Level="1">
+         <ComponentRef Id="AlacrittyExe" />
+         <ComponentRef Id="AlacrittyShortcut" />
+         <ComponentRef Id="ModifyPathEnv" />
+         <ComponentRef Id="ContextMenu" />
+      </Feature>
+      <!-- Application binaries -->
+      <DirectoryRef Id="AlacrittyProgramFiles">
+         <Component Id="AlacrittyExe">
+            <File Id="AlacrittyExeFile" Source=".\target\release\alacritty.exe" Name="alacritty.exe" KeyPath="yes" />
+         </Component>
+      </DirectoryRef>
+      <DirectoryRef Id="AlacrittyProgramMenu">
+         <!-- Application shortcut -->
+         <Component Id="AlacrittyShortcut" Guid="aa36e61a-23cd-4383-b744-2f78e912f0dc">
+            <Shortcut Id="AlacrittyShortcutFile" Name="Alacritty" Description="A cross-platform, GPU-accelerated terminal emulator" Target="[AlacrittyProgramFiles]alacritty.exe" />
+            <RemoveFolder Id="AlacrittyProgramMenu" On="uninstall" />
+            <RegistryValue Root="HKCU" Key="Software\Microsoft\Alacritty" Name="installed" Type="integer" Value="1" KeyPath="yes" />
+         </Component>
+      </DirectoryRef>
+      <DirectoryRef Id="AlacrittyProgramFiles">
+         <!-- Add to PATH -->
+         <Component Id="ModifyPathEnv" Guid="edf0b679-9eb6-46f7-a5d1-5160f30acb34" KeyPath="yes">
+            <Environment Id="PathEnv" Value="[AlacrittyProgramFiles]" Name="PATH" Permanent="no" Part="first" Action="set" System="yes" />
+         </Component>
+      </DirectoryRef>
+      <StandardDirectory Id="ProgramFiles64Folder">
+         <Directory Id="AlacrittyProgramFiles" Name="Alacritty" />
+      </StandardDirectory>
+      <StandardDirectory Id="ProgramMenuFolder">
+         <Directory Id="AlacrittyProgramMenu" Name="Alacritty" />
+      </StandardDirectory>
+      <!-- Add context menu -->
+      <Component Id="ContextMenu" Guid="449f9121-f7b9-41fe-82da-52349ea8ff91" Directory="TARGETDIR">
+         <RegistryKey Root="HKCU" Key="Software\Classes\Directory\Background\shell\Open Alacritty here\command">
+            <RegistryValue Type="string" Value="[AlacrittyProgramFiles]alacritty.exe" KeyPath="yes" />
+         </RegistryKey>
+         <RegistryKey Root="HKCU" Key="Software\Classes\Directory\Background\shell\Open Alacritty here">
+            <RegistryValue Type="string" Name="Icon" Value="[AlacrittyProgramFiles]alacritty.exe" />
+         </RegistryKey>
+      </Component>
+   </Package>
 </Wix>
diff --git a/alacritty_terminal/src/selection.rs b/alacritty_terminal/src/selection.rs
index 542430d3..1536724c 100644
--- a/alacritty_terminal/src/selection.rs
+++ b/alacritty_terminal/src/selection.rs
@@ -469,6 +469,7 @@ mod tests {
         assert_eq!(selection.to_range(&term(1, 2)), None);
     }
 
+    #[rustfmt::skip]
     /// Test selection across adjacent lines.
     ///
     /// 1.  [  ][  ][  ][  ][  ]
@@ -490,6 +491,7 @@ mod tests {
         });
     }
 
+    #[rustfmt::skip]
     /// Test selection across adjacent lines.
     ///
     /// 1.  [  ][  ][  ][  ][  ]
