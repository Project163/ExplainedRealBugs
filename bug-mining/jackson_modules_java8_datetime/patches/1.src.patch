diff --git a/datetime/src/main/java/com/fasterxml/jackson/datatype/jsr310/ser/InstantSerializer.java b/datetime/src/main/java/com/fasterxml/jackson/datatype/jsr310/ser/InstantSerializer.java
index 96a5857..3494b3b 100644
--- a/datetime/src/main/java/com/fasterxml/jackson/datatype/jsr310/ser/InstantSerializer.java
+++ b/datetime/src/main/java/com/fasterxml/jackson/datatype/jsr310/ser/InstantSerializer.java
@@ -28,7 +28,7 @@ import java.time.format.DateTimeFormatter;
  * @author Nick Williams
  * @since 2.2
  */
-public final class InstantSerializer extends InstantSerializerBase<Instant>
+public class InstantSerializer extends InstantSerializerBase<Instant>
 {
     private static final long serialVersionUID = 1L;
 
diff --git a/datetime/src/main/java/com/fasterxml/jackson/datatype/jsr310/ser/JSR310FormattedSerializerBase.java b/datetime/src/main/java/com/fasterxml/jackson/datatype/jsr310/ser/JSR310FormattedSerializerBase.java
index 0548c98..339fe44 100644
--- a/datetime/src/main/java/com/fasterxml/jackson/datatype/jsr310/ser/JSR310FormattedSerializerBase.java
+++ b/datetime/src/main/java/com/fasterxml/jackson/datatype/jsr310/ser/JSR310FormattedSerializerBase.java
@@ -21,6 +21,7 @@ import java.time.format.DateTimeFormatter;
 import java.util.Locale;
 
 import com.fasterxml.jackson.annotation.JsonFormat;
+import com.fasterxml.jackson.annotation.JsonFormat.Shape;
 
 import com.fasterxml.jackson.databind.*;
 import com.fasterxml.jackson.databind.jsonFormatVisitors.JsonArrayFormatVisitor;
@@ -171,6 +172,14 @@ abstract class JSR310FormattedSerializerBase<T>
         if (_useTimestamp != null) {
             return _useTimestamp.booleanValue();
         }
+        if (_shape != null) {
+            if (_shape == Shape.STRING) {
+                return false;
+            }
+            if (_shape == Shape.NUMBER_INT) {
+                return true;
+            }
+        }
         // assume that explicit formatter definition implies use of textual format
         if (_formatter != null) { 
             return false;
diff --git a/datetime/src/main/java/com/fasterxml/jackson/datatype/jsr310/ser/LocalDateSerializer.java b/datetime/src/main/java/com/fasterxml/jackson/datatype/jsr310/ser/LocalDateSerializer.java
index 371ac67..14c7704 100644
--- a/datetime/src/main/java/com/fasterxml/jackson/datatype/jsr310/ser/LocalDateSerializer.java
+++ b/datetime/src/main/java/com/fasterxml/jackson/datatype/jsr310/ser/LocalDateSerializer.java
@@ -23,10 +23,12 @@ import java.time.format.DateTimeFormatter;
 
 import com.fasterxml.jackson.core.JsonGenerator;
 import com.fasterxml.jackson.core.JsonToken;
+import com.fasterxml.jackson.core.type.WritableTypeId;
 import com.fasterxml.jackson.databind.*;
 import com.fasterxml.jackson.databind.jsonFormatVisitors.JsonFormatVisitorWrapper;
 import com.fasterxml.jackson.databind.jsonFormatVisitors.JsonStringFormatVisitor;
 import com.fasterxml.jackson.databind.jsonFormatVisitors.JsonValueFormat;
+import com.fasterxml.jackson.databind.jsontype.TypeSerializer;
 
 /**
  * Serializer for Java 8 temporal {@link LocalDate}s.
@@ -59,24 +61,49 @@ public class LocalDateSerializer extends JSR310FormattedSerializerBase<LocalDate
     }
 
     @Override
-    public void serialize(LocalDate date, JsonGenerator generator, SerializerProvider provider) throws IOException
+    public void serialize(LocalDate date, JsonGenerator g, SerializerProvider provider) throws IOException
     {
         if (useTimestamp(provider)) {
             if (_shape == JsonFormat.Shape.NUMBER_INT) {
-                generator.writeNumber(date.toEpochDay());
+                g.writeNumber(date.toEpochDay());
             } else {
-                generator.writeStartArray();
-                generator.writeNumber(date.getYear());
-                generator.writeNumber(date.getMonthValue());
-                generator.writeNumber(date.getDayOfMonth());
-                generator.writeEndArray();
+                g.writeStartArray();
+                _serializeAsArrayContents(date, g, provider);
+                g.writeEndArray();
             }
         } else {
-            String str = (_formatter == null) ? date.toString() : date.format(_formatter);
-            generator.writeString(str);
+            g.writeString((_formatter == null) ? date.toString() : date.format(_formatter));
         }
     }
-    
+
+    @Override
+    public void serializeWithType(LocalDate value, JsonGenerator g,
+            SerializerProvider provider, TypeSerializer typeSer) throws IOException
+    {
+        WritableTypeId typeIdDef = typeSer.writeTypePrefix(g,
+                typeSer.typeId(value, serializationShape(provider)));
+        // need to write out to avoid double-writing array markers
+        switch (typeIdDef.valueShape) {
+        case START_ARRAY:
+            _serializeAsArrayContents(value, g, provider);
+            break;
+        case VALUE_NUMBER_INT:
+            g.writeNumber(value.toEpochDay());
+            break;
+        default:
+            g.writeString((_formatter == null) ? value.toString() : value.format(_formatter));
+        }
+        typeSer.writeTypeSuffix(g, typeIdDef);
+    }
+
+    protected void _serializeAsArrayContents(LocalDate value, JsonGenerator g,
+            SerializerProvider provider) throws IOException
+    {
+        g.writeNumber(value.getYear());
+        g.writeNumber(value.getMonthValue());
+        g.writeNumber(value.getDayOfMonth());
+    }
+
     @Override
     public void acceptJsonFormatVisitor(JsonFormatVisitorWrapper visitor, JavaType typeHint) throws JsonMappingException
     {
diff --git a/datetime/src/main/java/com/fasterxml/jackson/datatype/jsr310/ser/LocalDateTimeSerializer.java b/datetime/src/main/java/com/fasterxml/jackson/datatype/jsr310/ser/LocalDateTimeSerializer.java
index 71b9af6..1afc166 100644
--- a/datetime/src/main/java/com/fasterxml/jackson/datatype/jsr310/ser/LocalDateTimeSerializer.java
+++ b/datetime/src/main/java/com/fasterxml/jackson/datatype/jsr310/ser/LocalDateTimeSerializer.java
@@ -58,7 +58,6 @@ public class LocalDateTimeSerializer extends JSR310FormattedSerializerBase<Local
         return new LocalDateTimeSerializer(this, useTimestamp, f);
     }
 
-    // since 2.7: TODO in 2.8; change to use per-type defaulting
     protected DateTimeFormatter _defaultFormatter() {
         return DateTimeFormatter.ISO_LOCAL_DATE_TIME;
     }
diff --git a/datetime/src/main/java/com/fasterxml/jackson/datatype/jsr310/ser/MonthDaySerializer.java b/datetime/src/main/java/com/fasterxml/jackson/datatype/jsr310/ser/MonthDaySerializer.java
index f86ddb3..4b4f2fb 100644
--- a/datetime/src/main/java/com/fasterxml/jackson/datatype/jsr310/ser/MonthDaySerializer.java
+++ b/datetime/src/main/java/com/fasterxml/jackson/datatype/jsr310/ser/MonthDaySerializer.java
@@ -16,18 +16,18 @@
 
 package com.fasterxml.jackson.datatype.jsr310.ser;
 
+import java.io.IOException;
+import java.time.MonthDay;
+import java.time.format.DateTimeFormatter;
+
 import com.fasterxml.jackson.annotation.JsonFormat;
+
 import com.fasterxml.jackson.core.JsonGenerator;
 import com.fasterxml.jackson.core.JsonToken;
-import com.fasterxml.jackson.databind.JavaType;
-import com.fasterxml.jackson.databind.JsonMappingException;
+import com.fasterxml.jackson.core.type.WritableTypeId;
+
 import com.fasterxml.jackson.databind.SerializerProvider;
-import com.fasterxml.jackson.databind.jsonFormatVisitors.JsonFormatVisitorWrapper;
-import com.fasterxml.jackson.databind.jsonFormatVisitors.JsonStringFormatVisitor;
-import com.fasterxml.jackson.databind.jsonFormatVisitors.JsonValueFormat;
-import java.io.IOException;
-import java.time.MonthDay;
-import java.time.format.DateTimeFormatter;
+import com.fasterxml.jackson.databind.jsontype.TypeSerializer;
 
 /**
  * Serializer for Java 8 temporal {@link MonthDay}s.
@@ -62,33 +62,38 @@ public class MonthDaySerializer extends JSR310FormattedSerializerBase<MonthDay>
     }
 
     @Override
-    public void serialize(MonthDay value, JsonGenerator generator, SerializerProvider provider)
+    public void serialize(MonthDay value, JsonGenerator g, SerializerProvider provider)
         throws IOException
     {
         if (_useTimestampExplicitOnly(provider)) {
-            generator.writeStartArray();
-            generator.writeNumber(value.getMonthValue());
-            generator.writeNumber(value.getDayOfMonth());
-            generator.writeEndArray();
+            g.writeStartArray();
+            _serializeAsArrayContents(value, g, provider);
+            g.writeEndArray();
         } else {
-            String str = (_formatter == null) ? value.toString() : value.format(_formatter);
-            generator.writeString(str);
+            g.writeString((_formatter == null) ? value.toString() : value.format(_formatter));
         }
     }
 
     @Override
-    protected void _acceptTimestampVisitor(JsonFormatVisitorWrapper visitor, JavaType typeHint) throws JsonMappingException
+    public void serializeWithType(MonthDay value, JsonGenerator g,
+            SerializerProvider provider, TypeSerializer typeSer) throws IOException
     {
-        SerializerProvider provider = visitor.getProvider();
-        boolean useTimestamp = (provider != null) && _useTimestampExplicitOnly(provider);
-        if (useTimestamp) {
-            _acceptTimestampVisitor(visitor, typeHint);
+        WritableTypeId typeIdDef = typeSer.writeTypePrefix(g,
+                typeSer.typeId(value, serializationShape(provider)));
+        // need to write out to avoid double-writing array markers
+        if (typeIdDef.valueShape == JsonToken.START_ARRAY) {
+            _serializeAsArrayContents(value, g, provider);
         } else {
-            JsonStringFormatVisitor v2 = visitor.expectStringFormat(typeHint);
-            if (v2 != null) {
-                v2.format(JsonValueFormat.DATE_TIME);
-            }
+            g.writeString((_formatter == null) ? value.toString() : value.format(_formatter));
         }
+        typeSer.writeTypeSuffix(g, typeIdDef);
+    }
+    
+    protected void _serializeAsArrayContents(MonthDay value, JsonGenerator g,
+            SerializerProvider provider) throws IOException
+    {
+        g.writeNumber(value.getMonthValue());
+        g.writeNumber(value.getDayOfMonth());
     }
 
     @Override // since 2.9
diff --git a/datetime/src/main/java/com/fasterxml/jackson/datatype/jsr310/ser/YearMonthSerializer.java b/datetime/src/main/java/com/fasterxml/jackson/datatype/jsr310/ser/YearMonthSerializer.java
index d8b467e..4ad7c47 100644
--- a/datetime/src/main/java/com/fasterxml/jackson/datatype/jsr310/ser/YearMonthSerializer.java
+++ b/datetime/src/main/java/com/fasterxml/jackson/datatype/jsr310/ser/YearMonthSerializer.java
@@ -23,12 +23,14 @@ import java.time.format.DateTimeFormatter;
 
 import com.fasterxml.jackson.core.JsonGenerator;
 import com.fasterxml.jackson.core.JsonToken;
+import com.fasterxml.jackson.core.type.WritableTypeId;
 import com.fasterxml.jackson.databind.JavaType;
 import com.fasterxml.jackson.databind.JsonMappingException;
 import com.fasterxml.jackson.databind.SerializerProvider;
 import com.fasterxml.jackson.databind.jsonFormatVisitors.JsonFormatVisitorWrapper;
 import com.fasterxml.jackson.databind.jsonFormatVisitors.JsonStringFormatVisitor;
 import com.fasterxml.jackson.databind.jsonFormatVisitors.JsonValueFormat;
+import com.fasterxml.jackson.databind.jsontype.TypeSerializer;
 
 /**
  * Serializer for Java 8 temporal {@link YearMonth}s.
@@ -62,18 +64,37 @@ public class YearMonthSerializer extends JSR310FormattedSerializerBase<YearMonth
     }
 
     @Override
-    public void serialize(YearMonth yearMonth, JsonGenerator generator,
-            SerializerProvider provider) throws IOException
+    public void serialize(YearMonth value, JsonGenerator g, SerializerProvider provider) throws IOException
     {
         if (useTimestamp(provider)) {
-            generator.writeStartArray();
-            generator.writeNumber(yearMonth.getYear());
-            generator.writeNumber(yearMonth.getMonthValue());
-            generator.writeEndArray();
+            g.writeStartArray();
+            _serializeAsArrayContents(value, g, provider);
+            g.writeEndArray();
+            return;
+        }
+        g.writeString((_formatter == null) ? value.toString() : value.format(_formatter));
+    }
+
+    @Override
+    public void serializeWithType(YearMonth value, JsonGenerator g,
+            SerializerProvider provider, TypeSerializer typeSer) throws IOException
+    {
+        WritableTypeId typeIdDef = typeSer.writeTypePrefix(g,
+                typeSer.typeId(value, serializationShape(provider)));
+        // need to write out to avoid double-writing array markers
+        if (typeIdDef.valueShape == JsonToken.START_ARRAY) {
+            _serializeAsArrayContents(value, g, provider);
         } else {
-            String str = (_formatter == null) ? yearMonth.toString() : yearMonth.format(_formatter);
-            generator.writeString(str);
+            g.writeString((_formatter == null) ? value.toString() : value.format(_formatter));
         }
+        typeSer.writeTypeSuffix(g, typeIdDef);
+    }
+    
+    protected void _serializeAsArrayContents(YearMonth value, JsonGenerator g,
+            SerializerProvider provider) throws IOException
+    {
+        g.writeNumber(value.getYear());
+        g.writeNumber(value.getMonthValue());
     }
 
     @Override
diff --git a/datetime/src/main/java/com/fasterxml/jackson/datatype/jsr310/ser/YearSerializer.java b/datetime/src/main/java/com/fasterxml/jackson/datatype/jsr310/ser/YearSerializer.java
index 950cf4b..052195f 100644
--- a/datetime/src/main/java/com/fasterxml/jackson/datatype/jsr310/ser/YearSerializer.java
+++ b/datetime/src/main/java/com/fasterxml/jackson/datatype/jsr310/ser/YearSerializer.java
@@ -17,9 +17,11 @@
 package com.fasterxml.jackson.datatype.jsr310.ser;
 
 import com.fasterxml.jackson.annotation.JsonFormat;
+
 import com.fasterxml.jackson.core.JsonGenerator;
 import com.fasterxml.jackson.core.JsonParser;
 import com.fasterxml.jackson.core.JsonToken;
+
 import com.fasterxml.jackson.databind.JavaType;
 import com.fasterxml.jackson.databind.JsonMappingException;
 import com.fasterxml.jackson.databind.SerializerProvider;
@@ -70,8 +72,10 @@ public class YearSerializer extends JSR310FormattedSerializerBase<Year>
         }
     }
 
+    // Override because we have String/Int, NOT String/Array
     @Override
-    protected void _acceptTimestampVisitor(JsonFormatVisitorWrapper visitor, JavaType typeHint) throws JsonMappingException
+    protected void _acceptTimestampVisitor(JsonFormatVisitorWrapper visitor, JavaType typeHint)
+            throws JsonMappingException
     {
         JsonIntegerFormatVisitor v2 = visitor.expectIntegerFormat(typeHint);
         if (v2 != null) {
diff --git a/datetime/src/test/java/com/fasterxml/jackson/datatype/jsr310/ModuleTestBase.java b/datetime/src/test/java/com/fasterxml/jackson/datatype/jsr310/ModuleTestBase.java
index 1fcad0c..7ef16f8 100644
--- a/datetime/src/test/java/com/fasterxml/jackson/datatype/jsr310/ModuleTestBase.java
+++ b/datetime/src/test/java/com/fasterxml/jackson/datatype/jsr310/ModuleTestBase.java
@@ -11,7 +11,7 @@ public class ModuleTestBase
     final static String NO_NANOSECS_SER = "0.0";
     final static String NO_NANOSECS_SUFFIX = ".000000000";
     
-    protected ObjectMapper newMapper() {
+    protected static ObjectMapper newMapper() {
         return new ObjectMapper()
                 .registerModule(new JavaTimeModule());
     }
diff --git a/datetime/src/test/java/com/fasterxml/jackson/datatype/jsr310/ser/LocalDateSerTest.java b/datetime/src/test/java/com/fasterxml/jackson/datatype/jsr310/ser/LocalDateSerTest.java
index f98915f..541e89b 100644
--- a/datetime/src/test/java/com/fasterxml/jackson/datatype/jsr310/ser/LocalDateSerTest.java
+++ b/datetime/src/test/java/com/fasterxml/jackson/datatype/jsr310/ser/LocalDateSerTest.java
@@ -18,10 +18,10 @@ package com.fasterxml.jackson.datatype.jsr310.ser;
 
 import com.fasterxml.jackson.annotation.JsonFormat;
 import com.fasterxml.jackson.annotation.JsonTypeInfo;
+
 import com.fasterxml.jackson.databind.JsonMappingException;
 import com.fasterxml.jackson.databind.ObjectMapper;
 import com.fasterxml.jackson.databind.SerializationFeature;
-import com.fasterxml.jackson.databind.jsontype.impl.StdTypeResolverBuilder;
 import com.fasterxml.jackson.datatype.jsr310.MockObjectConfiguration;
 import com.fasterxml.jackson.datatype.jsr310.ModuleTestBase;
 
@@ -66,10 +66,10 @@ public class LocalDateSerTest
     }
 
     // [modules-java8#46]
-    @JsonTypeInfo(use = JsonTypeInfo.Id.NONE)
     static class Holder46 {
         public LocalDate localDate;
 
+        @JsonTypeInfo(use = JsonTypeInfo.Id.CLASS, include = JsonTypeInfo.As.WRAPPER_OBJECT)
         public Object object;
 
         public Holder46(LocalDate localDate, Object object) {
@@ -283,19 +283,13 @@ public class LocalDateSerTest
     }
 
     // [modules-java8#46]
+    @Test
     public void testPolymorphicSerialization() throws Exception
     {
         ObjectMapper mapper = newMapper();
-        StdTypeResolverBuilder typeResolverBuilder =
-                new ObjectMapper.DefaultTypeResolverBuilder(ObjectMapper.DefaultTyping.NON_FINAL)
-                        .init(JsonTypeInfo.Id.CLASS, null)
-                        .inclusion(JsonTypeInfo.As.WRAPPER_OBJECT);
-
-        mapper = new ObjectMapper();
-        mapper.setDefaultTyping(typeResolverBuilder);
         final LocalDate localDate = LocalDate.of(2017, 12, 5);
-        String dateHolderStr = mapper.writeValueAsString(new Holder46(localDate, localDate));
+        String json = mapper.writeValueAsString(new Holder46(localDate, localDate));
         assertEquals(aposToQuotes("{\"localDate\":[2017,12,5],\"object\":{\"java.time.LocalDate\":[2017,12,5]}}"),
-                dateHolderStr);
+                json);
     }
 }
diff --git a/datetime/src/test/java/com/fasterxml/jackson/datatype/jsr310/TestYearMonthSerialization.java b/datetime/src/test/java/com/fasterxml/jackson/datatype/jsr310/ser/YearMonthSerializationTest.java
similarity index 95%
rename from datetime/src/test/java/com/fasterxml/jackson/datatype/jsr310/TestYearMonthSerialization.java
rename to datetime/src/test/java/com/fasterxml/jackson/datatype/jsr310/ser/YearMonthSerializationTest.java
index 2b53f10..1198471 100644
--- a/datetime/src/test/java/com/fasterxml/jackson/datatype/jsr310/TestYearMonthSerialization.java
+++ b/datetime/src/test/java/com/fasterxml/jackson/datatype/jsr310/ser/YearMonthSerializationTest.java
@@ -14,7 +14,7 @@
  * limitations under the license.
  */
 
-package com.fasterxml.jackson.datatype.jsr310;
+package com.fasterxml.jackson.datatype.jsr310.ser;
 
 import static org.junit.Assert.assertEquals;
 import static org.junit.Assert.assertNotNull;
@@ -29,11 +29,12 @@ import com.fasterxml.jackson.annotation.JsonFormat;
 import com.fasterxml.jackson.annotation.JsonProperty;
 import com.fasterxml.jackson.databind.ObjectMapper;
 import com.fasterxml.jackson.databind.SerializationFeature;
+import com.fasterxml.jackson.datatype.jsr310.MockObjectConfiguration;
+import com.fasterxml.jackson.datatype.jsr310.ModuleTestBase;
 
-import org.junit.Before;
 import org.junit.Test;
 
-public class TestYearMonthSerialization
+public class YearMonthSerializationTest
 	extends ModuleTestBase
 {
     private static class SimpleAggregate
@@ -49,14 +50,7 @@ public class TestYearMonthSerialization
         }
     }
 
-    private ObjectMapper MAPPER;
-
-    @Before
-    public void setUp()
-    {
-        this.MAPPER = new ObjectMapper();
-        this.MAPPER.registerModule(new JavaTimeModule());
-    }
+    private final ObjectMapper MAPPER = newMapper();
 
     @Test
     public void testSerializationAsTimestamp01() throws Exception
