{"url":"https://api.github.com/repos/FasterXML/jackson-modules-java8/issues/175","repository_url":"https://api.github.com/repos/FasterXML/jackson-modules-java8","labels_url":"https://api.github.com/repos/FasterXML/jackson-modules-java8/issues/175/labels{/name}","comments_url":"https://api.github.com/repos/FasterXML/jackson-modules-java8/issues/175/comments","events_url":"https://api.github.com/repos/FasterXML/jackson-modules-java8/issues/175/events","html_url":"https://github.com/FasterXML/jackson-modules-java8/issues/175","id":621062728,"node_id":"MDU6SXNzdWU2MjEwNjI3Mjg=","number":175,"title":"ObjectMapper#setTimeZone ignored by jsr-310/datetime types during serialization when using `@JsonFormat` annotation ","user":{"login":"ErwanLeroux","id":1643338,"node_id":"MDQ6VXNlcjE2NDMzMzg=","avatar_url":"https://avatars.githubusercontent.com/u/1643338?v=4","gravatar_id":"","url":"https://api.github.com/users/ErwanLeroux","html_url":"https://github.com/ErwanLeroux","followers_url":"https://api.github.com/users/ErwanLeroux/followers","following_url":"https://api.github.com/users/ErwanLeroux/following{/other_user}","gists_url":"https://api.github.com/users/ErwanLeroux/gists{/gist_id}","starred_url":"https://api.github.com/users/ErwanLeroux/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ErwanLeroux/subscriptions","organizations_url":"https://api.github.com/users/ErwanLeroux/orgs","repos_url":"https://api.github.com/users/ErwanLeroux/repos","events_url":"https://api.github.com/users/ErwanLeroux/events{/privacy}","received_events_url":"https://api.github.com/users/ErwanLeroux/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":1499316538,"node_id":"MDU6TGFiZWwxNDk5MzE2NTM4","url":"https://api.github.com/repos/FasterXML/jackson-modules-java8/labels/good%20first%20issue","name":"good first issue","color":"b3ff6d","default":true,"description":"Issue that seems easy to resolve and is likely a good candidate for contributors new to project"},{"id":2386945117,"node_id":"MDU6TGFiZWwyMzg2OTQ1MTE3","url":"https://api.github.com/repos/FasterXML/jackson-modules-java8/labels/hacktoberfest","name":"hacktoberfest","color":"e580aa","default":false,"description":"Issue related to Hactoberfest2020 activities, eligible for additional rewards"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/FasterXML/jackson-modules-java8/milestones/17","html_url":"https://github.com/FasterXML/jackson-modules-java8/milestone/17","labels_url":"https://api.github.com/repos/FasterXML/jackson-modules-java8/milestones/17/labels","id":5526431,"node_id":"MDk6TWlsZXN0b25lNTUyNjQzMQ==","number":17,"title":"2.12.0","description":null,"creator":{"login":"cowtowncoder","id":55065,"node_id":"MDQ6VXNlcjU1MDY1","avatar_url":"https://avatars.githubusercontent.com/u/55065?v=4","gravatar_id":"","url":"https://api.github.com/users/cowtowncoder","html_url":"https://github.com/cowtowncoder","followers_url":"https://api.github.com/users/cowtowncoder/followers","following_url":"https://api.github.com/users/cowtowncoder/following{/other_user}","gists_url":"https://api.github.com/users/cowtowncoder/gists{/gist_id}","starred_url":"https://api.github.com/users/cowtowncoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cowtowncoder/subscriptions","organizations_url":"https://api.github.com/users/cowtowncoder/orgs","repos_url":"https://api.github.com/users/cowtowncoder/repos","events_url":"https://api.github.com/users/cowtowncoder/events{/privacy}","received_events_url":"https://api.github.com/users/cowtowncoder/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":6,"state":"open","created_at":"2020-06-10T03:05:32Z","updated_at":"2024-02-04T01:58:16Z","due_on":null,"closed_at":null},"comments":4,"created_at":"2020-05-19T15:13:24Z","updated_at":"2020-10-20T04:56:50Z","closed_at":"2020-10-08T02:23:25Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"Hello, i have an issue regarding the serialization of OffsetDateTime, the timezone i set in the object mapper is not used\r\n\r\nWith the following code\r\n```\r\npublic class POJO {\r\n    @JsonFormat(shape = JsonFormat.Shape.STRING, pattern = \"yyyy-MM-dd'T'HH:mm:ss.SSSXXX\")\r\n    private OffsetDateTime offsetDateTimeWithoutTimeZone;\r\n}\r\n```\r\n```\r\npublic static void setUp() {\r\n    mapperWithTimezone = new ObjectMapper()\r\n            .registerModule(new JavaTimeModule())\r\n            .disable(SerializationFeature.WRITE_DATES_AS_TIMESTAMPS)\r\n            .setTimeZone(TimeZone.getTimeZone(\"Europe/Paris\"))\r\n            .enable(SerializationFeature.INDENT_OUTPUT);\r\n}\r\n```\r\n```\r\nfinal OffsetDateTime firstJune2020AtNoonOffsetUTC = OffsetDateTime.of(\r\n        LocalDate.of(2020, Month.JUNE, 1),\r\n        LocalTime.NOON,\r\n        ZoneOffset.UTC);\r\n\r\nfinal POJO pojoOffsetUTC = new POJO();\r\npojoOffsetUTC.setOffsetDateTimeWithoutTimeZone(firstJune2020AtNoonOffsetUTC);\r\nfinal String strPojoOffSetUTC = mapperWithTimezone.writeValueAsString(pojoOffsetUTC);\r\n```\r\nI'm expecting that the output is\r\n\r\n```{\"offsetDateTimeWithoutTimeZone\" : \"2020-06-01T14:00:00.000+02:00\"}```\r\n\r\n but i get\r\n\r\n```{\"offsetDateTimeWithoutTimeZone\" : \"2020-06-01T12:00:00.000Z\"}```\r\n\r\nThe javadoc of com.fasterxml.jackson.annotation.JsonFormat#timezone tells me that the default is the one specified in the objectMapper, but UTC is used instead.\r\n\r\nI search a bit in the code, and i didn't see anything regarding the use of ObjectMapper#setTimezone in the method com.fasterxml.jackson.datatype.jsr310.ser.JSR310FormattedSerializerBase#createContextual\r\n\r\nWhen i specify the timezone in the JsonFormat annotation, it work as intended, but i would prefer to have a global setting rather specifying it for each field.\r\n\r\nI created a repo with a working code to illustrate my question : https://github.com/ErwanLeroux/jackson-issue","closed_by":{"login":"cowtowncoder","id":55065,"node_id":"MDQ6VXNlcjU1MDY1","avatar_url":"https://avatars.githubusercontent.com/u/55065?v=4","gravatar_id":"","url":"https://api.github.com/users/cowtowncoder","html_url":"https://github.com/cowtowncoder","followers_url":"https://api.github.com/users/cowtowncoder/followers","following_url":"https://api.github.com/users/cowtowncoder/following{/other_user}","gists_url":"https://api.github.com/users/cowtowncoder/gists{/gist_id}","starred_url":"https://api.github.com/users/cowtowncoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cowtowncoder/subscriptions","organizations_url":"https://api.github.com/users/cowtowncoder/orgs","repos_url":"https://api.github.com/users/cowtowncoder/repos","events_url":"https://api.github.com/users/cowtowncoder/events{/privacy}","received_events_url":"https://api.github.com/users/cowtowncoder/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/FasterXML/jackson-modules-java8/issues/175/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/FasterXML/jackson-modules-java8/issues/175/timeline","performed_via_github_app":null,"state_reason":"completed"}