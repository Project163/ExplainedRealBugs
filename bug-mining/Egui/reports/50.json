{"url":"https://api.github.com/repos/emilk/egui/issues/4254","repository_url":"https://api.github.com/repos/emilk/egui","labels_url":"https://api.github.com/repos/emilk/egui/issues/4254/labels{/name}","comments_url":"https://api.github.com/repos/emilk/egui/issues/4254/comments","events_url":"https://api.github.com/repos/emilk/egui/issues/4254/events","html_url":"https://github.com/emilk/egui/issues/4254","id":2212249965,"node_id":"I_kwDOCd2s286D3EFt","number":4254,"title":"On Wayland, app repaints every frame if IME output is set","user":{"login":"white-axe","id":144272066,"node_id":"U_kgDOCJlqwg","avatar_url":"https://avatars.githubusercontent.com/u/144272066?v=4","gravatar_id":"","url":"https://api.github.com/users/white-axe","html_url":"https://github.com/white-axe","followers_url":"https://api.github.com/users/white-axe/followers","following_url":"https://api.github.com/users/white-axe/following{/other_user}","gists_url":"https://api.github.com/users/white-axe/gists{/gist_id}","starred_url":"https://api.github.com/users/white-axe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/white-axe/subscriptions","organizations_url":"https://api.github.com/users/white-axe/orgs","repos_url":"https://api.github.com/users/white-axe/repos","events_url":"https://api.github.com/users/white-axe/events{/privacy}","received_events_url":"https://api.github.com/users/white-axe/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":1191600517,"node_id":"MDU6TGFiZWwxMTkxNjAwNTE3","url":"https://api.github.com/repos/emilk/egui/labels/bug","name":"bug","color":"FBCA04","default":true,"description":"Something is broken"},{"id":3453345708,"node_id":"LA_kwDOCd2s287N1d-s","url":"https://api.github.com/repos/emilk/egui/labels/native-linux","name":"native-linux","color":"d93f0b","default":false,"description":"Problem specific to Linux"},{"id":6664079956,"node_id":"LA_kwDOCd2s288AAAABjTXKVA","url":"https://api.github.com/repos/emilk/egui/labels/IME","name":"IME","color":"6CBD16","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2024-03-28T02:59:04Z","updated_at":"2024-03-30T16:14:59Z","closed_at":"2024-03-30T16:14:59Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"**Describe the bug**\r\nOn Linux with Wayland, when an egui app using eframe has `ui.output(|o| o.ime)` not equal to `None`, the app continuously repaints.\r\n\r\nOne example of when `ui.output(|o| o.ime)` is not `None` is when an `egui::widgets::TextEdit` is focused because it is set by the widget in order to allow IMEs to determine where the cursor is.\r\n\r\nI haven't tested this on non-Linux machines, but WebAssembly apps in browsers on Linux don't seem to have this problem, nor do apps for Windows running in Wine on Linux. Linux with X11 doesn't have this problem either.\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n1. Clone egui and checkout to the 0.27.0 tag\r\n2. `cargo run -p egui_demo_app`\r\n3. Make sure \"Backend\" is selected in the top-left corner of the app so that the left pane is visible\r\n4. Set the rendering mode to \"Reactive\" in the left pane so that the app doesn't repaint unless it has to\r\n5. Focus the text edit in the widget gallery or any other text edit\r\n6. Observe that the \"Mean CPU usage\" in the left pane constantly updates, meaning the app is repainting every frame\r\n\r\n**Expected behavior**\r\nThe app should not repaint every frame when the text edit is selected.\r\n\r\n**Desktop (please complete the following information):**\r\n - OS: Arch Linux with GNOME 46\r\n - Version: Linux unknown 6.8.1-zen1-1-zen <span>#</span>1 ZEN SMP PREEMPT_DYNAMIC Sat, 16 Mar 2024 17:15:23 +0000 x86_64 GNU/Linux","closed_by":{"login":"emilk","id":1148717,"node_id":"MDQ6VXNlcjExNDg3MTc=","avatar_url":"https://avatars.githubusercontent.com/u/1148717?v=4","gravatar_id":"","url":"https://api.github.com/users/emilk","html_url":"https://github.com/emilk","followers_url":"https://api.github.com/users/emilk/followers","following_url":"https://api.github.com/users/emilk/following{/other_user}","gists_url":"https://api.github.com/users/emilk/gists{/gist_id}","starred_url":"https://api.github.com/users/emilk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/emilk/subscriptions","organizations_url":"https://api.github.com/users/emilk/orgs","repos_url":"https://api.github.com/users/emilk/repos","events_url":"https://api.github.com/users/emilk/events{/privacy}","received_events_url":"https://api.github.com/users/emilk/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/emilk/egui/issues/4254/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/emilk/egui/issues/4254/timeline","performed_via_github_app":null,"state_reason":"completed"}