<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 20:16:06 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[LANG-815] DurationFormatUtils.formatPeriod() mis-calculation</title>
                <link>https://issues.apache.org/jira/browse/LANG-815</link>
                <project id="12310481" key="LANG">Commons Lang</project>
                    <description>&lt;p&gt;Hello,&lt;/p&gt;

&lt;p&gt;I just encountered an issue with DurationFormatUtils.formatPeriod()&lt;br/&gt;
and here I suggest the patch.&lt;/p&gt;

&lt;p&gt;The problem is found when calcurating a duration between  June 30 to August 8.&lt;/p&gt;

&lt;p&gt;Duration must be 1 month and 9 days  (June 30 + 1 month = July 30,&lt;br/&gt;
July 30 + 9 Days = August 8)&lt;br/&gt;
but current logic tells this duration is 1 month and 8 days.&lt;/p&gt;

&lt;p&gt;then I found out the logic to adjust days value if it was negative by&lt;br/&gt;
initial estimate. it uses start date&lt;br/&gt;
(June in above case) but must use prev month of end date (July in&lt;br/&gt;
above case). then days value was&lt;br/&gt;
wrong since getActualMaximum() will return a wrong number.&lt;/p&gt;

&lt;p&gt;thank you,&lt;br/&gt;
-Naoya&lt;/p&gt;</description>
                <environment>&lt;p&gt;JDK 1.7&lt;/p&gt;</environment>
        <key id="12604134">LANG-815</key>
            <summary>DurationFormatUtils.formatPeriod() mis-calculation</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="8">Not A Problem</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="naoya_sugioka">Naoya Sugioka</reporter>
                        <labels>
                    </labels>
                <created>Mon, 20 Aug 2012 22:04:11 +0000</created>
                <updated>Tue, 15 Oct 2013 02:33:06 +0000</updated>
                            <resolved>Thu, 27 Sep 2012 12:47:45 +0000</resolved>
                                    <version>3.1</version>
                                                    <component>lang.time.*</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                    <workratio workratioPercent="0"/>
                                    <progress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                    <timeoriginalestimate seconds="3600">1h</timeoriginalestimate>
                            <timeestimate seconds="3600">1h</timeestimate>
                                        <comments>
                            <comment id="13438260" author="naoya_sugioka" created="Mon, 20 Aug 2012 22:04:59 +0000"  >&lt;p&gt;a suggested patch&lt;/p&gt;</comment>
                            <comment id="13443537" author="garydgregory" created="Tue, 28 Aug 2012 21:09:48 +0000"  >&lt;p&gt;This patch breaks a unit test:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;junit.framework.ComparisonFailure: expected:&amp;lt;01 2[6]&amp;gt; but was:&amp;lt;01 2[3]&amp;gt;
	at junit.framework.Assert.assertEquals(Assert.java:85)
	at junit.framework.Assert.assertEquals(Assert.java:91)
	at org.apache.commons.lang3.time.DurationFormatUtilsTest.assertEqualDuration(DurationFormatUtilsTest.java:553)
	at org.apache.commons.lang3.time.DurationFormatUtilsTest.assertEqualDuration(DurationFormatUtilsTest.java:540)
	at org.apache.commons.lang3.time.DurationFormatUtilsTest.testEdgeDurations(DurationFormatUtilsTest.java:421)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
	at java.lang.reflect.Method.invoke(Unknown Source)
	at junit.framework.TestCase.runTest(TestCase.java:168)
	at junit.framework.TestCase.runBare(TestCase.java:134)
	at junit.framework.TestResult$1.protect(TestResult.java:110)
	at junit.framework.TestResult.runProtected(TestResult.java:128)
	at junit.framework.TestResult.run(TestResult.java:113)
	at junit.framework.TestCase.run(TestCase.java:124)
	at junit.framework.TestSuite.runTest(TestSuite.java:243)
	at junit.framework.TestSuite.run(TestSuite.java:238)
	at org.junit.internal.runners.JUnit38ClassRunner.run(JUnit38ClassRunner.java:83)
	at org.eclipse.jdt.internal.junit4.runner.JUnit4TestReference.run(JUnit4TestReference.java:50)
	at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38)
	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:467)
	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:683)
	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:390)
	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:197)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Base your patch on trunk&lt;/li&gt;
	&lt;li&gt;Please provide a unit test to cover your specific case.&lt;/li&gt;
	&lt;li&gt;Make sure existing tests break (unless there is a bug in the test itself.)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Thank you.&lt;/p&gt;
</comment>
                            <comment id="13461101" author="dmjones500" created="Sat, 22 Sep 2012 10:04:01 +0000"  >&lt;p&gt;I don&apos;t believe this is a bug. Below is a test case that should demonstrate the issue, but it passes just fine:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;@Test
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void testLANG815() {
    Calendar calendar = Calendar.getInstance();
    calendar.set(2012, 6, 30, 0, 0, 0);
    &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; startMillis = calendar.getTimeInMillis();
    
    calendar.set(2012, 8, 8);
    &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; endMillis = calendar.getTimeInMillis();
    
    
    assertEquals(&lt;span class=&quot;code-quote&quot;&gt;&quot;1 9&quot;&lt;/span&gt;, DurationFormatUtils
            .formatPeriod(startMillis, endMillis, &lt;span class=&quot;code-quote&quot;&gt;&quot;M d&quot;&lt;/span&gt;));
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13464680" author="sebb@apache.org" created="Thu, 27 Sep 2012 12:47:45 +0000"  >&lt;p&gt;URL: &lt;a href=&quot;http://svn.apache.org/viewvc?rev=1390971&amp;amp;view=rev&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?rev=1390971&amp;amp;view=rev&lt;/a&gt;&lt;br/&gt;
Log:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/LANG-815&quot; title=&quot;DurationFormatUtils.formatPeriod() mis-calculation&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LANG-815&quot;&gt;&lt;del&gt;LANG-815&lt;/del&gt;&lt;/a&gt; DurationFormatUtils.formatPeriod() mis-calculation&lt;br/&gt;
Add test case to show there is no issue&lt;/p&gt;

&lt;p&gt;Modified:&lt;br/&gt;
    commons/proper/lang/trunk/src/test/java/org/apache/commons/lang3/time/DurationFormatUtilsTest.java&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12541661" name="duration-format.diff" size="801" author="naoya_sugioka" created="Mon, 20 Aug 2012 22:04:59 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>252744</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 8 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0d59j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>74629</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>