<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 20:14:40 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[LANG-342] HashCodeBuilder.append(long) is incorrect</title>
                <link>https://issues.apache.org/jira/browse/LANG-342</link>
                <project id="12310481" key="LANG">Commons Lang</project>
                    <description>&lt;p&gt;I was looking at using HashCodeBuilder rather than always writing out the strategy by hand, and I noticed one potential mistake:&lt;br/&gt;
    /**&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Append a hashCode for a long.&lt;br/&gt;
     *&lt;/li&gt;
	&lt;li&gt;@param value  the long to add to the hashCode&lt;/li&gt;
	&lt;li&gt;@return this&lt;br/&gt;
     */&lt;br/&gt;
    public HashCodeBuilder append(long value)
    {
        iTotal = iTotal * iConstant + ((int) (value ^ (value &amp;gt;&amp;gt; 32))); 
        return this;
    }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;whereas Effective Java and Long.hashCode() use:&lt;br/&gt;
    /**&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Returns a hash code for this &amp;lt;code&amp;gt;Long&amp;lt;/code&amp;gt;. The result is&lt;/li&gt;
	&lt;li&gt;the exclusive OR of the two halves of the primitive&lt;/li&gt;
	&lt;li&gt;&amp;lt;code&amp;gt;long&amp;lt;/code&amp;gt; value held by this &amp;lt;code&amp;gt;Long&amp;lt;/code&amp;gt;&lt;/li&gt;
	&lt;li&gt;object. That is, the hashcode is the value of the expression:&lt;/li&gt;
	&lt;li&gt;&amp;lt;blockquote&amp;gt;&amp;lt;pre&amp;gt;&lt;/li&gt;
	&lt;li&gt;(int)(this.longValue()^(this.longValue()&amp;gt;&amp;gt;&amp;gt;32))&lt;/li&gt;
	&lt;li&gt;&amp;lt;/pre&amp;gt;&amp;lt;/blockquote&amp;gt;&lt;br/&gt;
     *&lt;/li&gt;
	&lt;li&gt;@return  a hash code value for this object.&lt;br/&gt;
     */&lt;br/&gt;
    public int hashCode() 
{
      return (int)(value ^ (value &amp;gt;&amp;gt;&amp;gt; 32));
    }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;So the author accidentally used a signed right-shift rather than an unsigned.&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;Stephen Colebourne noted that while this is a bug, it is minor and could have backward compatability issues.  I would simply recommend that a non-JavaDoc comment be added noting this method doesn&apos;t follow &quot;Effective Java&quot; correctly.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12372191">LANG-342</key>
            <summary>HashCodeBuilder.append(long) is incorrect</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="2">Won&apos;t Fix</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="bmanes">Benjamin Manes</reporter>
                        <labels>
                    </labels>
                <created>Fri, 22 Jun 2007 07:42:50 +0000</created>
                <updated>Thu, 20 Sep 2007 17:55:11 +0000</updated>
                            <resolved>Thu, 20 Sep 2007 17:55:12 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="12510779" author="bayard" created="Fri, 6 Jul 2007 20:27:04 +0000"  >&lt;p&gt;Setting fix version to 2.3.1 so the javadoc can be added. Then it should be reversioned to 3.0 for consideration there.&lt;/p&gt;</comment>
                            <comment id="12518586" author="bayard" created="Thu, 9 Aug 2007 00:29:39 +0000"  >&lt;p&gt;Non-javadoc note added to HashCodeBuilder.append.&lt;/p&gt;</comment>
                            <comment id="12528909" author="jcsahnwaldt" created="Wed, 19 Sep 2007 21:29:28 +0000"  >&lt;p&gt;It doesn&apos;t matter if &amp;gt;&amp;gt;&amp;gt; or &amp;gt;&amp;gt; is used. We shift down the upper half of the long and XOR with the lower half. Of course, we also XOR the unshifted upper half with the shifted upper half (which consists of zeros or ones), but then we cast to int, which simply throws away the upper half. It doesn&apos;t matter at all if there were zeros or ones in the shifted upper half.&lt;/p&gt;

&lt;p&gt;Here&apos;s a little test. Looping through all longs takes too long, let&apos;s just use random numbers.&lt;/p&gt;

&lt;p&gt;java.util.Random rnd = new java.util.Random();&lt;br/&gt;
for (;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;br/&gt;
{&lt;br/&gt;
  long value = rnd.nextLong();&lt;br/&gt;
  int signed = (int)(value ^ (value &amp;gt;&amp;gt; 32));&lt;br/&gt;
  int unsigned = (int)(value ^ (value &amp;gt;&amp;gt;&amp;gt; 32));&lt;br/&gt;
  if (signed != unsigned) System.out.println(value+&quot; &quot;&lt;ins&gt;signed&lt;/ins&gt;&quot; &quot;+unsigned);&lt;br/&gt;
}&lt;/p&gt;</comment>
                            <comment id="12529170" author="scolebourne" created="Thu, 20 Sep 2007 17:55:09 +0000"  >&lt;p&gt;Thanks for the analysis. I&apos;ll close the issue as &apos;Won&apos;t fix&apos;, as a comment has already been added to the sourcebase.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>147253</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            18 years, 10 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0d67z:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>74784</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>