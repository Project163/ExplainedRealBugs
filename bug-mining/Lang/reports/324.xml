<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 20:16:32 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[LANG-1039] HashCodeBuilder.reflectionHashCode(Object object) returns always the same result for any array</title>
                <link>https://issues.apache.org/jira/browse/LANG-1039</link>
                <project id="12310481" key="LANG">Commons Lang</project>
                    <description>&lt;p&gt;HashCodeBuilder.reflectionHashCode(Object object) returns always the same result for any array. The result is 17.&lt;/p&gt;

&lt;p&gt;There is no information in javadoc, that this method works in that way.&lt;br/&gt;
The same situation in previous versions.&lt;/p&gt;

&lt;p&gt;&lt;b&gt;Example:&lt;/b&gt;&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;HashCodeBuilderTest {
    
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void main(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] args) {
        
        &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(HashCodeBuilder.reflectionHashCode(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;[] {1, 1}));
        &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(HashCodeBuilder.reflectionHashCode(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;[] {2, 2}));
        &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(HashCodeBuilder.reflectionHashCode(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;[] {3, 3}));
        &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(HashCodeBuilder.reflectionHashCode(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;[] {4, 4}));
        &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(HashCodeBuilder.reflectionHashCode(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Long&lt;/span&gt;[] {5L, 5L}));
        &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(HashCodeBuilder.reflectionHashCode(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Double&lt;/span&gt;[] {&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;}));
        &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(HashCodeBuilder.reflectionHashCode(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;[] {&lt;span class=&quot;code-object&quot;&gt;Boolean&lt;/span&gt;.FALSE, 1L, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;}));
        
    }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;b&gt;Output:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;17
17
17
17
17
17
17
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;b&gt;Fix example 1&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;First check if argument obj in HashCodeBuilder.reflectionHashCode(Object obj) is an array and than use java.util.Arrays.hashCode(Object[] array)&lt;/p&gt;</description>
                <environment>&lt;p&gt;Windows 7, Java 6&lt;/p&gt;</environment>
        <key id="12743223">LANG-1039</key>
            <summary>HashCodeBuilder.reflectionHashCode(Object object) returns always the same result for any array</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="8">Not A Problem</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="bpaszkow">Bartosz Paszkowski</reporter>
                        <labels>
                    </labels>
                <created>Mon, 22 Sep 2014 15:59:27 +0000</created>
                <updated>Wed, 19 Oct 2016 15:24:44 +0000</updated>
                            <resolved>Sun, 28 Sep 2014 06:03:39 +0000</resolved>
                                    <version>3.3.2</version>
                                                    <component>lang.builder.*</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="14146299" author="dmjones500" created="Wed, 24 Sep 2014 13:18:30 +0000"  >&lt;p&gt;This method works by examining the fields of an object and creating a cumulative hashcode based upon them. Given that an array has no fields, this behaviour seems correct to me (albeit a little counter-intuitive).&lt;/p&gt;

&lt;p&gt;If those arrays had been contained within an object (the normal use case), your results would not be observed. Your results are identical to what you&apos;d see if you simply called &lt;tt&gt;HashCodeBuilder.reflectionHashCode(new Object())&lt;/tt&gt;.&lt;/p&gt;</comment>
                            <comment id="14147565" author="halfdan" created="Thu, 25 Sep 2014 09:14:15 +0000"  >&lt;p&gt;The Javadoc for method HashCodeBuilder.reflectionHashCode states:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&quot;This method uses reflection to build a valid hash code.&quot;&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;And a valid hashCode implementation indeed doesn&apos;t have to produce distinct values for different instances:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;As much as is reasonably practical, the hashCode method defined by class Object does return distinct integers for distinct objects. (This is typically implemented by converting the internal address of the object into an integer, but this implementation technique is not required by the JavaTM programming language.)&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;However in this particular implementation we can apply &quot;the principle of least astonishment&quot;:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;If a necessary feature has a high astonishment factor, it may be necessary to redesign the feature.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;One can be astonished seeing how this method returns the same value (namely 17) for every array, no matter how big or of what type.&lt;/p&gt;</comment>
                            <comment id="14147601" author="dmjones500" created="Thu, 25 Sep 2014 10:22:50 +0000"  >&lt;p&gt;The first line in the Javadoc for the &lt;tt&gt;HashCodeBuilder&lt;/tt&gt; is:&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Assists in implementing &lt;tt&gt;Object.hashCode()&lt;/tt&gt; methods.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;In other words. the supported use case is generating a hash code for your own custom class. You either do this manually by appending fields to the hash code builder, or you use the reflective builder:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; hashCode() {
  &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; HashCodeBuilder.reflectionHashCode(&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;);
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;There is no expectation that &lt;tt&gt;reflectionHashCode()&lt;/tt&gt; will be passed a primitive array object. I see no reason to change this behaviour, given the documented intention of the class.&lt;/p&gt;</comment>
                            <comment id="14147988" author="halfdan" created="Thu, 25 Sep 2014 17:07:52 +0000"  >&lt;blockquote&gt;
&lt;p&gt;The first line in the Javadoc for the HashCodeBuilder is:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;Assists in implementing Object.hashCode() methods.&lt;/p&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;

&lt;p&gt;and the second line in the Javadoc is:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;This class enables a good hashCode method to be built for any class.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;This is the interface:&lt;br/&gt;
reflectionHashCode(Object object, String... excludeFields)&lt;br/&gt;
It promises, that it will work for any given Object.&lt;br/&gt;
It doesnt say, that it isn&apos;t for arrays.&lt;br/&gt;
Neither does Javadoc.&lt;/p&gt;

&lt;p&gt;So I see two options:&lt;br/&gt;
1. To add statement like: &quot;Warning: This method provides constant result of 17 for any array.&quot;&lt;br/&gt;
2. To refactor this method for consistency.&lt;/p&gt;

&lt;p&gt;Living it the way it is is simply irresponsible.&lt;/p&gt;
</comment>
                            <comment id="14149041" author="dmjones500" created="Fri, 26 Sep 2014 11:30:32 +0000"  >&lt;p&gt;Could you describe your use case in more detail? As I&apos;ve explained, our expectation is for this method to be used to help you override &lt;tt&gt;Object.hashCode()&lt;/tt&gt; when creating your own class. Consequently, we were not expecting to be passed an array as an argument.&lt;/p&gt;

&lt;p&gt;It would be helpful to understand how you are trying to use it, so we can better decide if this is a use case we want to support. If it is, we can look at altering the class behaviour. If it&apos;s not, then we can look to improve the Javadocs to avoid similar confusion in the future.&lt;/p&gt;</comment>
                            <comment id="14149284" author="halfdan" created="Fri, 26 Sep 2014 15:21:51 +0000"  >&lt;p&gt;There is no such use case. &lt;br/&gt;
We&apos;ve only found a bug in this method, that is all.&lt;br/&gt;
So we are telling you about it to be helpful and to improve your library.&lt;br/&gt;
If you say:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Consequently, we were not expecting to be passed an array as an argument.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;than you must allways remember, that your code should be idiot-proof.&lt;br/&gt;
You cannot simply expect, that your code will be used according to your guides - you have to enforce this.&lt;/p&gt;

&lt;p&gt;I&apos;m sure you will come up with some good solution.&lt;br/&gt;
Good luck.&lt;/p&gt;</comment>
                            <comment id="14149311" author="kgorecki" created="Fri, 26 Sep 2014 15:39:17 +0000"  >&lt;p&gt;Then for consistency let&apos;s make all these methods: &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;HashCodeBuilder.append(&lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;[])
HashCodeBuilder.append(&lt;span class=&quot;code-object&quot;&gt;char&lt;/span&gt;[])
HashCodeBuilder.append(&lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt;[])
HashCodeBuilder.append(&lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;[])
HashCodeBuilder.append(&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;[])
HashCodeBuilder.append(&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;[])
HashCodeBuilder.append(&lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt;[])
HashCodeBuilder.append(&lt;span class=&quot;code-object&quot;&gt;short&lt;/span&gt;[])
HashCodeBuilder.append(&lt;span class=&quot;code-object&quot;&gt;float&lt;/span&gt;[])&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;return 17 &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="14150006" author="dmjones500" created="Fri, 26 Sep 2014 21:24:17 +0000"  >&lt;p&gt;Since there isn&apos;t a new use case being discussed, I&apos;m content that the class can remain as it is (functionally). To avoid any future confusion about how the method works, I&apos;ve made some adjustments to the Javadoc to make it clear that a constant result is return if the supplied object has no fields to include in the hash code.&lt;/p&gt;

&lt;p&gt;&amp;#8212;&lt;/p&gt;

&lt;p&gt;Author: djones&lt;br/&gt;
Date: Fri Sep 26 21:19:12 2014&lt;br/&gt;
New Revision: 1627889&lt;/p&gt;

&lt;p&gt;URL: &lt;a href=&quot;http://svn.apache.org/r1627889&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/r1627889&lt;/a&gt;&lt;br/&gt;
Log:&lt;br/&gt;
Made it clear that the fields of the object form the hash code (&lt;a href=&quot;https://issues.apache.org/jira/browse/LANG-1039&quot; title=&quot;HashCodeBuilder.reflectionHashCode(Object object) returns always the same result for any array&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LANG-1039&quot;&gt;&lt;del&gt;LANG-1039&lt;/del&gt;&lt;/a&gt;).&lt;br/&gt;
Pulled magic values into constants.&lt;/p&gt;

&lt;p&gt;Modified:&lt;br/&gt;
    commons/proper/lang/trunk/src/main/java/org/apache/commons/lang3/builder/HashCodeBuilder.java&lt;/p&gt;</comment>
                            <comment id="14150702" author="bpaszkow" created="Sat, 27 Sep 2014 18:51:40 +0000"  >&lt;p&gt;Thank you.&lt;/p&gt;</comment>
                            <comment id="14150706" author="kgorecki" created="Sat, 27 Sep 2014 18:56:18 +0000"  >&lt;p&gt;Thank you!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 8 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i20cav:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>