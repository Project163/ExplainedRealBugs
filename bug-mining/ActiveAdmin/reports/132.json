{"url":"https://api.github.com/repos/activeadmin/activeadmin/issues/5093","repository_url":"https://api.github.com/repos/activeadmin/activeadmin","labels_url":"https://api.github.com/repos/activeadmin/activeadmin/issues/5093/labels{/name}","comments_url":"https://api.github.com/repos/activeadmin/activeadmin/issues/5093/comments","events_url":"https://api.github.com/repos/activeadmin/activeadmin/issues/5093/events","html_url":"https://github.com/activeadmin/activeadmin/issues/5093","id":244874479,"node_id":"MDU6SXNzdWUyNDQ4NzQ0Nzk=","number":5093,"title":"table name prefix & suffix not taken into account for active_admin_comments","user":{"login":"Techbrunch","id":1835765,"node_id":"MDQ6VXNlcjE4MzU3NjU=","avatar_url":"https://avatars.githubusercontent.com/u/1835765?v=4","gravatar_id":"","url":"https://api.github.com/users/Techbrunch","html_url":"https://github.com/Techbrunch","followers_url":"https://api.github.com/users/Techbrunch/followers","following_url":"https://api.github.com/users/Techbrunch/following{/other_user}","gists_url":"https://api.github.com/users/Techbrunch/gists{/gist_id}","starred_url":"https://api.github.com/users/Techbrunch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Techbrunch/subscriptions","organizations_url":"https://api.github.com/users/Techbrunch/orgs","repos_url":"https://api.github.com/users/Techbrunch/repos","events_url":"https://api.github.com/users/Techbrunch/events{/privacy}","received_events_url":"https://api.github.com/users/Techbrunch/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2017-07-22T22:04:41Z","updated_at":"2017-07-25T14:21:26Z","closed_at":"2017-07-25T14:21:26Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"Because I'm currently working with a legacy database, I have setup a table name prefix in `config/application.rb`.\r\n\r\n```ruby\r\nActiveRecord::Base.table_name_prefix = 'prefix_'\r\n```\r\n\r\nIt appears that ActiveAdmin does not pickup on that, which result in a Mysql error when trying to display the index page of the `Comment` resource or any individual resources:\r\n\r\n### Expected behavior\r\n\r\nActiveAdmin should detect that a prefix has been set on ActiveRecord and use it when retrieving admin comments.\r\n\r\n### Actual behavior\r\n\r\nI think that since `table_name` is set `/lib/active_admin/orm/active_record/comments/comment.rb` the `table_name_prefix` is discarded.\r\n\r\n```\r\nActiveRecord::StatementInvalid in Admin::CommentsController#index\r\nMysql2::Error: Table 'database.active_admin_comments' doesn't exist: SHOW FULL FIELDS FROM `active_admin_comments`\r\n```\r\n\r\n### Suggested fix\r\n\r\nSomething like:\r\n```ruby\r\nmodule ActiveAdmin\r\n  class Comment < ActiveRecord::Base\r\n\r\n    self.table_name = \"#{self.table_name_prefix}active_admin_comments\"\r\n[...]\r\n```\r\n\r\nI'll see if this work tomorrow and if yes I'll create a pull request.\r\n\r\nPS: Note same thing is happening for the suffix.","closed_by":{"login":"javierjulio","id":198547,"node_id":"MDQ6VXNlcjE5ODU0Nw==","avatar_url":"https://avatars.githubusercontent.com/u/198547?v=4","gravatar_id":"","url":"https://api.github.com/users/javierjulio","html_url":"https://github.com/javierjulio","followers_url":"https://api.github.com/users/javierjulio/followers","following_url":"https://api.github.com/users/javierjulio/following{/other_user}","gists_url":"https://api.github.com/users/javierjulio/gists{/gist_id}","starred_url":"https://api.github.com/users/javierjulio/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javierjulio/subscriptions","organizations_url":"https://api.github.com/users/javierjulio/orgs","repos_url":"https://api.github.com/users/javierjulio/repos","events_url":"https://api.github.com/users/javierjulio/events{/privacy}","received_events_url":"https://api.github.com/users/javierjulio/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/activeadmin/activeadmin/issues/5093/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/activeadmin/activeadmin/issues/5093/timeline","performed_via_github_app":null,"state_reason":"completed"}