{"url":"https://api.github.com/repos/activeadmin/activeadmin/issues/5236","repository_url":"https://api.github.com/repos/activeadmin/activeadmin","labels_url":"https://api.github.com/repos/activeadmin/activeadmin/issues/5236/labels{/name}","comments_url":"https://api.github.com/repos/activeadmin/activeadmin/issues/5236/comments","events_url":"https://api.github.com/repos/activeadmin/activeadmin/issues/5236/events","html_url":"https://github.com/activeadmin/activeadmin/issues/5236","id":272262798,"node_id":"MDU6SXNzdWUyNzIyNjI3OTg=","number":5236,"title":"Has Many association for model with a primary key other than :id causes undefined method error in Ransack when building filters.","user":{"login":"wspurgin","id":3472781,"node_id":"MDQ6VXNlcjM0NzI3ODE=","avatar_url":"https://avatars.githubusercontent.com/u/3472781?v=4","gravatar_id":"","url":"https://api.github.com/users/wspurgin","html_url":"https://github.com/wspurgin","followers_url":"https://api.github.com/users/wspurgin/followers","following_url":"https://api.github.com/users/wspurgin/following{/other_user}","gists_url":"https://api.github.com/users/wspurgin/gists{/gist_id}","starred_url":"https://api.github.com/users/wspurgin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wspurgin/subscriptions","organizations_url":"https://api.github.com/users/wspurgin/orgs","repos_url":"https://api.github.com/users/wspurgin/repos","events_url":"https://api.github.com/users/wspurgin/events{/privacy}","received_events_url":"https://api.github.com/users/wspurgin/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2017-11-08T16:29:57Z","updated_at":"2017-11-19T16:45:08Z","closed_at":"2017-11-19T16:45:08Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"This is pulled from [this SO question](https://stackoverflow.com/questions/47141863/active-admin-and-has-one/47142866#47142866).\r\n\r\n### Expected behavior\r\n\r\nA User model is associated to many Vehicles. A basic Admin interface is registered for the User model with no filters manually defined\r\n\r\n```ruby\r\n# models/user.rb\r\nclass User < ApplicationRecord\r\n  # Include default devise modules. Others available are:\r\n  # :confirmable, :lockable, :timeoutable and :omniauthable\r\n  devise :database_authenticatable,\r\n         :recoverable, :rememberable, :trackable, :validatable\r\n\r\n  has_many :vehicles\r\nend\r\n\r\n# admin/user.rb\r\n\r\nActiveAdmin.register User do\r\nend\r\n```\r\n\r\nGoing to `/admin/users` should produce a admin index view of all users.\r\n\r\n### Actual behavior\r\n\r\nThe OP of the StackOverflow question lined above got an undefined method error for the Ransack search that AA attempted to create for the default filters. Here's the full error trace in [pastbin](https://pastebin.com/JZvpS5rS).\r\n\r\n`undefined method vehicle_id_eq for Ransack::Search<class: User, base: Grouping <combinator: and>>:Ransack::Search`\r\n\r\n### How to reproduce\r\n\r\nHere's the rub. I've created [this sample app](https://github.com/wspurgin/vanilla/tree/active_admin-default-filters-created-for-has-associations) with what *should* be close to the setup the OP of that question had, but I can't reproduce their error.\r\n\r\nI'll attempt to get the OP to add or link their code here though.\r\n\r\nHowever, regardless of that issue, I think this is also a good discussion point. Should we create filters for all non-polymorphic associations by default? What about `has_and_belongs_to_many` associations? Maybe our default filters should not include any associations?\r\n\r\n----------------------------\r\n\r\n**EDIT**\r\n\r\nOP's code is visible here: https://github.com/brenninger01/csc4500_permits/tree/testing\r\n\r\nI've updated the linked sample app to reproduce the error. It appears that it's due to the primary key for the association being something *other than* id. It looks like its from `default_association_filters` in `filters/resource_extension.rb`. We just set the filter as the `name` of the association (`vehicles` in this case). However, Ransack should be able to tell from the association that the primary key of `vehicles` is *not* `id`. Could it be an issue with Ransack?","closed_by":{"login":"varyonic","id":780081,"node_id":"MDQ6VXNlcjc4MDA4MQ==","avatar_url":"https://avatars.githubusercontent.com/u/780081?v=4","gravatar_id":"","url":"https://api.github.com/users/varyonic","html_url":"https://github.com/varyonic","followers_url":"https://api.github.com/users/varyonic/followers","following_url":"https://api.github.com/users/varyonic/following{/other_user}","gists_url":"https://api.github.com/users/varyonic/gists{/gist_id}","starred_url":"https://api.github.com/users/varyonic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/varyonic/subscriptions","organizations_url":"https://api.github.com/users/varyonic/orgs","repos_url":"https://api.github.com/users/varyonic/repos","events_url":"https://api.github.com/users/varyonic/events{/privacy}","received_events_url":"https://api.github.com/users/varyonic/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/activeadmin/activeadmin/issues/5236/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/activeadmin/activeadmin/issues/5236/timeline","performed_via_github_app":null,"state_reason":"completed"}