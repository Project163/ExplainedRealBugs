{"url":"https://api.github.com/repos/activeadmin/activeadmin/issues/3583","repository_url":"https://api.github.com/repos/activeadmin/activeadmin","labels_url":"https://api.github.com/repos/activeadmin/activeadmin/issues/3583/labels{/name}","comments_url":"https://api.github.com/repos/activeadmin/activeadmin/issues/3583/comments","events_url":"https://api.github.com/repos/activeadmin/activeadmin/issues/3583/events","html_url":"https://github.com/activeadmin/activeadmin/issues/3583","id":47852268,"node_id":"MDU6SXNzdWU0Nzg1MjI2OA==","number":3583,"title":"Comments no longer associated with an STI model's base class","user":{"login":"johnmaxwell","id":13686,"node_id":"MDQ6VXNlcjEzNjg2","avatar_url":"https://avatars.githubusercontent.com/u/13686?v=4","gravatar_id":"","url":"https://api.github.com/users/johnmaxwell","html_url":"https://github.com/johnmaxwell","followers_url":"https://api.github.com/users/johnmaxwell/followers","following_url":"https://api.github.com/users/johnmaxwell/following{/other_user}","gists_url":"https://api.github.com/users/johnmaxwell/gists{/gist_id}","starred_url":"https://api.github.com/users/johnmaxwell/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/johnmaxwell/subscriptions","organizations_url":"https://api.github.com/users/johnmaxwell/orgs","repos_url":"https://api.github.com/users/johnmaxwell/repos","events_url":"https://api.github.com/users/johnmaxwell/events{/privacy}","received_events_url":"https://api.github.com/users/johnmaxwell/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":21,"created_at":"2014-11-05T16:00:27Z","updated_at":"2015-01-27T09:00:38Z","closed_at":"2015-01-27T09:00:37Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"Rails has a feature called Single Table Inheritance that allows you to subclass ActiveRecord models via a type field, and when that particular record is loaded from a database, it will be instantiated as the subclass in specified in the type field.  You can read more about this Rails feature here: http://api.rubyonrails.org/classes/ActiveRecord/Base.html#class-ActiveRecord::Base-label-Single+table+inheritance\n\nIn ActiveAdmin 0.6.3, ActiveAdmin::Comments were created and associated with an ActiveRecord model's base_class (http://api.rubyonrails.org/classes/ActiveRecord/Inheritance/ClassMethods.html#method-i-base_class) via it's `resource` polymorphic association.   In ActiveAdmin 1.0.0.pre the ActiveAdmin::Comments are associated with the subclass itself, not its model base class.\n\nSo in the documentation example above where you have the following STI hierarchy:\n\n```\nclass Company < ActiveRecord::Base; end\nclass Firm < Company; end\nclass Client < Company; end\nclass PriorityClient < Client; end\n```\n\nCreating a comment on any instance of these in ActiveAdmin 0.6.3 and earlier would be associated with the \"Company\" class.  In ActiveAdmin 1.0.0.pre, the same comments comments would be associated with their respective subclass: Firm, Client, or PriorityClient.\n\nThe upshot is that this change breaks the comment associations with models that use STI in two ways:\n- Coming from ActiveAdmin versions < 1.0.0, Comments won't be found for an STI model.\n- If a model switches type, it loses the associated comments.\n\nIs this an intentional change?  I've monkey-patched ActiveAdmin::Comment.resource_type in my own app to restore the old, more compatible behavior.  I can submit a patch if you want to restore that behavior.\n","closed_by":{"login":"timoschilling","id":165599,"node_id":"MDQ6VXNlcjE2NTU5OQ==","avatar_url":"https://avatars.githubusercontent.com/u/165599?v=4","gravatar_id":"","url":"https://api.github.com/users/timoschilling","html_url":"https://github.com/timoschilling","followers_url":"https://api.github.com/users/timoschilling/followers","following_url":"https://api.github.com/users/timoschilling/following{/other_user}","gists_url":"https://api.github.com/users/timoschilling/gists{/gist_id}","starred_url":"https://api.github.com/users/timoschilling/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/timoschilling/subscriptions","organizations_url":"https://api.github.com/users/timoschilling/orgs","repos_url":"https://api.github.com/users/timoschilling/repos","events_url":"https://api.github.com/users/timoschilling/events{/privacy}","received_events_url":"https://api.github.com/users/timoschilling/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/activeadmin/activeadmin/issues/3583/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/activeadmin/activeadmin/issues/3583/timeline","performed_via_github_app":null,"state_reason":"completed"}