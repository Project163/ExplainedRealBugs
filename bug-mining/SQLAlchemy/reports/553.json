{"url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/10079","repository_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy","labels_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/10079/labels{/name}","comments_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/10079/comments","events_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/10079/events","html_url":"https://github.com/sqlalchemy/sqlalchemy/issues/10079","id":1795228413,"node_id":"I_kwDOCX5JB85rAQL9","number":10079,"title":"url.make_url returning not URL instances ","user":{"login":"grigoriev-semyon","id":33061489,"node_id":"MDQ6VXNlcjMzMDYxNDg5","avatar_url":"https://avatars.githubusercontent.com/u/33061489?v=4","gravatar_id":"","url":"https://api.github.com/users/grigoriev-semyon","html_url":"https://github.com/grigoriev-semyon","followers_url":"https://api.github.com/users/grigoriev-semyon/followers","following_url":"https://api.github.com/users/grigoriev-semyon/following{/other_user}","gists_url":"https://api.github.com/users/grigoriev-semyon/gists{/gist_id}","starred_url":"https://api.github.com/users/grigoriev-semyon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/grigoriev-semyon/subscriptions","organizations_url":"https://api.github.com/users/grigoriev-semyon/orgs","repos_url":"https://api.github.com/users/grigoriev-semyon/repos","events_url":"https://api.github.com/users/grigoriev-semyon/events{/privacy}","received_events_url":"https://api.github.com/users/grigoriev-semyon/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":1141275752,"node_id":"MDU6TGFiZWwxMTQxMjc1NzUy","url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/labels/engine","name":"engine","color":"B04040","default":false,"description":"engines, connections, transactions, isolation levels, execution options"},{"id":1313059238,"node_id":"MDU6TGFiZWwxMzEzMDU5MjM4","url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/labels/use%20case","name":"use case","color":"b54650","default":false,"description":"not really a feature or a bug; can be support for new DB features or user use cases not anticipated"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/milestones/100","html_url":"https://github.com/sqlalchemy/sqlalchemy/milestone/100","labels_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/milestones/100/labels","id":8974115,"node_id":"MI_kwDOCX5JB84AiO8j","number":100,"title":"2.0.x","description":"","creator":{"login":"CaselIT","id":16175304,"node_id":"MDQ6VXNlcjE2MTc1MzA0","avatar_url":"https://avatars.githubusercontent.com/u/16175304?v=4","gravatar_id":"","url":"https://api.github.com/users/CaselIT","html_url":"https://github.com/CaselIT","followers_url":"https://api.github.com/users/CaselIT/followers","following_url":"https://api.github.com/users/CaselIT/following{/other_user}","gists_url":"https://api.github.com/users/CaselIT/gists{/gist_id}","starred_url":"https://api.github.com/users/CaselIT/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CaselIT/subscriptions","organizations_url":"https://api.github.com/users/CaselIT/orgs","repos_url":"https://api.github.com/users/CaselIT/repos","events_url":"https://api.github.com/users/CaselIT/events{/privacy}","received_events_url":"https://api.github.com/users/CaselIT/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":68,"closed_issues":416,"state":"open","created_at":"2023-01-27T12:23:11Z","updated_at":"2025-11-08T19:58:19Z","due_on":null,"closed_at":null},"comments":1,"created_at":"2023-07-09T04:25:24Z","updated_at":"2023-07-12T18:54:16Z","closed_at":"2023-07-12T18:54:15Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Describe the bug\n\nIf you pass an object to `create_engine`, for example, of the type `<class 'pydantic_core._pydantic_core.MultiHostUrl'>`\r\nthat sqlalchemy will fall with an error, since the `url.make_url` function takes as an argument either a string, or an object of the URL type, or Mock for testing.\r\n\r\nI believe that the SQLAlchemy should warn that an invalid type has been passed.\n\n### Optional link from https://docs.sqlalchemy.org which documents the behavior that is expected\n\n_No response_\n\n### SQLAlchemy Version in Use\n\n2.0.18\n\n### DBAPI (i.e. the database driver)\n\npsycopg2\n\n### Database Vendor and Major Version\n\nPostgreSQL\n\n### Python Version\n\n3.11\n\n### Operating system\n\nOSX\n\n### To Reproduce\n\n```python\nfrom pydantic import PostgresDsn\r\nfrom pydantic_settings import BaseSettings\r\n\r\n\r\nclass Settings(BaseSettings):\r\n    \"\"\"Application settings\"\"\"\r\n    DB_DSN: PostgresDsn = 'postgresql://postgres@localhost:5432/postgres'\r\n\r\ncreate_engine(Settings().DB_DSN)\n```\n\n\n### Error\n\n```\r\nTraceback (most recent call last):\r\n  File \".../venv/bin/alembic\", line 8, in <module>\r\n    sys.exit(main())\r\n             ^^^^^^\r\n  File \".../venv/lib/python3.11/site-packages/alembic/config.py\", line 632, in main\r\n    CommandLine(prog=prog).main(argv=argv)\r\n  File \".../venv/lib/python3.11/site-packages/alembic/config.py\", line 626, in main\r\n    self.run_cmd(cfg, options)\r\n  File \".../venv/lib/python3.11/site-packages/alembic/config.py\", line 603, in run_cmd\r\n    fn(\r\n  File \".../venv/lib/python3.11/site-packages/alembic/command.py\", line 385, in upgrade\r\n    script.run_env()\r\n  File \".../venv/lib/python3.11/site-packages/alembic/script/base.py\", line 582, in run_env\r\n    util.load_python_file(self.dir, \"env.py\")\r\n  File \".../venv/lib/python3.11/site-packages/alembic/util/pyfiles.py\", line 94, in load_python_file\r\n    module = load_module_py(module_id, path)\r\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \".../venv/lib/python3.11/site-packages/alembic/util/pyfiles.py\", line 110, in load_module_py\r\n    spec.loader.exec_module(module)  # type: ignore\r\n    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"<frozen importlib._bootstrap_external>\", line 940, in exec_module\r\n  File \"<frozen importlib._bootstrap>\", line 241, in _call_with_frames_removed\r\n  File \".../migrations/env.py\", line 82, in <module>\r\n    run_migrations_online()\r\n  File \".../migrations/env.py\", line 66, in run_migrations_online\r\n    connectable = engine_from_config(\r\n                  ^^^^^^^^^^^^^^^^^^^\r\n  File \".../venv/lib/python3.11/site-packages/sqlalchemy/engine/create.py\", line 806, in engine_from_config\r\n    return create_engine(url, **options)\r\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"<string>\", line 2, in create_engine\r\n  File \".../venv/lib/python3.11/site-packages/sqlalchemy/util/deprecations.py\", line 281, in warned\r\n    return fn(*args, **kwargs)  # type: ignore[no-any-return]\r\n           ^^^^^^^^^^^^^^^^^^^\r\n  File \".../venv/lib/python3.11/site-packages/sqlalchemy/engine/create.py\", line 553, in create_engine\r\n    u, plugins, kwargs = u._instantiate_plugins(kwargs)\r\n                         ^^^^^^^^^^^^^^^^^^^^^^\r\nAttributeError: 'pydantic_core._pydantic_core.MultiHostUrl' object has no attribute '_instantiate_plugins'\r\n\r\n``` \n\n### Additional context\n\n_No response_","closed_by":{"login":"sqlalchemy-bot","id":36047385,"node_id":"MDQ6VXNlcjM2MDQ3Mzg1","avatar_url":"https://avatars.githubusercontent.com/u/36047385?v=4","gravatar_id":"","url":"https://api.github.com/users/sqlalchemy-bot","html_url":"https://github.com/sqlalchemy-bot","followers_url":"https://api.github.com/users/sqlalchemy-bot/followers","following_url":"https://api.github.com/users/sqlalchemy-bot/following{/other_user}","gists_url":"https://api.github.com/users/sqlalchemy-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/sqlalchemy-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sqlalchemy-bot/subscriptions","organizations_url":"https://api.github.com/users/sqlalchemy-bot/orgs","repos_url":"https://api.github.com/users/sqlalchemy-bot/repos","events_url":"https://api.github.com/users/sqlalchemy-bot/events{/privacy}","received_events_url":"https://api.github.com/users/sqlalchemy-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/10079/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":1,"eyes":0},"timeline_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/10079/timeline","performed_via_github_app":null,"state_reason":"completed"}