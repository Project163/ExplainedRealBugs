{"url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/3047","repository_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy","labels_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/3047/labels{/name}","comments_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/3047/comments","events_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/3047/events","html_url":"https://github.com/sqlalchemy/sqlalchemy/issues/3047","id":384630459,"node_id":"MDU6SXNzdWUzODQ2MzA0NTk=","number":3047,"title":"Errors when creating models are hidden","user":{"login":"sqlalchemy-bot","id":36047385,"node_id":"MDQ6VXNlcjM2MDQ3Mzg1","avatar_url":"https://avatars.githubusercontent.com/u/36047385?v=4","gravatar_id":"","url":"https://api.github.com/users/sqlalchemy-bot","html_url":"https://github.com/sqlalchemy-bot","followers_url":"https://api.github.com/users/sqlalchemy-bot/followers","following_url":"https://api.github.com/users/sqlalchemy-bot/following{/other_user}","gists_url":"https://api.github.com/users/sqlalchemy-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/sqlalchemy-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sqlalchemy-bot/subscriptions","organizations_url":"https://api.github.com/users/sqlalchemy-bot/orgs","repos_url":"https://api.github.com/users/sqlalchemy-bot/repos","events_url":"https://api.github.com/users/sqlalchemy-bot/events{/privacy}","received_events_url":"https://api.github.com/users/sqlalchemy-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":1141269142,"node_id":"MDU6TGFiZWwxMTQxMjY5MTQy","url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/milestones/68","html_url":"https://github.com/sqlalchemy/sqlalchemy/milestone/68","labels_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/milestones/68/labels","id":3850651,"node_id":"MDk6TWlsZXN0b25lMzg1MDY1MQ==","number":68,"title":"0.9.5","description":null,"creator":{"login":"sqlalchemy-bot","id":36047385,"node_id":"MDQ6VXNlcjM2MDQ3Mzg1","avatar_url":"https://avatars.githubusercontent.com/u/36047385?v=4","gravatar_id":"","url":"https://api.github.com/users/sqlalchemy-bot","html_url":"https://github.com/sqlalchemy-bot","followers_url":"https://api.github.com/users/sqlalchemy-bot/followers","following_url":"https://api.github.com/users/sqlalchemy-bot/following{/other_user}","gists_url":"https://api.github.com/users/sqlalchemy-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/sqlalchemy-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sqlalchemy-bot/subscriptions","organizations_url":"https://api.github.com/users/sqlalchemy-bot/orgs","repos_url":"https://api.github.com/users/sqlalchemy-bot/repos","events_url":"https://api.github.com/users/sqlalchemy-bot/events{/privacy}","received_events_url":"https://api.github.com/users/sqlalchemy-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":42,"state":"closed","created_at":"2018-11-27T04:28:42Z","updated_at":"2018-11-28T16:50:00Z","due_on":null,"closed_at":"2018-11-28T16:50:00Z"},"comments":15,"created_at":"2014-05-10T20:19:23Z","updated_at":"2014-05-11T17:44:17Z","closed_at":"2014-05-11T17:44:17Z","author_association":"COLLABORATOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"**Migrated issue, originally created by Matthias Urlichs ([@smurfix](https://github.com/smurfix))**\n\nThe problem I saw was that the _first_ access to MyDeclarativeTable.query returned None, but after that everything worked.\n\nI would like to actually see the error. I cannot understand why you're hiding it, in multiple places.\n\nThe first is in lib/sqlalchemy/orm/scoping.py:query_property() where inside the query class you return None if there was an UnmappedClassError.\n\nThe second is in sqlalchemy/orm/base.py:_inspect_mapped_class() where you return None upon catching exc.NO_STATE, which is an AttributeError, which neatly masks off the AttributeError that my model caused because of a typo.\n\nI submit that this makes no sense whatsoever, and I'd like to ask you to do something about these nonproductive try/except statements. They mask real problems. I can't see any practical use for them.\n\nThis is what I did:\n```\nTraceback (most recent call last):\n  File \"./manage.py\", line 42, in <module>\n    manager.run()\n  File \"/usr/lib/python2.7/dist-packages/flask_script/__init__.py\", line 412, in run\n    result = self.handle(sys.argv[0], sys.argv[1:])\n  File \"/usr/lib/python2.7/dist-packages/flask_script/__init__.py\", line 383, in handle\n    res = handle(*args, **config)\n  File \"/daten/src/git/pip/pybble/pybble/manager/main.py\", line 119, in __call__\n    return create_app(**kw)\n  File \"/daten/src/git/pip/pybble/pybble/app/__init__.py\", line 342, in create_app\n    site = Site.q.get_by(domain=text_type(site))\n  File \"/usr/lib/python2.7/dist-packages/sqlalchemy/orm/scoping.py\", line 130, in __get__\n    mapper = class_mapper(owner)\n  File \"/usr/lib/python2.7/dist-packages/sqlalchemy/orm/base.py\", line 383, in class_mapper\n    raise exc.UnmappedClassError(class_)\nUnmappedClassError: Class 'pybble.core.models.site.Site' is not mapped\n> /usr/lib/python2.7/dist-packages/sqlalchemy/orm/base.py(383)class_mapper()\n-> raise exc.UnmappedClassError(class_)\n(Pdb) q\nsmurf@data:/daten/src/git/pip/pybble$ test/run.sh populate\n> /daten/src/git/pip/pybble/pybble/app/__init__.py(342)create_app()\n-> site = Site.q.get_by(domain=text_type(site))\n(Pdb) b /usr/lib/python2.7/dist-packages/sqlalchemy/orm/base.py:378\nBreakpoint 1 at /usr/lib/python2.7/dist-packages/sqlalchemy/orm/base.py:378\n(Pdb) c\n> /usr/lib/python2.7/dist-packages/sqlalchemy/orm/base.py(378)class_mapper()\n-> mapper = _inspect_mapped_class(class_, configure=configure)\n(Pdb) cl\nClear all breaks? y\n(Pdb) s\n--Call--\n> /usr/lib/python2.7/dist-packages/sqlalchemy/orm/base.py(347)_inspect_mapped_class()\n-> @inspection._inspects(type)\n(Pdb) n\n> /usr/lib/python2.7/dist-packages/sqlalchemy/orm/base.py(349)_inspect_mapped_class()\n-> try:\n(Pdb) \n> /usr/lib/python2.7/dist-packages/sqlalchemy/orm/base.py(350)_inspect_mapped_class()\n-> class_manager = manager_of_class(class_)\n(Pdb) \n> /usr/lib/python2.7/dist-packages/sqlalchemy/orm/base.py(351)_inspect_mapped_class()\n-> if not class_manager.is_mapped:\n(Pdb) \n> /usr/lib/python2.7/dist-packages/sqlalchemy/orm/base.py(353)_inspect_mapped_class()\n-> mapper = class_manager.mapper\n(Pdb) \n> /usr/lib/python2.7/dist-packages/sqlalchemy/orm/base.py(354)_inspect_mapped_class()\n-> if configure and mapper._new_mappers:\n(Pdb) \n> /usr/lib/python2.7/dist-packages/sqlalchemy/orm/base.py(355)_inspect_mapped_class()\n-> mapper._configure_all()\n(Pdb) \nAttributeError: \"type object 'SiteConfigVar' has no attribute 'name'\"\n> /usr/lib/python2.7/dist-packages/sqlalchemy/orm/base.py(355)_inspect_mapped_class()\n-> mapper._configure_all()\n(Pdb) \n\n```\n\nIt's not realistic to expect users to find their bugs by trial and error when Python has error handling which is perfectly capable of reporting exactly what went wrong.\n\nRemoving these exception handlers is (mostly) straightforward. See the attached patch, which does not break any of the basic (sqlite) test cases.\n\n","closed_by":{"login":"sqlalchemy-bot","id":36047385,"node_id":"MDQ6VXNlcjM2MDQ3Mzg1","avatar_url":"https://avatars.githubusercontent.com/u/36047385?v=4","gravatar_id":"","url":"https://api.github.com/users/sqlalchemy-bot","html_url":"https://github.com/sqlalchemy-bot","followers_url":"https://api.github.com/users/sqlalchemy-bot/followers","following_url":"https://api.github.com/users/sqlalchemy-bot/following{/other_user}","gists_url":"https://api.github.com/users/sqlalchemy-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/sqlalchemy-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sqlalchemy-bot/subscriptions","organizations_url":"https://api.github.com/users/sqlalchemy-bot/orgs","repos_url":"https://api.github.com/users/sqlalchemy-bot/repos","events_url":"https://api.github.com/users/sqlalchemy-bot/events{/privacy}","received_events_url":"https://api.github.com/users/sqlalchemy-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/3047/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/3047/timeline","performed_via_github_app":null,"state_reason":"completed"}