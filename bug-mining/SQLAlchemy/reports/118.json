{"url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/3014","repository_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy","labels_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/3014/labels{/name}","comments_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/3014/comments","events_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/3014/events","html_url":"https://github.com/sqlalchemy/sqlalchemy/issues/3014","id":384630118,"node_id":"MDU6SXNzdWUzODQ2MzAxMTg=","number":3014,"title":"Documentation for recursive CTE query - column order in second select needs to be same order as first select.","user":{"login":"sqlalchemy-bot","id":36047385,"node_id":"MDQ6VXNlcjM2MDQ3Mzg1","avatar_url":"https://avatars.githubusercontent.com/u/36047385?v=4","gravatar_id":"","url":"https://api.github.com/users/sqlalchemy-bot","html_url":"https://github.com/sqlalchemy-bot","followers_url":"https://api.github.com/users/sqlalchemy-bot/followers","following_url":"https://api.github.com/users/sqlalchemy-bot/following{/other_user}","gists_url":"https://api.github.com/users/sqlalchemy-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/sqlalchemy-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sqlalchemy-bot/subscriptions","organizations_url":"https://api.github.com/users/sqlalchemy-bot/orgs","repos_url":"https://api.github.com/users/sqlalchemy-bot/repos","events_url":"https://api.github.com/users/sqlalchemy-bot/events{/privacy}","received_events_url":"https://api.github.com/users/sqlalchemy-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":1141269142,"node_id":"MDU6TGFiZWwxMTQxMjY5MTQy","url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"},{"id":1141273862,"node_id":"MDU6TGFiZWwxMTQxMjczODYy","url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/labels/documentation","name":"documentation","color":"ffe7a8","default":true,"description":""},{"id":1141273863,"node_id":"MDU6TGFiZWwxMTQxMjczODYz","url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/labels/low%20priority","name":"low priority","color":"90C0D0","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/milestones/74","html_url":"https://github.com/sqlalchemy/sqlalchemy/milestone/74","labels_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/milestones/74/labels","id":3850658,"node_id":"MDk6TWlsZXN0b25lMzg1MDY1OA==","number":74,"title":"0.9.4","description":null,"creator":{"login":"sqlalchemy-bot","id":36047385,"node_id":"MDQ6VXNlcjM2MDQ3Mzg1","avatar_url":"https://avatars.githubusercontent.com/u/36047385?v=4","gravatar_id":"","url":"https://api.github.com/users/sqlalchemy-bot","html_url":"https://github.com/sqlalchemy-bot","followers_url":"https://api.github.com/users/sqlalchemy-bot/followers","following_url":"https://api.github.com/users/sqlalchemy-bot/following{/other_user}","gists_url":"https://api.github.com/users/sqlalchemy-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/sqlalchemy-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sqlalchemy-bot/subscriptions","organizations_url":"https://api.github.com/users/sqlalchemy-bot/orgs","repos_url":"https://api.github.com/users/sqlalchemy-bot/repos","events_url":"https://api.github.com/users/sqlalchemy-bot/events{/privacy}","received_events_url":"https://api.github.com/users/sqlalchemy-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":32,"state":"closed","created_at":"2018-11-27T04:30:13Z","updated_at":"2018-11-28T16:50:02Z","due_on":null,"closed_at":"2018-11-28T16:50:02Z"},"comments":6,"created_at":"2014-04-02T22:04:07Z","updated_at":"2014-04-04T08:35:03Z","closed_at":"2014-04-02T22:14:26Z","author_association":"COLLABORATOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"**Migrated issue, originally created by Stephen Bridgett ([@sbridgett](https://github.com/sbridgett))**\n\nFirstly thank you for all the great work developing SQLalchemy.\n\nI was trying to create a recursive CTE query using the \"sub_part\" example given on:\n\n(1)     http://docs.sqlalchemy.org/en/rel_0_9/core/selectable.html\nand on:\n(2)    http://docs.sqlalchemy.org/en/rel_0_9/orm/query.html\n\nboth in sections titled:\n \"cte(name=None, recursive=False)\"\n\nhowever the query hangs, - when tried on SQLite 3 and on Postgres 8.4.\n(I am using SQLalchemy version 0.9.3)\n\nwhen I compared the query with the SQL query given on the Postgresql page:\n http://www.postgresql.org/docs/8.4/static/queries-with.html\n(half way down that page)\n\nthe postgres SQL always has the columns in each SELECT in the order:\n\"sub_part, part, quantity\" (in the first select) and:  \"p.sub_part, p.part, p.quantity\" (in the second select)\n\nHowever the SQLalchemy ORM query on page:\n    http://docs.sqlalchemy.org/en/rel_0_9/orm/query.html\nhas:\n     Part.sub_part,  Part.part, Part.quantity  (for the first select),\nbut then in the second select the order is changed to:\n   parts_alias.part, parts_alias.sub_part, parts_alias.quantity\n\nIf I change the order of columns in this second select to:\n\n    session.query(\n        parts_alias.sub_part,\n        parts_alias.part,\n        parts_alias.quantity).\\\n\n(ie. putting \"sub_part\" first to match the order in the first select)\n\nThen the query works well. It seems to be important that the columns are in same order for the recursive cte union to work.\n\nThis applies: \n\n(1) to the ORM query page:\n   http://docs.sqlalchemy.org/en/rel_0_9/orm/query.html\n  section titled:   cte(name=None, recursive=False)\n\n(2) and to the CORE selectable page:\n   http://docs.sqlalchemy.org/en/rel_0_9/core/selectable.html\n  section titled:   cte(name=None, recursive=False)\n\nCould these two pages be updated to correct this?\n\n\nAlso on that CORE selectable page, I think the select_from function: \n\n\"select_from(included_parts.join(parts,\n                    included_parts.c.part==parts.c.part))\"\n\nat the end of that CTE \"statement=\" recursive query isn't really needed, as the final query doesn't select from \"parts\", although it could be useful if wish to select additional columns from \"part\", so is still helpful.\n\nThank you again for all the great work developing SQLalchemy.\n\n","closed_by":{"login":"sqlalchemy-bot","id":36047385,"node_id":"MDQ6VXNlcjM2MDQ3Mzg1","avatar_url":"https://avatars.githubusercontent.com/u/36047385?v=4","gravatar_id":"","url":"https://api.github.com/users/sqlalchemy-bot","html_url":"https://github.com/sqlalchemy-bot","followers_url":"https://api.github.com/users/sqlalchemy-bot/followers","following_url":"https://api.github.com/users/sqlalchemy-bot/following{/other_user}","gists_url":"https://api.github.com/users/sqlalchemy-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/sqlalchemy-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sqlalchemy-bot/subscriptions","organizations_url":"https://api.github.com/users/sqlalchemy-bot/orgs","repos_url":"https://api.github.com/users/sqlalchemy-bot/repos","events_url":"https://api.github.com/users/sqlalchemy-bot/events{/privacy}","received_events_url":"https://api.github.com/users/sqlalchemy-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/3014/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/3014/timeline","performed_via_github_app":null,"state_reason":"completed"}