{"url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/3501","repository_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy","labels_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/3501/labels{/name}","comments_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/3501/comments","events_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/3501/events","html_url":"https://github.com/sqlalchemy/sqlalchemy/issues/3501","id":384634635,"node_id":"MDU6SXNzdWUzODQ2MzQ2MzU=","number":3501,"title":"full positional mapping w/ ORM / corresponding compat for TextAsFrom","user":{"login":"sqlalchemy-bot","id":36047385,"node_id":"MDQ6VXNlcjM2MDQ3Mzg1","avatar_url":"https://avatars.githubusercontent.com/u/36047385?v=4","gravatar_id":"","url":"https://api.github.com/users/sqlalchemy-bot","html_url":"https://github.com/sqlalchemy-bot","followers_url":"https://api.github.com/users/sqlalchemy-bot/followers","following_url":"https://api.github.com/users/sqlalchemy-bot/following{/other_user}","gists_url":"https://api.github.com/users/sqlalchemy-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/sqlalchemy-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sqlalchemy-bot/subscriptions","organizations_url":"https://api.github.com/users/sqlalchemy-bot/orgs","repos_url":"https://api.github.com/users/sqlalchemy-bot/repos","events_url":"https://api.github.com/users/sqlalchemy-bot/events{/privacy}","received_events_url":"https://api.github.com/users/sqlalchemy-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":1141273873,"node_id":"MDU6TGFiZWwxMTQxMjczODcz","url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/labels/high%20priority","name":"high priority","color":"C0B0E0","default":false,"description":null},{"id":1141273925,"node_id":"MDU6TGFiZWwxMTQxMjczOTI1","url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/labels/feature","name":"feature","color":"306080","default":false,"description":null},{"id":1141274001,"node_id":"MDU6TGFiZWwxMTQxMjc0MDAx","url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/labels/sql","name":"sql","color":"5060F0","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/milestones/41","html_url":"https://github.com/sqlalchemy/sqlalchemy/milestone/41","labels_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/milestones/41/labels","id":3850610,"node_id":"MDk6TWlsZXN0b25lMzg1MDYxMA==","number":41,"title":"1.1","description":null,"creator":{"login":"sqlalchemy-bot","id":36047385,"node_id":"MDQ6VXNlcjM2MDQ3Mzg1","avatar_url":"https://avatars.githubusercontent.com/u/36047385?v=4","gravatar_id":"","url":"https://api.github.com/users/sqlalchemy-bot","html_url":"https://github.com/sqlalchemy-bot","followers_url":"https://api.github.com/users/sqlalchemy-bot/followers","following_url":"https://api.github.com/users/sqlalchemy-bot/following{/other_user}","gists_url":"https://api.github.com/users/sqlalchemy-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/sqlalchemy-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sqlalchemy-bot/subscriptions","organizations_url":"https://api.github.com/users/sqlalchemy-bot/orgs","repos_url":"https://api.github.com/users/sqlalchemy-bot/repos","events_url":"https://api.github.com/users/sqlalchemy-bot/events{/privacy}","received_events_url":"https://api.github.com/users/sqlalchemy-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":96,"state":"closed","created_at":"2018-11-27T04:03:36Z","updated_at":"2018-11-28T16:49:52Z","due_on":null,"closed_at":"2018-11-28T16:49:52Z"},"comments":6,"created_at":"2015-07-26T22:33:48Z","updated_at":"2016-01-14T23:08:02Z","closed_at":"2016-01-14T23:08:02Z","author_association":"COLLABORATOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"**Migrated issue, originally created by Michael Bayer ([@zzzeek](https://github.com/zzzeek))**\n\ntons of use cases for TextAsFrom that should be intuitive that don't work.    When we make a TextAsFrom with a positional set of columns, those columns should be welded to it.  The statement should be able to work in any ORM context flawlessly, no reliance on names matching up should be needed as we do not target on name anymore:\n\n\n```\nfrom sqlalchemy import *\nfrom sqlalchemy.orm import *\nfrom sqlalchemy.ext.declarative import declarative_base\n\nBase = declarative_base()\n\n\nclass A(Base):\n    __tablename__ = 'a'\n    id = Column(Integer, primary_key=True)\n    bs = relationship(\"B\")\n\n\nclass B(Base):\n    __tablename__ = 'b'\n    id = Column(Integer, primary_key=True)\n    a_id = Column(ForeignKey('a.id'))\n\ne = create_engine(\"sqlite://\", echo='debug')\nBase.metadata.create_all(e)\n\ns = Session(e)\ns.add_all([\n    A(bs=[B(), B()]),\n    A(bs=[B(), B()])\n])\ns.commit()\n\nb1 = aliased(B)\n\n# works\nsql = \"select a.id, ba.id as bid, ba.a_id from \"\\\n    \"a left outer join b as ba on a.id=ba.a_id\"\n\n# fails.  why?\n# sql = \"select a.id as aid, ba.id as bid, ba.a_id from \"\\\n#    \"a left outer join b as ba on a.id=ba.a_id\"\n\n# fails. why?\n# sql = \"select a.id as aid, ba.id, ba.a_id from \"\\\n#    \"a left outer join b as ba on a.id=ba.a_id\"\n\n\n# are we relying upon names somehow?  we should be able to\n# be 100% positional now\nt = text(sql).columns(A.id, b1.id, b1.a_id)\n\nq = s.query(A).from_statement(t).options(contains_eager(A.bs, alias=b1))\n\nfor a in q:\n    print a.id\n    print a, a.bs\n\n# forget about if we try a1 = aliased(A) also...\n```\n\nI've added docs in 7d268d4bcb5e6205d05ac and 4f51fa947ffa0cadeab7ad7dc that we may even have to dial back for versions that don't have this feature.\n\n----------------------------------------\nAttachments: [3501.patch](../wiki/imported_issue_attachments/3501/3501.patch)\n\n","closed_by":{"login":"sqlalchemy-bot","id":36047385,"node_id":"MDQ6VXNlcjM2MDQ3Mzg1","avatar_url":"https://avatars.githubusercontent.com/u/36047385?v=4","gravatar_id":"","url":"https://api.github.com/users/sqlalchemy-bot","html_url":"https://github.com/sqlalchemy-bot","followers_url":"https://api.github.com/users/sqlalchemy-bot/followers","following_url":"https://api.github.com/users/sqlalchemy-bot/following{/other_user}","gists_url":"https://api.github.com/users/sqlalchemy-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/sqlalchemy-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sqlalchemy-bot/subscriptions","organizations_url":"https://api.github.com/users/sqlalchemy-bot/orgs","repos_url":"https://api.github.com/users/sqlalchemy-bot/repos","events_url":"https://api.github.com/users/sqlalchemy-bot/events{/privacy}","received_events_url":"https://api.github.com/users/sqlalchemy-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/3501/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/3501/timeline","performed_via_github_app":null,"state_reason":"completed"}