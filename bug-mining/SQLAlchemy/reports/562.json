{"url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/11317","repository_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy","labels_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/11317/labels{/name}","comments_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/11317/comments","events_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/11317/events","html_url":"https://github.com/sqlalchemy/sqlalchemy/issues/11317","id":2261851121,"node_id":"I_kwDOCX5JB86G0Rvx","number":11317,"title":"Generated syntax error when using funcs in server_default in MySQL","user":{"login":"CaselIT","id":16175304,"node_id":"MDQ6VXNlcjE2MTc1MzA0","avatar_url":"https://avatars.githubusercontent.com/u/16175304?v=4","gravatar_id":"","url":"https://api.github.com/users/CaselIT","html_url":"https://github.com/CaselIT","followers_url":"https://api.github.com/users/CaselIT/followers","following_url":"https://api.github.com/users/CaselIT/following{/other_user}","gists_url":"https://api.github.com/users/CaselIT/gists{/gist_id}","starred_url":"https://api.github.com/users/CaselIT/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CaselIT/subscriptions","organizations_url":"https://api.github.com/users/CaselIT/orgs","repos_url":"https://api.github.com/users/CaselIT/repos","events_url":"https://api.github.com/users/CaselIT/events{/privacy}","received_events_url":"https://api.github.com/users/CaselIT/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":1141269142,"node_id":"MDU6TGFiZWwxMTQxMjY5MTQy","url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"},{"id":1141273948,"node_id":"MDU6TGFiZWwxMTQxMjczOTQ4","url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/labels/schema","name":"schema","color":"602060","default":false,"description":"things related to the DDL related objects like Table, Column, CreateIndex, etc."},{"id":1141273954,"node_id":"MDU6TGFiZWwxMTQxMjczOTU0","url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/labels/mysql","name":"mysql","color":"30A040","default":false,"description":null},{"id":1144578950,"node_id":"MDU6TGFiZWwxMTQ0NTc4OTUw","url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/labels/functions","name":"functions","color":"ead55b","default":false,"description":"dealing with sql functions, sqlalchemy.sql.functions"},{"id":2205915448,"node_id":"MDU6TGFiZWwyMjA1OTE1NDQ4","url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/labels/mariadb","name":"mariadb","color":"c1fdff","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/milestones/100","html_url":"https://github.com/sqlalchemy/sqlalchemy/milestone/100","labels_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/milestones/100/labels","id":8974115,"node_id":"MI_kwDOCX5JB84AiO8j","number":100,"title":"2.0.x","description":"","creator":{"login":"CaselIT","id":16175304,"node_id":"MDQ6VXNlcjE2MTc1MzA0","avatar_url":"https://avatars.githubusercontent.com/u/16175304?v=4","gravatar_id":"","url":"https://api.github.com/users/CaselIT","html_url":"https://github.com/CaselIT","followers_url":"https://api.github.com/users/CaselIT/followers","following_url":"https://api.github.com/users/CaselIT/following{/other_user}","gists_url":"https://api.github.com/users/CaselIT/gists{/gist_id}","starred_url":"https://api.github.com/users/CaselIT/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CaselIT/subscriptions","organizations_url":"https://api.github.com/users/CaselIT/orgs","repos_url":"https://api.github.com/users/CaselIT/repos","events_url":"https://api.github.com/users/CaselIT/events{/privacy}","received_events_url":"https://api.github.com/users/CaselIT/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":68,"closed_issues":416,"state":"open","created_at":"2023-01-27T12:23:11Z","updated_at":"2025-11-08T19:58:19Z","due_on":null,"closed_at":null},"comments":4,"created_at":"2024-04-24T17:46:39Z","updated_at":"2024-10-08T18:37:45Z","closed_at":"2024-10-08T18:37:44Z","author_association":"MEMBER","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Discussed in https://github.com/sqlalchemy/sqlalchemy/discussions/11315\r\n\r\n<div type='discussions-op-text'>\r\n\r\n<sup>Originally posted by **martinm07** April 24, 2024</sup>\r\nUsing MySQL version `8.0.29` and SQLAlchemy version `2.0.29` on Windows 10, the following code produces the further following error:\r\n```python\r\nfrom sqlalchemy import create_engine, Table, Column, MetaData, Integer, Date, func\r\n\r\nengine = create_engine(\"mysql://root:password@localhost/dbname\", echo=True)\r\n\r\nmetadata_obj = MetaData()\r\nuser_table = Table(\r\n    \"users\",\r\n    metadata_obj,\r\n    Column(\"id\", Integer, primary_key=True),\r\n    Column(\"date_created\", Date, server_default=func.current_date())\r\n)\r\n\r\nmetadata_obj.create_all(engine)\r\n```\r\n```\r\nsqlalchemy.exc.ProgrammingError: (MySQLdb.ProgrammingError) (1064, \"You have an error in your SQL syntax; check the manual that corresponds \r\nto your MySQL server version for the right syntax to use near 'CURRENT_TIME, \\n\\tPRIMARY KEY (id)\\n)' at line 3\")\r\n[SQL:\r\nCREATE TABLE users (\r\n        id INTEGER NOT NULL AUTO_INCREMENT,\r\n        date_created DATE DEFAULT CURRENT_TIME,\r\n        PRIMARY KEY (id)\r\n)\r\n\r\n]\r\n(Background on this error at: https://sqlalche.me/e/20/f405)\r\n```\r\nSQLAlchemy produces incorrect MySQL code, which should be what I put in `text()` below:\r\n```python\r\nfrom sqlalchemy import create_engine, text\r\n\r\nengine = create_engine(\"mysql://root:WeMustKnowWeWillKnow@localhost/testing\", echo=True)\r\n\r\nwith engine.connect() as conn:\r\n    conn.execute(\r\n        text(\"\"\"\r\nCREATE TABLE users (\r\n        id INTEGER NOT NULL AUTO_INCREMENT,\r\n        date_created DATE DEFAULT (CURRENT_TIME),\r\n        PRIMARY KEY (id)\r\n)\r\n\"\"\")\r\n    )\r\n    conn.commit()\r\n```\r\nNamely, brackets around `CURRENT_TIME`.\r\nIs this a bug, or some known limitation?</div>","closed_by":{"login":"sqlalchemy-bot","id":36047385,"node_id":"MDQ6VXNlcjM2MDQ3Mzg1","avatar_url":"https://avatars.githubusercontent.com/u/36047385?v=4","gravatar_id":"","url":"https://api.github.com/users/sqlalchemy-bot","html_url":"https://github.com/sqlalchemy-bot","followers_url":"https://api.github.com/users/sqlalchemy-bot/followers","following_url":"https://api.github.com/users/sqlalchemy-bot/following{/other_user}","gists_url":"https://api.github.com/users/sqlalchemy-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/sqlalchemy-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sqlalchemy-bot/subscriptions","organizations_url":"https://api.github.com/users/sqlalchemy-bot/orgs","repos_url":"https://api.github.com/users/sqlalchemy-bot/repos","events_url":"https://api.github.com/users/sqlalchemy-bot/events{/privacy}","received_events_url":"https://api.github.com/users/sqlalchemy-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/11317/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/11317/timeline","performed_via_github_app":null,"state_reason":"completed"}