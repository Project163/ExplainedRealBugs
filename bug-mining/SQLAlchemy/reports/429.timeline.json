[{"url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/comments/441931715","html_url":"https://github.com/sqlalchemy/sqlalchemy/issues/3593#issuecomment-441931715","issue_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/3593","id":441931715,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0MTkzMTcxNQ==","user":{"login":"sqlalchemy-bot","id":36047385,"node_id":"MDQ6VXNlcjM2MDQ3Mzg1","avatar_url":"https://avatars.githubusercontent.com/u/36047385?v=4","gravatar_id":"","url":"https://api.github.com/users/sqlalchemy-bot","html_url":"https://github.com/sqlalchemy-bot","followers_url":"https://api.github.com/users/sqlalchemy-bot/followers","following_url":"https://api.github.com/users/sqlalchemy-bot/following{/other_user}","gists_url":"https://api.github.com/users/sqlalchemy-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/sqlalchemy-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sqlalchemy-bot/subscriptions","organizations_url":"https://api.github.com/users/sqlalchemy-bot/orgs","repos_url":"https://api.github.com/users/sqlalchemy-bot/repos","events_url":"https://api.github.com/users/sqlalchemy-bot/events{/privacy}","received_events_url":"https://api.github.com/users/sqlalchemy-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2015-11-25T03:14:09Z","updated_at":"2018-11-27T05:53:35Z","body":"**Michael Bayer ([@zzzeek](https://github.com/zzzeek)) wrote:**\n\nIt's the SQL rendering, so that's somewhat of a relief.  \n\nShorter test:\n\n```\nimport sqlalchemy as sa\nimport sqlalchemy.orm\nfrom sqlalchemy.orm import joinedload, joinedload_all\nimport sqlalchemy.ext.declarative\nimport sqlalchemy.ext.orderinglist\n\nBase = sqlalchemy.ext.declarative.declarative_base()\n\n\nclass Node(Base):\n    __tablename__ = 'todo_elements'\n\n    element_id = sa.Column(sa.Integer, nullable=False, primary_key=True)\n    element_type = sa.Column(sa.String(20), nullable=False)\n\n    __mapper_args__ = {\n        'polymorphic_on': element_type,\n        'with_polymorphic': ('*', None),\n    }\n\n\nclass NodeWithEdges(Node):\n    __mapper_args__ = {'polymorphic_identity': 'todo.list'}\n\n\nclass LeafNode(Node):\n    __mapper_args__ = {'polymorphic_identity': 'todo.item'}\n\n    my_flag = sa.Column(sa.Boolean, default=False)\n\n\nclass Edge(Base):\n    __tablename__ = 'todo_links'\n    __table_args__ = (\n        sa.PrimaryKeyConstraint('parent_id', 'child_id'),\n        sa.ForeignKeyConstraint(['parent_id'], [Node.element_id]),\n        sa.ForeignKeyConstraint(['child_id'], [Node.element_id]),\n    )\n\n    parent_id = sa.Column(sa.Integer, nullable=False)\n    child_id = sa.Column(sa.Integer, nullable=False)\n\n\nEdge.child = sa.orm.relationship(\n    Node,\n    primaryjoin=Edge.child_id == Node.element_id,\n)\n\n\nNodeWithEdges.links = sa.orm.relationship(\n    Edge,\n    primaryjoin=NodeWithEdges.element_id == Edge.parent_id,\n)\n\nengine = sa.create_engine('postgresql://scott:tiger@localhost/test', echo=True)\n\nBase.metadata.drop_all(engine)\nBase.metadata.create_all(engine)\n\nSession = sa.orm.sessionmaker(bind=engine)\nsession = Session()\n\n\n#\n# 1 --> 2 --> 3\n#         --> 4\n#         --> 5\n#\n\nn1 = NodeWithEdges(element_id=1)\nn2 = NodeWithEdges(element_id=2)\nn3 = LeafNode(element_id=3)\nn4 = LeafNode(element_id=4, my_flag=True)\nn5 = LeafNode(element_id=5)\n\ne12 = Edge(parent_id=n1.element_id, child_id=n2.element_id)\ne23 = Edge(parent_id=n2.element_id, child_id=n3.element_id)\ne24 = Edge(parent_id=n2.element_id, child_id=n4.element_id)\ne25 = Edge(parent_id=n2.element_id, child_id=n5.element_id)\n\nsession.add_all([n1, n2, n3, n4, n5, e12, e23, e24, e25])\nsession.commit()\nsession.expunge_all()\n\nnew_n1 = session.query(NodeWithEdges).options(\n        joinedload_all(\n            NodeWithEdges.links,\n            Edge.child,\n            NodeWithEdges.links\n        )\n    ).filter(\n    NodeWithEdges.element_id == 1).all()[0]\n\n\ndef traverse(node, f, depth=0):\n    f(node, depth)\n    if hasattr(node, 'links'):\n        for link in node.links:\n            if link.parent_id != node.element_id:\n            #if link.child is node:\n                import pdb\n                pdb.set_trace()\n            else:\n                traverse(link.child, f, depth + 1)\n\ndef indent_print(node, depth):\n    print('  ' * depth + str(node.element_id))\n    if hasattr(node, 'my_flag'):\n        print(node.my_flag)\n\ntraverse(new_n1, indent_print)\n\n```\n\nthe good SQL in 0.8.0:\n\n\n```\nSELECT todo_elements.element_id AS todo_elements_element_id, todo_elements.element_type AS todo_elements_element_type, todo_links_1.parent_id AS todo_links_1_parent_id, todo_links_1.child_id AS todo_links_1_child_id, todo_elements_1.element_id AS todo_elements_1_element_id, todo_elements_1.element_type AS todo_elements_1_element_type, todo_links_2.parent_id AS todo_links_2_parent_id, todo_links_2.child_id AS todo_links_2_child_id, todo_elements_1.my_flag AS todo_elements_1_my_flag \nFROM todo_elements LEFT OUTER JOIN todo_links AS todo_links_1 ON todo_elements.element_id = todo_links_1.parent_id LEFT OUTER JOIN todo_elements AS todo_elements_1 ON todo_links_1.child_id = todo_elements_1.element_id LEFT OUTER JOIN todo_links AS todo_links_2 ON todo_elements_1.element_id = todo_links_2.parent_id \nWHERE todo_elements.element_id = %(element_id_1)s AND todo_elements.element_type IN (%(element_type_1)s)\n\n```\n\nthe bad, the last ON clause gets messed up:\n\n\n```\nSELECT todo_elements.element_id AS todo_elements_element_id, todo_elements.element_type AS todo_elements_element_type, todo_links_1.parent_id AS todo_links_1_parent_id, todo_links_1.child_id AS todo_links_1_child_id, todo_elements_1.element_id AS todo_elements_1_element_id, todo_elements_1.element_type AS todo_elements_1_element_type, todo_links_2.parent_id AS todo_links_2_parent_id, todo_links_2.child_id AS todo_links_2_child_id, todo_elements_1.my_flag AS todo_elements_1_my_flag \nFROM todo_elements LEFT OUTER JOIN todo_links AS todo_links_1 ON todo_elements.element_id = todo_links_1.parent_id LEFT OUTER JOIN todo_elements AS todo_elements_1 ON todo_links_1.child_id = todo_elements_1.element_id LEFT OUTER JOIN todo_links AS todo_links_2 ON todo_elements.element_id = todo_links_2.parent_id \nWHERE todo_elements.element_id = %(element_id_1)s AND todo_elements.element_type IN (%(element_type_1)s)\n\n```\n","author_association":"COLLABORATOR","reactions":{"url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/comments/441931715/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"sqlalchemy-bot","id":36047385,"node_id":"MDQ6VXNlcjM2MDQ3Mzg1","avatar_url":"https://avatars.githubusercontent.com/u/36047385?v=4","gravatar_id":"","url":"https://api.github.com/users/sqlalchemy-bot","html_url":"https://github.com/sqlalchemy-bot","followers_url":"https://api.github.com/users/sqlalchemy-bot/followers","following_url":"https://api.github.com/users/sqlalchemy-bot/following{/other_user}","gists_url":"https://api.github.com/users/sqlalchemy-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/sqlalchemy-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sqlalchemy-bot/subscriptions","organizations_url":"https://api.github.com/users/sqlalchemy-bot/orgs","repos_url":"https://api.github.com/users/sqlalchemy-bot/repos","events_url":"https://api.github.com/users/sqlalchemy-bot/events{/privacy}","received_events_url":"https://api.github.com/users/sqlalchemy-bot/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/comments/441931716","html_url":"https://github.com/sqlalchemy/sqlalchemy/issues/3593#issuecomment-441931716","issue_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/3593","id":441931716,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0MTkzMTcxNg==","user":{"login":"sqlalchemy-bot","id":36047385,"node_id":"MDQ6VXNlcjM2MDQ3Mzg1","avatar_url":"https://avatars.githubusercontent.com/u/36047385?v=4","gravatar_id":"","url":"https://api.github.com/users/sqlalchemy-bot","html_url":"https://github.com/sqlalchemy-bot","followers_url":"https://api.github.com/users/sqlalchemy-bot/followers","following_url":"https://api.github.com/users/sqlalchemy-bot/following{/other_user}","gists_url":"https://api.github.com/users/sqlalchemy-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/sqlalchemy-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sqlalchemy-bot/subscriptions","organizations_url":"https://api.github.com/users/sqlalchemy-bot/orgs","repos_url":"https://api.github.com/users/sqlalchemy-bot/repos","events_url":"https://api.github.com/users/sqlalchemy-bot/events{/privacy}","received_events_url":"https://api.github.com/users/sqlalchemy-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2015-11-25T06:06:19Z","updated_at":"2018-11-27T05:53:36Z","body":"**Michael Bayer ([@zzzeek](https://github.com/zzzeek)) wrote:**\n\nhere's the patch, needs a test:\n\n\n```\ndiff --git a/lib/sqlalchemy/orm/strategies.py b/lib/sqlalchemy/orm/strategies.py\nindex 7de470d..21152e3 100644\n--- a/lib/sqlalchemy/orm/strategies.py\n+++ b/lib/sqlalchemy/orm/strategies.py\n@@ -1325,8 +1325,17 @@ class JoinedLoader(AbstractRelationshipLoader):\n \n         if adapter:\n             if getattr(adapter, 'aliased_class', None):\n+                # joining from an adapted entity.  The adapted entity\n+                # might be a \"with_polymorphic\", so resolve that to our\n+                # specific mapper's entity before looking for our attribute\n+                # name on it.\n+                efm = inspect(adapter.aliased_class).\\\n+                    _entity_for_mapper(self.parent)\n+\n+                # look for our attribute on the adapted entity, else fall back\n+                # to our straight property\n                 onclause = getattr(\n-                    adapter.aliased_class, self.key,\n+                    efm.entity, self.key,\n                     self.parent_property)\n             else:\n                 onclause = getattr(\n\n```\n\nthis might be portable to even 0.9, I doubt I want to port it there but this bug does go back to 0.8.1.\n","author_association":"COLLABORATOR","reactions":{"url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/comments/441931716/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"sqlalchemy-bot","id":36047385,"node_id":"MDQ6VXNlcjM2MDQ3Mzg1","avatar_url":"https://avatars.githubusercontent.com/u/36047385?v=4","gravatar_id":"","url":"https://api.github.com/users/sqlalchemy-bot","html_url":"https://github.com/sqlalchemy-bot","followers_url":"https://api.github.com/users/sqlalchemy-bot/followers","following_url":"https://api.github.com/users/sqlalchemy-bot/following{/other_user}","gists_url":"https://api.github.com/users/sqlalchemy-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/sqlalchemy-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sqlalchemy-bot/subscriptions","organizations_url":"https://api.github.com/users/sqlalchemy-bot/orgs","repos_url":"https://api.github.com/users/sqlalchemy-bot/repos","events_url":"https://api.github.com/users/sqlalchemy-bot/events{/privacy}","received_events_url":"https://api.github.com/users/sqlalchemy-bot/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/comments/441931717","html_url":"https://github.com/sqlalchemy/sqlalchemy/issues/3593#issuecomment-441931717","issue_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/3593","id":441931717,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0MTkzMTcxNw==","user":{"login":"sqlalchemy-bot","id":36047385,"node_id":"MDQ6VXNlcjM2MDQ3Mzg1","avatar_url":"https://avatars.githubusercontent.com/u/36047385?v=4","gravatar_id":"","url":"https://api.github.com/users/sqlalchemy-bot","html_url":"https://github.com/sqlalchemy-bot","followers_url":"https://api.github.com/users/sqlalchemy-bot/followers","following_url":"https://api.github.com/users/sqlalchemy-bot/following{/other_user}","gists_url":"https://api.github.com/users/sqlalchemy-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/sqlalchemy-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sqlalchemy-bot/subscriptions","organizations_url":"https://api.github.com/users/sqlalchemy-bot/orgs","repos_url":"https://api.github.com/users/sqlalchemy-bot/repos","events_url":"https://api.github.com/users/sqlalchemy-bot/events{/privacy}","received_events_url":"https://api.github.com/users/sqlalchemy-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2015-11-25T06:20:08Z","updated_at":"2018-11-27T05:53:36Z","body":"**Michael Bayer ([@zzzeek](https://github.com/zzzeek)) wrote:**\n\nthe regression issue is #2714\n","author_association":"COLLABORATOR","reactions":{"url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/comments/441931717/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"sqlalchemy-bot","id":36047385,"node_id":"MDQ6VXNlcjM2MDQ3Mzg1","avatar_url":"https://avatars.githubusercontent.com/u/36047385?v=4","gravatar_id":"","url":"https://api.github.com/users/sqlalchemy-bot","html_url":"https://github.com/sqlalchemy-bot","followers_url":"https://api.github.com/users/sqlalchemy-bot/followers","following_url":"https://api.github.com/users/sqlalchemy-bot/following{/other_user}","gists_url":"https://api.github.com/users/sqlalchemy-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/sqlalchemy-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sqlalchemy-bot/subscriptions","organizations_url":"https://api.github.com/users/sqlalchemy-bot/orgs","repos_url":"https://api.github.com/users/sqlalchemy-bot/repos","events_url":"https://api.github.com/users/sqlalchemy-bot/events{/privacy}","received_events_url":"https://api.github.com/users/sqlalchemy-bot/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/comments/441931718","html_url":"https://github.com/sqlalchemy/sqlalchemy/issues/3593#issuecomment-441931718","issue_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/3593","id":441931718,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0MTkzMTcxOA==","user":{"login":"sqlalchemy-bot","id":36047385,"node_id":"MDQ6VXNlcjM2MDQ3Mzg1","avatar_url":"https://avatars.githubusercontent.com/u/36047385?v=4","gravatar_id":"","url":"https://api.github.com/users/sqlalchemy-bot","html_url":"https://github.com/sqlalchemy-bot","followers_url":"https://api.github.com/users/sqlalchemy-bot/followers","following_url":"https://api.github.com/users/sqlalchemy-bot/following{/other_user}","gists_url":"https://api.github.com/users/sqlalchemy-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/sqlalchemy-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sqlalchemy-bot/subscriptions","organizations_url":"https://api.github.com/users/sqlalchemy-bot/orgs","repos_url":"https://api.github.com/users/sqlalchemy-bot/repos","events_url":"https://api.github.com/users/sqlalchemy-bot/events{/privacy}","received_events_url":"https://api.github.com/users/sqlalchemy-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2015-11-25T19:19:53Z","updated_at":"2018-11-27T05:53:36Z","body":"**Michael Bayer ([@zzzeek](https://github.com/zzzeek)) wrote:**\n\nrevised:\n\n\n```\ndiff --git a/lib/sqlalchemy/orm/strategies.py b/lib/sqlalchemy/orm/strategies.py\nindex 7de470d..21152e3 100644\n--- a/lib/sqlalchemy/orm/strategies.py\n+++ b/lib/sqlalchemy/orm/strategies.py\n@@ -1325,8 +1325,17 @@ class JoinedLoader(AbstractRelationshipLoader):\n \n         if adapter:\n             if getattr(adapter, 'aliased_class', None):\n+                # joining from an adapted entity.  The adapted entity\n+                # might be a \"with_polymorphic\", so resolve that to our\n+                # specific mapper's entity before looking for our attribute\n+                # name on it.\n+                efm = inspect(adapter.aliased_class).\\\n+                    _entity_for_mapper(self.parent)\n+\n+                # look for our attribute on the adapted entity, else fall back\n+                # to our straight property\n                 onclause = getattr(\n-                    adapter.aliased_class, self.key,\n+                    efm.entity, self.key,\n                     self.parent_property)\n             else:\n                 onclause = getattr(\ndiff --git a/lib/sqlalchemy/orm/util.py b/lib/sqlalchemy/orm/util.py\nindex 4351c8d..46183a4 100644\n--- a/lib/sqlalchemy/orm/util.py\n+++ b/lib/sqlalchemy/orm/util.py\n@@ -537,7 +537,11 @@ class AliasedInsp(InspectionAttr):\n     def _entity_for_mapper(self, mapper):\n         self_poly = self.with_polymorphic_mappers\n         if mapper in self_poly:\n-            return getattr(self.entity, mapper.class_.__name__)._aliased_insp\n+            if mapper is self.mapper:\n+                return self\n+            else:\n+                return getattr(\n+                    self.entity, mapper.class_.__name__)._aliased_insp\n         elif mapper.isa(self.mapper):\n             return self\n         else:\n\n```\n\n\nneed to test both:\n\n\n```\nNode.links = sa.orm.relationship(\n    Edge,\n    primaryjoin=NodeWithEdges.element_id == Edge.parent_id,\n)\n\n\n```\n\nand\n\n\n```\nNodeWithEdges.links = sa.orm.relationship(\n    Edge,\n    primaryjoin=NodeWithEdges.element_id == Edge.parent_id,\n)\n\n```\n","author_association":"COLLABORATOR","reactions":{"url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/comments/441931718/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"sqlalchemy-bot","id":36047385,"node_id":"MDQ6VXNlcjM2MDQ3Mzg1","avatar_url":"https://avatars.githubusercontent.com/u/36047385?v=4","gravatar_id":"","url":"https://api.github.com/users/sqlalchemy-bot","html_url":"https://github.com/sqlalchemy-bot","followers_url":"https://api.github.com/users/sqlalchemy-bot/followers","following_url":"https://api.github.com/users/sqlalchemy-bot/following{/other_user}","gists_url":"https://api.github.com/users/sqlalchemy-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/sqlalchemy-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sqlalchemy-bot/subscriptions","organizations_url":"https://api.github.com/users/sqlalchemy-bot/orgs","repos_url":"https://api.github.com/users/sqlalchemy-bot/repos","events_url":"https://api.github.com/users/sqlalchemy-bot/events{/privacy}","received_events_url":"https://api.github.com/users/sqlalchemy-bot/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/comments/441931720","html_url":"https://github.com/sqlalchemy/sqlalchemy/issues/3593#issuecomment-441931720","issue_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/3593","id":441931720,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0MTkzMTcyMA==","user":{"login":"sqlalchemy-bot","id":36047385,"node_id":"MDQ6VXNlcjM2MDQ3Mzg1","avatar_url":"https://avatars.githubusercontent.com/u/36047385?v=4","gravatar_id":"","url":"https://api.github.com/users/sqlalchemy-bot","html_url":"https://github.com/sqlalchemy-bot","followers_url":"https://api.github.com/users/sqlalchemy-bot/followers","following_url":"https://api.github.com/users/sqlalchemy-bot/following{/other_user}","gists_url":"https://api.github.com/users/sqlalchemy-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/sqlalchemy-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sqlalchemy-bot/subscriptions","organizations_url":"https://api.github.com/users/sqlalchemy-bot/orgs","repos_url":"https://api.github.com/users/sqlalchemy-bot/repos","events_url":"https://api.github.com/users/sqlalchemy-bot/events{/privacy}","received_events_url":"https://api.github.com/users/sqlalchemy-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2015-11-25T20:33:06Z","updated_at":"2018-11-27T05:53:36Z","body":"**Michael Bayer ([@zzzeek](https://github.com/zzzeek)) wrote:**\n\n- Fixed bug which is actually a regression that occurred between\nversions 0.8.0 and 0.8.1, due :ticket:`2714`.  The case where\njoined eager loading needs to join out over a subclass-bound\nrelationship when \"with_polymorphic\" were also used would fail\nto join from the correct entity.\nfixes #3593\n\n\n→ 1202e140b987\n","author_association":"COLLABORATOR","reactions":{"url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/comments/441931720/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"sqlalchemy-bot","id":36047385,"node_id":"MDQ6VXNlcjM2MDQ3Mzg1","avatar_url":"https://avatars.githubusercontent.com/u/36047385?v=4","gravatar_id":"","url":"https://api.github.com/users/sqlalchemy-bot","html_url":"https://github.com/sqlalchemy-bot","followers_url":"https://api.github.com/users/sqlalchemy-bot/followers","following_url":"https://api.github.com/users/sqlalchemy-bot/following{/other_user}","gists_url":"https://api.github.com/users/sqlalchemy-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/sqlalchemy-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sqlalchemy-bot/subscriptions","organizations_url":"https://api.github.com/users/sqlalchemy-bot/orgs","repos_url":"https://api.github.com/users/sqlalchemy-bot/repos","events_url":"https://api.github.com/users/sqlalchemy-bot/events{/privacy}","received_events_url":"https://api.github.com/users/sqlalchemy-bot/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/comments/441931721","html_url":"https://github.com/sqlalchemy/sqlalchemy/issues/3593#issuecomment-441931721","issue_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/3593","id":441931721,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0MTkzMTcyMQ==","user":{"login":"sqlalchemy-bot","id":36047385,"node_id":"MDQ6VXNlcjM2MDQ3Mzg1","avatar_url":"https://avatars.githubusercontent.com/u/36047385?v=4","gravatar_id":"","url":"https://api.github.com/users/sqlalchemy-bot","html_url":"https://github.com/sqlalchemy-bot","followers_url":"https://api.github.com/users/sqlalchemy-bot/followers","following_url":"https://api.github.com/users/sqlalchemy-bot/following{/other_user}","gists_url":"https://api.github.com/users/sqlalchemy-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/sqlalchemy-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sqlalchemy-bot/subscriptions","organizations_url":"https://api.github.com/users/sqlalchemy-bot/orgs","repos_url":"https://api.github.com/users/sqlalchemy-bot/repos","events_url":"https://api.github.com/users/sqlalchemy-bot/events{/privacy}","received_events_url":"https://api.github.com/users/sqlalchemy-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2015-11-25T20:33:06Z","updated_at":"2018-11-27T05:53:36Z","body":"**Michael Bayer ([@zzzeek](https://github.com/zzzeek)) wrote:**\n\n- Fixed bug which is actually a regression that occurred between\nversions 0.8.0 and 0.8.1, due :ticket:`2714`.  The case where\njoined eager loading needs to join out over a subclass-bound\nrelationship when \"with_polymorphic\" were also used would fail\nto join from the correct entity.\nfixes #3593\n\n(cherry picked from commit 1202e140b9876cf202c56d2f41bbbb573e15a39d)\n\n\n→ 2aeda9bd21eb\n","author_association":"COLLABORATOR","reactions":{"url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/comments/441931721/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"sqlalchemy-bot","id":36047385,"node_id":"MDQ6VXNlcjM2MDQ3Mzg1","avatar_url":"https://avatars.githubusercontent.com/u/36047385?v=4","gravatar_id":"","url":"https://api.github.com/users/sqlalchemy-bot","html_url":"https://github.com/sqlalchemy-bot","followers_url":"https://api.github.com/users/sqlalchemy-bot/followers","following_url":"https://api.github.com/users/sqlalchemy-bot/following{/other_user}","gists_url":"https://api.github.com/users/sqlalchemy-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/sqlalchemy-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sqlalchemy-bot/subscriptions","organizations_url":"https://api.github.com/users/sqlalchemy-bot/orgs","repos_url":"https://api.github.com/users/sqlalchemy-bot/repos","events_url":"https://api.github.com/users/sqlalchemy-bot/events{/privacy}","received_events_url":"https://api.github.com/users/sqlalchemy-bot/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/comments/441931725","html_url":"https://github.com/sqlalchemy/sqlalchemy/issues/3593#issuecomment-441931725","issue_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/3593","id":441931725,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0MTkzMTcyNQ==","user":{"login":"sqlalchemy-bot","id":36047385,"node_id":"MDQ6VXNlcjM2MDQ3Mzg1","avatar_url":"https://avatars.githubusercontent.com/u/36047385?v=4","gravatar_id":"","url":"https://api.github.com/users/sqlalchemy-bot","html_url":"https://github.com/sqlalchemy-bot","followers_url":"https://api.github.com/users/sqlalchemy-bot/followers","following_url":"https://api.github.com/users/sqlalchemy-bot/following{/other_user}","gists_url":"https://api.github.com/users/sqlalchemy-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/sqlalchemy-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sqlalchemy-bot/subscriptions","organizations_url":"https://api.github.com/users/sqlalchemy-bot/orgs","repos_url":"https://api.github.com/users/sqlalchemy-bot/repos","events_url":"https://api.github.com/users/sqlalchemy-bot/events{/privacy}","received_events_url":"https://api.github.com/users/sqlalchemy-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2015-11-25T20:33:06Z","updated_at":"2018-11-27T05:53:37Z","body":"**Changes by Michael Bayer ([@zzzeek](https://github.com/zzzeek)):**\n\n* changed **status** to closed\n","author_association":"COLLABORATOR","reactions":{"url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/comments/441931725/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"sqlalchemy-bot","id":36047385,"node_id":"MDQ6VXNlcjM2MDQ3Mzg1","avatar_url":"https://avatars.githubusercontent.com/u/36047385?v=4","gravatar_id":"","url":"https://api.github.com/users/sqlalchemy-bot","html_url":"https://github.com/sqlalchemy-bot","followers_url":"https://api.github.com/users/sqlalchemy-bot/followers","following_url":"https://api.github.com/users/sqlalchemy-bot/following{/other_user}","gists_url":"https://api.github.com/users/sqlalchemy-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/sqlalchemy-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sqlalchemy-bot/subscriptions","organizations_url":"https://api.github.com/users/sqlalchemy-bot/orgs","repos_url":"https://api.github.com/users/sqlalchemy-bot/repos","events_url":"https://api.github.com/users/sqlalchemy-bot/events{/privacy}","received_events_url":"https://api.github.com/users/sqlalchemy-bot/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":1988632338,"node_id":"MDExOkNsb3NlZEV2ZW50MTk4ODYzMjMzOA==","url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/events/1988632338","actor":{"login":"sqlalchemy-bot","id":36047385,"node_id":"MDQ6VXNlcjM2MDQ3Mzg1","avatar_url":"https://avatars.githubusercontent.com/u/36047385?v=4","gravatar_id":"","url":"https://api.github.com/users/sqlalchemy-bot","html_url":"https://github.com/sqlalchemy-bot","followers_url":"https://api.github.com/users/sqlalchemy-bot/followers","following_url":"https://api.github.com/users/sqlalchemy-bot/following{/other_user}","gists_url":"https://api.github.com/users/sqlalchemy-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/sqlalchemy-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sqlalchemy-bot/subscriptions","organizations_url":"https://api.github.com/users/sqlalchemy-bot/orgs","repos_url":"https://api.github.com/users/sqlalchemy-bot/repos","events_url":"https://api.github.com/users/sqlalchemy-bot/events{/privacy}","received_events_url":"https://api.github.com/users/sqlalchemy-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2015-11-25T20:33:06Z","state_reason":null,"performed_via_github_app":null},{"url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/comments/441931723","html_url":"https://github.com/sqlalchemy/sqlalchemy/issues/3593#issuecomment-441931723","issue_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/3593","id":441931723,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0MTkzMTcyMw==","user":{"login":"sqlalchemy-bot","id":36047385,"node_id":"MDQ6VXNlcjM2MDQ3Mzg1","avatar_url":"https://avatars.githubusercontent.com/u/36047385?v=4","gravatar_id":"","url":"https://api.github.com/users/sqlalchemy-bot","html_url":"https://github.com/sqlalchemy-bot","followers_url":"https://api.github.com/users/sqlalchemy-bot/followers","following_url":"https://api.github.com/users/sqlalchemy-bot/following{/other_user}","gists_url":"https://api.github.com/users/sqlalchemy-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/sqlalchemy-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sqlalchemy-bot/subscriptions","organizations_url":"https://api.github.com/users/sqlalchemy-bot/orgs","repos_url":"https://api.github.com/users/sqlalchemy-bot/repos","events_url":"https://api.github.com/users/sqlalchemy-bot/events{/privacy}","received_events_url":"https://api.github.com/users/sqlalchemy-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2015-12-21T11:37:37Z","updated_at":"2018-11-27T05:53:37Z","body":"**Bertrand Croq ([@bcroq](https://github.com/bcroq)) wrote:**\n\nUpgrading from SQLAlchemy 1.0.9 to 1.0.10 breaks one of my applications :\n\n\n```\n  File \".../lib/python2.7/site-packages/SQLAlchemy-1.0.10-py2.7-linux-x86_64.egg/sqlalchemy/orm/query.py\", line 2728, in __iter__\n    context = self._compile_context()\n  File \".../lib/python2.7/site-packages/SQLAlchemy-1.0.10-py2.7-linux-x86_64.egg/sqlalchemy/orm/query.py\", line 3196, in _compile_context\n    strategy(*rec[1:])\n  File \".../lib/python2.7/site-packages/SQLAlchemy-1.0.10-py2.7-linux-x86_64.egg/sqlalchemy/orm/strategies.py\", line 1333, in _create_eager_join\n    _entity_for_mapper(self.parent)\n  File \".../lib/python2.7/site-packages/SQLAlchemy-1.0.10-py2.7-linux-x86_64.egg/sqlalchemy/orm/util.py\", line 549, in _entity_for_mapper\n    mapper, self)\nAssertionError: mapper Mapper|BaseClass|relation_name doesn't correspond to <AliasedInsp at 0x7fab70121f90; PolymClass>\n\n```\n\n\nI had to remove `lazy=False` from some relations to make it work again.\n\n\nI work on a simple test to report the problem in a cleaner way.\n\n\nEDIT: https://gist.github.com/bcroq/312877e01102f14a8948\n","author_association":"COLLABORATOR","reactions":{"url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/comments/441931723/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"sqlalchemy-bot","id":36047385,"node_id":"MDQ6VXNlcjM2MDQ3Mzg1","avatar_url":"https://avatars.githubusercontent.com/u/36047385?v=4","gravatar_id":"","url":"https://api.github.com/users/sqlalchemy-bot","html_url":"https://github.com/sqlalchemy-bot","followers_url":"https://api.github.com/users/sqlalchemy-bot/followers","following_url":"https://api.github.com/users/sqlalchemy-bot/following{/other_user}","gists_url":"https://api.github.com/users/sqlalchemy-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/sqlalchemy-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sqlalchemy-bot/subscriptions","organizations_url":"https://api.github.com/users/sqlalchemy-bot/orgs","repos_url":"https://api.github.com/users/sqlalchemy-bot/repos","events_url":"https://api.github.com/users/sqlalchemy-bot/events{/privacy}","received_events_url":"https://api.github.com/users/sqlalchemy-bot/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":1988632332,"node_id":"MDEyOkxhYmVsZWRFdmVudDE5ODg2MzIzMzI=","url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/events/1988632332","actor":{"login":"sqlalchemy-bot","id":36047385,"node_id":"MDQ6VXNlcjM2MDQ3Mzg1","avatar_url":"https://avatars.githubusercontent.com/u/36047385?v=4","gravatar_id":"","url":"https://api.github.com/users/sqlalchemy-bot","html_url":"https://github.com/sqlalchemy-bot","followers_url":"https://api.github.com/users/sqlalchemy-bot/followers","following_url":"https://api.github.com/users/sqlalchemy-bot/following{/other_user}","gists_url":"https://api.github.com/users/sqlalchemy-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/sqlalchemy-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sqlalchemy-bot/subscriptions","organizations_url":"https://api.github.com/users/sqlalchemy-bot/orgs","repos_url":"https://api.github.com/users/sqlalchemy-bot/repos","events_url":"https://api.github.com/users/sqlalchemy-bot/events{/privacy}","received_events_url":"https://api.github.com/users/sqlalchemy-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2018-11-27T05:53:35Z","label":{"name":"high priority","color":"C0B0E0"},"performed_via_github_app":null},{"id":1988632333,"node_id":"MDEyOkxhYmVsZWRFdmVudDE5ODg2MzIzMzM=","url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/events/1988632333","actor":{"login":"sqlalchemy-bot","id":36047385,"node_id":"MDQ6VXNlcjM2MDQ3Mzg1","avatar_url":"https://avatars.githubusercontent.com/u/36047385?v=4","gravatar_id":"","url":"https://api.github.com/users/sqlalchemy-bot","html_url":"https://github.com/sqlalchemy-bot","followers_url":"https://api.github.com/users/sqlalchemy-bot/followers","following_url":"https://api.github.com/users/sqlalchemy-bot/following{/other_user}","gists_url":"https://api.github.com/users/sqlalchemy-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/sqlalchemy-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sqlalchemy-bot/subscriptions","organizations_url":"https://api.github.com/users/sqlalchemy-bot/orgs","repos_url":"https://api.github.com/users/sqlalchemy-bot/repos","events_url":"https://api.github.com/users/sqlalchemy-bot/events{/privacy}","received_events_url":"https://api.github.com/users/sqlalchemy-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2018-11-27T05:53:35Z","label":{"name":"bug","color":"d73a4a"},"performed_via_github_app":null},{"id":1988632334,"node_id":"MDEyOkxhYmVsZWRFdmVudDE5ODg2MzIzMzQ=","url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/events/1988632334","actor":{"login":"sqlalchemy-bot","id":36047385,"node_id":"MDQ6VXNlcjM2MDQ3Mzg1","avatar_url":"https://avatars.githubusercontent.com/u/36047385?v=4","gravatar_id":"","url":"https://api.github.com/users/sqlalchemy-bot","html_url":"https://github.com/sqlalchemy-bot","followers_url":"https://api.github.com/users/sqlalchemy-bot/followers","following_url":"https://api.github.com/users/sqlalchemy-bot/following{/other_user}","gists_url":"https://api.github.com/users/sqlalchemy-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/sqlalchemy-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sqlalchemy-bot/subscriptions","organizations_url":"https://api.github.com/users/sqlalchemy-bot/orgs","repos_url":"https://api.github.com/users/sqlalchemy-bot/repos","events_url":"https://api.github.com/users/sqlalchemy-bot/events{/privacy}","received_events_url":"https://api.github.com/users/sqlalchemy-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2018-11-27T05:53:35Z","label":{"name":"orm","color":"20C0B0"},"performed_via_github_app":null},{"id":1988632335,"node_id":"MDE1Ok1pbGVzdG9uZWRFdmVudDE5ODg2MzIzMzU=","url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/events/1988632335","actor":{"login":"sqlalchemy-bot","id":36047385,"node_id":"MDQ6VXNlcjM2MDQ3Mzg1","avatar_url":"https://avatars.githubusercontent.com/u/36047385?v=4","gravatar_id":"","url":"https://api.github.com/users/sqlalchemy-bot","html_url":"https://github.com/sqlalchemy-bot","followers_url":"https://api.github.com/users/sqlalchemy-bot/followers","following_url":"https://api.github.com/users/sqlalchemy-bot/following{/other_user}","gists_url":"https://api.github.com/users/sqlalchemy-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/sqlalchemy-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sqlalchemy-bot/subscriptions","organizations_url":"https://api.github.com/users/sqlalchemy-bot/orgs","repos_url":"https://api.github.com/users/sqlalchemy-bot/repos","events_url":"https://api.github.com/users/sqlalchemy-bot/events{/privacy}","received_events_url":"https://api.github.com/users/sqlalchemy-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"milestoned","commit_id":null,"commit_url":null,"created_at":"2018-11-27T05:53:35Z","milestone":{"title":"1.0.xx"},"performed_via_github_app":null},{"actor":{"login":"sqlalchemy-bot","id":36047385,"node_id":"MDQ6VXNlcjM2MDQ3Mzg1","avatar_url":"https://avatars.githubusercontent.com/u/36047385?v=4","gravatar_id":"","url":"https://api.github.com/users/sqlalchemy-bot","html_url":"https://github.com/sqlalchemy-bot","followers_url":"https://api.github.com/users/sqlalchemy-bot/followers","following_url":"https://api.github.com/users/sqlalchemy-bot/following{/other_user}","gists_url":"https://api.github.com/users/sqlalchemy-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/sqlalchemy-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sqlalchemy-bot/subscriptions","organizations_url":"https://api.github.com/users/sqlalchemy-bot/orgs","repos_url":"https://api.github.com/users/sqlalchemy-bot/repos","events_url":"https://api.github.com/users/sqlalchemy-bot/events{/privacy}","received_events_url":"https://api.github.com/users/sqlalchemy-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-27T05:54:21Z","updated_at":"2018-11-27T05:54:21Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/3611","repository_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy","labels_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/3611/labels{/name}","comments_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/3611/comments","events_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/3611/events","html_url":"https://github.com/sqlalchemy/sqlalchemy/issues/3611","id":384635657,"node_id":"MDU6SXNzdWUzODQ2MzU2NTc=","number":3611,"title":"Regression joinedload on polymorphic entity","user":{"login":"sqlalchemy-bot","id":36047385,"node_id":"MDQ6VXNlcjM2MDQ3Mzg1","avatar_url":"https://avatars.githubusercontent.com/u/36047385?v=4","gravatar_id":"","url":"https://api.github.com/users/sqlalchemy-bot","html_url":"https://github.com/sqlalchemy-bot","followers_url":"https://api.github.com/users/sqlalchemy-bot/followers","following_url":"https://api.github.com/users/sqlalchemy-bot/following{/other_user}","gists_url":"https://api.github.com/users/sqlalchemy-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/sqlalchemy-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sqlalchemy-bot/subscriptions","organizations_url":"https://api.github.com/users/sqlalchemy-bot/orgs","repos_url":"https://api.github.com/users/sqlalchemy-bot/repos","events_url":"https://api.github.com/users/sqlalchemy-bot/events{/privacy}","received_events_url":"https://api.github.com/users/sqlalchemy-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":1141269142,"node_id":"MDU6TGFiZWwxMTQxMjY5MTQy","url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"},{"id":1141273966,"node_id":"MDU6TGFiZWwxMTQxMjczOTY2","url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/labels/orm","name":"orm","color":"20C0B0","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/milestones/57","html_url":"https://github.com/sqlalchemy/sqlalchemy/milestone/57","labels_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/milestones/57/labels","id":3850634,"node_id":"MDk6TWlsZXN0b25lMzg1MDYzNA==","number":57,"title":"1.0.xx","description":null,"creator":{"login":"sqlalchemy-bot","id":36047385,"node_id":"MDQ6VXNlcjM2MDQ3Mzg1","avatar_url":"https://avatars.githubusercontent.com/u/36047385?v=4","gravatar_id":"","url":"https://api.github.com/users/sqlalchemy-bot","html_url":"https://github.com/sqlalchemy-bot","followers_url":"https://api.github.com/users/sqlalchemy-bot/followers","following_url":"https://api.github.com/users/sqlalchemy-bot/following{/other_user}","gists_url":"https://api.github.com/users/sqlalchemy-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/sqlalchemy-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sqlalchemy-bot/subscriptions","organizations_url":"https://api.github.com/users/sqlalchemy-bot/orgs","repos_url":"https://api.github.com/users/sqlalchemy-bot/repos","events_url":"https://api.github.com/users/sqlalchemy-bot/events{/privacy}","received_events_url":"https://api.github.com/users/sqlalchemy-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":127,"state":"closed","created_at":"2018-11-27T04:15:49Z","updated_at":"2018-11-28T16:49:57Z","due_on":null,"closed_at":"2018-11-28T16:49:57Z"},"comments":9,"created_at":"2015-12-15T08:40:33Z","updated_at":"2015-12-22T02:43:23Z","closed_at":"2015-12-15T19:01:42Z","author_association":"COLLABORATOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"repository":{"id":159271175,"node_id":"MDEwOlJlcG9zaXRvcnkxNTkyNzExNzU=","name":"sqlalchemy","full_name":"sqlalchemy/sqlalchemy","private":false,"owner":{"login":"sqlalchemy","id":6043126,"node_id":"MDEyOk9yZ2FuaXphdGlvbjYwNDMxMjY=","avatar_url":"https://avatars.githubusercontent.com/u/6043126?v=4","gravatar_id":"","url":"https://api.github.com/users/sqlalchemy","html_url":"https://github.com/sqlalchemy","followers_url":"https://api.github.com/users/sqlalchemy/followers","following_url":"https://api.github.com/users/sqlalchemy/following{/other_user}","gists_url":"https://api.github.com/users/sqlalchemy/gists{/gist_id}","starred_url":"https://api.github.com/users/sqlalchemy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sqlalchemy/subscriptions","organizations_url":"https://api.github.com/users/sqlalchemy/orgs","repos_url":"https://api.github.com/users/sqlalchemy/repos","events_url":"https://api.github.com/users/sqlalchemy/events{/privacy}","received_events_url":"https://api.github.com/users/sqlalchemy/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/sqlalchemy/sqlalchemy","description":"The Database Toolkit for Python","fork":false,"url":"https://api.github.com/repos/sqlalchemy/sqlalchemy","forks_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/forks","keys_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/keys{/key_id}","collaborators_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/teams","hooks_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/hooks","issue_events_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/events{/number}","events_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/events","assignees_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/assignees{/user}","branches_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/branches{/branch}","tags_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/tags","blobs_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/git/refs{/sha}","trees_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/git/trees{/sha}","statuses_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/statuses/{sha}","languages_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/languages","stargazers_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/stargazers","contributors_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/contributors","subscribers_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/subscribers","subscription_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/subscription","commits_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/commits{/sha}","git_commits_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/git/commits{/sha}","comments_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/comments{/number}","issue_comment_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/comments{/number}","contents_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/contents/{+path}","compare_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/compare/{base}...{head}","merges_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/merges","archive_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/downloads","issues_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues{/number}","pulls_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/pulls{/number}","milestones_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/milestones{/number}","notifications_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/labels{/name}","releases_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/releases{/id}","deployments_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/deployments","created_at":"2018-11-27T03:35:03Z","updated_at":"2025-11-10T08:14:59Z","pushed_at":"2025-11-09T19:21:36Z","git_url":"git://github.com/sqlalchemy/sqlalchemy.git","ssh_url":"git@github.com:sqlalchemy/sqlalchemy.git","clone_url":"https://github.com/sqlalchemy/sqlalchemy.git","svn_url":"https://github.com/sqlalchemy/sqlalchemy","homepage":"https://www.sqlalchemy.org","size":97110,"stargazers_count":11107,"watchers_count":11107,"language":"Python","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":true,"forks_count":1596,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":219,"license":{"key":"mit","name":"MIT License","spdx_id":"MIT","url":"https://api.github.com/licenses/mit","node_id":"MDc6TGljZW5zZTEz"},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["python","sql","sqlalchemy"],"visibility":"public","forks":1596,"open_issues":219,"watchers":11107,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"body":"**Migrated issue, originally created by Bastien Chatelard ([@bchatelard](https://github.com/bchatelard))**\n\nI am facing a regression on joinedload on polymorphic entity in 1.0.10.\n\nI have reproduced a minimal test case that works fine in 1.0.9 and does not in 1.0.10:\n \n```\nimport sqlalchemy as sa\nimport sqlalchemy.orm\nfrom sqlalchemy.orm import joinedload\nimport sqlalchemy.ext.declarative\nimport sqlalchemy.ext.orderinglist\n\nBase = sqlalchemy.ext.declarative.declarative_base()\n\n\nclass Person(Base):\n    __tablename__ = 'person'\n\n    id = sa.Column(sa.Integer, nullable=False, primary_key=True)\n    person_type = sa.Column(sa.String(20), nullable=False)\n\n    __mapper_args__ = {\n        'polymorphic_on': person_type,\n        'with_polymorphic': '*',\n    }\n\n\nclass User(Person):\n    __mapper_args__ = {'polymorphic_identity': 'user'}\n\n\nclass Admin(Person):\n    __mapper_args__ = {'polymorphic_identity': 'admin'}\n\n\nclass Action(Base):\n    __tablename__ = 'action'\n    id = sa.Column(sa.Integer, nullable=False, primary_key=True)\n\n    author_id = sa.Column(sa.Integer, sa.ForeignKey(User.id))\n    author = sa.orm.relationship('User')\n\n    post_type = sa.Column(sa.String(20), nullable=False)\n\n    __mapper_args__ = {\n        'polymorphic_on': post_type,\n        'polymorphic_identity': 'post',\n        'with_polymorphic': '*',\n    }\n\n\nclass Like(Action):\n    __tablename__ = 'like'\n    __mapper_args__ = {'polymorphic_identity': 'like'}\n    id = sa.Column(sa.Integer, sa.ForeignKey('action.id'), primary_key=True)\n\n\nclass Comment(Action):\n    __tablename__ = 'comment'\n    __mapper_args__ = {'polymorphic_identity': 'comment'}\n    id = sa.Column(sa.Integer, sa.ForeignKey('action.id'), primary_key=True)\n\n    article_id = sa.Column(sa.Integer, sa.ForeignKey('article.id'))\n    article = sa.orm.relationship('Article', primaryjoin='Article.id==Comment.article_id', backref='comments')\n\n\nclass Article(Base):\n    __tablename__ = 'article'\n    id = sa.Column(sa.Integer, nullable=False, primary_key=True)\n\n\nengine = sa.create_engine('sqlite:///:memory:', echo=True)\n\nBase.metadata.drop_all(engine)\nBase.metadata.create_all(engine)\n\nSession = sa.orm.sessionmaker(bind=engine)\nsession = Session()\n\nuser1 = User(id=1)\nadmin1 = Admin(id=2)\nuser2 = User(id=3)\narticle1 = Article(id=1)\ncomment1 = Comment(id=2, author=user1, article_id=1)\ncomment2 = Comment(id=3, author=user2, article_id=1)\n\nsession.add_all([user1, user2, admin1, article1, comment1, comment2])\nsession.commit()\nsession.expunge_all()\n\n\n# Works with 1.0.9\n# Not working with 1.0.10: raise AssertionError\ntry:\n    new_n1 = session.query(Article).options(\n        joinedload(Article.comments).joinedload(Action.author),\n    ).all()\n\n    print new_n1\n    print new_n1[0].comments\n    print new_n1[0].comments[0].author\nexcept AssertionError as e:\n    print e\n\n\n# Works with 1.0.9\n# Not working with 1.0.10: 2 queries\ntry:\n    new_n1 = session.query(Article).options(\n        joinedload('comments'),\n        joinedload('comments.author')\n    ).all()\n\n    print new_n1\n    print new_n1[0].comments\n    print new_n1[0].comments[0].author\nexcept AssertionError as e:\n    print e\n\n# Works with 1.0.9\n# Not working with 1.0.10: raise AssertionError\ntry:\n    new_n1 = session.query(Article).options(\n        joinedload('comments').joinedload('author')\n    ).all()\n\n    print new_n1\n    print new_n1[0].comments\n    print new_n1[0].comments[0].author\nexcept AssertionError as e:\n    print e\n\n# Works with 1.0.9\n# Not working with 1.0.10: raise AssertionError\ntry:\n    new_n1 = session.query(Article).options(\n        joinedload('comments').load_only('id', 'author_id').joinedload('author').load_only('id')\n    ).all()\n\n    print new_n1\n    print new_n1[0].comments\n    print new_n1[0].comments[0].author\nexcept AssertionError as e:\n    print e\n```\n\nIt might be related to #2714 or #3593\n\n","reactions":{"url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/3611/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/3611/timeline","performed_via_github_app":null,"state_reason":"completed"}},"event":"cross-referenced"}]