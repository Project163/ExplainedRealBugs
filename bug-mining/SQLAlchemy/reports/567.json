{"url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/10665","repository_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy","labels_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/10665/labels{/name}","comments_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/10665/comments","events_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/10665/events","html_url":"https://github.com/sqlalchemy/sqlalchemy/issues/10665","id":2002917619,"node_id":"I_kwDOCX5JB853Yhjz","number":10665,"title":"PrimaryKey and Unique Constraint do not support 'postgresql_include'","user":{"login":"CaselIT","id":16175304,"node_id":"MDQ6VXNlcjE2MTc1MzA0","avatar_url":"https://avatars.githubusercontent.com/u/16175304?v=4","gravatar_id":"","url":"https://api.github.com/users/CaselIT","html_url":"https://github.com/CaselIT","followers_url":"https://api.github.com/users/CaselIT/followers","following_url":"https://api.github.com/users/CaselIT/following{/other_user}","gists_url":"https://api.github.com/users/CaselIT/gists{/gist_id}","starred_url":"https://api.github.com/users/CaselIT/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CaselIT/subscriptions","organizations_url":"https://api.github.com/users/CaselIT/orgs","repos_url":"https://api.github.com/users/CaselIT/repos","events_url":"https://api.github.com/users/CaselIT/events{/privacy}","received_events_url":"https://api.github.com/users/CaselIT/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":1141273914,"node_id":"MDU6TGFiZWwxMTQxMjczOTE0","url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/labels/postgresql","name":"postgresql","color":"60A070","default":false,"description":""},{"id":1141273948,"node_id":"MDU6TGFiZWwxMTQxMjczOTQ4","url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/labels/schema","name":"schema","color":"602060","default":false,"description":"things related to the DDL related objects like Table, Column, CreateIndex, etc."},{"id":1142415575,"node_id":"MDU6TGFiZWwxMTQyNDE1NTc1","url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/labels/reflection","name":"reflection","color":"60e0cb","default":false,"description":"reflection of tables, columns, constraints, defaults, sequences, views, everything else"},{"id":1171369643,"node_id":"MDU6TGFiZWwxMTcxMzY5NjQz","url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/labels/PRs%20(with%20tests!)%20welcome","name":"PRs (with tests!) welcome","color":"b8e0f9","default":false,"description":"a fix or feature which is appropriate to be implemented by volunteers"},{"id":1313059238,"node_id":"MDU6TGFiZWwxMzEzMDU5MjM4","url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/labels/use%20case","name":"use case","color":"b54650","default":false,"description":"not really a feature or a bug; can be support for new DB features or user use cases not anticipated"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/milestones/100","html_url":"https://github.com/sqlalchemy/sqlalchemy/milestone/100","labels_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/milestones/100/labels","id":8974115,"node_id":"MI_kwDOCX5JB84AiO8j","number":100,"title":"2.0.x","description":"","creator":{"login":"CaselIT","id":16175304,"node_id":"MDQ6VXNlcjE2MTc1MzA0","avatar_url":"https://avatars.githubusercontent.com/u/16175304?v=4","gravatar_id":"","url":"https://api.github.com/users/CaselIT","html_url":"https://github.com/CaselIT","followers_url":"https://api.github.com/users/CaselIT/followers","following_url":"https://api.github.com/users/CaselIT/following{/other_user}","gists_url":"https://api.github.com/users/CaselIT/gists{/gist_id}","starred_url":"https://api.github.com/users/CaselIT/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CaselIT/subscriptions","organizations_url":"https://api.github.com/users/CaselIT/orgs","repos_url":"https://api.github.com/users/CaselIT/repos","events_url":"https://api.github.com/users/CaselIT/events{/privacy}","received_events_url":"https://api.github.com/users/CaselIT/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":68,"closed_issues":416,"state":"open","created_at":"2023-01-27T12:23:11Z","updated_at":"2025-11-08T19:58:19Z","due_on":null,"closed_at":null},"comments":5,"created_at":"2023-11-20T20:08:11Z","updated_at":"2025-04-04T19:04:18Z","closed_at":"2025-04-04T19:04:17Z","author_association":"MEMBER","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Discussed in https://github.com/sqlalchemy/sqlalchemy/discussions/10664\r\n\r\n<div type='discussions-op-text'>\r\n\r\n<sup>Originally posted by **LeResKP** November 20, 2023</sup>\r\nWhen trying to create a PrimaryKeyConstraint postgresql_include is not supported. I checked a bit the code and it seems there is no postgres specific kw allowed for PrimaryKeyConstraint.\r\n\r\nThis example use alambic, but it's the same when creating a Table().\r\n\r\n```\r\n    op.create_table(\r\n        \"user\",\r\n        sa.Column(\"iduser\", sa.Integer(), autoincrement=False, nullable=False),\r\n        sa.Column(\"value\", sa.Integer(), nullable=False),\r\n        sa.PrimaryKeyConstraint(\r\n            \"iduser\",\r\n            name=\"brackethistory_iduser_idproduct_idbracket_date_incl_value_pkey\",\r\n            postgresql_include=[\"value\"],\r\n        ),\r\n    )\r\n\r\n```\r\n\r\nHere is the error traceback:\r\n```\r\n  File \"/home/aurelien/a9engine/alembic/versions/f0eefd074216_auto.py\", line 392, in upgrade\r\n    sa.PrimaryKeyConstraint(\r\n  File \"/home/aurelien/venvs/a9engine/lib64/python3.9/site-packages/sqlalchemy/sql/schema.py\", line 3839, in __init__\r\n    super(PrimaryKeyConstraint, self).__init__(*columns, **kw)\r\n  File \"/home/aurelien/venvs/a9engine/lib64/python3.9/site-packages/sqlalchemy/sql/schema.py\", line 3285, in __init__\r\n    Constraint.__init__(self, **kw)\r\n  File \"/home/aurelien/venvs/a9engine/lib64/python3.9/site-packages/sqlalchemy/sql/schema.py\", line 3129, in __init__\r\n    self._validate_dialect_kwargs(dialect_kw)\r\n  File \"/home/aurelien/venvs/a9engine/lib64/python3.9/site-packages/sqlalchemy/sql/base.py\", line 428, in _validate_dialect_kwargs\r\n    raise exc.ArgumentError(\r\nsqlalchemy.exc.ArgumentError: Argument 'postgresql_include' is not accepted by dialect 'postgresql' on behalf of <class 'sqlalchemy.sql.schema.PrimaryKeyConstraint'>\r\n```\r\n\r\nWhen creating an index, it works.\r\n```\r\n    op.create_index(\r\n        \"idx_bracketoftest_idbracket\", \"bracketoftest\", [\"idbracket\"], unique=False, postgresql_include=[\"idtest\"]\r\n   ``` \r\n\r\n\r\n\r\nIs there a reason this is not working? Or it's a missing feature ?\r\n\r\nThanks in advance for your help</div>","closed_by":{"login":"sqlalchemy-bot","id":36047385,"node_id":"MDQ6VXNlcjM2MDQ3Mzg1","avatar_url":"https://avatars.githubusercontent.com/u/36047385?v=4","gravatar_id":"","url":"https://api.github.com/users/sqlalchemy-bot","html_url":"https://github.com/sqlalchemy-bot","followers_url":"https://api.github.com/users/sqlalchemy-bot/followers","following_url":"https://api.github.com/users/sqlalchemy-bot/following{/other_user}","gists_url":"https://api.github.com/users/sqlalchemy-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/sqlalchemy-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sqlalchemy-bot/subscriptions","organizations_url":"https://api.github.com/users/sqlalchemy-bot/orgs","repos_url":"https://api.github.com/users/sqlalchemy-bot/repos","events_url":"https://api.github.com/users/sqlalchemy-bot/events{/privacy}","received_events_url":"https://api.github.com/users/sqlalchemy-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/10665/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/10665/timeline","performed_via_github_app":null,"state_reason":"completed"}