[{"url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/comments/441923357","html_url":"https://github.com/sqlalchemy/sqlalchemy/issues/3035#issuecomment-441923357","issue_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/3035","id":441923357,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0MTkyMzM1Nw==","user":{"login":"sqlalchemy-bot","id":36047385,"node_id":"MDQ6VXNlcjM2MDQ3Mzg1","avatar_url":"https://avatars.githubusercontent.com/u/36047385?v=4","gravatar_id":"","url":"https://api.github.com/users/sqlalchemy-bot","html_url":"https://github.com/sqlalchemy-bot","followers_url":"https://api.github.com/users/sqlalchemy-bot/followers","following_url":"https://api.github.com/users/sqlalchemy-bot/following{/other_user}","gists_url":"https://api.github.com/users/sqlalchemy-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/sqlalchemy-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sqlalchemy-bot/subscriptions","organizations_url":"https://api.github.com/users/sqlalchemy-bot/orgs","repos_url":"https://api.github.com/users/sqlalchemy-bot/repos","events_url":"https://api.github.com/users/sqlalchemy-bot/events{/privacy}","received_events_url":"https://api.github.com/users/sqlalchemy-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2014-04-26T23:07:50Z","updated_at":"2018-11-27T05:30:04Z","body":"**Michael Bayer ([@zzzeek](https://github.com/zzzeek)) wrote:**\n\nhere's a better patch, everything passes except for some exception raises:\n\n\n```\ndiff --git a/lib/sqlalchemy/orm/session.py b/lib/sqlalchemy/orm/session.py\nindex 89d9946..8bb1fc8 100644\n--- a/lib/sqlalchemy/orm/session.py\n+++ b/lib/sqlalchemy/orm/session.py\n@@ -635,14 +635,8 @@ class Session(_SessionClassMethods):\n                 SessionExtension._adapt_listener(self, ext)\n \n         if binds is not None:\n-            for mapperortable, bind in binds.items():\n-                insp = inspect(mapperortable)\n-                if insp.is_selectable:\n-                    self.bind_table(mapperortable, bind)\n-                elif insp.is_mapper:\n-                    self.bind_mapper(mapperortable, bind)\n-                else:\n-                    assert False\n+            for key, bind in binds.items():\n+                self._add_bind(key, bind)\n \n \n         if not self.autocommit:\n@@ -1019,40 +1013,45 @@ class Session(_SessionClassMethods):\n     # TODO: + crystallize + document resolution order\n     #       vis. bind_mapper/bind_table\n \n-    def bind_mapper(self, mapper, bind):\n-        \"\"\"Bind operations for a mapper to a Connectable.\n-\n-        mapper\n-          A mapper instance or mapped class\n+    def _add_bind(self, key, bind):\n+        try:\n+            insp = inspect(key)\n+        except sa_exc.NoInspectionAvailable:\n+            if not isinstance(key, type):\n+                raise exc.ArgumentError(\n+                            \"Not acceptable bind target: %s\" %\n+                            key)\n+        else:\n+            if insp.is_selectable:\n+                self.__binds[insp] = bind\n+            elif insp.is_mapper:\n+                self.__binds[insp.class_] = bind\n+                for selectable in insp._all_tables:\n+                    self.__binds[selectable] = bind\n+            else:\n+                raise exc.ArgumentError(\n+                            \"Not acceptable bind target: %s\" %\n+                            key)\n \n-        bind\n-          Any Connectable: a :class:`.Engine` or :class:`.Connection`.\n+    def bind_mapper(self, mapper, bind):\n+        \"\"\"Associate a :class:`.Mapper` with a \"bind\", e.g. a :class:`.Engine`\n+        or :class:`.Connection`.\n \n-        All subsequent operations involving this mapper will use the given\n-        `bind`.\n+        The given mapper is added to a lookup used by the\n+        :meth:`.Session.get_bind` method.\n \n         \"\"\"\n-        if isinstance(mapper, type):\n-            mapper = class_mapper(mapper)\n-\n-        self.__binds[mapper.base_mapper] = bind\n-        for t in mapper._all_tables:\n-            self.__binds[t] = bind\n+        self._add_bind(mapper, bind)\n \n     def bind_table(self, table, bind):\n-        \"\"\"Bind operations on a Table to a Connectable.\n-\n-        table\n-          A :class:`.Table` instance\n-\n-        bind\n-          Any Connectable: a :class:`.Engine` or :class:`.Connection`.\n+        \"\"\"Associate a :class:`.Table` with a \"bind\", e.g. a :class:`.Engine`\n+        or :class:`.Connection`.\n \n-        All subsequent operations involving this :class:`.Table` will use the \n-        given `bind`.\n+        The given mapper is added to a lookup used by the\n+        :meth:`.Session.get_bind` method.\n \n         \"\"\"\n-        self.__binds[table] = bind\n+        self._add_bind(table, bind)\n \n     def get_bind(self, mapper=None, clause=None):\n         \"\"\"Return a \"bind\" to which this :class:`.Session` is bound.\n@@ -1115,15 +1114,23 @@ class Session(_SessionClassMethods):\n                     \"Connection, and no context was provided to locate \"\n                     \"a binding.\")\n \n-        c_mapper = mapper is not None and _class_to_mapper(mapper) or None\n+        if mapper is not None:\n+            try:\n+                mapper = inspect(mapper)\n+            except sa_exc.NoInspectionAvailable:\n+                if isinstance(mapper, type):\n+                    raise exc.UnmappedClassError(mapper)\n+                else:\n+                    raise\n \n-        # manually bound?\n         if self.__binds:\n-            if c_mapper:\n-                if c_mapper.base_mapper in self.__binds:\n-                    return self.__binds[c_mapper.base_mapper]\n-                elif c_mapper.mapped_table in self.__binds:\n-                    return self.__binds[c_mapper.mapped_table]\n+            if mapper:\n+                for cls in mapper.class_.__mro__:\n+                    if cls in self.__binds:\n+                        return self.__binds[cls]\n+                if clause is None:\n+                    clause = mapper.mapped_table\n+\n             if clause is not None:\n                 for t in sql_util.find_tables(clause, include_crud=True):\n                     if t in self.__binds:\n@@ -1135,12 +1142,12 @@ class Session(_SessionClassMethods):\n         if isinstance(clause, sql.expression.ClauseElement) and clause.bind:\n             return clause.bind\n \n-        if c_mapper and c_mapper.mapped_table.bind:\n-            return c_mapper.mapped_table.bind\n+        if mapper and mapper.mapped_table.bind:\n+            return mapper.mapped_table.bind\n \n         context = []\n         if mapper is not None:\n-            context.append('mapper %s' % c_mapper)\n+            context.append('mapper %s' % mapper)\n         if clause is not None:\n             context.append('SQL expression')\n \n\n```\n","author_association":"COLLABORATOR","reactions":{"url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/comments/441923357/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"sqlalchemy-bot","id":36047385,"node_id":"MDQ6VXNlcjM2MDQ3Mzg1","avatar_url":"https://avatars.githubusercontent.com/u/36047385?v=4","gravatar_id":"","url":"https://api.github.com/users/sqlalchemy-bot","html_url":"https://github.com/sqlalchemy-bot","followers_url":"https://api.github.com/users/sqlalchemy-bot/followers","following_url":"https://api.github.com/users/sqlalchemy-bot/following{/other_user}","gists_url":"https://api.github.com/users/sqlalchemy-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/sqlalchemy-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sqlalchemy-bot/subscriptions","organizations_url":"https://api.github.com/users/sqlalchemy-bot/orgs","repos_url":"https://api.github.com/users/sqlalchemy-bot/repos","events_url":"https://api.github.com/users/sqlalchemy-bot/events{/privacy}","received_events_url":"https://api.github.com/users/sqlalchemy-bot/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/comments/441923359","html_url":"https://github.com/sqlalchemy/sqlalchemy/issues/3035#issuecomment-441923359","issue_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/3035","id":441923359,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0MTkyMzM1OQ==","user":{"login":"sqlalchemy-bot","id":36047385,"node_id":"MDQ6VXNlcjM2MDQ3Mzg1","avatar_url":"https://avatars.githubusercontent.com/u/36047385?v=4","gravatar_id":"","url":"https://api.github.com/users/sqlalchemy-bot","html_url":"https://github.com/sqlalchemy-bot","followers_url":"https://api.github.com/users/sqlalchemy-bot/followers","following_url":"https://api.github.com/users/sqlalchemy-bot/following{/other_user}","gists_url":"https://api.github.com/users/sqlalchemy-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/sqlalchemy-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sqlalchemy-bot/subscriptions","organizations_url":"https://api.github.com/users/sqlalchemy-bot/orgs","repos_url":"https://api.github.com/users/sqlalchemy-bot/repos","events_url":"https://api.github.com/users/sqlalchemy-bot/events{/privacy}","received_events_url":"https://api.github.com/users/sqlalchemy-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2014-09-17T17:25:59Z","updated_at":"2018-11-27T05:30:04Z","body":"**Michael Bayer ([@zzzeek](https://github.com/zzzeek)) wrote:**\n\nIssue #3202 was marked as a duplicate of this issue.\n","author_association":"COLLABORATOR","reactions":{"url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/comments/441923359/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"sqlalchemy-bot","id":36047385,"node_id":"MDQ6VXNlcjM2MDQ3Mzg1","avatar_url":"https://avatars.githubusercontent.com/u/36047385?v=4","gravatar_id":"","url":"https://api.github.com/users/sqlalchemy-bot","html_url":"https://github.com/sqlalchemy-bot","followers_url":"https://api.github.com/users/sqlalchemy-bot/followers","following_url":"https://api.github.com/users/sqlalchemy-bot/following{/other_user}","gists_url":"https://api.github.com/users/sqlalchemy-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/sqlalchemy-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sqlalchemy-bot/subscriptions","organizations_url":"https://api.github.com/users/sqlalchemy-bot/orgs","repos_url":"https://api.github.com/users/sqlalchemy-bot/repos","events_url":"https://api.github.com/users/sqlalchemy-bot/events{/privacy}","received_events_url":"https://api.github.com/users/sqlalchemy-bot/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/comments/441923360","html_url":"https://github.com/sqlalchemy/sqlalchemy/issues/3035#issuecomment-441923360","issue_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/3035","id":441923360,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0MTkyMzM2MA==","user":{"login":"sqlalchemy-bot","id":36047385,"node_id":"MDQ6VXNlcjM2MDQ3Mzg1","avatar_url":"https://avatars.githubusercontent.com/u/36047385?v=4","gravatar_id":"","url":"https://api.github.com/users/sqlalchemy-bot","html_url":"https://github.com/sqlalchemy-bot","followers_url":"https://api.github.com/users/sqlalchemy-bot/followers","following_url":"https://api.github.com/users/sqlalchemy-bot/following{/other_user}","gists_url":"https://api.github.com/users/sqlalchemy-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/sqlalchemy-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sqlalchemy-bot/subscriptions","organizations_url":"https://api.github.com/users/sqlalchemy-bot/orgs","repos_url":"https://api.github.com/users/sqlalchemy-bot/repos","events_url":"https://api.github.com/users/sqlalchemy-bot/events{/privacy}","received_events_url":"https://api.github.com/users/sqlalchemy-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2014-09-17T17:26:33Z","updated_at":"2018-11-27T05:30:04Z","body":"**Michael Bayer ([@zzzeek](https://github.com/zzzeek)) wrote:**\n\nadditional test from #3202:\n\n\n```\nfrom sqlalchemy import Column, Integer, ForeignKey, create_engine, orm\nfrom sqlalchemy.ext.declarative import declarative_base\n\nBase = declarative_base()\n\nclass A(Base):\n    __tablename__ = 'A'\n    id = Column(Integer, primary_key=True)\n    type = Column(Integer, nullable=False)\n    __mapper_args__ = {'polymorphic_on': type}\n\nclass B(A):\n    __tablename__ = 'B'\n    id = Column(ForeignKey(A.id), primary_key=True)\n    __mapper_args__ = {'polymorphic_identity': 1}\n\nengine = create_engine('sqlite://')\nbinds = {table: engine for table in Base.metadata.sorted_tables}\ndb = orm.sessionmaker(binds=binds)()\n\nprint db.get_bind(A) # Engine(sqlite://)\nprint db.get_bind(B) # sqlalchemy.exc.UnboundExecutionError: Could not locate a bind configured on mapper Mapper|B|B or this Session\n\n```\n","author_association":"COLLABORATOR","reactions":{"url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/comments/441923360/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"sqlalchemy-bot","id":36047385,"node_id":"MDQ6VXNlcjM2MDQ3Mzg1","avatar_url":"https://avatars.githubusercontent.com/u/36047385?v=4","gravatar_id":"","url":"https://api.github.com/users/sqlalchemy-bot","html_url":"https://github.com/sqlalchemy-bot","followers_url":"https://api.github.com/users/sqlalchemy-bot/followers","following_url":"https://api.github.com/users/sqlalchemy-bot/following{/other_user}","gists_url":"https://api.github.com/users/sqlalchemy-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/sqlalchemy-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sqlalchemy-bot/subscriptions","organizations_url":"https://api.github.com/users/sqlalchemy-bot/orgs","repos_url":"https://api.github.com/users/sqlalchemy-bot/repos","events_url":"https://api.github.com/users/sqlalchemy-bot/events{/privacy}","received_events_url":"https://api.github.com/users/sqlalchemy-bot/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/comments/441923361","html_url":"https://github.com/sqlalchemy/sqlalchemy/issues/3035#issuecomment-441923361","issue_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/3035","id":441923361,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0MTkyMzM2MQ==","user":{"login":"sqlalchemy-bot","id":36047385,"node_id":"MDQ6VXNlcjM2MDQ3Mzg1","avatar_url":"https://avatars.githubusercontent.com/u/36047385?v=4","gravatar_id":"","url":"https://api.github.com/users/sqlalchemy-bot","html_url":"https://github.com/sqlalchemy-bot","followers_url":"https://api.github.com/users/sqlalchemy-bot/followers","following_url":"https://api.github.com/users/sqlalchemy-bot/following{/other_user}","gists_url":"https://api.github.com/users/sqlalchemy-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/sqlalchemy-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sqlalchemy-bot/subscriptions","organizations_url":"https://api.github.com/users/sqlalchemy-bot/orgs","repos_url":"https://api.github.com/users/sqlalchemy-bot/repos","events_url":"https://api.github.com/users/sqlalchemy-bot/events{/privacy}","received_events_url":"https://api.github.com/users/sqlalchemy-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2014-10-14T18:04:43Z","updated_at":"2018-11-27T05:30:04Z","body":"**Michael Bayer ([@zzzeek](https://github.com/zzzeek)) wrote:**\n\n- Improvements to the mechanism used by :class:`.Session` to locate\n\"binds\" (e.g. engines to use), such engines can be associated with\nmixin classes, concrete subclasses, as well as a wider variety\nof table metadata such as joined inheritance tables.\nfixes #3035\n\n\nâ†’ 6de1a878702b\n","author_association":"COLLABORATOR","reactions":{"url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/comments/441923361/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"sqlalchemy-bot","id":36047385,"node_id":"MDQ6VXNlcjM2MDQ3Mzg1","avatar_url":"https://avatars.githubusercontent.com/u/36047385?v=4","gravatar_id":"","url":"https://api.github.com/users/sqlalchemy-bot","html_url":"https://github.com/sqlalchemy-bot","followers_url":"https://api.github.com/users/sqlalchemy-bot/followers","following_url":"https://api.github.com/users/sqlalchemy-bot/following{/other_user}","gists_url":"https://api.github.com/users/sqlalchemy-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/sqlalchemy-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sqlalchemy-bot/subscriptions","organizations_url":"https://api.github.com/users/sqlalchemy-bot/orgs","repos_url":"https://api.github.com/users/sqlalchemy-bot/repos","events_url":"https://api.github.com/users/sqlalchemy-bot/events{/privacy}","received_events_url":"https://api.github.com/users/sqlalchemy-bot/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/comments/441923362","html_url":"https://github.com/sqlalchemy/sqlalchemy/issues/3035#issuecomment-441923362","issue_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/3035","id":441923362,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0MTkyMzM2Mg==","user":{"login":"sqlalchemy-bot","id":36047385,"node_id":"MDQ6VXNlcjM2MDQ3Mzg1","avatar_url":"https://avatars.githubusercontent.com/u/36047385?v=4","gravatar_id":"","url":"https://api.github.com/users/sqlalchemy-bot","html_url":"https://github.com/sqlalchemy-bot","followers_url":"https://api.github.com/users/sqlalchemy-bot/followers","following_url":"https://api.github.com/users/sqlalchemy-bot/following{/other_user}","gists_url":"https://api.github.com/users/sqlalchemy-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/sqlalchemy-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sqlalchemy-bot/subscriptions","organizations_url":"https://api.github.com/users/sqlalchemy-bot/orgs","repos_url":"https://api.github.com/users/sqlalchemy-bot/repos","events_url":"https://api.github.com/users/sqlalchemy-bot/events{/privacy}","received_events_url":"https://api.github.com/users/sqlalchemy-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2014-10-14T18:04:43Z","updated_at":"2018-11-27T05:30:05Z","body":"**Changes by Michael Bayer ([@zzzeek](https://github.com/zzzeek)):**\n\n* changed **status** to closed\n","author_association":"COLLABORATOR","reactions":{"url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/comments/441923362/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"sqlalchemy-bot","id":36047385,"node_id":"MDQ6VXNlcjM2MDQ3Mzg1","avatar_url":"https://avatars.githubusercontent.com/u/36047385?v=4","gravatar_id":"","url":"https://api.github.com/users/sqlalchemy-bot","html_url":"https://github.com/sqlalchemy-bot","followers_url":"https://api.github.com/users/sqlalchemy-bot/followers","following_url":"https://api.github.com/users/sqlalchemy-bot/following{/other_user}","gists_url":"https://api.github.com/users/sqlalchemy-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/sqlalchemy-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sqlalchemy-bot/subscriptions","organizations_url":"https://api.github.com/users/sqlalchemy-bot/orgs","repos_url":"https://api.github.com/users/sqlalchemy-bot/repos","events_url":"https://api.github.com/users/sqlalchemy-bot/events{/privacy}","received_events_url":"https://api.github.com/users/sqlalchemy-bot/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":1988603604,"node_id":"MDExOkNsb3NlZEV2ZW50MTk4ODYwMzYwNA==","url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/events/1988603604","actor":{"login":"sqlalchemy-bot","id":36047385,"node_id":"MDQ6VXNlcjM2MDQ3Mzg1","avatar_url":"https://avatars.githubusercontent.com/u/36047385?v=4","gravatar_id":"","url":"https://api.github.com/users/sqlalchemy-bot","html_url":"https://github.com/sqlalchemy-bot","followers_url":"https://api.github.com/users/sqlalchemy-bot/followers","following_url":"https://api.github.com/users/sqlalchemy-bot/following{/other_user}","gists_url":"https://api.github.com/users/sqlalchemy-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/sqlalchemy-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sqlalchemy-bot/subscriptions","organizations_url":"https://api.github.com/users/sqlalchemy-bot/orgs","repos_url":"https://api.github.com/users/sqlalchemy-bot/repos","events_url":"https://api.github.com/users/sqlalchemy-bot/events{/privacy}","received_events_url":"https://api.github.com/users/sqlalchemy-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2014-10-14T18:04:43Z","state_reason":null,"performed_via_github_app":null},{"id":1988603597,"node_id":"MDEyOkxhYmVsZWRFdmVudDE5ODg2MDM1OTc=","url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/events/1988603597","actor":{"login":"sqlalchemy-bot","id":36047385,"node_id":"MDQ6VXNlcjM2MDQ3Mzg1","avatar_url":"https://avatars.githubusercontent.com/u/36047385?v=4","gravatar_id":"","url":"https://api.github.com/users/sqlalchemy-bot","html_url":"https://github.com/sqlalchemy-bot","followers_url":"https://api.github.com/users/sqlalchemy-bot/followers","following_url":"https://api.github.com/users/sqlalchemy-bot/following{/other_user}","gists_url":"https://api.github.com/users/sqlalchemy-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/sqlalchemy-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sqlalchemy-bot/subscriptions","organizations_url":"https://api.github.com/users/sqlalchemy-bot/orgs","repos_url":"https://api.github.com/users/sqlalchemy-bot/repos","events_url":"https://api.github.com/users/sqlalchemy-bot/events{/privacy}","received_events_url":"https://api.github.com/users/sqlalchemy-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2018-11-27T05:30:04Z","label":{"name":"feature","color":"306080"},"performed_via_github_app":null},{"id":1988603598,"node_id":"MDEyOkxhYmVsZWRFdmVudDE5ODg2MDM1OTg=","url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/events/1988603598","actor":{"login":"sqlalchemy-bot","id":36047385,"node_id":"MDQ6VXNlcjM2MDQ3Mzg1","avatar_url":"https://avatars.githubusercontent.com/u/36047385?v=4","gravatar_id":"","url":"https://api.github.com/users/sqlalchemy-bot","html_url":"https://github.com/sqlalchemy-bot","followers_url":"https://api.github.com/users/sqlalchemy-bot/followers","following_url":"https://api.github.com/users/sqlalchemy-bot/following{/other_user}","gists_url":"https://api.github.com/users/sqlalchemy-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/sqlalchemy-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sqlalchemy-bot/subscriptions","organizations_url":"https://api.github.com/users/sqlalchemy-bot/orgs","repos_url":"https://api.github.com/users/sqlalchemy-bot/repos","events_url":"https://api.github.com/users/sqlalchemy-bot/events{/privacy}","received_events_url":"https://api.github.com/users/sqlalchemy-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2018-11-27T05:30:04Z","label":{"name":"orm","color":"20C0B0"},"performed_via_github_app":null},{"id":1988603601,"node_id":"MDE1Ok1pbGVzdG9uZWRFdmVudDE5ODg2MDM2MDE=","url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/events/1988603601","actor":{"login":"sqlalchemy-bot","id":36047385,"node_id":"MDQ6VXNlcjM2MDQ3Mzg1","avatar_url":"https://avatars.githubusercontent.com/u/36047385?v=4","gravatar_id":"","url":"https://api.github.com/users/sqlalchemy-bot","html_url":"https://github.com/sqlalchemy-bot","followers_url":"https://api.github.com/users/sqlalchemy-bot/followers","following_url":"https://api.github.com/users/sqlalchemy-bot/following{/other_user}","gists_url":"https://api.github.com/users/sqlalchemy-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/sqlalchemy-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sqlalchemy-bot/subscriptions","organizations_url":"https://api.github.com/users/sqlalchemy-bot/orgs","repos_url":"https://api.github.com/users/sqlalchemy-bot/repos","events_url":"https://api.github.com/users/sqlalchemy-bot/events{/privacy}","received_events_url":"https://api.github.com/users/sqlalchemy-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"milestoned","commit_id":null,"commit_url":null,"created_at":"2018-11-27T05:30:04Z","milestone":{"title":"1.0"},"performed_via_github_app":null},{"actor":{"login":"sqlalchemy-bot","id":36047385,"node_id":"MDQ6VXNlcjM2MDQ3Mzg1","avatar_url":"https://avatars.githubusercontent.com/u/36047385?v=4","gravatar_id":"","url":"https://api.github.com/users/sqlalchemy-bot","html_url":"https://github.com/sqlalchemy-bot","followers_url":"https://api.github.com/users/sqlalchemy-bot/followers","following_url":"https://api.github.com/users/sqlalchemy-bot/following{/other_user}","gists_url":"https://api.github.com/users/sqlalchemy-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/sqlalchemy-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sqlalchemy-bot/subscriptions","organizations_url":"https://api.github.com/users/sqlalchemy-bot/orgs","repos_url":"https://api.github.com/users/sqlalchemy-bot/repos","events_url":"https://api.github.com/users/sqlalchemy-bot/events{/privacy}","received_events_url":"https://api.github.com/users/sqlalchemy-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-27T05:37:31Z","updated_at":"2018-11-27T05:37:31Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/3202","repository_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy","labels_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/3202/labels{/name}","comments_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/3202/comments","events_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/3202/events","html_url":"https://github.com/sqlalchemy/sqlalchemy/issues/3202","id":384631947,"node_id":"MDU6SXNzdWUzODQ2MzE5NDc=","number":3202,"title":"UnboundExecutionError for joint table subclasses when binds is constructed from list of tables","user":{"login":"sqlalchemy-bot","id":36047385,"node_id":"MDQ6VXNlcjM2MDQ3Mzg1","avatar_url":"https://avatars.githubusercontent.com/u/36047385?v=4","gravatar_id":"","url":"https://api.github.com/users/sqlalchemy-bot","html_url":"https://github.com/sqlalchemy-bot","followers_url":"https://api.github.com/users/sqlalchemy-bot/followers","following_url":"https://api.github.com/users/sqlalchemy-bot/following{/other_user}","gists_url":"https://api.github.com/users/sqlalchemy-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/sqlalchemy-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sqlalchemy-bot/subscriptions","organizations_url":"https://api.github.com/users/sqlalchemy-bot/orgs","repos_url":"https://api.github.com/users/sqlalchemy-bot/repos","events_url":"https://api.github.com/users/sqlalchemy-bot/events{/privacy}","received_events_url":"https://api.github.com/users/sqlalchemy-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":1141269142,"node_id":"MDU6TGFiZWwxMTQxMjY5MTQy","url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"},{"id":1141269144,"node_id":"MDU6TGFiZWwxMTQxMjY5MTQ0","url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/labels/duplicate","name":"duplicate","color":"cfd3d7","default":true,"description":"This issue or pull request already exists"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2014-09-17T12:05:49Z","updated_at":"2014-10-14T18:05:06Z","closed_at":"2014-09-17T17:25:59Z","author_association":"COLLABORATOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"repository":{"id":159271175,"node_id":"MDEwOlJlcG9zaXRvcnkxNTkyNzExNzU=","name":"sqlalchemy","full_name":"sqlalchemy/sqlalchemy","private":false,"owner":{"login":"sqlalchemy","id":6043126,"node_id":"MDEyOk9yZ2FuaXphdGlvbjYwNDMxMjY=","avatar_url":"https://avatars.githubusercontent.com/u/6043126?v=4","gravatar_id":"","url":"https://api.github.com/users/sqlalchemy","html_url":"https://github.com/sqlalchemy","followers_url":"https://api.github.com/users/sqlalchemy/followers","following_url":"https://api.github.com/users/sqlalchemy/following{/other_user}","gists_url":"https://api.github.com/users/sqlalchemy/gists{/gist_id}","starred_url":"https://api.github.com/users/sqlalchemy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sqlalchemy/subscriptions","organizations_url":"https://api.github.com/users/sqlalchemy/orgs","repos_url":"https://api.github.com/users/sqlalchemy/repos","events_url":"https://api.github.com/users/sqlalchemy/events{/privacy}","received_events_url":"https://api.github.com/users/sqlalchemy/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/sqlalchemy/sqlalchemy","description":"The Database Toolkit for Python","fork":false,"url":"https://api.github.com/repos/sqlalchemy/sqlalchemy","forks_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/forks","keys_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/keys{/key_id}","collaborators_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/teams","hooks_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/hooks","issue_events_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/events{/number}","events_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/events","assignees_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/assignees{/user}","branches_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/branches{/branch}","tags_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/tags","blobs_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/git/refs{/sha}","trees_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/git/trees{/sha}","statuses_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/statuses/{sha}","languages_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/languages","stargazers_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/stargazers","contributors_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/contributors","subscribers_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/subscribers","subscription_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/subscription","commits_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/commits{/sha}","git_commits_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/git/commits{/sha}","comments_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/comments{/number}","issue_comment_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/comments{/number}","contents_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/contents/{+path}","compare_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/compare/{base}...{head}","merges_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/merges","archive_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/downloads","issues_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues{/number}","pulls_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/pulls{/number}","milestones_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/milestones{/number}","notifications_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/labels{/name}","releases_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/releases{/id}","deployments_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/deployments","created_at":"2018-11-27T03:35:03Z","updated_at":"2025-11-10T08:14:59Z","pushed_at":"2025-11-09T19:21:36Z","git_url":"git://github.com/sqlalchemy/sqlalchemy.git","ssh_url":"git@github.com:sqlalchemy/sqlalchemy.git","clone_url":"https://github.com/sqlalchemy/sqlalchemy.git","svn_url":"https://github.com/sqlalchemy/sqlalchemy","homepage":"https://www.sqlalchemy.org","size":97110,"stargazers_count":11107,"watchers_count":11107,"language":"Python","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":true,"forks_count":1596,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":219,"license":{"key":"mit","name":"MIT License","spdx_id":"MIT","url":"https://api.github.com/licenses/mit","node_id":"MDc6TGljZW5zZTEz"},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["python","sql","sqlalchemy"],"visibility":"public","forks":1596,"open_issues":219,"watchers":11107,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"body":"**Migrated issue, originally created by Denis Otkidach ([@ods](https://github.com/ods))**\n\nThe list of tables is the only list of mapped data that automatically collected in `MetaData` object. So it's the simplest way to construct session with multiple connections where separate connection is used for each metadata. `Session.get_bind()` does look up based on `mapper.mapped_table`. This works for simple mapped classes, but doesn't work for classes mapped to join like subclasses with joined table inheritance.\n\nTest case:\n\n```python\nfrom sqlalchemy import Column, Integer, ForeignKey, create_engine, orm\nfrom sqlalchemy.ext.declarative import declarative_base\n\nBase = declarative_base()\n\nclass A(Base):\n    __tablename__ = 'A'\n    id = Column(Integer, primary_key=True)\n    type = Column(Integer, nullable=False)\n    __mapper_args__ = {'polymorphic_on': type}\n\nclass B(A):\n    __tablename__ = 'B'\n    id = Column(ForeignKey(A.id), primary_key=True)\n    __mapper_args__ = {'polymorphic_identity': 1}\n\nengine = create_engine('sqlite://')\nbinds = {table: engine for table in Base.metadata.sorted_tables}\ndb = orm.sessionmaker(binds=binds)()\n\nprint db.get_bind(A) # Engine(sqlite://)\nprint db.get_bind(B) # sqlalchemy.exc.UnboundExecutionError: Could not locate a bind configured on mapper Mapper|B|B or this Session\n```\n\nShould we iterate through tables used in `Join` object `mapper.mapped_table` refers to?\n\n","reactions":{"url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/3202/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/3202/timeline","performed_via_github_app":null,"state_reason":"completed"}},"event":"cross-referenced"}]