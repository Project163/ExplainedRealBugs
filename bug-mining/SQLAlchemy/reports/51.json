{"url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/1361","repository_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy","labels_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/1361/labels{/name}","comments_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/1361/comments","events_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/1361/events","html_url":"https://github.com/sqlalchemy/sqlalchemy/issues/1361","id":384616870,"node_id":"MDU6SXNzdWUzODQ2MTY4NzA=","number":1361,"title":"Make create_engine accept parameterized URL when Oracle TNS name is used","user":{"login":"sqlalchemy-bot","id":36047385,"node_id":"MDQ6VXNlcjM2MDQ3Mzg1","avatar_url":"https://avatars.githubusercontent.com/u/36047385?v=4","gravatar_id":"","url":"https://api.github.com/users/sqlalchemy-bot","html_url":"https://github.com/sqlalchemy-bot","followers_url":"https://api.github.com/users/sqlalchemy-bot/followers","following_url":"https://api.github.com/users/sqlalchemy-bot/following{/other_user}","gists_url":"https://api.github.com/users/sqlalchemy-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/sqlalchemy-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sqlalchemy-bot/subscriptions","organizations_url":"https://api.github.com/users/sqlalchemy-bot/orgs","repos_url":"https://api.github.com/users/sqlalchemy-bot/repos","events_url":"https://api.github.com/users/sqlalchemy-bot/events{/privacy}","received_events_url":"https://api.github.com/users/sqlalchemy-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":1141269142,"node_id":"MDU6TGFiZWwxMTQxMjY5MTQy","url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"},{"id":1141273862,"node_id":"MDU6TGFiZWwxMTQxMjczODYy","url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/labels/documentation","name":"documentation","color":"ffe7a8","default":true,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/milestones/20","html_url":"https://github.com/sqlalchemy/sqlalchemy/milestone/20","labels_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/milestones/20/labels","id":3850574,"node_id":"MDk6TWlsZXN0b25lMzg1MDU3NA==","number":20,"title":"0.5.4","description":null,"creator":{"login":"sqlalchemy-bot","id":36047385,"node_id":"MDQ6VXNlcjM2MDQ3Mzg1","avatar_url":"https://avatars.githubusercontent.com/u/36047385?v=4","gravatar_id":"","url":"https://api.github.com/users/sqlalchemy-bot","html_url":"https://github.com/sqlalchemy-bot","followers_url":"https://api.github.com/users/sqlalchemy-bot/followers","following_url":"https://api.github.com/users/sqlalchemy-bot/following{/other_user}","gists_url":"https://api.github.com/users/sqlalchemy-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/sqlalchemy-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sqlalchemy-bot/subscriptions","organizations_url":"https://api.github.com/users/sqlalchemy-bot/orgs","repos_url":"https://api.github.com/users/sqlalchemy-bot/repos","events_url":"https://api.github.com/users/sqlalchemy-bot/events{/privacy}","received_events_url":"https://api.github.com/users/sqlalchemy-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":25,"state":"closed","created_at":"2018-11-27T03:51:15Z","updated_at":"2018-11-28T16:49:45Z","due_on":null,"closed_at":"2018-11-28T16:49:45Z"},"comments":12,"created_at":"2009-03-31T16:28:34Z","updated_at":"2014-02-23T18:14:14Z","closed_at":"2009-04-03T22:43:13Z","author_association":"COLLABORATOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"**Migrated issue, originally created by Catherine Devlin ([@catherinedevlin](https://github.com/catherinedevlin))**\n\nHey, SQLAlchemy folks... to finish switching sqlpython over to sqlalchemy-managed connections, we need a little extra capability for create_engine with Oracle, and I'm attaching a patch for engine/url.py to supply it.  Can you consider applying it to your trunk?\n\nI've got an Oracle database ORCL on localhost, but I need to connect to it with the TNSnames.ora label of DBASE.  Here's what's happening as of svn rev 5883 in the 0.5.3 trunk:\n\n\n    \n    >>> from sqlalchemy import *\n    >>> create_engine('oracle://jrrt:jrrt@dbase').connect()\n    <sqlalchemy.engine.base.Connection object at 0xb65a148c>\n    >>> create_engine('oracle://sys:syspasswd@localhost/orcl?mode=2').connect()\n    <sqlalchemy.engine.base.Connection object at 0xb76daecc>\n    >>> create_engine('oracle://sys:syspasswd@dbase?mode=2').connect()\n    Traceback (most recent call last):\n      *** boom ***  (screams)  (sirens)\n      File \"/home/catherine/dev/sqla4336/lib/sqlalchemy/engine/strategies.py\", line 80, in connect\n        raise exc.DBAPIError.instance(None, None, e)\n    sqlalchemy.exc.DatabaseError: (DatabaseError) ORA-12154: TNS:could not resolve the connect identifier specified\n     None None\n\n\nIn other words, ?param=val parameters, right now, only work when the url has the full hostname and database name explicitly - not when the TNS name is used in the url.  With this patch, they work either way.\n\nI think the patch fits with the documentation, or at least doesn't contradict it.\n\nFrom the docs at http://www.sqlalchemy.org/docs/05/reference/dialects/oracle.html:\n----------------------------------------------------------------------------------\n\nConnecting with create_engine() uses the standard URL approach of oracle://user:pass@host:port/dbname[?key=value&key=value...](?key=value&key=value...). If dbname is present, the host, port, and dbname tokens are converted to a TNS name using the cx_oracle makedsn() function. Otherwise, the host token is taken directly as a TNS name.\n\nAdditional arguments which may be specified either as query string arguments on the URL, or as keyword arguments to create_engine() are:\n\n    * allow_twophase - enable two-phase transactions. Defaults to True.\n    * auto_convert_lobs - defaults to True, see the section on LOB objects.\n    * auto_setinputsizes - the cx_oracle.setinputsizes() call is issued for all bind parameters. This is required for LOB datatypes but can be disabled to reduce overhead. Defaults to True.\n    * mode - This is given the string value of SYSDBA or SYSOPER, or alternatively an integer value. This value is only available as a URL query string argument.\n\n----------------------------------------\nAttachments: [urlparampatch.diff](../wiki/imported_issue_attachments/1361/urlparampatch.diff) | [1361.patch](../wiki/imported_issue_attachments/1361/1361.patch)\n\n","closed_by":{"login":"sqlalchemy-bot","id":36047385,"node_id":"MDQ6VXNlcjM2MDQ3Mzg1","avatar_url":"https://avatars.githubusercontent.com/u/36047385?v=4","gravatar_id":"","url":"https://api.github.com/users/sqlalchemy-bot","html_url":"https://github.com/sqlalchemy-bot","followers_url":"https://api.github.com/users/sqlalchemy-bot/followers","following_url":"https://api.github.com/users/sqlalchemy-bot/following{/other_user}","gists_url":"https://api.github.com/users/sqlalchemy-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/sqlalchemy-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sqlalchemy-bot/subscriptions","organizations_url":"https://api.github.com/users/sqlalchemy-bot/orgs","repos_url":"https://api.github.com/users/sqlalchemy-bot/repos","events_url":"https://api.github.com/users/sqlalchemy-bot/events{/privacy}","received_events_url":"https://api.github.com/users/sqlalchemy-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/1361/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/sqlalchemy/sqlalchemy/issues/1361/timeline","performed_via_github_app":null,"state_reason":"completed"}