{"url":"https://api.github.com/repos/FasterXML/jackson-dataformat-xml/issues/550","repository_url":"https://api.github.com/repos/FasterXML/jackson-dataformat-xml","labels_url":"https://api.github.com/repos/FasterXML/jackson-dataformat-xml/issues/550/labels{/name}","comments_url":"https://api.github.com/repos/FasterXML/jackson-dataformat-xml/issues/550/comments","events_url":"https://api.github.com/repos/FasterXML/jackson-dataformat-xml/issues/550/events","html_url":"https://github.com/FasterXML/jackson-dataformat-xml/issues/550","id":1410098285,"node_id":"I_kwDOABJ3ss5UDGRt","number":550,"title":"Use of `ClassLoader`-taking `newFactory()` variant breaks applications using default JDK XML implementation","user":{"login":"dfelliott","id":16450298,"node_id":"MDQ6VXNlcjE2NDUwMjk4","avatar_url":"https://avatars.githubusercontent.com/u/16450298?v=4","gravatar_id":"","url":"https://api.github.com/users/dfelliott","html_url":"https://github.com/dfelliott","followers_url":"https://api.github.com/users/dfelliott/followers","following_url":"https://api.github.com/users/dfelliott/following{/other_user}","gists_url":"https://api.github.com/users/dfelliott/gists{/gist_id}","starred_url":"https://api.github.com/users/dfelliott/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dfelliott/subscriptions","organizations_url":"https://api.github.com/users/dfelliott/orgs","repos_url":"https://api.github.com/users/dfelliott/repos","events_url":"https://api.github.com/users/dfelliott/events{/privacy}","received_events_url":"https://api.github.com/users/dfelliott/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/FasterXML/jackson-dataformat-xml/milestones/50","html_url":"https://github.com/FasterXML/jackson-dataformat-xml/milestone/50","labels_url":"https://api.github.com/repos/FasterXML/jackson-dataformat-xml/milestones/50/labels","id":8366620,"node_id":"MI_kwDOABJ3ss4Af6oc","number":50,"title":"2.14.0","description":null,"creator":{"login":"cowtowncoder","id":55065,"node_id":"MDQ6VXNlcjU1MDY1","avatar_url":"https://avatars.githubusercontent.com/u/55065?v=4","gravatar_id":"","url":"https://api.github.com/users/cowtowncoder","html_url":"https://github.com/cowtowncoder","followers_url":"https://api.github.com/users/cowtowncoder/followers","following_url":"https://api.github.com/users/cowtowncoder/following{/other_user}","gists_url":"https://api.github.com/users/cowtowncoder/gists{/gist_id}","starred_url":"https://api.github.com/users/cowtowncoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cowtowncoder/subscriptions","organizations_url":"https://api.github.com/users/cowtowncoder/orgs","repos_url":"https://api.github.com/users/cowtowncoder/repos","events_url":"https://api.github.com/users/cowtowncoder/events{/privacy}","received_events_url":"https://api.github.com/users/cowtowncoder/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":1,"closed_issues":4,"state":"open","created_at":"2022-08-31T00:14:06Z","updated_at":"2022-10-25T01:27:09Z","due_on":null,"closed_at":null},"comments":4,"created_at":"2022-10-15T08:48:40Z","updated_at":"2023-01-09T18:20:20Z","closed_at":"2022-10-25T01:19:29Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"The fix for https://github.com/FasterXML/jackson-dataformat-xml/issues/483 introduced a regression for applications using only the built-in JDK XML support.\r\n\r\nBefore this change, the code did this:\r\n```\r\n            xmlIn = XMLInputFactory.newInstance();\r\n```\r\n\r\nAfter this change, the code does this:\r\n```\r\n            // 05-Jul-2021, tatu: as per [dataformat-xml#483], specify ClassLoader\r\n            xmlIn = XMLInputFactory.newFactory(XMLInputFactory.class.getName(),\r\n                    getClass().getClassLoader());\r\n```\r\n\r\nA similar change applies to the `XMLOutputFactory`.\r\n\r\nUnfortunately if you look at the JDK's implementation of these methods, the one taking zero arguments (old code) will fall back to the built-in implementation whereas the one accepting arguments (new code) does not perform the fallback.\r\n\r\nMy preference would be to revert this change, not just because it would fix this problem for me but because I believe the original code was actually correct and the new code is not.  Why should only XML libraries on whatever ClassLoader is hosting Jackson be considered?  Shouldn't the caller be able to control what library is used in the default constructor by controlling the context ClassLoader?\r\n\r\nMeanwhile, a caller wishing to use the XML support of a specific ClassLoader, be it Jackson's ClassLoader or another, is already free to make the call to XMLInputFactory and XMLOutputFactory itself, passing in the specific objects to use.  Or that caller could instead simply set their ContextClassLoader appropriately and the default constructor would do what they want.","closed_by":{"login":"cowtowncoder","id":55065,"node_id":"MDQ6VXNlcjU1MDY1","avatar_url":"https://avatars.githubusercontent.com/u/55065?v=4","gravatar_id":"","url":"https://api.github.com/users/cowtowncoder","html_url":"https://github.com/cowtowncoder","followers_url":"https://api.github.com/users/cowtowncoder/followers","following_url":"https://api.github.com/users/cowtowncoder/following{/other_user}","gists_url":"https://api.github.com/users/cowtowncoder/gists{/gist_id}","starred_url":"https://api.github.com/users/cowtowncoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cowtowncoder/subscriptions","organizations_url":"https://api.github.com/users/cowtowncoder/orgs","repos_url":"https://api.github.com/users/cowtowncoder/repos","events_url":"https://api.github.com/users/cowtowncoder/events{/privacy}","received_events_url":"https://api.github.com/users/cowtowncoder/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/FasterXML/jackson-dataformat-xml/issues/550/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/FasterXML/jackson-dataformat-xml/issues/550/timeline","performed_via_github_app":null,"state_reason":"completed"}