{"url":"https://api.github.com/repos/FasterXML/jackson-dataformat-xml/issues/389","repository_url":"https://api.github.com/repos/FasterXML/jackson-dataformat-xml","labels_url":"https://api.github.com/repos/FasterXML/jackson-dataformat-xml/issues/389/labels{/name}","comments_url":"https://api.github.com/repos/FasterXML/jackson-dataformat-xml/issues/389/comments","events_url":"https://api.github.com/repos/FasterXML/jackson-dataformat-xml/issues/389/events","html_url":"https://github.com/FasterXML/jackson-dataformat-xml/issues/389","id":585794429,"node_id":"MDU6SXNzdWU1ODU3OTQ0Mjk=","number":389,"title":"Exception when serializing with type via mapper.writerFor(type).write(...)","user":{"login":"texhnolyzze","id":26366553,"node_id":"MDQ6VXNlcjI2MzY2NTUz","avatar_url":"https://avatars.githubusercontent.com/u/26366553?v=4","gravatar_id":"","url":"https://api.github.com/users/texhnolyzze","html_url":"https://github.com/texhnolyzze","followers_url":"https://api.github.com/users/texhnolyzze/followers","following_url":"https://api.github.com/users/texhnolyzze/following{/other_user}","gists_url":"https://api.github.com/users/texhnolyzze/gists{/gist_id}","starred_url":"https://api.github.com/users/texhnolyzze/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/texhnolyzze/subscriptions","organizations_url":"https://api.github.com/users/texhnolyzze/orgs","repos_url":"https://api.github.com/users/texhnolyzze/repos","events_url":"https://api.github.com/users/texhnolyzze/events{/privacy}","received_events_url":"https://api.github.com/users/texhnolyzze/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/FasterXML/jackson-dataformat-xml/milestones/34","html_url":"https://github.com/FasterXML/jackson-dataformat-xml/milestone/34","labels_url":"https://api.github.com/repos/FasterXML/jackson-dataformat-xml/milestones/34/labels","id":5409081,"node_id":"MDk6TWlsZXN0b25lNTQwOTA4MQ==","number":34,"title":"2.11.1","description":null,"creator":{"login":"cowtowncoder","id":55065,"node_id":"MDQ6VXNlcjU1MDY1","avatar_url":"https://avatars.githubusercontent.com/u/55065?v=4","gravatar_id":"","url":"https://api.github.com/users/cowtowncoder","html_url":"https://github.com/cowtowncoder","followers_url":"https://api.github.com/users/cowtowncoder/followers","following_url":"https://api.github.com/users/cowtowncoder/following{/other_user}","gists_url":"https://api.github.com/users/cowtowncoder/gists{/gist_id}","starred_url":"https://api.github.com/users/cowtowncoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cowtowncoder/subscriptions","organizations_url":"https://api.github.com/users/cowtowncoder/orgs","repos_url":"https://api.github.com/users/cowtowncoder/repos","events_url":"https://api.github.com/users/cowtowncoder/events{/privacy}","received_events_url":"https://api.github.com/users/cowtowncoder/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":8,"state":"open","created_at":"2020-05-12T04:09:53Z","updated_at":"2020-06-07T02:57:19Z","due_on":null,"closed_at":null},"comments":3,"created_at":"2020-03-22T19:32:42Z","updated_at":"2020-05-22T00:31:25Z","closed_at":"2020-05-22T00:22:48Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"Hello again! \r\nWe have problems with Jackson (2.97) again (not JSON, but XML). Please, tell me what am I doing wrong. Here is the simple code:\r\n```java\r\n@JsonTypeInfo(use = JsonTypeInfo.Id.NAME, property = \"type\")\r\n@JsonSubTypes({\r\n    @JsonSubTypes.Type(value = ConcreteModel.class, name = \"ConcreteModel\")\r\n})\r\npublic abstract class AbstractModel {\r\n    \r\n\t@JacksonXmlProperty(isAttribute = true)\r\n\tpublic Long id;\r\n\t\r\n\t@JacksonXmlProperty(isAttribute = true)\r\n\tpublic String name;\r\n\r\n}\r\n```\r\n\r\n```java\r\n@JacksonXmlRootElement(localName = \"Concrete\")\r\npublic class ConcreteModel extends AbstractModel {\r\n\r\n\t@JacksonXmlProperty(isAttribute = true)\r\n\tpublic String someAdditionalField;\r\n\r\n}\r\n```\r\n\r\nI ommitted getters/setters.\r\nOkay, now I'm doing such simple thing:\r\n```java\r\nConcreteModel concreteModel = new ConcreteModel();\r\nconcreteModel.id = 1L;\r\nconcreteModel.name = \"Bob\";\r\nconcreteModel.someAdditionalField = \"...\";\r\nXmlMapper xmlMapper = getXmlMapper();\r\nSystem.out.println(xmlMapper.writeValueAsString(concreteModel));\r\n```\r\n\r\nAnd it outputs:\r\n```xml\r\n<Concrete type=\"ConcreteModel\" id=\"1\" name=\"Bob\" someAdditionalField=\"...\"/>\r\n```\r\n\r\nGreat!\r\nNow I replaced the last line to:\r\n```java\r\nSystem.out.println(xmlMapper.writerFor(xmlMapper.constructType(concreteModel.getClass())).writeValueAsString(concreteModel));\r\n```\r\nAnd I'm getting the error:\r\n```\r\ncom.fasterxml.jackson.databind.JsonMappingException: No element/attribute name specified when trying to output element\r\n\tSuppressed: com.fasterxml.jackson.core.JsonGenerationException: Trying to write END_DOCUMENT when document has no root (ie. trying to output empty document).\r\n\t\tat com.fasterxml.jackson.dataformat.xml.util.StaxUtil.throwAsGenerationException(StaxUtil.java:47)\r\n\t\tat com.fasterxml.jackson.dataformat.xml.ser.ToXmlGenerator.close(ToXmlGenerator.java:1188)\r\n\t\tat com.fasterxml.jackson.databind.util.ClassUtil.closeOnFailAndThrowAsIOE(ClassUtil.java:488)\r\n\t\tat com.fasterxml.jackson.databind.ObjectWriter._configAndWriteValue(ObjectWriter.java:1122)\r\n\t\t... 32 more\r\n\tCaused by: javax.xml.stream.XMLStreamException: Trying to write END_DOCUMENT when document has no root (ie. trying to output empty document).\r\n\t\tat com.ctc.wstx.sw.BaseStreamWriter.throwOutputError(BaseStreamWriter.java:1584)\r\n\t\tat com.ctc.wstx.sw.BaseStreamWriter.reportNwfStructure(BaseStreamWriter.java:1613)\r\n\t\tat com.ctc.wstx.sw.BaseStreamWriter._finishDocument(BaseStreamWriter.java:1439)\r\n\t\tat com.ctc.wstx.sw.BaseStreamWriter.closeCompletely(BaseStreamWriter.java:921)\r\n\t\tat com.fasterxml.jackson.dataformat.xml.ser.ToXmlGenerator.close(ToXmlGenerator.java:1183)\r\n\t\t... 34 more\r\nCaused by: java.lang.IllegalStateException: No element/attribute name specified when trying to output element\r\n\tat com.fasterxml.jackson.dataformat.xml.ser.ToXmlGenerator.handleMissingName(ToXmlGenerator.java:1218)\r\n\tat com.fasterxml.jackson.dataformat.xml.ser.ToXmlGenerator._handleStartObject(ToXmlGenerator.java:533)\r\n\tat com.fasterxml.jackson.dataformat.xml.ser.ToXmlGenerator.writeStartObject(ToXmlGenerator.java:509)\r\n\tat com.fasterxml.jackson.core.base.GeneratorBase.writeStartObject(GeneratorBase.java:286)\r\n\tat com.fasterxml.jackson.core.JsonGenerator.writeTypePrefix(JsonGenerator.java:1459)\r\n\tat com.fasterxml.jackson.databind.jsontype.impl.TypeSerializerBase.writeTypePrefix(TypeSerializerBase.java:46)\r\n\tat com.fasterxml.jackson.databind.ser.std.BeanSerializerBase.serializeWithType(BeanSerializerBase.java:600)\r\n\tat com.fasterxml.jackson.dataformat.xml.ser.XmlBeanSerializerBase.serializeWithType(XmlBeanSerializerBase.java:320)\r\n\tat com.fasterxml.jackson.databind.ser.DefaultSerializerProvider.serializePolymorphic(DefaultSerializerProvider.java:452)\r\n\t... 34 more\r\n```\r\n\r\nCan you please tell me what is wrong?","closed_by":{"login":"cowtowncoder","id":55065,"node_id":"MDQ6VXNlcjU1MDY1","avatar_url":"https://avatars.githubusercontent.com/u/55065?v=4","gravatar_id":"","url":"https://api.github.com/users/cowtowncoder","html_url":"https://github.com/cowtowncoder","followers_url":"https://api.github.com/users/cowtowncoder/followers","following_url":"https://api.github.com/users/cowtowncoder/following{/other_user}","gists_url":"https://api.github.com/users/cowtowncoder/gists{/gist_id}","starred_url":"https://api.github.com/users/cowtowncoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cowtowncoder/subscriptions","organizations_url":"https://api.github.com/users/cowtowncoder/orgs","repos_url":"https://api.github.com/users/cowtowncoder/repos","events_url":"https://api.github.com/users/cowtowncoder/events{/privacy}","received_events_url":"https://api.github.com/users/cowtowncoder/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/FasterXML/jackson-dataformat-xml/issues/389/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/FasterXML/jackson-dataformat-xml/issues/389/timeline","performed_via_github_app":null,"state_reason":"completed"}