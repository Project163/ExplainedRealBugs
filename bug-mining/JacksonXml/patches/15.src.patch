diff --git a/pom.xml b/pom.xml
index d1e6d5af..6cefbf55 100644
--- a/pom.xml
+++ b/pom.xml
@@ -25,7 +25,7 @@ Some data-binding types overridden as well (ObjectMapper sub-classed as XmlMappe
   </scm>
   <properties>
     <version.jackson.annotations>2.6.0</version.jackson.annotations>
-    <version.jackson.core>2.6.3</version.jackson.core>
+    <version.jackson.core>2.6.4-SNAPSHOT</version.jackson.core>
     <version.jackson.jaxb>${version.jackson.core}</version.jackson.jaxb>
     <packageVersion.dir>com/fasterxml/jackson/dataformat/xml</packageVersion.dir>
     <packageVersion.package>${project.groupId}.xml</packageVersion.package>
diff --git a/release-notes/CREDITS b/release-notes/CREDITS
index 29a3113e..71db8507 100644
--- a/release-notes/CREDITS
+++ b/release-notes/CREDITS
@@ -20,3 +20,8 @@ Dan Jasek: (oillio@github)
 
 * Contributed #126: Allow specifying properties that should be written as CData
  (2.5.0)
+
+Leo Wang (wanglingsong@github)
+
+* Reported #171: `@JacksonXmlRootElement` malfunction in multi-thread environment
+ (2.6.4)
diff --git a/release-notes/VERSION b/release-notes/VERSION
index 730a264c..915fbf0c 100644
--- a/release-notes/VERSION
+++ b/release-notes/VERSION
@@ -6,6 +6,8 @@ Project: jackson-dataformat-xml
 
 2.6.4 (not yet released)
 
+#171: `@JacksonXmlRootElement` malfunction in multi-thread environment
+ (reported by Leo W)
 #172: XML INDENT_OUTPUT property fails to add newline/indent initial elements
  (reported by rpatrick00@github)
 
diff --git a/src/main/java/com/fasterxml/jackson/dataformat/xml/util/XmlRootNameLookup.java b/src/main/java/com/fasterxml/jackson/dataformat/xml/util/XmlRootNameLookup.java
index 5791e261..c7205ff6 100644
--- a/src/main/java/com/fasterxml/jackson/dataformat/xml/util/XmlRootNameLookup.java
+++ b/src/main/java/com/fasterxml/jackson/dataformat/xml/util/XmlRootNameLookup.java
@@ -52,6 +52,19 @@ public class XmlRootNameLookup
             return name;
         }
 
+        // 06-Dec-2015, tatu: as per [dataformat-xlm#171], need to actually do
+        //    bit more of syncing, unfortunately. Jackson 2.7 should resolve
+        //    the actual problem, but until then...
+        name = _findRootName(rootType, config);
+
+        synchronized (_rootNames) {
+            _rootNames.put(key, name);
+        }
+        return name;
+    }
+    
+    protected synchronized QName _findRootName(Class<?> rootType, MapperConfig<?> config)
+    {
         BeanDescription beanDesc = config.introspectClassAnnotations(rootType);
         AnnotationIntrospector intr = config.getAnnotationIntrospector();
         AnnotatedClass ac = beanDesc.getClassInfo();
@@ -68,21 +81,16 @@ public class XmlRootNameLookup
             // Should we strip out enclosing class tho? For now, nope:
             // one caveat: array simple names end with "[]"; also, "$" needs replacing
             localName = StaxUtil.sanitizeXmlTypeName(rootType.getSimpleName());
-            name = new QName("", localName);
-        } else {
-            // Otherwise let's see if there's namespace, too (if we are missing it)
-            if (ns == null || ns.length() == 0) {
-                ns = findNamespace(intr, ac);
-            }
+            return new QName("", localName);
+        }
+        // Otherwise let's see if there's namespace, too (if we are missing it)
+        if (ns == null || ns.length() == 0) {
+            ns = findNamespace(intr, ac);
         }
         if (ns == null) { // some QName impls barf on nulls...
             ns = "";
         }
-        name = new QName(ns, localName);
-        synchronized (_rootNames) {
-            _rootNames.put(key, name);
-        }
-        return name;
+        return new QName(ns, localName);
     }
 
     private String findNamespace(AnnotationIntrospector ai, AnnotatedClass ann)
diff --git a/src/test/java/com/fasterxml/jackson/dataformat/xml/ManualTest.java b/src/test/java/com/fasterxml/jackson/dataformat/xml/ManualTest.java
new file mode 100644
index 00000000..ccd4a116
--- /dev/null
+++ b/src/test/java/com/fasterxml/jackson/dataformat/xml/ManualTest.java
@@ -0,0 +1,32 @@
+package com.fasterxml.jackson.dataformat.xml;
+
+import com.fasterxml.jackson.core.JsonProcessingException;
+import com.fasterxml.jackson.dataformat.xml.annotation.JacksonXmlRootElement;
+
+public class ManualTest extends XmlTestBase
+{
+
+    @JacksonXmlRootElement(localName = "model")
+    static class TestModel { public int a; }
+
+    public static void main(String[] s) throws Exception {
+
+        final XmlMapper xmlMapper = new XmlMapper();
+
+        for (int i=0;i < 40; i++) {
+            new Thread(new Runnable() {
+                @Override
+                public void run() {
+                    try {
+                        System.out.println(xmlMapper.writeValueAsString(new TestModel()));
+                    } catch (JsonProcessingException e) {
+                        e.printStackTrace();
+                    }
+                }
+            }).start();
+        }
+
+        Thread.sleep(10000L);
+
+    }
+}
diff --git a/src/test/java/com/fasterxml/jackson/dataformat/xml/misc/TextValueTest.java b/src/test/java/com/fasterxml/jackson/dataformat/xml/misc/TextValueTest.java
index 88eb9f6a..ad003e26 100644
--- a/src/test/java/com/fasterxml/jackson/dataformat/xml/misc/TextValueTest.java
+++ b/src/test/java/com/fasterxml/jackson/dataformat/xml/misc/TextValueTest.java
@@ -23,7 +23,7 @@ public class TextValueTest extends XmlTestBase
         public String text = "something";
     }
 	
-    // [Issue#24]
+    // [dataformat-xml#24]
 
     static class Main {
         @JsonProperty("com.test.stack") public Stack stack;
@@ -56,7 +56,7 @@ public class TextValueTest extends XmlTestBase
         public String value;
     }
 
-    // [Issue#66]
+    // [dataformat-xml#66]
     static class Issue66Bean
     {
         @JacksonXmlProperty(isAttribute = true)
@@ -66,7 +66,7 @@ public class TextValueTest extends XmlTestBase
         protected String textValue;
     }
 
-    // [Issue#72]
+    // [dataformat-xml#72]
     
     static class TextOnlyBean
     {
@@ -130,7 +130,7 @@ public class TextValueTest extends XmlTestBase
         assertEquals(TEXT, main.stack.slot.value);
     }
 
-    // for [Issue#36]
+    // for [dataformat-xml#36]
     public void testAlternateTextElementName() throws IOException
     {
         final String XML = "<JAXBStyle>foo</JAXBStyle>";
@@ -148,7 +148,7 @@ public class TextValueTest extends XmlTestBase
         assertEquals("foo", pojo.value);
     }
 
-    // [Issue#66], implicit property from "XmlText"
+    // [dataformat-xml#66], implicit property from "XmlText"
     public void testIssue66() throws Exception
     {
         JacksonXmlModule module = new JacksonXmlModule();
@@ -166,7 +166,7 @@ public class TextValueTest extends XmlTestBase
         assertEquals(XML, json);
     }
 
-    // [Issue#72]
+    // [dataformat-xml#72]
     public void testTextOnlyPojo() throws Exception
     {
         XmlMapper mapper = xmlMapper(true);
