{"url":"https://api.github.com/repos/fastify/fastify/issues/451","repository_url":"https://api.github.com/repos/fastify/fastify","labels_url":"https://api.github.com/repos/fastify/fastify/issues/451/labels{/name}","comments_url":"https://api.github.com/repos/fastify/fastify/issues/451/comments","events_url":"https://api.github.com/repos/fastify/fastify/issues/451/events","html_url":"https://github.com/fastify/fastify/issues/451","id":273021891,"node_id":"MDU6SXNzdWUyNzMwMjE4OTE=","number":451,"title":"setNotFoundHandler is suppressing duplicated routes checking","user":{"login":"tmorell","id":2086227,"node_id":"MDQ6VXNlcjIwODYyMjc=","avatar_url":"https://avatars.githubusercontent.com/u/2086227?v=4","gravatar_id":"","url":"https://api.github.com/users/tmorell","html_url":"https://github.com/tmorell","followers_url":"https://api.github.com/users/tmorell/followers","following_url":"https://api.github.com/users/tmorell/following{/other_user}","gists_url":"https://api.github.com/users/tmorell/gists{/gist_id}","starred_url":"https://api.github.com/users/tmorell/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tmorell/subscriptions","organizations_url":"https://api.github.com/users/tmorell/orgs","repos_url":"https://api.github.com/users/tmorell/repos","events_url":"https://api.github.com/users/tmorell/events{/privacy}","received_events_url":"https://api.github.com/users/tmorell/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":451588686,"node_id":"MDU6TGFiZWw0NTE1ODg2ODY=","url":"https://api.github.com/repos/fastify/fastify/labels/bug","name":"bug","color":"ee0701","default":true,"description":"Confirmed bug"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/fastify/fastify/milestones/1","html_url":"https://github.com/fastify/fastify/milestone/1","labels_url":"https://api.github.com/repos/fastify/fastify/milestones/1/labels","id":2947145,"node_id":"MDk6TWlsZXN0b25lMjk0NzE0NQ==","number":1,"title":"v1.0.0","description":"","creator":{"login":"delvedor","id":4865608,"node_id":"MDQ6VXNlcjQ4NjU2MDg=","avatar_url":"https://avatars.githubusercontent.com/u/4865608?v=4","gravatar_id":"","url":"https://api.github.com/users/delvedor","html_url":"https://github.com/delvedor","followers_url":"https://api.github.com/users/delvedor/followers","following_url":"https://api.github.com/users/delvedor/following{/other_user}","gists_url":"https://api.github.com/users/delvedor/gists{/gist_id}","starred_url":"https://api.github.com/users/delvedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/delvedor/subscriptions","organizations_url":"https://api.github.com/users/delvedor/orgs","repos_url":"https://api.github.com/users/delvedor/repos","events_url":"https://api.github.com/users/delvedor/events{/privacy}","received_events_url":"https://api.github.com/users/delvedor/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":34,"state":"closed","created_at":"2017-11-29T17:01:39Z","updated_at":"2018-06-12T10:05:52Z","due_on":"2018-03-06T08:00:00Z","closed_at":"2018-06-12T10:03:32Z"},"comments":1,"created_at":"2017-11-10T18:35:23Z","updated_at":"2017-11-29T17:02:58Z","closed_at":"2017-11-11T12:18:04Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"When enabling setNotFoundHandler handler, Fastify is not performing a check for duplicated routes. This is an example:\r\n\r\n```javascript\r\nconst fastify = require('fastify')();\r\n\r\n// Declare a route\r\nfastify.get(\"/\", function (request, reply) {\r\n\tconsole.log(\"1\");\r\n\treply.send({});\r\n});\r\nfastify.get(\"/\", function (request, reply) {\r\n\tconsole.log(\"2\");\r\n\treply.send({});\r\n});\r\n\r\nfastify.setNotFoundHandler((req, res) => {\r\n\tconsole.log(\"setNotFoundHandler\");\r\n\tres.code(404).send({\r\n\t\terror: \"Not Found\",\r\n\t\tmessage: `Resource '${req.params[\"*\"]}' was not found`,\r\n\t\tstatusCode: 404\r\n\t});\r\n});\r\n\r\n// Run the server!\r\nfastify.listen(3000, function (error) {\r\n\tif (error) {\r\n\t\tconsole.log(error.message);\r\n\t\treturn;\r\n\t}\r\n\tconsole.log('Fastify app listening on port 3000!');\r\n});\r\n```\r\n\r\nWith setNotFoundHandler enabled I get \"Fastify app listening on port 3000!\", and I get \"1\" in the console.\r\nIt setNotFoundHandler is removed, I get \"GET already set for /\"\r\n\r\nThanks!","closed_by":{"login":"delvedor","id":4865608,"node_id":"MDQ6VXNlcjQ4NjU2MDg=","avatar_url":"https://avatars.githubusercontent.com/u/4865608?v=4","gravatar_id":"","url":"https://api.github.com/users/delvedor","html_url":"https://github.com/delvedor","followers_url":"https://api.github.com/users/delvedor/followers","following_url":"https://api.github.com/users/delvedor/following{/other_user}","gists_url":"https://api.github.com/users/delvedor/gists{/gist_id}","starred_url":"https://api.github.com/users/delvedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/delvedor/subscriptions","organizations_url":"https://api.github.com/users/delvedor/orgs","repos_url":"https://api.github.com/users/delvedor/repos","events_url":"https://api.github.com/users/delvedor/events{/privacy}","received_events_url":"https://api.github.com/users/delvedor/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/fastify/fastify/issues/451/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/fastify/fastify/issues/451/timeline","performed_via_github_app":null,"state_reason":"completed"}