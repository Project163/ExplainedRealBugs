{"url":"https://api.github.com/repos/vuejs/vue/issues/7153","repository_url":"https://api.github.com/repos/vuejs/vue","labels_url":"https://api.github.com/repos/vuejs/vue/issues/7153/labels{/name}","comments_url":"https://api.github.com/repos/vuejs/vue/issues/7153/comments","events_url":"https://api.github.com/repos/vuejs/vue/issues/7153/events","html_url":"https://github.com/vuejs/vue/issues/7153","id":277935866,"node_id":"MDU6SXNzdWUyNzc5MzU4NjY=","number":7153,"title":"Input @keydown class binding - Micro/Macro Task","user":{"login":"EthanDM","id":20825648,"node_id":"MDQ6VXNlcjIwODI1NjQ4","avatar_url":"https://avatars.githubusercontent.com/u/20825648?v=4","gravatar_id":"","url":"https://api.github.com/users/EthanDM","html_url":"https://github.com/EthanDM","followers_url":"https://api.github.com/users/EthanDM/followers","following_url":"https://api.github.com/users/EthanDM/following{/other_user}","gists_url":"https://api.github.com/users/EthanDM/gists{/gist_id}","starred_url":"https://api.github.com/users/EthanDM/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/EthanDM/subscriptions","organizations_url":"https://api.github.com/users/EthanDM/orgs","repos_url":"https://api.github.com/users/EthanDM/repos","events_url":"https://api.github.com/users/EthanDM/events{/privacy}","received_events_url":"https://api.github.com/users/EthanDM/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2017-11-29T22:48:21Z","updated_at":"2017-11-30T15:48:57Z","closed_at":"2017-11-30T15:48:57Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Version\r\n2.5.9\r\n\r\n### Reproduction link\r\n[https://jsfiddle.net/ethandm/21va7wje/](https://jsfiddle.net/ethandm/21va7wje/)\r\n\r\n### Steps to reproduce\r\nEnter a number into the input field. @keydown then fires the keyDwn(e) method, setting this.untouched = false. The green background should be removed on the input field since it has been \"touched.\"\r\n\r\n### What is expected?\r\nThe pressed number should be entered into the input field. Instead, no number is added and it is only after the second press that it is.\r\n\r\nIf the class binding is removed from the input field it has no problem acting as expected, so I don't think it's an issue with @keydown or setting \"this.untouched = false\". In addition, if the class binding is left on and v-model.lazy is set to v-model, it works as expected. However, v-model will not work for my use case.\r\n\r\n### What is actually happening?\r\nThe class binding is set but no number is added to the field as it did in Vue 2.2.6 -> 2.4.4.\r\n\r\nSee here for a reproduction in 2.4.4 and all works as expected with the class binding and v-model.lazy: https://jsfiddle.net/ethandm/8762osgf/\r\n\r\nEDIT: I assume it's related to this release note from v2.5.0:\r\n\r\n> We have changed the implementation of Vue.nextTick to fix a few bugs (related to #6566, #6690). The change involves using a macro task instead of a micro task to defer DOM updates when inside a DOM event handler attached via v-on. This means any Vue updates triggered by state changes inside v-on handlers will be now deferred using a macro task. This may lead to changes in behavior when dealing with native DOM events.\r\n> \r\n> For more details regarding micro/macro tasks, see this blog post.\r\n> \r\n> For the new implementation, see source code for nextTick.\r\n\r\nNow I'm not sure if it's a bug or expected behavior due to the change but will need a solution. Thanks.\r\n\r\n\r\n<!-- generated by vue-issues. DO NOT REMOVE -->","closed_by":{"login":"yyx990803","id":499550,"node_id":"MDQ6VXNlcjQ5OTU1MA==","avatar_url":"https://avatars.githubusercontent.com/u/499550?v=4","gravatar_id":"","url":"https://api.github.com/users/yyx990803","html_url":"https://github.com/yyx990803","followers_url":"https://api.github.com/users/yyx990803/followers","following_url":"https://api.github.com/users/yyx990803/following{/other_user}","gists_url":"https://api.github.com/users/yyx990803/gists{/gist_id}","starred_url":"https://api.github.com/users/yyx990803/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yyx990803/subscriptions","organizations_url":"https://api.github.com/users/yyx990803/orgs","repos_url":"https://api.github.com/users/yyx990803/repos","events_url":"https://api.github.com/users/yyx990803/events{/privacy}","received_events_url":"https://api.github.com/users/yyx990803/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/vuejs/vue/issues/7153/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/vuejs/vue/issues/7153/timeline","performed_via_github_app":null,"state_reason":"completed"}