{"url":"https://api.github.com/repos/vuejs/vue/issues/7223","repository_url":"https://api.github.com/repos/vuejs/vue","labels_url":"https://api.github.com/repos/vuejs/vue/issues/7223/labels{/name}","comments_url":"https://api.github.com/repos/vuejs/vue/issues/7223/comments","events_url":"https://api.github.com/repos/vuejs/vue/issues/7223/events","html_url":"https://github.com/vuejs/vue/issues/7223","id":281224561,"node_id":"MDU6SXNzdWUyODEyMjQ1NjE=","number":7223,"title":"vue-template-compiler double-escaping newlines in _ssrNode text string templates","user":{"login":"felixbuenemann","id":909587,"node_id":"MDQ6VXNlcjkwOTU4Nw==","avatar_url":"https://avatars.githubusercontent.com/u/909587?v=4","gravatar_id":"","url":"https://api.github.com/users/felixbuenemann","html_url":"https://github.com/felixbuenemann","followers_url":"https://api.github.com/users/felixbuenemann/followers","following_url":"https://api.github.com/users/felixbuenemann/following{/other_user}","gists_url":"https://api.github.com/users/felixbuenemann/gists{/gist_id}","starred_url":"https://api.github.com/users/felixbuenemann/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/felixbuenemann/subscriptions","organizations_url":"https://api.github.com/users/felixbuenemann/orgs","repos_url":"https://api.github.com/users/felixbuenemann/repos","events_url":"https://api.github.com/users/felixbuenemann/events{/privacy}","received_events_url":"https://api.github.com/users/felixbuenemann/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":49750488,"node_id":"MDU6TGFiZWw0OTc1MDQ4OA==","url":"https://api.github.com/repos/vuejs/vue/labels/bug","name":"bug","color":"b60205","default":true,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2017-12-12T01:20:35Z","updated_at":"2017-12-12T22:06:12Z","closed_at":"2017-12-12T22:06:12Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Version\r\n2.5.9\r\n\r\n### Reproduction link\r\n[https://gist.github.com/2b3c1a683b334022c626917b0abb2adc](https://gist.github.com/2b3c1a683b334022c626917b0abb2adc)\r\n\r\n(I used a Gist, because ssrCompile is not exposed by the globals build of Vue.)\r\n\r\n### Steps to reproduce\r\n```javascript\r\ncompiler = require('vue-template-compiler')\r\ntemplate = \"<div id=\\\"foo,\\nbar\\\">\\n<textarea id=\\\"foo,\\nbar\\\">foo\\nbar</textarea>\\n</div>\"\r\nresult = compiler.ssrCompile(template)\r\nconsole.log(result.render)\r\n// output: with(this){return _c('div',{attrs:{\"id\":\"foo,\\nbar\"}},[_ssrNode(\"<textarea id=\\\"foo,\\\\nbar\\\">foo\\nbar</textarea>\")])}\r\n```\r\n\r\n### What is expected?\r\nvue-template-compiler should not double-escape newlines in attributes for _ssrNode string templates.\r\n\r\n### What is actually happening?\r\nvue-template-compiler double-escapes newlines in attributes of _ssrNodes.\r\n\r\n---\r\nIf you look at the output from the reproduction steps, you will see that the newline character '\\n' is only double escaped, if it is part of an attribute in an ssrNode, if is nor optimized to a string template and stored in the attrs property, is it fine and other newlines that are outside attributes are also fine.\r\n\r\nThe bug was observed with vue-template-compiler v2.5.9 and node.js v8.9.1.\r\n\r\nWhile the above example seems silly, newlines in attribute are very common when using responsive images, with multiple sizes in the srcset attribute, which are usually broken onto one line per size/url for readability and this is how a colleague of mine ran into this bug, where responsive images were working differently between ssr and rehydration due to the problem, because the browser aborted srcset parsing when finding the \"\\n\" literal string.\r\n\r\n<!-- generated by vue-issues. DO NOT REMOVE -->","closed_by":{"login":"yyx990803","id":499550,"node_id":"MDQ6VXNlcjQ5OTU1MA==","avatar_url":"https://avatars.githubusercontent.com/u/499550?v=4","gravatar_id":"","url":"https://api.github.com/users/yyx990803","html_url":"https://github.com/yyx990803","followers_url":"https://api.github.com/users/yyx990803/followers","following_url":"https://api.github.com/users/yyx990803/following{/other_user}","gists_url":"https://api.github.com/users/yyx990803/gists{/gist_id}","starred_url":"https://api.github.com/users/yyx990803/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yyx990803/subscriptions","organizations_url":"https://api.github.com/users/yyx990803/orgs","repos_url":"https://api.github.com/users/yyx990803/repos","events_url":"https://api.github.com/users/yyx990803/events{/privacy}","received_events_url":"https://api.github.com/users/yyx990803/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/vuejs/vue/issues/7223/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/vuejs/vue/issues/7223/timeline","performed_via_github_app":null,"state_reason":"completed"}