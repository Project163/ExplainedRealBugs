{"url":"https://api.github.com/repos/vuejs/vue/issues/4484","repository_url":"https://api.github.com/repos/vuejs/vue","labels_url":"https://api.github.com/repos/vuejs/vue/issues/4484/labels{/name}","comments_url":"https://api.github.com/repos/vuejs/vue/issues/4484/comments","events_url":"https://api.github.com/repos/vuejs/vue/issues/4484/events","html_url":"https://github.com/vuejs/vue/issues/4484","id":195734818,"node_id":"MDU6SXNzdWUxOTU3MzQ4MTg=","number":4484,"title":"node with v-show inside v-if is reused in the adjacent v-else","user":{"login":"dolymood","id":2121554,"node_id":"MDQ6VXNlcjIxMjE1NTQ=","avatar_url":"https://avatars.githubusercontent.com/u/2121554?v=4","gravatar_id":"","url":"https://api.github.com/users/dolymood","html_url":"https://github.com/dolymood","followers_url":"https://api.github.com/users/dolymood/followers","following_url":"https://api.github.com/users/dolymood/following{/other_user}","gists_url":"https://api.github.com/users/dolymood/gists{/gist_id}","starred_url":"https://api.github.com/users/dolymood/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dolymood/subscriptions","organizations_url":"https://api.github.com/users/dolymood/orgs","repos_url":"https://api.github.com/users/dolymood/repos","events_url":"https://api.github.com/users/dolymood/events{/privacy}","received_events_url":"https://api.github.com/users/dolymood/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":49750488,"node_id":"MDU6TGFiZWw0OTc1MDQ4OA==","url":"https://api.github.com/repos/vuejs/vue/labels/bug","name":"bug","color":"b60205","default":true,"description":null}],"state":"closed","locked":false,"assignee":{"login":"defcc","id":2603918,"node_id":"MDQ6VXNlcjI2MDM5MTg=","avatar_url":"https://avatars.githubusercontent.com/u/2603918?v=4","gravatar_id":"","url":"https://api.github.com/users/defcc","html_url":"https://github.com/defcc","followers_url":"https://api.github.com/users/defcc/followers","following_url":"https://api.github.com/users/defcc/following{/other_user}","gists_url":"https://api.github.com/users/defcc/gists{/gist_id}","starred_url":"https://api.github.com/users/defcc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/defcc/subscriptions","organizations_url":"https://api.github.com/users/defcc/orgs","repos_url":"https://api.github.com/users/defcc/repos","events_url":"https://api.github.com/users/defcc/events{/privacy}","received_events_url":"https://api.github.com/users/defcc/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"defcc","id":2603918,"node_id":"MDQ6VXNlcjI2MDM5MTg=","avatar_url":"https://avatars.githubusercontent.com/u/2603918?v=4","gravatar_id":"","url":"https://api.github.com/users/defcc","html_url":"https://github.com/defcc","followers_url":"https://api.github.com/users/defcc/followers","following_url":"https://api.github.com/users/defcc/following{/other_user}","gists_url":"https://api.github.com/users/defcc/gists{/gist_id}","starred_url":"https://api.github.com/users/defcc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/defcc/subscriptions","organizations_url":"https://api.github.com/users/defcc/orgs","repos_url":"https://api.github.com/users/defcc/repos","events_url":"https://api.github.com/users/defcc/events{/privacy}","received_events_url":"https://api.github.com/users/defcc/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":null,"comments":2,"created_at":"2016-12-15T07:25:26Z","updated_at":"2016-12-23T03:33:34Z","closed_at":"2016-12-21T21:08:48Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Vue.js version\r\n2.1.6\r\n\r\n### Reproduction Link\r\n\r\nhttp://codepen.io/dolymood/pen/gLQmwy\r\n\r\n### Steps to reproduce\r\n\r\nCode\r\n\r\n```html\r\n<div class=\"el el-if\" v-if=\"bln\"><span v-show=\"false\">hidden content</span></div>\r\n<div class=\"el el-else\" v-else><span @click=\"toggle\">visible  content</span></div>\r\n```\r\n\r\n1. `bln=true`, the `span` element in `el-if` is hidden\r\n\r\n2. `bln=false`, the `span` element in `el-else` is __hidden__\r\n\r\n### What is Expected?\r\n\r\nWhen `bln=false`, the `span` element should be __visible__\r\n\r\n### What is actually happening?\r\n\r\n`patchVnode` will check the nodes is same:\r\n\r\n```js\r\nfunction sameVnode (vnode1, vnode2) {\r\n  return (\r\n    vnode1.key === vnode2.key &&\r\n    vnode1.tag === vnode2.tag &&\r\n    vnode1.isComment === vnode2.isComment &&\r\n    !vnode1.data === !vnode2.data\r\n  )\r\n}\r\n```\r\n\r\nBecause the old vnode `vnode1.data` is \r\n\r\n```js\r\n{\r\n  directives: [{\r\n     def: {bind: fn, update: fn}\r\n     expression: \"false\"\r\n     modifiers: {},\r\n     name: \"show\",\r\n     rawName: \"v-show\",\r\n     value: false\r\n  }]\r\n}\r\n```\r\n\r\nand the new vnode `vnode2.data` is\r\n\r\n```js\r\n{\r\n  on: {click: fn}\r\n}\r\n```\r\n\r\nSo `sameVnode(span1, span2)` result  is `true`, but `updateDirectives` will be call `v-show` directive's `unbind` hook function.\r\n\r\nIf the `span` elements have different `key` attributes, the result will be correct. But i think it will be better if:\r\n\r\n> When `bln=false`, the `span` element should be __visible__\r\n\r\n","closed_by":{"login":"yyx990803","id":499550,"node_id":"MDQ6VXNlcjQ5OTU1MA==","avatar_url":"https://avatars.githubusercontent.com/u/499550?v=4","gravatar_id":"","url":"https://api.github.com/users/yyx990803","html_url":"https://github.com/yyx990803","followers_url":"https://api.github.com/users/yyx990803/followers","following_url":"https://api.github.com/users/yyx990803/following{/other_user}","gists_url":"https://api.github.com/users/yyx990803/gists{/gist_id}","starred_url":"https://api.github.com/users/yyx990803/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yyx990803/subscriptions","organizations_url":"https://api.github.com/users/yyx990803/orgs","repos_url":"https://api.github.com/users/yyx990803/repos","events_url":"https://api.github.com/users/yyx990803/events{/privacy}","received_events_url":"https://api.github.com/users/yyx990803/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/vuejs/vue/issues/4484/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/vuejs/vue/issues/4484/timeline","performed_via_github_app":null,"state_reason":"completed"}