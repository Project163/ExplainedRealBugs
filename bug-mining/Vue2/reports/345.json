{"url":"https://api.github.com/repos/vuejs/vue/issues/8567","repository_url":"https://api.github.com/repos/vuejs/vue","labels_url":"https://api.github.com/repos/vuejs/vue/issues/8567/labels{/name}","comments_url":"https://api.github.com/repos/vuejs/vue/issues/8567/comments","events_url":"https://api.github.com/repos/vuejs/vue/issues/8567/events","html_url":"https://github.com/vuejs/vue/issues/8567","id":345343846,"node_id":"MDU6SXNzdWUzNDUzNDM4NDY=","number":8567,"title":"Immediate watcher skips parent(s) errorCaptured and jumps straight to the top error handler","user":{"login":"michaelfelixmurphy","id":5606909,"node_id":"MDQ6VXNlcjU2MDY5MDk=","avatar_url":"https://avatars.githubusercontent.com/u/5606909?v=4","gravatar_id":"","url":"https://api.github.com/users/michaelfelixmurphy","html_url":"https://github.com/michaelfelixmurphy","followers_url":"https://api.github.com/users/michaelfelixmurphy/followers","following_url":"https://api.github.com/users/michaelfelixmurphy/following{/other_user}","gists_url":"https://api.github.com/users/michaelfelixmurphy/gists{/gist_id}","starred_url":"https://api.github.com/users/michaelfelixmurphy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/michaelfelixmurphy/subscriptions","organizations_url":"https://api.github.com/users/michaelfelixmurphy/orgs","repos_url":"https://api.github.com/users/michaelfelixmurphy/repos","events_url":"https://api.github.com/users/michaelfelixmurphy/events{/privacy}","received_events_url":"https://api.github.com/users/michaelfelixmurphy/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":49750488,"node_id":"MDU6TGFiZWw0OTc1MDQ4OA==","url":"https://api.github.com/repos/vuejs/vue/labels/bug","name":"bug","color":"b60205","default":true,"description":null},{"id":863458406,"node_id":"MDU6TGFiZWw4NjM0NTg0MDY=","url":"https://api.github.com/repos/vuejs/vue/labels/has%20PR","name":"has PR","color":"5319e7","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2018-07-27T19:39:13Z","updated_at":"2018-11-29T23:14:29Z","closed_at":"2018-11-29T23:14:29Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Version\r\n2.5.16\r\n\r\n### Reproduction link\r\n[https://codesandbox.io/s/wkpy6x5r25](https://codesandbox.io/s/wkpy6x5r25)\r\n\r\n### Steps to reproduce\r\nSimply opening and running the sandbox should show the error. Instead of getting an alert that App.vue caught the error in HelloWorld's watcher, the error escapes all the way to the top level. To see the expected behavior, open Hello World and set the watcher to immediate: false. Then hit the button to trigger the watcher. In this case the error is caught by the parent, App.vue. In the immediate case, this does not happen.\r\n\r\n### What is expected?\r\nErrors in immediate watchers should be caught by the parent component(s)'s errorCaptured().\r\n\r\n### What is actually happening?\r\nThe error escapes to the nextTick hander. This handler has no ctx or vm to pass to the errorHandler. When errorHandler does not receive a vm, it cannot call the parent errorCaptured handlers.\r\n\r\n---\r\nThis appears to be an oversight in src/core/instance/state.js. In the case options.immediate is true, cb.call(vm, watcher.value) should be wrapped in a try catch that explicitly calls handleError with the vm.\r\n\r\nA proposed fix:\r\n```\r\n    if (options.immediate) {\r\n      try {\r\n        cb.call(vm, watcher.value)\r\n      } catch (e) {\r\n        handleError(e, vm, `immediate call for watcher ${watcher.expression}`)\r\n      }\r\n    }\r\n```\r\n\r\n<!-- generated by vue-issues. DO NOT REMOVE -->","closed_by":{"login":"yyx990803","id":499550,"node_id":"MDQ6VXNlcjQ5OTU1MA==","avatar_url":"https://avatars.githubusercontent.com/u/499550?v=4","gravatar_id":"","url":"https://api.github.com/users/yyx990803","html_url":"https://github.com/yyx990803","followers_url":"https://api.github.com/users/yyx990803/followers","following_url":"https://api.github.com/users/yyx990803/following{/other_user}","gists_url":"https://api.github.com/users/yyx990803/gists{/gist_id}","starred_url":"https://api.github.com/users/yyx990803/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yyx990803/subscriptions","organizations_url":"https://api.github.com/users/yyx990803/orgs","repos_url":"https://api.github.com/users/yyx990803/repos","events_url":"https://api.github.com/users/yyx990803/events{/privacy}","received_events_url":"https://api.github.com/users/yyx990803/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/vuejs/vue/issues/8567/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/vuejs/vue/issues/8567/timeline","performed_via_github_app":null,"state_reason":"completed"}