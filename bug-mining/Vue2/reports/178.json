{"url":"https://api.github.com/repos/vuejs/vue/issues/5055","repository_url":"https://api.github.com/repos/vuejs/vue","labels_url":"https://api.github.com/repos/vuejs/vue/issues/5055/labels{/name}","comments_url":"https://api.github.com/repos/vuejs/vue/issues/5055/comments","events_url":"https://api.github.com/repos/vuejs/vue/issues/5055/events","html_url":"https://github.com/vuejs/vue/issues/5055","id":211201578,"node_id":"MDU6SXNzdWUyMTEyMDE1Nzg=","number":5055,"title":"Circular object values crash <select> update","user":{"login":"Tamschi","id":715360,"node_id":"MDQ6VXNlcjcxNTM2MA==","avatar_url":"https://avatars.githubusercontent.com/u/715360?v=4","gravatar_id":"","url":"https://api.github.com/users/Tamschi","html_url":"https://github.com/Tamschi","followers_url":"https://api.github.com/users/Tamschi/followers","following_url":"https://api.github.com/users/Tamschi/following{/other_user}","gists_url":"https://api.github.com/users/Tamschi/gists{/gist_id}","starred_url":"https://api.github.com/users/Tamschi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Tamschi/subscriptions","organizations_url":"https://api.github.com/users/Tamschi/orgs","repos_url":"https://api.github.com/users/Tamschi/repos","events_url":"https://api.github.com/users/Tamschi/events{/privacy}","received_events_url":"https://api.github.com/users/Tamschi/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2017-03-01T20:40:32Z","updated_at":"2017-03-03T09:34:18Z","closed_at":"2017-03-03T02:49:19Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Vue.js version\r\n2.2.1\r\n\r\n### Reproduction Link\r\nhttps://jsfiddle.net/Tamschi/6q4Ljk0j/\r\n\r\n### Steps to reproduce\r\nCreate a vue-backed `<select>` element that satisfies the following conditions:\r\n- The selected value is an `object`.\r\n- At least one `<option>` has an `object` value.\r\n- At least one of these instances leads to a circular reference and does not appear only after a value that loosely equals the selected value in the option list.\r\n\r\n### What is Expected?\r\nThe Vue.js app should select the right option and avoid a crash.\r\n\r\n### What is actually happening?\r\nThe app crashes with\r\n```\r\nUncaught TypeError: Converting circular structure to JSON\r\n    at JSON.stringify (<anonymous>)\r\n    at looseEqual (vue@2.2.1:225)\r\n    at setSelected (vue@2.2.1:6674)\r\n    at cb (vue@2.2.1:6616)\r\n    at inserted (vue@2.2.1:6618)\r\n    at callHook$1 (vue@2.2.1:5102)\r\n    at callInsert (vue@2.2.1:5045)\r\n    at wrappedHook (vue@2.2.1:1690)\r\n    at Object.invoker [as insert] (vue@2.2.1:1637)\r\n    at invokeInsertHook (vue@2.2.1:4828)\r\n\r\nlooseEqual\t@\tvue@2.2.1:225\r\nsetSelected\t@\tvue@2.2.1:6674\r\ncb\t@\tvue@2.2.1:6616\r\ninserted\t@\tvue@2.2.1:6618\r\ncallHook$1\t@\tvue@2.2.1:5102\r\ncallInsert\t@\tvue@2.2.1:5045\r\nwrappedHook\t@\tvue@2.2.1:1690\r\ninvoker\t@\tvue@2.2.1:1637\r\ninvokeInsertHook\t@\tvue@2.2.1:4828\r\npatch\t@\tvue@2.2.1:4992\r\nVue._update\t@\tvue@2.2.1:1994\r\nupdateComponent\t@\tvue@2.2.1:2104\r\nget\t@\tvue@2.2.1:2417\r\nWatcher\t@\tvue@2.2.1:2400\r\nmountComponent\t@\tvue@2.2.1:2114\r\nVue$3.$mount\t@\tvue@2.2.1:7153\r\nVue$3.$mount\t@\tvue@2.2.1:9154\r\nVue._init\t@\tvue@2.2.1:3652\r\nVue$3\t@\tvue@2.2.1:3733\r\nwindow.onload\t@\t(index):48\r\n```\r\nin Chrome and\r\n```\r\nTypeError: cyclic object value 1 vue:225:12\r\n\tlooseEqual https://unpkg.com/vue:225:12\r\n\tsetSelected https://unpkg.com/vue:6674:11\r\n\tinserted/cb https://unpkg.com/vue:6616:9\r\n\tinserted https://unpkg.com/vue:6618:7\r\n\tcallHook$1 https://unpkg.com/vue:5102:5\r\n\t_update/callInsert https://unpkg.com/vue:5045:9\r\n\twrappedHook https://unpkg.com/vue:1690:5\r\n\tinvoker https://unpkg.com/vue:1637:9\r\n\tinvokeInsertHook https://unpkg.com/vue:4828:9\r\n\tpatch https://unpkg.com/vue:4992:5\r\n\tlifecycleMixin/Vue.prototype._update https://unpkg.com/vue:1994:16\r\n\tmountComponent/updateComponent https://unpkg.com/vue:2104:7\r\n\tget https://unpkg.com/vue:2417:13\r\n\tWatcher https://unpkg.com/vue:2400:7\r\n\tmountComponent https://unpkg.com/vue:2114:17\r\n\tVue$3.prototype.$mount https://unpkg.com/vue:7153:10\r\n\tVue$3.prototype.$mount https://unpkg.com/vue:9154:10\r\n\tinitMixin/Vue.prototype._init https://unpkg.com/vue:3652:7\r\n\tVue$3 https://unpkg.com/vue:3733:3\r\n\twindow.onload https://fiddle.jshell.net/Tamschi/6q4Ljk0j/show/:48:1\r\n```\r\nin Firefox. (I thought I'd include both traces since they contain slightly different information.)","closed_by":{"login":"yyx990803","id":499550,"node_id":"MDQ6VXNlcjQ5OTU1MA==","avatar_url":"https://avatars.githubusercontent.com/u/499550?v=4","gravatar_id":"","url":"https://api.github.com/users/yyx990803","html_url":"https://github.com/yyx990803","followers_url":"https://api.github.com/users/yyx990803/followers","following_url":"https://api.github.com/users/yyx990803/following{/other_user}","gists_url":"https://api.github.com/users/yyx990803/gists{/gist_id}","starred_url":"https://api.github.com/users/yyx990803/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yyx990803/subscriptions","organizations_url":"https://api.github.com/users/yyx990803/orgs","repos_url":"https://api.github.com/users/yyx990803/repos","events_url":"https://api.github.com/users/yyx990803/events{/privacy}","received_events_url":"https://api.github.com/users/yyx990803/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/vuejs/vue/issues/5055/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/vuejs/vue/issues/5055/timeline","performed_via_github_app":null,"state_reason":"completed"}