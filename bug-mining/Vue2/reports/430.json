{"url":"https://api.github.com/repos/vuejs/vue/issues/12615","repository_url":"https://api.github.com/repos/vuejs/vue","labels_url":"https://api.github.com/repos/vuejs/vue/issues/12615/labels{/name}","comments_url":"https://api.github.com/repos/vuejs/vue/issues/12615/comments","events_url":"https://api.github.com/repos/vuejs/vue/issues/12615/events","html_url":"https://github.com/vuejs/vue/issues/12615","id":1294658619,"node_id":"I_kwDOALL9ps5NKuw7","number":12615,"title":"Setting the value of reactive property in SSR overwrites the reactive property with the plain JS value","user":{"login":"lwansbrough","id":186674,"node_id":"MDQ6VXNlcjE4NjY3NA==","avatar_url":"https://avatars.githubusercontent.com/u/186674?v=4","gravatar_id":"","url":"https://api.github.com/users/lwansbrough","html_url":"https://github.com/lwansbrough","followers_url":"https://api.github.com/users/lwansbrough/followers","following_url":"https://api.github.com/users/lwansbrough/following{/other_user}","gists_url":"https://api.github.com/users/lwansbrough/gists{/gist_id}","starred_url":"https://api.github.com/users/lwansbrough/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lwansbrough/subscriptions","organizations_url":"https://api.github.com/users/lwansbrough/orgs","repos_url":"https://api.github.com/users/lwansbrough/repos","events_url":"https://api.github.com/users/lwansbrough/events{/privacy}","received_events_url":"https://api.github.com/users/lwansbrough/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":79873474,"node_id":"MDU6TGFiZWw3OTg3MzQ3NA==","url":"https://api.github.com/repos/vuejs/vue/labels/need%20repro","name":"need repro","color":"eb6420","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2022-07-05T18:59:00Z","updated_at":"2022-07-06T05:17:54Z","closed_at":"2022-07-06T04:50:10Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Version\r\nVue 2.7.2\r\nNode.js 16\r\n\r\n### Reproduction link\r\n[stackblitz.com](https://stackblitz.com/edit/vite-vue2-xcr4jb?file=src/store/site.js)\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n### Steps to reproduce\r\nI'm using the following Pinia store. All that's happening here is the state is being set to a value. According to Pinia's docs, this should work just fine. And indeed it does _in the browser._\r\n\r\n```\r\nimport serialize from 'serialize-javascript'\r\n\r\nexport const useSiteStore = defineStore('site', {\r\n  state: () => ({\r\n    domain: null\r\n  }),\r\n  actions: {\r\n    async setSite(domain) {\r\n      console.log(serialize(this.domain)) // { \"value\": null }\r\n      this.domain = domain\r\n      console.log(serialize(this.domain)) // \"example.com\"\r\n    }\r\n  }\r\n})\r\n```\r\n\r\n### What is expected?\r\nThe console.log outputs should match _in structure_ with just the value having changed. I'm unsure whether it should be an object returned or strictly just the value, but it should be the same for both. (The browsers return `null` and then `\"example.com\"`). `this.domain` should be updated reactively.\r\n\r\n### What is actually happening?\r\nWhen `this.domain = domain` is executed, the reactive reference or whatever you'd call it is _overwritten and replaced_ by a plain JS string. The result is that `this.domain` is no longer reactive. It's worth noting that the above code works perfectly in Chrome/Firefox. It only fails during SSR. As a result Node.js is outputting `[Vue warn]: toRefs() expects a reactive object but received a plain one.`\r\n\r\n---\r\nI initially filed this issue with the Pinia team, but they don't seem convinced that this is a Pinia issue. https://github.com/vuejs/pinia/discussions/1425\r\n\r\n<!-- generated by vue-issues. DO NOT REMOVE -->","closed_by":{"login":"yyx990803","id":499550,"node_id":"MDQ6VXNlcjQ5OTU1MA==","avatar_url":"https://avatars.githubusercontent.com/u/499550?v=4","gravatar_id":"","url":"https://api.github.com/users/yyx990803","html_url":"https://github.com/yyx990803","followers_url":"https://api.github.com/users/yyx990803/followers","following_url":"https://api.github.com/users/yyx990803/following{/other_user}","gists_url":"https://api.github.com/users/yyx990803/gists{/gist_id}","starred_url":"https://api.github.com/users/yyx990803/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yyx990803/subscriptions","organizations_url":"https://api.github.com/users/yyx990803/orgs","repos_url":"https://api.github.com/users/yyx990803/repos","events_url":"https://api.github.com/users/yyx990803/events{/privacy}","received_events_url":"https://api.github.com/users/yyx990803/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/vuejs/vue/issues/12615/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/vuejs/vue/issues/12615/timeline","performed_via_github_app":null,"state_reason":"completed"}