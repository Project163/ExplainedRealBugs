{"url":"https://api.github.com/repos/vuejs/vue/issues/12799","repository_url":"https://api.github.com/repos/vuejs/vue","labels_url":"https://api.github.com/repos/vuejs/vue/issues/12799/labels{/name}","comments_url":"https://api.github.com/repos/vuejs/vue/issues/12799/comments","events_url":"https://api.github.com/repos/vuejs/vue/issues/12799/events","html_url":"https://github.com/vuejs/vue/issues/12799","id":1380557459,"node_id":"I_kwDOALL9ps5SSaKT","number":12799,"title":"[2.7.10] readonly on frozen object causing TypeError: Cannot define property __v_rawToReadonly","user":{"login":"xiaxzp","id":16774502,"node_id":"MDQ6VXNlcjE2Nzc0NTAy","avatar_url":"https://avatars.githubusercontent.com/u/16774502?v=4","gravatar_id":"","url":"https://api.github.com/users/xiaxzp","html_url":"https://github.com/xiaxzp","followers_url":"https://api.github.com/users/xiaxzp/followers","following_url":"https://api.github.com/users/xiaxzp/following{/other_user}","gists_url":"https://api.github.com/users/xiaxzp/gists{/gist_id}","starred_url":"https://api.github.com/users/xiaxzp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xiaxzp/subscriptions","organizations_url":"https://api.github.com/users/xiaxzp/orgs","repos_url":"https://api.github.com/users/xiaxzp/repos","events_url":"https://api.github.com/users/xiaxzp/events{/privacy}","received_events_url":"https://api.github.com/users/xiaxzp/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2022-09-21T08:42:37Z","updated_at":"2022-10-11T04:26:39Z","closed_at":"2022-10-11T04:26:39Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Version\r\n2.7.10\r\n\r\n### Reproduction link\r\n[codesandbox.io](https://codesandbox.io/s/vue-2-7-v-rawtoreadonly-demo-10ix10?file=/src/App.vue)\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n### Steps to reproduce\r\nreason:\r\nReadonly function sets new property on object recursively. This may cause this error when meeting frozen variables. Of course this error can also happen when using readonly directly on frozen objects.\r\n\r\n\r\n#### code:\r\n` import { readonly } from 'vue';`\r\n`const test = {`\r\n`  variable: { tp: 1 },`\r\n`}`\r\n`Object.freeze(test.variable);`\r\n`const readonlyTest = readonly(test);`\r\n\r\n`export default {`\r\n`  name: \"App\",`\r\n`  setup() {`\r\n`    const { variable } = readonlyTest;`\r\n`    return {`\r\n`      variable,`\r\n`    }`\r\n`  },`\r\n`}; `\r\n\r\n### What is expected?\r\ngo well\r\n\r\n### What is actually happening?\r\n[Vue warn]: Error in setup: \"TypeError: Cannot define property __v_rawToReadonly, object is not extensible\"\r\nTypeError: Cannot define property __v_rawToReadonly, object is not extensible\r\n\r\n\r\n---\r\n\r\nsolvement:\r\nhttps://github.com/vuejs/vue/pull/12798\r\nThis fix can simply solve the issue by checking the extensibility of target, and keep the temp proxy at the same time, but leaving existing proxy cache useless.\r\nThe main reason is the \"isReadonly\" judgement, but it's difficult to change this basic feature, and the frozen target may still contain not frozen things? As this case may happen rarely, this fix is enough now and willing for future improvements.\r\n\r\n<!-- generated by vue-issues. DO NOT REMOVE -->","closed_by":{"login":"yyx990803","id":499550,"node_id":"MDQ6VXNlcjQ5OTU1MA==","avatar_url":"https://avatars.githubusercontent.com/u/499550?v=4","gravatar_id":"","url":"https://api.github.com/users/yyx990803","html_url":"https://github.com/yyx990803","followers_url":"https://api.github.com/users/yyx990803/followers","following_url":"https://api.github.com/users/yyx990803/following{/other_user}","gists_url":"https://api.github.com/users/yyx990803/gists{/gist_id}","starred_url":"https://api.github.com/users/yyx990803/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yyx990803/subscriptions","organizations_url":"https://api.github.com/users/yyx990803/orgs","repos_url":"https://api.github.com/users/yyx990803/repos","events_url":"https://api.github.com/users/yyx990803/events{/privacy}","received_events_url":"https://api.github.com/users/yyx990803/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/vuejs/vue/issues/12799/reactions","total_count":3,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":1},"timeline_url":"https://api.github.com/repos/vuejs/vue/issues/12799/timeline","performed_via_github_app":null,"state_reason":"completed"}