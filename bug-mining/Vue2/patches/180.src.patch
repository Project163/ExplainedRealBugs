diff --git a/src/compiler/codegen/events.js b/src/compiler/codegen/events.js
index 3d80d8ad..ce0ae289 100644
--- a/src/compiler/codegen/events.js
+++ b/src/compiler/codegen/events.js
@@ -48,12 +48,19 @@ function genHandler (
 ): string {
   if (!handler) {
     return 'function(){}'
-  } else if (Array.isArray(handler)) {
+  }
+
+  if (Array.isArray(handler)) {
     return `[${handler.map(handler => genHandler(name, handler)).join(',')}]`
-  } else if (!handler.modifiers) {
-    return fnExpRE.test(handler.value) || simplePathRE.test(handler.value)
+  }
+
+  const isMethodPath = simplePathRE.test(handler.value)
+  const isFunctionExpression = fnExpRE.test(handler.value)
+
+  if (!handler.modifiers) {
+    return isMethodPath || isFunctionExpression
       ? handler.value
-      : `function($event){${handler.value}}`
+      : `function($event){${handler.value}}` // inline statement
   } else {
     let code = ''
     const keys = []
@@ -71,9 +78,11 @@ function genHandler (
     if (keys.length) {
       code += genKeyFilter(keys)
     }
-    const handlerCode = simplePathRE.test(handler.value)
+    const handlerCode = isMethodPath
       ? handler.value + '($event)'
-      : handler.value
+      : isFunctionExpression
+        ? `(${handler.value})($event)`
+        : handler.value
     return `function($event){${code}${handlerCode}}`
   }
 }
diff --git a/src/compiler/codegen/index.js b/src/compiler/codegen/index.js
index 9fd910e2..71619040 100644
--- a/src/compiler/codegen/index.js
+++ b/src/compiler/codegen/index.js
@@ -40,6 +40,7 @@ export function generate (
   const code = ast ? genElement(ast) : '_c("div")'
   staticRenderFns = prevStaticRenderFns
   onceCount = prevOnceCount
+  console.log(code)
   return {
     render: `with(this){return ${code}}`,
     staticRenderFns: currentStaticRenderFns
diff --git a/test/unit/modules/compiler/codegen.spec.js b/test/unit/modules/compiler/codegen.spec.js
index 290185c7..0fea71a0 100644
--- a/test/unit/modules/compiler/codegen.spec.js
+++ b/test/unit/modules/compiler/codegen.spec.js
@@ -360,6 +360,11 @@ describe('codegen', () => {
       '<input @input="e=>current++">',
       `with(this){return _c('input',{on:{"input":e=>current++}})}`
     )
+    // with modifiers
+    assertCodegen(
+      `<input @keyup.enter="e=>current++">`,
+      `with(this){return _c('input',{on:{"keyup":function($event){if(!('button' in $event)&&_k($event.keyCode,"enter",13))return null;(e=>current++)($event)}}})}`
+    )
   })
 
   // #3893
