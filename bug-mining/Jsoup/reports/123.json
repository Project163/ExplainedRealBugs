{"url":"https://api.github.com/repos/jhy/jsoup/issues/618","repository_url":"https://api.github.com/repos/jhy/jsoup","labels_url":"https://api.github.com/repos/jhy/jsoup/issues/618/labels{/name}","comments_url":"https://api.github.com/repos/jhy/jsoup/issues/618/comments","events_url":"https://api.github.com/repos/jhy/jsoup/issues/618/events","html_url":"https://github.com/jhy/jsoup/issues/618","id":103467854,"node_id":"MDU6SXNzdWUxMDM0Njc4NTQ=","number":618,"title":"A small bug for duplicate tuple in response header","user":{"login":"ruokunan","id":9259210,"node_id":"MDQ6VXNlcjkyNTkyMTA=","avatar_url":"https://avatars.githubusercontent.com/u/9259210?v=4","gravatar_id":"","url":"https://api.github.com/users/ruokunan","html_url":"https://github.com/ruokunan","followers_url":"https://api.github.com/users/ruokunan/followers","following_url":"https://api.github.com/users/ruokunan/following{/other_user}","gists_url":"https://api.github.com/users/ruokunan/gists{/gist_id}","starred_url":"https://api.github.com/users/ruokunan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ruokunan/subscriptions","organizations_url":"https://api.github.com/users/ruokunan/orgs","repos_url":"https://api.github.com/users/ruokunan/repos","events_url":"https://api.github.com/users/ruokunan/events{/privacy}","received_events_url":"https://api.github.com/users/ruokunan/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/jhy/jsoup/milestones/8","html_url":"https://github.com/jhy/jsoup/milestone/8","labels_url":"https://api.github.com/repos/jhy/jsoup/milestones/8/labels","id":1682735,"node_id":"MDk6TWlsZXN0b25lMTY4MjczNQ==","number":8,"title":"1.9.1","description":"http://jsoup.org/news/release-1.9.1","creator":{"login":"jhy","id":76934,"node_id":"MDQ6VXNlcjc2OTM0","avatar_url":"https://avatars.githubusercontent.com/u/76934?v=4","gravatar_id":"","url":"https://api.github.com/users/jhy","html_url":"https://github.com/jhy","followers_url":"https://api.github.com/users/jhy/followers","following_url":"https://api.github.com/users/jhy/following{/other_user}","gists_url":"https://api.github.com/users/jhy/gists{/gist_id}","starred_url":"https://api.github.com/users/jhy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jhy/subscriptions","organizations_url":"https://api.github.com/users/jhy/orgs","repos_url":"https://api.github.com/users/jhy/repos","events_url":"https://api.github.com/users/jhy/events{/privacy}","received_events_url":"https://api.github.com/users/jhy/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":14,"state":"closed","created_at":"2016-04-04T18:37:21Z","updated_at":"2016-04-18T02:30:47Z","due_on":"2016-04-16T07:00:00Z","closed_at":"2016-04-18T02:30:47Z"},"comments":2,"created_at":"2015-08-27T09:32:49Z","updated_at":"2016-04-05T19:06:30Z","closed_at":"2015-08-30T22:47:52Z","author_association":"NONE","active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"for response headers have duplicate tuple，\nin this case\nX-Powered-By:PHP/5.2.8\nX-Powered-By:ASP.NET\n\nJsoup can only get the second one\nif I run header（“X-powered-by”） \nI got Asp.NET\n\nURL：http://01pt.com/\n\nCache-Control:no-store, no-cache, must-revalidate, post-check=0, pre-check=0\nContent-Encoding:gzip\nContent-Length:16224\nContent-Type:text/html;charset=gb2312\nDate:Thu, 27 Aug 2015 09:22:40 GMT\nExpires:Thu, 19 Nov 1981 08:52:00 GMT\nPragma:no-cache\nServer:Microsoft-IIS/7.5\nVary:Accept-Encoding\nX-Powered-By:PHP/5.2.8\nX-Powered-By:ASP.NET\n\nThe bug is because \nif (!values.isEmpty()) header(name, values.get(0));\n\nI change it to\n                 if (!values.isEmpty()) {\n                        String val = \"\";\n                        for(String str: values) {\n                          val = val.concat(str).concat(\" \");\n\n```\n                    }\n                    header(name, val);\n              }\n```\n\nthen I am able to get “PHP/5.2.8 ASP.NET” when I run header（“X-powered-by”）\n\n void processResponseHeaders(Map<String, List<String>> resHeaders) {\n            for (Map.Entry<String, List<String>> entry : resHeaders.entrySet()) {\n                String name = entry.getKey();\n                if (name == null)\n                    continue; // http/1.1 line\n\n```\n            List<String> values = entry.getValue();\n            if (name.equalsIgnoreCase(\"Set-Cookie\")) {\n                for (String value : values) {\n                    if (value == null)\n                        continue;\n                    TokenQueue cd = new TokenQueue(value);\n                    String cookieName = cd.chompTo(\"=\").trim();\n                    String cookieVal = cd.consumeTo(\";\").trim();\n                    // ignores path, date, domain, validateTLSCertificates et al. req'd?\n                    // name not blank, value not null\n                    if (cookieName.length() > 0)\n                        cookie(cookieName, cookieVal);\n                }\n            } else { // only take the first instance of each header\n                if (!values.isEmpty())\n                    header(name, values.get(0));\n            }\n        }\n    }\n```\n","closed_by":{"login":"jhy","id":76934,"node_id":"MDQ6VXNlcjc2OTM0","avatar_url":"https://avatars.githubusercontent.com/u/76934?v=4","gravatar_id":"","url":"https://api.github.com/users/jhy","html_url":"https://github.com/jhy","followers_url":"https://api.github.com/users/jhy/followers","following_url":"https://api.github.com/users/jhy/following{/other_user}","gists_url":"https://api.github.com/users/jhy/gists{/gist_id}","starred_url":"https://api.github.com/users/jhy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jhy/subscriptions","organizations_url":"https://api.github.com/users/jhy/orgs","repos_url":"https://api.github.com/users/jhy/repos","events_url":"https://api.github.com/users/jhy/events{/privacy}","received_events_url":"https://api.github.com/users/jhy/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/jhy/jsoup/issues/618/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/jhy/jsoup/issues/618/timeline","performed_via_github_app":null,"state_reason":"completed"}