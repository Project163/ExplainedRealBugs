{"url":"https://api.github.com/repos/jhy/jsoup/issues/2140","repository_url":"https://api.github.com/repos/jhy/jsoup","labels_url":"https://api.github.com/repos/jhy/jsoup/issues/2140/labels{/name}","comments_url":"https://api.github.com/repos/jhy/jsoup/issues/2140/comments","events_url":"https://api.github.com/repos/jhy/jsoup/issues/2140/events","html_url":"https://github.com/jhy/jsoup/issues/2140","id":2324840544,"node_id":"I_kwDOAAbAPs6KkkBg","number":2140,"title":"Form elements not updated when making DOM changes","user":{"login":"aditsu","id":71749,"node_id":"MDQ6VXNlcjcxNzQ5","avatar_url":"https://avatars.githubusercontent.com/u/71749?v=4","gravatar_id":"","url":"https://api.github.com/users/aditsu","html_url":"https://github.com/aditsu","followers_url":"https://api.github.com/users/aditsu/followers","following_url":"https://api.github.com/users/aditsu/following{/other_user}","gists_url":"https://api.github.com/users/aditsu/gists{/gist_id}","starred_url":"https://api.github.com/users/aditsu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aditsu/subscriptions","organizations_url":"https://api.github.com/users/aditsu/orgs","repos_url":"https://api.github.com/users/aditsu/repos","events_url":"https://api.github.com/users/aditsu/events{/privacy}","received_events_url":"https://api.github.com/users/aditsu/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":23217,"node_id":"MDU6TGFiZWwyMzIxNw==","url":"https://api.github.com/repos/jhy/jsoup/labels/improvement","name":"improvement","color":"4bfa82","default":false,"description":"An improvement / new feature idea"}],"state":"closed","locked":false,"assignee":{"login":"jhy","id":76934,"node_id":"MDQ6VXNlcjc2OTM0","avatar_url":"https://avatars.githubusercontent.com/u/76934?v=4","gravatar_id":"","url":"https://api.github.com/users/jhy","html_url":"https://github.com/jhy","followers_url":"https://api.github.com/users/jhy/followers","following_url":"https://api.github.com/users/jhy/following{/other_user}","gists_url":"https://api.github.com/users/jhy/gists{/gist_id}","starred_url":"https://api.github.com/users/jhy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jhy/subscriptions","organizations_url":"https://api.github.com/users/jhy/orgs","repos_url":"https://api.github.com/users/jhy/repos","events_url":"https://api.github.com/users/jhy/events{/privacy}","received_events_url":"https://api.github.com/users/jhy/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"jhy","id":76934,"node_id":"MDQ6VXNlcjc2OTM0","avatar_url":"https://avatars.githubusercontent.com/u/76934?v=4","gravatar_id":"","url":"https://api.github.com/users/jhy","html_url":"https://github.com/jhy","followers_url":"https://api.github.com/users/jhy/followers","following_url":"https://api.github.com/users/jhy/following{/other_user}","gists_url":"https://api.github.com/users/jhy/gists{/gist_id}","starred_url":"https://api.github.com/users/jhy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jhy/subscriptions","organizations_url":"https://api.github.com/users/jhy/orgs","repos_url":"https://api.github.com/users/jhy/repos","events_url":"https://api.github.com/users/jhy/events{/privacy}","received_events_url":"https://api.github.com/users/jhy/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":{"url":"https://api.github.com/repos/jhy/jsoup/milestones/30","html_url":"https://github.com/jhy/jsoup/milestone/30","labels_url":"https://api.github.com/repos/jhy/jsoup/milestones/30/labels","id":11312824,"node_id":"MI_kwDOAAbAPs4ArJ64","number":30,"title":"1.18.2","description":"https://jsoup.org/news/release-1.18.2","creator":{"login":"jhy","id":76934,"node_id":"MDQ6VXNlcjc2OTM0","avatar_url":"https://avatars.githubusercontent.com/u/76934?v=4","gravatar_id":"","url":"https://api.github.com/users/jhy","html_url":"https://github.com/jhy","followers_url":"https://api.github.com/users/jhy/followers","following_url":"https://api.github.com/users/jhy/following{/other_user}","gists_url":"https://api.github.com/users/jhy/gists{/gist_id}","starred_url":"https://api.github.com/users/jhy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jhy/subscriptions","organizations_url":"https://api.github.com/users/jhy/orgs","repos_url":"https://api.github.com/users/jhy/repos","events_url":"https://api.github.com/users/jhy/events{/privacy}","received_events_url":"https://api.github.com/users/jhy/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":28,"state":"closed","created_at":"2024-07-15T07:18:19Z","updated_at":"2024-11-28T23:51:20Z","due_on":"2024-11-27T08:00:00Z","closed_at":"2024-11-28T23:51:20Z"},"comments":5,"created_at":"2024-05-30T06:43:25Z","updated_at":"2024-07-15T07:20:22Z","closed_at":"2024-07-15T07:19:07Z","author_association":"NONE","active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"I am parsing an html document and making some changes to it, then extracting some form fields. It looks like the `elements` in `FormElement` are already set when the document is initially parsed, and remain unchanged.\r\nExample code:\r\n\r\n```\r\nimport org.jsoup.Jsoup;\r\nimport org.jsoup.nodes.Document;\r\nimport org.jsoup.nodes.FormElement;\r\n\r\npublic class ParseTest {\r\n\tpublic static void main(final String... args) {\r\n\t\tfinal String html = \"<html><body><form><div id=d1><input id=foo></div><input id=bar></form></body></html>\";\r\n\t\tfinal Document doc = Jsoup.parse(html);\r\n\t\tdoc.select(\"#d1\").remove();\r\n\t\tfinal FormElement form = (FormElement) doc.selectFirst(\"form\");\r\n\t\tform.appendElement(\"select\").attr(\"id\", \"baz\");\r\n\t\tSystem.out.println(form);\r\n\t\tSystem.out.println();\r\n\t\tSystem.out.println(form.elements());\r\n\t}\r\n}\r\n```\r\n\r\nThe result shows that the form now has the `bar` and `baz` fields, but its `elements` are still `foo` and `bar`. Notice that `foo` was removed even before selecting the form element.\r\n\r\nWorkaround (re-parsing): `form = (FormElement) Jsoup.parse(form.toString()).selectFirst(\"form\");`\r\nJsoup version: 1.17.2","closed_by":{"login":"jhy","id":76934,"node_id":"MDQ6VXNlcjc2OTM0","avatar_url":"https://avatars.githubusercontent.com/u/76934?v=4","gravatar_id":"","url":"https://api.github.com/users/jhy","html_url":"https://github.com/jhy","followers_url":"https://api.github.com/users/jhy/followers","following_url":"https://api.github.com/users/jhy/following{/other_user}","gists_url":"https://api.github.com/users/jhy/gists{/gist_id}","starred_url":"https://api.github.com/users/jhy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jhy/subscriptions","organizations_url":"https://api.github.com/users/jhy/orgs","repos_url":"https://api.github.com/users/jhy/repos","events_url":"https://api.github.com/users/jhy/events{/privacy}","received_events_url":"https://api.github.com/users/jhy/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/jhy/jsoup/issues/2140/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/jhy/jsoup/issues/2140/timeline","performed_via_github_app":null,"state_reason":"completed"}