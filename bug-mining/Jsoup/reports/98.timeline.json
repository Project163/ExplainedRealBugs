[{"url":"https://api.github.com/repos/jhy/jsoup/issues/comments/34953153","html_url":"https://github.com/jhy/jsoup/issues/383#issuecomment-34953153","issue_url":"https://api.github.com/repos/jhy/jsoup/issues/383","id":34953153,"node_id":"MDEyOklzc3VlQ29tbWVudDM0OTUzMTUz","user":{"login":"Kaned1as","id":863272,"node_id":"MDQ6VXNlcjg2MzI3Mg==","avatar_url":"https://avatars.githubusercontent.com/u/863272?v=4","gravatar_id":"","url":"https://api.github.com/users/Kaned1as","html_url":"https://github.com/Kaned1as","followers_url":"https://api.github.com/users/Kaned1as/followers","following_url":"https://api.github.com/users/Kaned1as/following{/other_user}","gists_url":"https://api.github.com/users/Kaned1as/gists{/gist_id}","starred_url":"https://api.github.com/users/Kaned1as/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Kaned1as/subscriptions","organizations_url":"https://api.github.com/users/Kaned1as/orgs","repos_url":"https://api.github.com/users/Kaned1as/repos","events_url":"https://api.github.com/users/Kaned1as/events{/privacy}","received_events_url":"https://api.github.com/users/Kaned1as/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2014-02-13T06:59:29Z","updated_at":"2014-02-13T06:59:39Z","body":"I second this\n\nalso .html()\n\nseems like kitkat gc is more aggressive\n","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/jhy/jsoup/issues/comments/34953153/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Kaned1as","id":863272,"node_id":"MDQ6VXNlcjg2MzI3Mg==","avatar_url":"https://avatars.githubusercontent.com/u/863272?v=4","gravatar_id":"","url":"https://api.github.com/users/Kaned1as","html_url":"https://github.com/Kaned1as","followers_url":"https://api.github.com/users/Kaned1as/followers","following_url":"https://api.github.com/users/Kaned1as/following{/other_user}","gists_url":"https://api.github.com/users/Kaned1as/gists{/gist_id}","starred_url":"https://api.github.com/users/Kaned1as/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Kaned1as/subscriptions","organizations_url":"https://api.github.com/users/Kaned1as/orgs","repos_url":"https://api.github.com/users/Kaned1as/repos","events_url":"https://api.github.com/users/Kaned1as/events{/privacy}","received_events_url":"https://api.github.com/users/Kaned1as/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/jhy/jsoup/issues/comments/88675283","html_url":"https://github.com/jhy/jsoup/issues/383#issuecomment-88675283","issue_url":"https://api.github.com/repos/jhy/jsoup/issues/383","id":88675283,"node_id":"MDEyOklzc3VlQ29tbWVudDg4Njc1Mjgz","user":{"login":"gregko","id":1746812,"node_id":"MDQ6VXNlcjE3NDY4MTI=","avatar_url":"https://avatars.githubusercontent.com/u/1746812?v=4","gravatar_id":"","url":"https://api.github.com/users/gregko","html_url":"https://github.com/gregko","followers_url":"https://api.github.com/users/gregko/followers","following_url":"https://api.github.com/users/gregko/following{/other_user}","gists_url":"https://api.github.com/users/gregko/gists{/gist_id}","starred_url":"https://api.github.com/users/gregko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gregko/subscriptions","organizations_url":"https://api.github.com/users/gregko/orgs","repos_url":"https://api.github.com/users/gregko/repos","events_url":"https://api.github.com/users/gregko/events{/privacy}","received_events_url":"https://api.github.com/users/gregko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2015-04-02T00:38:08Z","updated_at":"2015-04-02T00:38:08Z","body":"I also find jsoup about 10x slower on Android 4.4 KitKat and v5 Lollipop than on older versions (tested 4.3 and 4.2.2). Under KitKat I tested with both ART and Dalvik VMs, practically no difference. Any idea what could be done about it?\n","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/jhy/jsoup/issues/comments/88675283/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"gregko","id":1746812,"node_id":"MDQ6VXNlcjE3NDY4MTI=","avatar_url":"https://avatars.githubusercontent.com/u/1746812?v=4","gravatar_id":"","url":"https://api.github.com/users/gregko","html_url":"https://github.com/gregko","followers_url":"https://api.github.com/users/gregko/followers","following_url":"https://api.github.com/users/gregko/following{/other_user}","gists_url":"https://api.github.com/users/gregko/gists{/gist_id}","starred_url":"https://api.github.com/users/gregko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gregko/subscriptions","organizations_url":"https://api.github.com/users/gregko/orgs","repos_url":"https://api.github.com/users/gregko/repos","events_url":"https://api.github.com/users/gregko/events{/privacy}","received_events_url":"https://api.github.com/users/gregko/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/jhy/jsoup/issues/comments/88676486","html_url":"https://github.com/jhy/jsoup/issues/383#issuecomment-88676486","issue_url":"https://api.github.com/repos/jhy/jsoup/issues/383","id":88676486,"node_id":"MDEyOklzc3VlQ29tbWVudDg4Njc2NDg2","user":{"login":"jhy","id":76934,"node_id":"MDQ6VXNlcjc2OTM0","avatar_url":"https://avatars.githubusercontent.com/u/76934?v=4","gravatar_id":"","url":"https://api.github.com/users/jhy","html_url":"https://github.com/jhy","followers_url":"https://api.github.com/users/jhy/followers","following_url":"https://api.github.com/users/jhy/following{/other_user}","gists_url":"https://api.github.com/users/jhy/gists{/gist_id}","starred_url":"https://api.github.com/users/jhy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jhy/subscriptions","organizations_url":"https://api.github.com/users/jhy/orgs","repos_url":"https://api.github.com/users/jhy/repos","events_url":"https://api.github.com/users/jhy/events{/privacy}","received_events_url":"https://api.github.com/users/jhy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2015-04-02T00:51:25Z","updated_at":"2015-04-02T00:51:25Z","body":"What jsoup version -- can you try with Mainline (not 1.8.1)? I optimized a\nlot of things that can cause GC. I didn't see a 10x speedup but it did\nimprove.\n\nAre you looking at parsing or serialization? Can you give me your example\nparsing HTML files?\n\nOn Wed, Apr 1, 2015 at 5:38 PM, Greg Kochaniak notifications@github.com\nwrote:\n\n> I also find jsoup about 10x slower on Android 4.4 KitKat and v5 Lollipop\n> than on older versions (tested 4.3 and 4.2.2). Under KitKat I tested with\n> both ART and Dalvik VMs, practically no difference. Any idea what could be\n> done about it?\n> \n> —\n> Reply to this email directly or view it on GitHub\n> https://github.com/jhy/jsoup/issues/383#issuecomment-88675283.\n","author_association":"OWNER","reactions":{"url":"https://api.github.com/repos/jhy/jsoup/issues/comments/88676486/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"jhy","id":76934,"node_id":"MDQ6VXNlcjc2OTM0","avatar_url":"https://avatars.githubusercontent.com/u/76934?v=4","gravatar_id":"","url":"https://api.github.com/users/jhy","html_url":"https://github.com/jhy","followers_url":"https://api.github.com/users/jhy/followers","following_url":"https://api.github.com/users/jhy/following{/other_user}","gists_url":"https://api.github.com/users/jhy/gists{/gist_id}","starred_url":"https://api.github.com/users/jhy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jhy/subscriptions","organizations_url":"https://api.github.com/users/jhy/orgs","repos_url":"https://api.github.com/users/jhy/repos","events_url":"https://api.github.com/users/jhy/events{/privacy}","received_events_url":"https://api.github.com/users/jhy/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/jhy/jsoup/issues/comments/88879385","html_url":"https://github.com/jhy/jsoup/issues/383#issuecomment-88879385","issue_url":"https://api.github.com/repos/jhy/jsoup/issues/383","id":88879385,"node_id":"MDEyOklzc3VlQ29tbWVudDg4ODc5Mzg1","user":{"login":"gregko","id":1746812,"node_id":"MDQ6VXNlcjE3NDY4MTI=","avatar_url":"https://avatars.githubusercontent.com/u/1746812?v=4","gravatar_id":"","url":"https://api.github.com/users/gregko","html_url":"https://github.com/gregko","followers_url":"https://api.github.com/users/gregko/followers","following_url":"https://api.github.com/users/gregko/following{/other_user}","gists_url":"https://api.github.com/users/gregko/gists{/gist_id}","starred_url":"https://api.github.com/users/gregko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gregko/subscriptions","organizations_url":"https://api.github.com/users/gregko/orgs","repos_url":"https://api.github.com/users/gregko/repos","events_url":"https://api.github.com/users/gregko/events{/privacy}","received_events_url":"https://api.github.com/users/gregko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2015-04-02T12:05:46Z","updated_at":"2015-04-02T12:05:46Z","body":"Hey, thanks for the answer! I was using before ver. 1.7.4, and after reading your release notes about Android optimizations in 1.8.2, I instantly built it form the latest GitHub source (last build yesterday) and tested this. The issue persists, version 1.8.x is very fast under Android 4.3 and lower, e.g. loads a long chapter from ePub book into my app in about 2 seconds even on slow old devices, while it takes about 20 seconds to load on Galaxy Note 3 - lots of memory and decent processor, with KitKat before, now upgraded to Lollipop. Same on other devices I own and in the emulators. It's probably the inefficient use of memory, as the VM doing garbage collection often? I'm going to try it now with a setting requesting a bigger heap, will report shortly what happens then.\n\nWhat my app (https://play.google.com/store/apps/details?id=com.hyperionics.avar) does with jsoup: runs my modified version of Readability algorithm to extract text for reading aloud or on screen , reject junk like menus, ads, unrelated links etc.Then, it processes further the cleaned-up jsoup doc e.g. downloading and inserting style nodes and doing further cleanup to have styled HTML text for reading aloud and highlighting the sentences it reads, e.g. it traverses all nodes extracting text, but also keeping text attributes like headers, paragraphs, divs and styles. This last step, which is also slow on Android 4.4 and higher, is based on your text extractor and node visitor. It no longer manipulates the Document object, just visits the nodes and accumulates my \"simpliefied HTML\" in a StringBuilder object.\n\nGreg\n","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/jhy/jsoup/issues/comments/88879385/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"gregko","id":1746812,"node_id":"MDQ6VXNlcjE3NDY4MTI=","avatar_url":"https://avatars.githubusercontent.com/u/1746812?v=4","gravatar_id":"","url":"https://api.github.com/users/gregko","html_url":"https://github.com/gregko","followers_url":"https://api.github.com/users/gregko/followers","following_url":"https://api.github.com/users/gregko/following{/other_user}","gists_url":"https://api.github.com/users/gregko/gists{/gist_id}","starred_url":"https://api.github.com/users/gregko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gregko/subscriptions","organizations_url":"https://api.github.com/users/gregko/orgs","repos_url":"https://api.github.com/users/gregko/repos","events_url":"https://api.github.com/users/gregko/events{/privacy}","received_events_url":"https://api.github.com/users/gregko/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/jhy/jsoup/issues/comments/88880188","html_url":"https://github.com/jhy/jsoup/issues/383#issuecomment-88880188","issue_url":"https://api.github.com/repos/jhy/jsoup/issues/383","id":88880188,"node_id":"MDEyOklzc3VlQ29tbWVudDg4ODgwMTg4","user":{"login":"gregko","id":1746812,"node_id":"MDQ6VXNlcjE3NDY4MTI=","avatar_url":"https://avatars.githubusercontent.com/u/1746812?v=4","gravatar_id":"","url":"https://api.github.com/users/gregko","html_url":"https://github.com/gregko","followers_url":"https://api.github.com/users/gregko/followers","following_url":"https://api.github.com/users/gregko/following{/other_user}","gists_url":"https://api.github.com/users/gregko/gists{/gist_id}","starred_url":"https://api.github.com/users/gregko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gregko/subscriptions","organizations_url":"https://api.github.com/users/gregko/orgs","repos_url":"https://api.github.com/users/gregko/repos","events_url":"https://api.github.com/users/gregko/events{/privacy}","received_events_url":"https://api.github.com/users/gregko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2015-04-02T12:11:55Z","updated_at":"2015-04-02T12:11:55Z","body":"Update: just tried android:largeHeap=\"true\" in AndroidManifest.xml of the app, no difference on Android 5 test (Galaxy Note 3 phone).\n","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/jhy/jsoup/issues/comments/88880188/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"gregko","id":1746812,"node_id":"MDQ6VXNlcjE3NDY4MTI=","avatar_url":"https://avatars.githubusercontent.com/u/1746812?v=4","gravatar_id":"","url":"https://api.github.com/users/gregko","html_url":"https://github.com/gregko","followers_url":"https://api.github.com/users/gregko/followers","following_url":"https://api.github.com/users/gregko/following{/other_user}","gists_url":"https://api.github.com/users/gregko/gists{/gist_id}","starred_url":"https://api.github.com/users/gregko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gregko/subscriptions","organizations_url":"https://api.github.com/users/gregko/orgs","repos_url":"https://api.github.com/users/gregko/repos","events_url":"https://api.github.com/users/gregko/events{/privacy}","received_events_url":"https://api.github.com/users/gregko/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/jhy/jsoup/issues/comments/88951720","html_url":"https://github.com/jhy/jsoup/issues/383#issuecomment-88951720","issue_url":"https://api.github.com/repos/jhy/jsoup/issues/383","id":88951720,"node_id":"MDEyOklzc3VlQ29tbWVudDg4OTUxNzIw","user":{"login":"jhy","id":76934,"node_id":"MDQ6VXNlcjc2OTM0","avatar_url":"https://avatars.githubusercontent.com/u/76934?v=4","gravatar_id":"","url":"https://api.github.com/users/jhy","html_url":"https://github.com/jhy","followers_url":"https://api.github.com/users/jhy/followers","following_url":"https://api.github.com/users/jhy/following{/other_user}","gists_url":"https://api.github.com/users/jhy/gists{/gist_id}","starred_url":"https://api.github.com/users/jhy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jhy/subscriptions","organizations_url":"https://api.github.com/users/jhy/orgs","repos_url":"https://api.github.com/users/jhy/repos","events_url":"https://api.github.com/users/jhy/events{/privacy}","received_events_url":"https://api.github.com/users/jhy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2015-04-02T15:44:47Z","updated_at":"2015-04-02T15:44:47Z","body":"Could you send me (directly, jonathan@hedley.net) a sample of that epub\ndoc? I'm seeing like 10ms parse times for jsoup.org, 155ms for CNN sites on\nLollipop Nexus 5.\n\nI need to find an old phone to compare pre-kitkat.\n\nOn Thu, Apr 2, 2015, 05:11 Greg Kochaniak notifications@github.com wrote:\n\n> Update: just tried android:largeHeap=\"true\" in AndroidManifest.xml of the\n> app, no difference on Android 5 test (Galaxy Note 3 phone).\n> \n> —\n> Reply to this email directly or view it on GitHub\n> https://github.com/jhy/jsoup/issues/383#issuecomment-88880188.\n","author_association":"OWNER","reactions":{"url":"https://api.github.com/repos/jhy/jsoup/issues/comments/88951720/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"jhy","id":76934,"node_id":"MDQ6VXNlcjc2OTM0","avatar_url":"https://avatars.githubusercontent.com/u/76934?v=4","gravatar_id":"","url":"https://api.github.com/users/jhy","html_url":"https://github.com/jhy","followers_url":"https://api.github.com/users/jhy/followers","following_url":"https://api.github.com/users/jhy/following{/other_user}","gists_url":"https://api.github.com/users/jhy/gists{/gist_id}","starred_url":"https://api.github.com/users/jhy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jhy/subscriptions","organizations_url":"https://api.github.com/users/jhy/orgs","repos_url":"https://api.github.com/users/jhy/repos","events_url":"https://api.github.com/users/jhy/events{/privacy}","received_events_url":"https://api.github.com/users/jhy/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/jhy/jsoup/issues/comments/89017807","html_url":"https://github.com/jhy/jsoup/issues/383#issuecomment-89017807","issue_url":"https://api.github.com/repos/jhy/jsoup/issues/383","id":89017807,"node_id":"MDEyOklzc3VlQ29tbWVudDg5MDE3ODA3","user":{"login":"gregko","id":1746812,"node_id":"MDQ6VXNlcjE3NDY4MTI=","avatar_url":"https://avatars.githubusercontent.com/u/1746812?v=4","gravatar_id":"","url":"https://api.github.com/users/gregko","html_url":"https://github.com/gregko","followers_url":"https://api.github.com/users/gregko/followers","following_url":"https://api.github.com/users/gregko/following{/other_user}","gists_url":"https://api.github.com/users/gregko/gists{/gist_id}","starred_url":"https://api.github.com/users/gregko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gregko/subscriptions","organizations_url":"https://api.github.com/users/gregko/orgs","repos_url":"https://api.github.com/users/gregko/repos","events_url":"https://api.github.com/users/gregko/events{/privacy}","received_events_url":"https://api.github.com/users/gregko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2015-04-02T19:28:48Z","updated_at":"2015-04-02T19:28:48Z","body":"I was not sure what exactly you need, but assume an ePub chapter. Will try to extract and email it... The jsoup parse is probably pretty fast, the other operations I do take longer. I looked at the jsoup code, and for example Element hasClass(String className) method calls classNames() method that creates a lot of strings and a String table, and then a Set<String> - a lot of objects created on the heap, to give us a simple yes/no answer, and they all have to be garbage collected soon after. Imagine now iterating through all elements in a doc...\n\nI will try to replace hasClass() with just a RegEx \"\\bclass_name\\b\" expression lookup and see if that makes a difference in my app. Then will continue searching for other places like that to optimize memory management. If you have suggestions where to look, let me know. If I do get something that works really well, will issue a merge request to your repo.\n\nGreg\n","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/jhy/jsoup/issues/comments/89017807/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"gregko","id":1746812,"node_id":"MDQ6VXNlcjE3NDY4MTI=","avatar_url":"https://avatars.githubusercontent.com/u/1746812?v=4","gravatar_id":"","url":"https://api.github.com/users/gregko","html_url":"https://github.com/gregko","followers_url":"https://api.github.com/users/gregko/followers","following_url":"https://api.github.com/users/gregko/following{/other_user}","gists_url":"https://api.github.com/users/gregko/gists{/gist_id}","starred_url":"https://api.github.com/users/gregko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gregko/subscriptions","organizations_url":"https://api.github.com/users/gregko/orgs","repos_url":"https://api.github.com/users/gregko/repos","events_url":"https://api.github.com/users/gregko/events{/privacy}","received_events_url":"https://api.github.com/users/gregko/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/jhy/jsoup/issues/comments/90249695","html_url":"https://github.com/jhy/jsoup/issues/383#issuecomment-90249695","issue_url":"https://api.github.com/repos/jhy/jsoup/issues/383","id":90249695,"node_id":"MDEyOklzc3VlQ29tbWVudDkwMjQ5Njk1","user":{"login":"jhy","id":76934,"node_id":"MDQ6VXNlcjc2OTM0","avatar_url":"https://avatars.githubusercontent.com/u/76934?v=4","gravatar_id":"","url":"https://api.github.com/users/jhy","html_url":"https://github.com/jhy","followers_url":"https://api.github.com/users/jhy/followers","following_url":"https://api.github.com/users/jhy/following{/other_user}","gists_url":"https://api.github.com/users/jhy/gists{/gist_id}","starred_url":"https://api.github.com/users/jhy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jhy/subscriptions","organizations_url":"https://api.github.com/users/jhy/orgs","repos_url":"https://api.github.com/users/jhy/repos","events_url":"https://api.github.com/users/jhy/events{/privacy}","received_events_url":"https://api.github.com/users/jhy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2015-04-06T21:22:49Z","updated_at":"2015-04-06T21:22:49Z","body":"I dug into why CharsetEncoder#canEncode() is so slow on Android. I can't find why it's changed so much between ICS to KK where it got really slow, but I do see that it's implemented natively and involves creating arrays and copying through the native interfaces. However in the JDK, for at least UTF and Ascii, there are simple one-liner implementations for canEncode. I expect somewhere between ICS and KK, Android moved from using OpenJDK to a native (ICU) implementation and that's where this speed regression comes from.\n\nI think the fix will be to roll some specific encode checks, referring to the simple implementations in the OpenJDK character sets.\n","author_association":"OWNER","reactions":{"url":"https://api.github.com/repos/jhy/jsoup/issues/comments/90249695/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"jhy","id":76934,"node_id":"MDQ6VXNlcjc2OTM0","avatar_url":"https://avatars.githubusercontent.com/u/76934?v=4","gravatar_id":"","url":"https://api.github.com/users/jhy","html_url":"https://github.com/jhy","followers_url":"https://api.github.com/users/jhy/followers","following_url":"https://api.github.com/users/jhy/following{/other_user}","gists_url":"https://api.github.com/users/jhy/gists{/gist_id}","starred_url":"https://api.github.com/users/jhy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jhy/subscriptions","organizations_url":"https://api.github.com/users/jhy/orgs","repos_url":"https://api.github.com/users/jhy/repos","events_url":"https://api.github.com/users/jhy/events{/privacy}","received_events_url":"https://api.github.com/users/jhy/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":274728185,"node_id":"MDExOkNsb3NlZEV2ZW50Mjc0NzI4MTg1","url":"https://api.github.com/repos/jhy/jsoup/issues/events/274728185","actor":{"login":"jhy","id":76934,"node_id":"MDQ6VXNlcjc2OTM0","avatar_url":"https://avatars.githubusercontent.com/u/76934?v=4","gravatar_id":"","url":"https://api.github.com/users/jhy","html_url":"https://github.com/jhy","followers_url":"https://api.github.com/users/jhy/followers","following_url":"https://api.github.com/users/jhy/following{/other_user}","gists_url":"https://api.github.com/users/jhy/gists{/gist_id}","starred_url":"https://api.github.com/users/jhy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jhy/subscriptions","organizations_url":"https://api.github.com/users/jhy/orgs","repos_url":"https://api.github.com/users/jhy/repos","events_url":"https://api.github.com/users/jhy/events{/privacy}","received_events_url":"https://api.github.com/users/jhy/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"closed","commit_id":"b14e7357248a0f683b8252be3e68f5e171fb8529","commit_url":"https://api.github.com/repos/jhy/jsoup/commits/b14e7357248a0f683b8252be3e68f5e171fb8529","created_at":"2015-04-07T02:30:18Z","state_reason":null,"performed_via_github_app":null},{"url":"https://api.github.com/repos/jhy/jsoup/issues/comments/90321715","html_url":"https://github.com/jhy/jsoup/issues/383#issuecomment-90321715","issue_url":"https://api.github.com/repos/jhy/jsoup/issues/383","id":90321715,"node_id":"MDEyOklzc3VlQ29tbWVudDkwMzIxNzE1","user":{"login":"jhy","id":76934,"node_id":"MDQ6VXNlcjc2OTM0","avatar_url":"https://avatars.githubusercontent.com/u/76934?v=4","gravatar_id":"","url":"https://api.github.com/users/jhy","html_url":"https://github.com/jhy","followers_url":"https://api.github.com/users/jhy/followers","following_url":"https://api.github.com/users/jhy/following{/other_user}","gists_url":"https://api.github.com/users/jhy/gists{/gist_id}","starred_url":"https://api.github.com/users/jhy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jhy/subscriptions","organizations_url":"https://api.github.com/users/jhy/orgs","repos_url":"https://api.github.com/users/jhy/repos","events_url":"https://api.github.com/users/jhy/events{/privacy}","received_events_url":"https://api.github.com/users/jhy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2015-04-07T02:35:04Z","updated_at":"2015-04-07T02:35:04Z","body":"Thanks to @gregko and everyone else for getting to the bottom of this. The Android implementation of canEncode doesn't use the OpenJDK simple methods, and ends up being very slow. I've built simple tests for ascii and UTF, similarly to Greg's impl. We can extend it simply if there are other charsets in use that get impacted.\n","author_association":"OWNER","reactions":{"url":"https://api.github.com/repos/jhy/jsoup/issues/comments/90321715/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"jhy","id":76934,"node_id":"MDQ6VXNlcjc2OTM0","avatar_url":"https://avatars.githubusercontent.com/u/76934?v=4","gravatar_id":"","url":"https://api.github.com/users/jhy","html_url":"https://github.com/jhy","followers_url":"https://api.github.com/users/jhy/followers","following_url":"https://api.github.com/users/jhy/following{/other_user}","gists_url":"https://api.github.com/users/jhy/gists{/gist_id}","starred_url":"https://api.github.com/users/jhy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jhy/subscriptions","organizations_url":"https://api.github.com/users/jhy/orgs","repos_url":"https://api.github.com/users/jhy/repos","events_url":"https://api.github.com/users/jhy/events{/privacy}","received_events_url":"https://api.github.com/users/jhy/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":274730152,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50Mjc0NzMwMTUy","url":"https://api.github.com/repos/jhy/jsoup/issues/events/274730152","actor":{"login":"gregko","id":1746812,"node_id":"MDQ6VXNlcjE3NDY4MTI=","avatar_url":"https://avatars.githubusercontent.com/u/1746812?v=4","gravatar_id":"","url":"https://api.github.com/users/gregko","html_url":"https://github.com/gregko","followers_url":"https://api.github.com/users/gregko/followers","following_url":"https://api.github.com/users/gregko/following{/other_user}","gists_url":"https://api.github.com/users/gregko/gists{/gist_id}","starred_url":"https://api.github.com/users/gregko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gregko/subscriptions","organizations_url":"https://api.github.com/users/gregko/orgs","repos_url":"https://api.github.com/users/gregko/repos","events_url":"https://api.github.com/users/gregko/events{/privacy}","received_events_url":"https://api.github.com/users/gregko/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2015-04-07T02:35:04Z","performed_via_github_app":null},{"id":274730153,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDI3NDczMDE1Mw==","url":"https://api.github.com/repos/jhy/jsoup/issues/events/274730153","actor":{"login":"gregko","id":1746812,"node_id":"MDQ6VXNlcjE3NDY4MTI=","avatar_url":"https://avatars.githubusercontent.com/u/1746812?v=4","gravatar_id":"","url":"https://api.github.com/users/gregko","html_url":"https://github.com/gregko","followers_url":"https://api.github.com/users/gregko/followers","following_url":"https://api.github.com/users/gregko/following{/other_user}","gists_url":"https://api.github.com/users/gregko/gists{/gist_id}","starred_url":"https://api.github.com/users/gregko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gregko/subscriptions","organizations_url":"https://api.github.com/users/gregko/orgs","repos_url":"https://api.github.com/users/gregko/repos","events_url":"https://api.github.com/users/gregko/events{/privacy}","received_events_url":"https://api.github.com/users/gregko/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2015-04-07T02:35:04Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/jhy/jsoup/issues/comments/90322009","html_url":"https://github.com/jhy/jsoup/issues/383#issuecomment-90322009","issue_url":"https://api.github.com/repos/jhy/jsoup/issues/383","id":90322009,"node_id":"MDEyOklzc3VlQ29tbWVudDkwMzIyMDA5","user":{"login":"jhy","id":76934,"node_id":"MDQ6VXNlcjc2OTM0","avatar_url":"https://avatars.githubusercontent.com/u/76934?v=4","gravatar_id":"","url":"https://api.github.com/users/jhy","html_url":"https://github.com/jhy","followers_url":"https://api.github.com/users/jhy/followers","following_url":"https://api.github.com/users/jhy/following{/other_user}","gists_url":"https://api.github.com/users/jhy/gists{/gist_id}","starred_url":"https://api.github.com/users/jhy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jhy/subscriptions","organizations_url":"https://api.github.com/users/jhy/orgs","repos_url":"https://api.github.com/users/jhy/repos","events_url":"https://api.github.com/users/jhy/events{/privacy}","received_events_url":"https://api.github.com/users/jhy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2015-04-07T02:36:02Z","updated_at":"2015-04-07T02:36:27Z","body":"Here's data on the improved Document.html() time:\n\nOLD impl v New (ms)\nWiki: 1895, 16 (118x)\nCNN: 6378,  (115x)\nAlterslash: 3013, 28 (107x)\nJsoup: 167, 2 (83x)\n\nTested on a Nexus 5, running 5.1.\n","author_association":"OWNER","reactions":{"url":"https://api.github.com/repos/jhy/jsoup/issues/comments/90322009/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"jhy","id":76934,"node_id":"MDQ6VXNlcjc2OTM0","avatar_url":"https://avatars.githubusercontent.com/u/76934?v=4","gravatar_id":"","url":"https://api.github.com/users/jhy","html_url":"https://github.com/jhy","followers_url":"https://api.github.com/users/jhy/followers","following_url":"https://api.github.com/users/jhy/following{/other_user}","gists_url":"https://api.github.com/users/jhy/gists{/gist_id}","starred_url":"https://api.github.com/users/jhy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jhy/subscriptions","organizations_url":"https://api.github.com/users/jhy/orgs","repos_url":"https://api.github.com/users/jhy/repos","events_url":"https://api.github.com/users/jhy/events{/privacy}","received_events_url":"https://api.github.com/users/jhy/received_events","type":"User","user_view_type":"public","site_admin":false}},{"actor":{"login":"jhy","id":76934,"node_id":"MDQ6VXNlcjc2OTM0","avatar_url":"https://avatars.githubusercontent.com/u/76934?v=4","gravatar_id":"","url":"https://api.github.com/users/jhy","html_url":"https://github.com/jhy","followers_url":"https://api.github.com/users/jhy/followers","following_url":"https://api.github.com/users/jhy/following{/other_user}","gists_url":"https://api.github.com/users/jhy/gists{/gist_id}","starred_url":"https://api.github.com/users/jhy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jhy/subscriptions","organizations_url":"https://api.github.com/users/jhy/orgs","repos_url":"https://api.github.com/users/jhy/repos","events_url":"https://api.github.com/users/jhy/events{/privacy}","received_events_url":"https://api.github.com/users/jhy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2015-04-07T02:39:42Z","updated_at":"2015-04-07T02:39:42Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/jhy/jsoup/issues/513","repository_url":"https://api.github.com/repos/jhy/jsoup","labels_url":"https://api.github.com/repos/jhy/jsoup/issues/513/labels{/name}","comments_url":"https://api.github.com/repos/jhy/jsoup/issues/513/comments","events_url":"https://api.github.com/repos/jhy/jsoup/issues/513/events","html_url":"https://github.com/jhy/jsoup/issues/513","id":52981431,"node_id":"MDU6SXNzdWU1Mjk4MTQzMQ==","number":513,"title":"CanEncode in entities escape is slow causing performance bottleneck. ","user":{"login":"ramannanda9","id":883240,"node_id":"MDQ6VXNlcjg4MzI0MA==","avatar_url":"https://avatars.githubusercontent.com/u/883240?v=4","gravatar_id":"","url":"https://api.github.com/users/ramannanda9","html_url":"https://github.com/ramannanda9","followers_url":"https://api.github.com/users/ramannanda9/followers","following_url":"https://api.github.com/users/ramannanda9/following{/other_user}","gists_url":"https://api.github.com/users/ramannanda9/gists{/gist_id}","starred_url":"https://api.github.com/users/ramannanda9/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ramannanda9/subscriptions","organizations_url":"https://api.github.com/users/ramannanda9/orgs","repos_url":"https://api.github.com/users/ramannanda9/repos","events_url":"https://api.github.com/users/ramannanda9/events{/privacy}","received_events_url":"https://api.github.com/users/ramannanda9/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2014-12-28T13:45:38Z","updated_at":"2015-04-07T02:39:42Z","closed_at":"2015-04-07T02:39:42Z","author_association":"NONE","active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"repository":{"id":442430,"node_id":"MDEwOlJlcG9zaXRvcnk0NDI0MzA=","name":"jsoup","full_name":"jhy/jsoup","private":false,"owner":{"login":"jhy","id":76934,"node_id":"MDQ6VXNlcjc2OTM0","avatar_url":"https://avatars.githubusercontent.com/u/76934?v=4","gravatar_id":"","url":"https://api.github.com/users/jhy","html_url":"https://github.com/jhy","followers_url":"https://api.github.com/users/jhy/followers","following_url":"https://api.github.com/users/jhy/following{/other_user}","gists_url":"https://api.github.com/users/jhy/gists{/gist_id}","starred_url":"https://api.github.com/users/jhy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jhy/subscriptions","organizations_url":"https://api.github.com/users/jhy/orgs","repos_url":"https://api.github.com/users/jhy/repos","events_url":"https://api.github.com/users/jhy/events{/privacy}","received_events_url":"https://api.github.com/users/jhy/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/jhy/jsoup","description":"jsoup: the Java HTML parser, built for HTML editing, cleaning, scraping, and XSS safety.","fork":false,"url":"https://api.github.com/repos/jhy/jsoup","forks_url":"https://api.github.com/repos/jhy/jsoup/forks","keys_url":"https://api.github.com/repos/jhy/jsoup/keys{/key_id}","collaborators_url":"https://api.github.com/repos/jhy/jsoup/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/jhy/jsoup/teams","hooks_url":"https://api.github.com/repos/jhy/jsoup/hooks","issue_events_url":"https://api.github.com/repos/jhy/jsoup/issues/events{/number}","events_url":"https://api.github.com/repos/jhy/jsoup/events","assignees_url":"https://api.github.com/repos/jhy/jsoup/assignees{/user}","branches_url":"https://api.github.com/repos/jhy/jsoup/branches{/branch}","tags_url":"https://api.github.com/repos/jhy/jsoup/tags","blobs_url":"https://api.github.com/repos/jhy/jsoup/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/jhy/jsoup/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/jhy/jsoup/git/refs{/sha}","trees_url":"https://api.github.com/repos/jhy/jsoup/git/trees{/sha}","statuses_url":"https://api.github.com/repos/jhy/jsoup/statuses/{sha}","languages_url":"https://api.github.com/repos/jhy/jsoup/languages","stargazers_url":"https://api.github.com/repos/jhy/jsoup/stargazers","contributors_url":"https://api.github.com/repos/jhy/jsoup/contributors","subscribers_url":"https://api.github.com/repos/jhy/jsoup/subscribers","subscription_url":"https://api.github.com/repos/jhy/jsoup/subscription","commits_url":"https://api.github.com/repos/jhy/jsoup/commits{/sha}","git_commits_url":"https://api.github.com/repos/jhy/jsoup/git/commits{/sha}","comments_url":"https://api.github.com/repos/jhy/jsoup/comments{/number}","issue_comment_url":"https://api.github.com/repos/jhy/jsoup/issues/comments{/number}","contents_url":"https://api.github.com/repos/jhy/jsoup/contents/{+path}","compare_url":"https://api.github.com/repos/jhy/jsoup/compare/{base}...{head}","merges_url":"https://api.github.com/repos/jhy/jsoup/merges","archive_url":"https://api.github.com/repos/jhy/jsoup/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/jhy/jsoup/downloads","issues_url":"https://api.github.com/repos/jhy/jsoup/issues{/number}","pulls_url":"https://api.github.com/repos/jhy/jsoup/pulls{/number}","milestones_url":"https://api.github.com/repos/jhy/jsoup/milestones{/number}","notifications_url":"https://api.github.com/repos/jhy/jsoup/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/jhy/jsoup/labels{/name}","releases_url":"https://api.github.com/repos/jhy/jsoup/releases{/id}","deployments_url":"https://api.github.com/repos/jhy/jsoup/deployments","created_at":"2009-12-19T01:29:58Z","updated_at":"2025-11-08T13:24:44Z","pushed_at":"2025-11-03T23:01:11Z","git_url":"git://github.com/jhy/jsoup.git","ssh_url":"git@github.com:jhy/jsoup.git","clone_url":"https://github.com/jhy/jsoup.git","svn_url":"https://github.com/jhy/jsoup","homepage":"https://jsoup.org","size":6573,"stargazers_count":11274,"watchers_count":11274,"language":"Java","has_issues":true,"has_projects":false,"has_downloads":false,"has_wiki":false,"has_pages":false,"has_discussions":true,"forks_count":2265,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":11,"license":{"key":"mit","name":"MIT License","spdx_id":"MIT","url":"https://api.github.com/licenses/mit","node_id":"MDc6TGljZW5zZTEz"},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["css","css-selectors","dom","html","java","java-html-parser","jsoup","parser","xml","xpath"],"visibility":"public","forks":2265,"open_issues":11,"watchers":11274,"default_branch":"master","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"body":"CanEncode is slow, should be moved down or replaced. \n![can_encode_slow](https://cloud.githubusercontent.com/assets/883240/5563957/d95be5f0-8ec5-11e4-8f6f-f5287384ed58.png)\n","reactions":{"url":"https://api.github.com/repos/jhy/jsoup/issues/513/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/jhy/jsoup/issues/513/timeline","performed_via_github_app":null,"state_reason":"completed"}},"event":"cross-referenced"},{"url":"https://api.github.com/repos/jhy/jsoup/issues/comments/90326225","html_url":"https://github.com/jhy/jsoup/issues/383#issuecomment-90326225","issue_url":"https://api.github.com/repos/jhy/jsoup/issues/383","id":90326225,"node_id":"MDEyOklzc3VlQ29tbWVudDkwMzI2MjI1","user":{"login":"gregko","id":1746812,"node_id":"MDQ6VXNlcjE3NDY4MTI=","avatar_url":"https://avatars.githubusercontent.com/u/1746812?v=4","gravatar_id":"","url":"https://api.github.com/users/gregko","html_url":"https://github.com/gregko","followers_url":"https://api.github.com/users/gregko/followers","following_url":"https://api.github.com/users/gregko/following{/other_user}","gists_url":"https://api.github.com/users/gregko/gists{/gist_id}","starred_url":"https://api.github.com/users/gregko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gregko/subscriptions","organizations_url":"https://api.github.com/users/gregko/orgs","repos_url":"https://api.github.com/users/gregko/repos","events_url":"https://api.github.com/users/gregko/events{/privacy}","received_events_url":"https://api.github.com/users/gregko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2015-04-07T02:52:59Z","updated_at":"2015-04-07T12:21:17Z","body":"Yes, that was pretty much my concussion as well. Wrapping chars in character arrays (lots of junk on the heap to dispose) sending them over VM/native boundary, and do this for the file I sent you over 200,000 times... hopefully you can find a more general solution, what I purposed is still the best optimization for the special case of dealing with Unicode. Good luck! \nGreg \n\n-------- Original message --------\nFrom: Jonathan Hedley notifications@github.com \nDate: 04/06/2015  5:22 PM  (GMT-05:00) \nTo: jhy/jsoup jsoup@noreply.github.com \nCc: Greg Kochaniak gregko@hyperionics.com \nSubject: Re: [jsoup] Performance issues on Android Kitkat (#383) \n\nI dug into why CharsetEncoder#canEncode() is so slow on Android. I can't find why it's changed so much between ICS to KK where it got really slow, but I do see that it's implemented natively and involves creating arrays and copying through the native interfaces. However in the JDK, for at least UTF and Ascii, there are simple one-liner implementations for canEncode. I expect somewhere between ICS and KK, Android moved from using OpenJDK to a native (ICU) implementation and that's where this speed regression comes from.\n\nI think the fix will be to roll some specific encode checks, referring to the simple implementations in the OpenJDK character sets.\n\n—\nReply to this email directly or view it on GitHub.\n","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/jhy/jsoup/issues/comments/90326225/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"gregko","id":1746812,"node_id":"MDQ6VXNlcjE3NDY4MTI=","avatar_url":"https://avatars.githubusercontent.com/u/1746812?v=4","gravatar_id":"","url":"https://api.github.com/users/gregko","html_url":"https://github.com/gregko","followers_url":"https://api.github.com/users/gregko/followers","following_url":"https://api.github.com/users/gregko/following{/other_user}","gists_url":"https://api.github.com/users/gregko/gists{/gist_id}","starred_url":"https://api.github.com/users/gregko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gregko/subscriptions","organizations_url":"https://api.github.com/users/gregko/orgs","repos_url":"https://api.github.com/users/gregko/repos","events_url":"https://api.github.com/users/gregko/events{/privacy}","received_events_url":"https://api.github.com/users/gregko/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/jhy/jsoup/issues/comments/90343515","html_url":"https://github.com/jhy/jsoup/issues/383#issuecomment-90343515","issue_url":"https://api.github.com/repos/jhy/jsoup/issues/383","id":90343515,"node_id":"MDEyOklzc3VlQ29tbWVudDkwMzQzNTE1","user":{"login":"jhy","id":76934,"node_id":"MDQ6VXNlcjc2OTM0","avatar_url":"https://avatars.githubusercontent.com/u/76934?v=4","gravatar_id":"","url":"https://api.github.com/users/jhy","html_url":"https://github.com/jhy","followers_url":"https://api.github.com/users/jhy/followers","following_url":"https://api.github.com/users/jhy/following{/other_user}","gists_url":"https://api.github.com/users/jhy/gists{/gist_id}","starred_url":"https://api.github.com/users/jhy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jhy/subscriptions","organizations_url":"https://api.github.com/users/jhy/orgs","repos_url":"https://api.github.com/users/jhy/repos","events_url":"https://api.github.com/users/jhy/events{/privacy}","received_events_url":"https://api.github.com/users/jhy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2015-04-07T03:35:30Z","updated_at":"2015-04-07T03:35:30Z","body":"I didn't really find a more generic approach. I looked at reimplementing\nthe encoding loop, or catching an exception on unsupported characters and\nreplacing with an escape. The problem with these is that we aren't actually\ndoing the encoding at this phase.\n\nThis implementation should be easy to extend if we see issues with other\ncommon encodings.\n\nOn Mon, Apr 6, 2015 at 7:53 PM, Greg Kochaniak notifications@github.com\nwrote:\n\n> Yes, that was pretty much my concussion as well. Wrapping chars in\n> character arrays (lots of junk on the heap to dispose) sending them over\n> VM/native boundary, and do this for the file I sent you over 200,000\n> times... hopefully you can find a more general solution, what I purposed is\n> still the best optimization for the social case of dealing with Unicode.\n> Good luck!\n> Greg\n> \n> -------- Original message --------\n> From: Jonathan Hedley notifications@github.com\n> Date: 04/06/2015 5:22 PM (GMT-05:00)\n> To: jhy/jsoup jsoup@noreply.github.com\n> Cc: Greg Kochaniak gregko@hyperionics.com\n> Subject: Re: [jsoup] Performance issues on Android Kitkat (#383)\n> \n> I dug into why CharsetEncoder#canEncode() is so slow on Android. I can't\n> find why it's changed so much between ICS to KK where it got really slow,\n> but I do see that it's implemented natively and involves creating arrays\n> and copying through the native interfaces. However in the JDK, for at least\n> UTF and Ascii, there are simple one-liner implementations for canEncode. I\n> expect somewhere between ICS and KK, Android moved from using OpenJDK to a\n> native (ICU) implementation and that's where this speed regression comes\n> from.\n> \n> I think the fix will be to roll some specific encode checks, referring to\n> the simple implementations in the OpenJDK character sets.\n> \n> —\n> Reply to this email directly or view it on GitHub.\n> \n> —\n> Reply to this email directly or view it on GitHub\n> https://github.com/jhy/jsoup/issues/383#issuecomment-90326225.\n","author_association":"OWNER","reactions":{"url":"https://api.github.com/repos/jhy/jsoup/issues/comments/90343515/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"jhy","id":76934,"node_id":"MDQ6VXNlcjc2OTM0","avatar_url":"https://avatars.githubusercontent.com/u/76934?v=4","gravatar_id":"","url":"https://api.github.com/users/jhy","html_url":"https://github.com/jhy","followers_url":"https://api.github.com/users/jhy/followers","following_url":"https://api.github.com/users/jhy/following{/other_user}","gists_url":"https://api.github.com/users/jhy/gists{/gist_id}","starred_url":"https://api.github.com/users/jhy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jhy/subscriptions","organizations_url":"https://api.github.com/users/jhy/orgs","repos_url":"https://api.github.com/users/jhy/repos","events_url":"https://api.github.com/users/jhy/events{/privacy}","received_events_url":"https://api.github.com/users/jhy/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/jhy/jsoup/issues/comments/90740339","html_url":"https://github.com/jhy/jsoup/issues/383#issuecomment-90740339","issue_url":"https://api.github.com/repos/jhy/jsoup/issues/383","id":90740339,"node_id":"MDEyOklzc3VlQ29tbWVudDkwNzQwMzM5","user":{"login":"Kaned1as","id":863272,"node_id":"MDQ6VXNlcjg2MzI3Mg==","avatar_url":"https://avatars.githubusercontent.com/u/863272?v=4","gravatar_id":"","url":"https://api.github.com/users/Kaned1as","html_url":"https://github.com/Kaned1as","followers_url":"https://api.github.com/users/Kaned1as/followers","following_url":"https://api.github.com/users/Kaned1as/following{/other_user}","gists_url":"https://api.github.com/users/Kaned1as/gists{/gist_id}","starred_url":"https://api.github.com/users/Kaned1as/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Kaned1as/subscriptions","organizations_url":"https://api.github.com/users/Kaned1as/orgs","repos_url":"https://api.github.com/users/Kaned1as/repos","events_url":"https://api.github.com/users/Kaned1as/events{/privacy}","received_events_url":"https://api.github.com/users/Kaned1as/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2015-04-07T21:41:55Z","updated_at":"2015-04-07T21:41:55Z","body":"Hey, thanks! I've been waiting for this for year!\nI even reimplemented escaping in a very hacky way just for one site to work properly.\n\nGlad to see you didn't forget your open projects! It brings me some money from time to time - where can I donate few bucks to you?\n","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/jhy/jsoup/issues/comments/90740339/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Kaned1as","id":863272,"node_id":"MDQ6VXNlcjg2MzI3Mg==","avatar_url":"https://avatars.githubusercontent.com/u/863272?v=4","gravatar_id":"","url":"https://api.github.com/users/Kaned1as","html_url":"https://github.com/Kaned1as","followers_url":"https://api.github.com/users/Kaned1as/followers","following_url":"https://api.github.com/users/Kaned1as/following{/other_user}","gists_url":"https://api.github.com/users/Kaned1as/gists{/gist_id}","starred_url":"https://api.github.com/users/Kaned1as/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Kaned1as/subscriptions","organizations_url":"https://api.github.com/users/Kaned1as/orgs","repos_url":"https://api.github.com/users/Kaned1as/repos","events_url":"https://api.github.com/users/Kaned1as/events{/privacy}","received_events_url":"https://api.github.com/users/Kaned1as/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":436375580,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDQzNjM3NTU4MA==","url":"https://api.github.com/repos/jhy/jsoup/issues/events/436375580","actor":{"login":"boferri","id":281172,"node_id":"MDQ6VXNlcjI4MTE3Mg==","avatar_url":"https://avatars.githubusercontent.com/u/281172?v=4","gravatar_id":"","url":"https://api.github.com/users/boferri","html_url":"https://github.com/boferri","followers_url":"https://api.github.com/users/boferri/followers","following_url":"https://api.github.com/users/boferri/following{/other_user}","gists_url":"https://api.github.com/users/boferri/gists{/gist_id}","starred_url":"https://api.github.com/users/boferri/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/boferri/subscriptions","organizations_url":"https://api.github.com/users/boferri/orgs","repos_url":"https://api.github.com/users/boferri/repos","events_url":"https://api.github.com/users/boferri/events{/privacy}","received_events_url":"https://api.github.com/users/boferri/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"1ab221b62240aad6281d5d44f28e73757306ef77","commit_url":"https://api.github.com/repos/dswarm/jsoup/commits/1ab221b62240aad6281d5d44f28e73757306ef77","created_at":"2015-10-15T13:25:36Z","performed_via_github_app":null}]