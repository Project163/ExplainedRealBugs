{"url":"https://api.github.com/repos/jhy/jsoup/issues/1949","repository_url":"https://api.github.com/repos/jhy/jsoup","labels_url":"https://api.github.com/repos/jhy/jsoup/issues/1949/labels{/name}","comments_url":"https://api.github.com/repos/jhy/jsoup/issues/1949/comments","events_url":"https://api.github.com/repos/jhy/jsoup/issues/1949/events","html_url":"https://github.com/jhy/jsoup/issues/1949","id":1697279270,"node_id":"I_kwDOAAbAPs5lKm0m","number":1949,"title":"Attributes in form-elements are not deduplicated when parsing as HTML","user":{"login":"perlan","id":1583945,"node_id":"MDQ6VXNlcjE1ODM5NDU=","avatar_url":"https://avatars.githubusercontent.com/u/1583945?v=4","gravatar_id":"","url":"https://api.github.com/users/perlan","html_url":"https://github.com/perlan","followers_url":"https://api.github.com/users/perlan/followers","following_url":"https://api.github.com/users/perlan/following{/other_user}","gists_url":"https://api.github.com/users/perlan/gists{/gist_id}","starred_url":"https://api.github.com/users/perlan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/perlan/subscriptions","organizations_url":"https://api.github.com/users/perlan/orgs","repos_url":"https://api.github.com/users/perlan/repos","events_url":"https://api.github.com/users/perlan/events{/privacy}","received_events_url":"https://api.github.com/users/perlan/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":22026,"node_id":"MDU6TGFiZWwyMjAyNg==","url":"https://api.github.com/repos/jhy/jsoup/labels/bug","name":"bug","color":"D13131","default":true,"description":"A confirmed bug, that we should fix"},{"id":623963149,"node_id":"MDU6TGFiZWw2MjM5NjMxNDk=","url":"https://api.github.com/repos/jhy/jsoup/labels/fixed","name":"fixed","color":"7BE482","default":false,"description":"An {bug|improvement} that has been {fixed|implemented}"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/jhy/jsoup/milestones/26","html_url":"https://github.com/jhy/jsoup/milestone/26","labels_url":"https://api.github.com/repos/jhy/jsoup/milestones/26/labels","id":9367142,"node_id":"MI_kwDOAAbAPs4Aju5m","number":26,"title":"1.16.2","description":"","creator":{"login":"jhy","id":76934,"node_id":"MDQ6VXNlcjc2OTM0","avatar_url":"https://avatars.githubusercontent.com/u/76934?v=4","gravatar_id":"","url":"https://api.github.com/users/jhy","html_url":"https://github.com/jhy","followers_url":"https://api.github.com/users/jhy/followers","following_url":"https://api.github.com/users/jhy/following{/other_user}","gists_url":"https://api.github.com/users/jhy/gists{/gist_id}","starred_url":"https://api.github.com/users/jhy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jhy/subscriptions","organizations_url":"https://api.github.com/users/jhy/orgs","repos_url":"https://api.github.com/users/jhy/repos","events_url":"https://api.github.com/users/jhy/events{/privacy}","received_events_url":"https://api.github.com/users/jhy/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":20,"state":"closed","created_at":"2023-05-06T02:28:21Z","updated_at":"2025-02-25T20:02:57Z","due_on":null,"closed_at":"2023-10-24T04:45:28Z"},"comments":1,"created_at":"2023-05-05T09:14:20Z","updated_at":"2023-05-08T08:41:16Z","closed_at":"2023-05-08T08:38:20Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"I have an issue with form-elements that contains duplicate attributes. I was expecting that attributes in form-elements should be deduplicated in the same way as all other elements when parsing HTML via Parser.htmlParser() but duplicate attributes seems to always be retained. Using Parser.xmlParser(), form attributes are correctly deduplicated so the issue only affects HTML.\r\n\r\nLooking though old issues and pull requests, I found #1219 that seems to fix deduplication for start tags but that fix doesn't seems to apply to form-elements.\r\n\r\nHere is a simple test-case adopted from `HtmlParserTest`:\r\n\r\n```\r\n    @Test public void dropsDuplicateAttributesInFormElement() {\r\n        String html = \"<form One=One ONE=Two Two=two one=Three One=Four two=Five></form>\";\r\n        Parser parser = Parser.htmlParser().setTrackErrors(10);\r\n        Document doc = parser.parseInput(html, \"\");\r\n\r\n        Element p = doc.selectFirst(\"form\");\r\n        assertEquals(\"<form one=\\\"One\\\" two=\\\"two\\\"></form>\", p.outerHtml()); // normalized names due to lower casing\r\n\r\n        assertEquals(1, parser.getErrors().size());\r\n        assertEquals(\"Dropped duplicate attribute(s) in tag [form]\", parser.getErrors().get(0).getErrorMessage());\r\n    }\r\n```","closed_by":{"login":"jhy","id":76934,"node_id":"MDQ6VXNlcjc2OTM0","avatar_url":"https://avatars.githubusercontent.com/u/76934?v=4","gravatar_id":"","url":"https://api.github.com/users/jhy","html_url":"https://github.com/jhy","followers_url":"https://api.github.com/users/jhy/followers","following_url":"https://api.github.com/users/jhy/following{/other_user}","gists_url":"https://api.github.com/users/jhy/gists{/gist_id}","starred_url":"https://api.github.com/users/jhy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jhy/subscriptions","organizations_url":"https://api.github.com/users/jhy/orgs","repos_url":"https://api.github.com/users/jhy/repos","events_url":"https://api.github.com/users/jhy/events{/privacy}","received_events_url":"https://api.github.com/users/jhy/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/jhy/jsoup/issues/1949/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/jhy/jsoup/issues/1949/timeline","performed_via_github_app":null,"state_reason":"completed"}