diff --git a/CHANGES b/CHANGES
index 43a00916..aa6fe21c 100644
--- a/CHANGES
+++ b/CHANGES
@@ -21,6 +21,16 @@ jsoup changelog
   * Improvement: added Element#childrenSize() as a convenience to get the size of an element's element children.
     <https://github.com/jhy/jsoup/pull/1291>
 
+  * Improvement: in W3CDom.asString, allow the output mode to be specified as HTML or as XML. It will default to
+    checking the content, and automatically selecting.
+
+  * Improvement: added a Document#documentType() method, to get a doc's doctype.
+
+  * Improvement: To DocumentType, added #name(), #publicID(), and #systemId() methods to fetch those fields.
+
+  * Improvement: in W3CDom conversions from jsoup documents, retain the DocumentType, and be able to serialize it.
+    <https://github.com/jhy/jsoup/issues/1183>
+
   * Bugfix: on pages fetch by Jsoup.Connection, a "Mark Invalid" exception might be incorrectly thrown, or the page may
     miss some data. This occurred on larger pages when the file transfer was chunked, and an invalid HTML entity
     happened to cross a chunk boundary.
@@ -64,10 +74,6 @@ jsoup changelog
   * Bugfix: Removed binary input detection as it was causing too many false positives.
     <https://github.com/jhy/jsoup/issues/1250>
 
-  * Bugfix: The W3CDom#asString method (that converts a Jsoup Document to a W3C DOM and outputs it as a String) would
-    make invalid XML output (the Transformer was switching into HTML output mode).
-    <https://github.com/jhy/jsoup/issues/1098>
-
   * Bugfix: when cloning a TextNode, if .attributes() was hit before the clone() method, the text value would only be a
     shallow clone.
     <https://github.com/jhy/jsoup/issues/1176>
diff --git a/src/main/java/org/jsoup/helper/W3CDom.java b/src/main/java/org/jsoup/helper/W3CDom.java
index 97286631..324a0d55 100644
--- a/src/main/java/org/jsoup/helper/W3CDom.java
+++ b/src/main/java/org/jsoup/helper/W3CDom.java
@@ -6,14 +6,16 @@ import org.jsoup.nodes.Attributes;
 import org.jsoup.select.NodeTraversor;
 import org.jsoup.select.NodeVisitor;
 import org.w3c.dom.Comment;
-import org.w3c.dom.DOMConfiguration;
+import org.w3c.dom.DOMImplementation;
 import org.w3c.dom.Document;
+import org.w3c.dom.DocumentType;
 import org.w3c.dom.Element;
 import org.w3c.dom.Text;
 
 import javax.xml.parsers.DocumentBuilder;
 import javax.xml.parsers.DocumentBuilderFactory;
 import javax.xml.parsers.ParserConfigurationException;
+import javax.xml.transform.OutputKeys;
 import javax.xml.transform.Transformer;
 import javax.xml.transform.TransformerException;
 import javax.xml.transform.TransformerFactory;
@@ -21,20 +23,111 @@ import javax.xml.transform.dom.DOMSource;
 import javax.xml.transform.stream.StreamResult;
 import java.io.StringWriter;
 import java.util.HashMap;
+import java.util.Map;
 import java.util.Properties;
 import java.util.Stack;
 
-import static javax.xml.transform.OutputKeys.*;
+import static javax.xml.transform.OutputKeys.METHOD;
 
 /**
  * Helper class to transform a {@link org.jsoup.nodes.Document} to a {@link org.w3c.dom.Document org.w3c.dom.Document},
  * for integration with toolsets that use the W3C DOM.
  */
 public class W3CDom {
-    protected DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();
+    protected DocumentBuilderFactory factory;
+
+    public W3CDom() {
+        factory = DocumentBuilderFactory.newInstance();
+        factory.setNamespaceAware(true);
+    }
+
+    /**
+     * Converts a jsoup DOM to a W3C DOM
+     *
+     * @param in jsoup Document
+     * @return W3C Document
+     */
+    public static Document convert(org.jsoup.nodes.Document in) {
+        return (new W3CDom().fromJsoup(in));
+    }
+
+    /**
+     * Serialize a W3C document to a String. Provide Properties to define output settings including if HTML or XML. If
+     * you don't provide the properties ({@code null}), the output will be auto-detected based on the content of the
+     * document.
+     *
+     * @param doc Document
+     * @param properties (optional/nullable) the output properties to use. See {@link
+     *     Transformer#setOutputProperties(Properties)} and {@link OutputKeys}
+     * @return Document as string
+     * @see #OutputHtml
+     * @see #OutputXml
+     * @see OutputKeys#ENCODING
+     * @see OutputKeys#OMIT_XML_DECLARATION
+     * @see OutputKeys#STANDALONE
+     * @see OutputKeys#STANDALONE
+     * @see OutputKeys#DOCTYPE_PUBLIC
+     * @see OutputKeys#DOCTYPE_PUBLIC
+     * @see OutputKeys#CDATA_SECTION_ELEMENTS
+     * @see OutputKeys#INDENT
+     * @see OutputKeys#MEDIA_TYPE
+     */
+    public static String asString(Document doc, Map<String, String> properties) {
+        try {
+            DOMSource domSource = new DOMSource(doc);
+            StringWriter writer = new StringWriter();
+            StreamResult result = new StreamResult(writer);
+            TransformerFactory tf = TransformerFactory.newInstance();
+            Transformer transformer = tf.newTransformer();
+            if (properties != null)
+                transformer.setOutputProperties(propertiesFromMap(properties));
+
+            if (doc.getDoctype() != null) {
+                DocumentType doctype = doc.getDoctype();
+                if (!StringUtil.isBlank(doctype.getPublicId()))
+                    transformer.setOutputProperty(OutputKeys.DOCTYPE_PUBLIC, doctype.getPublicId());
+                if (!StringUtil.isBlank(doctype.getSystemId()))
+                    transformer.setOutputProperty(OutputKeys.DOCTYPE_SYSTEM, doctype.getSystemId());
+                    // handle <!doctype html> for legacy dom. TODO: nicer if <!doctype html>
+                else if (doctype.getName().equalsIgnoreCase("html")
+                    && StringUtil.isBlank(doctype.getPublicId())
+                    && StringUtil.isBlank(doctype.getSystemId()))
+                    transformer.setOutputProperty(OutputKeys.DOCTYPE_SYSTEM, "about:legacy-compat");
+            }
+
+            transformer.transform(domSource, result);
+            return writer.toString();
+
+        } catch (TransformerException e) {
+            throw new IllegalStateException(e);
+        }
+    }
+
+    static Properties propertiesFromMap(Map<String, String> map) {
+        Properties props = new Properties();
+        props.putAll(map);
+        return props;
+    }
+
+    /** Canned default for HTML output. */
+    public static HashMap<String, String> OutputHtml() {
+        return methodMap("html");
+    }
+
+    /** Canned default for XML output. */
+    public static HashMap<String, String> OutputXml() {
+        return methodMap("xml");
+    }
+
+    private static HashMap<String, String> methodMap(String method) {
+        HashMap<String, String> map = new HashMap<>();
+        map.put(METHOD, method);
+        return map;
+    }
 
     /**
      * Convert a jsoup Document to a W3C Document.
+     *
      * @param in jsoup doc
      * @return w3c doc
      */
@@ -42,11 +135,18 @@ public class W3CDom {
         Validate.notNull(in);
         DocumentBuilder builder;
         try {
-        	//set the factory to be namespace-aware
-        	factory.setNamespaceAware(true);
             builder = factory.newDocumentBuilder();
-            Document out = builder.newDocument();
+            DOMImplementation impl = builder.getDOMImplementation();
+            Document out;
+
+            out = builder.newDocument();
+            org.jsoup.nodes.DocumentType doctype = in.documentType();
+            if (doctype != null) {
+                org.w3c.dom.DocumentType documentType = impl.createDocumentType(doctype.name(), doctype.publicId(), doctype.systemId());
+                out.appendChild(documentType);
+            }
             out.setXmlStandalone(true);
+
             convert(in, out);
             return out;
         } catch (ParserConfigurationException e) {
@@ -57,6 +157,7 @@ public class W3CDom {
     /**
      * Converts a jsoup document into the provided W3C Document. If required, you can set options on the output document
      * before converting.
+     *
      * @param in jsoup doc
      * @param out w3c doc
      * @see org.jsoup.helper.W3CDom#fromJsoup(org.jsoup.nodes.Document)
@@ -69,6 +170,17 @@ public class W3CDom {
         NodeTraversor.traverse(new W3CBuilder(out), rootEl);
     }
 
+    /**
+     * Serialize a W3C document to a String. The output format will be XML or HTML depending on the content of the doc.
+     *
+     * @param doc Document
+     * @return Document as string
+     * @see W3CDom#asString(Document, Map)
+     */
+    public String asString(Document doc) {
+        return asString(doc, null);
+    }
+
     /**
      * Implements the conversion by walking the input.
      */
@@ -118,6 +230,7 @@ public class W3CDom {
                 dest.appendChild(node);
             } else {
                 // unhandled
+                // not that doctype is not handled here - rather it is used in the initial doc creation
             }
         }
 
@@ -163,36 +276,4 @@ public class W3CDom {
         }
 
     }
-
-    /**
-     * Serialize a W3C document to a String.
-     * @param doc Document
-     * @return Document as string
-     */
-    public String asString(Document doc) {
-        return asString(doc, null);
-    }
-
-    /**
-     * Serialize a W3C document to a String.
-     *
-     * @param doc Document
-     * @param properties the transformer output properties to use. See {@link Transformer#setOutputProperties(Properties)}
-     * @return Document as string
-     */
-    public String asString(Document doc, Properties properties) {
-        try {
-            DOMSource domSource = new DOMSource(doc);
-            StringWriter writer = new StringWriter();
-            StreamResult result = new StreamResult(writer);
-            TransformerFactory tf = TransformerFactory.newInstance();
-            Transformer transformer = tf.newTransformer();
-            transformer.setOutputProperties(properties);
-            transformer.setOutputProperty(METHOD, "xml");
-            transformer.transform(domSource, result);
-            return writer.toString();
-        } catch (TransformerException e) {
-            throw new IllegalStateException(e);
-        }
-    }
 }
diff --git a/src/main/java/org/jsoup/nodes/Document.java b/src/main/java/org/jsoup/nodes/Document.java
index fe389a38..92ae0b72 100644
--- a/src/main/java/org/jsoup/nodes/Document.java
+++ b/src/main/java/org/jsoup/nodes/Document.java
@@ -59,6 +59,21 @@ public class Document extends Element {
     public String location() {
      return location;
     }
+
+    /**
+     * Returns this Document's doctype.
+     * @return document type, or null if not set
+     */
+    public DocumentType documentType() {
+        for (Node node : childNodes) {
+            if (node instanceof DocumentType)
+                return (DocumentType) node;
+            else if (!(node instanceof LeafNode)) // scans forward across comments, text, processing instructions etc
+                break;
+        }
+        return null;
+        // todo - add a set document type?
+    }
     
     /**
      Accessor to the document's {@code head} element.
diff --git a/src/main/java/org/jsoup/nodes/DocumentType.java b/src/main/java/org/jsoup/nodes/DocumentType.java
index dbc08f37..b94f2c76 100644
--- a/src/main/java/org/jsoup/nodes/DocumentType.java
+++ b/src/main/java/org/jsoup/nodes/DocumentType.java
@@ -31,10 +31,8 @@ public class DocumentType extends LeafNode {
         Validate.notNull(systemId);
         attr(NAME, name);
         attr(PUBLIC_ID, publicId);
-        if (has(PUBLIC_ID)) {
-            attr(PUB_SYS_KEY, PUBLIC_KEY);
-        }
         attr(SYSTEM_ID, systemId);
+        updatePubSyskey();
     }
 
     /**
@@ -48,10 +46,8 @@ public class DocumentType extends LeafNode {
     public DocumentType(String name, String publicId, String systemId, String baseUri) {
         attr(NAME, name);
         attr(PUBLIC_ID, publicId);
-        if (has(PUBLIC_ID)) {
-            attr(PUB_SYS_KEY, PUBLIC_KEY);
-        }
         attr(SYSTEM_ID, systemId);
+        updatePubSyskey();
     }
 
     /**
@@ -64,17 +60,46 @@ public class DocumentType extends LeafNode {
      */
     public DocumentType(String name, String pubSysKey, String publicId, String systemId, String baseUri) {
         attr(NAME, name);
-        if (pubSysKey != null) {
-            attr(PUB_SYS_KEY, pubSysKey);
-        }
         attr(PUBLIC_ID, publicId);
         attr(SYSTEM_ID, systemId);
+        updatePubSyskey();
     }
     public void setPubSysKey(String value) {
         if (value != null)
             attr(PUB_SYS_KEY, value);
     }
 
+    private void updatePubSyskey() {
+        if (has(PUBLIC_ID)) {
+            attr(PUB_SYS_KEY, PUBLIC_KEY);
+        } else if (has(SYSTEM_ID))
+            attr(PUB_SYS_KEY, SYSTEM_KEY);
+    }
+
+    /**
+     * Get this doctype's name (when set, or empty string)
+     * @return doctype name
+     */
+    public String name() {
+        return attr(NAME);
+    }
+
+    /**
+     * Get this doctype's Public ID (when set, or empty string)
+     * @return doctype Public ID
+     */
+    public String publicId() {
+        return attr(PUBLIC_ID);
+    }
+
+    /**
+     * Get this doctype's System ID (when set, or empty string)
+     * @return doctype System ID
+     */
+    public String systemId() {
+        return attr(SYSTEM_ID);
+    }
+
     @Override
     public String nodeName() {
         return "#doctype";
diff --git a/src/test/java/org/jsoup/helper/W3CDomTest.java b/src/test/java/org/jsoup/helper/W3CDomTest.java
index 30691bf8..91c54b95 100644
--- a/src/test/java/org/jsoup/helper/W3CDomTest.java
+++ b/src/test/java/org/jsoup/helper/W3CDomTest.java
@@ -6,8 +6,12 @@ import org.jsoup.integration.ParseTest;
 import org.jsoup.nodes.Element;
 import org.junit.Test;
 import org.w3c.dom.Document;
+import org.w3c.dom.DocumentType;
 import org.w3c.dom.Node;
 import org.w3c.dom.NodeList;
+import org.xml.sax.EntityResolver;
+import org.xml.sax.InputSource;
+import org.xml.sax.SAXException;
 
 import javax.xml.parsers.DocumentBuilder;
 import javax.xml.parsers.DocumentBuilderFactory;
@@ -19,8 +23,9 @@ import javax.xml.xpath.XPathFactory;
 import java.io.ByteArrayInputStream;
 import java.io.File;
 import java.io.IOException;
+import java.io.StringReader;
 import java.nio.charset.StandardCharsets;
-import java.util.Properties;
+import java.util.Map;
 
 import static org.junit.Assert.*;
 
@@ -30,8 +35,19 @@ public class W3CDomTest {
         try {
             DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();
             factory.setNamespaceAware(nameSpaceAware);
-            DocumentBuilder documentBuilder = factory.newDocumentBuilder();
-            Document dom = documentBuilder.parse(new ByteArrayInputStream(xml.getBytes(StandardCharsets.UTF_8)));
+            DocumentBuilder builder = factory.newDocumentBuilder();
+            builder.setEntityResolver(new EntityResolver() {
+                @Override
+                public InputSource resolveEntity(String publicId, String systemId)
+                    throws SAXException, IOException {
+                    if (systemId.contains("about:legacy-compat")) { // <!doctype html>
+                        return new InputSource(new StringReader(""));
+                    } else {
+                        return null;
+                    }
+                }
+            });
+            Document dom = builder.parse(new ByteArrayInputStream(xml.getBytes(StandardCharsets.UTF_8)));
             dom.normalizeDocument();
             return dom;
         } catch (Exception e) {
@@ -49,18 +65,17 @@ public class W3CDomTest {
         NodeList meta = wDoc.getElementsByTagName("META");
         assertEquals(0, meta.getLength());
 
-        String out = w3c.asString(wDoc);
+        String out = W3CDom.asString(wDoc, W3CDom.OutputXml());
         String expected = "<?xml version=\"1.0\" encoding=\"UTF-8\"?><html><head><title>W3c</title></head><body><p class=\"one\" id=\"12\">Text</p><!-- comment --><invalid>What<script>alert('!')</script></invalid></body></html>";
         assertEquals(expected, TextUtil.stripNewlines(out));
 
-        String xml = w3c.asString(wDoc);
-        Document roundTrip = parseXml(xml, true);
+        Document roundTrip = parseXml(out, true);
         assertEquals("Text", roundTrip.getElementsByTagName("p").item(0).getTextContent());
 
         // check we can set properties
-        Properties properties = new Properties();
+        Map<String, String> properties = W3CDom.OutputXml();
         properties.put(OutputKeys.INDENT, "yes");
-        String furtherOut = w3c.asString(wDoc, properties);
+        String furtherOut = W3CDom.asString(wDoc, properties);
         assertTrue(furtherOut.length() > out.length()); // wanted to assert formatting, but actual indentation is platform specific so breaks in CI
         String furtherExpected =
             "<?xml version=\"1.0\" encoding=\"UTF-8\"?><html><head><title>W3c</title></head><body><p class=\"one\" id=\"12\">Text</p><!-- comment --><invalid>What<script>alert('!')</script></invalid></body></html>";
@@ -74,12 +89,17 @@ public class W3CDomTest {
 
         W3CDom w3c = new W3CDom();
         Document wDoc = w3c.fromJsoup(doc);
-        Node htmlEl = wDoc.getChildNodes().item(0);
+        Node htmlEl = wDoc.getChildNodes().item(1);
         assertNull(htmlEl.getNamespaceURI());
         assertEquals("html", htmlEl.getLocalName());
         assertEquals("html", htmlEl.getNodeName());
 
-        String xml = w3c.asString(wDoc);
+        DocumentType doctype = wDoc.getDoctype();
+        Node doctypeNode = wDoc.getChildNodes().item(0);
+        assertSame(doctype, doctypeNode);
+        assertEquals("html", doctype.getName());
+
+        String xml = W3CDom.asString(wDoc, W3CDom.OutputXml());
         assertTrue(xml.contains("ipod"));
 
         Document roundTrip = parseXml(xml, true);
@@ -230,5 +250,39 @@ public class W3CDomTest {
         XPathExpression xpath = XPathFactory.newInstance().newXPath().compile(query);
         return ((NodeList) xpath.evaluate(w3cDoc, XPathConstants.NODE));
     }
+
+    @Test
+    public void testRoundTripDoctype() {
+        // TODO - not super happy with this output - but plain DOM doesn't let it out, and don't want to rebuild the writer
+        String base = "<!DOCTYPE html><p>One</p>";
+        assertEquals("<!DOCTYPE html SYSTEM \"about:legacy-compat\"><html><head><META http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\"></head><body><p>One</p></body></html>",
+            output(base, true));
+        assertEquals("<?xml version=\"1.0\" encoding=\"UTF-8\"?><!DOCTYPE html SYSTEM \"about:legacy-compat\"><html><head/><body><p>One</p></body></html>", output(base, false));
+
+        String publicDoc = "<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">";
+        assertEquals("<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\"><html><head><META http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\"></head><body></body></html>", output(publicDoc, true));
+        assertEquals("<?xml version=\"1.0\" encoding=\"UTF-8\"?><!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\"><html><head /><body /></html>", output(publicDoc, false));
+
+        String systemDoc = "<!DOCTYPE html SYSTEM \"exampledtdfile.dtd\">";
+        assertEquals("<!DOCTYPE html SYSTEM \"exampledtdfile.dtd\"><html><head><META http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\"></head><body></body></html>", output(systemDoc, true));
+        assertEquals("<?xml version=\"1.0\" encoding=\"UTF-8\"?><!DOCTYPE html SYSTEM \"exampledtdfile.dtd\"><html><head/><body/></html>", output(systemDoc, false));
+
+        String legacyDoc = "<!DOCTYPE html SYSTEM \"about:legacy-compat\">";
+        assertEquals("<!DOCTYPE html SYSTEM \"about:legacy-compat\"><html><head><META http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\"></head><body></body></html>", output(legacyDoc, true));
+        assertEquals("<?xml version=\"1.0\" encoding=\"UTF-8\"?><!DOCTYPE html SYSTEM \"about:legacy-compat\"><html><head/><body/></html>", output(legacyDoc, false));
+
+        String noDoctype = "<p>One</p>";
+        assertEquals("<html><head><META http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\"></head><body><p>One</p></body></html>", output(noDoctype, true));
+        assertEquals("<?xml version=\"1.0\" encoding=\"UTF-8\"?><html><head/><body><p>One</p></body></html>", output(noDoctype, false));
+    }
+
+    private String output(String in, boolean modeHtml) {
+        org.jsoup.nodes.Document jdoc = Jsoup.parse(in);
+        Document w3c = W3CDom.convert(jdoc);
+
+        Map<String, String> properties = modeHtml ? W3CDom.OutputHtml() : W3CDom.OutputXml();
+        return TextUtil.stripNewlines(W3CDom.asString(w3c, properties));
+    }
+
 }
 
diff --git a/src/test/java/org/jsoup/nodes/DocumentTest.java b/src/test/java/org/jsoup/nodes/DocumentTest.java
index 0a56fa35..98bd1b27 100644
--- a/src/test/java/org/jsoup/nodes/DocumentTest.java
+++ b/src/test/java/org/jsoup/nodes/DocumentTest.java
@@ -100,13 +100,13 @@ public class DocumentTest {
     }
     
     @Test public void testLocation() throws IOException {
-    	File in = new ParseTest().getFile("/htmltests/yahoo-jp.html");
+    	File in = ParseTest.getFile("/htmltests/yahoo-jp.html");
         Document doc = Jsoup.parse(in, "UTF-8", "http://www.yahoo.co.jp/index.html");
         String location = doc.location();
         String baseUri = doc.baseUri();
         assertEquals("http://www.yahoo.co.jp/index.html",location);
         assertEquals("http://www.yahoo.co.jp/_ylh=X3oDMTB0NWxnaGxsBF9TAzIwNzcyOTYyNjUEdGlkAzEyBHRtcGwDZ2Ex/",baseUri);
-        in = new ParseTest().getFile("/htmltests/nyt-article-1.html");
+        in = ParseTest.getFile("/htmltests/nyt-article-1.html");
         doc = Jsoup.parse(in, null, "http://www.nytimes.com/2010/07/26/business/global/26bp.html?hp");
         location = doc.location();
         baseUri = doc.baseUri();
@@ -176,7 +176,7 @@ public class DocumentTest {
         assertFalse(docA.hashCode() == docC.hashCode());
     }
 
-    @Test public void DocumentsWithSameContentAreVerifialbe() throws Exception {
+    @Test public void DocumentsWithSameContentAreVerifiable() throws Exception {
         Document docA = Jsoup.parse("<div/>One");
         Document docB = Jsoup.parse("<div/>One");
         Document docC = Jsoup.parse("<div/>Two");
@@ -454,4 +454,12 @@ public class DocumentTest {
         assertEquals(StandardCharsets.US_ASCII, doc.outputSettings().charset());
         assertEquals(asci, p.outerHtml());
     }
+
+    @Test public void testDocumentTypeGet() {
+        String html = "\n\n<!-- comment -->  <!doctype html><p>One</p>";
+        Document doc = Jsoup.parse(html);
+        DocumentType documentType = doc.documentType();
+        assertNotNull(documentType);
+        assertEquals("html", documentType.name());
+    }
 }
diff --git a/src/test/java/org/jsoup/nodes/DocumentTypeTest.java b/src/test/java/org/jsoup/nodes/DocumentTypeTest.java
index 7f32adb1..443feb75 100644
--- a/src/test/java/org/jsoup/nodes/DocumentTypeTest.java
+++ b/src/test/java/org/jsoup/nodes/DocumentTypeTest.java
@@ -35,10 +35,13 @@ public class DocumentTypeTest {
         assertEquals("<!DOCTYPE html PUBLIC \"-//IETF//DTD HTML//\">", publicDocType.outerHtml());
 
         DocumentType systemDocType = new DocumentType("html", "", "http://www.ibm.com/data/dtd/v11/ibmxhtml1-transitional.dtd");
-        assertEquals("<!DOCTYPE html \"http://www.ibm.com/data/dtd/v11/ibmxhtml1-transitional.dtd\">", systemDocType.outerHtml());
+        assertEquals("<!DOCTYPE html SYSTEM \"http://www.ibm.com/data/dtd/v11/ibmxhtml1-transitional.dtd\">", systemDocType.outerHtml());
 
         DocumentType combo = new DocumentType("notHtml", "--public", "--system");
         assertEquals("<!DOCTYPE notHtml PUBLIC \"--public\" \"--system\">", combo.outerHtml());
+        assertEquals("notHtml", combo.name());
+        assertEquals("--public", combo.publicId());
+        assertEquals("--system", combo.systemId());
     }
 
     @Test public void testRoundTrip() {
