diff --git a/CHANGES b/CHANGES
index 2b85a9be..fb1ed151 100644
--- a/CHANGES
+++ b/CHANGES
@@ -11,6 +11,9 @@ jsoup changelog
  * Improved "abs:" absolute URL handling in Elements.attr("abs:href") and Node.hasAttr("abs:href").
    <https://github.com/jhy/jsoup/issues/97>
 
+ * Fixed cookie handling issue in jsoup.Connect where empty cookies would cause a validation exception.
+   <https://github.com/jhy/jsoup/issues/87>
+
 *** Release 1.5.2 [2011-02-27]
  * Fixed issue with selector parser where some boolean AND + OR combined queries (e.g. "meta[http-equiv], meta[content]")
    were being parsed incorrectly as OR only queries (e.g. former as "meta, [http-equiv], meta[content]")
diff --git a/src/main/java/org/jsoup/helper/HttpConnection.java b/src/main/java/org/jsoup/helper/HttpConnection.java
index 4b1cf4dc..8187e0c4 100644
--- a/src/main/java/org/jsoup/helper/HttpConnection.java
+++ b/src/main/java/org/jsoup/helper/HttpConnection.java
@@ -453,38 +453,46 @@ public class HttpConnection implements Connection {
             statusMessage = conn.getResponseMessage();
             contentType = conn.getContentType();
 
-            // headers into map
             Map<String, List<String>> resHeaders = conn.getHeaderFields();
+            processResponseHeaders(resHeaders);
+
+            // if from a redirect, map previous response cookies into this response
+            if (previousResponse != null) {
+                for (Map.Entry<String, String> prevCookie : previousResponse.cookies().entrySet()) {
+                    if (!hasCookie(prevCookie.getKey()))
+                        cookie(prevCookie.getKey(), prevCookie.getValue());
+                }
+            }
+        }
+
+        void processResponseHeaders(Map<String, List<String>> resHeaders) {
             for (Map.Entry<String, List<String>> entry : resHeaders.entrySet()) {
                 String name = entry.getKey();
                 if (name == null)
                     continue; // http/1.1 line
 
                 List<String> values = entry.getValue();
-
                 if (name.equalsIgnoreCase("Set-Cookie")) {
                     for (String value : values) {
+                        if (value == null)
+                            continue;
                         TokenQueue cd = new TokenQueue(value);
                         String cookieName = cd.chompTo("=").trim();
                         String cookieVal = cd.consumeTo(";").trim();
+                        if (cookieVal == null)
+                            cookieVal = "";
                         // ignores path, date, domain, secure et al. req'd?
-                        cookie(cookieName, cookieVal);
+                        // name not blank, value not null
+                        if (cookieName != null && cookieName.length() > 0)
+                            cookie(cookieName, cookieVal);
                     }
                 } else { // only take the first instance of each header
                     if (!values.isEmpty())
                         header(name, values.get(0));
                 }
             }
-
-            // if from a redirect, map previous response cookies into this response
-            if (previousResponse != null) {
-                for (Map.Entry<String, String> prevCookie : previousResponse.cookies().entrySet()) {
-                    if (!hasCookie(prevCookie.getKey()))
-                        cookie(prevCookie.getKey(), prevCookie.getValue());
-                }
-            }
         }
-        
+
         private static void writePost(Collection<Connection.KeyVal> data, OutputStream outputStream) throws IOException {
             OutputStreamWriter w = new OutputStreamWriter(outputStream, DataUtil.defaultCharset);
             boolean first = true;
diff --git a/src/test/java/org/jsoup/helper/HttpConnectionTest.java b/src/test/java/org/jsoup/helper/HttpConnectionTest.java
index 69f65441..092c73d5 100644
--- a/src/test/java/org/jsoup/helper/HttpConnectionTest.java
+++ b/src/test/java/org/jsoup/helper/HttpConnectionTest.java
@@ -5,8 +5,7 @@ import org.junit.Test;
 import org.jsoup.Connection;
 
 import java.io.IOException;
-import java.util.Map;
-import java.util.Collection;
+import java.util.*;
 import java.net.URL;
 import java.net.MalformedURLException;
 
@@ -51,6 +50,36 @@ public class HttpConnectionTest {
         assertEquals("deflate", res.header("accept-Encoding"));
     }
 
+    @Test public void ignoresEmptySetCookies() {
+        // prep http response header map
+        Map<String, List<String>> headers = new HashMap<String, List<String>>();
+        headers.put("Set-Cookie", Collections.<String>emptyList());
+        HttpConnection.Response res = new HttpConnection.Response();
+        res.processResponseHeaders(headers);
+        assertEquals(0, res.cookies().size());
+    }
+
+    @Test public void ignoresEmptyCookieNameAndVals() {
+        // prep http response header map
+        Map<String, List<String>> headers = new HashMap<String, List<String>>();
+        List<String> cookieStrings = new ArrayList<String>();
+        cookieStrings.add(null);
+        cookieStrings.add("");
+        cookieStrings.add("one");
+        cookieStrings.add("two=");
+        cookieStrings.add("three=;");
+        cookieStrings.add("four=data; Domain=.example.com; Path=/");
+
+        headers.put("Set-Cookie", cookieStrings);
+        HttpConnection.Response res = new HttpConnection.Response();
+        res.processResponseHeaders(headers);
+        assertEquals(4, res.cookies().size());
+        assertEquals("", res.cookie("one"));
+        assertEquals("", res.cookie("two"));
+        assertEquals("", res.cookie("three"));
+        assertEquals("data", res.cookie("four"));
+    }
+
     @Test public void connectWithUrl() throws MalformedURLException {
         Connection con = HttpConnection.connect(new URL("http://example.com"));
         assertEquals("http://example.com", con.request().url().toExternalForm());
