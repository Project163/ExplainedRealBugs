diff --git a/CHANGES b/CHANGES
index 73f0ecc6..2073c34a 100644
--- a/CHANGES
+++ b/CHANGES
@@ -7,6 +7,9 @@ jsoup changelog
  * Fixed support for self-closing script tags.
    <https://github.com/jhy/jsoup/issues/305>
 
+ * Fixed a crash when reading an unterminated CDATA section.
+   <https://github.com/jhy/jsoup/issues/349>
+
 *** Release 1.7.2 [2013-Jan-27]
  * Added support for supplementary characters outside of the Basic Multilingual Plane.
    <https://github.com/jhy/jsoup/issues/288> <https://github.com/jhy/jsoup/pull/289>
diff --git a/src/main/java/org/jsoup/parser/CharacterReader.java b/src/main/java/org/jsoup/parser/CharacterReader.java
index d4142ef5..f8e0eb07 100644
--- a/src/main/java/org/jsoup/parser/CharacterReader.java
+++ b/src/main/java/org/jsoup/parser/CharacterReader.java
@@ -86,9 +86,9 @@ class CharacterReader {
             // scan to first instance of startchar:
             if (startChar != input[offset])
                 while(++offset < length && startChar != input[offset]);
-            if (offset < length) {
-                int i = offset + 1;
-                int last = i + seq.length()-1;
+            int i = offset + 1;
+            int last = i + seq.length()-1;
+            if (offset < length && last <= length) {
                 for (int j = 1; i < last && seq.charAt(j) == input[i]; i++, j++);
                 if (i == last) // found full sequence
                     return offset - pos;
diff --git a/src/test/java/org/jsoup/parser/CharacterReaderTest.java b/src/test/java/org/jsoup/parser/CharacterReaderTest.java
index 0a1176ac..8f32251d 100644
--- a/src/test/java/org/jsoup/parser/CharacterReaderTest.java
+++ b/src/test/java/org/jsoup/parser/CharacterReaderTest.java
@@ -95,6 +95,11 @@ public class CharacterReaderTest {
         assertEquals(-1, r.nextIndexOf("Two"));
     }
 
+    @Test public void nextIndexOfUnmatched() {
+        CharacterReader r = new CharacterReader("<[[one]]");
+        assertEquals(-1, r.nextIndexOf("]]>"));
+    }
+
     @Test public void consumeToChar() {
         CharacterReader r = new CharacterReader("One Two Three");
         assertEquals("One ", r.consumeTo('T'));
diff --git a/src/test/java/org/jsoup/parser/HtmlParserTest.java b/src/test/java/org/jsoup/parser/HtmlParserTest.java
index c7174330..6aeaeaca 100644
--- a/src/test/java/org/jsoup/parser/HtmlParserTest.java
+++ b/src/test/java/org/jsoup/parser/HtmlParserTest.java
@@ -287,6 +287,13 @@ public class HtmlParserTest {
         assertEquals(1, div.childNodeSize()); // no elements, one text node
     }
 
+    @Test public void handlesUnclosedCdataAtEOF() {
+        // https://github.com/jhy/jsoup/issues/349 would crash, as character reader would try to seek past EOF
+        String h = "<![CDATA[]]";
+        Document doc = Jsoup.parse(h);
+        assertEquals(1, doc.body().childNodeSize());
+    }
+
     @Test public void handlesInvalidStartTags() {
         String h = "<div>Hello < There <&amp;></div>"; // parse to <div {#text=Hello < There <&>}>
         Document doc = Jsoup.parse(h);
