diff --git a/CHANGES.md b/CHANGES.md
index 33c609ee..759adefe 100644
--- a/CHANGES.md
+++ b/CHANGES.md
@@ -11,6 +11,7 @@
 * When using the JDK HttpClient, any system default proxy (`ProxySelector.getDefault()`) was ignored. Now, the system proxy is used if a per-request proxy is not set. [#2388](https://github.com/jhy/jsoup/issues/2388), [#2390](https://github.com/jhy/jsoup/pull/2390)
 * A ValidationException could be thrown in the adoption agency algorithm with particularly broken input. Now logged as a parse error. [#2393](https://github.com/jhy/jsoup/issues/2393)
 * Null characters in the HTML body were not consistently removed; and in foreign content were not correctly replaced. [#2395](https://github.com/jhy/jsoup/issues/2395)
+* An IndexOutOfBoundsException could be thrown when parsing a body fragment with crafted input. Now logged as a parse error. [#2397](https://github.com/jhy/jsoup/issues/2397)
 
 
 ## 1.21.2 (2025-Aug-25)
diff --git a/src/main/java/org/jsoup/parser/HtmlTreeBuilderState.java b/src/main/java/org/jsoup/parser/HtmlTreeBuilderState.java
index 67ed2477..cd44dc01 100644
--- a/src/main/java/org/jsoup/parser/HtmlTreeBuilderState.java
+++ b/src/main/java/org/jsoup/parser/HtmlTreeBuilderState.java
@@ -1687,7 +1687,7 @@ enum HtmlTreeBuilderState {
                         return false;
                 }
             } else if (t.isEndTag() && t.asEndTag().normalName().equals("frameset")) {
-                if (tb.currentElementIs("html")) { // frag
+                if (!tb.currentElementIs("frameset")) { // spec checks if el is html; deviate to confirm we are about to pop the frameset el
                     tb.error(this);
                     return false;
                 } else {
diff --git a/src/test/java/org/jsoup/integration/FuzzFixesTest.java b/src/test/java/org/jsoup/integration/FuzzFixesTest.java
index 01191b8c..d6e1be20 100644
--- a/src/test/java/org/jsoup/integration/FuzzFixesTest.java
+++ b/src/test/java/org/jsoup/integration/FuzzFixesTest.java
@@ -56,6 +56,14 @@ public class FuzzFixesTest {
         assertNotNull(doc);
     }
 
+    @ParameterizedTest
+    @MethodSource("testFiles")
+    void testHtmlFragmentParse(File file) throws IOException {
+        String html = ParseTest.getFileAsString(file);
+        Document doc = Jsoup.parseBodyFragment(html);
+        assertNotNull(doc);
+    }
+
     @ParameterizedTest
     @MethodSource("testFiles")
     void testXmlParse(File file) throws IOException {
diff --git a/src/test/resources/fuzztests/2397.html.gz b/src/test/resources/fuzztests/2397.html.gz
new file mode 100644
index 00000000..81900aa3
Binary files /dev/null and b/src/test/resources/fuzztests/2397.html.gz differ
diff --git a/src/test/resources/fuzztests/48116.html.gz b/src/test/resources/fuzztests/48116.html.gz
index 37367dc8..748c5efd 100644
Binary files a/src/test/resources/fuzztests/48116.html.gz and b/src/test/resources/fuzztests/48116.html.gz differ
