diff --git a/src/main/java/org/jsoup/helper/DataUtil.java b/src/main/java/org/jsoup/helper/DataUtil.java
index dab3bc2b..33457c3a 100644
--- a/src/main/java/org/jsoup/helper/DataUtil.java
+++ b/src/main/java/org/jsoup/helper/DataUtil.java
@@ -7,6 +7,7 @@ import org.jsoup.parser.Parser;
 import java.io.*;
 import java.nio.ByteBuffer;
 import java.nio.charset.Charset;
+import java.nio.charset.IllegalCharsetNameException;
 import java.util.regex.Matcher;
 import java.util.regex.Pattern;
 import java.util.Locale;
@@ -16,7 +17,7 @@ import java.util.Locale;
  *
  */
 public class DataUtil {
-    private static final Pattern charsetPattern = Pattern.compile("(?i)\\bcharset=\\s*\"?([^\\s;\"]*)");
+    private static final Pattern charsetPattern = Pattern.compile("(?i)\\bcharset=\\s*(?:\"|')?([^\\s,;\"']*)");
     static final String defaultCharset = "UTF-8"; // used if not found in header or meta charset
     private static final int bufferSize = 0x20000; // ~130K.
 
@@ -80,8 +81,25 @@ public class DataUtil {
             doc = parser.parseInput(docData, baseUri);
             Element meta = doc.select("meta[http-equiv=content-type], meta[charset]").first();
             if (meta != null) { // if not found, will keep utf-8 as best attempt
-                String foundCharset = meta.hasAttr("http-equiv") ? getCharsetFromContentType(meta.attr("content")) : meta.attr("charset");
+
+                String foundCharset;
+                if (meta.hasAttr("http-equiv")) {
+                    foundCharset = getCharsetFromContentType(meta.attr("content"));
+                    if (foundCharset == null && meta.hasAttr("charset")) {
+                        try {
+                            if (Charset.isSupported(meta.attr("charset"))) {
+                                foundCharset = meta.attr("charset");
+                            }
+                        } catch (IllegalCharsetNameException e) {
+                            foundCharset = null;
+                        }
+                    }
+                } else {
+                    foundCharset = meta.attr("charset");
+                }
+
                 if (foundCharset != null && foundCharset.length() != 0 && !foundCharset.equals(defaultCharset)) { // need to re-decode
+                    foundCharset = foundCharset.trim().replaceAll("[\"']", "");
                     charsetName = foundCharset;
                     byteData.rewind();
                     docData = Charset.forName(foundCharset).decode(byteData).toString();
@@ -151,9 +169,16 @@ public class DataUtil {
         Matcher m = charsetPattern.matcher(contentType);
         if (m.find()) {
             String charset = m.group(1).trim();
-            if (Charset.isSupported(charset)) return charset;
-            charset = charset.toUpperCase(Locale.ENGLISH);
-            if (Charset.isSupported(charset)) return charset;
+            charset = charset.replace("charset=", "");
+            if (charset.isEmpty()) return null;
+            try {
+                if (Charset.isSupported(charset)) return charset;
+                charset = charset.toUpperCase(Locale.ENGLISH);
+                if (Charset.isSupported(charset)) return charset;
+            } catch (IllegalCharsetNameException e) {
+                // if our advanced charset matching fails.... we just take the default
+                return null;
+            }
         }
         return null;
     }
diff --git a/src/main/java/org/jsoup/helper/HttpConnection.java b/src/main/java/org/jsoup/helper/HttpConnection.java
index f748c229..49404708 100644
--- a/src/main/java/org/jsoup/helper/HttpConnection.java
+++ b/src/main/java/org/jsoup/helper/HttpConnection.java
@@ -453,7 +453,12 @@ public class HttpConnection implements Connection {
                 if (needsRedirect && req.followRedirects()) {
                     req.method(Method.GET); // always redirect with a get. any data param from original req are dropped.
                     req.data().clear();
-                    req.url(new URL(req.url(), encodeUrl(res.header("Location"))));
+
+                    String location = res.header("Location");
+                    if (location != null && location.startsWith("http:/") && location.charAt(6) != '/') // fix broken Location: http:/temp/AAG_New/en/index.php
+                        location = location.substring(6);
+                    req.url(new URL(req.url(), encodeUrl(location)));
+
                     for (Map.Entry<String, String> cookie : res.cookies.entrySet()) { // add response cookies to request (for e.g. login posts)
                         req.cookie(cookie.getKey(), cookie.getValue());
                     }
diff --git a/src/test/java/org/jsoup/helper/DataUtilTest.java b/src/test/java/org/jsoup/helper/DataUtilTest.java
index a810ac75..3db6d2a3 100644
--- a/src/test/java/org/jsoup/helper/DataUtilTest.java
+++ b/src/test/java/org/jsoup/helper/DataUtilTest.java
@@ -1,7 +1,5 @@
 package org.jsoup.helper;
 
-import static org.junit.Assert.assertEquals;
-
 import org.jsoup.nodes.Document;
 import org.jsoup.parser.Parser;
 import org.junit.Test;
@@ -9,6 +7,8 @@ import org.junit.Test;
 import java.nio.ByteBuffer;
 import java.nio.charset.Charset;
 
+import static org.junit.Assert.assertEquals;
+
 public class DataUtilTest {
     @Test
     public void testCharset() {
@@ -25,12 +25,35 @@ public class DataUtilTest {
         assertEquals("UTF-8", DataUtil.getCharsetFromContentType("text/html;charset=\"UTF-8\""));
         assertEquals("ISO-8859-1", DataUtil.getCharsetFromContentType("text/html; charset=\"ISO-8859-1\""));
         assertEquals(null, DataUtil.getCharsetFromContentType("text/html; charset=\"Unsupported\""));
+        assertEquals("UTF-8", DataUtil.getCharsetFromContentType("text/html; charset='UTF-8'"));
     }
-    
+
     @Test public void discardsSpuriousByteOrderMark() {
         String html = "\uFEFF<html><head><title>One</title></head><body>Two</body></html>";
         ByteBuffer buffer = Charset.forName("UTF-8").encode(html);
         Document doc = DataUtil.parseByteData(buffer, "UTF-8", "http://foo.com/", Parser.htmlParser());
         assertEquals("One", doc.head().text());
     }
+
+    @Test
+    public void shouldNotThrowExceptionOnEmptyCharset() {
+        assertEquals(null, DataUtil.getCharsetFromContentType("text/html; charset="));
+        assertEquals(null, DataUtil.getCharsetFromContentType("text/html; charset=;"));
+    }
+
+    @Test
+    public void shouldSelectFirstCharsetOnWeirdMultileCharsetsInMetaTags() {
+        assertEquals("ISO-8859-1", DataUtil.getCharsetFromContentType("text/html; charset=ISO-8859-1, charset=1251"));
+    }
+
+    @Test
+    public void shouldCorrectCharsetForDuplicateCharsetString() {
+        assertEquals("iso-8859-1", DataUtil.getCharsetFromContentType("text/html; charset=charset=iso-8859-1"));
+    }
+
+    @Test
+    public void shouldReturnNullForIllegalCharsetNames() {
+        assertEquals(null, DataUtil.getCharsetFromContentType("text/html; charset=$HJKDF§$/("));
+    }
+
 }
diff --git a/src/test/java/org/jsoup/integration/ParseTest.java b/src/test/java/org/jsoup/integration/ParseTest.java
index 240bacc4..ed026d22 100644
--- a/src/test/java/org/jsoup/integration/ParseTest.java
+++ b/src/test/java/org/jsoup/integration/ParseTest.java
@@ -4,13 +4,13 @@ import org.jsoup.Jsoup;
 import org.jsoup.nodes.Document;
 import org.jsoup.nodes.Element;
 import org.jsoup.select.Elements;
-import static org.junit.Assert.*;
 import org.junit.Test;
 
-import java.io.File;
-import java.io.IOException;
+import java.io.*;
 import java.net.URISyntaxException;
 
+import static org.junit.Assert.*;
+
 /**
  * Integration test: parses from real-world example HTML.
  *
@@ -22,9 +22,9 @@ public class ParseTest {
     public void testSmhBizArticle() throws IOException {
         File in = getFile("/htmltests/smh-biz-article-1.html");
         Document doc = Jsoup.parse(in, "UTF-8",
-            "http://www.smh.com.au/business/the-boards-next-fear-the-female-quota-20100106-lteq.html");
+                "http://www.smh.com.au/business/the-boards-next-fear-the-female-quota-20100106-lteq.html");
         assertEquals("The board’s next fear: the female quota",
-            doc.title()); // note that the apos in the source is a literal ’ (8217), not escaped or '
+                doc.title()); // note that the apos in the source is a literal ’ (8217), not escaped or '
         assertEquals("en", doc.select("html").attr("xml:lang"));
 
         Elements articleBody = doc.select(".articleBody > *");
@@ -46,8 +46,8 @@ public class ParseTest {
 
         Element hs = doc.select("a[href*=naughty-corners-are-a-bad-idea]").first();
         assertEquals(
-            "http://www.heraldsun.com.au/news/naughty-corners-are-a-bad-idea-for-kids/story-e6frf7jo-1225817899003",
-            hs.attr("href"));
+                "http://www.heraldsun.com.au/news/naughty-corners-are-a-bad-idea-for-kids/story-e6frf7jo-1225817899003",
+                hs.attr("href"));
         assertEquals(hs.attr("href"), hs.attr("abs:href"));
     }
 
@@ -59,10 +59,10 @@ public class ParseTest {
         Elements results = doc.select("h3.r > a");
         assertEquals(12, results.size());
         assertEquals(
-            "http://news.google.com/news?hl=en&q=ipod&um=1&ie=UTF-8&ei=uYlKS4SbBoGg6gPf-5XXCw&sa=X&oi=news_group&ct=title&resnum=1&ved=0CCIQsQQwAA",
-            results.get(0).attr("href"));
+                "http://news.google.com/news?hl=en&q=ipod&um=1&ie=UTF-8&ei=uYlKS4SbBoGg6gPf-5XXCw&sa=X&oi=news_group&ct=title&resnum=1&ved=0CCIQsQQwAA",
+                results.get(0).attr("href"));
         assertEquals("http://www.apple.com/itunes/",
-            results.get(1).attr("href"));
+                results.get(1).attr("href"));
     }
 
     @Test
@@ -80,7 +80,7 @@ public class ParseTest {
         assertEquals("Yahoo! JAPAN", doc.title());
         Element a = doc.select("a[href=t/2322m2]").first();
         assertEquals("http://www.yahoo.co.jp/_ylh=X3oDMTB0NWxnaGxsBF9TAzIwNzcyOTYyNjUEdGlkAzEyBHRtcGwDZ2Ex/t/2322m2",
-            a.attr("abs:href")); // session put into <base>
+                a.attr("abs:href")); // session put into <base>
         assertEquals("全国、人気の駅ランキング", a.text());
     }
 
@@ -89,7 +89,7 @@ public class ParseTest {
         // tests <meta http-equiv="Content-Type" content="text/html;charset=gb2312">
         File in = getFile("/htmltests/baidu-cn-home.html");
         Document doc = Jsoup.parse(in, null,
-            "http://www.baidu.com/"); // http charset is gb2312, but NOT specifying it, to test http-equiv parse
+                "http://www.baidu.com/"); // http charset is gb2312, but NOT specifying it, to test http-equiv parse
         Element submit = doc.select("#su").first();
         assertEquals("百度一下", submit.attr("value"));
 
@@ -105,7 +105,7 @@ public class ParseTest {
 
         doc.outputSettings().charset("ascii");
         assertEquals("<title>&#x767e;&#x5ea6;&#x4e00;&#x4e0b;&#xff0c;&#x4f60;&#x5c31;&#x77e5;&#x9053;      </title>",
-            doc.select("title").outerHtml());
+                doc.select("title").outerHtml());
     }
 
     @Test
@@ -113,7 +113,7 @@ public class ParseTest {
         // tests <meta charset> when preceded by another <meta>
         File in = getFile("/htmltests/baidu-variant.html");
         Document doc = Jsoup.parse(in, null,
-            "http://www.baidu.com/"); // http charset is gb2312, but NOT specifying it, to test http-equiv parse
+                "http://www.baidu.com/"); // http charset is gb2312, but NOT specifying it, to test http-equiv parse
         // check auto-detect from meta
         assertEquals("GB2312", doc.outputSettings().charset().displayName());
         assertEquals("<title>百度一下，你就知道</title>", doc.select("title").outerHtml());
@@ -140,6 +140,16 @@ public class ParseTest {
         assertEquals("新", doc.text());
     }
 
+    @Test
+    public void testBrokenHtml5CharsetWithASingleDoubleQuote() throws IOException {
+        InputStream in = inputStreamFrom("<html>\n" +
+                "<head><meta charset=UTF-8\"></head>\n" +
+                "<body></body>\n" +
+                "</html>");
+        Document doc = Jsoup.parse(in, null, "http://example.com/");
+        assertEquals("UTF-8", doc.outputSettings().charset().displayName());
+    }
+
     @Test
     public void testNytArticle() throws IOException {
         // has tags like <nyt_text>
@@ -149,7 +159,7 @@ public class ParseTest {
         Element headline = doc.select("nyt_headline[version=1.0]").first();
         assertEquals("As BP Lays Out Future, It Will Not Include Hayward", headline.text());
     }
-    
+
     @Test
     public void testYahooArticle() throws IOException {
         File in = getFile("/htmltests/yahoo-article-1.html");
@@ -162,9 +172,17 @@ public class ParseTest {
         try {
             File file = new File(ParseTest.class.getResource(resourceName).toURI());
             return file;
-        }
-        catch (URISyntaxException e) {
+        } catch (URISyntaxException e) {
             throw new IllegalStateException(e);
         }
     }
+
+    private InputStream inputStreamFrom(String s) {
+        try {
+            return new ByteArrayInputStream(s.getBytes("UTF-8"));
+        } catch (UnsupportedEncodingException e) {
+            throw new RuntimeException(e);
+        }
+    }
+
 }
diff --git a/src/test/java/org/jsoup/integration/UrlConnectTest.java b/src/test/java/org/jsoup/integration/UrlConnectTest.java
index d8316640..1b7e34f5 100644
--- a/src/test/java/org/jsoup/integration/UrlConnectTest.java
+++ b/src/test/java/org/jsoup/integration/UrlConnectTest.java
@@ -1,19 +1,21 @@
 package org.jsoup.integration;
 
+import org.jsoup.Connection;
 import org.jsoup.HttpStatusException;
+import org.jsoup.Jsoup;
 import org.jsoup.UnsupportedMimeTypeException;
-import org.junit.Test;
-import org.junit.Ignore;
-import static org.junit.Assert.*;
 import org.jsoup.nodes.Document;
-import org.jsoup.Jsoup;
-import org.jsoup.Connection;
+import org.junit.Ignore;
+import org.junit.Test;
 
+import java.io.IOException;
 import java.net.MalformedURLException;
 import java.net.URL;
-import java.io.IOException;
 import java.util.Map;
 
+import static org.junit.Assert.assertEquals;
+import static org.junit.Assert.assertTrue;
+
 /**
  Tests the URL connection. Not enabled by default, so tests don't require network connection.
 
@@ -154,6 +156,13 @@ public class UrlConnectTest {
         assertTrue(doc.title().contains("Google"));
     }
 
+    @Test
+    public void gracefullyHandleBrokenLocationRedirect() throws IOException {
+        Connection con = Jsoup.connect("http://aag-ye.com"); // has Location: http:/temp/AAG_New/en/index.php
+        con.get(); // would throw exception on error
+        assertTrue(true);
+    }
+
     @Test
     public void throwsExceptionOnError() {
         String url = "http://direct.infohound.net/tools/404";
@@ -260,4 +269,44 @@ public class UrlConnectTest {
         assertEquals(actualDocText, largeRes.parse().text().length());
         assertEquals(actualDocText, unlimitedRes.parse().text().length());
     }
+
+    @Test
+    public void shouldWorkForCharsetInExtraAttribute() throws IOException {
+        Connection.Response res = Jsoup.connect("https://www.creditmutuel.com/groupe/fr/").execute();
+        Document doc = res.parse(); // would throw an error if charset unsupported
+        assertEquals("ISO-8859-1", res.charset());
+    }
+
+    // The following tests were added to test specific domains if they work. All code paths
+    // which make the following test green are tested in other unit or integration tests, so the following lines
+    // could be deleted
+
+    @Test
+    public void shouldSelectFirstCharsetOnWeirdMultileCharsetsInMetaTags() throws IOException {
+        Connection.Response res = Jsoup.connect("http://aamo.info/").execute();
+        res.parse(); // would throw an error if charset unsupported
+        assertEquals("ISO-8859-1", res.charset());
+    }
+
+    @Test
+    public void shouldParseBrokenHtml5MetaCharsetTagCorrectly() throws IOException {
+        Connection.Response res = Jsoup.connect("http://9kuhkep.net").execute();
+        res.parse(); // would throw an error if charset unsupported
+        assertEquals("UTF-8", res.charset());
+    }
+
+    @Test
+    public void shouldEmptyMetaCharsetCorrectly() throws IOException {
+        Connection.Response res = Jsoup.connect("http://aastmultimedia.com").execute();
+        res.parse(); // would throw an error if charset unsupported
+        assertEquals("UTF-8", res.charset());
+    }
+
+    @Test
+    public void shouldWorkForDuplicateCharsetInTag() throws IOException {
+        Connection.Response res = Jsoup.connect("http://aaptsdassn.org").execute();
+        Document doc = res.parse(); // would throw an error if charset unsupported
+        assertEquals("ISO-8859-1", res.charset());
+    }
+
 }
