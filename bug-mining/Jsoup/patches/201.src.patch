diff --git a/CHANGES b/CHANGES
index d50beefb..6cc6c757 100644
--- a/CHANGES
+++ b/CHANGES
@@ -8,6 +8,10 @@ jsoup changelog
   * Improvement: added Element chaining methods for various overridden methods on Node.
     <https://github.com/jhy/jsoup/issues/1193>
 
+  * Bugfix: if duplicate attributes in an element exist, retain the first vs the last attribute with the same name. Case
+    aware (HTML case-insensitive names, XML are case-sensitive).
+    <https://github.com/jhy/jsoup/issues/1219>
+
   * Various code hygiene updates.
 
 **** Release 1.12.1 [2019-May12]
diff --git a/src/main/java/org/jsoup/nodes/Attributes.java b/src/main/java/org/jsoup/nodes/Attributes.java
index b3fe49a6..85dabcf2 100644
--- a/src/main/java/org/jsoup/nodes/Attributes.java
+++ b/src/main/java/org/jsoup/nodes/Attributes.java
@@ -1,8 +1,9 @@
 package org.jsoup.nodes;
 
 import org.jsoup.SerializationException;
-import org.jsoup.internal.StringUtil;
 import org.jsoup.helper.Validate;
+import org.jsoup.internal.StringUtil;
+import org.jsoup.parser.ParseSettings;
 
 import java.io.IOException;
 import java.util.AbstractMap;
@@ -111,12 +112,16 @@ public class Attributes implements Iterable<Attribute>, Cloneable {
         return i == NotFound ? EmptyString : checkNotNull(vals[i]);
     }
 
-    // adds without checking if this key exists
-    private void add(String key, String value) {
+    /**
+     * Adds a new attribute. Will produce duplicates if the key already exists.
+     * @see Attributes#put(String, String)
+     */
+    public Attributes add(String key, String value) {
         checkCapacity(size + 1);
         keys[size] = key;
         vals[size] = value;
         size++;
+        return this;
     }
 
     /**
@@ -230,6 +235,13 @@ public class Attributes implements Iterable<Attribute>, Cloneable {
         return size;
     }
 
+    /**
+     * Test if this Attributes list is empty (size==0).
+     */
+    public boolean isEmpty() {
+        return size == 0;
+    }
+
     /**
      Add all the attributes from the incoming set to this set.
      @param incoming attributes to add to these attributes.
@@ -382,6 +394,30 @@ public class Attributes implements Iterable<Attribute>, Cloneable {
         }
     }
 
+    /**
+     * Internal method. Removes duplicate attribute by name. Settings for case sensitivity of key names.
+     * @param settings case sensitivity
+     * @return number of removed dupes
+     */
+    public int deduplicate(ParseSettings settings) {
+        if (isEmpty())
+            return 0;
+        boolean preserve = settings.preserveAttributeCase();
+        int dupes = 0;
+        OUTER: for (int i = 0; i < keys.length; i++) {
+            for (int j = i + 1; j < keys.length; j++) {
+                if (keys[j] == null)
+                    continue OUTER; // keys.length doesn't shrink when removing, so re-test
+                if ((preserve && keys[i].equals(keys[j])) || (!preserve && keys[i].equalsIgnoreCase(keys[j]))) {
+                    dupes++;
+                    remove(j);
+                    j--;
+                }
+            }
+        }
+        return dupes;
+    }
+
     private static class Dataset extends AbstractMap<String, String> {
         private final Attributes attributes;
 
diff --git a/src/main/java/org/jsoup/parser/HtmlTreeBuilder.java b/src/main/java/org/jsoup/parser/HtmlTreeBuilder.java
index fd7d2bfb..099859d1 100644
--- a/src/main/java/org/jsoup/parser/HtmlTreeBuilder.java
+++ b/src/main/java/org/jsoup/parser/HtmlTreeBuilder.java
@@ -1,7 +1,7 @@
 package org.jsoup.parser;
 
-import org.jsoup.internal.StringUtil;
 import org.jsoup.helper.Validate;
+import org.jsoup.internal.StringUtil;
 import org.jsoup.nodes.CDataNode;
 import org.jsoup.nodes.Comment;
 import org.jsoup.nodes.DataNode;
@@ -194,7 +194,15 @@ public class HtmlTreeBuilder extends TreeBuilder {
             parser.getErrors().add(new ParseError(reader.pos(), "Unexpected token [%s] when in state [%s]", currentToken.tokenType(), state));
     }
 
-    Element insert(Token.StartTag startTag) {
+    Element insert(final Token.StartTag startTag) {
+        // cleanup duplicate attributes:
+        if (!startTag.attributes.isEmpty()) {
+            int dupes = startTag.attributes.deduplicate(settings);
+            if (dupes > 0) {
+                error("Duplicate attribute");
+            }
+        }
+
         // handle empty unknown tags
         // when the spec expects an empty tag, will directly hit insertEmpty, so won't generate this fake end tag.
         if (startTag.isSelfClosing()) {
diff --git a/src/main/java/org/jsoup/parser/ParseSettings.java b/src/main/java/org/jsoup/parser/ParseSettings.java
index b12c3f29..18c685a4 100644
--- a/src/main/java/org/jsoup/parser/ParseSettings.java
+++ b/src/main/java/org/jsoup/parser/ParseSettings.java
@@ -25,6 +25,20 @@ public class ParseSettings {
     private final boolean preserveTagCase;
     private final boolean preserveAttributeCase;
 
+    /**
+     * Returns true if preserving tag name case.
+     */
+    public boolean preserveTagCase() {
+        return preserveTagCase;
+    }
+
+    /**
+     * Returns true if preserving attribute case.
+     */
+    public boolean preserveAttributeCase() {
+        return preserveAttributeCase;
+    }
+
     /**
      * Define parse settings.
      * @param tag preserve tag case?
diff --git a/src/main/java/org/jsoup/parser/Token.java b/src/main/java/org/jsoup/parser/Token.java
index 55866ed1..ca26404c 100644
--- a/src/main/java/org/jsoup/parser/Token.java
+++ b/src/main/java/org/jsoup/parser/Token.java
@@ -112,7 +112,8 @@ abstract class Token {
                         value = "";
                     else
                         value = null;
-                    attributes.put(pendingAttributeName, value);
+                    // note that we add, not put. So that the first is kept, and rest are deduped, once in a context where case sensitivity is known (the appropriate tree builder).
+                    attributes.add(pendingAttributeName, value);
                 }
             }
             pendingAttributeName = null;
@@ -125,7 +126,6 @@ abstract class Token {
         final void finaliseTag() {
             // finalises for emit
             if (pendingAttributeName != null) {
-                // todo: check if attribute name exists; if so, drop and error
                 newAttribute();
             }
         }
diff --git a/src/main/java/org/jsoup/parser/TreeBuilder.java b/src/main/java/org/jsoup/parser/TreeBuilder.java
index 75dd91a7..b54f06aa 100644
--- a/src/main/java/org/jsoup/parser/TreeBuilder.java
+++ b/src/main/java/org/jsoup/parser/TreeBuilder.java
@@ -91,4 +91,15 @@ abstract class TreeBuilder {
         int size = stack.size();
         return size > 0 ? stack.get(size-1) : null;
     }
+
+
+    /**
+     * If the parser is tracking errors, and an error at the current position.
+     * @param msg error message
+     */
+    protected void error(String msg) {
+        ParseErrorList errors = parser.getErrors();
+        if (errors.canAddError())
+            errors.add(new ParseError(reader.pos(), msg));
+    }
 }
diff --git a/src/main/java/org/jsoup/parser/XmlTreeBuilder.java b/src/main/java/org/jsoup/parser/XmlTreeBuilder.java
index 87cdc372..7fbe2519 100644
--- a/src/main/java/org/jsoup/parser/XmlTreeBuilder.java
+++ b/src/main/java/org/jsoup/parser/XmlTreeBuilder.java
@@ -75,6 +75,8 @@ public class XmlTreeBuilder extends TreeBuilder {
     Element insert(Token.StartTag startTag) {
         Tag tag = Tag.valueOf(startTag.name(), settings);
         // todo: wonder if for xml parsing, should treat all tags as unknown? because it's not html.
+        startTag.attributes.deduplicate(settings);
+
         Element el = new Element(tag, baseUri, settings.normalizeAttributes(startTag.attributes));
         insertNode(el);
         if (startTag.isSelfClosing()) {
diff --git a/src/test/java/org/jsoup/parser/HtmlParserTest.java b/src/test/java/org/jsoup/parser/HtmlParserTest.java
index 6c83c1e0..ad387656 100644
--- a/src/test/java/org/jsoup/parser/HtmlParserTest.java
+++ b/src/test/java/org/jsoup/parser/HtmlParserTest.java
@@ -55,6 +55,25 @@ public class HtmlParserTest {
         assertEquals("foo > bar", p.attr("class"));
     }
 
+    @Test public void dropsDuplicateAttributes() {
+        String html = "<p One=One ONE=Two Two=two one=Three One=Four two=Five>Text</p>";
+        Parser parser = Parser.htmlParser().setTrackErrors(10);
+        Document doc = parser.parseInput(html, "");
+
+        Element p = doc.selectFirst("p");
+        assertEquals("<p one=\"One\" two=\"two\">Text</p>", p.outerHtml()); // normalized names due to lower casing
+
+        assertEquals(1, parser.getErrors().size());
+        assertEquals("Duplicate attribute", parser.getErrors().get(0).getErrorMessage());
+    }
+
+    @Test public void retainsAttributesOfDifferentCaseIfSensitive() {
+        String html = "<p One=One One=Two one=Three two=Four two=Five Two=Six>Text</p>";
+        Parser parser = Parser.htmlParser().settings(ParseSettings.preserveCase);
+        Document doc = parser.parseInput(html, "");
+        assertEquals("<p One=\"One\" one=\"Three\" two=\"Four\" Two=\"Six\">Text</p>", doc.selectFirst("p").outerHtml());
+    }
+
     @Test public void parsesQuiteRoughAttributes() {
         String html = "<p =a>One<a <p>Something</p>Else";
         // this (used to; now gets cleaner) gets a <p> with attr '=a' and an <a tag with an attribue named '<p'; and then auto-recreated
diff --git a/src/test/java/org/jsoup/parser/XmlTreeBuilderTest.java b/src/test/java/org/jsoup/parser/XmlTreeBuilderTest.java
index 7ce70b3f..683e16bc 100644
--- a/src/test/java/org/jsoup/parser/XmlTreeBuilderTest.java
+++ b/src/test/java/org/jsoup/parser/XmlTreeBuilderTest.java
@@ -245,4 +245,14 @@ public class XmlTreeBuilderTest {
         Document doc = Jsoup.parse(html, "", Parser.xmlParser());
         assertEquals("<script> var a=\"\n <!--?\"; var b=\"?-->\"; </script>", doc.html()); // converted from pseudo xmldecl to comment
     }
+
+    @Test public void dropsDuplicateAttributes() {
+        // case sensitive, so should drop Four and Five
+        String html = "<p One=One ONE=Two one=Three One=Four ONE=Five two=Six two=Seven Two=Eight>Text</p>";
+        Parser parser = Parser.xmlParser().setTrackErrors(10);
+        Document doc = parser.parseInput(html, "");
+
+        assertEquals("<p One=\"One\" ONE=\"Two\" one=\"Three\" two=\"Six\" Two=\"Eight\">Text</p>", doc.selectFirst("p").outerHtml());
+    }
+
 }
