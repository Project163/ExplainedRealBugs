diff --git a/CHANGES b/CHANGES
index a1900854..5183ab84 100644
--- a/CHANGES
+++ b/CHANGES
@@ -22,6 +22,10 @@ Release 1.15.4 [PENDING]
     MalformedURLException when fetched.
     <https://github.com/jhy/jsoup/issues/1873>
 
+  * Bugfix: Element.cssSelector would create invalid selectors for elements where the tag name, ID, or classnames needed
+    to be escaped (e.g. if a class name contained a ':' or '.').
+    <https://github.com/jhy/jsoup/issues/1742>
+
   * Bgufix: element.text() should have a space between a block and an inline element.
     <https://github.com/jhy/jsoup/issues/1877>
 
diff --git a/src/main/java/org/jsoup/nodes/Element.java b/src/main/java/org/jsoup/nodes/Element.java
index b9ba7656..31152839 100644
--- a/src/main/java/org/jsoup/nodes/Element.java
+++ b/src/main/java/org/jsoup/nodes/Element.java
@@ -6,6 +6,7 @@ import org.jsoup.internal.NonnullByDefault;
 import org.jsoup.internal.StringUtil;
 import org.jsoup.parser.ParseSettings;
 import org.jsoup.parser.Tag;
+import org.jsoup.parser.TokenQueue;
 import org.jsoup.select.Collector;
 import org.jsoup.select.Elements;
 import org.jsoup.select.Evaluator;
@@ -32,6 +33,7 @@ import java.util.regex.PatternSyntaxException;
 
 import static org.jsoup.internal.Normalizer.normalize;
 import static org.jsoup.nodes.TextNode.lastCharIsWhitespace;
+import static org.jsoup.parser.TokenQueue.escapeCssIdentifier;
 
 /**
  * A HTML element consists of a tag name, attributes, and child nodes (including text nodes and
@@ -834,7 +836,7 @@ public class Element extends Node {
     public String cssSelector() {
         if (id().length() > 0) {
             // prefer to return the ID - but check that it's actually unique first!
-            String idSel = "#" + id();
+            String idSel = "#" + escapeCssIdentifier(id());
             Document doc = ownerDocument();
             if (doc != null) {
                 Elements els = doc.select(idSel);
@@ -845,10 +847,14 @@ public class Element extends Node {
             }
         }
 
-        // Translate HTML namespace ns:tag to CSS namespace syntax ns|tag
-        String tagName = tagName().replace(':', '|');
+        // Escape tagname, and translate HTML namespace ns:tag to CSS namespace syntax ns|tag
+        String tagName = escapeCssIdentifier(tagName()).replace("\\:", "|");
         StringBuilder selector = new StringBuilder(tagName);
-        String classes = StringUtil.join(classNames(), ".");
+        // String classes = StringUtil.join(classNames().stream().map(TokenQueue::escapeCssIdentifier).iterator(), ".");
+        // todo - replace with ^^ in 1.16.1 when we enable Android support for stream etc
+        StringUtil.StringJoiner escapedClasses = new StringUtil.StringJoiner(".");
+        for (String name : classNames()) escapedClasses.add(escapeCssIdentifier(name));
+        String classes = escapedClasses.complete();
         if (classes.length() > 0)
             selector.append('.').append(classes);
 
diff --git a/src/main/java/org/jsoup/parser/TokenQueue.java b/src/main/java/org/jsoup/parser/TokenQueue.java
index 25690483..ff6ad339 100644
--- a/src/main/java/org/jsoup/parser/TokenQueue.java
+++ b/src/main/java/org/jsoup/parser/TokenQueue.java
@@ -292,6 +292,23 @@ public class TokenQueue {
         return StringUtil.releaseBuilder(out);
     }
 
+    /*
+    Given a CSS identifier (such as a tag, ID, or class), escape any CSS special characters that would otherwise not be
+    valid in a selector.
+     */
+    public static String escapeCssIdentifier(String in) {
+        StringBuilder out = StringUtil.borrowBuilder();
+        TokenQueue q = new TokenQueue(in);
+        while (!q.isEmpty()) {
+            if (q.matchesCssIdentifier(ElementSelectorChars)) {
+                out.append(q.consume());
+            } else {
+                out.append(ESC).append(q.consume());
+            }
+        }
+        return StringUtil.releaseBuilder(out);
+    }
+
     /**
      * Pulls the next run of whitespace characters of the queue.
      * @return Whether consuming whitespace or not
@@ -323,8 +340,9 @@ public class TokenQueue {
      * @return tag name
      */
     public String consumeElementSelector() {
-        return consumeEscapedCssIdentifier("*|", "|", "_", "-");
+        return consumeEscapedCssIdentifier(ElementSelectorChars);
     }
+    private static final String[] ElementSelectorChars = {"*|", "|", "_", "-"};
 
     /**
      Consume a CSS identifier (ID or class) off the queue (letter, digit, -, _)
@@ -332,8 +350,10 @@ public class TokenQueue {
      @return identifier
      */
     public String consumeCssIdentifier() {
-        return consumeEscapedCssIdentifier("-", "_");
+        return consumeEscapedCssIdentifier(CssIdentifierChars);
     }
+    private static final String[] CssIdentifierChars = {"-", "_"};
+
 
     private String consumeEscapedCssIdentifier(String... matches) {
         int start = pos;
@@ -342,7 +362,7 @@ public class TokenQueue {
             if (queue.charAt(pos) == ESC && remainingLength() >1 ) {
                 escaped = true;
                 pos+=2; // skip the escape and the escaped
-            } else if (matchesWord() || matchesAny(matches)) {
+            } else if (matchesCssIdentifier(matches)) {
                 pos++;
             } else {
                 break;
@@ -353,6 +373,10 @@ public class TokenQueue {
         return escaped ? unescape(consumed) : consumed;
     }
 
+    private boolean matchesCssIdentifier(String... matches) {
+        return matchesWord() || matchesAny(matches);
+    }
+
     /**
      Consume and return whatever is left on the queue.
      @return remained of queue.
diff --git a/src/test/java/org/jsoup/nodes/ElementTest.java b/src/test/java/org/jsoup/nodes/ElementTest.java
index 1d9b301f..f623fe8c 100644
--- a/src/test/java/org/jsoup/nodes/ElementTest.java
+++ b/src/test/java/org/jsoup/nodes/ElementTest.java
@@ -1170,6 +1170,27 @@ public class ElementTest {
         assertSame(divC, doc.select(divC.cssSelector()).first());
     }
 
+    @Test public void cssSelectorEscaped() {
+        // https://github.com/jhy/jsoup/issues/1742
+        Document doc = Jsoup.parse("<p\\p>One</p\\p> <p id='one.two'>Two</p> <p class='one.two:three/four'>Three</p>");
+        Element one = doc.expectFirst("p\\\\p");
+        Elements ps = doc.select("p");
+        Element two = ps.get(0);
+        Element three = ps.get(1);
+
+        String oneSelect = one.cssSelector();
+        assertEquals("html > body > p\\\\p", oneSelect);
+        assertEquals(one, doc.expectFirst(oneSelect));
+
+        String twoSelect = two.cssSelector();
+        assertEquals("#one\\.two", twoSelect);
+        assertEquals(two, doc.expectFirst(twoSelect));
+
+        String threeSelect = three.cssSelector();
+        assertEquals("html > body > p.one\\.two\\:three\\/four", threeSelect);
+        assertEquals(three, doc.expectFirst(threeSelect));
+    }
+
     @Test
     public void testClassNames() {
         Document doc = Jsoup.parse("<div class=\"c1 c2\">C</div>");
diff --git a/src/test/java/org/jsoup/parser/TokenQueueTest.java b/src/test/java/org/jsoup/parser/TokenQueueTest.java
index 13505ad2..8147d035 100644
--- a/src/test/java/org/jsoup/parser/TokenQueueTest.java
+++ b/src/test/java/org/jsoup/parser/TokenQueueTest.java
@@ -46,6 +46,10 @@ public class TokenQueueTest {
         assertEquals("one ( ) \\", TokenQueue.unescape("one \\( \\) \\\\"));
     }
 
+    @Test public void escapeCssIdentifier() {
+        assertEquals("one\\#two\\.three\\/four\\\\five", TokenQueue.escapeCssIdentifier("one#two.three/four\\five"));
+    }
+
     @Test public void chompToIgnoreCase() {
         String t = "<textarea>one < two </TEXTarea>";
         TokenQueue tq = new TokenQueue(t);
