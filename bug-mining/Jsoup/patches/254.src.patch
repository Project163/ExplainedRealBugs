diff --git a/CHANGES b/CHANGES
index 262503ea..856495f8 100644
--- a/CHANGES
+++ b/CHANGES
@@ -33,6 +33,10 @@ jsoup changelog
     count per element when parsing to 512 (in real-world HTML, P99 is ~ 8).
     <https://github.com/jhy/jsoup/issues/1578>
 
+  * Bugfix [Fuzz]: Speed improvement for the foster formatting elements algo, by limiting how far up a crafted stack
+    to scan.
+    <https://github.com/jhy/jsoup/issues/1593>
+
 *** Release 1.14.1 [2021-Jul-10]
   * Change: updated the minimum supported Java version from Java 7 to Java 8.
 
diff --git a/src/main/java/org/jsoup/parser/HtmlTreeBuilder.java b/src/main/java/org/jsoup/parser/HtmlTreeBuilder.java
index ed533b8d..faddd6f8 100644
--- a/src/main/java/org/jsoup/parser/HtmlTreeBuilder.java
+++ b/src/main/java/org/jsoup/parser/HtmlTreeBuilder.java
@@ -336,7 +336,9 @@ public class HtmlTreeBuilder extends TreeBuilder {
     }
 
     Element getFromStack(String elName) {
-        for (int pos = stack.size() -1; pos >= 0; pos--) {
+        final int bottom = stack.size() - 1;
+        final int upper = bottom >= maxQueueDepth ? bottom - maxQueueDepth : 0;
+        for (int pos = bottom; pos >= upper; pos--) {
             Element next = stack.get(pos);
             if (next.normalName().equals(elName)) {
                 return next;
diff --git a/src/test/java/org/jsoup/integration/FuzzFixesTest.java b/src/test/java/org/jsoup/integration/FuzzFixesTest.java
index 122cb59d..6f08c222 100644
--- a/src/test/java/org/jsoup/integration/FuzzFixesTest.java
+++ b/src/test/java/org/jsoup/integration/FuzzFixesTest.java
@@ -122,4 +122,18 @@ public class FuzzFixesTest {
         Document docXml = Jsoup.parse(new FileInputStream(in), "UTF-8", "https://example.com", Parser.xmlParser());
         assertNotNull(docXml);
     }
+
+    @Test
+    public void parseTimeout1593() throws IOException {
+        // https://github.com/jhy/jsoup/issues/1593
+        // had unbounded depth in the foster formatting element scan - now limited to <= 256
+        // realworld HTML generally has only a few
+        File in = ParseTest.getFile("/fuzztests/1593.html.gz");
+
+        Document doc = Jsoup.parse(in, "UTF-8");
+        assertNotNull(doc);
+
+        Document docXml = Jsoup.parse(new FileInputStream(in), "UTF-8", "https://example.com", Parser.xmlParser());
+        assertNotNull(docXml);
+    }
 }
diff --git a/src/test/resources/fuzztests/1593.html.gz b/src/test/resources/fuzztests/1593.html.gz
new file mode 100644
index 00000000..8b8eab4b
Binary files /dev/null and b/src/test/resources/fuzztests/1593.html.gz differ
