diff --git a/CHANGES b/CHANGES
index ccafe5a4..91364ccb 100644
--- a/CHANGES
+++ b/CHANGES
@@ -3,6 +3,10 @@ jsoup changelog
 *** Release 0.3.2 (pending)
  * Allow _ and - in CSS ID selectors (per CSS spec).
  	<http://github.com/jhy/jsoup/issues/issue/10>
+ 
+ * Relative links are resolved to absolute when cleaning, to normalize
+    output and to verify safe protocol. (Were previously discarded.)
+      <http://github.com/jhy/jsoup/issues/issue/12>
 
 *** Release 0.3.1 (2010-Feb-20)
  * New features: supports Elements#html(), html(String),
diff --git a/src/main/java/org/jsoup/safety/Cleaner.java b/src/main/java/org/jsoup/safety/Cleaner.java
index af59a3f0..6e342ac7 100644
--- a/src/main/java/org/jsoup/safety/Cleaner.java
+++ b/src/main/java/org/jsoup/safety/Cleaner.java
@@ -105,7 +105,7 @@ public class Cleaner {
 
         Attributes sourceAttrs = sourceEl.attributes();
         for (Attribute sourceAttr : sourceAttrs) {
-            if (whitelist.isSafeAttribute(sourceTag, sourceAttr))
+            if (whitelist.isSafeAttribute(sourceTag, sourceEl, sourceAttr))
                 destAttrs.put(sourceAttr);
             else
                 numDiscarded++;
diff --git a/src/main/java/org/jsoup/safety/Whitelist.java b/src/main/java/org/jsoup/safety/Whitelist.java
index 117808f5..77f29537 100644
--- a/src/main/java/org/jsoup/safety/Whitelist.java
+++ b/src/main/java/org/jsoup/safety/Whitelist.java
@@ -8,6 +8,7 @@ package org.jsoup.safety;
 import org.apache.commons.lang.Validate;
 import org.jsoup.nodes.Attribute;
 import org.jsoup.nodes.Attributes;
+import org.jsoup.nodes.Element;
 
 import java.util.HashMap;
 import java.util.HashSet;
@@ -293,29 +294,32 @@ public class Whitelist {
         return tagNames.contains(TagName.valueOf(tag));
     }
 
-    boolean isSafeAttribute(String tagName, Attribute attr) {
+    boolean isSafeAttribute(String tagName, Element el, Attribute attr) {
         TagName tag = TagName.valueOf(tagName);
         AttributeKey key = AttributeKey.valueOf(attr.getKey());
-        AttributeValue value = AttributeValue.valueOf(attr.getValue());
 
         if (attributes.containsKey(tag)) {
             if (attributes.get(tag).contains(key)) {
                 if (protocols.containsKey(tag)) {
                     Map<AttributeKey, Set<Protocol>> attrProts = protocols.get(tag);
                     // ok if not defined protocol; otherwise test
-                    return !attrProts.containsKey(key) || testValidProtocol(value, attrProts.get(key));
+                    return !attrProts.containsKey(key) || testValidProtocol(el, attr, attrProts.get(key));
                 } else { // attribute found, no protocols defined, so OK
                     return true;
                 }
             }
         } else { // no attributes defined for tag, try :all tag
-            return !tagName.equals(":all") && isSafeAttribute(":all", attr);
+            return !tagName.equals(":all") && isSafeAttribute(":all", el, attr);
         }
         return false;
     }
 
-    private boolean testValidProtocol(AttributeValue value, Set<Protocol> protocols) {
-        // todo: use the absUrl method and test this is a good URL
+    private boolean testValidProtocol(Element el, Attribute attr, Set<Protocol> protocols) {
+        // resolve relative urls to abs, and update the attribute so output html has abs.
+        // rels without a baseuri get removed
+        String value = el.absUrl(attr.getKey());
+        attr.setValue(value);
+        
         for (Protocol protocol : protocols) {
             String prot = protocol.toString() + ":";
             if (value.toString().toLowerCase().startsWith(prot)) {
diff --git a/src/test/java/org/jsoup/org/jsoup/safety/CleanerTest.java b/src/test/java/org/jsoup/org/jsoup/safety/CleanerTest.java
index db999604..8d86a84d 100644
--- a/src/test/java/org/jsoup/org/jsoup/safety/CleanerTest.java
+++ b/src/test/java/org/jsoup/org/jsoup/safety/CleanerTest.java
@@ -29,7 +29,7 @@ public class CleanerTest {
         String h = "<div><p><a href='javascript:sendAllMoney()'>Dodgy</a> <A HREF='HTTP://nice.com'>Nice</p><blockquote>Hello</blockquote>";
         String cleanHtml = Jsoup.clean(h, Whitelist.basic());
 
-        assertEquals("<p><a rel=\"nofollow\">Dodgy</a> <a href=\"HTTP://nice.com\" rel=\"nofollow\">Nice</a></p><blockquote>Hello</blockquote>",
+        assertEquals("<p><a rel=\"nofollow\">Dodgy</a> <a href=\"http://nice.com\" rel=\"nofollow\">Nice</a></p><blockquote>Hello</blockquote>",
                 TextUtil.stripNewlines(cleanHtml));
     }
     
@@ -95,4 +95,16 @@ public class CleanerTest {
         assertFalse(Jsoup.isValid(nok1, Whitelist.basic()));
         assertFalse(Jsoup.isValid(nok2, Whitelist.basic()));
     }
+    
+    @Test public void resolvesRelativeLinks() {
+        String html = "<a href='/foo'>Link</a>";
+        String clean = Jsoup.clean(html, "http://example.com/", Whitelist.basic());
+        assertEquals("<a href=\"http://example.com/foo\" rel=\"nofollow\">Link</a>", clean);
+    }
+    
+    @Test public void dropsUnresolvableRelativeLinks() {
+        String html = "<a href='/foo'>Link</a>";
+        String clean = Jsoup.clean(html, Whitelist.basic());
+        assertEquals("<a rel=\"nofollow\">Link</a>", clean);
+    }
 }
