diff --git a/CHANGES b/CHANGES
index 1ea1370e..fedd6c79 100644
--- a/CHANGES
+++ b/CHANGES
@@ -17,6 +17,9 @@ jsoup changelog
 
  * Fixed GAE support: load HTML entities from a file on startup, instead of embedding in the class.
 
+ * Fixed issue with :all pseudo-tag in HTML sanitizer when cleaning tags previously defined in whitelist
+   <https://github.com/jhy/jsoup/issues/156>
+
 *** Release 1.6.2 [2011-Mar-27]
  * Added a simplified XML parsing mode, which can usefully parse valid and invalid XML, but does not enforce any HTML
    document structure or special tag behaviour.
diff --git a/src/main/java/org/jsoup/safety/Whitelist.java b/src/main/java/org/jsoup/safety/Whitelist.java
index 4d14dce7..085b0f53 100644
--- a/src/main/java/org/jsoup/safety/Whitelist.java
+++ b/src/main/java/org/jsoup/safety/Whitelist.java
@@ -329,10 +329,9 @@ public class Whitelist {
                     return true;
                 }
             }
-        } else { // no attributes defined for tag, try :all tag
-            return !tagName.equals(":all") && isSafeAttribute(":all", el, attr);
         }
-        return false;
+        // no attributes defined for tag, try :all tag
+        return !tagName.equals(":all") && isSafeAttribute(":all", el, attr);
     }
 
     private boolean testValidProtocol(Element el, Attribute attr, Set<Protocol> protocols) {
diff --git a/src/test/java/org/jsoup/safety/CleanerTest.java b/src/test/java/org/jsoup/safety/CleanerTest.java
index 4989ece9..294bd69b 100644
--- a/src/test/java/org/jsoup/safety/CleanerTest.java
+++ b/src/test/java/org/jsoup/safety/CleanerTest.java
@@ -122,4 +122,15 @@ public class CleanerTest {
         String preserved = Jsoup.clean(html, Whitelist.basicWithImages().addProtocols("img", "src", "cid", "data"));
         assertEquals("<img src=\"cid:12345\" /> \n<img src=\"data:gzzt\" />", preserved);
     }
+
+    @Test public void handlesAllPseudoTag() {
+        String html = "<p class='foo' src='bar'><a class='qux'>link</a></p>";
+        Whitelist whitelist = new Whitelist()
+                .addAttributes(":all", "class")
+                .addAttributes("p", "style")
+                .addTags("p", "a");
+
+        String clean = Jsoup.clean(html, whitelist);
+        assertEquals("<p class=\"foo\"><a class=\"qux\">link</a></p>", clean);
+    }
 }
