diff --git a/CHANGES b/CHANGES
index 6bde8695..300e644f 100644
--- a/CHANGES
+++ b/CHANGES
@@ -23,6 +23,11 @@ jsoup changelog
    encoding entities (as &nbsp; is not defined), regardless of the output character set.
    <https://github.com/jhy/jsoup/issues/523>
 
+ * Fixed an issue when resolving URLs, if the absolute URL had no path, the relative URL was not normalized correctly.
+   Also fixed an issue where connections that were redirected to a relative URL did not have the same normalization
+   rules as a URL read from Nodes.absUrl(String).
+   <https://github.com/jhy/jsoup/issues/585>
+
 *** Release 1.8.2 [2015-Apr-13]
  * Performance improvements for parsing HTML on Android, of 1.5x to 1.9x, with larger parses getting a bigger
    speed increase. For non-Android JREs, around 1.1x to 1.2x.
diff --git a/src/main/java/org/jsoup/helper/HttpConnection.java b/src/main/java/org/jsoup/helper/HttpConnection.java
index 284614b8..b21379d2 100644
--- a/src/main/java/org/jsoup/helper/HttpConnection.java
+++ b/src/main/java/org/jsoup/helper/HttpConnection.java
@@ -526,7 +526,7 @@ public class HttpConnection implements Connection {
                     String location = res.header(LOCATION);
                     if (location != null && location.startsWith("http:/") && location.charAt(6) != '/') // fix broken Location: http:/temp/AAG_New/en/index.php
                         location = location.substring(6);
-                    req.url(new URL(req.url(), encodeUrl(location)));
+                    req.url(StringUtil.resolve(req.url(), encodeUrl(location)));
 
                     for (Map.Entry<String, String> cookie : res.cookies.entrySet()) { // add response cookies to request (for e.g. login posts)
                         req.cookie(cookie.getKey(), cookie.getValue());
diff --git a/src/main/java/org/jsoup/helper/StringUtil.java b/src/main/java/org/jsoup/helper/StringUtil.java
index 779f40ca..4d341829 100644
--- a/src/main/java/org/jsoup/helper/StringUtil.java
+++ b/src/main/java/org/jsoup/helper/StringUtil.java
@@ -1,5 +1,7 @@
 package org.jsoup.helper;
 
+import java.net.MalformedURLException;
+import java.net.URL;
 import java.util.Collection;
 import java.util.Iterator;
 
@@ -150,4 +152,45 @@ public final class StringUtil {
         }
         return false;
     }
+
+    /**
+     * Create a new absolute URL, from a provided existing absolute URL and a relative URL component.
+     * @param base the existing absolulte base URL
+     * @param relUrl the relative URL to resolve. (If it's already absolute, it will be returned)
+     * @return the resolved absolute URL
+     * @throws MalformedURLException if an error occurred generating the URL
+     */
+    public static URL resolve(URL base, String relUrl) throws MalformedURLException {
+        // workaround: java resolves '//path/file + ?foo' to '//path/?foo', not '//path/file?foo' as desired
+        if (relUrl.startsWith("?"))
+            relUrl = base.getPath() + relUrl;
+        // workaround: //example.com + ./foo = //example.com/./foo, not //example.com/foo
+        if (relUrl.indexOf('.') == 0 && base.getFile().indexOf('/') != 0) {
+            base = new URL(base.getProtocol(), base.getHost(), base.getPort(), "/" + base.getFile());
+        }
+        return new URL(base, relUrl);
+    }
+
+    /**
+     * Create a new absolute URL, from a provided existing absolute URL and a relative URL component.
+     * @param baseUrl the existing absolute base URL
+     * @param relUrl the relative URL to resolve. (If it's already absolute, it will be returned)
+     * @return an absolute URL if one was able to be generated, or the empty string if not
+     */
+    public static String resolve(final String baseUrl, final String relUrl) {
+        URL base;
+        try {
+            try {
+                base = new URL(baseUrl);
+            } catch (MalformedURLException e) {
+                // the base is unsuitable, but the attribute/rel may be abs on its own, so try that
+                URL abs = new URL(relUrl);
+                return abs.toExternalForm();
+            }
+            return resolve(base, relUrl).toExternalForm();
+        } catch (MalformedURLException e) {
+            return "";
+        }
+
+    }
 }
diff --git a/src/main/java/org/jsoup/nodes/Node.java b/src/main/java/org/jsoup/nodes/Node.java
index fbff7656..9df63a1b 100644
--- a/src/main/java/org/jsoup/nodes/Node.java
+++ b/src/main/java/org/jsoup/nodes/Node.java
@@ -178,27 +178,10 @@ public abstract class Node implements Cloneable {
     public String absUrl(String attributeKey) {
         Validate.notEmpty(attributeKey);
 
-        String relUrl = attr(attributeKey);
         if (!hasAttr(attributeKey)) {
             return ""; // nothing to make absolute with
         } else {
-            URL base;
-            try {
-                try {
-                    base = new URL(baseUri);
-                } catch (MalformedURLException e) {
-                    // the base is unsuitable, but the attribute may be abs on its own, so try that
-                    URL abs = new URL(relUrl);
-                    return abs.toExternalForm();
-                }
-                // workaround: java resolves '//path/file + ?foo' to '//path/?foo', not '//path/file?foo' as desired
-                if (relUrl.startsWith("?"))
-                    relUrl = base.getPath() + relUrl;
-                URL abs = new URL(base, relUrl);
-                return abs.toExternalForm();
-            } catch (MalformedURLException e) {
-                return "";
-            }
+            return StringUtil.resolve(baseUri, attr(attributeKey));
         }
     }
 
diff --git a/src/test/java/org/jsoup/helper/StringUtilTest.java b/src/test/java/org/jsoup/helper/StringUtilTest.java
index 0a4153d2..29de2c91 100644
--- a/src/test/java/org/jsoup/helper/StringUtilTest.java
+++ b/src/test/java/org/jsoup/helper/StringUtilTest.java
@@ -5,6 +5,7 @@ import org.junit.Test;
 
 import java.util.Arrays;
 
+import static org.jsoup.helper.StringUtil.*;
 import static org.junit.Assert.assertEquals;
 import static org.junit.Assert.assertFalse;
 import static org.junit.Assert.assertTrue;
@@ -58,18 +59,35 @@ public class StringUtilTest {
     }
 
     @Test public void normaliseWhiteSpace() {
-        assertEquals(" ", StringUtil.normaliseWhitespace("    \r \n \r\n"));
-        assertEquals(" hello there ", StringUtil.normaliseWhitespace("   hello   \r \n  there    \n"));
-        assertEquals("hello", StringUtil.normaliseWhitespace("hello"));
-        assertEquals("hello there", StringUtil.normaliseWhitespace("hello\nthere"));
+        assertEquals(" ", normaliseWhitespace("    \r \n \r\n"));
+        assertEquals(" hello there ", normaliseWhitespace("   hello   \r \n  there    \n"));
+        assertEquals("hello", normaliseWhitespace("hello"));
+        assertEquals("hello there", normaliseWhitespace("hello\nthere"));
     }
 
     @Test public void normaliseWhiteSpaceHandlesHighSurrogates() {
         String test71540chars = "\ud869\udeb2\u304b\u309a  1";
         String test71540charsExpectedSingleWhitespace = "\ud869\udeb2\u304b\u309a 1";
 
-        assertEquals(test71540charsExpectedSingleWhitespace, StringUtil.normaliseWhitespace(test71540chars));
+        assertEquals(test71540charsExpectedSingleWhitespace, normaliseWhitespace(test71540chars));
         String extractedText = Jsoup.parse(test71540chars).text();
         assertEquals(test71540charsExpectedSingleWhitespace, extractedText);
     }
+
+    @Test public void resolvesRelativeUrls() {
+        assertEquals("http://example.com/one/two?three", resolve("http://example.com", "./one/two?three"));
+        assertEquals("http://example.com/one/two?three", resolve("http://example.com?one", "./one/two?three"));
+        assertEquals("http://example.com/one/two?three#four", resolve("http://example.com", "./one/two?three#four"));
+        assertEquals("https://example.com/one", resolve("http://example.com/", "https://example.com/one"));
+        assertEquals("http://example.com/one/two.html", resolve("http://example.com/two/", "../one/two.html"));
+        assertEquals("https://example2.com/one", resolve("https://example.com/", "//example2.com/one"));
+        assertEquals("https://example.com:8080/one", resolve("https://example.com:8080", "./one"));
+        assertEquals("https://example2.com/one", resolve("http://example.com/", "https://example2.com/one"));
+        assertEquals("https://example.com/one", resolve("wrong", "https://example.com/one"));
+        assertEquals("https://example.com/one", resolve("https://example.com/one", ""));
+        assertEquals("", resolve("wrong", "also wrong"));
+        assertEquals("ftp://example.com/one", resolve("ftp://example.com/two/", "../one"));
+        assertEquals("ftp://example.com/one/two.c", resolve("ftp://example.com/one/", "./two.c"));
+        assertEquals("ftp://example.com/one/two.c", resolve("ftp://example.com/one/", "two.c"));
+    }
 }
diff --git a/src/test/java/org/jsoup/integration/UrlConnectTest.java b/src/test/java/org/jsoup/integration/UrlConnectTest.java
index 3a12c584..b8556e15 100644
--- a/src/test/java/org/jsoup/integration/UrlConnectTest.java
+++ b/src/test/java/org/jsoup/integration/UrlConnectTest.java
@@ -188,6 +188,16 @@ public class UrlConnectTest {
         Connection con = Jsoup.connect("http://direct.infohound.net/tools/302-rel-dot.pl"); // to ./ok.html
         Document doc = con.post();
         assertTrue(doc.title().contains("OK"));
+        assertEquals(doc.location(), "http://direct.infohound.net/tools/ok.html");
+    }
+
+    @Test
+    public void followsRelativeDotRedirect2() throws IOException {
+        //redirects to "esportspenedes.cat/./ep/index.php", should resolve to "esportspenedes.cat/ep/index.php"
+        Connection con = Jsoup.connect("http://esportspenedes.cat")  // note lack of trailing / - server should redir to / first, then to ./ep/...; but doesn't'
+                .timeout(10000);
+        Document doc = con.post();
+        assertEquals(doc.location(), "http://esportspenedes.cat/ep/index.php");
     }
 
     @Test
diff --git a/src/test/java/org/jsoup/nodes/NodeTest.java b/src/test/java/org/jsoup/nodes/NodeTest.java
index b25aaf97..760dcfed 100644
--- a/src/test/java/org/jsoup/nodes/NodeTest.java
+++ b/src/test/java/org/jsoup/nodes/NodeTest.java
@@ -124,6 +124,12 @@ public class NodeTest {
         Element a2 = doc.select("a").get(1);
         assertEquals("http://jsoup.org/path/bar.html?foo", a2.absUrl("href"));
     }
+
+    @Test public void absHandlesDotFromIndex() {
+        Document doc = Jsoup.parse("<a href='./one/two.html'>One</a>", "http://example.com");
+        Element a1 = doc.select("a").first();
+        assertEquals("http://example.com/one/two.html", a1.absUrl("href"));
+    }
     
     @Test public void testRemove() {
         Document doc = Jsoup.parse("<p>One <span>two</span> three</p>");
