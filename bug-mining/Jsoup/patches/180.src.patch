diff --git a/CHANGES b/CHANGES
index c67fdd5d..6f599a85 100644
--- a/CHANGES
+++ b/CHANGES
@@ -65,6 +65,10 @@ jsoup changelog
   * Bugfix: Element.shallowClone() was not making a clone of its attributes.
     <https://github.com/jhy/jsoup/issues/1201>
 
+  * Bugfix: fixed an ArrayIndexOutOfBoundsException in HttpConnection.looksLikeUtf8 when testing small strings in
+    specific ranges.
+    <https://github.com/jhy/jsoup/issues/1172>
+
   * Updated jetty-server (which is used for integration tests) to latest 9.2 series (9.2.28).
 
 *** Release 1.11.3 [2018-Apr-15]
diff --git a/src/main/java/org/jsoup/helper/HttpConnection.java b/src/main/java/org/jsoup/helper/HttpConnection.java
index 0f666bac..00a1d985 100644
--- a/src/main/java/org/jsoup/helper/HttpConnection.java
+++ b/src/main/java/org/jsoup/helper/HttpConnection.java
@@ -421,6 +421,9 @@ public class HttpConnection implements Connection {
                     return false;
                 }
 
+                if (end >= input.length)
+                    return false;
+
                 while (i < end) {
                     i++;
                     o = input[i];
diff --git a/src/test/java/org/jsoup/helper/HttpConnectionTest.java b/src/test/java/org/jsoup/helper/HttpConnectionTest.java
index 4e6bf335..896383d8 100644
--- a/src/test/java/org/jsoup/helper/HttpConnectionTest.java
+++ b/src/test/java/org/jsoup/helper/HttpConnectionTest.java
@@ -1,6 +1,7 @@
 package org.jsoup.helper;
 
 import org.jsoup.Connection;
+import org.jsoup.Jsoup;
 import org.jsoup.MultiLocaleRule;
 import org.jsoup.MultiLocaleRule.MultiLocaleTest;
 import org.jsoup.integration.ParseTest;
@@ -249,4 +250,9 @@ public class HttpConnectionTest {
         }
         assertTrue(threw);
     }
+
+    @Test public void handlesHeaderEncodingOnRequest() {
+        Connection.Request req = new HttpConnection.Request();
+        req.addHeader("xxx", "Ã©");
+    }
 }
