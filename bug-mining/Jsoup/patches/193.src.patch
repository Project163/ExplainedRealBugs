diff --git a/CHANGES b/CHANGES
index e457b91d..41c790d9 100644
--- a/CHANGES
+++ b/CHANGES
@@ -35,6 +35,10 @@ jsoup changelog
     validation.
     <https://github.com/jhy/jsoup/issues/1159>
 
+  * Bugfix: some pseudo XML Declarations were incorrectly handled when using the XML Parser, leading to an IOOB
+    exception when parsing.
+    <https://github.com/jhy/jsoup/issues/1139>
+
   * Updated jetty-server (which is used for integration tests) to latest 9.2 series (9.2.26.v20180806).
 
 *** Release 1.11.3 [2018-Apr-15]
diff --git a/src/main/java/org/jsoup/nodes/Comment.java b/src/main/java/org/jsoup/nodes/Comment.java
index d0669fef..d9833854 100644
--- a/src/main/java/org/jsoup/nodes/Comment.java
+++ b/src/main/java/org/jsoup/nodes/Comment.java
@@ -75,7 +75,7 @@ public class Comment extends LeafNode {
         String data = getData();
         Document doc = Jsoup.parse("<" + data.substring(1, data.length() -1) + ">", baseUri(), Parser.xmlParser());
         XmlDeclaration decl = null;
-        if (doc.childNodeSize() > 0) {
+        if (doc.children().size() > 0) {
             Element el = doc.child(0);
             decl = new XmlDeclaration(NodeUtils.parser(doc).settings().normalizeTag(el.tagName()), data.startsWith("!"));
             decl.attributes().addAll(el.attributes());
diff --git a/src/test/java/org/jsoup/parser/XmlTreeBuilderTest.java b/src/test/java/org/jsoup/parser/XmlTreeBuilderTest.java
index 508b8c8f..7ce70b3f 100644
--- a/src/test/java/org/jsoup/parser/XmlTreeBuilderTest.java
+++ b/src/test/java/org/jsoup/parser/XmlTreeBuilderTest.java
@@ -237,4 +237,12 @@ public class XmlTreeBuilderTest {
         Document doc = Jsoup.parse(xml, "", Parser.xmlParser());
         assertEquals("One", doc.select("val").text());
     }
+
+    @Test
+    public void handlesLTinScript() {
+        // https://github.com/jhy/jsoup/issues/1139
+        String html = "<script> var a=\"<?\"; var b=\"?>\"; </script>";
+        Document doc = Jsoup.parse(html, "", Parser.xmlParser());
+        assertEquals("<script> var a=\"\n <!--?\"; var b=\"?-->\"; </script>", doc.html()); // converted from pseudo xmldecl to comment
+    }
 }
