diff --git a/src/main/java/org/apache/xmlgraphics/image/loader/impl/ImageLoaderFactoryRaw.java b/src/main/java/org/apache/xmlgraphics/image/loader/impl/ImageLoaderFactoryRaw.java
index 2f01546..f97ad59 100644
--- a/src/main/java/org/apache/xmlgraphics/image/loader/impl/ImageLoaderFactoryRaw.java
+++ b/src/main/java/org/apache/xmlgraphics/image/loader/impl/ImageLoaderFactoryRaw.java
@@ -19,8 +19,18 @@
 
 package org.apache.xmlgraphics.image.loader.impl;
 
+import java.util.Map;
+
+import javax.imageio.metadata.IIOMetadata;
+import javax.imageio.metadata.IIOMetadataNode;
+
+import org.w3c.dom.NamedNodeMap;
+import org.w3c.dom.Node;
+
 import org.apache.xmlgraphics.image.loader.ImageFlavor;
+import org.apache.xmlgraphics.image.loader.ImageInfo;
 import org.apache.xmlgraphics.image.loader.spi.ImageLoader;
+import org.apache.xmlgraphics.image.loader.util.Penalty;
 import org.apache.xmlgraphics.util.MimeConstants;
 
 /**
@@ -93,4 +103,34 @@ public class ImageLoaderFactoryRaw extends AbstractImageLoaderFactory {
         return true;
     }
 
+    @Override
+    public boolean isSupported(ImageInfo imageInfo) {
+        if ("image/png".equals(imageInfo.getMimeType())) {
+            Map additionalPenalties = (Map) imageInfo.getCustomObjects().get("additionalPenalties");
+            int penalty = 0;
+            Penalty penaltyObj = ((Penalty)additionalPenalties.get(ImageLoaderRawPNG.class.getName()));
+            if (penaltyObj != null) {
+                penalty = penaltyObj.getValue();
+            }
+            IIOMetadata metadata = (IIOMetadata) imageInfo.getCustomObjects().get(IIOMetadata.class);
+            if (metadata != null) {
+                IIOMetadataNode children = (IIOMetadataNode)metadata.getAsTree("javax_imageio_png_1.0").getChildNodes();
+                NamedNodeMap attr = children.getElementsByTagName("IHDR").item(0).getAttributes();
+                String bitDepth = attr.getNamedItem("bitDepth").getNodeValue();
+                String interlaceMethod = attr.getNamedItem("interlaceMethod").getNodeValue();
+                String colorType = attr.getNamedItem("colorType").getNodeValue();
+                if (!bitDepth.equals("8") || !interlaceMethod.equals("none")
+                        || ((colorType.equals("RGBAlpha") || colorType.equals("GrayAlpha")) && penalty >= 0)) {
+                    return false;
+                }
+                children = (IIOMetadataNode)metadata.getAsTree("javax_imageio_1.0").getChildNodes();
+                Node numChannels = children.getElementsByTagName("NumChannels").item(0);
+                String numChannelsStr = numChannels.getAttributes().getNamedItem("value").getNodeValue();
+                if ("4".equals(numChannelsStr) && "Palette".equals(colorType) && penalty >= 0) {
+                    return false;
+                }
+            }
+        }
+        return true;
+    }
 }
diff --git a/src/main/java/org/apache/xmlgraphics/image/loader/impl/ImageLoaderRawPNG.java b/src/main/java/org/apache/xmlgraphics/image/loader/impl/ImageLoaderRawPNG.java
index edfca61..00fcc1d 100644
--- a/src/main/java/org/apache/xmlgraphics/image/loader/impl/ImageLoaderRawPNG.java
+++ b/src/main/java/org/apache/xmlgraphics/image/loader/impl/ImageLoaderRawPNG.java
@@ -74,13 +74,4 @@ public class ImageLoaderRawPNG extends AbstractImageLoader {
         ImageRawPNG irpng = im.getImageRawPNG(info);
         return irpng;
     }
-
-    /** {@inheritDoc} */
-    public int getUsagePenalty() {
-        // since this image loader does not handle all kinds of PNG images then we add some penalty to it
-        // so that it is not chosen by default; instead, users need to give it a negative penalty in
-        // fop.xconf so that it is used
-        return 1000;
-    }
-
 }
diff --git a/src/main/java/org/apache/xmlgraphics/image/loader/impl/imageio/PreloaderImageIO.java b/src/main/java/org/apache/xmlgraphics/image/loader/impl/imageio/PreloaderImageIO.java
index a7dea63..1c6b421 100644
--- a/src/main/java/org/apache/xmlgraphics/image/loader/impl/imageio/PreloaderImageIO.java
+++ b/src/main/java/org/apache/xmlgraphics/image/loader/impl/imageio/PreloaderImageIO.java
@@ -52,6 +52,7 @@ public class PreloaderImageIO extends AbstractImagePreloader {
             return null;
         }
         ImageInputStream in = ImageUtil.needImageInputStream(src);
+        long startPos = in.getStreamPosition();
         Iterator iter = ImageIO.getImageReaders(in);
         if (!iter.hasNext()) {
             return null;
@@ -85,15 +86,8 @@ public class PreloaderImageIO extends AbstractImagePreloader {
         }
 
         if (iiometa == null) {
-            if (firstIOException == null) {
-                throw new ImageException("Could not extract image metadata");
-            } else {
-                throw new ImageException("I/O error while extracting image metadata"
-                        + (firstIOException.getMessage() != null
-                            ? ": " + firstIOException.getMessage()
-                            : ""),
-                        firstIOException);
-            }
+            in.seek(startPos);
+            return null;
         }
 
         //Resolution (first a default, then try to read the metadata)
diff --git a/src/main/java/org/apache/xmlgraphics/image/loader/spi/ImageImplRegistry.java b/src/main/java/org/apache/xmlgraphics/image/loader/spi/ImageImplRegistry.java
index 3f03cad..56a6cef 100644
--- a/src/main/java/org/apache/xmlgraphics/image/loader/spi/ImageImplRegistry.java
+++ b/src/main/java/org/apache/xmlgraphics/image/loader/spi/ImageImplRegistry.java
@@ -322,6 +322,7 @@ public class ImageImplRegistry {
     public ImageLoaderFactory[] getImageLoaderFactories(ImageInfo imageInfo, ImageFlavor flavor) {
         String mime = imageInfo.getMimeType();
         Collection matches = new java.util.TreeSet(new ImageLoaderFactoryComparator(flavor));
+        imageInfo.getCustomObjects().put("additionalPenalties", additionalPenalties);
         Map flavorMap = (Map) loaders.get(mime);
         if (flavorMap != null) {
             for (Object i : flavorMap.entrySet()) {
diff --git a/src/test/java/org/apache/xmlgraphics/image/loader/CorruptImagesTestCase.java b/src/test/java/org/apache/xmlgraphics/image/loader/CorruptImagesTestCase.java
index 774123c..5b83cd3 100644
--- a/src/test/java/org/apache/xmlgraphics/image/loader/CorruptImagesTestCase.java
+++ b/src/test/java/org/apache/xmlgraphics/image/loader/CorruptImagesTestCase.java
@@ -21,8 +21,7 @@ package org.apache.xmlgraphics.image.loader;
 
 import org.junit.Test;
 
-import static org.junit.Assert.assertNotNull;
-import static org.junit.Assert.fail;
+import static org.junit.Assert.assertEquals;
 
 /**
  * Tests for error behaviour with corrupt images.
@@ -38,13 +37,8 @@ public class CorruptImagesTestCase {
         ImageSessionContext sessionContext = imageContext.newSessionContext();
         ImageManager manager = imageContext.getImageManager();
 
-        try {
-            manager.preloadImage(uri, sessionContext);
-            fail("Expected an ImageException!");
-        } catch (Exception ie) {
-            //Expected exception
-            assertNotNull(ie.getMessage());
-        }
+        ImageInfo imageInfo = manager.preloadImage(uri, sessionContext);
+        assertEquals(imageInfo.getMimeType(), "image/png");
     }
 
 }
diff --git a/src/test/java/org/apache/xmlgraphics/image/loader/impl/ImageLoaderRawPNGTestCase.java b/src/test/java/org/apache/xmlgraphics/image/loader/impl/ImageLoaderRawPNGTestCase.java
index ea9e521..f29da10 100644
--- a/src/test/java/org/apache/xmlgraphics/image/loader/impl/ImageLoaderRawPNGTestCase.java
+++ b/src/test/java/org/apache/xmlgraphics/image/loader/impl/ImageLoaderRawPNGTestCase.java
@@ -48,7 +48,7 @@ public class ImageLoaderRawPNGTestCase {
 
     @Test
     public void testGetUsagePenalty() {
-        assertEquals(1000, ilrpng.getUsagePenalty());
+        assertEquals(0, ilrpng.getUsagePenalty());
     }
 
     @Test
