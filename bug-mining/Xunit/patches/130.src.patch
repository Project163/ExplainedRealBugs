diff --git a/license.txt b/license.txt
index 9781099e..3f80b800 100644
--- a/license.txt
+++ b/license.txt
@@ -1,14 +1,48 @@
-Copyright (c) .NET Foundation and Contributors
-All Rights Reserved
+Unless otherwise noted, the source code here is covered by the following license:
 
-Licensed under the Apache License, Version 2.0 (the "License");
-you may not use this file except in compliance with the License.
-You may obtain a copy of the License at
+    Copyright (c) .NET Foundation and Contributors
+    All Rights Reserved
 
-    http://www.apache.org/licenses/LICENSE-2.0
+    Licensed under the Apache License, Version 2.0 (the "License");
+    you may not use this file except in compliance with the License.
+    You may obtain a copy of the License at
 
-Unless required by applicable law or agreed to in writing, software
-distributed under the License is distributed on an "AS IS" BASIS,
-WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-See the License for the specific language governing permissions and
-limitations under the License.
+        http://www.apache.org/licenses/LICENSE-2.0
+
+    Unless required by applicable law or agreed to in writing, software
+    distributed under the License is distributed on an "AS IS" BASIS,
+    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+    See the License for the specific language governing permissions and
+    limitations under the License.
+
+-----------------------
+
+The code in src/common/AssemblyResolution/Microsoft.DotNet.PlatformAbstractions was imported from:
+    https://github.com/dotnet/core-setup/tree/v2.0.1/src/managed/Microsoft.DotNet.PlatformAbstractions
+
+The code in src/common/AssemblyResolution/Microsoft.DotNet.PlatformAbstractions was imported from:
+    https://github.com/dotnet/core-setup/tree/v2.0.1/src/managed/Microsoft.Extensions.DependencyModel
+
+Both sets of code are covered by the following license:
+
+    The MIT License (MIT)
+
+    Copyright (c) 2015 .NET Foundation
+
+    Permission is hereby granted, free of charge, to any person obtaining a copy
+    of this software and associated documentation files (the "Software"), to deal
+    in the Software without restriction, including without limitation the rights
+    to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
+    copies of the Software, and to permit persons to whom the Software is
+    furnished to do so, subject to the following conditions:
+
+    The above copyright notice and this permission notice shall be included in all
+    copies or substantial portions of the Software.
+
+    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
+    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
+    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
+    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
+    SOFTWARE.
diff --git a/src/xunit.runner.utility/Utility/AssemblyHelper_Desktop.cs b/src/common/AssemblyResolution/AssemblyHelper_Desktop.cs
similarity index 67%
rename from src/xunit.runner.utility/Utility/AssemblyHelper_Desktop.cs
rename to src/common/AssemblyResolution/AssemblyHelper_Desktop.cs
index 89fa8da9..ba21ffd1 100644
--- a/src/xunit.runner.utility/Utility/AssemblyHelper_Desktop.cs
+++ b/src/common/AssemblyResolution/AssemblyHelper_Desktop.cs
@@ -6,15 +6,14 @@
 using System.IO;
 using System.Reflection;
 using Xunit.Abstractions;
+using Xunit.Sdk;
 
 namespace Xunit
 {
     /// <summary>
-    /// This class provides assistance with assembly resolution for missing assemblies. To help with resolution
-    /// of dependencies from a folder, use <see cref="SubscribeResolveForDirectory"/>; for help with resolution
-    /// of dependencies from an assembly (with potential use of .deps.json), use <see cref="SubscribeResolveForAssembly"/>.
+    /// This class provides assistance with assembly resolution for missing assemblies.
     /// </summary>
-    public class AssemblyHelper : LongLivedMarshalByRefObject, IDisposable
+    class AssemblyHelper : LongLivedMarshalByRefObject, IDisposable
     {
         static readonly string[] Extensions = { ".dll", ".exe" };
 
@@ -56,9 +55,9 @@ Assembly LoadAssembly(AssemblyName assemblyName)
             if (internalDiagnosticsMessageSink != null)
             {
                 if (result == null)
-                    internalDiagnosticsMessageSink.OnMessage(new DiagnosticMessage($"[AssemblyHelper_Desktop.LoadAssembly] Resolution for '{assemblyName.Name}' failed, passed down to next resolver"));
+                    internalDiagnosticsMessageSink.OnMessage(new _DiagnosticMessage($"[AssemblyHelper_Desktop.LoadAssembly] Resolution for '{assemblyName.Name}' failed, passed down to next resolver"));
                 else
-                    internalDiagnosticsMessageSink.OnMessage(new DiagnosticMessage($"[AssemblyHelper_Desktop.LoadAssembly] Resolved '{assemblyName.Name}' to '{resolvedAssemblyPath}'"));
+                    internalDiagnosticsMessageSink.OnMessage(new _DiagnosticMessage($"[AssemblyHelper_Desktop.LoadAssembly] Resolved '{assemblyName.Name}' to '{resolvedAssemblyPath}'"));
             }
 
             lookupCache[assemblyName.Name] = result;
@@ -86,12 +85,6 @@ Assembly ResolveAndLoadAssembly(string pathWithoutExtension, out string resolved
             return null;
         }
 
-        /// <summary/>
-        [EditorBrowsable(EditorBrowsableState.Never)]
-        [Obsolete("Please use SubscribeResolveForDirectory instead")]
-        public static IDisposable SubscribeResolve(string path = null)
-            => SubscribeResolveForDirectory(null, null);
-
         /// <summary>
         /// Subscribes to the appropriate assembly resolution event, to provide automatic assembly resolution for
         /// an assembly and any of its dependencies. Depending on the target platform, this may include the use
@@ -99,19 +92,16 @@ public static IDisposable SubscribeResolve(string path = null)
         /// </summary>
         /// <returns>An object which, when disposed, un-subscribes.</returns>
         public static IDisposable SubscribeResolveForAssembly(string assemblyFileName, IMessageSink internalDiagnosticsMessageSink = null)
-            => SubscribeResolveForDirectory(internalDiagnosticsMessageSink, Path.GetDirectoryName(Path.GetFullPath(assemblyFileName)));
+            => new AssemblyHelper(Path.GetDirectoryName(Path.GetFullPath(assemblyFileName)), internalDiagnosticsMessageSink);
 
         /// <summary>
         /// Subscribes to the appropriate assembly resolution event, to provide automatic assembly resolution for
-        /// any assemblies located in a folder. This is typically used to help resolve the dependencies of
-        /// the runner utility library from its location in the NuGet packages folder.
+        /// an assembly and any of its dependencies. Depending on the target platform, this may include the use
+        /// of the .deps.json file generated during the build process.
         /// </summary>
-        /// <param name="internalDiagnosticsMessageSink">The optional message sink to send internal diagnostics messages to.</param>
         /// <returns>An object which, when disposed, un-subscribes.</returns>
-        /// <param name="directory">The optional directory to use for resolving assemblies; if <c>null</c> is passed,
-        /// then it uses the directory which contains the runner utility assembly.</param>
-        public static IDisposable SubscribeResolveForDirectory(IMessageSink internalDiagnosticsMessageSink = null, string directory = null)
-            => new AssemblyHelper(directory ?? Path.GetDirectoryName(typeof(AssemblyHelper).Assembly.GetLocalCodeBase()), internalDiagnosticsMessageSink);
+        public static IDisposable SubscribeResolveForAssembly(Type typeInAssembly, IMessageSink internalDiagnosticsMessageSink = null)
+            => new AssemblyHelper(Path.GetDirectoryName(typeInAssembly.Assembly.Location), internalDiagnosticsMessageSink);
     }
 }
 
diff --git a/src/xunit.runner.utility/Utility/NetCoreAssemblyDependencyResolver.cs b/src/common/AssemblyResolution/AssemblyHelper_NetCoreApp.cs
similarity index 56%
rename from src/xunit.runner.utility/Utility/NetCoreAssemblyDependencyResolver.cs
rename to src/common/AssemblyResolution/AssemblyHelper_NetCoreApp.cs
index bd6c6831..bbbc71e7 100644
--- a/src/xunit.runner.utility/Utility/NetCoreAssemblyDependencyResolver.cs
+++ b/src/common/AssemblyResolution/AssemblyHelper_NetCoreApp.cs
@@ -1,4 +1,4 @@
-#if NETCOREAPP1_0
+﻿#if NETCOREAPP1_0 || NETCOREAPP2_0
 
 using System;
 using System.IO;
@@ -10,27 +10,20 @@
 namespace Xunit
 {
     /// <summary>
-    /// A class which encapsulates support for resolving dependencies for .NET core assemblies.
-    /// This includes support for using the .deps.json file that sits alongside the assembly
-    /// so that dependencies do not need to be copied locally. It also supports loading native
-    /// assembly assets.
+    /// This class provides assistance with assembly resolution for missing assemblies.
     /// </summary>
-    public class NetCoreAssemblyDependencyResolver : AssemblyLoadContext, IDisposable
+    class AssemblyHelper : AssemblyLoadContext, IDisposable
     {
         readonly DependencyContextAssemblyCache assemblyCache;
         readonly IMessageSink internalDiagnosticsMessageSink;
 
-        /// <summary/>
-        [Obsolete("Please call the constructor with the support for internal diagnostics messages")]
-        public NetCoreAssemblyDependencyResolver(string assemblyFilePath) : this(assemblyFilePath, null) { }
-
         /// <summary>
         /// Initializes a new instance of the <see cref="NetCoreAssemblyDependencyResolver"/> class.
         /// </summary>
         /// <param name="assemblyFileName">The path to the assembly</param>
         /// <param name="internalDiagnosticsMessageSink">An optional message sink for use with internal diagnostics messages;
         /// may pass <c>null</c> for no internal diagnostics messages</param>
-        public NetCoreAssemblyDependencyResolver(string assemblyFileName, IMessageSink internalDiagnosticsMessageSink)
+        public AssemblyHelper(string assemblyFileName, IMessageSink internalDiagnosticsMessageSink)
         {
             this.internalDiagnosticsMessageSink = internalDiagnosticsMessageSink;
 
@@ -63,6 +56,24 @@ protected override IntPtr LoadUnmanagedDll(string unmanagedDllName)
 
         Assembly OnResolving(AssemblyLoadContext context, AssemblyName name)
             => assemblyCache.LoadManagedDll(name.Name, path => LoadFromAssemblyPath(path));
+
+        /// <summary>
+        /// Subscribes to the appropriate assembly resolution event, to provide automatic assembly resolution for
+        /// an assembly and any of its dependencies. Depending on the target platform, this may include the use
+        /// of the .deps.json file generated during the build process.
+        /// </summary>
+        /// <returns>An object which, when disposed, un-subscribes.</returns>
+        public static IDisposable SubscribeResolveForAssembly(string assemblyFileName, IMessageSink internalDiagnosticsMessageSink = null)
+            => new AssemblyHelper(assemblyFileName, internalDiagnosticsMessageSink);
+
+        /// <summary>
+        /// Subscribes to the appropriate assembly resolution event, to provide automatic assembly resolution for
+        /// an assembly and any of its dependencies. Depending on the target platform, this may include the use
+        /// of the .deps.json file generated during the build process.
+        /// </summary>
+        /// <returns>An object which, when disposed, un-subscribes.</returns>
+        public static IDisposable SubscribeResolveForAssembly(Type typeInAssembly, IMessageSink internalDiagnosticsMessageSink = null)
+            => new AssemblyHelper(typeInAssembly.GetTypeInfo().Assembly.Location, internalDiagnosticsMessageSink);
     }
 }
 
diff --git a/src/common/AssemblyResolution/AssemblyHelper_NetStandard.cs b/src/common/AssemblyResolution/AssemblyHelper_NetStandard.cs
new file mode 100644
index 00000000..9d8105a9
--- /dev/null
+++ b/src/common/AssemblyResolution/AssemblyHelper_NetStandard.cs
@@ -0,0 +1,33 @@
+﻿#if NETSTANDARD1_1 || NETSTANDARD1_5 || WINDOWS_UAP
+
+using System;
+using Xunit.Abstractions;
+
+namespace Xunit
+{
+    /// <summary>
+    /// This class provides assistance with assembly resolution for missing assemblies.
+    /// </summary>
+    static class AssemblyHelper
+    {
+        /// <summary>
+        /// Subscribes to the appropriate assembly resolution event, to provide automatic assembly resolution for
+        /// an assembly and any of its dependencies. Depending on the target platform, this may include the use
+        /// of the .deps.json file generated during the build process.
+        /// </summary>
+        /// <returns>An object which, when disposed, un-subscribes.</returns>
+        public static IDisposable SubscribeResolveForAssembly(string assemblyFileName, IMessageSink internalDiagnosticsMessageSink = null)
+            => null;
+
+        /// <summary>
+        /// Subscribes to the appropriate assembly resolution event, to provide automatic assembly resolution for
+        /// an assembly and any of its dependencies. Depending on the target platform, this may include the use
+        /// of the .deps.json file generated during the build process.
+        /// </summary>
+        /// <returns>An object which, when disposed, un-subscribes.</returns>
+        public static IDisposable SubscribeResolveForAssembly(Type typeInAssembly, IMessageSink internalDiagnosticsMessageSink = null)
+            => null;
+    }
+}
+
+#endif
diff --git a/src/xunit.runner.utility/Utility/DependencyContextAssemblyCache.cs b/src/common/AssemblyResolution/DependencyContextAssemblyCache.cs
similarity index 79%
rename from src/xunit.runner.utility/Utility/DependencyContextAssemblyCache.cs
rename to src/common/AssemblyResolution/DependencyContextAssemblyCache.cs
index 20d27b80..4234d9fa 100644
--- a/src/xunit.runner.utility/Utility/DependencyContextAssemblyCache.cs
+++ b/src/common/AssemblyResolution/DependencyContextAssemblyCache.cs
@@ -1,4 +1,4 @@
-﻿#if NET452 || NETCOREAPP1_0 || NETCOREAPP2_0
+﻿#if NETCOREAPP1_0 || NETCOREAPP2_0
 
 using System;
 using System.Collections.Generic;
@@ -30,6 +30,9 @@ class DependencyContextAssemblyCache
         readonly Dictionary<string, Assembly> managedAssemblyCache;
         readonly Dictionary<string, Tuple<RuntimeLibrary, RuntimeAssetGroup>> managedAssemblyMap;
         readonly Platform operatingSystemPlatform;
+        readonly string[] unmanagedDllFormats;
+        readonly Dictionary<string, string> unmanagedAssemblyCache;
+        readonly Dictionary<string, Tuple<RuntimeLibrary, RuntimeAssetGroup>> unmanagedAssemblyMap;
 
         public DependencyContextAssemblyCache(string assemblyFolder,
                                               DependencyContext dependencyContext,
@@ -49,12 +52,12 @@ class DependencyContextAssemblyCache
             assemblyResolver = new XunitPackageCompilationAssemblyResolver(internalDiagnosticsMessageSink, fileSystem);
 
             if (internalDiagnosticsMessageSink != null)
-                internalDiagnosticsMessageSink.OnMessage(new DiagnosticMessage($"[DependencyContextAssemblyCache..ctor] Runtime graph: [{string.Join(",", dependencyContext.RuntimeGraph.Select(x => $"'{x.Runtime}'"))}]"));
+                internalDiagnosticsMessageSink.OnMessage(new _DiagnosticMessage($"[DependencyContextAssemblyCache..ctor] Runtime graph: [{string.Join(",", dependencyContext.RuntimeGraph.Select(x => $"'{x.Runtime}'"))}]"));
 
             var compatibleRuntimes = GetCompatibleRuntimes(dependencyContext);
 
             if (internalDiagnosticsMessageSink != null)
-                internalDiagnosticsMessageSink.OnMessage(new DiagnosticMessage($"[DependencyContextAssemblyCache..ctor] Compatible runtimes: [{string.Join(",", compatibleRuntimes.Select(x => $"'{x}'"))}]"));
+                internalDiagnosticsMessageSink.OnMessage(new _DiagnosticMessage($"[DependencyContextAssemblyCache..ctor] Compatible runtimes: [{string.Join(",", compatibleRuntimes.Select(x => $"'{x}'"))}]"));
 
             managedAssemblyCache = new Dictionary<string, Assembly>(StringComparer.OrdinalIgnoreCase);
             managedAssemblyMap =
@@ -68,9 +71,8 @@ class DependencyContextAssemblyCache
                                  .ToDictionaryIgnoringDuplicateKeys(tuple => tuple.Item1, tuple => tuple.Item2, StringComparer.OrdinalIgnoreCase);
 
             if (internalDiagnosticsMessageSink != null)
-                internalDiagnosticsMessageSink.OnMessage(new DiagnosticMessage($"[DependencyContextAssemblyCache..ctor] Managed assembly map: [{string.Join(",", managedAssemblyMap.Keys.Select(k => $"'{k}'").OrderBy(k => k, StringComparer.OrdinalIgnoreCase))}]"));
+                internalDiagnosticsMessageSink.OnMessage(new _DiagnosticMessage($"[DependencyContextAssemblyCache..ctor] Managed assembly map: [{string.Join(",", managedAssemblyMap.Keys.Select(k => $"'{k}'").OrderBy(k => k, StringComparer.OrdinalIgnoreCase))}]"));
 
-#if NETCOREAPP1_0 || NETCOREAPP2_0
             unmanagedDllFormats = GetUnmanagedDllFormats().ToArray();
             unmanagedAssemblyCache = new Dictionary<string, string>(StringComparer.OrdinalIgnoreCase);
             unmanagedAssemblyMap =
@@ -83,11 +85,7 @@ class DependencyContextAssemblyCache
                                  .ToDictionaryIgnoringDuplicateKeys(tuple => tuple.Item1, tuple => tuple.Item2, StringComparer.OrdinalIgnoreCase);
 
             if (internalDiagnosticsMessageSink != null)
-                internalDiagnosticsMessageSink.OnMessage(new DiagnosticMessage($"[DependencyContextAssemblyCache..ctor] Unmanaged assembly map: [{string.Join(",", unmanagedAssemblyMap.Keys.Select(k => $"'{k}'").OrderBy(k => k, StringComparer.OrdinalIgnoreCase))}]"));
-#else
-            if (internalDiagnosticsMessageSink != null)
-                internalDiagnosticsMessageSink.OnMessage(new DiagnosticMessage("[DependencyContextAssemblyCache..ctor] Unmanaged assembly map: []"));
-#endif
+                internalDiagnosticsMessageSink.OnMessage(new _DiagnosticMessage($"[DependencyContextAssemblyCache..ctor] Unmanaged assembly map: [{string.Join(",", unmanagedAssemblyMap.Keys.Select(k => $"'{k}'").OrderBy(k => k, StringComparer.OrdinalIgnoreCase))}]"));
         }
 
         List<string> GetCompatibleRuntimes(DependencyContext dependencyContext)
@@ -130,11 +128,31 @@ string GetFallbackRuntime(string runtime)
             }
 
             if (internalDiagnosticsMessageSink != null)
-                internalDiagnosticsMessageSink.OnMessage(new DiagnosticMessage($"[DependencyContextAssemblyCache.GetFallbackRuntime] Could not find runtime '{runtime}', falling back to '{result}'"));
+                internalDiagnosticsMessageSink.OnMessage(new _DiagnosticMessage($"[DependencyContextAssemblyCache.GetFallbackRuntime] Could not find runtime '{runtime}', falling back to '{result}'"));
 
             return result;
         }
 
+        IEnumerable<string> GetUnmanagedDllFormats()
+        {
+            yield return "{0}";
+
+            if (operatingSystemPlatform == Platform.Windows)
+            {
+                yield return "{0}.dll";
+            }
+            else if (operatingSystemPlatform == Platform.Darwin)
+            {
+                yield return "lib{0}.dylib";
+                yield return "{0}.dylib";
+            }
+            else if (operatingSystemPlatform == Platform.Linux)
+            {
+                yield return "lib{0}.so";
+                yield return "{0}.so";
+            }
+        }
+
         public Assembly LoadManagedDll(string assemblyName, Func<string, Assembly> managedAssemblyLoader)
         {
             if (!managedAssemblyCache.TryGetValue(assemblyName, out var result))
@@ -147,15 +165,44 @@ public Assembly LoadManagedDll(string assemblyName, Func<string, Assembly> manag
                 if (internalDiagnosticsMessageSink != null)
                 {
                     if (result == null)
-                        internalDiagnosticsMessageSink.OnMessage(new DiagnosticMessage($"[DependencyContextAssemblyCache.LoadManagedDll] Resolution for '{assemblyName}' failed, passed down to next resolver"));
+                        internalDiagnosticsMessageSink.OnMessage(new _DiagnosticMessage($"[DependencyContextAssemblyCache.LoadManagedDll] Resolution for '{assemblyName}' failed, passed down to next resolver"));
                     else
-                        internalDiagnosticsMessageSink.OnMessage(new DiagnosticMessage($"[DependencyContextAssemblyCache.LoadManagedDll] Resolved '{assemblyName}' to '{resolvedAssemblyPath}'"));
+                        internalDiagnosticsMessageSink.OnMessage(new _DiagnosticMessage($"[DependencyContextAssemblyCache.LoadManagedDll] Resolved '{assemblyName}' to '{resolvedAssemblyPath}'"));
                 }
             }
 
             return result;
         }
 
+        public IntPtr LoadUnmanagedLibrary(string unmanagedLibraryName, Func<string, IntPtr> unmanagedAssemblyLoader)
+        {
+            var result = default(IntPtr);
+            var needDiagnostics = false;
+
+            if (!unmanagedAssemblyCache.TryGetValue(unmanagedLibraryName, out var resolvedAssemblyPath))
+            {
+                resolvedAssemblyPath = ResolveUnmanagedLibrary(unmanagedLibraryName);
+                unmanagedAssemblyCache[unmanagedLibraryName] = resolvedAssemblyPath;
+                needDiagnostics = true;
+            }
+
+            if (resolvedAssemblyPath != null)
+                result = unmanagedAssemblyLoader(resolvedAssemblyPath);
+
+            if (needDiagnostics && internalDiagnosticsMessageSink != null)
+                if (result != default)
+                    internalDiagnosticsMessageSink.OnMessage(new _DiagnosticMessage($"[DependencyContextAssemblyCache.LoadUnmanagedLibrary] Resolved '{unmanagedLibraryName}' to '{resolvedAssemblyPath}'"));
+                else
+                {
+                    if (resolvedAssemblyPath != null)
+                        internalDiagnosticsMessageSink.OnMessage(new _DiagnosticMessage($"[DependencyContextAssemblyCache.LoadUnmanagedLibrary] Resolving '{unmanagedLibraryName}', found assembly path '{resolvedAssemblyPath}' but the assembly would not load"));
+
+                    internalDiagnosticsMessageSink.OnMessage(new _DiagnosticMessage($"[DependencyContextAssemblyCache.LoadUnmanagedLibrary] Resolution for '{unmanagedLibraryName}' failed, passed down to next resolver"));
+                }
+
+            return result;
+        }
+
         Tuple<string, Assembly> ResolveManagedAssembly(string assemblyName, Func<string, Assembly> managedAssemblyLoader)
         {
             // Try to find dependency in the local folder
@@ -196,81 +243,24 @@ public Assembly LoadManagedDll(string assemblyName, Func<string, Assembly> manag
                             return Tuple.Create(resolvedAssemblyPath, assembly);
 
                         if (internalDiagnosticsMessageSink != null)
-                            internalDiagnosticsMessageSink.OnMessage(new DiagnosticMessage($"[DependencyContextAssemblyCache.ResolveManagedAssembly] Resolving '{assemblyName}', found assembly path '{resolvedAssemblyPath}' but the assembly would not load"));
+                            internalDiagnosticsMessageSink.OnMessage(new _DiagnosticMessage($"[DependencyContextAssemblyCache.ResolveManagedAssembly] Resolving '{assemblyName}', found assembly path '{resolvedAssemblyPath}' but the assembly would not load"));
                     }
                     else
                     {
                         if (internalDiagnosticsMessageSink != null)
-                            internalDiagnosticsMessageSink.OnMessage(new DiagnosticMessage($"[DependencyContextAssemblyCache.ResolveManagedAssembly] Resolving '{assemblyName}', found a resolved path, but could not map a filename in [{string.Join(",", assemblies.OrderBy(k => k, StringComparer.OrdinalIgnoreCase).Select(k => $"'{k}'"))}]"));
+                            internalDiagnosticsMessageSink.OnMessage(new _DiagnosticMessage($"[DependencyContextAssemblyCache.ResolveManagedAssembly] Resolving '{assemblyName}', found a resolved path, but could not map a filename in [{string.Join(",", assemblies.OrderBy(k => k, StringComparer.OrdinalIgnoreCase).Select(k => $"'{k}'"))}]"));
                     }
                 }
                 else
                 {
                     if (internalDiagnosticsMessageSink != null)
-                        internalDiagnosticsMessageSink.OnMessage(new DiagnosticMessage($"[DependencyContextAssemblyCache.ResolveManagedAssembly] Resolving '{assemblyName}', found in dependency map, but unable to resolve a path in [{string.Join(",", assetGroup.AssetPaths.OrderBy(k => k, StringComparer.OrdinalIgnoreCase).Select(k => $"'{k}'"))}]"));
+                        internalDiagnosticsMessageSink.OnMessage(new _DiagnosticMessage($"[DependencyContextAssemblyCache.ResolveManagedAssembly] Resolving '{assemblyName}', found in dependency map, but unable to resolve a path in [{string.Join(",", assetGroup.AssetPaths.OrderBy(k => k, StringComparer.OrdinalIgnoreCase).Select(k => $"'{k}'"))}]"));
                 }
             }
 
             return ManagedAssemblyNotFound;
         }
 
-#if NETCOREAPP1_0 || NETCOREAPP2_0
-        // Unmanaged DLL support
-
-        readonly string[] unmanagedDllFormats;
-
-        readonly Dictionary<string, string> unmanagedAssemblyCache;
-        readonly Dictionary<string, Tuple<RuntimeLibrary, RuntimeAssetGroup>> unmanagedAssemblyMap;
-
-        IEnumerable<string> GetUnmanagedDllFormats()
-        {
-            yield return "{0}";
-
-            if (operatingSystemPlatform == Platform.Windows)
-            {
-                yield return "{0}.dll";
-            }
-            else if (operatingSystemPlatform == Platform.Darwin)
-            {
-                yield return "lib{0}.dylib";
-                yield return "{0}.dylib";
-            }
-            else if (operatingSystemPlatform == Platform.Linux)
-            {
-                yield return "lib{0}.so";
-                yield return "{0}.so";
-            }
-        }
-
-        public IntPtr LoadUnmanagedLibrary(string unmanagedLibraryName, Func<string, IntPtr> unmanagedAssemblyLoader)
-        {
-            var result = default(IntPtr);
-            var needDiagnostics = false;
-
-            if (!unmanagedAssemblyCache.TryGetValue(unmanagedLibraryName, out var resolvedAssemblyPath))
-            {
-                resolvedAssemblyPath = ResolveUnmanagedLibrary(unmanagedLibraryName);
-                unmanagedAssemblyCache[unmanagedLibraryName] = resolvedAssemblyPath;
-                needDiagnostics = true;
-            }
-
-            if (resolvedAssemblyPath != null)
-                result = unmanagedAssemblyLoader(resolvedAssemblyPath);
-
-            if (needDiagnostics && internalDiagnosticsMessageSink != null)
-                if (result != default)
-                    internalDiagnosticsMessageSink.OnMessage(new DiagnosticMessage($"[DependencyContextAssemblyCache.LoadUnmanagedLibrary] Resolved '{unmanagedLibraryName}' to '{resolvedAssemblyPath}'"));
-                else
-                {
-                    if (resolvedAssemblyPath != null)
-                        internalDiagnosticsMessageSink.OnMessage(new DiagnosticMessage($"[DependencyContextAssemblyCache.LoadUnmanagedLibrary] Resolving '{unmanagedLibraryName}', found assembly path '{resolvedAssemblyPath}' but the assembly would not load"));
-
-                    internalDiagnosticsMessageSink.OnMessage(new DiagnosticMessage($"[DependencyContextAssemblyCache.LoadUnmanagedLibrary] Resolution for '{unmanagedLibraryName}' failed, passed down to next resolver"));
-                }
-
-            return result;
-        }
-
         public string ResolveUnmanagedLibrary(string unmanagedLibraryName)
         {
             foreach (var format in unmanagedDllFormats)
@@ -291,19 +281,18 @@ public string ResolveUnmanagedLibrary(string unmanagedLibraryName)
                             return Path.GetFullPath(resolvedAssemblyPath);
 
                         if (internalDiagnosticsMessageSink != null)
-                            internalDiagnosticsMessageSink.OnMessage(new DiagnosticMessage($"[DependencyContextAssemblyCache.ResolveUnmanagedLibrary] Found a resolved path, but could not map a filename in [{string.Join(",", assemblies.OrderBy(k => k, StringComparer.OrdinalIgnoreCase).Select(k => $"'{k}'"))}]"));
+                            internalDiagnosticsMessageSink.OnMessage(new _DiagnosticMessage($"[DependencyContextAssemblyCache.ResolveUnmanagedLibrary] Found a resolved path, but could not map a filename in [{string.Join(",", assemblies.OrderBy(k => k, StringComparer.OrdinalIgnoreCase).Select(k => $"'{k}'"))}]"));
                     }
                     else
                     {
                         if (internalDiagnosticsMessageSink != null)
-                            internalDiagnosticsMessageSink.OnMessage(new DiagnosticMessage($"[DependencyContextAssemblyCache.ResolveUnmanagedLibrary] Found in dependency map, but unable to resolve a path in [{string.Join(",", assetGroup.AssetPaths.OrderBy(k => k, StringComparer.OrdinalIgnoreCase).Select(k => $"'{k}'"))}]"));
+                            internalDiagnosticsMessageSink.OnMessage(new _DiagnosticMessage($"[DependencyContextAssemblyCache.ResolveUnmanagedLibrary] Found in dependency map, but unable to resolve a path in [{string.Join(",", assetGroup.AssetPaths.OrderBy(k => k, StringComparer.OrdinalIgnoreCase).Select(k => $"'{k}'"))}]"));
                     }
                 }
             }
 
             return null;
         }
-#endif
     }
 }
 
diff --git a/src/common/Microsoft.DotNet.PlatformAbstractions/ApplicationEnvironment.cs b/src/common/AssemblyResolution/Microsoft.DotNet.PlatformAbstractions/ApplicationEnvironment.cs
similarity index 100%
rename from src/common/Microsoft.DotNet.PlatformAbstractions/ApplicationEnvironment.cs
rename to src/common/AssemblyResolution/Microsoft.DotNet.PlatformAbstractions/ApplicationEnvironment.cs
diff --git a/src/common/Microsoft.DotNet.PlatformAbstractions/HashCodeCombiner.cs b/src/common/AssemblyResolution/Microsoft.DotNet.PlatformAbstractions/HashCodeCombiner.cs
similarity index 100%
rename from src/common/Microsoft.DotNet.PlatformAbstractions/HashCodeCombiner.cs
rename to src/common/AssemblyResolution/Microsoft.DotNet.PlatformAbstractions/HashCodeCombiner.cs
diff --git a/src/common/Microsoft.DotNet.PlatformAbstractions/Native/NativeMethods.Darwin.cs b/src/common/AssemblyResolution/Microsoft.DotNet.PlatformAbstractions/Native/NativeMethods.Darwin.cs
similarity index 100%
rename from src/common/Microsoft.DotNet.PlatformAbstractions/Native/NativeMethods.Darwin.cs
rename to src/common/AssemblyResolution/Microsoft.DotNet.PlatformAbstractions/Native/NativeMethods.Darwin.cs
diff --git a/src/common/Microsoft.DotNet.PlatformAbstractions/Native/NativeMethods.Unix.cs b/src/common/AssemblyResolution/Microsoft.DotNet.PlatformAbstractions/Native/NativeMethods.Unix.cs
similarity index 100%
rename from src/common/Microsoft.DotNet.PlatformAbstractions/Native/NativeMethods.Unix.cs
rename to src/common/AssemblyResolution/Microsoft.DotNet.PlatformAbstractions/Native/NativeMethods.Unix.cs
diff --git a/src/common/Microsoft.DotNet.PlatformAbstractions/Native/NativeMethods.Windows.cs b/src/common/AssemblyResolution/Microsoft.DotNet.PlatformAbstractions/Native/NativeMethods.Windows.cs
similarity index 100%
rename from src/common/Microsoft.DotNet.PlatformAbstractions/Native/NativeMethods.Windows.cs
rename to src/common/AssemblyResolution/Microsoft.DotNet.PlatformAbstractions/Native/NativeMethods.Windows.cs
diff --git a/src/common/Microsoft.DotNet.PlatformAbstractions/Native/PlatformApis.cs b/src/common/AssemblyResolution/Microsoft.DotNet.PlatformAbstractions/Native/PlatformApis.cs
similarity index 100%
rename from src/common/Microsoft.DotNet.PlatformAbstractions/Native/PlatformApis.cs
rename to src/common/AssemblyResolution/Microsoft.DotNet.PlatformAbstractions/Native/PlatformApis.cs
diff --git a/src/common/Microsoft.DotNet.PlatformAbstractions/Platform.cs b/src/common/AssemblyResolution/Microsoft.DotNet.PlatformAbstractions/Platform.cs
similarity index 100%
rename from src/common/Microsoft.DotNet.PlatformAbstractions/Platform.cs
rename to src/common/AssemblyResolution/Microsoft.DotNet.PlatformAbstractions/Platform.cs
diff --git a/src/common/Microsoft.DotNet.PlatformAbstractions/RuntimeEnvironment.cs b/src/common/AssemblyResolution/Microsoft.DotNet.PlatformAbstractions/RuntimeEnvironment.cs
similarity index 100%
rename from src/common/Microsoft.DotNet.PlatformAbstractions/RuntimeEnvironment.cs
rename to src/common/AssemblyResolution/Microsoft.DotNet.PlatformAbstractions/RuntimeEnvironment.cs
diff --git a/src/common/Microsoft.Extensions.DependencyModel/CollectionExtensions.cs b/src/common/AssemblyResolution/Microsoft.Extensions.DependencyModel/CollectionExtensions.cs
similarity index 100%
rename from src/common/Microsoft.Extensions.DependencyModel/CollectionExtensions.cs
rename to src/common/AssemblyResolution/Microsoft.Extensions.DependencyModel/CollectionExtensions.cs
diff --git a/src/common/Microsoft.Extensions.DependencyModel/CompilationLibrary.cs b/src/common/AssemblyResolution/Microsoft.Extensions.DependencyModel/CompilationLibrary.cs
similarity index 100%
rename from src/common/Microsoft.Extensions.DependencyModel/CompilationLibrary.cs
rename to src/common/AssemblyResolution/Microsoft.Extensions.DependencyModel/CompilationLibrary.cs
diff --git a/src/common/Microsoft.Extensions.DependencyModel/CompilationOptions.cs b/src/common/AssemblyResolution/Microsoft.Extensions.DependencyModel/CompilationOptions.cs
similarity index 100%
rename from src/common/Microsoft.Extensions.DependencyModel/CompilationOptions.cs
rename to src/common/AssemblyResolution/Microsoft.Extensions.DependencyModel/CompilationOptions.cs
diff --git a/src/common/Microsoft.Extensions.DependencyModel/Dependency.cs b/src/common/AssemblyResolution/Microsoft.Extensions.DependencyModel/Dependency.cs
similarity index 100%
rename from src/common/Microsoft.Extensions.DependencyModel/Dependency.cs
rename to src/common/AssemblyResolution/Microsoft.Extensions.DependencyModel/Dependency.cs
diff --git a/src/common/Microsoft.Extensions.DependencyModel/DependencyContext.cs b/src/common/AssemblyResolution/Microsoft.Extensions.DependencyModel/DependencyContext.cs
similarity index 98%
rename from src/common/Microsoft.Extensions.DependencyModel/DependencyContext.cs
rename to src/common/AssemblyResolution/Microsoft.Extensions.DependencyModel/DependencyContext.cs
index 1fe9488f..aa3ffa0e 100644
--- a/src/common/Microsoft.Extensions.DependencyModel/DependencyContext.cs
+++ b/src/common/AssemblyResolution/Microsoft.Extensions.DependencyModel/DependencyContext.cs
@@ -1,7 +1,7 @@
 ﻿// Copyright (c) .NET Foundation and contributors. All rights reserved.
 // Licensed under the MIT license. See LICENSE file in the project root for full license information.
 
-#if NET452 || NETCOREAPP1_0 || NETCOREAPP2_0
+#if NETCOREAPP1_0 || NETCOREAPP2_0
 
 using System;
 using System.Collections.Generic;
diff --git a/src/common/Microsoft.Extensions.DependencyModel/DependencyContextExtensions.cs b/src/common/AssemblyResolution/Microsoft.Extensions.DependencyModel/DependencyContextExtensions.cs
similarity index 99%
rename from src/common/Microsoft.Extensions.DependencyModel/DependencyContextExtensions.cs
rename to src/common/AssemblyResolution/Microsoft.Extensions.DependencyModel/DependencyContextExtensions.cs
index 04f74251..e9c19349 100644
--- a/src/common/Microsoft.Extensions.DependencyModel/DependencyContextExtensions.cs
+++ b/src/common/AssemblyResolution/Microsoft.Extensions.DependencyModel/DependencyContextExtensions.cs
@@ -1,4 +1,4 @@
-﻿#if NET452 || NETCOREAPP1_0 || NETCOREAPP2_0
+﻿#if NETCOREAPP1_0 || NETCOREAPP2_0
 
 using System;
 using System.Collections.Generic;
diff --git a/src/common/Microsoft.Extensions.DependencyModel/DependencyContextJsonReader.cs b/src/common/AssemblyResolution/Microsoft.Extensions.DependencyModel/DependencyContextJsonReader.cs
similarity index 99%
rename from src/common/Microsoft.Extensions.DependencyModel/DependencyContextJsonReader.cs
rename to src/common/AssemblyResolution/Microsoft.Extensions.DependencyModel/DependencyContextJsonReader.cs
index 09ee610e..51f45742 100644
--- a/src/common/Microsoft.Extensions.DependencyModel/DependencyContextJsonReader.cs
+++ b/src/common/AssemblyResolution/Microsoft.Extensions.DependencyModel/DependencyContextJsonReader.cs
@@ -1,7 +1,7 @@
 ﻿// Copyright (c) .NET Foundation and contributors. All rights reserved.
 // Licensed under the MIT license. See LICENSE file in the project root for full license information.
 
-#if NET452 || NETCOREAPP1_0 || NETCOREAPP2_0
+#if NETCOREAPP1_0 || NETCOREAPP2_0
 
 using System;
 using System.Collections.Generic;
diff --git a/src/common/Microsoft.Extensions.DependencyModel/DependencyContextLoader.cs b/src/common/AssemblyResolution/Microsoft.Extensions.DependencyModel/DependencyContextLoader.cs
similarity index 98%
rename from src/common/Microsoft.Extensions.DependencyModel/DependencyContextLoader.cs
rename to src/common/AssemblyResolution/Microsoft.Extensions.DependencyModel/DependencyContextLoader.cs
index 82554f9c..87de5715 100644
--- a/src/common/Microsoft.Extensions.DependencyModel/DependencyContextLoader.cs
+++ b/src/common/AssemblyResolution/Microsoft.Extensions.DependencyModel/DependencyContextLoader.cs
@@ -1,7 +1,7 @@
 ﻿// Copyright (c) .NET Foundation and contributors. All rights reserved.
 // Licensed under the MIT license. See LICENSE file in the project root for full license information.
 
-#if NET452 || NETCOREAPP1_0 || NETCOREAPP2_0
+#if NETCOREAPP1_0 || NETCOREAPP2_0
 
 using System;
 using System.Collections.Generic;
diff --git a/src/common/Microsoft.Extensions.DependencyModel/DependencyContextPaths.cs b/src/common/AssemblyResolution/Microsoft.Extensions.DependencyModel/DependencyContextPaths.cs
similarity index 100%
rename from src/common/Microsoft.Extensions.DependencyModel/DependencyContextPaths.cs
rename to src/common/AssemblyResolution/Microsoft.Extensions.DependencyModel/DependencyContextPaths.cs
diff --git a/src/common/Microsoft.Extensions.DependencyModel/DependencyContextStrings.cs b/src/common/AssemblyResolution/Microsoft.Extensions.DependencyModel/DependencyContextStrings.cs
similarity index 100%
rename from src/common/Microsoft.Extensions.DependencyModel/DependencyContextStrings.cs
rename to src/common/AssemblyResolution/Microsoft.Extensions.DependencyModel/DependencyContextStrings.cs
diff --git a/src/common/Microsoft.Extensions.DependencyModel/DirectoryWrapper.cs b/src/common/AssemblyResolution/Microsoft.Extensions.DependencyModel/DirectoryWrapper.cs
similarity index 100%
rename from src/common/Microsoft.Extensions.DependencyModel/DirectoryWrapper.cs
rename to src/common/AssemblyResolution/Microsoft.Extensions.DependencyModel/DirectoryWrapper.cs
diff --git a/src/common/Microsoft.Extensions.DependencyModel/EnvironmentWrapper.cs b/src/common/AssemblyResolution/Microsoft.Extensions.DependencyModel/EnvironmentWrapper.cs
similarity index 100%
rename from src/common/Microsoft.Extensions.DependencyModel/EnvironmentWrapper.cs
rename to src/common/AssemblyResolution/Microsoft.Extensions.DependencyModel/EnvironmentWrapper.cs
diff --git a/src/common/Microsoft.Extensions.DependencyModel/FileSystemWrapper.cs b/src/common/AssemblyResolution/Microsoft.Extensions.DependencyModel/FileSystemWrapper.cs
similarity index 100%
rename from src/common/Microsoft.Extensions.DependencyModel/FileSystemWrapper.cs
rename to src/common/AssemblyResolution/Microsoft.Extensions.DependencyModel/FileSystemWrapper.cs
diff --git a/src/common/Microsoft.Extensions.DependencyModel/FileWrapper.cs b/src/common/AssemblyResolution/Microsoft.Extensions.DependencyModel/FileWrapper.cs
similarity index 100%
rename from src/common/Microsoft.Extensions.DependencyModel/FileWrapper.cs
rename to src/common/AssemblyResolution/Microsoft.Extensions.DependencyModel/FileWrapper.cs
diff --git a/src/common/Microsoft.Extensions.DependencyModel/IDependencyContextReader.cs b/src/common/AssemblyResolution/Microsoft.Extensions.DependencyModel/IDependencyContextReader.cs
similarity index 83%
rename from src/common/Microsoft.Extensions.DependencyModel/IDependencyContextReader.cs
rename to src/common/AssemblyResolution/Microsoft.Extensions.DependencyModel/IDependencyContextReader.cs
index c69363ef..9f7658c7 100644
--- a/src/common/Microsoft.Extensions.DependencyModel/IDependencyContextReader.cs
+++ b/src/common/AssemblyResolution/Microsoft.Extensions.DependencyModel/IDependencyContextReader.cs
@@ -1,4 +1,4 @@
-#if NET452 || NETCOREAPP1_0 || NETCOREAPP2_0
+#if NETCOREAPP1_0 || NETCOREAPP2_0
 
 using System;
 using System.IO;
diff --git a/src/common/Microsoft.Extensions.DependencyModel/IDirectory.cs b/src/common/AssemblyResolution/Microsoft.Extensions.DependencyModel/IDirectory.cs
similarity index 100%
rename from src/common/Microsoft.Extensions.DependencyModel/IDirectory.cs
rename to src/common/AssemblyResolution/Microsoft.Extensions.DependencyModel/IDirectory.cs
diff --git a/src/common/Microsoft.Extensions.DependencyModel/IEnvironment.cs b/src/common/AssemblyResolution/Microsoft.Extensions.DependencyModel/IEnvironment.cs
similarity index 100%
rename from src/common/Microsoft.Extensions.DependencyModel/IEnvironment.cs
rename to src/common/AssemblyResolution/Microsoft.Extensions.DependencyModel/IEnvironment.cs
diff --git a/src/common/Microsoft.Extensions.DependencyModel/IFile.cs b/src/common/AssemblyResolution/Microsoft.Extensions.DependencyModel/IFile.cs
similarity index 100%
rename from src/common/Microsoft.Extensions.DependencyModel/IFile.cs
rename to src/common/AssemblyResolution/Microsoft.Extensions.DependencyModel/IFile.cs
diff --git a/src/common/Microsoft.Extensions.DependencyModel/IFileSystem.cs b/src/common/AssemblyResolution/Microsoft.Extensions.DependencyModel/IFileSystem.cs
similarity index 100%
rename from src/common/Microsoft.Extensions.DependencyModel/IFileSystem.cs
rename to src/common/AssemblyResolution/Microsoft.Extensions.DependencyModel/IFileSystem.cs
diff --git a/src/common/Microsoft.Extensions.DependencyModel/Library.cs b/src/common/AssemblyResolution/Microsoft.Extensions.DependencyModel/Library.cs
similarity index 100%
rename from src/common/Microsoft.Extensions.DependencyModel/Library.cs
rename to src/common/AssemblyResolution/Microsoft.Extensions.DependencyModel/Library.cs
diff --git a/src/common/Microsoft.Extensions.DependencyModel/Resolution/AppBaseCompilationAssemblyResolver.cs b/src/common/AssemblyResolution/Microsoft.Extensions.DependencyModel/Resolution/AppBaseCompilationAssemblyResolver.cs
similarity index 100%
rename from src/common/Microsoft.Extensions.DependencyModel/Resolution/AppBaseCompilationAssemblyResolver.cs
rename to src/common/AssemblyResolution/Microsoft.Extensions.DependencyModel/Resolution/AppBaseCompilationAssemblyResolver.cs
diff --git a/src/common/Microsoft.Extensions.DependencyModel/Resolution/CompositeCompilationAssemblyResolver.cs b/src/common/AssemblyResolution/Microsoft.Extensions.DependencyModel/Resolution/CompositeCompilationAssemblyResolver.cs
similarity index 100%
rename from src/common/Microsoft.Extensions.DependencyModel/Resolution/CompositeCompilationAssemblyResolver.cs
rename to src/common/AssemblyResolution/Microsoft.Extensions.DependencyModel/Resolution/CompositeCompilationAssemblyResolver.cs
diff --git a/src/common/Microsoft.Extensions.DependencyModel/Resolution/DotNetReferenceAssembliesPathResolver.cs b/src/common/AssemblyResolution/Microsoft.Extensions.DependencyModel/Resolution/DotNetReferenceAssembliesPathResolver.cs
similarity index 100%
rename from src/common/Microsoft.Extensions.DependencyModel/Resolution/DotNetReferenceAssembliesPathResolver.cs
rename to src/common/AssemblyResolution/Microsoft.Extensions.DependencyModel/Resolution/DotNetReferenceAssembliesPathResolver.cs
diff --git a/src/common/Microsoft.Extensions.DependencyModel/Resolution/ICompilationAssemblyResolver.cs b/src/common/AssemblyResolution/Microsoft.Extensions.DependencyModel/Resolution/ICompilationAssemblyResolver.cs
similarity index 100%
rename from src/common/Microsoft.Extensions.DependencyModel/Resolution/ICompilationAssemblyResolver.cs
rename to src/common/AssemblyResolution/Microsoft.Extensions.DependencyModel/Resolution/ICompilationAssemblyResolver.cs
diff --git a/src/common/Microsoft.Extensions.DependencyModel/Resolution/PackageCompilationAssemblyResolver.cs b/src/common/AssemblyResolution/Microsoft.Extensions.DependencyModel/Resolution/PackageCompilationAssemblyResolver.cs
similarity index 100%
rename from src/common/Microsoft.Extensions.DependencyModel/Resolution/PackageCompilationAssemblyResolver.cs
rename to src/common/AssemblyResolution/Microsoft.Extensions.DependencyModel/Resolution/PackageCompilationAssemblyResolver.cs
diff --git a/src/common/Microsoft.Extensions.DependencyModel/Resolution/ReferenceAssemblyPathResolver.cs b/src/common/AssemblyResolution/Microsoft.Extensions.DependencyModel/Resolution/ReferenceAssemblyPathResolver.cs
similarity index 100%
rename from src/common/Microsoft.Extensions.DependencyModel/Resolution/ReferenceAssemblyPathResolver.cs
rename to src/common/AssemblyResolution/Microsoft.Extensions.DependencyModel/Resolution/ReferenceAssemblyPathResolver.cs
diff --git a/src/common/Microsoft.Extensions.DependencyModel/Resolution/ResolverUtils.cs b/src/common/AssemblyResolution/Microsoft.Extensions.DependencyModel/Resolution/ResolverUtils.cs
similarity index 100%
rename from src/common/Microsoft.Extensions.DependencyModel/Resolution/ResolverUtils.cs
rename to src/common/AssemblyResolution/Microsoft.Extensions.DependencyModel/Resolution/ResolverUtils.cs
diff --git a/src/common/Microsoft.Extensions.DependencyModel/ResourceAssembly.cs b/src/common/AssemblyResolution/Microsoft.Extensions.DependencyModel/ResourceAssembly.cs
similarity index 100%
rename from src/common/Microsoft.Extensions.DependencyModel/ResourceAssembly.cs
rename to src/common/AssemblyResolution/Microsoft.Extensions.DependencyModel/ResourceAssembly.cs
diff --git a/src/common/Microsoft.Extensions.DependencyModel/RuntimeAssembly.cs b/src/common/AssemblyResolution/Microsoft.Extensions.DependencyModel/RuntimeAssembly.cs
similarity index 100%
rename from src/common/Microsoft.Extensions.DependencyModel/RuntimeAssembly.cs
rename to src/common/AssemblyResolution/Microsoft.Extensions.DependencyModel/RuntimeAssembly.cs
diff --git a/src/common/Microsoft.Extensions.DependencyModel/RuntimeAssetGroup.cs b/src/common/AssemblyResolution/Microsoft.Extensions.DependencyModel/RuntimeAssetGroup.cs
similarity index 100%
rename from src/common/Microsoft.Extensions.DependencyModel/RuntimeAssetGroup.cs
rename to src/common/AssemblyResolution/Microsoft.Extensions.DependencyModel/RuntimeAssetGroup.cs
diff --git a/src/common/Microsoft.Extensions.DependencyModel/RuntimeFallbacks.cs b/src/common/AssemblyResolution/Microsoft.Extensions.DependencyModel/RuntimeFallbacks.cs
similarity index 100%
rename from src/common/Microsoft.Extensions.DependencyModel/RuntimeFallbacks.cs
rename to src/common/AssemblyResolution/Microsoft.Extensions.DependencyModel/RuntimeFallbacks.cs
diff --git a/src/common/Microsoft.Extensions.DependencyModel/RuntimeLibrary.cs b/src/common/AssemblyResolution/Microsoft.Extensions.DependencyModel/RuntimeLibrary.cs
similarity index 100%
rename from src/common/Microsoft.Extensions.DependencyModel/RuntimeLibrary.cs
rename to src/common/AssemblyResolution/Microsoft.Extensions.DependencyModel/RuntimeLibrary.cs
diff --git a/src/common/Microsoft.Extensions.DependencyModel/TargetInfo.cs b/src/common/AssemblyResolution/Microsoft.Extensions.DependencyModel/TargetInfo.cs
similarity index 100%
rename from src/common/Microsoft.Extensions.DependencyModel/TargetInfo.cs
rename to src/common/AssemblyResolution/Microsoft.Extensions.DependencyModel/TargetInfo.cs
diff --git a/src/xunit.runner.utility/Utility/DependencyModel/XunitPackageCompilationAssemblyResolver.cs b/src/common/AssemblyResolution/XunitPackageCompilationAssemblyResolver.cs
similarity index 67%
rename from src/xunit.runner.utility/Utility/DependencyModel/XunitPackageCompilationAssemblyResolver.cs
rename to src/common/AssemblyResolution/XunitPackageCompilationAssemblyResolver.cs
index aa87ad76..a9a4f7df 100644
--- a/src/xunit.runner.utility/Utility/DependencyModel/XunitPackageCompilationAssemblyResolver.cs
+++ b/src/common/AssemblyResolution/XunitPackageCompilationAssemblyResolver.cs
@@ -1,4 +1,4 @@
-﻿#if NET452 || NETCOREAPP1_0 || NETCOREAPP2_0
+﻿#if NETCOREAPP1_0 || NETCOREAPP2_0
 
 // Adapted from https://github.com/dotnet/core-setup/blob/652b680dff6b1afb9cd26cc3c2e883a664c209fd/src/managed/Microsoft.Extensions.DependencyModel/Resolution/PackageCompilationAssemblyResolver.cs
 
@@ -30,39 +30,36 @@ class XunitPackageCompilationAssemblyResolver : ICompilationAssemblyResolver
 
         static List<string> GetDefaultProbeDirectories(Platform osPlatform, IMessageSink internalDiagnosticsMessageSink)
         {
-            var results = new HashSet<string>();
+            var results = default(List<string>);
 
-#if NETCOREAPP1_0
-            // The fact that the original code would only use PROBING_DIRECTORIES was causing failures to load
-            // referenced packages, so instead we'll use PROBING_DIRECTORIES as a supplemental folder.
-            var probeDirectories = AppContext.GetData("PROBING_DIRECTORIES");
-            var listOfDirectories = probeDirectories as string;
-
-            if (!string.IsNullOrEmpty(listOfDirectories))
-                foreach (var directory in listOfDirectories.Split(new char[] { Path.PathSeparator }, StringSplitOptions.RemoveEmptyEntries))
-                    results.Add(directory);
-#endif
-
-            // Allow the user to override the default location of NuGet packages
-            var packageDirectory = Environment.GetEnvironmentVariable("NUGET_PACKAGES");
-            if (!string.IsNullOrEmpty(packageDirectory))
-                results.Add(packageDirectory);
+            var probeDirectories = AppContext.GetData("PROBING_DIRECTORIES") as string;
+            if (!string.IsNullOrEmpty(probeDirectories))
+                results = probeDirectories.Split(new char[] { Path.PathSeparator }, StringSplitOptions.RemoveEmptyEntries).ToList();
             else
             {
-                string basePath;
-                if (osPlatform == Platform.Windows)
-                    basePath = Environment.GetEnvironmentVariable("USERPROFILE");
-                else
-                    basePath = Environment.GetEnvironmentVariable("HOME");
+                results = new List<string>();
 
-                if (!string.IsNullOrEmpty(basePath))
-                    results.Add(Path.Combine(basePath, ".nuget", "packages"));
+                // Allow the user to override the default location of NuGet packages
+                var packageDirectory = Environment.GetEnvironmentVariable("NUGET_PACKAGES");
+                if (!string.IsNullOrEmpty(packageDirectory))
+                    results.Add(packageDirectory);
+                else
+                {
+                    string basePath;
+                    if (osPlatform == Platform.Windows)
+                        basePath = Environment.GetEnvironmentVariable("USERPROFILE");
+                    else
+                        basePath = Environment.GetEnvironmentVariable("HOME");
+
+                    if (!string.IsNullOrEmpty(basePath))
+                        results.Add(Path.Combine(basePath, ".nuget", "packages"));
+                }
             }
 
             if (internalDiagnosticsMessageSink != null)
-                internalDiagnosticsMessageSink.OnMessage(new DiagnosticMessage($"[XunitPackageCompilationAssemblyResolver.GetDefaultProbeDirectories] returns: [{string.Join(",", results.Select(x => $"'{x}'"))}]"));
+                internalDiagnosticsMessageSink.OnMessage(new _DiagnosticMessage($"[XunitPackageCompilationAssemblyResolver.GetDefaultProbeDirectories] returns: [{string.Join(",", results.Select(x => $"'{x}'"))}]"));
 
-            return results.ToList();
+            return results;
         }
 
         public bool TryResolveAssemblyPaths(CompilationLibrary library, List<string> assemblies)
diff --git a/src/common/AssemblyResolution/_DiagnosticMessage.cs b/src/common/AssemblyResolution/_DiagnosticMessage.cs
new file mode 100644
index 00000000..bb851b0b
--- /dev/null
+++ b/src/common/AssemblyResolution/_DiagnosticMessage.cs
@@ -0,0 +1,34 @@
+using Xunit.Abstractions;
+
+namespace Xunit
+{
+    class _DiagnosticMessage : IDiagnosticMessage
+    {
+        /// <summary>
+        /// Initializes a new instance of the <see cref="DiagnosticMessage"/> class.
+        /// </summary>
+        public _DiagnosticMessage() { }
+
+        /// <summary>
+        /// Initializes a new instance of the <see cref="DiagnosticMessage"/> class.
+        /// </summary>
+        /// <param name="message">The message to send</param>
+        public _DiagnosticMessage(string message)
+        {
+            Message = message;
+        }
+
+        /// <summary>
+        /// Initializes a new instance of the <see cref="DiagnosticMessage"/> class.
+        /// </summary>
+        /// <param name="format">The format of the message to send</param>
+        /// <param name="args">The arguments used to format the message</param>
+        public _DiagnosticMessage(string format, params object[] args)
+        {
+            Message = string.Format(format, args);
+        }
+
+        /// <inheritdoc/>
+        public string Message { get; set; }
+    }
+}
diff --git a/src/common/LongLivedMarshalByRefObject.cs b/src/common/LongLivedMarshalByRefObject.cs
index 1f96a23b..f874882f 100644
--- a/src/common/LongLivedMarshalByRefObject.cs
+++ b/src/common/LongLivedMarshalByRefObject.cs
@@ -8,17 +8,17 @@ namespace Xunit.Sdk
     using System;
     using System.Security;
 
-    #if XUNIT_FRAMEWORK
+#if XUNIT_FRAMEWORK
     using System.Collections.Concurrent;
     using System.Runtime.Remoting;
-    #endif
+#endif
 
     /// <summary>
     /// Base class for all long-lived objects that may cross over an AppDomain.
     /// </summary>
-    public abstract class LongLivedMarshalByRefObject: MarshalByRefObject
+    public abstract class LongLivedMarshalByRefObject : MarshalByRefObject
     {
-    #if XUNIT_FRAMEWORK
+#if XUNIT_FRAMEWORK
         static ConcurrentBag<MarshalByRefObject> remoteObjects = new ConcurrentBag<MarshalByRefObject>();
 
         /// <summary>
@@ -40,12 +40,12 @@ public static void DisconnectAll()
 
             remoteObjects = new ConcurrentBag<MarshalByRefObject>();
         }
-    #else
+#else
         /// <summary>
         /// Disconnects all remote objects.
         /// </summary>
         public static void DisconnectAll() { }
-    #endif
+#endif
 
         /// <inheritdoc/>
         [SecurityCritical]
diff --git a/src/common/Microsoft.DotNet.PlatformAbstractions/LICENSE b/src/common/Microsoft.DotNet.PlatformAbstractions/LICENSE
deleted file mode 100644
index a7757a86..00000000
--- a/src/common/Microsoft.DotNet.PlatformAbstractions/LICENSE
+++ /dev/null
@@ -1,29 +0,0 @@
-﻿The code in this folder was imported from:
-
-    https://github.com/dotnet/core-setup/tree/v2.0.1/src/managed/Microsoft.DotNet.PlatformAbstractions
-
-The original license file can be found here:
-
-    https://github.com/dotnet/core-setup/blob/v2.0.1/LICENSE.TXT
-
-        The MIT License (MIT)
-
-        Copyright (c) 2015 .NET Foundation
-
-        Permission is hereby granted, free of charge, to any person obtaining a copy
-        of this software and associated documentation files (the "Software"), to deal
-        in the Software without restriction, including without limitation the rights
-        to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
-        copies of the Software, and to permit persons to whom the Software is
-        furnished to do so, subject to the following conditions:
-
-        The above copyright notice and this permission notice shall be included in all
-        copies or substantial portions of the Software.
-
-        THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
-        IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
-        FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
-        AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
-        LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
-        OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
-        SOFTWARE.
diff --git a/src/common/Microsoft.Extensions.DependencyModel/LICENSE b/src/common/Microsoft.Extensions.DependencyModel/LICENSE
deleted file mode 100644
index 9d075b6c..00000000
--- a/src/common/Microsoft.Extensions.DependencyModel/LICENSE
+++ /dev/null
@@ -1,29 +0,0 @@
-﻿The code in this folder was imported from:
-
-    https://github.com/dotnet/core-setup/tree/v2.0.1/src/managed/Microsoft.Extensions.DependencyModel
-
-The original license file can be found here:
-
-    https://github.com/dotnet/core-setup/blob/v2.0.1/LICENSE.TXT
-
-        The MIT License (MIT)
-
-        Copyright (c) 2015 .NET Foundation
-
-        Permission is hereby granted, free of charge, to any person obtaining a copy
-        of this software and associated documentation files (the "Software"), to deal
-        in the Software without restriction, including without limitation the rights
-        to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
-        copies of the Software, and to permit persons to whom the Software is
-        furnished to do so, subject to the following conditions:
-
-        The above copyright notice and this permission notice shall be included in all
-        copies or substantial portions of the Software.
-
-        THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
-        IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
-        FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
-        AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
-        LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
-        OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
-        SOFTWARE.
diff --git a/src/common/NullMessageSink.cs b/src/common/NullMessageSink.cs
index 068c158b..aa7fcc51 100644
--- a/src/common/NullMessageSink.cs
+++ b/src/common/NullMessageSink.cs
@@ -1,5 +1,6 @@
 using System.Collections.Generic;
 using Xunit.Abstractions;
+using Xunit.Sdk;
 
 #if XUNIT_FRAMEWORK
 namespace Xunit.Sdk
diff --git a/src/common/SourceInformation.cs b/src/common/SourceInformation.cs
index 797934cb..1210003b 100644
--- a/src/common/SourceInformation.cs
+++ b/src/common/SourceInformation.cs
@@ -1,4 +1,5 @@
 using Xunit.Abstractions;
+using Xunit.Sdk;
 
 #if XUNIT_FRAMEWORK
 namespace Xunit.Sdk
diff --git a/src/dotnet-xunit/Program.cs b/src/dotnet-xunit/Program.cs
index fa55dfc7..c55fc376 100644
--- a/src/dotnet-xunit/Program.cs
+++ b/src/dotnet-xunit/Program.cs
@@ -418,19 +418,25 @@ int RunDotNetCoreProject(string outputPath, string assemblyName, string targetFi
         }
 
         var runner = Path.Combine(consoleFolder, "xunit.console.dll");
-        var psi = new ProcessStartInfo
-        {
-            FileName = DotNetMuxer.MuxerPath,
-            Arguments = $@"exec --fx-version {fxVersion} ""{runner}"" ""{targetFileName}"" {extraArgs}",
-            WorkingDirectory = Path.GetFullPath(outputPath)
-        };
+        var workingDirectory = Path.GetFullPath(outputPath);
+        var targetFileNameWithoutExtension = Path.GetFileNameWithoutExtension(targetFileName);
+        var depsFile = targetFileNameWithoutExtension + ".deps.json";
+        var runtimeConfigJson = targetFileNameWithoutExtension + ".runtimeconfig.json";
+
+        var args = $@"exec --fx-version {fxVersion} --depsfile ""{depsFile}"" ";
+
+        if (File.Exists(Path.Combine(workingDirectory, runtimeConfigJson)))
+            args += $@"--runtimeconfig ""{runtimeConfigJson}"" ";
+
+        args += $@"""{runner}"" ""{targetFileName}"" {extraArgs}";
+
+        var psi = new ProcessStartInfo { FileName = DotNetMuxer.MuxerPath, Arguments = args, WorkingDirectory = workingDirectory };
 
         WriteLineDiagnostics($"EXEC: \"{psi.FileName}\" {psi.Arguments}");
         WriteLineDiagnostics($"  IN: {psi.WorkingDirectory}");
 
         var runTests = Process.Start(psi);
         runTests.WaitForExit();
-
         return runTests.ExitCode;
     }
 
diff --git a/src/messages/BaseMessages/TestAssemblyMessage.cs b/src/messages/BaseMessages/TestAssemblyMessage.cs
index 2d6e1df2..8a2c1d31 100644
--- a/src/messages/BaseMessages/TestAssemblyMessage.cs
+++ b/src/messages/BaseMessages/TestAssemblyMessage.cs
@@ -1,6 +1,7 @@
 ﻿using System.Collections.Generic;
 using System.Linq;
 using Xunit.Abstractions;
+using Xunit.Sdk;
 
 #if XUNIT_FRAMEWORK
 namespace Xunit.Sdk
diff --git a/src/messages/DiagnosticMessage.cs b/src/messages/DiagnosticMessage.cs
index 35b34935..4589eaa8 100644
--- a/src/messages/DiagnosticMessage.cs
+++ b/src/messages/DiagnosticMessage.cs
@@ -1,6 +1,7 @@
 using System.Collections.Generic;
 using System.Linq;
 using Xunit.Abstractions;
+using Xunit.Sdk;
 
 #if XUNIT_FRAMEWORK
 namespace Xunit.Sdk
diff --git a/src/messages/DiscoveryCompleteMessage.cs b/src/messages/DiscoveryCompleteMessage.cs
index 7111ca30..06842125 100644
--- a/src/messages/DiscoveryCompleteMessage.cs
+++ b/src/messages/DiscoveryCompleteMessage.cs
@@ -1,4 +1,5 @@
 using Xunit.Abstractions;
+using Xunit.Sdk;
 
 #if XUNIT_FRAMEWORK
 namespace Xunit.Sdk
diff --git a/src/messages/ErrorMessage.cs b/src/messages/ErrorMessage.cs
index 0926fa10..275f1129 100644
--- a/src/messages/ErrorMessage.cs
+++ b/src/messages/ErrorMessage.cs
@@ -1,6 +1,7 @@
 using System;
 using System.Collections.Generic;
 using Xunit.Abstractions;
+using Xunit.Sdk;
 
 #if XUNIT_FRAMEWORK
 namespace Xunit.Sdk
diff --git a/src/xunit.console/ConsoleRunner.cs b/src/xunit.console/ConsoleRunner.cs
index 1418e741..3a996653 100644
--- a/src/xunit.console/ConsoleRunner.cs
+++ b/src/xunit.console/ConsoleRunner.cs
@@ -21,14 +21,15 @@ class ConsoleRunner
         IRunnerLogger logger;
         IMessageSinkWithTypes reporterMessageHandler;
 
-        public ConsoleRunner(object consoleLock, CommandLine commandLine)
+        public ConsoleRunner(object consoleLock)
         {
             this.consoleLock = consoleLock;
-            this.commandLine = commandLine;
         }
 
         public int EntryPoint(string[] args)
         {
+            commandLine = CommandLine.Parse(args);
+
             try
             {
                 var reporters = GetAvailableRunnerReporters();
@@ -419,7 +420,7 @@ void PrintUsage(IReadOnlyList<IRunnerReporter> reporters)
                         if (assemblyElement != null)
                             resultsSink = new DelegatingXmlCreationSink(resultsSink, assemblyElement);
                         if (longRunningSeconds > 0)
-                            resultsSink = new DelegatingLongRunningTestDetectionSink(resultsSink, TimeSpan.FromSeconds(longRunningSeconds), diagnosticMessageSink);
+                            resultsSink = new DelegatingLongRunningTestDetectionSink(resultsSink, TimeSpan.FromSeconds(longRunningSeconds), MessageSinkWithTypesAdapter.Wrap(diagnosticMessageSink));
                         if (failSkips)
                             resultsSink = new DelegatingFailSkipSink(resultsSink);
 
diff --git a/src/xunit.console/Program.cs b/src/xunit.console/Program.cs
index 57f4f238..a7f8026a 100644
--- a/src/xunit.console/Program.cs
+++ b/src/xunit.console/Program.cs
@@ -1,4 +1,5 @@
 using System;
+using System.Linq;
 
 namespace Xunit.ConsoleClient
 {
@@ -7,12 +8,13 @@ public class Program
         [STAThread]
         public static int Main(string[] args)
         {
+            // This code must not contain any references to code in any external assembly (or any code that references any code in any
+            // other assembly) until AFTER the creation of the AssemblyHelper.
             var consoleLock = new object();
-            var commandLine = CommandLine.Parse(args);
-            var internalDiagnosticsMessageSink = DiagnosticMessageSink.ForInternalDiagnostics(consoleLock, commandLine.InternalDiagnosticMessages, commandLine.NoColor);
+            var internalDiagnosticsMessageSink = DiagnosticMessageSink.ForInternalDiagnostics(consoleLock, args.Contains("-internaldiagnostics"), args.Contains("-nocolor"));
 
-            using (AssemblyHelper.SubscribeResolveForDirectory(internalDiagnosticsMessageSink))
-                return new ConsoleRunner(consoleLock, commandLine).EntryPoint(args);
+            using (AssemblyHelper.SubscribeResolveForAssembly(typeof(Program), internalDiagnosticsMessageSink))
+                return new ConsoleRunner(consoleLock).EntryPoint(args);
         }
     }
 }
diff --git a/src/xunit.console/Sinks/DiagnosticMessageSink.cs b/src/xunit.console/Sinks/DiagnosticMessageSink.cs
index 4908f16e..1d34f150 100644
--- a/src/xunit.console/Sinks/DiagnosticMessageSink.cs
+++ b/src/xunit.console/Sinks/DiagnosticMessageSink.cs
@@ -3,12 +3,13 @@
 
 namespace Xunit.ConsoleClient
 {
-    public class DiagnosticMessageSink : TestMessageSink
+    public class DiagnosticMessageSink : IMessageSink
     {
         readonly string assemblyDisplayName;
         readonly object consoleLock;
         readonly ConsoleColor displayColor;
         readonly bool noColor;
+        readonly bool showDiagnostics;
 
         DiagnosticMessageSink(object consoleLock, string assemblyDisplayName, bool showDiagnostics, bool noColor, ConsoleColor displayColor)
         {
@@ -16,9 +17,7 @@ public class DiagnosticMessageSink : TestMessageSink
             this.assemblyDisplayName = assemblyDisplayName;
             this.noColor = noColor;
             this.displayColor = displayColor;
-
-            if (showDiagnostics)
-                Diagnostics.DiagnosticMessageEvent += HandleDiagnosticMessage;
+            this.showDiagnostics = showDiagnostics;
         }
 
         public static DiagnosticMessageSink ForDiagnostics(object consoleLock, string assemblyDisplayName, bool showDiagnostics, bool noColor)
@@ -30,21 +29,26 @@ public static DiagnosticMessageSink ForInternalDiagnostics(object consoleLock, b
         public static DiagnosticMessageSink ForInternalDiagnostics(object consoleLock, string assemblyDisplayName, bool showDiagnostics, bool noColor)
             => new DiagnosticMessageSink(consoleLock, assemblyDisplayName, showDiagnostics, noColor, ConsoleColor.DarkGray);
 
-        void HandleDiagnosticMessage(MessageHandlerArgs<IDiagnosticMessage> args)
+        public bool OnMessage(IMessageSinkMessage message)
         {
-            lock (consoleLock)
+            if (showDiagnostics && message is IDiagnosticMessage diagnosticMessage)
             {
-                if (!noColor)
-                    ConsoleHelper.SetForegroundColor(displayColor);
-
-                if (assemblyDisplayName != null)
-                    Console.WriteLine($"   {assemblyDisplayName}: {args.Message.Message}");
-                else
-                    Console.WriteLine($"   {args.Message.Message}");
-
-                if (!noColor)
-                    ConsoleHelper.ResetColor();
+                lock (consoleLock)
+                {
+                    if (!noColor)
+                        ConsoleHelper.SetForegroundColor(displayColor);
+
+                    if (assemblyDisplayName != null)
+                        Console.WriteLine($"   {assemblyDisplayName}: {diagnosticMessage.Message}");
+                    else
+                        Console.WriteLine($"   {diagnosticMessage.Message}");
+
+                    if (!noColor)
+                        ConsoleHelper.ResetColor();
+                }
             }
+
+            return true;
         }
     }
 }
diff --git a/src/xunit.console/xunit.console.csproj b/src/xunit.console/xunit.console.csproj
index 3245d4a2..33231935 100644
--- a/src/xunit.console/xunit.console.csproj
+++ b/src/xunit.console/xunit.console.csproj
@@ -1,6 +1,7 @@
 ﻿<Project Sdk="Microsoft.NET.Sdk">
 
   <PropertyGroup>
+    <AllowUnsafeBlocks>true</AllowUnsafeBlocks>
     <OutputType>Exe</OutputType>
     <RootNamespace>Xunit.ConsoleClient</RootNamespace>
     <TargetFrameworks>net452;netcoreapp1.0;netcoreapp2.0</TargetFrameworks>
@@ -12,6 +13,7 @@
     <Compile Include="..\common\DictionaryExtensions.cs" LinkBase="Common" />
     <Compile Include="..\common\Guard.cs" LinkBase="Common" />
     <Compile Include="..\common\Json.cs" LinkBase="Common" />
+    <Compile Include="..\common\AssemblyResolution\**\*.cs" LinkBase="Common\AssemblyResolution" />
   </ItemGroup>
 
   <ItemGroup>
diff --git a/src/xunit.runner.assemblies/xunit.runner.assemblies.csproj b/src/xunit.runner.assemblies/xunit.runner.assemblies.csproj
new file mode 100644
index 00000000..8a42371d
--- /dev/null
+++ b/src/xunit.runner.assemblies/xunit.runner.assemblies.csproj
@@ -0,0 +1,30 @@
+<Project Sdk="Microsoft.NET.Sdk">
+
+  <PropertyGroup>
+    <AllowUnsafeBlocks>true</AllowUnsafeBlocks>
+    <RootNamespace>Xunit</RootNamespace>
+    <TargetFrameworks>net452;netcoreapp1.0;netcoreapp2.0</TargetFrameworks>
+  </PropertyGroup>
+
+  <ItemGroup>
+    <Compile Include="..\common\AssemblyExtensions.cs" LinkBase="Common" />
+    <Compile Include="..\common\DictionaryExtensions.cs" LinkBase="Common" />
+    <Compile Include="..\common\Json.cs" LinkBase="Common" />
+    <Compile Include="..\common\LongLivedMarshalByRefObject.cs" LinkBase="Common" />
+    <Compile Include="..\common\AssemblyResolution\**\*.cs" LinkBase="Common\AssemblyResolution" />
+  </ItemGroup>
+
+  <ItemGroup>
+    <PackageReference Include="xunit.abstractions" Version="2.0.1" />
+  </ItemGroup>
+
+  <ItemGroup Condition=" '$(TargetFramework)' == 'net452' ">
+    <Reference Include="System.Configuration" />
+    <Reference Include="System.Web" />
+  </ItemGroup>
+
+  <ItemGroup Condition=" '$(TargetFramework)' != 'net452' ">
+    <PackageReference Include="System.Runtime.Loader" Version="4.0.0" />
+  </ItemGroup>
+  
+</Project>
diff --git a/src/xunit.runner.msbuild/xunit.cs b/src/xunit.runner.msbuild/xunit.cs
index 94a067b0..5ea87451 100644
--- a/src/xunit.runner.msbuild/xunit.cs
+++ b/src/xunit.runner.msbuild/xunit.cs
@@ -158,8 +158,8 @@ public override bool Execute()
 
             var originalWorkingFolder = Directory.GetCurrentDirectory();
             var internalDiagnosticsMessageSink = DiagnosticMessageSink.ForInternalDiagnostics(Log, InternalDiagnosticMessages);
-
-            using (AssemblyHelper.SubscribeResolveForDirectory(internalDiagnosticsMessageSink))
+            
+            using (AssemblyHelper.SubscribeResolveForAssembly(typeof(xunit), internalDiagnosticsMessageSink))
             {
                 var reporter = GetReporter();
                 if (reporter == null)
diff --git a/src/xunit.runner.msbuild/xunit.runner.msbuild.csproj b/src/xunit.runner.msbuild/xunit.runner.msbuild.csproj
index 6f4ef985..4319bd64 100644
--- a/src/xunit.runner.msbuild/xunit.runner.msbuild.csproj
+++ b/src/xunit.runner.msbuild/xunit.runner.msbuild.csproj
@@ -1,6 +1,7 @@
 ﻿<Project Sdk="Microsoft.NET.Sdk">
 
   <PropertyGroup>
+    <AllowUnsafeBlocks>true</AllowUnsafeBlocks>
     <AssemblyName>xunit.runner.msbuild.net452</AssemblyName>
     <RootNamespace>Xunit.Runner.MSBuild</RootNamespace>
     <TargetFramework>net452</TargetFramework>
@@ -10,6 +11,7 @@
     <Compile Include="..\common\AssemblyExtensions.cs" LinkBase="Common" />
     <Compile Include="..\common\DictionaryExtensions.cs" LinkBase="Common" />
     <Compile Include="..\common\Guard.cs" LinkBase="Common" />
+    <Compile Include="..\common\AssemblyResolution\**\*.cs" LinkBase="Common\AssemblyResolution" />
   </ItemGroup>
 
   <ItemGroup>
diff --git a/src/xunit.runner.utility/Frameworks/NullSourceInformationProvider.cs b/src/xunit.runner.utility/Frameworks/NullSourceInformationProvider.cs
index bb687f0e..8babc888 100644
--- a/src/xunit.runner.utility/Frameworks/NullSourceInformationProvider.cs
+++ b/src/xunit.runner.utility/Frameworks/NullSourceInformationProvider.cs
@@ -1,4 +1,5 @@
 ﻿using Xunit.Abstractions;
+using Xunit.Sdk;
 
 namespace Xunit
 {
diff --git a/src/xunit.runner.utility/Frameworks/VisualStudioSourceInformationProvider.cs b/src/xunit.runner.utility/Frameworks/VisualStudioSourceInformationProvider.cs
index 16171c45..0151f773 100644
--- a/src/xunit.runner.utility/Frameworks/VisualStudioSourceInformationProvider.cs
+++ b/src/xunit.runner.utility/Frameworks/VisualStudioSourceInformationProvider.cs
@@ -1,6 +1,7 @@
 ﻿#if !NETSTANDARD1_1
 
 using Xunit.Abstractions;
+using Xunit.Sdk;
 
 namespace Xunit
 {
diff --git a/src/xunit.runner.utility/Frameworks/v1/XmlNodeCallbackHandler.cs b/src/xunit.runner.utility/Frameworks/v1/XmlNodeCallbackHandler.cs
index 66630bb7..4131fef4 100644
--- a/src/xunit.runner.utility/Frameworks/v1/XmlNodeCallbackHandler.cs
+++ b/src/xunit.runner.utility/Frameworks/v1/XmlNodeCallbackHandler.cs
@@ -4,6 +4,7 @@
 using System.Threading;
 using System.Web.UI;
 using System.Xml;
+using Xunit.Sdk;
 
 namespace Xunit
 {
diff --git a/src/xunit.runner.utility/Frameworks/v1/Xunit1Test.cs b/src/xunit.runner.utility/Frameworks/v1/Xunit1Test.cs
index a46fbde3..fa223407 100644
--- a/src/xunit.runner.utility/Frameworks/v1/Xunit1Test.cs
+++ b/src/xunit.runner.utility/Frameworks/v1/Xunit1Test.cs
@@ -1,4 +1,5 @@
 ﻿using Xunit.Abstractions;
+using Xunit.Sdk;
 
 namespace Xunit
 {
diff --git a/src/xunit.runner.utility/Frameworks/v2/Xunit2.cs b/src/xunit.runner.utility/Frameworks/v2/Xunit2.cs
index 069fbfe4..5bcf9a1b 100644
--- a/src/xunit.runner.utility/Frameworks/v2/Xunit2.cs
+++ b/src/xunit.runner.utility/Frameworks/v2/Xunit2.cs
@@ -4,6 +4,7 @@
 using System.Linq;
 using System.Reflection;
 using Xunit.Abstractions;
+using Xunit.Sdk;
 
 namespace Xunit
 {
diff --git a/src/xunit.runner.utility/Frameworks/v2/Xunit2Discoverer.cs b/src/xunit.runner.utility/Frameworks/v2/Xunit2Discoverer.cs
index 72b79e13..068b2db4 100644
--- a/src/xunit.runner.utility/Frameworks/v2/Xunit2Discoverer.cs
+++ b/src/xunit.runner.utility/Frameworks/v2/Xunit2Discoverer.cs
@@ -4,6 +4,7 @@
 using System.Linq;
 using System.Reflection;
 using Xunit.Abstractions;
+using Xunit.Sdk;
 
 namespace Xunit
 {
diff --git a/src/xunit.runner.utility/Messages/MessageSinkAdapter.cs b/src/xunit.runner.utility/Messages/MessageSinkAdapter.cs
index 21352484..b2c95a5a 100644
--- a/src/xunit.runner.utility/Messages/MessageSinkAdapter.cs
+++ b/src/xunit.runner.utility/Messages/MessageSinkAdapter.cs
@@ -2,6 +2,7 @@
 using System.Collections.Generic;
 using System.Linq;
 using Xunit.Abstractions;
+using Xunit.Sdk;
 
 namespace Xunit
 {
diff --git a/src/xunit.runner.utility/Messages/MessageSinkWithTypesAdapter.cs b/src/xunit.runner.utility/Messages/MessageSinkWithTypesAdapter.cs
index ee61d1b4..540c02c3 100644
--- a/src/xunit.runner.utility/Messages/MessageSinkWithTypesAdapter.cs
+++ b/src/xunit.runner.utility/Messages/MessageSinkWithTypesAdapter.cs
@@ -1,5 +1,6 @@
 ﻿using System.Collections.Generic;
 using Xunit.Abstractions;
+using Xunit.Sdk;
 
 namespace Xunit
 {
diff --git a/src/xunit.runner.utility/Messages/OptimizedRemoteMessageSink.cs b/src/xunit.runner.utility/Messages/OptimizedRemoteMessageSink.cs
index 88a3ac78..08232c39 100644
--- a/src/xunit.runner.utility/Messages/OptimizedRemoteMessageSink.cs
+++ b/src/xunit.runner.utility/Messages/OptimizedRemoteMessageSink.cs
@@ -3,6 +3,7 @@
 using System.Linq;
 using System.Threading;
 using Xunit.Abstractions;
+using Xunit.Sdk;
 
 namespace Xunit
 {
diff --git a/src/xunit.runner.utility/Sinks/AggregateMessageSink.cs b/src/xunit.runner.utility/Sinks/AggregateMessageSink.cs
index c98c42f8..52d0c42f 100644
--- a/src/xunit.runner.utility/Sinks/AggregateMessageSink.cs
+++ b/src/xunit.runner.utility/Sinks/AggregateMessageSink.cs
@@ -1,5 +1,6 @@
 ﻿using System.Collections.Generic;
 using Xunit.Abstractions;
+using Xunit.Sdk;
 
 namespace Xunit
 {
diff --git a/src/xunit.runner.utility/Sinks/DelegatingSinks/DelegatingExecutionSummarySink.cs b/src/xunit.runner.utility/Sinks/DelegatingSinks/DelegatingExecutionSummarySink.cs
index e1a83a23..673af44b 100644
--- a/src/xunit.runner.utility/Sinks/DelegatingSinks/DelegatingExecutionSummarySink.cs
+++ b/src/xunit.runner.utility/Sinks/DelegatingSinks/DelegatingExecutionSummarySink.cs
@@ -3,6 +3,7 @@
 using System.IO;
 using System.Threading;
 using Xunit.Abstractions;
+using Xunit.Sdk;
 
 namespace Xunit
 {
diff --git a/src/xunit.runner.utility/Sinks/DelegatingSinks/DelegatingFailSkipSink.cs b/src/xunit.runner.utility/Sinks/DelegatingSinks/DelegatingFailSkipSink.cs
index 74a720ed..dd3b8020 100644
--- a/src/xunit.runner.utility/Sinks/DelegatingSinks/DelegatingFailSkipSink.cs
+++ b/src/xunit.runner.utility/Sinks/DelegatingSinks/DelegatingFailSkipSink.cs
@@ -1,6 +1,7 @@
 ﻿using System.Collections.Generic;
 using System.Threading;
 using Xunit.Abstractions;
+using Xunit.Sdk;
 
 namespace Xunit
 {
diff --git a/src/xunit.runner.utility/Sinks/DelegatingSinks/DelegatingXmlCreationSink.cs b/src/xunit.runner.utility/Sinks/DelegatingSinks/DelegatingXmlCreationSink.cs
index 0a91acb3..df23149c 100644
--- a/src/xunit.runner.utility/Sinks/DelegatingSinks/DelegatingXmlCreationSink.cs
+++ b/src/xunit.runner.utility/Sinks/DelegatingSinks/DelegatingXmlCreationSink.cs
@@ -7,6 +7,7 @@
 using System.Threading;
 using System.Xml.Linq;
 using Xunit.Abstractions;
+using Xunit.Sdk;
 
 namespace Xunit
 {
diff --git a/src/xunit.runner.utility/Sinks/EventSinks/DiagnosticEventSink.cs b/src/xunit.runner.utility/Sinks/EventSinks/DiagnosticEventSink.cs
index 97dfa454..58746e88 100644
--- a/src/xunit.runner.utility/Sinks/EventSinks/DiagnosticEventSink.cs
+++ b/src/xunit.runner.utility/Sinks/EventSinks/DiagnosticEventSink.cs
@@ -1,5 +1,6 @@
 ﻿using System.Collections.Generic;
 using Xunit.Abstractions;
+using Xunit.Sdk;
 
 namespace Xunit
 {
diff --git a/src/xunit.runner.utility/Sinks/EventSinks/DiscoveryEventSink.cs b/src/xunit.runner.utility/Sinks/EventSinks/DiscoveryEventSink.cs
index c072833a..d923e8a8 100644
--- a/src/xunit.runner.utility/Sinks/EventSinks/DiscoveryEventSink.cs
+++ b/src/xunit.runner.utility/Sinks/EventSinks/DiscoveryEventSink.cs
@@ -1,5 +1,6 @@
 ﻿using System.Collections.Generic;
 using Xunit.Abstractions;
+using Xunit.Sdk;
 
 namespace Xunit
 {
diff --git a/src/xunit.runner.utility/Sinks/EventSinks/ExecutionEventSink.cs b/src/xunit.runner.utility/Sinks/EventSinks/ExecutionEventSink.cs
index 92a0a310..7ca4ccd9 100644
--- a/src/xunit.runner.utility/Sinks/EventSinks/ExecutionEventSink.cs
+++ b/src/xunit.runner.utility/Sinks/EventSinks/ExecutionEventSink.cs
@@ -1,5 +1,6 @@
 ﻿using System.Collections.Generic;
 using Xunit.Abstractions;
+using Xunit.Sdk;
 
 namespace Xunit
 {
diff --git a/src/xunit.runner.utility/Sinks/EventSinks/RunnerEventSink.cs b/src/xunit.runner.utility/Sinks/EventSinks/RunnerEventSink.cs
index 84573057..0f9513b8 100644
--- a/src/xunit.runner.utility/Sinks/EventSinks/RunnerEventSink.cs
+++ b/src/xunit.runner.utility/Sinks/EventSinks/RunnerEventSink.cs
@@ -1,5 +1,6 @@
 ﻿using System.Collections.Generic;
 using Xunit.Abstractions;
+using Xunit.Sdk;
 
 namespace Xunit
 {
diff --git a/src/xunit.runner.utility/Sinks/TestDiscoverySink.cs b/src/xunit.runner.utility/Sinks/TestDiscoverySink.cs
index 3d609fde..d0c52df8 100644
--- a/src/xunit.runner.utility/Sinks/TestDiscoverySink.cs
+++ b/src/xunit.runner.utility/Sinks/TestDiscoverySink.cs
@@ -2,6 +2,7 @@
 using System.Collections.Generic;
 using System.Threading;
 using Xunit.Abstractions;
+using Xunit.Sdk;
 
 namespace Xunit
 {
diff --git a/src/xunit.runner.utility/Utility/AssemblyHelper_NetCoreApp.cs b/src/xunit.runner.utility/Utility/AssemblyHelper_NetCoreApp.cs
deleted file mode 100644
index cdf7eedb..00000000
--- a/src/xunit.runner.utility/Utility/AssemblyHelper_NetCoreApp.cs
+++ /dev/null
@@ -1,38 +0,0 @@
-﻿#if NETCOREAPP1_0
-
-using System;
-using Xunit.Abstractions;
-
-namespace Xunit
-{
-    /// <summary>
-    /// This class provides assistance with assembly resolution for missing assemblies. To help with resolution
-    /// of dependencies from a folder, use <see cref="SubscribeResolveForDirectory"/>; for help with resolution
-    /// of dependencies from an assembly (with potential use of .deps.json), use <see cref="SubscribeResolveForAssembly"/>.
-    /// </summary>
-    public static class AssemblyHelper
-    {
-        /// <summary>
-        /// Subscribes to the appropriate assembly resolution event, to provide automatic assembly resolution for
-        /// an assembly and any of its dependencies. Depending on the target platform, this may include the use
-        /// of the .deps.json file generated during the build process.
-        /// </summary>
-        /// <returns>An object which, when disposed, un-subscribes.</returns>
-        public static IDisposable SubscribeResolveForAssembly(string assemblyFileName, IMessageSink internalDiagnosticsMessageSink = null)
-            => new NetCoreAssemblyDependencyResolver(assemblyFileName, internalDiagnosticsMessageSink);
-
-        /// <summary>
-        /// Subscribes to the appropriate assembly resolution event, to provide automatic assembly resolution for
-        /// any assemblies located in a folder. This is typically used to help resolve the dependencies of
-        /// the runner utility library from its location in the NuGet packages folder.
-        /// </summary>
-        /// <param name="internalDiagnosticsMessageSink">The optional message sink to send internal diagnostics messages to.</param>
-        /// <returns>An object which, when disposed, un-subscribes.</returns>
-        /// <param name="directory">The optional directory to use for resolving assemblies; if <c>null</c> is passed,
-        /// then it uses the directory which contains the runner utility assembly.</param>
-        public static IDisposable SubscribeResolveForDirectory(IMessageSink internalDiagnosticsMessageSink = null, string directory = null)
-            => null;    // Don't need this for .NET Core, as .deps.json will resolve everything for us
-    }
-}
-
-#endif
diff --git a/src/xunit.runner.utility/Utility/AssemblyHelper_NetStandard.cs b/src/xunit.runner.utility/Utility/AssemblyHelper_NetStandard.cs
deleted file mode 100644
index b2ba397c..00000000
--- a/src/xunit.runner.utility/Utility/AssemblyHelper_NetStandard.cs
+++ /dev/null
@@ -1,38 +0,0 @@
-﻿#if NETSTANDARD1_1 || NETSTANDARD1_5
-
-using System;
-using Xunit.Abstractions;
-
-namespace Xunit
-{
-    /// <summary>
-    /// This class provides assistance with assembly resolution for missing assemblies. To help with resolution
-    /// of dependencies from a folder, use <see cref="SubscribeResolveForDirectory"/>; for help with resolution
-    /// of dependencies from an assembly (with potential use of .deps.json), use <see cref="SubscribeResolveForAssembly"/>.
-    /// </summary>
-    public class AssemblyHelper
-    {
-        /// <summary>
-        /// Subscribes to the appropriate assembly resolution event, to provide automatic assembly resolution for
-        /// an assembly and any of its dependencies. Depending on the target platform, this may include the use
-        /// of the .deps.json file generated during the build process.
-        /// </summary>
-        /// <returns>An object which, when disposed, un-subscribes.</returns>
-        public static IDisposable SubscribeResolveForAssembly(string assemblyFileName, IMessageSink internalDiagnosticsMessageSink = null)
-            => null;    // We don't support .deps.json on .NET Standard, because it's only available in .NET Core
-
-        /// <summary>
-        /// Subscribes to the appropriate assembly resolution event, to provide automatic assembly resolution for
-        /// any assemblies located in a folder. This is typically used to help resolve the dependencies of
-        /// the runner utility library from its location in the NuGet packages folder.
-        /// </summary>
-        /// <param name="internalDiagnosticsMessageSink">The optional message sink to send internal diagnostics messages to.</param>
-        /// <returns>An object which, when disposed, un-subscribes.</returns>
-        /// <param name="directory">The optional directory to use for resolving assemblies; if <c>null</c> is passed,
-        /// then it uses the directory which contains the runner utility assembly.</param>
-        public static IDisposable SubscribeResolveForDirectory(IMessageSink internalDiagnosticsMessageSink = null, string directory = null)
-            => null;    // We don't support this in .NET Standard, because we assume the packaging system does this for us
-    }
-}
-
-#endif
diff --git a/src/xunit.runner.utility/Utility/DependencyContextAssemblyHelper.cs b/src/xunit.runner.utility/Utility/DependencyContextAssemblyHelper.cs
deleted file mode 100644
index 342e9e8a..00000000
--- a/src/xunit.runner.utility/Utility/DependencyContextAssemblyHelper.cs
+++ /dev/null
@@ -1,60 +0,0 @@
-﻿#if NET452
-
-using System;
-using System.IO;
-using System.Reflection;
-using Internal.Microsoft.Extensions.DependencyModel;
-using Xunit.Abstractions;
-
-namespace Xunit
-{
-    class DependencyContextAssemblyHelper : IDisposable
-    {
-        static readonly DependencyContextJsonReader JsonReader = new DependencyContextJsonReader();
-
-        readonly DependencyContextAssemblyCache assemblyCache;
-        readonly IMessageSink internalDiagnosticsMessageSink;
-
-        public DependencyContextAssemblyHelper(string assemblyFolder, DependencyContext dependencyContext, IMessageSink internalDiagnosticsMessageSink)
-        {
-            this.internalDiagnosticsMessageSink = internalDiagnosticsMessageSink;
-
-            assemblyCache = new DependencyContextAssemblyCache(assemblyFolder, dependencyContext, internalDiagnosticsMessageSink);
-
-            AppDomain.CurrentDomain.AssemblyResolve += OnResolving;
-        }
-
-        public void Dispose()
-            => AppDomain.CurrentDomain.AssemblyResolve -= OnResolving;
-
-        Assembly OnResolving(object sender, ResolveEventArgs args)
-            => assemblyCache.LoadManagedDll(new AssemblyName(args.Name).Name, path => Assembly.LoadFile(path));
-
-        public static IDisposable SubscribeResolveForAssembly(string assemblyFileName, IMessageSink internalDiagnosticsMessageSink)
-        {
-            var assemblyFolder = Path.GetDirectoryName(assemblyFileName);
-            var depsJsonFile = Path.Combine(assemblyFolder, Path.GetFileNameWithoutExtension(assemblyFileName) + ".deps.json");
-            if (!File.Exists(depsJsonFile))
-            {
-                if (internalDiagnosticsMessageSink != null)
-                    internalDiagnosticsMessageSink.OnMessage(new DiagnosticMessage($"[DependencyContextAssemblyHelper.SubscribeResolveForAssembly] Skipping resolution for '{depsJsonFile}': File not found"));
-                return null;
-            }
-
-            using (var stream = File.OpenRead(depsJsonFile))
-            {
-                var context = JsonReader.Read(stream);
-                if (context == null)
-                {
-                    if (internalDiagnosticsMessageSink != null)
-                        internalDiagnosticsMessageSink.OnMessage(new DiagnosticMessage($"[DependencyContextAssemblyHelper.SubscribeResolveForAssembly] Skipping resolution for '{depsJsonFile}': File appears to be malformed"));
-                    return null;
-                }
-
-                return new DependencyContextAssemblyHelper(assemblyFolder, context, internalDiagnosticsMessageSink);
-            }
-        }
-    }
-}
-
-#endif
diff --git a/src/xunit.runner.utility/Utility/DiaSessionWrapperHelper.cs b/src/xunit.runner.utility/Utility/DiaSessionWrapperHelper.cs
index e843d26c..436753ca 100644
--- a/src/xunit.runner.utility/Utility/DiaSessionWrapperHelper.cs
+++ b/src/xunit.runner.utility/Utility/DiaSessionWrapperHelper.cs
@@ -6,6 +6,7 @@
 using System.Linq;
 using System.Linq.Expressions;
 using System.Reflection;
+using Xunit.Sdk;
 
 namespace Xunit
 {
diff --git a/src/xunit.runner.utility/Utility/DiaSessionWrapperHelper_DotNet.cs b/src/xunit.runner.utility/Utility/DiaSessionWrapperHelper_DotNet.cs
index adb0d83b..2721d890 100644
--- a/src/xunit.runner.utility/Utility/DiaSessionWrapperHelper_DotNet.cs
+++ b/src/xunit.runner.utility/Utility/DiaSessionWrapperHelper_DotNet.cs
@@ -6,6 +6,7 @@
 using System.Linq;
 using System.Reflection;
 using System.Runtime.CompilerServices;
+using Xunit.Sdk;
 
 namespace Xunit
 {
diff --git a/src/xunit.runner.utility/Utility/LongLivedMarshalByRefObject.cs b/src/xunit.runner.utility/Utility/LongLivedMarshalByRefObject.cs
deleted file mode 100644
index 866ccb5d..00000000
--- a/src/xunit.runner.utility/Utility/LongLivedMarshalByRefObject.cs
+++ /dev/null
@@ -1,19 +0,0 @@
-﻿namespace Xunit
-{
-    /// <summary>
-    /// Base class for all long-lived objects that may cross over an AppDomain.
-    /// </summary>
-#if NET35 || NET452
-    public abstract class LongLivedMarshalByRefObject : System.MarshalByRefObject
-    {
-        /// <inheritdoc/>
-        [System.Security.SecurityCritical]
-        public override sealed object InitializeLifetimeService()
-        {
-            return null;
-        }
-    }
-#else
-    public abstract class LongLivedMarshalByRefObject { }
-#endif
-}
diff --git a/src/xunit.runner.utility/Visitors/TestMessageVisitor.cs b/src/xunit.runner.utility/Visitors/TestMessageVisitor.cs
index 6e023a92..8160cd6c 100644
--- a/src/xunit.runner.utility/Visitors/TestMessageVisitor.cs
+++ b/src/xunit.runner.utility/Visitors/TestMessageVisitor.cs
@@ -1,6 +1,7 @@
 ﻿using System;
 using System.Threading;
 using Xunit.Abstractions;
+using Xunit.Sdk;
 
 namespace Xunit
 {
diff --git a/src/xunit.runner.utility/xunit.runner.utility.csproj b/src/xunit.runner.utility/xunit.runner.utility.csproj
index 3c9f9058..4dc65b84 100644
--- a/src/xunit.runner.utility/xunit.runner.utility.csproj
+++ b/src/xunit.runner.utility/xunit.runner.utility.csproj
@@ -1,7 +1,6 @@
 ﻿<Project Sdk="Microsoft.NET.Sdk">
 
   <PropertyGroup>
-    <AllowUnsafeBlocks>true</AllowUnsafeBlocks>
     <AssemblyName Condition=" '$(TargetFramework)' == 'net35' ">xunit.runner.utility.net35</AssemblyName>
     <AssemblyName Condition=" '$(TargetFramework)' == 'net452' ">xunit.runner.utility.net452</AssemblyName>
     <AssemblyName Condition=" '$(TargetFramework)' == 'netstandard1.1' ">xunit.runner.utility.netstandard11</AssemblyName>
@@ -9,7 +8,6 @@
     <AssemblyName Condition=" '$(TargetFramework)' == 'netcoreapp1.0' ">xunit.runner.utility.netcoreapp10</AssemblyName>
     <GenerateDocumentationFile>true</GenerateDocumentationFile>
     <RootNamespace>Xunit</RootNamespace>
-    <RuntimeFrameworkVersion Condition=" '$(TargetFramework)' == 'netcoreapp1.0' ">1.0.0</RuntimeFrameworkVersion>
     <TargetFrameworks>net35;net452;netstandard1.1;netstandard1.5;netcoreapp1.0</TargetFrameworks>
   </PropertyGroup>
 
@@ -33,10 +31,8 @@
     <Compile Include="..\common\TestOptionsNames.cs" LinkBase="Common" />
     <Compile Include="..\common\XunitSerializationInfo.cs" LinkBase="Common" />
     <Compile Include="..\common\XunitWorkerThread.cs" LinkBase="Common" />
-    <Compile Include="..\common\Microsoft.DotNet.PlatformAbstractions\**\*.cs" LinkBase="Common\Microsoft.DotNet.PlatformAbstractions" />
-    <None Include="..\common\Microsoft.DotNet.PlatformAbstractions\LICENSE" LinkBase="Common\Microsoft.DotNet.PlatformAbstractions" />
-    <Compile Include="..\common\Microsoft.Extensions.DependencyModel\**\*.cs" LinkBase="Common\Microsoft.Extensions.DependencyModel" />
-    <None Include="..\common\Microsoft.Extensions.DependencyModel\LICENSE" LinkBase="Common\Microsoft.Extensions.DependencyModel" />
+    <Compile Include="..\common\AssemblyResolution\AssemblyHelper_Desktop.cs" LinkBase="Common" />
+    <Compile Include="..\common\AssemblyResolution\_DiagnosticMessage.cs" LinkBase="Common" />
     <Compile Include="..\messages\**\*.cs" LinkBase="Messages" />
   </ItemGroup>
 
diff --git a/src/xunit.runner.visualstudio/VsTestRunner.cs b/src/xunit.runner.visualstudio/VsTestRunner.cs
index 040babca..1f543b1c 100644
--- a/src/xunit.runner.visualstudio/VsTestRunner.cs
+++ b/src/xunit.runner.visualstudio/VsTestRunner.cs
@@ -196,7 +196,7 @@ static bool ContainsAppX(IEnumerable<string> sources)
 
                 var internalDiagnosticsMessageSink = DiagnosticMessageSink.ForInternalDiagnostics(logger, runSettings.InternalDiagnostics);
 
-                using (AssemblyHelper.SubscribeResolveForDirectory(MessageSinkAdapter.Wrap(internalDiagnosticsMessageSink)))
+                using (AssemblyHelper.SubscribeResolveForAssembly(typeof(VsTestRunner), MessageSinkAdapter.Wrap(internalDiagnosticsMessageSink)))
                 {
                     foreach (var assemblyFileNameCanBeWithoutAbsolutePath in sources)
                     {
@@ -398,7 +398,7 @@ static TestAssemblyConfiguration LoadConfiguration(string assemblyName)
                                                                         .CreateMessageHandler(new VisualStudioRunnerLogger(logger)));
                 var internalDiagnosticsMessageSink = DiagnosticMessageSink.ForInternalDiagnostics(logger, runSettings.InternalDiagnostics);
 
-                using (AssemblyHelper.SubscribeResolveForDirectory(MessageSinkAdapter.Wrap(internalDiagnosticsMessageSink)))
+                using (AssemblyHelper.SubscribeResolveForAssembly(typeof(VsTestRunner), MessageSinkAdapter.Wrap(internalDiagnosticsMessageSink)))
                 {
                     if (parallelizeAssemblies)
                         runInfos
diff --git a/src/xunit.runner.visualstudio/xunit.runner.visualstudio.csproj b/src/xunit.runner.visualstudio/xunit.runner.visualstudio.csproj
index cad7f472..b39d8e33 100644
--- a/src/xunit.runner.visualstudio/xunit.runner.visualstudio.csproj
+++ b/src/xunit.runner.visualstudio/xunit.runner.visualstudio.csproj
@@ -12,11 +12,9 @@
 
   <ItemGroup>
     <Compile Include="..\common\ConsoleHelper.cs" LinkBase="Common" />
+    <Compile Include="..\common\DictionaryExtensions.cs" LinkBase="Common" />
     <Compile Include="..\common\Json.cs" LinkBase="Common" />
-    <Compile Include="..\common\Microsoft.DotNet.PlatformAbstractions\**\*.cs" LinkBase="Common\Microsoft.DotNet.PlatformAbstractions" />
-    <None Include="..\common\Microsoft.DotNet.PlatformAbstractions\LICENSE" LinkBase="Common\Microsoft.DotNet.PlatformAbstractions" />
-    <Compile Include="..\common\Microsoft.Extensions.DependencyModel\**\*.cs" LinkBase="Common\Microsoft.Extensions.DependencyModel" />
-    <None Include="..\common\Microsoft.Extensions.DependencyModel\LICENSE" LinkBase="Common\Microsoft.Extensions.DependencyModel" />
+    <Compile Include="..\common\AssemblyResolution\**\*.cs" LinkBase="Common\AssemblyResolution" />
   </ItemGroup>
 
   <ItemGroup>
diff --git a/test/test.utility/TestDoubles/SpyMessageBus.cs b/test/test.utility/TestDoubles/SpyMessageBus.cs
index e84d77a6..b8a178bd 100644
--- a/test/test.utility/TestDoubles/SpyMessageBus.cs
+++ b/test/test.utility/TestDoubles/SpyMessageBus.cs
@@ -1,9 +1,9 @@
 ﻿using System;
 using System.Collections.Generic;
+using Xunit;
 using Xunit.Abstractions;
-using Xunit.Sdk;
 
-public class SpyMessageBus : LongLivedMarshalByRefObject, IMessageBus
+public class SpyMessageBus : Xunit.LongLivedMarshalByRefObject, Xunit.Sdk.IMessageBus
 {
     readonly Func<IMessageSinkMessage, bool> cancellationThunk;
 
diff --git a/test/test.utility/TestDoubles/SpyMessageSink.cs b/test/test.utility/TestDoubles/SpyMessageSink.cs
index 20c68d9c..5e9447dc 100644
--- a/test/test.utility/TestDoubles/SpyMessageSink.cs
+++ b/test/test.utility/TestDoubles/SpyMessageSink.cs
@@ -1,8 +1,8 @@
 ﻿using System;
 using System.Collections.Generic;
 using System.Threading;
+using Xunit;
 using Xunit.Abstractions;
-using Xunit.Sdk;
 
 public class SpyMessageSink<TFinalMessage> : LongLivedMarshalByRefObject, IMessageSink
 {
diff --git a/test/test.xunit.execution/Common/AssemblyExtensionsTests.cs b/test/test.xunit.execution/Common/AssemblyExtensionsTests.cs
index a4438788..636a37cf 100644
--- a/test/test.xunit.execution/Common/AssemblyExtensionsTests.cs
+++ b/test/test.xunit.execution/Common/AssemblyExtensionsTests.cs
@@ -1,10 +1,4 @@
 ﻿using System;
-using System.Collections.Generic;
-using System.Linq;
-using System.Reflection;
-using System.Text;
-using System.Threading.Tasks;
-using NSubstitute;
 using Xunit;
 
 public class AssemblyExtensionsTests
diff --git a/test/test.xunit.execution/Sdk/ExtensibilityPointFactoryTests.cs b/test/test.xunit.execution/Sdk/ExtensibilityPointFactoryTests.cs
index 4b476884..184e00f8 100644
--- a/test/test.xunit.execution/Sdk/ExtensibilityPointFactoryTests.cs
+++ b/test/test.xunit.execution/Sdk/ExtensibilityPointFactoryTests.cs
@@ -94,7 +94,7 @@ public void IncompatibleOrInvalidTypesGetDefaultBehavior(string factoryTypeName,
 
             Assert.IsType<CollectionPerClassTestCollectionFactory>(result);
             Assert.Collection(DiagnosticMessages,
-                msg => Assert.Equal<object>(expectedMessage, msg)
+                msg => Assert.Equal(expectedMessage, msg)
             );
         }
 
diff --git a/test/test.xunit.runner.utility/Extensibility/DefaultRunnerReporterMessageHandlerTests.cs b/test/test.xunit.runner.utility/Extensibility/DefaultRunnerReporterMessageHandlerTests.cs
index 1fb749a7..f0cf1ea9 100644
--- a/test/test.xunit.runner.utility/Extensibility/DefaultRunnerReporterMessageHandlerTests.cs
+++ b/test/test.xunit.runner.utility/Extensibility/DefaultRunnerReporterMessageHandlerTests.cs
@@ -160,7 +160,7 @@ public static void LogsMessage(bool diagnosticMessages, string expectedResult)
             handler.OnMessage(message);
 
             var msg = Assert.Single(handler.Messages);
-            Assert.Equal<object>(expectedResult, msg);
+            Assert.Equal(expectedResult, msg);
         }
     }
 
diff --git a/test/test.xunit.runner.utility/Extensibility/DefaultRunnerReporterWithTypesMessageHandlerTests.cs b/test/test.xunit.runner.utility/Extensibility/DefaultRunnerReporterWithTypesMessageHandlerTests.cs
index 91ac3260..ac709dfb 100644
--- a/test/test.xunit.runner.utility/Extensibility/DefaultRunnerReporterWithTypesMessageHandlerTests.cs
+++ b/test/test.xunit.runner.utility/Extensibility/DefaultRunnerReporterWithTypesMessageHandlerTests.cs
@@ -158,7 +158,7 @@ public static void LogsMessage(bool diagnosticMessages, string expectedResult)
             handler.OnMessageWithTypes(message, null);
 
             var msg = Assert.Single(handler.Messages);
-            Assert.Equal<object>(expectedResult, msg);
+            Assert.Equal(expectedResult, msg);
         }
     }
 
diff --git a/test/test.xunit.runner.utility/TestDoubles/TestableDependencyContext.cs b/test/test.xunit.runner.utility/TestDoubles/TestableDependencyContext.cs
index a236e4b6..2a163dca 100644
--- a/test/test.xunit.runner.utility/TestDoubles/TestableDependencyContext.cs
+++ b/test/test.xunit.runner.utility/TestDoubles/TestableDependencyContext.cs
@@ -1,4 +1,6 @@
-﻿using System.Collections.Generic;
+﻿#if NETCOREAPP2_0
+
+using System.Collections.Generic;
 using System.Linq;
 using Internal.Microsoft.Extensions.DependencyModel;
 
@@ -17,3 +19,5 @@ public TestableDependencyContext(List<RuntimeLibrary> runtimeLibraries, List<Run
         InnerRuntimeGraph = runtimeGraph;
     }
 }
+
+#endif
diff --git a/test/test.xunit.runner.utility/TestDoubles/TestableDependencyContextAssemblyCache.cs b/test/test.xunit.runner.utility/TestDoubles/TestableDependencyContextAssemblyCache.cs
index 7a1721cc..08909177 100644
--- a/test/test.xunit.runner.utility/TestDoubles/TestableDependencyContextAssemblyCache.cs
+++ b/test/test.xunit.runner.utility/TestDoubles/TestableDependencyContextAssemblyCache.cs
@@ -1,4 +1,6 @@
-﻿using System;
+﻿#if NETCOREAPP2_0
+
+using System;
 using System.Collections.Generic;
 using System.IO;
 using System.Linq;
@@ -94,10 +96,8 @@ public List<string> GetAndClearDiagnosticMessages()
     public Assembly LoadManagedDll(string assemblyName)
         => LoadManagedDll(assemblyName, location => new DummyAssembly(location));
 
-#if NETCOREAPP2_0
     public IntPtr LoadUnmanagedLibrary(string unmanagedLibraryName)
         => LoadUnmanagedLibrary(unmanagedLibraryName, location => new IntPtr(42));
-#endif
 
     public void MockAllLibrariesPresentInNuGetCache()
     {
@@ -147,3 +147,5 @@ public static TestableDependencyContextAssemblyCache CreateEmpty()
                                                       "unknown",
                                                       Substitute.For<IFileSystem>());
 }
+
+#endif
diff --git a/test/test.xunit.runner.utility/Utility/DependencyContextAssemblyCacheTests.cs b/test/test.xunit.runner.utility/Utility/DependencyContextAssemblyCacheTests.cs
index 5d37ba24..31fa823b 100644
--- a/test/test.xunit.runner.utility/Utility/DependencyContextAssemblyCacheTests.cs
+++ b/test/test.xunit.runner.utility/Utility/DependencyContextAssemblyCacheTests.cs
@@ -1,4 +1,6 @@
-﻿using System;
+﻿#if NETCOREAPP2_0
+
+using System;
 using System.IO;
 using Internal.Microsoft.DotNet.PlatformAbstractions;
 using NSubstitute;
@@ -13,42 +15,30 @@ public class Initialization
                     "osx.10.10-x64",
                     "['osx.10.12-x64','osx.10.12','osx.10.11-x64','osx.10.11','osx.10.10-x64','osx.10.10','osx-x64','osx']",
                     "['osx.10.10-x64','osx.10.10','osx-x64','osx','unix-x64','unix','any','base','']",
-#if NETCOREAPP2_0
                     "['dependency1.dylib','libdependency2.dylib']"
-#else
-                    "[]"
-#endif
         )]
         [InlineData(Platform.Linux,
                     "ubuntu.16.04-x64",
                     "['ubuntu.16.04-x64','ubuntu.16.04','linux-x64','linux']",
                     "['ubuntu.16.04-x64','ubuntu.16.04','ubuntu-x64','ubuntu','linux-x64','linux','unix-x64','unix','any','base','']",
-#if NETCOREAPP2_0
                     "['dependency1.so','libdependency2.so']"
-#else
-                    "[]"
-#endif
         )]
         [InlineData(Platform.Windows,
                     "win10-x64",
                     "['win10-x64','win10']",
                     "['win10-x64','win10','win8-x64','win8','win7-x64','win7','win','any','base','']",
-#if NETCOREAPP2_0
                     "['dependency1.dll','dependency2.dll']"
-#else
-                    "[]"
-#endif
         )]
         internal void KnownRuntime(Platform platform, string runtime, string expectedRuntimeGraph, string expectedCompatibleRuntimes, string expectedUnmanagedMap)
         {
             var cache = TestableDependencyContextAssemblyCache.Create(platform, runtime);
 
             Assert.Collection(cache.GetAndClearDiagnosticMessages(),
-                message => Assert.Equal<object>($"[XunitPackageCompilationAssemblyResolver.GetDefaultProbeDirectories] returns: ['{NuGetHelper.PackageCachePath}']", message),
-                message => Assert.Equal<object>($"[DependencyContextAssemblyCache..ctor] Runtime graph: {expectedRuntimeGraph}", message),
-                message => Assert.Equal<object>($"[DependencyContextAssemblyCache..ctor] Compatible runtimes: {expectedCompatibleRuntimes}", message),
-                message => Assert.Equal<object>("[DependencyContextAssemblyCache..ctor] Managed assembly map: ['managed.ref1','managed.ref2']", message),
-                message => Assert.Equal<object>($"[DependencyContextAssemblyCache..ctor] Unmanaged assembly map: {expectedUnmanagedMap}", message)
+                message => Assert.StartsWith($"[XunitPackageCompilationAssemblyResolver.GetDefaultProbeDirectories] returns: [", message),
+                message => Assert.Equal($"[DependencyContextAssemblyCache..ctor] Runtime graph: {expectedRuntimeGraph}", message),
+                message => Assert.Equal($"[DependencyContextAssemblyCache..ctor] Compatible runtimes: {expectedCompatibleRuntimes}", message),
+                message => Assert.Equal("[DependencyContextAssemblyCache..ctor] Managed assembly map: ['managed.ref1','managed.ref2']", message),
+                message => Assert.Equal($"[DependencyContextAssemblyCache..ctor] Unmanaged assembly map: {expectedUnmanagedMap}", message)
             );
         }
 
@@ -229,8 +219,8 @@ public void NotInCache()
 
                 Assert.Null(result);
                 Assert.Collection(cache.GetAndClearDiagnosticMessages(),
-                    message => Assert.Equal<object>("[DependencyContextAssemblyCache.ResolveManagedAssembly] Resolving 'managed.ref1', found in dependency map, but unable to resolve a path in ['runtime/any/managed.ref1.dll','runtime/any/managed.ref2.dll']", message),
-                    message => Assert.Equal<object>("[DependencyContextAssemblyCache.LoadManagedDll] Resolution for 'managed.ref1' failed, passed down to next resolver", message)
+                    message => Assert.Equal("[DependencyContextAssemblyCache.ResolveManagedAssembly] Resolving 'managed.ref1', found in dependency map, but unable to resolve a path in ['runtime/any/managed.ref1.dll','runtime/any/managed.ref2.dll']", message),
+                    message => Assert.Equal("[DependencyContextAssemblyCache.LoadManagedDll] Resolution for 'managed.ref1' failed, passed down to next resolver", message)
                 );
             }
 
@@ -289,7 +279,6 @@ public void PresentLocally()
         }
     }
 
-#if NETCOREAPP2_0
     public class UnmanagedLibrary
     {
         [Fact]
@@ -344,5 +333,6 @@ internal void InCache(Platform platform, string runtime, string unmanagedLibrary
             Assert.Equal($"[DependencyContextAssemblyCache.LoadUnmanagedLibrary] Resolved '{unmanagedLibraryName}' to '{expectedPath}'", message);
         }
     }
-#endif
 }
+
+#endif
\ No newline at end of file
diff --git a/test/test.xunit.runner.utility/test.xunit.runner.utility.csproj b/test/test.xunit.runner.utility/test.xunit.runner.utility.csproj
index ff034ce5..819a9647 100644
--- a/test/test.xunit.runner.utility/test.xunit.runner.utility.csproj
+++ b/test/test.xunit.runner.utility/test.xunit.runner.utility.csproj
@@ -16,11 +16,8 @@
     <Compile Include="..\..\src\common\SerializationHelper.cs" LinkBase="Common" />
     <Compile Include="..\..\src\common\TestOptionsNames.cs" LinkBase="Common" />
     <Compile Include="..\..\src\common\XunitSerializationInfo.cs" LinkBase="Common" />
-    <Compile Include="..\..\src\common\Microsoft.DotNet.PlatformAbstractions\**\*.cs" LinkBase="Common\Microsoft.DotNet.PlatformAbstractions" />
-    <Compile Include="..\..\src\common\Microsoft.Extensions.DependencyModel\**\*.cs" LinkBase="Common\Microsoft.Extensions.DependencyModel" />
+    <Compile Include="..\..\src\common\AssemblyResolution\**\*.cs" LinkBase="Common\AssemblyResolution" />
     <Compile Include="..\..\src\xunit.runner.utility\Frameworks\v1\Xunit1ExceptionUtility.cs" LinkBase="Common\RunnerUtility" />
-    <Compile Include="..\..\src\xunit.runner.utility\Utility\DependencyContextAssemblyCache.cs" LinkBase="Common\RunnerUtility" />
-    <Compile Include="..\..\src\xunit.runner.utility\Utility\DependencyModel\XunitPackageCompilationAssemblyResolver.cs" LinkBase="Common\RunnerUtility" />
   </ItemGroup>
 
   <ItemGroup>
diff --git a/xunit.vs2017.sln b/xunit.vs2017.sln
index 61815d52..350dcaff 100644
--- a/xunit.vs2017.sln
+++ b/xunit.vs2017.sln
@@ -1,7 +1,7 @@
 ﻿
 Microsoft Visual Studio Solution File, Format Version 12.00
 # Visual Studio 15
-VisualStudioVersion = 15.0.27004.2005
+VisualStudioVersion = 15.0.27130.2010
 MinimumVisualStudioVersion = 14.0.22823.1
 Project("{2150E333-8FDC-42A3-9474-1A3956D46DE8}") = "Source", "Source", "{DAED8494-AC8A-4C67-A8F1-616D95ECC302}"
 	ProjectSection(SolutionItems) = preProject
@@ -112,6 +112,8 @@ Project("{9A19103F-16F7-4668-BE54-9A1E7A4F7556}") = "test.testcasefilter", "test
 EndProject
 Project("{9A19103F-16F7-4668-BE54-9A1E7A4F7556}") = "test.xunit.runner.visualstudio", "test\test.xunit.runner.visualstudio\test.xunit.runner.visualstudio.csproj", "{BD1E1BC0-B37B-48AA-AB56-781ACE2109D8}"
 EndProject
+Project("{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}") = "xunit.runner.assemblies", "src\xunit.runner.assemblies\xunit.runner.assemblies.csproj", "{0DE0D908-6454-43D0-8DB7-9146D5B1B548}"
+EndProject
 Global
 	GlobalSection(SolutionConfigurationPlatforms) = preSolution
 		Debug_x86|Any CPU = Debug_x86|Any CPU
@@ -296,6 +298,14 @@ Global
 		{BD1E1BC0-B37B-48AA-AB56-781ACE2109D8}.Release_x86|Any CPU.Build.0 = Release|Any CPU
 		{BD1E1BC0-B37B-48AA-AB56-781ACE2109D8}.Release|Any CPU.ActiveCfg = Release|Any CPU
 		{BD1E1BC0-B37B-48AA-AB56-781ACE2109D8}.Release|Any CPU.Build.0 = Release|Any CPU
+		{0DE0D908-6454-43D0-8DB7-9146D5B1B548}.Debug_x86|Any CPU.ActiveCfg = Debug|Any CPU
+		{0DE0D908-6454-43D0-8DB7-9146D5B1B548}.Debug_x86|Any CPU.Build.0 = Debug|Any CPU
+		{0DE0D908-6454-43D0-8DB7-9146D5B1B548}.Debug|Any CPU.ActiveCfg = Debug|Any CPU
+		{0DE0D908-6454-43D0-8DB7-9146D5B1B548}.Debug|Any CPU.Build.0 = Debug|Any CPU
+		{0DE0D908-6454-43D0-8DB7-9146D5B1B548}.Release_x86|Any CPU.ActiveCfg = Release|Any CPU
+		{0DE0D908-6454-43D0-8DB7-9146D5B1B548}.Release_x86|Any CPU.Build.0 = Release|Any CPU
+		{0DE0D908-6454-43D0-8DB7-9146D5B1B548}.Release|Any CPU.ActiveCfg = Release|Any CPU
+		{0DE0D908-6454-43D0-8DB7-9146D5B1B548}.Release|Any CPU.Build.0 = Release|Any CPU
 	EndGlobalSection
 	GlobalSection(SolutionProperties) = preSolution
 		HideSolutionNode = FALSE
@@ -332,6 +342,7 @@ Global
 		{378C9C3B-D783-4728-A368-373E081ADD59} = {2DF4CF8D-7096-45B8-BEFF-7518E5264DF4}
 		{8D57BD0A-F46C-44FF-8AFE-D571D9230C44} = {2DF4CF8D-7096-45B8-BEFF-7518E5264DF4}
 		{BD1E1BC0-B37B-48AA-AB56-781ACE2109D8} = {9D9F81DC-EE05-43B4-AF77-8EFE32024E82}
+		{0DE0D908-6454-43D0-8DB7-9146D5B1B548} = {A727699B-E50A-4F83-8627-8BE64237582C}
 	EndGlobalSection
 	GlobalSection(ExtensibilityGlobals) = postSolution
 		SolutionGuid = {290036A3-A9C9-4AB2-8D97-7DA0711FDABD}
