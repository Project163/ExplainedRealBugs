diff --git a/src/dotnet-xunit/ArgParser.cs b/src/dotnet-xunit/ArgParser.cs
index a9196815..d707a9e1 100644
--- a/src/dotnet-xunit/ArgParser.cs
+++ b/src/dotnet-xunit/ArgParser.cs
@@ -5,9 +5,9 @@ public static class ArgParser
 {
     // Simple argument parser that doesn't do much validation, since we will rely on the inner
     // runners to do the argument validation.
-    public static Dictionary<string, string> Parse(string[] args)
+    public static Dictionary<string, List<string>> Parse(string[] args)
     {
-        var result = new Dictionary<string, string>(StringComparer.OrdinalIgnoreCase);
+        var result = new Dictionary<string, List<string>>(StringComparer.OrdinalIgnoreCase);
         var idx = 0;
 
         while (idx < args.Length)
@@ -16,10 +16,16 @@ public static class ArgParser
             if (!arg.StartsWith("-"))
                 throw new ArgumentException($"Unexpected parameter: {arg}");
 
+            if (!result.TryGetValue(arg, out var values))
+            {
+                values = new List<string>();
+                result.Add(arg, values);
+            }
+
             if (idx < args.Length && !args[idx].StartsWith("-"))
-                result.Add(arg, args[idx++]);
+                values.Add(args[idx++]);
             else
-                result.Add(arg, null);
+                values.Add(null);
         }
 
         return result;
diff --git a/src/dotnet-xunit/DictionaryExtensions.cs b/src/dotnet-xunit/DictionaryExtensions.cs
index 9af6a309..56b1e1b0 100644
--- a/src/dotnet-xunit/DictionaryExtensions.cs
+++ b/src/dotnet-xunit/DictionaryExtensions.cs
@@ -3,9 +3,9 @@
 
 static class DictionaryExtensions
 {
-    public static string GetAndRemoveParameterWithValue(this Dictionary<string, string> dictionary, string key)
+    public static string GetAndRemoveParameterWithValue(this Dictionary<string, List<string>> dictionary, string key)
     {
-        if (dictionary.TryGetValue(key, out var result))
+        if (dictionary.TryGetSingleValue(key, out var result))
         {
             if (result == null)
                 throw new ArgumentException($"Missing value for option '{key}'");
@@ -16,9 +16,9 @@ public static string GetAndRemoveParameterWithValue(this Dictionary<string, stri
         return result;
     }
 
-    public static bool TryGetAndRemoveParameterWithoutValue(this Dictionary<string, string> dictionary, string key)
+    public static bool TryGetAndRemoveParameterWithoutValue(this Dictionary<string, List<string>> dictionary, string key)
     {
-        if (dictionary.TryGetValue(key, out var result))
+        if (dictionary.TryGetSingleValue(key, out var result))
         {
             if (result != null)
                 throw new ArgumentException($"Option '{key}' should not have a value");
@@ -30,9 +30,9 @@ public static bool TryGetAndRemoveParameterWithoutValue(this Dictionary<string,
         return false;
     }
 
-    public static bool TryGetParameterWithoutValue(this Dictionary<string, string> dictionary, string key)
+    public static bool TryGetParameterWithoutValue(this Dictionary<string, List<string>> dictionary, string key)
     {
-        if (dictionary.TryGetValue(key, out var result))
+        if (dictionary.TryGetSingleValue(key, out var result))
         {
             if (result != null)
                 throw new ArgumentException($"Option '{key}' should not have a value");
@@ -42,4 +42,18 @@ public static bool TryGetParameterWithoutValue(this Dictionary<string, string> d
 
         return false;
     }
+
+    public static bool TryGetSingleValue(this Dictionary<string, List<string>> dictionary, string key, out string value)
+    {
+        value = null;
+
+        if (!dictionary.TryGetValue(key, out var values))
+            return false;
+
+        if (values.Count > 1)
+            throw new ArgumentException($"Option '{key}' cannot be set more than once");
+
+        value = values[0];
+        return true;
+    }
 }
diff --git a/src/dotnet-xunit/Program.cs b/src/dotnet-xunit/Program.cs
index ac3c6b32..531a3564 100644
--- a/src/dotnet-xunit/Program.cs
+++ b/src/dotnet-xunit/Program.cs
@@ -16,7 +16,7 @@ class Program
     string FxVersion;
     bool InternalDiagnostics;
     bool NoColor;
-    Dictionary<string, string> ParsedArgs;
+    Dictionary<string, List<string>> ParsedArgs;
 
     static int Main(string[] args)
         => new Program().Execute(args);
@@ -57,8 +57,8 @@ int Execute(string[] args)
                 // in the context of the bin folder, not the project folder
                 var currentDirectory = Directory.GetCurrentDirectory();
                 foreach (var key in OutputFileArgs)
-                    if (ParsedArgs.TryGetValue(key, out var fileName))
-                        ParsedArgs[key] = Path.GetFullPath(Path.Combine(currentDirectory, fileName));
+                    if (ParsedArgs.TryGetSingleValue(key, out var fileName))
+                        ParsedArgs[key][0] = Path.GetFullPath(Path.Combine(currentDirectory, fileName));
             }
             catch (ArgumentException ex)
             {
@@ -256,10 +256,10 @@ int RunTargetFramework(string testProject, string targetFramework, bool amendOut
 
         if (amendOutputFileNames)
         {
-            var amendedParsedArgs = new Dictionary<string, string>(ParsedArgs);
+            var amendedParsedArgs = ParsedArgs.ToDictionary(kvp => kvp.Key, kvp => new List<string>(kvp.Value));
             foreach (var key in OutputFileArgs)
-                if (amendedParsedArgs.TryGetValue(key, out var filePath))
-                    amendedParsedArgs[key] = Path.Combine(Path.GetDirectoryName(filePath), $"{Path.GetFileNameWithoutExtension(filePath)}-{targetFramework}{Path.GetExtension(filePath)}");
+                if (amendedParsedArgs.TryGetSingleValue(key, out var filePath))
+                    amendedParsedArgs[key][0] = Path.Combine(Path.GetDirectoryName(filePath), $"{Path.GetFileNameWithoutExtension(filePath)}-{targetFramework}{Path.GetExtension(filePath)}");
             extraArgs = ToArgumentsString(amendedParsedArgs);
         }
         else
@@ -390,8 +390,8 @@ int RunDotNetCoreProject(string outputPath, string assemblyName, string targetFi
         return runTests.ExitCode;
     }
 
-    string ToArgumentsString(Dictionary<string, string> parsedArgs)
-        => string.Join(" ", parsedArgs.Select(kvp => kvp.Value == null ? kvp.Key : $"{kvp.Key} \"{kvp.Value}\""));
+    string ToArgumentsString(Dictionary<string, List<string>> parsedArgs)
+        => string.Join(" ", parsedArgs.SelectMany(kvp => kvp.Value.Select(value => value == null ? kvp.Key : $"{kvp.Key} \"{value}\"")));
 
     void WriteLine(string message)
         => WriteLineWithColor(ConsoleColor.White, message);
