diff --git a/src/common/ExceptionUtility.cs b/src/common/ExceptionUtility.cs
index 4a5dcb4d..7b11a19d 100644
--- a/src/common/ExceptionUtility.cs
+++ b/src/common/ExceptionUtility.cs
@@ -47,9 +47,9 @@ static string FilterStackTrace(string stack)
 
             var results = new List<string>();
 
-            foreach (string line in SplitLines(stack))
+            foreach (var line in SplitLines(stack))
             {
-                string trimmedLine = line.TrimStart();
+                var trimmedLine = line.TrimStart();
                 if (!ExcludeStackFrame(trimmedLine))
                     results.Add(line);
             }
@@ -57,26 +57,42 @@ static string FilterStackTrace(string stack)
             return string.Join(Environment.NewLine, results.ToArray());
         }
 
+        static string GetAt(string[] values, int index)
+        {
+            if (values == null || index < 0 || values.Length <= index)
+                return String.Empty;
+
+            return values[index] ?? String.Empty;
+        }
+
+        static int GetAt(int[] values, int index)
+        {
+            if (values == null || values.Length <= index)
+                return -1;
+
+            return values[index];
+        }
+
         static string GetMessage(IFailureInformation failureInfo, int index, int level)
         {
-            string result = "";
+            var result = "";
 
             if (level > 0)
             {
-                for (int idx = 0; idx < level; idx++)
+                for (var idx = 0; idx < level; idx++)
                     result += "----";
 
                 result += " ";
             }
 
-            var exceptionType = failureInfo.ExceptionTypes[index];
+            var exceptionType = GetAt(failureInfo.ExceptionTypes, index);
             if (GetNamespace(exceptionType) != "Xunit.Sdk")
                 result += exceptionType + " : ";
 
-            result += failureInfo.Messages[index];
+            result += GetAt(failureInfo.Messages, index);
 
-            for (int subIndex = index + 1; subIndex < failureInfo.ExceptionParentIndices.Length; ++subIndex)
-                if (failureInfo.ExceptionParentIndices[subIndex] == index)
+            for (var subIndex = index + 1; subIndex < failureInfo.ExceptionParentIndices.Length; ++subIndex)
+                if (GetAt(failureInfo.ExceptionParentIndices, subIndex) == index)
                     result += Environment.NewLine + GetMessage(failureInfo, subIndex, level + 1);
 
             return result;
@@ -93,26 +109,26 @@ private static string GetNamespace(string exceptionType)
 
         static string GetStackTrace(IFailureInformation failureInfo, int index)
         {
-            string result = FilterStackTrace(failureInfo.StackTraces[index]);
+            var result = FilterStackTrace(GetAt(failureInfo.StackTraces, index));
 
             var children = new List<int>();
-            for (int subIndex = index + 1; subIndex < failureInfo.ExceptionParentIndices.Length; ++subIndex)
-                if (failureInfo.ExceptionParentIndices[subIndex] == index)
+            for (var subIndex = index + 1; subIndex < failureInfo.ExceptionParentIndices.Length; ++subIndex)
+                if (GetAt(failureInfo.ExceptionParentIndices, subIndex) == index)
                     children.Add(subIndex);
 
             if (children.Count > 1)
             {
-                for (int idx = 0; idx < children.Count; ++idx)
+                for (var idx = 0; idx < children.Count; ++idx)
                     result += String.Format("{0}----- Inner Stack Trace #{1} ({2}) -----{0}{3}",
                                             Environment.NewLine,
                                             idx + 1,
-                                            failureInfo.ExceptionTypes[children[idx]],
+                                            GetAt(failureInfo.ExceptionTypes, children[idx]),
                                             GetStackTrace(failureInfo, children[idx]));
             }
             else if (children.Count == 1)
-                result += Environment.NewLine +
-                          "----- Inner Stack Trace -----" + Environment.NewLine +
-                          GetStackTrace(failureInfo, children[0]);
+                result += string.Format("{0}----- Inner Stack Trace -----{0}{1}",
+                                        Environment.NewLine,
+                                        GetStackTrace(failureInfo, children[0]));
 
             return result;
         }
@@ -122,7 +138,7 @@ static IEnumerable<string> SplitLines(string input)
         {
             while (true)
             {
-                int idx = input.IndexOf(Environment.NewLine);
+                var idx = input.IndexOf(Environment.NewLine);
 
                 if (idx < 0)
                 {
diff --git a/test/test.xunit.runner.utility/Utility/ExceptionUtilityTests.cs b/test/test.xunit.runner.utility/Utility/ExceptionUtilityTests.cs
index 4282dad1..7bf2e20e 100644
--- a/test/test.xunit.runner.utility/Utility/ExceptionUtilityTests.cs
+++ b/test/test.xunit.runner.utility/Utility/ExceptionUtilityTests.cs
@@ -10,10 +10,10 @@ public class ExceptionUtilityTests
 {
     class FailureInformation : IFailureInformation, IEnumerable
     {
-        List<int> exceptionParentIndices = new List<int>();
-        List<string> exceptionTypes = new List<string>();
-        List<string> messages = new List<string>();
-        List<string> stackTraces = new List<string>();
+        readonly List<int> exceptionParentIndices = new List<int>();
+        readonly List<string> exceptionTypes = new List<string>();
+        readonly List<string> messages = new List<string>();
+        readonly List<string> stackTraces = new List<string>();
 
         public string[] ExceptionTypes
         {
@@ -48,6 +48,26 @@ public void Add(Type exceptionType, string message = null, string stackTrace = n
             exceptionParentIndices.Add(index);
         }
 
+        public void AddExceptionType(string exceptionTypeName)
+        {
+            exceptionTypes.Add(exceptionTypeName);
+        }
+
+        public void AddIndex(int index)
+        {
+            exceptionParentIndices.Add(index);
+        }
+
+        public void AddMessage(string message)
+        {
+            messages.Add(message);
+        }
+
+        public void AddStackTrace(string stackTrace)
+        {
+            stackTraces.Add(stackTrace);
+        }
+
         public IEnumerator GetEnumerator()
         {
             throw new NotImplementedException();
@@ -109,6 +129,26 @@ public void AggregateException()
                        + "---- System.NotImplementedException : inner #2" + Environment.NewLine
                        + "---- this is crazy", result);
         }
+
+        [Fact]
+        public void MissingExceptionTypes()
+        {
+            var failureInfo = new FailureInformation();
+            failureInfo.AddMessage("Message 1");
+            failureInfo.AddMessage("Message 2");
+            failureInfo.AddMessage("Message 3");
+            failureInfo.AddIndex(-1);
+            failureInfo.AddIndex(0);
+            failureInfo.AddIndex(0);
+            failureInfo.AddExceptionType("ExceptionType1");
+            failureInfo.AddExceptionType("Xunit.Sdk.ExceptionType2");
+
+            var result = ExceptionUtility.CombineMessages(failureInfo);
+
+            Assert.Equal("ExceptionType1 : Message 1" + Environment.NewLine +
+                         "---- Message 2" + Environment.NewLine +
+                         "----  : Message 3", result);
+        }
     }
 
     public class CombineStackTraces
@@ -184,5 +224,28 @@ public void AggregateException()
                 line => Assert.Contains("at ExceptionUtilityTests.CombineStackTraces", line)
             );
         }
+
+        [Fact]
+        public void MissingStackTracesAndExceptionTypes()
+        {
+            var failureInfo = new FailureInformation();
+            failureInfo.AddMessage("Message 1");
+            failureInfo.AddMessage("Message 2");
+            failureInfo.AddMessage("Message 3");
+            failureInfo.AddIndex(-1);
+            failureInfo.AddIndex(0);
+            failureInfo.AddIndex(0);
+            failureInfo.AddExceptionType("ExceptionType1");
+            failureInfo.AddExceptionType("Xunit.Sdk.ExceptionType2");
+            failureInfo.AddStackTrace("Stack Trace 1");
+            failureInfo.AddStackTrace("Stack Trace 2");
+
+            var result = ExceptionUtility.CombineStackTraces(failureInfo);
+
+            Assert.Equal("Stack Trace 1" + Environment.NewLine +
+                         "----- Inner Stack Trace #1 (Xunit.Sdk.ExceptionType2) -----" + Environment.NewLine +
+                         "Stack Trace 2" + Environment.NewLine +
+                         "----- Inner Stack Trace #2 () -----" + Environment.NewLine, result);
+        }
     }
 }
\ No newline at end of file
