{"url":"https://api.github.com/repos/xunit/xunit/issues/1522","repository_url":"https://api.github.com/repos/xunit/xunit","labels_url":"https://api.github.com/repos/xunit/xunit/issues/1522/labels{/name}","comments_url":"https://api.github.com/repos/xunit/xunit/issues/1522/comments","events_url":"https://api.github.com/repos/xunit/xunit/issues/1522/events","html_url":"https://github.com/xunit/xunit/issues/1522","id":266603210,"node_id":"MDU6SXNzdWUyNjY2MDMyMTA=","number":1522,"title":"Running xunit.runner.console in 2.3.0 while output directed to xml, on second run results in malformed xml","user":{"login":"bone9820","id":17709153,"node_id":"MDQ6VXNlcjE3NzA5MTUz","avatar_url":"https://avatars.githubusercontent.com/u/17709153?v=4","gravatar_id":"","url":"https://api.github.com/users/bone9820","html_url":"https://github.com/bone9820","followers_url":"https://api.github.com/users/bone9820/followers","following_url":"https://api.github.com/users/bone9820/following{/other_user}","gists_url":"https://api.github.com/users/bone9820/gists{/gist_id}","starred_url":"https://api.github.com/users/bone9820/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bone9820/subscriptions","organizations_url":"https://api.github.com/users/bone9820/orgs","repos_url":"https://api.github.com/users/bone9820/repos","events_url":"https://api.github.com/users/bone9820/events{/privacy}","received_events_url":"https://api.github.com/users/bone9820/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2017-10-18T18:52:20Z","updated_at":"2017-10-19T17:38:58Z","closed_at":"2017-10-19T17:09:09Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"When running the console runner and output is directed to xml, the second and subsequent runs can result in malformed xml. It appears that the output has remaining information in the buffer and is writing that out.\r\n\r\nConsole params: \r\nxunit.console.exe C:\\jenkins\\workspace\\cbh-common-lib\\Lib.Measurement.Test\\bin\\Release\\Lib.Measurement.Test.dll -xml C:\\jenkins\\workspace\\cbh-common-lib\\test_results\\Lib.Measurement.Test.dll.xml\r\n\r\nBelow is a very simple project that runs just fine and tests just fine in the studio but when run through the console runner and output passes it results in the following;\r\n\r\n`<?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n<assemblies timestamp=\"10/18/2017 12:42:03\">\r\n  <assembly name=\"C:\\jenkins\\workspace\\cbh-common-lib\\Lib.Measurement.Test\\bin\\Release\\Lib.Measurement.Test.DLL\" environment=\"64-bit .NET 4.0.30319.42000 [collection-per-class, parallel (2 threads)]\" test-framework=\"xUnit.net 2.3.0.3820\" run-date=\"2017-10-18\" run-time=\"12:42:01\" config-file=\"C:\\jenkins\\workspace\\cbh-common-lib\\packages\\xunit.runner.console.2.3.0\\tools\\net452\\xunit.console.exe.Config\" total=\"18\" passed=\"18\" failed=\"0\" skipped=\"0\" time=\"1.277\" errors=\"0\">\r\n    <errors />\r\n    <collection total=\"9\" passed=\"9\" failed=\"0\" skipped=\"0\" name=\"Test collection for Lib.Measurement.Test.CheckpointTest\" time=\"0.094\">\r\n      <test name=\"Lib.Measurement.Test.CheckpointTest.GetJournalTextTest\" type=\"Lib.Measurement.Test.CheckpointTest\" method=\"GetJournalTextTest\" time=\"0.0895785\" result=\"Pass\" />\r\n      <test name=\"Lib.Measurement.Test.CheckpointTest.ClassNameTest\" type=\"Lib.Measurement.Test.CheckpointTest\" method=\"ClassNameTest\" time=\"0.0004318\" result=\"Pass\" />\r\n      <test name=\"Lib.Measurement.Test.CheckpointTest.SubeventNameTest\" type=\"Lib.Measurement.Test.CheckpointTest\" method=\"SubeventNameTest\" time=\"0.0006284\" result=\"Pass\" />\r\n      <test name=\"Lib.Measurement.Test.CheckpointTest.ApplicationNameTest\" type=\"Lib.Measurement.Test.CheckpointTest\" method=\"ApplicationNameTest\" time=\"0.0004804\" result=\"Pass\" />\r\n      <test name=\"Lib.Measurement.Test.CheckpointTest.ProjectNameTest\" type=\"Lib.Measurement.Test.CheckpointTest\" method=\"ProjectNameTest\" time=\"0.00039\" result=\"Pass\" />\r\n      <test name=\"Lib.Measurement.Test.CheckpointTest.OffsetTest\" type=\"Lib.Measurement.Test.CheckpointTest\" method=\"OffsetTest\" time=\"0.000705\" result=\"Pass\" />\r\n      <test name=\"Lib.Measurement.Test.CheckpointTest.EventNameTest\" type=\"Lib.Measurement.Test.CheckpointTest\" method=\"EventNameTest\" time=\"0.0003461\" result=\"Pass\" />\r\n      <test name=\"Lib.Measurement.Test.CheckpointTest.CheckpointConstructorTest\" type=\"Lib.Measurement.Test.CheckpointTest\" method=\"CheckpointConstructorTest\" time=\"0.0003647\" result=\"Pass\" />\r\n      <test name=\"Lib.Measurement.Test.CheckpointTest.ProcessStartTimeTest\" type=\"Lib.Measurement.Test.CheckpointTest\" method=\"ProcessStartTimeTest\" time=\"0.0007421\" result=\"Pass\" />\r\n    </collection>\r\n    <collection total=\"9\" passed=\"9\" failed=\"0\" skipped=\"0\" name=\"Test collection for Lib.Measurement.Test.CodeTimerTest\" time=\"1.137\">\r\n      <test name=\"Lib.Measurement.Test.CodeTimerTest.FailTimerTest\" type=\"Lib.Measurement.Test.CodeTimerTest\" method=\"FailTimerTest\" time=\"0.1287063\" result=\"Pass\" />\r\n      <test name=\"Lib.Measurement.Test.CodeTimerTest.StartTimerTest\" type=\"Lib.Measurement.Test.CodeTimerTest\" method=\"StartTimerTest\" time=\"1.0028721\" result=\"Pass\" />\r\n      <test name=\"Lib.Measurement.Test.CodeTimerTest.StopTimerTest\" type=\"Lib.Measurement.Test.CodeTimerTest\" method=\"StopTimerTest\" time=\"0.0008179\" result=\"Pass\" />\r\n      <test name=\"Lib.Measurement.Test.CodeTimerTest.StartedTest\" type=\"Lib.Measurement.Test.CodeTimerTest\" method=\"StartedTest\" time=\"0.0008823\" result=\"Pass\" />\r\n      <test name=\"Lib.Measurement.Test.CodeTimerTest.TimerDisposeTest\" type=\"Lib.Measurement.Test.CodeTimerTest\" method=\"TimerDisposeTest\" time=\"0.0007236\" result=\"Pass\" />\r\n      <test name=\"Lib.Measurement.Test.CodeTimerTest.TimerConstructorTest\" type=\"Lib.Measurement.Test.CodeTimerTest\" method=\"TimerConstructorTest\" time=\"0.0006924\" result=\"Pass\" />\r\n      <test name=\"Lib.Measurement.Test.CodeTimerTest.TimerEventTest\" type=\"Lib.Measurement.Test.CodeTimerTest\" method=\"TimerEventTest\" time=\"0.0003904\" result=\"Pass\" />\r\n      <test name=\"Lib.Measurement.Test.CodeTimerTest.GetJournalTextTest\" type=\"Lib.Measurement.Test.CodeTimerTest\" method=\"GetJournalTextTest\" time=\"0.0010745\" result=\"Pass\" />\r\n      <test name=\"Lib.Measurement.Test.CodeTimerTest.RunningTest\" type=\"Lib.Measurement.Test.CodeTimerTest\" method=\"RunningTest\" time=\"0.0010809\" result=\"Pass\" />\r\n    </collection>\r\n  </assembly>\r\n</assemblies>es>`\r\n\r\nAs you can see on the last line it gets an extra \"es>\" stuffed in there. I have also seen it where you get more of the word assemblies. The current work around is to simply delete the existing file prior to run.\r\n\r\n\r\nhttps://github.com/bone9820/xunit-error","closed_by":{"login":"bradwilson","id":16944,"node_id":"MDQ6VXNlcjE2OTQ0","avatar_url":"https://avatars.githubusercontent.com/u/16944?v=4","gravatar_id":"","url":"https://api.github.com/users/bradwilson","html_url":"https://github.com/bradwilson","followers_url":"https://api.github.com/users/bradwilson/followers","following_url":"https://api.github.com/users/bradwilson/following{/other_user}","gists_url":"https://api.github.com/users/bradwilson/gists{/gist_id}","starred_url":"https://api.github.com/users/bradwilson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bradwilson/subscriptions","organizations_url":"https://api.github.com/users/bradwilson/orgs","repos_url":"https://api.github.com/users/bradwilson/repos","events_url":"https://api.github.com/users/bradwilson/events{/privacy}","received_events_url":"https://api.github.com/users/bradwilson/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/xunit/xunit/issues/1522/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/xunit/xunit/issues/1522/timeline","performed_via_github_app":null,"state_reason":"completed"}