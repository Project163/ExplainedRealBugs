{"url":"https://api.github.com/repos/xunit/xunit/issues/5","repository_url":"https://api.github.com/repos/xunit/xunit","labels_url":"https://api.github.com/repos/xunit/xunit/issues/5/labels{/name}","comments_url":"https://api.github.com/repos/xunit/xunit/issues/5/comments","events_url":"https://api.github.com/repos/xunit/xunit/issues/5/events","html_url":"https://github.com/xunit/xunit/issues/5","id":25818136,"node_id":"MDU6SXNzdWUyNTgxODEzNg==","number":5,"title":"Exception parsing is REALLY difficult","user":{"login":"citizenmatt","id":222659,"node_id":"MDQ6VXNlcjIyMjY1OQ==","avatar_url":"https://avatars.githubusercontent.com/u/222659?v=4","gravatar_id":"","url":"https://api.github.com/users/citizenmatt","html_url":"https://github.com/citizenmatt","followers_url":"https://api.github.com/users/citizenmatt/followers","following_url":"https://api.github.com/users/citizenmatt/following{/other_user}","gists_url":"https://api.github.com/users/citizenmatt/gists{/gist_id}","starred_url":"https://api.github.com/users/citizenmatt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/citizenmatt/subscriptions","organizations_url":"https://api.github.com/users/citizenmatt/orgs","repos_url":"https://api.github.com/users/citizenmatt/repos","events_url":"https://api.github.com/users/citizenmatt/events{/privacy}","received_events_url":"https://api.github.com/users/citizenmatt/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":75574830,"node_id":"MDU6TGFiZWw3NTU3NDgzMA==","url":"https://api.github.com/repos/xunit/xunit/labels/Feature","name":"Feature","color":"FEF2C0","default":false,"description":"A request for a new feature"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/xunit/xunit/milestones/1","html_url":"https://github.com/xunit/xunit/milestone/1","labels_url":"https://api.github.com/repos/xunit/xunit/milestones/1/labels","id":497765,"node_id":"MDk6TWlsZXN0b25lNDk3NzY1","number":1,"title":"2.0-beta-1","description":"Build 2616","creator":{"login":"bradwilson","id":16944,"node_id":"MDQ6VXNlcjE2OTQ0","avatar_url":"https://avatars.githubusercontent.com/u/16944?v=4","gravatar_id":"","url":"https://api.github.com/users/bradwilson","html_url":"https://github.com/bradwilson","followers_url":"https://api.github.com/users/bradwilson/followers","following_url":"https://api.github.com/users/bradwilson/following{/other_user}","gists_url":"https://api.github.com/users/bradwilson/gists{/gist_id}","starred_url":"https://api.github.com/users/bradwilson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bradwilson/subscriptions","organizations_url":"https://api.github.com/users/bradwilson/orgs","repos_url":"https://api.github.com/users/bradwilson/repos","events_url":"https://api.github.com/users/bradwilson/events{/privacy}","received_events_url":"https://api.github.com/users/bradwilson/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":10,"state":"closed","created_at":"2013-11-26T21:23:17Z","updated_at":"2014-07-19T19:05:37Z","due_on":null,"closed_at":"2014-07-19T19:05:37Z"},"comments":3,"created_at":"2014-01-17T16:22:02Z","updated_at":"2014-03-23T00:07:48Z","closed_at":"2014-03-15T21:36:08Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"I'm trying to port the ReSharper runner to use xunit2, and a couple of things have changed with the way exception information is passed that's making it really awkward to parse. Rather than output the exception information directly to the user, I need to capture it as type/message/stack trace information, and ReSharper can format it nicely in the results pane. I've been doing this with regexes up until now (and never really been satisfied with that) but it's worked.\n\nxunit2 has tweaked some of the formatting, and introduced AggregateException, and it's making things much more awkward. For example, the message string now contains information about single, inner or aggregate exceptions, and each message could potentially include a \"----\" marker or not, or a newline from the exception itself. It usually includes the type information, but not for xunit asserts, where I have to get the type information from the stack trace, but only if it's an aggregated exception, because nested exceptions don't include type information. It's all do-able, but it's a proper PITA, and messy.\n\nCan I suggest a change from 3 strings (type, messages, stackTraces) to string arrays? Using arrays will still work with the cross-domain messaging, as they're simple CLR types (although I haven't tested it). Instead of packing all messages into one string, and all stack traces into another string, and using the type just for the main outer exception, each exception can enter it's type, message and stack trace separately into the arrays.\n\nI personally don't need to know that an exception is inner or not, but that information could be encoded in a fourth array that acts as an index. A simple way to do it would be use an int array that points to the parent exception. Something like:\n\n```\nindex - type - message - stack\n_     - System.AggregateException - message - stack (root exception)\n  0   - System.InvalidOperationException - message - stack (aggregated)\n    1 - System.NullReferenceException - message - stack (inner)\n  0   - Xunit.Sdk.TestCaseException - message - stack (aggregated)\n```\n\nThis would allow rebuilding the exception info from a runner if it needs it, and moving `ExceptionUtility` to xunit.runner.utility would allow the current runners to easily format it back for easy consumption.\n\nWhat do you think? Happy to provide a PR if you're interested.\n","closed_by":{"login":"bradwilson","id":16944,"node_id":"MDQ6VXNlcjE2OTQ0","avatar_url":"https://avatars.githubusercontent.com/u/16944?v=4","gravatar_id":"","url":"https://api.github.com/users/bradwilson","html_url":"https://github.com/bradwilson","followers_url":"https://api.github.com/users/bradwilson/followers","following_url":"https://api.github.com/users/bradwilson/following{/other_user}","gists_url":"https://api.github.com/users/bradwilson/gists{/gist_id}","starred_url":"https://api.github.com/users/bradwilson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bradwilson/subscriptions","organizations_url":"https://api.github.com/users/bradwilson/orgs","repos_url":"https://api.github.com/users/bradwilson/repos","events_url":"https://api.github.com/users/bradwilson/events{/privacy}","received_events_url":"https://api.github.com/users/bradwilson/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/xunit/xunit/issues/5/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/xunit/xunit/issues/5/timeline","performed_via_github_app":null,"state_reason":"completed"}