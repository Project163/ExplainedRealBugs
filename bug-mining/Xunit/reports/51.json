{"url":"https://api.github.com/repos/xunit/xunit/issues/281","repository_url":"https://api.github.com/repos/xunit/xunit","labels_url":"https://api.github.com/repos/xunit/xunit/issues/281/labels{/name}","comments_url":"https://api.github.com/repos/xunit/xunit/issues/281/comments","events_url":"https://api.github.com/repos/xunit/xunit/issues/281/events","html_url":"https://github.com/xunit/xunit/issues/281","id":56067141,"node_id":"MDU6SXNzdWU1NjA2NzE0MQ==","number":281,"title":"Add msbuild targets file to xunit.runners NuGet package","user":{"login":"robv8r","id":251736,"node_id":"MDQ6VXNlcjI1MTczNg==","avatar_url":"https://avatars.githubusercontent.com/u/251736?v=4","gravatar_id":"","url":"https://api.github.com/users/robv8r","html_url":"https://github.com/robv8r","followers_url":"https://api.github.com/users/robv8r/followers","following_url":"https://api.github.com/users/robv8r/following{/other_user}","gists_url":"https://api.github.com/users/robv8r/gists{/gist_id}","starred_url":"https://api.github.com/users/robv8r/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/robv8r/subscriptions","organizations_url":"https://api.github.com/users/robv8r/orgs","repos_url":"https://api.github.com/users/robv8r/repos","events_url":"https://api.github.com/users/robv8r/events{/privacy}","received_events_url":"https://api.github.com/users/robv8r/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":75574830,"node_id":"MDU6TGFiZWw3NTU3NDgzMA==","url":"https://api.github.com/repos/xunit/xunit/labels/Feature","name":"Feature","color":"FEF2C0","default":false,"description":"A request for a new feature"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2015-01-30T18:25:57Z","updated_at":"2015-03-08T21:14:51Z","closed_at":"2015-02-28T18:49:53Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"## Problem\n\nAccording to the wiki page titled [How To Use MSBuild](https://xunit.codeplex.com/wikipage?title=HowToUseMSBuild), one can use markup similar to the following to get xUnit MsBuild support.  \n\n``` xml\n<Project\n    DefaultTargets=\"Test\"\n    xmlns=\"http://schemas.microsoft.com/developer/msbuild/2003\">\n\n  <UsingTask\n    AssemblyFile=\"xunit.runner.msbuild.dll\"\n    TaskName=\"Xunit.Runner.MSBuild.xunit\"/>\n\n  <Target Name=\"Test\">\n    <xunit Assembly=\"MyTests\\bin\\Debug\\MyTests.dll\" />\n  </Target>\n\n</Project>\n```\n\nThis approach works well.  However, it's not as clean when referencing the xUnit NuGet package in a .csproj file.  To do this, one would need markup similar to the following:\n\n``` xml\n<Project\n    DefaultTargets=\"Build\"\n    xmlns=\"http://schemas.microsoft.com/developer/msbuild/2003\">\n\n  <!-- .csproj file contents ommitted -->\n\n  <UsingTask\n    AssemblyFile=\"..\\packages\\xunit.1.9.2\\lib\\net20\\xunit.runner.msbuild.dll\"\n    TaskName=\"Xunit.Runner.MSBuild.xunit\"/>\n\n  <Target Name=\"AfterBuild\">\n    <xunit Assembly=\"MyTests\\bin\\Debug\\MyTests.dll\" />\n  </Target>\n\n</Project>\n```\n\nIn the example above, the path to the xunit.runner.msbuild.dll file found in the NuGet package is hard coded in the .csproj file.  While this works, it's not ideal.  The approach is tied to a specific version of the NuGet package.  When version 1.9.3 or 2.0.0 of xUnit comes out, the developer will need to edit the .csproj file to point to the new package. \n## Proposal\n\nNuGet provides a means to include .props and .targets files that are inserted into a .csproj file when the NuGet package is applied.  One option would be to include a .targets file that declared the `UsingTask` similar to how the new xUnit Visual Studio runner imports its test adapter.\n\nThe structure of the existing xUnit NuGet Package (1.9.2) looks like this:\n\n```\n+---xunit.1.9.2\n    \\---lib\n        \\---net20\n            |---xunit.dll\n            |---xunit.dll.tdnet\n            |---xunit.runner.msbuild.dll\n            |---xunit.runner.tdnet.dll\n            |---xunit.runner.utility.dll\n            \\---xunit.xml\n```\n\nThe proposed structure would look like this:\n\n```\n+---xunit.1.9.2\n    |---lib\n    |   \\---net20\n    |       |---xunit.dll\n    |       |---xunit.dll.tdnet\n    |       |---xunit.runner.msbuild.dll\n    |       |---xunit.runner.tdnet.dll\n    |       |---xunit.runner.utility.dll\n    |       \\---xunit.xml\n    \\---build\n        \\---xunit.targets\n```\n\nThe new .targets file could be similar to the following:\n### xunit.targets\n\n``` xml\n<Project\n    xmlns=\"http://schemas.microsoft.com/developer/msbuild/2003\">\n\n  <UsingTask\n    AssemblyFile=\"$(MSBuildThisFileDirectory)..\\lib\\net20\\xunit.runner.msbuild.dll\"\n    Condition=\"Exists('$(MSBuildThisFileDirectory)..\\lib\\net20\\xunit.runner.msbuild.dll')\"\n    TaskName=\"Xunit.Runner.MSBuild.xunit\"/>\n\n</Project>\n```\n\nThis would reduce the amount of changes to the .csproj file a developer would need to do to run tests on build. The first example could now be reduced to the following:\n\n``` xml\n<Project\n    DefaultTargets=\"Build\"\n    xmlns=\"http://schemas.microsoft.com/developer/msbuild/2003\">\n\n  <!-- .csproj file contents ommitted -->\n\n  <Target Name=\"AfterBuild\">\n    <xunit Assembly=\"$(TargetPath)\" />\n  </Target>\n\n</Project>\n```\n","closed_by":{"login":"bradwilson","id":16944,"node_id":"MDQ6VXNlcjE2OTQ0","avatar_url":"https://avatars.githubusercontent.com/u/16944?v=4","gravatar_id":"","url":"https://api.github.com/users/bradwilson","html_url":"https://github.com/bradwilson","followers_url":"https://api.github.com/users/bradwilson/followers","following_url":"https://api.github.com/users/bradwilson/following{/other_user}","gists_url":"https://api.github.com/users/bradwilson/gists{/gist_id}","starred_url":"https://api.github.com/users/bradwilson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bradwilson/subscriptions","organizations_url":"https://api.github.com/users/bradwilson/orgs","repos_url":"https://api.github.com/users/bradwilson/repos","events_url":"https://api.github.com/users/bradwilson/events{/privacy}","received_events_url":"https://api.github.com/users/bradwilson/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/xunit/xunit/issues/281/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/xunit/xunit/issues/281/timeline","performed_via_github_app":null,"state_reason":"completed"}