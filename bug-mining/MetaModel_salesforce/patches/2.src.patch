diff --git a/salesforce/src/main/java/org/apache/metamodel/salesforce/SalesforceDataSet.java b/salesforce/src/main/java/org/apache/metamodel/salesforce/SalesforceDataSet.java
index 2b53d1bd..85f2d9a7 100644
--- a/salesforce/src/main/java/org/apache/metamodel/salesforce/SalesforceDataSet.java
+++ b/salesforce/src/main/java/org/apache/metamodel/salesforce/SalesforceDataSet.java
@@ -108,7 +108,7 @@ final class SalesforceDataSet extends AbstractDataSet {
                 return BooleanComparator.toBoolean(value);
             }
             if (columnType.isNumber()) {
-                return NumberComparator.toNumber(columnType.isNumber());
+                return NumberComparator.toNumber(value);
             }
             if (columnType.isTimeBased()) {
                 final SimpleDateFormat dateFormat;
diff --git a/salesforce/src/test/java/org/apache/metamodel/salesforce/SalesforceDataContextTest.java b/salesforce/src/test/java/org/apache/metamodel/salesforce/SalesforceDataContextTest.java
index e7acc849..7cb6fb6b 100644
--- a/salesforce/src/test/java/org/apache/metamodel/salesforce/SalesforceDataContextTest.java
+++ b/salesforce/src/test/java/org/apache/metamodel/salesforce/SalesforceDataContextTest.java
@@ -22,10 +22,8 @@ import java.sql.Timestamp;
 import java.text.SimpleDateFormat;
 import java.util.ArrayList;
 import java.util.Arrays;
-import java.util.Calendar;
 import java.util.Date;
 import java.util.List;
-import java.util.TimeZone;
 
 import org.apache.metamodel.UpdateCallback;
 import org.apache.metamodel.UpdateScript;
@@ -51,7 +49,7 @@ public class SalesforceDataContextTest extends SalesforceTestCase {
             System.err.println(getInvalidConfigurationMessage());
             return;
         }
-        SalesforceDataContext dc = new SalesforceDataContext(getUsername(), getPassword(), getSecurityToken());
+        SalesforceDataContext dc = getSalesforceDataContext();
 
         Column[] timeColumns = dc.getDefaultSchema().getTableByName("Contact").getTimeBasedColumns();
         assertEquals(
@@ -73,6 +71,10 @@ public class SalesforceDataContextTest extends SalesforceTestCase {
         ds.close();
     }
 
+    private SalesforceDataContext getSalesforceDataContext() {
+        return new SalesforceDataContext(getEndpoint(), getUsername(), getPassword(), getSecurityToken());
+    }
+
     public void testInvalidLoginException() throws Exception {
         try {
             new SalesforceDataContext("foo", "bar", "baz");
@@ -113,7 +115,7 @@ public class SalesforceDataContextTest extends SalesforceTestCase {
             return;
         }
 
-        SalesforceDataContext dc = new SalesforceDataContext(getUsername(), getPassword(), getSecurityToken());
+        SalesforceDataContext dc = getSalesforceDataContext();
 
         Schema schema = dc.getDefaultSchema();
 
@@ -152,7 +154,7 @@ public class SalesforceDataContextTest extends SalesforceTestCase {
             return;
         }
 
-        SalesforceDataContext dc = new SalesforceDataContext(getUsername(), getPassword(), getSecurityToken());
+        SalesforceDataContext dc = getSalesforceDataContext();
 
         runConversionTest(dc, "Account");
         runConversionTest(dc, "Contact");
@@ -188,7 +190,7 @@ public class SalesforceDataContextTest extends SalesforceTestCase {
             return;
         }
 
-        SalesforceDataContext dc = new SalesforceDataContext(getUsername(), getPassword(), getSecurityToken());
+        SalesforceDataContext dc = getSalesforceDataContext();
 
         DataSet ds;
 
@@ -225,7 +227,7 @@ public class SalesforceDataContextTest extends SalesforceTestCase {
             return;
         }
 
-        SalesforceDataContext dc = new SalesforceDataContext(getUsername(), getPassword(), getSecurityToken());
+        SalesforceDataContext dc = getSalesforceDataContext();
 
         final String tableName = "Account";
         final String insertedName = "MetaModel TESTER contact";
@@ -303,7 +305,7 @@ public class SalesforceDataContextTest extends SalesforceTestCase {
             return;
         }
 
-        SalesforceDataContext dc = new SalesforceDataContext(getUsername(), getPassword(), getSecurityToken());
+        SalesforceDataContext dc = getSalesforceDataContext();
 
         final String tableName = "Contact";
         final String firstName = "MetaModelJohn";
diff --git a/salesforce/src/test/java/org/apache/metamodel/salesforce/SalesforceDataSetTest.java b/salesforce/src/test/java/org/apache/metamodel/salesforce/SalesforceDataSetTest.java
new file mode 100644
index 00000000..838e3865
--- /dev/null
+++ b/salesforce/src/test/java/org/apache/metamodel/salesforce/SalesforceDataSetTest.java
@@ -0,0 +1,60 @@
+/**
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ *
+ *   http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing,
+ * software distributed under the License is distributed on an
+ * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+ * KIND, either express or implied.  See the License for the
+ * specific language governing permissions and limitations
+ * under the License.
+ */
+package org.apache.metamodel.salesforce;
+
+import com.sforce.soap.partner.QueryResult;
+import com.sforce.ws.ConnectionException;
+import com.sforce.ws.bind.TypeMapper;
+import com.sforce.ws.parser.PullParserException;
+import com.sforce.ws.parser.XmlInputStream;
+import org.apache.metamodel.data.Row;
+import org.apache.metamodel.schema.Column;
+import org.apache.metamodel.schema.ColumnType;
+import org.apache.metamodel.schema.MutableColumn;
+import org.junit.Test;
+
+import java.io.IOException;
+import java.util.List;
+
+import static org.junit.Assert.assertEquals;
+
+public class SalesforceDataSetTest {
+
+    @Test
+    public void testQuery() throws Exception {
+        QueryResult qr = queryResult("/result/double-value.xml");
+        MutableColumn version = new MutableColumn("Version", ColumnType.DOUBLE);
+
+        SalesforceDataSet dataSet = new SalesforceDataSet(new Column[] { version }, qr, null);
+        List<Row> rows = dataSet.toRows();
+
+        assertEquals(5386.21, rows.get(0).getValue(version));
+        assertEquals(53.0, rows.get(1).getValue(version));
+        
+        dataSet.close();
+    }
+
+    private QueryResult queryResult(String input) throws PullParserException, IOException, ConnectionException {
+        QueryResult queryResult = new QueryResult();
+        XmlInputStream in = new XmlInputStream();
+        in.setInput(getClass().getResourceAsStream(input), "UTF-8");
+        queryResult.load(in, new TypeMapper());
+        return queryResult;
+    }
+}
\ No newline at end of file
diff --git a/salesforce/src/test/java/org/apache/metamodel/salesforce/SalesforceTestCase.java b/salesforce/src/test/java/org/apache/metamodel/salesforce/SalesforceTestCase.java
index 039fd615..6b1b8668 100644
--- a/salesforce/src/test/java/org/apache/metamodel/salesforce/SalesforceTestCase.java
+++ b/salesforce/src/test/java/org/apache/metamodel/salesforce/SalesforceTestCase.java
@@ -22,6 +22,7 @@ import java.io.File;
 import java.io.FileReader;
 import java.util.Properties;
 
+import com.sforce.soap.partner.Connector;
 import junit.framework.TestCase;
 
 /**
@@ -33,6 +34,7 @@ public abstract class SalesforceTestCase extends TestCase {
     private String _username;
     private String _password;
     private String _securityToken;
+    private String _endpoint;
     private boolean _configured;
 
     @Override
@@ -46,7 +48,8 @@ public abstract class SalesforceTestCase extends TestCase {
             _username = properties.getProperty("salesforce.username");
             _password = properties.getProperty("salesforce.password");
             _securityToken = properties.getProperty("salesforce.securityToken");
-            
+            _endpoint = properties.getProperty("salesforce.endpoint", Connector.END_POINT);
+
             _configured = (_username != null && !_username.isEmpty());
         } else {
             _configured = false;
@@ -78,4 +81,9 @@ public abstract class SalesforceTestCase extends TestCase {
     public String getSecurityToken() {
         return _securityToken;
     }
+
+    public String getEndpoint() {
+        return _endpoint;
+    }
+
 }
diff --git a/salesforce/src/test/resources/result/double-value.xml b/salesforce/src/test/resources/result/double-value.xml
new file mode 100644
index 00000000..526f0e2b
--- /dev/null
+++ b/salesforce/src/test/resources/result/double-value.xml
@@ -0,0 +1,18 @@
+<n1:queryResponse xmlns:n1="urn:partner.soap.sforce.com">
+    <n1:done>true</n1:done>
+    <n1:queryLocator n2:nil="true"
+                     xmlns:n2="http://www.w3.org/2001/XMLSchema-instance" />
+    <n1:records>
+        <n3:type n4:type="string" xmlns:n3="urn:sobject.partner.soap.sforce.com"
+                 xmlns:n4="http://www.w3.org/2001/XMLSchema-instance">Application</n3:type>
+        <n5:Version n6:type="string" xmlns:n5="urn:sobject.partner.soap.sforce.com"
+                         xmlns:n6="http://www.w3.org/2001/XMLSchema-instance">5386.21</n5:Version>
+    </n1:records>
+    <n1:records>
+        <n7:type n8:type="string" xmlns:n7="urn:sobject.partner.soap.sforce.com"
+                 xmlns:n8="http://www.w3.org/2001/XMLSchema-instance">Application</n7:type>
+        <n9:Version n10:type="string" xmlns:n9="urn:sobject.partner.soap.sforce.com"
+                         xmlns:n10="http://www.w3.org/2001/XMLSchema-instance">53.0</n9:Version>
+    </n1:records>
+    <n1:size>2</n1:size>
+</n1:queryResponse>
\ No newline at end of file
