{"url":"https://api.github.com/repos/python-poetry/poetry/issues/847","repository_url":"https://api.github.com/repos/python-poetry/poetry","labels_url":"https://api.github.com/repos/python-poetry/poetry/issues/847/labels{/name}","comments_url":"https://api.github.com/repos/python-poetry/poetry/issues/847/comments","events_url":"https://api.github.com/repos/python-poetry/poetry/issues/847/events","html_url":"https://github.com/python-poetry/poetry/issues/847","id":404376471,"node_id":"MDU6SXNzdWU0MDQzNzY0NzE=","number":847,"title":"Python restricted dependencies for multiple Python versions fail: 'Array' object has no attribute 'strip'","user":{"login":"okin","id":445491,"node_id":"MDQ6VXNlcjQ0NTQ5MQ==","avatar_url":"https://avatars.githubusercontent.com/u/445491?v=4","gravatar_id":"","url":"https://api.github.com/users/okin","html_url":"https://github.com/okin","followers_url":"https://api.github.com/users/okin/followers","following_url":"https://api.github.com/users/okin/following{/other_user}","gists_url":"https://api.github.com/users/okin/gists{/gist_id}","starred_url":"https://api.github.com/users/okin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/okin/subscriptions","organizations_url":"https://api.github.com/users/okin/orgs","repos_url":"https://api.github.com/users/okin/repos","events_url":"https://api.github.com/users/okin/events{/privacy}","received_events_url":"https://api.github.com/users/okin/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":851628021,"node_id":"MDU6TGFiZWw4NTE2MjgwMjE=","url":"https://api.github.com/repos/python-poetry/poetry/labels/kind/bug","name":"kind/bug","color":"f74a2a","default":false,"description":"Something isn't working as expected"},{"id":851636946,"node_id":"MDU6TGFiZWw4NTE2MzY5NDY=","url":"https://api.github.com/repos/python-poetry/poetry/labels/area/installer","name":"area/installer","color":"EEA9B7","default":false,"description":"Related to the dependency installer"},{"id":1055741547,"node_id":"MDU6TGFiZWwxMDU1NzQxNTQ3","url":"https://api.github.com/repos/python-poetry/poetry/labels/area/docs","name":"area/docs","color":"86d8ad","default":false,"description":"Documentation issues/improvements"}],"state":"closed","locked":true,"assignee":null,"assignees":[],"milestone":null,"comments":7,"created_at":"2019-01-29T16:29:40Z","updated_at":"2024-03-03T13:06:24Z","closed_at":"2019-09-29T10:46:25Z","author_association":"NONE","type":null,"active_lock_reason":"resolved","sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"<!--\r\n  Hi there! Thank you for discovering and submitting an issue.\r\n\r\n  Before you submit this; let's make sure of a few things.\r\n  Please make sure the following boxes are ticked if they are correct.\r\n  If not, please try and fulfill these first.\r\n-->\r\n\r\n<!-- Checked checkbox should look like this: [x] -->\r\n- [x] I am on the [latest](https://github.com/sdispater/poetry/releases/latest) Poetry version.\r\n- [x] I have searched the [issues](https://github.com/sdispater/poetry/issues) of this repo and believe that this is not a duplicate.\r\n- [x] If an exception occurs when executing a command, I executed it again in debug mode (`-vvv` option).\r\n\r\n- **OS version and name**: Ubuntu 18.10\r\n- **Poetry version**: Poetry 0.12.11 (bug does also affect 0.12.10)\r\n- **Link of a [Gist](https://gist.github.com/) with the contents of your pyproject.toml file**: https://gist.github.com/okin/9fca594f2a4ba9917f1c292752d21e4c\r\n\r\n## Issue\r\n<!-- Now feel free to write your issue, but please be descriptive! Thanks again ðŸ™Œ â¤ï¸ -->\r\n\r\nI want to configure an dependency that is only applied when specific Python versions are used.\r\nThe documentation shows an [example](https://poetry.eustace.io/docs/versions/#python-restricted-dependencies) that matches my case: `pathlib2 = { version = \"^2.2\", python = [\"~2.7\", \"^3.2\"] }`\r\n\r\nI added this to my project config.\r\nWhenever I now try to run `poetry install`, `poetry update` or `poetry check` I am greeted with the following message:\r\n```\r\n[AttributeError]            \r\n'Array' object has no attribute 'strip'  \r\n```\r\n\r\nNo further action is done as poetry appears to break in this case.\r\n\r\n### Debug output from poetry check\r\n\r\n```\r\n[AttributeError]            \r\n'Array' object has no attribute 'strip'  \r\n                                           \r\nException trace:\r\n /home/wenselowski/.poetry/lib/poetry/_vendor/py3.6/cleo/application.py in run() at line 94\r\n   status_code = self.do_run(input_, output_)\r\n /home/wenselowski/.poetry/lib/poetry/console/application.py in do_run() at line 88\r\n   return super(Application, self).do_run(i, o)\r\n /home/wenselowski/.poetry/lib/poetry/_vendor/py3.6/cleo/application.py in do_run() at line 197\r\n   status_code = command.run(input_, output_)\r\n /home/wenselowski/.poetry/lib/poetry/console/commands/command.py in run() at line 77\r\n   return super(BaseCommand, self).run(i, o)\r\n /home/wenselowski/.poetry/lib/poetry/_vendor/py3.6/cleo/commands/base_command.py in run() at line 146\r\n   status_code = self.execute(input_, output_)\r\n /home/wenselowski/.poetry/lib/poetry/_vendor/py3.6/cleo/commands/command.py in execute() at line 107\r\n   return self.handle()\r\n /home/wenselowski/.poetry/lib/poetry/console/commands/check.py in handle() at line 13\r\n   check_result = self.poetry.check(self.poetry.local_config, strict=True)\r\n /home/wenselowski/.poetry/lib/poetry/console/commands/command.py in poetry() at line 62\r\n   return self.get_application().poetry\r\n /home/wenselowski/.poetry/lib/poetry/console/application.py in poetry() at line 60\r\n   self._poetry = Poetry.create(os.getcwd())\r\n /home/wenselowski/.poetry/lib/poetry/poetry.py in create() at line 148\r\n   package.add_dependency(name, constraint)\r\n /home/wenselowski/.poetry/lib/poetry/packages/package.py in add_dependency() at line 304\r\n   dependency.python_versions = python_versions\r\n /home/wenselowski/.poetry/lib/poetry/packages/dependency.py in python_versions() at line 89\r\n   self._python_constraint = parse_constraint(value)\r\n /home/wenselowski/.poetry/lib/poetry/semver/__init__.py in parse_constraint() at line 19\r\n   or_constraints = re.split(r\"\\s*\\|\\|?\\s*\", constraints.strip())\r\n\r\ncheck\r\n```\r\n\r\n\r\n### Workaround\r\n\r\nNo error is shown when configuring it as multiple requirements but no further testing was done if this actually would resolve correctly.\r\n\r\n```\r\npathlib2 = [\r\n\t{ version = \"^2.2\", python = \"~2.7\" },\r\n\t{ version = \"^2.2\", python = \"^3.2\" }\r\n]\r\n```","closed_by":{"login":"sdispater","id":555648,"node_id":"MDQ6VXNlcjU1NTY0OA==","avatar_url":"https://avatars.githubusercontent.com/u/555648?v=4","gravatar_id":"","url":"https://api.github.com/users/sdispater","html_url":"https://github.com/sdispater","followers_url":"https://api.github.com/users/sdispater/followers","following_url":"https://api.github.com/users/sdispater/following{/other_user}","gists_url":"https://api.github.com/users/sdispater/gists{/gist_id}","starred_url":"https://api.github.com/users/sdispater/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sdispater/subscriptions","organizations_url":"https://api.github.com/users/sdispater/orgs","repos_url":"https://api.github.com/users/sdispater/repos","events_url":"https://api.github.com/users/sdispater/events{/privacy}","received_events_url":"https://api.github.com/users/sdispater/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/python-poetry/poetry/issues/847/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/python-poetry/poetry/issues/847/timeline","performed_via_github_app":null,"state_reason":"completed"}