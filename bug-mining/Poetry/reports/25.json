{"url":"https://api.github.com/repos/python-poetry/poetry/issues/3026","repository_url":"https://api.github.com/repos/python-poetry/poetry","labels_url":"https://api.github.com/repos/python-poetry/poetry/issues/3026/labels{/name}","comments_url":"https://api.github.com/repos/python-poetry/poetry/issues/3026/comments","events_url":"https://api.github.com/repos/python-poetry/poetry/issues/3026/events","html_url":"https://github.com/python-poetry/poetry/issues/3026","id":712987297,"node_id":"MDU6SXNzdWU3MTI5ODcyOTc=","number":3026,"title":"RuntimeError","user":{"login":"remram44","id":426784,"node_id":"MDQ6VXNlcjQyNjc4NA==","avatar_url":"https://avatars.githubusercontent.com/u/426784?v=4","gravatar_id":"","url":"https://api.github.com/users/remram44","html_url":"https://github.com/remram44","followers_url":"https://api.github.com/users/remram44/followers","following_url":"https://api.github.com/users/remram44/following{/other_user}","gists_url":"https://api.github.com/users/remram44/gists{/gist_id}","starred_url":"https://api.github.com/users/remram44/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/remram44/subscriptions","organizations_url":"https://api.github.com/users/remram44/orgs","repos_url":"https://api.github.com/users/remram44/repos","events_url":"https://api.github.com/users/remram44/events{/privacy}","received_events_url":"https://api.github.com/users/remram44/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":851628021,"node_id":"MDU6TGFiZWw4NTE2MjgwMjE=","url":"https://api.github.com/repos/python-poetry/poetry/labels/kind/bug","name":"kind/bug","color":"f74a2a","default":false,"description":"Something isn't working as expected"}],"state":"closed","locked":true,"assignee":null,"assignees":[],"milestone":null,"comments":10,"created_at":"2020-10-01T16:13:41Z","updated_at":"2024-03-02T23:07:07Z","closed_at":"2020-10-01T22:25:09Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":"resolved","sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"- [x] I am on the [latest](https://github.com/python-poetry/poetry/releases/latest) Poetry version.\r\n- [x] I have searched the [issues](https://github.com/python-poetry/poetry/issues) of this repo and believe that this is not a duplicate.\r\n- [x] If an exception occurs when executing a command, I executed it again in debug mode (`-vvv` option).\r\n\r\n- **OS version and name**: Ubuntu Linux 20.04.1\r\n- **Poetry version**: 1.1.0\r\n- **Link of a [Gist](https://gist.github.com/) with the contents of your pyproject.toml file**: https://gitlab.com/ViDA-NYU/datamart/datamart/-/blob/1f15e3db009837cb51ee22274ce9bf3b96e205d7/pyproject.toml\r\n\r\n## Issue\r\n\r\nSince the update, running `poetry install` crashes with a `RuntimeError`.\r\n\r\n<details>\r\n<summary><code>poetry install -vvv</code></summary>\r\n\r\n```\r\nVirtualenv datamart-TD2l9kg0-py3.8 already exists.\r\nUsing virtualenv: /home/remram/.cache/pypoetry/virtualenvs/datamart-TD2l9kg0-py3.8\r\nInstalling dependencies from lock file\r\n\r\nFinding the necessary packages for the current system\r\n\r\n  Stack trace:\r\n\r\n  17  ~/.poetry/lib/poetry/_vendor/py3.8/clikit/console_application.py:131 in run\r\n       129│             parsed_args = resolved_command.args\r\n       130│ \r\n     → 131│             status_code = command.handle(parsed_args, io)\r\n       132│         except KeyboardInterrupt:\r\n       133│             status_code = 1\r\n\r\n  16  ~/.poetry/lib/poetry/_vendor/py3.8/clikit/api/command/command.py:120 in handle\r\n       118│     def handle(self, args, io):  # type: (Args, IO) -> int\r\n       119│         try:\r\n     → 120│             status_code = self._do_handle(args, io)\r\n       121│         except KeyboardInterrupt:\r\n       122│             if io.is_debug():\r\n\r\n  15  ~/.poetry/lib/poetry/_vendor/py3.8/clikit/api/command/command.py:171 in _do_handle\r\n       169│         handler_method = self._config.handler_method\r\n       170│ \r\n     → 171│         return getattr(handler, handler_method)(args, io, self)\r\n       172│ \r\n       173│     def __repr__(self):  # type: () -> str\r\n\r\n  14  ~/.poetry/lib/poetry/_vendor/py3.8/cleo/commands/command.py:92 in wrap_handle\r\n        90│         self._command = command\r\n        91│ \r\n     →  92│         return self.handle()\r\n        93│ \r\n        94│     def handle(self):  # type: () -> Optional[int]\r\n\r\n  13  ~/.poetry/lib/poetry/console/commands/install.py:71 in handle\r\n        69│         self._installer.verbose(self._io.is_verbose())\r\n        70│ \r\n     →  71│         return_code = self._installer.run()\r\n        72│ \r\n        73│         if return_code != 0:\r\n\r\n  12  ~/.poetry/lib/poetry/installation/installer.py:99 in run\r\n        97│         local_repo = Repository()\r\n        98│ \r\n     →  99│         return self._do_install(local_repo)\r\n       100│ \r\n       101│     def dry_run(self, dry_run=True):  # type: (bool) -> Installer\r\n\r\n  11  ~/.poetry/lib/poetry/installation/installer.py:278 in _do_install\r\n       276│ \r\n       277│         with solver.use_environment(self._env):\r\n     → 278│             ops = solver.solve(use_latest=whitelist)\r\n       279│ \r\n       280│         # We need to filter operations so that packages\r\n\r\n  10  ~/.poetry/lib/poetry/puzzle/solver.py:65 in solve\r\n        63│         with self._provider.progress():\r\n        64│             start = time.time()\r\n     →  65│             packages, depths = self._solve(use_latest=use_latest)\r\n        66│             end = time.time()\r\n        67│ \r\n\r\n   9  ~/.poetry/lib/poetry/puzzle/solver.py:233 in _solve\r\n       231│ \r\n       232│         try:\r\n     → 233│             result = resolve_version(\r\n       234│                 self._package, self._provider, locked=locked, use_latest=use_latest\r\n       235│             )\r\n\r\n   8  ~/.poetry/lib/poetry/mixology/__init__.py:7 in resolve_version\r\n       5│     solver = VersionSolver(root, provider, locked=locked, use_latest=use_latest)\r\n       6│ \r\n     → 7│     return solver.solve()\r\n       8│ \r\n\r\n   7  ~/.poetry/lib/poetry/mixology/version_solver.py:84 in solve\r\n        82│             while next is not None:\r\n        83│                 self._propagate(next)\r\n     →  84│                 next = self._choose_package_version()\r\n        85│ \r\n        86│             return self._result()\r\n\r\n   6  ~/.poetry/lib/poetry/mixology/version_solver.py:397 in _choose_package_version\r\n       395│             version = locked\r\n       396│ \r\n     → 397│         version = self._provider.complete_package(version)\r\n       398│ \r\n       399│         conflict = False\r\n\r\n   5  ~/.poetry/lib/poetry/puzzle/provider.py:447 in complete_package\r\n       445│             for r in requires:\r\n       446│                 if r.is_directory():\r\n     → 447│                     self.search_for_directory(r)\r\n       448│                 elif r.is_file():\r\n       449│                     self.search_for_file(r)\r\n\r\n   4  ~/.poetry/lib/poetry/puzzle/provider.py:264 in search_for_directory\r\n       262│             package = _package.clone()\r\n       263│         else:\r\n     → 264│             package = self.get_package_from_directory(\r\n       265│                 dependency.full_path, name=dependency.name\r\n       266│             )\r\n\r\n   3  ~/.poetry/lib/poetry/puzzle/provider.py:284 in get_package_from_directory\r\n       282│         cls, directory, name=None\r\n       283│     ):  # type: (Path, Optional[str]) -> Package\r\n     → 284│         package = PackageInfo.from_directory(path=directory).to_package(\r\n       285│             root_dir=directory\r\n       286│         )\r\n\r\n   2  ~/.poetry/lib/poetry/inspection/info.py:527 in from_directory\r\n       525│                         info = cls.from_setup_files(path)\r\n       526│                     else:\r\n     → 527│                         info = cls._pep517_metadata(path)\r\n       528│                 except PackageInfoError:\r\n       529│                     if not info:\r\n\r\n   1  ~/.poetry/lib/poetry/inspection/info.py:492 in _pep517_metadata\r\n       490│                     )\r\n       491│                 finally:\r\n     → 492│                     os.chdir(cwd.as_posix())\r\n       493│ \r\n       494│         if info:\r\n\r\n  RuntimeError\r\n\r\n  generator didn't stop after throw()\r\n\r\n  at /usr/lib/python3.8/contextlib.py:162 in __exit__\r\n      158│                 # by 'except BaseException'.\r\n      159│                 if sys.exc_info()[1] is value:\r\n      160│                     return False\r\n      161│                 raise\r\n    → 162│             raise RuntimeError(\"generator didn't stop after throw()\")\r\n      163│ \r\n      164│ \r\n      165│ class _AsyncGeneratorContextManager(_GeneratorContextManagerBase,\r\n      166│                                     AbstractAsyncContextManager):\r\n```\r\n\r\n</details>","closed_by":{"login":"abn","id":165325,"node_id":"MDQ6VXNlcjE2NTMyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/165325?v=4","gravatar_id":"","url":"https://api.github.com/users/abn","html_url":"https://github.com/abn","followers_url":"https://api.github.com/users/abn/followers","following_url":"https://api.github.com/users/abn/following{/other_user}","gists_url":"https://api.github.com/users/abn/gists{/gist_id}","starred_url":"https://api.github.com/users/abn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/abn/subscriptions","organizations_url":"https://api.github.com/users/abn/orgs","repos_url":"https://api.github.com/users/abn/repos","events_url":"https://api.github.com/users/abn/events{/privacy}","received_events_url":"https://api.github.com/users/abn/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/python-poetry/poetry/issues/3026/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/python-poetry/poetry/issues/3026/timeline","performed_via_github_app":null,"state_reason":"completed"}