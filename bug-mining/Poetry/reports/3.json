{"url":"https://api.github.com/repos/python-poetry/poetry/issues/350","repository_url":"https://api.github.com/repos/python-poetry/poetry","labels_url":"https://api.github.com/repos/python-poetry/poetry/issues/350/labels{/name}","comments_url":"https://api.github.com/repos/python-poetry/poetry/issues/350/comments","events_url":"https://api.github.com/repos/python-poetry/poetry/issues/350/events","html_url":"https://github.com/python-poetry/poetry/issues/350","id":345397371,"node_id":"MDU6SXNzdWUzNDUzOTczNzE=","number":350,"title":"Poetry selecting incorrect version of sub-dependency","user":{"login":"ghost","id":10137,"node_id":"MDQ6VXNlcjEwMTM3","avatar_url":"https://avatars.githubusercontent.com/u/10137?v=4","gravatar_id":"","url":"https://api.github.com/users/ghost","html_url":"https://github.com/ghost","followers_url":"https://api.github.com/users/ghost/followers","following_url":"https://api.github.com/users/ghost/following{/other_user}","gists_url":"https://api.github.com/users/ghost/gists{/gist_id}","starred_url":"https://api.github.com/users/ghost/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ghost/subscriptions","organizations_url":"https://api.github.com/users/ghost/orgs","repos_url":"https://api.github.com/users/ghost/repos","events_url":"https://api.github.com/users/ghost/events{/privacy}","received_events_url":"https://api.github.com/users/ghost/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":851628021,"node_id":"MDU6TGFiZWw4NTE2MjgwMjE=","url":"https://api.github.com/repos/python-poetry/poetry/labels/kind/bug","name":"kind/bug","color":"f74a2a","default":false,"description":"Something isn't working as expected"},{"id":851634278,"node_id":"MDU6TGFiZWw4NTE2MzQyNzg=","url":"https://api.github.com/repos/python-poetry/poetry/labels/area/solver","name":"area/solver","color":"356991","default":false,"description":"Related to the dependency resolver"}],"state":"closed","locked":true,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2018-07-27T23:56:37Z","updated_at":"2024-03-03T18:44:38Z","closed_at":"2018-07-28T23:59:12Z","author_association":"NONE","type":null,"active_lock_reason":"resolved","sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"<!--\r\n  Hi there! Thank you for discovering and submitting an issue.\r\n\r\n  Before you submit this; let's make sure of a few things.\r\n  Please make sure the following boxes are ticked if they are correct.\r\n  If not, please try and fulfill these first.\r\n-->\r\n\r\n<!-- Checked checkbox should look like this: [x] -->\r\n- [x] I am on the [latest](https://github.com/sdispater/poetry/releases/latest) Poetry version.\r\n- [x] I have searched the [issues](https://github.com/sdispater/poetry/issues) of this repo and believe that this is not a duplicate.\r\n- [x] If an exception occurs when executing a command, I executed it again in debug mode (`-vvv` option).\r\n\r\n<!--\r\n  Once those are done, if you're able to fill in the following list with your information,\r\n  it'd be very helpful to whoever handles the issue.\r\n-->\r\n\r\n- **OS version and name**: macOS 10.13.4 High Sierra\r\n- **Poetry version**: 0.11.3\r\n\r\n## Issue\r\n<!-- Now feel free to write your issue, but please be descriptive! Thanks again ðŸ™Œ â¤ï¸ -->\r\nPoetry currently installs celery in a non-functional state by installing the wrong version of one of its dependencies, billiard. billiard's version number isn't parseable by semver so I think that may be the problem? Steps to reproduce:\r\n\r\n```toml\r\n[tool.poetry]\r\nname = \"deps\"\r\nversion = \"0.1.0\"\r\ndescription = \"\"\r\nauthors = [\"Your Name <you@example.com>\"]\r\n\r\n[tool.poetry.dependencies]\r\npython = \"*\"\r\ncelery = \"^4.2\"\r\n\r\n[tool.poetry.dev-dependencies]\r\n```\r\n\r\n```shell\r\n$ poetry lock -vvv\r\nVirtualenv deps-py3.6 already exists.\r\nUsing virtualenv: /Users/<user>/Library/Caches/pypoetry/virtualenvs/deps-py3.6\r\nUpdating dependencies\r\nResolving dependencies...\r\n   1: fact: deps is 0.1.0\r\n   1: derived: deps\r\n   1: fact: deps depends on celery (^4.2)\r\n   1: selecting deps (0.1.0)\r\n   1: derived: celery (^4.2)\r\nPyPI: 2 packages found for celery >=4.2,<5.0\r\n   1: fact: celery (4.2.1) depends on kombu (>=4.2.0,<5.0)\r\n   1: fact: celery (4.2.1) depends on billiard (>=3.5.0.2,<3.6.0)\r\n   1: fact: celery (4.2.1) depends on pytz (>0.0-dev)\r\n   1: selecting celery (4.2.1)\r\n   1: derived: pytz (>0.0-dev)\r\n   1: derived: billiard (>=3.5.0.2,<3.6.0)\r\n   1: derived: kombu (>=4.2.0,<5.0)\r\nPyPI: 91 packages found for pytz >0.0-dev\r\n   1: selecting pytz (2018.5)\r\nPyPI: 4 packages found for billiard >=3.5.0.2,<3.6.0\r\n   1: selecting billiard (3.5.0.0rc2)\r\nPyPI: No release information found for kombu-3.0.17-20140602, skipping\r\nPyPI: 2 packages found for kombu >=4.2.0,<5.0\r\n   1: fact: kombu (4.2.1) depends on amqp (>=2.1.4,<3.0)\r\n   1: selecting kombu (4.2.1)\r\n   1: derived: amqp (>=2.1.4,<3.0)\r\nPyPI: No release information found for amqp-0.0.1, skipping\r\nPyPI: 7 packages found for amqp >=2.1.4,<3.0\r\n   1: fact: amqp (2.3.2) depends on vine (>=1.1.3)\r\n   1: selecting amqp (2.3.2)\r\n   1: derived: vine (>=1.1.3)\r\nPyPI: No release information found for vine-1.0.0rc1, skipping\r\nPyPI: 2 packages found for vine >=1.1.3\r\n   1: selecting vine (1.1.4)\r\n   1: Version solving took 0.369 seconds.\r\n   1: Tried 1 solutions.\r\n\r\n\r\nWriting lock file\r\n```\r\n\r\nRelevant section of pyproject.lock:\r\n\r\n```toml\r\n[[package]]\r\ncategory = \"main\"\r\ndescription = \"Python multiprocessing fork with improvements and bugfixes\"\r\nname = \"billiard\"\r\noptional = false\r\nplatform = \"UNKNOWN\"\r\npython-versions = \"*\"\r\nversion = \"3.5.0.0rc2\"\r\n\r\n[[package]]\r\ncategory = \"main\"\r\ndescription = \"Distributed Task Queue.\"\r\nname = \"celery\"\r\noptional = false\r\nplatform = \"any\"\r\npython-versions = \">=2.7, !=3.0.*, !=3.1.*, !=3.2.*, !=3.3.*\"\r\nversion = \"4.2.1\"\r\n\r\n[package.dependencies]\r\nbilliard = \">=3.5.0.2,<3.6.0\"\r\nkombu = \">=4.2.0,<5.0\"\r\npytz = \">0.0-dev\"\r\n```\r\n\r\nFor some reason it's installing 3.5.0.0rc2 which is outside of the range `>=3.5.0.2,<3.6.0`. Installing billiard directly will also install 3.5.0.0rc2 instead of the latest 3.5.0.4.","closed_by":{"login":"sdispater","id":555648,"node_id":"MDQ6VXNlcjU1NTY0OA==","avatar_url":"https://avatars.githubusercontent.com/u/555648?v=4","gravatar_id":"","url":"https://api.github.com/users/sdispater","html_url":"https://github.com/sdispater","followers_url":"https://api.github.com/users/sdispater/followers","following_url":"https://api.github.com/users/sdispater/following{/other_user}","gists_url":"https://api.github.com/users/sdispater/gists{/gist_id}","starred_url":"https://api.github.com/users/sdispater/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sdispater/subscriptions","organizations_url":"https://api.github.com/users/sdispater/orgs","repos_url":"https://api.github.com/users/sdispater/repos","events_url":"https://api.github.com/users/sdispater/events{/privacy}","received_events_url":"https://api.github.com/users/sdispater/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/python-poetry/poetry/issues/350/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/python-poetry/poetry/issues/350/timeline","performed_via_github_app":null,"state_reason":"completed"}