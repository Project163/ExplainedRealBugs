{"url":"https://api.github.com/repos/python-poetry/poetry/issues/1434","repository_url":"https://api.github.com/repos/python-poetry/poetry","labels_url":"https://api.github.com/repos/python-poetry/poetry/issues/1434/labels{/name}","comments_url":"https://api.github.com/repos/python-poetry/poetry/issues/1434/comments","events_url":"https://api.github.com/repos/python-poetry/poetry/issues/1434/events","html_url":"https://github.com/python-poetry/poetry/issues/1434","id":501827491,"node_id":"MDU6SXNzdWU1MDE4Mjc0OTE=","number":1434,"title":"poetry export adds extra url multiple times","user":{"login":"reversefold","id":100180,"node_id":"MDQ6VXNlcjEwMDE4MA==","avatar_url":"https://avatars.githubusercontent.com/u/100180?v=4","gravatar_id":"","url":"https://api.github.com/users/reversefold","html_url":"https://github.com/reversefold","followers_url":"https://api.github.com/users/reversefold/followers","following_url":"https://api.github.com/users/reversefold/following{/other_user}","gists_url":"https://api.github.com/users/reversefold/gists{/gist_id}","starred_url":"https://api.github.com/users/reversefold/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/reversefold/subscriptions","organizations_url":"https://api.github.com/users/reversefold/orgs","repos_url":"https://api.github.com/users/reversefold/repos","events_url":"https://api.github.com/users/reversefold/events{/privacy}","received_events_url":"https://api.github.com/users/reversefold/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":851628021,"node_id":"MDU6TGFiZWw4NTE2MjgwMjE=","url":"https://api.github.com/repos/python-poetry/poetry/labels/kind/bug","name":"kind/bug","color":"f74a2a","default":false,"description":"Something isn't working as expected"}],"state":"closed","locked":true,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2019-10-03T03:14:34Z","updated_at":"2024-03-03T10:05:09Z","closed_at":"2019-11-21T20:35:52Z","author_association":"NONE","type":null,"active_lock_reason":"resolved","sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"<!--\r\n  Hi there! Thank you for discovering and submitting an issue.\r\n\r\n  Before you submit this; let's make sure of a few things.\r\n  Please make sure the following boxes are ticked if they are correct.\r\n  If not, please try and fulfill these first.\r\n-->\r\n\r\n<!-- Checked checkbox should look like this: [x] -->\r\n- [x] I am on the [latest](https://github.com/sdispater/poetry/releases/latest) Poetry version.\r\n- [x] I have searched the [issues](https://github.com/sdispater/poetry/issues) of this repo and believe that this is not a duplicate.\r\n- [x] If an exception occurs when executing a command, I executed it again in debug mode (`-vvv` option).\r\n\r\n<!--\r\n  Once those are done, if you're able to fill in the following list with your information,\r\n  it'd be very helpful to whoever handles the issue.\r\n-->\r\n\r\n- **OS version and name**: macOS Mojave 10.14.6\r\n- **Poetry version**: 1.0.0b1\r\n- **Link of a [Gist](https://gist.github.com/) with the contents of your pyproject.toml file**: I can't give this out as it's not open source, but I have a source in `[[tool.poetry.source]]` which is an internal pypi repo.\r\n\r\n## Issue\r\nIf I run `poetry export -f requirements.txt` the result include the same `--extra-index-url` entry with the same URL at the top of the output once for each one of the packages in my poetry.lock. I suspect this is because poetry.lock (rightly) includes the same `[package.source]` entry for each dependency as they were downloaded from the source in `pyproject.toml` `[[tool.poetry.source]]`.\r\n\r\nAn interesting extra bit of information is that if I add `default = true` to the `[[tool.poetry.source]]` I only get one `--index-url` entry.\r\n\r\nI'm also seeing some odd inconsistencies with the poetry.lock. When I deleted it and recreated it with the source set to default I got a poetry.lock with no (or at least fewer) sources. Running poetry update seemed to put them back. I'm now not able to reproduce this issue, though, so I'm not sure what exactly caused it.","closed_by":{"login":"sdispater","id":555648,"node_id":"MDQ6VXNlcjU1NTY0OA==","avatar_url":"https://avatars.githubusercontent.com/u/555648?v=4","gravatar_id":"","url":"https://api.github.com/users/sdispater","html_url":"https://github.com/sdispater","followers_url":"https://api.github.com/users/sdispater/followers","following_url":"https://api.github.com/users/sdispater/following{/other_user}","gists_url":"https://api.github.com/users/sdispater/gists{/gist_id}","starred_url":"https://api.github.com/users/sdispater/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sdispater/subscriptions","organizations_url":"https://api.github.com/users/sdispater/orgs","repos_url":"https://api.github.com/users/sdispater/repos","events_url":"https://api.github.com/users/sdispater/events{/privacy}","received_events_url":"https://api.github.com/users/sdispater/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/python-poetry/poetry/issues/1434/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/python-poetry/poetry/issues/1434/timeline","performed_via_github_app":null,"state_reason":"completed"}