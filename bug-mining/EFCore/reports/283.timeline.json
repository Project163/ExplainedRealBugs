[{"id":8635906304,"node_id":"LE_lADOAPaMMs5fpD2CzwAAAAICvXkA","url":"https://api.github.com/repos/dotnet/efcore/issues/events/8635906304","actor":{"login":"kcindric","id":44549361,"node_id":"MDQ6VXNlcjQ0NTQ5MzYx","avatar_url":"https://avatars.githubusercontent.com/u/44549361?v=4","gravatar_id":"","url":"https://api.github.com/users/kcindric","html_url":"https://github.com/kcindric","followers_url":"https://api.github.com/users/kcindric/followers","following_url":"https://api.github.com/users/kcindric/following{/other_user}","gists_url":"https://api.github.com/users/kcindric/gists{/gist_id}","starred_url":"https://api.github.com/users/kcindric/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kcindric/subscriptions","organizations_url":"https://api.github.com/users/kcindric/orgs","repos_url":"https://api.github.com/users/kcindric/repos","events_url":"https://api.github.com/users/kcindric/events{/privacy}","received_events_url":"https://api.github.com/users/kcindric/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2023-03-01T09:31:59Z","label":{"name":"customer-reported","color":"a4a5f9"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/dotnet/efcore/issues/comments/1450543879","html_url":"https://github.com/dotnet/efcore/issues/30373#issuecomment-1450543879","issue_url":"https://api.github.com/repos/dotnet/efcore/issues/30373","id":1450543879,"node_id":"IC_kwDOAPaMMs5WdYsH","user":{"login":"kcindric","id":44549361,"node_id":"MDQ6VXNlcjQ0NTQ5MzYx","avatar_url":"https://avatars.githubusercontent.com/u/44549361?v=4","gravatar_id":"","url":"https://api.github.com/users/kcindric","html_url":"https://github.com/kcindric","followers_url":"https://api.github.com/users/kcindric/followers","following_url":"https://api.github.com/users/kcindric/following{/other_user}","gists_url":"https://api.github.com/users/kcindric/gists{/gist_id}","starred_url":"https://api.github.com/users/kcindric/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kcindric/subscriptions","organizations_url":"https://api.github.com/users/kcindric/orgs","repos_url":"https://api.github.com/users/kcindric/repos","events_url":"https://api.github.com/users/kcindric/events{/privacy}","received_events_url":"https://api.github.com/users/kcindric/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-01T17:26:06Z","updated_at":"2023-03-01T17:26:06Z","body":"it seems there is another issue ([#30295](https://github.com/dotnet/efcore/issues/30295)) opened with a similar problem. I'm happy to provide a runable project throwing the same error if it makes it easier to debug.","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/dotnet/efcore/issues/comments/1450543879/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"kcindric","id":44549361,"node_id":"MDQ6VXNlcjQ0NTQ5MzYx","avatar_url":"https://avatars.githubusercontent.com/u/44549361?v=4","gravatar_id":"","url":"https://api.github.com/users/kcindric","html_url":"https://github.com/kcindric","followers_url":"https://api.github.com/users/kcindric/followers","following_url":"https://api.github.com/users/kcindric/following{/other_user}","gists_url":"https://api.github.com/users/kcindric/gists{/gist_id}","starred_url":"https://api.github.com/users/kcindric/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kcindric/subscriptions","organizations_url":"https://api.github.com/users/kcindric/orgs","repos_url":"https://api.github.com/users/kcindric/repos","events_url":"https://api.github.com/users/kcindric/events{/privacy}","received_events_url":"https://api.github.com/users/kcindric/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/dotnet/efcore/issues/comments/1450813272","html_url":"https://github.com/dotnet/efcore/issues/30373#issuecomment-1450813272","issue_url":"https://api.github.com/repos/dotnet/efcore/issues/30373","id":1450813272,"node_id":"IC_kwDOAPaMMs5WeadY","user":{"login":"ajcvickers","id":1430078,"node_id":"MDQ6VXNlcjE0MzAwNzg=","avatar_url":"https://avatars.githubusercontent.com/u/1430078?v=4","gravatar_id":"","url":"https://api.github.com/users/ajcvickers","html_url":"https://github.com/ajcvickers","followers_url":"https://api.github.com/users/ajcvickers/followers","following_url":"https://api.github.com/users/ajcvickers/following{/other_user}","gists_url":"https://api.github.com/users/ajcvickers/gists{/gist_id}","starred_url":"https://api.github.com/users/ajcvickers/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajcvickers/subscriptions","organizations_url":"https://api.github.com/users/ajcvickers/orgs","repos_url":"https://api.github.com/users/ajcvickers/repos","events_url":"https://api.github.com/users/ajcvickers/events{/privacy}","received_events_url":"https://api.github.com/users/ajcvickers/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-01T20:38:14Z","updated_at":"2023-03-01T20:38:14Z","body":"@kcindric A runnable project for this would be very helpful!","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/dotnet/efcore/issues/comments/1450813272/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"ajcvickers","id":1430078,"node_id":"MDQ6VXNlcjE0MzAwNzg=","avatar_url":"https://avatars.githubusercontent.com/u/1430078?v=4","gravatar_id":"","url":"https://api.github.com/users/ajcvickers","html_url":"https://github.com/ajcvickers","followers_url":"https://api.github.com/users/ajcvickers/followers","following_url":"https://api.github.com/users/ajcvickers/following{/other_user}","gists_url":"https://api.github.com/users/ajcvickers/gists{/gist_id}","starred_url":"https://api.github.com/users/ajcvickers/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajcvickers/subscriptions","organizations_url":"https://api.github.com/users/ajcvickers/orgs","repos_url":"https://api.github.com/users/ajcvickers/repos","events_url":"https://api.github.com/users/ajcvickers/events{/privacy}","received_events_url":"https://api.github.com/users/ajcvickers/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":8642465064,"node_id":"MEE_lADOAPaMMs5fpD2CzwAAAAIDIY0o","url":"https://api.github.com/repos/dotnet/efcore/issues/events/8642465064","actor":{"login":"kcindric","id":44549361,"node_id":"MDQ6VXNlcjQ0NTQ5MzYx","avatar_url":"https://avatars.githubusercontent.com/u/44549361?v=4","gravatar_id":"","url":"https://api.github.com/users/kcindric","html_url":"https://github.com/kcindric","followers_url":"https://api.github.com/users/kcindric/followers","following_url":"https://api.github.com/users/kcindric/following{/other_user}","gists_url":"https://api.github.com/users/kcindric/gists{/gist_id}","starred_url":"https://api.github.com/users/kcindric/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kcindric/subscriptions","organizations_url":"https://api.github.com/users/kcindric/orgs","repos_url":"https://api.github.com/users/kcindric/repos","events_url":"https://api.github.com/users/kcindric/events{/privacy}","received_events_url":"https://api.github.com/users/kcindric/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2023-03-01T20:38:14Z","performed_via_github_app":null},{"id":8642465088,"node_id":"SE_lADOAPaMMs5fpD2CzwAAAAIDIY1A","url":"https://api.github.com/repos/dotnet/efcore/issues/events/8642465088","actor":{"login":"kcindric","id":44549361,"node_id":"MDQ6VXNlcjQ0NTQ5MzYx","avatar_url":"https://avatars.githubusercontent.com/u/44549361?v=4","gravatar_id":"","url":"https://api.github.com/users/kcindric","html_url":"https://github.com/kcindric","followers_url":"https://api.github.com/users/kcindric/followers","following_url":"https://api.github.com/users/kcindric/following{/other_user}","gists_url":"https://api.github.com/users/kcindric/gists{/gist_id}","starred_url":"https://api.github.com/users/kcindric/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kcindric/subscriptions","organizations_url":"https://api.github.com/users/kcindric/orgs","repos_url":"https://api.github.com/users/kcindric/repos","events_url":"https://api.github.com/users/kcindric/events{/privacy}","received_events_url":"https://api.github.com/users/kcindric/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2023-03-01T20:38:15Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/dotnet/efcore/issues/comments/1451512789","html_url":"https://github.com/dotnet/efcore/issues/30373#issuecomment-1451512789","issue_url":"https://api.github.com/repos/dotnet/efcore/issues/30373","id":1451512789,"node_id":"IC_kwDOAPaMMs5WhFPV","user":{"login":"kcindric","id":44549361,"node_id":"MDQ6VXNlcjQ0NTQ5MzYx","avatar_url":"https://avatars.githubusercontent.com/u/44549361?v=4","gravatar_id":"","url":"https://api.github.com/users/kcindric","html_url":"https://github.com/kcindric","followers_url":"https://api.github.com/users/kcindric/followers","following_url":"https://api.github.com/users/kcindric/following{/other_user}","gists_url":"https://api.github.com/users/kcindric/gists{/gist_id}","starred_url":"https://api.github.com/users/kcindric/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kcindric/subscriptions","organizations_url":"https://api.github.com/users/kcindric/orgs","repos_url":"https://api.github.com/users/kcindric/repos","events_url":"https://api.github.com/users/kcindric/events{/privacy}","received_events_url":"https://api.github.com/users/kcindric/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-02T08:54:58Z","updated_at":"2023-03-02T09:22:06Z","body":"> @kcindric A runnable project for this would be very helpful!\r\n\r\n@ajcvickers  here you go!\r\nhttps://github.com/kcindric/EF-DDD-problem","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/dotnet/efcore/issues/comments/1451512789/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"kcindric","id":44549361,"node_id":"MDQ6VXNlcjQ0NTQ5MzYx","avatar_url":"https://avatars.githubusercontent.com/u/44549361?v=4","gravatar_id":"","url":"https://api.github.com/users/kcindric","html_url":"https://github.com/kcindric","followers_url":"https://api.github.com/users/kcindric/followers","following_url":"https://api.github.com/users/kcindric/following{/other_user}","gists_url":"https://api.github.com/users/kcindric/gists{/gist_id}","starred_url":"https://api.github.com/users/kcindric/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kcindric/subscriptions","organizations_url":"https://api.github.com/users/kcindric/orgs","repos_url":"https://api.github.com/users/kcindric/repos","events_url":"https://api.github.com/users/kcindric/events{/privacy}","received_events_url":"https://api.github.com/users/kcindric/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":8646799309,"node_id":"MEE_lADOAPaMMs5fpD2CzwAAAAIDY6_N","url":"https://api.github.com/repos/dotnet/efcore/issues/events/8646799309","actor":{"login":"kcindric","id":44549361,"node_id":"MDQ6VXNlcjQ0NTQ5MzYx","avatar_url":"https://avatars.githubusercontent.com/u/44549361?v=4","gravatar_id":"","url":"https://api.github.com/users/kcindric","html_url":"https://github.com/kcindric","followers_url":"https://api.github.com/users/kcindric/followers","following_url":"https://api.github.com/users/kcindric/following{/other_user}","gists_url":"https://api.github.com/users/kcindric/gists{/gist_id}","starred_url":"https://api.github.com/users/kcindric/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kcindric/subscriptions","organizations_url":"https://api.github.com/users/kcindric/orgs","repos_url":"https://api.github.com/users/kcindric/repos","events_url":"https://api.github.com/users/kcindric/events{/privacy}","received_events_url":"https://api.github.com/users/kcindric/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2023-03-02T08:54:59Z","performed_via_github_app":null},{"id":8646799320,"node_id":"SE_lADOAPaMMs5fpD2CzwAAAAIDY6_Y","url":"https://api.github.com/repos/dotnet/efcore/issues/events/8646799320","actor":{"login":"kcindric","id":44549361,"node_id":"MDQ6VXNlcjQ0NTQ5MzYx","avatar_url":"https://avatars.githubusercontent.com/u/44549361?v=4","gravatar_id":"","url":"https://api.github.com/users/kcindric","html_url":"https://github.com/kcindric","followers_url":"https://api.github.com/users/kcindric/followers","following_url":"https://api.github.com/users/kcindric/following{/other_user}","gists_url":"https://api.github.com/users/kcindric/gists{/gist_id}","starred_url":"https://api.github.com/users/kcindric/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kcindric/subscriptions","organizations_url":"https://api.github.com/users/kcindric/orgs","repos_url":"https://api.github.com/users/kcindric/repos","events_url":"https://api.github.com/users/kcindric/events{/privacy}","received_events_url":"https://api.github.com/users/kcindric/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2023-03-02T08:54:59Z","performed_via_github_app":null},{"id":8647074772,"node_id":"MEE_lADOAPaMMs5fpD2CzwAAAAIDZ-PU","url":"https://api.github.com/repos/dotnet/efcore/issues/events/8647074772","actor":{"login":"ajcvickers","id":1430078,"node_id":"MDQ6VXNlcjE0MzAwNzg=","avatar_url":"https://avatars.githubusercontent.com/u/1430078?v=4","gravatar_id":"","url":"https://api.github.com/users/ajcvickers","html_url":"https://github.com/ajcvickers","followers_url":"https://api.github.com/users/ajcvickers/followers","following_url":"https://api.github.com/users/ajcvickers/following{/other_user}","gists_url":"https://api.github.com/users/ajcvickers/gists{/gist_id}","starred_url":"https://api.github.com/users/ajcvickers/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajcvickers/subscriptions","organizations_url":"https://api.github.com/users/ajcvickers/orgs","repos_url":"https://api.github.com/users/ajcvickers/repos","events_url":"https://api.github.com/users/ajcvickers/events{/privacy}","received_events_url":"https://api.github.com/users/ajcvickers/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2023-03-02T09:22:06Z","performed_via_github_app":null},{"id":8647074789,"node_id":"SE_lADOAPaMMs5fpD2CzwAAAAIDZ-Pl","url":"https://api.github.com/repos/dotnet/efcore/issues/events/8647074789","actor":{"login":"ajcvickers","id":1430078,"node_id":"MDQ6VXNlcjE0MzAwNzg=","avatar_url":"https://avatars.githubusercontent.com/u/1430078?v=4","gravatar_id":"","url":"https://api.github.com/users/ajcvickers","html_url":"https://github.com/ajcvickers","followers_url":"https://api.github.com/users/ajcvickers/followers","following_url":"https://api.github.com/users/ajcvickers/following{/other_user}","gists_url":"https://api.github.com/users/ajcvickers/gists{/gist_id}","starred_url":"https://api.github.com/users/ajcvickers/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajcvickers/subscriptions","organizations_url":"https://api.github.com/users/ajcvickers/orgs","repos_url":"https://api.github.com/users/ajcvickers/repos","events_url":"https://api.github.com/users/ajcvickers/events{/privacy}","received_events_url":"https://api.github.com/users/ajcvickers/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2023-03-02T09:22:06Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/dotnet/efcore/issues/comments/1451789198","html_url":"https://github.com/dotnet/efcore/issues/30373#issuecomment-1451789198","issue_url":"https://api.github.com/repos/dotnet/efcore/issues/30373","id":1451789198,"node_id":"IC_kwDOAPaMMs5WiIuO","user":{"login":"ajcvickers","id":1430078,"node_id":"MDQ6VXNlcjE0MzAwNzg=","avatar_url":"https://avatars.githubusercontent.com/u/1430078?v=4","gravatar_id":"","url":"https://api.github.com/users/ajcvickers","html_url":"https://github.com/ajcvickers","followers_url":"https://api.github.com/users/ajcvickers/followers","following_url":"https://api.github.com/users/ajcvickers/following{/other_user}","gists_url":"https://api.github.com/users/ajcvickers/gists{/gist_id}","starred_url":"https://api.github.com/users/ajcvickers/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajcvickers/subscriptions","organizations_url":"https://api.github.com/users/ajcvickers/orgs","repos_url":"https://api.github.com/users/ajcvickers/repos","events_url":"https://api.github.com/users/ajcvickers/events{/privacy}","received_events_url":"https://api.github.com/users/ajcvickers/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-02T12:27:38Z","updated_at":"2023-03-02T12:27:38Z","body":"Note for triage: this is another case (e.g. like #30107) where a CLR type is first configured as a non-entity type (`builder.Property(m => m.DepartmentId)`), and then later configured again as an entity type (`builder.OwnsMany(o => o.DepartmentIds, ...`). We should handle this better, either with an eager exception with a better message, or in model validation.\r\n\r\n@kcindric A given CLR type cannot be used as both an entity type and as the type of a normally mapped property.","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/dotnet/efcore/issues/comments/1451789198/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"ajcvickers","id":1430078,"node_id":"MDQ6VXNlcjE0MzAwNzg=","avatar_url":"https://avatars.githubusercontent.com/u/1430078?v=4","gravatar_id":"","url":"https://api.github.com/users/ajcvickers","html_url":"https://github.com/ajcvickers","followers_url":"https://api.github.com/users/ajcvickers/followers","following_url":"https://api.github.com/users/ajcvickers/following{/other_user}","gists_url":"https://api.github.com/users/ajcvickers/gists{/gist_id}","starred_url":"https://api.github.com/users/ajcvickers/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajcvickers/subscriptions","organizations_url":"https://api.github.com/users/ajcvickers/orgs","repos_url":"https://api.github.com/users/ajcvickers/repos","events_url":"https://api.github.com/users/ajcvickers/events{/privacy}","received_events_url":"https://api.github.com/users/ajcvickers/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":8648860564,"node_id":"MEE_lADOAPaMMs5fpD2CzwAAAAIDgyOU","url":"https://api.github.com/repos/dotnet/efcore/issues/events/8648860564","actor":{"login":"kcindric","id":44549361,"node_id":"MDQ6VXNlcjQ0NTQ5MzYx","avatar_url":"https://avatars.githubusercontent.com/u/44549361?v=4","gravatar_id":"","url":"https://api.github.com/users/kcindric","html_url":"https://github.com/kcindric","followers_url":"https://api.github.com/users/kcindric/followers","following_url":"https://api.github.com/users/kcindric/following{/other_user}","gists_url":"https://api.github.com/users/kcindric/gists{/gist_id}","starred_url":"https://api.github.com/users/kcindric/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kcindric/subscriptions","organizations_url":"https://api.github.com/users/kcindric/orgs","repos_url":"https://api.github.com/users/kcindric/repos","events_url":"https://api.github.com/users/kcindric/events{/privacy}","received_events_url":"https://api.github.com/users/kcindric/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2023-03-02T12:27:39Z","performed_via_github_app":null},{"id":8648860585,"node_id":"SE_lADOAPaMMs5fpD2CzwAAAAIDgyOp","url":"https://api.github.com/repos/dotnet/efcore/issues/events/8648860585","actor":{"login":"kcindric","id":44549361,"node_id":"MDQ6VXNlcjQ0NTQ5MzYx","avatar_url":"https://avatars.githubusercontent.com/u/44549361?v=4","gravatar_id":"","url":"https://api.github.com/users/kcindric","html_url":"https://github.com/kcindric","followers_url":"https://api.github.com/users/kcindric/followers","following_url":"https://api.github.com/users/kcindric/following{/other_user}","gists_url":"https://api.github.com/users/kcindric/gists{/gist_id}","starred_url":"https://api.github.com/users/kcindric/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kcindric/subscriptions","organizations_url":"https://api.github.com/users/kcindric/orgs","repos_url":"https://api.github.com/users/kcindric/repos","events_url":"https://api.github.com/users/kcindric/events{/privacy}","received_events_url":"https://api.github.com/users/kcindric/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2023-03-02T12:27:39Z","performed_via_github_app":null},{"actor":{"login":"ajcvickers","id":1430078,"node_id":"MDQ6VXNlcjE0MzAwNzg=","avatar_url":"https://avatars.githubusercontent.com/u/1430078?v=4","gravatar_id":"","url":"https://api.github.com/users/ajcvickers","html_url":"https://github.com/ajcvickers","followers_url":"https://api.github.com/users/ajcvickers/followers","following_url":"https://api.github.com/users/ajcvickers/following{/other_user}","gists_url":"https://api.github.com/users/ajcvickers/gists{/gist_id}","starred_url":"https://api.github.com/users/ajcvickers/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajcvickers/subscriptions","organizations_url":"https://api.github.com/users/ajcvickers/orgs","repos_url":"https://api.github.com/users/ajcvickers/repos","events_url":"https://api.github.com/users/ajcvickers/events{/privacy}","received_events_url":"https://api.github.com/users/ajcvickers/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-02T12:28:07Z","updated_at":"2023-03-02T12:28:07Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/dotnet/efcore/issues/30295","repository_url":"https://api.github.com/repos/dotnet/efcore","labels_url":"https://api.github.com/repos/dotnet/efcore/issues/30295/labels{/name}","comments_url":"https://api.github.com/repos/dotnet/efcore/issues/30295/comments","events_url":"https://api.github.com/repos/dotnet/efcore/issues/30295/events","html_url":"https://github.com/dotnet/efcore/issues/30295","id":1586811275,"node_id":"I_kwDOAPaMMs5elNGL","number":30295,"title":"System.NullReferenceException: Object reference not set to an instance of an object.","user":{"login":"ademclk","id":90575399,"node_id":"MDQ6VXNlcjkwNTc1Mzk5","avatar_url":"https://avatars.githubusercontent.com/u/90575399?v=4","gravatar_id":"","url":"https://api.github.com/users/ademclk","html_url":"https://github.com/ademclk","followers_url":"https://api.github.com/users/ademclk/followers","following_url":"https://api.github.com/users/ademclk/following{/other_user}","gists_url":"https://api.github.com/users/ademclk/gists{/gist_id}","starred_url":"https://api.github.com/users/ademclk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ademclk/subscriptions","organizations_url":"https://api.github.com/users/ademclk/orgs","repos_url":"https://api.github.com/users/ademclk/repos","events_url":"https://api.github.com/users/ademclk/events{/privacy}","received_events_url":"https://api.github.com/users/ademclk/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":936619505,"node_id":"MDU6TGFiZWw5MzY2MTk1MDU=","url":"https://api.github.com/repos/dotnet/efcore/labels/customer-reported","name":"customer-reported","color":"a4a5f9","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2023-02-16T00:44:30Z","updated_at":"2025-06-16T09:00:50Z","closed_at":"2023-03-02T12:28:07Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"repository":{"id":16157746,"node_id":"MDEwOlJlcG9zaXRvcnkxNjE1Nzc0Ng==","name":"efcore","full_name":"dotnet/efcore","private":false,"owner":{"login":"dotnet","id":9141961,"node_id":"MDEyOk9yZ2FuaXphdGlvbjkxNDE5NjE=","avatar_url":"https://avatars.githubusercontent.com/u/9141961?v=4","gravatar_id":"","url":"https://api.github.com/users/dotnet","html_url":"https://github.com/dotnet","followers_url":"https://api.github.com/users/dotnet/followers","following_url":"https://api.github.com/users/dotnet/following{/other_user}","gists_url":"https://api.github.com/users/dotnet/gists{/gist_id}","starred_url":"https://api.github.com/users/dotnet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dotnet/subscriptions","organizations_url":"https://api.github.com/users/dotnet/orgs","repos_url":"https://api.github.com/users/dotnet/repos","events_url":"https://api.github.com/users/dotnet/events{/privacy}","received_events_url":"https://api.github.com/users/dotnet/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/dotnet/efcore","description":"EF Core is a modern object-database mapper for .NET. It supports LINQ queries, change tracking, updates, and schema migrations.","fork":false,"url":"https://api.github.com/repos/dotnet/efcore","forks_url":"https://api.github.com/repos/dotnet/efcore/forks","keys_url":"https://api.github.com/repos/dotnet/efcore/keys{/key_id}","collaborators_url":"https://api.github.com/repos/dotnet/efcore/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/dotnet/efcore/teams","hooks_url":"https://api.github.com/repos/dotnet/efcore/hooks","issue_events_url":"https://api.github.com/repos/dotnet/efcore/issues/events{/number}","events_url":"https://api.github.com/repos/dotnet/efcore/events","assignees_url":"https://api.github.com/repos/dotnet/efcore/assignees{/user}","branches_url":"https://api.github.com/repos/dotnet/efcore/branches{/branch}","tags_url":"https://api.github.com/repos/dotnet/efcore/tags","blobs_url":"https://api.github.com/repos/dotnet/efcore/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/dotnet/efcore/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/dotnet/efcore/git/refs{/sha}","trees_url":"https://api.github.com/repos/dotnet/efcore/git/trees{/sha}","statuses_url":"https://api.github.com/repos/dotnet/efcore/statuses/{sha}","languages_url":"https://api.github.com/repos/dotnet/efcore/languages","stargazers_url":"https://api.github.com/repos/dotnet/efcore/stargazers","contributors_url":"https://api.github.com/repos/dotnet/efcore/contributors","subscribers_url":"https://api.github.com/repos/dotnet/efcore/subscribers","subscription_url":"https://api.github.com/repos/dotnet/efcore/subscription","commits_url":"https://api.github.com/repos/dotnet/efcore/commits{/sha}","git_commits_url":"https://api.github.com/repos/dotnet/efcore/git/commits{/sha}","comments_url":"https://api.github.com/repos/dotnet/efcore/comments{/number}","issue_comment_url":"https://api.github.com/repos/dotnet/efcore/issues/comments{/number}","contents_url":"https://api.github.com/repos/dotnet/efcore/contents/{+path}","compare_url":"https://api.github.com/repos/dotnet/efcore/compare/{base}...{head}","merges_url":"https://api.github.com/repos/dotnet/efcore/merges","archive_url":"https://api.github.com/repos/dotnet/efcore/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/dotnet/efcore/downloads","issues_url":"https://api.github.com/repos/dotnet/efcore/issues{/number}","pulls_url":"https://api.github.com/repos/dotnet/efcore/pulls{/number}","milestones_url":"https://api.github.com/repos/dotnet/efcore/milestones{/number}","notifications_url":"https://api.github.com/repos/dotnet/efcore/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/dotnet/efcore/labels{/name}","releases_url":"https://api.github.com/repos/dotnet/efcore/releases{/id}","deployments_url":"https://api.github.com/repos/dotnet/efcore/deployments","created_at":"2014-01-23T00:52:01Z","updated_at":"2025-11-10T14:21:49Z","pushed_at":"2025-11-10T05:59:58Z","git_url":"git://github.com/dotnet/efcore.git","ssh_url":"git@github.com:dotnet/efcore.git","clone_url":"https://github.com/dotnet/efcore.git","svn_url":"https://github.com/dotnet/efcore","homepage":"https://learn.microsoft.com/ef/","size":215987,"stargazers_count":14455,"watchers_count":14455,"language":"C#","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":3324,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":2430,"license":{"key":"mit","name":"MIT License","spdx_id":"MIT","url":"https://api.github.com/licenses/mit","node_id":"MDc6TGljZW5zZTEz"},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["aspnet-product","c-sharp","database","dotnet-core","dotnet-framework","dotnet-standard","entity-framework","hacktoberfest","orm"],"visibility":"public","forks":3324,"open_issues":2430,"watchers":14455,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"body":"## Mapping aggregates to database\r\n\r\nI was mapping my aggregate roots to my database. Made 9 of them without errors but the last one I couldn't make it. Everything seems same but I couldn't figure out.\r\n\r\nIf you want to check my project files to understand what's going on [ademclk/ceyehatapi](https://github.com/ademclk/ceyehat-api)\r\n\r\nIf you check my city configurations file I mapped entities like this and it worked fine. I don't know what's the problem with this one.\r\n\r\nHelp needed. If you want to check issue [ademclk/ceyehatapi/issues](https://github.com/ademclk/ceyehat-api/issues/60)\r\n\r\nPassenger configurations file.\r\n\r\n```C#\r\nusing Ceyehat.Domain.CustomerAggregate.ValueObjects;\r\nusing Ceyehat.Domain.PassengerAggregate;\r\nusing Ceyehat.Domain.PassengerAggregate.Entities;\r\nusing Ceyehat.Domain.PassengerAggregate.ValueObjects;\r\nusing Microsoft.EntityFrameworkCore;\r\nusing Microsoft.EntityFrameworkCore.Metadata.Builders;\r\n\r\nnamespace Ceyehat.Infrastructure.Persistence.Configurations;\r\n\r\npublic class PassengerConfigurations : IEntityTypeConfiguration<Passenger>\r\n{\r\n    public void Configure(EntityTypeBuilder<Passenger> builder)\r\n    {\r\n        ConfigurePassengersTable(builder);\r\n        ConfigurePassengerFlightTicketsTable(builder);\r\n        ConfigurePassengerBoardingPassesTable(builder);\r\n    }\r\n\r\n    private void ConfigurePassengerBoardingPassesTable(EntityTypeBuilder<Passenger> builder)\r\n    {\r\n        builder.OwnsMany(\r\n            p => p.BoardingPasses,\r\n            tb =>\r\n            {\r\n                tb.ToTable(\"PassengerBoardingPasses\");\r\n\r\n                tb.HasKey(b => b.Id);\r\n\r\n                tb.Property(b => b.Id)\r\n                    .HasColumnName(\"PassengerBoardingPassId\")\r\n                    .ValueGeneratedNever()\r\n                    .HasConversion(\r\n                        id => id.Value,\r\n                        value => BoardingPassId.Create(value));\r\n\r\n                tb.Property(b => b.FlightTicketId)\r\n                    .ValueGeneratedNever()\r\n                    .HasConversion(\r\n                        id => id.Value,\r\n                        value => FlightTicketId.Create(value));\r\n\r\n                tb.Property(b => b.Gate)\r\n                    .HasMaxLength(8);\r\n\r\n                tb.Property(b => b.BoardingTime)\r\n                    .IsRequired();\r\n            });\r\n    }\r\n\r\n    private void ConfigurePassengerFlightTicketsTable(EntityTypeBuilder<Passenger> builder)\r\n    {\r\n        builder.OwnsMany(\r\n            p => p.FlightTickets,\r\n            tb =>\r\n            {\r\n                tb.ToTable(\"PassengerFlightTickets\");\r\n\r\n                tb.Property(t => t.Id)\r\n                    .HasColumnName(\"PassengerFlightTicketId\")\r\n                    .ValueGeneratedNever()\r\n                    .HasConversion(\r\n                        id => id.Value,\r\n                        value => FlightTicketId.Create(value));\r\n\r\n                tb.Property(t => t.BookingId)\r\n                    .ValueGeneratedNever()\r\n                    .HasConversion(\r\n                        id => id.Value,\r\n                        value => BookingId.Create(value));\r\n            });\r\n    }\r\n\r\n    private void ConfigurePassengersTable(EntityTypeBuilder<Passenger> builder)\r\n    {\r\n        builder.ToTable(\"Passengers\");\r\n\r\n        builder.HasKey(p => p.Id);\r\n\r\n        builder.Property(p => p.Id)\r\n            .ValueGeneratedNever()\r\n            .HasConversion(\r\n                p => p.Value,\r\n                value => PassengerId.Create(value));\r\n\r\n        builder.Property(p => p.CustomerId)\r\n            .ValueGeneratedNever()\r\n            .HasConversion(\r\n                p => p.Value,\r\n                value => CustomerId.Create(value));\r\n\r\n    }\r\n}\r\n```\r\n\r\n\r\n### Stack Trace\r\n\r\n```\r\nBuild started...\r\nBuild succeeded.\r\nSystem.Reflection.TargetInvocationException: Exception has been thrown by the target of an invocation.\r\n ---> System.NullReferenceException: Object reference not set to an instance of an object.\r\n   at Microsoft.EntityFrameworkCore.Metadata.Conventions.Internal.ConventionBatchExtensions.Run(IConventionBatch batch, InternalForeignKeyBuilder relationshipBuilder)\r\n   at Microsoft.EntityFrameworkCore.Metadata.Internal.InternalForeignKeyBuilder.ReuniquifyImplicitProperties(Boolean force)\r\n   at Microsoft.EntityFrameworkCore.Metadata.Conventions.ForeignKeyPropertyDiscoveryConvention.DiscoverProperties(IConventionForeignKeyBuilder relationshipBuilder, IConventionContext context)\r\n   at Microsoft.EntityFrameworkCore.Metadata.Conventions.ForeignKeyPropertyDiscoveryConvention.ProcessForeignKeyRequirednessChanged(IConventionForeignKeyBuilder relationshipBuilder, IConventionContext`1 context)\r\n   at Microsoft.EntityFrameworkCore.Metadata.Conventions.Internal.ConventionDispatcher.ImmediateConventionScope.OnForeignKeyRequirednessChanged(IConventionForeignKeyBuilder relationshipBuilder)\r\n   at Microsoft.EntityFrameworkCore.Metadata.Conventions.Internal.ConventionDispatcher.OnForeignKeyRequirednessChangedNode.Run(ConventionDispatcher dispatcher)\r\n   at Microsoft.EntityFrameworkCore.Metadata.Conventions.Internal.ConventionDispatcher.DelayedConventionScope.Run(ConventionDispatcher dispatcher)\r\n   at Microsoft.EntityFrameworkCore.Metadata.Conventions.Internal.ConventionDispatcher.ConventionBatch.Run()\r\n   at Microsoft.EntityFrameworkCore.Metadata.Conventions.Internal.ConventionDispatcher.ConventionBatch.Run(IConventionForeignKey foreignKey)\r\n   at Microsoft.EntityFrameworkCore.Metadata.Builders.EntityTypeBuilder`1.OwnsManyBuilder[TRelatedEntity](TypeIdentity ownedType, MemberIdentity navigation)\r\n   at Microsoft.EntityFrameworkCore.Metadata.Builders.EntityTypeBuilder`1.OwnsMany[TRelatedEntity](Expression`1 navigationExpression, Action`1 buildAction)\r\n   at Ceyehat.Infrastructure.Persistence.Configurations.PassengerConfigurations.ConfigurePassengerFlightTicketsTable(EntityTypeBuilder`1 builder) in /Users/ademclk/RiderProjects/ceyehat-api/Ceyehat.Infrastructure/Persistence/Configurations/PassengerConfigurations.cs:line 51\r\n   at Ceyehat.Infrastructure.Persistence.Configurations.PassengerConfigurations.Configure(EntityTypeBuilder`1 builder) in /Users/ademclk/RiderProjects/ceyehat-api/Ceyehat.Infrastructure/Persistence/Configurations/PassengerConfigurations.cs:line 15\r\n   at Microsoft.EntityFrameworkCore.ModelBuilder.ApplyConfiguration[TEntity](IEntityTypeConfiguration`1 configuration)\r\n   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)\r\n   at System.Reflection.MethodInvoker.Invoke(Object obj, IntPtr* args, BindingFlags invokeAttr)\r\n   --- End of inner exception stack trace ---\r\n   at System.Reflection.MethodInvoker.Invoke(Object obj, IntPtr* args, BindingFlags invokeAttr)\r\n   at System.Reflection.RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)\r\n   at Microsoft.EntityFrameworkCore.ModelBuilder.ApplyConfigurationsFromAssembly(Assembly assembly, Func`2 predicate)\r\n   at Ceyehat.Infrastructure.Persistence.CeyehatDbContext.OnModelCreating(ModelBuilder modelBuilder) in /Users/ademclk/RiderProjects/ceyehat-api/Ceyehat.Infrastructure/Persistence/CeyehatDbContext.cs:line 37\r\n   at Microsoft.EntityFrameworkCore.Infrastructure.ModelCustomizer.Customize(ModelBuilder modelBuilder, DbContext context)\r\n   at Microsoft.EntityFrameworkCore.Infrastructure.ModelSource.CreateModel(DbContext context, IConventionSetBuilder conventionSetBuilder, ModelDependencies modelDependencies)\r\n   at Microsoft.EntityFrameworkCore.Infrastructure.ModelSource.GetModel(DbContext context, ModelCreationDependencies modelCreationDependencies, Boolean designTime)\r\n   at Microsoft.EntityFrameworkCore.Internal.DbContextServices.CreateModel(Boolean designTime)\r\n   at Microsoft.EntityFrameworkCore.Internal.DbContextServices.get_Model()\r\n   at Microsoft.EntityFrameworkCore.Infrastructure.EntityFrameworkServicesBuilder.<>c.<TryAddCoreServices>b__8_4(IServiceProvider p)\r\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)\r\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitCache(ServiceCallSite callSite, RuntimeResolverContext context, ServiceProviderEngineScope serviceProviderEngine, RuntimeResolverLock lockType)\r\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitScopeCache(ServiceCallSite callSite, RuntimeResolverContext context)\r\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)\r\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)\r\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)\r\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitCache(ServiceCallSite callSite, RuntimeResolverContext context, ServiceProviderEngineScope serviceProviderEngine, RuntimeResolverLock lockType)\r\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitScopeCache(ServiceCallSite callSite, RuntimeResolverContext context)\r\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)\r\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)\r\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)\r\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitCache(ServiceCallSite callSite, RuntimeResolverContext context, ServiceProviderEngineScope serviceProviderEngine, RuntimeResolverLock lockType)\r\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitScopeCache(ServiceCallSite callSite, RuntimeResolverContext context)\r\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)\r\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)\r\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)\r\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitCache(ServiceCallSite callSite, RuntimeResolverContext context, ServiceProviderEngineScope serviceProviderEngine, RuntimeResolverLock lockType)\r\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitScopeCache(ServiceCallSite callSite, RuntimeResolverContext context)\r\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)\r\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)\r\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)\r\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitCache(ServiceCallSite callSite, RuntimeResolverContext context, ServiceProviderEngineScope serviceProviderEngine, RuntimeResolverLock lockType)\r\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitScopeCache(ServiceCallSite callSite, RuntimeResolverContext context)\r\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)\r\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)\r\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)\r\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitCache(ServiceCallSite callSite, RuntimeResolverContext context, ServiceProviderEngineScope serviceProviderEngine, RuntimeResolverLock lockType)\r\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitScopeCache(ServiceCallSite callSite, RuntimeResolverContext context)\r\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)\r\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.Resolve(ServiceCallSite callSite, ServiceProviderEngineScope scope)\r\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.DynamicServiceProviderEngine.<>c__DisplayClass2_0.<RealizeService>b__0(ServiceProviderEngineScope scope)\r\n   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)\r\n   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)\r\n   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)\r\n   at Microsoft.EntityFrameworkCore.DbContext.get_DbContextDependencies()\r\n   at Microsoft.EntityFrameworkCore.DbContext.get_ContextServices()\r\n   at Microsoft.EntityFrameworkCore.DbContext.get_InternalServiceProvider()\r\n   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IInfrastructure<System.IServiceProvider>.get_Instance()\r\n   at Microsoft.EntityFrameworkCore.Infrastructure.Internal.InfrastructureExtensions.GetService[TService](IInfrastructure`1 accessor)\r\n   at Microsoft.EntityFrameworkCore.Infrastructure.AccessorExtensions.GetService[TService](IInfrastructure`1 accessor)\r\n   at Microsoft.EntityFrameworkCore.Design.Internal.DbContextOperations.CreateContext(Func`1 factory)\r\n   at Microsoft.EntityFrameworkCore.Design.Internal.DbContextOperations.CreateContext(String contextType)\r\n   at Microsoft.EntityFrameworkCore.Design.Internal.MigrationsOperations.AddMigration(String name, String outputDir, String contextType, String namespace)\r\n   at Microsoft.EntityFrameworkCore.Design.OperationExecutor.AddMigrationImpl(String name, String outputDir, String contextType, String namespace)\r\n   at Microsoft.EntityFrameworkCore.Design.OperationExecutor.AddMigration.<>c__DisplayClass0_0.<.ctor>b__0()\r\n   at Microsoft.EntityFrameworkCore.Design.OperationExecutor.OperationBase.<>c__DisplayClass3_0`1.<Execute>b__0()\r\n   at Microsoft.EntityFrameworkCore.Design.OperationExecutor.OperationBase.Execute(Action action)\r\nException has been thrown by the target of an invocation.\r\n\r\n```\r\n\r\n### Verbose output\r\n\r\n```\r\nUsing project '/Users/ademclk/RiderProjects/ceyehat-api/Ceyehat.Infrastructure/Ceyehat.Infrastructure.csproj'.\r\nUsing startup project '/Users/ademclk/RiderProjects/ceyehat-api/ceyehat/ceyehat.csproj'.\r\nWriting '/Users/ademclk/RiderProjects/ceyehat-api/Ceyehat.Infrastructure/obj/Ceyehat.Infrastructure.csproj.EntityFrameworkCore.targets'...\r\ndotnet msbuild /target:GetEFProjectMetadata /property:EFProjectMetadataFile=/var/folders/51/ct25jx3x6xn53_3s8r5449qr0000gn/T/tmpHOliq8.tmp /verbosity:quiet /nologo /Users/ademclk/RiderProjects/ceyehat-api/Ceyehat.Infrastructure/Ceyehat.Infrastructure.csproj\r\nWriting '/Users/ademclk/RiderProjects/ceyehat-api/ceyehat/obj/ceyehat.csproj.EntityFrameworkCore.targets'...\r\ndotnet msbuild /target:GetEFProjectMetadata /property:EFProjectMetadataFile=/var/folders/51/ct25jx3x6xn53_3s8r5449qr0000gn/T/tmpfJx0jN.tmp /verbosity:quiet /nologo /Users/ademclk/RiderProjects/ceyehat-api/ceyehat/ceyehat.csproj\r\nBuild started...\r\ndotnet build /Users/ademclk/RiderProjects/ceyehat-api/ceyehat/ceyehat.csproj /verbosity:quiet /nologo\r\n\r\nBuild succeeded.\r\n    0 Warning(s)\r\n    0 Error(s)\r\n\r\nTime Elapsed 00:00:01.36\r\nBuild succeeded.\r\ndotnet exec --depsfile /Users/ademclk/RiderProjects/ceyehat-api/ceyehat/bin/Debug/net7.0/ceyehat.deps.json --additionalprobingpath /Users/ademclk/.nuget/packages --runtimeconfig /Users/ademclk/RiderProjects/ceyehat-api/ceyehat/bin/Debug/net7.0/ceyehat.runtimeconfig.json /Users/ademclk/.dotnet/tools/.store/dotnet-ef/7.0.3/dotnet-ef/7.0.3/tools/net6.0/any/tools/netcoreapp2.0/any/ef.dll migrations add PassengerMapping --assembly /Users/ademclk/RiderProjects/ceyehat-api/ceyehat/bin/Debug/net7.0/Ceyehat.Infrastructure.dll --project /Users/ademclk/RiderProjects/ceyehat-api/Ceyehat.Infrastructure/Ceyehat.Infrastructure.csproj --startup-assembly /Users/ademclk/RiderProjects/ceyehat-api/ceyehat/bin/Debug/net7.0/ceyehat.dll --startup-project /Users/ademclk/RiderProjects/ceyehat-api/ceyehat/ceyehat.csproj --project-dir /Users/ademclk/RiderProjects/ceyehat-api/Ceyehat.Infrastructure/ --root-namespace Ceyehat.Infrastructure --language C# --framework net7.0 --nullable --working-dir /Users/ademclk/RiderProjects/ceyehat-api --verbose\r\nUsing assembly 'Ceyehat.Infrastructure'.\r\nUsing startup assembly 'ceyehat'.\r\nUsing application base '/Users/ademclk/RiderProjects/ceyehat-api/ceyehat/bin/Debug/net7.0'.\r\nUsing working directory '/Users/ademclk/RiderProjects/ceyehat-api/ceyehat'.\r\nUsing root namespace 'Ceyehat.Infrastructure'.\r\nUsing project directory '/Users/ademclk/RiderProjects/ceyehat-api/Ceyehat.Infrastructure/'.\r\nRemaining arguments: .\r\nFinding DbContext classes...\r\nFinding IDesignTimeDbContextFactory implementations...\r\nFinding application service provider in assembly 'ceyehat'...\r\nFinding Microsoft.Extensions.Hosting service provider...\r\nUsing environment 'Development'.\r\nUsing application service provider from Microsoft.Extensions.Hosting.\r\nFound DbContext 'CeyehatDbContext'.\r\nFinding DbContext classes in the project...\r\nUsing context 'CeyehatDbContext'.\r\n\r\n```\r\n\r\n### Include provider and version information\r\n\r\nEF Core version:\r\nDatabase provider: Microsoft.EntityFrameworkCore.PostgreSQL\r\nTarget framework: .NET 7.0\r\nOperating system: macOS\r\nIDE: (Rider 2022.3.2)\r\n","reactions":{"url":"https://api.github.com/repos/dotnet/efcore/issues/30295/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/dotnet/efcore/issues/30295/timeline","performed_via_github_app":null,"state_reason":"duplicate"}},"event":"cross-referenced"},{"actor":{"login":"marinobjelopera26","id":64930112,"node_id":"MDQ6VXNlcjY0OTMwMTEy","avatar_url":"https://avatars.githubusercontent.com/u/64930112?v=4","gravatar_id":"","url":"https://api.github.com/users/marinobjelopera26","html_url":"https://github.com/marinobjelopera26","followers_url":"https://api.github.com/users/marinobjelopera26/followers","following_url":"https://api.github.com/users/marinobjelopera26/following{/other_user}","gists_url":"https://api.github.com/users/marinobjelopera26/gists{/gist_id}","starred_url":"https://api.github.com/users/marinobjelopera26/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marinobjelopera26/subscriptions","organizations_url":"https://api.github.com/users/marinobjelopera26/orgs","repos_url":"https://api.github.com/users/marinobjelopera26/repos","events_url":"https://api.github.com/users/marinobjelopera26/events{/privacy}","received_events_url":"https://api.github.com/users/marinobjelopera26/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-08T09:19:21Z","updated_at":"2023-03-08T09:19:21Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/dotnet/efcore/issues/30203","repository_url":"https://api.github.com/repos/dotnet/efcore","labels_url":"https://api.github.com/repos/dotnet/efcore/issues/30203/labels{/name}","comments_url":"https://api.github.com/repos/dotnet/efcore/issues/30203/comments","events_url":"https://api.github.com/repos/dotnet/efcore/issues/30203/events","html_url":"https://github.com/dotnet/efcore/issues/30203","id":1569797110,"node_id":"I_kwDOAPaMMs5dkTP2","number":30203,"title":"Add-Migration EFCore tool generates NRE for CLR type used both as property on entity A and an owned entity (or collection of) on entity B","user":{"login":"marinobjelopera26","id":64930112,"node_id":"MDQ6VXNlcjY0OTMwMTEy","avatar_url":"https://avatars.githubusercontent.com/u/64930112?v=4","gravatar_id":"","url":"https://api.github.com/users/marinobjelopera26","html_url":"https://github.com/marinobjelopera26","followers_url":"https://api.github.com/users/marinobjelopera26/followers","following_url":"https://api.github.com/users/marinobjelopera26/following{/other_user}","gists_url":"https://api.github.com/users/marinobjelopera26/gists{/gist_id}","starred_url":"https://api.github.com/users/marinobjelopera26/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marinobjelopera26/subscriptions","organizations_url":"https://api.github.com/users/marinobjelopera26/orgs","repos_url":"https://api.github.com/users/marinobjelopera26/repos","events_url":"https://api.github.com/users/marinobjelopera26/events{/privacy}","received_events_url":"https://api.github.com/users/marinobjelopera26/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":936619505,"node_id":"MDU6TGFiZWw5MzY2MTk1MDU=","url":"https://api.github.com/repos/dotnet/efcore/labels/customer-reported","name":"customer-reported","color":"a4a5f9","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":10,"created_at":"2023-02-03T12:52:55Z","updated_at":"2023-03-12T20:36:36Z","closed_at":"2023-02-06T10:33:22Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"repository":{"id":16157746,"node_id":"MDEwOlJlcG9zaXRvcnkxNjE1Nzc0Ng==","name":"efcore","full_name":"dotnet/efcore","private":false,"owner":{"login":"dotnet","id":9141961,"node_id":"MDEyOk9yZ2FuaXphdGlvbjkxNDE5NjE=","avatar_url":"https://avatars.githubusercontent.com/u/9141961?v=4","gravatar_id":"","url":"https://api.github.com/users/dotnet","html_url":"https://github.com/dotnet","followers_url":"https://api.github.com/users/dotnet/followers","following_url":"https://api.github.com/users/dotnet/following{/other_user}","gists_url":"https://api.github.com/users/dotnet/gists{/gist_id}","starred_url":"https://api.github.com/users/dotnet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dotnet/subscriptions","organizations_url":"https://api.github.com/users/dotnet/orgs","repos_url":"https://api.github.com/users/dotnet/repos","events_url":"https://api.github.com/users/dotnet/events{/privacy}","received_events_url":"https://api.github.com/users/dotnet/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/dotnet/efcore","description":"EF Core is a modern object-database mapper for .NET. It supports LINQ queries, change tracking, updates, and schema migrations.","fork":false,"url":"https://api.github.com/repos/dotnet/efcore","forks_url":"https://api.github.com/repos/dotnet/efcore/forks","keys_url":"https://api.github.com/repos/dotnet/efcore/keys{/key_id}","collaborators_url":"https://api.github.com/repos/dotnet/efcore/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/dotnet/efcore/teams","hooks_url":"https://api.github.com/repos/dotnet/efcore/hooks","issue_events_url":"https://api.github.com/repos/dotnet/efcore/issues/events{/number}","events_url":"https://api.github.com/repos/dotnet/efcore/events","assignees_url":"https://api.github.com/repos/dotnet/efcore/assignees{/user}","branches_url":"https://api.github.com/repos/dotnet/efcore/branches{/branch}","tags_url":"https://api.github.com/repos/dotnet/efcore/tags","blobs_url":"https://api.github.com/repos/dotnet/efcore/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/dotnet/efcore/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/dotnet/efcore/git/refs{/sha}","trees_url":"https://api.github.com/repos/dotnet/efcore/git/trees{/sha}","statuses_url":"https://api.github.com/repos/dotnet/efcore/statuses/{sha}","languages_url":"https://api.github.com/repos/dotnet/efcore/languages","stargazers_url":"https://api.github.com/repos/dotnet/efcore/stargazers","contributors_url":"https://api.github.com/repos/dotnet/efcore/contributors","subscribers_url":"https://api.github.com/repos/dotnet/efcore/subscribers","subscription_url":"https://api.github.com/repos/dotnet/efcore/subscription","commits_url":"https://api.github.com/repos/dotnet/efcore/commits{/sha}","git_commits_url":"https://api.github.com/repos/dotnet/efcore/git/commits{/sha}","comments_url":"https://api.github.com/repos/dotnet/efcore/comments{/number}","issue_comment_url":"https://api.github.com/repos/dotnet/efcore/issues/comments{/number}","contents_url":"https://api.github.com/repos/dotnet/efcore/contents/{+path}","compare_url":"https://api.github.com/repos/dotnet/efcore/compare/{base}...{head}","merges_url":"https://api.github.com/repos/dotnet/efcore/merges","archive_url":"https://api.github.com/repos/dotnet/efcore/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/dotnet/efcore/downloads","issues_url":"https://api.github.com/repos/dotnet/efcore/issues{/number}","pulls_url":"https://api.github.com/repos/dotnet/efcore/pulls{/number}","milestones_url":"https://api.github.com/repos/dotnet/efcore/milestones{/number}","notifications_url":"https://api.github.com/repos/dotnet/efcore/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/dotnet/efcore/labels{/name}","releases_url":"https://api.github.com/repos/dotnet/efcore/releases{/id}","deployments_url":"https://api.github.com/repos/dotnet/efcore/deployments","created_at":"2014-01-23T00:52:01Z","updated_at":"2025-11-10T14:21:49Z","pushed_at":"2025-11-10T05:59:58Z","git_url":"git://github.com/dotnet/efcore.git","ssh_url":"git@github.com:dotnet/efcore.git","clone_url":"https://github.com/dotnet/efcore.git","svn_url":"https://github.com/dotnet/efcore","homepage":"https://learn.microsoft.com/ef/","size":215987,"stargazers_count":14455,"watchers_count":14455,"language":"C#","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":3324,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":2430,"license":{"key":"mit","name":"MIT License","spdx_id":"MIT","url":"https://api.github.com/licenses/mit","node_id":"MDc6TGljZW5zZTEz"},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["aspnet-product","c-sharp","database","dotnet-core","dotnet-framework","dotnet-standard","entity-framework","hacktoberfest","orm"],"visibility":"public","forks":3324,"open_issues":2430,"watchers":14455,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"body":"## Description\r\n\r\nI have ran upon an issue with using EF Core tools while invoking `Add-Migration MigrationName`  through the Package Manager Console in Visual Studio 2022, as described below.\r\n\r\nI have a .NET6 solution with webapi as the main, runnable part of the solution. The rest of the solution consists of supporting projects to implement functionalities in an architecture of choice. One of the project contains entities that are persisted in Persistence .NET6 project in an SQL Server instance through EF Core v7.0.0 ORM. I am defining manual configurations for entities by implementing `IEntityConfiguration<T>` interface. \r\n\r\nI have entity class as follows:\r\n```C#\r\n// These two classes are simple value objects containing a single property and static factory functions to instantiate them\r\npublic class ProductId { ... } // contains a Guid value property\r\npublic class ProductIdentifier { ... } // contains a string value property\r\n\r\n// This class should be persisted as an owned entity type as part of the Product entity in Products table\r\npublic class ProductCoreSystem : ValueObject\r\n{\r\n    public string Identifier { get; private set; }\r\n    public string Code { get; private set; }\r\n\r\n    // object instantiation logic\r\n}\r\n\r\npublic sealed class Product \r\n{\r\n    private Product() {  } // empty ctor for EF Core purposes\r\n\r\n    public ProductId Id { get; private set; }\r\n    public ProductIdentifier Identifier { get; private set; }\r\n    public ProductCoreSystem CoreSystem { get; private set; }\r\n\r\n    // ... other Product related logic\r\n}\r\n```\r\n\r\nTo configure this entity persistence to the SQL server, I have the following `IEntityTypeConfiguration` implementation:\r\n```C#\r\npublic class ProductConfigurations : IEntityTypeConfiguration<Product>\r\n{\r\n    public void Configure(EntityTypeBuilder<Product> builder)\r\n    {\r\n        builder.ToTable(\"Products\", schema: \"dbo\");\r\n\r\n        builder.HasKey(p => p.Id);\r\n\r\n        builder.Property(p => p.Id)\r\n            .ValueGeneratedNever() // we are manually generating the ID value\r\n            .HasConversion(\r\n                id => id.Value,\r\n                value => ProductId.Create(value));\r\n\r\n        builder.Property(p => p.Identifier)\r\n            .IsRequired()\r\n            .HasMaxLength(30)\r\n            .HasConversion(\r\n                name => name.Value,\r\n                value => ProductIdentifier.Create(value));\r\n\r\n        builder.OwnsOne(\r\n            p => p.CoreSystem,\r\n            ownedBuilder => \r\n            {\r\n                ownedBuilder.Property(cs => cs.Identifier)\r\n                    .IsRequired()\r\n                    .HasColumnType(\"CHAR(3)\")\r\n                    .HasColumnName(nameof(Product.Identifier));\r\n\r\n                ownedBuilder.Property(cs => cs.Code)\r\n                    .IsRequired()\r\n                    .HasMaxLength(30)\r\n                    .HasColumnName(\"CoreSystemCode\");\r\n            });\r\n    }\r\n}\r\n```\r\nDbContext is set up as follows:\r\n```C#\r\npublic class AppDbContext : DbContext\r\n{\r\n    public AppDbContext(DbContextOptions<AppDbContext> options)\r\n        : base(options)\r\n    {\r\n    }\r\n\r\n    protected override void OnModelCreating(ModelBuilder modelBuilder)\r\n    {\r\n        modelBuilder.ApplyConfigurationsFromAssembly(typeof(AssemblyReference).Assembly);\r\n\r\n        base.OnModelCreating(modelBuilder);\r\n    }\r\n}\r\n```\r\n\r\nAfter invoking `Add-Migration SomeMigrationName` through Visual Studio Package Manager Console, I get a NullReferenceException generated by EF Core as stated below in the Stack trace section. After rename of the `IEntityTypeConfiguration<T>` implementing type from `ProductConfigurations` to let's say, `InsProductConfigurations`, Add-Migration command successfully generates a new migration while nothing of the underlying configuration code has been changed.\r\n\r\nThis issue occurrs when the configured entity contains owned types, either one-to-one owned type or one-to-many list of owned types.\r\n\r\n### Stack trace\r\n```\r\nSystem.Reflection.TargetInvocationException: Exception has been thrown by the target of an invocation.\r\n ---> System.NullReferenceException: Object reference not set to an instance of an object.\r\n   at Microsoft.EntityFrameworkCore.Metadata.Internal.InternalEntityTypeBuilder.CreateForeignKey(InternalEntityTypeBuilder principalEntityTypeBuilder, IReadOnlyList`1 dependentProperties, Key principalKey, String propertyBaseName, Nullable`1 required, ConfigurationSource configurationSource)\r\n   at Microsoft.EntityFrameworkCore.Metadata.Internal.InternalEntityTypeBuilder.HasRelationship(EntityType targetEntityType, Nullable`1 navigationToTarget, Nullable`1 inverseNavigation, Nullable`1 setTargetAsPrincipal, ConfigurationSource configurationSource, Nullable`1 required)\r\n   at Microsoft.EntityFrameworkCore.Metadata.Internal.InternalEntityTypeBuilder.HasOwnership(EntityType targetEntityType, MemberIdentity& navigation, Nullable`1 inverse, ConfigurationSource configurationSource)\r\n   at Microsoft.EntityFrameworkCore.Metadata.Internal.InternalEntityTypeBuilder.Microsoft.EntityFrameworkCore.Metadata.Builders.IConventionEntityTypeBuilder.HasOwnership(IConventionEntityType targetEntityType, MemberInfo navigation, Boolean fromDataAnnotation)\r\n   at Microsoft.EntityFrameworkCore.Metadata.Conventions.RelationshipDiscoveryConvention.CreateRelationships(IEnumerable`1 relationshipCandidates, IConventionEntityTypeBuilder entityTypeBuilder)\r\n   at Microsoft.EntityFrameworkCore.Metadata.Conventions.RelationshipDiscoveryConvention.Process(IConventionEntityType entityType, String navigationName, MemberInfo memberInfo, IConventionContext context)\r\n   at Microsoft.EntityFrameworkCore.Metadata.Conventions.RelationshipDiscoveryConvention.ProcessNavigationRemoved(IConventionEntityTypeBuilder sourceEntityTypeBuilder, IConventionEntityTypeBuilder targetEntityTypeBuilder, String navigationName, MemberInfo memberInfo, IConventionContext`1 context)\r\n   at Microsoft.EntityFrameworkCore.Metadata.Conventions.Internal.ConventionDispatcher.ImmediateConventionScope.OnNavigationRemoved(IConventionEntityTypeBuilder sourceEntityTypeBuilder, IConventionEntityTypeBuilder targetEntityTypeBuilder, String navigationName, MemberInfo memberInfo)\r\n   at Microsoft.EntityFrameworkCore.Metadata.Conventions.Internal.ConventionDispatcher.OnNavigationRemovedNode.Run(ConventionDispatcher dispatcher)\r\n   at Microsoft.EntityFrameworkCore.Metadata.Conventions.Internal.ConventionDispatcher.DelayedConventionScope.Run(ConventionDispatcher dispatcher)\r\n   at Microsoft.EntityFrameworkCore.Metadata.Conventions.Internal.ConventionDispatcher.ConventionBatch.Run()\r\n   at Microsoft.EntityFrameworkCore.Metadata.Conventions.Internal.ConventionDispatcher.ConventionBatch.Dispose()\r\n   at Microsoft.EntityFrameworkCore.Metadata.Builders.EntityTypeBuilder`1.OwnsOneBuilder[TRelatedEntity](TypeIdentity ownedType, MemberIdentity navigation)\r\n   at Microsoft.EntityFrameworkCore.Metadata.Builders.EntityTypeBuilder`1.OwnsOne[TRelatedEntity](Expression`1 navigationExpression, Action`1 buildAction)\r\n   at CustomNamespace.Persistence.ProductConfiguration.Configure(EntityTypeBuilder`1 builder) in C:\\CustomNamespace\\Persistence\\ProductConfiguration.cs:line 27\r\n   at Microsoft.EntityFrameworkCore.ModelBuilder.ApplyConfiguration[TEntity](IEntityTypeConfiguration`1 configuration)\r\n   --- End of inner exception stack trace ---\r\n   at System.RuntimeMethodHandle.InvokeMethod(Object target, Span`1& arguments, Signature sig, Boolean constructor, Boolean wrapExceptions)\r\n   at System.Reflection.RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)\r\n   at Microsoft.EntityFrameworkCore.ModelBuilder.ApplyConfigurationsFromAssembly(Assembly assembly, Func`2 predicate)\r\n   at CustomNamespace.Persistence.DbContext.OnModelCreating(ModelBuilder modelBuilder) in C:\\CustomNamespace\\Persistence\\DbContext.cs:line 16\r\n   at Microsoft.EntityFrameworkCore.Infrastructure.ModelCustomizer.Customize(ModelBuilder modelBuilder, DbContext context)\r\n   at Microsoft.EntityFrameworkCore.Infrastructure.ModelSource.CreateModel(DbContext context, IConventionSetBuilder conventionSetBuilder, ModelDependencies modelDependencies)\r\n   at Microsoft.EntityFrameworkCore.Infrastructure.ModelSource.GetModel(DbContext context, ModelCreationDependencies modelCreationDependencies, Boolean designTime)\r\n   at Microsoft.EntityFrameworkCore.Internal.DbContextServices.CreateModel(Boolean designTime)\r\n   at Microsoft.EntityFrameworkCore.Internal.DbContextServices.get_Model()\r\n   at Microsoft.EntityFrameworkCore.Infrastructure.EntityFrameworkServicesBuilder.<>c.<TryAddCoreServices>b__8_4(IServiceProvider p)\r\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitFactory(FactoryCallSite factoryCallSite, RuntimeResolverContext context)\r\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)\r\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitCache(ServiceCallSite callSite, RuntimeResolverContext context, ServiceProviderEngineScope serviceProviderEngine, RuntimeResolverLock lockType)\r\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitScopeCache(ServiceCallSite callSite, RuntimeResolverContext context)\r\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)\r\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)\r\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)\r\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitCache(ServiceCallSite callSite, RuntimeResolverContext context, ServiceProviderEngineScope serviceProviderEngine, RuntimeResolverLock lockType)\r\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitScopeCache(ServiceCallSite callSite, RuntimeResolverContext context)\r\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)\r\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)\r\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)\r\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitCache(ServiceCallSite callSite, RuntimeResolverContext context, ServiceProviderEngineScope serviceProviderEngine, RuntimeResolverLock lockType)\r\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitScopeCache(ServiceCallSite callSite, RuntimeResolverContext context)\r\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)\r\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)\r\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)\r\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitCache(ServiceCallSite callSite, RuntimeResolverContext context, ServiceProviderEngineScope serviceProviderEngine, RuntimeResolverLock lockType)\r\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitScopeCache(ServiceCallSite callSite, RuntimeResolverContext context)\r\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)\r\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)\r\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)\r\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitCache(ServiceCallSite callSite, RuntimeResolverContext context, ServiceProviderEngineScope serviceProviderEngine, RuntimeResolverLock lockType)\r\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitScopeCache(ServiceCallSite callSite, RuntimeResolverContext context)\r\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)\r\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)\r\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)\r\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitCache(ServiceCallSite callSite, RuntimeResolverContext context, ServiceProviderEngineScope serviceProviderEngine, RuntimeResolverLock lockType)\r\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitScopeCache(ServiceCallSite callSite, RuntimeResolverContext context)\r\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)\r\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.Resolve(ServiceCallSite callSite, ServiceProviderEngineScope scope)\r\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.DynamicServiceProviderEngine.<>c__DisplayClass2_0.<RealizeService>b__0(ServiceProviderEngineScope scope)\r\n   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)\r\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)\r\n   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)\r\n   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)\r\n   at Microsoft.EntityFrameworkCore.DbContext.get_DbContextDependencies()\r\n   at Microsoft.EntityFrameworkCore.DbContext.get_ContextServices()\r\n   at Microsoft.EntityFrameworkCore.DbContext.get_InternalServiceProvider()\r\n   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IInfrastructure<System.IServiceProvider>.get_Instance()\r\n   at Microsoft.EntityFrameworkCore.Infrastructure.Internal.InfrastructureExtensions.GetService[TService](IInfrastructure`1 accessor)\r\n   at Microsoft.EntityFrameworkCore.Infrastructure.AccessorExtensions.GetService[TService](IInfrastructure`1 accessor)\r\n   at Microsoft.EntityFrameworkCore.Design.Internal.DbContextOperations.CreateContext(Func`1 factory)\r\n   at Microsoft.EntityFrameworkCore.Design.Internal.DbContextOperations.CreateContext(String contextType)\r\n   at Microsoft.EntityFrameworkCore.Design.Internal.MigrationsOperations.AddMigration(String name, String outputDir, String contextType, String namespace)\r\n   at Microsoft.EntityFrameworkCore.Design.OperationExecutor.AddMigrationImpl(String name, String outputDir, String contextType, String namespace)\r\n   at Microsoft.EntityFrameworkCore.Design.OperationExecutor.AddMigration.<>c__DisplayClass0_0.<.ctor>b__0()\r\n   at Microsoft.EntityFrameworkCore.Design.OperationExecutor.OperationBase.<>c__DisplayClass3_0`1.<Execute>b__0()\r\n   at Microsoft.EntityFrameworkCore.Design.OperationExecutor.OperationBase.Execute(Action action)\r\nException has been thrown by the target of an invocation.\r\n```\r\n\r\n\r\n### Provider and version information\r\n\r\nEF Core version: v7.0.0.\r\nDatabase provider: Microsoft.EntityFrameworkCore.SqlServer\r\nTarget framework: .NET 6.0\r\nOperating system: Linux\r\nIDE: Visual Studio 2022 17.4.4\r\n","reactions":{"url":"https://api.github.com/repos/dotnet/efcore/issues/30203/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/dotnet/efcore/issues/30203/timeline","performed_via_github_app":null,"state_reason":"not_planned"}},"event":"cross-referenced"},{"id":8705853682,"node_id":"LE_lADOAPaMMs5fpD2CzwAAAAIG6Mjy","url":"https://api.github.com/repos/dotnet/efcore/issues/events/8705853682","actor":{"login":"ajcvickers","id":1430078,"node_id":"MDQ6VXNlcjE0MzAwNzg=","avatar_url":"https://avatars.githubusercontent.com/u/1430078?v=4","gravatar_id":"","url":"https://api.github.com/users/ajcvickers","html_url":"https://github.com/ajcvickers","followers_url":"https://api.github.com/users/ajcvickers/followers","following_url":"https://api.github.com/users/ajcvickers/following{/other_user}","gists_url":"https://api.github.com/users/ajcvickers/gists{/gist_id}","starred_url":"https://api.github.com/users/ajcvickers/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajcvickers/subscriptions","organizations_url":"https://api.github.com/users/ajcvickers/orgs","repos_url":"https://api.github.com/users/ajcvickers/repos","events_url":"https://api.github.com/users/ajcvickers/events{/privacy}","received_events_url":"https://api.github.com/users/ajcvickers/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2023-03-09T10:11:09Z","label":{"name":"type-bug","color":"f7c6c7"},"performed_via_github_app":null},{"id":8705853704,"node_id":"LE_lADOAPaMMs5fpD2CzwAAAAIG6MkI","url":"https://api.github.com/repos/dotnet/efcore/issues/events/8705853704","actor":{"login":"ajcvickers","id":1430078,"node_id":"MDQ6VXNlcjE0MzAwNzg=","avatar_url":"https://avatars.githubusercontent.com/u/1430078?v=4","gravatar_id":"","url":"https://api.github.com/users/ajcvickers","html_url":"https://github.com/ajcvickers","followers_url":"https://api.github.com/users/ajcvickers/followers","following_url":"https://api.github.com/users/ajcvickers/following{/other_user}","gists_url":"https://api.github.com/users/ajcvickers/gists{/gist_id}","starred_url":"https://api.github.com/users/ajcvickers/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajcvickers/subscriptions","organizations_url":"https://api.github.com/users/ajcvickers/orgs","repos_url":"https://api.github.com/users/ajcvickers/repos","events_url":"https://api.github.com/users/ajcvickers/events{/privacy}","received_events_url":"https://api.github.com/users/ajcvickers/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2023-03-09T10:11:09Z","label":{"name":"area-model-building","color":"32b37b"},"performed_via_github_app":null},{"id":8705855133,"node_id":"LE_lADOAPaMMs5fpD2CzwAAAAIG6M6d","url":"https://api.github.com/repos/dotnet/efcore/issues/events/8705855133","actor":{"login":"ajcvickers","id":1430078,"node_id":"MDQ6VXNlcjE0MzAwNzg=","avatar_url":"https://avatars.githubusercontent.com/u/1430078?v=4","gravatar_id":"","url":"https://api.github.com/users/ajcvickers","html_url":"https://github.com/ajcvickers","followers_url":"https://api.github.com/users/ajcvickers/followers","following_url":"https://api.github.com/users/ajcvickers/following{/other_user}","gists_url":"https://api.github.com/users/ajcvickers/gists{/gist_id}","starred_url":"https://api.github.com/users/ajcvickers/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajcvickers/subscriptions","organizations_url":"https://api.github.com/users/ajcvickers/orgs","repos_url":"https://api.github.com/users/ajcvickers/repos","events_url":"https://api.github.com/users/ajcvickers/events{/privacy}","received_events_url":"https://api.github.com/users/ajcvickers/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2023-03-09T10:11:17Z","label":{"name":"consider-for-current-release","color":"fef2c0"},"performed_via_github_app":null},{"id":8705856389,"node_id":"MIE_lADOAPaMMs5fpD2CzwAAAAIG6NOF","url":"https://api.github.com/repos/dotnet/efcore/issues/events/8705856389","actor":{"login":"ajcvickers","id":1430078,"node_id":"MDQ6VXNlcjE0MzAwNzg=","avatar_url":"https://avatars.githubusercontent.com/u/1430078?v=4","gravatar_id":"","url":"https://api.github.com/users/ajcvickers","html_url":"https://github.com/ajcvickers","followers_url":"https://api.github.com/users/ajcvickers/followers","following_url":"https://api.github.com/users/ajcvickers/following{/other_user}","gists_url":"https://api.github.com/users/ajcvickers/gists{/gist_id}","starred_url":"https://api.github.com/users/ajcvickers/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajcvickers/subscriptions","organizations_url":"https://api.github.com/users/ajcvickers/orgs","repos_url":"https://api.github.com/users/ajcvickers/repos","events_url":"https://api.github.com/users/ajcvickers/events{/privacy}","received_events_url":"https://api.github.com/users/ajcvickers/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"milestoned","commit_id":null,"commit_url":null,"created_at":"2023-03-09T10:11:24Z","milestone":{"title":"Backlog"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/dotnet/efcore/issues/comments/1475186706","html_url":"https://github.com/dotnet/efcore/issues/30373#issuecomment-1475186706","issue_url":"https://api.github.com/repos/dotnet/efcore/issues/30373","id":1475186706,"node_id":"IC_kwDOAPaMMs5X7ZAS","user":{"login":"stephtr","id":5764184,"node_id":"MDQ6VXNlcjU3NjQxODQ=","avatar_url":"https://avatars.githubusercontent.com/u/5764184?v=4","gravatar_id":"","url":"https://api.github.com/users/stephtr","html_url":"https://github.com/stephtr","followers_url":"https://api.github.com/users/stephtr/followers","following_url":"https://api.github.com/users/stephtr/following{/other_user}","gists_url":"https://api.github.com/users/stephtr/gists{/gist_id}","starred_url":"https://api.github.com/users/stephtr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stephtr/subscriptions","organizations_url":"https://api.github.com/users/stephtr/orgs","repos_url":"https://api.github.com/users/stephtr/repos","events_url":"https://api.github.com/users/stephtr/events{/privacy}","received_events_url":"https://api.github.com/users/stephtr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-19T10:01:52Z","updated_at":"2023-03-19T10:01:52Z","body":"Just for your information, I also ran into this error with the following code and SqLite:\r\n`modelBuilder.Entity<Parent>().OwnsMany(q => q.ChildItem, options => options.ToJson());`\r\nIf I just use `modelBuilder.Entity<Parent>().OwnsMany(q => q.ChildItem);` it worked.\r\nI could also provide a sample project, if that would help.","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/dotnet/efcore/issues/comments/1475186706/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"stephtr","id":5764184,"node_id":"MDQ6VXNlcjU3NjQxODQ=","avatar_url":"https://avatars.githubusercontent.com/u/5764184?v=4","gravatar_id":"","url":"https://api.github.com/users/stephtr","html_url":"https://github.com/stephtr","followers_url":"https://api.github.com/users/stephtr/followers","following_url":"https://api.github.com/users/stephtr/following{/other_user}","gists_url":"https://api.github.com/users/stephtr/gists{/gist_id}","starred_url":"https://api.github.com/users/stephtr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stephtr/subscriptions","organizations_url":"https://api.github.com/users/stephtr/orgs","repos_url":"https://api.github.com/users/stephtr/repos","events_url":"https://api.github.com/users/stephtr/events{/privacy}","received_events_url":"https://api.github.com/users/stephtr/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":8858203988,"node_id":"AE_lADOAPaMMs5fpD2CzwAAAAIP_XdU","url":"https://api.github.com/repos/dotnet/efcore/issues/events/8858203988","actor":{"login":"ajcvickers","id":1430078,"node_id":"MDQ6VXNlcjE0MzAwNzg=","avatar_url":"https://avatars.githubusercontent.com/u/1430078?v=4","gravatar_id":"","url":"https://api.github.com/users/ajcvickers","html_url":"https://github.com/ajcvickers","followers_url":"https://api.github.com/users/ajcvickers/followers","following_url":"https://api.github.com/users/ajcvickers/following{/other_user}","gists_url":"https://api.github.com/users/ajcvickers/gists{/gist_id}","starred_url":"https://api.github.com/users/ajcvickers/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajcvickers/subscriptions","organizations_url":"https://api.github.com/users/ajcvickers/orgs","repos_url":"https://api.github.com/users/ajcvickers/repos","events_url":"https://api.github.com/users/ajcvickers/events{/privacy}","received_events_url":"https://api.github.com/users/ajcvickers/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"assigned","commit_id":null,"commit_url":null,"created_at":"2023-03-27T20:31:37Z","assignee":{"login":"ajcvickers","id":1430078,"node_id":"MDQ6VXNlcjE0MzAwNzg=","avatar_url":"https://avatars.githubusercontent.com/u/1430078?v=4","gravatar_id":"","url":"https://api.github.com/users/ajcvickers","html_url":"https://github.com/ajcvickers","followers_url":"https://api.github.com/users/ajcvickers/followers","following_url":"https://api.github.com/users/ajcvickers/following{/other_user}","gists_url":"https://api.github.com/users/ajcvickers/gists{/gist_id}","starred_url":"https://api.github.com/users/ajcvickers/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajcvickers/subscriptions","organizations_url":"https://api.github.com/users/ajcvickers/orgs","repos_url":"https://api.github.com/users/ajcvickers/repos","events_url":"https://api.github.com/users/ajcvickers/events{/privacy}","received_events_url":"https://api.github.com/users/ajcvickers/received_events","type":"User","user_view_type":"public","site_admin":false},"performed_via_github_app":null},{"actor":{"login":"vflame","id":12207061,"node_id":"MDQ6VXNlcjEyMjA3MDYx","avatar_url":"https://avatars.githubusercontent.com/u/12207061?v=4","gravatar_id":"","url":"https://api.github.com/users/vflame","html_url":"https://github.com/vflame","followers_url":"https://api.github.com/users/vflame/followers","following_url":"https://api.github.com/users/vflame/following{/other_user}","gists_url":"https://api.github.com/users/vflame/gists{/gist_id}","starred_url":"https://api.github.com/users/vflame/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vflame/subscriptions","organizations_url":"https://api.github.com/users/vflame/orgs","repos_url":"https://api.github.com/users/vflame/repos","events_url":"https://api.github.com/users/vflame/events{/privacy}","received_events_url":"https://api.github.com/users/vflame/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-04T19:48:20Z","updated_at":"2023-04-04T19:48:20Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/dotnet/efcore/issues/30629","repository_url":"https://api.github.com/repos/dotnet/efcore","labels_url":"https://api.github.com/repos/dotnet/efcore/issues/30629/labels{/name}","comments_url":"https://api.github.com/repos/dotnet/efcore/issues/30629/comments","events_url":"https://api.github.com/repos/dotnet/efcore/issues/30629/events","html_url":"https://github.com/dotnet/efcore/issues/30629","id":1654478357,"node_id":"I_kwDOAPaMMs5inVYV","number":30629,"title":"NullReferenceException when a hierarchy has OwnedEntity","user":{"login":"vflame","id":12207061,"node_id":"MDQ6VXNlcjEyMjA3MDYx","avatar_url":"https://avatars.githubusercontent.com/u/12207061?v=4","gravatar_id":"","url":"https://api.github.com/users/vflame","html_url":"https://github.com/vflame","followers_url":"https://api.github.com/users/vflame/followers","following_url":"https://api.github.com/users/vflame/following{/other_user}","gists_url":"https://api.github.com/users/vflame/gists{/gist_id}","starred_url":"https://api.github.com/users/vflame/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vflame/subscriptions","organizations_url":"https://api.github.com/users/vflame/orgs","repos_url":"https://api.github.com/users/vflame/repos","events_url":"https://api.github.com/users/vflame/events{/privacy}","received_events_url":"https://api.github.com/users/vflame/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":936619505,"node_id":"MDU6TGFiZWw5MzY2MTk1MDU=","url":"https://api.github.com/repos/dotnet/efcore/labels/customer-reported","name":"customer-reported","color":"a4a5f9","default":false,"description":""},{"id":1675384372,"node_id":"MDU6TGFiZWwxNjc1Mzg0Mzcy","url":"https://api.github.com/repos/dotnet/efcore/labels/area-query","name":"area-query","color":"32b37b","default":false,"description":""}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/dotnet/efcore/milestones/2","html_url":"https://github.com/dotnet/efcore/milestone/2","labels_url":"https://api.github.com/repos/dotnet/efcore/milestones/2/labels","id":648040,"node_id":"MDk6TWlsZXN0b25lNjQ4MDQw","number":2,"title":"Backlog","description":"Issues that have been approved but are not scheduled a specific release.","creator":{"login":"bricelam","id":1226749,"node_id":"MDQ6VXNlcjEyMjY3NDk=","avatar_url":"https://avatars.githubusercontent.com/u/1226749?v=4","gravatar_id":"","url":"https://api.github.com/users/bricelam","html_url":"https://github.com/bricelam","followers_url":"https://api.github.com/users/bricelam/followers","following_url":"https://api.github.com/users/bricelam/following{/other_user}","gists_url":"https://api.github.com/users/bricelam/gists{/gist_id}","starred_url":"https://api.github.com/users/bricelam/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bricelam/subscriptions","organizations_url":"https://api.github.com/users/bricelam/orgs","repos_url":"https://api.github.com/users/bricelam/repos","events_url":"https://api.github.com/users/bricelam/events{/privacy}","received_events_url":"https://api.github.com/users/bricelam/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":2157,"closed_issues":10,"state":"open","created_at":"2014-05-03T18:58:28Z","updated_at":"2025-11-07T08:33:50Z","due_on":null,"closed_at":null},"comments":2,"created_at":"2023-04-04T19:48:20Z","updated_at":"2025-06-15T19:01:19Z","closed_at":null,"author_association":"NONE","type":{"id":1092402,"node_id":"IT_kwDOAIt-yc4AEKsy","name":"Bug","description":"An unexpected problem or behavior","color":"red","created_at":"2024-01-25T11:45:43Z","updated_at":"2024-07-26T10:20:14Z","is_enabled":true},"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"repository":{"id":16157746,"node_id":"MDEwOlJlcG9zaXRvcnkxNjE1Nzc0Ng==","name":"efcore","full_name":"dotnet/efcore","private":false,"owner":{"login":"dotnet","id":9141961,"node_id":"MDEyOk9yZ2FuaXphdGlvbjkxNDE5NjE=","avatar_url":"https://avatars.githubusercontent.com/u/9141961?v=4","gravatar_id":"","url":"https://api.github.com/users/dotnet","html_url":"https://github.com/dotnet","followers_url":"https://api.github.com/users/dotnet/followers","following_url":"https://api.github.com/users/dotnet/following{/other_user}","gists_url":"https://api.github.com/users/dotnet/gists{/gist_id}","starred_url":"https://api.github.com/users/dotnet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dotnet/subscriptions","organizations_url":"https://api.github.com/users/dotnet/orgs","repos_url":"https://api.github.com/users/dotnet/repos","events_url":"https://api.github.com/users/dotnet/events{/privacy}","received_events_url":"https://api.github.com/users/dotnet/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/dotnet/efcore","description":"EF Core is a modern object-database mapper for .NET. It supports LINQ queries, change tracking, updates, and schema migrations.","fork":false,"url":"https://api.github.com/repos/dotnet/efcore","forks_url":"https://api.github.com/repos/dotnet/efcore/forks","keys_url":"https://api.github.com/repos/dotnet/efcore/keys{/key_id}","collaborators_url":"https://api.github.com/repos/dotnet/efcore/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/dotnet/efcore/teams","hooks_url":"https://api.github.com/repos/dotnet/efcore/hooks","issue_events_url":"https://api.github.com/repos/dotnet/efcore/issues/events{/number}","events_url":"https://api.github.com/repos/dotnet/efcore/events","assignees_url":"https://api.github.com/repos/dotnet/efcore/assignees{/user}","branches_url":"https://api.github.com/repos/dotnet/efcore/branches{/branch}","tags_url":"https://api.github.com/repos/dotnet/efcore/tags","blobs_url":"https://api.github.com/repos/dotnet/efcore/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/dotnet/efcore/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/dotnet/efcore/git/refs{/sha}","trees_url":"https://api.github.com/repos/dotnet/efcore/git/trees{/sha}","statuses_url":"https://api.github.com/repos/dotnet/efcore/statuses/{sha}","languages_url":"https://api.github.com/repos/dotnet/efcore/languages","stargazers_url":"https://api.github.com/repos/dotnet/efcore/stargazers","contributors_url":"https://api.github.com/repos/dotnet/efcore/contributors","subscribers_url":"https://api.github.com/repos/dotnet/efcore/subscribers","subscription_url":"https://api.github.com/repos/dotnet/efcore/subscription","commits_url":"https://api.github.com/repos/dotnet/efcore/commits{/sha}","git_commits_url":"https://api.github.com/repos/dotnet/efcore/git/commits{/sha}","comments_url":"https://api.github.com/repos/dotnet/efcore/comments{/number}","issue_comment_url":"https://api.github.com/repos/dotnet/efcore/issues/comments{/number}","contents_url":"https://api.github.com/repos/dotnet/efcore/contents/{+path}","compare_url":"https://api.github.com/repos/dotnet/efcore/compare/{base}...{head}","merges_url":"https://api.github.com/repos/dotnet/efcore/merges","archive_url":"https://api.github.com/repos/dotnet/efcore/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/dotnet/efcore/downloads","issues_url":"https://api.github.com/repos/dotnet/efcore/issues{/number}","pulls_url":"https://api.github.com/repos/dotnet/efcore/pulls{/number}","milestones_url":"https://api.github.com/repos/dotnet/efcore/milestones{/number}","notifications_url":"https://api.github.com/repos/dotnet/efcore/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/dotnet/efcore/labels{/name}","releases_url":"https://api.github.com/repos/dotnet/efcore/releases{/id}","deployments_url":"https://api.github.com/repos/dotnet/efcore/deployments","created_at":"2014-01-23T00:52:01Z","updated_at":"2025-11-10T14:21:49Z","pushed_at":"2025-11-10T05:59:58Z","git_url":"git://github.com/dotnet/efcore.git","ssh_url":"git@github.com:dotnet/efcore.git","clone_url":"https://github.com/dotnet/efcore.git","svn_url":"https://github.com/dotnet/efcore","homepage":"https://learn.microsoft.com/ef/","size":215987,"stargazers_count":14455,"watchers_count":14455,"language":"C#","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":3324,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":2430,"license":{"key":"mit","name":"MIT License","spdx_id":"MIT","url":"https://api.github.com/licenses/mit","node_id":"MDc6TGljZW5zZTEz"},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["aspnet-product","c-sharp","database","dotnet-core","dotnet-framework","dotnet-standard","entity-framework","hacktoberfest","orm"],"visibility":"public","forks":3324,"open_issues":2430,"watchers":14455,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"body":"## File a bug\r\n\r\nNullReferenceException thrown when entity hierarchy has owned entity when performing select projection. Not sure if related to: https://github.com/dotnet/efcore/issues/30107 and https://github.com/dotnet/efcore/issues/30373\r\n\r\nCan provide repro project if needed\r\n\r\n### Include your code\r\n\r\nEntities/Configs\r\n```c#\r\n public record OwnedEntity\r\n    {\r\n        public string Mode { get; private set; }\r\n    }\r\n    public class ConcreteWithOwned : BaseEntity\r\n    {\r\n        private class ConcreteWithOwnedConfig : IEntityTypeConfiguration<ConcreteWithOwned>\r\n        {\r\n            public void Configure(EntityTypeBuilder<ConcreteWithOwned> builder)\r\n            {\r\n                builder.OwnsOne(p => p.Owned, c =>\r\n                {\r\n                });\r\n            }\r\n        }\r\n\r\n        public OwnedEntity Owned { get; set; }\r\n    }\r\n    public abstract class BaseEntity\r\n    {\r\n        private class BaseEntityEFConfiguration : IEntityTypeConfiguration<BaseEntity>\r\n        {\r\n            public void Configure(EntityTypeBuilder<BaseEntity> builder)\r\n            {\r\n            }\r\n        }\r\n\r\n        public string Id { get; init; } = Guid.NewGuid().ToString();\r\n\r\n        public ComputedResult ComputeReturnNull()\r\n        {\r\n            return null;\r\n        }\r\n\r\n        public ComputedResult ComputeReturnValue()\r\n        {\r\n            return new();\r\n        }\r\n    }\r\n    public class ComputedResult\r\n    {\r\n        public string Value { get; set; } = \"VALUE\";\r\n    }\r\n\r\n    public class ConcreteEntity : BaseEntity\r\n    {\r\n        private class ConcreteEntityEFConfiguration : IEntityTypeConfiguration<ConcreteEntity>\r\n        {\r\n            public void Configure(EntityTypeBuilder<ConcreteEntity> builder)\r\n            {\r\n               \r\n            }\r\n        }\r\n    }\r\n```\r\n\r\n```c#\r\nvar entity1 = new ConcreteWithOwned();\r\nvar entity2 = new ConcreteEntity();\r\n\r\n\r\ndbcontext.Add(entity1);\r\ndbcontext.Add(entity2);\r\n\r\ndbcontext.SaveChanges();\r\ndbcontext.ChangeTracker.Clear();\r\n\r\n\r\n//concrete without owned projection\r\nvar x3 = dbcontext.Set<ConcreteEntity>()\r\n           .Select(p => new\r\n           {\r\n               Computed1 = p.ComputeReturnValue() == null ? null : p.ComputeReturnValue().Value, //does not throw\r\n               Computed2 = p.ComputeReturnNull() == null ? null : p.ComputeReturnNull().Value, //does not throw\r\n           }).ToList();\r\n\r\n//concrete with owned projection throws NRE\r\nvar x1 = dbcontext.Set<ConcreteWithOwned>()\r\n           .Select(p => new\r\n           {\r\n               Computed1 = p.ComputeReturnValue() == null ? null : p.ComputeReturnValue().Value, //does not throw with non-null return\r\n               Computed2 = p.ComputeReturnNull() == null ? null : p.ComputeReturnNull().Value,  //NRE thrown when return is null\r\n           }).ToList();\r\n\r\n//base projection throws NRE\r\nvar x2 = dbcontext.Set<BaseEntity>()\r\n           .Select(p => new\r\n           {\r\n               Computed1 = p.ComputeReturnValue() == null ? null : p.ComputeReturnValue().Value, //does not throw with non-null return\r\n               Computed2 = p.ComputeReturnNull() == null ? null : p.ComputeReturnNull().Value, //NRE thrown when return is null\r\n           }).ToList();\r\n```\r\n\r\n\r\n### Include provider and version information\r\n\r\nEF Core version: 7.0.4\r\nDatabase provider: Microsoft.EntityFrameworkCore.SqlServer & Npgsql\r\nTarget framework: .NET 7.0\r\nOperating system: WIN10\r\nIDE: Visual Studio 2022\r\n","reactions":{"url":"https://api.github.com/repos/dotnet/efcore/issues/30629/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/dotnet/efcore/issues/30629/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"actor":{"login":"ajcvickers","id":1430078,"node_id":"MDQ6VXNlcjE0MzAwNzg=","avatar_url":"https://avatars.githubusercontent.com/u/1430078?v=4","gravatar_id":"","url":"https://api.github.com/users/ajcvickers","html_url":"https://github.com/ajcvickers","followers_url":"https://api.github.com/users/ajcvickers/followers","following_url":"https://api.github.com/users/ajcvickers/following{/other_user}","gists_url":"https://api.github.com/users/ajcvickers/gists{/gist_id}","starred_url":"https://api.github.com/users/ajcvickers/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajcvickers/subscriptions","organizations_url":"https://api.github.com/users/ajcvickers/orgs","repos_url":"https://api.github.com/users/ajcvickers/repos","events_url":"https://api.github.com/users/ajcvickers/events{/privacy}","received_events_url":"https://api.github.com/users/ajcvickers/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-07T15:48:39Z","updated_at":"2023-04-07T15:48:39Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/dotnet/efcore/issues/30639","repository_url":"https://api.github.com/repos/dotnet/efcore","labels_url":"https://api.github.com/repos/dotnet/efcore/issues/30639/labels{/name}","comments_url":"https://api.github.com/repos/dotnet/efcore/issues/30639/comments","events_url":"https://api.github.com/repos/dotnet/efcore/issues/30639/events","html_url":"https://github.com/dotnet/efcore/issues/30639","id":1656296509,"node_id":"I_kwDOAPaMMs5iuRQ9","number":30639,"title":"EF Core adding a migration exception using DDD and value objects","user":{"login":"rizkengin","id":53193167,"node_id":"MDQ6VXNlcjUzMTkzMTY3","avatar_url":"https://avatars.githubusercontent.com/u/53193167?v=4","gravatar_id":"","url":"https://api.github.com/users/rizkengin","html_url":"https://github.com/rizkengin","followers_url":"https://api.github.com/users/rizkengin/followers","following_url":"https://api.github.com/users/rizkengin/following{/other_user}","gists_url":"https://api.github.com/users/rizkengin/gists{/gist_id}","starred_url":"https://api.github.com/users/rizkengin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rizkengin/subscriptions","organizations_url":"https://api.github.com/users/rizkengin/orgs","repos_url":"https://api.github.com/users/rizkengin/repos","events_url":"https://api.github.com/users/rizkengin/events{/privacy}","received_events_url":"https://api.github.com/users/rizkengin/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":936619505,"node_id":"MDU6TGFiZWw5MzY2MTk1MDU=","url":"https://api.github.com/repos/dotnet/efcore/labels/customer-reported","name":"customer-reported","color":"a4a5f9","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2023-04-05T21:07:17Z","updated_at":"2025-06-16T08:59:38Z","closed_at":"2023-04-11T11:00:47Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"repository":{"id":16157746,"node_id":"MDEwOlJlcG9zaXRvcnkxNjE1Nzc0Ng==","name":"efcore","full_name":"dotnet/efcore","private":false,"owner":{"login":"dotnet","id":9141961,"node_id":"MDEyOk9yZ2FuaXphdGlvbjkxNDE5NjE=","avatar_url":"https://avatars.githubusercontent.com/u/9141961?v=4","gravatar_id":"","url":"https://api.github.com/users/dotnet","html_url":"https://github.com/dotnet","followers_url":"https://api.github.com/users/dotnet/followers","following_url":"https://api.github.com/users/dotnet/following{/other_user}","gists_url":"https://api.github.com/users/dotnet/gists{/gist_id}","starred_url":"https://api.github.com/users/dotnet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dotnet/subscriptions","organizations_url":"https://api.github.com/users/dotnet/orgs","repos_url":"https://api.github.com/users/dotnet/repos","events_url":"https://api.github.com/users/dotnet/events{/privacy}","received_events_url":"https://api.github.com/users/dotnet/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/dotnet/efcore","description":"EF Core is a modern object-database mapper for .NET. It supports LINQ queries, change tracking, updates, and schema migrations.","fork":false,"url":"https://api.github.com/repos/dotnet/efcore","forks_url":"https://api.github.com/repos/dotnet/efcore/forks","keys_url":"https://api.github.com/repos/dotnet/efcore/keys{/key_id}","collaborators_url":"https://api.github.com/repos/dotnet/efcore/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/dotnet/efcore/teams","hooks_url":"https://api.github.com/repos/dotnet/efcore/hooks","issue_events_url":"https://api.github.com/repos/dotnet/efcore/issues/events{/number}","events_url":"https://api.github.com/repos/dotnet/efcore/events","assignees_url":"https://api.github.com/repos/dotnet/efcore/assignees{/user}","branches_url":"https://api.github.com/repos/dotnet/efcore/branches{/branch}","tags_url":"https://api.github.com/repos/dotnet/efcore/tags","blobs_url":"https://api.github.com/repos/dotnet/efcore/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/dotnet/efcore/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/dotnet/efcore/git/refs{/sha}","trees_url":"https://api.github.com/repos/dotnet/efcore/git/trees{/sha}","statuses_url":"https://api.github.com/repos/dotnet/efcore/statuses/{sha}","languages_url":"https://api.github.com/repos/dotnet/efcore/languages","stargazers_url":"https://api.github.com/repos/dotnet/efcore/stargazers","contributors_url":"https://api.github.com/repos/dotnet/efcore/contributors","subscribers_url":"https://api.github.com/repos/dotnet/efcore/subscribers","subscription_url":"https://api.github.com/repos/dotnet/efcore/subscription","commits_url":"https://api.github.com/repos/dotnet/efcore/commits{/sha}","git_commits_url":"https://api.github.com/repos/dotnet/efcore/git/commits{/sha}","comments_url":"https://api.github.com/repos/dotnet/efcore/comments{/number}","issue_comment_url":"https://api.github.com/repos/dotnet/efcore/issues/comments{/number}","contents_url":"https://api.github.com/repos/dotnet/efcore/contents/{+path}","compare_url":"https://api.github.com/repos/dotnet/efcore/compare/{base}...{head}","merges_url":"https://api.github.com/repos/dotnet/efcore/merges","archive_url":"https://api.github.com/repos/dotnet/efcore/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/dotnet/efcore/downloads","issues_url":"https://api.github.com/repos/dotnet/efcore/issues{/number}","pulls_url":"https://api.github.com/repos/dotnet/efcore/pulls{/number}","milestones_url":"https://api.github.com/repos/dotnet/efcore/milestones{/number}","notifications_url":"https://api.github.com/repos/dotnet/efcore/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/dotnet/efcore/labels{/name}","releases_url":"https://api.github.com/repos/dotnet/efcore/releases{/id}","deployments_url":"https://api.github.com/repos/dotnet/efcore/deployments","created_at":"2014-01-23T00:52:01Z","updated_at":"2025-11-10T14:21:49Z","pushed_at":"2025-11-10T05:59:58Z","git_url":"git://github.com/dotnet/efcore.git","ssh_url":"git@github.com:dotnet/efcore.git","clone_url":"https://github.com/dotnet/efcore.git","svn_url":"https://github.com/dotnet/efcore","homepage":"https://learn.microsoft.com/ef/","size":215987,"stargazers_count":14455,"watchers_count":14455,"language":"C#","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":3324,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":2430,"license":{"key":"mit","name":"MIT License","spdx_id":"MIT","url":"https://api.github.com/licenses/mit","node_id":"MDc6TGljZW5zZTEz"},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["aspnet-product","c-sharp","database","dotnet-core","dotnet-framework","dotnet-standard","entity-framework","hacktoberfest","orm"],"visibility":"public","forks":3324,"open_issues":2430,"watchers":14455,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"body":" I'm facing a very annoying issue with my application whenever I try to add a new migration using ef core I get a System.Reflection.TargetInvocationException: Exception has been thrown by the target of an invocation.\r\n\r\nI tried everything I can think of but nothing seems to solve this issue, I have a user aggregate and a discipline aggregate I need to map to the database using fluent api, What I'm trying to do is make the user own many discplineIds and the discipline own many userIds \r\n\r\nThis is the User Aggregate class\r\n\r\n```\r\npublic sealed class User : AggregateRoot<UserId>\r\n{\r\n    private readonly List<UserRefreshToken> _refreshTokens = new();\r\n    private readonly List<UserCheckLog> _checkLogs = new();\r\n    private readonly List<UserNotification> _notifications = new();\r\n    private readonly List<ProjectLogId> _projectLogsIds = new();\r\n    private readonly List<DisciplineId> _disciplineIds = new();\r\n\r\n\r\n    private User(\r\n        UserId userId,\r\n        string firstName,\r\n        string lastName,\r\n        string email,\r\n        string password,\r\n        Role role,\r\n        CurrentState currentState,\r\n        int overTimeCount,\r\n        double weeklyWorkedHours,\r\n        bool isLocked,\r\n        List<string> lockoutReasons,\r\n        Uri? profilePictureUrl,\r\n        List<string> fcmTokens,\r\n        DateTime createdAt,\r\n        DateTime updatedAt)\r\n        : base(userId)\r\n    {\r\n        FirstName = firstName;\r\n        LastName = lastName;\r\n        Email = email;\r\n        Password = password;\r\n        Role = role;\r\n        CurrentState = currentState;\r\n        OverTimeCount = overTimeCount;\r\n        WeeklyWorkedHours = weeklyWorkedHours;\r\n        IsLocked = isLocked;\r\n        LockoutReasons = lockoutReasons;\r\n        ProfilePictureUrl = profilePictureUrl;\r\n        FcmTokens = fcmTokens;\r\n    }\r\n\r\n    public static User Create(\r\n        string firstName,\r\n        string lastName,\r\n        string email,\r\n        string password,\r\n        int overTimeCount,\r\n        Uri? profilePictureUrl = null) => new(UserId.CreateUnique(), firstName, lastName, email, password, Role.User, CurrentState.LoggedOut, overTimeCount, 0, true, new(), profilePictureUrl, new(), DateTime.UtcNow, DateTime.UtcNow);\r\n\r\n    public string FirstName { get; private set; }\r\n    public string LastName { get; private set; }\r\n    public string Email { get; private set; }\r\n    public string Password { get; private set; }\r\n    public Role Role { get; private set; }\r\n    public CurrentState CurrentState { get; private set; }\r\n    public int OverTimeCount { get; private set; }\r\n    public double WeeklyWorkedHours { get; private set; }\r\n    public bool IsLocked { get; private set; }\r\n    public List<string> LockoutReasons { get; private set; }\r\n    public Uri? ProfilePictureUrl { get; private set; }\r\n    public List<string> FcmTokens { get; private set; }\r\n    public DateTime CreatedAt { get; private set; }\r\n    public DateTime UpdatedAt { get; private set; }\r\n\r\n\r\n    public IReadOnlyList<UserRefreshToken> RefreshTokens => _refreshTokens.AsReadOnly();\r\n    public IReadOnlyList<UserCheckLog> CheckLogs => _checkLogs.AsReadOnly();\r\n    public IReadOnlyList<UserNotification> Notifications => _notifications.AsReadOnly();\r\n    public IReadOnlyList<ProjectLogId> ProjectLogsIds => _projectLogsIds.AsReadOnly();\r\n    public IReadOnlyList<DisciplineId> DisciplineIds => _disciplineIds.AsReadOnly();\r\n\r\n\r\n\r\n    #pragma warning disable CS8618 \r\n    private User()\r\n    {\r\n\r\n    }\r\n    #pragma warning restore CS8618\r\n}\r\n```\r\n\r\nand this is the Discipline Aggregate class\r\n\r\n```\r\npublic sealed class Discipline : AggregateRoot<DisciplineId>\r\n{\r\n    private readonly List<UserId> _usersIds = new();\r\n\r\n    private Discipline(\r\n        DisciplineId disciplineId,\r\n        string name)\r\n        : base(disciplineId)\r\n    {\r\n        Name = name;\r\n    }\r\n    public string Name { get; private set; }\r\n    public IReadOnlyList<UserId> UsersIds => _usersIds.AsReadOnly();\r\n\r\n\r\n    #pragma warning disable CS8618 \r\n    private Discipline()\r\n    {\r\n\r\n    }\r\n    #pragma warning restore CS8618\r\n}\r\n```\r\n\r\nI'm using strongly typed Ids for both \r\n\r\n```\r\npublic sealed class UserId : ValueObject\r\n{\r\n    public Guid Value { get; private set; }\r\n\r\n    private UserId(Guid value)\r\n    {\r\n        Value = value;\r\n    }\r\n\r\n    public static UserId Create(Guid value) => new UserId(value);\r\n    public static UserId CreateUnique() => new UserId(Guid.NewGuid());\r\n\r\n    protected override IEnumerable<object> GetEqualityComponents()\r\n    {\r\n        yield return Value;\r\n    }\r\n}\r\n```\r\n\r\n```\r\npublic sealed class DisciplineId : ValueObject\r\n{\r\n    public Guid Value { get; private set; }\r\n\r\n    private DisciplineId(Guid value)\r\n    {\r\n        Value = value;\r\n    }\r\n\r\n    public static DisciplineId Create(Guid value) => new(value);\r\n    public static DisciplineId CreateUnique() => new(Guid.NewGuid());\r\n\r\n    protected override IEnumerable<object> GetEqualityComponents()\r\n    {\r\n        yield return Value;\r\n    }\r\n}\r\n```\r\n\r\nand this is the fluent api config for both\r\n\r\n```\r\npublic class UserConfigurations : IEntityTypeConfiguration<User>\r\n{\r\n    public void Configure(EntityTypeBuilder<User> builder)\r\n    {\r\n        ConfigureUserTable(builder);\r\n        ConfigureUserRefreshTokensTable(builder);\r\n        ConfigureUserCheckLogsTable(builder);\r\n        ConfigureUserNotificationsTable(builder);\r\n        ConfigureUserProjectLogsIdsTable(builder);\r\n        configureUserDisciplineIdsTable(builder);\r\n    }\r\n\r\n    private void configureUserDisciplineIdsTable(EntityTypeBuilder<User> builder)\r\n    {\r\n        builder.OwnsMany(u => u.DisciplineIds, dib =>\r\n        {\r\n            dib.ToTable(\"UserDisciplineIds\");\r\n\r\n            dib.WithOwner().HasForeignKey(\"UserId\");\r\n\r\n            dib.HasKey(\"Id\");\r\n\r\n            dib.Property(di => di.Value)\r\n                .HasColumnName(\"DisciplineId\")\r\n                .ValueGeneratedNever();\r\n        });\r\n\r\n        \r\n\r\n        builder.Metadata.FindNavigation(nameof(User.DisciplineIds))!.SetPropertyAccessMode(PropertyAccessMode.Field);\r\n    }\r\n\r\n    private void ConfigureUserProjectLogsIdsTable(EntityTypeBuilder<User> builder)\r\n    {\r\n        builder.OwnsMany(u => u.ProjectLogsIds, plb =>\r\n        {\r\n            plb.ToTable(\"UserProjectLogsIds\");\r\n\r\n            plb.WithOwner().HasForeignKey(\"UserId\");\r\n\r\n            plb.HasKey(\"Id\");\r\n\r\n            plb.Property(pl => pl.Value)\r\n                .HasColumnName(\"ProjectLogId\")\r\n                .ValueGeneratedNever();\r\n        });\r\n\r\n        builder.Metadata.FindNavigation(nameof(User.ProjectLogsIds))!.SetPropertyAccessMode(PropertyAccessMode.Field);\r\n    }\r\n\r\n    private void ConfigureUserNotificationsTable(EntityTypeBuilder<User> builder)\r\n    {\r\n        builder.OwnsMany(u => u.Notifications, nb =>\r\n        {\r\n            nb.ToTable(\"Notifications\");\r\n\r\n            nb.WithOwner().HasForeignKey(\"UserId\");\r\n\r\n            nb.HasKey(\"Id\", \"UserId\");\r\n\r\n            nb.Property(n => n.Id)\r\n                .HasColumnName(\"UserNotificationId\")\r\n                .ValueGeneratedNever()\r\n                .HasConversion(\r\n                    id => id.Value,\r\n                    value => UserNotificationId.Create(value));\r\n\r\n            nb.OwnsOne(n => n.Sender, sb =>{\r\n                sb.Property(s => s.Name)\r\n                .HasColumnName(\"SenderName\");\r\n\r\n                sb.Property(s => s.UserId)\r\n                    .HasColumnName(\"SenderUserId\")\r\n                    .HasConversion(\r\n                        id => id.Value,\r\n                        value => UserId.Create(value));\r\n            });\r\n        });\r\n\r\n        builder.Metadata.FindNavigation(nameof(User.Notifications))!.SetPropertyAccessMode(PropertyAccessMode.Field);\r\n    }\r\n\r\n    private void ConfigureUserCheckLogsTable(EntityTypeBuilder<User> builder)\r\n    {\r\n        builder.OwnsMany(u => u.CheckLogs, clb =>\r\n        {\r\n            clb.ToTable(\"CheckLogs\");\r\n\r\n            clb.WithOwner().HasForeignKey(\"UserId\");\r\n\r\n            clb.HasKey(\"Id\", \"UserId\");\r\n\r\n            clb.Property(cl => cl.Id)\r\n                .HasColumnName(\"UserCheckLogId\")\r\n                .ValueGeneratedNever()\r\n                .HasConversion(\r\n                    id => id.Value,\r\n                    value => UserCheckLogId.Create(value));\r\n        });\r\n\r\n        builder.Metadata.FindNavigation(nameof(User.CheckLogs))!.SetPropertyAccessMode(PropertyAccessMode.Field);\r\n    }\r\n\r\n    private void ConfigureUserRefreshTokensTable(EntityTypeBuilder<User> builder)\r\n    {\r\n        builder.OwnsMany(u => u.RefreshTokens, rtb =>\r\n        {\r\n            rtb.ToTable(\"RefreshTokens\");\r\n\r\n            rtb.WithOwner().HasForeignKey(\"UserId\");\r\n\r\n            rtb.HasKey(\"Id\", \"UserId\");\r\n\r\n            rtb.Property(rt => rt.Id)\r\n                .HasColumnName(\"UserRefreshTokenId\")\r\n                .ValueGeneratedNever()\r\n                .HasConversion(\r\n                    id => id.Value,\r\n                    value => UserRefreshTokenId.Create(value));\r\n        });\r\n\r\n        builder.Metadata.FindNavigation(nameof(User.RefreshTokens))!.SetPropertyAccessMode(PropertyAccessMode.Field);\r\n    }\r\n\r\n    private void ConfigureUserTable(EntityTypeBuilder<User> builder)\r\n    {\r\n        builder.ToTable(\"Users\");\r\n\r\n        builder.HasKey(u => u.Id);\r\n\r\n        builder.Property(u => u.Id)\r\n            .ValueGeneratedNever()\r\n            .HasConversion(\r\n                id => id.Value,\r\n                value => UserId.Create(value));\r\n\r\n        builder.Property(u => u.FirstName)\r\n            .HasMaxLength(50)\r\n            .IsRequired();\r\n\r\n        builder.Property(u => u.LastName)\r\n            .HasMaxLength(50)\r\n            .IsRequired();\r\n\r\n        builder.Property(u => u.Email)\r\n            .HasMaxLength(100)\r\n            .IsRequired();\r\n    }\r\n}\r\n```\r\n\r\n```\r\npublic class DisciplineConfigurations : IEntityTypeConfiguration<Discipline>\r\n{\r\n    public void Configure(EntityTypeBuilder<Discipline> builder)\r\n    {\r\n        ConfigureDisciplineTable(builder);\r\n        ConfigureDisciplineUserIdsTable(builder);\r\n    }\r\n\r\n    private void ConfigureDisciplineUserIdsTable(EntityTypeBuilder<Discipline> builder)\r\n    {\r\n        builder.OwnsMany(u => u.UsersIds, dib =>\r\n        {\r\n            dib.ToTable(\"DisciplineUsersIds\");\r\n\r\n            dib.WithOwner().HasForeignKey(\"DisciplineId\");\r\n\r\n            dib.HasKey(\"Id\");\r\n\r\n            dib.Property(di => di.Value)\r\n                .HasColumnName(\"UserId\")\r\n                .ValueGeneratedNever();\r\n        });\r\n\r\n        builder.Metadata.FindNavigation(nameof(Discipline.UsersIds))!.SetPropertyAccessMode(PropertyAccessMode.Field);\r\n    }\r\n\r\n    private void ConfigureDisciplineTable(EntityTypeBuilder<Discipline> builder)\r\n    {\r\n        builder.ToTable(\"Disciplines\");\r\n\r\n        builder.HasKey(x => x.Id);\r\n\r\n        builder.Property(p => p.Id)\r\n                .ValueGeneratedNever()\r\n                .HasConversion(\r\n                    id => id.Value,\r\n                    value => DisciplineId.Create(value));\r\n    }\r\n}\r\n```\r\n\r\nwhen i try to add a migration this always throws the following exception\r\n\r\n> System.Reflection.TargetInvocationException: Exception has been thrown by the target of an invocation.\r\n>  ---> System.NullReferenceException: Object reference not set to an instance of an object.\r\n>    at Microsoft.EntityFrameworkCore.Metadata.Conventions.Internal.ConventionBatchExtensions.Run(IConventionBatch batch, InternalForeignKeyBuilder relationshipBuilder)\r\n>    at Microsoft.EntityFrameworkCore.Metadata.Internal.InternalForeignKeyBuilder.ReuniquifyImplicitProperties(Boolean force)\r\n>    at Microsoft.EntityFrameworkCore.Metadata.Conventions.ForeignKeyPropertyDiscoveryConvention.DiscoverProperties(IConventionForeignKeyBuilder relationshipBuilder, IConventionContext context)\r\n>    at Microsoft.EntityFrameworkCore.Metadata.Conventions.ForeignKeyPropertyDiscoveryConvention.ProcessForeignKeyRequirednessChanged(IConventionForeignKeyBuilder relationshipBuilder, IConventionContext`1 context)\r\n>    at Microsoft.EntityFrameworkCore.Metadata.Conventions.Internal.ConventionDispatcher.ImmediateConventionScope.OnForeignKeyRequirednessChanged(IConventionForeignKeyBuilder relationshipBuilder)\r\n>    at Microsoft.EntityFrameworkCore.Metadata.Conventions.Internal.ConventionDispatcher.OnForeignKeyRequirednessChangedNode.Run(ConventionDispatcher dispatcher)\r\n>    at Microsoft.EntityFrameworkCore.Metadata.Conventions.Internal.ConventionDispatcher.DelayedConventionScope.Run(ConventionDispatcher dispatcher)\r\n>    at Microsoft.EntityFrameworkCore.Metadata.Conventions.Internal.ConventionDispatcher.ConventionBatch.Run()\r\n>    at Microsoft.EntityFrameworkCore.Metadata.Conventions.Internal.ConventionDispatcher.ConventionBatch.Run(IConventionForeignKey foreignKey)\r\n>    at Microsoft.EntityFrameworkCore.Metadata.Builders.EntityTypeBuilder`1.OwnsManyBuilder[TRelatedEntity](TypeIdentity ownedType, MemberIdentity navigation)\r\n>    at Microsoft.EntityFrameworkCore.Metadata.Builders.EntityTypeBuilder`1.OwnsMany[TRelatedEntity](Expression`1 navigationExpression, Action`1 buildAction)\r\n>    at TimeTracker.Infrastructure.Persistence.Configurations.UserConfigurations.ConfigureUserRefreshTokensTable(EntityTypeBuilder`1 builder) in C:\\Users\\rizk_\\source\\repos\\TimeTracker\\TimeTracker.Infrastructure\\Persistence\\Configurations\\UserConfigurations.cs:line 115\r\n>    at TimeTracker.Infrastructure.Persistence.Configurations.UserConfigurations.Configure(EntityTypeBuilder`1 builder) in C:\\Users\\rizk_\\source\\repos\\TimeTracker\\TimeTracker.Infrastructure\\Persistence\\Configurations\\UserConfigurations.cs:line 15\r\n>    at Microsoft.EntityFrameworkCore.ModelBuilder.ApplyConfiguration[TEntity](IEntityTypeConfiguration`1 configuration)\r\n>    at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)\r\n>    at System.Reflection.MethodInvoker.Invoke(Object obj, IntPtr* args, BindingFlags invokeAttr)\r\n>    --- End of inner exception stack trace ---\r\n>    at System.Reflection.MethodInvoker.Invoke(Object obj, IntPtr* args, BindingFlags invokeAttr)\r\n>    at System.Reflection.RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)\r\n>    at System.Reflection.MethodBase.Invoke(Object obj, Object[] parameters)\r\n>    at Microsoft.EntityFrameworkCore.ModelBuilder.ApplyConfigurationsFromAssembly(Assembly assembly, Func`2 predicate)\r\n>    at TimeTracker.Infrastructure.Persistence.TimeTrackerDbContext.OnModelCreating(ModelBuilder modelBuilder) in C:\\Users\\rizk_\\source\\repos\\TimeTracker\\TimeTracker.Infrastructure\\Persistence\\TimeTrackerDbContext.cs:line 23\r\n>    at Microsoft.EntityFrameworkCore.Infrastructure.ModelCustomizer.Customize(ModelBuilder modelBuilder, DbContext context)\r\n>    at Microsoft.EntityFrameworkCore.Infrastructure.ModelSource.CreateModel(DbContext context, IConventionSetBuilder conventionSetBuilder, ModelDependencies modelDependencies)\r\n>    at Microsoft.EntityFrameworkCore.Infrastructure.ModelSource.GetModel(DbContext context, ModelCreationDependencies modelCreationDependencies, Boolean designTime)\r\n>    at Microsoft.EntityFrameworkCore.Internal.DbContextServices.CreateModel(Boolean designTime)\r\n>    at Microsoft.EntityFrameworkCore.Internal.DbContextServices.get_Model()\r\n>    at Microsoft.EntityFrameworkCore.Infrastructure.EntityFrameworkServicesBuilder.<>c.<TryAddCoreServices>b__8_4(IServiceProvider p)\r\n>    at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)\r\n>    at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitCache(ServiceCallSite callSite, RuntimeResolverContext context, ServiceProviderEngineScope serviceProviderEngine, RuntimeResolverLock lockType)\r\n>    at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitScopeCache(ServiceCallSite callSite, RuntimeResolverContext context)\r\n>    at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)\r\n>    at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)\r\n>    at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)\r\n>    at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitCache(ServiceCallSite callSite, RuntimeResolverContext context, ServiceProviderEngineScope serviceProviderEngine, RuntimeResolverLock lockType)\r\n>    at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitScopeCache(ServiceCallSite callSite, RuntimeResolverContext context)\r\n>    at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)\r\n>    at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)\r\n>    at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)\r\n>    at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitCache(ServiceCallSite callSite, RuntimeResolverContext context, ServiceProviderEngineScope serviceProviderEngine, RuntimeResolverLock lockType)\r\n>    at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitScopeCache(ServiceCallSite callSite, RuntimeResolverContext context)\r\n>    at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)\r\n>    at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)\r\n>    at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)\r\n>    at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitCache(ServiceCallSite callSite, RuntimeResolverContext context, ServiceProviderEngineScope serviceProviderEngine, RuntimeResolverLock lockType)\r\n>    at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitScopeCache(ServiceCallSite callSite, RuntimeResolverContext context)\r\n>    at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)\r\n>    at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)\r\n>    at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)\r\n>    at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitCache(ServiceCallSite callSite, RuntimeResolverContext context, ServiceProviderEngineScope serviceProviderEngine, RuntimeResolverLock lockType)\r\n>    at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitScopeCache(ServiceCallSite callSite, RuntimeResolverContext context)\r\n>    at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)\r\n>    at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)\r\n>    at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)\r\n>    at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitCache(ServiceCallSite callSite, RuntimeResolverContext context, ServiceProviderEngineScope serviceProviderEngine, RuntimeResolverLock lockType)\r\n>    at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitScopeCache(ServiceCallSite callSite, RuntimeResolverContext context)\r\n>    at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)\r\n>    at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.Resolve(ServiceCallSite callSite, ServiceProviderEngineScope scope)\r\n>    at Microsoft.Extensions.DependencyInjection.ServiceLookup.DynamicServiceProviderEngine.<>c__DisplayClass2_0.<RealizeService>b__0(ServiceProviderEngineScope scope)\r\n>    at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)\r\n>    at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)\r\n>    at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)\r\n>    at Microsoft.EntityFrameworkCore.DbContext.get_DbContextDependencies()\r\n>    at Microsoft.EntityFrameworkCore.DbContext.get_ContextServices()\r\n>    at Microsoft.EntityFrameworkCore.DbContext.get_InternalServiceProvider()\r\n>    at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Infrastructure.IInfrastructure<System.IServiceProvider>.get_Instance()\r\n>    at Microsoft.EntityFrameworkCore.Infrastructure.Internal.InfrastructureExtensions.GetService[TService](IInfrastructure`1 accessor)\r\n>    at Microsoft.EntityFrameworkCore.Infrastructure.AccessorExtensions.GetService[TService](IInfrastructure`1 accessor)\r\n>    at Microsoft.EntityFrameworkCore.Design.Internal.DbContextOperations.CreateContext(Func`1 factory)\r\n>    at Microsoft.EntityFrameworkCore.Design.Internal.DbContextOperations.CreateContext(String contextType)\r\n>    at Microsoft.EntityFrameworkCore.Design.Internal.MigrationsOperations.AddMigration(String name, String outputDir, String contextType, String namespace)\r\n>    at Microsoft.EntityFrameworkCore.Design.OperationExecutor.AddMigrationImpl(String name, String outputDir, String contextType, String namespace)\r\n>    at Microsoft.EntityFrameworkCore.Design.OperationExecutor.AddMigration.<>c__DisplayClass0_0.<.ctor>b__0()\r\n>    at Microsoft.EntityFrameworkCore.Design.OperationExecutor.OperationBase.<>c__DisplayClass3_0`1.<Execute>b__0()\r\n>    at Microsoft.EntityFrameworkCore.Design.OperationExecutor.OperationBase.Execute(Action action)\r\n> Exception has been thrown by the target of an invocation.\r\n\r\nin the exception it shows that there is a problem in line 115 which is the following method in the above config\r\n\r\n```\r\nbuilder.OwnsMany(u => u.RefreshTokens, rtb =>\r\n        {\r\n            rtb.ToTable(\"RefreshTokens\");\r\n\r\n            rtb.WithOwner().HasForeignKey(\"UserId\");\r\n\r\n            rtb.HasKey(\"Id\", \"UserId\");\r\n\r\n            rtb.Property(rt => rt.Id)\r\n                .HasColumnName(\"UserRefreshTokenId\")\r\n                .ValueGeneratedNever()\r\n                .HasConversion(\r\n                    id => id.Value,\r\n                    value => UserRefreshTokenId.Create(value));\r\n        });\r\n```\r\n\r\nbut after alot of debugging I noticed the following, when I delete the discipline config and try to add a migration with only the user config the migration gets generated sucessfully without problems, and when I delete the user config and only run the discipline the config the migration gets genereated sucessfully, so I tried to remove the list of userIds in the discipline aggregate and the migration was added sucessfully. \r\n\r\nIs this a bug or am I doing something wrong here? ","reactions":{"url":"https://api.github.com/repos/dotnet/efcore/issues/30639/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/dotnet/efcore/issues/30639/timeline","performed_via_github_app":null,"state_reason":"duplicate"}},"event":"cross-referenced"},{"url":"https://api.github.com/repos/dotnet/efcore/issues/comments/1513533152","html_url":"https://github.com/dotnet/efcore/issues/30373#issuecomment-1513533152","issue_url":"https://api.github.com/repos/dotnet/efcore/issues/30373","id":1513533152,"node_id":"IC_kwDOAPaMMs5aNq7g","user":{"login":"NikolaVranes","id":84865811,"node_id":"MDQ6VXNlcjg0ODY1ODEx","avatar_url":"https://avatars.githubusercontent.com/u/84865811?v=4","gravatar_id":"","url":"https://api.github.com/users/NikolaVranes","html_url":"https://github.com/NikolaVranes","followers_url":"https://api.github.com/users/NikolaVranes/followers","following_url":"https://api.github.com/users/NikolaVranes/following{/other_user}","gists_url":"https://api.github.com/users/NikolaVranes/gists{/gist_id}","starred_url":"https://api.github.com/users/NikolaVranes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/NikolaVranes/subscriptions","organizations_url":"https://api.github.com/users/NikolaVranes/orgs","repos_url":"https://api.github.com/users/NikolaVranes/repos","events_url":"https://api.github.com/users/NikolaVranes/events{/privacy}","received_events_url":"https://api.github.com/users/NikolaVranes/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-18T17:16:47Z","updated_at":"2023-04-18T17:16:47Z","body":"@kcindric Is this fixed?","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/dotnet/efcore/issues/comments/1513533152/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"NikolaVranes","id":84865811,"node_id":"MDQ6VXNlcjg0ODY1ODEx","avatar_url":"https://avatars.githubusercontent.com/u/84865811?v=4","gravatar_id":"","url":"https://api.github.com/users/NikolaVranes","html_url":"https://github.com/NikolaVranes","followers_url":"https://api.github.com/users/NikolaVranes/followers","following_url":"https://api.github.com/users/NikolaVranes/following{/other_user}","gists_url":"https://api.github.com/users/NikolaVranes/gists{/gist_id}","starred_url":"https://api.github.com/users/NikolaVranes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/NikolaVranes/subscriptions","organizations_url":"https://api.github.com/users/NikolaVranes/orgs","repos_url":"https://api.github.com/users/NikolaVranes/repos","events_url":"https://api.github.com/users/NikolaVranes/events{/privacy}","received_events_url":"https://api.github.com/users/NikolaVranes/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":9038416863,"node_id":"MEE_lADOAPaMMs5fpD2CzwAAAAIau0vf","url":"https://api.github.com/repos/dotnet/efcore/issues/events/9038416863","actor":{"login":"kcindric","id":44549361,"node_id":"MDQ6VXNlcjQ0NTQ5MzYx","avatar_url":"https://avatars.githubusercontent.com/u/44549361?v=4","gravatar_id":"","url":"https://api.github.com/users/kcindric","html_url":"https://github.com/kcindric","followers_url":"https://api.github.com/users/kcindric/followers","following_url":"https://api.github.com/users/kcindric/following{/other_user}","gists_url":"https://api.github.com/users/kcindric/gists{/gist_id}","starred_url":"https://api.github.com/users/kcindric/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kcindric/subscriptions","organizations_url":"https://api.github.com/users/kcindric/orgs","repos_url":"https://api.github.com/users/kcindric/repos","events_url":"https://api.github.com/users/kcindric/events{/privacy}","received_events_url":"https://api.github.com/users/kcindric/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2023-04-18T17:16:48Z","performed_via_github_app":null},{"id":9038416878,"node_id":"SE_lADOAPaMMs5fpD2CzwAAAAIau0vu","url":"https://api.github.com/repos/dotnet/efcore/issues/events/9038416878","actor":{"login":"kcindric","id":44549361,"node_id":"MDQ6VXNlcjQ0NTQ5MzYx","avatar_url":"https://avatars.githubusercontent.com/u/44549361?v=4","gravatar_id":"","url":"https://api.github.com/users/kcindric","html_url":"https://github.com/kcindric","followers_url":"https://api.github.com/users/kcindric/followers","following_url":"https://api.github.com/users/kcindric/following{/other_user}","gists_url":"https://api.github.com/users/kcindric/gists{/gist_id}","starred_url":"https://api.github.com/users/kcindric/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kcindric/subscriptions","organizations_url":"https://api.github.com/users/kcindric/orgs","repos_url":"https://api.github.com/users/kcindric/repos","events_url":"https://api.github.com/users/kcindric/events{/privacy}","received_events_url":"https://api.github.com/users/kcindric/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2023-04-18T17:16:48Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/dotnet/efcore/issues/comments/1672845757","html_url":"https://github.com/dotnet/efcore/issues/30373#issuecomment-1672845757","issue_url":"https://api.github.com/repos/dotnet/efcore/issues/30373","id":1672845757,"node_id":"IC_kwDOAPaMMs5jtZm9","user":{"login":"jorgefpcardoso","id":35601332,"node_id":"MDQ6VXNlcjM1NjAxMzMy","avatar_url":"https://avatars.githubusercontent.com/u/35601332?v=4","gravatar_id":"","url":"https://api.github.com/users/jorgefpcardoso","html_url":"https://github.com/jorgefpcardoso","followers_url":"https://api.github.com/users/jorgefpcardoso/followers","following_url":"https://api.github.com/users/jorgefpcardoso/following{/other_user}","gists_url":"https://api.github.com/users/jorgefpcardoso/gists{/gist_id}","starred_url":"https://api.github.com/users/jorgefpcardoso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jorgefpcardoso/subscriptions","organizations_url":"https://api.github.com/users/jorgefpcardoso/orgs","repos_url":"https://api.github.com/users/jorgefpcardoso/repos","events_url":"https://api.github.com/users/jorgefpcardoso/events{/privacy}","received_events_url":"https://api.github.com/users/jorgefpcardoso/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-10T09:07:38Z","updated_at":"2023-08-10T09:07:38Z","body":"Any ideas on how to resolve this?","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/dotnet/efcore/issues/comments/1672845757/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"jorgefpcardoso","id":35601332,"node_id":"MDQ6VXNlcjM1NjAxMzMy","avatar_url":"https://avatars.githubusercontent.com/u/35601332?v=4","gravatar_id":"","url":"https://api.github.com/users/jorgefpcardoso","html_url":"https://github.com/jorgefpcardoso","followers_url":"https://api.github.com/users/jorgefpcardoso/followers","following_url":"https://api.github.com/users/jorgefpcardoso/following{/other_user}","gists_url":"https://api.github.com/users/jorgefpcardoso/gists{/gist_id}","starred_url":"https://api.github.com/users/jorgefpcardoso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jorgefpcardoso/subscriptions","organizations_url":"https://api.github.com/users/jorgefpcardoso/orgs","repos_url":"https://api.github.com/users/jorgefpcardoso/repos","events_url":"https://api.github.com/users/jorgefpcardoso/events{/privacy}","received_events_url":"https://api.github.com/users/jorgefpcardoso/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/dotnet/efcore/issues/comments/1672903635","html_url":"https://github.com/dotnet/efcore/issues/30373#issuecomment-1672903635","issue_url":"https://api.github.com/repos/dotnet/efcore/issues/30373","id":1672903635,"node_id":"IC_kwDOAPaMMs5jtnvT","user":{"login":"kcindric","id":44549361,"node_id":"MDQ6VXNlcjQ0NTQ5MzYx","avatar_url":"https://avatars.githubusercontent.com/u/44549361?v=4","gravatar_id":"","url":"https://api.github.com/users/kcindric","html_url":"https://github.com/kcindric","followers_url":"https://api.github.com/users/kcindric/followers","following_url":"https://api.github.com/users/kcindric/following{/other_user}","gists_url":"https://api.github.com/users/kcindric/gists{/gist_id}","starred_url":"https://api.github.com/users/kcindric/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kcindric/subscriptions","organizations_url":"https://api.github.com/users/kcindric/orgs","repos_url":"https://api.github.com/users/kcindric/repos","events_url":"https://api.github.com/users/kcindric/events{/privacy}","received_events_url":"https://api.github.com/users/kcindric/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-10T09:45:11Z","updated_at":"2023-08-10T09:45:11Z","body":"@NikolaVranes & @jorgecardoso220 I \"fixed\" this by not using strongly typed IDs and using plain int IDs instead.\r\n\r\nExample of my Domain and EF Configuration files:\r\n\r\n```c#\r\npublic class Department : AggregateRoot<int>\r\n{\r\n    private Department(int departmentId, string name, int officeId, DateTime createdDateTime,\r\n        DateTime updatedDateTime) :\r\n        base(departmentId)\r\n    {\r\n        Id = departmentId;\r\n        Name = name;\r\n        OfficeId = officeId;\r\n        CreatedDateTime = createdDateTime;\r\n        UpdatedDateTime = updatedDateTime;\r\n    }\r\n\r\n    private Department()\r\n    {\r\n    }\r\n\r\n    public string Name { get; private set; }\r\n    public int OfficeId { get; private set; }\r\n    public DateTime CreatedDateTime { get; private set; }\r\n    public DateTime UpdatedDateTime { get; private set; }\r\n\r\n    public static Department Create(int departmentId, string name, int officeId)\r\n    {\r\n        return new Department(departmentId, name, officeId, DateTime.UtcNow, DateTime.UtcNow);\r\n    }\r\n}\r\n```\r\n\r\n```c#\r\npublic class DepartmentConfigurations : IEntityTypeConfiguration<Department>\r\n{\r\n    public void Configure(EntityTypeBuilder<Department> builder)\r\n    {\r\n        ConfigureDepartmentTable(builder);\r\n    }\r\n\r\n    private void ConfigureDepartmentTable(EntityTypeBuilder<Department> builder)\r\n    {\r\n        builder.ToTable(nameof(Department), nameof(Department));\r\n\r\n        builder.HasKey(d => d.Id);\r\n        \r\n        builder.Property(d => d.Id)\r\n            .ValueGeneratedNever();\r\n\r\n        builder.HasOne<Office>()\r\n            .WithMany()\r\n            .HasForeignKey(d => d.OfficeId);\r\n    }\r\n}\r\n```\r\n\r\nThere's a workaround that Amichai mentioned in his video but I find that approach too complicated:\r\nhttps://www.youtube.com/watch?v=B3Iq346KwUQ\r\n\r\nHope it helps!","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/dotnet/efcore/issues/comments/1672903635/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":1,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"kcindric","id":44549361,"node_id":"MDQ6VXNlcjQ0NTQ5MzYx","avatar_url":"https://avatars.githubusercontent.com/u/44549361?v=4","gravatar_id":"","url":"https://api.github.com/users/kcindric","html_url":"https://github.com/kcindric","followers_url":"https://api.github.com/users/kcindric/followers","following_url":"https://api.github.com/users/kcindric/following{/other_user}","gists_url":"https://api.github.com/users/kcindric/gists{/gist_id}","starred_url":"https://api.github.com/users/kcindric/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kcindric/subscriptions","organizations_url":"https://api.github.com/users/kcindric/orgs","repos_url":"https://api.github.com/users/kcindric/repos","events_url":"https://api.github.com/users/kcindric/events{/privacy}","received_events_url":"https://api.github.com/users/kcindric/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":10057140973,"node_id":"MEE_lADOAPaMMs5fpD2CzwAAAAJXc8rt","url":"https://api.github.com/repos/dotnet/efcore/issues/events/10057140973","actor":{"login":"jorgefpcardoso","id":35601332,"node_id":"MDQ6VXNlcjM1NjAxMzMy","avatar_url":"https://avatars.githubusercontent.com/u/35601332?v=4","gravatar_id":"","url":"https://api.github.com/users/jorgefpcardoso","html_url":"https://github.com/jorgefpcardoso","followers_url":"https://api.github.com/users/jorgefpcardoso/followers","following_url":"https://api.github.com/users/jorgefpcardoso/following{/other_user}","gists_url":"https://api.github.com/users/jorgefpcardoso/gists{/gist_id}","starred_url":"https://api.github.com/users/jorgefpcardoso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jorgefpcardoso/subscriptions","organizations_url":"https://api.github.com/users/jorgefpcardoso/orgs","repos_url":"https://api.github.com/users/jorgefpcardoso/repos","events_url":"https://api.github.com/users/jorgefpcardoso/events{/privacy}","received_events_url":"https://api.github.com/users/jorgefpcardoso/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2023-08-10T09:45:11Z","performed_via_github_app":null},{"id":10057140998,"node_id":"SE_lADOAPaMMs5fpD2CzwAAAAJXc8sG","url":"https://api.github.com/repos/dotnet/efcore/issues/events/10057140998","actor":{"login":"jorgefpcardoso","id":35601332,"node_id":"MDQ6VXNlcjM1NjAxMzMy","avatar_url":"https://avatars.githubusercontent.com/u/35601332?v=4","gravatar_id":"","url":"https://api.github.com/users/jorgefpcardoso","html_url":"https://github.com/jorgefpcardoso","followers_url":"https://api.github.com/users/jorgefpcardoso/followers","following_url":"https://api.github.com/users/jorgefpcardoso/following{/other_user}","gists_url":"https://api.github.com/users/jorgefpcardoso/gists{/gist_id}","starred_url":"https://api.github.com/users/jorgefpcardoso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jorgefpcardoso/subscriptions","organizations_url":"https://api.github.com/users/jorgefpcardoso/orgs","repos_url":"https://api.github.com/users/jorgefpcardoso/repos","events_url":"https://api.github.com/users/jorgefpcardoso/events{/privacy}","received_events_url":"https://api.github.com/users/jorgefpcardoso/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2023-08-10T09:45:11Z","performed_via_github_app":null}]