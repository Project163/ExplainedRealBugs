[{"id":15371702378,"node_id":"LE_lADOAPaMMs6fji4zzwAAAAOUOZBq","url":"https://api.github.com/repos/dotnet/efcore/issues/events/15371702378","actor":{"login":"meghanmae","id":43832670,"node_id":"MDQ6VXNlcjQzODMyNjcw","avatar_url":"https://avatars.githubusercontent.com/u/43832670?v=4","gravatar_id":"","url":"https://api.github.com/users/meghanmae","html_url":"https://github.com/meghanmae","followers_url":"https://api.github.com/users/meghanmae/followers","following_url":"https://api.github.com/users/meghanmae/following{/other_user}","gists_url":"https://api.github.com/users/meghanmae/gists{/gist_id}","starred_url":"https://api.github.com/users/meghanmae/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/meghanmae/subscriptions","organizations_url":"https://api.github.com/users/meghanmae/orgs","repos_url":"https://api.github.com/users/meghanmae/repos","events_url":"https://api.github.com/users/meghanmae/events{/privacy}","received_events_url":"https://api.github.com/users/meghanmae/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2024-11-20T19:11:04Z","label":{"name":"customer-reported","color":"a4a5f9"},"performed_via_github_app":null},{"id":15372120095,"node_id":"AE_lADOAPaMMs6fji4zzwAAAAOUP_Af","url":"https://api.github.com/repos/dotnet/efcore/issues/events/15372120095","actor":{"login":"cincuranet","id":4540597,"node_id":"MDQ6VXNlcjQ1NDA1OTc=","avatar_url":"https://avatars.githubusercontent.com/u/4540597?v=4","gravatar_id":"","url":"https://api.github.com/users/cincuranet","html_url":"https://github.com/cincuranet","followers_url":"https://api.github.com/users/cincuranet/followers","following_url":"https://api.github.com/users/cincuranet/following{/other_user}","gists_url":"https://api.github.com/users/cincuranet/gists{/gist_id}","starred_url":"https://api.github.com/users/cincuranet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cincuranet/subscriptions","organizations_url":"https://api.github.com/users/cincuranet/orgs","repos_url":"https://api.github.com/users/cincuranet/repos","events_url":"https://api.github.com/users/cincuranet/events{/privacy}","received_events_url":"https://api.github.com/users/cincuranet/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"assigned","commit_id":null,"commit_url":null,"created_at":"2024-11-20T19:53:31Z","assignee":{"login":"maumar","id":1591930,"node_id":"MDQ6VXNlcjE1OTE5MzA=","avatar_url":"https://avatars.githubusercontent.com/u/1591930?v=4","gravatar_id":"","url":"https://api.github.com/users/maumar","html_url":"https://github.com/maumar","followers_url":"https://api.github.com/users/maumar/followers","following_url":"https://api.github.com/users/maumar/following{/other_user}","gists_url":"https://api.github.com/users/maumar/gists{/gist_id}","starred_url":"https://api.github.com/users/maumar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/maumar/subscriptions","organizations_url":"https://api.github.com/users/maumar/orgs","repos_url":"https://api.github.com/users/maumar/repos","events_url":"https://api.github.com/users/maumar/events{/privacy}","received_events_url":"https://api.github.com/users/maumar/received_events","type":"User","user_view_type":"public","site_admin":false},"performed_via_github_app":null},{"id":15372120111,"node_id":"AE_lADOAPaMMs6fji4zzwAAAAOUP_Av","url":"https://api.github.com/repos/dotnet/efcore/issues/events/15372120111","actor":{"login":"cincuranet","id":4540597,"node_id":"MDQ6VXNlcjQ1NDA1OTc=","avatar_url":"https://avatars.githubusercontent.com/u/4540597?v=4","gravatar_id":"","url":"https://api.github.com/users/cincuranet","html_url":"https://github.com/cincuranet","followers_url":"https://api.github.com/users/cincuranet/followers","following_url":"https://api.github.com/users/cincuranet/following{/other_user}","gists_url":"https://api.github.com/users/cincuranet/gists{/gist_id}","starred_url":"https://api.github.com/users/cincuranet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cincuranet/subscriptions","organizations_url":"https://api.github.com/users/cincuranet/orgs","repos_url":"https://api.github.com/users/cincuranet/repos","events_url":"https://api.github.com/users/cincuranet/events{/privacy}","received_events_url":"https://api.github.com/users/cincuranet/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"assigned","commit_id":null,"commit_url":null,"created_at":"2024-11-20T19:53:31Z","assignee":{"login":"AndriySvyryd","id":6539701,"node_id":"MDQ6VXNlcjY1Mzk3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6539701?v=4","gravatar_id":"","url":"https://api.github.com/users/AndriySvyryd","html_url":"https://github.com/AndriySvyryd","followers_url":"https://api.github.com/users/AndriySvyryd/followers","following_url":"https://api.github.com/users/AndriySvyryd/following{/other_user}","gists_url":"https://api.github.com/users/AndriySvyryd/gists{/gist_id}","starred_url":"https://api.github.com/users/AndriySvyryd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AndriySvyryd/subscriptions","organizations_url":"https://api.github.com/users/AndriySvyryd/orgs","repos_url":"https://api.github.com/users/AndriySvyryd/repos","events_url":"https://api.github.com/users/AndriySvyryd/events{/privacy}","received_events_url":"https://api.github.com/users/AndriySvyryd/received_events","type":"User","user_view_type":"public","site_admin":false},"performed_via_github_app":null},{"id":15372120598,"node_id":"LE_lADOAPaMMs6fji4zzwAAAAOUP_IW","url":"https://api.github.com/repos/dotnet/efcore/issues/events/15372120598","actor":{"login":"cincuranet","id":4540597,"node_id":"MDQ6VXNlcjQ1NDA1OTc=","avatar_url":"https://avatars.githubusercontent.com/u/4540597?v=4","gravatar_id":"","url":"https://api.github.com/users/cincuranet","html_url":"https://github.com/cincuranet","followers_url":"https://api.github.com/users/cincuranet/followers","following_url":"https://api.github.com/users/cincuranet/following{/other_user}","gists_url":"https://api.github.com/users/cincuranet/gists{/gist_id}","starred_url":"https://api.github.com/users/cincuranet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cincuranet/subscriptions","organizations_url":"https://api.github.com/users/cincuranet/orgs","repos_url":"https://api.github.com/users/cincuranet/repos","events_url":"https://api.github.com/users/cincuranet/events{/privacy}","received_events_url":"https://api.github.com/users/cincuranet/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2024-11-20T19:53:35Z","label":{"name":"area-migrations","color":"32b37b"},"performed_via_github_app":null},{"id":15405821985,"node_id":"UNE_lADOAPaMMs6fji4zzwAAAAOWQjAh","url":"https://api.github.com/repos/dotnet/efcore/issues/events/15405821985","actor":{"login":"AndriySvyryd","id":6539701,"node_id":"MDQ6VXNlcjY1Mzk3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6539701?v=4","gravatar_id":"","url":"https://api.github.com/users/AndriySvyryd","html_url":"https://github.com/AndriySvyryd","followers_url":"https://api.github.com/users/AndriySvyryd/followers","following_url":"https://api.github.com/users/AndriySvyryd/following{/other_user}","gists_url":"https://api.github.com/users/AndriySvyryd/gists{/gist_id}","starred_url":"https://api.github.com/users/AndriySvyryd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AndriySvyryd/subscriptions","organizations_url":"https://api.github.com/users/AndriySvyryd/orgs","repos_url":"https://api.github.com/users/AndriySvyryd/repos","events_url":"https://api.github.com/users/AndriySvyryd/events{/privacy}","received_events_url":"https://api.github.com/users/AndriySvyryd/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"unassigned","commit_id":null,"commit_url":null,"created_at":"2024-11-23T01:13:11Z","assignee":{"login":"AndriySvyryd","id":6539701,"node_id":"MDQ6VXNlcjY1Mzk3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6539701?v=4","gravatar_id":"","url":"https://api.github.com/users/AndriySvyryd","html_url":"https://github.com/AndriySvyryd","followers_url":"https://api.github.com/users/AndriySvyryd/followers","following_url":"https://api.github.com/users/AndriySvyryd/following{/other_user}","gists_url":"https://api.github.com/users/AndriySvyryd/gists{/gist_id}","starred_url":"https://api.github.com/users/AndriySvyryd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AndriySvyryd/subscriptions","organizations_url":"https://api.github.com/users/AndriySvyryd/orgs","repos_url":"https://api.github.com/users/AndriySvyryd/repos","events_url":"https://api.github.com/users/AndriySvyryd/events{/privacy}","received_events_url":"https://api.github.com/users/AndriySvyryd/received_events","type":"User","user_view_type":"public","site_admin":false},"performed_via_github_app":null},{"url":"https://api.github.com/repos/dotnet/efcore/issues/comments/2500208196","html_url":"https://github.com/dotnet/efcore/issues/35162#issuecomment-2500208196","issue_url":"https://api.github.com/repos/dotnet/efcore/issues/35162","id":2500208196,"node_id":"IC_kwDOAPaMMs6VBiZE","user":{"login":"devedse","id":2350015,"node_id":"MDQ6VXNlcjIzNTAwMTU=","avatar_url":"https://avatars.githubusercontent.com/u/2350015?v=4","gravatar_id":"","url":"https://api.github.com/users/devedse","html_url":"https://github.com/devedse","followers_url":"https://api.github.com/users/devedse/followers","following_url":"https://api.github.com/users/devedse/following{/other_user}","gists_url":"https://api.github.com/users/devedse/gists{/gist_id}","starred_url":"https://api.github.com/users/devedse/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/devedse/subscriptions","organizations_url":"https://api.github.com/users/devedse/orgs","repos_url":"https://api.github.com/users/devedse/repos","events_url":"https://api.github.com/users/devedse/events{/privacy}","received_events_url":"https://api.github.com/users/devedse/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-11-26T10:14:40Z","updated_at":"2024-11-26T10:14:40Z","body":"We are running into the same issue on our customer code base. The workaround also works for us.","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/dotnet/efcore/issues/comments/2500208196/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"devedse","id":2350015,"node_id":"MDQ6VXNlcjIzNTAwMTU=","avatar_url":"https://avatars.githubusercontent.com/u/2350015?v=4","gravatar_id":"","url":"https://api.github.com/users/devedse","html_url":"https://github.com/devedse","followers_url":"https://api.github.com/users/devedse/followers","following_url":"https://api.github.com/users/devedse/following{/other_user}","gists_url":"https://api.github.com/users/devedse/gists{/gist_id}","starred_url":"https://api.github.com/users/devedse/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/devedse/subscriptions","organizations_url":"https://api.github.com/users/devedse/orgs","repos_url":"https://api.github.com/users/devedse/repos","events_url":"https://api.github.com/users/devedse/events{/privacy}","received_events_url":"https://api.github.com/users/devedse/received_events","type":"User","user_view_type":"public","site_admin":false}},{"actor":{"login":"AnthonyDewhirst","id":642569,"node_id":"MDQ6VXNlcjY0MjU2OQ==","avatar_url":"https://avatars.githubusercontent.com/u/642569?v=4","gravatar_id":"","url":"https://api.github.com/users/AnthonyDewhirst","html_url":"https://github.com/AnthonyDewhirst","followers_url":"https://api.github.com/users/AnthonyDewhirst/followers","following_url":"https://api.github.com/users/AnthonyDewhirst/following{/other_user}","gists_url":"https://api.github.com/users/AnthonyDewhirst/gists{/gist_id}","starred_url":"https://api.github.com/users/AnthonyDewhirst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AnthonyDewhirst/subscriptions","organizations_url":"https://api.github.com/users/AnthonyDewhirst/orgs","repos_url":"https://api.github.com/users/AnthonyDewhirst/repos","events_url":"https://api.github.com/users/AnthonyDewhirst/events{/privacy}","received_events_url":"https://api.github.com/users/AnthonyDewhirst/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-11-26T16:28:38Z","updated_at":"2024-11-26T16:28:38Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/dotnet/efcore/issues/35096","repository_url":"https://api.github.com/repos/dotnet/efcore","labels_url":"https://api.github.com/repos/dotnet/efcore/issues/35096/labels{/name}","comments_url":"https://api.github.com/repos/dotnet/efcore/issues/35096/comments","events_url":"https://api.github.com/repos/dotnet/efcore/issues/35096/events","html_url":"https://github.com/dotnet/efcore/issues/35096","id":2656030247,"node_id":"I_kwDOAPaMMs6eT84n","number":35096,"title":"EF9: single transaction spanning all migrations causes transaction-incompatible SQL to fail","user":{"login":"Tornhoof","id":7989549,"node_id":"MDQ6VXNlcjc5ODk1NDk=","avatar_url":"https://avatars.githubusercontent.com/u/7989549?v=4","gravatar_id":"","url":"https://api.github.com/users/Tornhoof","html_url":"https://github.com/Tornhoof","followers_url":"https://api.github.com/users/Tornhoof/followers","following_url":"https://api.github.com/users/Tornhoof/following{/other_user}","gists_url":"https://api.github.com/users/Tornhoof/gists{/gist_id}","starred_url":"https://api.github.com/users/Tornhoof/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Tornhoof/subscriptions","organizations_url":"https://api.github.com/users/Tornhoof/orgs","repos_url":"https://api.github.com/users/Tornhoof/repos","events_url":"https://api.github.com/users/Tornhoof/events{/privacy}","received_events_url":"https://api.github.com/users/Tornhoof/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":936619505,"node_id":"MDU6TGFiZWw5MzY2MTk1MDU=","url":"https://api.github.com/repos/dotnet/efcore/labels/customer-reported","name":"customer-reported","color":"a4a5f9","default":false,"description":""},{"id":1900942474,"node_id":"MDU6TGFiZWwxOTAwOTQyNDc0","url":"https://api.github.com/repos/dotnet/efcore/labels/area-migrations","name":"area-migrations","color":"32b37b","default":false,"description":""},{"id":3281025791,"node_id":"MDU6TGFiZWwzMjgxMDI1Nzkx","url":"https://api.github.com/repos/dotnet/efcore/labels/priority-bug","name":"priority-bug","color":"1E3932","default":false,"description":"Issues which requires API breaks and have bigger impact hence should be fixed earlier in the release"},{"id":9022438466,"node_id":"LA_kwDOAPaMMs8AAAACGcd8Qg","url":"https://api.github.com/repos/dotnet/efcore/labels/rc-2","name":"rc-2","color":"ACB3D7","default":false,"description":""}],"state":"closed","locked":false,"assignee":{"login":"AndriySvyryd","id":6539701,"node_id":"MDQ6VXNlcjY1Mzk3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6539701?v=4","gravatar_id":"","url":"https://api.github.com/users/AndriySvyryd","html_url":"https://github.com/AndriySvyryd","followers_url":"https://api.github.com/users/AndriySvyryd/followers","following_url":"https://api.github.com/users/AndriySvyryd/following{/other_user}","gists_url":"https://api.github.com/users/AndriySvyryd/gists{/gist_id}","starred_url":"https://api.github.com/users/AndriySvyryd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AndriySvyryd/subscriptions","organizations_url":"https://api.github.com/users/AndriySvyryd/orgs","repos_url":"https://api.github.com/users/AndriySvyryd/repos","events_url":"https://api.github.com/users/AndriySvyryd/events{/privacy}","received_events_url":"https://api.github.com/users/AndriySvyryd/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"AndriySvyryd","id":6539701,"node_id":"MDQ6VXNlcjY1Mzk3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6539701?v=4","gravatar_id":"","url":"https://api.github.com/users/AndriySvyryd","html_url":"https://github.com/AndriySvyryd","followers_url":"https://api.github.com/users/AndriySvyryd/followers","following_url":"https://api.github.com/users/AndriySvyryd/following{/other_user}","gists_url":"https://api.github.com/users/AndriySvyryd/gists{/gist_id}","starred_url":"https://api.github.com/users/AndriySvyryd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AndriySvyryd/subscriptions","organizations_url":"https://api.github.com/users/AndriySvyryd/orgs","repos_url":"https://api.github.com/users/AndriySvyryd/repos","events_url":"https://api.github.com/users/AndriySvyryd/events{/privacy}","received_events_url":"https://api.github.com/users/AndriySvyryd/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":{"url":"https://api.github.com/repos/dotnet/efcore/milestones/204","html_url":"https://github.com/dotnet/efcore/milestone/204","labels_url":"https://api.github.com/repos/dotnet/efcore/milestones/204/labels","id":11480673,"node_id":"MI_kwDOAPaMMs4Ary5h","number":204,"title":"10.0.0","description":"","creator":{"login":"roji","id":1862641,"node_id":"MDQ6VXNlcjE4NjI2NDE=","avatar_url":"https://avatars.githubusercontent.com/u/1862641?v=4","gravatar_id":"","url":"https://api.github.com/users/roji","html_url":"https://github.com/roji","followers_url":"https://api.github.com/users/roji/followers","following_url":"https://api.github.com/users/roji/following{/other_user}","gists_url":"https://api.github.com/users/roji/gists{/gist_id}","starred_url":"https://api.github.com/users/roji/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roji/subscriptions","organizations_url":"https://api.github.com/users/roji/orgs","repos_url":"https://api.github.com/users/roji/repos","events_url":"https://api.github.com/users/roji/events{/privacy}","received_events_url":"https://api.github.com/users/roji/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":1,"closed_issues":193,"state":"open","created_at":"2024-08-23T12:48:26Z","updated_at":"2025-11-05T08:24:30Z","due_on":null,"closed_at":null},"comments":38,"created_at":"2024-11-13T16:18:14Z","updated_at":"2025-09-08T20:00:02Z","closed_at":"2025-08-27T19:52:52Z","author_association":"NONE","type":{"id":1092402,"node_id":"IT_kwDOAIt-yc4AEKsy","name":"Bug","description":"An unexpected problem or behavior","color":"red","created_at":"2024-01-25T11:45:43Z","updated_at":"2024-07-26T10:20:14Z","is_enabled":true},"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"repository":{"id":16157746,"node_id":"MDEwOlJlcG9zaXRvcnkxNjE1Nzc0Ng==","name":"efcore","full_name":"dotnet/efcore","private":false,"owner":{"login":"dotnet","id":9141961,"node_id":"MDEyOk9yZ2FuaXphdGlvbjkxNDE5NjE=","avatar_url":"https://avatars.githubusercontent.com/u/9141961?v=4","gravatar_id":"","url":"https://api.github.com/users/dotnet","html_url":"https://github.com/dotnet","followers_url":"https://api.github.com/users/dotnet/followers","following_url":"https://api.github.com/users/dotnet/following{/other_user}","gists_url":"https://api.github.com/users/dotnet/gists{/gist_id}","starred_url":"https://api.github.com/users/dotnet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dotnet/subscriptions","organizations_url":"https://api.github.com/users/dotnet/orgs","repos_url":"https://api.github.com/users/dotnet/repos","events_url":"https://api.github.com/users/dotnet/events{/privacy}","received_events_url":"https://api.github.com/users/dotnet/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/dotnet/efcore","description":"EF Core is a modern object-database mapper for .NET. It supports LINQ queries, change tracking, updates, and schema migrations.","fork":false,"url":"https://api.github.com/repos/dotnet/efcore","forks_url":"https://api.github.com/repos/dotnet/efcore/forks","keys_url":"https://api.github.com/repos/dotnet/efcore/keys{/key_id}","collaborators_url":"https://api.github.com/repos/dotnet/efcore/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/dotnet/efcore/teams","hooks_url":"https://api.github.com/repos/dotnet/efcore/hooks","issue_events_url":"https://api.github.com/repos/dotnet/efcore/issues/events{/number}","events_url":"https://api.github.com/repos/dotnet/efcore/events","assignees_url":"https://api.github.com/repos/dotnet/efcore/assignees{/user}","branches_url":"https://api.github.com/repos/dotnet/efcore/branches{/branch}","tags_url":"https://api.github.com/repos/dotnet/efcore/tags","blobs_url":"https://api.github.com/repos/dotnet/efcore/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/dotnet/efcore/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/dotnet/efcore/git/refs{/sha}","trees_url":"https://api.github.com/repos/dotnet/efcore/git/trees{/sha}","statuses_url":"https://api.github.com/repos/dotnet/efcore/statuses/{sha}","languages_url":"https://api.github.com/repos/dotnet/efcore/languages","stargazers_url":"https://api.github.com/repos/dotnet/efcore/stargazers","contributors_url":"https://api.github.com/repos/dotnet/efcore/contributors","subscribers_url":"https://api.github.com/repos/dotnet/efcore/subscribers","subscription_url":"https://api.github.com/repos/dotnet/efcore/subscription","commits_url":"https://api.github.com/repos/dotnet/efcore/commits{/sha}","git_commits_url":"https://api.github.com/repos/dotnet/efcore/git/commits{/sha}","comments_url":"https://api.github.com/repos/dotnet/efcore/comments{/number}","issue_comment_url":"https://api.github.com/repos/dotnet/efcore/issues/comments{/number}","contents_url":"https://api.github.com/repos/dotnet/efcore/contents/{+path}","compare_url":"https://api.github.com/repos/dotnet/efcore/compare/{base}...{head}","merges_url":"https://api.github.com/repos/dotnet/efcore/merges","archive_url":"https://api.github.com/repos/dotnet/efcore/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/dotnet/efcore/downloads","issues_url":"https://api.github.com/repos/dotnet/efcore/issues{/number}","pulls_url":"https://api.github.com/repos/dotnet/efcore/pulls{/number}","milestones_url":"https://api.github.com/repos/dotnet/efcore/milestones{/number}","notifications_url":"https://api.github.com/repos/dotnet/efcore/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/dotnet/efcore/labels{/name}","releases_url":"https://api.github.com/repos/dotnet/efcore/releases{/id}","deployments_url":"https://api.github.com/repos/dotnet/efcore/deployments","created_at":"2014-01-23T00:52:01Z","updated_at":"2025-11-10T14:21:49Z","pushed_at":"2025-11-10T05:59:58Z","git_url":"git://github.com/dotnet/efcore.git","ssh_url":"git@github.com:dotnet/efcore.git","clone_url":"https://github.com/dotnet/efcore.git","svn_url":"https://github.com/dotnet/efcore","homepage":"https://learn.microsoft.com/ef/","size":215987,"stargazers_count":14455,"watchers_count":14455,"language":"C#","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":3324,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":2430,"license":{"key":"mit","name":"MIT License","spdx_id":"MIT","url":"https://api.github.com/licenses/mit","node_id":"MDc6TGljZW5zZTEz"},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["aspnet-product","c-sharp","database","dotnet-core","dotnet-framework","dotnet-standard","entity-framework","hacktoberfest","orm"],"visibility":"public","forks":3324,"open_issues":2430,"watchers":14455,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"body":"Hi,\nI tried to migrate my solution to .NET 9, incl. EF Core 9 with SQL Server as the provider.\nSuddenly one of my migrations (old one from .NET 7 times) fails. I looked into the differences between the migration code and it appears that the transaction for migrations is now one large transaction per DbContext? and not one migration per .cs migration file.\n\nIf I modify my migration to use suppressTransaction: true from https://learn.microsoft.com/en-us/ef/core/managing-schemas/migrations/managing?tabs=dotnet-core-cli it works again.\n\nIs that an intended breaking change or some config parameter I missed in the migration?\n\nLog see below:\n\n.NET 8:\n```ini\n\n2024-11-13 15:52:31.8230 - Info  - ThreadId: 16 - TraceId: na - Identity: System - Migrations: Applying migration '20230313093754_RemoveNodesMetadataId'.\n2024-11-13 15:52:31.8230 - Debug - ThreadId: 16 - TraceId: na - Identity: System - Connection: Opening connection to database 'AnnotationsTestsDb' on server 'localhost'.\n2024-11-13 15:52:31.8230 - Debug - ThreadId: 16 - TraceId: na - Identity: System - Connection: Opened connection to database 'AnnotationsTestsDb' on server 'localhost'.\n2024-11-13 15:52:31.8230 - Debug - ThreadId: 16 - TraceId: na - Identity: System - Transaction: Beginning transaction with isolation level 'Unspecified'.\n2024-11-13 15:52:31.8230 - Debug - ThreadId: 16 - TraceId: na - Identity: System - Transaction: Began transaction with isolation level 'ReadCommitted'.\n2024-11-13 15:52:31.8230 - Debug - ThreadId: 16 - TraceId: na - Identity: System - Command: Creating DbCommand for 'ExecuteNonQuery'.\n2024-11-13 15:52:31.8230 - Debug - ThreadId: 16 - TraceId: na - Identity: System - Command: Created DbCommand for 'ExecuteNonQuery' (0ms).\n2024-11-13 15:52:31.8230 - Debug - ThreadId: 16 - TraceId: na - Identity: System - Command: Initialized DbCommand for 'ExecuteNonQuery' (0ms).\n2024-11-13 15:52:31.8230 - Debug - ThreadId: 16 - TraceId: na - Identity: System - Command: Executing DbCommand [Parameters=[], CommandType='Text', CommandTimeout='30']\n\nDECLARE @ToDeletePredecessor AS TVP_BIGINT;\nINSERT INTO @ToDeletePredecessor SELECT DISTINCT e.Id FROM isPredecessorOf e LEFT OUTER JOIN Nodes n1 ON n1.$node_id = e.$from_id LEFT OUTER JOIN Nodes n2 ON n2.$node_id = e.$to_id WHERE n1.Id IS NULL OR n2.Id IS NULL;\nDELETE FROM GraphPaths WHERE Id IN (SELECT [Value] FROM @ToDeletePredecessor);\nDELETE FROM isPredecessorOf WHERE Id IN (SELECT [Value] FROM @ToDeletePredecessor);\n2024-11-13 15:52:31.8230 - Info  - ThreadId: 19 - TraceId: na - Identity: System - Command: Executed DbCommand (10ms) [Parameters=[], CommandType='Text', CommandTimeout='30']\n\nDECLARE @ToDeletePredecessor AS TVP_BIGINT;\nINSERT INTO @ToDeletePredecessor SELECT DISTINCT e.Id FROM isPredecessorOf e LEFT OUTER JOIN Nodes n1 ON n1.$node_id = e.$from_id LEFT OUTER JOIN Nodes n2 ON n2.$node_id = e.$to_id WHERE n1.Id IS NULL OR n2.Id IS NULL;\nDELETE FROM GraphPaths WHERE Id IN (SELECT [Value] FROM @ToDeletePredecessor);\nDELETE FROM isPredecessorOf WHERE Id IN (SELECT [Value] FROM @ToDeletePredecessor);\n```\n\n.NET9:\n```ini\n\n2024-11-13 16:05:04.0882 - Info  - ThreadId: 15 - TraceId: na - Identity: System - Migrations: Applying migration '20230313093754_RemoveNodesMetadataId'.\n2024-11-13 16:05:04.0882 - Debug - ThreadId: 15 - TraceId: na - Identity: System - Command: Creating DbCommand for 'ExecuteNonQuery'.\n2024-11-13 16:05:04.0882 - Debug - ThreadId: 15 - TraceId: na - Identity: System - Command: Created DbCommand for 'ExecuteNonQuery' (0ms).\n2024-11-13 16:05:04.0882 - Debug - ThreadId: 15 - TraceId: na - Identity: System - Command: Initialized DbCommand for 'ExecuteNonQuery' (0ms).\n2024-11-13 16:05:04.0882 - Debug - ThreadId: 15 - TraceId: na - Identity: System - Command: Executing DbCommand [Parameters=[], CommandType='Text', CommandTimeout='30']\n\nDECLARE @ToDeletePredecessor AS TVP_BIGINT;\nINSERT INTO @ToDeletePredecessor SELECT DISTINCT e.Id FROM isPredecessorOf e LEFT OUTER JOIN Nodes n1 ON n1.$node_id = e.$from_id LEFT OUTER JOIN Nodes n2 ON n2.$node_id = e.$to_id WHERE n1.Id IS NULL OR n2.Id IS NULL;\nDELETE FROM GraphPaths WHERE Id IN (SELECT [Value] FROM @ToDeletePredecessor);\nDELETE FROM isPredecessorOf WHERE Id IN (SELECT [Value] FROM @ToDeletePredecessor)\n2024-11-13 16:05:05.1854 - Error - ThreadId: 15 - TraceId: na - Identity: System - Command: Failed executing DbCommand (1,091ms) [Parameters=[], CommandType='Text', CommandTimeout='30']\n\nDECLARE @ToDeletePredecessor AS TVP_BIGINT;\nINSERT INTO @ToDeletePredecessor SELECT DISTINCT e.Id FROM isPredecessorOf e LEFT OUTER JOIN Nodes n1 ON n1.$node_id = e.$from_id LEFT OUTER JOIN Nodes n2 ON n2.$node_id = e.$to_id WHERE n1.Id IS NULL OR n2.Id IS NULL;\nDELETE FROM GraphPaths WHERE Id IN (SELECT [Value] FROM @ToDeletePredecessor);\nDELETE FROM isPredecessorOf WHERE Id IN (SELECT [Value] FROM @ToDeletePredecessor)\n2024-11-13 16:05:05.1854 - Debug - ThreadId: 15 - TraceId: na - Identity: System - Transaction: Disposing transaction.\n```\n\n(I don't really know why this specific sql snippet fails in the existing migration and I have not really looked into that in any detail, I guess it might be related to the TVP not being available in that transaction, but that's just a wild guess).","reactions":{"url":"https://api.github.com/repos/dotnet/efcore/issues/35096/reactions","total_count":5,"+1":4,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":1},"timeline_url":"https://api.github.com/repos/dotnet/efcore/issues/35096/timeline","performed_via_github_app":null,"state_reason":"completed"}},"event":"cross-referenced"},{"url":"https://api.github.com/repos/dotnet/efcore/issues/comments/2504153412","html_url":"https://github.com/dotnet/efcore/issues/35162#issuecomment-2504153412","issue_url":"https://api.github.com/repos/dotnet/efcore/issues/35162","id":2504153412,"node_id":"IC_kwDOAPaMMs6VQllE","user":{"login":"roji","id":1862641,"node_id":"MDQ6VXNlcjE4NjI2NDE=","avatar_url":"https://avatars.githubusercontent.com/u/1862641?v=4","gravatar_id":"","url":"https://api.github.com/users/roji","html_url":"https://github.com/roji","followers_url":"https://api.github.com/users/roji/followers","following_url":"https://api.github.com/users/roji/following{/other_user}","gists_url":"https://api.github.com/users/roji/gists{/gist_id}","starred_url":"https://api.github.com/users/roji/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roji/subscriptions","organizations_url":"https://api.github.com/users/roji/orgs","repos_url":"https://api.github.com/users/roji/repos","events_url":"https://api.github.com/users/roji/events{/privacy}","received_events_url":"https://api.github.com/users/roji/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-11-27T15:24:18Z","updated_at":"2024-11-27T15:24:18Z","body":"Poaching (have a bit of extra capacity to help with 9.0 regressions for the 9.0.1 cutoff). Confirmed regression from 8.0 to 9.0.\n\n<details>\n<summary>Repro</summary>\n\n```c#\nawait using var context = new BlogContext();\nawait context.Database.EnsureDeletedAsync();\nawait context.Database.MigrateAsync();\n\npublic class BlogContext : DbContext\n{\n    public DbSet<Blog> Blogs { get; set; }\n\n    protected override void OnConfiguring(DbContextOptionsBuilder optionsBuilder)\n        => optionsBuilder\n            .UseSqlServer(\"Server=localhost;Database=test;User=SA;Password=Abcd5678;Connect Timeout=60;ConnectRetryCount=0;Encrypt=false\")\n            .LogTo(Console.WriteLine, LogLevel.Information)\n            .EnableSensitiveDataLogging();\n}\n\npublic class Blog\n{\n    public int Id { get; set; }\n    public string Name { get; set; }\n}\n```\n\nGenerate an initial migration for the above, then add another empty migration, and paste the following into it:\n\n```c#\n            migrationBuilder.DropTable(\n                name: \"Blogs\");\n\n            migrationBuilder.CreateTable(\n                name: \"Blogs\",\n                columns: table => new\n                {\n                    Id = table.Column<int>(type: \"int\", nullable: false)\n                        .Annotation(\"SqlServer:Identity\", \"1, 1\"),\n                    Name = table.Column<string>(type: \"nvarchar(max)\", nullable: false)\n                },\n                constraints: table =>\n                {\n                    table.PrimaryKey(\"PK_Blogs\", x => x.Id);\n                });\n```\n\n</details>","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/dotnet/efcore/issues/comments/2504153412/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"roji","id":1862641,"node_id":"MDQ6VXNlcjE4NjI2NDE=","avatar_url":"https://avatars.githubusercontent.com/u/1862641?v=4","gravatar_id":"","url":"https://api.github.com/users/roji","html_url":"https://github.com/roji","followers_url":"https://api.github.com/users/roji/followers","following_url":"https://api.github.com/users/roji/following{/other_user}","gists_url":"https://api.github.com/users/roji/gists{/gist_id}","starred_url":"https://api.github.com/users/roji/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roji/subscriptions","organizations_url":"https://api.github.com/users/roji/orgs","repos_url":"https://api.github.com/users/roji/repos","events_url":"https://api.github.com/users/roji/events{/privacy}","received_events_url":"https://api.github.com/users/roji/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":15454325878,"node_id":"AE_lADOAPaMMs6fji4zzwAAAAOZJkx2","url":"https://api.github.com/repos/dotnet/efcore/issues/events/15454325878","actor":{"login":"roji","id":1862641,"node_id":"MDQ6VXNlcjE4NjI2NDE=","avatar_url":"https://avatars.githubusercontent.com/u/1862641?v=4","gravatar_id":"","url":"https://api.github.com/users/roji","html_url":"https://github.com/roji","followers_url":"https://api.github.com/users/roji/followers","following_url":"https://api.github.com/users/roji/following{/other_user}","gists_url":"https://api.github.com/users/roji/gists{/gist_id}","starred_url":"https://api.github.com/users/roji/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roji/subscriptions","organizations_url":"https://api.github.com/users/roji/orgs","repos_url":"https://api.github.com/users/roji/repos","events_url":"https://api.github.com/users/roji/events{/privacy}","received_events_url":"https://api.github.com/users/roji/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"assigned","commit_id":null,"commit_url":null,"created_at":"2024-11-27T15:24:23Z","assignee":{"login":"roji","id":1862641,"node_id":"MDQ6VXNlcjE4NjI2NDE=","avatar_url":"https://avatars.githubusercontent.com/u/1862641?v=4","gravatar_id":"","url":"https://api.github.com/users/roji","html_url":"https://github.com/roji","followers_url":"https://api.github.com/users/roji/followers","following_url":"https://api.github.com/users/roji/following{/other_user}","gists_url":"https://api.github.com/users/roji/gists{/gist_id}","starred_url":"https://api.github.com/users/roji/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roji/subscriptions","organizations_url":"https://api.github.com/users/roji/orgs","repos_url":"https://api.github.com/users/roji/repos","events_url":"https://api.github.com/users/roji/events{/privacy}","received_events_url":"https://api.github.com/users/roji/received_events","type":"User","user_view_type":"public","site_admin":false},"performed_via_github_app":null},{"id":15454325930,"node_id":"UNE_lADOAPaMMs6fji4zzwAAAAOZJkyq","url":"https://api.github.com/repos/dotnet/efcore/issues/events/15454325930","actor":{"login":"roji","id":1862641,"node_id":"MDQ6VXNlcjE4NjI2NDE=","avatar_url":"https://avatars.githubusercontent.com/u/1862641?v=4","gravatar_id":"","url":"https://api.github.com/users/roji","html_url":"https://github.com/roji","followers_url":"https://api.github.com/users/roji/followers","following_url":"https://api.github.com/users/roji/following{/other_user}","gists_url":"https://api.github.com/users/roji/gists{/gist_id}","starred_url":"https://api.github.com/users/roji/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roji/subscriptions","organizations_url":"https://api.github.com/users/roji/orgs","repos_url":"https://api.github.com/users/roji/repos","events_url":"https://api.github.com/users/roji/events{/privacy}","received_events_url":"https://api.github.com/users/roji/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"unassigned","commit_id":null,"commit_url":null,"created_at":"2024-11-27T15:24:23Z","assignee":{"login":"maumar","id":1591930,"node_id":"MDQ6VXNlcjE1OTE5MzA=","avatar_url":"https://avatars.githubusercontent.com/u/1591930?v=4","gravatar_id":"","url":"https://api.github.com/users/maumar","html_url":"https://github.com/maumar","followers_url":"https://api.github.com/users/maumar/followers","following_url":"https://api.github.com/users/maumar/following{/other_user}","gists_url":"https://api.github.com/users/maumar/gists{/gist_id}","starred_url":"https://api.github.com/users/maumar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/maumar/subscriptions","organizations_url":"https://api.github.com/users/maumar/orgs","repos_url":"https://api.github.com/users/maumar/repos","events_url":"https://api.github.com/users/maumar/events{/privacy}","received_events_url":"https://api.github.com/users/maumar/received_events","type":"User","user_view_type":"public","site_admin":false},"performed_via_github_app":null},{"id":15454327242,"node_id":"LE_lADOAPaMMs6fji4zzwAAAAOZJlHK","url":"https://api.github.com/repos/dotnet/efcore/issues/events/15454327242","actor":{"login":"roji","id":1862641,"node_id":"MDQ6VXNlcjE4NjI2NDE=","avatar_url":"https://avatars.githubusercontent.com/u/1862641?v=4","gravatar_id":"","url":"https://api.github.com/users/roji","html_url":"https://github.com/roji","followers_url":"https://api.github.com/users/roji/followers","following_url":"https://api.github.com/users/roji/following{/other_user}","gists_url":"https://api.github.com/users/roji/gists{/gist_id}","starred_url":"https://api.github.com/users/roji/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roji/subscriptions","organizations_url":"https://api.github.com/users/roji/orgs","repos_url":"https://api.github.com/users/roji/repos","events_url":"https://api.github.com/users/roji/events{/privacy}","received_events_url":"https://api.github.com/users/roji/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2024-11-27T15:24:27Z","label":{"name":"regression","color":"ff1fff"},"performed_via_github_app":null},{"id":15454329444,"node_id":"LE_lADOAPaMMs6fji4zzwAAAAOZJlpk","url":"https://api.github.com/repos/dotnet/efcore/issues/events/15454329444","actor":{"login":"roji","id":1862641,"node_id":"MDQ6VXNlcjE4NjI2NDE=","avatar_url":"https://avatars.githubusercontent.com/u/1862641?v=4","gravatar_id":"","url":"https://api.github.com/users/roji","html_url":"https://github.com/roji","followers_url":"https://api.github.com/users/roji/followers","following_url":"https://api.github.com/users/roji/following{/other_user}","gists_url":"https://api.github.com/users/roji/gists{/gist_id}","starred_url":"https://api.github.com/users/roji/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roji/subscriptions","organizations_url":"https://api.github.com/users/roji/orgs","repos_url":"https://api.github.com/users/roji/repos","events_url":"https://api.github.com/users/roji/events{/privacy}","received_events_url":"https://api.github.com/users/roji/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2024-11-27T15:24:35Z","label":{"name":"type-bug","color":"f7c6c7"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/dotnet/efcore/issues/comments/2504312274","html_url":"https://github.com/dotnet/efcore/issues/35162#issuecomment-2504312274","issue_url":"https://api.github.com/repos/dotnet/efcore/issues/35162","id":2504312274,"node_id":"IC_kwDOAPaMMs6VRMXS","user":{"login":"roji","id":1862641,"node_id":"MDQ6VXNlcjE4NjI2NDE=","avatar_url":"https://avatars.githubusercontent.com/u/1862641?v=4","gravatar_id":"","url":"https://api.github.com/users/roji","html_url":"https://github.com/roji","followers_url":"https://api.github.com/users/roji/followers","following_url":"https://api.github.com/users/roji/following{/other_user}","gists_url":"https://api.github.com/users/roji/gists{/gist_id}","starred_url":"https://api.github.com/users/roji/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roji/subscriptions","organizations_url":"https://api.github.com/users/roji/orgs","repos_url":"https://api.github.com/users/roji/repos","events_url":"https://api.github.com/users/roji/events{/privacy}","received_events_url":"https://api.github.com/users/roji/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-11-27T16:31:56Z","updated_at":"2024-11-27T16:31:56Z","body":"@meghanmae and @AnthonyDewhirst, can you please confirm how you ended up with a single migration that has a DropTable and then a CreateTable on the same migration? Is this the result of manual editing of the migration, or did EF generate this itself? If it's the latter, can you provide more info on that?","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/dotnet/efcore/issues/comments/2504312274/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"roji","id":1862641,"node_id":"MDQ6VXNlcjE4NjI2NDE=","avatar_url":"https://avatars.githubusercontent.com/u/1862641?v=4","gravatar_id":"","url":"https://api.github.com/users/roji","html_url":"https://github.com/roji","followers_url":"https://api.github.com/users/roji/followers","following_url":"https://api.github.com/users/roji/following{/other_user}","gists_url":"https://api.github.com/users/roji/gists{/gist_id}","starred_url":"https://api.github.com/users/roji/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roji/subscriptions","organizations_url":"https://api.github.com/users/roji/orgs","repos_url":"https://api.github.com/users/roji/repos","events_url":"https://api.github.com/users/roji/events{/privacy}","received_events_url":"https://api.github.com/users/roji/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":15455207108,"node_id":"MEE_lADOAPaMMs6fji4zzwAAAAOZM77E","url":"https://api.github.com/repos/dotnet/efcore/issues/events/15455207108","actor":{"login":"AnthonyDewhirst","id":642569,"node_id":"MDQ6VXNlcjY0MjU2OQ==","avatar_url":"https://avatars.githubusercontent.com/u/642569?v=4","gravatar_id":"","url":"https://api.github.com/users/AnthonyDewhirst","html_url":"https://github.com/AnthonyDewhirst","followers_url":"https://api.github.com/users/AnthonyDewhirst/followers","following_url":"https://api.github.com/users/AnthonyDewhirst/following{/other_user}","gists_url":"https://api.github.com/users/AnthonyDewhirst/gists{/gist_id}","starred_url":"https://api.github.com/users/AnthonyDewhirst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AnthonyDewhirst/subscriptions","organizations_url":"https://api.github.com/users/AnthonyDewhirst/orgs","repos_url":"https://api.github.com/users/AnthonyDewhirst/repos","events_url":"https://api.github.com/users/AnthonyDewhirst/events{/privacy}","received_events_url":"https://api.github.com/users/AnthonyDewhirst/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2024-11-27T16:31:58Z","performed_via_github_app":null},{"id":15455207123,"node_id":"SE_lADOAPaMMs6fji4zzwAAAAOZM77T","url":"https://api.github.com/repos/dotnet/efcore/issues/events/15455207123","actor":{"login":"AnthonyDewhirst","id":642569,"node_id":"MDQ6VXNlcjY0MjU2OQ==","avatar_url":"https://avatars.githubusercontent.com/u/642569?v=4","gravatar_id":"","url":"https://api.github.com/users/AnthonyDewhirst","html_url":"https://github.com/AnthonyDewhirst","followers_url":"https://api.github.com/users/AnthonyDewhirst/followers","following_url":"https://api.github.com/users/AnthonyDewhirst/following{/other_user}","gists_url":"https://api.github.com/users/AnthonyDewhirst/gists{/gist_id}","starred_url":"https://api.github.com/users/AnthonyDewhirst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AnthonyDewhirst/subscriptions","organizations_url":"https://api.github.com/users/AnthonyDewhirst/orgs","repos_url":"https://api.github.com/users/AnthonyDewhirst/repos","events_url":"https://api.github.com/users/AnthonyDewhirst/events{/privacy}","received_events_url":"https://api.github.com/users/AnthonyDewhirst/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2024-11-27T16:31:58Z","performed_via_github_app":null},{"id":15455207142,"node_id":"MEE_lADOAPaMMs6fji4zzwAAAAOZM77m","url":"https://api.github.com/repos/dotnet/efcore/issues/events/15455207142","actor":{"login":"meghanmae","id":43832670,"node_id":"MDQ6VXNlcjQzODMyNjcw","avatar_url":"https://avatars.githubusercontent.com/u/43832670?v=4","gravatar_id":"","url":"https://api.github.com/users/meghanmae","html_url":"https://github.com/meghanmae","followers_url":"https://api.github.com/users/meghanmae/followers","following_url":"https://api.github.com/users/meghanmae/following{/other_user}","gists_url":"https://api.github.com/users/meghanmae/gists{/gist_id}","starred_url":"https://api.github.com/users/meghanmae/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/meghanmae/subscriptions","organizations_url":"https://api.github.com/users/meghanmae/orgs","repos_url":"https://api.github.com/users/meghanmae/repos","events_url":"https://api.github.com/users/meghanmae/events{/privacy}","received_events_url":"https://api.github.com/users/meghanmae/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2024-11-27T16:31:58Z","performed_via_github_app":null},{"id":15455207155,"node_id":"SE_lADOAPaMMs6fji4zzwAAAAOZM77z","url":"https://api.github.com/repos/dotnet/efcore/issues/events/15455207155","actor":{"login":"meghanmae","id":43832670,"node_id":"MDQ6VXNlcjQzODMyNjcw","avatar_url":"https://avatars.githubusercontent.com/u/43832670?v=4","gravatar_id":"","url":"https://api.github.com/users/meghanmae","html_url":"https://github.com/meghanmae","followers_url":"https://api.github.com/users/meghanmae/followers","following_url":"https://api.github.com/users/meghanmae/following{/other_user}","gists_url":"https://api.github.com/users/meghanmae/gists{/gist_id}","starred_url":"https://api.github.com/users/meghanmae/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/meghanmae/subscriptions","organizations_url":"https://api.github.com/users/meghanmae/orgs","repos_url":"https://api.github.com/users/meghanmae/repos","events_url":"https://api.github.com/users/meghanmae/events{/privacy}","received_events_url":"https://api.github.com/users/meghanmae/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2024-11-27T16:31:58Z","performed_via_github_app":null},{"id":15455291961,"node_id":"REFE_lADOAPaMMs6fji4zzwAAAAOZNQo5","url":"https://api.github.com/repos/dotnet/efcore/issues/events/15455291961","actor":{"login":"roji","id":1862641,"node_id":"MDQ6VXNlcjE4NjI2NDE=","avatar_url":"https://avatars.githubusercontent.com/u/1862641?v=4","gravatar_id":"","url":"https://api.github.com/users/roji","html_url":"https://github.com/roji","followers_url":"https://api.github.com/users/roji/followers","following_url":"https://api.github.com/users/roji/following{/other_user}","gists_url":"https://api.github.com/users/roji/gists{/gist_id}","starred_url":"https://api.github.com/users/roji/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roji/subscriptions","organizations_url":"https://api.github.com/users/roji/orgs","repos_url":"https://api.github.com/users/roji/repos","events_url":"https://api.github.com/users/roji/events{/privacy}","received_events_url":"https://api.github.com/users/roji/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"36dc641dc8a6270c29bc9745429a3be6e4ec23e4","commit_url":"https://api.github.com/repos/roji/efcore/commits/36dc641dc8a6270c29bc9745429a3be6e4ec23e4","created_at":"2024-11-27T16:39:21Z","performed_via_github_app":null},{"actor":{"login":"roji","id":1862641,"node_id":"MDQ6VXNlcjE4NjI2NDE=","avatar_url":"https://avatars.githubusercontent.com/u/1862641?v=4","gravatar_id":"","url":"https://api.github.com/users/roji","html_url":"https://github.com/roji","followers_url":"https://api.github.com/users/roji/followers","following_url":"https://api.github.com/users/roji/following{/other_user}","gists_url":"https://api.github.com/users/roji/gists{/gist_id}","starred_url":"https://api.github.com/users/roji/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roji/subscriptions","organizations_url":"https://api.github.com/users/roji/orgs","repos_url":"https://api.github.com/users/roji/repos","events_url":"https://api.github.com/users/roji/events{/privacy}","received_events_url":"https://api.github.com/users/roji/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-11-27T16:43:13Z","updated_at":"2024-11-27T16:43:13Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/dotnet/efcore/issues/32239","repository_url":"https://api.github.com/repos/dotnet/efcore","labels_url":"https://api.github.com/repos/dotnet/efcore/issues/32239/labels{/name}","comments_url":"https://api.github.com/repos/dotnet/efcore/issues/32239/comments","events_url":"https://api.github.com/repos/dotnet/efcore/issues/32239/events","html_url":"https://github.com/dotnet/efcore/pull/32239","id":1978449112,"node_id":"PR_kwDOAPaMMs5epr36","number":32239,"title":"Temporal table migrations refactor.","user":{"login":"maumar","id":1591930,"node_id":"MDQ6VXNlcjE1OTE5MzA=","avatar_url":"https://avatars.githubusercontent.com/u/1591930?v=4","gravatar_id":"","url":"https://api.github.com/users/maumar","html_url":"https://github.com/maumar","followers_url":"https://api.github.com/users/maumar/followers","following_url":"https://api.github.com/users/maumar/following{/other_user}","gists_url":"https://api.github.com/users/maumar/gists{/gist_id}","starred_url":"https://api.github.com/users/maumar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/maumar/subscriptions","organizations_url":"https://api.github.com/users/maumar/orgs","repos_url":"https://api.github.com/users/maumar/repos","events_url":"https://api.github.com/users/maumar/events{/privacy}","received_events_url":"https://api.github.com/users/maumar/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2023-11-06T07:13:21Z","updated_at":"2024-11-27T16:43:12Z","closed_at":"2023-11-13T23:14:28Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"draft":false,"repository":{"id":16157746,"node_id":"MDEwOlJlcG9zaXRvcnkxNjE1Nzc0Ng==","name":"efcore","full_name":"dotnet/efcore","private":false,"owner":{"login":"dotnet","id":9141961,"node_id":"MDEyOk9yZ2FuaXphdGlvbjkxNDE5NjE=","avatar_url":"https://avatars.githubusercontent.com/u/9141961?v=4","gravatar_id":"","url":"https://api.github.com/users/dotnet","html_url":"https://github.com/dotnet","followers_url":"https://api.github.com/users/dotnet/followers","following_url":"https://api.github.com/users/dotnet/following{/other_user}","gists_url":"https://api.github.com/users/dotnet/gists{/gist_id}","starred_url":"https://api.github.com/users/dotnet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dotnet/subscriptions","organizations_url":"https://api.github.com/users/dotnet/orgs","repos_url":"https://api.github.com/users/dotnet/repos","events_url":"https://api.github.com/users/dotnet/events{/privacy}","received_events_url":"https://api.github.com/users/dotnet/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/dotnet/efcore","description":"EF Core is a modern object-database mapper for .NET. It supports LINQ queries, change tracking, updates, and schema migrations.","fork":false,"url":"https://api.github.com/repos/dotnet/efcore","forks_url":"https://api.github.com/repos/dotnet/efcore/forks","keys_url":"https://api.github.com/repos/dotnet/efcore/keys{/key_id}","collaborators_url":"https://api.github.com/repos/dotnet/efcore/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/dotnet/efcore/teams","hooks_url":"https://api.github.com/repos/dotnet/efcore/hooks","issue_events_url":"https://api.github.com/repos/dotnet/efcore/issues/events{/number}","events_url":"https://api.github.com/repos/dotnet/efcore/events","assignees_url":"https://api.github.com/repos/dotnet/efcore/assignees{/user}","branches_url":"https://api.github.com/repos/dotnet/efcore/branches{/branch}","tags_url":"https://api.github.com/repos/dotnet/efcore/tags","blobs_url":"https://api.github.com/repos/dotnet/efcore/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/dotnet/efcore/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/dotnet/efcore/git/refs{/sha}","trees_url":"https://api.github.com/repos/dotnet/efcore/git/trees{/sha}","statuses_url":"https://api.github.com/repos/dotnet/efcore/statuses/{sha}","languages_url":"https://api.github.com/repos/dotnet/efcore/languages","stargazers_url":"https://api.github.com/repos/dotnet/efcore/stargazers","contributors_url":"https://api.github.com/repos/dotnet/efcore/contributors","subscribers_url":"https://api.github.com/repos/dotnet/efcore/subscribers","subscription_url":"https://api.github.com/repos/dotnet/efcore/subscription","commits_url":"https://api.github.com/repos/dotnet/efcore/commits{/sha}","git_commits_url":"https://api.github.com/repos/dotnet/efcore/git/commits{/sha}","comments_url":"https://api.github.com/repos/dotnet/efcore/comments{/number}","issue_comment_url":"https://api.github.com/repos/dotnet/efcore/issues/comments{/number}","contents_url":"https://api.github.com/repos/dotnet/efcore/contents/{+path}","compare_url":"https://api.github.com/repos/dotnet/efcore/compare/{base}...{head}","merges_url":"https://api.github.com/repos/dotnet/efcore/merges","archive_url":"https://api.github.com/repos/dotnet/efcore/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/dotnet/efcore/downloads","issues_url":"https://api.github.com/repos/dotnet/efcore/issues{/number}","pulls_url":"https://api.github.com/repos/dotnet/efcore/pulls{/number}","milestones_url":"https://api.github.com/repos/dotnet/efcore/milestones{/number}","notifications_url":"https://api.github.com/repos/dotnet/efcore/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/dotnet/efcore/labels{/name}","releases_url":"https://api.github.com/repos/dotnet/efcore/releases{/id}","deployments_url":"https://api.github.com/repos/dotnet/efcore/deployments","created_at":"2014-01-23T00:52:01Z","updated_at":"2025-11-10T14:21:49Z","pushed_at":"2025-11-10T05:59:58Z","git_url":"git://github.com/dotnet/efcore.git","ssh_url":"git@github.com:dotnet/efcore.git","clone_url":"https://github.com/dotnet/efcore.git","svn_url":"https://github.com/dotnet/efcore","homepage":"https://learn.microsoft.com/ef/","size":215987,"stargazers_count":14455,"watchers_count":14455,"language":"C#","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":3324,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":2430,"license":{"key":"mit","name":"MIT License","spdx_id":"MIT","url":"https://api.github.com/licenses/mit","node_id":"MDc6TGljZW5zZTEz"},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["aspnet-product","c-sharp","database","dotnet-core","dotnet-framework","dotnet-standard","entity-framework","hacktoberfest","orm"],"visibility":"public","forks":3324,"open_issues":2430,"watchers":14455,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/dotnet/efcore/pulls/32239","html_url":"https://github.com/dotnet/efcore/pull/32239","diff_url":"https://github.com/dotnet/efcore/pull/32239.diff","patch_url":"https://github.com/dotnet/efcore/pull/32239.patch","merged_at":"2023-11-13T23:14:28Z"},"body":"Before we used to put temporal annotations on temporal tables and all their columns, so that it's easier to process. Problem was that this would generate very noisy migrations when converting from regular table to temporal and vice versa. Every column would have an AlterColumn operation (which we would ignore during processing, but they were nonetheless generated in migration files). Also, we were using relatively simple logic to track state of our temporal tables. Some operations require temporary disabling of the versioning/period, and we need to keep track of that so that we don't try to disable period twice, or forget to enable it later. The way we did it could lead to invalid SQL in some non-trivial scenarios (e.g. converting table to temporal and adding a new column at the same time)\r\n\r\nThe new approach is to only put temporal annotations on the table itself, and the period columns. Regular columns of the temporal table don't have any temporal annotations on them anymore and we reason about temporal information based on other table-based migration operation in the batch and, if need be, on the relational model. We also keep track of the actual temporal information for every operation (rather than keeping global dictionaries of period/version), so that complex migrations, involving multiple operations are more robust. To achieve that we compute the initial (temporal) state of all the tables involved in the migration. We scan all the table operations, and if some info is missing we get it from relational model. Then we do the proper processing of the migration operations - when we encounter table operation, we update the temporal information for that table (since table operations contain relevant temporal annotations). For all other operations we extract the current temporal state for the table involved, and reason based on that info.\r\n\r\nFixes #27459 - SQL Server Migrations: Review temporal table annotations \r\nFixes #29536 - EF Core IsTemporal() creates huge migration \r\nFixes #29799 - EF7 SqlServer Migration is trying to update columns on History table before creating the History table if any new columns are added in the same migration\r\n","reactions":{"url":"https://api.github.com/repos/dotnet/efcore/issues/32239/reactions","total_count":2,"+1":0,"-1":0,"laugh":0,"hooray":2,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/dotnet/efcore/issues/32239/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"actor":{"login":"roji","id":1862641,"node_id":"MDQ6VXNlcjE4NjI2NDE=","avatar_url":"https://avatars.githubusercontent.com/u/1862641?v=4","gravatar_id":"","url":"https://api.github.com/users/roji","html_url":"https://github.com/roji","followers_url":"https://api.github.com/users/roji/followers","following_url":"https://api.github.com/users/roji/following{/other_user}","gists_url":"https://api.github.com/users/roji/gists{/gist_id}","starred_url":"https://api.github.com/users/roji/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roji/subscriptions","organizations_url":"https://api.github.com/users/roji/orgs","repos_url":"https://api.github.com/users/roji/repos","events_url":"https://api.github.com/users/roji/events{/privacy}","received_events_url":"https://api.github.com/users/roji/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-11-27T16:48:37Z","updated_at":"2024-11-27T16:48:37Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/dotnet/efcore/issues/35225","repository_url":"https://api.github.com/repos/dotnet/efcore","labels_url":"https://api.github.com/repos/dotnet/efcore/issues/35225/labels{/name}","comments_url":"https://api.github.com/repos/dotnet/efcore/issues/35225/comments","events_url":"https://api.github.com/repos/dotnet/efcore/issues/35225/events","html_url":"https://github.com/dotnet/efcore/pull/35225","id":2699158278,"node_id":"PR_kwDOAPaMMs6DXOaw","number":35225,"title":"Temporary fix for DropTable/CreateTable issue around temporal tables","user":{"login":"roji","id":1862641,"node_id":"MDQ6VXNlcjE4NjI2NDE=","avatar_url":"https://avatars.githubusercontent.com/u/1862641?v=4","gravatar_id":"","url":"https://api.github.com/users/roji","html_url":"https://github.com/roji","followers_url":"https://api.github.com/users/roji/followers","following_url":"https://api.github.com/users/roji/following{/other_user}","gists_url":"https://api.github.com/users/roji/gists{/gist_id}","starred_url":"https://api.github.com/users/roji/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roji/subscriptions","organizations_url":"https://api.github.com/users/roji/orgs","repos_url":"https://api.github.com/users/roji/repos","events_url":"https://api.github.com/users/roji/events{/privacy}","received_events_url":"https://api.github.com/users/roji/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2024-11-27T16:48:36Z","updated_at":"2025-06-13T06:32:14Z","closed_at":"2024-12-03T18:08:44Z","author_association":"MEMBER","type":null,"active_lock_reason":null,"draft":true,"repository":{"id":16157746,"node_id":"MDEwOlJlcG9zaXRvcnkxNjE1Nzc0Ng==","name":"efcore","full_name":"dotnet/efcore","private":false,"owner":{"login":"dotnet","id":9141961,"node_id":"MDEyOk9yZ2FuaXphdGlvbjkxNDE5NjE=","avatar_url":"https://avatars.githubusercontent.com/u/9141961?v=4","gravatar_id":"","url":"https://api.github.com/users/dotnet","html_url":"https://github.com/dotnet","followers_url":"https://api.github.com/users/dotnet/followers","following_url":"https://api.github.com/users/dotnet/following{/other_user}","gists_url":"https://api.github.com/users/dotnet/gists{/gist_id}","starred_url":"https://api.github.com/users/dotnet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dotnet/subscriptions","organizations_url":"https://api.github.com/users/dotnet/orgs","repos_url":"https://api.github.com/users/dotnet/repos","events_url":"https://api.github.com/users/dotnet/events{/privacy}","received_events_url":"https://api.github.com/users/dotnet/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/dotnet/efcore","description":"EF Core is a modern object-database mapper for .NET. It supports LINQ queries, change tracking, updates, and schema migrations.","fork":false,"url":"https://api.github.com/repos/dotnet/efcore","forks_url":"https://api.github.com/repos/dotnet/efcore/forks","keys_url":"https://api.github.com/repos/dotnet/efcore/keys{/key_id}","collaborators_url":"https://api.github.com/repos/dotnet/efcore/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/dotnet/efcore/teams","hooks_url":"https://api.github.com/repos/dotnet/efcore/hooks","issue_events_url":"https://api.github.com/repos/dotnet/efcore/issues/events{/number}","events_url":"https://api.github.com/repos/dotnet/efcore/events","assignees_url":"https://api.github.com/repos/dotnet/efcore/assignees{/user}","branches_url":"https://api.github.com/repos/dotnet/efcore/branches{/branch}","tags_url":"https://api.github.com/repos/dotnet/efcore/tags","blobs_url":"https://api.github.com/repos/dotnet/efcore/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/dotnet/efcore/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/dotnet/efcore/git/refs{/sha}","trees_url":"https://api.github.com/repos/dotnet/efcore/git/trees{/sha}","statuses_url":"https://api.github.com/repos/dotnet/efcore/statuses/{sha}","languages_url":"https://api.github.com/repos/dotnet/efcore/languages","stargazers_url":"https://api.github.com/repos/dotnet/efcore/stargazers","contributors_url":"https://api.github.com/repos/dotnet/efcore/contributors","subscribers_url":"https://api.github.com/repos/dotnet/efcore/subscribers","subscription_url":"https://api.github.com/repos/dotnet/efcore/subscription","commits_url":"https://api.github.com/repos/dotnet/efcore/commits{/sha}","git_commits_url":"https://api.github.com/repos/dotnet/efcore/git/commits{/sha}","comments_url":"https://api.github.com/repos/dotnet/efcore/comments{/number}","issue_comment_url":"https://api.github.com/repos/dotnet/efcore/issues/comments{/number}","contents_url":"https://api.github.com/repos/dotnet/efcore/contents/{+path}","compare_url":"https://api.github.com/repos/dotnet/efcore/compare/{base}...{head}","merges_url":"https://api.github.com/repos/dotnet/efcore/merges","archive_url":"https://api.github.com/repos/dotnet/efcore/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/dotnet/efcore/downloads","issues_url":"https://api.github.com/repos/dotnet/efcore/issues{/number}","pulls_url":"https://api.github.com/repos/dotnet/efcore/pulls{/number}","milestones_url":"https://api.github.com/repos/dotnet/efcore/milestones{/number}","notifications_url":"https://api.github.com/repos/dotnet/efcore/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/dotnet/efcore/labels{/name}","releases_url":"https://api.github.com/repos/dotnet/efcore/releases{/id}","deployments_url":"https://api.github.com/repos/dotnet/efcore/deployments","created_at":"2014-01-23T00:52:01Z","updated_at":"2025-11-10T14:21:49Z","pushed_at":"2025-11-10T05:59:58Z","git_url":"git://github.com/dotnet/efcore.git","ssh_url":"git@github.com:dotnet/efcore.git","clone_url":"https://github.com/dotnet/efcore.git","svn_url":"https://github.com/dotnet/efcore","homepage":"https://learn.microsoft.com/ef/","size":215987,"stargazers_count":14455,"watchers_count":14455,"language":"C#","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":3324,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":2430,"license":{"key":"mit","name":"MIT License","spdx_id":"MIT","url":"https://api.github.com/licenses/mit","node_id":"MDc6TGljZW5zZTEz"},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["aspnet-product","c-sharp","database","dotnet-core","dotnet-framework","dotnet-standard","entity-framework","hacktoberfest","orm"],"visibility":"public","forks":3324,"open_issues":2430,"watchers":14455,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/dotnet/efcore/pulls/35225","html_url":"https://github.com/dotnet/efcore/pull/35225","diff_url":"https://github.com/dotnet/efcore/pull/35225.diff","patch_url":"https://github.com/dotnet/efcore/pull/35225.patch","merged_at":null},"body":"@maumar this is a bug in #32239, which I think is the result of a wider design issue in that PR; the trigger is simply having a DropTable followed by a CreateTable in the same migration. Your second processing loop for temporal tables ([code](https://github.com/dotnet/efcore/pull/32239/files#r1860979159)) removes the temporal data from the table when it sees the DropTable, and when we get to the CreateTable we get an exception since there's no data at that point ([code](https://github.com/dotnet/efcore/pull/32239/files#diff-c80a80f96194920fd36fd4daaa22d80408aaa7f083128172c4c05331f0b92de0R2483)).\r\n\r\nThe hacky fix proposed here - which is probably OK for patching - is to simply not remove the data when we see DropTable, ensuring that it's still there when the CreateTable is processed. We've got two user reports on #35162; am waiting to hear how they got to having DropTable/CreateTable in the same migration in order to better understand how critical this bug is.\r\n\r\nHowever, I think the design here is fundamentally problematic; you can't really do a pass over all operations (and then over the model for missing ones), storing the temporal data in a single dictionary; a single migration can create and drop the same table multiple times, each time with completely different temporal data. The current design flattens all that out, so that when you process e.g. the 1st CreateTable, you actually see the temporal data from the last CreateTable. IMHO the correct design here would be to have a single pass, extracting the temporal data when you see e.g. CreateTable, and remember it in the dictionary. If you have reach a table operation which **doesn't** contain temporal data, and don't have data in the dictionary (no e.g. CreateTable was present in the migration before), at that point you can consult the model, and again store the data in the dictionary. This way you always have the correct, up-to-date temporal data in the dictionary, as you're advancing in a single pass through all migration operations.\r\n\r\n\r\nFixes #35162\r\n","reactions":{"url":"https://api.github.com/repos/dotnet/efcore/issues/35225/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/dotnet/efcore/issues/35225/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"url":"https://api.github.com/repos/dotnet/efcore/issues/comments/2504479324","html_url":"https://github.com/dotnet/efcore/issues/35162#issuecomment-2504479324","issue_url":"https://api.github.com/repos/dotnet/efcore/issues/35162","id":2504479324,"node_id":"IC_kwDOAPaMMs6VR1Jc","user":{"login":"AnthonyDewhirst","id":642569,"node_id":"MDQ6VXNlcjY0MjU2OQ==","avatar_url":"https://avatars.githubusercontent.com/u/642569?v=4","gravatar_id":"","url":"https://api.github.com/users/AnthonyDewhirst","html_url":"https://github.com/AnthonyDewhirst","followers_url":"https://api.github.com/users/AnthonyDewhirst/followers","following_url":"https://api.github.com/users/AnthonyDewhirst/following{/other_user}","gists_url":"https://api.github.com/users/AnthonyDewhirst/gists{/gist_id}","starred_url":"https://api.github.com/users/AnthonyDewhirst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AnthonyDewhirst/subscriptions","organizations_url":"https://api.github.com/users/AnthonyDewhirst/orgs","repos_url":"https://api.github.com/users/AnthonyDewhirst/repos","events_url":"https://api.github.com/users/AnthonyDewhirst/events{/privacy}","received_events_url":"https://api.github.com/users/AnthonyDewhirst/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-11-27T17:53:54Z","updated_at":"2024-11-27T17:53:54Z","body":"Hi @roji apologise once more...\n\nBy the time I got this all fixed which included rolling back a migration in code to see what 9.0.0 generated, I realise that there should never have been a drop table. This was a case of 2 of my devs doing competing work and checking the code in and fixing it, by instead of deleting the migrations and crafting one again, by hand manipulating the files.\n\nSo, yep, our bad, not something should have ever made it passed a PR but had worked previously. I used the raw sql work around. But it's on my todo list to go generate the migrations properly. It's live so I need to be careful, but I think it's straight forward.\n\nSo from my perspective, this is user error and not an issue we have with ef core. \n\nI did mean to write this in early and was also on my todo list.\n\nThanks for the great work, much appreciated!","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/dotnet/efcore/issues/comments/2504479324/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":1,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"AnthonyDewhirst","id":642569,"node_id":"MDQ6VXNlcjY0MjU2OQ==","avatar_url":"https://avatars.githubusercontent.com/u/642569?v=4","gravatar_id":"","url":"https://api.github.com/users/AnthonyDewhirst","html_url":"https://github.com/AnthonyDewhirst","followers_url":"https://api.github.com/users/AnthonyDewhirst/followers","following_url":"https://api.github.com/users/AnthonyDewhirst/following{/other_user}","gists_url":"https://api.github.com/users/AnthonyDewhirst/gists{/gist_id}","starred_url":"https://api.github.com/users/AnthonyDewhirst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AnthonyDewhirst/subscriptions","organizations_url":"https://api.github.com/users/AnthonyDewhirst/orgs","repos_url":"https://api.github.com/users/AnthonyDewhirst/repos","events_url":"https://api.github.com/users/AnthonyDewhirst/events{/privacy}","received_events_url":"https://api.github.com/users/AnthonyDewhirst/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":15456073810,"node_id":"MEE_lADOAPaMMs6fji4zzwAAAAOZQPhS","url":"https://api.github.com/repos/dotnet/efcore/issues/events/15456073810","actor":{"login":"roji","id":1862641,"node_id":"MDQ6VXNlcjE4NjI2NDE=","avatar_url":"https://avatars.githubusercontent.com/u/1862641?v=4","gravatar_id":"","url":"https://api.github.com/users/roji","html_url":"https://github.com/roji","followers_url":"https://api.github.com/users/roji/followers","following_url":"https://api.github.com/users/roji/following{/other_user}","gists_url":"https://api.github.com/users/roji/gists{/gist_id}","starred_url":"https://api.github.com/users/roji/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roji/subscriptions","organizations_url":"https://api.github.com/users/roji/orgs","repos_url":"https://api.github.com/users/roji/repos","events_url":"https://api.github.com/users/roji/events{/privacy}","received_events_url":"https://api.github.com/users/roji/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2024-11-27T17:53:55Z","performed_via_github_app":null},{"id":15456073821,"node_id":"SE_lADOAPaMMs6fji4zzwAAAAOZQPhd","url":"https://api.github.com/repos/dotnet/efcore/issues/events/15456073821","actor":{"login":"roji","id":1862641,"node_id":"MDQ6VXNlcjE4NjI2NDE=","avatar_url":"https://avatars.githubusercontent.com/u/1862641?v=4","gravatar_id":"","url":"https://api.github.com/users/roji","html_url":"https://github.com/roji","followers_url":"https://api.github.com/users/roji/followers","following_url":"https://api.github.com/users/roji/following{/other_user}","gists_url":"https://api.github.com/users/roji/gists{/gist_id}","starred_url":"https://api.github.com/users/roji/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roji/subscriptions","organizations_url":"https://api.github.com/users/roji/orgs","repos_url":"https://api.github.com/users/roji/repos","events_url":"https://api.github.com/users/roji/events{/privacy}","received_events_url":"https://api.github.com/users/roji/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2024-11-27T17:53:55Z","performed_via_github_app":null},{"id":15498707224,"node_id":"AE_lADOAPaMMs6fji4zzwAAAAOby4EY","url":"https://api.github.com/repos/dotnet/efcore/issues/events/15498707224","actor":{"login":"ajcvickers","id":1430078,"node_id":"MDQ6VXNlcjE0MzAwNzg=","avatar_url":"https://avatars.githubusercontent.com/u/1430078?v=4","gravatar_id":"","url":"https://api.github.com/users/ajcvickers","html_url":"https://github.com/ajcvickers","followers_url":"https://api.github.com/users/ajcvickers/followers","following_url":"https://api.github.com/users/ajcvickers/following{/other_user}","gists_url":"https://api.github.com/users/ajcvickers/gists{/gist_id}","starred_url":"https://api.github.com/users/ajcvickers/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajcvickers/subscriptions","organizations_url":"https://api.github.com/users/ajcvickers/orgs","repos_url":"https://api.github.com/users/ajcvickers/repos","events_url":"https://api.github.com/users/ajcvickers/events{/privacy}","received_events_url":"https://api.github.com/users/ajcvickers/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"assigned","commit_id":null,"commit_url":null,"created_at":"2024-12-02T20:02:43Z","assignee":{"login":"maumar","id":1591930,"node_id":"MDQ6VXNlcjE1OTE5MzA=","avatar_url":"https://avatars.githubusercontent.com/u/1591930?v=4","gravatar_id":"","url":"https://api.github.com/users/maumar","html_url":"https://github.com/maumar","followers_url":"https://api.github.com/users/maumar/followers","following_url":"https://api.github.com/users/maumar/following{/other_user}","gists_url":"https://api.github.com/users/maumar/gists{/gist_id}","starred_url":"https://api.github.com/users/maumar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/maumar/subscriptions","organizations_url":"https://api.github.com/users/maumar/orgs","repos_url":"https://api.github.com/users/maumar/repos","events_url":"https://api.github.com/users/maumar/events{/privacy}","received_events_url":"https://api.github.com/users/maumar/received_events","type":"User","user_view_type":"public","site_admin":false},"performed_via_github_app":null},{"id":15498707806,"node_id":"UNE_lADOAPaMMs6fji4zzwAAAAOby4Ne","url":"https://api.github.com/repos/dotnet/efcore/issues/events/15498707806","actor":{"login":"ajcvickers","id":1430078,"node_id":"MDQ6VXNlcjE0MzAwNzg=","avatar_url":"https://avatars.githubusercontent.com/u/1430078?v=4","gravatar_id":"","url":"https://api.github.com/users/ajcvickers","html_url":"https://github.com/ajcvickers","followers_url":"https://api.github.com/users/ajcvickers/followers","following_url":"https://api.github.com/users/ajcvickers/following{/other_user}","gists_url":"https://api.github.com/users/ajcvickers/gists{/gist_id}","starred_url":"https://api.github.com/users/ajcvickers/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajcvickers/subscriptions","organizations_url":"https://api.github.com/users/ajcvickers/orgs","repos_url":"https://api.github.com/users/ajcvickers/repos","events_url":"https://api.github.com/users/ajcvickers/events{/privacy}","received_events_url":"https://api.github.com/users/ajcvickers/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"unassigned","commit_id":null,"commit_url":null,"created_at":"2024-12-02T20:02:47Z","assignee":{"login":"roji","id":1862641,"node_id":"MDQ6VXNlcjE4NjI2NDE=","avatar_url":"https://avatars.githubusercontent.com/u/1862641?v=4","gravatar_id":"","url":"https://api.github.com/users/roji","html_url":"https://github.com/roji","followers_url":"https://api.github.com/users/roji/followers","following_url":"https://api.github.com/users/roji/following{/other_user}","gists_url":"https://api.github.com/users/roji/gists{/gist_id}","starred_url":"https://api.github.com/users/roji/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roji/subscriptions","organizations_url":"https://api.github.com/users/roji/orgs","repos_url":"https://api.github.com/users/roji/repos","events_url":"https://api.github.com/users/roji/events{/privacy}","received_events_url":"https://api.github.com/users/roji/received_events","type":"User","user_view_type":"public","site_admin":false},"performed_via_github_app":null},{"id":15510033835,"node_id":"SE_lADOAPaMMs6fji4zzwAAAAOceFWr","url":"https://api.github.com/repos/dotnet/efcore/issues/events/15510033835","actor":{"login":"joakimriedel","id":429478,"node_id":"MDQ6VXNlcjQyOTQ3OA==","avatar_url":"https://avatars.githubusercontent.com/u/429478?v=4","gravatar_id":"","url":"https://api.github.com/users/joakimriedel","html_url":"https://github.com/joakimriedel","followers_url":"https://api.github.com/users/joakimriedel/followers","following_url":"https://api.github.com/users/joakimriedel/following{/other_user}","gists_url":"https://api.github.com/users/joakimriedel/gists{/gist_id}","starred_url":"https://api.github.com/users/joakimriedel/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/joakimriedel/subscriptions","organizations_url":"https://api.github.com/users/joakimriedel/orgs","repos_url":"https://api.github.com/users/joakimriedel/repos","events_url":"https://api.github.com/users/joakimriedel/events{/privacy}","received_events_url":"https://api.github.com/users/joakimriedel/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2024-12-03T13:43:18Z","performed_via_github_app":null},{"id":15537339363,"node_id":"MIE_lADOAPaMMs6fji4zzwAAAAOeGPvj","url":"https://api.github.com/repos/dotnet/efcore/issues/events/15537339363","actor":{"login":"maumar","id":1591930,"node_id":"MDQ6VXNlcjE1OTE5MzA=","avatar_url":"https://avatars.githubusercontent.com/u/1591930?v=4","gravatar_id":"","url":"https://api.github.com/users/maumar","html_url":"https://github.com/maumar","followers_url":"https://api.github.com/users/maumar/followers","following_url":"https://api.github.com/users/maumar/following{/other_user}","gists_url":"https://api.github.com/users/maumar/gists{/gist_id}","starred_url":"https://api.github.com/users/maumar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/maumar/subscriptions","organizations_url":"https://api.github.com/users/maumar/orgs","repos_url":"https://api.github.com/users/maumar/repos","events_url":"https://api.github.com/users/maumar/events{/privacy}","received_events_url":"https://api.github.com/users/maumar/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"milestoned","commit_id":null,"commit_url":null,"created_at":"2024-12-05T06:49:37Z","milestone":{"title":"10.0.0"},"performed_via_github_app":null},{"id":15619459811,"node_id":"SE_lADOAPaMMs6fji4zzwAAAAOi_grj","url":"https://api.github.com/repos/dotnet/efcore/issues/events/15619459811","actor":{"login":"sgluca","id":33540946,"node_id":"MDQ6VXNlcjMzNTQwOTQ2","avatar_url":"https://avatars.githubusercontent.com/u/33540946?v=4","gravatar_id":"","url":"https://api.github.com/users/sgluca","html_url":"https://github.com/sgluca","followers_url":"https://api.github.com/users/sgluca/followers","following_url":"https://api.github.com/users/sgluca/following{/other_user}","gists_url":"https://api.github.com/users/sgluca/gists{/gist_id}","starred_url":"https://api.github.com/users/sgluca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sgluca/subscriptions","organizations_url":"https://api.github.com/users/sgluca/orgs","repos_url":"https://api.github.com/users/sgluca/repos","events_url":"https://api.github.com/users/sgluca/events{/privacy}","received_events_url":"https://api.github.com/users/sgluca/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2024-12-11T14:18:26Z","performed_via_github_app":null},{"actor":{"login":"roji","id":1862641,"node_id":"MDQ6VXNlcjE4NjI2NDE=","avatar_url":"https://avatars.githubusercontent.com/u/1862641?v=4","gravatar_id":"","url":"https://api.github.com/users/roji","html_url":"https://github.com/roji","followers_url":"https://api.github.com/users/roji/followers","following_url":"https://api.github.com/users/roji/following{/other_user}","gists_url":"https://api.github.com/users/roji/gists{/gist_id}","starred_url":"https://api.github.com/users/roji/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roji/subscriptions","organizations_url":"https://api.github.com/users/roji/orgs","repos_url":"https://api.github.com/users/roji/repos","events_url":"https://api.github.com/users/roji/events{/privacy}","received_events_url":"https://api.github.com/users/roji/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-12T23:00:34Z","updated_at":"2024-12-12T23:00:34Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/dotnet/efcore/issues/35323","repository_url":"https://api.github.com/repos/dotnet/efcore","labels_url":"https://api.github.com/repos/dotnet/efcore/issues/35323/labels{/name}","comments_url":"https://api.github.com/repos/dotnet/efcore/issues/35323/comments","events_url":"https://api.github.com/repos/dotnet/efcore/issues/35323/events","html_url":"https://github.com/dotnet/efcore/issues/35323","id":2736129750,"node_id":"I_kwDOAPaMMs6jFgbW","number":35323,"title":"Existing Migration file which renames table from XXX to YYY and creates a new table XXX produces KeyNotFoundException","user":{"login":"trancefreak77","id":8483337,"node_id":"MDQ6VXNlcjg0ODMzMzc=","avatar_url":"https://avatars.githubusercontent.com/u/8483337?v=4","gravatar_id":"","url":"https://api.github.com/users/trancefreak77","html_url":"https://github.com/trancefreak77","followers_url":"https://api.github.com/users/trancefreak77/followers","following_url":"https://api.github.com/users/trancefreak77/following{/other_user}","gists_url":"https://api.github.com/users/trancefreak77/gists{/gist_id}","starred_url":"https://api.github.com/users/trancefreak77/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/trancefreak77/subscriptions","organizations_url":"https://api.github.com/users/trancefreak77/orgs","repos_url":"https://api.github.com/users/trancefreak77/repos","events_url":"https://api.github.com/users/trancefreak77/events{/privacy}","received_events_url":"https://api.github.com/users/trancefreak77/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":514908713,"node_id":"MDU6TGFiZWw1MTQ5MDg3MTM=","url":"https://api.github.com/repos/dotnet/efcore/labels/regression","name":"regression","color":"ff1fff","default":false,"description":null},{"id":936619505,"node_id":"MDU6TGFiZWw5MzY2MTk1MDU=","url":"https://api.github.com/repos/dotnet/efcore/labels/customer-reported","name":"customer-reported","color":"a4a5f9","default":false,"description":""},{"id":1900942474,"node_id":"MDU6TGFiZWwxOTAwOTQyNDc0","url":"https://api.github.com/repos/dotnet/efcore/labels/area-migrations","name":"area-migrations","color":"32b37b","default":false,"description":""},{"id":4528277234,"node_id":"LA_kwDOAPaMMs8AAAABDegG8g","url":"https://api.github.com/repos/dotnet/efcore/labels/area-temporal-tables","name":"area-temporal-tables","color":"32b37b","default":false,"description":""}],"state":"closed","locked":false,"assignee":{"login":"maumar","id":1591930,"node_id":"MDQ6VXNlcjE1OTE5MzA=","avatar_url":"https://avatars.githubusercontent.com/u/1591930?v=4","gravatar_id":"","url":"https://api.github.com/users/maumar","html_url":"https://github.com/maumar","followers_url":"https://api.github.com/users/maumar/followers","following_url":"https://api.github.com/users/maumar/following{/other_user}","gists_url":"https://api.github.com/users/maumar/gists{/gist_id}","starred_url":"https://api.github.com/users/maumar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/maumar/subscriptions","organizations_url":"https://api.github.com/users/maumar/orgs","repos_url":"https://api.github.com/users/maumar/repos","events_url":"https://api.github.com/users/maumar/events{/privacy}","received_events_url":"https://api.github.com/users/maumar/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"maumar","id":1591930,"node_id":"MDQ6VXNlcjE1OTE5MzA=","avatar_url":"https://avatars.githubusercontent.com/u/1591930?v=4","gravatar_id":"","url":"https://api.github.com/users/maumar","html_url":"https://github.com/maumar","followers_url":"https://api.github.com/users/maumar/followers","following_url":"https://api.github.com/users/maumar/following{/other_user}","gists_url":"https://api.github.com/users/maumar/gists{/gist_id}","starred_url":"https://api.github.com/users/maumar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/maumar/subscriptions","organizations_url":"https://api.github.com/users/maumar/orgs","repos_url":"https://api.github.com/users/maumar/repos","events_url":"https://api.github.com/users/maumar/events{/privacy}","received_events_url":"https://api.github.com/users/maumar/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":null,"comments":3,"created_at":"2024-12-12T14:50:39Z","updated_at":"2025-06-16T19:44:45Z","closed_at":"2025-03-12T08:23:09Z","author_association":"NONE","type":{"id":1092402,"node_id":"IT_kwDOAIt-yc4AEKsy","name":"Bug","description":"An unexpected problem or behavior","color":"red","created_at":"2024-01-25T11:45:43Z","updated_at":"2024-07-26T10:20:14Z","is_enabled":true},"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"repository":{"id":16157746,"node_id":"MDEwOlJlcG9zaXRvcnkxNjE1Nzc0Ng==","name":"efcore","full_name":"dotnet/efcore","private":false,"owner":{"login":"dotnet","id":9141961,"node_id":"MDEyOk9yZ2FuaXphdGlvbjkxNDE5NjE=","avatar_url":"https://avatars.githubusercontent.com/u/9141961?v=4","gravatar_id":"","url":"https://api.github.com/users/dotnet","html_url":"https://github.com/dotnet","followers_url":"https://api.github.com/users/dotnet/followers","following_url":"https://api.github.com/users/dotnet/following{/other_user}","gists_url":"https://api.github.com/users/dotnet/gists{/gist_id}","starred_url":"https://api.github.com/users/dotnet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dotnet/subscriptions","organizations_url":"https://api.github.com/users/dotnet/orgs","repos_url":"https://api.github.com/users/dotnet/repos","events_url":"https://api.github.com/users/dotnet/events{/privacy}","received_events_url":"https://api.github.com/users/dotnet/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/dotnet/efcore","description":"EF Core is a modern object-database mapper for .NET. It supports LINQ queries, change tracking, updates, and schema migrations.","fork":false,"url":"https://api.github.com/repos/dotnet/efcore","forks_url":"https://api.github.com/repos/dotnet/efcore/forks","keys_url":"https://api.github.com/repos/dotnet/efcore/keys{/key_id}","collaborators_url":"https://api.github.com/repos/dotnet/efcore/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/dotnet/efcore/teams","hooks_url":"https://api.github.com/repos/dotnet/efcore/hooks","issue_events_url":"https://api.github.com/repos/dotnet/efcore/issues/events{/number}","events_url":"https://api.github.com/repos/dotnet/efcore/events","assignees_url":"https://api.github.com/repos/dotnet/efcore/assignees{/user}","branches_url":"https://api.github.com/repos/dotnet/efcore/branches{/branch}","tags_url":"https://api.github.com/repos/dotnet/efcore/tags","blobs_url":"https://api.github.com/repos/dotnet/efcore/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/dotnet/efcore/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/dotnet/efcore/git/refs{/sha}","trees_url":"https://api.github.com/repos/dotnet/efcore/git/trees{/sha}","statuses_url":"https://api.github.com/repos/dotnet/efcore/statuses/{sha}","languages_url":"https://api.github.com/repos/dotnet/efcore/languages","stargazers_url":"https://api.github.com/repos/dotnet/efcore/stargazers","contributors_url":"https://api.github.com/repos/dotnet/efcore/contributors","subscribers_url":"https://api.github.com/repos/dotnet/efcore/subscribers","subscription_url":"https://api.github.com/repos/dotnet/efcore/subscription","commits_url":"https://api.github.com/repos/dotnet/efcore/commits{/sha}","git_commits_url":"https://api.github.com/repos/dotnet/efcore/git/commits{/sha}","comments_url":"https://api.github.com/repos/dotnet/efcore/comments{/number}","issue_comment_url":"https://api.github.com/repos/dotnet/efcore/issues/comments{/number}","contents_url":"https://api.github.com/repos/dotnet/efcore/contents/{+path}","compare_url":"https://api.github.com/repos/dotnet/efcore/compare/{base}...{head}","merges_url":"https://api.github.com/repos/dotnet/efcore/merges","archive_url":"https://api.github.com/repos/dotnet/efcore/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/dotnet/efcore/downloads","issues_url":"https://api.github.com/repos/dotnet/efcore/issues{/number}","pulls_url":"https://api.github.com/repos/dotnet/efcore/pulls{/number}","milestones_url":"https://api.github.com/repos/dotnet/efcore/milestones{/number}","notifications_url":"https://api.github.com/repos/dotnet/efcore/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/dotnet/efcore/labels{/name}","releases_url":"https://api.github.com/repos/dotnet/efcore/releases{/id}","deployments_url":"https://api.github.com/repos/dotnet/efcore/deployments","created_at":"2014-01-23T00:52:01Z","updated_at":"2025-11-10T14:21:49Z","pushed_at":"2025-11-10T05:59:58Z","git_url":"git://github.com/dotnet/efcore.git","ssh_url":"git@github.com:dotnet/efcore.git","clone_url":"https://github.com/dotnet/efcore.git","svn_url":"https://github.com/dotnet/efcore","homepage":"https://learn.microsoft.com/ef/","size":215987,"stargazers_count":14455,"watchers_count":14455,"language":"C#","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":3324,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":2430,"license":{"key":"mit","name":"MIT License","spdx_id":"MIT","url":"https://api.github.com/licenses/mit","node_id":"MDc6TGljZW5zZTEz"},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["aspnet-product","c-sharp","database","dotnet-core","dotnet-framework","dotnet-standard","entity-framework","hacktoberfest","orm"],"visibility":"public","forks":3324,"open_issues":2430,"watchers":14455,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"body":"EF Core 9.0.0 seems to have introduced a bug which was not present in previous versions.\nOur existing migration file has the following content:\n\n```csharp\nusing Microsoft.EntityFrameworkCore.Migrations;\n\nnamespace Authorization.Infrastructure.Migrations\n{\n    public partial class AdaptEntitiesForNewEndpoints : Migration\n    {\n        protected override void Up(MigrationBuilder migrationBuilder)\n        {\n            migrationBuilder.DropForeignKey(\n                name: \"FK_ModulePermission_Module_ModuleId\",\n                schema: \"authorization\",\n                table: \"ModulePermission\");\n\n            migrationBuilder.RenameTable(\n                name: \"Module\",\n                newName: \"ModuleGroup\",\n                newSchema: \"authorization\",\n                schema: \"authorization\");\n\n            migrationBuilder.CreateTable(\n              name: \"Module\",\n              schema: \"authorization\",\n              columns: table => new\n                                {\n                                  Id = table.Column<int>(type: \"int\", nullable: false)\n                                    .Annotation(\"SqlServer:Identity\", \"1, 1\"),\n                                  ModuleId = table.Column<string>(type: \"nvarchar(max)\", nullable: true)\n                                },\n              constraints: table =>\n              {\n                table.PrimaryKey(\"PK_Module\", x => x.Id)\n                  .Annotation(\"SqlServer:Clustered\", true);\n              });\n```\n\nAs you can see our migration file (created by EFCore, code first) contains a\n> RenameTable from Module to ModuleGroup\n\nThe next command is a\n> CreateTable Module\n\nSo the old existing Module table should be renamed to ModuleGroup and a new table also named Module should be created.\nThis constellation produces a\n> KeyNotFoundException\n\nThe error is in class SqlServerMigrationsSqlGenerator.\nBelow code is directly from the SqlServerMigrationsSqlGenerator class. You see that the first RenameTable operation is addressed in the switch/case block\n```csharp\n                case RenameTableOperation renameTableOperation:\n                {\n                    if (temporalInformation is null)\n                    {\n                        temporalInformation = BuildTemporalInformationFromMigrationOperation(schema, renameTableOperation);\n                    }\n\n                    var isTemporalTable = renameTableOperation[SqlServerAnnotationNames.IsTemporal] as bool? == true;\n                    if (isTemporalTable)\n                    {\n                        DisableVersioning(\n                            tableName,\n                            schema,\n                            temporalInformation,\n                            suppressTransaction,\n                            shouldEnableVersioning: true);\n                    }\n\n                    operations.Add(operation);\n\n                    // since table was renamed, update entry in the temporal info map\n                    temporalTableInformationMap[(renameTableOperation.NewName!, renameTableOperation.NewSchema)] = temporalInformation;\n                    temporalTableInformationMap.Remove((tableName, schema));\n\n                    break;\n                }\n```\nIn this case block the table name is removed from dictionary temporalTableInformationMap (You can see the full code posted below).\n\nThe next foreach loop (foreach (var operation in migrationOperations)) addresses the CreateTable operation with the same name as the renamed one.\n\nThis code then produces the KeyNotFoundException because the temporalTableInformationMap does no longer contain an entry for table name \"Module\" in the dict \"temporalTableInformationMap\" because it has been removed from the dict in the prior loop (renameTable operation).\n```csharp\n            // we are guaranteed to find entry here - we looped through all the operations earlier,\n            // info missing from operations we got from the model\n            // and in case of no/incomplete model we created dummy (non-temporal) entries\n            var temporalInformation = temporalTableInformationMap[(tableName, rawSchema)];\n```\n\nSo it is definitely not guaranteed that the entry is present in the temporalTableInformationMap as stated in the comment above.\n\nBelow you can find the complete snippet from class SqlServerMigrationsSqlGenerator.\n\n```csharp\n        // now we do proper processing - for table operations we look at the annotations on them\n        // and continuously update the stored temporal info as the table is being modified\n        // for column (and other) operations we don't have annotations on them, so we look into the\n        // information we stored in the initial pass and updated in when processing table ops that happened earlier\n        foreach (var operation in migrationOperations)\n        {\n            if (operation is EnsureSchemaOperation ensureSchemaOperation)\n            {\n                availableSchemas.Add(ensureSchemaOperation.Name);\n            }\n\n            if (operation is not ITableMigrationOperation tableMigrationOperation)\n            {\n                operations.Add(operation);\n                continue;\n            }\n\n            var tableName = tableMigrationOperation.Table;\n            var rawSchema = tableMigrationOperation.Schema;\n\n            var suppressTransaction = IsMemoryOptimized(operation, model, rawSchema, tableName);\n\n            var schema = rawSchema ?? model?.GetDefaultSchema();\n\n            // we are guaranteed to find entry here - we looped through all the operations earlier,\n            // info missing from operations we got from the model\n            // and in case of no/incomplete model we created dummy (non-temporal) entries\n            var temporalInformation = temporalTableInformationMap[(tableName, rawSchema)];\n\n            switch (operation)\n            {\n                case CreateTableOperation createTableOperation:\n                {\n                    // for create table we always generate new temporal information from the operation itself\n                    // just in case there was a table with that name before that got deleted/renamed\n                    // this shouldn't happen as we re-use existing tables rather than drop/recreate\n                    // but we are being extra defensive here\n                    // and also, temporal state (disabled versioning etc.) should always reset when creating a table\n                    temporalInformation = BuildTemporalInformationFromMigrationOperation(schema, createTableOperation);\n\n                    if (temporalInformation.IsTemporalTable\n                        && temporalInformation.HistoryTableSchema != schema\n                        && temporalInformation.HistoryTableSchema != null\n                        && !availableSchemas.Contains(temporalInformation.HistoryTableSchema))\n                    {\n                        operations.Add(new EnsureSchemaOperation { Name = temporalInformation.HistoryTableSchema });\n                        availableSchemas.Add(temporalInformation.HistoryTableSchema);\n                    }\n\n                    operations.Add(operation);\n\n                    break;\n                }\n\n                case DropTableOperation dropTableOperation:\n                {\n                    var isTemporalTable = dropTableOperation[SqlServerAnnotationNames.IsTemporal] as bool? == true;\n                    if (isTemporalTable)\n                    {\n                        // if we don't have temporal information, but we know table is temporal\n                        // (based on the annotation found on the operation itself)\n                        // we assume that versioning must be disabled, if we have temporal info we can check properly\n                        if (temporalInformation is null || !temporalInformation.DisabledVersioning)\n                        {\n                            AddDisableVersioningOperation(tableName, schema, suppressTransaction);\n                        }\n\n                        if (temporalInformation is not null)\n                        {\n                            temporalInformation.ShouldEnableVersioning = false;\n                            temporalInformation.ShouldEnablePeriod = false;\n                        }\n\n                        operations.Add(operation);\n\n                        var historyTableName = dropTableOperation[SqlServerAnnotationNames.TemporalHistoryTableName] as string;\n                        var historyTableSchema =\n                            dropTableOperation[SqlServerAnnotationNames.TemporalHistoryTableSchema] as string ?? schema;\n                        var dropHistoryTableOperation = new DropTableOperation { Name = historyTableName!, Schema = historyTableSchema };\n                        operations.Add(dropHistoryTableOperation);\n                    }\n                    else\n                    {\n                        operations.Add(operation);\n                    }\n\n                    // we removed the table, so we no longer need it's temporal information\n                    // there will be no more operations involving this table\n                    temporalTableInformationMap.Remove((tableName, schema));\n\n                    break;\n                }\n\n                case RenameTableOperation renameTableOperation:\n                {\n                    if (temporalInformation is null)\n                    {\n                        temporalInformation = BuildTemporalInformationFromMigrationOperation(schema, renameTableOperation);\n                    }\n\n                    var isTemporalTable = renameTableOperation[SqlServerAnnotationNames.IsTemporal] as bool? == true;\n                    if (isTemporalTable)\n                    {\n                        DisableVersioning(\n                            tableName,\n                            schema,\n                            temporalInformation,\n                            suppressTransaction,\n                            shouldEnableVersioning: true);\n                    }\n\n                    operations.Add(operation);\n\n                    // since table was renamed, update entry in the temporal info map\n                    temporalTableInformationMap[(renameTableOperation.NewName!, renameTableOperation.NewSchema)] = temporalInformation;\n                    temporalTableInformationMap.Remove((tableName, schema));\n\n                    break;\n                }\n```\n\nPlease let me know if you need additional information.\n\n------\n\nEF Core version: 9.0.0\nDatabase provider: Microsoft.EntityFrameworkCore.SqlServer\nTarget framework: .NET8.0\nOperating system: Windows\nIDE: Visual Studio 2022 17.12.3\n","reactions":{"url":"https://api.github.com/repos/dotnet/efcore/issues/35323/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/dotnet/efcore/issues/35323/timeline","performed_via_github_app":null,"state_reason":"duplicate"}},"event":"cross-referenced"},{"id":15740722182,"node_id":"SE_lADOAPaMMs6fji4zzwAAAAOqOFwG","url":"https://api.github.com/repos/dotnet/efcore/issues/events/15740722182","actor":{"login":"abrovko","id":22479803,"node_id":"MDQ6VXNlcjIyNDc5ODAz","avatar_url":"https://avatars.githubusercontent.com/u/22479803?v=4","gravatar_id":"","url":"https://api.github.com/users/abrovko","html_url":"https://github.com/abrovko","followers_url":"https://api.github.com/users/abrovko/followers","following_url":"https://api.github.com/users/abrovko/following{/other_user}","gists_url":"https://api.github.com/users/abrovko/gists{/gist_id}","starred_url":"https://api.github.com/users/abrovko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/abrovko/subscriptions","organizations_url":"https://api.github.com/users/abrovko/orgs","repos_url":"https://api.github.com/users/abrovko/repos","events_url":"https://api.github.com/users/abrovko/events{/privacy}","received_events_url":"https://api.github.com/users/abrovko/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2024-12-22T03:03:27Z","performed_via_github_app":null}]