{"url":"https://api.github.com/repos/dotnet/efcore/issues/35391","repository_url":"https://api.github.com/repos/dotnet/efcore","labels_url":"https://api.github.com/repos/dotnet/efcore/issues/35391/labels{/name}","comments_url":"https://api.github.com/repos/dotnet/efcore/issues/35391/comments","events_url":"https://api.github.com/repos/dotnet/efcore/issues/35391/events","html_url":"https://github.com/dotnet/efcore/issues/35391","id":2763214316,"node_id":"I_kwDOAPaMMs6ks03s","number":35391,"title":"sqlite migrations: replacing primary key with an autoincrement identity fails","user":{"login":"jhgbrt","id":126034,"node_id":"MDQ6VXNlcjEyNjAzNA==","avatar_url":"https://avatars.githubusercontent.com/u/126034?v=4","gravatar_id":"","url":"https://api.github.com/users/jhgbrt","html_url":"https://github.com/jhgbrt","followers_url":"https://api.github.com/users/jhgbrt/followers","following_url":"https://api.github.com/users/jhgbrt/following{/other_user}","gists_url":"https://api.github.com/users/jhgbrt/gists{/gist_id}","starred_url":"https://api.github.com/users/jhgbrt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jhgbrt/subscriptions","organizations_url":"https://api.github.com/users/jhgbrt/orgs","repos_url":"https://api.github.com/users/jhgbrt/repos","events_url":"https://api.github.com/users/jhgbrt/events{/privacy}","received_events_url":"https://api.github.com/users/jhgbrt/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":936619505,"node_id":"MDU6TGFiZWw5MzY2MTk1MDU=","url":"https://api.github.com/repos/dotnet/efcore/labels/customer-reported","name":"customer-reported","color":"a4a5f9","default":false,"description":""},{"id":1900942474,"node_id":"MDU6TGFiZWwxOTAwOTQyNDc0","url":"https://api.github.com/repos/dotnet/efcore/labels/area-migrations","name":"area-migrations","color":"32b37b","default":false,"description":""},{"id":9022438466,"node_id":"LA_kwDOAPaMMs8AAAACGcd8Qg","url":"https://api.github.com/repos/dotnet/efcore/labels/rc-2","name":"rc-2","color":"ACB3D7","default":false,"description":""}],"state":"closed","locked":false,"assignee":{"login":"AndriySvyryd","id":6539701,"node_id":"MDQ6VXNlcjY1Mzk3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6539701?v=4","gravatar_id":"","url":"https://api.github.com/users/AndriySvyryd","html_url":"https://github.com/AndriySvyryd","followers_url":"https://api.github.com/users/AndriySvyryd/followers","following_url":"https://api.github.com/users/AndriySvyryd/following{/other_user}","gists_url":"https://api.github.com/users/AndriySvyryd/gists{/gist_id}","starred_url":"https://api.github.com/users/AndriySvyryd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AndriySvyryd/subscriptions","organizations_url":"https://api.github.com/users/AndriySvyryd/orgs","repos_url":"https://api.github.com/users/AndriySvyryd/repos","events_url":"https://api.github.com/users/AndriySvyryd/events{/privacy}","received_events_url":"https://api.github.com/users/AndriySvyryd/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"AndriySvyryd","id":6539701,"node_id":"MDQ6VXNlcjY1Mzk3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6539701?v=4","gravatar_id":"","url":"https://api.github.com/users/AndriySvyryd","html_url":"https://github.com/AndriySvyryd","followers_url":"https://api.github.com/users/AndriySvyryd/followers","following_url":"https://api.github.com/users/AndriySvyryd/following{/other_user}","gists_url":"https://api.github.com/users/AndriySvyryd/gists{/gist_id}","starred_url":"https://api.github.com/users/AndriySvyryd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AndriySvyryd/subscriptions","organizations_url":"https://api.github.com/users/AndriySvyryd/orgs","repos_url":"https://api.github.com/users/AndriySvyryd/repos","events_url":"https://api.github.com/users/AndriySvyryd/events{/privacy}","received_events_url":"https://api.github.com/users/AndriySvyryd/received_events","type":"User","user_view_type":"public","site_admin":false},{"login":"Copilot","id":198982749,"node_id":"BOT_kgDOC9w8XQ","avatar_url":"https://avatars.githubusercontent.com/in/1143301?v=4","gravatar_id":"","url":"https://api.github.com/users/Copilot","html_url":"https://github.com/apps/copilot-swe-agent","followers_url":"https://api.github.com/users/Copilot/followers","following_url":"https://api.github.com/users/Copilot/following{/other_user}","gists_url":"https://api.github.com/users/Copilot/gists{/gist_id}","starred_url":"https://api.github.com/users/Copilot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Copilot/subscriptions","organizations_url":"https://api.github.com/users/Copilot/orgs","repos_url":"https://api.github.com/users/Copilot/repos","events_url":"https://api.github.com/users/Copilot/events{/privacy}","received_events_url":"https://api.github.com/users/Copilot/received_events","type":"Bot","user_view_type":"public","site_admin":false}],"milestone":{"url":"https://api.github.com/repos/dotnet/efcore/milestones/204","html_url":"https://github.com/dotnet/efcore/milestone/204","labels_url":"https://api.github.com/repos/dotnet/efcore/milestones/204/labels","id":11480673,"node_id":"MI_kwDOAPaMMs4Ary5h","number":204,"title":"10.0.0","description":"","creator":{"login":"roji","id":1862641,"node_id":"MDQ6VXNlcjE4NjI2NDE=","avatar_url":"https://avatars.githubusercontent.com/u/1862641?v=4","gravatar_id":"","url":"https://api.github.com/users/roji","html_url":"https://github.com/roji","followers_url":"https://api.github.com/users/roji/followers","following_url":"https://api.github.com/users/roji/following{/other_user}","gists_url":"https://api.github.com/users/roji/gists{/gist_id}","starred_url":"https://api.github.com/users/roji/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roji/subscriptions","organizations_url":"https://api.github.com/users/roji/orgs","repos_url":"https://api.github.com/users/roji/repos","events_url":"https://api.github.com/users/roji/events{/privacy}","received_events_url":"https://api.github.com/users/roji/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":1,"closed_issues":193,"state":"open","created_at":"2024-08-23T12:48:26Z","updated_at":"2025-11-05T08:24:30Z","due_on":null,"closed_at":null},"comments":1,"created_at":"2024-12-30T13:29:16Z","updated_at":"2025-09-08T20:00:50Z","closed_at":"2025-08-29T17:58:32Z","author_association":"NONE","type":{"id":1092402,"node_id":"IT_kwDOAIt-yc4AEKsy","name":"Bug","description":"An unexpected problem or behavior","color":"red","created_at":"2024-01-25T11:45:43Z","updated_at":"2024-07-26T10:20:14Z","is_enabled":true},"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"Migration to replace key (e.g. of type string) by an Identity key fails with unique constraint violation. The migration script adds the Id column with default value 0. \n\n```\nALTER TABLE \"People\" ADD \"Id\" INTEGER NOT NULL DEFAULT 0;\n```\n\nThen it creates a temp table:\n```\nCREATE TABLE \"ef_temp_People\" (\n    \"Id\" INTEGER NOT NULL CONSTRAINT \"PK_People\" PRIMARY KEY AUTOINCREMENT,\n    \"Ssn\" TEXT NOT NULL\n);\n```\n\nWhen inserting data into the corresponding temp table, the unique constraint is violated:\n\n```\nINSERT INTO \"ef_temp_People\" (\"Id\", \"Ssn\")\nSELECT \"Id\", \"Ssn\"\nFROM \"People\";\n```\nIn fact, there is no need to add the Id column to the original table, and INSERT statement should omit the Id column. The code below works fine:\n\n```\nALTER TABLE \"People\" ADD \"Id\" INTEGER NOT NULL DEFAULT 0;\nCREATE TABLE \"ef_temp_People\" (\n    \"Id\" INTEGER NOT NULL CONSTRAINT \"PK_People\" PRIMARY KEY AUTOINCREMENT,\n    \"Ssn\" TEXT NOT NULL\n);\nINSERT INTO \"ef_temp_People\" (\"Ssn\")\nSELECT \"Ssn\"\nFROM \"People\";\n```\n\n\n### Reproduce the problem:\n\nConsoleApp2.csproj:\n\n```\n<Project Sdk=\"Microsoft.NET.Sdk\">\n\n  <PropertyGroup>\n    <OutputType>Exe</OutputType>\n    <TargetFramework>net9.0</TargetFramework>\n    <ImplicitUsings>enable</ImplicitUsings>\n    <Nullable>enable</Nullable>\n  </PropertyGroup>\n\n  <ItemGroup>\n    <PackageReference Include=\"Microsoft.EntityFrameworkCore.Design\" Version=\"9.0.0\">\n      <PrivateAssets>all</PrivateAssets>\n      <IncludeAssets>runtime; build; native; contentfiles; analyzers; buildtransitive</IncludeAssets>\n    </PackageReference>\n    <PackageReference Include=\"Microsoft.EntityFrameworkCore.Sqlite\" Version=\"9.0.0\" />\n  </ItemGroup>\n\n</Project>\n\n```\n\n\nInitial Program.cs:\n\n```C#\nusing Microsoft.EntityFrameworkCore;\n\nvar context = new DataContext();\n\nif (!context.People.Any())\n{\n    context.People.Add(new Person { Ssn = \"12345\" });\n    context.People.Add(new Person { Ssn = \"67890\" });\n    context.SaveChanges();\n}\n\nforeach (var p in context.People)\n{\n    Console.WriteLine(p);    \n}\n\n\nclass DataContext : DbContext\n{\n    public DataContext() : base(new DbContextOptionsBuilder<DataContext>()\n            .UseSqlite(\"Data Source=data.db\")\n            .Options)\n    {\n    }\n    protected override void OnModelCreating(ModelBuilder modelBuilder)\n    {\n        base.OnModelCreating(modelBuilder);\n\n        var personBuilder = modelBuilder.Entity<Person>();\n        personBuilder.HasKey(p => p.Ssn);\n        personBuilder.Property(p => p.Ssn).IsRequired(true);\n\n    }\n    public DbSet<Person> People { get; set; }\n}\n\nclass Person\n{\n    public string Ssn { get; set; }\n\n    public override string ToString() => $\"Ssn = {Ssn}\";\n}\n```\nInitialization on the command line:\n\n```\nPS C:\\ConsoleApp2> dotnet ef migrations list\nBuild started...\nBuild succeeded.\n20241230122009_InitialCreate (Pending)\nPS C:\\ConsoleApp2> dotnet ef database update\nBuild started...\nBuild succeeded.\nAcquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.\nApplying migration '20241230122009_InitialCreate'.\nDone.\nPS C:\\ConsoleApp2> dotnet run\nSsn = 12345\nSsn = 67890\n```\n\nChange Program.cs to:\n```\nusing Microsoft.EntityFrameworkCore;\n\nvar context = new DataContext();\n\nif (!context.People.Any())\n{\n    context.People.Add(new Person { Ssn = \"12345\" });\n    context.People.Add(new Person { Ssn = \"67890\" });\n    context.SaveChanges();\n}\n\nforeach (var p in context.People)\n{\n    Console.WriteLine(p);    \n}\nclass DataContext : DbContext\n{\n    public DataContext() : base(new DbContextOptionsBuilder<DataContext>()\n            .UseSqlite(\"Data Source=data.db\")\n            .Options)\n    {\n    }\n    protected override void OnModelCreating(ModelBuilder modelBuilder)\n    {\n        base.OnModelCreating(modelBuilder);\n\n        var personBuilder = modelBuilder.Entity<Person>();\n        personBuilder.HasKey(p => p.Id);\n        personBuilder.HasIndex(p => p.Ssn).IsUnique();\n        personBuilder.Property(p => p.Ssn).IsRequired(true);\n\n    }\n    public DbSet<Person> People { get; set; }\n}\n\nclass Person\n{\n    public int Id { get; set; }\n    public string Ssn { get; set; }\n\n    public override string ToString() => $\"Ssn = {Ssn}\";\n}\n```\n\n...\nPS C:\\ConsoleApp2> dotnet ef database update --verbose\nUsing project 'C:\\ConsoleApp2\\ConsoleApp2.csproj'.\nUsing startup project 'C:\\ConsoleApp2\\ConsoleApp2.csproj'.\ndotnet msbuild /target:GetEFProjectMetadata /property:EFProjectMetadataFile=C:\\Users\\jeroe\\AppData\\Local\\Temp\\tmphs3l5m.tmp /verbosity:quiet /nologo C:\\ConsoleApp2\\ConsoleApp2.csproj\ndotnet msbuild /target:GetEFProjectMetadata /property:EFProjectMetadataFile=C:\\Users\\jeroe\\AppData\\Local\\Temp\\tmptvxjls.tmp /verbosity:quiet /nologo C:\\ConsoleApp2\\ConsoleApp2.csproj\nBuild started...\ndotnet build C:\\ConsoleApp2\\ConsoleApp2.csproj /verbosity:quiet /nologo /p:PublishAot=false\n\nBuild succeeded.\n    0 Warning(s)\n    0 Error(s)\n\nTime Elapsed 00:00:01.52\n\nBuild succeeded.\ndotnet exec --depsfile C:\\ConsoleApp2\\bin\\Debug\\net9.0\\ConsoleApp2.deps.json --additionalprobingpath C:\\Users\\jeroe\\.nuget\\packages --additionalprobingpath \"C:\\Program Files (x86)\\Microsoft Visual Studio\\Shared\\NuGetPackages\" --runtimeconfig C:\\ConsoleApp2\\bin\\Debug\\net9.0\\ConsoleApp2.runtimeconfig.json C:\\Users\\jeroe\\.dotnet\\tools\\.store\\dotnet-ef\\9.0.0\\dotnet-ef\\9.0.0\\tools\\net8.0\\any\\tools\\netcoreapp2.0\\any\\ef.dll database update --assembly C:\\ConsoleApp2\\bin\\Debug\\net9.0\\ConsoleApp2.dll --project C:\\ConsoleApp2\\ConsoleApp2.csproj --startup-assembly C:\\ConsoleApp2\\bin\\Debug\\net9.0\\ConsoleApp2.dll --startup-project C:\\ConsoleApp2\\ConsoleApp2.csproj --project-dir C:\\ConsoleApp2\\ --root-namespace ConsoleApp2 --language C# --framework net9.0 --nullable --working-dir C:\\ConsoleApp2 --verbose\nUsing assembly 'ConsoleApp2'.\nUsing startup assembly 'ConsoleApp2'.\nUsing application base 'C:\\ConsoleApp2\\bin\\Debug\\net9.0'.\nUsing working directory 'C:\\ConsoleApp2'.\nUsing root namespace 'ConsoleApp2'.\nUsing project directory 'C:\\ConsoleApp2\\'.\nRemaining arguments: .\nFinding DbContext classes...\nFinding IDesignTimeDbContextFactory implementations...\nFinding DbContext classes in the project...\nFound DbContext 'DataContext'.\nFinding application service provider in assembly 'ConsoleApp2'...\nFinding Microsoft.Extensions.Hosting service provider...\nNo static method 'CreateHostBuilder(string[])' was found on class 'Program'.\nNo application service provider was found.\nUsing context 'DataContext'.\nFinding design-time services referenced by assembly 'ConsoleApp2'...\nFinding design-time services referenced by assembly 'ConsoleApp2'...\nNo referenced design-time services were found.\nFinding design-time services for provider 'Microsoft.EntityFrameworkCore.Sqlite'...\nUsing design-time services from provider 'Microsoft.EntityFrameworkCore.Sqlite'.\nFinding IDesignTimeServices implementations in assembly 'ConsoleApp2'...\nNo design-time services were found.\nCreating DbConnection.\nCreated DbConnection. (15ms).\nMigrating using database 'main' on server 'data.db'.\nCreating DbConnection.\nCreated DbConnection. (3ms).\nOpening connection to database 'main' on server 'data.db'.\nOpened connection to database 'main' on server 'C:\\ConsoleApp2\\data.db'.\nDisposing connection to database 'main' on server 'data.db'.\nDisposed connection to database 'main' on server 'data.db' (2ms).\nOpening connection to database 'main' on server 'data.db'.\nOpened connection to database 'main' on server 'C:\\ConsoleApp2\\data.db'.\nAcquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.\nCreating DbCommand for 'ExecuteScalar'.\nCreated DbCommand for 'ExecuteScalar' (4ms).\nInitialized DbCommand for 'ExecuteScalar' (8ms).\nExecuting DbCommand [Parameters=[], CommandType='Text', CommandTimeout='30']\nSELECT COUNT(*) FROM \"sqlite_master\" WHERE \"name\" = '__EFMigrationsLock' AND \"type\" = 'table';\nExecuted DbCommand (17ms) [Parameters=[], CommandType='Text', CommandTimeout='30']\nSELECT COUNT(*) FROM \"sqlite_master\" WHERE \"name\" = '__EFMigrationsLock' AND \"type\" = 'table';\nCreating DbCommand for 'ExecuteScalar'.\nCreated DbCommand for 'ExecuteScalar' (2ms).\nInitialized DbCommand for 'ExecuteScalar' (2ms).\nExecuting DbCommand [Parameters=[], CommandType='Text', CommandTimeout='30']\nINSERT OR IGNORE INTO \"__EFMigrationsLock\"(\"Id\", \"Timestamp\") VALUES(1, '2024-12-30 13:06:02.2638872+00:00');\nSELECT changes();\nExecuted DbCommand (10ms) [Parameters=[], CommandType='Text', CommandTimeout='30']\nINSERT OR IGNORE INTO \"__EFMigrationsLock\"(\"Id\", \"Timestamp\") VALUES(1, '2024-12-30 13:06:02.2638872+00:00');\nSELECT changes();\nCreating DbCommand for 'ExecuteNonQuery'.\nCreated DbCommand for 'ExecuteNonQuery' (1ms).\nInitialized DbCommand for 'ExecuteNonQuery' (3ms).\nExecuting DbCommand [Parameters=[], CommandType='Text', CommandTimeout='30']\nCREATE TABLE IF NOT EXISTS \"__EFMigrationsHistory\" (\n    \"MigrationId\" TEXT NOT NULL CONSTRAINT \"PK___EFMigrationsHistory\" PRIMARY KEY,\n    \"ProductVersion\" TEXT NOT NULL\n);\nExecuted DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']\nCREATE TABLE IF NOT EXISTS \"__EFMigrationsHistory\" (\n    \"MigrationId\" TEXT NOT NULL CONSTRAINT \"PK___EFMigrationsHistory\" PRIMARY KEY,\n    \"ProductVersion\" TEXT NOT NULL\n);\nBeginning transaction with isolation level 'Unspecified'.\nBegan transaction with isolation level 'Serializable'.\nCreating DbConnection.\nCreated DbConnection. (2ms).\nOpening connection to database 'main' on server 'data.db'.\nOpened connection to database 'main' on server 'C:\\ConsoleApp2\\data.db'.\nDisposing connection to database 'main' on server 'data.db'.\nDisposed connection to database 'main' on server 'data.db' (0ms).\nCreating DbCommand for 'ExecuteScalar'.\nCreated DbCommand for 'ExecuteScalar' (0ms).\nInitialized DbCommand for 'ExecuteScalar' (1ms).\nExecuting DbCommand [Parameters=[], CommandType='Text', CommandTimeout='30']\nSELECT COUNT(*) FROM \"sqlite_master\" WHERE \"name\" = '__EFMigrationsHistory' AND \"type\" = 'table';\nExecuted DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']\nSELECT COUNT(*) FROM \"sqlite_master\" WHERE \"name\" = '__EFMigrationsHistory' AND \"type\" = 'table';\nCreating DbCommand for 'ExecuteReader'.\nCreated DbCommand for 'ExecuteReader' (0ms).\nInitialized DbCommand for 'ExecuteReader' (1ms).\nExecuting DbCommand [Parameters=[], CommandType='Text', CommandTimeout='30']\nSELECT \"MigrationId\", \"ProductVersion\"\nFROM \"__EFMigrationsHistory\"\nORDER BY \"MigrationId\";\nExecuted DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']\nSELECT \"MigrationId\", \"ProductVersion\"\nFROM \"__EFMigrationsHistory\"\nORDER BY \"MigrationId\";\nClosing data reader to 'main' on server 'C:\\ConsoleApp2\\data.db'.\nA data reader for 'main' on server 'C:\\ConsoleApp2\\data.db' is being disposed after spending 3ms reading results.\nApplying migration '20241230123240_ReplaceKeyByIdentity'.\nThe migration operation 'PRAGMA foreign_keys = 0;\n' from migration 'ReplaceKeyByIdentity' cannot be executed in a transaction. If the app is terminated or an unrecoverable error occurs while this operation is being executed then the migration will be left in a partially applied state and would need to be reverted manually before it can be applied again. Create a separate migration that contains just this operation.\nCreating DbCommand for 'ExecuteNonQuery'.\nCreated DbCommand for 'ExecuteNonQuery' (1ms).\nInitialized DbCommand for 'ExecuteNonQuery' (2ms).\nExecuting DbCommand [Parameters=[], CommandType='Text', CommandTimeout='30']\nALTER TABLE \"People\" ADD \"Id\" INTEGER NOT NULL DEFAULT 0;\nExecuted DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']\nALTER TABLE \"People\" ADD \"Id\" INTEGER NOT NULL DEFAULT 0;\nCreating DbCommand for 'ExecuteNonQuery'.\nCreated DbCommand for 'ExecuteNonQuery' (0ms).\nInitialized DbCommand for 'ExecuteNonQuery' (1ms).\nExecuting DbCommand [Parameters=[], CommandType='Text', CommandTimeout='30']\nCREATE UNIQUE INDEX \"IX_People_Ssn\" ON \"People\" (\"Ssn\");\nExecuted DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']\nCREATE UNIQUE INDEX \"IX_People_Ssn\" ON \"People\" (\"Ssn\");\nCreating DbCommand for 'ExecuteNonQuery'.\nCreated DbCommand for 'ExecuteNonQuery' (0ms).\nInitialized DbCommand for 'ExecuteNonQuery' (1ms).\nExecuting DbCommand [Parameters=[], CommandType='Text', CommandTimeout='30']\nCREATE TABLE \"ef_temp_People\" (\n    \"Id\" INTEGER NOT NULL CONSTRAINT \"PK_People\" PRIMARY KEY AUTOINCREMENT,\n    \"Ssn\" TEXT NOT NULL\n);\nExecuted DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']\nCREATE TABLE \"ef_temp_People\" (\n    \"Id\" INTEGER NOT NULL CONSTRAINT \"PK_People\" PRIMARY KEY AUTOINCREMENT,\n    \"Ssn\" TEXT NOT NULL\n);\nCreating DbCommand for 'ExecuteNonQuery'.\nCreated DbCommand for 'ExecuteNonQuery' (0ms).\nInitialized DbCommand for 'ExecuteNonQuery' (1ms).\nExecuting DbCommand [Parameters=[], CommandType='Text', CommandTimeout='30']\nINSERT INTO \"ef_temp_People\" (\"Id\", \"Ssn\")\nSELECT \"Id\", \"Ssn\"\nFROM \"People\";\nFailed executing DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']\nINSERT INTO \"ef_temp_People\" (\"Id\", \"Ssn\")\nSELECT \"Id\", \"Ssn\"\nFROM \"People\";\nDisposing transaction.\nCreating DbCommand for 'ExecuteScalar'.\nCreated DbCommand for 'ExecuteScalar' (1ms).\nInitialized DbCommand for 'ExecuteScalar' (2ms).\nExecuting DbCommand [Parameters=[], CommandType='Text', CommandTimeout='30']\nDELETE FROM \"__EFMigrationsLock\";\nExecuted DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']\nDELETE FROM \"__EFMigrationsLock\";\nClosing connection to database 'main' on server 'C:\\ConsoleApp2\\data.db'.\nClosed connection to database 'main' on server 'data.db' (3ms).\n'DataContext' disposed.\nDisposing connection to database 'main' on server 'data.db'.\nDisposed connection to database 'main' on server 'data.db' (0ms).\nMicrosoft.Data.Sqlite.SqliteException (0x80004005): SQLite Error 19: 'UNIQUE constraint failed: ef_temp_People.Id'.\n   at Microsoft.Data.Sqlite.SqliteException.ThrowExceptionForRC(Int32 rc, sqlite3 db)\n   at Microsoft.Data.Sqlite.SqliteDataReader.NextResult()\n   at Microsoft.Data.Sqlite.SqliteCommand.ExecuteReader(CommandBehavior behavior)\n   at Microsoft.Data.Sqlite.SqliteCommand.ExecuteReader()\n   at Microsoft.Data.Sqlite.SqliteCommand.ExecuteNonQuery()\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteNonQuery(RelationalCommandParameterObject parameterObject)\n   at Microsoft.EntityFrameworkCore.Migrations.MigrationCommand.ExecuteNonQuery(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)\n   at Microsoft.EntityFrameworkCore.Migrations.Internal.MigrationCommandExecutor.Execute(IReadOnlyList`1 migrationCommands, IRelationalConnection connection, MigrationExecutionState executionState, Boolean beginTransaction, Boolean commitTransaction, Nullable`1 isolationLevel)\n   at Microsoft.EntityFrameworkCore.Migrations.Internal.MigrationCommandExecutor.<>c.<ExecuteNonQuery>b__3_1(DbContext _, ValueTuple`6 s)\n   at Microsoft.EntityFrameworkCore.Storage.NonRetryingExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)\n   at Microsoft.EntityFrameworkCore.Migrations.Internal.MigrationCommandExecutor.ExecuteNonQuery(IReadOnlyList`1 migrationCommands, IRelationalConnection connection, MigrationExecutionState executionState, Boolean commitTransaction, Nullable`1 isolationLevel)\n   at Microsoft.EntityFrameworkCore.Migrations.Internal.Migrator.MigrateImplementation(DbContext context, String targetMigration, MigrationExecutionState state, Boolean useTransaction)\n   at Microsoft.EntityFrameworkCore.Migrations.Internal.Migrator.<>c.<Migrate>b__20_1(DbContext c, ValueTuple`4 s)\n   at Microsoft.EntityFrameworkCore.Storage.NonRetryingExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)\n   at Microsoft.EntityFrameworkCore.Migrations.Internal.Migrator.Migrate(String targetMigration)\n   at Microsoft.EntityFrameworkCore.Design.Internal.MigrationsOperations.UpdateDatabase(String targetMigration, String connectionString, String contextType)\n   at Microsoft.EntityFrameworkCore.Design.OperationExecutor.UpdateDatabaseImpl(String targetMigration, String connectionString, String contextType)\n   at Microsoft.EntityFrameworkCore.Design.OperationExecutor.UpdateDatabase.<>c__DisplayClass0_0.<.ctor>b__0()\n   at Microsoft.EntityFrameworkCore.Design.OperationExecutor.OperationBase.Execute(Action action)\nSQLite Error 19: 'UNIQUE constraint failed: ef_temp_People.Id'.\n```\n\n### Include provider and version information\n\nEF Core version:\nDatabase provider: (Microsoft.EntityFrameworkCore.SqLite 9.0.0)\nTarget framework: (NET 9.0)\nOperating system:\nIDE: (e.g. Visual Studio 2022 17.13.0 Preview 2.1)\n","closed_by":{"login":"AndriySvyryd","id":6539701,"node_id":"MDQ6VXNlcjY1Mzk3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6539701?v=4","gravatar_id":"","url":"https://api.github.com/users/AndriySvyryd","html_url":"https://github.com/AndriySvyryd","followers_url":"https://api.github.com/users/AndriySvyryd/followers","following_url":"https://api.github.com/users/AndriySvyryd/following{/other_user}","gists_url":"https://api.github.com/users/AndriySvyryd/gists{/gist_id}","starred_url":"https://api.github.com/users/AndriySvyryd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AndriySvyryd/subscriptions","organizations_url":"https://api.github.com/users/AndriySvyryd/orgs","repos_url":"https://api.github.com/users/AndriySvyryd/repos","events_url":"https://api.github.com/users/AndriySvyryd/events{/privacy}","received_events_url":"https://api.github.com/users/AndriySvyryd/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/dotnet/efcore/issues/35391/reactions","total_count":2,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":1},"timeline_url":"https://api.github.com/repos/dotnet/efcore/issues/35391/timeline","performed_via_github_app":null,"state_reason":"completed"}