{"url":"https://api.github.com/repos/dotnet/efcore/issues/32179","repository_url":"https://api.github.com/repos/dotnet/efcore","labels_url":"https://api.github.com/repos/dotnet/efcore/issues/32179/labels{/name}","comments_url":"https://api.github.com/repos/dotnet/efcore/issues/32179/comments","events_url":"https://api.github.com/repos/dotnet/efcore/issues/32179/events","html_url":"https://github.com/dotnet/efcore/issues/32179","id":1967181027,"node_id":"I_kwDOAPaMMs51QMzj","number":32179,"title":"Scaffolding fails for some SQLite generated columns","user":{"login":"jzebedee","id":1896945,"node_id":"MDQ6VXNlcjE4OTY5NDU=","avatar_url":"https://avatars.githubusercontent.com/u/1896945?v=4","gravatar_id":"","url":"https://api.github.com/users/jzebedee","html_url":"https://github.com/jzebedee","followers_url":"https://api.github.com/users/jzebedee/followers","following_url":"https://api.github.com/users/jzebedee/following{/other_user}","gists_url":"https://api.github.com/users/jzebedee/gists{/gist_id}","starred_url":"https://api.github.com/users/jzebedee/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jzebedee/subscriptions","organizations_url":"https://api.github.com/users/jzebedee/orgs","repos_url":"https://api.github.com/users/jzebedee/repos","events_url":"https://api.github.com/users/jzebedee/events{/privacy}","received_events_url":"https://api.github.com/users/jzebedee/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":936619505,"node_id":"MDU6TGFiZWw5MzY2MTk1MDU=","url":"https://api.github.com/repos/dotnet/efcore/labels/customer-reported","name":"customer-reported","color":"a4a5f9","default":false,"description":""},{"id":1382547263,"node_id":"MDU6TGFiZWwxMzgyNTQ3MjYz","url":"https://api.github.com/repos/dotnet/efcore/labels/good%20first%20issue","name":"good first issue","color":"fef2c0","default":true,"description":"This issue should be relatively straightforward to fix."},{"id":1900977179,"node_id":"MDU6TGFiZWwxOTAwOTc3MTc5","url":"https://api.github.com/repos/dotnet/efcore/labels/area-scaffolding","name":"area-scaffolding","color":"32b37b","default":false,"description":""},{"id":2416018083,"node_id":"MDU6TGFiZWwyNDE2MDE4MDgz","url":"https://api.github.com/repos/dotnet/efcore/labels/area-sqlite","name":"area-sqlite","color":"32b37b","default":false,"description":""}],"state":"closed","locked":false,"assignee":{"login":"bricelam","id":1226749,"node_id":"MDQ6VXNlcjEyMjY3NDk=","avatar_url":"https://avatars.githubusercontent.com/u/1226749?v=4","gravatar_id":"","url":"https://api.github.com/users/bricelam","html_url":"https://github.com/bricelam","followers_url":"https://api.github.com/users/bricelam/followers","following_url":"https://api.github.com/users/bricelam/following{/other_user}","gists_url":"https://api.github.com/users/bricelam/gists{/gist_id}","starred_url":"https://api.github.com/users/bricelam/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bricelam/subscriptions","organizations_url":"https://api.github.com/users/bricelam/orgs","repos_url":"https://api.github.com/users/bricelam/repos","events_url":"https://api.github.com/users/bricelam/events{/privacy}","received_events_url":"https://api.github.com/users/bricelam/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"bricelam","id":1226749,"node_id":"MDQ6VXNlcjEyMjY3NDk=","avatar_url":"https://avatars.githubusercontent.com/u/1226749?v=4","gravatar_id":"","url":"https://api.github.com/users/bricelam","html_url":"https://github.com/bricelam","followers_url":"https://api.github.com/users/bricelam/followers","following_url":"https://api.github.com/users/bricelam/following{/other_user}","gists_url":"https://api.github.com/users/bricelam/gists{/gist_id}","starred_url":"https://api.github.com/users/bricelam/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bricelam/subscriptions","organizations_url":"https://api.github.com/users/bricelam/orgs","repos_url":"https://api.github.com/users/bricelam/repos","events_url":"https://api.github.com/users/bricelam/events{/privacy}","received_events_url":"https://api.github.com/users/bricelam/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":{"url":"https://api.github.com/repos/dotnet/efcore/milestones/180","html_url":"https://github.com/dotnet/efcore/milestone/180","labels_url":"https://api.github.com/repos/dotnet/efcore/milestones/180/labels","id":9963267,"node_id":"MI_kwDOAPaMMs4AmAcD","number":180,"title":"9.0.0","description":null,"creator":{"login":"ajcvickers","id":1430078,"node_id":"MDQ6VXNlcjE0MzAwNzg=","avatar_url":"https://avatars.githubusercontent.com/u/1430078?v=4","gravatar_id":"","url":"https://api.github.com/users/ajcvickers","html_url":"https://github.com/ajcvickers","followers_url":"https://api.github.com/users/ajcvickers/followers","following_url":"https://api.github.com/users/ajcvickers/following{/other_user}","gists_url":"https://api.github.com/users/ajcvickers/gists{/gist_id}","starred_url":"https://api.github.com/users/ajcvickers/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajcvickers/subscriptions","organizations_url":"https://api.github.com/users/ajcvickers/orgs","repos_url":"https://api.github.com/users/ajcvickers/repos","events_url":"https://api.github.com/users/ajcvickers/events{/privacy}","received_events_url":"https://api.github.com/users/ajcvickers/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":339,"state":"closed","created_at":"2023-09-25T15:41:58Z","updated_at":"2025-04-01T18:19:15Z","due_on":null,"closed_at":"2024-11-14T11:54:05Z"},"comments":4,"created_at":"2023-10-29T22:15:10Z","updated_at":"2025-06-15T19:53:23Z","closed_at":"2023-11-08T00:18:35Z","author_association":"NONE","type":{"id":1092402,"node_id":"IT_kwDOAIt-yc4AEKsy","name":"Bug","description":"An unexpected problem or behavior","color":"red","created_at":"2024-01-25T11:45:43Z","updated_at":"2024-07-26T10:20:14Z","is_enabled":true},"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"In .NET 8 RC2, `dotnet ef dbcontext scaffold` fails on SQLite databases that contain generated columns.\r\n\r\n## Repro environment\r\n* EF Core version: `8.0.0-rc.2.23480.1`\r\n* Database provider: `Microsoft.EntityFrameworkCore.Sqlite`\r\n* Target framework: `net8.0`\r\n* Operating system: Windows 11 Version 22H2\r\n```\r\nPS C:\\temp> [System.Environment]::OSVersion.Version\r\n\r\nMajor  Minor  Build  Revision\r\n-----  -----  -----  --------\r\n10     0      22621  0\r\n```\r\n* IDE: `n/a`\r\n\r\n## DB Schema\r\n\r\n```sql\r\nCREATE TABLE IF NOT EXISTS nodes (\r\n    body TEXT,\r\n    id   TEXT GENERATED ALWAYS AS (json_extract(body, '$.id')) VIRTUAL NOT NULL UNIQUE\r\n);\r\n```\r\n\r\n## Repro project\r\n\r\n```csproj\r\n<Project Sdk=\"Microsoft.NET.Sdk\">\r\n\r\n  <PropertyGroup>\r\n    <TargetFramework>net8.0</TargetFramework>\r\n    <ImplicitUsings>enable</ImplicitUsings>\r\n    <Nullable>enable</Nullable>\r\n  </PropertyGroup>\r\n\r\n  <ItemGroup>\r\n    <PackageReference Include=\"Microsoft.EntityFrameworkCore.Design\" Version=\"8.0.0-rc.2.23480.1\">\r\n      <PrivateAssets>all</PrivateAssets>\r\n      <IncludeAssets>runtime; build; native; contentfiles; analyzers; buildtransitive</IncludeAssets>\r\n    </PackageReference>\r\n    <PackageReference Include=\"Microsoft.EntityFrameworkCore.Sqlite\" Version=\"8.0.0-rc.2.23480.1\" />\r\n  </ItemGroup>\r\n\r\n</Project>\r\n```\r\n\r\n## CLI output\r\n\r\n```powershell\r\nPS C:\\temp> dotnet ef --version\r\nEntity Framework Core .NET Command-line Tools\r\n8.0.0-rc.2.23480.1\r\nPS C:\\temp> sqlite3 repro.db \"CREATE TABLE IF NOT EXISTS nodes (body TEXT, id TEXT GENERATED ALWAYS AS (json_extract(body, '$.id')) VIRTUAL NOT NULL UNIQUE);\"\r\nPS C:\\temp> dotnet ef dbcontext scaffold \"Data Source=repro.db\" Microsoft.EntityFrameworkCore.Sqlite --verbose\r\nUsing project 'C:\\temp\\temp.csproj'.\r\nUsing startup project 'C:\\temp\\temp.csproj'.\r\nWriting 'C:\\temp\\obj\\temp.csproj.EntityFrameworkCore.targets'...\r\ndotnet msbuild /target:GetEFProjectMetadata /property:EFProjectMetadataFile=C:\\Users\\Zebedee\\AppData\\Local\\Temp\\tmpubpisq.tmp /verbosity:quiet /nologo C:\\temp\\temp.csproj\r\nWriting 'C:\\temp\\obj\\temp.csproj.EntityFrameworkCore.targets'...\r\ndotnet msbuild /target:GetEFProjectMetadata /property:EFProjectMetadataFile=C:\\Users\\Zebedee\\AppData\\Local\\Temp\\tmpmn0jlc.tmp /verbosity:quiet /nologo C:\\temp\\temp.csproj\r\nBuild started...\r\ndotnet build C:\\temp\\temp.csproj /verbosity:quiet /nologo /p:PublishAot=false\r\n\r\nBuild succeeded.\r\n    0 Warning(s)\r\n    0 Error(s)\r\n\r\nTime Elapsed 00:00:01.23\r\nBuild succeeded.\r\ndotnet exec --depsfile C:\\temp\\bin\\Debug\\net8.0\\temp.deps.json --additionalprobingpath C:\\Users\\Zebedee\\.nuget\\packages --additionalprobingpath \"C:\\Program Files (x86)\\Microsoft Visual Studio\\Shared\\NuGetPackages\" --additionalprobingpath \"C:\\Program Files\\dotnet\\sdk\\NuGetFallbackFolder\" --runtimeconfig C:\\temp\\bin\\Debug\\net8.0\\temp.runtimeconfig.json C:\\Users\\Zebedee\\.dotnet\\tools\\.store\\dotnet-ef\\8.0.0-rc.2.23480.1\\dotnet-ef\\8.0.0-rc.2.23480.1\\tools\\net8.0\\any\\tools\\netcoreapp2.0\\any\\ef.dll dbcontext scaffold \"Data Source=repro.db\" Microsoft.EntityFrameworkCore.Sqlite --assembly C:\\temp\\bin\\Debug\\net8.0\\temp.dll --project C:\\temp\\temp.csproj --startup-assembly C:\\temp\\bin\\Debug\\net8.0\\temp.dll --startup-project C:\\temp\\temp.csproj --project-dir C:\\temp\\ --root-namespace temp --language C# --framework net8.0 --nullable --working-dir C:\\temp --verbose\r\nUsing assembly 'temp'.\r\nUsing startup assembly 'temp'.\r\nUsing application base 'C:\\temp\\bin\\Debug\\net8.0'.\r\nUsing working directory 'C:\\temp'.\r\nUsing root namespace 'temp'.\r\nUsing project directory 'C:\\temp\\'.\r\nRemaining arguments: .\r\nFinding design-time services referenced by assembly 'temp'...\r\nFinding design-time services referenced by assembly 'temp'...\r\nNo referenced design-time services were found.\r\nFinding design-time services for provider 'Microsoft.EntityFrameworkCore.Sqlite'...\r\nUsing design-time services from provider 'Microsoft.EntityFrameworkCore.Sqlite'.\r\nFinding IDesignTimeServices implementations in assembly 'temp'...\r\nNo design-time services were found.\r\nTo protect potentially sensitive information in your connection string, you should move it out of source code. You can avoid scaffolding the connection string by using the Name= syntax to read it from configuration - see https://go.microsoft.com/fwlink/?linkid=2131148. For more guidance on storing connection strings, see https://go.microsoft.com/fwlink/?LinkId=723263.\r\nFound table with name: 'nodes'.\r\nFound column on table 'nodes' with name: 'body', data type: TEXT, not nullable: False, default value: (null).\r\nFound column on table 'nodes' with name: 'id', data type: TEXT, not nullable: True, default value: (null).\r\nQuerying table 'nodes' to determine an appropriate CLR type for each column.\r\nFound unique constraint on table 'sqlite_autoindex_nodes_1' with name: nodes.\r\nSystem.ArgumentException: The string argument 'sql' cannot be empty.\r\n   at Microsoft.EntityFrameworkCore.Utilities.Check.NullButNotEmpty(String value, String parameterName)\r\n   at Microsoft.EntityFrameworkCore.RelationalPropertyBuilderExtensions.HasComputedColumnSql(PropertyBuilder propertyBuilder, String sql, Nullable`1 stored)\r\n   at Microsoft.EntityFrameworkCore.Scaffolding.Internal.RelationalScaffoldingModelFactory.VisitColumn(EntityTypeBuilder builder, DatabaseColumn column)\r\n   at Microsoft.EntityFrameworkCore.Scaffolding.Internal.RelationalScaffoldingModelFactory.VisitColumns(EntityTypeBuilder builder, ICollection`1 columns)\r\n   at Microsoft.EntityFrameworkCore.Scaffolding.Internal.RelationalScaffoldingModelFactory.VisitTable(ModelBuilder modelBuilder, DatabaseTable table)\r\n   at Microsoft.EntityFrameworkCore.Scaffolding.Internal.RelationalScaffoldingModelFactory.VisitTables(ModelBuilder modelBuilder, ICollection`1 tables)\r\n   at Microsoft.EntityFrameworkCore.Scaffolding.Internal.RelationalScaffoldingModelFactory.VisitDatabaseModel(ModelBuilder modelBuilder, DatabaseModel databaseModel)\r\n   at Microsoft.EntityFrameworkCore.Scaffolding.Internal.RelationalScaffoldingModelFactory.Create(DatabaseModel databaseModel, ModelReverseEngineerOptions options)\r\n   at Microsoft.EntityFrameworkCore.Scaffolding.Internal.ReverseEngineerScaffolder.ScaffoldModel(String connectionString, DatabaseModelFactoryOptions databaseOptions, ModelReverseEngineerOptions modelOptions, ModelCodeGenerationOptions codeOptions)\r\n   at Microsoft.EntityFrameworkCore.Design.Internal.DatabaseOperations.ScaffoldContext(String provider, String connectionString, String outputDir, String outputContextDir, String dbContextClassName, IEnumerable`1 schemas, IEnumerable`1 tables, String modelNamespace, String contextNamespace, Boolean useDataAnnotations, Boolean overwriteFiles, Boolean useDatabaseNames, Boolean suppressOnConfiguring, Boolean noPluralize)\r\n   at Microsoft.EntityFrameworkCore.Design.OperationExecutor.ScaffoldContextImpl(String provider, String connectionString, String outputDir, String outputDbContextDir, String dbContextClassName, IEnumerable`1 schemaFilters, IEnumerable`1 tableFilters, String modelNamespace, String contextNamespace, Boolean useDataAnnotations, Boolean overwriteFiles, Boolean useDatabaseNames, Boolean suppressOnConfiguring, Boolean noPluralize)\r\n   at Microsoft.EntityFrameworkCore.Design.OperationExecutor.ScaffoldContext.<>c__DisplayClass0_0.<.ctor>b__0()\r\n   at Microsoft.EntityFrameworkCore.Design.OperationExecutor.OperationBase.<>c__DisplayClass3_0`1.<Execute>b__0()\r\n   at Microsoft.EntityFrameworkCore.Design.OperationExecutor.OperationBase.Execute(Action action)\r\nThe string argument 'sql' cannot be empty.\r\n```\r\n","closed_by":{"login":"bricelam","id":1226749,"node_id":"MDQ6VXNlcjEyMjY3NDk=","avatar_url":"https://avatars.githubusercontent.com/u/1226749?v=4","gravatar_id":"","url":"https://api.github.com/users/bricelam","html_url":"https://github.com/bricelam","followers_url":"https://api.github.com/users/bricelam/followers","following_url":"https://api.github.com/users/bricelam/following{/other_user}","gists_url":"https://api.github.com/users/bricelam/gists{/gist_id}","starred_url":"https://api.github.com/users/bricelam/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bricelam/subscriptions","organizations_url":"https://api.github.com/users/bricelam/orgs","repos_url":"https://api.github.com/users/bricelam/repos","events_url":"https://api.github.com/users/bricelam/events{/privacy}","received_events_url":"https://api.github.com/users/bricelam/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/dotnet/efcore/issues/32179/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/dotnet/efcore/issues/32179/timeline","performed_via_github_app":null,"state_reason":"completed"}