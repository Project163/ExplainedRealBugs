{"url":"https://api.github.com/repos/dotnet/efcore/issues/36494","repository_url":"https://api.github.com/repos/dotnet/efcore","labels_url":"https://api.github.com/repos/dotnet/efcore/issues/36494/labels{/name}","comments_url":"https://api.github.com/repos/dotnet/efcore/issues/36494/comments","events_url":"https://api.github.com/repos/dotnet/efcore/issues/36494/events","html_url":"https://github.com/dotnet/efcore/issues/36494","id":3286283774,"node_id":"I_kwDOAPaMMs7D4LX-","number":36494,"title":"ComplexProperty creates a migration loop after upgrading from 9.0.7 to 10.0.0-preview.6.25358.103","user":{"login":"jscarle","id":29762210,"node_id":"MDQ6VXNlcjI5NzYyMjEw","avatar_url":"https://avatars.githubusercontent.com/u/29762210?v=4","gravatar_id":"","url":"https://api.github.com/users/jscarle","html_url":"https://github.com/jscarle","followers_url":"https://api.github.com/users/jscarle/followers","following_url":"https://api.github.com/users/jscarle/following{/other_user}","gists_url":"https://api.github.com/users/jscarle/gists{/gist_id}","starred_url":"https://api.github.com/users/jscarle/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jscarle/subscriptions","organizations_url":"https://api.github.com/users/jscarle/orgs","repos_url":"https://api.github.com/users/jscarle/repos","events_url":"https://api.github.com/users/jscarle/events{/privacy}","received_events_url":"https://api.github.com/users/jscarle/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":936619505,"node_id":"MDU6TGFiZWw5MzY2MTk1MDU=","url":"https://api.github.com/repos/dotnet/efcore/labels/customer-reported","name":"customer-reported","color":"a4a5f9","default":false,"description":""},{"id":1900942474,"node_id":"MDU6TGFiZWwxOTAwOTQyNDc0","url":"https://api.github.com/repos/dotnet/efcore/labels/area-migrations","name":"area-migrations","color":"32b37b","default":false,"description":""},{"id":6678623180,"node_id":"LA_kwDOAPaMMs8AAAABjhOzzA","url":"https://api.github.com/repos/dotnet/efcore/labels/area-complex-types","name":"area-complex-types","color":"32b37b","default":false,"description":""},{"id":9022437988,"node_id":"LA_kwDOAPaMMs8AAAACGcd6ZA","url":"https://api.github.com/repos/dotnet/efcore/labels/rc-1","name":"rc-1","color":"ACB3D7","default":false,"description":""}],"state":"closed","locked":false,"assignee":{"login":"AndriySvyryd","id":6539701,"node_id":"MDQ6VXNlcjY1Mzk3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6539701?v=4","gravatar_id":"","url":"https://api.github.com/users/AndriySvyryd","html_url":"https://github.com/AndriySvyryd","followers_url":"https://api.github.com/users/AndriySvyryd/followers","following_url":"https://api.github.com/users/AndriySvyryd/following{/other_user}","gists_url":"https://api.github.com/users/AndriySvyryd/gists{/gist_id}","starred_url":"https://api.github.com/users/AndriySvyryd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AndriySvyryd/subscriptions","organizations_url":"https://api.github.com/users/AndriySvyryd/orgs","repos_url":"https://api.github.com/users/AndriySvyryd/repos","events_url":"https://api.github.com/users/AndriySvyryd/events{/privacy}","received_events_url":"https://api.github.com/users/AndriySvyryd/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"AndriySvyryd","id":6539701,"node_id":"MDQ6VXNlcjY1Mzk3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6539701?v=4","gravatar_id":"","url":"https://api.github.com/users/AndriySvyryd","html_url":"https://github.com/AndriySvyryd","followers_url":"https://api.github.com/users/AndriySvyryd/followers","following_url":"https://api.github.com/users/AndriySvyryd/following{/other_user}","gists_url":"https://api.github.com/users/AndriySvyryd/gists{/gist_id}","starred_url":"https://api.github.com/users/AndriySvyryd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AndriySvyryd/subscriptions","organizations_url":"https://api.github.com/users/AndriySvyryd/orgs","repos_url":"https://api.github.com/users/AndriySvyryd/repos","events_url":"https://api.github.com/users/AndriySvyryd/events{/privacy}","received_events_url":"https://api.github.com/users/AndriySvyryd/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":{"url":"https://api.github.com/repos/dotnet/efcore/milestones/204","html_url":"https://github.com/dotnet/efcore/milestone/204","labels_url":"https://api.github.com/repos/dotnet/efcore/milestones/204/labels","id":11480673,"node_id":"MI_kwDOAPaMMs4Ary5h","number":204,"title":"10.0.0","description":"","creator":{"login":"roji","id":1862641,"node_id":"MDQ6VXNlcjE4NjI2NDE=","avatar_url":"https://avatars.githubusercontent.com/u/1862641?v=4","gravatar_id":"","url":"https://api.github.com/users/roji","html_url":"https://github.com/roji","followers_url":"https://api.github.com/users/roji/followers","following_url":"https://api.github.com/users/roji/following{/other_user}","gists_url":"https://api.github.com/users/roji/gists{/gist_id}","starred_url":"https://api.github.com/users/roji/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roji/subscriptions","organizations_url":"https://api.github.com/users/roji/orgs","repos_url":"https://api.github.com/users/roji/repos","events_url":"https://api.github.com/users/roji/events{/privacy}","received_events_url":"https://api.github.com/users/roji/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":1,"closed_issues":193,"state":"open","created_at":"2024-08-23T12:48:26Z","updated_at":"2025-11-05T08:24:30Z","due_on":null,"closed_at":null},"comments":8,"created_at":"2025-08-02T20:36:41Z","updated_at":"2025-09-08T20:05:31Z","closed_at":"2025-08-07T19:24:59Z","author_association":"NONE","type":{"id":1092402,"node_id":"IT_kwDOAIt-yc4AEKsy","name":"Bug","description":"An unexpected problem or behavior","color":"red","created_at":"2024-01-25T11:45:43Z","updated_at":"2024-07-26T10:20:14Z","is_enabled":true},"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Bug description\n\n@roji I don't know how to be able to repro this without spending hours trying to tear down my existing project. So I'll try to provide as much context as possible, but essentially I have an .NET 10 minimal API based project that uses EntityFrameworkCore 9.0.7. If I upgrade to version 10.0.0-preview.6.25358.103 and create a new migration with absolutely no code changes, it create a migration for all of the columns where a ComplexProperty is configured. Even if I create the migration, it will throw PendingModelChangesWarning on startup. I can create as many migrations as I'd like, they're always identical.\n\nMy best guess is that it seems to be related to detecting nullability around structs.\n\n### Your code\n\nRelevants bits of code:\n\n```csharp\npublic sealed class City\n{\n    public int CityId { get; init; }\n    public required Coordinates Location { get; init; }\n}\n\ninternal sealed class CityConfiguration : IEntityTypeConfiguration<City>\n{\n    public void Configure(EntityTypeBuilder<City> entity)\n    {\n        entity.HasKey(e => e.CityId);\n\n        entity.Property(e => e.CityId)\n            .ValueGeneratedOnAdd();\n        entity.ComplexProperty(e => e.Location, builder =>\n            {\n                builder.Property(e => e.Latitude)\n                    .HasColumnType(\"decimal(9, 6)\");\n                builder.Property(e => e.Longitude)\n                    .HasColumnType(\"decimal(9, 6)\");\n            }\n        );\n    }\n}\n\n// Value objects have been simplified\npublic readonly struct Coordinates\n{\n    public Latitude Latitude { get; init; }\n    public Longitude Longitude { get; init; }\n}\n\npublic readonly struct Coordinates\n{\n    public Latitude Latitude { get; private init; }\n    public Longitude Longitude { get; private init; }\n\n    private Coordinates()\n    {\n    }\n\n    public static Coordinates Create(Latitude latitude, Longitude longitude)\n    {\n        return new Coordinates { Latitude = latitude, Longitude = longitude };\n    }\n}\n\npublic readonly struct Latitude\n{\n    private decimal _value;\n\n    private Latitude(decimal value)\n    {\n        _value = value;\n    }\n\n    public static Latitude Create(decimal value)\n    {\n        return new Latitude(value);\n    }\n\n    public decimal ToDecimal()\n    {\n        return _value;\n    }\n}\n\npublic readonly struct Longitude\n{\n    private decimal _value;\n\n    private Longitude(decimal value)\n    {\n        _value = value;\n    }\n\n    public static Longitude Create(decimal value)\n    {\n        return new Longitude(value);\n    }\n\n    public decimal ToDecimal()\n    {\n        return _value;\n    }\n}\n```\n\nI wire up value converters around Latitude and Longitude.\n\nThe migrations it will create will look like this:\n\n```csharp\nusing Microsoft.EntityFrameworkCore.Migrations;\n\n#nullable disable\n\nnamespace Database.Migrations\n{\n    /// <inheritdoc />\n    public partial class PendingModelChanges : Migration\n    {\n        /// <inheritdoc />\n        protected override void Up(MigrationBuilder migrationBuilder)\n        {\n            migrationBuilder.AlterColumn<decimal>(\n                name: \"Longitude\",\n                table: \"City\",\n                type: \"decimal(9,6)\",\n                nullable: false,\n                defaultValue: 0m,\n                oldClrType: typeof(decimal),\n                oldType: \"decimal(9,6)\",\n                oldNullable: true);\n\n            migrationBuilder.AlterColumn<decimal>(\n                name: \"Latitude\",\n                table: \"City\",\n                type: \"decimal(9,6)\",\n                nullable: false,\n                defaultValue: 0m,\n                oldClrType: typeof(decimal),\n                oldType: \"decimal(9,6)\",\n                oldNullable: true);\n        }\n\n        /// <inheritdoc />\n        protected override void Down(MigrationBuilder migrationBuilder)\n        {\n            migrationBuilder.AlterColumn<decimal>(\n                name: \"Longitude\",\n                table: \"City\",\n                type: \"decimal(9,6)\",\n                nullable: true,\n                oldClrType: typeof(decimal),\n                oldType: \"decimal(9,6)\");\n\n            migrationBuilder.AlterColumn<decimal>(\n                name: \"Latitude\",\n                table: \"City\",\n                type: \"decimal(9,6)\",\n                nullable: true,\n                oldClrType: typeof(decimal),\n                oldType: \"decimal(9,6)\");\n        }\n    }\n}\n```\n\nI wish I could provide better code examples, but there's a lot of code dependencies that make it complex for me to water down my project into a focused repro.\n\n### EF Core version\n\n10.0.0-preview.6.25358.103\n\n### Database provider\n\nMicrosoft.EntityFrameworkCore.SqlServer\n\n### Target framework\n\n.NET 10.0.0-preview.6.25358.103\n\n### Operating system\n\nWindows 11\n\n### IDE\n\nJetBrains Rider 2025.2 RC 1","closed_by":{"login":"AndriySvyryd","id":6539701,"node_id":"MDQ6VXNlcjY1Mzk3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6539701?v=4","gravatar_id":"","url":"https://api.github.com/users/AndriySvyryd","html_url":"https://github.com/AndriySvyryd","followers_url":"https://api.github.com/users/AndriySvyryd/followers","following_url":"https://api.github.com/users/AndriySvyryd/following{/other_user}","gists_url":"https://api.github.com/users/AndriySvyryd/gists{/gist_id}","starred_url":"https://api.github.com/users/AndriySvyryd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AndriySvyryd/subscriptions","organizations_url":"https://api.github.com/users/AndriySvyryd/orgs","repos_url":"https://api.github.com/users/AndriySvyryd/repos","events_url":"https://api.github.com/users/AndriySvyryd/events{/privacy}","received_events_url":"https://api.github.com/users/AndriySvyryd/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/dotnet/efcore/issues/36494/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/dotnet/efcore/issues/36494/timeline","performed_via_github_app":null,"state_reason":"completed"}