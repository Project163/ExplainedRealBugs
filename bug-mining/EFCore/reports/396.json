{"url":"https://api.github.com/repos/dotnet/efcore/issues/32896","repository_url":"https://api.github.com/repos/dotnet/efcore","labels_url":"https://api.github.com/repos/dotnet/efcore/issues/32896/labels{/name}","comments_url":"https://api.github.com/repos/dotnet/efcore/issues/32896/comments","events_url":"https://api.github.com/repos/dotnet/efcore/issues/32896/events","html_url":"https://github.com/dotnet/efcore/issues/32896","id":2096179626,"node_id":"I_kwDOAPaMMs588Smq","number":32896,"title":"Query never returns when DB value for column mapped to primitive collection is ''","user":{"login":"sindrekroknes","id":143387557,"node_id":"U_kgDOCIvrpQ","avatar_url":"https://avatars.githubusercontent.com/u/143387557?v=4","gravatar_id":"","url":"https://api.github.com/users/sindrekroknes","html_url":"https://github.com/sindrekroknes","followers_url":"https://api.github.com/users/sindrekroknes/followers","following_url":"https://api.github.com/users/sindrekroknes/following{/other_user}","gists_url":"https://api.github.com/users/sindrekroknes/gists{/gist_id}","starred_url":"https://api.github.com/users/sindrekroknes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sindrekroknes/subscriptions","organizations_url":"https://api.github.com/users/sindrekroknes/orgs","repos_url":"https://api.github.com/users/sindrekroknes/repos","events_url":"https://api.github.com/users/sindrekroknes/events{/privacy}","received_events_url":"https://api.github.com/users/sindrekroknes/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":936619505,"node_id":"MDU6TGFiZWw5MzY2MTk1MDU=","url":"https://api.github.com/repos/dotnet/efcore/labels/customer-reported","name":"customer-reported","color":"a4a5f9","default":false,"description":""},{"id":1017558838,"node_id":"MDU6TGFiZWwxMDE3NTU4ODM4","url":"https://api.github.com/repos/dotnet/efcore/labels/Servicing-approved","name":"Servicing-approved","color":"048708","default":false,"description":""},{"id":1900941630,"node_id":"MDU6TGFiZWwxOTAwOTQxNjMw","url":"https://api.github.com/repos/dotnet/efcore/labels/area-model-building","name":"area-model-building","color":"32b37b","default":false,"description":""},{"id":4725071141,"node_id":"LA_kwDOAPaMMs8AAAABGaLdJQ","url":"https://api.github.com/repos/dotnet/efcore/labels/area-primitive-collections","name":"area-primitive-collections","color":"32b37b","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/dotnet/efcore/milestones/188","html_url":"https://github.com/dotnet/efcore/milestone/188","labels_url":"https://api.github.com/repos/dotnet/efcore/milestones/188/labels","id":10432910,"node_id":"MI_kwDOAPaMMs4AnzGO","number":188,"title":"8.0.3","description":null,"creator":{"login":"AndriySvyryd","id":6539701,"node_id":"MDQ6VXNlcjY1Mzk3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6539701?v=4","gravatar_id":"","url":"https://api.github.com/users/AndriySvyryd","html_url":"https://github.com/AndriySvyryd","followers_url":"https://api.github.com/users/AndriySvyryd/followers","following_url":"https://api.github.com/users/AndriySvyryd/following{/other_user}","gists_url":"https://api.github.com/users/AndriySvyryd/gists{/gist_id}","starred_url":"https://api.github.com/users/AndriySvyryd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AndriySvyryd/subscriptions","organizations_url":"https://api.github.com/users/AndriySvyryd/orgs","repos_url":"https://api.github.com/users/AndriySvyryd/repos","events_url":"https://api.github.com/users/AndriySvyryd/events{/privacy}","received_events_url":"https://api.github.com/users/AndriySvyryd/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":22,"state":"closed","created_at":"2024-01-18T01:09:32Z","updated_at":"2024-04-09T08:41:20Z","due_on":null,"closed_at":"2024-04-09T08:41:20Z"},"comments":8,"created_at":"2024-01-23T14:11:31Z","updated_at":"2025-06-15T19:57:38Z","closed_at":"2024-02-07T12:57:44Z","author_association":"NONE","type":{"id":1092402,"node_id":"IT_kwDOAIt-yc4AEKsy","name":"Bug","description":"An unexpected problem or behavior","color":"red","created_at":"2024-01-25T11:45:43Z","updated_at":"2024-07-26T10:20:14Z","is_enabled":true},"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"## Problem\r\nWhen using EF to query an entity that has a primitive collection property the query never returns if the database value of the column is ''\r\nThe database query appears to execute successfully, but nothing more happens. The method never returns.\r\nThis is the last thing logged, even with LogLevel set to Trace:\r\n```\r\ninfo: 23.01.2024 14:47:32.803 RelationalEventId.CommandExecuted[20101] (Microsoft.EntityFrameworkCore.Database.Command)\r\n      Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']\r\n      SELECT \"s\".\"Id\", \"s\".\"List\"\r\n      FROM \"SimpleEntities\" AS \"s\"\r\n      LIMIT 1\r\n```\r\n\r\nEncountered this when adding a new column to an existing table. The generated migration sets the default value to ''\r\nTested with different collection types and primitives,  Sqlite/SqlServer, and sync/async. Same result for everything I tested with. \r\n\r\nUpdate: Left the repro running over night, the FirstAsync method has still not returned.\r\n\r\n### Repro code\r\n```C#\r\nawait using var connection = new SqliteConnection(\"DataSource=:memory:\");\r\nawait connection.OpenAsync();\r\n\r\nawait using var ctx = new SimpleContext(connection);\r\nawait ctx.Database.EnsureDeletedAsync();\r\nawait ctx.Database.EnsureCreatedAsync();\r\n\r\nawait ctx.Database.ExecuteSqlRawAsync(\"INSERT INTO SimpleEntities (List) VALUES ('');\");\r\n\r\nvar entity = await ctx.SimpleEntities.FirstAsync();\r\nConsole.WriteLine(entity);\r\n\r\npublic class SimpleContext(SqliteConnection connection) : DbContext\r\n{\r\n    public DbSet<SimpleEntity> SimpleEntities => Set<SimpleEntity>();\r\n\r\n    protected override void OnConfiguring(DbContextOptionsBuilder optionsBuilder)\r\n    {\r\n        optionsBuilder\r\n            .UseSqlite(connection)\r\n            .LogTo(Console.WriteLine, LogLevel.Information)\r\n            .EnableSensitiveDataLogging();\r\n    }\r\n}\r\n\r\npublic record SimpleEntity(int Id, IEnumerable<string>? List);\r\n```\r\n\r\n### Include provider and version information\r\n\r\nEF Core version: 8.0.1\r\nDatabase provider: tested with Microsoft.EntityFrameworkCore.SqlServer and Microsoft.EntityFrameworkCore.Sqlite\r\nTarget framework: .NET 8.0)\r\nOperating system: Windows 11\r\nIDE: VS Code\r\n","closed_by":{"login":"ajcvickers","id":1430078,"node_id":"MDQ6VXNlcjE0MzAwNzg=","avatar_url":"https://avatars.githubusercontent.com/u/1430078?v=4","gravatar_id":"","url":"https://api.github.com/users/ajcvickers","html_url":"https://github.com/ajcvickers","followers_url":"https://api.github.com/users/ajcvickers/followers","following_url":"https://api.github.com/users/ajcvickers/following{/other_user}","gists_url":"https://api.github.com/users/ajcvickers/gists{/gist_id}","starred_url":"https://api.github.com/users/ajcvickers/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajcvickers/subscriptions","organizations_url":"https://api.github.com/users/ajcvickers/orgs","repos_url":"https://api.github.com/users/ajcvickers/repos","events_url":"https://api.github.com/users/ajcvickers/events{/privacy}","received_events_url":"https://api.github.com/users/ajcvickers/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/dotnet/efcore/issues/32896/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/dotnet/efcore/issues/32896/timeline","performed_via_github_app":null,"state_reason":"completed"}