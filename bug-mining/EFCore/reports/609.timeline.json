[{"id":15476464556,"node_id":"LE_lADOAPaMMs6hQCpUzwAAAAOaeBus","url":"https://api.github.com/repos/dotnet/efcore/issues/events/15476464556","actor":{"login":"c5racing","id":11325751,"node_id":"MDQ6VXNlcjExMzI1NzUx","avatar_url":"https://avatars.githubusercontent.com/u/11325751?v=4","gravatar_id":"","url":"https://api.github.com/users/c5racing","html_url":"https://github.com/c5racing","followers_url":"https://api.github.com/users/c5racing/followers","following_url":"https://api.github.com/users/c5racing/following{/other_user}","gists_url":"https://api.github.com/users/c5racing/gists{/gist_id}","starred_url":"https://api.github.com/users/c5racing/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/c5racing/subscriptions","organizations_url":"https://api.github.com/users/c5racing/orgs","repos_url":"https://api.github.com/users/c5racing/repos","events_url":"https://api.github.com/users/c5racing/events{/privacy}","received_events_url":"https://api.github.com/users/c5racing/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2024-11-29T14:42:35Z","label":{"name":"customer-reported","color":"a4a5f9"},"performed_via_github_app":null},{"id":15476507069,"node_id":"RTE_lADOAPaMMs6hQCpUzwAAAAOaeMG9","url":"https://api.github.com/repos/dotnet/efcore/issues/events/15476507069","actor":{"login":"c5racing","id":11325751,"node_id":"MDQ6VXNlcjExMzI1NzUx","avatar_url":"https://avatars.githubusercontent.com/u/11325751?v=4","gravatar_id":"","url":"https://api.github.com/users/c5racing","html_url":"https://github.com/c5racing","followers_url":"https://api.github.com/users/c5racing/followers","following_url":"https://api.github.com/users/c5racing/following{/other_user}","gists_url":"https://api.github.com/users/c5racing/gists{/gist_id}","starred_url":"https://api.github.com/users/c5racing/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/c5racing/subscriptions","organizations_url":"https://api.github.com/users/c5racing/orgs","repos_url":"https://api.github.com/users/c5racing/repos","events_url":"https://api.github.com/users/c5racing/events{/privacy}","received_events_url":"https://api.github.com/users/c5racing/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"renamed","commit_id":null,"commit_url":null,"created_at":"2024-11-29T14:46:49Z","rename":{"from":"EF9: SaveChanges() is much slower when using .ToJson() Mapping vs. PostgreSQL Legacy POCO mapping","to":"EF9: SaveChanges() is much slower in .NET8 vs. .NET9 when using .ToJson() Mapping vs. PostgreSQL Legacy POCO mapping"},"performed_via_github_app":null},{"id":15476510269,"node_id":"RTE_lADOAPaMMs6hQCpUzwAAAAOaeM49","url":"https://api.github.com/repos/dotnet/efcore/issues/events/15476510269","actor":{"login":"c5racing","id":11325751,"node_id":"MDQ6VXNlcjExMzI1NzUx","avatar_url":"https://avatars.githubusercontent.com/u/11325751?v=4","gravatar_id":"","url":"https://api.github.com/users/c5racing","html_url":"https://github.com/c5racing","followers_url":"https://api.github.com/users/c5racing/followers","following_url":"https://api.github.com/users/c5racing/following{/other_user}","gists_url":"https://api.github.com/users/c5racing/gists{/gist_id}","starred_url":"https://api.github.com/users/c5racing/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/c5racing/subscriptions","organizations_url":"https://api.github.com/users/c5racing/orgs","repos_url":"https://api.github.com/users/c5racing/repos","events_url":"https://api.github.com/users/c5racing/events{/privacy}","received_events_url":"https://api.github.com/users/c5racing/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"renamed","commit_id":null,"commit_url":null,"created_at":"2024-11-29T14:47:08Z","rename":{"from":"EF9: SaveChanges() is much slower in .NET8 vs. .NET9 when using .ToJson() Mapping vs. PostgreSQL Legacy POCO mapping","to":"EF9: SaveChanges() is much slower in .NET9 vs. .NET8 when using .ToJson() Mapping vs. PostgreSQL Legacy POCO mapping"},"performed_via_github_app":null},{"id":15476549859,"node_id":"RTE_lADOAPaMMs6hQCpUzwAAAAOaeWjj","url":"https://api.github.com/repos/dotnet/efcore/issues/events/15476549859","actor":{"login":"c5racing","id":11325751,"node_id":"MDQ6VXNlcjExMzI1NzUx","avatar_url":"https://avatars.githubusercontent.com/u/11325751?v=4","gravatar_id":"","url":"https://api.github.com/users/c5racing","html_url":"https://github.com/c5racing","followers_url":"https://api.github.com/users/c5racing/followers","following_url":"https://api.github.com/users/c5racing/following{/other_user}","gists_url":"https://api.github.com/users/c5racing/gists{/gist_id}","starred_url":"https://api.github.com/users/c5racing/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/c5racing/subscriptions","organizations_url":"https://api.github.com/users/c5racing/orgs","repos_url":"https://api.github.com/users/c5racing/repos","events_url":"https://api.github.com/users/c5racing/events{/privacy}","received_events_url":"https://api.github.com/users/c5racing/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"renamed","commit_id":null,"commit_url":null,"created_at":"2024-11-29T14:51:03Z","rename":{"from":"EF9: SaveChanges() is much slower in .NET9 vs. .NET8 when using .ToJson() Mapping vs. PostgreSQL Legacy POCO mapping","to":"EF9: SaveChanges() is significantly slower in .NET9 vs. .NET8 when using .ToJson() Mapping vs. PostgreSQL Legacy POCO mapping"},"performed_via_github_app":null},{"actor":{"login":"c5racing","id":11325751,"node_id":"MDQ6VXNlcjExMzI1NzUx","avatar_url":"https://avatars.githubusercontent.com/u/11325751?v=4","gravatar_id":"","url":"https://api.github.com/users/c5racing","html_url":"https://github.com/c5racing","followers_url":"https://api.github.com/users/c5racing/followers","following_url":"https://api.github.com/users/c5racing/following{/other_user}","gists_url":"https://api.github.com/users/c5racing/gists{/gist_id}","starred_url":"https://api.github.com/users/c5racing/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/c5racing/subscriptions","organizations_url":"https://api.github.com/users/c5racing/orgs","repos_url":"https://api.github.com/users/c5racing/repos","events_url":"https://api.github.com/users/c5racing/events{/privacy}","received_events_url":"https://api.github.com/users/c5racing/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-11-29T14:53:29Z","updated_at":"2024-11-29T14:53:29Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/dotnet/efcore/issues/35053","repository_url":"https://api.github.com/repos/dotnet/efcore","labels_url":"https://api.github.com/repos/dotnet/efcore/issues/35053/labels{/name}","comments_url":"https://api.github.com/repos/dotnet/efcore/issues/35053/comments","events_url":"https://api.github.com/repos/dotnet/efcore/issues/35053/events","html_url":"https://github.com/dotnet/efcore/issues/35053","id":2637901123,"node_id":"I_kwDOAPaMMs6dOy1D","number":35053,"title":"Is EF9 slower than EF8?","user":{"login":"wallyrion","id":30635131,"node_id":"MDQ6VXNlcjMwNjM1MTMx","avatar_url":"https://avatars.githubusercontent.com/u/30635131?v=4","gravatar_id":"","url":"https://api.github.com/users/wallyrion","html_url":"https://github.com/wallyrion","followers_url":"https://api.github.com/users/wallyrion/followers","following_url":"https://api.github.com/users/wallyrion/following{/other_user}","gists_url":"https://api.github.com/users/wallyrion/gists{/gist_id}","starred_url":"https://api.github.com/users/wallyrion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wallyrion/subscriptions","organizations_url":"https://api.github.com/users/wallyrion/orgs","repos_url":"https://api.github.com/users/wallyrion/repos","events_url":"https://api.github.com/users/wallyrion/events{/privacy}","received_events_url":"https://api.github.com/users/wallyrion/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":130861068,"node_id":"MDU6TGFiZWwxMzA4NjEwNjg=","url":"https://api.github.com/repos/dotnet/efcore/labels/area-perf","name":"area-perf","color":"5319e7","default":false,"description":""},{"id":514908713,"node_id":"MDU6TGFiZWw1MTQ5MDg3MTM=","url":"https://api.github.com/repos/dotnet/efcore/labels/regression","name":"regression","color":"ff1fff","default":false,"description":null},{"id":936619505,"node_id":"MDU6TGFiZWw5MzY2MTk1MDU=","url":"https://api.github.com/repos/dotnet/efcore/labels/customer-reported","name":"customer-reported","color":"a4a5f9","default":false,"description":""},{"id":1675384372,"node_id":"MDU6TGFiZWwxNjc1Mzg0Mzcy","url":"https://api.github.com/repos/dotnet/efcore/labels/area-query","name":"area-query","color":"32b37b","default":false,"description":""},{"id":8130499638,"node_id":"LA_kwDOAPaMMs8AAAAB5J2UNg","url":"https://api.github.com/repos/dotnet/efcore/labels/preview-1","name":"preview-1","color":"ACB3D7","default":false,"description":""}],"state":"closed","locked":false,"assignee":{"login":"maumar","id":1591930,"node_id":"MDQ6VXNlcjE1OTE5MzA=","avatar_url":"https://avatars.githubusercontent.com/u/1591930?v=4","gravatar_id":"","url":"https://api.github.com/users/maumar","html_url":"https://github.com/maumar","followers_url":"https://api.github.com/users/maumar/followers","following_url":"https://api.github.com/users/maumar/following{/other_user}","gists_url":"https://api.github.com/users/maumar/gists{/gist_id}","starred_url":"https://api.github.com/users/maumar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/maumar/subscriptions","organizations_url":"https://api.github.com/users/maumar/orgs","repos_url":"https://api.github.com/users/maumar/repos","events_url":"https://api.github.com/users/maumar/events{/privacy}","received_events_url":"https://api.github.com/users/maumar/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"maumar","id":1591930,"node_id":"MDQ6VXNlcjE1OTE5MzA=","avatar_url":"https://avatars.githubusercontent.com/u/1591930?v=4","gravatar_id":"","url":"https://api.github.com/users/maumar","html_url":"https://github.com/maumar","followers_url":"https://api.github.com/users/maumar/followers","following_url":"https://api.github.com/users/maumar/following{/other_user}","gists_url":"https://api.github.com/users/maumar/gists{/gist_id}","starred_url":"https://api.github.com/users/maumar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/maumar/subscriptions","organizations_url":"https://api.github.com/users/maumar/orgs","repos_url":"https://api.github.com/users/maumar/repos","events_url":"https://api.github.com/users/maumar/events{/privacy}","received_events_url":"https://api.github.com/users/maumar/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":{"url":"https://api.github.com/repos/dotnet/efcore/milestones/209","html_url":"https://github.com/dotnet/efcore/milestone/209","labels_url":"https://api.github.com/repos/dotnet/efcore/milestones/209/labels","id":12021339,"node_id":"MI_kwDOAPaMMs4At25b","number":209,"title":"9.0.2","description":null,"creator":{"login":"maumar","id":1591930,"node_id":"MDQ6VXNlcjE1OTE5MzA=","avatar_url":"https://avatars.githubusercontent.com/u/1591930?v=4","gravatar_id":"","url":"https://api.github.com/users/maumar","html_url":"https://github.com/maumar","followers_url":"https://api.github.com/users/maumar/followers","following_url":"https://api.github.com/users/maumar/following{/other_user}","gists_url":"https://api.github.com/users/maumar/gists{/gist_id}","starred_url":"https://api.github.com/users/maumar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/maumar/subscriptions","organizations_url":"https://api.github.com/users/maumar/orgs","repos_url":"https://api.github.com/users/maumar/repos","events_url":"https://api.github.com/users/maumar/events{/privacy}","received_events_url":"https://api.github.com/users/maumar/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":7,"state":"closed","created_at":"2024-12-10T03:44:52Z","updated_at":"2025-02-05T21:49:43Z","due_on":null,"closed_at":"2025-02-05T21:49:43Z"},"comments":22,"created_at":"2024-11-06T12:01:07Z","updated_at":"2025-02-10T22:32:08Z","closed_at":"2025-01-14T07:12:55Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"repository":{"id":16157746,"node_id":"MDEwOlJlcG9zaXRvcnkxNjE1Nzc0Ng==","name":"efcore","full_name":"dotnet/efcore","private":false,"owner":{"login":"dotnet","id":9141961,"node_id":"MDEyOk9yZ2FuaXphdGlvbjkxNDE5NjE=","avatar_url":"https://avatars.githubusercontent.com/u/9141961?v=4","gravatar_id":"","url":"https://api.github.com/users/dotnet","html_url":"https://github.com/dotnet","followers_url":"https://api.github.com/users/dotnet/followers","following_url":"https://api.github.com/users/dotnet/following{/other_user}","gists_url":"https://api.github.com/users/dotnet/gists{/gist_id}","starred_url":"https://api.github.com/users/dotnet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dotnet/subscriptions","organizations_url":"https://api.github.com/users/dotnet/orgs","repos_url":"https://api.github.com/users/dotnet/repos","events_url":"https://api.github.com/users/dotnet/events{/privacy}","received_events_url":"https://api.github.com/users/dotnet/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/dotnet/efcore","description":"EF Core is a modern object-database mapper for .NET. It supports LINQ queries, change tracking, updates, and schema migrations.","fork":false,"url":"https://api.github.com/repos/dotnet/efcore","forks_url":"https://api.github.com/repos/dotnet/efcore/forks","keys_url":"https://api.github.com/repos/dotnet/efcore/keys{/key_id}","collaborators_url":"https://api.github.com/repos/dotnet/efcore/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/dotnet/efcore/teams","hooks_url":"https://api.github.com/repos/dotnet/efcore/hooks","issue_events_url":"https://api.github.com/repos/dotnet/efcore/issues/events{/number}","events_url":"https://api.github.com/repos/dotnet/efcore/events","assignees_url":"https://api.github.com/repos/dotnet/efcore/assignees{/user}","branches_url":"https://api.github.com/repos/dotnet/efcore/branches{/branch}","tags_url":"https://api.github.com/repos/dotnet/efcore/tags","blobs_url":"https://api.github.com/repos/dotnet/efcore/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/dotnet/efcore/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/dotnet/efcore/git/refs{/sha}","trees_url":"https://api.github.com/repos/dotnet/efcore/git/trees{/sha}","statuses_url":"https://api.github.com/repos/dotnet/efcore/statuses/{sha}","languages_url":"https://api.github.com/repos/dotnet/efcore/languages","stargazers_url":"https://api.github.com/repos/dotnet/efcore/stargazers","contributors_url":"https://api.github.com/repos/dotnet/efcore/contributors","subscribers_url":"https://api.github.com/repos/dotnet/efcore/subscribers","subscription_url":"https://api.github.com/repos/dotnet/efcore/subscription","commits_url":"https://api.github.com/repos/dotnet/efcore/commits{/sha}","git_commits_url":"https://api.github.com/repos/dotnet/efcore/git/commits{/sha}","comments_url":"https://api.github.com/repos/dotnet/efcore/comments{/number}","issue_comment_url":"https://api.github.com/repos/dotnet/efcore/issues/comments{/number}","contents_url":"https://api.github.com/repos/dotnet/efcore/contents/{+path}","compare_url":"https://api.github.com/repos/dotnet/efcore/compare/{base}...{head}","merges_url":"https://api.github.com/repos/dotnet/efcore/merges","archive_url":"https://api.github.com/repos/dotnet/efcore/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/dotnet/efcore/downloads","issues_url":"https://api.github.com/repos/dotnet/efcore/issues{/number}","pulls_url":"https://api.github.com/repos/dotnet/efcore/pulls{/number}","milestones_url":"https://api.github.com/repos/dotnet/efcore/milestones{/number}","notifications_url":"https://api.github.com/repos/dotnet/efcore/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/dotnet/efcore/labels{/name}","releases_url":"https://api.github.com/repos/dotnet/efcore/releases{/id}","deployments_url":"https://api.github.com/repos/dotnet/efcore/deployments","created_at":"2014-01-23T00:52:01Z","updated_at":"2025-11-10T14:21:49Z","pushed_at":"2025-11-10T05:59:58Z","git_url":"git://github.com/dotnet/efcore.git","ssh_url":"git@github.com:dotnet/efcore.git","clone_url":"https://github.com/dotnet/efcore.git","svn_url":"https://github.com/dotnet/efcore","homepage":"https://learn.microsoft.com/ef/","size":215987,"stargazers_count":14455,"watchers_count":14455,"language":"C#","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":3324,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":2430,"license":{"key":"mit","name":"MIT License","spdx_id":"MIT","url":"https://api.github.com/licenses/mit","node_id":"MDc6TGljZW5zZTEz"},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["aspnet-product","c-sharp","database","dotnet-core","dotnet-framework","dotnet-standard","entity-framework","hacktoberfest","orm"],"visibility":"public","forks":3324,"open_issues":2430,"watchers":14455,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"body":"I observed that EF 9 is running noticeably slower and is allocating twice as much memory compared to its performance with EF 8. I'm trying to determine whether this performance degradation is an isolated exception or if there might be an issue with my benchmarking setup. Any insights would be appreciated\n\n#### There are some benchmarks with BenchmarkDotnet\n\n| Method          | Job      | Runtime  | UseSplitQuery | Mean     | Error     | StdDev    | Ratio | RatioSD | Allocated | Alloc Ratio |\n|---------------- |--------- |--------- |-------------- |---------:|----------:|----------:|------:|--------:|----------:|------------:|\n| GetCustomerById | .NET 8.0 | .NET 8.0 | False         | 1.688 ms | 0.0368 ms | 0.1038 ms |  1.00 |    0.09 |  53.82 KB |        1.00 |\n| GetCustomerById | .NET 9.0 | .NET 9.0 | False         | 2.516 ms | 0.0474 ms | 0.1059 ms |  1.50 |    0.11 | 196.56 KB |        3.65 |\n|                 |          |          |               |          |           |           |       |         |           |             |\n| GetCustomerById | .NET 8.0 | .NET 8.0 | True          | 2.867 ms | 0.0598 ms | 0.1705 ms |  1.00 |    0.08 |  79.58 KB |        1.00 |\n| GetCustomerById | .NET 9.0 | .NET 9.0 | True          | 3.114 ms | 0.0732 ms | 0.2136 ms |  1.09 |    0.10 | 161.05 KB |        2.02 |\n\n\n#### Comparing the load testing metrics with k6. Performance degradation is also noticeable.\n\n| Metric                      | .NET 8                                | .NET 9                                |\n|----------------------------:|:-------------------------------------:|:-------------------------------------:|\n| **Total Requests**          | 1,690,574                             | 1,287,101                             |\n| **Requests per second**     | 1,741.02                              | 1,325.61                              |\n| **Data Received**           | 13 GB                                 | 9.5 GB                                |\n| **Data Sent**               | 220 MB                                | 164 MB                                |\n| **HTTP Request Duration**   | avg=2.29s, p(90)=4.79s, p(95)=5.51s   | avg=3.32s, p(90)=6.73s, p(95)=8.06s   |\n| **Request Blocking**        | avg=6.02µs, p(90)=5.01µs, p(95)=5.81µs| avg=6.65µs, p(90)=5.15µs, p(95)=6.02µs|\n| **Request Receiving**       | avg=44.14µs, p(90)=61.38µs, p(95)=75.48µs| avg=42.62µs, p(90)=62.5µs, p(95)=76.01µs|\n| **Request Sending**         | avg=14.77µs, p(90)=16.12µs, p(95)=32.88µs| avg=13.8µs, p(90)=15.95µs, p(95)=29.79µs|\n| **Iteration Duration**      | avg=3.29s, p(90)=5.79s, p(95)=6.52s   | avg=4.32s, p(90)=7.73s, p(95)=9.06s   |\n| **Virtual Users (VUs)**     | max=10,000                            | max=10,000                            |\n\n### Query for benchmarks.\n\n```\n var result =\n            await customerQuery.Select(customer => new CustomerDto\n                {\n                    Id = customer.Id,\n                    Name = customer.Name,\n                    Orders = customer.Orders.Select(order => new OrderDto\n                    {\n                        OrderId = order.Id,\n                        OrderDate = order.OrderDate,\n                        OrderItems = order.OrderItems.Select(oi => new OrderItemDto\n                        {\n                            OrderItemId = oi.Id,\n                            ProductName = oi.ProductName,\n                            Quantity = oi.Quantity,\n                            Price = oi.Price\n                        }).ToList()\n                    }).ToList()\n                })\n                .FirstOrDefaultAsync(c => c.Id == customerId);\n```\n\n\n#### Benchmarking ToListAsync() (retrieving 10000 items into memory)\nWe can observe 7x performance degradation for both speed and memory allocation between EF8 and EF9\n\n| Method                | Job      | Runtime  | Mean    | Error    | StdDev   | Ratio | RatioSD | Allocated  | Alloc Ratio |\n|---------------------- |--------- |--------- |--------:|---------:|---------:|------:|--------:|-----------:|------------:|\n| GetALlCustomers       | .NET 8.0 | .NET 8.0 | 1.788 s | 0.0194 s | 0.0172 s |  1.00 |    0.01 |  272.78 MB |        1.00 |\n| GetALlCustomers       | .NET 9.0 | .NET 9.0 | 7.926 s | 0.0411 s | 0.0384 s |  4.43 |    0.05 | 1784.25 MB |        6.54 |\n\n\n\n\n### Complete source code for the benchmarks\n[My repo](https://github.com/wallyrion/Benchmarks.EF-Dapper)\n\n### Include provider and version information\n\nEF Core version:\nDatabase provider Npgsql.EntityFrameworkCore.PostgreSQL (I tried to use SqlServer provider instead of Postgres and is shows the same results)\n**Version=\"8.0.10\"\nVersion=\"9.0.0-rc.2.24474.1\"** \nTarget framework: (e.g. .NET 8.0 and .NET 9)\nOperating system:\nWindows 11 (for benchmarks) / Docker container (for load test)\n","reactions":{"url":"https://api.github.com/repos/dotnet/efcore/issues/35053/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/dotnet/efcore/issues/35053/timeline","performed_via_github_app":null,"state_reason":"completed"}},"event":"cross-referenced"},{"id":15477349595,"node_id":"SE_lADOAPaMMs6hQCpUzwAAAAOahZzb","url":"https://api.github.com/repos/dotnet/efcore/issues/events/15477349595","actor":{"login":"frencsi","id":31436644,"node_id":"MDQ6VXNlcjMxNDM2NjQ0","avatar_url":"https://avatars.githubusercontent.com/u/31436644?v=4","gravatar_id":"","url":"https://api.github.com/users/frencsi","html_url":"https://github.com/frencsi","followers_url":"https://api.github.com/users/frencsi/followers","following_url":"https://api.github.com/users/frencsi/following{/other_user}","gists_url":"https://api.github.com/users/frencsi/gists{/gist_id}","starred_url":"https://api.github.com/users/frencsi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/frencsi/subscriptions","organizations_url":"https://api.github.com/users/frencsi/orgs","repos_url":"https://api.github.com/users/frencsi/repos","events_url":"https://api.github.com/users/frencsi/events{/privacy}","received_events_url":"https://api.github.com/users/frencsi/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2024-11-29T16:10:46Z","performed_via_github_app":null},{"id":15480494626,"node_id":"AE_lADOAPaMMs6hQCpUzwAAAAOatZoi","url":"https://api.github.com/repos/dotnet/efcore/issues/events/15480494626","actor":{"login":"maumar","id":1591930,"node_id":"MDQ6VXNlcjE1OTE5MzA=","avatar_url":"https://avatars.githubusercontent.com/u/1591930?v=4","gravatar_id":"","url":"https://api.github.com/users/maumar","html_url":"https://github.com/maumar","followers_url":"https://api.github.com/users/maumar/followers","following_url":"https://api.github.com/users/maumar/following{/other_user}","gists_url":"https://api.github.com/users/maumar/gists{/gist_id}","starred_url":"https://api.github.com/users/maumar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/maumar/subscriptions","organizations_url":"https://api.github.com/users/maumar/orgs","repos_url":"https://api.github.com/users/maumar/repos","events_url":"https://api.github.com/users/maumar/events{/privacy}","received_events_url":"https://api.github.com/users/maumar/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"assigned","commit_id":null,"commit_url":null,"created_at":"2024-11-30T08:03:35Z","assignee":{"login":"maumar","id":1591930,"node_id":"MDQ6VXNlcjE1OTE5MzA=","avatar_url":"https://avatars.githubusercontent.com/u/1591930?v=4","gravatar_id":"","url":"https://api.github.com/users/maumar","html_url":"https://github.com/maumar","followers_url":"https://api.github.com/users/maumar/followers","following_url":"https://api.github.com/users/maumar/following{/other_user}","gists_url":"https://api.github.com/users/maumar/gists{/gist_id}","starred_url":"https://api.github.com/users/maumar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/maumar/subscriptions","organizations_url":"https://api.github.com/users/maumar/orgs","repos_url":"https://api.github.com/users/maumar/repos","events_url":"https://api.github.com/users/maumar/events{/privacy}","received_events_url":"https://api.github.com/users/maumar/received_events","type":"User","user_view_type":"public","site_admin":false},"performed_via_github_app":null},{"url":"https://api.github.com/repos/dotnet/efcore/issues/comments/2508884468","html_url":"https://github.com/dotnet/efcore/issues/35239#issuecomment-2508884468","issue_url":"https://api.github.com/repos/dotnet/efcore/issues/35239","id":2508884468,"node_id":"IC_kwDOAPaMMs6Vion0","user":{"login":"roji","id":1862641,"node_id":"MDQ6VXNlcjE4NjI2NDE=","avatar_url":"https://avatars.githubusercontent.com/u/1862641?v=4","gravatar_id":"","url":"https://api.github.com/users/roji","html_url":"https://github.com/roji","followers_url":"https://api.github.com/users/roji/followers","following_url":"https://api.github.com/users/roji/following{/other_user}","gists_url":"https://api.github.com/users/roji/gists{/gist_id}","starred_url":"https://api.github.com/users/roji/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roji/subscriptions","organizations_url":"https://api.github.com/users/roji/orgs","repos_url":"https://api.github.com/users/roji/repos","events_url":"https://api.github.com/users/roji/events{/privacy}","received_events_url":"https://api.github.com/users/roji/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-11-30T08:23:24Z","updated_at":"2024-11-30T08:23:24Z","body":"The difference between 8.0 and 9.0 is likely part of the more general #35053 (not specifically related to JSON), though we should test this scenario specifically after the fixes to #35053 to make sure.\n\nThen for the general difference between PG legacy POCO mapping and ToJson, some difference is definitely expected (since legacy POCO treats the whole document as a single property, no change tracking inside); but 300ms does seem quite excessive (any thoughts @ajcvickers?).","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/dotnet/efcore/issues/comments/2508884468/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"roji","id":1862641,"node_id":"MDQ6VXNlcjE4NjI2NDE=","avatar_url":"https://avatars.githubusercontent.com/u/1862641?v=4","gravatar_id":"","url":"https://api.github.com/users/roji","html_url":"https://github.com/roji","followers_url":"https://api.github.com/users/roji/followers","following_url":"https://api.github.com/users/roji/following{/other_user}","gists_url":"https://api.github.com/users/roji/gists{/gist_id}","starred_url":"https://api.github.com/users/roji/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roji/subscriptions","organizations_url":"https://api.github.com/users/roji/orgs","repos_url":"https://api.github.com/users/roji/repos","events_url":"https://api.github.com/users/roji/events{/privacy}","received_events_url":"https://api.github.com/users/roji/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":15480532314,"node_id":"MEE_lADOAPaMMs6hQCpUzwAAAAOati1a","url":"https://api.github.com/repos/dotnet/efcore/issues/events/15480532314","actor":{"login":"ajcvickers","id":1430078,"node_id":"MDQ6VXNlcjE0MzAwNzg=","avatar_url":"https://avatars.githubusercontent.com/u/1430078?v=4","gravatar_id":"","url":"https://api.github.com/users/ajcvickers","html_url":"https://github.com/ajcvickers","followers_url":"https://api.github.com/users/ajcvickers/followers","following_url":"https://api.github.com/users/ajcvickers/following{/other_user}","gists_url":"https://api.github.com/users/ajcvickers/gists{/gist_id}","starred_url":"https://api.github.com/users/ajcvickers/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajcvickers/subscriptions","organizations_url":"https://api.github.com/users/ajcvickers/orgs","repos_url":"https://api.github.com/users/ajcvickers/repos","events_url":"https://api.github.com/users/ajcvickers/events{/privacy}","received_events_url":"https://api.github.com/users/ajcvickers/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2024-11-30T08:23:25Z","performed_via_github_app":null},{"id":15480532316,"node_id":"SE_lADOAPaMMs6hQCpUzwAAAAOati1c","url":"https://api.github.com/repos/dotnet/efcore/issues/events/15480532316","actor":{"login":"ajcvickers","id":1430078,"node_id":"MDQ6VXNlcjE0MzAwNzg=","avatar_url":"https://avatars.githubusercontent.com/u/1430078?v=4","gravatar_id":"","url":"https://api.github.com/users/ajcvickers","html_url":"https://github.com/ajcvickers","followers_url":"https://api.github.com/users/ajcvickers/followers","following_url":"https://api.github.com/users/ajcvickers/following{/other_user}","gists_url":"https://api.github.com/users/ajcvickers/gists{/gist_id}","starred_url":"https://api.github.com/users/ajcvickers/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajcvickers/subscriptions","organizations_url":"https://api.github.com/users/ajcvickers/orgs","repos_url":"https://api.github.com/users/ajcvickers/repos","events_url":"https://api.github.com/users/ajcvickers/events{/privacy}","received_events_url":"https://api.github.com/users/ajcvickers/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2024-11-30T08:23:25Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/dotnet/efcore/issues/comments/2508909665","html_url":"https://github.com/dotnet/efcore/issues/35239#issuecomment-2508909665","issue_url":"https://api.github.com/repos/dotnet/efcore/issues/35239","id":2508909665,"node_id":"IC_kwDOAPaMMs6Viuxh","user":{"login":"ajcvickers","id":1430078,"node_id":"MDQ6VXNlcjE0MzAwNzg=","avatar_url":"https://avatars.githubusercontent.com/u/1430078?v=4","gravatar_id":"","url":"https://api.github.com/users/ajcvickers","html_url":"https://github.com/ajcvickers","followers_url":"https://api.github.com/users/ajcvickers/followers","following_url":"https://api.github.com/users/ajcvickers/following{/other_user}","gists_url":"https://api.github.com/users/ajcvickers/gists{/gist_id}","starred_url":"https://api.github.com/users/ajcvickers/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajcvickers/subscriptions","organizations_url":"https://api.github.com/users/ajcvickers/orgs","repos_url":"https://api.github.com/users/ajcvickers/repos","events_url":"https://api.github.com/users/ajcvickers/events{/privacy}","received_events_url":"https://api.github.com/users/ajcvickers/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-11-30T10:07:23Z","updated_at":"2024-11-30T10:07:23Z","body":"Yep, seems slow. But our relational JSON processing code is very inefficient--multiple passes, use of DOM, etc.--so it's not too much of a surprise.","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/dotnet/efcore/issues/comments/2508909665/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"ajcvickers","id":1430078,"node_id":"MDQ6VXNlcjE0MzAwNzg=","avatar_url":"https://avatars.githubusercontent.com/u/1430078?v=4","gravatar_id":"","url":"https://api.github.com/users/ajcvickers","html_url":"https://github.com/ajcvickers","followers_url":"https://api.github.com/users/ajcvickers/followers","following_url":"https://api.github.com/users/ajcvickers/following{/other_user}","gists_url":"https://api.github.com/users/ajcvickers/gists{/gist_id}","starred_url":"https://api.github.com/users/ajcvickers/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajcvickers/subscriptions","organizations_url":"https://api.github.com/users/ajcvickers/orgs","repos_url":"https://api.github.com/users/ajcvickers/repos","events_url":"https://api.github.com/users/ajcvickers/events{/privacy}","received_events_url":"https://api.github.com/users/ajcvickers/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":15481667393,"node_id":"SE_lADOAPaMMs6hQCpUzwAAAAOax39B","url":"https://api.github.com/repos/dotnet/efcore/issues/events/15481667393","actor":{"login":"Xor-el","id":12124088,"node_id":"MDQ6VXNlcjEyMTI0MDg4","avatar_url":"https://avatars.githubusercontent.com/u/12124088?v=4","gravatar_id":"","url":"https://api.github.com/users/Xor-el","html_url":"https://github.com/Xor-el","followers_url":"https://api.github.com/users/Xor-el/followers","following_url":"https://api.github.com/users/Xor-el/following{/other_user}","gists_url":"https://api.github.com/users/Xor-el/gists{/gist_id}","starred_url":"https://api.github.com/users/Xor-el/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Xor-el/subscriptions","organizations_url":"https://api.github.com/users/Xor-el/orgs","repos_url":"https://api.github.com/users/Xor-el/repos","events_url":"https://api.github.com/users/Xor-el/events{/privacy}","received_events_url":"https://api.github.com/users/Xor-el/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2024-11-30T17:53:48Z","performed_via_github_app":null},{"id":15494780831,"node_id":"SE_lADOAPaMMs6hQCpUzwAAAAObj5ef","url":"https://api.github.com/repos/dotnet/efcore/issues/events/15494780831","actor":{"login":"ramonesz297","id":20284037,"node_id":"MDQ6VXNlcjIwMjg0MDM3","avatar_url":"https://avatars.githubusercontent.com/u/20284037?v=4","gravatar_id":"","url":"https://api.github.com/users/ramonesz297","html_url":"https://github.com/ramonesz297","followers_url":"https://api.github.com/users/ramonesz297/followers","following_url":"https://api.github.com/users/ramonesz297/following{/other_user}","gists_url":"https://api.github.com/users/ramonesz297/gists{/gist_id}","starred_url":"https://api.github.com/users/ramonesz297/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ramonesz297/subscriptions","organizations_url":"https://api.github.com/users/ramonesz297/orgs","repos_url":"https://api.github.com/users/ramonesz297/repos","events_url":"https://api.github.com/users/ramonesz297/events{/privacy}","received_events_url":"https://api.github.com/users/ramonesz297/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2024-12-02T15:23:13Z","performed_via_github_app":null},{"id":15497440687,"node_id":"SE_lADOAPaMMs6hQCpUzwAAAAObuC2v","url":"https://api.github.com/repos/dotnet/efcore/issues/events/15497440687","actor":{"login":"marcominerva","id":3522534,"node_id":"MDQ6VXNlcjM1MjI1MzQ=","avatar_url":"https://avatars.githubusercontent.com/u/3522534?v=4","gravatar_id":"","url":"https://api.github.com/users/marcominerva","html_url":"https://github.com/marcominerva","followers_url":"https://api.github.com/users/marcominerva/followers","following_url":"https://api.github.com/users/marcominerva/following{/other_user}","gists_url":"https://api.github.com/users/marcominerva/gists{/gist_id}","starred_url":"https://api.github.com/users/marcominerva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marcominerva/subscriptions","organizations_url":"https://api.github.com/users/marcominerva/orgs","repos_url":"https://api.github.com/users/marcominerva/repos","events_url":"https://api.github.com/users/marcominerva/events{/privacy}","received_events_url":"https://api.github.com/users/marcominerva/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2024-12-02T18:13:35Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/dotnet/efcore/issues/comments/2540532876","html_url":"https://github.com/dotnet/efcore/issues/35239#issuecomment-2540532876","issue_url":"https://api.github.com/repos/dotnet/efcore/issues/35239","id":2540532876,"node_id":"IC_kwDOAPaMMs6XbXSM","user":{"login":"maumar","id":1591930,"node_id":"MDQ6VXNlcjE1OTE5MzA=","avatar_url":"https://avatars.githubusercontent.com/u/1591930?v=4","gravatar_id":"","url":"https://api.github.com/users/maumar","html_url":"https://github.com/maumar","followers_url":"https://api.github.com/users/maumar/followers","following_url":"https://api.github.com/users/maumar/following{/other_user}","gists_url":"https://api.github.com/users/maumar/gists{/gist_id}","starred_url":"https://api.github.com/users/maumar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/maumar/subscriptions","organizations_url":"https://api.github.com/users/maumar/orgs","repos_url":"https://api.github.com/users/maumar/repos","events_url":"https://api.github.com/users/maumar/events{/privacy}","received_events_url":"https://api.github.com/users/maumar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-13T04:34:01Z","updated_at":"2024-12-13T04:34:01Z","body":"Problem is with `List<Guid>` property. ListOfValueTypesComparer (as well as ListOfNullableValueTypesComparer and ListOfReferenceTypesComparer) use ValueComparer.ConstructorExpression to build a new instance of valuecomparer every time it's called rather than use the instance passed as an argument (ValueComparer constant is not something we can represent in code for AOT case). This results in us creating 1000s of comparers, which then have their Equal(Guid Guid) delegate lazilly compiled (1000s of times) during save changes.","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/dotnet/efcore/issues/comments/2540532876/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"maumar","id":1591930,"node_id":"MDQ6VXNlcjE1OTE5MzA=","avatar_url":"https://avatars.githubusercontent.com/u/1591930?v=4","gravatar_id":"","url":"https://api.github.com/users/maumar","html_url":"https://github.com/maumar","followers_url":"https://api.github.com/users/maumar/followers","following_url":"https://api.github.com/users/maumar/following{/other_user}","gists_url":"https://api.github.com/users/maumar/gists{/gist_id}","starred_url":"https://api.github.com/users/maumar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/maumar/subscriptions","organizations_url":"https://api.github.com/users/maumar/orgs","repos_url":"https://api.github.com/users/maumar/repos","events_url":"https://api.github.com/users/maumar/events{/privacy}","received_events_url":"https://api.github.com/users/maumar/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/dotnet/efcore/issues/comments/2540558698","html_url":"https://github.com/dotnet/efcore/issues/35239#issuecomment-2540558698","issue_url":"https://api.github.com/repos/dotnet/efcore/issues/35239","id":2540558698,"node_id":"IC_kwDOAPaMMs6Xbdlq","user":{"login":"maumar","id":1591930,"node_id":"MDQ6VXNlcjE1OTE5MzA=","avatar_url":"https://avatars.githubusercontent.com/u/1591930?v=4","gravatar_id":"","url":"https://api.github.com/users/maumar","html_url":"https://github.com/maumar","followers_url":"https://api.github.com/users/maumar/followers","following_url":"https://api.github.com/users/maumar/following{/other_user}","gists_url":"https://api.github.com/users/maumar/gists{/gist_id}","starred_url":"https://api.github.com/users/maumar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/maumar/subscriptions","organizations_url":"https://api.github.com/users/maumar/orgs","repos_url":"https://api.github.com/users/maumar/repos","events_url":"https://api.github.com/users/maumar/events{/privacy}","received_events_url":"https://api.github.com/users/maumar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-13T05:04:45Z","updated_at":"2024-12-13T05:04:45Z","body":"We should use EqualsExpression SnapshotExpression from the element comparer rather than comparer itself. So, instead of \n\n```cs\nprivate static bool Compare(IEnumerable<TElement>? a, IEnumerable<TElement>? b, ValueComparer<TElement> elementComparer)\n```\n\nwe should use\n\n```cs\nprivate static bool Compare(IEnumerable<TElement>? a, IEnumerable<TElement>? b, Type elementComparerType, Func<TElement, TElement, bool> equalsFunc)\n```\n","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/dotnet/efcore/issues/comments/2540558698/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"maumar","id":1591930,"node_id":"MDQ6VXNlcjE1OTE5MzA=","avatar_url":"https://avatars.githubusercontent.com/u/1591930?v=4","gravatar_id":"","url":"https://api.github.com/users/maumar","html_url":"https://github.com/maumar","followers_url":"https://api.github.com/users/maumar/followers","following_url":"https://api.github.com/users/maumar/following{/other_user}","gists_url":"https://api.github.com/users/maumar/gists{/gist_id}","starred_url":"https://api.github.com/users/maumar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/maumar/subscriptions","organizations_url":"https://api.github.com/users/maumar/orgs","repos_url":"https://api.github.com/users/maumar/repos","events_url":"https://api.github.com/users/maumar/events{/privacy}","received_events_url":"https://api.github.com/users/maumar/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":15647332984,"node_id":"REFE_lADOAPaMMs6hQCpUzwAAAAOkp1p4","url":"https://api.github.com/repos/dotnet/efcore/issues/events/15647332984","actor":{"login":"maumar","id":1591930,"node_id":"MDQ6VXNlcjE1OTE5MzA=","avatar_url":"https://avatars.githubusercontent.com/u/1591930?v=4","gravatar_id":"","url":"https://api.github.com/users/maumar","html_url":"https://github.com/maumar","followers_url":"https://api.github.com/users/maumar/followers","following_url":"https://api.github.com/users/maumar/following{/other_user}","gists_url":"https://api.github.com/users/maumar/gists{/gist_id}","starred_url":"https://api.github.com/users/maumar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/maumar/subscriptions","organizations_url":"https://api.github.com/users/maumar/orgs","repos_url":"https://api.github.com/users/maumar/repos","events_url":"https://api.github.com/users/maumar/events{/privacy}","received_events_url":"https://api.github.com/users/maumar/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"acf51971f12582193520903000bda16282794893","commit_url":"https://api.github.com/repos/dotnet/efcore/commits/acf51971f12582193520903000bda16282794893","created_at":"2024-12-13T11:04:34Z","performed_via_github_app":null},{"actor":{"login":"maumar","id":1591930,"node_id":"MDQ6VXNlcjE1OTE5MzA=","avatar_url":"https://avatars.githubusercontent.com/u/1591930?v=4","gravatar_id":"","url":"https://api.github.com/users/maumar","html_url":"https://github.com/maumar","followers_url":"https://api.github.com/users/maumar/followers","following_url":"https://api.github.com/users/maumar/following{/other_user}","gists_url":"https://api.github.com/users/maumar/gists{/gist_id}","starred_url":"https://api.github.com/users/maumar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/maumar/subscriptions","organizations_url":"https://api.github.com/users/maumar/orgs","repos_url":"https://api.github.com/users/maumar/repos","events_url":"https://api.github.com/users/maumar/events{/privacy}","received_events_url":"https://api.github.com/users/maumar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-13T11:04:54Z","updated_at":"2024-12-13T11:04:54Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/dotnet/efcore/issues/35326","repository_url":"https://api.github.com/repos/dotnet/efcore","labels_url":"https://api.github.com/repos/dotnet/efcore/issues/35326/labels{/name}","comments_url":"https://api.github.com/repos/dotnet/efcore/issues/35326/comments","events_url":"https://api.github.com/repos/dotnet/efcore/issues/35326/events","html_url":"https://github.com/dotnet/efcore/pull/35326","id":2738134561,"node_id":"PR_kwDOAPaMMs6FIerU","number":35326,"title":"Fix to #35239 - EF9: SaveChanges() is significantly slower in .NET9 vs. .NET8 when using .ToJson() Mapping vs. PostgreSQL Legacy POCO mapping","user":{"login":"maumar","id":1591930,"node_id":"MDQ6VXNlcjE1OTE5MzA=","avatar_url":"https://avatars.githubusercontent.com/u/1591930?v=4","gravatar_id":"","url":"https://api.github.com/users/maumar","html_url":"https://github.com/maumar","followers_url":"https://api.github.com/users/maumar/followers","following_url":"https://api.github.com/users/maumar/following{/other_user}","gists_url":"https://api.github.com/users/maumar/gists{/gist_id}","starred_url":"https://api.github.com/users/maumar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/maumar/subscriptions","organizations_url":"https://api.github.com/users/maumar/orgs","repos_url":"https://api.github.com/users/maumar/repos","events_url":"https://api.github.com/users/maumar/events{/privacy}","received_events_url":"https://api.github.com/users/maumar/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2024-12-13T11:04:53Z","updated_at":"2025-01-06T21:57:18Z","closed_at":"2025-01-06T21:57:17Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"draft":false,"repository":{"id":16157746,"node_id":"MDEwOlJlcG9zaXRvcnkxNjE1Nzc0Ng==","name":"efcore","full_name":"dotnet/efcore","private":false,"owner":{"login":"dotnet","id":9141961,"node_id":"MDEyOk9yZ2FuaXphdGlvbjkxNDE5NjE=","avatar_url":"https://avatars.githubusercontent.com/u/9141961?v=4","gravatar_id":"","url":"https://api.github.com/users/dotnet","html_url":"https://github.com/dotnet","followers_url":"https://api.github.com/users/dotnet/followers","following_url":"https://api.github.com/users/dotnet/following{/other_user}","gists_url":"https://api.github.com/users/dotnet/gists{/gist_id}","starred_url":"https://api.github.com/users/dotnet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dotnet/subscriptions","organizations_url":"https://api.github.com/users/dotnet/orgs","repos_url":"https://api.github.com/users/dotnet/repos","events_url":"https://api.github.com/users/dotnet/events{/privacy}","received_events_url":"https://api.github.com/users/dotnet/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/dotnet/efcore","description":"EF Core is a modern object-database mapper for .NET. It supports LINQ queries, change tracking, updates, and schema migrations.","fork":false,"url":"https://api.github.com/repos/dotnet/efcore","forks_url":"https://api.github.com/repos/dotnet/efcore/forks","keys_url":"https://api.github.com/repos/dotnet/efcore/keys{/key_id}","collaborators_url":"https://api.github.com/repos/dotnet/efcore/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/dotnet/efcore/teams","hooks_url":"https://api.github.com/repos/dotnet/efcore/hooks","issue_events_url":"https://api.github.com/repos/dotnet/efcore/issues/events{/number}","events_url":"https://api.github.com/repos/dotnet/efcore/events","assignees_url":"https://api.github.com/repos/dotnet/efcore/assignees{/user}","branches_url":"https://api.github.com/repos/dotnet/efcore/branches{/branch}","tags_url":"https://api.github.com/repos/dotnet/efcore/tags","blobs_url":"https://api.github.com/repos/dotnet/efcore/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/dotnet/efcore/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/dotnet/efcore/git/refs{/sha}","trees_url":"https://api.github.com/repos/dotnet/efcore/git/trees{/sha}","statuses_url":"https://api.github.com/repos/dotnet/efcore/statuses/{sha}","languages_url":"https://api.github.com/repos/dotnet/efcore/languages","stargazers_url":"https://api.github.com/repos/dotnet/efcore/stargazers","contributors_url":"https://api.github.com/repos/dotnet/efcore/contributors","subscribers_url":"https://api.github.com/repos/dotnet/efcore/subscribers","subscription_url":"https://api.github.com/repos/dotnet/efcore/subscription","commits_url":"https://api.github.com/repos/dotnet/efcore/commits{/sha}","git_commits_url":"https://api.github.com/repos/dotnet/efcore/git/commits{/sha}","comments_url":"https://api.github.com/repos/dotnet/efcore/comments{/number}","issue_comment_url":"https://api.github.com/repos/dotnet/efcore/issues/comments{/number}","contents_url":"https://api.github.com/repos/dotnet/efcore/contents/{+path}","compare_url":"https://api.github.com/repos/dotnet/efcore/compare/{base}...{head}","merges_url":"https://api.github.com/repos/dotnet/efcore/merges","archive_url":"https://api.github.com/repos/dotnet/efcore/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/dotnet/efcore/downloads","issues_url":"https://api.github.com/repos/dotnet/efcore/issues{/number}","pulls_url":"https://api.github.com/repos/dotnet/efcore/pulls{/number}","milestones_url":"https://api.github.com/repos/dotnet/efcore/milestones{/number}","notifications_url":"https://api.github.com/repos/dotnet/efcore/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/dotnet/efcore/labels{/name}","releases_url":"https://api.github.com/repos/dotnet/efcore/releases{/id}","deployments_url":"https://api.github.com/repos/dotnet/efcore/deployments","created_at":"2014-01-23T00:52:01Z","updated_at":"2025-11-10T14:21:49Z","pushed_at":"2025-11-10T05:59:58Z","git_url":"git://github.com/dotnet/efcore.git","ssh_url":"git@github.com:dotnet/efcore.git","clone_url":"https://github.com/dotnet/efcore.git","svn_url":"https://github.com/dotnet/efcore","homepage":"https://learn.microsoft.com/ef/","size":215987,"stargazers_count":14455,"watchers_count":14455,"language":"C#","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":3324,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":2430,"license":{"key":"mit","name":"MIT License","spdx_id":"MIT","url":"https://api.github.com/licenses/mit","node_id":"MDc6TGljZW5zZTEz"},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["aspnet-product","c-sharp","database","dotnet-core","dotnet-framework","dotnet-standard","entity-framework","hacktoberfest","orm"],"visibility":"public","forks":3324,"open_issues":2430,"watchers":14455,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/dotnet/efcore/pulls/35326","html_url":"https://github.com/dotnet/efcore/pull/35326","diff_url":"https://github.com/dotnet/efcore/pull/35326.diff","patch_url":"https://github.com/dotnet/efcore/pull/35326.patch","merged_at":"2025-01-06T21:57:17Z"},"body":"Problem was that as part of AOT refactoring we changed way that we build comparers. Specifically, comparers of collections - ListOfValueTypesComparer, ListOfNullableValueTypesComparer and ListOfReferenceTypesComparer. Before those list comparer Compare, Hashcode and Snapshot methods would take as argument element comparer, which was responsible for comparing elements. We need to be able to express these in code for AOT but we are not able to generate constant of type ValueComparer (or ValueComparer<TElement>) that was needed. As a solution, each comparer now stores expression describing how it can be constructed, so we use that instead (as we are perfectly capable to expressing that in code form). Problem is that now every time compare, snapshot or hashcode method is called for array type, we construct new ValueComparer for the element type. As a result in the reported case we would generate 1000s of comparers which all have to be compiled and that causes huge overhead.\r\n\r\nFix is to pass relevant func from the element comparer to the outer comparer. We only passed the element comparer object to the outer Compare/Hashcode/Snapshot function to call that relevant func. This way we avoid constructing redundant comparers.\r\n\r\nFixes #35239","reactions":{"url":"https://api.github.com/repos/dotnet/efcore/issues/35326/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/dotnet/efcore/issues/35326/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"id":15655172191,"node_id":"REFE_lADOAPaMMs6hQCpUzwAAAAOlHvhf","url":"https://api.github.com/repos/dotnet/efcore/issues/events/15655172191","actor":{"login":"maumar","id":1591930,"node_id":"MDQ6VXNlcjE1OTE5MzA=","avatar_url":"https://avatars.githubusercontent.com/u/1591930?v=4","gravatar_id":"","url":"https://api.github.com/users/maumar","html_url":"https://github.com/maumar","followers_url":"https://api.github.com/users/maumar/followers","following_url":"https://api.github.com/users/maumar/following{/other_user}","gists_url":"https://api.github.com/users/maumar/gists{/gist_id}","starred_url":"https://api.github.com/users/maumar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/maumar/subscriptions","organizations_url":"https://api.github.com/users/maumar/orgs","repos_url":"https://api.github.com/users/maumar/repos","events_url":"https://api.github.com/users/maumar/events{/privacy}","received_events_url":"https://api.github.com/users/maumar/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"93806f66c1605a1eb8e4d472de06504ebfc9328d","commit_url":"https://api.github.com/repos/dotnet/efcore/commits/93806f66c1605a1eb8e4d472de06504ebfc9328d","created_at":"2024-12-14T02:27:24Z","performed_via_github_app":null},{"id":15655185219,"node_id":"REFE_lADOAPaMMs6hQCpUzwAAAAOlHytD","url":"https://api.github.com/repos/dotnet/efcore/issues/events/15655185219","actor":{"login":"maumar","id":1591930,"node_id":"MDQ6VXNlcjE1OTE5MzA=","avatar_url":"https://avatars.githubusercontent.com/u/1591930?v=4","gravatar_id":"","url":"https://api.github.com/users/maumar","html_url":"https://github.com/maumar","followers_url":"https://api.github.com/users/maumar/followers","following_url":"https://api.github.com/users/maumar/following{/other_user}","gists_url":"https://api.github.com/users/maumar/gists{/gist_id}","starred_url":"https://api.github.com/users/maumar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/maumar/subscriptions","organizations_url":"https://api.github.com/users/maumar/orgs","repos_url":"https://api.github.com/users/maumar/repos","events_url":"https://api.github.com/users/maumar/events{/privacy}","received_events_url":"https://api.github.com/users/maumar/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"41306eb213c39aff8977bf0d7dc6b3b4d59dd37b","commit_url":"https://api.github.com/repos/dotnet/efcore/commits/41306eb213c39aff8977bf0d7dc6b3b4d59dd37b","created_at":"2024-12-14T02:32:01Z","performed_via_github_app":null},{"id":15655193159,"node_id":"REFE_lADOAPaMMs6hQCpUzwAAAAOlH0pH","url":"https://api.github.com/repos/dotnet/efcore/issues/events/15655193159","actor":{"login":"maumar","id":1591930,"node_id":"MDQ6VXNlcjE1OTE5MzA=","avatar_url":"https://avatars.githubusercontent.com/u/1591930?v=4","gravatar_id":"","url":"https://api.github.com/users/maumar","html_url":"https://github.com/maumar","followers_url":"https://api.github.com/users/maumar/followers","following_url":"https://api.github.com/users/maumar/following{/other_user}","gists_url":"https://api.github.com/users/maumar/gists{/gist_id}","starred_url":"https://api.github.com/users/maumar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/maumar/subscriptions","organizations_url":"https://api.github.com/users/maumar/orgs","repos_url":"https://api.github.com/users/maumar/repos","events_url":"https://api.github.com/users/maumar/events{/privacy}","received_events_url":"https://api.github.com/users/maumar/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"56e51cfd2420a77d9b921dd9fc4887da30af5654","commit_url":"https://api.github.com/repos/dotnet/efcore/commits/56e51cfd2420a77d9b921dd9fc4887da30af5654","created_at":"2024-12-14T02:36:18Z","performed_via_github_app":null},{"id":15656862162,"node_id":"REFE_lADOAPaMMs6hQCpUzwAAAAOlOMHS","url":"https://api.github.com/repos/dotnet/efcore/issues/events/15656862162","actor":{"login":"maumar","id":1591930,"node_id":"MDQ6VXNlcjE1OTE5MzA=","avatar_url":"https://avatars.githubusercontent.com/u/1591930?v=4","gravatar_id":"","url":"https://api.github.com/users/maumar","html_url":"https://github.com/maumar","followers_url":"https://api.github.com/users/maumar/followers","following_url":"https://api.github.com/users/maumar/following{/other_user}","gists_url":"https://api.github.com/users/maumar/gists{/gist_id}","starred_url":"https://api.github.com/users/maumar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/maumar/subscriptions","organizations_url":"https://api.github.com/users/maumar/orgs","repos_url":"https://api.github.com/users/maumar/repos","events_url":"https://api.github.com/users/maumar/events{/privacy}","received_events_url":"https://api.github.com/users/maumar/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"9b4fbbfea152b5b76d90e3d0ae34a6482f061af4","commit_url":"https://api.github.com/repos/dotnet/efcore/commits/9b4fbbfea152b5b76d90e3d0ae34a6482f061af4","created_at":"2024-12-14T10:55:15Z","performed_via_github_app":null},{"id":15713954142,"node_id":"REFE_lADOAPaMMs6hQCpUzwAAAAOon-le","url":"https://api.github.com/repos/dotnet/efcore/issues/events/15713954142","actor":{"login":"maumar","id":1591930,"node_id":"MDQ6VXNlcjE1OTE5MzA=","avatar_url":"https://avatars.githubusercontent.com/u/1591930?v=4","gravatar_id":"","url":"https://api.github.com/users/maumar","html_url":"https://github.com/maumar","followers_url":"https://api.github.com/users/maumar/followers","following_url":"https://api.github.com/users/maumar/following{/other_user}","gists_url":"https://api.github.com/users/maumar/gists{/gist_id}","starred_url":"https://api.github.com/users/maumar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/maumar/subscriptions","organizations_url":"https://api.github.com/users/maumar/orgs","repos_url":"https://api.github.com/users/maumar/repos","events_url":"https://api.github.com/users/maumar/events{/privacy}","received_events_url":"https://api.github.com/users/maumar/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"d0585515e84fe97f336c1155fd8f0af01394ce33","commit_url":"https://api.github.com/repos/dotnet/efcore/commits/d0585515e84fe97f336c1155fd8f0af01394ce33","created_at":"2024-12-19T08:48:27Z","performed_via_github_app":null},{"id":15714193815,"node_id":"REFE_lADOAPaMMs6hQCpUzwAAAAOoo5GX","url":"https://api.github.com/repos/dotnet/efcore/issues/events/15714193815","actor":{"login":"maumar","id":1591930,"node_id":"MDQ6VXNlcjE1OTE5MzA=","avatar_url":"https://avatars.githubusercontent.com/u/1591930?v=4","gravatar_id":"","url":"https://api.github.com/users/maumar","html_url":"https://github.com/maumar","followers_url":"https://api.github.com/users/maumar/followers","following_url":"https://api.github.com/users/maumar/following{/other_user}","gists_url":"https://api.github.com/users/maumar/gists{/gist_id}","starred_url":"https://api.github.com/users/maumar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/maumar/subscriptions","organizations_url":"https://api.github.com/users/maumar/orgs","repos_url":"https://api.github.com/users/maumar/repos","events_url":"https://api.github.com/users/maumar/events{/privacy}","received_events_url":"https://api.github.com/users/maumar/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"934f69c390a2e2072f530a64816783f713201c3c","commit_url":"https://api.github.com/repos/dotnet/efcore/commits/934f69c390a2e2072f530a64816783f713201c3c","created_at":"2024-12-19T09:08:06Z","performed_via_github_app":null},{"id":15714229735,"node_id":"REFE_lADOAPaMMs6hQCpUzwAAAAOopB3n","url":"https://api.github.com/repos/dotnet/efcore/issues/events/15714229735","actor":{"login":"maumar","id":1591930,"node_id":"MDQ6VXNlcjE1OTE5MzA=","avatar_url":"https://avatars.githubusercontent.com/u/1591930?v=4","gravatar_id":"","url":"https://api.github.com/users/maumar","html_url":"https://github.com/maumar","followers_url":"https://api.github.com/users/maumar/followers","following_url":"https://api.github.com/users/maumar/following{/other_user}","gists_url":"https://api.github.com/users/maumar/gists{/gist_id}","starred_url":"https://api.github.com/users/maumar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/maumar/subscriptions","organizations_url":"https://api.github.com/users/maumar/orgs","repos_url":"https://api.github.com/users/maumar/repos","events_url":"https://api.github.com/users/maumar/events{/privacy}","received_events_url":"https://api.github.com/users/maumar/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"da82547e3eb37ffedfb4e46b96a0a26124abc532","commit_url":"https://api.github.com/repos/dotnet/efcore/commits/da82547e3eb37ffedfb4e46b96a0a26124abc532","created_at":"2024-12-19T09:10:58Z","performed_via_github_app":null},{"id":15714739495,"node_id":"REFE_lADOAPaMMs6hQCpUzwAAAAOoq-Un","url":"https://api.github.com/repos/dotnet/efcore/issues/events/15714739495","actor":{"login":"maumar","id":1591930,"node_id":"MDQ6VXNlcjE1OTE5MzA=","avatar_url":"https://avatars.githubusercontent.com/u/1591930?v=4","gravatar_id":"","url":"https://api.github.com/users/maumar","html_url":"https://github.com/maumar","followers_url":"https://api.github.com/users/maumar/followers","following_url":"https://api.github.com/users/maumar/following{/other_user}","gists_url":"https://api.github.com/users/maumar/gists{/gist_id}","starred_url":"https://api.github.com/users/maumar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/maumar/subscriptions","organizations_url":"https://api.github.com/users/maumar/orgs","repos_url":"https://api.github.com/users/maumar/repos","events_url":"https://api.github.com/users/maumar/events{/privacy}","received_events_url":"https://api.github.com/users/maumar/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"a949c833145fe1cf9815acdc9105433e9de3af2d","commit_url":"https://api.github.com/repos/dotnet/efcore/commits/a949c833145fe1cf9815acdc9105433e9de3af2d","created_at":"2024-12-19T09:46:38Z","performed_via_github_app":null},{"id":15714899502,"node_id":"REFE_lADOAPaMMs6hQCpUzwAAAAOorlYu","url":"https://api.github.com/repos/dotnet/efcore/issues/events/15714899502","actor":{"login":"maumar","id":1591930,"node_id":"MDQ6VXNlcjE1OTE5MzA=","avatar_url":"https://avatars.githubusercontent.com/u/1591930?v=4","gravatar_id":"","url":"https://api.github.com/users/maumar","html_url":"https://github.com/maumar","followers_url":"https://api.github.com/users/maumar/followers","following_url":"https://api.github.com/users/maumar/following{/other_user}","gists_url":"https://api.github.com/users/maumar/gists{/gist_id}","starred_url":"https://api.github.com/users/maumar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/maumar/subscriptions","organizations_url":"https://api.github.com/users/maumar/orgs","repos_url":"https://api.github.com/users/maumar/repos","events_url":"https://api.github.com/users/maumar/events{/privacy}","received_events_url":"https://api.github.com/users/maumar/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"c8d3f3f88722eac4ab33a44cd71c7829b1bb0ee3","commit_url":"https://api.github.com/repos/dotnet/efcore/commits/c8d3f3f88722eac4ab33a44cd71c7829b1bb0ee3","created_at":"2024-12-19T09:56:58Z","performed_via_github_app":null},{"actor":{"login":"maumar","id":1591930,"node_id":"MDQ6VXNlcjE1OTE5MzA=","avatar_url":"https://avatars.githubusercontent.com/u/1591930?v=4","gravatar_id":"","url":"https://api.github.com/users/maumar","html_url":"https://github.com/maumar","followers_url":"https://api.github.com/users/maumar/followers","following_url":"https://api.github.com/users/maumar/following{/other_user}","gists_url":"https://api.github.com/users/maumar/gists{/gist_id}","starred_url":"https://api.github.com/users/maumar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/maumar/subscriptions","organizations_url":"https://api.github.com/users/maumar/orgs","repos_url":"https://api.github.com/users/maumar/repos","events_url":"https://api.github.com/users/maumar/events{/privacy}","received_events_url":"https://api.github.com/users/maumar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-19T22:22:11Z","updated_at":"2024-12-19T22:22:11Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/dotnet/efcore/issues/35360","repository_url":"https://api.github.com/repos/dotnet/efcore","labels_url":"https://api.github.com/repos/dotnet/efcore/issues/35360/labels{/name}","comments_url":"https://api.github.com/repos/dotnet/efcore/issues/35360/comments","events_url":"https://api.github.com/repos/dotnet/efcore/issues/35360/events","html_url":"https://github.com/dotnet/efcore/pull/35360","id":2751534703,"node_id":"PR_kwDOAPaMMs6F2YiL","number":35360,"title":"[release/9.0-staging] Fix to #35239 - EF9: SaveChanges() is significantly slower in .NET9 vs. .NET8 when using .ToJson() Mapping vs. PostgreSQL Legacy POCO mapping","user":{"login":"maumar","id":1591930,"node_id":"MDQ6VXNlcjE1OTE5MzA=","avatar_url":"https://avatars.githubusercontent.com/u/1591930?v=4","gravatar_id":"","url":"https://api.github.com/users/maumar","html_url":"https://github.com/maumar","followers_url":"https://api.github.com/users/maumar/followers","following_url":"https://api.github.com/users/maumar/following{/other_user}","gists_url":"https://api.github.com/users/maumar/gists{/gist_id}","starred_url":"https://api.github.com/users/maumar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/maumar/subscriptions","organizations_url":"https://api.github.com/users/maumar/orgs","repos_url":"https://api.github.com/users/maumar/repos","events_url":"https://api.github.com/users/maumar/events{/privacy}","received_events_url":"https://api.github.com/users/maumar/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":1017558838,"node_id":"MDU6TGFiZWwxMDE3NTU4ODM4","url":"https://api.github.com/repos/dotnet/efcore/labels/Servicing-approved","name":"Servicing-approved","color":"048708","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/dotnet/efcore/milestones/209","html_url":"https://github.com/dotnet/efcore/milestone/209","labels_url":"https://api.github.com/repos/dotnet/efcore/milestones/209/labels","id":12021339,"node_id":"MI_kwDOAPaMMs4At25b","number":209,"title":"9.0.2","description":null,"creator":{"login":"maumar","id":1591930,"node_id":"MDQ6VXNlcjE1OTE5MzA=","avatar_url":"https://avatars.githubusercontent.com/u/1591930?v=4","gravatar_id":"","url":"https://api.github.com/users/maumar","html_url":"https://github.com/maumar","followers_url":"https://api.github.com/users/maumar/followers","following_url":"https://api.github.com/users/maumar/following{/other_user}","gists_url":"https://api.github.com/users/maumar/gists{/gist_id}","starred_url":"https://api.github.com/users/maumar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/maumar/subscriptions","organizations_url":"https://api.github.com/users/maumar/orgs","repos_url":"https://api.github.com/users/maumar/repos","events_url":"https://api.github.com/users/maumar/events{/privacy}","received_events_url":"https://api.github.com/users/maumar/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":7,"state":"closed","created_at":"2024-12-10T03:44:52Z","updated_at":"2025-02-05T21:49:43Z","due_on":null,"closed_at":"2025-02-05T21:49:43Z"},"comments":4,"created_at":"2024-12-19T22:22:10Z","updated_at":"2025-01-06T10:30:22Z","closed_at":"2025-01-06T10:30:20Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"draft":false,"repository":{"id":16157746,"node_id":"MDEwOlJlcG9zaXRvcnkxNjE1Nzc0Ng==","name":"efcore","full_name":"dotnet/efcore","private":false,"owner":{"login":"dotnet","id":9141961,"node_id":"MDEyOk9yZ2FuaXphdGlvbjkxNDE5NjE=","avatar_url":"https://avatars.githubusercontent.com/u/9141961?v=4","gravatar_id":"","url":"https://api.github.com/users/dotnet","html_url":"https://github.com/dotnet","followers_url":"https://api.github.com/users/dotnet/followers","following_url":"https://api.github.com/users/dotnet/following{/other_user}","gists_url":"https://api.github.com/users/dotnet/gists{/gist_id}","starred_url":"https://api.github.com/users/dotnet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dotnet/subscriptions","organizations_url":"https://api.github.com/users/dotnet/orgs","repos_url":"https://api.github.com/users/dotnet/repos","events_url":"https://api.github.com/users/dotnet/events{/privacy}","received_events_url":"https://api.github.com/users/dotnet/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/dotnet/efcore","description":"EF Core is a modern object-database mapper for .NET. It supports LINQ queries, change tracking, updates, and schema migrations.","fork":false,"url":"https://api.github.com/repos/dotnet/efcore","forks_url":"https://api.github.com/repos/dotnet/efcore/forks","keys_url":"https://api.github.com/repos/dotnet/efcore/keys{/key_id}","collaborators_url":"https://api.github.com/repos/dotnet/efcore/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/dotnet/efcore/teams","hooks_url":"https://api.github.com/repos/dotnet/efcore/hooks","issue_events_url":"https://api.github.com/repos/dotnet/efcore/issues/events{/number}","events_url":"https://api.github.com/repos/dotnet/efcore/events","assignees_url":"https://api.github.com/repos/dotnet/efcore/assignees{/user}","branches_url":"https://api.github.com/repos/dotnet/efcore/branches{/branch}","tags_url":"https://api.github.com/repos/dotnet/efcore/tags","blobs_url":"https://api.github.com/repos/dotnet/efcore/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/dotnet/efcore/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/dotnet/efcore/git/refs{/sha}","trees_url":"https://api.github.com/repos/dotnet/efcore/git/trees{/sha}","statuses_url":"https://api.github.com/repos/dotnet/efcore/statuses/{sha}","languages_url":"https://api.github.com/repos/dotnet/efcore/languages","stargazers_url":"https://api.github.com/repos/dotnet/efcore/stargazers","contributors_url":"https://api.github.com/repos/dotnet/efcore/contributors","subscribers_url":"https://api.github.com/repos/dotnet/efcore/subscribers","subscription_url":"https://api.github.com/repos/dotnet/efcore/subscription","commits_url":"https://api.github.com/repos/dotnet/efcore/commits{/sha}","git_commits_url":"https://api.github.com/repos/dotnet/efcore/git/commits{/sha}","comments_url":"https://api.github.com/repos/dotnet/efcore/comments{/number}","issue_comment_url":"https://api.github.com/repos/dotnet/efcore/issues/comments{/number}","contents_url":"https://api.github.com/repos/dotnet/efcore/contents/{+path}","compare_url":"https://api.github.com/repos/dotnet/efcore/compare/{base}...{head}","merges_url":"https://api.github.com/repos/dotnet/efcore/merges","archive_url":"https://api.github.com/repos/dotnet/efcore/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/dotnet/efcore/downloads","issues_url":"https://api.github.com/repos/dotnet/efcore/issues{/number}","pulls_url":"https://api.github.com/repos/dotnet/efcore/pulls{/number}","milestones_url":"https://api.github.com/repos/dotnet/efcore/milestones{/number}","notifications_url":"https://api.github.com/repos/dotnet/efcore/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/dotnet/efcore/labels{/name}","releases_url":"https://api.github.com/repos/dotnet/efcore/releases{/id}","deployments_url":"https://api.github.com/repos/dotnet/efcore/deployments","created_at":"2014-01-23T00:52:01Z","updated_at":"2025-11-10T14:21:49Z","pushed_at":"2025-11-10T05:59:58Z","git_url":"git://github.com/dotnet/efcore.git","ssh_url":"git@github.com:dotnet/efcore.git","clone_url":"https://github.com/dotnet/efcore.git","svn_url":"https://github.com/dotnet/efcore","homepage":"https://learn.microsoft.com/ef/","size":215987,"stargazers_count":14455,"watchers_count":14455,"language":"C#","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":3324,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":2430,"license":{"key":"mit","name":"MIT License","spdx_id":"MIT","url":"https://api.github.com/licenses/mit","node_id":"MDc6TGljZW5zZTEz"},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["aspnet-product","c-sharp","database","dotnet-core","dotnet-framework","dotnet-standard","entity-framework","hacktoberfest","orm"],"visibility":"public","forks":3324,"open_issues":2430,"watchers":14455,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/dotnet/efcore/pulls/35360","html_url":"https://github.com/dotnet/efcore/pull/35360","diff_url":"https://github.com/dotnet/efcore/pull/35360.diff","patch_url":"https://github.com/dotnet/efcore/pull/35360.patch","merged_at":"2025-01-06T10:30:20Z"},"body":"Fixes #35239\r\nSafer version of https://github.com/dotnet/efcore/pull/35326\r\n\r\n**Description**\r\n\r\nEF9 introduced a change in how we construct ValueComparers for some of our types (specifically collection of scalars/references), in preparation for AOT work. The way the change was implemented may cause a severe performance regression during SaveChanges operation involving multiple entities using collections of primitives (one of our highly requested features). \r\n\r\n**Customer impact**\r\n\r\nCustomers performing data manipulation operations on entities with collections of primitives may experience significant performance regressions. This may also happen when no data has been changed, but sufficiently large entity graph has been loaded into change tracker. There is no workaround for this issue, apart from changing the model to not use primitive collections (which is unacceptable for majority of customers)\r\n\r\n**How found**\r\n\r\nMultiple customer reports on EF 9\r\n\r\n**Regression**\r\n\r\nYes, from EF8. Note: this is a perf regression only, not a functional regression.\r\n\r\n**Testing**\r\n\r\nAd hoc performance test using BenchmarkDotNet. Functional testing already covered by existing tests.\r\n\r\n**Risk**\r\n\r\nLow. The patch fix has been limited in scope to reduce the risk. Changes should only affect models with primitive collections. Added quirks just to be sure.\r\n\r\n**Perf numbers**\r\n\r\nOver 20x regression between 8 and 9 for the tested scenario. \r\n\r\n8.0.11\r\n\r\n| Method          | Mean     | Error   | StdDev  |\r\n|---------------- |---------:|--------:|--------:|\r\n| SaveChangesTest | 172.1 ms | 1.78 ms | 1.58 ms |\r\n\r\n\r\n9.0\r\n\r\n| Method          | Mean    | Error    | StdDev   |\r\n|---------------- |--------:|---------:|---------:|\r\n| SaveChangesTest | 5.487 s | 0.0621 s | 0.0551 s |\r\n\r\n\r\n9.0.2 (with fix)\r\n\r\n| Method          | Mean     | Error   | StdDev  |\r\n|---------------- |---------:|--------:|--------:|\r\n| SaveChangesTest | 179.8 ms | 1.71 ms | 1.43 ms |\r\n","reactions":{"url":"https://api.github.com/repos/dotnet/efcore/issues/35360/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/dotnet/efcore/issues/35360/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"id":15727160296,"node_id":"REFE_lADOAPaMMs6hQCpUzwAAAAOpaWvo","url":"https://api.github.com/repos/dotnet/efcore/issues/events/15727160296","actor":{"login":"maumar","id":1591930,"node_id":"MDQ6VXNlcjE1OTE5MzA=","avatar_url":"https://avatars.githubusercontent.com/u/1591930?v=4","gravatar_id":"","url":"https://api.github.com/users/maumar","html_url":"https://github.com/maumar","followers_url":"https://api.github.com/users/maumar/followers","following_url":"https://api.github.com/users/maumar/following{/other_user}","gists_url":"https://api.github.com/users/maumar/gists{/gist_id}","starred_url":"https://api.github.com/users/maumar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/maumar/subscriptions","organizations_url":"https://api.github.com/users/maumar/orgs","repos_url":"https://api.github.com/users/maumar/repos","events_url":"https://api.github.com/users/maumar/events{/privacy}","received_events_url":"https://api.github.com/users/maumar/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"f2c36d80ad7ff2e847c6214a2d7d22eaa031f5be","commit_url":"https://api.github.com/repos/dotnet/efcore/commits/f2c36d80ad7ff2e847c6214a2d7d22eaa031f5be","created_at":"2024-12-20T01:54:41Z","performed_via_github_app":null},{"id":15738017711,"node_id":"REFE_lADOAPaMMs6hQCpUzwAAAAOqDxev","url":"https://api.github.com/repos/dotnet/efcore/issues/events/15738017711","actor":{"login":"maumar","id":1591930,"node_id":"MDQ6VXNlcjE1OTE5MzA=","avatar_url":"https://avatars.githubusercontent.com/u/1591930?v=4","gravatar_id":"","url":"https://api.github.com/users/maumar","html_url":"https://github.com/maumar","followers_url":"https://api.github.com/users/maumar/followers","following_url":"https://api.github.com/users/maumar/following{/other_user}","gists_url":"https://api.github.com/users/maumar/gists{/gist_id}","starred_url":"https://api.github.com/users/maumar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/maumar/subscriptions","organizations_url":"https://api.github.com/users/maumar/orgs","repos_url":"https://api.github.com/users/maumar/repos","events_url":"https://api.github.com/users/maumar/events{/privacy}","received_events_url":"https://api.github.com/users/maumar/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"338fd9df49356edd8f6cd8708a6c08482f39a251","commit_url":"https://api.github.com/repos/dotnet/efcore/commits/338fd9df49356edd8f6cd8708a6c08482f39a251","created_at":"2024-12-20T23:17:01Z","performed_via_github_app":null}]