[{"id":9196185243,"node_id":"LE_lADOAPaMMs5lZyYTzwAAAAIkIqab","url":"https://api.github.com/repos/dotnet/efcore/issues/events/9196185243","actor":{"login":"EdwardNickson","id":26862861,"node_id":"MDQ6VXNlcjI2ODYyODYx","avatar_url":"https://avatars.githubusercontent.com/u/26862861?v=4","gravatar_id":"","url":"https://api.github.com/users/EdwardNickson","html_url":"https://github.com/EdwardNickson","followers_url":"https://api.github.com/users/EdwardNickson/followers","following_url":"https://api.github.com/users/EdwardNickson/following{/other_user}","gists_url":"https://api.github.com/users/EdwardNickson/gists{/gist_id}","starred_url":"https://api.github.com/users/EdwardNickson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/EdwardNickson/subscriptions","organizations_url":"https://api.github.com/users/EdwardNickson/orgs","repos_url":"https://api.github.com/users/EdwardNickson/repos","events_url":"https://api.github.com/users/EdwardNickson/events{/privacy}","received_events_url":"https://api.github.com/users/EdwardNickson/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2023-05-09T03:39:01Z","label":{"name":"customer-reported","color":"a4a5f9"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/dotnet/efcore/issues/comments/1541162312","html_url":"https://github.com/dotnet/efcore/issues/30851#issuecomment-1541162312","issue_url":"https://api.github.com/repos/dotnet/efcore/issues/30851","id":1541162312,"node_id":"IC_kwDOAPaMMs5b3EVI","user":{"login":"EdwardNickson","id":26862861,"node_id":"MDQ6VXNlcjI2ODYyODYx","avatar_url":"https://avatars.githubusercontent.com/u/26862861?v=4","gravatar_id":"","url":"https://api.github.com/users/EdwardNickson","html_url":"https://github.com/EdwardNickson","followers_url":"https://api.github.com/users/EdwardNickson/followers","following_url":"https://api.github.com/users/EdwardNickson/following{/other_user}","gists_url":"https://api.github.com/users/EdwardNickson/gists{/gist_id}","starred_url":"https://api.github.com/users/EdwardNickson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/EdwardNickson/subscriptions","organizations_url":"https://api.github.com/users/EdwardNickson/orgs","repos_url":"https://api.github.com/users/EdwardNickson/repos","events_url":"https://api.github.com/users/EdwardNickson/events{/privacy}","received_events_url":"https://api.github.com/users/EdwardNickson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-10T01:35:54Z","updated_at":"2023-05-10T01:41:50Z","body":"I can also trigger this with one reader and one writer.\r\nChanging the loop above to this:\r\n```\r\nfor (int i = 0; i < 5000; i++)\r\n{\r\n    var taskOne = Task.Run(() =>\r\n    {\r\n        var logEvent = new LogEvent(){ Message = \"Log Message\" };\r\n        contextOne.LogEvents.Add(logEvent);\r\n        contextOne.SaveChanges();\r\n        return logEvent.Id;\r\n    });\r\n    var taskTwo = Task.Run(() =>\r\n    {\r\n        var a = contextTwo.LogEvents.ToList();\r\n    });\r\n    await taskOne;\r\n    await taskTwo;\r\n}\r\n```\r\neventually yields this exception:\r\n```\r\nUnhandled exception. Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.\r\n ---> System.InvalidOperationException: The instance of entity type 'LogEvent' cannot be tracked because another instance with the same key value for {'Id'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.\r\n   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)\r\n   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)\r\n   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NavigationFixer.KeyPropertyChanged(InternalEntityEntry entry, IProperty property, IEnumerable`1 containingPrincipalKeys, IEnumerable`1 containingForeignKeys, Object oldValue, Object newValue)\r\n   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.DetectKeyChange(InternalEntityEntry entry, IProperty property)\r\n   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.ChangeDetector.PropertyChanged(InternalEntityEntry entry, IPropertyBase propertyBase, Boolean setModified)\r\n   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetProperty(IPropertyBase propertyBase, Object value, Boolean isMaterialization, Boolean setModified, Boolean isCascadeDelete, CurrentValueType valueType)\r\n   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetStoreGeneratedValue(IProperty property, Object value, Boolean setModified)\r\n   at Microsoft.EntityFrameworkCore.Update.ColumnModification.set_Value(Object value)\r\n   at Microsoft.EntityFrameworkCore.Update.ModificationCommand.PropagateResults(RelationalDataReader relationalReader)\r\n   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSet(Int32 startCommandIndex, RelationalDataReader reader)\r\n   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.Consume(RelationalDataReader reader)\r\n   --- End of inner exception stack trace ---\r\n   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.Consume(RelationalDataReader reader)\r\n   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)\r\n   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.Execute(IEnumerable`1 commandBatches, IRelationalConnection connection)\r\n   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(IList`1 entriesToSave)\r\n   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(StateManager stateManager, Boolean acceptAllChangesOnSuccess)\r\n   at Microsoft.EntityFrameworkCore.DbContext.SaveChanges(Boolean acceptAllChangesOnSuccess)\r\n   at collisionTest.Program.<>c__DisplayClass0_0.<Main>b__0() in /work/code/packager/dbtest/Program.cs:line 52\r\n   at System.Threading.Tasks.Task`1.InnerInvoke()\r\n   at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)\r\n--- End of stack trace from previous location ---\r\n   at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)\r\n   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)\r\n--- End of stack trace from previous location ---\r\n   at collisionTest.Program.Main(String[] _) in /code/dbtest/Program.cs:line 59\r\n   at collisionTest.Program.<Main>(String[] _)\r\n```\r\n\r\nIn this case the exception happens because of this chain of events:\r\n1. Insert LogEvent 1 into the database, DB returns ID 1. EF Core starts tracking ID 1.\r\n2. Insert LogEvent 2 into the database, DB returns ID 2. EF Core starts tracking ID 2.\r\n3. Bug occurs and LogEvent 2 doesn’t actually get committed to the DB. DB sequence for LogEvent table doesn’t get incremented to 2.\r\n4. Insert LogEvent 3 into the database, DB returns ID 2. EF Core tries to track ID 2. It’s already tracked in step 2 so we get the exception.\r\n","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/dotnet/efcore/issues/comments/1541162312/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"EdwardNickson","id":26862861,"node_id":"MDQ6VXNlcjI2ODYyODYx","avatar_url":"https://avatars.githubusercontent.com/u/26862861?v=4","gravatar_id":"","url":"https://api.github.com/users/EdwardNickson","html_url":"https://github.com/EdwardNickson","followers_url":"https://api.github.com/users/EdwardNickson/followers","following_url":"https://api.github.com/users/EdwardNickson/following{/other_user}","gists_url":"https://api.github.com/users/EdwardNickson/gists{/gist_id}","starred_url":"https://api.github.com/users/EdwardNickson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/EdwardNickson/subscriptions","organizations_url":"https://api.github.com/users/EdwardNickson/orgs","repos_url":"https://api.github.com/users/EdwardNickson/repos","events_url":"https://api.github.com/users/EdwardNickson/events{/privacy}","received_events_url":"https://api.github.com/users/EdwardNickson/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/dotnet/efcore/issues/comments/1542746664","html_url":"https://github.com/dotnet/efcore/issues/30851#issuecomment-1542746664","issue_url":"https://api.github.com/repos/dotnet/efcore/issues/30851","id":1542746664,"node_id":"IC_kwDOAPaMMs5b9HIo","user":{"login":"AndriySvyryd","id":6539701,"node_id":"MDQ6VXNlcjY1Mzk3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6539701?v=4","gravatar_id":"","url":"https://api.github.com/users/AndriySvyryd","html_url":"https://github.com/AndriySvyryd","followers_url":"https://api.github.com/users/AndriySvyryd/followers","following_url":"https://api.github.com/users/AndriySvyryd/following{/other_user}","gists_url":"https://api.github.com/users/AndriySvyryd/gists{/gist_id}","starred_url":"https://api.github.com/users/AndriySvyryd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AndriySvyryd/subscriptions","organizations_url":"https://api.github.com/users/AndriySvyryd/orgs","repos_url":"https://api.github.com/users/AndriySvyryd/repos","events_url":"https://api.github.com/users/AndriySvyryd/events{/privacy}","received_events_url":"https://api.github.com/users/AndriySvyryd/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-10T20:11:05Z","updated_at":"2023-05-10T20:11:05Z","body":"cc @bricelam ","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/dotnet/efcore/issues/comments/1542746664/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"AndriySvyryd","id":6539701,"node_id":"MDQ6VXNlcjY1Mzk3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6539701?v=4","gravatar_id":"","url":"https://api.github.com/users/AndriySvyryd","html_url":"https://github.com/AndriySvyryd","followers_url":"https://api.github.com/users/AndriySvyryd/followers","following_url":"https://api.github.com/users/AndriySvyryd/following{/other_user}","gists_url":"https://api.github.com/users/AndriySvyryd/gists{/gist_id}","starred_url":"https://api.github.com/users/AndriySvyryd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AndriySvyryd/subscriptions","organizations_url":"https://api.github.com/users/AndriySvyryd/orgs","repos_url":"https://api.github.com/users/AndriySvyryd/repos","events_url":"https://api.github.com/users/AndriySvyryd/events{/privacy}","received_events_url":"https://api.github.com/users/AndriySvyryd/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":9215197267,"node_id":"MEE_lADOAPaMMs5lZyYTzwAAAAIlRMBT","url":"https://api.github.com/repos/dotnet/efcore/issues/events/9215197267","actor":{"login":"bricelam","id":1226749,"node_id":"MDQ6VXNlcjEyMjY3NDk=","avatar_url":"https://avatars.githubusercontent.com/u/1226749?v=4","gravatar_id":"","url":"https://api.github.com/users/bricelam","html_url":"https://github.com/bricelam","followers_url":"https://api.github.com/users/bricelam/followers","following_url":"https://api.github.com/users/bricelam/following{/other_user}","gists_url":"https://api.github.com/users/bricelam/gists{/gist_id}","starred_url":"https://api.github.com/users/bricelam/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bricelam/subscriptions","organizations_url":"https://api.github.com/users/bricelam/orgs","repos_url":"https://api.github.com/users/bricelam/repos","events_url":"https://api.github.com/users/bricelam/events{/privacy}","received_events_url":"https://api.github.com/users/bricelam/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2023-05-10T20:11:05Z","performed_via_github_app":null},{"id":9215197289,"node_id":"SE_lADOAPaMMs5lZyYTzwAAAAIlRMBp","url":"https://api.github.com/repos/dotnet/efcore/issues/events/9215197289","actor":{"login":"bricelam","id":1226749,"node_id":"MDQ6VXNlcjEyMjY3NDk=","avatar_url":"https://avatars.githubusercontent.com/u/1226749?v=4","gravatar_id":"","url":"https://api.github.com/users/bricelam","html_url":"https://github.com/bricelam","followers_url":"https://api.github.com/users/bricelam/followers","following_url":"https://api.github.com/users/bricelam/following{/other_user}","gists_url":"https://api.github.com/users/bricelam/gists{/gist_id}","starred_url":"https://api.github.com/users/bricelam/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bricelam/subscriptions","organizations_url":"https://api.github.com/users/bricelam/orgs","repos_url":"https://api.github.com/users/bricelam/repos","events_url":"https://api.github.com/users/bricelam/events{/privacy}","received_events_url":"https://api.github.com/users/bricelam/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2023-05-10T20:11:05Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/dotnet/efcore/issues/comments/1542812558","html_url":"https://github.com/dotnet/efcore/issues/30851#issuecomment-1542812558","issue_url":"https://api.github.com/repos/dotnet/efcore/issues/30851","id":1542812558,"node_id":"IC_kwDOAPaMMs5b9XOO","user":{"login":"bricelam","id":1226749,"node_id":"MDQ6VXNlcjEyMjY3NDk=","avatar_url":"https://avatars.githubusercontent.com/u/1226749?v=4","gravatar_id":"","url":"https://api.github.com/users/bricelam","html_url":"https://github.com/bricelam","followers_url":"https://api.github.com/users/bricelam/followers","following_url":"https://api.github.com/users/bricelam/following{/other_user}","gists_url":"https://api.github.com/users/bricelam/gists{/gist_id}","starred_url":"https://api.github.com/users/bricelam/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bricelam/subscriptions","organizations_url":"https://api.github.com/users/bricelam/orgs","repos_url":"https://api.github.com/users/bricelam/repos","events_url":"https://api.github.com/users/bricelam/events{/privacy}","received_events_url":"https://api.github.com/users/bricelam/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-10T21:08:39Z","updated_at":"2023-05-10T21:08:39Z","body":"This looks like an issue with SQLite itself. I'd follow up with them.\r\n\r\n> We have found that adding\r\nReplaceService<IUpdateSqlGenerator, SqliteLegacyUpdateSqlGenerator>() to our options builder resolves this issue\r\n\r\nThis causes EF to use both an INSERT and SELECT statement...\r\n\r\n```sql\r\nINSERT INTO \"Table0\" (\"Column0\", \"Column1\")\r\nVALUES (@p0, @p1);\r\n\r\nSELECT \"Id\"\r\nFROM \"Table0\"\r\nWHERE changes() = 1 AND \"rowid\" = last_insert_rowid();\r\n```\r\n\r\n...instead of an INSERT statement with a RETURNING clause.\r\n\r\n```sql\r\nINSERT INTO \"Table0\" (\"Column0\", \"Column1\")\r\nVALUES (@p0, @p1)\r\nRETURNING \"Id\";\r\n```\r\n\r\nWhich leads me to believe that the issue probably has something to do with a race condition in SQLite's handling of the RETURNING clause.","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/dotnet/efcore/issues/comments/1542812558/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"bricelam","id":1226749,"node_id":"MDQ6VXNlcjEyMjY3NDk=","avatar_url":"https://avatars.githubusercontent.com/u/1226749?v=4","gravatar_id":"","url":"https://api.github.com/users/bricelam","html_url":"https://github.com/bricelam","followers_url":"https://api.github.com/users/bricelam/followers","following_url":"https://api.github.com/users/bricelam/following{/other_user}","gists_url":"https://api.github.com/users/bricelam/gists{/gist_id}","starred_url":"https://api.github.com/users/bricelam/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bricelam/subscriptions","organizations_url":"https://api.github.com/users/bricelam/orgs","repos_url":"https://api.github.com/users/bricelam/repos","events_url":"https://api.github.com/users/bricelam/events{/privacy}","received_events_url":"https://api.github.com/users/bricelam/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/dotnet/efcore/issues/comments/1542818457","html_url":"https://github.com/dotnet/efcore/issues/30851#issuecomment-1542818457","issue_url":"https://api.github.com/repos/dotnet/efcore/issues/30851","id":1542818457,"node_id":"IC_kwDOAPaMMs5b9YqZ","user":{"login":"bricelam","id":1226749,"node_id":"MDQ6VXNlcjEyMjY3NDk=","avatar_url":"https://avatars.githubusercontent.com/u/1226749?v=4","gravatar_id":"","url":"https://api.github.com/users/bricelam","html_url":"https://github.com/bricelam","followers_url":"https://api.github.com/users/bricelam/followers","following_url":"https://api.github.com/users/bricelam/following{/other_user}","gists_url":"https://api.github.com/users/bricelam/gists{/gist_id}","starred_url":"https://api.github.com/users/bricelam/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bricelam/subscriptions","organizations_url":"https://api.github.com/users/bricelam/orgs","repos_url":"https://api.github.com/users/bricelam/repos","events_url":"https://api.github.com/users/bricelam/events{/privacy}","received_events_url":"https://api.github.com/users/bricelam/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-10T21:14:45Z","updated_at":"2023-05-10T21:15:06Z","body":"I wonder if the AUTOINCREMENT feature is also playing into this--we know that RETURNING doesn't play well with triggers, and autoincrement has many of the same characteristics as a trigger.","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/dotnet/efcore/issues/comments/1542818457/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"bricelam","id":1226749,"node_id":"MDQ6VXNlcjEyMjY3NDk=","avatar_url":"https://avatars.githubusercontent.com/u/1226749?v=4","gravatar_id":"","url":"https://api.github.com/users/bricelam","html_url":"https://github.com/bricelam","followers_url":"https://api.github.com/users/bricelam/followers","following_url":"https://api.github.com/users/bricelam/following{/other_user}","gists_url":"https://api.github.com/users/bricelam/gists{/gist_id}","starred_url":"https://api.github.com/users/bricelam/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bricelam/subscriptions","organizations_url":"https://api.github.com/users/bricelam/orgs","repos_url":"https://api.github.com/users/bricelam/repos","events_url":"https://api.github.com/users/bricelam/events{/privacy}","received_events_url":"https://api.github.com/users/bricelam/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/dotnet/efcore/issues/comments/1543599170","html_url":"https://github.com/dotnet/efcore/issues/30851#issuecomment-1543599170","issue_url":"https://api.github.com/repos/dotnet/efcore/issues/30851","id":1543599170,"node_id":"IC_kwDOAPaMMs5cAXRC","user":{"login":"ajcvickers","id":1430078,"node_id":"MDQ6VXNlcjE0MzAwNzg=","avatar_url":"https://avatars.githubusercontent.com/u/1430078?v=4","gravatar_id":"","url":"https://api.github.com/users/ajcvickers","html_url":"https://github.com/ajcvickers","followers_url":"https://api.github.com/users/ajcvickers/followers","following_url":"https://api.github.com/users/ajcvickers/following{/other_user}","gists_url":"https://api.github.com/users/ajcvickers/gists{/gist_id}","starred_url":"https://api.github.com/users/ajcvickers/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajcvickers/subscriptions","organizations_url":"https://api.github.com/users/ajcvickers/orgs","repos_url":"https://api.github.com/users/ajcvickers/repos","events_url":"https://api.github.com/users/ajcvickers/events{/privacy}","received_events_url":"https://api.github.com/users/ajcvickers/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-11T08:51:27Z","updated_at":"2023-05-11T08:51:27Z","body":"In addition to changing the generated SQL, `SqliteLegacyUpdateSqlGenerator` also reverts to explicitly using a transaction again. Based on this, I tried leaving the SQL the same, but using an explicit transaction:\r\n\r\n```C#\r\nusing (var transaction = contextOne.Database.BeginTransaction())\r\n{\r\n    contextOne.SaveChanges();\r\n    transaction.Commit();\r\n}\r\n```\r\n\r\nThe bug no longer repros with this code. I wonder if SQLite needs an explicit transaction for this to be safe, despite it being a \"single statement\"? @roji?","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/dotnet/efcore/issues/comments/1543599170/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"ajcvickers","id":1430078,"node_id":"MDQ6VXNlcjE0MzAwNzg=","avatar_url":"https://avatars.githubusercontent.com/u/1430078?v=4","gravatar_id":"","url":"https://api.github.com/users/ajcvickers","html_url":"https://github.com/ajcvickers","followers_url":"https://api.github.com/users/ajcvickers/followers","following_url":"https://api.github.com/users/ajcvickers/following{/other_user}","gists_url":"https://api.github.com/users/ajcvickers/gists{/gist_id}","starred_url":"https://api.github.com/users/ajcvickers/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajcvickers/subscriptions","organizations_url":"https://api.github.com/users/ajcvickers/orgs","repos_url":"https://api.github.com/users/ajcvickers/repos","events_url":"https://api.github.com/users/ajcvickers/events{/privacy}","received_events_url":"https://api.github.com/users/ajcvickers/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":9219720157,"node_id":"MEE_lADOAPaMMs5lZyYTzwAAAAIlicPd","url":"https://api.github.com/repos/dotnet/efcore/issues/events/9219720157","actor":{"login":"roji","id":1862641,"node_id":"MDQ6VXNlcjE4NjI2NDE=","avatar_url":"https://avatars.githubusercontent.com/u/1862641?v=4","gravatar_id":"","url":"https://api.github.com/users/roji","html_url":"https://github.com/roji","followers_url":"https://api.github.com/users/roji/followers","following_url":"https://api.github.com/users/roji/following{/other_user}","gists_url":"https://api.github.com/users/roji/gists{/gist_id}","starred_url":"https://api.github.com/users/roji/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roji/subscriptions","organizations_url":"https://api.github.com/users/roji/orgs","repos_url":"https://api.github.com/users/roji/repos","events_url":"https://api.github.com/users/roji/events{/privacy}","received_events_url":"https://api.github.com/users/roji/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2023-05-11T08:51:27Z","performed_via_github_app":null},{"id":9219720173,"node_id":"SE_lADOAPaMMs5lZyYTzwAAAAIlicPt","url":"https://api.github.com/repos/dotnet/efcore/issues/events/9219720173","actor":{"login":"roji","id":1862641,"node_id":"MDQ6VXNlcjE4NjI2NDE=","avatar_url":"https://avatars.githubusercontent.com/u/1862641?v=4","gravatar_id":"","url":"https://api.github.com/users/roji","html_url":"https://github.com/roji","followers_url":"https://api.github.com/users/roji/followers","following_url":"https://api.github.com/users/roji/following{/other_user}","gists_url":"https://api.github.com/users/roji/gists{/gist_id}","starred_url":"https://api.github.com/users/roji/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roji/subscriptions","organizations_url":"https://api.github.com/users/roji/orgs","repos_url":"https://api.github.com/users/roji/repos","events_url":"https://api.github.com/users/roji/events{/privacy}","received_events_url":"https://api.github.com/users/roji/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2023-05-11T08:51:27Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/dotnet/efcore/issues/comments/1543673323","html_url":"https://github.com/dotnet/efcore/issues/30851#issuecomment-1543673323","issue_url":"https://api.github.com/repos/dotnet/efcore/issues/30851","id":1543673323,"node_id":"IC_kwDOAPaMMs5cApXr","user":{"login":"roji","id":1862641,"node_id":"MDQ6VXNlcjE4NjI2NDE=","avatar_url":"https://avatars.githubusercontent.com/u/1862641?v=4","gravatar_id":"","url":"https://api.github.com/users/roji","html_url":"https://github.com/roji","followers_url":"https://api.github.com/users/roji/followers","following_url":"https://api.github.com/users/roji/following{/other_user}","gists_url":"https://api.github.com/users/roji/gists{/gist_id}","starred_url":"https://api.github.com/users/roji/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roji/subscriptions","organizations_url":"https://api.github.com/users/roji/orgs","repos_url":"https://api.github.com/users/roji/repos","events_url":"https://api.github.com/users/roji/events{/privacy}","received_events_url":"https://api.github.com/users/roji/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-11T09:39:17Z","updated_at":"2023-05-12T08:45:25Z","body":"Ouch :/ Is this something we can also reproduce without EF, i.e. directly with Microsoft.Data.Sqlite (just to get an even more self-contained repro)? If so, I'd definitely try reporting this to the SQlite maintainers to see what they say... If it's really needed, we can see about always having the transaction there based on the provider - but this seems like it would be a pretty serious bug...","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/dotnet/efcore/issues/comments/1543673323/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"roji","id":1862641,"node_id":"MDQ6VXNlcjE4NjI2NDE=","avatar_url":"https://avatars.githubusercontent.com/u/1862641?v=4","gravatar_id":"","url":"https://api.github.com/users/roji","html_url":"https://github.com/roji","followers_url":"https://api.github.com/users/roji/followers","following_url":"https://api.github.com/users/roji/following{/other_user}","gists_url":"https://api.github.com/users/roji/gists{/gist_id}","starred_url":"https://api.github.com/users/roji/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roji/subscriptions","organizations_url":"https://api.github.com/users/roji/orgs","repos_url":"https://api.github.com/users/roji/repos","events_url":"https://api.github.com/users/roji/events{/privacy}","received_events_url":"https://api.github.com/users/roji/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/dotnet/efcore/issues/comments/1545249239","html_url":"https://github.com/dotnet/efcore/issues/30851#issuecomment-1545249239","issue_url":"https://api.github.com/repos/dotnet/efcore/issues/30851","id":1545249239,"node_id":"IC_kwDOAPaMMs5cGqHX","user":{"login":"EdwardNickson","id":26862861,"node_id":"MDQ6VXNlcjI2ODYyODYx","avatar_url":"https://avatars.githubusercontent.com/u/26862861?v=4","gravatar_id":"","url":"https://api.github.com/users/EdwardNickson","html_url":"https://github.com/EdwardNickson","followers_url":"https://api.github.com/users/EdwardNickson/followers","following_url":"https://api.github.com/users/EdwardNickson/following{/other_user}","gists_url":"https://api.github.com/users/EdwardNickson/gists{/gist_id}","starred_url":"https://api.github.com/users/EdwardNickson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/EdwardNickson/subscriptions","organizations_url":"https://api.github.com/users/EdwardNickson/orgs","repos_url":"https://api.github.com/users/EdwardNickson/repos","events_url":"https://api.github.com/users/EdwardNickson/events{/privacy}","received_events_url":"https://api.github.com/users/EdwardNickson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-12T06:39:08Z","updated_at":"2023-05-12T06:39:08Z","body":"I'l create a bug report. I can repro with Microsoft.Data.Sqlite & System.Data.SQLite.\r\nThe code below doesn't use AUTOINCREMENT, it's just inserting the same data over and over but we still get the bug, so it's the RETURNING which is causing this.\r\n\r\n```C#\r\nusing System.Diagnostics;\r\nusing Microsoft.Data.Sqlite;\r\n\r\nnamespace collisionTest;\r\n\r\npublic class Program\r\n{\r\n    public static string CreateDB()\r\n    {\r\n        string filePath = Path.GetTempFileName();\r\n        var connectionString = $\"Data Source={filePath}\";\r\n        using (var connection = new SqliteConnection(connectionString))\r\n        {\r\n            connection.Open();\r\n            using var command = connection.CreateCommand();\r\n            command.CommandText = @\"\r\n                CREATE TABLE IF NOT EXISTS 'LogEvents' (\r\n                    'Id' INTEGER NOT NULL,\r\n                    'Message' TEXT NOT NULL\r\n                );\r\n                PRAGMA journal_mode=DELETE;\r\n            \";\r\n            command.ExecuteNonQuery();\r\n        }\r\n        return connectionString;\r\n    }\r\n\r\n    public static long CountRecords(string connectionString)\r\n    {\r\n        using var connection = new SqliteConnection(connectionString);\r\n        connection.Open();\r\n        using var command = connection.CreateCommand();\r\n        command.CommandText = \"Select count(*) from 'LogEvents';\";\r\n        return (long) command.ExecuteScalar()!;\r\n    }\r\n\r\n    static async Task Main(string[] _)\r\n    {\r\n        var connectionString = CreateDB();\r\n\r\n        string notReturning = @$\"\r\n            INSERT INTO 'LogEvents' ('ID', 'Message')\r\n            VALUES (1, 'test message');\r\n        \";\r\n        string returning = @$\"\r\n            INSERT INTO 'LogEvents' ('ID', 'Message')\r\n            VALUES (1, 'test message')\r\n            returning ID;\r\n        \";\r\n        foreach (var statement in new string[]{notReturning, returning})\r\n        {\r\n            var startingCount = CountRecords(connectionString);\r\n            int inserts = 5000;\r\n            var stopWatch = Stopwatch.StartNew();\r\n            for (int i = 0; i < inserts; i++)\r\n            {\r\n                var taskOne = Task.Run(() =>\r\n                {\r\n                    using var connection = new SqliteConnection(connectionString);\r\n                    connection.Open();\r\n                    using var command = connection.CreateCommand();\r\n                    command.CommandText = statement;\r\n                    command.ExecuteScalar();\r\n                });\r\n                var taskTwo = Task.Run(() =>\r\n                {\r\n                    CountRecords(connectionString);\r\n                });\r\n                await taskOne;\r\n                await taskTwo;\r\n            }\r\n            stopWatch.Stop();\r\n            var finalCount = CountRecords(connectionString);\r\n            Debug.WriteLine($\"SQL Statement: {statement}\");\r\n            Debug.WriteLine($\"{inserts} Inserts\");\r\n            Debug.WriteLine($\"{finalCount - startingCount} Records Created\");\r\n            Debug.WriteLine($\"Time Taken: {stopWatch.ElapsedMilliseconds}\");\r\n        }\r\n    }\r\n}\r\n```\r\n\r\nThe output of this is:\r\n```\r\nSQL Statement: \r\n            INSERT INTO 'LogEvents' ('ID', 'Message')\r\n            VALUES (1, 'test message');\r\n5000 Inserts\r\n5000 Records Created\r\nTime Taken: 2064\r\n\r\nSQL Statement: \r\n            INSERT INTO 'LogEvents' ('ID', 'Message')\r\n            VALUES (1, 'test message')\r\n            returning ID;\r\n5000 Inserts\r\n4901 Records Created\r\nTime Taken: 714\r\n```\r\n\r\nInterestingly the statement with the RETURNING is significantly faster than the one without, which seems wrong given it has to do more.","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/dotnet/efcore/issues/comments/1545249239/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"EdwardNickson","id":26862861,"node_id":"MDQ6VXNlcjI2ODYyODYx","avatar_url":"https://avatars.githubusercontent.com/u/26862861?v=4","gravatar_id":"","url":"https://api.github.com/users/EdwardNickson","html_url":"https://github.com/EdwardNickson","followers_url":"https://api.github.com/users/EdwardNickson/followers","following_url":"https://api.github.com/users/EdwardNickson/following{/other_user}","gists_url":"https://api.github.com/users/EdwardNickson/gists{/gist_id}","starred_url":"https://api.github.com/users/EdwardNickson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/EdwardNickson/subscriptions","organizations_url":"https://api.github.com/users/EdwardNickson/orgs","repos_url":"https://api.github.com/users/EdwardNickson/repos","events_url":"https://api.github.com/users/EdwardNickson/events{/privacy}","received_events_url":"https://api.github.com/users/EdwardNickson/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/dotnet/efcore/issues/comments/1545385879","html_url":"https://github.com/dotnet/efcore/issues/30851#issuecomment-1545385879","issue_url":"https://api.github.com/repos/dotnet/efcore/issues/30851","id":1545385879,"node_id":"IC_kwDOAPaMMs5cHLeX","user":{"login":"EdwardNickson","id":26862861,"node_id":"MDQ6VXNlcjI2ODYyODYx","avatar_url":"https://avatars.githubusercontent.com/u/26862861?v=4","gravatar_id":"","url":"https://api.github.com/users/EdwardNickson","html_url":"https://github.com/EdwardNickson","followers_url":"https://api.github.com/users/EdwardNickson/followers","following_url":"https://api.github.com/users/EdwardNickson/following{/other_user}","gists_url":"https://api.github.com/users/EdwardNickson/gists{/gist_id}","starred_url":"https://api.github.com/users/EdwardNickson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/EdwardNickson/subscriptions","organizations_url":"https://api.github.com/users/EdwardNickson/orgs","repos_url":"https://api.github.com/users/EdwardNickson/repos","events_url":"https://api.github.com/users/EdwardNickson/events{/privacy}","received_events_url":"https://api.github.com/users/EdwardNickson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-12T08:37:15Z","updated_at":"2023-05-12T08:37:15Z","body":"Bug report in sqlite forum - https://sqlite.org/forum/forumpost/44aaf065a3","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/dotnet/efcore/issues/comments/1545385879/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":1,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"EdwardNickson","id":26862861,"node_id":"MDQ6VXNlcjI2ODYyODYx","avatar_url":"https://avatars.githubusercontent.com/u/26862861?v=4","gravatar_id":"","url":"https://api.github.com/users/EdwardNickson","html_url":"https://github.com/EdwardNickson","followers_url":"https://api.github.com/users/EdwardNickson/followers","following_url":"https://api.github.com/users/EdwardNickson/following{/other_user}","gists_url":"https://api.github.com/users/EdwardNickson/gists{/gist_id}","starred_url":"https://api.github.com/users/EdwardNickson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/EdwardNickson/subscriptions","organizations_url":"https://api.github.com/users/EdwardNickson/orgs","repos_url":"https://api.github.com/users/EdwardNickson/repos","events_url":"https://api.github.com/users/EdwardNickson/events{/privacy}","received_events_url":"https://api.github.com/users/EdwardNickson/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/dotnet/efcore/issues/comments/1547260917","html_url":"https://github.com/dotnet/efcore/issues/30851#issuecomment-1547260917","issue_url":"https://api.github.com/repos/dotnet/efcore/issues/30851","id":1547260917,"node_id":"IC_kwDOAPaMMs5cOVP1","user":{"login":"EdwardNickson","id":26862861,"node_id":"MDQ6VXNlcjI2ODYyODYx","avatar_url":"https://avatars.githubusercontent.com/u/26862861?v=4","gravatar_id":"","url":"https://api.github.com/users/EdwardNickson","html_url":"https://github.com/EdwardNickson","followers_url":"https://api.github.com/users/EdwardNickson/followers","following_url":"https://api.github.com/users/EdwardNickson/following{/other_user}","gists_url":"https://api.github.com/users/EdwardNickson/gists{/gist_id}","starred_url":"https://api.github.com/users/EdwardNickson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/EdwardNickson/subscriptions","organizations_url":"https://api.github.com/users/EdwardNickson/orgs","repos_url":"https://api.github.com/users/EdwardNickson/repos","events_url":"https://api.github.com/users/EdwardNickson/events{/privacy}","received_events_url":"https://api.github.com/users/EdwardNickson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-15T06:29:36Z","updated_at":"2023-05-15T06:29:36Z","body":"The SQLite team don't think this is an issue with the core SQLite Lib and are viewing this as a bug in System.Data.SQLite. See details in forum post linked above. Assuming that's true then this bug will also need to be fixed in Microsoft.Data.Sqlite.","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/dotnet/efcore/issues/comments/1547260917/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"EdwardNickson","id":26862861,"node_id":"MDQ6VXNlcjI2ODYyODYx","avatar_url":"https://avatars.githubusercontent.com/u/26862861?v=4","gravatar_id":"","url":"https://api.github.com/users/EdwardNickson","html_url":"https://github.com/EdwardNickson","followers_url":"https://api.github.com/users/EdwardNickson/followers","following_url":"https://api.github.com/users/EdwardNickson/following{/other_user}","gists_url":"https://api.github.com/users/EdwardNickson/gists{/gist_id}","starred_url":"https://api.github.com/users/EdwardNickson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/EdwardNickson/subscriptions","organizations_url":"https://api.github.com/users/EdwardNickson/orgs","repos_url":"https://api.github.com/users/EdwardNickson/repos","events_url":"https://api.github.com/users/EdwardNickson/events{/privacy}","received_events_url":"https://api.github.com/users/EdwardNickson/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/dotnet/efcore/issues/comments/1548475092","html_url":"https://github.com/dotnet/efcore/issues/30851#issuecomment-1548475092","issue_url":"https://api.github.com/repos/dotnet/efcore/issues/30851","id":1548475092,"node_id":"IC_kwDOAPaMMs5cS9rU","user":{"login":"bricelam","id":1226749,"node_id":"MDQ6VXNlcjEyMjY3NDk=","avatar_url":"https://avatars.githubusercontent.com/u/1226749?v=4","gravatar_id":"","url":"https://api.github.com/users/bricelam","html_url":"https://github.com/bricelam","followers_url":"https://api.github.com/users/bricelam/followers","following_url":"https://api.github.com/users/bricelam/following{/other_user}","gists_url":"https://api.github.com/users/bricelam/gists{/gist_id}","starred_url":"https://api.github.com/users/bricelam/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bricelam/subscriptions","organizations_url":"https://api.github.com/users/bricelam/orgs","repos_url":"https://api.github.com/users/bricelam/repos","events_url":"https://api.github.com/users/bricelam/events{/privacy}","received_events_url":"https://api.github.com/users/bricelam/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-15T19:46:41Z","updated_at":"2023-05-15T19:46:41Z","body":"Ah yes, I think we also assume that we can stop stepping after a statement returns results.","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/dotnet/efcore/issues/comments/1548475092/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"bricelam","id":1226749,"node_id":"MDQ6VXNlcjEyMjY3NDk=","avatar_url":"https://avatars.githubusercontent.com/u/1226749?v=4","gravatar_id":"","url":"https://api.github.com/users/bricelam","html_url":"https://github.com/bricelam","followers_url":"https://api.github.com/users/bricelam/followers","following_url":"https://api.github.com/users/bricelam/following{/other_user}","gists_url":"https://api.github.com/users/bricelam/gists{/gist_id}","starred_url":"https://api.github.com/users/bricelam/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bricelam/subscriptions","organizations_url":"https://api.github.com/users/bricelam/orgs","repos_url":"https://api.github.com/users/bricelam/repos","events_url":"https://api.github.com/users/bricelam/events{/privacy}","received_events_url":"https://api.github.com/users/bricelam/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":9250450046,"node_id":"LE_lADOAPaMMs5lZyYTzwAAAAInXqp-","url":"https://api.github.com/repos/dotnet/efcore/issues/events/9250450046","actor":{"login":"bricelam","id":1226749,"node_id":"MDQ6VXNlcjEyMjY3NDk=","avatar_url":"https://avatars.githubusercontent.com/u/1226749?v=4","gravatar_id":"","url":"https://api.github.com/users/bricelam","html_url":"https://github.com/bricelam","followers_url":"https://api.github.com/users/bricelam/followers","following_url":"https://api.github.com/users/bricelam/following{/other_user}","gists_url":"https://api.github.com/users/bricelam/gists{/gist_id}","starred_url":"https://api.github.com/users/bricelam/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bricelam/subscriptions","organizations_url":"https://api.github.com/users/bricelam/orgs","repos_url":"https://api.github.com/users/bricelam/repos","events_url":"https://api.github.com/users/bricelam/events{/privacy}","received_events_url":"https://api.github.com/users/bricelam/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2023-05-15T19:46:55Z","label":{"name":"type-bug","color":"f7c6c7"},"performed_via_github_app":null},{"id":9250450053,"node_id":"LE_lADOAPaMMs5lZyYTzwAAAAInXqqF","url":"https://api.github.com/repos/dotnet/efcore/issues/events/9250450053","actor":{"login":"bricelam","id":1226749,"node_id":"MDQ6VXNlcjEyMjY3NDk=","avatar_url":"https://avatars.githubusercontent.com/u/1226749?v=4","gravatar_id":"","url":"https://api.github.com/users/bricelam","html_url":"https://github.com/bricelam","followers_url":"https://api.github.com/users/bricelam/followers","following_url":"https://api.github.com/users/bricelam/following{/other_user}","gists_url":"https://api.github.com/users/bricelam/gists{/gist_id}","starred_url":"https://api.github.com/users/bricelam/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bricelam/subscriptions","organizations_url":"https://api.github.com/users/bricelam/orgs","repos_url":"https://api.github.com/users/bricelam/repos","events_url":"https://api.github.com/users/bricelam/events{/privacy}","received_events_url":"https://api.github.com/users/bricelam/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2023-05-15T19:46:55Z","label":{"name":"area-adonet-sqlite","color":"044a64"},"performed_via_github_app":null},{"id":9250450321,"node_id":"AE_lADOAPaMMs5lZyYTzwAAAAInXquR","url":"https://api.github.com/repos/dotnet/efcore/issues/events/9250450321","actor":{"login":"bricelam","id":1226749,"node_id":"MDQ6VXNlcjEyMjY3NDk=","avatar_url":"https://avatars.githubusercontent.com/u/1226749?v=4","gravatar_id":"","url":"https://api.github.com/users/bricelam","html_url":"https://github.com/bricelam","followers_url":"https://api.github.com/users/bricelam/followers","following_url":"https://api.github.com/users/bricelam/following{/other_user}","gists_url":"https://api.github.com/users/bricelam/gists{/gist_id}","starred_url":"https://api.github.com/users/bricelam/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bricelam/subscriptions","organizations_url":"https://api.github.com/users/bricelam/orgs","repos_url":"https://api.github.com/users/bricelam/repos","events_url":"https://api.github.com/users/bricelam/events{/privacy}","received_events_url":"https://api.github.com/users/bricelam/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"assigned","commit_id":null,"commit_url":null,"created_at":"2023-05-15T19:46:57Z","assignee":{"login":"bricelam","id":1226749,"node_id":"MDQ6VXNlcjEyMjY3NDk=","avatar_url":"https://avatars.githubusercontent.com/u/1226749?v=4","gravatar_id":"","url":"https://api.github.com/users/bricelam","html_url":"https://github.com/bricelam","followers_url":"https://api.github.com/users/bricelam/followers","following_url":"https://api.github.com/users/bricelam/following{/other_user}","gists_url":"https://api.github.com/users/bricelam/gists{/gist_id}","starred_url":"https://api.github.com/users/bricelam/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bricelam/subscriptions","organizations_url":"https://api.github.com/users/bricelam/orgs","repos_url":"https://api.github.com/users/bricelam/repos","events_url":"https://api.github.com/users/bricelam/events{/privacy}","received_events_url":"https://api.github.com/users/bricelam/received_events","type":"User","user_view_type":"public","site_admin":false},"performed_via_github_app":null},{"url":"https://api.github.com/repos/dotnet/efcore/issues/comments/1548639889","html_url":"https://github.com/dotnet/efcore/issues/30851#issuecomment-1548639889","issue_url":"https://api.github.com/repos/dotnet/efcore/issues/30851","id":1548639889,"node_id":"IC_kwDOAPaMMs5cTl6R","user":{"login":"EdwardNickson","id":26862861,"node_id":"MDQ6VXNlcjI2ODYyODYx","avatar_url":"https://avatars.githubusercontent.com/u/26862861?v=4","gravatar_id":"","url":"https://api.github.com/users/EdwardNickson","html_url":"https://github.com/EdwardNickson","followers_url":"https://api.github.com/users/EdwardNickson/followers","following_url":"https://api.github.com/users/EdwardNickson/following{/other_user}","gists_url":"https://api.github.com/users/EdwardNickson/gists{/gist_id}","starred_url":"https://api.github.com/users/EdwardNickson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/EdwardNickson/subscriptions","organizations_url":"https://api.github.com/users/EdwardNickson/orgs","repos_url":"https://api.github.com/users/EdwardNickson/repos","events_url":"https://api.github.com/users/EdwardNickson/events{/privacy}","received_events_url":"https://api.github.com/users/EdwardNickson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-15T21:48:20Z","updated_at":"2023-05-15T21:48:20Z","body":"That being said, someone in the forum pointed out that the documentation for RETURNING states that all database modifications are made in the first step so the proposed fix shouldn't be needed.\r\n\r\nFrom https://www.sqlite.org/lang_returning.html#processing_order\r\n\r\n> When a DELETE, INSERT, or UPDATE statement with a RETURNING clause is run, all of the database changes occur during the first invocation of [sqlite3_step()](https://www.sqlite.org/c3ref/step.html). The RETURNING clause output is accumulated in memory. The first sqlite3_step() call returns one row of RETURNING output and subsequent rows of RETURNING output are returned by subsequent calls to sqlite3_step(). To put this another way, all RETURNING clause output is embargoed until after all database modification actions are completed\r\n\r\n","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/dotnet/efcore/issues/comments/1548639889/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"EdwardNickson","id":26862861,"node_id":"MDQ6VXNlcjI2ODYyODYx","avatar_url":"https://avatars.githubusercontent.com/u/26862861?v=4","gravatar_id":"","url":"https://api.github.com/users/EdwardNickson","html_url":"https://github.com/EdwardNickson","followers_url":"https://api.github.com/users/EdwardNickson/followers","following_url":"https://api.github.com/users/EdwardNickson/following{/other_user}","gists_url":"https://api.github.com/users/EdwardNickson/gists{/gist_id}","starred_url":"https://api.github.com/users/EdwardNickson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/EdwardNickson/subscriptions","organizations_url":"https://api.github.com/users/EdwardNickson/orgs","repos_url":"https://api.github.com/users/EdwardNickson/repos","events_url":"https://api.github.com/users/EdwardNickson/events{/privacy}","received_events_url":"https://api.github.com/users/EdwardNickson/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/dotnet/efcore/issues/comments/1549099409","html_url":"https://github.com/dotnet/efcore/issues/30851#issuecomment-1549099409","issue_url":"https://api.github.com/repos/dotnet/efcore/issues/30851","id":1549099409,"node_id":"IC_kwDOAPaMMs5cVWGR","user":{"login":"roji","id":1862641,"node_id":"MDQ6VXNlcjE4NjI2NDE=","avatar_url":"https://avatars.githubusercontent.com/u/1862641?v=4","gravatar_id":"","url":"https://api.github.com/users/roji","html_url":"https://github.com/roji","followers_url":"https://api.github.com/users/roji/followers","following_url":"https://api.github.com/users/roji/following{/other_user}","gists_url":"https://api.github.com/users/roji/gists{/gist_id}","starred_url":"https://api.github.com/users/roji/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roji/subscriptions","organizations_url":"https://api.github.com/users/roji/orgs","repos_url":"https://api.github.com/users/roji/repos","events_url":"https://api.github.com/users/roji/events{/privacy}","received_events_url":"https://api.github.com/users/roji/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-16T07:01:34Z","updated_at":"2023-05-16T07:01:34Z","body":"@EdwardNickson thanks for opening the issue and managing the back-and-forths! Have you also reported this to System.Data.Sqlite by any chance?","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/dotnet/efcore/issues/comments/1549099409/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"roji","id":1862641,"node_id":"MDQ6VXNlcjE4NjI2NDE=","avatar_url":"https://avatars.githubusercontent.com/u/1862641?v=4","gravatar_id":"","url":"https://api.github.com/users/roji","html_url":"https://github.com/roji","followers_url":"https://api.github.com/users/roji/followers","following_url":"https://api.github.com/users/roji/following{/other_user}","gists_url":"https://api.github.com/users/roji/gists{/gist_id}","starred_url":"https://api.github.com/users/roji/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roji/subscriptions","organizations_url":"https://api.github.com/users/roji/orgs","repos_url":"https://api.github.com/users/roji/repos","events_url":"https://api.github.com/users/roji/events{/privacy}","received_events_url":"https://api.github.com/users/roji/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":9254175757,"node_id":"MEE_lADOAPaMMs5lZyYTzwAAAAInl4QN","url":"https://api.github.com/repos/dotnet/efcore/issues/events/9254175757","actor":{"login":"EdwardNickson","id":26862861,"node_id":"MDQ6VXNlcjI2ODYyODYx","avatar_url":"https://avatars.githubusercontent.com/u/26862861?v=4","gravatar_id":"","url":"https://api.github.com/users/EdwardNickson","html_url":"https://github.com/EdwardNickson","followers_url":"https://api.github.com/users/EdwardNickson/followers","following_url":"https://api.github.com/users/EdwardNickson/following{/other_user}","gists_url":"https://api.github.com/users/EdwardNickson/gists{/gist_id}","starred_url":"https://api.github.com/users/EdwardNickson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/EdwardNickson/subscriptions","organizations_url":"https://api.github.com/users/EdwardNickson/orgs","repos_url":"https://api.github.com/users/EdwardNickson/repos","events_url":"https://api.github.com/users/EdwardNickson/events{/privacy}","received_events_url":"https://api.github.com/users/EdwardNickson/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2023-05-16T07:01:34Z","performed_via_github_app":null},{"id":9254175766,"node_id":"SE_lADOAPaMMs5lZyYTzwAAAAInl4QW","url":"https://api.github.com/repos/dotnet/efcore/issues/events/9254175766","actor":{"login":"EdwardNickson","id":26862861,"node_id":"MDQ6VXNlcjI2ODYyODYx","avatar_url":"https://avatars.githubusercontent.com/u/26862861?v=4","gravatar_id":"","url":"https://api.github.com/users/EdwardNickson","html_url":"https://github.com/EdwardNickson","followers_url":"https://api.github.com/users/EdwardNickson/followers","following_url":"https://api.github.com/users/EdwardNickson/following{/other_user}","gists_url":"https://api.github.com/users/EdwardNickson/gists{/gist_id}","starred_url":"https://api.github.com/users/EdwardNickson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/EdwardNickson/subscriptions","organizations_url":"https://api.github.com/users/EdwardNickson/orgs","repos_url":"https://api.github.com/users/EdwardNickson/repos","events_url":"https://api.github.com/users/EdwardNickson/events{/privacy}","received_events_url":"https://api.github.com/users/EdwardNickson/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2023-05-16T07:01:34Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/dotnet/efcore/issues/comments/1550417931","html_url":"https://github.com/dotnet/efcore/issues/30851#issuecomment-1550417931","issue_url":"https://api.github.com/repos/dotnet/efcore/issues/30851","id":1550417931,"node_id":"IC_kwDOAPaMMs5caYAL","user":{"login":"mistachkin","id":8270420,"node_id":"MDQ6VXNlcjgyNzA0MjA=","avatar_url":"https://avatars.githubusercontent.com/u/8270420?v=4","gravatar_id":"","url":"https://api.github.com/users/mistachkin","html_url":"https://github.com/mistachkin","followers_url":"https://api.github.com/users/mistachkin/followers","following_url":"https://api.github.com/users/mistachkin/following{/other_user}","gists_url":"https://api.github.com/users/mistachkin/gists{/gist_id}","starred_url":"https://api.github.com/users/mistachkin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mistachkin/subscriptions","organizations_url":"https://api.github.com/users/mistachkin/orgs","repos_url":"https://api.github.com/users/mistachkin/repos","events_url":"https://api.github.com/users/mistachkin/events{/privacy}","received_events_url":"https://api.github.com/users/mistachkin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-16T22:07:55Z","updated_at":"2023-05-16T22:08:12Z","body":"> @EdwardNickson thanks for opening the issue and managing the back-and-forths! Have you also reported this to System.Data.Sqlite by any chance?\r\n\r\nYes.\r\n\r\nTo clarify further: System.Data.SQLite is officially supported by the SQLite Development Team, primarily by me.\r\n\r\nThe issue itself proved to be somewhat more complex than I initially thought, here is a brief summary:\r\n\r\n1. For any SQL query, regardless of content, the **sqlite3_step()** function **must** be called until **SQLITE_DONE** is returned.\r\n2. If this rule is not followed, there is a risk that an (implicit) write transaction (containing any pending changes) will be rolled back, making it appear just like the SQL query was never executed.\r\n3. The bug impacted both the **ExecuteScalar** and **ExecuteNonQuery** methods of System.Data.SQLite.\r\n4. In addition to the bug fix itself, extra diagnostics and backward compatibility overrides have been added to help de-risk the pending 1.0.118.0 release.\r\n\r\nPlease feel free to reach out directly to me (via email or phone) if further issues are encountered.","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/dotnet/efcore/issues/comments/1550417931/reactions","total_count":3,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":3,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"mistachkin","id":8270420,"node_id":"MDQ6VXNlcjgyNzA0MjA=","avatar_url":"https://avatars.githubusercontent.com/u/8270420?v=4","gravatar_id":"","url":"https://api.github.com/users/mistachkin","html_url":"https://github.com/mistachkin","followers_url":"https://api.github.com/users/mistachkin/followers","following_url":"https://api.github.com/users/mistachkin/following{/other_user}","gists_url":"https://api.github.com/users/mistachkin/gists{/gist_id}","starred_url":"https://api.github.com/users/mistachkin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mistachkin/subscriptions","organizations_url":"https://api.github.com/users/mistachkin/orgs","repos_url":"https://api.github.com/users/mistachkin/repos","events_url":"https://api.github.com/users/mistachkin/events{/privacy}","received_events_url":"https://api.github.com/users/mistachkin/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":9262850794,"node_id":"MEE_lADOAPaMMs5lZyYTzwAAAAIoG-Lq","url":"https://api.github.com/repos/dotnet/efcore/issues/events/9262850794","actor":{"login":"EdwardNickson","id":26862861,"node_id":"MDQ6VXNlcjI2ODYyODYx","avatar_url":"https://avatars.githubusercontent.com/u/26862861?v=4","gravatar_id":"","url":"https://api.github.com/users/EdwardNickson","html_url":"https://github.com/EdwardNickson","followers_url":"https://api.github.com/users/EdwardNickson/followers","following_url":"https://api.github.com/users/EdwardNickson/following{/other_user}","gists_url":"https://api.github.com/users/EdwardNickson/gists{/gist_id}","starred_url":"https://api.github.com/users/EdwardNickson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/EdwardNickson/subscriptions","organizations_url":"https://api.github.com/users/EdwardNickson/orgs","repos_url":"https://api.github.com/users/EdwardNickson/repos","events_url":"https://api.github.com/users/EdwardNickson/events{/privacy}","received_events_url":"https://api.github.com/users/EdwardNickson/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2023-05-16T22:07:55Z","performed_via_github_app":null},{"id":9262850805,"node_id":"SE_lADOAPaMMs5lZyYTzwAAAAIoG-L1","url":"https://api.github.com/repos/dotnet/efcore/issues/events/9262850805","actor":{"login":"EdwardNickson","id":26862861,"node_id":"MDQ6VXNlcjI2ODYyODYx","avatar_url":"https://avatars.githubusercontent.com/u/26862861?v=4","gravatar_id":"","url":"https://api.github.com/users/EdwardNickson","html_url":"https://github.com/EdwardNickson","followers_url":"https://api.github.com/users/EdwardNickson/followers","following_url":"https://api.github.com/users/EdwardNickson/following{/other_user}","gists_url":"https://api.github.com/users/EdwardNickson/gists{/gist_id}","starred_url":"https://api.github.com/users/EdwardNickson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/EdwardNickson/subscriptions","organizations_url":"https://api.github.com/users/EdwardNickson/orgs","repos_url":"https://api.github.com/users/EdwardNickson/repos","events_url":"https://api.github.com/users/EdwardNickson/events{/privacy}","received_events_url":"https://api.github.com/users/EdwardNickson/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2023-05-16T22:07:55Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/dotnet/efcore/issues/comments/1550438405","html_url":"https://github.com/dotnet/efcore/issues/30851#issuecomment-1550438405","issue_url":"https://api.github.com/repos/dotnet/efcore/issues/30851","id":1550438405,"node_id":"IC_kwDOAPaMMs5cadAF","user":{"login":"freeze-out","id":14074245,"node_id":"MDQ6VXNlcjE0MDc0MjQ1","avatar_url":"https://avatars.githubusercontent.com/u/14074245?v=4","gravatar_id":"","url":"https://api.github.com/users/freeze-out","html_url":"https://github.com/freeze-out","followers_url":"https://api.github.com/users/freeze-out/followers","following_url":"https://api.github.com/users/freeze-out/following{/other_user}","gists_url":"https://api.github.com/users/freeze-out/gists{/gist_id}","starred_url":"https://api.github.com/users/freeze-out/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/freeze-out/subscriptions","organizations_url":"https://api.github.com/users/freeze-out/orgs","repos_url":"https://api.github.com/users/freeze-out/repos","events_url":"https://api.github.com/users/freeze-out/events{/privacy}","received_events_url":"https://api.github.com/users/freeze-out/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-16T22:28:06Z","updated_at":"2023-05-16T23:21:03Z","body":"I can confirm the bug. I recently had in my logs that data sets were saved without any error and when I searched for some entries in my database they were not there. I have a huge data loss because of that. I just realized that my databases were set to Delete journal mode. Probably that was default setting in EF few versions ago? Those databases are pretty old and I haven't set them to Delete mode by myself. My newer databases are set to WAL.\r\n\r\nP.S: I have multiple processes writing and reading from same database.","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/dotnet/efcore/issues/comments/1550438405/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"freeze-out","id":14074245,"node_id":"MDQ6VXNlcjE0MDc0MjQ1","avatar_url":"https://avatars.githubusercontent.com/u/14074245?v=4","gravatar_id":"","url":"https://api.github.com/users/freeze-out","html_url":"https://github.com/freeze-out","followers_url":"https://api.github.com/users/freeze-out/followers","following_url":"https://api.github.com/users/freeze-out/following{/other_user}","gists_url":"https://api.github.com/users/freeze-out/gists{/gist_id}","starred_url":"https://api.github.com/users/freeze-out/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/freeze-out/subscriptions","organizations_url":"https://api.github.com/users/freeze-out/orgs","repos_url":"https://api.github.com/users/freeze-out/repos","events_url":"https://api.github.com/users/freeze-out/events{/privacy}","received_events_url":"https://api.github.com/users/freeze-out/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":9266830677,"node_id":"LE_lADOAPaMMs5lZyYTzwAAAAIoWJ1V","url":"https://api.github.com/repos/dotnet/efcore/issues/events/9266830677","actor":{"login":"roji","id":1862641,"node_id":"MDQ6VXNlcjE4NjI2NDE=","avatar_url":"https://avatars.githubusercontent.com/u/1862641?v=4","gravatar_id":"","url":"https://api.github.com/users/roji","html_url":"https://github.com/roji","followers_url":"https://api.github.com/users/roji/followers","following_url":"https://api.github.com/users/roji/following{/other_user}","gists_url":"https://api.github.com/users/roji/gists{/gist_id}","starred_url":"https://api.github.com/users/roji/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roji/subscriptions","organizations_url":"https://api.github.com/users/roji/orgs","repos_url":"https://api.github.com/users/roji/repos","events_url":"https://api.github.com/users/roji/events{/privacy}","received_events_url":"https://api.github.com/users/roji/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2023-05-17T09:16:49Z","label":{"name":"Servicing-consider","color":"bfd4f2"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/dotnet/efcore/issues/comments/1553653644","html_url":"https://github.com/dotnet/efcore/issues/30851#issuecomment-1553653644","issue_url":"https://api.github.com/repos/dotnet/efcore/issues/30851","id":1553653644,"node_id":"IC_kwDOAPaMMs5cmt-M","user":{"login":"freeze-out","id":14074245,"node_id":"MDQ6VXNlcjE0MDc0MjQ1","avatar_url":"https://avatars.githubusercontent.com/u/14074245?v=4","gravatar_id":"","url":"https://api.github.com/users/freeze-out","html_url":"https://github.com/freeze-out","followers_url":"https://api.github.com/users/freeze-out/followers","following_url":"https://api.github.com/users/freeze-out/following{/other_user}","gists_url":"https://api.github.com/users/freeze-out/gists{/gist_id}","starred_url":"https://api.github.com/users/freeze-out/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/freeze-out/subscriptions","organizations_url":"https://api.github.com/users/freeze-out/orgs","repos_url":"https://api.github.com/users/freeze-out/repos","events_url":"https://api.github.com/users/freeze-out/events{/privacy}","received_events_url":"https://api.github.com/users/freeze-out/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-18T21:13:52Z","updated_at":"2023-05-18T21:13:52Z","body":"Any idea how many percentage of data can get lost because of the bug? Is the 4901 data set saved out of 5000 a realistic scenario or could it be even more under any circumstances?","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/dotnet/efcore/issues/comments/1553653644/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"freeze-out","id":14074245,"node_id":"MDQ6VXNlcjE0MDc0MjQ1","avatar_url":"https://avatars.githubusercontent.com/u/14074245?v=4","gravatar_id":"","url":"https://api.github.com/users/freeze-out","html_url":"https://github.com/freeze-out","followers_url":"https://api.github.com/users/freeze-out/followers","following_url":"https://api.github.com/users/freeze-out/following{/other_user}","gists_url":"https://api.github.com/users/freeze-out/gists{/gist_id}","starred_url":"https://api.github.com/users/freeze-out/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/freeze-out/subscriptions","organizations_url":"https://api.github.com/users/freeze-out/orgs","repos_url":"https://api.github.com/users/freeze-out/repos","events_url":"https://api.github.com/users/freeze-out/events{/privacy}","received_events_url":"https://api.github.com/users/freeze-out/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/dotnet/efcore/issues/comments/1554272352","html_url":"https://github.com/dotnet/efcore/issues/30851#issuecomment-1554272352","issue_url":"https://api.github.com/repos/dotnet/efcore/issues/30851","id":1554272352,"node_id":"IC_kwDOAPaMMs5cpFBg","user":{"login":"roji","id":1862641,"node_id":"MDQ6VXNlcjE4NjI2NDE=","avatar_url":"https://avatars.githubusercontent.com/u/1862641?v=4","gravatar_id":"","url":"https://api.github.com/users/roji","html_url":"https://github.com/roji","followers_url":"https://api.github.com/users/roji/followers","following_url":"https://api.github.com/users/roji/following{/other_user}","gists_url":"https://api.github.com/users/roji/gists{/gist_id}","starred_url":"https://api.github.com/users/roji/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roji/subscriptions","organizations_url":"https://api.github.com/users/roji/orgs","repos_url":"https://api.github.com/users/roji/repos","events_url":"https://api.github.com/users/roji/events{/privacy}","received_events_url":"https://api.github.com/users/roji/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-19T09:08:08Z","updated_at":"2023-05-19T09:08:08Z","body":"@freeze-out as with most concurrency bugs, I don't think anyone can answer that reliably; it also shouldn't really matter - if even one row can be silently lost, that's already pretty critical.","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/dotnet/efcore/issues/comments/1554272352/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"roji","id":1862641,"node_id":"MDQ6VXNlcjE4NjI2NDE=","avatar_url":"https://avatars.githubusercontent.com/u/1862641?v=4","gravatar_id":"","url":"https://api.github.com/users/roji","html_url":"https://github.com/roji","followers_url":"https://api.github.com/users/roji/followers","following_url":"https://api.github.com/users/roji/following{/other_user}","gists_url":"https://api.github.com/users/roji/gists{/gist_id}","starred_url":"https://api.github.com/users/roji/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roji/subscriptions","organizations_url":"https://api.github.com/users/roji/orgs","repos_url":"https://api.github.com/users/roji/repos","events_url":"https://api.github.com/users/roji/events{/privacy}","received_events_url":"https://api.github.com/users/roji/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":9287378172,"node_id":"MEE_lADOAPaMMs5lZyYTzwAAAAIpkiT8","url":"https://api.github.com/repos/dotnet/efcore/issues/events/9287378172","actor":{"login":"freeze-out","id":14074245,"node_id":"MDQ6VXNlcjE0MDc0MjQ1","avatar_url":"https://avatars.githubusercontent.com/u/14074245?v=4","gravatar_id":"","url":"https://api.github.com/users/freeze-out","html_url":"https://github.com/freeze-out","followers_url":"https://api.github.com/users/freeze-out/followers","following_url":"https://api.github.com/users/freeze-out/following{/other_user}","gists_url":"https://api.github.com/users/freeze-out/gists{/gist_id}","starred_url":"https://api.github.com/users/freeze-out/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/freeze-out/subscriptions","organizations_url":"https://api.github.com/users/freeze-out/orgs","repos_url":"https://api.github.com/users/freeze-out/repos","events_url":"https://api.github.com/users/freeze-out/events{/privacy}","received_events_url":"https://api.github.com/users/freeze-out/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2023-05-19T09:08:08Z","performed_via_github_app":null}]