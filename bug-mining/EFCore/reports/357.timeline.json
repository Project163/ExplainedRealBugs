[{"id":11023689567,"node_id":"LE_lADOAPaMMs53dTiEzwAAAAKRECdf","url":"https://api.github.com/repos/dotnet/efcore/issues/events/11023689567","actor":{"login":"AlexeiScherbakov","id":8665915,"node_id":"MDQ6VXNlcjg2NjU5MTU=","avatar_url":"https://avatars.githubusercontent.com/u/8665915?v=4","gravatar_id":"","url":"https://api.github.com/users/AlexeiScherbakov","html_url":"https://github.com/AlexeiScherbakov","followers_url":"https://api.github.com/users/AlexeiScherbakov/followers","following_url":"https://api.github.com/users/AlexeiScherbakov/following{/other_user}","gists_url":"https://api.github.com/users/AlexeiScherbakov/gists{/gist_id}","starred_url":"https://api.github.com/users/AlexeiScherbakov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AlexeiScherbakov/subscriptions","organizations_url":"https://api.github.com/users/AlexeiScherbakov/orgs","repos_url":"https://api.github.com/users/AlexeiScherbakov/repos","events_url":"https://api.github.com/users/AlexeiScherbakov/events{/privacy}","received_events_url":"https://api.github.com/users/AlexeiScherbakov/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2023-11-21T12:22:34Z","label":{"name":"customer-reported","color":"a4a5f9"},"performed_via_github_app":null},{"actor":{"login":"AlexeiScherbakov","id":8665915,"node_id":"MDQ6VXNlcjg2NjU5MTU=","avatar_url":"https://avatars.githubusercontent.com/u/8665915?v=4","gravatar_id":"","url":"https://api.github.com/users/AlexeiScherbakov","html_url":"https://github.com/AlexeiScherbakov","followers_url":"https://api.github.com/users/AlexeiScherbakov/followers","following_url":"https://api.github.com/users/AlexeiScherbakov/following{/other_user}","gists_url":"https://api.github.com/users/AlexeiScherbakov/gists{/gist_id}","starred_url":"https://api.github.com/users/AlexeiScherbakov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AlexeiScherbakov/subscriptions","organizations_url":"https://api.github.com/users/AlexeiScherbakov/orgs","repos_url":"https://api.github.com/users/AlexeiScherbakov/repos","events_url":"https://api.github.com/users/AlexeiScherbakov/events{/privacy}","received_events_url":"https://api.github.com/users/AlexeiScherbakov/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-11-21T12:32:45Z","updated_at":"2023-11-21T12:32:45Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/dotnet/efcore/issues/32365","repository_url":"https://api.github.com/repos/dotnet/efcore","labels_url":"https://api.github.com/repos/dotnet/efcore/issues/32365/labels{/name}","comments_url":"https://api.github.com/repos/dotnet/efcore/issues/32365/comments","events_url":"https://api.github.com/repos/dotnet/efcore/issues/32365/events","html_url":"https://github.com/dotnet/efcore/issues/32365","id":2002833225,"node_id":"I_kwDOAPaMMs53YM9J","number":32365,"title":"Hashset contains becomes a traditional IN statement instead of the new OpenJSON parameter","user":{"login":"ngelotte","id":16006512,"node_id":"MDQ6VXNlcjE2MDA2NTEy","avatar_url":"https://avatars.githubusercontent.com/u/16006512?v=4","gravatar_id":"","url":"https://api.github.com/users/ngelotte","html_url":"https://github.com/ngelotte","followers_url":"https://api.github.com/users/ngelotte/followers","following_url":"https://api.github.com/users/ngelotte/following{/other_user}","gists_url":"https://api.github.com/users/ngelotte/gists{/gist_id}","starred_url":"https://api.github.com/users/ngelotte/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ngelotte/subscriptions","organizations_url":"https://api.github.com/users/ngelotte/orgs","repos_url":"https://api.github.com/users/ngelotte/repos","events_url":"https://api.github.com/users/ngelotte/events{/privacy}","received_events_url":"https://api.github.com/users/ngelotte/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":130861068,"node_id":"MDU6TGFiZWwxMzA4NjEwNjg=","url":"https://api.github.com/repos/dotnet/efcore/labels/area-perf","name":"area-perf","color":"5319e7","default":false,"description":""},{"id":936619505,"node_id":"MDU6TGFiZWw5MzY2MTk1MDU=","url":"https://api.github.com/repos/dotnet/efcore/labels/customer-reported","name":"customer-reported","color":"a4a5f9","default":false,"description":""},{"id":1675384372,"node_id":"MDU6TGFiZWwxNjc1Mzg0Mzcy","url":"https://api.github.com/repos/dotnet/efcore/labels/area-query","name":"area-query","color":"32b37b","default":false,"description":""},{"id":4725071141,"node_id":"LA_kwDOAPaMMs8AAAABGaLdJQ","url":"https://api.github.com/repos/dotnet/efcore/labels/area-primitive-collections","name":"area-primitive-collections","color":"32b37b","default":false,"description":""}],"state":"closed","locked":false,"assignee":{"login":"cincuranet","id":4540597,"node_id":"MDQ6VXNlcjQ1NDA1OTc=","avatar_url":"https://avatars.githubusercontent.com/u/4540597?v=4","gravatar_id":"","url":"https://api.github.com/users/cincuranet","html_url":"https://github.com/cincuranet","followers_url":"https://api.github.com/users/cincuranet/followers","following_url":"https://api.github.com/users/cincuranet/following{/other_user}","gists_url":"https://api.github.com/users/cincuranet/gists{/gist_id}","starred_url":"https://api.github.com/users/cincuranet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cincuranet/subscriptions","organizations_url":"https://api.github.com/users/cincuranet/orgs","repos_url":"https://api.github.com/users/cincuranet/repos","events_url":"https://api.github.com/users/cincuranet/events{/privacy}","received_events_url":"https://api.github.com/users/cincuranet/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"cincuranet","id":4540597,"node_id":"MDQ6VXNlcjQ1NDA1OTc=","avatar_url":"https://avatars.githubusercontent.com/u/4540597?v=4","gravatar_id":"","url":"https://api.github.com/users/cincuranet","html_url":"https://github.com/cincuranet","followers_url":"https://api.github.com/users/cincuranet/followers","following_url":"https://api.github.com/users/cincuranet/following{/other_user}","gists_url":"https://api.github.com/users/cincuranet/gists{/gist_id}","starred_url":"https://api.github.com/users/cincuranet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cincuranet/subscriptions","organizations_url":"https://api.github.com/users/cincuranet/orgs","repos_url":"https://api.github.com/users/cincuranet/repos","events_url":"https://api.github.com/users/cincuranet/events{/privacy}","received_events_url":"https://api.github.com/users/cincuranet/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":{"url":"https://api.github.com/repos/dotnet/efcore/milestones/180","html_url":"https://github.com/dotnet/efcore/milestone/180","labels_url":"https://api.github.com/repos/dotnet/efcore/milestones/180/labels","id":9963267,"node_id":"MI_kwDOAPaMMs4AmAcD","number":180,"title":"9.0.0","description":null,"creator":{"login":"ajcvickers","id":1430078,"node_id":"MDQ6VXNlcjE0MzAwNzg=","avatar_url":"https://avatars.githubusercontent.com/u/1430078?v=4","gravatar_id":"","url":"https://api.github.com/users/ajcvickers","html_url":"https://github.com/ajcvickers","followers_url":"https://api.github.com/users/ajcvickers/followers","following_url":"https://api.github.com/users/ajcvickers/following{/other_user}","gists_url":"https://api.github.com/users/ajcvickers/gists{/gist_id}","starred_url":"https://api.github.com/users/ajcvickers/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajcvickers/subscriptions","organizations_url":"https://api.github.com/users/ajcvickers/orgs","repos_url":"https://api.github.com/users/ajcvickers/repos","events_url":"https://api.github.com/users/ajcvickers/events{/privacy}","received_events_url":"https://api.github.com/users/ajcvickers/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":339,"state":"closed","created_at":"2023-09-25T15:41:58Z","updated_at":"2025-04-01T18:19:15Z","due_on":null,"closed_at":"2024-11-14T11:54:05Z"},"comments":19,"created_at":"2023-11-20T19:09:45Z","updated_at":"2025-06-15T19:54:35Z","closed_at":"2024-06-10T07:24:23Z","author_association":"NONE","type":{"id":1092406,"node_id":"IT_kwDOAIt-yc4AEKs2","name":"Feature","description":"A request, idea, or new functionality","color":"blue","created_at":"2024-01-25T11:45:43Z","updated_at":"2024-10-08T09:10:05Z","is_enabled":true},"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"repository":{"id":16157746,"node_id":"MDEwOlJlcG9zaXRvcnkxNjE1Nzc0Ng==","name":"efcore","full_name":"dotnet/efcore","private":false,"owner":{"login":"dotnet","id":9141961,"node_id":"MDEyOk9yZ2FuaXphdGlvbjkxNDE5NjE=","avatar_url":"https://avatars.githubusercontent.com/u/9141961?v=4","gravatar_id":"","url":"https://api.github.com/users/dotnet","html_url":"https://github.com/dotnet","followers_url":"https://api.github.com/users/dotnet/followers","following_url":"https://api.github.com/users/dotnet/following{/other_user}","gists_url":"https://api.github.com/users/dotnet/gists{/gist_id}","starred_url":"https://api.github.com/users/dotnet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dotnet/subscriptions","organizations_url":"https://api.github.com/users/dotnet/orgs","repos_url":"https://api.github.com/users/dotnet/repos","events_url":"https://api.github.com/users/dotnet/events{/privacy}","received_events_url":"https://api.github.com/users/dotnet/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/dotnet/efcore","description":"EF Core is a modern object-database mapper for .NET. It supports LINQ queries, change tracking, updates, and schema migrations.","fork":false,"url":"https://api.github.com/repos/dotnet/efcore","forks_url":"https://api.github.com/repos/dotnet/efcore/forks","keys_url":"https://api.github.com/repos/dotnet/efcore/keys{/key_id}","collaborators_url":"https://api.github.com/repos/dotnet/efcore/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/dotnet/efcore/teams","hooks_url":"https://api.github.com/repos/dotnet/efcore/hooks","issue_events_url":"https://api.github.com/repos/dotnet/efcore/issues/events{/number}","events_url":"https://api.github.com/repos/dotnet/efcore/events","assignees_url":"https://api.github.com/repos/dotnet/efcore/assignees{/user}","branches_url":"https://api.github.com/repos/dotnet/efcore/branches{/branch}","tags_url":"https://api.github.com/repos/dotnet/efcore/tags","blobs_url":"https://api.github.com/repos/dotnet/efcore/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/dotnet/efcore/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/dotnet/efcore/git/refs{/sha}","trees_url":"https://api.github.com/repos/dotnet/efcore/git/trees{/sha}","statuses_url":"https://api.github.com/repos/dotnet/efcore/statuses/{sha}","languages_url":"https://api.github.com/repos/dotnet/efcore/languages","stargazers_url":"https://api.github.com/repos/dotnet/efcore/stargazers","contributors_url":"https://api.github.com/repos/dotnet/efcore/contributors","subscribers_url":"https://api.github.com/repos/dotnet/efcore/subscribers","subscription_url":"https://api.github.com/repos/dotnet/efcore/subscription","commits_url":"https://api.github.com/repos/dotnet/efcore/commits{/sha}","git_commits_url":"https://api.github.com/repos/dotnet/efcore/git/commits{/sha}","comments_url":"https://api.github.com/repos/dotnet/efcore/comments{/number}","issue_comment_url":"https://api.github.com/repos/dotnet/efcore/issues/comments{/number}","contents_url":"https://api.github.com/repos/dotnet/efcore/contents/{+path}","compare_url":"https://api.github.com/repos/dotnet/efcore/compare/{base}...{head}","merges_url":"https://api.github.com/repos/dotnet/efcore/merges","archive_url":"https://api.github.com/repos/dotnet/efcore/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/dotnet/efcore/downloads","issues_url":"https://api.github.com/repos/dotnet/efcore/issues{/number}","pulls_url":"https://api.github.com/repos/dotnet/efcore/pulls{/number}","milestones_url":"https://api.github.com/repos/dotnet/efcore/milestones{/number}","notifications_url":"https://api.github.com/repos/dotnet/efcore/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/dotnet/efcore/labels{/name}","releases_url":"https://api.github.com/repos/dotnet/efcore/releases{/id}","deployments_url":"https://api.github.com/repos/dotnet/efcore/deployments","created_at":"2014-01-23T00:52:01Z","updated_at":"2025-11-10T14:21:49Z","pushed_at":"2025-11-10T05:59:58Z","git_url":"git://github.com/dotnet/efcore.git","ssh_url":"git@github.com:dotnet/efcore.git","clone_url":"https://github.com/dotnet/efcore.git","svn_url":"https://github.com/dotnet/efcore","homepage":"https://learn.microsoft.com/ef/","size":215987,"stargazers_count":14455,"watchers_count":14455,"language":"C#","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":3324,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":2430,"license":{"key":"mit","name":"MIT License","spdx_id":"MIT","url":"https://api.github.com/licenses/mit","node_id":"MDc6TGljZW5zZTEz"},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["aspnet-product","c-sharp","database","dotnet-core","dotnet-framework","dotnet-standard","entity-framework","hacktoberfest","orm"],"visibility":"public","forks":3324,"open_issues":2430,"watchers":14455,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"body":"## File a bug\r\n\r\nIf you use a HashSet for the parameter which is used by contains it generates the old style non parameterized query\r\n\r\n```C#\r\nHashSet<string> filterData = [\"Thing1\", \"Thing2\"];\r\nvar results =  db.TableOfStuff.Where(t => filterData.Contains(t.Item)).ToList();\r\n```\r\n\r\nThe following code generates the new parameterized query but it seems like an unnecessary ToList and an easy place to miss adding the ToList and end up with a performance degradation.\r\n\r\n```C#\r\nHashSet<string> filterData = [\"Thing1\", \"Thing2\"];\r\nvar results =  db.TableOfStuff.Where(t => filterData.ToList().Contains(t.Item)).ToList();\r\n```\r\n\r\n\r\n### Include provider and version information\r\n\r\nEF Core version: 8.0\r\nDatabase provider: Microsoft.EntityFrameworkCore.SqlServer\r\nTarget framework: .Net 8.0\r\nOperating system: Windows\r\nIDE: Visual Studio 17.8\r\n","reactions":{"url":"https://api.github.com/repos/dotnet/efcore/issues/32365/reactions","total_count":9,"+1":9,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/dotnet/efcore/issues/32365/timeline","performed_via_github_app":null,"state_reason":"completed"}},"event":"cross-referenced"},{"url":"https://api.github.com/repos/dotnet/efcore/issues/comments/1820855627","html_url":"https://github.com/dotnet/efcore/issues/32374#issuecomment-1820855627","issue_url":"https://api.github.com/repos/dotnet/efcore/issues/32374","id":1820855627,"node_id":"IC_kwDOAPaMMs5siA1L","user":{"login":"ajcvickers","id":1430078,"node_id":"MDQ6VXNlcjE0MzAwNzg=","avatar_url":"https://avatars.githubusercontent.com/u/1430078?v=4","gravatar_id":"","url":"https://api.github.com/users/ajcvickers","html_url":"https://github.com/ajcvickers","followers_url":"https://api.github.com/users/ajcvickers/followers","following_url":"https://api.github.com/users/ajcvickers/following{/other_user}","gists_url":"https://api.github.com/users/ajcvickers/gists{/gist_id}","starred_url":"https://api.github.com/users/ajcvickers/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajcvickers/subscriptions","organizations_url":"https://api.github.com/users/ajcvickers/orgs","repos_url":"https://api.github.com/users/ajcvickers/repos","events_url":"https://api.github.com/users/ajcvickers/events{/privacy}","received_events_url":"https://api.github.com/users/ajcvickers/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-11-21T12:43:36Z","updated_at":"2023-11-21T12:43:36Z","body":"@AlexeiScherbakov Make sure you have the compatibility level for your database set appropriately. See [Contains in LINQ queries may stop working on older SQL Server versions](https://learn.microsoft.com/en-us/ef/core/what-is-new/ef-core-8.0/breaking-changes#sqlserver-contains-compatibility)","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/dotnet/efcore/issues/comments/1820855627/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"ajcvickers","id":1430078,"node_id":"MDQ6VXNlcjE0MzAwNzg=","avatar_url":"https://avatars.githubusercontent.com/u/1430078?v=4","gravatar_id":"","url":"https://api.github.com/users/ajcvickers","html_url":"https://github.com/ajcvickers","followers_url":"https://api.github.com/users/ajcvickers/followers","following_url":"https://api.github.com/users/ajcvickers/following{/other_user}","gists_url":"https://api.github.com/users/ajcvickers/gists{/gist_id}","starred_url":"https://api.github.com/users/ajcvickers/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajcvickers/subscriptions","organizations_url":"https://api.github.com/users/ajcvickers/orgs","repos_url":"https://api.github.com/users/ajcvickers/repos","events_url":"https://api.github.com/users/ajcvickers/events{/privacy}","received_events_url":"https://api.github.com/users/ajcvickers/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":11023924625,"node_id":"MEE_lADOAPaMMs53dTiEzwAAAAKRE72R","url":"https://api.github.com/repos/dotnet/efcore/issues/events/11023924625","actor":{"login":"AlexeiScherbakov","id":8665915,"node_id":"MDQ6VXNlcjg2NjU5MTU=","avatar_url":"https://avatars.githubusercontent.com/u/8665915?v=4","gravatar_id":"","url":"https://api.github.com/users/AlexeiScherbakov","html_url":"https://github.com/AlexeiScherbakov","followers_url":"https://api.github.com/users/AlexeiScherbakov/followers","following_url":"https://api.github.com/users/AlexeiScherbakov/following{/other_user}","gists_url":"https://api.github.com/users/AlexeiScherbakov/gists{/gist_id}","starred_url":"https://api.github.com/users/AlexeiScherbakov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AlexeiScherbakov/subscriptions","organizations_url":"https://api.github.com/users/AlexeiScherbakov/orgs","repos_url":"https://api.github.com/users/AlexeiScherbakov/repos","events_url":"https://api.github.com/users/AlexeiScherbakov/events{/privacy}","received_events_url":"https://api.github.com/users/AlexeiScherbakov/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2023-11-21T12:43:36Z","performed_via_github_app":null},{"id":11023924639,"node_id":"SE_lADOAPaMMs53dTiEzwAAAAKRE72f","url":"https://api.github.com/repos/dotnet/efcore/issues/events/11023924639","actor":{"login":"AlexeiScherbakov","id":8665915,"node_id":"MDQ6VXNlcjg2NjU5MTU=","avatar_url":"https://avatars.githubusercontent.com/u/8665915?v=4","gravatar_id":"","url":"https://api.github.com/users/AlexeiScherbakov","html_url":"https://github.com/AlexeiScherbakov","followers_url":"https://api.github.com/users/AlexeiScherbakov/followers","following_url":"https://api.github.com/users/AlexeiScherbakov/following{/other_user}","gists_url":"https://api.github.com/users/AlexeiScherbakov/gists{/gist_id}","starred_url":"https://api.github.com/users/AlexeiScherbakov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AlexeiScherbakov/subscriptions","organizations_url":"https://api.github.com/users/AlexeiScherbakov/orgs","repos_url":"https://api.github.com/users/AlexeiScherbakov/repos","events_url":"https://api.github.com/users/AlexeiScherbakov/events{/privacy}","received_events_url":"https://api.github.com/users/AlexeiScherbakov/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2023-11-21T12:43:36Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/dotnet/efcore/issues/comments/1821266502","html_url":"https://github.com/dotnet/efcore/issues/32374#issuecomment-1821266502","issue_url":"https://api.github.com/repos/dotnet/efcore/issues/32374","id":1821266502,"node_id":"IC_kwDOAPaMMs5sjlJG","user":{"login":"AlexeiScherbakov","id":8665915,"node_id":"MDQ6VXNlcjg2NjU5MTU=","avatar_url":"https://avatars.githubusercontent.com/u/8665915?v=4","gravatar_id":"","url":"https://api.github.com/users/AlexeiScherbakov","html_url":"https://github.com/AlexeiScherbakov","followers_url":"https://api.github.com/users/AlexeiScherbakov/followers","following_url":"https://api.github.com/users/AlexeiScherbakov/following{/other_user}","gists_url":"https://api.github.com/users/AlexeiScherbakov/gists{/gist_id}","starred_url":"https://api.github.com/users/AlexeiScherbakov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AlexeiScherbakov/subscriptions","organizations_url":"https://api.github.com/users/AlexeiScherbakov/orgs","repos_url":"https://api.github.com/users/AlexeiScherbakov/repos","events_url":"https://api.github.com/users/AlexeiScherbakov/events{/privacy}","received_events_url":"https://api.github.com/users/AlexeiScherbakov/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-11-21T16:33:33Z","updated_at":"2023-11-21T16:33:33Z","body":"I use 15.0 version of SQL Server with compatibility level 150\r\nIn my test environment ```SELECT name, compatibility_level FROM sys.databases;``` returns\r\n```\r\nmaster\t150\r\ntempdb\t150\r\nmodel\t150\r\nmsdb\t150\r\nOpenJsonBugDb\t150\r\n```\r\n\r\nProblem is that inside subquery with nested aggregate OPENJSON cannot be evaluated by SQL Server, but IN instruction - can. It means that thanslator cannot use OPENJSON everywhere\r\n\r\nProblem is **only** when Contains is used in nested expression\r\n\r\nFor example this is working normally:\r\n```\r\n[Test]\r\npublic void TestJustCountTranslation()\r\n{\r\n    using var dbContext = _webApplication.Services.GetRequiredService<SalesDbContext>();\r\n\r\n    string[] shippedStatuses = new string[]\r\n    {\r\n        \"Delivered\",\r\n        \"Shipped\",\r\n        \"Net\"\r\n    };\r\n\r\n    int intStart = 20230101;\r\n    int intEnd = 20231121;\r\n\r\n    var data = dbContext.Sales.Where(x => (x.DateId >= intStart) && (x.DateId <= intEnd) && (x.FiltersService == 0)\r\n            && shippedStatuses.Contains(x.StatusNameLine))\r\n        .Count();\r\n}\r\n\r\n[Test]\r\npublic void TestJustCount2Translation()\r\n{\r\n    using var dbContext = _webApplication.Services.GetRequiredService<SalesDbContext>();\r\n\r\n    HashSet<string> shippedStatuses = new HashSet<string>()\r\n    {\r\n        \"Delivered\",\r\n        \"Shipped\",\r\n        \"Net\"\r\n    };\r\n\r\n    int intStart = 20230101;\r\n    int intEnd = 20231121;\r\n\r\n    var data = dbContext.Sales.Where(x => (x.DateId >= intStart) && (x.DateId <= intEnd) && (x.FiltersService == 0)\r\n            && shippedStatuses.Contains(x.StatusNameLine))\r\n        .Count();\r\n}\r\n```","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/dotnet/efcore/issues/comments/1821266502/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"AlexeiScherbakov","id":8665915,"node_id":"MDQ6VXNlcjg2NjU5MTU=","avatar_url":"https://avatars.githubusercontent.com/u/8665915?v=4","gravatar_id":"","url":"https://api.github.com/users/AlexeiScherbakov","html_url":"https://github.com/AlexeiScherbakov","followers_url":"https://api.github.com/users/AlexeiScherbakov/followers","following_url":"https://api.github.com/users/AlexeiScherbakov/following{/other_user}","gists_url":"https://api.github.com/users/AlexeiScherbakov/gists{/gist_id}","starred_url":"https://api.github.com/users/AlexeiScherbakov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AlexeiScherbakov/subscriptions","organizations_url":"https://api.github.com/users/AlexeiScherbakov/orgs","repos_url":"https://api.github.com/users/AlexeiScherbakov/repos","events_url":"https://api.github.com/users/AlexeiScherbakov/events{/privacy}","received_events_url":"https://api.github.com/users/AlexeiScherbakov/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/dotnet/efcore/issues/comments/1821312278","html_url":"https://github.com/dotnet/efcore/issues/32374#issuecomment-1821312278","issue_url":"https://api.github.com/repos/dotnet/efcore/issues/32374","id":1821312278,"node_id":"IC_kwDOAPaMMs5sjwUW","user":{"login":"roji","id":1862641,"node_id":"MDQ6VXNlcjE4NjI2NDE=","avatar_url":"https://avatars.githubusercontent.com/u/1862641?v=4","gravatar_id":"","url":"https://api.github.com/users/roji","html_url":"https://github.com/roji","followers_url":"https://api.github.com/users/roji/followers","following_url":"https://api.github.com/users/roji/following{/other_user}","gists_url":"https://api.github.com/users/roji/gists{/gist_id}","starred_url":"https://api.github.com/users/roji/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roji/subscriptions","organizations_url":"https://api.github.com/users/roji/orgs","repos_url":"https://api.github.com/users/roji/repos","events_url":"https://api.github.com/users/roji/events{/privacy}","received_events_url":"https://api.github.com/users/roji/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-11-21T17:00:16Z","updated_at":"2023-11-21T17:00:16Z","body":"Thanks @AlexeiScherbakov, I'll investigate this.","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/dotnet/efcore/issues/comments/1821312278/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"roji","id":1862641,"node_id":"MDQ6VXNlcjE4NjI2NDE=","avatar_url":"https://avatars.githubusercontent.com/u/1862641?v=4","gravatar_id":"","url":"https://api.github.com/users/roji","html_url":"https://github.com/roji","followers_url":"https://api.github.com/users/roji/followers","following_url":"https://api.github.com/users/roji/following{/other_user}","gists_url":"https://api.github.com/users/roji/gists{/gist_id}","starred_url":"https://api.github.com/users/roji/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roji/subscriptions","organizations_url":"https://api.github.com/users/roji/orgs","repos_url":"https://api.github.com/users/roji/repos","events_url":"https://api.github.com/users/roji/events{/privacy}","received_events_url":"https://api.github.com/users/roji/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":11027047974,"node_id":"MEE_lADOAPaMMs53dTiEzwAAAAKRQ2Ym","url":"https://api.github.com/repos/dotnet/efcore/issues/events/11027047974","actor":{"login":"AlexeiScherbakov","id":8665915,"node_id":"MDQ6VXNlcjg2NjU5MTU=","avatar_url":"https://avatars.githubusercontent.com/u/8665915?v=4","gravatar_id":"","url":"https://api.github.com/users/AlexeiScherbakov","html_url":"https://github.com/AlexeiScherbakov","followers_url":"https://api.github.com/users/AlexeiScherbakov/followers","following_url":"https://api.github.com/users/AlexeiScherbakov/following{/other_user}","gists_url":"https://api.github.com/users/AlexeiScherbakov/gists{/gist_id}","starred_url":"https://api.github.com/users/AlexeiScherbakov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AlexeiScherbakov/subscriptions","organizations_url":"https://api.github.com/users/AlexeiScherbakov/orgs","repos_url":"https://api.github.com/users/AlexeiScherbakov/repos","events_url":"https://api.github.com/users/AlexeiScherbakov/events{/privacy}","received_events_url":"https://api.github.com/users/AlexeiScherbakov/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2023-11-21T17:00:16Z","performed_via_github_app":null},{"id":11027047985,"node_id":"SE_lADOAPaMMs53dTiEzwAAAAKRQ2Yx","url":"https://api.github.com/repos/dotnet/efcore/issues/events/11027047985","actor":{"login":"AlexeiScherbakov","id":8665915,"node_id":"MDQ6VXNlcjg2NjU5MTU=","avatar_url":"https://avatars.githubusercontent.com/u/8665915?v=4","gravatar_id":"","url":"https://api.github.com/users/AlexeiScherbakov","html_url":"https://github.com/AlexeiScherbakov","followers_url":"https://api.github.com/users/AlexeiScherbakov/followers","following_url":"https://api.github.com/users/AlexeiScherbakov/following{/other_user}","gists_url":"https://api.github.com/users/AlexeiScherbakov/gists{/gist_id}","starred_url":"https://api.github.com/users/AlexeiScherbakov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AlexeiScherbakov/subscriptions","organizations_url":"https://api.github.com/users/AlexeiScherbakov/orgs","repos_url":"https://api.github.com/users/AlexeiScherbakov/repos","events_url":"https://api.github.com/users/AlexeiScherbakov/events{/privacy}","received_events_url":"https://api.github.com/users/AlexeiScherbakov/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2023-11-21T17:00:16Z","performed_via_github_app":null},{"id":11064006098,"node_id":"RTE_lADOAPaMMs53dTiEzwAAAAKTd1XS","url":"https://api.github.com/repos/dotnet/efcore/issues/events/11064006098","actor":{"login":"roji","id":1862641,"node_id":"MDQ6VXNlcjE4NjI2NDE=","avatar_url":"https://avatars.githubusercontent.com/u/1862641?v=4","gravatar_id":"","url":"https://api.github.com/users/roji","html_url":"https://github.com/roji","followers_url":"https://api.github.com/users/roji/followers","following_url":"https://api.github.com/users/roji/following{/other_user}","gists_url":"https://api.github.com/users/roji/gists{/gist_id}","starred_url":"https://api.github.com/users/roji/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roji/subscriptions","organizations_url":"https://api.github.com/users/roji/orgs","repos_url":"https://api.github.com/users/roji/repos","events_url":"https://api.github.com/users/roji/events{/privacy}","received_events_url":"https://api.github.com/users/roji/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"renamed","commit_id":null,"commit_url":null,"created_at":"2023-11-26T20:46:34Z","rename":{"from":"New OpenJSON expression to SQL translation breaks argregates on subquery with 'Cannot perform an aggregate function on an expression containing an aggregate or a subquery' exception","to":"New OpenJSON expression to SQL translation breaks aggregates on subquery with 'Cannot perform an aggregate function on an expression containing an aggregate or a subquery' exception"},"performed_via_github_app":null},{"id":11069721796,"node_id":"LE_lADOAPaMMs53dTiEzwAAAAKTzozE","url":"https://api.github.com/repos/dotnet/efcore/issues/events/11069721796","actor":{"login":"roji","id":1862641,"node_id":"MDQ6VXNlcjE4NjI2NDE=","avatar_url":"https://avatars.githubusercontent.com/u/1862641?v=4","gravatar_id":"","url":"https://api.github.com/users/roji","html_url":"https://github.com/roji","followers_url":"https://api.github.com/users/roji/followers","following_url":"https://api.github.com/users/roji/following{/other_user}","gists_url":"https://api.github.com/users/roji/gists{/gist_id}","starred_url":"https://api.github.com/users/roji/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roji/subscriptions","organizations_url":"https://api.github.com/users/roji/orgs","repos_url":"https://api.github.com/users/roji/repos","events_url":"https://api.github.com/users/roji/events{/privacy}","received_events_url":"https://api.github.com/users/roji/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2023-11-27T11:23:29Z","label":{"name":"type-bug","color":"f7c6c7"},"performed_via_github_app":null},{"id":11069722364,"node_id":"LE_lADOAPaMMs53dTiEzwAAAAKTzo78","url":"https://api.github.com/repos/dotnet/efcore/issues/events/11069722364","actor":{"login":"roji","id":1862641,"node_id":"MDQ6VXNlcjE4NjI2NDE=","avatar_url":"https://avatars.githubusercontent.com/u/1862641?v=4","gravatar_id":"","url":"https://api.github.com/users/roji","html_url":"https://github.com/roji","followers_url":"https://api.github.com/users/roji/followers","following_url":"https://api.github.com/users/roji/following{/other_user}","gists_url":"https://api.github.com/users/roji/gists{/gist_id}","starred_url":"https://api.github.com/users/roji/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roji/subscriptions","organizations_url":"https://api.github.com/users/roji/orgs","repos_url":"https://api.github.com/users/roji/repos","events_url":"https://api.github.com/users/roji/events{/privacy}","received_events_url":"https://api.github.com/users/roji/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2023-11-27T11:23:33Z","label":{"name":"regression","color":"ff1fff"},"performed_via_github_app":null},{"id":11069723706,"node_id":"LE_lADOAPaMMs53dTiEzwAAAAKTzpQ6","url":"https://api.github.com/repos/dotnet/efcore/issues/events/11069723706","actor":{"login":"roji","id":1862641,"node_id":"MDQ6VXNlcjE4NjI2NDE=","avatar_url":"https://avatars.githubusercontent.com/u/1862641?v=4","gravatar_id":"","url":"https://api.github.com/users/roji","html_url":"https://github.com/roji","followers_url":"https://api.github.com/users/roji/followers","following_url":"https://api.github.com/users/roji/following{/other_user}","gists_url":"https://api.github.com/users/roji/gists{/gist_id}","starred_url":"https://api.github.com/users/roji/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roji/subscriptions","organizations_url":"https://api.github.com/users/roji/orgs","repos_url":"https://api.github.com/users/roji/repos","events_url":"https://api.github.com/users/roji/events{/privacy}","received_events_url":"https://api.github.com/users/roji/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2023-11-27T11:23:40Z","label":{"name":"area-query","color":"32b37b"},"performed_via_github_app":null},{"id":11069723716,"node_id":"LE_lADOAPaMMs53dTiEzwAAAAKTzpRE","url":"https://api.github.com/repos/dotnet/efcore/issues/events/11069723716","actor":{"login":"roji","id":1862641,"node_id":"MDQ6VXNlcjE4NjI2NDE=","avatar_url":"https://avatars.githubusercontent.com/u/1862641?v=4","gravatar_id":"","url":"https://api.github.com/users/roji","html_url":"https://github.com/roji","followers_url":"https://api.github.com/users/roji/followers","following_url":"https://api.github.com/users/roji/following{/other_user}","gists_url":"https://api.github.com/users/roji/gists{/gist_id}","starred_url":"https://api.github.com/users/roji/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roji/subscriptions","organizations_url":"https://api.github.com/users/roji/orgs","repos_url":"https://api.github.com/users/roji/repos","events_url":"https://api.github.com/users/roji/events{/privacy}","received_events_url":"https://api.github.com/users/roji/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2023-11-27T11:23:40Z","label":{"name":"area-primitive-collections","color":"32b37b"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/dotnet/efcore/issues/comments/1827708337","html_url":"https://github.com/dotnet/efcore/issues/32374#issuecomment-1827708337","issue_url":"https://api.github.com/repos/dotnet/efcore/issues/32374","id":1827708337,"node_id":"IC_kwDOAPaMMs5s8J2x","user":{"login":"roji","id":1862641,"node_id":"MDQ6VXNlcjE4NjI2NDE=","avatar_url":"https://avatars.githubusercontent.com/u/1862641?v=4","gravatar_id":"","url":"https://api.github.com/users/roji","html_url":"https://github.com/roji","followers_url":"https://api.github.com/users/roji/followers","following_url":"https://api.github.com/users/roji/following{/other_user}","gists_url":"https://api.github.com/users/roji/gists{/gist_id}","starred_url":"https://api.github.com/users/roji/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roji/subscriptions","organizations_url":"https://api.github.com/users/roji/orgs","repos_url":"https://api.github.com/users/roji/repos","events_url":"https://api.github.com/users/roji/events{/privacy}","received_events_url":"https://api.github.com/users/roji/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-11-27T12:07:24Z","updated_at":"2023-11-27T12:07:24Z","body":"Confirmed, this is indeed a limitation of SQL Server which we've run up against in the past (e.g. #26141).\r\n\r\n<details>\r\n<summary>Minimal repro</summary>\r\n\r\n```c#\r\nawait using var ctx = new BlogContext();\r\nawait ctx.Database.EnsureDeletedAsync();\r\nawait ctx.Database.EnsureCreatedAsync();\r\n\r\nvar shippedStatuses = new[] { \"Delivered\", \"Shipped\", \"Net\" };\r\n\r\n_ = ctx.Sales\r\n    .GroupBy(x => x.JournalId)\r\n    .Select(x => new\r\n    {\r\n        x.Key,\r\n        ShippedInOrder = x.Count(x => shippedStatuses.Contains(x.StatusNameLine)),\r\n    })\r\n    .SingleOrDefault();\r\n\r\npublic class BlogContext : DbContext\r\n{\r\n    public DbSet<SalesItem> Sales { get; set; }\r\n\r\n    protected override void OnConfiguring(DbContextOptionsBuilder optionsBuilder)\r\n        => optionsBuilder\r\n            .UseSqlServer(\"Server=localhost;Database=test;User=SA;Password=Abcd5678;Connect Timeout=60;ConnectRetryCount=0;Encrypt=false\")\r\n            .LogTo(Console.WriteLine, LogLevel.Information)\r\n            .EnableSensitiveDataLogging();\r\n}\r\n\r\npublic class SalesItem\r\n{\r\n    public int Id { get; set; }\r\n    public int JournalId { get; set; }\r\n    public string StatusNameLine { get; set; }\r\n}\r\n```\r\n\r\n</details>\r\n\r\nBasically it boils down to the following:\r\n\r\n```sql\r\nCREATE TABLE Blogs\r\n(\r\n    Id INT PRIMARY KEY IDENTITY,\r\n    Owner NVARCHAR(MAX),\r\n    Tag NVARCHAR(MAX)\r\n);\r\n\r\n-- The following works (approximates our old translation):\r\nSELECT Owner, COUNT(CASE WHEN Tag IN ('foo', 'bar') THEN 1 END) FROM Blogs GROUP BY Owner;\r\n\r\n-- The following fails (approximates our new translation):\r\nSELECT Owner, COUNT(CASE WHEN Tag IN (SELECT value FROM OPENJSON('[\"foo\", \"bar\"]')) THEN 1 END) FROM Blogs GROUP BY Owner;\r\n```\r\n\r\nThis works fine on PostgreSQL, SQLite and MariaDB, SQL Server is the only one not supporting this.\r\n\r\nOne workaround for this kind of case is to pull the filter out of the aggregate projection and have it as a WHERE clause (which gets evaluated before GROUP BY):\r\n\r\n```c#\r\n_ = ctx.Sales\r\n    .Where(x => shippedStatuses.Contains(x.StatusNameLine))\r\n    .GroupBy(x => x.JournalId)\r\n    .Select(x => new\r\n    {\r\n        x.Key,\r\n        ShippedInOrder = x.Count(),\r\n    })\r\n    .SingleOrDefault();\r\n```\r\n\r\nImportantly, this pre-filters out any non-matching rows, and so doesn't produce the same results - the original query returned rows for all Journals, whereas this one doesn't return rows for Journals with no matching Orders. However, if this is acceptable, it will work and may also be faster.\r\n\r\nTo mitigate this, we could detect when we're inside a aggregate expression, and refrain from translating Contains to OPENJSON for that specific case (revert to the old behavior). Note that this would still fail if the user tries anything other than a bare Contains operator on a parameterized collection, so it would be a very narrow workaround to prevent the Contains regression.","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/dotnet/efcore/issues/comments/1827708337/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"roji","id":1862641,"node_id":"MDQ6VXNlcjE4NjI2NDE=","avatar_url":"https://avatars.githubusercontent.com/u/1862641?v=4","gravatar_id":"","url":"https://api.github.com/users/roji","html_url":"https://github.com/roji","followers_url":"https://api.github.com/users/roji/followers","following_url":"https://api.github.com/users/roji/following{/other_user}","gists_url":"https://api.github.com/users/roji/gists{/gist_id}","starred_url":"https://api.github.com/users/roji/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roji/subscriptions","organizations_url":"https://api.github.com/users/roji/orgs","repos_url":"https://api.github.com/users/roji/repos","events_url":"https://api.github.com/users/roji/events{/privacy}","received_events_url":"https://api.github.com/users/roji/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/dotnet/efcore/issues/comments/1827781541","html_url":"https://github.com/dotnet/efcore/issues/32374#issuecomment-1827781541","issue_url":"https://api.github.com/repos/dotnet/efcore/issues/32374","id":1827781541,"node_id":"IC_kwDOAPaMMs5s8bul","user":{"login":"AlexeiScherbakov","id":8665915,"node_id":"MDQ6VXNlcjg2NjU5MTU=","avatar_url":"https://avatars.githubusercontent.com/u/8665915?v=4","gravatar_id":"","url":"https://api.github.com/users/AlexeiScherbakov","html_url":"https://github.com/AlexeiScherbakov","followers_url":"https://api.github.com/users/AlexeiScherbakov/followers","following_url":"https://api.github.com/users/AlexeiScherbakov/following{/other_user}","gists_url":"https://api.github.com/users/AlexeiScherbakov/gists{/gist_id}","starred_url":"https://api.github.com/users/AlexeiScherbakov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AlexeiScherbakov/subscriptions","organizations_url":"https://api.github.com/users/AlexeiScherbakov/orgs","repos_url":"https://api.github.com/users/AlexeiScherbakov/repos","events_url":"https://api.github.com/users/AlexeiScherbakov/events{/privacy}","received_events_url":"https://api.github.com/users/AlexeiScherbakov/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-11-27T12:55:08Z","updated_at":"2023-11-27T12:55:27Z","body":"Unfortunately this is just a minimal example of problem. Real queries are more complex - sales funnels calculations logic is \"mirrored\" from financial analysts.\r\nToday we have 2 logics with HashSet and Array which are translated to IN and OPENJSON.\r\nI see 3 ways:\r\n1. One-to-one matching (HashSet -> IN , Array -> OPENJSON or vice versa - don't know which matching is good)\r\n2. Some kind switch to current context (disable OPENJSON translation until switch is removed)\r\n```\r\nctx.SetSwitch(\"openjson_translation\",\"off\");\r\nawait ctx...\r\nctx.RemoveSwitch(\"openjson_translation\")\r\n```\r\n3. Query extension method\r\n```\r\nctx.Sales.WithoutOpenJsonTranslation().Select(...)\r\n```\r\n\r\nP.S. Current version **accidentally** implements 1 - and it is ok for me (I can choose what kind of translation I need with changing array<->HashSet. But it is classic [Bug/Feature](https://www.reddit.com/r/ProgrammerHumor/comments/1w1u3o/bug_vs_feature/). ","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/dotnet/efcore/issues/comments/1827781541/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"AlexeiScherbakov","id":8665915,"node_id":"MDQ6VXNlcjg2NjU5MTU=","avatar_url":"https://avatars.githubusercontent.com/u/8665915?v=4","gravatar_id":"","url":"https://api.github.com/users/AlexeiScherbakov","html_url":"https://github.com/AlexeiScherbakov","followers_url":"https://api.github.com/users/AlexeiScherbakov/followers","following_url":"https://api.github.com/users/AlexeiScherbakov/following{/other_user}","gists_url":"https://api.github.com/users/AlexeiScherbakov/gists{/gist_id}","starred_url":"https://api.github.com/users/AlexeiScherbakov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AlexeiScherbakov/subscriptions","organizations_url":"https://api.github.com/users/AlexeiScherbakov/orgs","repos_url":"https://api.github.com/users/AlexeiScherbakov/repos","events_url":"https://api.github.com/users/AlexeiScherbakov/events{/privacy}","received_events_url":"https://api.github.com/users/AlexeiScherbakov/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/dotnet/efcore/issues/comments/1828155469","html_url":"https://github.com/dotnet/efcore/issues/32374#issuecomment-1828155469","issue_url":"https://api.github.com/repos/dotnet/efcore/issues/32374","id":1828155469,"node_id":"IC_kwDOAPaMMs5s93BN","user":{"login":"roji","id":1862641,"node_id":"MDQ6VXNlcjE4NjI2NDE=","avatar_url":"https://avatars.githubusercontent.com/u/1862641?v=4","gravatar_id":"","url":"https://api.github.com/users/roji","html_url":"https://github.com/roji","followers_url":"https://api.github.com/users/roji/followers","following_url":"https://api.github.com/users/roji/following{/other_user}","gists_url":"https://api.github.com/users/roji/gists{/gist_id}","starred_url":"https://api.github.com/users/roji/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roji/subscriptions","organizations_url":"https://api.github.com/users/roji/orgs","repos_url":"https://api.github.com/users/roji/repos","events_url":"https://api.github.com/users/roji/events{/privacy}","received_events_url":"https://api.github.com/users/roji/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-11-27T16:15:02Z","updated_at":"2023-11-27T16:15:02Z","body":"If you're looking for a global opt-out from using OPENJSON (option 2), you can simply set the SQL Server compatibility level to a low value, [as detailed in the breaking changes notes](https://learn.microsoft.com/en-us/ef/core/what-is-new/ef-core-8.0/breaking-changes#sqlserver-contains-compatibility). In effect you'd be telling EF that it's targeting an old SQL Server which doesn't support OPENJSON (this doesn't currently affect other things).\r\n\r\nFor a per-query solution (3), I've submitted #32412 which adds EF.Constant, allowing integrating the array as a constant into the query tree; you would wrap your array parameter with EF.Constant (instead of WithoutOpenJsonTranslation), and this would produce the classical IN syntax (see https://github.com/dotnet/efcore/issues/32394#issuecomment-1825513906 for more info).\r\n\r\n","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/dotnet/efcore/issues/comments/1828155469/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"roji","id":1862641,"node_id":"MDQ6VXNlcjE4NjI2NDE=","avatar_url":"https://avatars.githubusercontent.com/u/1862641?v=4","gravatar_id":"","url":"https://api.github.com/users/roji","html_url":"https://github.com/roji","followers_url":"https://api.github.com/users/roji/followers","following_url":"https://api.github.com/users/roji/following{/other_user}","gists_url":"https://api.github.com/users/roji/gists{/gist_id}","starred_url":"https://api.github.com/users/roji/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roji/subscriptions","organizations_url":"https://api.github.com/users/roji/orgs","repos_url":"https://api.github.com/users/roji/repos","events_url":"https://api.github.com/users/roji/events{/privacy}","received_events_url":"https://api.github.com/users/roji/received_events","type":"User","user_view_type":"public","site_admin":false}},{"actor":{"login":"roji","id":1862641,"node_id":"MDQ6VXNlcjE4NjI2NDE=","avatar_url":"https://avatars.githubusercontent.com/u/1862641?v=4","gravatar_id":"","url":"https://api.github.com/users/roji","html_url":"https://github.com/roji","followers_url":"https://api.github.com/users/roji/followers","following_url":"https://api.github.com/users/roji/following{/other_user}","gists_url":"https://api.github.com/users/roji/gists{/gist_id}","starred_url":"https://api.github.com/users/roji/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roji/subscriptions","organizations_url":"https://api.github.com/users/roji/orgs","repos_url":"https://api.github.com/users/roji/repos","events_url":"https://api.github.com/users/roji/events{/privacy}","received_events_url":"https://api.github.com/users/roji/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-11-28T12:25:31Z","updated_at":"2023-11-28T12:25:31Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/dotnet/efcore/issues/32434","repository_url":"https://api.github.com/repos/dotnet/efcore","labels_url":"https://api.github.com/repos/dotnet/efcore/issues/32434/labels{/name}","comments_url":"https://api.github.com/repos/dotnet/efcore/issues/32434/comments","events_url":"https://api.github.com/repos/dotnet/efcore/issues/32434/events","html_url":"https://github.com/dotnet/efcore/pull/32434","id":2014325987,"node_id":"PR_kwDOAPaMMs5gjFYX","number":32434,"title":"[release/8.0] Allow opting out of new subquery translation for Contains","user":{"login":"roji","id":1862641,"node_id":"MDQ6VXNlcjE4NjI2NDE=","avatar_url":"https://avatars.githubusercontent.com/u/1862641?v=4","gravatar_id":"","url":"https://api.github.com/users/roji","html_url":"https://github.com/roji","followers_url":"https://api.github.com/users/roji/followers","following_url":"https://api.github.com/users/roji/following{/other_user}","gists_url":"https://api.github.com/users/roji/gists{/gist_id}","starred_url":"https://api.github.com/users/roji/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roji/subscriptions","organizations_url":"https://api.github.com/users/roji/orgs","repos_url":"https://api.github.com/users/roji/repos","events_url":"https://api.github.com/users/roji/events{/privacy}","received_events_url":"https://api.github.com/users/roji/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":1017558838,"node_id":"MDU6TGFiZWwxMDE3NTU4ODM4","url":"https://api.github.com/repos/dotnet/efcore/labels/Servicing-approved","name":"Servicing-approved","color":"048708","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":10,"created_at":"2023-11-28T12:25:30Z","updated_at":"2024-02-20T06:23:33Z","closed_at":"2024-01-03T22:37:29Z","author_association":"MEMBER","type":null,"active_lock_reason":null,"draft":false,"repository":{"id":16157746,"node_id":"MDEwOlJlcG9zaXRvcnkxNjE1Nzc0Ng==","name":"efcore","full_name":"dotnet/efcore","private":false,"owner":{"login":"dotnet","id":9141961,"node_id":"MDEyOk9yZ2FuaXphdGlvbjkxNDE5NjE=","avatar_url":"https://avatars.githubusercontent.com/u/9141961?v=4","gravatar_id":"","url":"https://api.github.com/users/dotnet","html_url":"https://github.com/dotnet","followers_url":"https://api.github.com/users/dotnet/followers","following_url":"https://api.github.com/users/dotnet/following{/other_user}","gists_url":"https://api.github.com/users/dotnet/gists{/gist_id}","starred_url":"https://api.github.com/users/dotnet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dotnet/subscriptions","organizations_url":"https://api.github.com/users/dotnet/orgs","repos_url":"https://api.github.com/users/dotnet/repos","events_url":"https://api.github.com/users/dotnet/events{/privacy}","received_events_url":"https://api.github.com/users/dotnet/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/dotnet/efcore","description":"EF Core is a modern object-database mapper for .NET. It supports LINQ queries, change tracking, updates, and schema migrations.","fork":false,"url":"https://api.github.com/repos/dotnet/efcore","forks_url":"https://api.github.com/repos/dotnet/efcore/forks","keys_url":"https://api.github.com/repos/dotnet/efcore/keys{/key_id}","collaborators_url":"https://api.github.com/repos/dotnet/efcore/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/dotnet/efcore/teams","hooks_url":"https://api.github.com/repos/dotnet/efcore/hooks","issue_events_url":"https://api.github.com/repos/dotnet/efcore/issues/events{/number}","events_url":"https://api.github.com/repos/dotnet/efcore/events","assignees_url":"https://api.github.com/repos/dotnet/efcore/assignees{/user}","branches_url":"https://api.github.com/repos/dotnet/efcore/branches{/branch}","tags_url":"https://api.github.com/repos/dotnet/efcore/tags","blobs_url":"https://api.github.com/repos/dotnet/efcore/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/dotnet/efcore/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/dotnet/efcore/git/refs{/sha}","trees_url":"https://api.github.com/repos/dotnet/efcore/git/trees{/sha}","statuses_url":"https://api.github.com/repos/dotnet/efcore/statuses/{sha}","languages_url":"https://api.github.com/repos/dotnet/efcore/languages","stargazers_url":"https://api.github.com/repos/dotnet/efcore/stargazers","contributors_url":"https://api.github.com/repos/dotnet/efcore/contributors","subscribers_url":"https://api.github.com/repos/dotnet/efcore/subscribers","subscription_url":"https://api.github.com/repos/dotnet/efcore/subscription","commits_url":"https://api.github.com/repos/dotnet/efcore/commits{/sha}","git_commits_url":"https://api.github.com/repos/dotnet/efcore/git/commits{/sha}","comments_url":"https://api.github.com/repos/dotnet/efcore/comments{/number}","issue_comment_url":"https://api.github.com/repos/dotnet/efcore/issues/comments{/number}","contents_url":"https://api.github.com/repos/dotnet/efcore/contents/{+path}","compare_url":"https://api.github.com/repos/dotnet/efcore/compare/{base}...{head}","merges_url":"https://api.github.com/repos/dotnet/efcore/merges","archive_url":"https://api.github.com/repos/dotnet/efcore/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/dotnet/efcore/downloads","issues_url":"https://api.github.com/repos/dotnet/efcore/issues{/number}","pulls_url":"https://api.github.com/repos/dotnet/efcore/pulls{/number}","milestones_url":"https://api.github.com/repos/dotnet/efcore/milestones{/number}","notifications_url":"https://api.github.com/repos/dotnet/efcore/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/dotnet/efcore/labels{/name}","releases_url":"https://api.github.com/repos/dotnet/efcore/releases{/id}","deployments_url":"https://api.github.com/repos/dotnet/efcore/deployments","created_at":"2014-01-23T00:52:01Z","updated_at":"2025-11-10T14:21:49Z","pushed_at":"2025-11-10T05:59:58Z","git_url":"git://github.com/dotnet/efcore.git","ssh_url":"git@github.com:dotnet/efcore.git","clone_url":"https://github.com/dotnet/efcore.git","svn_url":"https://github.com/dotnet/efcore","homepage":"https://learn.microsoft.com/ef/","size":215987,"stargazers_count":14455,"watchers_count":14455,"language":"C#","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":3324,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":2430,"license":{"key":"mit","name":"MIT License","spdx_id":"MIT","url":"https://api.github.com/licenses/mit","node_id":"MDc6TGljZW5zZTEz"},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["aspnet-product","c-sharp","database","dotnet-core","dotnet-framework","dotnet-standard","entity-framework","hacktoberfest","orm"],"visibility":"public","forks":3324,"open_issues":2430,"watchers":14455,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/dotnet/efcore/pulls/32434","html_url":"https://github.com/dotnet/efcore/pull/32434","diff_url":"https://github.com/dotnet/efcore/pull/32434.diff","patch_url":"https://github.com/dotnet/efcore/pull/32434.patch","merged_at":"2024-01-03T22:37:29Z"},"body":"Fixes #31552, backports #32412.\r\n\r\n### Description\r\n\r\nAs part of the new primitive collections support, EF8 translates the LINQ Contains operator using SQL subqueries (with e.g. OPENJSON on SQL Server) rather than the older and inefficient IN+constants translation. Although the new query shape is preferable, some edge cases have been flagged with it in terms of functionality and performance. This allows users to opt-out of the new translation on a per-query basis, going back to the old translation when needed.\r\n\r\n### Customer impact\r\n\r\nIn some edge cases, the new 8.0 Contains translation may be considerably less performant (#32394), or not supported by a specific database (#32374).\r\n\r\n### How found\r\n\r\nCustomer reported on 8.0\r\n\r\n### Regression\r\n\r\nYes\r\n\r\n### Testing\r\n\r\nAdded.\r\n\r\n### Risk\r\n\r\nVery low; quirk added.\r\n","reactions":{"url":"https://api.github.com/repos/dotnet/efcore/issues/32434/reactions","total_count":11,"+1":8,"-1":0,"laugh":0,"hooray":3,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/dotnet/efcore/issues/32434/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"id":11101744380,"node_id":"LE_lADOAPaMMs53dTiEzwAAAAKVtyz8","url":"https://api.github.com/repos/dotnet/efcore/issues/events/11101744380","actor":{"login":"ajcvickers","id":1430078,"node_id":"MDQ6VXNlcjE0MzAwNzg=","avatar_url":"https://avatars.githubusercontent.com/u/1430078?v=4","gravatar_id":"","url":"https://api.github.com/users/ajcvickers","html_url":"https://github.com/ajcvickers","followers_url":"https://api.github.com/users/ajcvickers/followers","following_url":"https://api.github.com/users/ajcvickers/following{/other_user}","gists_url":"https://api.github.com/users/ajcvickers/gists{/gist_id}","starred_url":"https://api.github.com/users/ajcvickers/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajcvickers/subscriptions","organizations_url":"https://api.github.com/users/ajcvickers/orgs","repos_url":"https://api.github.com/users/ajcvickers/repos","events_url":"https://api.github.com/users/ajcvickers/events{/privacy}","received_events_url":"https://api.github.com/users/ajcvickers/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2023-11-29T21:39:53Z","label":{"name":"Servicing-consider","color":"bfd4f2"},"performed_via_github_app":null},{"id":11109358218,"node_id":"AE_lADOAPaMMs53dTiEzwAAAAKWK1qK","url":"https://api.github.com/repos/dotnet/efcore/issues/events/11109358218","actor":{"login":"ajcvickers","id":1430078,"node_id":"MDQ6VXNlcjE0MzAwNzg=","avatar_url":"https://avatars.githubusercontent.com/u/1430078?v=4","gravatar_id":"","url":"https://api.github.com/users/ajcvickers","html_url":"https://github.com/ajcvickers","followers_url":"https://api.github.com/users/ajcvickers/followers","following_url":"https://api.github.com/users/ajcvickers/following{/other_user}","gists_url":"https://api.github.com/users/ajcvickers/gists{/gist_id}","starred_url":"https://api.github.com/users/ajcvickers/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajcvickers/subscriptions","organizations_url":"https://api.github.com/users/ajcvickers/orgs","repos_url":"https://api.github.com/users/ajcvickers/repos","events_url":"https://api.github.com/users/ajcvickers/events{/privacy}","received_events_url":"https://api.github.com/users/ajcvickers/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"assigned","commit_id":null,"commit_url":null,"created_at":"2023-11-30T13:49:47Z","assignee":{"login":"roji","id":1862641,"node_id":"MDQ6VXNlcjE4NjI2NDE=","avatar_url":"https://avatars.githubusercontent.com/u/1862641?v=4","gravatar_id":"","url":"https://api.github.com/users/roji","html_url":"https://github.com/roji","followers_url":"https://api.github.com/users/roji/followers","following_url":"https://api.github.com/users/roji/following{/other_user}","gists_url":"https://api.github.com/users/roji/gists{/gist_id}","starred_url":"https://api.github.com/users/roji/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roji/subscriptions","organizations_url":"https://api.github.com/users/roji/orgs","repos_url":"https://api.github.com/users/roji/repos","events_url":"https://api.github.com/users/roji/events{/privacy}","received_events_url":"https://api.github.com/users/roji/received_events","type":"User","user_view_type":"public","site_admin":false},"performed_via_github_app":null},{"id":11109359605,"node_id":"MIE_lADOAPaMMs53dTiEzwAAAAKWK1_1","url":"https://api.github.com/repos/dotnet/efcore/issues/events/11109359605","actor":{"login":"ajcvickers","id":1430078,"node_id":"MDQ6VXNlcjE0MzAwNzg=","avatar_url":"https://avatars.githubusercontent.com/u/1430078?v=4","gravatar_id":"","url":"https://api.github.com/users/ajcvickers","html_url":"https://github.com/ajcvickers","followers_url":"https://api.github.com/users/ajcvickers/followers","following_url":"https://api.github.com/users/ajcvickers/following{/other_user}","gists_url":"https://api.github.com/users/ajcvickers/gists{/gist_id}","starred_url":"https://api.github.com/users/ajcvickers/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajcvickers/subscriptions","organizations_url":"https://api.github.com/users/ajcvickers/orgs","repos_url":"https://api.github.com/users/ajcvickers/repos","events_url":"https://api.github.com/users/ajcvickers/events{/privacy}","received_events_url":"https://api.github.com/users/ajcvickers/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"milestoned","commit_id":null,"commit_url":null,"created_at":"2023-11-30T13:49:55Z","milestone":{"title":"8.0.x"},"performed_via_github_app":null},{"id":11121814180,"node_id":"REFE_lADOAPaMMs53dTiEzwAAAAKW6Wqk","url":"https://api.github.com/repos/dotnet/efcore/issues/events/11121814180","actor":{"login":"roji","id":1862641,"node_id":"MDQ6VXNlcjE4NjI2NDE=","avatar_url":"https://avatars.githubusercontent.com/u/1862641?v=4","gravatar_id":"","url":"https://api.github.com/users/roji","html_url":"https://github.com/roji","followers_url":"https://api.github.com/users/roji/followers","following_url":"https://api.github.com/users/roji/following{/other_user}","gists_url":"https://api.github.com/users/roji/gists{/gist_id}","starred_url":"https://api.github.com/users/roji/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roji/subscriptions","organizations_url":"https://api.github.com/users/roji/orgs","repos_url":"https://api.github.com/users/roji/repos","events_url":"https://api.github.com/users/roji/events{/privacy}","received_events_url":"https://api.github.com/users/roji/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"0eefa4b4bc04a58dca319c5d83c53f4526a4203e","commit_url":"https://api.github.com/repos/roji/efcore/commits/0eefa4b4bc04a58dca319c5d83c53f4526a4203e","created_at":"2023-12-01T12:46:11Z","performed_via_github_app":null},{"actor":{"login":"roji","id":1862641,"node_id":"MDQ6VXNlcjE4NjI2NDE=","avatar_url":"https://avatars.githubusercontent.com/u/1862641?v=4","gravatar_id":"","url":"https://api.github.com/users/roji","html_url":"https://github.com/roji","followers_url":"https://api.github.com/users/roji/followers","following_url":"https://api.github.com/users/roji/following{/other_user}","gists_url":"https://api.github.com/users/roji/gists{/gist_id}","starred_url":"https://api.github.com/users/roji/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roji/subscriptions","organizations_url":"https://api.github.com/users/roji/orgs","repos_url":"https://api.github.com/users/roji/repos","events_url":"https://api.github.com/users/roji/events{/privacy}","received_events_url":"https://api.github.com/users/roji/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-01T12:49:16Z","updated_at":"2023-12-01T12:49:16Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/dotnet/efcore/issues/32478","repository_url":"https://api.github.com/repos/dotnet/efcore","labels_url":"https://api.github.com/repos/dotnet/efcore/issues/32478/labels{/name}","comments_url":"https://api.github.com/repos/dotnet/efcore/issues/32478/comments","events_url":"https://api.github.com/repos/dotnet/efcore/issues/32478/events","html_url":"https://github.com/dotnet/efcore/pull/32478","id":2020820860,"node_id":"PR_kwDOAPaMMs5g5U3W","number":32478,"title":"Fix Contains within SQL Server aggregate functions","user":{"login":"roji","id":1862641,"node_id":"MDQ6VXNlcjE4NjI2NDE=","avatar_url":"https://avatars.githubusercontent.com/u/1862641?v=4","gravatar_id":"","url":"https://api.github.com/users/roji","html_url":"https://github.com/roji","followers_url":"https://api.github.com/users/roji/followers","following_url":"https://api.github.com/users/roji/following{/other_user}","gists_url":"https://api.github.com/users/roji/gists{/gist_id}","starred_url":"https://api.github.com/users/roji/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roji/subscriptions","organizations_url":"https://api.github.com/users/roji/orgs","repos_url":"https://api.github.com/users/roji/repos","events_url":"https://api.github.com/users/roji/events{/privacy}","received_events_url":"https://api.github.com/users/roji/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2023-12-01T12:49:15Z","updated_at":"2023-12-04T21:43:11Z","closed_at":"2023-12-04T21:43:10Z","author_association":"MEMBER","type":null,"active_lock_reason":null,"draft":false,"repository":{"id":16157746,"node_id":"MDEwOlJlcG9zaXRvcnkxNjE1Nzc0Ng==","name":"efcore","full_name":"dotnet/efcore","private":false,"owner":{"login":"dotnet","id":9141961,"node_id":"MDEyOk9yZ2FuaXphdGlvbjkxNDE5NjE=","avatar_url":"https://avatars.githubusercontent.com/u/9141961?v=4","gravatar_id":"","url":"https://api.github.com/users/dotnet","html_url":"https://github.com/dotnet","followers_url":"https://api.github.com/users/dotnet/followers","following_url":"https://api.github.com/users/dotnet/following{/other_user}","gists_url":"https://api.github.com/users/dotnet/gists{/gist_id}","starred_url":"https://api.github.com/users/dotnet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dotnet/subscriptions","organizations_url":"https://api.github.com/users/dotnet/orgs","repos_url":"https://api.github.com/users/dotnet/repos","events_url":"https://api.github.com/users/dotnet/events{/privacy}","received_events_url":"https://api.github.com/users/dotnet/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/dotnet/efcore","description":"EF Core is a modern object-database mapper for .NET. It supports LINQ queries, change tracking, updates, and schema migrations.","fork":false,"url":"https://api.github.com/repos/dotnet/efcore","forks_url":"https://api.github.com/repos/dotnet/efcore/forks","keys_url":"https://api.github.com/repos/dotnet/efcore/keys{/key_id}","collaborators_url":"https://api.github.com/repos/dotnet/efcore/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/dotnet/efcore/teams","hooks_url":"https://api.github.com/repos/dotnet/efcore/hooks","issue_events_url":"https://api.github.com/repos/dotnet/efcore/issues/events{/number}","events_url":"https://api.github.com/repos/dotnet/efcore/events","assignees_url":"https://api.github.com/repos/dotnet/efcore/assignees{/user}","branches_url":"https://api.github.com/repos/dotnet/efcore/branches{/branch}","tags_url":"https://api.github.com/repos/dotnet/efcore/tags","blobs_url":"https://api.github.com/repos/dotnet/efcore/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/dotnet/efcore/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/dotnet/efcore/git/refs{/sha}","trees_url":"https://api.github.com/repos/dotnet/efcore/git/trees{/sha}","statuses_url":"https://api.github.com/repos/dotnet/efcore/statuses/{sha}","languages_url":"https://api.github.com/repos/dotnet/efcore/languages","stargazers_url":"https://api.github.com/repos/dotnet/efcore/stargazers","contributors_url":"https://api.github.com/repos/dotnet/efcore/contributors","subscribers_url":"https://api.github.com/repos/dotnet/efcore/subscribers","subscription_url":"https://api.github.com/repos/dotnet/efcore/subscription","commits_url":"https://api.github.com/repos/dotnet/efcore/commits{/sha}","git_commits_url":"https://api.github.com/repos/dotnet/efcore/git/commits{/sha}","comments_url":"https://api.github.com/repos/dotnet/efcore/comments{/number}","issue_comment_url":"https://api.github.com/repos/dotnet/efcore/issues/comments{/number}","contents_url":"https://api.github.com/repos/dotnet/efcore/contents/{+path}","compare_url":"https://api.github.com/repos/dotnet/efcore/compare/{base}...{head}","merges_url":"https://api.github.com/repos/dotnet/efcore/merges","archive_url":"https://api.github.com/repos/dotnet/efcore/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/dotnet/efcore/downloads","issues_url":"https://api.github.com/repos/dotnet/efcore/issues{/number}","pulls_url":"https://api.github.com/repos/dotnet/efcore/pulls{/number}","milestones_url":"https://api.github.com/repos/dotnet/efcore/milestones{/number}","notifications_url":"https://api.github.com/repos/dotnet/efcore/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/dotnet/efcore/labels{/name}","releases_url":"https://api.github.com/repos/dotnet/efcore/releases{/id}","deployments_url":"https://api.github.com/repos/dotnet/efcore/deployments","created_at":"2014-01-23T00:52:01Z","updated_at":"2025-11-10T14:21:49Z","pushed_at":"2025-11-10T05:59:58Z","git_url":"git://github.com/dotnet/efcore.git","ssh_url":"git@github.com:dotnet/efcore.git","clone_url":"https://github.com/dotnet/efcore.git","svn_url":"https://github.com/dotnet/efcore","homepage":"https://learn.microsoft.com/ef/","size":215987,"stargazers_count":14455,"watchers_count":14455,"language":"C#","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":3324,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":2430,"license":{"key":"mit","name":"MIT License","spdx_id":"MIT","url":"https://api.github.com/licenses/mit","node_id":"MDc6TGljZW5zZTEz"},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["aspnet-product","c-sharp","database","dotnet-core","dotnet-framework","dotnet-standard","entity-framework","hacktoberfest","orm"],"visibility":"public","forks":3324,"open_issues":2430,"watchers":14455,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/dotnet/efcore/pulls/32478","html_url":"https://github.com/dotnet/efcore/pull/32478","diff_url":"https://github.com/dotnet/efcore/pull/32478.diff","patch_url":"https://github.com/dotnet/efcore/pull/32478.patch","merged_at":"2023-12-04T21:43:10Z"},"body":"This:\r\n\r\n* Adds tracking in SQL Server for when we're inside an aggregate method (Count, Max...). The flag was introduced on SqlServerQueryCompilationContext.\r\n    * This maybe isn't the ideal place, because the flag is only temporary translation state, and does not apply to all of compilation.\r\n    * But it's currently the only place shared across SqlServerQueryableMethodTranslatingExpressionVisitor and SqlServerSqlTranslatingExpressionVisitor. We can think about a better way to preserve state data across the different visitors during the translation process.\r\n* Then, if the flag is on and we see the new OPENJSON-based subquery translation for Contains, we convert it to the old IN+constants translations, as if the SQL Server compatibility level were too low.\r\n\r\nOne note: we could instead refrain from producing the OPENJSON translation altogether (return null from TranslatePrimitiveCollection), and let the general relational fallback produce the old IN+constants translation. But this would block simplifications that pattern-match on top of the OPENJSON translation (currently we only have TranslateElementOrDefault which does that for SQL Server).\r\n\r\nFixes #32374","reactions":{"url":"https://api.github.com/repos/dotnet/efcore/issues/32478/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/dotnet/efcore/issues/32478/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"id":11122074962,"node_id":"REFE_lADOAPaMMs53dTiEzwAAAAKW7WVS","url":"https://api.github.com/repos/dotnet/efcore/issues/events/11122074962","actor":{"login":"roji","id":1862641,"node_id":"MDQ6VXNlcjE4NjI2NDE=","avatar_url":"https://avatars.githubusercontent.com/u/1862641?v=4","gravatar_id":"","url":"https://api.github.com/users/roji","html_url":"https://github.com/roji","followers_url":"https://api.github.com/users/roji/followers","following_url":"https://api.github.com/users/roji/following{/other_user}","gists_url":"https://api.github.com/users/roji/gists{/gist_id}","starred_url":"https://api.github.com/users/roji/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roji/subscriptions","organizations_url":"https://api.github.com/users/roji/orgs","repos_url":"https://api.github.com/users/roji/repos","events_url":"https://api.github.com/users/roji/events{/privacy}","received_events_url":"https://api.github.com/users/roji/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"9def3dbd4ccdfa3d21a4fb80f3c5fe58d2472966","commit_url":"https://api.github.com/repos/roji/efcore/commits/9def3dbd4ccdfa3d21a4fb80f3c5fe58d2472966","created_at":"2023-12-01T13:12:58Z","performed_via_github_app":null},{"id":11128603356,"node_id":"REFE_lADOAPaMMs53dTiEzwAAAAKXUQLc","url":"https://api.github.com/repos/dotnet/efcore/issues/events/11128603356","actor":{"login":"roji","id":1862641,"node_id":"MDQ6VXNlcjE4NjI2NDE=","avatar_url":"https://avatars.githubusercontent.com/u/1862641?v=4","gravatar_id":"","url":"https://api.github.com/users/roji","html_url":"https://github.com/roji","followers_url":"https://api.github.com/users/roji/followers","following_url":"https://api.github.com/users/roji/following{/other_user}","gists_url":"https://api.github.com/users/roji/gists{/gist_id}","starred_url":"https://api.github.com/users/roji/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roji/subscriptions","organizations_url":"https://api.github.com/users/roji/orgs","repos_url":"https://api.github.com/users/roji/repos","events_url":"https://api.github.com/users/roji/events{/privacy}","received_events_url":"https://api.github.com/users/roji/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"facca739b6102aa6dd2983103deae6817a307937","commit_url":"https://api.github.com/repos/roji/efcore/commits/facca739b6102aa6dd2983103deae6817a307937","created_at":"2023-12-02T09:09:58Z","performed_via_github_app":null},{"id":11144811729,"node_id":"CE_lADOAPaMMs53dTiEzwAAAAKYSFTR","url":"https://api.github.com/repos/dotnet/efcore/issues/events/11144811729","actor":{"login":"roji","id":1862641,"node_id":"MDQ6VXNlcjE4NjI2NDE=","avatar_url":"https://avatars.githubusercontent.com/u/1862641?v=4","gravatar_id":"","url":"https://api.github.com/users/roji","html_url":"https://github.com/roji","followers_url":"https://api.github.com/users/roji/followers","following_url":"https://api.github.com/users/roji/following{/other_user}","gists_url":"https://api.github.com/users/roji/gists{/gist_id}","starred_url":"https://api.github.com/users/roji/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roji/subscriptions","organizations_url":"https://api.github.com/users/roji/orgs","repos_url":"https://api.github.com/users/roji/repos","events_url":"https://api.github.com/users/roji/events{/privacy}","received_events_url":"https://api.github.com/users/roji/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2023-12-04T21:43:11Z","state_reason":null,"performed_via_github_app":null},{"id":11144812923,"node_id":"REFE_lADOAPaMMs53dTiEzwAAAAKYSFl7","url":"https://api.github.com/repos/dotnet/efcore/issues/events/11144812923","actor":{"login":"roji","id":1862641,"node_id":"MDQ6VXNlcjE4NjI2NDE=","avatar_url":"https://avatars.githubusercontent.com/u/1862641?v=4","gravatar_id":"","url":"https://api.github.com/users/roji","html_url":"https://github.com/roji","followers_url":"https://api.github.com/users/roji/followers","following_url":"https://api.github.com/users/roji/following{/other_user}","gists_url":"https://api.github.com/users/roji/gists{/gist_id}","starred_url":"https://api.github.com/users/roji/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roji/subscriptions","organizations_url":"https://api.github.com/users/roji/orgs","repos_url":"https://api.github.com/users/roji/repos","events_url":"https://api.github.com/users/roji/events{/privacy}","received_events_url":"https://api.github.com/users/roji/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"cfcdf56110f9046db80ab8c02a50a65f7542e1bb","commit_url":"https://api.github.com/repos/dotnet/efcore/commits/cfcdf56110f9046db80ab8c02a50a65f7542e1bb","created_at":"2023-12-04T21:43:17Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/dotnet/efcore/issues/comments/1839528577","html_url":"https://github.com/dotnet/efcore/issues/32374#issuecomment-1839528577","issue_url":"https://api.github.com/repos/dotnet/efcore/issues/32374","id":1839528577,"node_id":"IC_kwDOAPaMMs5tpPqB","user":{"login":"roji","id":1862641,"node_id":"MDQ6VXNlcjE4NjI2NDE=","avatar_url":"https://avatars.githubusercontent.com/u/1862641?v=4","gravatar_id":"","url":"https://api.github.com/users/roji","html_url":"https://github.com/roji","followers_url":"https://api.github.com/users/roji/followers","following_url":"https://api.github.com/users/roji/following{/other_user}","gists_url":"https://api.github.com/users/roji/gists{/gist_id}","starred_url":"https://api.github.com/users/roji/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roji/subscriptions","organizations_url":"https://api.github.com/users/roji/orgs","repos_url":"https://api.github.com/users/roji/repos","events_url":"https://api.github.com/users/roji/events{/privacy}","received_events_url":"https://api.github.com/users/roji/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-04T21:43:27Z","updated_at":"2023-12-04T21:43:27Z","body":"Reopening to consider servicing.","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/dotnet/efcore/issues/comments/1839528577/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"roji","id":1862641,"node_id":"MDQ6VXNlcjE4NjI2NDE=","avatar_url":"https://avatars.githubusercontent.com/u/1862641?v=4","gravatar_id":"","url":"https://api.github.com/users/roji","html_url":"https://github.com/roji","followers_url":"https://api.github.com/users/roji/followers","following_url":"https://api.github.com/users/roji/following{/other_user}","gists_url":"https://api.github.com/users/roji/gists{/gist_id}","starred_url":"https://api.github.com/users/roji/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roji/subscriptions","organizations_url":"https://api.github.com/users/roji/orgs","repos_url":"https://api.github.com/users/roji/repos","events_url":"https://api.github.com/users/roji/events{/privacy}","received_events_url":"https://api.github.com/users/roji/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":11144815018,"node_id":"REE_lADOAPaMMs53dTiEzwAAAAKYSGGq","url":"https://api.github.com/repos/dotnet/efcore/issues/events/11144815018","actor":{"login":"roji","id":1862641,"node_id":"MDQ6VXNlcjE4NjI2NDE=","avatar_url":"https://avatars.githubusercontent.com/u/1862641?v=4","gravatar_id":"","url":"https://api.github.com/users/roji","html_url":"https://github.com/roji","followers_url":"https://api.github.com/users/roji/followers","following_url":"https://api.github.com/users/roji/following{/other_user}","gists_url":"https://api.github.com/users/roji/gists{/gist_id}","starred_url":"https://api.github.com/users/roji/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roji/subscriptions","organizations_url":"https://api.github.com/users/roji/orgs","repos_url":"https://api.github.com/users/roji/repos","events_url":"https://api.github.com/users/roji/events{/privacy}","received_events_url":"https://api.github.com/users/roji/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"reopened","commit_id":null,"commit_url":null,"created_at":"2023-12-04T21:43:27Z","state_reason":"reopened","performed_via_github_app":null},{"actor":{"login":"Montago","id":456040,"node_id":"MDQ6VXNlcjQ1NjA0MA==","avatar_url":"https://avatars.githubusercontent.com/u/456040?v=4","gravatar_id":"","url":"https://api.github.com/users/Montago","html_url":"https://github.com/Montago","followers_url":"https://api.github.com/users/Montago/followers","following_url":"https://api.github.com/users/Montago/following{/other_user}","gists_url":"https://api.github.com/users/Montago/gists{/gist_id}","starred_url":"https://api.github.com/users/Montago/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Montago/subscriptions","organizations_url":"https://api.github.com/users/Montago/orgs","repos_url":"https://api.github.com/users/Montago/repos","events_url":"https://api.github.com/users/Montago/events{/privacy}","received_events_url":"https://api.github.com/users/Montago/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-06T07:54:21Z","updated_at":"2023-12-06T07:54:21Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/dotnet/efcore/issues/32528","repository_url":"https://api.github.com/repos/dotnet/efcore","labels_url":"https://api.github.com/repos/dotnet/efcore/issues/32528/labels{/name}","comments_url":"https://api.github.com/repos/dotnet/efcore/issues/32528/comments","events_url":"https://api.github.com/repos/dotnet/efcore/issues/32528/events","html_url":"https://github.com/dotnet/efcore/issues/32528","id":2027868725,"node_id":"I_kwDOAPaMMs543tI1","number":32528,"title":"EF should probe compatibility_level (for MS SQL) and translate appropriately ","user":{"login":"Montago","id":456040,"node_id":"MDQ6VXNlcjQ1NjA0MA==","avatar_url":"https://avatars.githubusercontent.com/u/456040?v=4","gravatar_id":"","url":"https://api.github.com/users/Montago","html_url":"https://github.com/Montago","followers_url":"https://api.github.com/users/Montago/followers","following_url":"https://api.github.com/users/Montago/following{/other_user}","gists_url":"https://api.github.com/users/Montago/gists{/gist_id}","starred_url":"https://api.github.com/users/Montago/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Montago/subscriptions","organizations_url":"https://api.github.com/users/Montago/orgs","repos_url":"https://api.github.com/users/Montago/repos","events_url":"https://api.github.com/users/Montago/events{/privacy}","received_events_url":"https://api.github.com/users/Montago/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":936619505,"node_id":"MDU6TGFiZWw5MzY2MTk1MDU=","url":"https://api.github.com/repos/dotnet/efcore/labels/customer-reported","name":"customer-reported","color":"a4a5f9","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":12,"created_at":"2023-12-06T07:35:59Z","updated_at":"2024-01-12T14:31:58Z","closed_at":"2024-01-03T14:06:28Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"repository":{"id":16157746,"node_id":"MDEwOlJlcG9zaXRvcnkxNjE1Nzc0Ng==","name":"efcore","full_name":"dotnet/efcore","private":false,"owner":{"login":"dotnet","id":9141961,"node_id":"MDEyOk9yZ2FuaXphdGlvbjkxNDE5NjE=","avatar_url":"https://avatars.githubusercontent.com/u/9141961?v=4","gravatar_id":"","url":"https://api.github.com/users/dotnet","html_url":"https://github.com/dotnet","followers_url":"https://api.github.com/users/dotnet/followers","following_url":"https://api.github.com/users/dotnet/following{/other_user}","gists_url":"https://api.github.com/users/dotnet/gists{/gist_id}","starred_url":"https://api.github.com/users/dotnet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dotnet/subscriptions","organizations_url":"https://api.github.com/users/dotnet/orgs","repos_url":"https://api.github.com/users/dotnet/repos","events_url":"https://api.github.com/users/dotnet/events{/privacy}","received_events_url":"https://api.github.com/users/dotnet/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/dotnet/efcore","description":"EF Core is a modern object-database mapper for .NET. It supports LINQ queries, change tracking, updates, and schema migrations.","fork":false,"url":"https://api.github.com/repos/dotnet/efcore","forks_url":"https://api.github.com/repos/dotnet/efcore/forks","keys_url":"https://api.github.com/repos/dotnet/efcore/keys{/key_id}","collaborators_url":"https://api.github.com/repos/dotnet/efcore/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/dotnet/efcore/teams","hooks_url":"https://api.github.com/repos/dotnet/efcore/hooks","issue_events_url":"https://api.github.com/repos/dotnet/efcore/issues/events{/number}","events_url":"https://api.github.com/repos/dotnet/efcore/events","assignees_url":"https://api.github.com/repos/dotnet/efcore/assignees{/user}","branches_url":"https://api.github.com/repos/dotnet/efcore/branches{/branch}","tags_url":"https://api.github.com/repos/dotnet/efcore/tags","blobs_url":"https://api.github.com/repos/dotnet/efcore/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/dotnet/efcore/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/dotnet/efcore/git/refs{/sha}","trees_url":"https://api.github.com/repos/dotnet/efcore/git/trees{/sha}","statuses_url":"https://api.github.com/repos/dotnet/efcore/statuses/{sha}","languages_url":"https://api.github.com/repos/dotnet/efcore/languages","stargazers_url":"https://api.github.com/repos/dotnet/efcore/stargazers","contributors_url":"https://api.github.com/repos/dotnet/efcore/contributors","subscribers_url":"https://api.github.com/repos/dotnet/efcore/subscribers","subscription_url":"https://api.github.com/repos/dotnet/efcore/subscription","commits_url":"https://api.github.com/repos/dotnet/efcore/commits{/sha}","git_commits_url":"https://api.github.com/repos/dotnet/efcore/git/commits{/sha}","comments_url":"https://api.github.com/repos/dotnet/efcore/comments{/number}","issue_comment_url":"https://api.github.com/repos/dotnet/efcore/issues/comments{/number}","contents_url":"https://api.github.com/repos/dotnet/efcore/contents/{+path}","compare_url":"https://api.github.com/repos/dotnet/efcore/compare/{base}...{head}","merges_url":"https://api.github.com/repos/dotnet/efcore/merges","archive_url":"https://api.github.com/repos/dotnet/efcore/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/dotnet/efcore/downloads","issues_url":"https://api.github.com/repos/dotnet/efcore/issues{/number}","pulls_url":"https://api.github.com/repos/dotnet/efcore/pulls{/number}","milestones_url":"https://api.github.com/repos/dotnet/efcore/milestones{/number}","notifications_url":"https://api.github.com/repos/dotnet/efcore/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/dotnet/efcore/labels{/name}","releases_url":"https://api.github.com/repos/dotnet/efcore/releases{/id}","deployments_url":"https://api.github.com/repos/dotnet/efcore/deployments","created_at":"2014-01-23T00:52:01Z","updated_at":"2025-11-10T14:21:49Z","pushed_at":"2025-11-10T05:59:58Z","git_url":"git://github.com/dotnet/efcore.git","ssh_url":"git@github.com:dotnet/efcore.git","clone_url":"https://github.com/dotnet/efcore.git","svn_url":"https://github.com/dotnet/efcore","homepage":"https://learn.microsoft.com/ef/","size":215987,"stargazers_count":14455,"watchers_count":14455,"language":"C#","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":3324,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":2430,"license":{"key":"mit","name":"MIT License","spdx_id":"MIT","url":"https://api.github.com/licenses/mit","node_id":"MDc6TGljZW5zZTEz"},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["aspnet-product","c-sharp","database","dotnet-core","dotnet-framework","dotnet-standard","entity-framework","hacktoberfest","orm"],"visibility":"public","forks":3324,"open_issues":2430,"watchers":14455,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"body":"<!-- What problem are you trying to solve? -->\r\nEF8 introduces OPENJSON for Contains operations which isn't available in older versions of MSSQL. \r\n\r\nHaving to probe the MSSQL server for compatibility_level  when constructing DBContext ads complexity and increase learning curve for beginners. \r\n\r\n<!-- Describe the solution you'd like -->\r\nEF could probe the MSSQL server once for each program lifecycle and store the information in static variables for later instantiations. \r\neg. have a Dictionary of [String, Int] : ConnectionString -> compatibility_level  \r\n\r\nthis would most likely also solve other issues where EF translates to incompatible SQL. ","reactions":{"url":"https://api.github.com/repos/dotnet/efcore/issues/32528/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/dotnet/efcore/issues/32528/timeline","performed_via_github_app":null,"state_reason":"not_planned"}},"event":"cross-referenced"}]