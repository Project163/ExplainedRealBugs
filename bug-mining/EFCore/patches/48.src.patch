diff --git a/src/EFCore.Relational/Query/Internal/QueryableAggregateMethodTranslator.cs b/src/EFCore.Relational/Query/Internal/QueryableAggregateMethodTranslator.cs
index b0592ca732..1d1e922350 100644
--- a/src/EFCore.Relational/Query/Internal/QueryableAggregateMethodTranslator.cs
+++ b/src/EFCore.Relational/Query/Internal/QueryableAggregateMethodTranslator.cs
@@ -79,27 +79,24 @@ public QueryableAggregateMethodTranslator(ISqlExpressionFactory sqlExpressionFac
                     || methodInfo == QueryableMethods.CountWithPredicate:
                     var countSqlExpression = (source.Selector as SqlExpression) ?? _sqlExpressionFactory.Fragment("*");
                     countSqlExpression = CombineTerms(source, countSqlExpression);
-                    return _sqlExpressionFactory.ApplyDefaultTypeMapping(
-                        _sqlExpressionFactory.Function(
-                            "COUNT",
-                            new[] { countSqlExpression },
-                            nullable: false,
-                            argumentsPropagateNullability: new[] { false },
-                            typeof(int)));
+                    return _sqlExpressionFactory.Function(
+                        "COUNT",
+                        new[] { countSqlExpression },
+                        nullable: false,
+                        argumentsPropagateNullability: new[] { false },
+                        typeof(int));
 
                 case nameof(Queryable.LongCount)
                 when methodInfo == QueryableMethods.LongCountWithoutPredicate
                     || methodInfo == QueryableMethods.LongCountWithPredicate:
                     var longCountSqlExpression = (source.Selector as SqlExpression) ?? _sqlExpressionFactory.Fragment("*");
                     longCountSqlExpression = CombineTerms(source, longCountSqlExpression);
-
-                    return _sqlExpressionFactory.ApplyDefaultTypeMapping(
-                        _sqlExpressionFactory.Function(
-                            "COUNT",
-                            new[] { longCountSqlExpression },
-                            nullable: false,
-                            argumentsPropagateNullability: new[] { false },
-                            typeof(long)));
+                    return _sqlExpressionFactory.Function(
+                        "COUNT",
+                        new[] { longCountSqlExpression },
+                        nullable: false,
+                        argumentsPropagateNullability: new[] { false },
+                        typeof(long));
 
                 case nameof(Queryable.Max)
                 when (methodInfo == QueryableMethods.MaxWithoutSelector
@@ -107,12 +104,12 @@ public QueryableAggregateMethodTranslator(ISqlExpressionFactory sqlExpressionFac
                     && source.Selector is SqlExpression maxSqlExpression:
                     maxSqlExpression = CombineTerms(source, maxSqlExpression);
                     return _sqlExpressionFactory.Function(
-                            "MAX",
-                            new[] { maxSqlExpression },
-                            nullable: true,
-                            argumentsPropagateNullability: new[] { false },
-                            maxSqlExpression.Type,
-                            maxSqlExpression.TypeMapping);
+                        "MAX",
+                        new[] { maxSqlExpression },
+                        nullable: true,
+                        argumentsPropagateNullability: new[] { false },
+                        maxSqlExpression.Type,
+                        maxSqlExpression.TypeMapping);
 
                 case nameof(Queryable.Min)
                 when (methodInfo == QueryableMethods.MinWithoutSelector
@@ -120,12 +117,12 @@ public QueryableAggregateMethodTranslator(ISqlExpressionFactory sqlExpressionFac
                     && source.Selector is SqlExpression minSqlExpression:
                     minSqlExpression = CombineTerms(source, minSqlExpression);
                     return _sqlExpressionFactory.Function(
-                            "MIN",
-                            new[] { minSqlExpression },
-                            nullable: true,
-                            argumentsPropagateNullability: new[] { false },
-                            minSqlExpression.Type,
-                            minSqlExpression.TypeMapping);
+                        "MIN",
+                        new[] { minSqlExpression },
+                        nullable: true,
+                        argumentsPropagateNullability: new[] { false },
+                        minSqlExpression.Type,
+                        minSqlExpression.TypeMapping);
 
                 case nameof(Queryable.Sum)
                 when (QueryableMethods.IsSumWithoutSelector(methodInfo)
diff --git a/src/EFCore.Relational/Query/RelationalQueryableMethodTranslatingExpressionVisitor.cs b/src/EFCore.Relational/Query/RelationalQueryableMethodTranslatingExpressionVisitor.cs
index c1f94c9a06..7cc54407f0 100644
--- a/src/EFCore.Relational/Query/RelationalQueryableMethodTranslatingExpressionVisitor.cs
+++ b/src/EFCore.Relational/Query/RelationalQueryableMethodTranslatingExpressionVisitor.cs
@@ -236,8 +236,7 @@ private static ShapedQueryExpression CreateShapedQueryExpression(IEntityType ent
         ShapedQueryExpression source,
         LambdaExpression? selector,
         Type resultType)
-        => TranslateAggregateWithSelector(
-            source, selector, e => TranslateAverage(e), throwWhenEmpty: true, resultType);
+        => TranslateAggregateWithSelector(source, selector, QueryableMethods.GetAverageWithoutSelector, throwWhenEmpty: true, resultType);
 
     /// <inheritdoc />
     protected override ShapedQueryExpression? TranslateCast(ShapedQueryExpression source, Type resultType)
@@ -301,7 +300,7 @@ private static ShapedQueryExpression CreateShapedQueryExpression(IEntityType ent
 
     /// <inheritdoc />
     protected override ShapedQueryExpression? TranslateCount(ShapedQueryExpression source, LambdaExpression? predicate)
-        => TranslateAggregateWithPredicate(source, predicate, e => TranslateCount(e), typeof(int));
+        => TranslateAggregateWithPredicate(source, predicate, QueryableMethods.CountWithoutPredicate);
 
     /// <inheritdoc />
     protected override ShapedQueryExpression? TranslateDefaultIfEmpty(ShapedQueryExpression source, Expression? defaultValue)
@@ -386,16 +385,7 @@ private static ShapedQueryExpression CreateShapedQueryExpression(IEntityType ent
         LambdaExpression? resultSelector)
     {
         var selectExpression = (SelectExpression)source.QueryExpression;
-        // This has it's own set of condition since it is different scenario from below.
-        // Aggregate operators need pushdown for skip/limit/offset covered by selectExpression.PrepareForAggregate.
-        // Aggregate operators need special processing beyond pushdown when applying over group by for client eval.
-        if (selectExpression.Limit != null
-            || selectExpression.Offset != null
-            || selectExpression.IsDistinct
-            || selectExpression.GroupBy.Count > 0)
-        {
-            selectExpression.PushdownIntoSubquery();
-        }
+        selectExpression.PrepareForAggregate();
 
         var remappedKeySelector = RemapLambdaBody(source, keySelector);
         var translatedKey = TranslateGroupingKey(remappedKeySelector);
@@ -623,15 +613,17 @@ private SqlExpression CreateJoinPredicate(Expression outerKey, Expression innerK
 
     /// <inheritdoc />
     protected override ShapedQueryExpression? TranslateLongCount(ShapedQueryExpression source, LambdaExpression? predicate)
-        => TranslateAggregateWithPredicate(source, predicate, e => TranslateLongCount(e), typeof(long));
+        => TranslateAggregateWithPredicate(source, predicate, QueryableMethods.LongCountWithoutPredicate);
 
     /// <inheritdoc />
     protected override ShapedQueryExpression? TranslateMax(ShapedQueryExpression source, LambdaExpression? selector, Type resultType)
-        => TranslateAggregateWithSelector(source, selector, e => TranslateMax(e), throwWhenEmpty: true, resultType);
+        => TranslateAggregateWithSelector(
+            source, selector, t => QueryableMethods.MaxWithoutSelector.MakeGenericMethod(t), throwWhenEmpty: true, resultType);
 
     /// <inheritdoc />
     protected override ShapedQueryExpression? TranslateMin(ShapedQueryExpression source, LambdaExpression? selector, Type resultType)
-        => TranslateAggregateWithSelector(source, selector, e => TranslateMin(e), throwWhenEmpty: true, resultType);
+        => TranslateAggregateWithSelector(
+            source, selector, t => QueryableMethods.MinWithoutSelector.MakeGenericMethod(t), throwWhenEmpty: true, resultType);
 
     /// <inheritdoc />
     protected override ShapedQueryExpression? TranslateOfType(ShapedQueryExpression source, Type resultType)
@@ -888,7 +880,7 @@ protected override Expression VisitMethodCall(MethodCallExpression methodCallExp
 
     /// <inheritdoc />
     protected override ShapedQueryExpression? TranslateSum(ShapedQueryExpression source, LambdaExpression? selector, Type resultType)
-        => TranslateAggregateWithSelector(source, selector, e => TranslateSum(e), throwWhenEmpty: false, resultType);
+        => TranslateAggregateWithSelector(source, selector, QueryableMethods.GetSumWithoutSelector, throwWhenEmpty: false, resultType);
 
     /// <inheritdoc />
     protected override ShapedQueryExpression? TranslateTake(ShapedQueryExpression source, Expression count)
@@ -954,7 +946,12 @@ protected override Expression VisitMethodCall(MethodCallExpression methodCallExp
         return source;
     }
 
-    private SqlExpression? TranslateExpression(Expression expression)
+    /// <summary>
+    ///     Translates the given expression into equivalent SQL representation.
+    /// </summary>
+    /// <param name="expression">An expression to translate.</param>
+    /// <returns>A <see cref="SqlExpression"/> which is translation of given expression or <see langword="null"/>.</returns>
+    protected virtual SqlExpression? TranslateExpression(Expression expression)
     {
         var translation = _sqlTranslator.Translate(expression);
         if (translation == null && _sqlTranslator.TranslationErrorDetails != null)
@@ -965,7 +962,13 @@ protected override Expression VisitMethodCall(MethodCallExpression methodCallExp
         return translation;
     }
 
-    private SqlExpression? TranslateLambdaExpression(
+    /// <summary>
+    ///     Translates the given lambda expression for the <see cref="ShapedQueryExpression"/> source into equivalent SQL representation.
+    /// </summary>
+    /// <param name="shapedQueryExpression">A <see cref="ShapedQueryExpression"/> on which the lambda expression is being applied.</param>
+    /// <param name="lambdaExpression">A <see cref="LambdaExpression"/> to translate into SQL.</param>
+    /// <returns>A <see cref="SqlExpression"/> which is translation of given lambda expression or <see langword="null"/>.</returns>
+    protected virtual SqlExpression? TranslateLambdaExpression(
         ShapedQueryExpression shapedQueryExpression,
         LambdaExpression lambdaExpression)
         => TranslateExpression(RemapLambdaBody(shapedQueryExpression, lambdaExpression));
@@ -1465,45 +1468,11 @@ private static Expression MatchShaperNullabilityForSetOperation(Expression shape
         }
     }
 
-    private SqlExpression? TranslateAverage(SqlExpression sqlExpression)
-        => RelationalDependencies.AggregateMethodCallTranslatorProvider.Translate(
-            RelationalDependencies.Model, QueryableMethods.GetAverageWithoutSelector(sqlExpression.Type),
-            new EnumerableExpression(sqlExpression), Array.Empty<SqlExpression>(), _queryCompilationContext.Logger);
-
-    private SqlExpression? TranslateCount(SqlExpression sqlExpression)
-        => RelationalDependencies.AggregateMethodCallTranslatorProvider.Translate(
-            RelationalDependencies.Model, QueryableMethods.CountWithoutPredicate,
-            new EnumerableExpression(sqlExpression), Array.Empty<SqlExpression>(), _queryCompilationContext.Logger);
-
-    private SqlExpression? TranslateLongCount(SqlExpression sqlExpression)
-        => RelationalDependencies.AggregateMethodCallTranslatorProvider.Translate(
-            RelationalDependencies.Model, QueryableMethods.LongCountWithoutPredicate,
-            new EnumerableExpression(sqlExpression), Array.Empty<SqlExpression>(), _queryCompilationContext.Logger);
-
-    private SqlExpression? TranslateMax(SqlExpression sqlExpression)
-        => RelationalDependencies.AggregateMethodCallTranslatorProvider.Translate(
-            RelationalDependencies.Model, QueryableMethods.MaxWithoutSelector,
-            new EnumerableExpression(sqlExpression), Array.Empty<SqlExpression>(), _queryCompilationContext.Logger);
-
-    private SqlExpression? TranslateMin(SqlExpression sqlExpression)
-        => RelationalDependencies.AggregateMethodCallTranslatorProvider.Translate(
-            RelationalDependencies.Model, QueryableMethods.MinWithoutSelector,
-            new EnumerableExpression(sqlExpression), Array.Empty<SqlExpression>(), _queryCompilationContext.Logger);
-
-    private SqlExpression? TranslateSum(SqlExpression sqlExpression)
-        => RelationalDependencies.AggregateMethodCallTranslatorProvider.Translate(
-            RelationalDependencies.Model, QueryableMethods.GetSumWithoutSelector(sqlExpression.Type),
-            new EnumerableExpression(sqlExpression), Array.Empty<SqlExpression>(), _queryCompilationContext.Logger);
-
     private ShapedQueryExpression? TranslateAggregateWithPredicate(
         ShapedQueryExpression source,
         LambdaExpression? predicate,
-        Func<SqlExpression, SqlExpression?> aggregateTranslator,
-        Type resultType)
+        MethodInfo predicateLessMethodInfo)
     {
-        var selectExpression = (SelectExpression)source.QueryExpression;
-        selectExpression.PrepareForAggregate();
-
         if (predicate != null)
         {
             var translatedSource = TranslateWhere(source, predicate);
@@ -1515,9 +1484,19 @@ private static Expression MatchShaperNullabilityForSetOperation(Expression shape
             source = translatedSource;
         }
 
-        HandleGroupByForAggregate(selectExpression, eraseProjection: true);
+        var selectExpression = (SelectExpression)source.QueryExpression;
+        if (!selectExpression.IsDistinct)
+        {
+            selectExpression.ReplaceProjection(new List<Expression>());
+        }
 
-        var translation = aggregateTranslator(_sqlExpressionFactory.Fragment("*"));
+        selectExpression.PrepareForAggregate();
+        var selector = _sqlExpressionFactory.Fragment("*");
+        var methodCall = Expression.Call(
+            predicateLessMethodInfo.MakeGenericMethod(selector.Type),
+            Expression.Call(
+                QueryableMethods.AsQueryable.MakeGenericMethod(selector.Type), new EnumerableExpression(selector)));
+        var translation = TranslateExpression(methodCall);
         if (translation == null)
         {
             return null;
@@ -1527,6 +1506,7 @@ private static Expression MatchShaperNullabilityForSetOperation(Expression shape
 
         selectExpression.ClearOrdering();
         selectExpression.ReplaceProjection(projectionMapping);
+        var resultType = predicateLessMethodInfo.ReturnType;
 
         return source.UpdateShaperExpression(
             Expression.Convert(
@@ -1536,18 +1516,17 @@ private static Expression MatchShaperNullabilityForSetOperation(Expression shape
 
     private ShapedQueryExpression? TranslateAggregateWithSelector(
         ShapedQueryExpression source,
-        LambdaExpression? selector,
-        Func<SqlExpression, SqlExpression?> aggregateTranslator,
+        LambdaExpression? selectorLambda,
+        Func<Type, MethodInfo> methodGenerator,
         bool throwWhenEmpty,
         Type resultType)
     {
         var selectExpression = (SelectExpression)source.QueryExpression;
         selectExpression.PrepareForAggregate();
-        HandleGroupByForAggregate(selectExpression);
 
-        SqlExpression translatedSelector;
-        if (selector == null
-            || selector.Body == selector.Parameters[0])
+        Expression? selector = null;
+        if (selectorLambda == null
+            || selectorLambda.Body == selectorLambda.Parameters[0])
         {
             var shaperExpression = source.ShaperExpression;
             if (shaperExpression is UnaryExpression unaryExpression
@@ -1558,34 +1537,32 @@ private static Expression MatchShaperNullabilityForSetOperation(Expression shape
 
             if (shaperExpression is ProjectionBindingExpression projectionBindingExpression)
             {
-                translatedSelector = (SqlExpression)selectExpression.GetProjection(projectionBindingExpression);
-            }
-            else
-            {
-                return null;
+                selector = selectExpression.GetProjection(projectionBindingExpression);
             }
         }
         else
         {
-            var newSelector = RemapLambdaBody(source, selector);
-            if (TranslateExpression(newSelector) is SqlExpression sqlExpression)
-            {
-                translatedSelector = sqlExpression;
-            }
-            else
-            {
-                return null;
-            }
+            selector = RemapLambdaBody(source, selectorLambda);
+        }
+
+        if (selector == null
+            || TranslateExpression(selector) is not SqlExpression translatedSelector)
+        {
+            return null;
         }
 
-        var projection = aggregateTranslator(translatedSelector);
-        if (projection == null)
+        var methodCall = Expression.Call(
+            methodGenerator(translatedSelector.Type),
+            Expression.Call(
+                QueryableMethods.AsQueryable.MakeGenericMethod(translatedSelector.Type), new EnumerableExpression(translatedSelector)));
+        var translation = _sqlTranslator.Translate(methodCall);
+        if (translation == null)
         {
             return null;
         }
 
         selectExpression.ReplaceProjection(
-            new Dictionary<ProjectionMember, Expression> { { new ProjectionMember(), projection } });
+            new Dictionary<ProjectionMember, Expression> { { new ProjectionMember(), translation } });
 
         selectExpression.ClearOrdering();
         Expression shaper;
@@ -1602,7 +1579,7 @@ private static Expression MatchShaperNullabilityForSetOperation(Expression shape
             var resultVariable = Expression.Variable(nullableResultType, "result");
             var returnValueForNull = resultType.IsNullableType()
                 ? (Expression)Expression.Constant(null, resultType)
-                : projection.Type.IsNullableType()
+                : translation.Type.IsNullableType()
                     ? Expression.Default(resultType)
                     : Expression.Throw(
                         Expression.New(
@@ -1624,7 +1601,7 @@ private static Expression MatchShaperNullabilityForSetOperation(Expression shape
         else
         {
             // Sum case. Projection is always non-null. We read nullable value.
-            shaper = new ProjectionBindingExpression(source.QueryExpression, new ProjectionMember(), projection.Type.MakeNullable());
+            shaper = new ProjectionBindingExpression(source.QueryExpression, new ProjectionMember(), translation.Type.MakeNullable());
 
             if (resultType != shaper.Type)
             {
diff --git a/src/EFCore.Relational/Query/RelationalQueryableMethodTranslatingExpressionVisitorDependencies.cs b/src/EFCore.Relational/Query/RelationalQueryableMethodTranslatingExpressionVisitorDependencies.cs
index ad3fd864ba..9fb23b65d9 100644
--- a/src/EFCore.Relational/Query/RelationalQueryableMethodTranslatingExpressionVisitorDependencies.cs
+++ b/src/EFCore.Relational/Query/RelationalQueryableMethodTranslatingExpressionVisitorDependencies.cs
@@ -47,14 +47,10 @@ public sealed record RelationalQueryableMethodTranslatingExpressionVisitorDepend
     [EntityFrameworkInternal]
     public RelationalQueryableMethodTranslatingExpressionVisitorDependencies(
         IRelationalSqlTranslatingExpressionVisitorFactory relationalSqlTranslatingExpressionVisitorFactory,
-        ISqlExpressionFactory sqlExpressionFactory,
-        IModel model,
-        IAggregateMethodCallTranslatorProvider aggregateMethodCallTranslatorProvider)
+        ISqlExpressionFactory sqlExpressionFactory)
     {
         RelationalSqlTranslatingExpressionVisitorFactory = relationalSqlTranslatingExpressionVisitorFactory;
         SqlExpressionFactory = sqlExpressionFactory;
-        Model = model;
-        AggregateMethodCallTranslatorProvider = aggregateMethodCallTranslatorProvider;
     }
 
     /// <summary>
@@ -66,14 +62,4 @@ public sealed record RelationalQueryableMethodTranslatingExpressionVisitorDepend
     ///     The SQL expression factory.
     /// </summary>
     public ISqlExpressionFactory SqlExpressionFactory { get; init; }
-
-    /// <summary>
-    ///     The model.
-    /// </summary>
-    public IModel Model { get; init; }
-
-    /// <summary>
-    ///     The aggregate method-call translation provider.
-    /// </summary>
-    public IAggregateMethodCallTranslatorProvider AggregateMethodCallTranslatorProvider { get; }
 }
diff --git a/src/EFCore.Relational/Query/RelationalSqlTranslatingExpressionVisitor.cs b/src/EFCore.Relational/Query/RelationalSqlTranslatingExpressionVisitor.cs
index a31edeb424..7718bb9de6 100644
--- a/src/EFCore.Relational/Query/RelationalSqlTranslatingExpressionVisitor.cs
+++ b/src/EFCore.Relational/Query/RelationalSqlTranslatingExpressionVisitor.cs
@@ -598,8 +598,12 @@ protected override Expression VisitExtension(Expression extensionExpression)
             case EntityProjectionExpression:
             case EntityReferenceExpression:
             case SqlExpression:
+            case EnumerableExpression:
                 return extensionExpression;
 
+            case RelationalGroupByShaperExpression relationalGroupByShaperExpression:
+                return new EnumerableExpression(relationalGroupByShaperExpression.ElementSelector);
+
             case EntityShaperExpression entityShaperExpression:
                 return new EntityReferenceExpression(entityShaperExpression);
 
@@ -788,11 +792,6 @@ protected override Expression VisitMethodCall(MethodCallExpression methodCallExp
                 var genericMethod = method.IsGenericMethod
                     ? method.GetGenericMethodDefinition()
                     : method;
-                if (genericMethod == QueryableMethods.AsQueryable
-                    && arguments[0] is RelationalGroupByShaperExpression groupByShaperExpression)
-                {
-                    return new EnumerableExpression(groupByShaperExpression.ElementSelector);
-                }
 
                 var enumerableSource = Visit(arguments[0]);
                 if (enumerableSource is EnumerableExpression)
@@ -800,6 +799,10 @@ protected override Expression VisitMethodCall(MethodCallExpression methodCallExp
                     enumerableExpression = (EnumerableExpression)enumerableSource;
                     switch (method.Name)
                     {
+                        case nameof(Queryable.AsQueryable)
+                        when genericMethod == QueryableMethods.AsQueryable:
+                            return enumerableExpression;
+
                         case nameof(Queryable.Average)
                         when QueryableMethods.IsAverageWithoutSelector(genericMethod):
                         case nameof(Queryable.Max)
diff --git a/src/EFCore.Relational/Query/SqlExpressions/SelectExpression.cs b/src/EFCore.Relational/Query/SqlExpressions/SelectExpression.cs
index 541a5c8e95..da0497f784 100644
--- a/src/EFCore.Relational/Query/SqlExpressions/SelectExpression.cs
+++ b/src/EFCore.Relational/Query/SqlExpressions/SelectExpression.cs
@@ -3150,7 +3150,8 @@ public void PrepareForAggregate()
     {
         if (IsDistinct
             || Limit != null
-            || Offset != null)
+            || Offset != null
+            || _groupBy.Count > 0)
         {
             PushdownIntoSubquery();
         }
diff --git a/test/EFCore.SqlServer.FunctionalTests/Query/ComplexNavigationsQuerySqlServerTest.cs b/test/EFCore.SqlServer.FunctionalTests/Query/ComplexNavigationsQuerySqlServerTest.cs
index 16b29bc9f3..52e830f319 100644
--- a/test/EFCore.SqlServer.FunctionalTests/Query/ComplexNavigationsQuerySqlServerTest.cs
+++ b/test/EFCore.SqlServer.FunctionalTests/Query/ComplexNavigationsQuerySqlServerTest.cs
@@ -2051,7 +2051,7 @@ public override async Task GroupJoin_in_subquery_with_client_projection_nested1(
 WHERE (
     SELECT COUNT(*)
     FROM (
-        SELECT TOP(10) [l0].[Id], [l0].[Date], [l0].[Name], [l0].[OneToMany_Optional_Self_Inverse1Id], [l0].[OneToMany_Required_Self_Inverse1Id], [l0].[OneToOne_Optional_Self1Id], [l1].[Id] AS [Id0], [l1].[Date] AS [Date0], [l1].[Level1_Optional_Id], [l1].[Level1_Required_Id], [l1].[Name] AS [Name0], [l1].[OneToMany_Optional_Inverse2Id], [l1].[OneToMany_Optional_Self_Inverse2Id], [l1].[OneToMany_Required_Inverse2Id], [l1].[OneToMany_Required_Self_Inverse2Id], [l1].[OneToOne_Optional_PK_Inverse2Id], [l1].[OneToOne_Optional_Self2Id]
+        SELECT TOP(10) [l0].[Id], [l1].[Id] AS [Id0]
         FROM [LevelOne] AS [l0]
         LEFT JOIN [LevelTwo] AS [l1] ON [l0].[Id] = [l1].[Level1_Optional_Id]
         WHERE (
diff --git a/test/EFCore.SqlServer.FunctionalTests/Query/ComplexNavigationsSharedTypeQuerySqlServerTest.cs b/test/EFCore.SqlServer.FunctionalTests/Query/ComplexNavigationsSharedTypeQuerySqlServerTest.cs
index cbddfdd68f..fdb96315aa 100644
--- a/test/EFCore.SqlServer.FunctionalTests/Query/ComplexNavigationsSharedTypeQuerySqlServerTest.cs
+++ b/test/EFCore.SqlServer.FunctionalTests/Query/ComplexNavigationsSharedTypeQuerySqlServerTest.cs
@@ -6997,7 +6997,7 @@ public override async Task GroupJoin_in_subquery_with_client_projection_nested1(
 WHERE (
     SELECT COUNT(*)
     FROM (
-        SELECT TOP(10) [l0].[Id], [l0].[Date], [l0].[Name], [t0].[Id] AS [Id0], [t0].[Date] AS [Date0], [t0].[Name] AS [Name0], [t0].[Id0] AS [Id00], [t0].[OneToOne_Required_PK_Date], [t0].[Level1_Optional_Id], [t0].[Level1_Required_Id], [t0].[Level2_Name], [t0].[OneToMany_Optional_Inverse2Id], [t0].[OneToMany_Required_Inverse2Id], [t0].[OneToOne_Optional_PK_Inverse2Id]
+        SELECT TOP(10) [l0].[Id], [t0].[Id] AS [Id0], [t0].[Id0] AS [Id00]
         FROM [Level1] AS [l0]
         LEFT JOIN (
             SELECT [l1].[Id], [l1].[Date], [l1].[Name], [t].[Id] AS [Id0], [t].[OneToOne_Required_PK_Date], [t].[Level1_Optional_Id], [t].[Level1_Required_Id], [t].[Level2_Name], [t].[OneToMany_Optional_Inverse2Id], [t].[OneToMany_Required_Inverse2Id], [t].[OneToOne_Optional_PK_Inverse2Id]
diff --git a/test/EFCore.SqlServer.FunctionalTests/Query/NorthwindAggregateOperatorsQuerySqlServerTest.cs b/test/EFCore.SqlServer.FunctionalTests/Query/NorthwindAggregateOperatorsQuerySqlServerTest.cs
index b8a69c2964..b4b793b398 100644
--- a/test/EFCore.SqlServer.FunctionalTests/Query/NorthwindAggregateOperatorsQuerySqlServerTest.cs
+++ b/test/EFCore.SqlServer.FunctionalTests/Query/NorthwindAggregateOperatorsQuerySqlServerTest.cs
@@ -2124,7 +2124,7 @@ public override async Task Count_after_client_projection(bool async)
 
 SELECT COUNT(*)
 FROM (
-    SELECT TOP(@__p_0) [o].[OrderID], [o].[CustomerID], [o].[EmployeeID], [o].[OrderDate]
+    SELECT TOP(@__p_0) [o].[OrderID]
     FROM [Orders] AS [o]
 ) AS [t]");
     }
diff --git a/test/EFCore.SqlServer.FunctionalTests/Query/NorthwindMiscellaneousQuerySqlServerTest.cs b/test/EFCore.SqlServer.FunctionalTests/Query/NorthwindMiscellaneousQuerySqlServerTest.cs
index 8e569ca0f2..8a57dc4cc8 100644
--- a/test/EFCore.SqlServer.FunctionalTests/Query/NorthwindMiscellaneousQuerySqlServerTest.cs
+++ b/test/EFCore.SqlServer.FunctionalTests/Query/NorthwindMiscellaneousQuerySqlServerTest.cs
@@ -1281,7 +1281,7 @@ public override async Task OrderBy_Take_Count(bool async)
 
 SELECT COUNT(*)
 FROM (
-    SELECT TOP(@__p_0) [o].[OrderID], [o].[CustomerID], [o].[EmployeeID], [o].[OrderDate]
+    SELECT TOP(@__p_0) [o].[OrderID]
     FROM [Orders] AS [o]
     ORDER BY [o].[OrderID]
 ) AS [t]");
@@ -3644,8 +3644,8 @@ public override async Task Anonymous_member_distinct_result(bool async)
 FROM (
     SELECT DISTINCT [c].[CustomerID]
     FROM [Customers] AS [c]
-) AS [t]
-WHERE [t].[CustomerID] LIKE N'A%'");
+    WHERE [c].[CustomerID] LIKE N'A%'
+) AS [t]");
     }
 
     public override async Task Anonymous_complex_distinct_where(bool async)
@@ -3680,8 +3680,8 @@ public override async Task Anonymous_complex_distinct_result(bool async)
 FROM (
     SELECT DISTINCT [c].[CustomerID] + COALESCE([c].[City], N'') AS [A]
     FROM [Customers] AS [c]
-) AS [t]
-WHERE [t].[A] IS NOT NULL AND ([t].[A] LIKE N'A%')");
+    WHERE [c].[CustomerID] + COALESCE([c].[City], N'') LIKE N'A%'
+) AS [t]");
     }
 
     public override async Task Anonymous_complex_orderby(bool async)
@@ -3748,8 +3748,8 @@ public override async Task DTO_member_distinct_result(bool async)
 FROM (
     SELECT DISTINCT [c].[CustomerID] AS [Property]
     FROM [Customers] AS [c]
-) AS [t]
-WHERE [t].[Property] LIKE N'A%'");
+    WHERE [c].[CustomerID] LIKE N'A%'
+) AS [t]");
     }
 
     public override async Task DTO_complex_distinct_where(bool async)
@@ -3784,8 +3784,8 @@ public override async Task DTO_complex_distinct_result(bool async)
 FROM (
     SELECT DISTINCT [c].[CustomerID] + COALESCE([c].[City], N'') AS [Property]
     FROM [Customers] AS [c]
-) AS [t]
-WHERE [t].[Property] IS NOT NULL AND ([t].[Property] LIKE N'A%')");
+    WHERE [c].[CustomerID] + COALESCE([c].[City], N'') LIKE N'A%'
+) AS [t]");
     }
 
     public override async Task DTO_complex_orderby(bool async)
@@ -3900,7 +3900,7 @@ public override async Task Select_take_count(bool async)
 
 SELECT COUNT(*)
 FROM (
-    SELECT TOP(@__p_0) [c].[CustomerID], [c].[Address], [c].[City], [c].[CompanyName], [c].[ContactName], [c].[ContactTitle], [c].[Country], [c].[Fax], [c].[Phone], [c].[PostalCode], [c].[Region]
+    SELECT TOP(@__p_0) [c].[CustomerID]
     FROM [Customers] AS [c]
 ) AS [t]");
     }
@@ -3914,7 +3914,7 @@ public override async Task Select_orderBy_take_count(bool async)
 
 SELECT COUNT(*)
 FROM (
-    SELECT TOP(@__p_0) [c].[CustomerID], [c].[Address], [c].[City], [c].[CompanyName], [c].[ContactName], [c].[ContactTitle], [c].[Country], [c].[Fax], [c].[Phone], [c].[PostalCode], [c].[Region]
+    SELECT TOP(@__p_0) [c].[CustomerID], [c].[Country]
     FROM [Customers] AS [c]
     ORDER BY [c].[Country]
 ) AS [t]");
@@ -3929,7 +3929,7 @@ public override async Task Select_take_long_count(bool async)
 
 SELECT COUNT_BIG(*)
 FROM (
-    SELECT TOP(@__p_0) [c].[CustomerID], [c].[Address], [c].[City], [c].[CompanyName], [c].[ContactName], [c].[ContactTitle], [c].[Country], [c].[Fax], [c].[Phone], [c].[PostalCode], [c].[Region]
+    SELECT TOP(@__p_0) [c].[CustomerID]
     FROM [Customers] AS [c]
 ) AS [t]");
     }
@@ -3943,7 +3943,7 @@ public override async Task Select_orderBy_take_long_count(bool async)
 
 SELECT COUNT_BIG(*)
 FROM (
-    SELECT TOP(@__p_0) [c].[CustomerID], [c].[Address], [c].[City], [c].[CompanyName], [c].[ContactName], [c].[ContactTitle], [c].[Country], [c].[Fax], [c].[Phone], [c].[PostalCode], [c].[Region]
+    SELECT TOP(@__p_0) [c].[CustomerID], [c].[Country]
     FROM [Customers] AS [c]
     ORDER BY [c].[Country]
 ) AS [t]");
@@ -4019,7 +4019,7 @@ public override async Task Select_skip_count(bool async)
 
 SELECT COUNT(*)
 FROM (
-    SELECT [c].[CustomerID], [c].[Address], [c].[City], [c].[CompanyName], [c].[ContactName], [c].[ContactTitle], [c].[Country], [c].[Fax], [c].[Phone], [c].[PostalCode], [c].[Region]
+    SELECT [c].[CustomerID]
     FROM [Customers] AS [c]
     ORDER BY (SELECT 1)
     OFFSET @__p_0 ROWS
@@ -4035,7 +4035,7 @@ public override async Task Select_orderBy_skip_count(bool async)
 
 SELECT COUNT(*)
 FROM (
-    SELECT [c].[CustomerID], [c].[Address], [c].[City], [c].[CompanyName], [c].[ContactName], [c].[ContactTitle], [c].[Country], [c].[Fax], [c].[Phone], [c].[PostalCode], [c].[Region]
+    SELECT [c].[CustomerID], [c].[Country]
     FROM [Customers] AS [c]
     ORDER BY [c].[Country]
     OFFSET @__p_0 ROWS
@@ -4051,7 +4051,7 @@ public override async Task Select_skip_long_count(bool async)
 
 SELECT COUNT_BIG(*)
 FROM (
-    SELECT [c].[CustomerID], [c].[Address], [c].[City], [c].[CompanyName], [c].[ContactName], [c].[ContactTitle], [c].[Country], [c].[Fax], [c].[Phone], [c].[PostalCode], [c].[Region]
+    SELECT [c].[CustomerID]
     FROM [Customers] AS [c]
     ORDER BY (SELECT 1)
     OFFSET @__p_0 ROWS
@@ -4067,7 +4067,7 @@ public override async Task Select_orderBy_skip_long_count(bool async)
 
 SELECT COUNT_BIG(*)
 FROM (
-    SELECT [c].[CustomerID], [c].[Address], [c].[City], [c].[CompanyName], [c].[ContactName], [c].[ContactTitle], [c].[Country], [c].[Fax], [c].[Phone], [c].[PostalCode], [c].[Region]
+    SELECT [c].[CustomerID], [c].[Country]
     FROM [Customers] AS [c]
     ORDER BY [c].[Country]
     OFFSET @__p_0 ROWS
@@ -4439,10 +4439,10 @@ public override async Task Join_take_count_works(bool async)
 
 SELECT COUNT(*)
 FROM (
-    SELECT TOP(@__p_0) [o].[OrderID], [o].[CustomerID], [o].[EmployeeID], [o].[OrderDate], [t].[CustomerID] AS [CustomerID0], [t].[Address], [t].[City], [t].[CompanyName], [t].[ContactName], [t].[ContactTitle], [t].[Country], [t].[Fax], [t].[Phone], [t].[PostalCode], [t].[Region]
+    SELECT TOP(@__p_0) [o].[OrderID], [t].[CustomerID]
     FROM [Orders] AS [o]
     INNER JOIN (
-        SELECT [c].[CustomerID], [c].[Address], [c].[City], [c].[CompanyName], [c].[ContactName], [c].[ContactTitle], [c].[Country], [c].[Fax], [c].[Phone], [c].[PostalCode], [c].[Region]
+        SELECT [c].[CustomerID]
         FROM [Customers] AS [c]
         WHERE [c].[CustomerID] = N'ALFKI'
     ) AS [t] ON [o].[CustomerID] = [t].[CustomerID]
diff --git a/test/EFCore.Sqlite.FunctionalTests/Query/NorthwindMiscellaneousQuerySqliteTest.cs b/test/EFCore.Sqlite.FunctionalTests/Query/NorthwindMiscellaneousQuerySqliteTest.cs
index a96568ed48..ce780e19e2 100644
--- a/test/EFCore.Sqlite.FunctionalTests/Query/NorthwindMiscellaneousQuerySqliteTest.cs
+++ b/test/EFCore.Sqlite.FunctionalTests/Query/NorthwindMiscellaneousQuerySqliteTest.cs
@@ -207,7 +207,7 @@ public override async Task Select_orderBy_skip_long_count(bool async)
 
 SELECT COUNT(*)
 FROM (
-    SELECT ""c"".""CustomerID"", ""c"".""Address"", ""c"".""City"", ""c"".""CompanyName"", ""c"".""ContactName"", ""c"".""ContactTitle"", ""c"".""Country"", ""c"".""Fax"", ""c"".""Phone"", ""c"".""PostalCode"", ""c"".""Region""
+    SELECT ""c"".""CustomerID"", ""c"".""Country""
     FROM ""Customers"" AS ""c""
     ORDER BY ""c"".""Country""
     LIMIT -1 OFFSET @__p_0
@@ -223,7 +223,7 @@ public override async Task Select_orderBy_take_long_count(bool async)
 
 SELECT COUNT(*)
 FROM (
-    SELECT ""c"".""CustomerID"", ""c"".""Address"", ""c"".""City"", ""c"".""CompanyName"", ""c"".""ContactName"", ""c"".""ContactTitle"", ""c"".""Country"", ""c"".""Fax"", ""c"".""Phone"", ""c"".""PostalCode"", ""c"".""Region""
+    SELECT ""c"".""CustomerID"", ""c"".""Country""
     FROM ""Customers"" AS ""c""
     ORDER BY ""c"".""Country""
     LIMIT @__p_0
@@ -239,7 +239,7 @@ public override async Task Select_skip_long_count(bool async)
 
 SELECT COUNT(*)
 FROM (
-    SELECT ""c"".""CustomerID"", ""c"".""Address"", ""c"".""City"", ""c"".""CompanyName"", ""c"".""ContactName"", ""c"".""ContactTitle"", ""c"".""Country"", ""c"".""Fax"", ""c"".""Phone"", ""c"".""PostalCode"", ""c"".""Region""
+    SELECT ""c"".""CustomerID""
     FROM ""Customers"" AS ""c""
     LIMIT -1 OFFSET @__p_0
 ) AS ""t""");
@@ -254,7 +254,7 @@ public override async Task Select_take_long_count(bool async)
 
 SELECT COUNT(*)
 FROM (
-    SELECT ""c"".""CustomerID"", ""c"".""Address"", ""c"".""City"", ""c"".""CompanyName"", ""c"".""ContactName"", ""c"".""ContactTitle"", ""c"".""Country"", ""c"".""Fax"", ""c"".""Phone"", ""c"".""PostalCode"", ""c"".""Region""
+    SELECT ""c"".""CustomerID""
     FROM ""Customers"" AS ""c""
     LIMIT @__p_0
 ) AS ""t""");
