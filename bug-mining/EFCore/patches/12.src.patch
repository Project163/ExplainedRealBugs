diff --git a/test/EFCore.Cosmos.FunctionalTests/Query/NorthwindKeylessEntitiesQueryCosmosTest.cs b/test/EFCore.Cosmos.FunctionalTests/Query/NorthwindKeylessEntitiesQueryCosmosTest.cs
index cd8de23f70..5f3253d47e 100644
--- a/test/EFCore.Cosmos.FunctionalTests/Query/NorthwindKeylessEntitiesQueryCosmosTest.cs
+++ b/test/EFCore.Cosmos.FunctionalTests/Query/NorthwindKeylessEntitiesQueryCosmosTest.cs
@@ -41,13 +41,13 @@ public override async Task KeylessEntity_where_simple(bool async)
 WHERE ((c[""Discriminator""] = ""Customer"") AND (c[""City""] = ""London""))");
     }
 
-    public override void KeylessEntity_by_database_view()
+    public override async Task KeylessEntity_by_database_view(bool async)
     {
         // Views are not supported.
         Assert.Equal(
             "0",
-            Assert.Throws<EqualException>(
-                () => base.KeylessEntity_by_database_view()).Actual);
+            (await Assert.ThrowsAsync<EqualException>(
+                () => base.KeylessEntity_by_database_view(async))).Actual);
 
         AssertSql(
             @"SELECT c
@@ -55,24 +55,19 @@ public override void KeylessEntity_by_database_view()
 WHERE (c[""Discriminator""] = ""ProductView"")");
     }
 
-    public override void Entity_mapped_to_view_on_right_side_of_join()
+    public override async Task Entity_mapped_to_view_on_right_side_of_join(bool async)
     {
-        AssertTranslationFailed(
-            () =>
-            {
-                base.Entity_mapped_to_view_on_right_side_of_join();
-                return Task.CompletedTask;
-            });
+        await AssertTranslationFailed(() => base.Entity_mapped_to_view_on_right_side_of_join(async));
 
         AssertSql();
     }
 
-    public override void KeylessEntity_with_nav_defining_query()
+    public override async Task KeylessEntity_with_nav_defining_query(bool async)
     {
         Assert.Equal(
             "0",
-            Assert.Throws<EqualException>(
-                () => base.KeylessEntity_with_nav_defining_query()).Actual);
+            (await Assert.ThrowsAsync <EqualException>(
+                () => base.KeylessEntity_with_nav_defining_query(async))).Actual);
 
         AssertSql(
             @"SELECT c
@@ -154,9 +149,9 @@ public override async Task Collection_correlated_with_keyless_entity_in_predicat
         AssertSql();
     }
 
-    public override void Auto_initialized_view_set()
+    public override async Task Auto_initialized_view_set(bool async)
     {
-        base.Auto_initialized_view_set();
+        await base.Auto_initialized_view_set(async);
 
         AssertSql(
             @"SELECT c
diff --git a/test/EFCore.Cosmos.FunctionalTests/Query/NorthwindMiscellaneousQueryCosmosTest.cs b/test/EFCore.Cosmos.FunctionalTests/Query/NorthwindMiscellaneousQueryCosmosTest.cs
index 45f98bcdef..29fb5a5eed 100644
--- a/test/EFCore.Cosmos.FunctionalTests/Query/NorthwindMiscellaneousQueryCosmosTest.cs
+++ b/test/EFCore.Cosmos.FunctionalTests/Query/NorthwindMiscellaneousQueryCosmosTest.cs
@@ -38,15 +38,9 @@ public virtual async Task Simple_IQueryable(bool async)
 WHERE (c[""Discriminator""] = ""Customer"")");
     }
 
-    public override void Shaper_command_caching_when_parameter_names_different()
+    public override async Task Shaper_command_caching_when_parameter_names_different(bool async)
     {
-        // Cosmos client evaluation. Issue #17246.
-        AssertTranslationFailed(
-            () =>
-            {
-                base.Shaper_command_caching_when_parameter_names_different();
-                return Task.CompletedTask;
-            });
+        await base.Shaper_command_caching_when_parameter_names_different(async);
 
         AssertSql(
             @"SELECT COUNT(1) AS c
@@ -58,28 +52,18 @@ public override void Shaper_command_caching_when_parameter_names_different()
 WHERE ((c[""Discriminator""] = ""Customer"") AND (c[""CustomerID""] = ""ALFKI""))");
     }
 
-    public override void Lifting_when_subquery_nested_order_by_anonymous()
+    public override async Task Lifting_when_subquery_nested_order_by_anonymous(bool async)
     {
         // Cosmos client evaluation. Issue #17246.
-        AssertTranslationFailed(
-            () =>
-            {
-                base.Lifting_when_subquery_nested_order_by_anonymous();
-                return Task.CompletedTask;
-            });
+        await AssertTranslationFailed(() => base.Lifting_when_subquery_nested_order_by_anonymous(async));
 
         AssertSql();
     }
 
-    public override void Lifting_when_subquery_nested_order_by_simple()
+    public override async Task Lifting_when_subquery_nested_order_by_simple(bool async)
     {
         // Cosmos client evaluation. Issue #17246.
-        AssertTranslationFailed(
-            () =>
-            {
-                base.Lifting_when_subquery_nested_order_by_simple();
-                return Task.CompletedTask;
-            });
+        await AssertTranslationFailed(() => base.Lifting_when_subquery_nested_order_by_simple(async));
 
         AssertSql();
     }
@@ -180,15 +164,10 @@ public override async Task Entity_equality_not_null(bool async)
 WHERE ((c[""Discriminator""] = ""Customer"") AND (c[""CustomerID""] != null))");
     }
 
-    public override void Query_when_evaluatable_queryable_method_call_with_repository()
+    public override async Task Query_when_evaluatable_queryable_method_call_with_repository(bool async)
     {
         // Cosmos client evaluation. Issue #17246.
-        AssertTranslationFailed(
-            () =>
-            {
-                base.Query_when_evaluatable_queryable_method_call_with_repository();
-                return Task.CompletedTask;
-            });
+        await AssertTranslationFailed(() => base.Query_when_evaluatable_queryable_method_call_with_repository(async));
 
         AssertSql();
     }
@@ -398,54 +377,34 @@ public override async Task Where_query_composition2_FirstOrDefault_with_anonymou
         AssertSql();
     }
 
-    public override void Select_Subquery_Single()
+    public override async Task Select_Subquery_Single(bool async)
     {
         // Cross collection join. Issue #17246.
-        AssertTranslationFailed(
-            () =>
-            {
-                base.Select_Subquery_Single();
-                return Task.CompletedTask;
-            });
+        await AssertTranslationFailed(() => base.Select_Subquery_Single(async));
 
         AssertSql();
     }
 
-    public override void Select_Where_Subquery_Deep_Single()
+    public override async Task Select_Where_Subquery_Deep_Single(bool async)
     {
         // Cosmos client evaluation. Issue #17246.
-        AssertTranslationFailed(
-            () =>
-            {
-                base.Select_Where_Subquery_Deep_Single();
-                return Task.CompletedTask;
-            });
+        await AssertTranslationFailed(() => base.Select_Where_Subquery_Deep_Single(async));
 
         AssertSql();
     }
 
-    public override void Select_Where_Subquery_Deep_First()
+    public override async Task Select_Where_Subquery_Deep_First(bool async)
     {
         // Cosmos client evaluation. Issue #17246.
-        AssertTranslationFailed(
-            () =>
-            {
-                base.Select_Where_Subquery_Deep_First();
-                return Task.CompletedTask;
-            });
+        await AssertTranslationFailed(() => base.Select_Where_Subquery_Deep_First(async));
 
         AssertSql();
     }
 
-    public override void Select_Where_Subquery_Equality()
+    public override async Task Select_Where_Subquery_Equality(bool async)
     {
         // Cosmos client evaluation. Issue #17246.
-        AssertTranslationFailed(
-            () =>
-            {
-                base.Select_Where_Subquery_Equality();
-                return Task.CompletedTask;
-            });
+        await AssertTranslationFailed(() => base.Select_Where_Subquery_Equality(async));
 
         AssertSql();
     }
@@ -521,15 +480,10 @@ public override async Task OrderBy_ternary_conditions(bool async)
 ORDER BY ((c[""UnitsInStock""] > 10) ? (c[""ProductID""] > 40) : (c[""ProductID""] <= 40)), c[""ProductID""]");
     }
 
-    public override void OrderBy_any()
+    public override async Task OrderBy_any(bool async)
     {
         // Cosmos client evaluation. Issue #17246.
-        AssertTranslationFailed(
-            () =>
-            {
-                base.OrderBy_any();
-                return Task.CompletedTask;
-            });
+        await AssertTranslationFailed(() => base.OrderBy_any(async));
 
         AssertSql();
     }
@@ -841,15 +795,10 @@ public override async Task Any_nested3(bool async)
         AssertSql();
     }
 
-    public override void Any_with_multiple_conditions_still_uses_exists()
+    public override async Task Any_with_multiple_conditions_still_uses_exists(bool async)
     {
         // Cosmos client evaluation. Issue #17246.
-        AssertTranslationFailed(
-            () =>
-            {
-                base.Any_with_multiple_conditions_still_uses_exists();
-                return Task.CompletedTask;
-            });
+        await AssertTranslationFailed(() => base.Any_with_multiple_conditions_still_uses_exists(async));
 
         AssertSql();
     }
@@ -1485,15 +1434,9 @@ public override async Task Where_subquery_expression_same_parametername(bool asy
 OFFSET 0 LIMIT 1");
     }
 
-    public override void Select_DTO_distinct_translated_to_server()
+    public override async Task Select_DTO_distinct_translated_to_server(bool async)
     {
-        // Cosmos client evaluation. Issue #17246.
-        AssertTranslationFailed(
-            () =>
-            {
-                base.Select_DTO_distinct_translated_to_server();
-                return Task.CompletedTask;
-            });
+        await base.Select_DTO_distinct_translated_to_server(async);
 
         AssertSql(
             @"SELECT DISTINCT 1
@@ -1501,15 +1444,9 @@ public override void Select_DTO_distinct_translated_to_server()
 WHERE ((c[""Discriminator""] = ""Order"") AND (c[""OrderID""] < 10300))");
     }
 
-    public override void Select_DTO_constructor_distinct_translated_to_server()
+    public override async Task Select_DTO_constructor_distinct_translated_to_server(bool async)
     {
-        // Cosmos client evaluation. Issue #17246.
-        AssertTranslationFailed(
-            () =>
-            {
-                base.Select_DTO_constructor_distinct_translated_to_server();
-                return Task.CompletedTask;
-            });
+        await base.Select_DTO_constructor_distinct_translated_to_server(async);
 
         AssertSql(
             @"SELECT DISTINCT c[""CustomerID""]
@@ -1517,15 +1454,9 @@ public override void Select_DTO_constructor_distinct_translated_to_server()
 WHERE ((c[""Discriminator""] = ""Order"") AND (c[""OrderID""] < 10300))");
     }
 
-    public override void Select_DTO_with_member_init_distinct_translated_to_server()
+    public override async Task Select_DTO_with_member_init_distinct_translated_to_server(bool async)
     {
-        // Cosmos client evaluation. Issue #17246.
-        AssertTranslationFailed(
-            () =>
-            {
-                base.Select_DTO_with_member_init_distinct_translated_to_server();
-                return Task.CompletedTask;
-            });
+        await base.Select_DTO_with_member_init_distinct_translated_to_server(async);
 
         AssertSql(
             @"SELECT DISTINCT VALUE {""Id"" : c[""CustomerID""], ""Count"" : c[""OrderID""]}
@@ -1533,15 +1464,10 @@ public override void Select_DTO_with_member_init_distinct_translated_to_server()
 WHERE ((c[""Discriminator""] = ""Order"") AND (c[""OrderID""] < 10300))");
     }
 
-    public override void Select_nested_collection_count_using_DTO()
+    public override async Task Select_nested_collection_count_using_DTO(bool async)
     {
         // Cosmos client evaluation. Issue #17246.
-        AssertTranslationFailed(
-            () =>
-            {
-                base.Select_nested_collection_count_using_DTO();
-                return Task.CompletedTask;
-            });
+        await AssertTranslationFailed(() => base.Select_nested_collection_count_using_DTO(async));
 
         AssertSql();
     }
@@ -1554,15 +1480,11 @@ public override async Task Select_DTO_with_member_init_distinct_in_subquery_tran
         AssertSql();
     }
 
-    public override void Select_DTO_with_member_init_distinct_in_subquery_used_in_projection_translated_to_server()
+    public override async Task Select_DTO_with_member_init_distinct_in_subquery_used_in_projection_translated_to_server(bool async)
     {
         // Cosmos client evaluation. Issue #17246.
-        AssertTranslationFailed(
-            () =>
-            {
-                base.Select_DTO_with_member_init_distinct_in_subquery_used_in_projection_translated_to_server();
-                return Task.CompletedTask;
-            });
+        await AssertTranslationFailed(
+            () => base.Select_DTO_with_member_init_distinct_in_subquery_used_in_projection_translated_to_server(async));
 
         AssertSql();
     }
@@ -1762,15 +1684,11 @@ public override async Task Select_take_skip_null_coalesce_operator3(bool async)
         AssertSql();
     }
 
-    public override void Selected_column_can_coalesce()
+    public override async Task Selected_column_can_coalesce(bool async)
     {
-        // Cosmos client evaluation. Issue #17246.
-        AssertTranslationFailed(
-            () =>
-            {
-                base.Selected_column_can_coalesce();
-                return Task.CompletedTask;
-            });
+        // Unsupported ORDER BY clause.
+        await Assert.ThrowsAsync<CosmosException>(
+            () => base.Selected_column_can_coalesce(async));
 
         AssertSql(
             @"SELECT c
@@ -3030,19 +2948,6 @@ public override async Task OrderBy_Dto_projection_skip_take(bool async)
 OFFSET @__p_0 LIMIT @__p_1");
     }
 
-    public override void Streaming_chained_sync_query()
-    {
-        // Cross collection join. Issue #17246.
-        AssertTranslationFailed(
-            () =>
-            {
-                base.Streaming_chained_sync_query();
-                return Task.CompletedTask;
-            });
-
-        AssertSql();
-    }
-
     public override async Task Join_take_count_works(bool async)
     {
         // Cosmos client evaluation. Issue #17246.
@@ -3075,15 +2980,10 @@ public override async Task OrderBy_empty_list_does_not_contains(bool async)
 ORDER BY NOT((true = false))");
     }
 
-    public override void Manual_expression_tree_typed_null_equality()
+    public override async Task Manual_expression_tree_typed_null_equality(bool async)
     {
         // Cosmos client evaluation. Issue #17246.
-        AssertTranslationFailed(
-            () =>
-            {
-                base.Manual_expression_tree_typed_null_equality();
-                return Task.CompletedTask;
-            });
+        await AssertTranslationFailed(() => base.Manual_expression_tree_typed_null_equality(async));
 
         AssertSql();
     }
@@ -3166,15 +3066,9 @@ public override async Task Entity_equality_through_subquery(bool async)
         AssertSql();
     }
 
-    public override void Can_convert_manually_build_expression_with_default()
+    public override async Task Can_convert_manually_build_expression_with_default(bool async)
     {
-        // Cosmos client evaluation. Issue #17246.
-        AssertTranslationFailed(
-            () =>
-            {
-                base.Can_convert_manually_build_expression_with_default();
-                return Task.CompletedTask;
-            });
+        await base.Can_convert_manually_build_expression_with_default(async);
 
         AssertSql(
             @"SELECT COUNT(1) AS c
@@ -3309,39 +3203,39 @@ public override async Task SelectMany_primitive(bool async)
 
     public override async Task SelectMany_primitive_select_subquery(bool async)
     {
-        // Cosmos client evaluation. Issue #17246.
         // Cosmos client evaluation. Issue #17246.
         Assert.Equal(
             CoreStrings.ExpressionParameterizationExceptionSensitive(
-                "value(Microsoft.EntityFrameworkCore.Query.NorthwindMiscellaneousQueryTestBase`1+<>c__DisplayClass168_0[Microsoft.EntityFrameworkCore.Query.NorthwindQueryCosmosFixture`1[Microsoft.EntityFrameworkCore.TestUtilities.NoopModelCustomizer]]).ss.Set().Any()"),
+                "value(Microsoft.EntityFrameworkCore.Query.NorthwindMiscellaneousQueryTestBase`1+<>c__DisplayClass169_0[Microsoft.EntityFrameworkCore.Query.NorthwindQueryCosmosFixture`1[Microsoft.EntityFrameworkCore.TestUtilities.NoopModelCustomizer]]).ss.Set().Any()"),
             (await Assert.ThrowsAsync<InvalidOperationException>(
                 () => base.SelectMany_primitive_select_subquery(async))).Message);
 
         AssertSql();
     }
 
-    public override void Select_DTO_constructor_distinct_with_navigation_translated_to_server()
+    public override async Task Select_DTO_constructor_distinct_with_navigation_translated_to_server(bool async)
+    {
+        // Cosmos client evaluation. Issue #17246.
+        await AssertTranslationFailed(
+            () => base.Select_DTO_constructor_distinct_with_navigation_translated_to_server(async));
+
+        AssertSql();
+    }
+
+    public override async Task Select_DTO_constructor_distinct_with_collection_projection_translated_to_server(bool async)
     {
         // Cosmos client evaluation. Issue #17246.
-        AssertTranslationFailed(
-            () =>
-            {
-                base.Select_DTO_constructor_distinct_with_navigation_translated_to_server();
-                return Task.CompletedTask;
-            });
+        await AssertTranslationFailed(
+            () => base.Select_DTO_constructor_distinct_with_collection_projection_translated_to_server(async));
 
         AssertSql();
     }
 
-    public override void Select_DTO_constructor_distinct_with_collection_projection_translated_to_server()
+    public override async Task Select_DTO_constructor_distinct_with_collection_projection_translated_to_server_with_binding_after_client_eval(bool async)
     {
         // Cosmos client evaluation. Issue #17246.
-        AssertTranslationFailed(
-            () =>
-            {
-                base.Select_DTO_constructor_distinct_with_collection_projection_translated_to_server();
-                return Task.CompletedTask;
-            });
+        await AssertTranslationFailed(
+            () => base.Select_DTO_constructor_distinct_with_collection_projection_translated_to_server_with_binding_after_client_eval(async));
 
         AssertSql();
     }
@@ -4266,16 +4160,16 @@ public override async Task Mixed_sync_async_query()
         AssertSql();
     }
 
-    public override void Parameter_extraction_can_throw_exception_from_user_code()
+    public override async Task Parameter_extraction_can_throw_exception_from_user_code(bool async)
     {
-        base.Parameter_extraction_can_throw_exception_from_user_code();
+        await base.Parameter_extraction_can_throw_exception_from_user_code(async);
 
         AssertSql();
     }
 
-    public override void Parameter_extraction_can_throw_exception_from_user_code_2()
+    public override async Task Parameter_extraction_can_throw_exception_from_user_code_2(bool async)
     {
-        base.Parameter_extraction_can_throw_exception_from_user_code_2();
+        await base.Parameter_extraction_can_throw_exception_from_user_code_2(async);
 
         AssertSql();
     }
@@ -4301,37 +4195,38 @@ public override void Can_cast_CreateQuery_result_to_IQueryable_T_bug_1730()
         AssertSql();
     }
 
-    public override void Multiple_context_instances()
+    public override async Task Multiple_context_instances(bool async)
     {
-        base.Multiple_context_instances();
+        await base.Multiple_context_instances(async);
 
         AssertSql();
     }
 
-    public override void Multiple_context_instances_2()
+    public override async Task Multiple_context_instances_2(bool async)
     {
-        base.Multiple_context_instances_2();
+        await base.Multiple_context_instances_2(async);
 
         AssertSql();
     }
 
-    public override void Multiple_context_instances_set()
+    public override async Task Multiple_context_instances_set(bool async)
     {
-        base.Multiple_context_instances_set();
+        await base.Multiple_context_instances_set(async);
 
         AssertSql();
     }
 
-    public override void Multiple_context_instances_parameter()
+    public override async Task Multiple_context_instances_parameter(bool async)
     {
-        base.Multiple_context_instances_parameter();
+        await base.Multiple_context_instances_parameter(async);
 
         AssertSql();
     }
 
-    public override void Entity_equality_through_subquery_composite_key()
+    public override async Task Entity_equality_through_subquery_composite_key(bool async)
     {
-        base.Entity_equality_through_subquery_composite_key();
+        // Cosmos client evaluation. Issue #17246.
+        await AssertTranslationFailed(() => base.Entity_equality_through_subquery_composite_key(async));
 
         AssertSql();
     }
diff --git a/test/EFCore.Cosmos.FunctionalTests/Query/NorthwindSelectQueryCosmosTest.cs b/test/EFCore.Cosmos.FunctionalTests/Query/NorthwindSelectQueryCosmosTest.cs
index 992f84e8f1..132de2a59e 100644
--- a/test/EFCore.Cosmos.FunctionalTests/Query/NorthwindSelectQueryCosmosTest.cs
+++ b/test/EFCore.Cosmos.FunctionalTests/Query/NorthwindSelectQueryCosmosTest.cs
@@ -316,82 +316,52 @@ public override async Task Select_nested_collection(bool async)
         AssertSql();
     }
 
-    public override void Select_nested_collection_multi_level()
+    public override async Task Select_nested_collection_multi_level(bool async)
     {
-        //// Cosmos client evaluation. Issue #17246.
-        //AssertTranslationFailed(
-        //    () =>
-        //    {
-        //        base.Select_nested_collection_multi_level();
-        //        return Task.CompletedTask;
-        //    });
+        // Cosmos client evaluation. Issue #17246.
+        await AssertTranslationFailed(() => base.Select_nested_collection_multi_level(async));
 
-        //AssertSql();
+        AssertSql();
     }
 
-    public override void Select_nested_collection_multi_level2()
+    public override async Task Select_nested_collection_multi_level2(bool async)
     {
-        //// Cosmos client evaluation. Issue #17246.
-        //AssertTranslationFailed(
-        //    () =>
-        //    {
-        //        base.Select_nested_collection_multi_level2();
-        //        return Task.CompletedTask;
-        //    });
+        // Cosmos client evaluation. Issue #17246.
+        await AssertTranslationFailed(() => base.Select_nested_collection_multi_level2(async));
 
-        //AssertSql();
+        AssertSql();
     }
 
-    public override void Select_nested_collection_multi_level3()
+    public override async Task Select_nested_collection_multi_level3(bool async)
     {
-        //// Cosmos client evaluation. Issue #17246.
-        //AssertTranslationFailed(
-        //    () =>
-        //    {
-        //        base.Select_nested_collection_multi_level3();
-        //        return Task.CompletedTask;
-        //    });
+        // Cosmos client evaluation. Issue #17246.
+        await AssertTranslationFailed(() => base.Select_nested_collection_multi_level3(async));
 
-        //AssertSql();
+        AssertSql();
     }
 
-    public override void Select_nested_collection_multi_level4()
+    public override async Task Select_nested_collection_multi_level4(bool async)
     {
-        //// Cosmos client evaluation. Issue #17246.
-        //AssertTranslationFailed(
-        //    () =>
-        //    {
-        //        base.Select_nested_collection_multi_level4();
-        //        return Task.CompletedTask;
-        //    });
+        // Cosmos client evaluation. Issue #17246.
+        await AssertTranslationFailed(() => base.Select_nested_collection_multi_level4(async));
 
-        //AssertSql();
+        AssertSql();
     }
 
-    public override void Select_nested_collection_multi_level5()
+    public override async Task Select_nested_collection_multi_level5(bool async)
     {
-        //// Cosmos client evaluation. Issue #17246.
-        //AssertTranslationFailed(
-        //    () =>
-        //    {
-        //        base.Select_nested_collection_multi_level5();
-        //        return Task.CompletedTask;
-        //    });
+        // Cosmos client evaluation. Issue #17246.
+        await AssertTranslationFailed(() => base.Select_nested_collection_multi_level5(async));
 
-        //AssertSql();
+        AssertSql();
     }
 
-    public override void Select_nested_collection_multi_level6()
+    public override async Task Select_nested_collection_multi_level6(bool async)
     {
-        //// Cosmos client evaluation. Issue #17246.
-        //AssertTranslationFailed(
-        //    () =>
-        //    {
-        //        base.Select_nested_collection_multi_level6();
-        //        return Task.CompletedTask;
-        //    });
+        // Cosmos client evaluation. Issue #17246.
+        await AssertTranslationFailed(() => base.Select_nested_collection_multi_level6(async));
 
-        //AssertSql();
+        AssertSql();
     }
 
     public override async Task Select_nested_collection_count_using_anonymous_type(bool async)
diff --git a/test/EFCore.Cosmos.FunctionalTests/Query/NorthwindWhereQueryCosmosTest.cs b/test/EFCore.Cosmos.FunctionalTests/Query/NorthwindWhereQueryCosmosTest.cs
index f666c2bd17..1bb0765630 100644
--- a/test/EFCore.Cosmos.FunctionalTests/Query/NorthwindWhereQueryCosmosTest.cs
+++ b/test/EFCore.Cosmos.FunctionalTests/Query/NorthwindWhereQueryCosmosTest.cs
@@ -684,15 +684,10 @@ public override async Task Where_simple_closure_via_query_cache_nullable_type_re
         AssertSql();
     }
 
-    public override void Where_subquery_closure_via_query_cache()
+    public override async Task Where_subquery_closure_via_query_cache(bool async)
     {
         // Cosmos client evaluation. Issue #17246.
-        AssertTranslationFailed(
-            () =>
-            {
-                base.Where_subquery_closure_via_query_cache();
-                return Task.CompletedTask;
-            });
+        await AssertTranslationFailed(() => base.Where_subquery_closure_via_query_cache(async));
 
         AssertSql();
     }
@@ -1765,15 +1760,15 @@ public override async Task Where_chain(bool async)
 WHERE (((c[""Discriminator""] = ""Order"") AND (c[""CustomerID""] = ""QUICK"")) AND (c[""OrderDate""] > ""1998-01-01T00:00:00""))");
     }
 
-    public override void Where_navigation_contains()
+    public override async Task Where_navigation_contains(bool async)
     {
-        // Cosmos client evaluation. Issue #17246.
-        AssertTranslationFailed(
-            () =>
-            {
-                base.Where_navigation_contains();
-                return Task.CompletedTask;
-            });
+        var message = (await Assert.ThrowsAsync<InvalidOperationException>(
+            () => base.Where_navigation_contains(async))).Message;
+
+        Assert.Equal(
+            CosmosStrings.NonEmbeddedIncludeNotSupported(
+                @"Navigation: Customer.Orders (List<Order>) Collection ToDependent Order Inverse: Customer PropertyAccessMode.Field"),
+                message);
 
         AssertSql();
     }
@@ -2454,30 +2449,16 @@ public override async Task Filter_with_property_compared_to_null_wrapped_in_expl
 WHERE ((c[""Discriminator""] = ""Customer"") AND (c[""Region""] = null))");
     }
 
-    public override void Where_nested_field_access_closure_via_query_cache_error_null()
-    {
-        base.Where_nested_field_access_closure_via_query_cache_error_null();
-
-        AssertSql();
-    }
-
-    public override async Task Where_nested_field_access_closure_via_query_cache_error_null_async()
-    {
-        await base.Where_nested_field_access_closure_via_query_cache_error_null_async();
-
-        AssertSql();
-    }
-
-    public override void Where_nested_field_access_closure_via_query_cache_error_method_null()
+    public override async Task Where_nested_field_access_closure_via_query_cache_error_null(bool async)
     {
-        base.Where_nested_field_access_closure_via_query_cache_error_method_null();
+        await base.Where_nested_field_access_closure_via_query_cache_error_null(async);
 
         AssertSql();
     }
 
-    public override async Task Where_nested_field_access_closure_via_query_cache_error_method_null_async()
+    public override async Task Where_nested_field_access_closure_via_query_cache_error_method_null(bool async)
     {
-        await base.Where_nested_field_access_closure_via_query_cache_error_method_null_async();
+        await base.Where_nested_field_access_closure_via_query_cache_error_method_null(async);
 
         AssertSql();
     }
diff --git a/test/EFCore.InMemory.FunctionalTests/Query/NorthwindKeylessEntitiesQueryInMemoryTest.cs b/test/EFCore.InMemory.FunctionalTests/Query/NorthwindKeylessEntitiesQueryInMemoryTest.cs
index 6fc55589a6..dfdaa7eba7 100644
--- a/test/EFCore.InMemory.FunctionalTests/Query/NorthwindKeylessEntitiesQueryInMemoryTest.cs
+++ b/test/EFCore.InMemory.FunctionalTests/Query/NorthwindKeylessEntitiesQueryInMemoryTest.cs
@@ -17,13 +17,11 @@ public class NorthwindKeylessEntitiesQueryInMemoryTest : NorthwindKeylessEntitie
     }
 
     // mapping to view not supported on InMemory
-    public override void KeylessEntity_by_database_view()
-    {
-    }
+    public override Task KeylessEntity_by_database_view(bool async)
+        => Task.CompletedTask;
 
-    public override void Entity_mapped_to_view_on_right_side_of_join()
-    {
-    }
+    public override Task Entity_mapped_to_view_on_right_side_of_join(bool async)
+        => Task.CompletedTask;
 
     public override async Task KeylessEntity_with_included_nav(bool async)
         => await Assert.ThrowsAsync<InvalidOperationException>(
diff --git a/test/EFCore.InMemory.FunctionalTests/Query/NorthwindMiscellaneousQueryInMemoryTest.cs b/test/EFCore.InMemory.FunctionalTests/Query/NorthwindMiscellaneousQueryInMemoryTest.cs
index 24d2809d9c..348d88fd22 100644
--- a/test/EFCore.InMemory.FunctionalTests/Query/NorthwindMiscellaneousQueryInMemoryTest.cs
+++ b/test/EFCore.InMemory.FunctionalTests/Query/NorthwindMiscellaneousQueryInMemoryTest.cs
@@ -1,6 +1,8 @@
 ï»¿// Licensed to the .NET Foundation under one or more agreements.
 // The .NET Foundation licenses this file to you under the MIT license.
 
+using Microsoft.EntityFrameworkCore.TestModels.Northwind;
+
 namespace Microsoft.EntityFrameworkCore.Query;
 
 public class NorthwindMiscellaneousQueryInMemoryTest : NorthwindMiscellaneousQueryTestBase<
@@ -48,4 +50,10 @@ public override Task Where_query_composition_entity_equality_multiple_elements_S
 
     public override Task Max_on_empty_sequence_throws(bool async)
         => Assert.ThrowsAsync<InvalidOperationException>(() => base.Max_on_empty_sequence_throws(async));
+
+    public override async Task Entity_equality_through_subquery_composite_key(bool async)
+        => Assert.Equal(
+            CoreStrings.EntityEqualityOnCompositeKeyEntitySubqueryNotSupported("==", nameof(OrderDetail)),
+            (await Assert.ThrowsAsync<InvalidOperationException>(
+                () => base.Entity_equality_through_subquery_composite_key(async))).Message);
 }
diff --git a/test/EFCore.Specification.Tests/Query/NorthwindAsNoTrackingQueryTestBase.cs b/test/EFCore.Specification.Tests/Query/NorthwindAsNoTrackingQueryTestBase.cs
index 1b258f593a..b02ddd2554 100644
--- a/test/EFCore.Specification.Tests/Query/NorthwindAsNoTrackingQueryTestBase.cs
+++ b/test/EFCore.Specification.Tests/Query/NorthwindAsNoTrackingQueryTestBase.cs
@@ -7,186 +7,155 @@
 // ReSharper disable AccessToDisposedClosure
 namespace Microsoft.EntityFrameworkCore.Query;
 
-public abstract class NorthwindAsNoTrackingQueryTestBase<TFixture> : IClassFixture<TFixture>
+public abstract class NorthwindAsNoTrackingQueryTestBase<TFixture> : QueryTestBase<TFixture>
     where TFixture : NorthwindQueryFixtureBase<NoopModelCustomizer>, new()
 {
     protected NorthwindAsNoTrackingQueryTestBase(TFixture fixture)
+        : base(fixture)
     {
-        Fixture = fixture;
     }
 
-    protected TFixture Fixture { get; }
-
     [ConditionalTheory]
-    [InlineData(false)]
-    [InlineData(true)]
-    public virtual void Entity_not_added_to_state_manager(bool useParam)
-    {
-        using var context = CreateContext();
-        var customers = useParam
-            ? context.Set<Customer>().AsTracking(QueryTrackingBehavior.NoTracking).ToList()
-            : context.Set<Customer>().AsNoTracking().ToList();
-
-        Assert.Equal(91, customers.Count);
-        Assert.Empty(context.ChangeTracker.Entries());
-    }
+    [InlineData(false, false)]
+    [InlineData(false, true)]
+    [InlineData(true, false)]
+    [InlineData(true, true)]
+    public virtual Task Entity_not_added_to_state_manager(bool useParam, bool async)
+        => useParam
+            ? AssertQuery(
+                async,
+                ss => ss.Set<Customer>().AsTracking(QueryTrackingBehavior.NoTracking),
+                entryCount: 0)
+            : AssertQuery(
+                async,
+                ss => ss.Set<Customer>().AsNoTracking(),
+                entryCount: 0);
 
-    [ConditionalFact]
-    public virtual void Applied_to_body_clause()
-    {
-        using var context = CreateContext();
-        var customers
-            = (from c in context.Set<Customer>()
-               join o in context.Set<Order>().AsNoTracking()
-                   on c.CustomerID equals o.CustomerID
-               where c.CustomerID == "ALFKI"
-               select o)
-            .ToList();
-
-        Assert.Equal(6, customers.Count);
-        Assert.Empty(context.ChangeTracker.Entries());
-    }
+    [ConditionalTheory]
+    [MemberData(nameof(IsAsyncData))]
+    public virtual Task Applied_to_body_clause(bool async)
+        => AssertQuery(
+            async,
+            ss => from c in ss.Set<Customer>()
+                  join o in ss.Set<Order>().AsNoTracking()
+                      on c.CustomerID equals o.CustomerID
+                  where c.CustomerID == "ALFKI"
+                  select o,
+            entryCount: 0);
 
-    [ConditionalFact]
-    public virtual void Applied_to_multiple_body_clauses()
-    {
-        using var context = CreateContext();
-        var customers
-            = (from c in context.Set<Customer>().AsNoTracking()
-               from o in context.Set<Order>().AsNoTracking()
-               where c.CustomerID == o.CustomerID
-               select new { c, o })
-            .ToList();
-
-        Assert.Equal(830, customers.Count);
-        Assert.Empty(context.ChangeTracker.Entries());
-    }
+    [ConditionalTheory]
+    [MemberData(nameof(IsAsyncData))]
+    public virtual Task Applied_to_multiple_body_clauses(bool async)
+        => AssertQuery(
+            async,
+            ss => from c in ss.Set<Customer>().AsNoTracking()
+                  from o in ss.Set<Order>().AsNoTracking()
+                  where c.CustomerID == o.CustomerID
+                  select new { c, o },
+            elementSorter: e => (e.c.CustomerID, e.o.OrderID),
+            entryCount: 0);
 
-    [ConditionalFact]
-    public virtual void Applied_to_body_clause_with_projection()
-    {
-        using var context = CreateContext();
-        var customers
-            = (from c in context.Set<Customer>()
-               join o in context.Set<Order>().AsNoTracking()
-                   on c.CustomerID equals o.CustomerID
-               where c.CustomerID == "ALFKI"
-               select new
-               {
-                   c.CustomerID,
-                   c,
-                   ocid = o.CustomerID,
-                   o
-               })
-            .ToList();
-
-        Assert.Equal(6, customers.Count);
-        Assert.Empty(context.ChangeTracker.Entries());
-    }
+    [ConditionalTheory]
+    [MemberData(nameof(IsAsyncData))]
+    public virtual Task Applied_to_body_clause_with_projection(bool async)
+        => AssertQuery(
+            async,
+            ss => from c in ss.Set<Customer>()
+                  join o in ss.Set<Order>().AsNoTracking()
+                      on c.CustomerID equals o.CustomerID
+                  where c.CustomerID == "ALFKI"
+                  select new
+                  {
+                      c.CustomerID,
+                      c,
+                      ocid = o.CustomerID,
+                      o
+                  },
+            elementSorter: e => (e.CustomerID, e.o.OrderID),
+            entryCount: 0);
 
-    [ConditionalFact]
-    public virtual void Applied_to_projection()
-    {
-        using var context = CreateContext();
-        var customers
-            = (from c in context.Set<Customer>()
-               join o in context.Set<Order>().AsNoTracking()
-                   on c.CustomerID equals o.CustomerID
-               where c.CustomerID == "ALFKI"
-               select new { c, o })
-            .AsNoTracking()
-            .ToList();
-
-        Assert.Equal(6, customers.Count);
-        Assert.Empty(context.ChangeTracker.Entries());
-    }
+    [ConditionalTheory]
+    [MemberData(nameof(IsAsyncData))]
+    public virtual Task Applied_to_projection(bool async)
+        => AssertQuery(
+            async,
+            ss => (from c in ss.Set<Customer>()
+                   join o in ss.Set<Order>().AsNoTracking()
+                       on c.CustomerID equals o.CustomerID
+                   where c.CustomerID == "ALFKI"
+                   select new { c, o }).AsNoTracking(),
+            elementSorter: e => (e.c.CustomerID, e.o.OrderID),
+            entryCount: 0);
 
-    [ConditionalFact]
-    public virtual void Can_get_current_values()
+    [ConditionalTheory]
+    [MemberData(nameof(IsAsyncData))]
+    public virtual async Task Can_get_current_values(bool async)
     {
         using var db = CreateContext();
-        var customer = db.Customers.First();
-
-        customer.CompanyName = "foo";
-
-        var dbCustomer = db.Customers.AsNoTracking().First();
 
-        Assert.NotEqual(customer.CompanyName, dbCustomer.CompanyName);
+        if (async)
+        {
+            var customer = await db.Customers.FirstAsync();
+            customer.CompanyName = "foo";
+            var dbCustomer = await db.Customers.AsNoTracking().FirstAsync();
+            Assert.NotEqual(customer.CompanyName, dbCustomer.CompanyName);
+        }
+        else
+        {
+            var customer = db.Customers.First();
+            customer.CompanyName = "foo";
+            var dbCustomer = db.Customers.AsNoTracking().First();
+            Assert.NotEqual(customer.CompanyName, dbCustomer.CompanyName);
+        }
     }
 
-    [ConditionalFact]
-    public virtual void Include_reference_and_collection()
-    {
-        using var context = CreateContext();
-        var orders
-            = context.Set<Order>()
+    [ConditionalTheory]
+    [MemberData(nameof(IsAsyncData))]
+    public virtual Task Include_reference_and_collection(bool async)
+        => AssertQuery(
+            async,
+            ss => ss.Set<Order>()
                 .Include(o => o.Customer)
                 .Include(o => o.OrderDetails)
-                .AsNoTracking()
-                .ToList();
+                .AsNoTracking(),
+            entryCount: 0);
 
-        Assert.Equal(830, orders.Count);
-    }
-
-    [ConditionalFact]
-    public virtual void Applied_after_navigation_expansion()
-    {
-        using var context = CreateContext();
-        var orders = context.Set<Order>().Where(o => o.Customer.City != "London").AsNoTracking().ToList();
-
-        Assert.Equal(784, orders.Count);
-    }
+    [ConditionalTheory]
+    [MemberData(nameof(IsAsyncData))]
+    public virtual Task Applied_after_navigation_expansion(bool async)
+        => AssertQuery(
+            async,
+            ss => ss.Set<Order>().Where(o => o.Customer.City != "London").AsNoTracking(),
+            entryCount: 0);
 
-    [ConditionalFact]
-    public virtual void Where_simple_shadow()
-    {
-        using var context = CreateContext();
-        var employees
-            = context.Set<Employee>()
+    [ConditionalTheory]
+    [MemberData(nameof(IsAsyncData))]
+    public virtual Task Where_simple_shadow(bool async)
+        => AssertQuery(
+            async,
+            ss => ss.Set<Employee>()
                 .Where(e => EF.Property<string>(e, "Title") == "Sales Representative")
-                .AsNoTracking()
-                .ToList();
+                .AsNoTracking(),
+            entryCount: 0);
 
-        Assert.Equal(6, employees.Count);
-    }
-
-    [ConditionalFact]
-    public virtual void Query_fast_path_when_ctor_binding()
-    {
-        using var context = CreateContext();
-        var employees
-            = context.Set<Customer>()
-                .AsNoTracking()
-                .ToList();
-
-        Assert.Equal(91, employees.Count);
-    }
-
-    [ConditionalFact]
-    public virtual async Task Query_fast_path_when_ctor_binding_async()
-    {
-        using var context = CreateContext();
-        var employees
-            = await context.Set<Customer>()
-                .AsNoTracking()
-                .ToListAsync();
-
-        Assert.Equal(91, employees.Count);
-    }
+    [ConditionalTheory]
+    [MemberData(nameof(IsAsyncData))]
+    public virtual Task Query_fast_path_when_ctor_binding(bool async)
+        => AssertQuery(
+            async,
+            ss => ss.Set<Customer>().AsNoTracking(),
+            entryCount: 0);
 
-    [ConditionalFact]
-    public virtual void SelectMany_simple()
-    {
-        using var context = CreateContext();
-        var results
-            = (from e in context.Set<Employee>()
-               from c in context.Set<Customer>()
-               select new { c, e })
-            .AsNoTracking()
-            .ToList();
-
-        Assert.Equal(819, results.Count);
-    }
+    [ConditionalTheory]
+    [MemberData(nameof(IsAsyncData))]
+    public virtual Task SelectMany_simple(bool async)
+        => AssertQuery(
+            async,
+            ss => (from e in ss.Set<Employee>()
+                   from c in ss.Set<Customer>()
+                   select new { c, e }).AsNoTracking(),
+            elementSorter: e => (e.c.CustomerID, e.e.EmployeeID),
+            entryCount: 0);
 
     protected NorthwindContext CreateContext()
         => Fixture.CreateContext();
diff --git a/test/EFCore.Specification.Tests/Query/NorthwindKeylessEntitiesQueryTestBase.cs b/test/EFCore.Specification.Tests/Query/NorthwindKeylessEntitiesQueryTestBase.cs
index fa6ba74048..30aecb7fa7 100644
--- a/test/EFCore.Specification.Tests/Query/NorthwindKeylessEntitiesQueryTestBase.cs
+++ b/test/EFCore.Specification.Tests/Query/NorthwindKeylessEntitiesQueryTestBase.cs
@@ -35,35 +35,26 @@ public virtual Task KeylessEntity_where_simple(bool async)
             async,
             ss => ss.Set<CustomerQuery>().Where(c => c.City == "London"));
 
-    [ConditionalFact]
-    public virtual void KeylessEntity_by_database_view()
-    {
-        using var context = CreateContext();
-        var results = context.Set<ProductView>().ToArray();
-
-        Assert.Equal(69, results.Length);
-    }
-
-    [ConditionalFact]
-    public virtual void Auto_initialized_view_set()
-    {
-        using var context = CreateContext();
-        var results = context.CustomerQueries.ToArray();
-
-        Assert.Equal(91, results.Length);
-    }
+    [ConditionalTheory]
+    [MemberData(nameof(IsAsyncData))]
+    public virtual Task KeylessEntity_by_database_view(bool async)
+        => AssertQuery(
+            async,
+            ss => ss.Set<ProductView>());
 
-    [ConditionalFact]
-    public virtual void KeylessEntity_with_nav_defining_query()
-    {
-        using var context = CreateContext();
-        var results
-            = context.Set<CustomerQueryWithQueryFilter>()
-                .Where(cq => cq.OrderCount > 0)
-                .ToArray();
+    [ConditionalTheory]
+    [MemberData(nameof(IsAsyncData))]
+    public virtual Task Auto_initialized_view_set(bool async)
+        => AssertQuery(
+            async,
+            ss => ss.Set<CustomerQuery>());
 
-        Assert.Equal(89, results.Length);
-    }
+    [ConditionalTheory]
+    [MemberData(nameof(IsAsyncData))]
+    public virtual Task KeylessEntity_with_nav_defining_query(bool async)
+        => AssertQuery(
+            async,
+            ss => ss.Set<CustomerQueryWithQueryFilter>().Where(cq => cq.OrderCount > 0));
 
     [ConditionalTheory]
     [MemberData(nameof(IsAsyncData))]
@@ -154,18 +145,17 @@ public virtual Task KeylessEntity_groupby(bool async)
                     }),
             elementSorter: e => (e.Key, e.Count, e.Sum));
 
-    [ConditionalFact]
-    public virtual void Entity_mapped_to_view_on_right_side_of_join()
-    {
-        using var context = CreateContext();
-
-        var results = (from o in context.Set<Order>()
-                       join pv in context.Set<ProductView>() on o.CustomerID equals pv.CategoryName into grouping
-                       from pv in grouping.DefaultIfEmpty()
-                       select new { Order = o, ProductView = pv }).ToList();
-
-        Assert.Equal(830, results.Count);
-    }
+    [ConditionalTheory]
+    [MemberData(nameof(IsAsyncData))]
+    public virtual Task Entity_mapped_to_view_on_right_side_of_join(bool async)
+        => AssertQuery(
+            async,
+            ss => from o in ss.Set<Order>()
+                  join pv in ss.Set<ProductView>() on o.CustomerID equals pv.CategoryName into grouping
+                  from pv in grouping.DefaultIfEmpty()
+                  select new { Order = o, ProductView = pv },
+            elementSorter: e => (e.Order.OrderID, e.ProductView?.ProductID),
+            entryCount: 830);
 
     [ConditionalTheory]
     [MemberData(nameof(IsAsyncData))]
diff --git a/test/EFCore.Specification.Tests/Query/NorthwindMiscellaneousQueryTestBase.cs b/test/EFCore.Specification.Tests/Query/NorthwindMiscellaneousQueryTestBase.cs
index e6c2545f9b..b9ec157598 100644
--- a/test/EFCore.Specification.Tests/Query/NorthwindMiscellaneousQueryTestBase.cs
+++ b/test/EFCore.Specification.Tests/Query/NorthwindMiscellaneousQueryTestBase.cs
@@ -23,68 +23,96 @@ protected virtual void ClearLog()
     {
     }
 
-    [ConditionalFact]
-    public virtual void Multiple_context_instances()
+    [ConditionalTheory]
+    [MemberData(nameof(IsAsyncData))]
+    public virtual async Task Multiple_context_instances(bool async)
     {
         using var context1 = CreateContext();
         using var context2 = CreateContext();
-        Assert.Equal(
-            CoreStrings.ErrorInvalidQueryable,
-            Assert.Throws<InvalidOperationException>(
-                () =>
-                    (from c in context1.Customers
-                     from o in context2.Orders
-                     select c).First()).Message);
+
+        var message = async ?
+            (await Assert.ThrowsAsync<InvalidOperationException>(
+                () => (from c in context1.Customers
+                       from o in context2.Orders
+                       select c).FirstAsync())).Message
+            : Assert.Throws<InvalidOperationException>(
+                () => (from c in context1.Customers
+                       from o in context2.Orders
+                       select c).First()).Message;
+
+        Assert.Equal(CoreStrings.ErrorInvalidQueryable, message);
     }
 
-    [ConditionalFact]
-    public virtual void Multiple_context_instances_2()
+    [ConditionalTheory]
+    [MemberData(nameof(IsAsyncData))]
+    public virtual async Task Multiple_context_instances_2(bool async)
     {
         using var context1 = CreateContext();
         using var context2 = CreateContext();
-        Assert.Equal(
-            CoreStrings.ErrorInvalidQueryable,
-            Assert.Throws<InvalidOperationException>(
-                () =>
-                    (from c in context1.Customers
-                     from o in context2.Set<Order>()
-                     select c).First()).Message);
+
+        var message = async ?
+            (await Assert.ThrowsAsync<InvalidOperationException>(
+                () => (from c in context1.Customers
+                       from o in context2.Set<Order>()
+                       select c).FirstAsync())).Message
+            : Assert.Throws<InvalidOperationException>(
+                () => (from c in context1.Customers
+                       from o in context2.Set<Order>()
+                       select c).First()).Message;
+
+        Assert.Equal(CoreStrings.ErrorInvalidQueryable, message);
     }
 
-    [ConditionalFact]
-    public virtual void Multiple_context_instances_set()
+    [ConditionalTheory]
+    [MemberData(nameof(IsAsyncData))]
+    public virtual async Task Multiple_context_instances_set(bool async)
     {
         using var context1 = CreateContext();
         using var context2 = CreateContext();
         var set = context2.Orders;
 
-        Assert.Equal(
-            CoreStrings.ErrorInvalidQueryable,
-            Assert.Throws<InvalidOperationException>(
+        var message = async ?
+            (await Assert.ThrowsAsync<InvalidOperationException>(
+                () => (from c in context1.Customers
+                       from o in set
+                       select c).FirstAsync())).Message
+            : Assert.Throws<InvalidOperationException>(
                 () => (from c in context1.Customers
                        from o in set
-                       select c).First()).Message);
+                       select c).First()).Message;
+
+        Assert.Equal(CoreStrings.ErrorInvalidQueryable, message);
     }
 
-    [ConditionalFact]
-    public virtual void Multiple_context_instances_parameter()
+    [ConditionalTheory]
+    [MemberData(nameof(IsAsyncData))]
+    public virtual async Task Multiple_context_instances_parameter(bool async)
     {
         using var context1 = CreateContext();
         using var context2 = CreateContext();
 
+        var message = async ?
+            (await Assert.ThrowsAsync<InvalidOperationException>(
+                () => queryAsync(context2))).Message
+            : Assert.Throws<InvalidOperationException>(
+                () => query(context2)).Message;
+
+        Assert.Equal(CoreStrings.ErrorInvalidQueryable, message);
+
         Customer query(NorthwindContext c2)
             => (from c in context1.Customers
                 from o in c2.Orders
                 select c).First();
 
-        Assert.Equal(
-            CoreStrings.ErrorInvalidQueryable,
-            Assert.Throws<InvalidOperationException>(
-                () => query(context2)).Message);
+        Task<Customer> queryAsync(NorthwindContext c2)
+            => (from c in context1.Customers
+                from o in c2.Orders
+                select c).FirstAsync();
     }
 
-    [ConditionalFact]
-    public virtual void Query_when_evaluatable_queryable_method_call_with_repository()
+    [ConditionalTheory]
+    [MemberData(nameof(IsAsyncData))]
+    public virtual async Task Query_when_evaluatable_queryable_method_call_with_repository(bool async)
     {
         using var context = CreateContext();
         context.ChangeTracker.QueryTrackingBehavior = QueryTrackingBehavior.NoTracking;
@@ -92,26 +120,27 @@ public virtual void Query_when_evaluatable_queryable_method_call_with_repository
         var customerRepository = new Repository<Customer>(context);
         var orderRepository = new Repository<Order>(context);
 
-        var results
-            = customerRepository.Find()
-                .Where(c => orderRepository.Find().Any(o => o.CustomerID == c.CustomerID))
-                .ToList();
+        var query1 = customerRepository.Find()
+            .Where(c => orderRepository.Find().Any(o => o.CustomerID == c.CustomerID));
+
+        var results = async ? await query1.ToListAsync() : query1.ToList();
 
         Assert.Equal(89, results.Count);
 
-        results
-            = (from c in customerRepository.Find()
-               where orderRepository.Find().Any(o => o.CustomerID == c.CustomerID)
-               select c)
-            .ToList();
+        var query2 = from c in customerRepository.Find()
+                     where orderRepository.Find().Any(o => o.CustomerID == c.CustomerID)
+                     select c;
+
+        results = async ? await query2.ToListAsync() : query2.ToList();
 
         Assert.Equal(89, results.Count);
 
         var orderQuery = orderRepository.Find();
 
-        results = customerRepository.Find()
-            .Where(c => orderQuery.Any(o => o.CustomerID == c.CustomerID))
-            .ToList();
+        var query3 = customerRepository.Find()
+            .Where(c => orderQuery.Any(o => o.CustomerID == c.CustomerID));
+
+        results = async ? await query3.ToListAsync() : query3.ToList();
 
         Assert.Equal(89, results.Count);
 
@@ -132,49 +161,45 @@ public IQueryable<T> Find()
             => _context.Set<T>();
     }
 
-    [ConditionalFact]
-    public virtual void Lifting_when_subquery_nested_order_by_simple()
-    {
-        using var context = CreateContext();
-        var results
-            = (from c1_Orders in context.Orders
-               join _c1 in
-                   (from c1 in
-                        (from c in context.Customers
-                         orderby c.CustomerID
-                         select c)
-                        .Take(2)
-                    from c2 in context.Customers
-                    select EF.Property<string>(c1, "CustomerID"))
-                   .Distinct()
-                   on EF.Property<string>(c1_Orders, "CustomerID") equals _c1
-               orderby _c1
-               select c1_Orders).ToList();
-
-        Assert.Equal(10, results.Count);
-    }
+    [ConditionalTheory]
+    [MemberData(nameof(IsAsyncData))]
+    public virtual Task Lifting_when_subquery_nested_order_by_simple(bool async)
+        => AssertQuery(
+            async,
+            ss => from c1_Orders in ss.Set<Order>()
+                  join _c1 in
+                      (from c1 in
+                           (from c in ss.Set<Customer>()
+                            orderby c.CustomerID
+                            select c)
+                           .Take(2)
+                       from c2 in ss.Set<Customer>()
+                       select EF.Property<string>(c1, "CustomerID"))
+                      .Distinct()
+                      on EF.Property<string>(c1_Orders, "CustomerID") equals _c1
+                  orderby _c1
+                  select c1_Orders,
+            entryCount: 10);
 
-    [ConditionalFact]
-    public virtual void Lifting_when_subquery_nested_order_by_anonymous()
-    {
-        using var context = CreateContext();
-        var results
-            = (from c1_Orders in context.Orders
-               join _c1 in
-                   (from c1 in
-                        (from c in context.Customers
-                         orderby c.CustomerID
-                         select c)
-                        .Take(2)
-                    from c2 in context.Customers
-                    select new { CustomerID = EF.Property<string>(c1, "CustomerID") })
-                   .Distinct()
-                   on EF.Property<string>(c1_Orders, "CustomerID") equals _c1.CustomerID
-               orderby _c1.CustomerID
-               select c1_Orders).ToList();
-
-        Assert.Equal(10, results.Count);
-    }
+    [ConditionalTheory]
+    [MemberData(nameof(IsAsyncData))]
+    public virtual Task Lifting_when_subquery_nested_order_by_anonymous(bool async)
+        => AssertQuery(
+            async,
+            ss => from c1_Orders in ss.Set<Order>()
+                  join _c1 in
+                      (from c1 in
+                           (from c in ss.Set<Customer>()
+                            orderby c.CustomerID
+                            select c)
+                           .Take(2)
+                       from c2 in ss.Set<Customer>()
+                       select new { CustomerID = EF.Property<string>(c1, "CustomerID") })
+                      .Distinct()
+                      on EF.Property<string>(c1_Orders, "CustomerID") equals _c1.CustomerID
+                  orderby _c1.CustomerID
+                  select c1_Orders,
+            entryCount: 10);
 
     private class Context
     {
@@ -214,24 +239,38 @@ var results
         Assert.Single(results);
     }
 
-    [ConditionalFact]
-    public virtual void Shaper_command_caching_when_parameter_names_different()
+    [ConditionalTheory]
+    [MemberData(nameof(IsAsyncData))]
+    public virtual async Task Shaper_command_caching_when_parameter_names_different(bool async)
     {
         using var context = CreateContext();
         var variableName = "test";
         var differentVariableName = "test";
 
-        context.Set<Customer>().Where(e => e.CustomerID == "ALFKI")
-            .Where(e2 => InMemoryCheck.Check(variableName, e2.CustomerID) || true).Count();
+        var query1 = context.Set<Customer>()
+            .Where(e => e.CustomerID == "ALFKI")
+            .Where(e2 => InMemoryCheck.Check(variableName, e2.CustomerID) || true);
 
-        context.Set<Customer>().Where(e => e.CustomerID == "ALFKI")
-            .Where(e2 => InMemoryCheck.Check(differentVariableName, e2.CustomerID) || true).Count();
+        var query2 = context.Set<Customer>()
+            .Where(e => e.CustomerID == "ALFKI")
+            .Where(e2 => InMemoryCheck.Check(differentVariableName, e2.CustomerID) || true);
+
+        if (async)
+        {
+            await query1.CountAsync();
+            await query2.CountAsync();
+        }
+        else
+        {
+            query1.Count();
+            query2.Count();
+        }
     }
 
-    [ConditionalFact]
-    public virtual void Can_convert_manually_build_expression_with_default()
+    [ConditionalTheory]
+    [MemberData(nameof(IsAsyncData))]
+    public virtual async Task Can_convert_manually_build_expression_with_default(bool async)
     {
-        using var context = CreateContext();
         var parameter = Expression.Parameter(typeof(Customer));
         var defaultExpression =
             Expression.Lambda<Func<Customer, bool>>(
@@ -242,8 +281,8 @@ public virtual void Can_convert_manually_build_expression_with_default()
                     Expression.Default(typeof(string))),
                 parameter);
 
-        context.Set<Customer>().Where(defaultExpression).Count();
-        context.Set<Customer>().Count(defaultExpression);
+        await AssertCount(async, ss => ss.Set<Customer>().Where(defaultExpression));
+        await AssertCount(async, ss => ss.Set<Customer>(), predicate: defaultExpression);
     }
 
     private static class InMemoryCheck
@@ -418,13 +457,13 @@ public virtual Task Entity_equality_through_subquery(bool async)
                   where c.Orders.FirstOrDefault() != null
                   select c.CustomerID);
 
-    [ConditionalFact]
-    public virtual void Entity_equality_through_subquery_composite_key()
-        => Assert.Throws<InvalidOperationException>(
-            () =>
-                CreateContext().Orders
-                    .Where(o => o.OrderDetails.FirstOrDefault() == new OrderDetail { OrderID = 10248, ProductID = 11 })
-                    .ToList());
+    [ConditionalTheory]
+    [MemberData(nameof(IsAsyncData))]
+    public virtual Task Entity_equality_through_subquery_composite_key(bool async)
+        => AssertQuery(
+            async,
+            ss => ss.Set<Order>()
+                .Where(o => o.OrderDetails.FirstOrDefault() == new OrderDetail { OrderID = 10248, ProductID = 11 }));
 
     [ConditionalTheory]
     [MemberData(nameof(IsAsyncData))]
@@ -941,16 +980,13 @@ public virtual Task Any_nested3(bool async)
             ss => ss.Set<Customer>().Where(c => ss.Set<Order>().Any(o => o.CustomerID.StartsWith("A")) && c.City != "London"),
             entryCount: 85);
 
-    [ConditionalFact]
-    public virtual void Any_with_multiple_conditions_still_uses_exists()
-    {
-        using var context = CreateContext();
-        var query = context.Customers
-            .Where(c => c.City == "London" && c.Orders.Any(o => o.EmployeeID == 1))
-            .ToList();
-
-        Assert.Equal(4, query.Count);
-    }
+    [ConditionalTheory]
+    [MemberData(nameof(IsAsyncData))]
+    public virtual Task Any_with_multiple_conditions_still_uses_exists(bool async)
+        => AssertQuery(
+            async,
+            ss => ss.Set<Customer>().Where(c => c.City == "London" && c.Orders.Any(o => o.EmployeeID == 1)),
+            entryCount: 4);
 
     [ConditionalTheory]
     [MemberData(nameof(IsAsyncData))]
@@ -1200,82 +1236,86 @@ public virtual Task Where_subquery_expression_same_parametername(bool async)
             },
             entryCount: 5);
 
-    [ConditionalFact]
-    public virtual void Select_DTO_distinct_translated_to_server()
-    {
-        using var context = CreateContext();
-        var actual = context.Set<Order>()
-            .Where(o => o.OrderID < 10300)
-            .Select(o => new OrderCountDTO())
-            .Distinct().ToList().OrderBy(e => e.Id).ToList();
-
-        var expected = Fixture.GetExpectedData().Set<Order>()
-            .Where(o => o.OrderID < 10300)
-            .Select(o => new OrderCountDTO())
-            .Distinct().ToList().OrderBy(e => e.Id).ToList();
-
-        Assert.Equal(expected.Count, actual.Count);
-        for (var i = 0; i < expected.Count; i++)
-        {
-            Assert.Equal(expected[i].Id, actual[i].Id);
-            Assert.Equal(expected[i].Count, actual[i].Count);
-        }
-    }
-
-    [ConditionalFact]
-    public virtual void Select_DTO_constructor_distinct_translated_to_server()
-    {
-        using var context = CreateContext();
-        var actual = context.Set<Order>()
-            .Where(o => o.OrderID < 10300)
-            .Select(o => new OrderCountDTO(o.CustomerID))
-            .Distinct().ToList().OrderBy(e => e.Id).ToList();
-
-        var expected = Fixture.GetExpectedData().Set<Order>()
-            .Where(o => o.OrderID < 10300)
-            .Select(o => new OrderCountDTO(o.CustomerID))
-            .Distinct().ToList().OrderBy(e => e.Id).ToList();
-
-        Assert.Equal(expected.Count, actual.Count);
-        for (var i = 0; i < expected.Count; i++)
-        {
-            Assert.Equal(expected[i].Id, actual[i].Id);
-            Assert.Equal(expected[i].Count, actual[i].Count);
-        }
-    }
+    [ConditionalTheory]
+    [MemberData(nameof(IsAsyncData))]
+    public virtual Task Select_DTO_distinct_translated_to_server(bool async)
+        => AssertQuery(
+            async,
+            ss => ss.Set<Order>()
+                .Where(o => o.OrderID < 10300)
+                .Select(o => new OrderCountDTO())
+                .Distinct(),
+            elementSorter: e => e.Id,
+            elementAsserter: (e, a) =>
+            {
+                Assert.Equal(e.Id, a.Id);
+                Assert.Equal(e.Count, a.Count);
+            });
 
-    [ConditionalFact]
-    public virtual void Select_DTO_constructor_distinct_with_navigation_translated_to_server()
-    {
-        using var context = CreateContext();
-        var actual = context.Set<Order>()
-            .Where(o => o.OrderID < 10300)
-            .Select(o => new OrderCountDTO(o.Customer.City))
-            .Distinct().ToList().OrderBy(e => e.Id).ToList();
+    [ConditionalTheory]
+    [MemberData(nameof(IsAsyncData))]
+    public virtual Task Select_DTO_constructor_distinct_translated_to_server(bool async)
+        => AssertQuery(
+            async,
+            ss => ss.Set<Order>()
+                .Where(o => o.OrderID < 10300)
+                .Select(o => new OrderCountDTO(o.CustomerID))
+                .Distinct(),
+            elementSorter: e => e.Id,
+            elementAsserter: (e, a) =>
+            {
+                Assert.Equal(e.Id, a.Id);
+                Assert.Equal(e.Count, a.Count);
+            });
 
-        var expected = Fixture.GetExpectedData().Set<Order>()
-            .Where(o => o.OrderID < 10300)
-            .Select(o => new OrderCountDTO(o.Customer.City))
-            .Distinct().ToList().OrderBy(e => e.Id).ToList();
+    [ConditionalTheory]
+    [MemberData(nameof(IsAsyncData))]
+    public virtual Task Select_DTO_constructor_distinct_with_navigation_translated_to_server(bool async)
+        => AssertQuery(
+            async,
+            ss => ss.Set<Order>()
+                .Where(o => o.OrderID < 10300)
+                .Select(o => new OrderCountDTO(o.Customer.City))
+                .Distinct(),
+            elementSorter: e => e.Id,
+            elementAsserter: (e, a) =>
+            {
+                Assert.Equal(e.Id, a.Id);
+                Assert.Equal(e.Count, a.Count);
+            });
 
-        Assert.Equal(expected.Count, actual.Count);
-        for (var i = 0; i < expected.Count; i++)
-        {
-            Assert.Equal(expected[i].Id, actual[i].Id);
-            Assert.Equal(expected[i].Count, actual[i].Count);
-        }
-    }
+    [ConditionalTheory]
+    [MemberData(nameof(IsAsyncData))]
+    public virtual Task Select_DTO_constructor_distinct_with_collection_projection_translated_to_server(bool async)
+        => AssertQuery(
+            async,
+            ss => ss.Set<Order>()
+                .Where(o => o.OrderID < 10300)
+                .Select(o => new { A = new OrderCountDTO(o.CustomerID), o.CustomerID })
+                .Distinct()
+                .Select(e => new { e.A, Orders = ss.Set<Order>().Where(o => o.CustomerID == e.CustomerID).ToList() }),
+            elementSorter: e => e.A.Id,
+            elementAsserter: (e, a) =>
+            {
+                Assert.Equal(e.A.Id, a.A.Id);
+                AssertCollection(e.Orders, a.Orders);
+            },
+            entryCount: 413);
 
-    [ConditionalFact]
-    public virtual void Select_DTO_constructor_distinct_with_collection_projection_translated_to_server()
+    [ConditionalTheory]
+    [MemberData(nameof(IsAsyncData))]
+    public virtual async Task Select_DTO_constructor_distinct_with_collection_projection_translated_to_server_with_binding_after_client_eval(bool async)
     {
         using var context = CreateContext();
-        var actual = context.Set<Order>()
+        var actualQuery = context.Set<Order>()
             .Where(o => o.OrderID < 10300)
             .Select(o => new { A = new OrderCountDTO(o.CustomerID), o.CustomerID })
             .Distinct()
-            .Select(e => new { e.A, Orders = context.Set<Order>().Where(o => o.CustomerID == e.CustomerID).ToList() })
-            .ToList().OrderBy(e => e.A.Id).ToList();
+            .Select(e => new { e.A, Orders = context.Set<Order>().Where(o => o.CustomerID == e.CustomerID).ToList() });
+
+        var actual = async
+            ? (await actualQuery.ToListAsync()).OrderBy(e => e.A.Id).ToList()
+            : actualQuery.ToList().OrderBy(e => e.A.Id).ToList();
 
         var expected = Fixture.GetExpectedData().Set<Order>()
             .Where(o => o.OrderID < 10300)
@@ -1292,52 +1332,36 @@ public virtual void Select_DTO_constructor_distinct_with_collection_projection_t
         }
     }
 
-    [ConditionalFact]
-    public virtual void Select_DTO_with_member_init_distinct_translated_to_server()
-    {
-        using var context = CreateContext();
-        var actual = context.Set<Order>()
-            .Where(o => o.OrderID < 10300)
-            .Select(
-                o => new OrderCountDTO { Id = o.CustomerID, Count = o.OrderID })
-            .Distinct().ToList().OrderBy(e => e.Count).ToList();
-
-        var expected = Fixture.GetExpectedData().Set<Order>()
-            .Where(o => o.OrderID < 10300)
-            .Select(
-                o => new OrderCountDTO { Id = o.CustomerID, Count = o.OrderID })
-            .Distinct().ToList().OrderBy(e => e.Count).ToList();
-
-        Assert.Equal(expected.Count, actual.Count);
-        for (var i = 0; i < expected.Count; i++)
-        {
-            Assert.Equal(expected[i].Id, actual[i].Id);
-            Assert.Equal(expected[i].Count, actual[i].Count);
-        }
-    }
-
-    [ConditionalFact]
-    public virtual void Select_nested_collection_count_using_DTO()
-    {
-        using var context = CreateContext();
-        var actual = context.Set<Customer>()
-            .Where(c => c.CustomerID.StartsWith("A"))
-            .Select(
-                c => new OrderCountDTO { Id = c.CustomerID, Count = c.Orders.Count })
-            .ToList().OrderBy(e => e.Id).ToList();
-
-        var expected = Fixture.GetExpectedData().Set<Customer>()
-            .Where(c => c.CustomerID.StartsWith("A"))
-            .Select(
-                c => new OrderCountDTO { Id = c.CustomerID, Count = c.Orders.Count })
-            .ToList().OrderBy(e => e.Id).ToList();
+    [ConditionalTheory]
+    [MemberData(nameof(IsAsyncData))]
+    public virtual Task Select_DTO_with_member_init_distinct_translated_to_server(bool async)
+        => AssertQuery(
+            async,
+            ss => ss.Set<Order>()
+                .Where(o => o.OrderID < 10300)
+                .Select(o => new OrderCountDTO { Id = o.CustomerID, Count = o.OrderID })
+                .Distinct(),
+            elementSorter: e => e.Count,
+            elementAsserter: (e, a) =>
+            {
+                Assert.Equal(e.Id, a.Id);
+                Assert.Equal(e.Count, a.Count);
+            });
 
-        Assert.Equal(expected.Count, actual.Count);
-        for (var i = 0; i < expected.Count; i++)
-        {
-            Assert.Equal(expected[i], actual[i]);
-        }
-    }
+    [ConditionalTheory]
+    [MemberData(nameof(IsAsyncData))]
+    public virtual Task Select_nested_collection_count_using_DTO(bool async)
+        => AssertQuery(
+            async,
+            ss => ss.Set<Customer>()
+                .Where(c => c.CustomerID.StartsWith("A"))
+                .Select(c => new OrderCountDTO { Id = c.CustomerID, Count = c.Orders.Count }),
+            elementSorter: e => e.Id,
+            elementAsserter: (e, a) =>
+            {
+                Assert.Equal(e.Id, a.Id);
+                Assert.Equal(e.Count, a.Count);
+            });
 
     [ConditionalTheory]
     [MemberData(nameof(IsAsyncData))]
@@ -1367,32 +1391,25 @@ public virtual Task Select_DTO_with_member_init_distinct_in_subquery_translated_
                 select c,
             entryCount: 35);
 
-    [ConditionalFact]
-    public virtual void Select_DTO_with_member_init_distinct_in_subquery_used_in_projection_translated_to_server()
-    {
-        using var context = CreateContext();
-        var actual = (from c in context.Set<Customer>().Where(c => c.CustomerID.StartsWith("A"))
-                      from o in context.Set<Order>().Where(o => o.OrderID < 10300)
-                          .Select(
-                              o => new OrderCountDTO { Id = o.CustomerID, Count = o.OrderID })
-                          .Distinct()
-                      select new { c, o }).ToList().OrderBy(e => e.c.CustomerID + " " + e.o.Count).ToList();
-
-        var expected = (from c in Fixture.GetExpectedData().Set<Customer>().Where(c => c.CustomerID.StartsWith("A"))
-                        from o in Fixture.GetExpectedData().Set<Order>().Where(o => o.OrderID < 10300)
-                            .Select(
-                                o => new OrderCountDTO { Id = o.CustomerID, Count = o.OrderID })
-                            .Distinct()
-                        select new { c, o }).ToList().OrderBy(e => e.c.CustomerID + " " + e.o.Count).ToList();
-
-        Assert.Equal(expected.Count, actual.Count);
-        for (var i = 0; i < expected.Count; i++)
-        {
-            Assert.Equal(expected[i].c.CustomerID, actual[i].c.CustomerID);
-            Assert.Equal(expected[i].o.Id, actual[i].o.Id);
-            Assert.Equal(expected[i].o.Count, actual[i].o.Count);
-        }
-    }
+    [ConditionalTheory]
+    [MemberData(nameof(IsAsyncData))]
+    public virtual Task Select_DTO_with_member_init_distinct_in_subquery_used_in_projection_translated_to_server(bool async)
+        => AssertQuery(
+            async,
+            ss => from c in ss.Set<Customer>().Where(c => c.CustomerID.StartsWith("A"))
+                  from o in ss.Set<Order>()
+                    .Where(o => o.OrderID < 10300)
+                    .Select(o => new OrderCountDTO { Id = o.CustomerID, Count = o.OrderID })
+                    .Distinct()
+                  select new { c, o },
+            elementSorter: e => (e.c.CustomerID, e.o.Count),
+            elementAsserter: (e, a) =>
+            {
+                Assert.Equal(e.c.CustomerID, a.c.CustomerID);
+                Assert.Equal(e.o.Id, a.o.Id);
+                Assert.Equal(e.o.Count, a.o.Count);
+            },
+            entryCount: 4);
 
     private class OrderCountDTO
     {
@@ -2622,14 +2639,14 @@ public virtual Task OrderBy_ternary_conditions(bool async)
             assertOrder: true,
             entryCount: 77);
 
-    [ConditionalFact]
-    public virtual void OrderBy_any()
-    {
-        using var context = CreateContext();
-        var query = context.Customers.OrderBy(p => p.Orders.Any(o => o.OrderID > 11000)).ThenBy(p => p.CustomerID).ToList();
-
-        Assert.Equal(91, query.Count);
-    }
+    [ConditionalTheory]
+    [MemberData(nameof(IsAsyncData))]
+    public virtual Task OrderBy_any(bool async)
+        => AssertQuery(
+            async,
+            ss => ss.Set<Customer>().OrderBy(p => p.Orders.Any(o => o.OrderID > 11000)).ThenBy(p => p.CustomerID),
+            assertOrder: true,
+            entryCount: 91);
 
     [ConditionalTheory]
     [MemberData(nameof(IsAsyncData))]
@@ -2928,17 +2945,15 @@ public virtual async Task Where_Property_shadow_closure(bool async)
             entryCount: 1);
     }
 
-    [ConditionalFact]
-    public virtual void Selected_column_can_coalesce()
-    {
-        using var context = CreateContext();
-        var customers = (from c in context.Set<Customer>()
-                         orderby c.Region ?? "ZZ"
-                         select c)
-            .ToList();
-
-        Assert.Equal(91, customers.Count);
-    }
+    [ConditionalTheory]
+    [MemberData(nameof(IsAsyncData))]
+    public virtual Task Selected_column_can_coalesce(bool async)
+        => AssertQuery(
+            async,
+            ss => (from c in ss.Set<Customer>()
+                  orderby c.Region ?? "ZZ"
+                  select c).Select(x => x),
+            entryCount: 91);
 
     [ConditionalFact]
     public virtual void Can_cast_CreateQuery_result_to_IQueryable_T_bug_1730()
@@ -2950,96 +2965,85 @@ public virtual void Can_cast_CreateQuery_result_to_IQueryable_T_bug_1730()
         products = (IQueryable<Product>)products.Provider.CreateQuery(products.Expression);
     }
 
-    [ConditionalFact]
-    public virtual void Select_Subquery_Single()
-    {
-        using var context = CreateContext();
-        var orderDetails
-            = (from od in context.Set<OrderDetail>()
-               orderby od.ProductID, od.OrderID
-               select (from o in context.Set<Order>()
-                       where od.OrderID == o.OrderID
-                       orderby o.OrderID
-                       select o).First())
-            .Take(2)
-            .ToList();
-
-        Assert.Equal(2, orderDetails.Count);
-    }
+    [ConditionalTheory]
+    [MemberData(nameof(IsAsyncData))]
+    public virtual Task Select_Subquery_Single(bool async)
+        => AssertQuery(
+            async,
+            ss => (from od in ss.Set<OrderDetail>()
+                   orderby od.ProductID, od.OrderID
+                   select (from o in ss.Set<Order>()
+                           where od.OrderID == o.OrderID
+                           orderby o.OrderID
+                           select o).First()).Take(2),
+            entryCount: 2);
 
-    [ConditionalFact]
-    public virtual void Select_Where_Subquery_Deep_Single()
-    {
-        using var context = CreateContext();
-        var orderDetails
-            = (from od in context.Set<OrderDetail>().Where(od => od.OrderID == 10344)
-               where (
-                       from o in context.Set<Order>()
-                       where od.OrderID == o.OrderID
-                       select (
-                           from c in context.Set<Customer>()
-                           where o.CustomerID == c.CustomerID
-                           select c
+    [ConditionalTheory]
+    [MemberData(nameof(IsAsyncData))]
+    public virtual Task Select_Where_Subquery_Deep_Single(bool async)
+        => AssertQuery(
+            async,
+            ss => (from od in ss.Set<OrderDetail>().Where(od => od.OrderID == 10344)
+                   where (
+                           from o in ss.Set<Order>()
+                           where od.OrderID == o.OrderID
+                           select (
+                               from c in ss.Set<Customer>()
+                               where o.CustomerID == c.CustomerID
+                               select c
+                           ).Single()
                        ).Single()
-                   ).Single()
-                   .City
-                   == "Seattle"
-               select od)
-            .Take(2)
-            .ToList();
-
-        Assert.Equal(2, orderDetails.Count);
-    }
+                       .City
+                       == "Seattle"
+                   select od)
+            .Take(2),
+            entryCount: 2);
 
-    [ConditionalFact]
-    public virtual void Select_Where_Subquery_Deep_First()
-    {
-        using var context = CreateContext();
-        var orderDetails
-            = (from od in context.Set<OrderDetail>()
-               where (
-                       from o in context.Set<Order>()
-                       where od.OrderID == o.OrderID
-                       select (
-                           from c in context.Set<Customer>()
-                           where o.CustomerID == c.CustomerID
-                           select c
+    [ConditionalTheory]
+    [MemberData(nameof(IsAsyncData))]
+    public virtual Task Select_Where_Subquery_Deep_First(bool async)
+        => AssertQuery(
+            async,
+            ss => (from od in ss.Set<OrderDetail>()
+                   where (
+                           from o in ss.Set<Order>()
+                           where od.OrderID == o.OrderID
+                           select (
+                               from c in ss.Set<Customer>()
+                               where o.CustomerID == c.CustomerID
+                               select c
+                           ).FirstOrDefault()
                        ).FirstOrDefault()
-                   ).FirstOrDefault()
-                   .City
-                   == "Seattle"
-               select od)
-            .Take(2)
-            .ToList();
-
-        Assert.Equal(2, orderDetails.Count);
-    }
+                       .City
+                       == "Seattle"
+                   select od)
+            .Take(2),
+            entryCount: 2);
 
-    [ConditionalFact]
-    public virtual void Select_Where_Subquery_Equality()
-    {
-        using var context = CreateContext();
-        var orders
-            = (from o in context.Orders.OrderBy(o => o.OrderID).Take(1)
-               // ReSharper disable once UseMethodAny.0
-               where (from od in context.OrderDetails.OrderBy(od => od.OrderID).Take(2)
-                      where (from c in context.Set<Customer>()
-                             where c.CustomerID == o.CustomerID
-                             orderby c.CustomerID
-                             select c).First().Country
-                          == (from o2 in context.Set<Order>()
-                              join c in context.Set<Customer>() on o2.CustomerID equals c.CustomerID
-                              where o2.OrderID == od.OrderID
-                              orderby o2.OrderID, c.CustomerID
-                              select c).First().Country
-                      orderby od.ProductID, od.OrderID
-                      select od).Count()
-                   > 0
-               orderby o.OrderID
-               select o).ToList();
-
-        Assert.Single(orders);
-    }
+    [ConditionalTheory]
+    [MemberData(nameof(IsAsyncData))]
+    public virtual Task Select_Where_Subquery_Equality(bool async)
+        => AssertQuery(
+            async,
+            ss => from o in ss.Set<Order>().OrderBy(o => o.OrderID).Take(1)
+                      // ReSharper disable once UseMethodAny.0
+                  where (from od in ss.Set<OrderDetail>().OrderBy(od => od.OrderID).Take(2)
+                         where (from c in ss.Set<Customer>()
+                                where c.CustomerID == o.CustomerID
+                                orderby c.CustomerID
+                                select c).First().Country
+                             == (from o2 in ss.Set<Order>()
+                                 join c in ss.Set<Customer>() on o2.CustomerID equals c.CustomerID
+                                 where o2.OrderID == od.OrderID
+                                 orderby o2.OrderID, c.CustomerID
+                                 select c).First().Country
+                         orderby od.ProductID, od.OrderID
+                         select od).Count()
+                      > 0
+                  orderby o.OrderID
+                  select o,
+            assertOrder: true,
+            entryCount: 1);
 
     [ConditionalTheory]
     [MemberData(nameof(IsAsyncData))]
@@ -3487,30 +3491,32 @@ public virtual async Task Parameter_extraction_short_circuits_3(bool async)
             entryCount: 830);
     }
 
-    [ConditionalFact]
-    public virtual void Parameter_extraction_can_throw_exception_from_user_code()
+    [ConditionalTheory]
+    [MemberData(nameof(IsAsyncData))]
+    public virtual Task Parameter_extraction_can_throw_exception_from_user_code(bool async)
     {
-        using var context = CreateContext();
         var customer = new Customer();
 
-        Assert.Throws<InvalidOperationException>(
-            () => context.Customers.Where(c => Equals(c.Orders.First(), customer.Orders.First())).ToList());
+        return Assert.ThrowsAsync<InvalidOperationException>(
+            () => AssertQuery(
+                async,
+                ss => ss.Set<Customer>().Where(c => Equals(c.Orders.First(), customer.Orders.First()))));
     }
 
-    [ConditionalFact]
-    public virtual void Parameter_extraction_can_throw_exception_from_user_code_2()
+    [ConditionalTheory]
+    [MemberData(nameof(IsAsyncData))]
+    public virtual Task Parameter_extraction_can_throw_exception_from_user_code_2(bool async)
     {
-        using var context = CreateContext();
         DateTime? dateFilter = null;
 
-        Assert.Throws<InvalidOperationException>(
-            () => context.Orders
-                .Where(
-                    o => (o.OrderID < 10400)
-                        && ((o.OrderDate.HasValue
-                            && o.OrderDate.Value.Month == dateFilter.Value.Month
-                            && o.OrderDate.Value.Year == dateFilter.Value.Year)))
-                .ToList());
+        return Assert.ThrowsAsync<InvalidOperationException>(
+            () => AssertQuery(
+                async,
+                ss => ss.Set<Order>()
+                    .Where(o => (o.OrderID < 10400)
+                        && o.OrderDate.HasValue
+                        && o.OrderDate.Value.Month == dateFilter.Value.Month
+                        && o.OrderDate.Value.Year == dateFilter.Value.Year)));
     }
 
     [ConditionalTheory]
@@ -4671,27 +4677,6 @@ public virtual Task OrderBy_Dto_projection_skip_take(bool async)
                 .Take(10),
             elementSorter: e => e.Id);
 
-    [ConditionalFact]
-    public virtual void Streaming_chained_sync_query()
-    {
-        using var context = CreateContext();
-        var results
-            = (context.Customers
-                .Select(
-                    c => new { c.CustomerID, Orders = context.Orders.Where(o => o.Customer.CustomerID == c.CustomerID).ToList() })
-                .ToList())
-            .Select(
-                x => new
-                {
-                    Orders = x.Orders
-                        .GroupJoin(
-                            new[] { "ALFKI" }, y => x.CustomerID, y => y, (h, id) => new { h.Customer })
-                })
-            .ToList();
-
-        Assert.Equal(830, results.SelectMany(r => r.Orders).ToList().Count);
-    }
-
     [ConditionalTheory]
     [MemberData(nameof(IsAsyncData))]
     public virtual Task Join_take_count_works(bool async)
@@ -4727,8 +4712,9 @@ public virtual Task OrderBy_empty_list_does_not_contains(bool async)
             entryCount: 91);
     }
 
-    [ConditionalFact]
-    public virtual void Manual_expression_tree_typed_null_equality()
+    [ConditionalTheory]
+    [MemberData(nameof(IsAsyncData))]
+    public virtual Task Manual_expression_tree_typed_null_equality(bool async)
     {
         using var context = CreateContext();
         var orderParameter = Expression.Parameter(typeof(Order), "o");
@@ -4746,11 +4732,11 @@ public virtual void Manual_expression_tree_typed_null_equality()
                 Expression.Constant(null, typeof(string))),
             orderParameter);
 
-        var query = context.Orders
-            .Where(o => o.OrderID < 10300)
-            .Select(selector).ToList();
-
-        // No verification. Query Compilation check.
+        return AssertQuery(
+            async,
+            ss => ss.Set<Order>()
+                .Where(o => o.OrderID < 10300)
+                .Select(selector));
     }
 
     [ConditionalTheory]
diff --git a/test/EFCore.Specification.Tests/Query/NorthwindNavigationsQueryTestBase.cs b/test/EFCore.Specification.Tests/Query/NorthwindNavigationsQueryTestBase.cs
index 718a200521..c02af6a6e2 100644
--- a/test/EFCore.Specification.Tests/Query/NorthwindNavigationsQueryTestBase.cs
+++ b/test/EFCore.Specification.Tests/Query/NorthwindNavigationsQueryTestBase.cs
@@ -89,18 +89,6 @@ where o.Customer.City.Contains("Sea")
                   select o,
             entryCount: 14);
 
-    [ConditionalFact]
-    public virtual async Task Select_Where_Navigation_Async()
-    {
-        using var context = CreateContext();
-        var orders
-            = await (from o in context.Set<Order>()
-                     where o.Customer.City == "Seattle"
-                     select o).ToListAsync();
-
-        Assert.Equal(14, orders.Count);
-    }
-
     [ConditionalTheory]
     [MemberData(nameof(IsAsyncData))]
     public virtual Task Select_Where_Navigation_Scalar_Equals_Navigation_Scalar(bool async)
@@ -324,20 +312,6 @@ public virtual Task Select_Singleton_Navigation_With_Member_Access(bool async)
             elementSorter: e => e.A + " " + e.B,
             entryCount: 1);
 
-    [ConditionalFact]
-    public virtual async Task Select_Singleton_Navigation_With_Member_Access_Async()
-    {
-        using var context = CreateContext();
-        var orders
-            = await (from o in context.Set<Order>()
-                     where o.Customer.City == "Seattle"
-                     where o.Customer.Phone != "555 555 5555"
-                     select new { A = o.Customer, B = o.Customer.City }).ToListAsync();
-
-        Assert.Equal(14, orders.Count);
-        Assert.True(orders.All(o => (o.A != null) && (o.B != null)));
-    }
-
     [ConditionalTheory]
     [MemberData(nameof(IsAsyncData))]
     public virtual Task Select_Where_Navigation_Multiple_Access(bool async)
@@ -681,18 +655,6 @@ public virtual Task Collection_where_nav_prop_sum(bool async)
                   select c,
             entryCount: 89);
 
-    [ConditionalFact]
-    public virtual async Task Collection_where_nav_prop_sum_async()
-    {
-        using var context = CreateContext();
-        var customers
-            = await (from c in context.Set<Customer>()
-                     where c.Orders.Sum(o => o.OrderID) > 1000
-                     select c).ToListAsync();
-
-        Assert.Equal(89, customers.Count);
-    }
-
     [ConditionalTheory]
     [MemberData(nameof(IsAsyncData))]
     public virtual Task Collection_select_nav_prop_first_or_default(bool async)
@@ -864,41 +826,35 @@ orderby c.CustomerID
     private static int ClientMethod(int argument)
         => argument;
 
-    [ConditionalFact]
-    public virtual void Navigation_in_subquery_referencing_outer_query()
-    {
-        using var context = CreateContext();
-        var query = from o in context.Orders
-                    // ReSharper disable once UseMethodAny.0
-                    where (from od in context.OrderDetails
-                           where o.Customer.Country == od.Order.Customer.Country
-                           select od).Count()
-                        > 0
-                    where o.OrderID == 10643 || o.OrderID == 10692
-                    select o;
-
-        var result = query.ToList();
-
-        Assert.Equal(2, result.Count);
-    }
+    [ConditionalTheory]
+    [MemberData(nameof(IsAsyncData))]
+    public virtual Task Navigation_in_subquery_referencing_outer_query(bool async)
+        => AssertQuery(
+            async,
+            ss => from o in ss.Set<Order>()
+                  // ReSharper disable once UseMethodAny.0
+                  where (from od in ss.Set<OrderDetail>()
+                         where o.Customer.Country == od.Order.Customer.Country
+                         select od).Count()
+                      > 0
+                  where o.OrderID == 10643 || o.OrderID == 10692
+                  select o,
+            entryCount: 2);
 
-    [ConditionalFact]
-    public virtual void Navigation_in_subquery_referencing_outer_query_with_client_side_result_operator_and_count()
-    {
-        using var context = CreateContext();
-        var query = from o in context.Orders
-                    where o.OrderID == 10643 || o.OrderID == 10692
-                    // ReSharper disable once UseMethodAny.0
-                    where (from od in context.OrderDetails
-                           where o.Customer.Country == od.Order.Customer.Country
-                           select od).Distinct().Count()
-                        > 0
-                    select o;
-
-        var result = query.ToList();
-
-        Assert.Equal(2, result.Count);
-    }
+    [ConditionalTheory]
+    [MemberData(nameof(IsAsyncData))]
+    public virtual Task Navigation_in_subquery_referencing_outer_query_with_client_side_result_operator_and_count(bool async)
+        => AssertQuery(
+            async,
+            ss => from o in ss.Set<Order>()
+                  where o.OrderID == 10643 || o.OrderID == 10692
+                  // ReSharper disable once UseMethodAny.0
+                  where (from od in ss.Set<OrderDetail>()
+                         where o.Customer.Country == od.Order.Customer.Country
+                         select od).Distinct().Count()
+                      > 0
+                  select o,
+            entryCount: 2);
 
     [ConditionalTheory]
     [MemberData(nameof(IsAsyncData))]
diff --git a/test/EFCore.Specification.Tests/Query/NorthwindQueryFixtureBase.cs b/test/EFCore.Specification.Tests/Query/NorthwindQueryFixtureBase.cs
index 1d72a02e82..64f4918f2b 100644
--- a/test/EFCore.Specification.Tests/Query/NorthwindQueryFixtureBase.cs
+++ b/test/EFCore.Specification.Tests/Query/NorthwindQueryFixtureBase.cs
@@ -76,11 +76,13 @@ public virtual ISetSource GetFilteredExpectedData(DbContext context)
         {
             { typeof(Customer), e => ((Customer)e)?.CustomerID },
             { typeof(CustomerQuery), e => ((CustomerQuery)e)?.CompanyName },
+            { typeof(CustomerQueryWithQueryFilter), e => ((CustomerQueryWithQueryFilter)e)?.CompanyName },
             { typeof(Order), e => ((Order)e)?.OrderID },
             { typeof(OrderQuery), e => ((OrderQuery)e)?.CustomerID },
             { typeof(Employee), e => ((Employee)e)?.EmployeeID },
             { typeof(Product), e => ((Product)e)?.ProductID },
             { typeof(ProductQuery), e => ((ProductQuery)e)?.ProductID },
+            { typeof(ProductView), e => ((ProductView)e)?.ProductID },
             { typeof(OrderDetail), e => (((OrderDetail)e)?.OrderID.ToString(), ((OrderDetail)e)?.ProductID.ToString()) }
         }.ToDictionary(e => e.Key, e => (object)e.Value);
 
@@ -127,6 +129,22 @@ public virtual ISetSource GetFilteredExpectedData(DbContext context)
                     }
                 }
             },
+            {
+                typeof(CustomerQueryWithQueryFilter), (e, a) =>
+                {
+                    Assert.Equal(e == null, a == null);
+
+                    if (a != null)
+                    {
+                        var ee = (CustomerQueryWithQueryFilter)e;
+                        var aa = (CustomerQueryWithQueryFilter)a;
+
+                        Assert.Equal(ee.CompanyName, aa.CompanyName);
+                        Assert.Equal(ee.SearchTerm, aa.SearchTerm);
+                        Assert.Equal(ee.OrderCount, aa.OrderCount);
+                    }
+                }
+            },
             {
                 typeof(Order), (e, a) =>
                 {
@@ -210,6 +228,22 @@ public virtual ISetSource GetFilteredExpectedData(DbContext context)
                     }
                 }
             },
+            {
+                typeof(ProductView), (e, a) =>
+                {
+                    Assert.Equal(e == null, a == null);
+
+                    if (a != null)
+                    {
+                        var ee = (ProductView)e;
+                        var aa = (ProductView)a;
+
+                        Assert.Equal(ee.ProductID, aa.ProductID);
+                        Assert.Equal(ee.CategoryName, aa.CategoryName);
+                        Assert.Equal(ee.ProductName, aa.ProductName);
+                    }
+                }
+            },
             {
                 typeof(OrderDetail), (e, a) =>
                 {
diff --git a/test/EFCore.Specification.Tests/Query/NorthwindSelectQueryTestBase.cs b/test/EFCore.Specification.Tests/Query/NorthwindSelectQueryTestBase.cs
index 638ac97828..b96dd420aa 100644
--- a/test/EFCore.Specification.Tests/Query/NorthwindSelectQueryTestBase.cs
+++ b/test/EFCore.Specification.Tests/Query/NorthwindSelectQueryTestBase.cs
@@ -403,139 +403,130 @@ select ss.Set<Order>()
             assertOrder: true,
             elementAsserter: (e, a) => AssertCollection(e, a, ordered: true));
 
-    [ConditionalFact]
-    public virtual void Select_nested_collection_multi_level()
-    {
-        using var context = CreateContext();
-        var customers = context.Customers
-            .Where(c => c.CustomerID.StartsWith("A"))
-            .Select(
-                c => new
+    [ConditionalTheory]
+    [MemberData(nameof(IsAsyncData))]
+    public virtual Task Select_nested_collection_multi_level(bool async)
+        => AssertQuery(
+            async,
+            ss => ss.Set<Customer>()
+                .OrderBy(c => c.CustomerID)
+                .Where(c => c.CustomerID.StartsWith("A"))
+                .Select(c => new
                 {
                     OrderDates = c.Orders
                         .Where(o => o.OrderID < 10500)
+                        .OrderBy(o => o.OrderID)
                         .Take(3)
-                        .Select(
-                            o => new { Date = o.OrderDate })
-                })
-            .ToList();
-
-        Assert.Equal(4, customers.Count);
-        Assert.All(customers, t => Assert.True(t.OrderDates.Count() <= 3));
-    }
+                        .Select(o => new { Date = o.OrderDate })
+                }),
+            assertOrder: true,
+            elementAsserter: (e, a) => AssertCollection(e.OrderDates, a.OrderDates, ordered: true));
 
-    [ConditionalFact]
-    public virtual void Select_nested_collection_multi_level2()
-    {
-        using var context = CreateContext();
-        var customers = context.Customers
-            .Where(c => c.CustomerID.StartsWith("A"))
-            .Select(
-                c => new
+    [ConditionalTheory]
+    [MemberData(nameof(IsAsyncData))]
+    public virtual Task Select_nested_collection_multi_level2(bool async)
+        => AssertQuery(
+            async,
+            ss => ss.Set<Customer>()
+                .OrderBy(c => c.CustomerID)
+                .Where(c => c.CustomerID.StartsWith("A"))
+                .Select(c => new
                 {
                     OrderDates = c.Orders
+                        .OrderBy(o => o.OrderID)
                         .Where(o => o.OrderID < 10500)
                         .Select(o => o.OrderDate)
                         .FirstOrDefault()
-                })
-            .ToList();
-
-        Assert.Equal(4, customers.Count);
-        Assert.Equal(3, customers.Count(c => c.OrderDates != null));
-    }
+                }),
+            assertOrder: true);
 
-    [ConditionalFact]
-    public virtual void Select_nested_collection_multi_level3()
-    {
-        using var context = CreateContext();
-        var customers = context.Customers
-            .Where(c => c.CustomerID.StartsWith("A"))
-            .Select(
-                c => new
+    [ConditionalTheory]
+    [MemberData(nameof(IsAsyncData))]
+    public virtual Task Select_nested_collection_multi_level3(bool async)
+        => AssertQuery(
+            async,
+            ss => ss.Set<Customer>()
+                .OrderBy(c => c.CustomerID)
+                .Where(c => c.CustomerID.StartsWith("A"))
+                .Select(c => new
                 {
-                    OrderDates = context.Orders
+                    OrderDates = ss.Set<Order>()
+                        .OrderBy(o => o.OrderID)
                         .Where(o => o.OrderID < 10500)
                         .Where(o => c.CustomerID == o.CustomerID)
                         .Select(o => o.OrderDate)
                         .FirstOrDefault()
-                })
-            .ToList();
-
-        Assert.Equal(4, customers.Count);
-        Assert.Equal(3, customers.Count(c => c.OrderDates != null));
-    }
+                }),
+            assertOrder: true);
 
-    [ConditionalFact]
-    public virtual void Select_nested_collection_multi_level4()
-    {
-        using var context = CreateContext();
-        var customers = context.Customers
-            .Where(c => c.CustomerID.StartsWith("A"))
-            .Select(
-                c => new
+    [ConditionalTheory]
+    [MemberData(nameof(IsAsyncData))]
+    public virtual Task Select_nested_collection_multi_level4(bool async)
+        => AssertQuery(
+            async,
+            ss => ss.Set<Customer>()
+                .OrderBy(c => c.CustomerID)
+                .Where(c => c.CustomerID.StartsWith("A"))
+                .Select(c => new
                 {
                     Order = (int?)c.Orders
+                        .OrderBy(o => o.OrderID)
                         .Where(o => o.OrderID < 10500)
-                        .Select(
-                            o => o.OrderDetails
-                                .Where(od => od.OrderID > 10)
-                                .Select(od => od.ProductID)
-                                .Count())
+                        .Select(o => o.OrderDetails
+                            .Where(od => od.OrderID > 10)
+                            .Select(od => od.ProductID)
+                            .Count())
                         .FirstOrDefault()
-                })
-            .ToList();
-
-        Assert.Equal(4, customers.Count);
-        Assert.Equal(3, customers.Count(c => c.Order != null && c.Order != 0));
-    }
+                }),
+            assertOrder: true);
 
-    [ConditionalFact]
-    public virtual void Select_nested_collection_multi_level5()
-    {
-        using var context = CreateContext();
-        var customers = context.Customers
-            .Where(c => c.CustomerID.StartsWith("A"))
-            .Select(
-                c => new
+    [ConditionalTheory]
+    [MemberData(nameof(IsAsyncData))]
+    public virtual Task Select_nested_collection_multi_level5(bool async)
+        => AssertQuery(
+            async,
+            ss => ss.Set<Customer>()
+                .OrderBy(c => c.CustomerID)
+                .Where(c => c.CustomerID.StartsWith("A"))
+                .Select(c => new
                 {
                     Order = (int?)c.Orders
+                        .OrderBy(o => o.OrderID)
                         .Where(o => o.OrderID < 10500)
                         .Select(
                             o => o.OrderDetails
+                                .OrderBy(od => od.OrderID)
+                                .ThenBy(od => od.ProductID)
                                 .Where(od => od.OrderID != c.Orders.Count)
                                 .Select(od => od.ProductID)
                                 .FirstOrDefault())
                         .FirstOrDefault()
-                })
-            .ToList();
-
-        Assert.Equal(4, customers.Count);
-        Assert.Equal(3, customers.Count(c => c.Order != null && c.Order != 0));
-    }
+                }),
+            assertOrder: true);
 
-    [ConditionalFact]
-    public virtual void Select_nested_collection_multi_level6()
-    {
-        using var context = CreateContext();
-        var customers = context.Customers
-            .Where(c => c.CustomerID.StartsWith("A"))
-            .Select(
-                c => new
+    [ConditionalTheory]
+    [MemberData(nameof(IsAsyncData))]
+    public virtual Task Select_nested_collection_multi_level6(bool async)
+        => AssertQuery(
+            async,
+            ss => ss.Set<Customer>()
+                .OrderBy(c => c.CustomerID)
+                .Where(c => c.CustomerID.StartsWith("A"))
+                .Select(c => new
                 {
                     Order = (int?)c.Orders
+                        .OrderBy(o => o.OrderID)
                         .Where(o => o.OrderID < 10500)
                         .Select(
                             o => o.OrderDetails
+                                .OrderBy(od => od.OrderID)
+                                .ThenBy(od => od.ProductID)
                                 .Where(od => od.OrderID != c.CustomerID.Length)
                                 .Select(od => od.ProductID)
                                 .FirstOrDefault())
                         .FirstOrDefault()
-                })
-            .ToList();
-
-        Assert.Equal(4, customers.Count);
-        Assert.Equal(3, customers.Count(c => c.Order != null && c.Order != 0));
-    }
+                }),
+            assertOrder: true);
 
     [ConditionalTheory]
     [MemberData(nameof(IsAsyncData))]
diff --git a/test/EFCore.Specification.Tests/Query/NorthwindSetOperationsQueryTestBase.cs b/test/EFCore.Specification.Tests/Query/NorthwindSetOperationsQueryTestBase.cs
index 8fbd6e5842..a72a933a87 100644
--- a/test/EFCore.Specification.Tests/Query/NorthwindSetOperationsQueryTestBase.cs
+++ b/test/EFCore.Specification.Tests/Query/NorthwindSetOperationsQueryTestBase.cs
@@ -380,44 +380,46 @@ public virtual Task Select_Except_reference_projection(bool async)
                         .Select(o => o.Customer)),
             entryCount: 88);
 
-    [ConditionalFact]
-    public virtual void Include_Union_only_on_one_side_throws()
+    [ConditionalTheory]
+    [MemberData(nameof(IsAsyncData))]
+    public virtual async Task Include_Union_only_on_one_side_throws(bool async)
     {
-        using var ctx = CreateContext();
-        Assert.Throws<InvalidOperationException>(
-            () =>
-                ctx.Customers
+        var message1 = (await Assert.ThrowsAsync<InvalidOperationException>(
+            () => AssertQuery(
+                async,
+                ss => ss.Set<Customer>()
                     .Where(c => c.City == "Berlin")
                     .Include(c => c.Orders)
-                    .Union(ctx.Customers.Where(c => c.City == "London"))
-                    .ToList());
+                    .Union(ss.Set<Customer>().Where(c => c.City == "London"))))).Message;
 
-        Assert.Throws<InvalidOperationException>(
-            () =>
-                ctx.Customers
+        Assert.Equal(CoreStrings.SetOperationWithDifferentIncludesInOperands, message1);
+
+        var message2 = (await Assert.ThrowsAsync<InvalidOperationException>(
+            () => AssertQuery(
+                async,
+                ss => ss.Set<Customer>()
                     .Where(c => c.City == "Berlin")
-                    .Union(
-                        ctx.Customers
-                            .Where(c => c.City == "London")
-                            .Include(c => c.Orders))
-                    .ToList());
+                    .Union(ss.Set<Customer>().Where(c => c.City == "London").Include(c => c.Orders))))).Message;
+
+        Assert.Equal(CoreStrings.SetOperationWithDifferentIncludesInOperands, message2);
     }
 
-    [ConditionalFact]
-    public virtual void Include_Union_different_includes_throws()
+    [ConditionalTheory]
+    [MemberData(nameof(IsAsyncData))]
+    public virtual async Task Include_Union_different_includes_throws(bool async)
     {
-        using var ctx = CreateContext();
-        Assert.Throws<InvalidOperationException>(
-            () =>
-                ctx.Customers
+        var message = (await Assert.ThrowsAsync<InvalidOperationException>(
+            () => AssertQuery(
+                async,
+                ss => ss.Set<Customer>()
                     .Where(c => c.City == "Berlin")
                     .Include(c => c.Orders)
-                    .Union(
-                        ctx.Customers
-                            .Where(c => c.City == "London")
-                            .Include(c => c.Orders)
-                            .ThenInclude(o => o.OrderDetails))
-                    .ToList());
+                    .Union(ss.Set<Customer>()
+                        .Where(c => c.City == "London")
+                        .Include(c => c.Orders)
+                        .ThenInclude(o => o.OrderDetails))))).Message;
+
+        Assert.Equal(CoreStrings.SetOperationWithDifferentIncludesInOperands, message);
     }
 
     [ConditionalTheory]
diff --git a/test/EFCore.Specification.Tests/Query/NorthwindWhereQueryTestBase.cs b/test/EFCore.Specification.Tests/Query/NorthwindWhereQueryTestBase.cs
index 525ed78edc..c0009e3327 100644
--- a/test/EFCore.Specification.Tests/Query/NorthwindWhereQueryTestBase.cs
+++ b/test/EFCore.Specification.Tests/Query/NorthwindWhereQueryTestBase.cs
@@ -305,54 +305,28 @@ public virtual async Task Where_nested_property_access_closure_via_query_cache(b
             entryCount: 1);
     }
 
-    [ConditionalFact]
-    public virtual void Where_nested_field_access_closure_via_query_cache_error_null()
-    {
-        var city = new City();
-
-        using var context = CreateContext();
-        Assert.Throws<InvalidOperationException>(
-            () => context.Set<Customer>()
-                .Where(c => c.City == city.Nested.InstanceFieldValue)
-                .ToList());
-    }
-
-    [ConditionalFact]
-    public virtual async Task Where_nested_field_access_closure_via_query_cache_error_null_async()
-    {
-        var city = new City();
-
-        using var context = CreateContext();
-        await Assert.ThrowsAsync<InvalidOperationException>(
-            async () =>
-                await context.Set<Customer>()
-                    .Where(c => c.City == city.Nested.InstanceFieldValue)
-                    .ToListAsync());
-    }
-
-    [ConditionalFact]
-    public virtual void Where_nested_field_access_closure_via_query_cache_error_method_null()
+    [ConditionalTheory]
+    [MemberData(nameof(IsAsyncData))]
+    public virtual Task Where_nested_field_access_closure_via_query_cache_error_null(bool async)
     {
         var city = new City();
 
-        using var context = CreateContext();
-        Assert.Throws<InvalidOperationException>(
-            () => context.Set<Customer>()
-                .Where(c => c.City == city.Throw().InstanceFieldValue)
-                .ToList());
+        return Assert.ThrowsAsync<InvalidOperationException>(
+            () => AssertQuery(
+                async,
+                ss => ss.Set<Customer>().Where(c => c.City == city.Nested.InstanceFieldValue)));
     }
 
-    [ConditionalFact]
-    public virtual async Task Where_nested_field_access_closure_via_query_cache_error_method_null_async()
+    [ConditionalTheory]
+    [MemberData(nameof(IsAsyncData))]
+    public virtual Task Where_nested_field_access_closure_via_query_cache_error_method_null(bool async)
     {
         var city = new City();
 
-        using var context = CreateContext();
-        await Assert.ThrowsAsync<InvalidOperationException>(
-            async () =>
-                await context.Set<Customer>()
-                    .Where(c => c.City == city.Throw().InstanceFieldValue)
-                    .ToListAsync());
+        return Assert.ThrowsAsync<InvalidOperationException>(
+            () => AssertQuery(
+                async,
+                ss => ss.Set<Customer>().Where(c => c.City == city.Throw().InstanceFieldValue)));
     }
 
     [ConditionalTheory]
@@ -464,8 +438,9 @@ public virtual async Task Where_simple_closure_via_query_cache_nullable_type_rev
             entryCount: 5);
     }
 
-    [ConditionalFact]
-    public virtual void Where_subquery_closure_via_query_cache()
+    [ConditionalTheory]
+    [MemberData(nameof(IsAsyncData))]
+    public virtual async Task Where_subquery_closure_via_query_cache(bool async)
     {
         using var context = CreateContext();
         string customerID = null;
@@ -474,15 +449,17 @@ public virtual void Where_subquery_closure_via_query_cache()
 
         customerID = "ALFKI";
 
-        var customers = context.Customers.Where(c => orders.Any(o => o.CustomerID == c.CustomerID)).ToList();
+        var customers = context.Customers.Where(c => orders.Any(o => o.CustomerID == c.CustomerID));
+        var result = async ? await customers.ToListAsync() : customers.ToList();
 
-        Assert.Single(customers);
+        Assert.Single(result);
 
         customerID = "ANATR";
 
-        customers = context.Customers.Where(c => orders.Any(o => o.CustomerID == c.CustomerID)).ToList();
+        customers = context.Customers.Where(c => orders.Any(o => o.CustomerID == c.CustomerID));
+        result = async ? await customers.ToListAsync() : customers.ToList();
 
-        Assert.Equal("ANATR", customers.Single().CustomerID);
+        Assert.Equal("ANATR", result.Single().CustomerID);
     }
 
     [ConditionalTheory]
@@ -1676,14 +1653,17 @@ public virtual Task Where_chain(bool async)
                 .Where(o => o.OrderDate > new DateTime(1998, 1, 1)),
             entryCount: 8);
 
-    [ConditionalFact]
-    public virtual void Where_navigation_contains()
+    [ConditionalTheory]
+    [MemberData(nameof(IsAsyncData))]
+    public virtual async Task Where_navigation_contains(bool async)
     {
         using var context = CreateContext();
         var customer = context.Customers.Include(c => c.Orders).Single(c => c.CustomerID == "ALFKI");
-        var orderDetails = context.OrderDetails.Where(od => customer.Orders.Contains(od.Order)).ToList();
+        var orderDetails = context.OrderDetails.Where(od => customer.Orders.Contains(od.Order));
+
+        var result = async ? await orderDetails.ToListAsync() : orderDetails.ToList();
 
-        Assert.Equal(12, orderDetails.Count);
+        Assert.Equal(12, result.Count);
     }
 
     [ConditionalTheory]
diff --git a/test/EFCore.Specification.Tests/TestModels/Northwind/NorthwindData.cs b/test/EFCore.Specification.Tests/TestModels/Northwind/NorthwindData.cs
index a0f118951c..b843e1b9f3 100644
--- a/test/EFCore.Specification.Tests/TestModels/Northwind/NorthwindData.cs
+++ b/test/EFCore.Specification.Tests/TestModels/Northwind/NorthwindData.cs
@@ -11,10 +11,23 @@ public partial class NorthwindData : ISetSource
     public Employee[] Employees { get; }
     public Product[] Products { get; }
     public ProductQuery[] ProductQueries { get; }
+    public ProductView[] ProductViews { get; }
     public Order[] Orders { get; }
     public OrderQuery[] OrderQueries { get; }
     public OrderDetail[] OrderDetails { get; }
 
+    private readonly Dictionary<int, string> _categoryNameMap = new Dictionary<int, string>
+    {
+        { 1, "Beverages" },
+        { 2, "Condiments" },
+        { 3, "Confections" },
+        { 4, "Dairy Products" },
+        { 5, "Grains/Cereals" },
+        { 6, "Meat/Poultry" },
+        { 7, "Produce" },
+        { 8, "Seafood" },
+    };
+
     public NorthwindData()
     {
         Customers = CreateCustomers();
@@ -24,7 +37,6 @@ public NorthwindData()
         OrderDetails = CreateOrderDetails();
 
         var customerQueries = new List<CustomerQuery>();
-        CustomerQueriesWithQueryFilter = new CustomerQueryWithQueryFilter[0];
 
         foreach (var customer in Customers)
         {
@@ -44,6 +56,7 @@ public NorthwindData()
         CustomerQueries = customerQueries.ToArray();
 
         var productQueries = new List<ProductQuery>();
+        var productViews = new List<ProductView>();
 
         foreach (var product in Products)
         {
@@ -58,10 +71,18 @@ public NorthwindData()
                         ProductID = product.ProductID,
                         ProductName = product.ProductName
                     });
+
+                productViews.Add(new ProductView
+                {
+                    CategoryName = _categoryNameMap[product.CategoryID.Value],
+                    ProductID = product.ProductID,
+                    ProductName = product.ProductName
+                });
             }
         }
 
         ProductQueries = productQueries.ToArray();
+        ProductViews = productViews.ToArray();
 
         var orderQueries = new List<OrderQuery>();
 
@@ -79,6 +100,20 @@ public NorthwindData()
 
         OrderQueries = orderQueries.ToArray();
 
+        var customerQueriesWithQueryFilter = new List<CustomerQueryWithQueryFilter>();
+        foreach (var customer in Customers)
+        {
+            customerQueriesWithQueryFilter.Add(
+                new CustomerQueryWithQueryFilter
+                {
+                    CompanyName = customer.CompanyName,
+                    SearchTerm = "A",
+                    OrderCount = customer.Orders.Count
+                });
+        }
+
+        CustomerQueriesWithQueryFilter = customerQueriesWithQueryFilter.ToArray();
+
         foreach (var orderDetail in OrderDetails)
         {
             var order = Orders.First(o => o.OrderID == orderDetail.OrderID);
@@ -160,6 +195,16 @@ public IQueryable<TEntity> Set<TEntity>()
             return (IQueryable<TEntity>)ProductQueries.AsQueryable();
         }
 
+        if (typeof(TEntity) == typeof(ProductView))
+        {
+            return (IQueryable<TEntity>)ProductViews.AsQueryable();
+        }
+
+        if (typeof(TEntity) == typeof(CustomerQueryWithQueryFilter))
+        {
+            return (IQueryable<TEntity>)CustomerQueriesWithQueryFilter.AsQueryable();
+        }
+
         throw new InvalidOperationException("Invalid entity type: " + typeof(TEntity));
     }
 
diff --git a/test/EFCore.SqlServer.FunctionalTests/Query/NorthwindAsNoTrackingQuerySqlServerTest.cs b/test/EFCore.SqlServer.FunctionalTests/Query/NorthwindAsNoTrackingQuerySqlServerTest.cs
index 7336d1831c..c4f3b1ef11 100644
--- a/test/EFCore.SqlServer.FunctionalTests/Query/NorthwindAsNoTrackingQuerySqlServerTest.cs
+++ b/test/EFCore.SqlServer.FunctionalTests/Query/NorthwindAsNoTrackingQuerySqlServerTest.cs
@@ -19,9 +19,9 @@ public class NorthwindAsNoTrackingQuerySqlServerTest : NorthwindAsNoTrackingQuer
     public virtual void Check_all_tests_overridden()
         => TestHelpers.AssertAllMethodsOverridden(GetType());
 
-    public override void Can_get_current_values()
+    public override async Task Can_get_current_values(bool async)
     {
-        base.Can_get_current_values();
+        await base.Can_get_current_values(async);
 
         AssertSql(
             @"SELECT TOP(1) [c].[CustomerID], [c].[Address], [c].[City], [c].[CompanyName], [c].[ContactName], [c].[ContactTitle], [c].[Country], [c].[Fax], [c].[Phone], [c].[PostalCode], [c].[Region]
@@ -31,18 +31,9 @@ public override void Can_get_current_values()
 FROM [Customers] AS [c]");
     }
 
-    public override async Task Query_fast_path_when_ctor_binding_async()
+    public override async Task Where_simple_shadow(bool async)
     {
-        await base.Query_fast_path_when_ctor_binding_async();
-
-        AssertSql(
-            @"SELECT [c].[CustomerID], [c].[Address], [c].[City], [c].[CompanyName], [c].[ContactName], [c].[ContactTitle], [c].[Country], [c].[Fax], [c].[Phone], [c].[PostalCode], [c].[Region]
-FROM [Customers] AS [c]");
-    }
-
-    public override void Where_simple_shadow()
-    {
-        base.Where_simple_shadow();
+        await base.Where_simple_shadow(async);
 
         AssertSql(
             @"SELECT [e].[EmployeeID], [e].[City], [e].[Country], [e].[FirstName], [e].[ReportsTo], [e].[Title]
@@ -50,27 +41,27 @@ public override void Where_simple_shadow()
 WHERE [e].[Title] = N'Sales Representative'");
     }
 
-    public override void Entity_not_added_to_state_manager(bool useParam)
+    public override async Task Entity_not_added_to_state_manager(bool useParam, bool async)
     {
-        base.Entity_not_added_to_state_manager(useParam);
+        await base.Entity_not_added_to_state_manager(useParam, async);
 
         AssertSql(
             @"SELECT [c].[CustomerID], [c].[Address], [c].[City], [c].[CompanyName], [c].[ContactName], [c].[ContactTitle], [c].[Country], [c].[Fax], [c].[Phone], [c].[PostalCode], [c].[Region]
 FROM [Customers] AS [c]");
     }
 
-    public override void Query_fast_path_when_ctor_binding()
+    public override async Task Query_fast_path_when_ctor_binding(bool async)
     {
-        base.Query_fast_path_when_ctor_binding();
+        await base.Query_fast_path_when_ctor_binding(async);
 
         AssertSql(
             @"SELECT [c].[CustomerID], [c].[Address], [c].[City], [c].[CompanyName], [c].[ContactName], [c].[ContactTitle], [c].[Country], [c].[Fax], [c].[Phone], [c].[PostalCode], [c].[Region]
 FROM [Customers] AS [c]");
     }
 
-    public override void Applied_to_multiple_body_clauses()
+    public override async Task Applied_to_multiple_body_clauses(bool async)
     {
-        base.Applied_to_multiple_body_clauses();
+        await base.Applied_to_multiple_body_clauses(async);
 
         AssertSql(
             @"SELECT [c].[CustomerID], [c].[Address], [c].[City], [c].[CompanyName], [c].[ContactName], [c].[ContactTitle], [c].[Country], [c].[Fax], [c].[Phone], [c].[PostalCode], [c].[Region], [o].[OrderID], [o].[CustomerID], [o].[EmployeeID], [o].[OrderDate]
@@ -79,9 +70,9 @@ public override void Applied_to_multiple_body_clauses()
 WHERE [c].[CustomerID] = [o].[CustomerID]");
     }
 
-    public override void SelectMany_simple()
+    public override async Task SelectMany_simple(bool async)
     {
-        base.SelectMany_simple();
+        await base.SelectMany_simple(async);
 
         AssertSql(
             @"SELECT [c].[CustomerID], [c].[Address], [c].[City], [c].[CompanyName], [c].[ContactName], [c].[ContactTitle], [c].[Country], [c].[Fax], [c].[Phone], [c].[PostalCode], [c].[Region], [e].[EmployeeID], [e].[City], [e].[Country], [e].[FirstName], [e].[ReportsTo], [e].[Title]
@@ -89,9 +80,9 @@ public override void SelectMany_simple()
 CROSS JOIN [Customers] AS [c]");
     }
 
-    public override void Applied_after_navigation_expansion()
+    public override async Task Applied_after_navigation_expansion(bool async)
     {
-        base.Applied_after_navigation_expansion();
+        await base.Applied_after_navigation_expansion(async);
 
         AssertSql(
             @"SELECT [o].[OrderID], [o].[CustomerID], [o].[EmployeeID], [o].[OrderDate]
@@ -100,9 +91,9 @@ public override void Applied_after_navigation_expansion()
 WHERE [c].[City] <> N'London' OR [c].[City] IS NULL");
     }
 
-    public override void Include_reference_and_collection()
+    public override async Task Include_reference_and_collection(bool async)
     {
-        base.Include_reference_and_collection();
+        await base.Include_reference_and_collection(async);
 
         AssertSql(
             @"SELECT [o].[OrderID], [o].[CustomerID], [o].[EmployeeID], [o].[OrderDate], [c].[CustomerID], [c].[Address], [c].[City], [c].[CompanyName], [c].[ContactName], [c].[ContactTitle], [c].[Country], [c].[Fax], [c].[Phone], [c].[PostalCode], [c].[Region], [o0].[OrderID], [o0].[ProductID], [o0].[Discount], [o0].[Quantity], [o0].[UnitPrice]
@@ -112,9 +103,9 @@ public override void Include_reference_and_collection()
 ORDER BY [o].[OrderID], [c].[CustomerID], [o0].[OrderID]");
     }
 
-    public override void Applied_to_body_clause()
+    public override async Task Applied_to_body_clause(bool async)
     {
-        base.Applied_to_body_clause();
+        await base.Applied_to_body_clause(async);
 
         AssertSql(
             @"SELECT [o].[OrderID], [o].[CustomerID], [o].[EmployeeID], [o].[OrderDate]
@@ -123,9 +114,9 @@ public override void Applied_to_body_clause()
 WHERE [c].[CustomerID] = N'ALFKI'");
     }
 
-    public override void Applied_to_projection()
+    public override async Task Applied_to_projection(bool async)
     {
-        base.Applied_to_projection();
+        await base.Applied_to_projection(async);
 
         AssertSql(
             @"SELECT [c].[CustomerID], [c].[Address], [c].[City], [c].[CompanyName], [c].[ContactName], [c].[ContactTitle], [c].[Country], [c].[Fax], [c].[Phone], [c].[PostalCode], [c].[Region], [o].[OrderID], [o].[CustomerID], [o].[EmployeeID], [o].[OrderDate]
@@ -134,9 +125,9 @@ public override void Applied_to_projection()
 WHERE [c].[CustomerID] = N'ALFKI'");
     }
 
-    public override void Applied_to_body_clause_with_projection()
+    public override async Task Applied_to_body_clause_with_projection(bool async)
     {
-        base.Applied_to_body_clause_with_projection();
+        await base.Applied_to_body_clause_with_projection(async);
 
         AssertSql(
             @"SELECT [c].[CustomerID], [c].[Address], [c].[City], [c].[CompanyName], [c].[ContactName], [c].[ContactTitle], [c].[Country], [c].[Fax], [c].[Phone], [c].[PostalCode], [c].[Region], [o].[CustomerID] AS [ocid], [o].[OrderID], [o].[EmployeeID], [o].[OrderDate]
diff --git a/test/EFCore.SqlServer.FunctionalTests/Query/NorthwindKeylessEntitiesQuerySqlServerTest.cs b/test/EFCore.SqlServer.FunctionalTests/Query/NorthwindKeylessEntitiesQuerySqlServerTest.cs
index b2478f3c4f..c37eedc0c9 100644
--- a/test/EFCore.SqlServer.FunctionalTests/Query/NorthwindKeylessEntitiesQuerySqlServerTest.cs
+++ b/test/EFCore.SqlServer.FunctionalTests/Query/NorthwindKeylessEntitiesQuerySqlServerTest.cs
@@ -44,20 +44,19 @@ public override async Task KeylessEntity_where_simple(bool async)
 WHERE [m].[City] = N'London'");
     }
 
-    public override void KeylessEntity_by_database_view()
+    public override async Task KeylessEntity_by_database_view(bool async)
     {
-        base.KeylessEntity_by_database_view();
+        await base.KeylessEntity_by_database_view(async);
 
         AssertSql(
             @"SELECT [a].[CategoryName], [a].[ProductID], [a].[ProductName]
 FROM [Alphabetical list of products] AS [a]");
     }
 
-    public override void KeylessEntity_with_nav_defining_query()
+    public override async Task KeylessEntity_with_nav_defining_query(bool async)
     {
         // FromSql mapping. Issue #21627.
-        Assert.Throws<SqlException>(
-            () => base.KeylessEntity_with_nav_defining_query());
+        await Assert.ThrowsAsync<SqlException>(() => base.KeylessEntity_with_nav_defining_query(async));
 
         AssertSql(
             @"SELECT [c].[CompanyName], [c].[OrderCount], [c].[SearchTerm]
@@ -118,9 +117,9 @@ SELECT 1
     WHERE [c].[CustomerID] IS NOT NULL AND [c].[CustomerID] = [o].[CustomerID])");
     }
 
-    public override void Auto_initialized_view_set()
+    public override async Task Auto_initialized_view_set(bool async)
     {
-        base.Auto_initialized_view_set();
+        await base.Auto_initialized_view_set(async);
 
         AssertSql(
             @"SELECT [c].[CustomerID], [c].[Address], [c].[City], [c].[CompanyName], [c].[ContactName], [c].[ContactTitle], [c].[Country], [c].[Fax], [c].[Phone], [c].[PostalCode], [c].[Region] FROM [Customers] AS [c]");
@@ -138,9 +137,9 @@ public override async Task KeylessEntity_groupby(bool async)
 GROUP BY [m].[City]");
     }
 
-    public override void Entity_mapped_to_view_on_right_side_of_join()
+    public override async Task Entity_mapped_to_view_on_right_side_of_join(bool async)
     {
-        base.Entity_mapped_to_view_on_right_side_of_join();
+        await base.Entity_mapped_to_view_on_right_side_of_join(async);
 
         AssertSql(
             @"SELECT [o].[OrderID], [o].[CustomerID], [o].[EmployeeID], [o].[OrderDate], [a].[CategoryName], [a].[ProductID], [a].[ProductName]
diff --git a/test/EFCore.SqlServer.FunctionalTests/Query/NorthwindMiscellaneousQuerySqlServerTest.cs b/test/EFCore.SqlServer.FunctionalTests/Query/NorthwindMiscellaneousQuerySqlServerTest.cs
index 6c53f3ffee..cd7b670489 100644
--- a/test/EFCore.SqlServer.FunctionalTests/Query/NorthwindMiscellaneousQuerySqlServerTest.cs
+++ b/test/EFCore.SqlServer.FunctionalTests/Query/NorthwindMiscellaneousQuerySqlServerTest.cs
@@ -27,9 +27,9 @@ protected override bool CanExecuteQueryString
     public virtual void Check_all_tests_overridden()
         => TestHelpers.AssertAllMethodsOverridden(GetType());
 
-    public override void Shaper_command_caching_when_parameter_names_different()
+    public override async Task Shaper_command_caching_when_parameter_names_different(bool async)
     {
-        base.Shaper_command_caching_when_parameter_names_different();
+        await base.Shaper_command_caching_when_parameter_names_different(async);
 
         AssertSql(
             @"SELECT COUNT(*)
@@ -41,9 +41,9 @@ public override void Shaper_command_caching_when_parameter_names_different()
 WHERE [c].[CustomerID] = N'ALFKI'");
     }
 
-    public override void Can_convert_manually_build_expression_with_default()
+    public override async Task Can_convert_manually_build_expression_with_default(bool async)
     {
-        base.Can_convert_manually_build_expression_with_default();
+        await base.Can_convert_manually_build_expression_with_default(async);
 
         AssertSql(
             @"SELECT COUNT(*)
@@ -55,9 +55,9 @@ public override void Can_convert_manually_build_expression_with_default()
 WHERE [c].[City] IS NOT NULL");
     }
 
-    public override void Lifting_when_subquery_nested_order_by_anonymous()
+    public override async Task Lifting_when_subquery_nested_order_by_anonymous(bool async)
     {
-        base.Lifting_when_subquery_nested_order_by_anonymous();
+        await base.Lifting_when_subquery_nested_order_by_anonymous(async);
 
         AssertSql(
             @"@__p_0='2'
@@ -76,9 +76,9 @@ public override void Lifting_when_subquery_nested_order_by_anonymous()
 ORDER BY [t0].[CustomerID]");
     }
 
-    public override void Lifting_when_subquery_nested_order_by_simple()
+    public override async Task Lifting_when_subquery_nested_order_by_simple(bool async)
     {
-        base.Lifting_when_subquery_nested_order_by_simple();
+        await base.Lifting_when_subquery_nested_order_by_simple(async);
 
         AssertSql(
             @"@__p_0='2'
@@ -695,9 +695,9 @@ public override async Task Where_query_composition2_FirstOrDefault_with_anonymou
     ORDER BY [e0].[EmployeeID]) IS NULL)");
     }
 
-    public override void Select_Subquery_Single()
+    public override async Task Select_Subquery_Single(bool async)
     {
-        base.Select_Subquery_Single();
+        await base.Select_Subquery_Single(async);
 
         AssertSql(
             @"@__p_0='2'
@@ -719,9 +719,9 @@ public override void Select_Subquery_Single()
 ORDER BY [t].[ProductID], [t].[OrderID]");
     }
 
-    public override void Select_Where_Subquery_Deep_Single()
+    public override async Task Select_Where_Subquery_Deep_Single(bool async)
     {
-        base.Select_Where_Subquery_Deep_Single();
+        await base.Select_Where_Subquery_Deep_Single(async);
 
         AssertSql(
             @"@__p_0='2'
@@ -737,9 +737,9 @@ public override void Select_Where_Subquery_Deep_Single()
     WHERE [o].[OrderID] = [o0].[OrderID]) = N'Seattle'");
     }
 
-    public override void Select_Where_Subquery_Deep_First()
+    public override async Task Select_Where_Subquery_Deep_First(bool async)
     {
-        base.Select_Where_Subquery_Deep_First();
+        await base.Select_Where_Subquery_Deep_First(async);
 
         AssertSql(
             @"@__p_0='2'
@@ -755,9 +755,9 @@ public override void Select_Where_Subquery_Deep_First()
     WHERE [o].[OrderID] = [o0].[OrderID]) = N'Seattle'");
     }
 
-    public override void Select_Where_Subquery_Equality()
+    public override async Task Select_Where_Subquery_Equality(bool async)
     {
-        base.Select_Where_Subquery_Equality();
+        await base.Select_Where_Subquery_Equality(async);
 
         AssertSql(
             @"@__p_0='1'
@@ -913,9 +913,9 @@ public override async Task OrderBy_ternary_conditions(bool async)
     //    WHEN (([p].[UnitsInStock] > CAST(10 AS smallint)) AND ([p].[ProductID] > 40)) OR (([p].[UnitsInStock] <= CAST(10 AS smallint)) AND ([p].[ProductID] <= 40))
     //    THEN CAST(1 AS bit) ELSE CAST(0 AS bit)
     //END, [p].[ProductID]");
-    public override void OrderBy_any()
+    public override async Task OrderBy_any(bool async)
     {
-        base.OrderBy_any();
+        await base.OrderBy_any(async);
 
         AssertSql(
             @"SELECT [c].[CustomerID], [c].[Address], [c].[City], [c].[CompanyName], [c].[ContactName], [c].[ContactTitle], [c].[Country], [c].[Fax], [c].[Phone], [c].[PostalCode], [c].[Region]
@@ -1406,9 +1406,9 @@ SELECT 1
     WHERE [o].[CustomerID] IS NOT NULL AND ([o].[CustomerID] LIKE N'A%')) AND ([c].[City] <> N'London' OR [c].[City] IS NULL)");
     }
 
-    public override void Any_with_multiple_conditions_still_uses_exists()
+    public override async Task Any_with_multiple_conditions_still_uses_exists(bool async)
     {
-        base.Any_with_multiple_conditions_still_uses_exists();
+        await base.Any_with_multiple_conditions_still_uses_exists(async);
 
         AssertSql(
             @"SELECT [c].[CustomerID], [c].[Address], [c].[City], [c].[CompanyName], [c].[ContactName], [c].[ContactTitle], [c].[Country], [c].[Fax], [c].[Phone], [c].[PostalCode], [c].[Region]
@@ -2233,9 +2233,9 @@ SELECT 1
 ORDER BY [e].[EmployeeID]");
     }
 
-    public override void Select_DTO_distinct_translated_to_server()
+    public override async Task Select_DTO_distinct_translated_to_server(bool async)
     {
-        base.Select_DTO_distinct_translated_to_server();
+        await base.Select_DTO_distinct_translated_to_server(async);
 
         AssertSql(
             @"SELECT DISTINCT 1
@@ -2243,9 +2243,9 @@ public override void Select_DTO_distinct_translated_to_server()
 WHERE [o].[OrderID] < 10300");
     }
 
-    public override void Select_DTO_constructor_distinct_translated_to_server()
+    public override async Task Select_DTO_constructor_distinct_translated_to_server(bool async)
     {
-        base.Select_DTO_constructor_distinct_translated_to_server();
+        await base.Select_DTO_constructor_distinct_translated_to_server(async);
 
         AssertSql(
             @"SELECT DISTINCT [o].[CustomerID]
@@ -2253,9 +2253,9 @@ public override void Select_DTO_constructor_distinct_translated_to_server()
 WHERE [o].[OrderID] < 10300");
     }
 
-    public override void Select_DTO_constructor_distinct_with_navigation_translated_to_server()
+    public override async Task Select_DTO_constructor_distinct_with_navigation_translated_to_server(bool async)
     {
-        base.Select_DTO_constructor_distinct_with_navigation_translated_to_server();
+        await base.Select_DTO_constructor_distinct_with_navigation_translated_to_server(async);
 
         AssertSql(
             @"SELECT DISTINCT [c].[City]
@@ -2264,11 +2264,26 @@ public override void Select_DTO_constructor_distinct_with_navigation_translated_
 WHERE [o].[OrderID] < 10300");
     }
 
-    public override void Select_DTO_constructor_distinct_with_collection_projection_translated_to_server()
+    public override async Task Select_DTO_constructor_distinct_with_collection_projection_translated_to_server(bool async)
+    {
+        await base.Select_DTO_constructor_distinct_with_collection_projection_translated_to_server(async);
+
+        AssertSql(
+            @"SELECT [t].[CustomerID], [o0].[OrderID], [o0].[CustomerID], [o0].[EmployeeID], [o0].[OrderDate]
+FROM (
+    SELECT DISTINCT [o].[CustomerID]
+    FROM [Orders] AS [o]
+    WHERE [o].[OrderID] < 10300
+) AS [t]
+LEFT JOIN [Orders] AS [o0] ON [t].[CustomerID] = [o0].[CustomerID]
+ORDER BY [t].[CustomerID]");
+    }
+
+    public override async Task Select_DTO_constructor_distinct_with_collection_projection_translated_to_server_with_binding_after_client_eval(bool async)
     {
         // Allow binding of expressions after projection has turned to client eval. Issue #24478.
-        Assert.Throws<TrueException>(
-            () => base.Select_DTO_constructor_distinct_with_collection_projection_translated_to_server());
+        await Assert.ThrowsAsync<TrueException>(
+            () => base.Select_DTO_constructor_distinct_with_collection_projection_translated_to_server_with_binding_after_client_eval(async));
 
         AssertSql(
             @"SELECT [t].[CustomerID], [o0].[OrderID], [o0].[CustomerID], [o0].[EmployeeID], [o0].[OrderDate]
@@ -2281,9 +2296,9 @@ public override void Select_DTO_constructor_distinct_with_collection_projection_
 ORDER BY [t].[CustomerID]");
     }
 
-    public override void Select_DTO_with_member_init_distinct_translated_to_server()
+    public override async Task Select_DTO_with_member_init_distinct_translated_to_server(bool async)
     {
-        base.Select_DTO_with_member_init_distinct_translated_to_server();
+        await base.Select_DTO_with_member_init_distinct_translated_to_server(async);
 
         AssertSql(
             @"SELECT DISTINCT [o].[CustomerID] AS [Id], [o].[OrderID] AS [Count]
@@ -2291,9 +2306,9 @@ public override void Select_DTO_with_member_init_distinct_translated_to_server()
 WHERE [o].[OrderID] < 10300");
     }
 
-    public override void Select_nested_collection_count_using_DTO()
+    public override async Task Select_nested_collection_count_using_DTO(bool async)
     {
-        base.Select_nested_collection_count_using_DTO();
+        await base.Select_nested_collection_count_using_DTO(async);
 
         AssertSql(
             @"SELECT [c].[CustomerID] AS [Id], (
@@ -2332,9 +2347,9 @@ public override async Task Select_DTO_with_member_init_distinct_in_subquery_tran
 INNER JOIN [Customers] AS [c] ON [t].[Id] = [c].[CustomerID]");
     }
 
-    public override void Select_DTO_with_member_init_distinct_in_subquery_used_in_projection_translated_to_server()
+    public override async Task Select_DTO_with_member_init_distinct_in_subquery_used_in_projection_translated_to_server(bool async)
     {
-        base.Select_DTO_with_member_init_distinct_in_subquery_used_in_projection_translated_to_server();
+        await base.Select_DTO_with_member_init_distinct_in_subquery_used_in_projection_translated_to_server(async);
 
         AssertSql(
             @"SELECT [c].[CustomerID], [c].[Address], [c].[City], [c].[CompanyName], [c].[ContactName], [c].[ContactTitle], [c].[Country], [c].[Fax], [c].[Phone], [c].[PostalCode], [c].[Region], [t].[Id], [t].[Count]
@@ -2597,9 +2612,9 @@ public override async Task Select_take_skip_null_coalesce_operator3(bool async)
 OFFSET @__p_1 ROWS");
     }
 
-    public override void Selected_column_can_coalesce()
+    public override async Task Selected_column_can_coalesce(bool async)
     {
-        base.Selected_column_can_coalesce();
+        await base.Selected_column_can_coalesce(async);
 
         AssertSql(
             @"SELECT [c].[CustomerID], [c].[Address], [c].[City], [c].[CompanyName], [c].[ContactName], [c].[ContactTitle], [c].[Country], [c].[Fax], [c].[Phone], [c].[PostalCode], [c].[Region]
@@ -4411,21 +4426,6 @@ public override async Task OrderBy_Dto_projection_skip_take(bool async)
 OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY");
     }
 
-    public override void Streaming_chained_sync_query()
-    {
-        base.Streaming_chained_sync_query();
-
-        AssertSql(
-            @"SELECT [c].[CustomerID], [t].[OrderID], [t].[CustomerID], [t].[EmployeeID], [t].[OrderDate], [t].[CustomerID0]
-FROM [Customers] AS [c]
-LEFT JOIN (
-    SELECT [o].[OrderID], [o].[CustomerID], [o].[EmployeeID], [o].[OrderDate], [c0].[CustomerID] AS [CustomerID0]
-    FROM [Orders] AS [o]
-    LEFT JOIN [Customers] AS [c0] ON [o].[CustomerID] = [c0].[CustomerID]
-) AS [t] ON [c].[CustomerID] = [t].[CustomerID0]
-ORDER BY [c].[CustomerID], [t].[OrderID]");
-    }
-
     public override async Task Join_take_count_works(bool async)
     {
         await base.Join_take_count_works(async);
@@ -4464,9 +4464,9 @@ public override async Task OrderBy_empty_list_does_not_contains(bool async)
 FROM [Customers] AS [c]");
     }
 
-    public override void Manual_expression_tree_typed_null_equality()
+    public override async Task Manual_expression_tree_typed_null_equality(bool async)
     {
-        base.Manual_expression_tree_typed_null_equality();
+        await base.Manual_expression_tree_typed_null_equality(async);
 
         AssertSql(
             @"SELECT [c].[City]
@@ -5543,9 +5543,9 @@ public override async Task OrderBy_ThenBy_predicate(bool async)
 ORDER BY [c].[City], [c].[CustomerID]");
     }
 
-    public override void Query_when_evaluatable_queryable_method_call_with_repository()
+    public override async Task Query_when_evaluatable_queryable_method_call_with_repository(bool async)
     {
-        base.Query_when_evaluatable_queryable_method_call_with_repository();
+        await base.Query_when_evaluatable_queryable_method_call_with_repository(async);
 
         AssertSql(
             @"SELECT [c].[CustomerID], [c].[Address], [c].[City], [c].[CompanyName], [c].[ContactName], [c].[ContactTitle], [c].[Country], [c].[Fax], [c].[Phone], [c].[PostalCode], [c].[Region]
@@ -6123,16 +6123,16 @@ public override async Task Mixed_sync_async_query()
         AssertSql();
     }
 
-    public override void Parameter_extraction_can_throw_exception_from_user_code()
+    public override async Task Parameter_extraction_can_throw_exception_from_user_code(bool async)
     {
-        base.Parameter_extraction_can_throw_exception_from_user_code();
+        await base.Parameter_extraction_can_throw_exception_from_user_code(async);
 
         AssertSql();
     }
 
-    public override void Parameter_extraction_can_throw_exception_from_user_code_2()
+    public override async Task Parameter_extraction_can_throw_exception_from_user_code_2(bool async)
     {
-        base.Parameter_extraction_can_throw_exception_from_user_code_2();
+        await base.Parameter_extraction_can_throw_exception_from_user_code_2(async);
 
         AssertSql();
     }
@@ -6207,37 +6207,42 @@ public override void Can_cast_CreateQuery_result_to_IQueryable_T_bug_1730()
         AssertSql();
     }
 
-    public override void Multiple_context_instances()
+    public override async Task Multiple_context_instances(bool async)
     {
-        base.Multiple_context_instances();
+        await base.Multiple_context_instances(async);
 
         AssertSql();
     }
 
-    public override void Multiple_context_instances_2()
+    public override async Task Multiple_context_instances_2(bool async)
     {
-        base.Multiple_context_instances_2();
+        await base.Multiple_context_instances_2(async);
 
         AssertSql();
     }
 
-    public override void Multiple_context_instances_set()
+    public override async Task Multiple_context_instances_set(bool async)
     {
-        base.Multiple_context_instances_set();
+        await base.Multiple_context_instances_set(async);
 
         AssertSql();
     }
 
-    public override void Multiple_context_instances_parameter()
+    public override async Task Multiple_context_instances_parameter(bool async)
     {
-        base.Multiple_context_instances_parameter();
+        await base.Multiple_context_instances_parameter(async);
 
         AssertSql();
     }
 
-    public override void Entity_equality_through_subquery_composite_key()
+    public override async Task Entity_equality_through_subquery_composite_key(bool async)
     {
-        base.Entity_equality_through_subquery_composite_key();
+        var message = (await Assert.ThrowsAsync<InvalidOperationException>(
+            () => base.Entity_equality_through_subquery_composite_key(async))).Message;
+
+        Assert.Equal(
+            CoreStrings.EntityEqualityOnCompositeKeyEntitySubqueryNotSupported("==", nameof(OrderDetail)),
+            message);
 
         AssertSql();
     }
diff --git a/test/EFCore.SqlServer.FunctionalTests/Query/NorthwindNavigationsQuerySqlServerTest.cs b/test/EFCore.SqlServer.FunctionalTests/Query/NorthwindNavigationsQuerySqlServerTest.cs
index 8beb44468f..da4337233a 100644
--- a/test/EFCore.SqlServer.FunctionalTests/Query/NorthwindNavigationsQuerySqlServerTest.cs
+++ b/test/EFCore.SqlServer.FunctionalTests/Query/NorthwindNavigationsQuerySqlServerTest.cs
@@ -815,9 +815,9 @@ public override async Task Where_subquery_on_navigation2(bool async)
         AssertSql();
     }
 
-    public override void Navigation_in_subquery_referencing_outer_query()
+    public override async Task Navigation_in_subquery_referencing_outer_query(bool async)
     {
-        base.Navigation_in_subquery_referencing_outer_query();
+        await base.Navigation_in_subquery_referencing_outer_query(async);
 
         AssertSql(
             @"SELECT [o].[OrderID], [o].[CustomerID], [o].[EmployeeID], [o].[OrderDate]
@@ -941,9 +941,9 @@ public override async Task Multiple_include_with_multiple_optional_navigations(b
 WHERE [c].[City] = N'London'");
     }
 
-    public override void Navigation_in_subquery_referencing_outer_query_with_client_side_result_operator_and_count()
+    public override async Task Navigation_in_subquery_referencing_outer_query_with_client_side_result_operator_and_count(bool async)
     {
-        base.Navigation_in_subquery_referencing_outer_query_with_client_side_result_operator_and_count();
+        await base.Navigation_in_subquery_referencing_outer_query_with_client_side_result_operator_and_count(async);
 
         AssertSql(
             @"SELECT [o].[OrderID], [o].[CustomerID], [o].[EmployeeID], [o].[OrderDate]
@@ -977,41 +977,6 @@ public override async Task Select_Where_Navigation_Scalar_Equals_Navigation_Scal
 WHERE [o].[OrderID] < 10300 AND ([c].[City] = [c0].[City] OR ([c].[City] IS NULL AND [c0].[City] IS NULL))");
     }
 
-    public override async Task Select_Where_Navigation_Async()
-    {
-        await base.Select_Where_Navigation_Async();
-
-        AssertSql(
-            @"SELECT [o].[OrderID], [o].[CustomerID], [o].[EmployeeID], [o].[OrderDate]
-FROM [Orders] AS [o]
-LEFT JOIN [Customers] AS [c] ON [o].[CustomerID] = [c].[CustomerID]
-WHERE [c].[City] = N'Seattle'");
-    }
-
-    public override async Task Collection_where_nav_prop_sum_async()
-    {
-        await base.Collection_where_nav_prop_sum_async();
-
-        AssertSql(
-            @"SELECT [c].[CustomerID], [c].[Address], [c].[City], [c].[CompanyName], [c].[ContactName], [c].[ContactTitle], [c].[Country], [c].[Fax], [c].[Phone], [c].[PostalCode], [c].[Region]
-FROM [Customers] AS [c]
-WHERE (
-    SELECT COALESCE(SUM([o].[OrderID]), 0)
-    FROM [Orders] AS [o]
-    WHERE [c].[CustomerID] = [o].[CustomerID]) > 1000");
-    }
-
-    public override async Task Select_Singleton_Navigation_With_Member_Access_Async()
-    {
-        await base.Select_Singleton_Navigation_With_Member_Access_Async();
-
-        AssertSql(
-            @"SELECT [c].[CustomerID], [c].[Address], [c].[City], [c].[CompanyName], [c].[ContactName], [c].[ContactTitle], [c].[Country], [c].[Fax], [c].[Phone], [c].[PostalCode], [c].[Region]
-FROM [Orders] AS [o]
-LEFT JOIN [Customers] AS [c] ON [o].[CustomerID] = [c].[CustomerID]
-WHERE [c].[City] = N'Seattle' AND ([c].[Phone] <> N'555 555 5555' OR [c].[Phone] IS NULL)");
-    }
-
     public override async Task Where_subquery_on_navigation_client_eval(bool async)
     {
         await base.Where_subquery_on_navigation_client_eval(async);
diff --git a/test/EFCore.SqlServer.FunctionalTests/Query/NorthwindSelectQuerySqlServerTest.cs b/test/EFCore.SqlServer.FunctionalTests/Query/NorthwindSelectQuerySqlServerTest.cs
index 47db8d2b55..610a80a326 100644
--- a/test/EFCore.SqlServer.FunctionalTests/Query/NorthwindSelectQuerySqlServerTest.cs
+++ b/test/EFCore.SqlServer.FunctionalTests/Query/NorthwindSelectQuerySqlServerTest.cs
@@ -287,9 +287,9 @@ public override async Task Select_nested_collection(bool async)
 ORDER BY [c].[CustomerID], [t].[OrderID]");
     }
 
-    public override void Select_nested_collection_multi_level()
+    public override async Task Select_nested_collection_multi_level(bool async)
     {
-        base.Select_nested_collection_multi_level();
+        await base.Select_nested_collection_multi_level(async);
 
         AssertSql(
             @"SELECT [c].[CustomerID], [t0].[Date], [t0].[OrderID]
@@ -304,38 +304,42 @@ public override void Select_nested_collection_multi_level()
     WHERE [t].[row] <= 3
 ) AS [t0] ON [c].[CustomerID] = [t0].[CustomerID]
 WHERE [c].[CustomerID] LIKE N'A%'
-ORDER BY [c].[CustomerID]");
+ORDER BY [c].[CustomerID], [t0].[CustomerID], [t0].[OrderID]");
     }
 
-    public override void Select_nested_collection_multi_level2()
+    public override async Task Select_nested_collection_multi_level2(bool async)
     {
-        base.Select_nested_collection_multi_level2();
+        await base.Select_nested_collection_multi_level2(async);
 
         AssertSql(
             @"SELECT (
     SELECT TOP(1) [o].[OrderDate]
     FROM [Orders] AS [o]
-    WHERE [c].[CustomerID] = [o].[CustomerID] AND [o].[OrderID] < 10500) AS [OrderDates]
+    WHERE [c].[CustomerID] = [o].[CustomerID] AND [o].[OrderID] < 10500
+    ORDER BY [o].[OrderID]) AS [OrderDates]
 FROM [Customers] AS [c]
-WHERE [c].[CustomerID] LIKE N'A%'");
+WHERE [c].[CustomerID] LIKE N'A%'
+ORDER BY [c].[CustomerID]");
     }
 
-    public override void Select_nested_collection_multi_level3()
+    public override async Task Select_nested_collection_multi_level3(bool async)
     {
-        base.Select_nested_collection_multi_level3();
+        await base.Select_nested_collection_multi_level3(async);
 
         AssertSql(
             @"SELECT (
     SELECT TOP(1) [o].[OrderDate]
     FROM [Orders] AS [o]
-    WHERE [o].[OrderID] < 10500 AND [c].[CustomerID] = [o].[CustomerID]) AS [OrderDates]
+    WHERE [o].[OrderID] < 10500 AND [c].[CustomerID] = [o].[CustomerID]
+    ORDER BY [o].[OrderID]) AS [OrderDates]
 FROM [Customers] AS [c]
-WHERE [c].[CustomerID] LIKE N'A%'");
+WHERE [c].[CustomerID] LIKE N'A%'
+ORDER BY [c].[CustomerID]");
     }
 
-    public override void Select_nested_collection_multi_level4()
+    public override async Task Select_nested_collection_multi_level4(bool async)
     {
-        base.Select_nested_collection_multi_level4();
+        await base.Select_nested_collection_multi_level4(async);
 
         AssertSql(
             @"SELECT COALESCE((
@@ -344,14 +348,16 @@ SELECT COUNT(*)
         FROM [Order Details] AS [o0]
         WHERE [o].[OrderID] = [o0].[OrderID] AND [o0].[OrderID] > 10)
     FROM [Orders] AS [o]
-    WHERE [c].[CustomerID] = [o].[CustomerID] AND [o].[OrderID] < 10500), 0) AS [Order]
+    WHERE [c].[CustomerID] = [o].[CustomerID] AND [o].[OrderID] < 10500
+    ORDER BY [o].[OrderID]), 0) AS [Order]
 FROM [Customers] AS [c]
-WHERE [c].[CustomerID] LIKE N'A%'");
+WHERE [c].[CustomerID] LIKE N'A%'
+ORDER BY [c].[CustomerID]");
     }
 
-    public override void Select_nested_collection_multi_level5()
+    public override async Task Select_nested_collection_multi_level5(bool async)
     {
-        base.Select_nested_collection_multi_level5();
+        await base.Select_nested_collection_multi_level5(async);
 
         AssertSql(
             @"SELECT COALESCE((
@@ -364,27 +370,33 @@ SELECT COUNT(*)
             WHERE [c].[CustomerID] = [o1].[CustomerID]) OR (
             SELECT COUNT(*)
             FROM [Orders] AS [o1]
-            WHERE [c].[CustomerID] = [o1].[CustomerID]) IS NULL)), 0)
+            WHERE [c].[CustomerID] = [o1].[CustomerID]) IS NULL)
+        ORDER BY [o0].[OrderID], [o0].[ProductID]), 0)
     FROM [Orders] AS [o]
-    WHERE [c].[CustomerID] = [o].[CustomerID] AND [o].[OrderID] < 10500), 0) AS [Order]
+    WHERE [c].[CustomerID] = [o].[CustomerID] AND [o].[OrderID] < 10500
+    ORDER BY [o].[OrderID]), 0) AS [Order]
 FROM [Customers] AS [c]
-WHERE [c].[CustomerID] LIKE N'A%'");
+WHERE [c].[CustomerID] LIKE N'A%'
+ORDER BY [c].[CustomerID]");
     }
 
-    public override void Select_nested_collection_multi_level6()
+    public override async Task Select_nested_collection_multi_level6(bool async)
     {
-        base.Select_nested_collection_multi_level6();
+        await base.Select_nested_collection_multi_level6(async);
 
         AssertSql(
             @"SELECT COALESCE((
     SELECT TOP(1) COALESCE((
         SELECT TOP(1) [o0].[ProductID]
         FROM [Order Details] AS [o0]
-        WHERE [o].[OrderID] = [o0].[OrderID] AND [o0].[OrderID] <> CAST(LEN([c].[CustomerID]) AS int)), 0)
+        WHERE [o].[OrderID] = [o0].[OrderID] AND [o0].[OrderID] <> CAST(LEN([c].[CustomerID]) AS int)
+        ORDER BY [o0].[OrderID], [o0].[ProductID]), 0)
     FROM [Orders] AS [o]
-    WHERE [c].[CustomerID] = [o].[CustomerID] AND [o].[OrderID] < 10500), 0) AS [Order]
+    WHERE [c].[CustomerID] = [o].[CustomerID] AND [o].[OrderID] < 10500
+    ORDER BY [o].[OrderID]), 0) AS [Order]
 FROM [Customers] AS [c]
-WHERE [c].[CustomerID] LIKE N'A%'");
+WHERE [c].[CustomerID] LIKE N'A%'
+ORDER BY [c].[CustomerID]");
     }
 
     public override async Task Select_nested_collection_count_using_anonymous_type(bool async)
diff --git a/test/EFCore.SqlServer.FunctionalTests/Query/NorthwindSetOperationsQuerySqlServerTest.cs b/test/EFCore.SqlServer.FunctionalTests/Query/NorthwindSetOperationsQuerySqlServerTest.cs
index 91ed47c174..537ebe92d4 100644
--- a/test/EFCore.SqlServer.FunctionalTests/Query/NorthwindSetOperationsQuerySqlServerTest.cs
+++ b/test/EFCore.SqlServer.FunctionalTests/Query/NorthwindSetOperationsQuerySqlServerTest.cs
@@ -1157,16 +1157,16 @@ public override async Task Collection_projection_before_set_operation_fails(bool
         AssertSql();
     }
 
-    public override void Include_Union_only_on_one_side_throws()
+    public override async Task Include_Union_only_on_one_side_throws(bool async)
     {
-        base.Include_Union_only_on_one_side_throws();
+        await base.Include_Union_only_on_one_side_throws(async);
 
         AssertSql();
     }
 
-    public override void Include_Union_different_includes_throws()
+    public override async Task Include_Union_different_includes_throws(bool async)
     {
-        base.Include_Union_different_includes_throws();
+        await base.Include_Union_different_includes_throws(async);
 
         AssertSql();
     }
diff --git a/test/EFCore.SqlServer.FunctionalTests/Query/NorthwindWhereQuerySqlServerTest.cs b/test/EFCore.SqlServer.FunctionalTests/Query/NorthwindWhereQuerySqlServerTest.cs
index d5025a1200..0a22109994 100644
--- a/test/EFCore.SqlServer.FunctionalTests/Query/NorthwindWhereQuerySqlServerTest.cs
+++ b/test/EFCore.SqlServer.FunctionalTests/Query/NorthwindWhereQuerySqlServerTest.cs
@@ -386,9 +386,9 @@ public override async Task Where_simple_closure_via_query_cache_nullable_type_re
 WHERE CAST([e].[ReportsTo] AS bigint) = @__p_0");
     }
 
-    public override void Where_subquery_closure_via_query_cache()
+    public override async Task Where_subquery_closure_via_query_cache(bool async)
     {
-        base.Where_subquery_closure_via_query_cache();
+        await base.Where_subquery_closure_via_query_cache(async);
 
         AssertSql(
             @"@__customerID_0='ALFKI' (Size = 5) (DbType = StringFixedLength)
@@ -1577,9 +1577,9 @@ public override async Task Where_chain(bool async)
 WHERE [o].[CustomerID] = N'QUICK' AND [o].[OrderDate] > '1998-01-01T00:00:00.000'");
     }
 
-    public override void Where_navigation_contains()
+    public override async Task Where_navigation_contains(bool async)
     {
-        base.Where_navigation_contains();
+        await base.Where_navigation_contains(async);
 
         AssertSql(
             @"SELECT [t].[CustomerID], [t].[Address], [t].[City], [t].[CompanyName], [t].[ContactName], [t].[ContactTitle], [t].[Country], [t].[Fax], [t].[Phone], [t].[PostalCode], [t].[Region], [o].[OrderID], [o].[CustomerID], [o].[EmployeeID], [o].[OrderDate]
@@ -2622,30 +2622,16 @@ public override async Task Where_equals_method_string_with_ignore_case(bool asyn
         AssertSql();
     }
 
-    public override void Where_nested_field_access_closure_via_query_cache_error_null()
+    public override async Task Where_nested_field_access_closure_via_query_cache_error_null(bool async)
     {
-        base.Where_nested_field_access_closure_via_query_cache_error_null();
+        await base.Where_nested_field_access_closure_via_query_cache_error_null(async);
 
         AssertSql();
     }
 
-    public override async Task Where_nested_field_access_closure_via_query_cache_error_null_async()
+    public override async Task Where_nested_field_access_closure_via_query_cache_error_method_null(bool async)
     {
-        await base.Where_nested_field_access_closure_via_query_cache_error_null_async();
-
-        AssertSql();
-    }
-
-    public override void Where_nested_field_access_closure_via_query_cache_error_method_null()
-    {
-        base.Where_nested_field_access_closure_via_query_cache_error_method_null();
-
-        AssertSql();
-    }
-
-    public override async Task Where_nested_field_access_closure_via_query_cache_error_method_null_async()
-    {
-        await base.Where_nested_field_access_closure_via_query_cache_error_method_null_async();
+        await base.Where_nested_field_access_closure_via_query_cache_error_method_null(async);
 
         AssertSql();
     }
diff --git a/test/EFCore.Sqlite.FunctionalTests/Query/NorthwindKeylessEntitiesQuerySqliteTest.cs b/test/EFCore.Sqlite.FunctionalTests/Query/NorthwindKeylessEntitiesQuerySqliteTest.cs
index be18664684..0738fd762e 100644
--- a/test/EFCore.Sqlite.FunctionalTests/Query/NorthwindKeylessEntitiesQuerySqliteTest.cs
+++ b/test/EFCore.Sqlite.FunctionalTests/Query/NorthwindKeylessEntitiesQuerySqliteTest.cs
@@ -17,8 +17,7 @@ public class NorthwindKeylessEntitiesQuerySqliteTest : NorthwindKeylessEntitiesQ
         //Fixture.TestSqlLoggerFactory.SetTestOutputHelper(testOutputHelper);
     }
 
-    public override void KeylessEntity_with_nav_defining_query()
+    public override Task KeylessEntity_with_nav_defining_query(bool async)
         // FromSql mapping. Issue #21627.
-        => Assert.Throws<SqliteException>(
-            () => base.KeylessEntity_with_nav_defining_query());
+        => Assert.ThrowsAsync<SqliteException>(() => base.KeylessEntity_with_nav_defining_query(async));
 }
diff --git a/test/EFCore.Sqlite.FunctionalTests/Query/NorthwindMiscellaneousQuerySqliteTest.cs b/test/EFCore.Sqlite.FunctionalTests/Query/NorthwindMiscellaneousQuerySqliteTest.cs
index 5cc58bd2bd..a96568ed48 100644
--- a/test/EFCore.Sqlite.FunctionalTests/Query/NorthwindMiscellaneousQuerySqliteTest.cs
+++ b/test/EFCore.Sqlite.FunctionalTests/Query/NorthwindMiscellaneousQuerySqliteTest.cs
@@ -305,50 +305,40 @@ public override async Task Concat_constant_string_int(bool async)
     }
 
     public override async Task Client_code_using_instance_method_throws(bool async)
-    {
-        Assert.Equal(
+        => Assert.Equal(
             CoreStrings.ClientProjectionCapturingConstantInMethodInstance(
                 "Microsoft.EntityFrameworkCore.Query.NorthwindMiscellaneousQuerySqliteTest",
                 "InstanceMethod"),
             (await Assert.ThrowsAsync<InvalidOperationException>(
                 () => base.Client_code_using_instance_method_throws(async))).Message);
 
-        AssertSql();
-    }
-
     public override async Task Client_code_using_instance_in_static_method(bool async)
-    {
-        Assert.Equal(
+        => Assert.Equal(
             CoreStrings.ClientProjectionCapturingConstantInMethodArgument(
                 "Microsoft.EntityFrameworkCore.Query.NorthwindMiscellaneousQuerySqliteTest",
                 "StaticMethod"),
             (await Assert.ThrowsAsync<InvalidOperationException>(
                 () => base.Client_code_using_instance_in_static_method(async))).Message);
 
-        AssertSql();
-    }
-
     public override async Task Client_code_using_instance_in_anonymous_type(bool async)
-    {
-        Assert.Equal(
+        => Assert.Equal(
             CoreStrings.ClientProjectionCapturingConstantInTree(
                 "Microsoft.EntityFrameworkCore.Query.NorthwindMiscellaneousQuerySqliteTest"),
             (await Assert.ThrowsAsync<InvalidOperationException>(
                 () => base.Client_code_using_instance_in_anonymous_type(async))).Message);
 
-        AssertSql();
-    }
-
     public override async Task Client_code_unknown_method(bool async)
-    {
-        await AssertTranslationFailedWithDetails(
+        => await AssertTranslationFailedWithDetails(
             () => base.Client_code_unknown_method(async),
             CoreStrings.QueryUnableToTranslateMethod(
                 "Microsoft.EntityFrameworkCore.Query.NorthwindMiscellaneousQueryTestBase<Microsoft.EntityFrameworkCore.Query.NorthwindQuerySqliteFixture<Microsoft.EntityFrameworkCore.TestUtilities.NoopModelCustomizer>>",
                 nameof(UnknownMethod)));
 
-        AssertSql();
-    }
+    public override async Task Entity_equality_through_subquery_composite_key(bool async)
+        => Assert.Equal(
+            CoreStrings.EntityEqualityOnCompositeKeyEntitySubqueryNotSupported("==", nameof(OrderDetail)),
+            (await Assert.ThrowsAsync<InvalidOperationException>(
+                () => base.Entity_equality_through_subquery_composite_key(async))).Message);
 
     public override async Task DefaultIfEmpty_in_subquery_nested_filter_order_comparison(bool async)
         => Assert.Equal(
diff --git a/test/EFCore.Sqlite.FunctionalTests/Query/NorthwindWhereQuerySqliteTest.cs b/test/EFCore.Sqlite.FunctionalTests/Query/NorthwindWhereQuerySqliteTest.cs
index 110dbe09cb..68f71cc847 100644
--- a/test/EFCore.Sqlite.FunctionalTests/Query/NorthwindWhereQuerySqliteTest.cs
+++ b/test/EFCore.Sqlite.FunctionalTests/Query/NorthwindWhereQuerySqliteTest.cs
@@ -12,26 +12,14 @@ public NorthwindWhereQuerySqliteTest(NorthwindQuerySqliteFixture<NoopModelCustom
         //Fixture.TestSqlLoggerFactory.SetTestOutputHelper(testOutputHelper);
     }
 
-    public override async Task Where_datetimeoffset_now_component(bool async)
-    {
-        await AssertTranslationFailed(() => base.Where_datetimeoffset_now_component(async));
-
-        AssertSql();
-    }
-
-    public override async Task Where_datetimeoffset_utcnow_component(bool async)
-    {
-        await AssertTranslationFailed(() => base.Where_datetimeoffset_utcnow_component(async));
+    public override Task Where_datetimeoffset_now_component(bool async)
+        => AssertTranslationFailed(() => base.Where_datetimeoffset_now_component(async));
 
-        AssertSql();
-    }
-
-    public override async Task Where_datetimeoffset_utcnow(bool async)
-    {
-        await AssertTranslationFailed(() => base.Where_datetimeoffset_utcnow_component(async));
+    public override Task Where_datetimeoffset_utcnow_component(bool async)
+        => AssertTranslationFailed(() => base.Where_datetimeoffset_utcnow_component(async));
 
-        AssertSql();
-    }
+    public override Task Where_datetimeoffset_utcnow(bool async)
+        => AssertTranslationFailed(() => base.Where_datetimeoffset_utcnow_component(async));
 
     public override async Task<string> Where_simple_closure(bool async)
     {
