diff --git a/test/EFCore.Cosmos.FunctionalTests/Query/Relationships/InProjection/JsonRelationshipsInProjectionNoTrackingQueryCosmosTest.cs b/test/EFCore.Cosmos.FunctionalTests/Query/Relationships/InProjection/JsonRelationshipsInProjectionNoTrackingQueryCosmosTest.cs
deleted file mode 100644
index 469d6eb33c..0000000000
--- a/test/EFCore.Cosmos.FunctionalTests/Query/Relationships/InProjection/JsonRelationshipsInProjectionNoTrackingQueryCosmosTest.cs
+++ /dev/null
@@ -1,317 +0,0 @@
-﻿// Licensed to the .NET Foundation under one or more agreements.
-// The .NET Foundation licenses this file to you under the MIT license.
-
-namespace Microsoft.EntityFrameworkCore.Query.Relationships.InProjection;
-
-public class JsonRelationshipsInProjectionNoTrackingQueryCosmosTest : JsonRelationshipsInProjectionQueryTestBase<JsonRelationshipsQueryCosmosFixture>
-{
-    private readonly NoTrackingRewriter _noTrackingRewriter = new();
-
-    public JsonRelationshipsInProjectionNoTrackingQueryCosmosTest(JsonRelationshipsQueryCosmosFixture fixture, ITestOutputHelper testOutputHelper)
-        : base(fixture)
-    {
-        Fixture.TestSqlLoggerFactory.Clear();
-        Fixture.TestSqlLoggerFactory.SetTestOutputHelper(testOutputHelper);
-    }
-
-    protected override Expression RewriteServerQueryExpression(Expression serverQueryExpression)
-    {
-        var rewritten = _noTrackingRewriter.Visit(serverQueryExpression);
-
-        return rewritten;
-    }
-
-    public override Task Project_root(bool async)
-        => Fixture.NoSyncTest(
-            async, async a =>
-            {
-                await base.Project_root(a);
-
-                AssertSql(
-                    """
-SELECT VALUE c
-FROM root c
-""");
-            });
-
-    public override Task Project_trunk_optional(bool async)
-        => Fixture.NoSyncTest(
-            async, async a =>
-            {
-                await base.Project_trunk_optional(a);
-
-                AssertSql(
-                    """
-SELECT VALUE c
-FROM root c
-ORDER BY c["Id"]
-""");
-            });
-
-    public override Task Project_trunk_required(bool async)
-        => Fixture.NoSyncTest(
-            async, async a =>
-            {
-                await base.Project_trunk_required(a);
-
-                AssertSql(
-                    """
-SELECT VALUE c
-FROM root c
-ORDER BY c["Id"]
-""");
-            });
-
-    public override Task Project_trunk_collection(bool async)
-        => Fixture.NoSyncTest(
-            async, async a =>
-            {
-                await base.Project_trunk_collection(a);
-
-                AssertSql(
-                    """
-SELECT VALUE c
-FROM root c
-ORDER BY c["Id"]
-""");
-            });
-
-    public override Task Project_branch_required_required(bool async)
-        => Fixture.NoSyncTest(
-            async, async a =>
-            {
-                await base.Project_branch_required_required(a);
-
-                AssertSql(
-                    """
-SELECT VALUE c
-FROM root c
-ORDER BY c["Id"]
-""");
-            });
-
-    public override Task Project_branch_required_optional(bool async)
-        => Fixture.NoSyncTest(
-            async, async a =>
-            {
-                await base.Project_branch_required_optional(a);
-
-                AssertSql(
-                    """
-SELECT VALUE c
-FROM root c
-ORDER BY c["Id"]
-""");
-            });
-
-    public override async Task Project_branch_required_collection(bool async)
-    {
-        if (async)
-        {
-            //issue #31696
-            await Assert.ThrowsAsync<NullReferenceException>(
-                () => base.Project_branch_required_collection(async));
-
-            AssertSql(
-                """
-SELECT VALUE c
-FROM root c
-ORDER BY c["Id"]
-""");
-        }
-    }
-
-    public override Task Project_branch_optional_required(bool async)
-        => Fixture.NoSyncTest(
-            async, async a =>
-            {
-                await base.Project_branch_optional_required(a);
-
-                AssertSql(
-                    """
-SELECT VALUE c
-FROM root c
-ORDER BY c["Id"]
-""");
-            });
-
-    public override Task Project_branch_optional_optional(bool async)
-        => Fixture.NoSyncTest(
-            async, async a =>
-            {
-                await base.Project_branch_optional_optional(a);
-
-                AssertSql(
-                    """
-SELECT VALUE c
-FROM root c
-ORDER BY c["Id"]
-""");
-            });
-
-    public override async Task Project_branch_optional_collection(bool async)
-    {
-        if (async)
-        {
-            //issue #31696
-            await Assert.ThrowsAsync<NullReferenceException>(
-                () => base.Project_branch_optional_collection(async));
-
-            AssertSql(
-                """
-SELECT VALUE c
-FROM root c
-ORDER BY c["Id"]
-""");
-        }
-    }
-
-    public override async Task Project_branch_collection_element_using_indexer_constant(bool async)
-    {
-        if (async)
-        {
-            //issue #31696
-            await Assert.ThrowsAsync<NullReferenceException>(
-                () => base.Project_branch_collection_element_using_indexer_constant(async));
-
-            AssertSql(
-                """
-SELECT VALUE c
-FROM root c
-ORDER BY c["Id"]
-""");
-        }
-    }
-
-    public override Task Project_root_duplicated(bool async)
-        => Fixture.NoSyncTest(
-            async, async a =>
-            {
-                await base.Project_root_duplicated(a);
-
-                AssertSql(
-                    """
-SELECT VALUE c
-FROM root c
-""");
-            });
-
-    public override async Task Project_trunk_and_branch_duplicated(bool async)
-    {
-        if (async)
-        {
-            //issue #31696
-            await Assert.ThrowsAsync<NullReferenceException>(
-                () => base.Project_trunk_and_branch_duplicated(async));
-
-            AssertSql(
-                """
-SELECT VALUE c
-FROM root c
-ORDER BY c["Id"]
-""");
-        }
-    }
-
-    public override async Task Project_trunk_and_trunk_duplicated(bool async)
-    {
-        if (async)
-        {
-            //issue #31696
-            await Assert.ThrowsAsync<NullReferenceException>(
-                () => base.Project_trunk_and_trunk_duplicated(async));
-
-            AssertSql(
-                """
-SELECT VALUE c
-FROM root c
-ORDER BY c["Id"]
-""");
-        }
-    }
-
-    public override async Task Project_multiple_branch_leaf(bool async)
-    {
-        if (async)
-        {
-            //issue #35702
-            await Assert.ThrowsAsync<ArgumentException>(
-                () => base.Project_multiple_branch_leaf(async));
-
-            AssertSql();
-        }
-    }
-
-    public override Task Project_leaf_trunk_root(bool async)
-        => Fixture.NoSyncTest(
-            async, async a =>
-            {
-                await base.Project_leaf_trunk_root(a);
-
-                AssertSql(
-                    """
-SELECT VALUE c
-FROM root c
-""");
-            });
-
-
-    public override Task Project_subquery_root_set_required_trunk_FirstOrDefault_branch(bool async)
-        => AssertTranslationFailed(
-            () => base.Project_subquery_root_set_required_trunk_FirstOrDefault_branch(async));
-
-    public override Task Project_subquery_root_set_optional_trunk_FirstOrDefault_branch(bool async)
-        => AssertTranslationFailed(
-            () => base.Project_subquery_root_set_optional_trunk_FirstOrDefault_branch(async));
-
-    public override Task Project_subquery_root_set_trunk_FirstOrDefault_collection(bool async)
-        => AssertTranslationFailed(
-            () => base.Project_subquery_root_set_trunk_FirstOrDefault_collection(async));
-
-    public override Task Project_subquery_root_set_complex_projection_including_references_to_outer_FirstOrDefault(bool async)
-        => AssertTranslationFailed(
-            () => base.Project_subquery_root_set_complex_projection_including_references_to_outer_FirstOrDefault(async));
-
-    public override Task Project_subquery_root_set_complex_projection_FirstOrDefault_project_reference_to_outer(bool async)
-        => AssertTranslationFailed(
-            () => base.Project_subquery_root_set_complex_projection_FirstOrDefault_project_reference_to_outer(async));
-
-    public override async Task SelectMany_trunk_collection(bool async)
-    {
-        if (async)
-        {
-            //issue #34349
-            await Assert.ThrowsAsync<KeyNotFoundException>(
-                () => base.SelectMany_trunk_collection(async));
-
-            AssertSql();
-        }
-    }
-
-    public override async Task SelectMany_required_trunk_reference_branch_collection(bool async)
-    {
-        if (async)
-        {
-            //issue #34349
-            await Assert.ThrowsAsync<KeyNotFoundException>(
-                () => base.SelectMany_required_trunk_reference_branch_collection(async));
-
-            AssertSql();
-        }
-    }
-
-    public override async Task SelectMany_optional_trunk_reference_branch_collection(bool async)
-    {
-        if (async)
-        {
-            //issue #34349
-            await Assert.ThrowsAsync<KeyNotFoundException>(
-                () => base.SelectMany_optional_trunk_reference_branch_collection(async));
-
-            AssertSql();
-        }
-    }
-
-    private void AssertSql(params string[] expected)
-        => Fixture.TestSqlLoggerFactory.AssertBaseline(expected);
-}
diff --git a/test/EFCore.Cosmos.FunctionalTests/Query/Relationships/JsonRelationshipsQueryCosmosFixture.cs b/test/EFCore.Cosmos.FunctionalTests/Query/Relationships/OwnedJsonRelationshipsCosmosFixture.cs
similarity index 94%
rename from test/EFCore.Cosmos.FunctionalTests/Query/Relationships/JsonRelationshipsQueryCosmosFixture.cs
rename to test/EFCore.Cosmos.FunctionalTests/Query/Relationships/OwnedJsonRelationshipsCosmosFixture.cs
index 0444901a12..4bd8b15591 100644
--- a/test/EFCore.Cosmos.FunctionalTests/Query/Relationships/JsonRelationshipsQueryCosmosFixture.cs
+++ b/test/EFCore.Cosmos.FunctionalTests/Query/Relationships/OwnedJsonRelationshipsCosmosFixture.cs
@@ -5,7 +5,7 @@
 
 namespace Microsoft.EntityFrameworkCore.Query.Relationships;
 
-public class JsonRelationshipsQueryCosmosFixture : JsonRelationshipsQueryFixtureBase
+public class OwnedJsonRelationshipsCosmosFixture : OwnedJsonRelationshipsFixtureBase
 {
     public TestSqlLoggerFactory TestSqlLoggerFactory
         => (TestSqlLoggerFactory)ListLoggerFactory;
diff --git a/test/EFCore.Cosmos.FunctionalTests/Query/Relationships/Projection/OwnedJsonNoTrackingProjectionCosmosTest.cs b/test/EFCore.Cosmos.FunctionalTests/Query/Relationships/Projection/OwnedJsonNoTrackingProjectionCosmosTest.cs
new file mode 100644
index 0000000000..863a7153f0
--- /dev/null
+++ b/test/EFCore.Cosmos.FunctionalTests/Query/Relationships/Projection/OwnedJsonNoTrackingProjectionCosmosTest.cs
@@ -0,0 +1,151 @@
+﻿// Licensed to the .NET Foundation under one or more agreements.
+// The .NET Foundation licenses this file to you under the MIT license.
+
+namespace Microsoft.EntityFrameworkCore.Query.Relationships.Projection;
+
+public class OwnedJsonNoTrackingProjectionCosmosTest : OwnedJsonNoTrackingProjectionTestBase<OwnedJsonRelationshipsCosmosFixture>
+{
+    private readonly TrackingRewriter _trackingRewriter = new();
+
+    public OwnedJsonNoTrackingProjectionCosmosTest(OwnedJsonRelationshipsCosmosFixture fixture, ITestOutputHelper testOutputHelper)
+        : base(fixture)
+    {
+        Fixture.TestSqlLoggerFactory.Clear();
+        Fixture.TestSqlLoggerFactory.SetTestOutputHelper(testOutputHelper);
+    }
+
+    protected override Expression RewriteServerQueryExpression(Expression serverQueryExpression)
+    {
+        var rewritten = _trackingRewriter.Visit(serverQueryExpression);
+
+        return rewritten;
+    }
+
+    public override Task Select_trunk_collection(bool async)
+        => Fixture.NoSyncTest(
+            async, async a =>
+            {
+                await base.Select_trunk_collection(a);
+
+                AssertSql(
+                    """
+SELECT VALUE c
+FROM root c
+ORDER BY c["Id"]
+""");
+            });
+
+    public override async Task Select_branch_required_collection(bool async)
+    {
+        if (async)
+        {
+            //issue #31696
+            await Assert.ThrowsAsync<NullReferenceException>(
+                () => base.Select_branch_required_collection(async));
+
+            AssertSql(
+                """
+SELECT VALUE c
+FROM root c
+ORDER BY c["Id"]
+""");
+        }
+    }
+
+    public override async Task Select_branch_optional_collection(bool async)
+    {
+        if (async)
+        {
+            //issue #31696
+            await Assert.ThrowsAsync<NullReferenceException>(
+                () => base.Select_branch_optional_collection(async));
+
+            AssertSql(
+                """
+SELECT VALUE c
+FROM root c
+ORDER BY c["Id"]
+""");
+        }
+    }
+
+    public override async Task Project_branch_collection_element_using_indexer_constant(bool async)
+    {
+        if (async)
+        {
+            //issue #31696
+            await Assert.ThrowsAsync<NullReferenceException>(
+                () => base.Project_branch_collection_element_using_indexer_constant(async));
+
+            AssertSql(
+                """
+SELECT VALUE c
+FROM root c
+ORDER BY c["Id"]
+""");
+        }
+    }
+
+    public override async Task Select_multiple_branch_leaf(bool async)
+    {
+        if (async)
+        {
+            //issue #35702
+            await Assert.ThrowsAsync<ArgumentException>(
+                () => base.Select_multiple_branch_leaf(async));
+
+            AssertSql();
+        }
+    }
+
+    public override Task Select_subquery_root_set_trunk_FirstOrDefault_collection(bool async)
+        => AssertTranslationFailed(
+            () => base.Select_subquery_root_set_trunk_FirstOrDefault_collection(async));
+
+    public override Task Select_subquery_root_set_complex_projection_including_references_to_outer_FirstOrDefault(bool async)
+        => AssertTranslationFailed(
+            () => base.Select_subquery_root_set_complex_projection_including_references_to_outer_FirstOrDefault(async));
+
+    public override Task Select_subquery_root_set_complex_projection_FirstOrDefault_project_reference_to_outer(bool async)
+        => AssertTranslationFailed(
+            () => base.Select_subquery_root_set_complex_projection_FirstOrDefault_project_reference_to_outer(async));
+
+    public override async Task SelectMany_trunk_collection(bool async)
+    {
+        if (async)
+        {
+            //issue #34349
+            await Assert.ThrowsAsync<KeyNotFoundException>(
+                () => base.SelectMany_trunk_collection(async));
+
+            AssertSql();
+        }
+    }
+
+    public override async Task SelectMany_required_trunk_reference_branch_collection(bool async)
+    {
+        if (async)
+        {
+            //issue #34349
+            await Assert.ThrowsAsync<KeyNotFoundException>(
+                () => base.SelectMany_required_trunk_reference_branch_collection(async));
+
+            AssertSql();
+        }
+    }
+
+    public override async Task SelectMany_optional_trunk_reference_branch_collection(bool async)
+    {
+        if (async)
+        {
+            //issue #34349
+            await Assert.ThrowsAsync<KeyNotFoundException>(
+                () => base.SelectMany_optional_trunk_reference_branch_collection(async));
+
+            AssertSql();
+        }
+    }
+
+    private void AssertSql(params string[] expected)
+        => Fixture.TestSqlLoggerFactory.AssertBaseline(expected);
+}
diff --git a/test/EFCore.Cosmos.FunctionalTests/Query/Relationships/Projection/OwnedJsonReferenceNoTrackingProjectionCosmosTest.cs b/test/EFCore.Cosmos.FunctionalTests/Query/Relationships/Projection/OwnedJsonReferenceNoTrackingProjectionCosmosTest.cs
new file mode 100644
index 0000000000..a7e802b94f
--- /dev/null
+++ b/test/EFCore.Cosmos.FunctionalTests/Query/Relationships/Projection/OwnedJsonReferenceNoTrackingProjectionCosmosTest.cs
@@ -0,0 +1,192 @@
+﻿// Licensed to the .NET Foundation under one or more agreements.
+// The .NET Foundation licenses this file to you under the MIT license.
+
+namespace Microsoft.EntityFrameworkCore.Query.Relationships.Projection;
+
+public class OwnedJsonReferenceNoTrackingProjectionCosmosTest : OwnedJsonReferenceNoTrackingProjectionTestBase<OwnedJsonRelationshipsCosmosFixture>
+{
+    private readonly TrackingRewriter _trackingRewriter = new();
+
+    public OwnedJsonReferenceNoTrackingProjectionCosmosTest(OwnedJsonRelationshipsCosmosFixture fixture, ITestOutputHelper testOutputHelper)
+        : base(fixture)
+    {
+        Fixture.TestSqlLoggerFactory.Clear();
+        Fixture.TestSqlLoggerFactory.SetTestOutputHelper(testOutputHelper);
+    }
+
+    protected override Expression RewriteServerQueryExpression(Expression serverQueryExpression)
+    {
+        var rewritten = _trackingRewriter.Visit(serverQueryExpression);
+
+        return rewritten;
+    }
+
+    public override Task Select_root(bool async)
+        => Fixture.NoSyncTest(
+            async, async a =>
+            {
+                await base.Select_root(a);
+
+                AssertSql(
+                    """
+SELECT VALUE c
+FROM root c
+""");
+            });
+
+    public override Task Select_trunk_optional(bool async)
+        => Fixture.NoSyncTest(
+            async, async a =>
+            {
+                await base.Select_trunk_optional(a);
+
+                AssertSql(
+                    """
+SELECT VALUE c
+FROM root c
+ORDER BY c["Id"]
+""");
+            });
+
+    public override Task Select_trunk_required(bool async)
+        => Fixture.NoSyncTest(
+            async, async a =>
+            {
+                await base.Select_trunk_required(a);
+
+                AssertSql(
+                    """
+SELECT VALUE c
+FROM root c
+ORDER BY c["Id"]
+""");
+            });
+
+    public override Task Select_branch_required_required(bool async)
+        => Fixture.NoSyncTest(
+            async, async a =>
+            {
+                await base.Select_branch_required_required(a);
+
+                AssertSql(
+                    """
+SELECT VALUE c
+FROM root c
+ORDER BY c["Id"]
+""");
+            });
+
+    public override Task Select_branch_required_optional(bool async)
+        => Fixture.NoSyncTest(
+            async, async a =>
+            {
+                await base.Select_branch_required_optional(a);
+
+                AssertSql(
+                    """
+SELECT VALUE c
+FROM root c
+ORDER BY c["Id"]
+""");
+            });
+
+    public override Task Select_branch_optional_required(bool async)
+        => Fixture.NoSyncTest(
+            async, async a =>
+            {
+                await base.Select_branch_optional_required(a);
+
+                AssertSql(
+                    """
+SELECT VALUE c
+FROM root c
+ORDER BY c["Id"]
+""");
+            });
+
+    public override Task Select_branch_optional_optional(bool async)
+        => Fixture.NoSyncTest(
+            async, async a =>
+            {
+                await base.Select_branch_optional_optional(a);
+
+                AssertSql(
+                    """
+SELECT VALUE c
+FROM root c
+ORDER BY c["Id"]
+""");
+            });
+
+    public override Task Select_root_duplicated(bool async)
+        => Fixture.NoSyncTest(
+            async, async a =>
+            {
+                await base.Select_root_duplicated(a);
+
+                AssertSql(
+                    """
+SELECT VALUE c
+FROM root c
+""");
+            });
+
+    public override async Task Select_trunk_and_branch_duplicated(bool async)
+    {
+        if (async)
+        {
+            //issue #31696
+            await Assert.ThrowsAsync<NullReferenceException>(
+                () => base.Select_trunk_and_branch_duplicated(async));
+
+            AssertSql(
+                """
+SELECT VALUE c
+FROM root c
+ORDER BY c["Id"]
+""");
+        }
+    }
+
+    public override async Task Select_trunk_and_trunk_duplicated(bool async)
+    {
+        if (async)
+        {
+            //issue #31696
+            await Assert.ThrowsAsync<NullReferenceException>(
+                () => base.Select_trunk_and_trunk_duplicated(async));
+
+            AssertSql(
+                """
+SELECT VALUE c
+FROM root c
+ORDER BY c["Id"]
+""");
+        }
+    }
+
+    public override Task Select_leaf_trunk_root(bool async)
+        => Fixture.NoSyncTest(
+            async, async a =>
+            {
+                await base.Select_leaf_trunk_root(a);
+
+                AssertSql(
+                    """
+SELECT VALUE c
+FROM root c
+""");
+            });
+
+
+    public override Task Select_subquery_root_set_required_trunk_FirstOrDefault_branch(bool async)
+        => AssertTranslationFailed(
+            () => base.Select_subquery_root_set_required_trunk_FirstOrDefault_branch(async));
+
+    public override Task Select_subquery_root_set_optional_trunk_FirstOrDefault_branch(bool async)
+        => AssertTranslationFailed(
+            () => base.Select_subquery_root_set_optional_trunk_FirstOrDefault_branch(async));
+
+    private void AssertSql(params string[] expected)
+        => Fixture.TestSqlLoggerFactory.AssertBaseline(expected);
+}
diff --git a/test/EFCore.InMemory.FunctionalTests/InMemoryComplianceTest.cs b/test/EFCore.InMemory.FunctionalTests/InMemoryComplianceTest.cs
index a6707db2bc..4c03937389 100644
--- a/test/EFCore.InMemory.FunctionalTests/InMemoryComplianceTest.cs
+++ b/test/EFCore.InMemory.FunctionalTests/InMemoryComplianceTest.cs
@@ -3,7 +3,7 @@
 
 using Microsoft.EntityFrameworkCore.BulkUpdates;
 using Microsoft.EntityFrameworkCore.Query.Relationships.Include;
-using Microsoft.EntityFrameworkCore.Query.Relationships.InProjection;
+using Microsoft.EntityFrameworkCore.Query.Relationships.Projection;
 
 namespace Microsoft.EntityFrameworkCore;
 
@@ -29,17 +29,24 @@ public class InMemoryComplianceTest : ComplianceTestBase
         typeof(JsonQueryTestBase<>),
 
         // TODO: implement later once things are baked
-        typeof(ComplexRelationshipsInProjectionNoTrackingQueryTestBase<>),
-        typeof(ComplexRelationshipsInProjectionQueryTestBase<>),
-        typeof(EntityRelationshipsInProjectionNoTrackingQueryTestBase<>),
-        typeof(EntityRelationshipsInProjectionQueryTestBase<>),
-        typeof(JsonRelationshipsInProjectionNoTrackingQueryTestBase<>),
-        typeof(JsonRelationshipsInProjectionQueryTestBase<>),
-        typeof(OwnedRelationshipsInProjectionNoTrackingQueryTestBase<>),
-        typeof(OwnedRelationshipsInProjectionQueryTestBase<>),
-        typeof(RelationshipsInProjectionQueryTestBase<>),
-        typeof(EntityRelationshipsIncludeQueryTestBase<>),
-        typeof(RelationshipsIncludeQueryTestBase<>),
+        typeof(NavigationNoTrackingProjectionTestBase<>),
+        typeof(NavigationProjectionTestBase<>),
+        typeof(OwnedJsonNoTrackingProjectionTestBase<>),
+        typeof(OwnedJsonProjectionTestBase<>),
+        typeof(OwnedNoTrackingProjectionTestBase<>),
+        typeof(OwnedProjectionTestBase<>),
+        typeof(ProjectionTestBase<>),
+        typeof(NavigationIncludeTestBase<>),
+
+        typeof(ComplexNoTrackingProjectionTestBase<>),
+        typeof(ComplexProjectionTestBase<>),
+        typeof(NavigationReferenceNoTrackingProjectionTestBase<>),
+        typeof(NavigationReferenceProjectionTestBase<>),
+        typeof(OwnedJsonReferenceNoTrackingProjectionTestBase<>),
+        typeof(OwnedJsonReferenceProjectionTestBase<>),
+        typeof(OwnedReferenceNoTrackingProjectionTestBase<>),
+        typeof(OwnedReferenceProjectionTestBase<>),
+        typeof(ReferenceProjectionTestBase<>),
     };
 
     protected override Assembly TargetAssembly { get; } = typeof(InMemoryComplianceTest).Assembly;
diff --git a/test/EFCore.Relational.Specification.Tests/Query/Relationships/ComplexRelationshipsQueryRelationalFixtureBase.cs b/test/EFCore.Relational.Specification.Tests/Query/Relationships/ComplexRelationsjipsRelationalFixtureBase.cs
similarity index 86%
rename from test/EFCore.Relational.Specification.Tests/Query/Relationships/ComplexRelationshipsQueryRelationalFixtureBase.cs
rename to test/EFCore.Relational.Specification.Tests/Query/Relationships/ComplexRelationsjipsRelationalFixtureBase.cs
index 99e8131795..0989a7ee3d 100644
--- a/test/EFCore.Relational.Specification.Tests/Query/Relationships/ComplexRelationshipsQueryRelationalFixtureBase.cs
+++ b/test/EFCore.Relational.Specification.Tests/Query/Relationships/ComplexRelationsjipsRelationalFixtureBase.cs
@@ -5,7 +5,7 @@
 
 namespace Microsoft.EntityFrameworkCore.Query.Relationships;
 
-public abstract class ComplexRelationshipsQueryRelationalFixtureBase : ComplexRelationshipsQueryFixtureBase
+public abstract class ComplexRelationsjipsRelationalFixtureBase : ComplexRelationshipsFixtureBase
 {
     protected override void OnModelCreating(ModelBuilder modelBuilder, DbContext context)
     {
diff --git a/test/EFCore.Relational.Specification.Tests/Query/Relationships/InProjection/ComplexRelationshipsInProjectionNoTrackingQueryRelationalTestBase.cs b/test/EFCore.Relational.Specification.Tests/Query/Relationships/InProjection/ComplexRelationshipsInProjectionNoTrackingQueryRelationalTestBase.cs
deleted file mode 100644
index fa56634fb1..0000000000
--- a/test/EFCore.Relational.Specification.Tests/Query/Relationships/InProjection/ComplexRelationshipsInProjectionNoTrackingQueryRelationalTestBase.cs
+++ /dev/null
@@ -1,10 +0,0 @@
-﻿// Licensed to the .NET Foundation under one or more agreements.
-// The .NET Foundation licenses this file to you under the MIT license.
-
-namespace Microsoft.EntityFrameworkCore.Query.Relationships.InProjection;
-
-public abstract class ComplexRelationshipsInProjectionNoTrackingQueryRelationalTestBase<TFixture>(TFixture fixture)
-    : ComplexRelationshipsInProjectionNoTrackingQueryTestBase<TFixture>(fixture)
-        where TFixture : ComplexRelationshipsQueryRelationalFixtureBase, new()
-{
-}
diff --git a/test/EFCore.Relational.Specification.Tests/Query/Relationships/InProjection/ComplexRelationshipsInProjectionQueryRelationalTestBase.cs b/test/EFCore.Relational.Specification.Tests/Query/Relationships/InProjection/ComplexRelationshipsInProjectionQueryRelationalTestBase.cs
deleted file mode 100644
index fd87362593..0000000000
--- a/test/EFCore.Relational.Specification.Tests/Query/Relationships/InProjection/ComplexRelationshipsInProjectionQueryRelationalTestBase.cs
+++ /dev/null
@@ -1,10 +0,0 @@
-﻿// Licensed to the .NET Foundation under one or more agreements.
-// The .NET Foundation licenses this file to you under the MIT license.
-
-namespace Microsoft.EntityFrameworkCore.Query.Relationships.InProjection;
-
-public abstract class ComplexRelationshipsInProjectionQueryRelationalTestBase<TFixture>(TFixture fixture)
-    : ComplexRelationshipsInProjectionQueryTestBase<TFixture>(fixture)
-        where TFixture : ComplexRelationshipsQueryRelationalFixtureBase, new()
-{
-}
diff --git a/test/EFCore.Relational.Specification.Tests/Query/Relationships/InProjection/EntityRelationshipsInProjectionNoTrackingQueryRelationalTestBase.cs b/test/EFCore.Relational.Specification.Tests/Query/Relationships/InProjection/EntityRelationshipsInProjectionNoTrackingQueryRelationalTestBase.cs
deleted file mode 100644
index dc74cb8d5a..0000000000
--- a/test/EFCore.Relational.Specification.Tests/Query/Relationships/InProjection/EntityRelationshipsInProjectionNoTrackingQueryRelationalTestBase.cs
+++ /dev/null
@@ -1,10 +0,0 @@
-﻿// Licensed to the .NET Foundation under one or more agreements.
-// The .NET Foundation licenses this file to you under the MIT license.
-
-namespace Microsoft.EntityFrameworkCore.Query.Relationships.InProjection;
-
-public abstract class EntityRelationshipsInProjectionNoTrackingQueryRelationalTestBase<TFixture>(TFixture fixture)
-    : EntityRelationshipsInProjectionNoTrackingQueryTestBase<TFixture>(fixture)
-        where TFixture : EntityRelationshipsQueryRelationalFixtureBase, new()
-{
-}
diff --git a/test/EFCore.Relational.Specification.Tests/Query/Relationships/InProjection/EntityRelationshipsInProjectionQueryRelationalTestBase.cs b/test/EFCore.Relational.Specification.Tests/Query/Relationships/InProjection/EntityRelationshipsInProjectionQueryRelationalTestBase.cs
deleted file mode 100644
index 7641634a22..0000000000
--- a/test/EFCore.Relational.Specification.Tests/Query/Relationships/InProjection/EntityRelationshipsInProjectionQueryRelationalTestBase.cs
+++ /dev/null
@@ -1,10 +0,0 @@
-﻿// Licensed to the .NET Foundation under one or more agreements.
-// The .NET Foundation licenses this file to you under the MIT license.
-
-namespace Microsoft.EntityFrameworkCore.Query.Relationships.InProjection;
-
-public abstract class EntityRelationshipsInProjectionQueryRelationalTestBase<TFixture>(TFixture fixture)
-    : EntityRelationshipsInProjectionQueryTestBase<TFixture>(fixture)
-        where TFixture : EntityRelationshipsQueryRelationalFixtureBase, new()
-{
-}
diff --git a/test/EFCore.Relational.Specification.Tests/Query/Relationships/InProjection/JsonRelationshipsInProjectionNoTrackingQueryRelationalTestBase.cs b/test/EFCore.Relational.Specification.Tests/Query/Relationships/InProjection/JsonRelationshipsInProjectionNoTrackingQueryRelationalTestBase.cs
deleted file mode 100644
index df73aae676..0000000000
--- a/test/EFCore.Relational.Specification.Tests/Query/Relationships/InProjection/JsonRelationshipsInProjectionNoTrackingQueryRelationalTestBase.cs
+++ /dev/null
@@ -1,10 +0,0 @@
-﻿// Licensed to the .NET Foundation under one or more agreements.
-// The .NET Foundation licenses this file to you under the MIT license.
-
-namespace Microsoft.EntityFrameworkCore.Query.Relationships.InProjection;
-
-public abstract class JsonRelationshipsInProjectionNoTrackingQueryRelationalTestBase<TFixture>(TFixture fixture)
-    : JsonRelationshipsInProjectionNoTrackingQueryTestBase<TFixture>(fixture)
-        where TFixture : JsonRelationshipsQueryRelationalFixtureBase, new()
-{
-}
diff --git a/test/EFCore.Relational.Specification.Tests/Query/Relationships/InProjection/JsonRelationshipsInProjectionQueryRelationalTestBase.cs b/test/EFCore.Relational.Specification.Tests/Query/Relationships/InProjection/JsonRelationshipsInProjectionQueryRelationalTestBase.cs
deleted file mode 100644
index 0c2a03171d..0000000000
--- a/test/EFCore.Relational.Specification.Tests/Query/Relationships/InProjection/JsonRelationshipsInProjectionQueryRelationalTestBase.cs
+++ /dev/null
@@ -1,10 +0,0 @@
-﻿// Licensed to the .NET Foundation under one or more agreements.
-// The .NET Foundation licenses this file to you under the MIT license.
-
-namespace Microsoft.EntityFrameworkCore.Query.Relationships.InProjection;
-
-public abstract class JsonRelationshipsInProjectionQueryRelationalTestBase<TFixture>(TFixture fixture)
-    : JsonRelationshipsInProjectionQueryTestBase<TFixture>(fixture)
-        where TFixture : JsonRelationshipsQueryRelationalFixtureBase, new()
-{
-}
diff --git a/test/EFCore.Relational.Specification.Tests/Query/Relationships/InProjection/OwnedRelationshipsInProjectionNoTrackingQueryRelationalTestBase.cs b/test/EFCore.Relational.Specification.Tests/Query/Relationships/InProjection/OwnedRelationshipsInProjectionNoTrackingQueryRelationalTestBase.cs
deleted file mode 100644
index e04e947d6a..0000000000
--- a/test/EFCore.Relational.Specification.Tests/Query/Relationships/InProjection/OwnedRelationshipsInProjectionNoTrackingQueryRelationalTestBase.cs
+++ /dev/null
@@ -1,10 +0,0 @@
-﻿// Licensed to the .NET Foundation under one or more agreements.
-// The .NET Foundation licenses this file to you under the MIT license.
-
-namespace Microsoft.EntityFrameworkCore.Query.Relationships.InProjection;
-
-public abstract class OwnedRelationshipsInProjectionNoTrackingQueryRelationalTestBase<TFixture>(TFixture fixture)
-    : OwnedRelationshipsInProjectionNoTrackingQueryTestBase<TFixture>(fixture)
-        where TFixture : OwnedRelationshipsQueryRelationalFixtureBase, new()
-{
-}
diff --git a/test/EFCore.Relational.Specification.Tests/Query/Relationships/InProjection/OwnedRelationshipsInProjectionQueryRelationalTestBase.cs b/test/EFCore.Relational.Specification.Tests/Query/Relationships/InProjection/OwnedRelationshipsInProjectionQueryRelationalTestBase.cs
deleted file mode 100644
index 4205cfe94c..0000000000
--- a/test/EFCore.Relational.Specification.Tests/Query/Relationships/InProjection/OwnedRelationshipsInProjectionQueryRelationalTestBase.cs
+++ /dev/null
@@ -1,10 +0,0 @@
-﻿// Licensed to the .NET Foundation under one or more agreements.
-// The .NET Foundation licenses this file to you under the MIT license.
-
-namespace Microsoft.EntityFrameworkCore.Query.Relationships.InProjection;
-
-public abstract class OwnedRelationshipsInProjectionQueryRelationalTestBase<TFixture>(TFixture fixture)
-    : OwnedRelationshipsInProjectionQueryTestBase<TFixture>(fixture)
-        where TFixture : OwnedRelationshipsQueryRelationalFixtureBase, new()
-{
-}
diff --git a/test/EFCore.Relational.Specification.Tests/Query/Relationships/Include/EntityRelationshipsIncludeQueryRelationalTestBase.cs b/test/EFCore.Relational.Specification.Tests/Query/Relationships/Include/EntityRelationshipsIncludeQueryRelationalTestBase.cs
deleted file mode 100644
index 234c0b1399..0000000000
--- a/test/EFCore.Relational.Specification.Tests/Query/Relationships/Include/EntityRelationshipsIncludeQueryRelationalTestBase.cs
+++ /dev/null
@@ -1,10 +0,0 @@
-﻿// Licensed to the .NET Foundation under one or more agreements.
-// The .NET Foundation licenses this file to you under the MIT license.
-
-namespace Microsoft.EntityFrameworkCore.Query.Relationships.Include;
-
-public abstract class EntityRelationshipsIncludeQueryRelationalTestBase<TFixture>(TFixture fixture)
-    : EntityRelationshipsIncludeQueryTestBase<TFixture>(fixture)
-        where TFixture : EntityRelationshipsQueryRelationalFixtureBase, new()
-{
-}
diff --git a/test/EFCore.Specification.Tests/Query/Relationships/Include/EntityRelationshipsIncludeQueryTestBase.cs b/test/EFCore.Relational.Specification.Tests/Query/Relationships/Include/NavigationIncludeRelationalTestBase.cs
similarity index 50%
rename from test/EFCore.Specification.Tests/Query/Relationships/Include/EntityRelationshipsIncludeQueryTestBase.cs
rename to test/EFCore.Relational.Specification.Tests/Query/Relationships/Include/NavigationIncludeRelationalTestBase.cs
index c972a8de15..cdc6c90023 100644
--- a/test/EFCore.Specification.Tests/Query/Relationships/Include/EntityRelationshipsIncludeQueryTestBase.cs
+++ b/test/EFCore.Relational.Specification.Tests/Query/Relationships/Include/NavigationIncludeRelationalTestBase.cs
@@ -3,8 +3,8 @@
 
 namespace Microsoft.EntityFrameworkCore.Query.Relationships.Include;
 
-public class EntityRelationshipsIncludeQueryTestBase<TFixture>(TFixture fixture)
-    : RelationshipsIncludeQueryTestBase<TFixture>(fixture)
-        where TFixture : EntityRelationshipsQueryFixtureBase, new()
+public abstract class NavigationIncludeRelationalTestBase<TFixture>(TFixture fixture)
+    : NavigationIncludeTestBase<TFixture>(fixture)
+        where TFixture : NavigationRelationshipsRelationalFixtureBase, new()
 {
 }
diff --git a/test/EFCore.Relational.Specification.Tests/Query/Relationships/EntityRelationshipsQueryRelationalFixtureBase.cs b/test/EFCore.Relational.Specification.Tests/Query/Relationships/NavigationRelationshipsRelationalFixtureBase.cs
similarity index 87%
rename from test/EFCore.Relational.Specification.Tests/Query/Relationships/EntityRelationshipsQueryRelationalFixtureBase.cs
rename to test/EFCore.Relational.Specification.Tests/Query/Relationships/NavigationRelationshipsRelationalFixtureBase.cs
index 6c9ec38fa8..7434ec7e32 100644
--- a/test/EFCore.Relational.Specification.Tests/Query/Relationships/EntityRelationshipsQueryRelationalFixtureBase.cs
+++ b/test/EFCore.Relational.Specification.Tests/Query/Relationships/NavigationRelationshipsRelationalFixtureBase.cs
@@ -5,7 +5,7 @@
 
 namespace Microsoft.EntityFrameworkCore.Query.Relationships;
 
-public abstract class EntityRelationshipsQueryRelationalFixtureBase : EntityRelationshipsQueryFixtureBase
+public abstract class NavigationRelationshipsRelationalFixtureBase : NavigationRelationshipsFixtureBase
 {
     protected override void OnModelCreating(ModelBuilder modelBuilder, DbContext context)
     {
diff --git a/test/EFCore.Relational.Specification.Tests/Query/Relationships/JsonRelationshipsQueryRelationalFixtureBase.cs b/test/EFCore.Relational.Specification.Tests/Query/Relationships/OwnedJsonRelationshipsRelationalFixtureBase.cs
similarity index 88%
rename from test/EFCore.Relational.Specification.Tests/Query/Relationships/JsonRelationshipsQueryRelationalFixtureBase.cs
rename to test/EFCore.Relational.Specification.Tests/Query/Relationships/OwnedJsonRelationshipsRelationalFixtureBase.cs
index a3d4bf2ec1..f7cd592206 100644
--- a/test/EFCore.Relational.Specification.Tests/Query/Relationships/JsonRelationshipsQueryRelationalFixtureBase.cs
+++ b/test/EFCore.Relational.Specification.Tests/Query/Relationships/OwnedJsonRelationshipsRelationalFixtureBase.cs
@@ -5,7 +5,7 @@
 
 namespace Microsoft.EntityFrameworkCore.Query.Relationships;
 
-public abstract class JsonRelationshipsQueryRelationalFixtureBase : JsonRelationshipsQueryFixtureBase
+public abstract class OwnedJsonRelationshipsRelationalFixtureBase : OwnedJsonRelationshipsFixtureBase
 {
     protected override void OnModelCreating(ModelBuilder modelBuilder, DbContext context)
     {
diff --git a/test/EFCore.Relational.Specification.Tests/Query/Relationships/OwnedRelationshipsQueryRelationalFixtureBase.cs b/test/EFCore.Relational.Specification.Tests/Query/Relationships/OwnedRelationshipsRelationalFixtureBase.cs
similarity index 97%
rename from test/EFCore.Relational.Specification.Tests/Query/Relationships/OwnedRelationshipsQueryRelationalFixtureBase.cs
rename to test/EFCore.Relational.Specification.Tests/Query/Relationships/OwnedRelationshipsRelationalFixtureBase.cs
index eca4dc93f0..7fb0489dbe 100644
--- a/test/EFCore.Relational.Specification.Tests/Query/Relationships/OwnedRelationshipsQueryRelationalFixtureBase.cs
+++ b/test/EFCore.Relational.Specification.Tests/Query/Relationships/OwnedRelationshipsRelationalFixtureBase.cs
@@ -5,7 +5,7 @@
 
 namespace Microsoft.EntityFrameworkCore.Query.Relationships;
 
-public abstract class OwnedRelationshipsQueryRelationalFixtureBase : OwnedRelationshipsQueryFixtureBase
+public abstract class OwnedRelationshipsRelationalFixtureBase : OwnedRelationshipsFixtureBase
 {
     protected override void OnModelCreating(ModelBuilder modelBuilder, DbContext context)
     {
diff --git a/test/EFCore.Relational.Specification.Tests/Query/Relationships/OwnedTableSplittingRelationshipsRelationalFixtureBase.cs b/test/EFCore.Relational.Specification.Tests/Query/Relationships/OwnedTableSplittingRelationshipsRelationalFixtureBase.cs
new file mode 100644
index 0000000000..a2ea243dab
--- /dev/null
+++ b/test/EFCore.Relational.Specification.Tests/Query/Relationships/OwnedTableSplittingRelationshipsRelationalFixtureBase.cs
@@ -0,0 +1,90 @@
+﻿// Licensed to the .NET Foundation under one or more agreements.
+// The .NET Foundation licenses this file to you under the MIT license.
+
+using Microsoft.EntityFrameworkCore.TestModels.RelationshipsModel;
+
+namespace Microsoft.EntityFrameworkCore.Query.Relationships;
+
+public abstract class OwnedTableSplittingRelationshipsRelationalFixtureBase : OwnedRelationshipsRelationalFixtureBase
+{
+    protected override string StoreName => "OwnedTableSplittingRelationshipsQueryTest";
+
+    protected override void OnModelCreating(ModelBuilder modelBuilder, DbContext context)
+    {
+        base.OnModelCreating(modelBuilder, context);
+
+        modelBuilder.Entity<RelationshipsRootEntity>()
+            .OwnsOne(x => x.OptionalReferenceTrunk, b =>
+            {
+                b.ToTable("Root_OptionalReferenceTrunk");
+                b.OwnsOne(x => x.OptionalReferenceBranch, bb =>
+                {
+                    bb.ToTable("Root_OptionalReferenceTrunk_OptionalReferenceBranch");
+                    bb.OwnsOne(x => x.RequiredReferenceLeaf).ToTable("Root_OptionalReferenceTrunk_OptionalReferenceBranch_RequiredReferenceLeaf");
+                    bb.OwnsOne(x => x.OptionalReferenceLeaf).ToTable("Root_OptionalReferenceTrunk_OptionalReferenceBranch_OptionalReferenceLeaf");
+                });
+
+                b.OwnsOne(x => x.RequiredReferenceBranch, bb =>
+                {
+                    bb.ToTable("Root_OptionalReferenceTrunk_RequiredReferenceBranch");
+                    bb.OwnsOne(x => x.RequiredReferenceLeaf).ToTable("Root_OptionalReferenceTrunk_RequiredReferenceBranch_RequiredReferenceLeaf");
+                    bb.OwnsOne(x => x.OptionalReferenceLeaf).ToTable("Root_OptionalReferenceTrunk_RequiredReferenceBranch_OptionalReferenceLeaf");
+                });
+
+                b.OwnsMany(x => x.CollectionBranch, bb =>
+                {
+                    bb.OwnsOne(x => x.RequiredReferenceLeaf).ToTable("Root_OptionalReferenceTrunk_CollectionBranch_RequiredReferenceLeaf");
+                    bb.OwnsOne(x => x.OptionalReferenceLeaf).ToTable("Root_OptionalReferenceTrunk_CollectionBranch_OptionalReferenceLeaf");
+                });
+            });
+
+        modelBuilder.Entity<RelationshipsRootEntity>()
+            .OwnsOne(x => x.RequiredReferenceTrunk, b =>
+            {
+                b.ToTable("Root_RequiredReferenceTrunk");
+                b.OwnsOne(x => x.OptionalReferenceBranch, bb =>
+                {
+                    bb.ToTable("Root_RequiredReferenceTrunk_OptionalReferenceBranch");
+                    bb.OwnsOne(x => x.RequiredReferenceLeaf).ToTable("Root_RequiredReferenceTrunk_OptionalReferenceBranch_RequiredReferenceLeaf");
+                    bb.OwnsOne(x => x.OptionalReferenceLeaf).ToTable("Root_RequiredReferenceTrunk_OptionalReferenceBranch_OptionalReferenceLeaf");
+                });
+
+                b.OwnsOne(x => x.RequiredReferenceBranch, bb =>
+                {
+                    bb.ToTable("Root_RequiredReferenceTrunk_RequiredReferenceBranch");
+                    bb.OwnsOne(x => x.RequiredReferenceLeaf).ToTable("Root_RequiredReferenceTrunk_RequiredReferenceBranch_RequiredReferenceLeaf");
+                    bb.OwnsOne(x => x.OptionalReferenceLeaf).ToTable("Root_RequiredReferenceTrunk_RequiredReferenceBranch_OptionalReferenceLeaf");
+                });
+
+                b.OwnsMany(x => x.CollectionBranch, bb =>
+                {
+                    bb.OwnsOne(x => x.RequiredReferenceLeaf).ToTable("Root_RequiredReferenceTrunk_CollectionBranch_RequiredReferenceLeaf");
+                    bb.OwnsOne(x => x.OptionalReferenceLeaf).ToTable("Root_RequiredReferenceTrunk_CollectionBranch_OptionalReferenceLeaf");
+                });
+            });
+
+        modelBuilder.Entity<RelationshipsRootEntity>()
+            .OwnsMany(x => x.CollectionTrunk, b =>
+            {
+                b.OwnsOne(x => x.OptionalReferenceBranch, bb =>
+                {
+                    bb.ToTable("Root_CollectionTrunk_OptionalReferenceBranch");
+                    bb.OwnsOne(x => x.RequiredReferenceLeaf).ToTable("Root_CollectionTrunk_OptionalReferenceBranch_RequiredReferenceLeaf");
+                    bb.OwnsOne(x => x.OptionalReferenceLeaf).ToTable("Root_CollectionTrunk_OptionalReferenceBranch_OptionalReferenceLeaf");
+                });
+
+                b.OwnsOne(x => x.RequiredReferenceBranch, bb =>
+                {
+                    bb.ToTable("Root_CollectionTrunk_RequiredReferenceBranch");
+                    bb.OwnsOne(x => x.RequiredReferenceLeaf).ToTable("Root_CollectionTrunk_RequiredReferenceBranch_RequiredReferenceLeaf");
+                    bb.OwnsOne(x => x.OptionalReferenceLeaf).ToTable("Root_CollectionTrunk_RequiredReferenceBranch_OptionalReferenceLeaf");
+                });
+
+                b.OwnsMany(x => x.CollectionBranch, bb =>
+                {
+                    bb.OwnsOne(x => x.RequiredReferenceLeaf).ToTable("Root_CollectionTrunk_CollectionBranch_RequiredReferenceLeaf");
+                    bb.OwnsOne(x => x.OptionalReferenceLeaf).ToTable("Root_CollectionTrunk_CollectionBranch_OptionalReferenceLeaf");
+                });
+            });
+    }
+}
diff --git a/test/EFCore.Relational.Specification.Tests/Query/Relationships/Projection/ComplexNoTrackingProjectionRelationalTestBase.cs b/test/EFCore.Relational.Specification.Tests/Query/Relationships/Projection/ComplexNoTrackingProjectionRelationalTestBase.cs
new file mode 100644
index 0000000000..305b91baca
--- /dev/null
+++ b/test/EFCore.Relational.Specification.Tests/Query/Relationships/Projection/ComplexNoTrackingProjectionRelationalTestBase.cs
@@ -0,0 +1,10 @@
+﻿// Licensed to the .NET Foundation under one or more agreements.
+// The .NET Foundation licenses this file to you under the MIT license.
+
+namespace Microsoft.EntityFrameworkCore.Query.Relationships.Projection;
+
+public abstract class ComplexNoTrackingProjectionRelationalTestBase<TFixture>(TFixture fixture)
+    : ComplexNoTrackingProjectionTestBase<TFixture>(fixture)
+        where TFixture : ComplexRelationsjipsRelationalFixtureBase, new()
+{
+}
diff --git a/test/EFCore.Relational.Specification.Tests/Query/Relationships/Projection/ComplexProjectionRelationalTestBase.cs b/test/EFCore.Relational.Specification.Tests/Query/Relationships/Projection/ComplexProjectionRelationalTestBase.cs
new file mode 100644
index 0000000000..7dd43ad7e3
--- /dev/null
+++ b/test/EFCore.Relational.Specification.Tests/Query/Relationships/Projection/ComplexProjectionRelationalTestBase.cs
@@ -0,0 +1,10 @@
+﻿// Licensed to the .NET Foundation under one or more agreements.
+// The .NET Foundation licenses this file to you under the MIT license.
+
+namespace Microsoft.EntityFrameworkCore.Query.Relationships.Projection;
+
+public abstract class ComplexProjectionRelationalTestBase<TFixture>(TFixture fixture)
+    : ComplexProjectionTestBase<TFixture>(fixture)
+        where TFixture : ComplexRelationsjipsRelationalFixtureBase, new()
+{
+}
diff --git a/test/EFCore.Relational.Specification.Tests/Query/Relationships/Projection/NavigationNoTrackingProjectionRelationalTestBase.cs b/test/EFCore.Relational.Specification.Tests/Query/Relationships/Projection/NavigationNoTrackingProjectionRelationalTestBase.cs
new file mode 100644
index 0000000000..d97e96a0a5
--- /dev/null
+++ b/test/EFCore.Relational.Specification.Tests/Query/Relationships/Projection/NavigationNoTrackingProjectionRelationalTestBase.cs
@@ -0,0 +1,10 @@
+﻿// Licensed to the .NET Foundation under one or more agreements.
+// The .NET Foundation licenses this file to you under the MIT license.
+
+namespace Microsoft.EntityFrameworkCore.Query.Relationships.Projection;
+
+public abstract class NavigationNoTrackingProjectionRelationalTestBase<TFixture>(TFixture fixture)
+    : NavigationNoTrackingProjectionTestBase<TFixture>(fixture)
+        where TFixture : NavigationRelationshipsRelationalFixtureBase, new()
+{
+}
diff --git a/test/EFCore.Relational.Specification.Tests/Query/Relationships/Projection/NavigationProjectionRelationalTestBase.cs b/test/EFCore.Relational.Specification.Tests/Query/Relationships/Projection/NavigationProjectionRelationalTestBase.cs
new file mode 100644
index 0000000000..a1ad006836
--- /dev/null
+++ b/test/EFCore.Relational.Specification.Tests/Query/Relationships/Projection/NavigationProjectionRelationalTestBase.cs
@@ -0,0 +1,10 @@
+﻿// Licensed to the .NET Foundation under one or more agreements.
+// The .NET Foundation licenses this file to you under the MIT license.
+
+namespace Microsoft.EntityFrameworkCore.Query.Relationships.Projection;
+
+public abstract class NavigationProjectionRelationalTestBase<TFixture>(TFixture fixture)
+    : NavigationProjectionTestBase<TFixture>(fixture)
+        where TFixture : NavigationRelationshipsRelationalFixtureBase, new()
+{
+}
diff --git a/test/EFCore.Relational.Specification.Tests/Query/Relationships/Projection/NavigationReferenceNoTrackingProjectionRelationalTestBase.cs b/test/EFCore.Relational.Specification.Tests/Query/Relationships/Projection/NavigationReferenceNoTrackingProjectionRelationalTestBase.cs
new file mode 100644
index 0000000000..36a3f097a4
--- /dev/null
+++ b/test/EFCore.Relational.Specification.Tests/Query/Relationships/Projection/NavigationReferenceNoTrackingProjectionRelationalTestBase.cs
@@ -0,0 +1,10 @@
+﻿// Licensed to the .NET Foundation under one or more agreements.
+// The .NET Foundation licenses this file to you under the MIT license.
+
+namespace Microsoft.EntityFrameworkCore.Query.Relationships.Projection;
+
+public abstract class NavigationReferenceNoTrackingProjectionRelationalTestBase<TFixture>(TFixture fixture)
+    : NavigationReferenceNoTrackingProjectionTestBase<TFixture>(fixture)
+        where TFixture : NavigationRelationshipsRelationalFixtureBase, new()
+{
+}
diff --git a/test/EFCore.Relational.Specification.Tests/Query/Relationships/Projection/NavigationReferenceProjectionRelationalTestBase.cs b/test/EFCore.Relational.Specification.Tests/Query/Relationships/Projection/NavigationReferenceProjectionRelationalTestBase.cs
new file mode 100644
index 0000000000..5cfa52d08f
--- /dev/null
+++ b/test/EFCore.Relational.Specification.Tests/Query/Relationships/Projection/NavigationReferenceProjectionRelationalTestBase.cs
@@ -0,0 +1,10 @@
+﻿// Licensed to the .NET Foundation under one or more agreements.
+// The .NET Foundation licenses this file to you under the MIT license.
+
+namespace Microsoft.EntityFrameworkCore.Query.Relationships.Projection;
+
+public abstract class NavigationReferenceProjectionRelationalTestBase<TFixture>(TFixture fixture)
+    : NavigationReferenceProjectionTestBase<TFixture>(fixture)
+        where TFixture : NavigationRelationshipsRelationalFixtureBase, new()
+{
+}
diff --git a/test/EFCore.Relational.Specification.Tests/Query/Relationships/Projection/OwnedJsonNoTrackingProjectionRelationalTestBase.cs b/test/EFCore.Relational.Specification.Tests/Query/Relationships/Projection/OwnedJsonNoTrackingProjectionRelationalTestBase.cs
new file mode 100644
index 0000000000..278ad37544
--- /dev/null
+++ b/test/EFCore.Relational.Specification.Tests/Query/Relationships/Projection/OwnedJsonNoTrackingProjectionRelationalTestBase.cs
@@ -0,0 +1,10 @@
+﻿// Licensed to the .NET Foundation under one or more agreements.
+// The .NET Foundation licenses this file to you under the MIT license.
+
+namespace Microsoft.EntityFrameworkCore.Query.Relationships.Projection;
+
+public abstract class OwnedJsonNoTrackingProjectionRelationalTestBase<TFixture>(TFixture fixture)
+    : OwnedJsonNoTrackingProjectionTestBase<TFixture>(fixture)
+        where TFixture : OwnedJsonRelationshipsRelationalFixtureBase, new()
+{
+}
diff --git a/test/EFCore.Relational.Specification.Tests/Query/Relationships/Projection/OwnedJsonProjectionRelationalTestBase.cs b/test/EFCore.Relational.Specification.Tests/Query/Relationships/Projection/OwnedJsonProjectionRelationalTestBase.cs
new file mode 100644
index 0000000000..4157008b3e
--- /dev/null
+++ b/test/EFCore.Relational.Specification.Tests/Query/Relationships/Projection/OwnedJsonProjectionRelationalTestBase.cs
@@ -0,0 +1,10 @@
+﻿// Licensed to the .NET Foundation under one or more agreements.
+// The .NET Foundation licenses this file to you under the MIT license.
+
+namespace Microsoft.EntityFrameworkCore.Query.Relationships.Projection;
+
+public abstract class OwnedJsonProjectionRelationalTestBase<TFixture>(TFixture fixture)
+    : OwnedJsonProjectionTestBase<TFixture>(fixture)
+        where TFixture : OwnedJsonRelationshipsRelationalFixtureBase, new()
+{
+}
diff --git a/test/EFCore.Relational.Specification.Tests/Query/Relationships/Projection/OwnedJsonReferenceNoTrackingProjectionRelationalTestBase.cs b/test/EFCore.Relational.Specification.Tests/Query/Relationships/Projection/OwnedJsonReferenceNoTrackingProjectionRelationalTestBase.cs
new file mode 100644
index 0000000000..119be8f980
--- /dev/null
+++ b/test/EFCore.Relational.Specification.Tests/Query/Relationships/Projection/OwnedJsonReferenceNoTrackingProjectionRelationalTestBase.cs
@@ -0,0 +1,10 @@
+﻿// Licensed to the .NET Foundation under one or more agreements.
+// The .NET Foundation licenses this file to you under the MIT license.
+
+namespace Microsoft.EntityFrameworkCore.Query.Relationships.Projection;
+
+public abstract class OwnedJsonReferenceNoTrackingProjectionRelationalTestBase<TFixture>(TFixture fixture)
+    : OwnedJsonReferenceNoTrackingProjectionTestBase<TFixture>(fixture)
+        where TFixture : OwnedJsonRelationshipsRelationalFixtureBase, new()
+{
+}
diff --git a/test/EFCore.Relational.Specification.Tests/Query/Relationships/Projection/OwnedJsonReferenceProjectionRelationalTestBase.cs b/test/EFCore.Relational.Specification.Tests/Query/Relationships/Projection/OwnedJsonReferenceProjectionRelationalTestBase.cs
new file mode 100644
index 0000000000..ed841787e7
--- /dev/null
+++ b/test/EFCore.Relational.Specification.Tests/Query/Relationships/Projection/OwnedJsonReferenceProjectionRelationalTestBase.cs
@@ -0,0 +1,10 @@
+﻿// Licensed to the .NET Foundation under one or more agreements.
+// The .NET Foundation licenses this file to you under the MIT license.
+
+namespace Microsoft.EntityFrameworkCore.Query.Relationships.Projection;
+
+public abstract class OwnedJsonReferenceProjectionRelationalTestBase<TFixture>(TFixture fixture)
+    : OwnedJsonReferenceProjectionTestBase<TFixture>(fixture)
+        where TFixture : OwnedJsonRelationshipsRelationalFixtureBase, new()
+{
+}
diff --git a/test/EFCore.Relational.Specification.Tests/Query/Relationships/Projection/OwnedNoTrackingProjectionRelationalTestBase.cs b/test/EFCore.Relational.Specification.Tests/Query/Relationships/Projection/OwnedNoTrackingProjectionRelationalTestBase.cs
new file mode 100644
index 0000000000..3acf2943fd
--- /dev/null
+++ b/test/EFCore.Relational.Specification.Tests/Query/Relationships/Projection/OwnedNoTrackingProjectionRelationalTestBase.cs
@@ -0,0 +1,10 @@
+﻿// Licensed to the .NET Foundation under one or more agreements.
+// The .NET Foundation licenses this file to you under the MIT license.
+
+namespace Microsoft.EntityFrameworkCore.Query.Relationships.Projection;
+
+public abstract class OwnedNoTrackingProjectionRelationalTestBase<TFixture>(TFixture fixture)
+    : OwnedNoTrackingProjectionTestBase<TFixture>(fixture)
+        where TFixture : OwnedRelationshipsRelationalFixtureBase, new()
+{
+}
diff --git a/test/EFCore.Relational.Specification.Tests/Query/Relationships/Projection/OwnedProjectionRelationalTestBase.cs b/test/EFCore.Relational.Specification.Tests/Query/Relationships/Projection/OwnedProjectionRelationalTestBase.cs
new file mode 100644
index 0000000000..76050f4105
--- /dev/null
+++ b/test/EFCore.Relational.Specification.Tests/Query/Relationships/Projection/OwnedProjectionRelationalTestBase.cs
@@ -0,0 +1,10 @@
+﻿// Licensed to the .NET Foundation under one or more agreements.
+// The .NET Foundation licenses this file to you under the MIT license.
+
+namespace Microsoft.EntityFrameworkCore.Query.Relationships.Projection;
+
+public abstract class OwnedProjectionRelationalTestBase<TFixture>(TFixture fixture)
+    : OwnedProjectionTestBase<TFixture>(fixture)
+        where TFixture : OwnedRelationshipsRelationalFixtureBase, new()
+{
+}
diff --git a/test/EFCore.Relational.Specification.Tests/Query/Relationships/Projection/OwnedReferenceNoTrackingProjectionRelationalTestBase.cs b/test/EFCore.Relational.Specification.Tests/Query/Relationships/Projection/OwnedReferenceNoTrackingProjectionRelationalTestBase.cs
new file mode 100644
index 0000000000..53c798b511
--- /dev/null
+++ b/test/EFCore.Relational.Specification.Tests/Query/Relationships/Projection/OwnedReferenceNoTrackingProjectionRelationalTestBase.cs
@@ -0,0 +1,10 @@
+﻿// Licensed to the .NET Foundation under one or more agreements.
+// The .NET Foundation licenses this file to you under the MIT license.
+
+namespace Microsoft.EntityFrameworkCore.Query.Relationships.Projection;
+
+public abstract class OwnedReferenceNoTrackingProjectionRelationalTestBase<TFixture>(TFixture fixture)
+    : OwnedReferenceNoTrackingProjectionTestBase<TFixture>(fixture)
+        where TFixture : OwnedRelationshipsRelationalFixtureBase, new()
+{
+}
diff --git a/test/EFCore.Relational.Specification.Tests/Query/Relationships/Projection/OwnedReferenceProjectionRelationalTestBase.cs b/test/EFCore.Relational.Specification.Tests/Query/Relationships/Projection/OwnedReferenceProjectionRelationalTestBase.cs
new file mode 100644
index 0000000000..8d3d60a9aa
--- /dev/null
+++ b/test/EFCore.Relational.Specification.Tests/Query/Relationships/Projection/OwnedReferenceProjectionRelationalTestBase.cs
@@ -0,0 +1,10 @@
+﻿// Licensed to the .NET Foundation under one or more agreements.
+// The .NET Foundation licenses this file to you under the MIT license.
+
+namespace Microsoft.EntityFrameworkCore.Query.Relationships.Projection;
+
+public abstract class OwnedReferenceProjectionRelationalTestBase<TFixture>(TFixture fixture)
+    : OwnedReferenceProjectionTestBase<TFixture>(fixture)
+        where TFixture : OwnedRelationshipsRelationalFixtureBase, new()
+{
+}
diff --git a/test/EFCore.Relational.Specification.Tests/Query/Relationships/Projection/OwnedTableSplittingNoTrackingProjectionRelationalTestBase.cs b/test/EFCore.Relational.Specification.Tests/Query/Relationships/Projection/OwnedTableSplittingNoTrackingProjectionRelationalTestBase.cs
new file mode 100644
index 0000000000..0481cd93ea
--- /dev/null
+++ b/test/EFCore.Relational.Specification.Tests/Query/Relationships/Projection/OwnedTableSplittingNoTrackingProjectionRelationalTestBase.cs
@@ -0,0 +1,10 @@
+﻿// Licensed to the .NET Foundation under one or more agreements.
+// The .NET Foundation licenses this file to you under the MIT license.
+
+namespace Microsoft.EntityFrameworkCore.Query.Relationships.Projection;
+
+public abstract class OwnedTableSplittingNoTrackingProjectionRelationalTestBase<TFixture>(TFixture fixture)
+    : OwnedNoTrackingProjectionTestBase<TFixture>(fixture)
+        where TFixture : OwnedTableSplittingRelationshipsRelationalFixtureBase, new()
+{
+}
diff --git a/test/EFCore.Relational.Specification.Tests/Query/Relationships/Projection/OwnedTableSplittingReferenceProjectionNoTrackingRelationalTestBase.cs b/test/EFCore.Relational.Specification.Tests/Query/Relationships/Projection/OwnedTableSplittingReferenceProjectionNoTrackingRelationalTestBase.cs
new file mode 100644
index 0000000000..e7064f1820
--- /dev/null
+++ b/test/EFCore.Relational.Specification.Tests/Query/Relationships/Projection/OwnedTableSplittingReferenceProjectionNoTrackingRelationalTestBase.cs
@@ -0,0 +1,10 @@
+﻿// Licensed to the .NET Foundation under one or more agreements.
+// The .NET Foundation licenses this file to you under the MIT license.
+
+namespace Microsoft.EntityFrameworkCore.Query.Relationships.Projection;
+
+public abstract class OwnedTableSplittingReferenceProjectionNoTrackingRelationalTestBase<TFixture>(TFixture fixture)
+    : OwnedReferenceNoTrackingProjectionTestBase<TFixture>(fixture)
+        where TFixture : OwnedTableSplittingRelationshipsRelationalFixtureBase, new()
+{
+}
diff --git a/test/EFCore.Relational.Specification.Tests/TestUtilities/TestSqlLoggerFactory.cs b/test/EFCore.Relational.Specification.Tests/TestUtilities/TestSqlLoggerFactory.cs
index 150fb559a1..57e3055ff9 100644
--- a/test/EFCore.Relational.Specification.Tests/TestUtilities/TestSqlLoggerFactory.cs
+++ b/test/EFCore.Relational.Specification.Tests/TestUtilities/TestSqlLoggerFactory.cs
@@ -100,7 +100,7 @@ public void AssertBaseline(string[] expected, bool assertOrder = true, bool forU
             var testInfo = testName + " : " + lineNumber + FileNewLine;
             const string indent = FileNewLine + "                ";
 
-            //if (Environment.GetEnvironmentVariable("EF_TEST_REWRITE_BASELINES")?.ToUpper() is "1" or "TRUE")
+            if (Environment.GetEnvironmentVariable("EF_TEST_REWRITE_BASELINES")?.ToUpper() is "1" or "TRUE")
             {
                 RewriteSourceWithNewBaseline(fileName, lineNumber);
             }
diff --git a/test/EFCore.Specification.Tests/Query/Relationships/ComplexRelationshipsQueryFixtureBase.cs b/test/EFCore.Specification.Tests/Query/Relationships/ComplexRelationshipsFixtureBase.cs
similarity index 93%
rename from test/EFCore.Specification.Tests/Query/Relationships/ComplexRelationshipsQueryFixtureBase.cs
rename to test/EFCore.Specification.Tests/Query/Relationships/ComplexRelationshipsFixtureBase.cs
index 9a0831ce07..f418570a25 100644
--- a/test/EFCore.Specification.Tests/Query/Relationships/ComplexRelationshipsQueryFixtureBase.cs
+++ b/test/EFCore.Specification.Tests/Query/Relationships/ComplexRelationshipsFixtureBase.cs
@@ -5,7 +5,9 @@
 
 namespace Microsoft.EntityFrameworkCore.Query.Relationships;
 
-public abstract class ComplexRelationshipsQueryFixtureBase : RelationshipsQueryFixtureBase
+// collections are not supported for non-json complex types
+// so only use this for reference test case
+public abstract class ComplexRelationshipsFixtureBase : RelationshipsQueryFixtureBase
 {
     protected override string StoreName => "ComplexRelationshipsQueryTest";
 
@@ -39,11 +41,8 @@ protected override void OnModelCreating(ModelBuilder modelBuilder, DbContext con
             .OnDelete(DeleteBehavior.Restrict)
             .IsRequired(true);
 
-        modelBuilder.Entity<RelationshipsRootEntity>()
-            .HasMany(x => x.CollectionTrunk)
-            .WithOne(x => x.CollectionInverseRoot)
-            .HasForeignKey(x => x.CollectionRootId)
-            .OnDelete(DeleteBehavior.Restrict);
+        modelBuilder.Entity<RelationshipsRootEntity>().Ignore(x => x.CollectionTrunk);
+        modelBuilder.Entity<RelationshipsTrunkEntity>().Ignore(x => x.CollectionInverseRoot);
 
         // TODO: issue #31376 - complex optional references
         modelBuilder.Entity<RelationshipsTrunkEntity>()
@@ -77,7 +76,7 @@ protected override void OnModelCreating(ModelBuilder modelBuilder, DbContext con
                 bb.Ignore(x => x.CollectionLeaf);
             });
 
-        // TODO: issue #31237 - complex collections
+        //  collections are not supported for non-json compex types 
         modelBuilder.Entity<RelationshipsTrunkEntity>().Ignore(x => x.CollectionBranch);
     }
 
diff --git a/test/EFCore.Specification.Tests/Query/Relationships/InProjection/ComplexRelationshipsInProjectionNoTrackingQueryTestBase.cs b/test/EFCore.Specification.Tests/Query/Relationships/InProjection/ComplexRelationshipsInProjectionNoTrackingQueryTestBase.cs
deleted file mode 100644
index 0af57981cc..0000000000
--- a/test/EFCore.Specification.Tests/Query/Relationships/InProjection/ComplexRelationshipsInProjectionNoTrackingQueryTestBase.cs
+++ /dev/null
@@ -1,18 +0,0 @@
-﻿// Licensed to the .NET Foundation under one or more agreements.
-// The .NET Foundation licenses this file to you under the MIT license.
-
-namespace Microsoft.EntityFrameworkCore.Query.Relationships.InProjection;
-
-public abstract class ComplexRelationshipsInProjectionNoTrackingQueryTestBase<TFixture>(TFixture fixture)
-    : ComplexRelationshipsInProjectionQueryTestBase<TFixture>(fixture)
-        where TFixture : ComplexRelationshipsQueryFixtureBase, new()
-{
-    private readonly NoTrackingRewriter _noTrackingRewriter = new();
-
-    protected override Expression RewriteServerQueryExpression(Expression serverQueryExpression)
-    {
-        var rewritten = _noTrackingRewriter.Visit(serverQueryExpression);
-
-        return rewritten;
-    }
-}
diff --git a/test/EFCore.Specification.Tests/Query/Relationships/InProjection/ComplexRelationshipsInProjectionQueryTestBase.cs b/test/EFCore.Specification.Tests/Query/Relationships/InProjection/ComplexRelationshipsInProjectionQueryTestBase.cs
deleted file mode 100644
index 421e8052d6..0000000000
--- a/test/EFCore.Specification.Tests/Query/Relationships/InProjection/ComplexRelationshipsInProjectionQueryTestBase.cs
+++ /dev/null
@@ -1,93 +0,0 @@
-﻿// Licensed to the .NET Foundation under one or more agreements.
-// The .NET Foundation licenses this file to you under the MIT license.
-
-using Microsoft.EntityFrameworkCore.TestModels.RelationshipsModel;
-
-namespace Microsoft.EntityFrameworkCore.Query.Relationships.InProjection;
-
-public abstract class ComplexRelationshipsInProjectionQueryTestBase<TFixture>(TFixture fixture)
-    : RelationshipsInProjectionQueryTestBase<TFixture>(fixture)
-        where TFixture : ComplexRelationshipsQueryFixtureBase, new()
-{
-    [ConditionalTheory]
-    [MemberData(nameof(IsAsyncData))]
-    public virtual Task Project_everything(bool async)
-        => AssertQuery(
-            async,
-            ss => from r in ss.Set<RelationshipsRootEntity>()
-                  join t in ss.Set<RelationshipsTrunkEntity>() on r.Id equals t.Id
-                  select new { r, t },
-            elementSorter: e => e.r.Id,
-            elementAsserter: (e, a) =>
-            {
-                AssertEqual(e.r, a.r);
-                AssertEqual(e.t, a.t);
-            });
-
-    [ConditionalTheory(Skip = "issue #31412")]
-    public override Task Project_branch_required_optional(bool async)
-        => base.Project_branch_required_optional(async);
-
-    [ConditionalTheory(Skip = "issue #31237")]
-    public override Task Project_branch_required_collection(bool async)
-        => base.Project_branch_required_collection(async);
-
-    [ConditionalTheory(Skip = "issue #31376")]
-    public override Task Project_branch_optional_optional(bool async)
-        => base.Project_branch_optional_optional(async);
-
-    [ConditionalTheory(Skip = "issue #31412")]
-    public override Task Project_branch_optional_required(bool async)
-        => base.Project_branch_optional_required(async);
-
-    [ConditionalTheory(Skip = "issue #31237")]
-    public override Task Project_branch_optional_collection(bool async)
-        => base.Project_branch_optional_collection(async);
-
-    public override Task Project_root_duplicated(bool async)
-        => base.Project_root_duplicated(async);
-
-    [ConditionalTheory(Skip = "issue #31412")]
-    public override Task Project_trunk_and_branch_duplicated(bool async)
-        => base.Project_trunk_and_branch_duplicated(async);
-
-    [ConditionalTheory(Skip = "issue #31412")]
-    public override Task Project_trunk_and_trunk_duplicated(bool async)
-        => base.Project_trunk_and_trunk_duplicated(async);
-
-    [ConditionalTheory(Skip = "issue #31237")]
-    public override Task Project_multiple_branch_leaf(bool async)
-        => base.Project_multiple_branch_leaf(async);
-
-    [ConditionalTheory(Skip = "issue #31237")]
-    public override Task Project_subquery_root_set_required_trunk_FirstOrDefault_branch(bool async)
-        => base.Project_subquery_root_set_required_trunk_FirstOrDefault_branch(async);
-
-    [ConditionalTheory(Skip = "issue #31412")]
-    public override Task Project_subquery_root_set_optional_trunk_FirstOrDefault_branch(bool async)
-        => base.Project_subquery_root_set_optional_trunk_FirstOrDefault_branch(async);
-
-    [ConditionalTheory(Skip = "issue #31237")]
-    public override Task Project_subquery_root_set_trunk_FirstOrDefault_collection(bool async)
-        => base.Project_subquery_root_set_trunk_FirstOrDefault_collection(async);
-
-    [ConditionalTheory(Skip = "issue #31237")]
-    public override Task Project_subquery_root_set_complex_projection_including_references_to_outer_FirstOrDefault(bool async)
-        => base.Project_subquery_root_set_complex_projection_including_references_to_outer_FirstOrDefault(async);
-
-    [ConditionalTheory(Skip = "issue #31237")]
-    public override Task Project_subquery_root_set_complex_projection_FirstOrDefault_project_reference_to_outer(bool async)
-        => base.Project_subquery_root_set_complex_projection_FirstOrDefault_project_reference_to_outer(async);
-
-    [ConditionalTheory(Skip = "issue #31237")]
-    public override Task SelectMany_trunk_collection(bool async)
-        => base.SelectMany_trunk_collection(async);
-
-    [ConditionalTheory(Skip = "issue #31237")]
-    public override Task SelectMany_required_trunk_reference_branch_collection(bool async)
-        => base.SelectMany_required_trunk_reference_branch_collection(async);
-
-    [ConditionalTheory(Skip = "issue #31237")]
-    public override Task SelectMany_optional_trunk_reference_branch_collection(bool async)
-        => base.SelectMany_optional_trunk_reference_branch_collection(async);
-}
diff --git a/test/EFCore.Specification.Tests/Query/Relationships/InProjection/EntityRelationshipsInProjectionNoTrackingQueryTestBase.cs b/test/EFCore.Specification.Tests/Query/Relationships/InProjection/EntityRelationshipsInProjectionNoTrackingQueryTestBase.cs
deleted file mode 100644
index fdd1f4c827..0000000000
--- a/test/EFCore.Specification.Tests/Query/Relationships/InProjection/EntityRelationshipsInProjectionNoTrackingQueryTestBase.cs
+++ /dev/null
@@ -1,14 +0,0 @@
-﻿// Licensed to the .NET Foundation under one or more agreements.
-// The .NET Foundation licenses this file to you under the MIT license.
-
-namespace Microsoft.EntityFrameworkCore.Query.Relationships.InProjection;
-
-public abstract class EntityRelationshipsInProjectionNoTrackingQueryTestBase<TFixture>(TFixture fixture)
-    : EntityRelationshipsInProjectionQueryTestBase<TFixture>(fixture)
-        where TFixture : EntityRelationshipsQueryFixtureBase, new()
-{
-    protected override Expression RewriteServerQueryExpression(Expression serverQueryExpression)
-    {
-        return base.RewriteServerQueryExpression(serverQueryExpression);
-    }
-}
diff --git a/test/EFCore.Specification.Tests/Query/Relationships/InProjection/JsonRelationshipsInProjectionNoTrackingQueryTestBase.cs b/test/EFCore.Specification.Tests/Query/Relationships/InProjection/JsonRelationshipsInProjectionNoTrackingQueryTestBase.cs
deleted file mode 100644
index c40c011c03..0000000000
--- a/test/EFCore.Specification.Tests/Query/Relationships/InProjection/JsonRelationshipsInProjectionNoTrackingQueryTestBase.cs
+++ /dev/null
@@ -1,18 +0,0 @@
-﻿// Licensed to the .NET Foundation under one or more agreements.
-// The .NET Foundation licenses this file to you under the MIT license.
-
-namespace Microsoft.EntityFrameworkCore.Query.Relationships.InProjection;
-
-public abstract class JsonRelationshipsInProjectionNoTrackingQueryTestBase<TFixture>(TFixture fixture)
-    : JsonRelationshipsInProjectionQueryTestBase<TFixture>(fixture)
-        where TFixture : JsonRelationshipsQueryFixtureBase, new()
-{
-    private readonly NoTrackingRewriter _noTrackingRewriter = new();
-
-    protected override Expression RewriteServerQueryExpression(Expression serverQueryExpression)
-    {
-        var rewritten = _noTrackingRewriter.Visit(serverQueryExpression);
-
-        return rewritten;
-    }
-}
diff --git a/test/EFCore.Specification.Tests/Query/Relationships/InProjection/NoTrackingRewriter.cs b/test/EFCore.Specification.Tests/Query/Relationships/InProjection/NoTrackingRewriter.cs
deleted file mode 100644
index 7e08cbe767..0000000000
--- a/test/EFCore.Specification.Tests/Query/Relationships/InProjection/NoTrackingRewriter.cs
+++ /dev/null
@@ -1,20 +0,0 @@
-﻿// Licensed to the .NET Foundation under one or more agreements.
-// The .NET Foundation licenses this file to you under the MIT license.
-
-namespace Microsoft.EntityFrameworkCore.Query.Relationships.InProjection;
-
-public class NoTrackingRewriter : ExpressionVisitor
-{
-    private static readonly MethodInfo AsNoTrackingMethodInfo
-        = typeof(EntityFrameworkQueryableExtensions).GetTypeInfo().GetDeclaredMethod(nameof(EntityFrameworkQueryableExtensions.AsNoTracking))!;
-
-    protected override Expression VisitExtension(Expression expression)
-    {
-        if (expression is EntityQueryRootExpression eqr)
-        {
-            return Expression.Call(AsNoTrackingMethodInfo.MakeGenericMethod(eqr.ElementType), eqr);
-        }
-
-        return base.VisitExtension(expression);
-    }
-}
diff --git a/test/EFCore.Specification.Tests/Query/Relationships/InProjection/OwnedRelationshipsInProjectionNoTrackingQueryTestBase.cs b/test/EFCore.Specification.Tests/Query/Relationships/InProjection/OwnedRelationshipsInProjectionNoTrackingQueryTestBase.cs
deleted file mode 100644
index 2cb435c2d6..0000000000
--- a/test/EFCore.Specification.Tests/Query/Relationships/InProjection/OwnedRelationshipsInProjectionNoTrackingQueryTestBase.cs
+++ /dev/null
@@ -1,18 +0,0 @@
-﻿// Licensed to the .NET Foundation under one or more agreements.
-// The .NET Foundation licenses this file to you under the MIT license.
-
-namespace Microsoft.EntityFrameworkCore.Query.Relationships.InProjection;
-
-public abstract class OwnedRelationshipsInProjectionNoTrackingQueryTestBase<TFixture>(TFixture fixture)
-    : OwnedRelationshipsInProjectionQueryTestBase<TFixture>(fixture)
-        where TFixture : OwnedRelationshipsQueryFixtureBase, new()
-{
-    private readonly NoTrackingRewriter _noTrackingRewriter = new();
-
-    protected override Expression RewriteServerQueryExpression(Expression serverQueryExpression)
-    {
-        var rewritten = _noTrackingRewriter.Visit(serverQueryExpression);
-
-        return rewritten;
-    }
-}
diff --git a/test/EFCore.Specification.Tests/Query/Relationships/InProjection/OwnedRelationshipsInProjectionQueryTestBase.cs b/test/EFCore.Specification.Tests/Query/Relationships/InProjection/OwnedRelationshipsInProjectionQueryTestBase.cs
deleted file mode 100644
index 166bb94932..0000000000
--- a/test/EFCore.Specification.Tests/Query/Relationships/InProjection/OwnedRelationshipsInProjectionQueryTestBase.cs
+++ /dev/null
@@ -1,10 +0,0 @@
-﻿// Licensed to the .NET Foundation under one or more agreements.
-// The .NET Foundation licenses this file to you under the MIT license.
-
-namespace Microsoft.EntityFrameworkCore.Query.Relationships.InProjection;
-
-public abstract class OwnedRelationshipsInProjectionQueryTestBase<TFixture>(TFixture fixture)
-    : RelationshipsInProjectionQueryTestBase<TFixture>(fixture)
-        where TFixture : OwnedRelationshipsQueryFixtureBase, new()
-{
-}
diff --git a/test/EFCore.Specification.Tests/Query/Relationships/InProjection/RelationshipsInProjectionQueryTestBase.cs b/test/EFCore.Specification.Tests/Query/Relationships/InProjection/RelationshipsInProjectionQueryTestBase.cs
deleted file mode 100644
index 734b2fa3d4..0000000000
--- a/test/EFCore.Specification.Tests/Query/Relationships/InProjection/RelationshipsInProjectionQueryTestBase.cs
+++ /dev/null
@@ -1,326 +0,0 @@
-﻿// Licensed to the .NET Foundation under one or more agreements.
-// The .NET Foundation licenses this file to you under the MIT license.
-
-using Microsoft.EntityFrameworkCore.TestModels.RelationshipsModel;
-
-namespace Microsoft.EntityFrameworkCore.Query.Relationships.InProjection;
-
-/// <summary>
-/// Tests for using navigations in projection - mostly to test shaper code around
-/// </summary>
-public abstract class RelationshipsInProjectionQueryTestBase<TFixture>(TFixture fixture) : QueryTestBase<TFixture>(fixture)
-    where TFixture : RelationshipsQueryFixtureBase, new()
-{
-    protected RelationshipsContext CreateContext()
-        => Fixture.CreateContext();
-
-    [ConditionalTheory]
-    [MemberData(nameof(IsAsyncData))]
-    public virtual Task Project_root(bool async)
-        => AssertQuery(
-            async,
-            ss => ss.Set<RelationshipsRootEntity>());
-
-    [ConditionalTheory]
-    [MemberData(nameof(IsAsyncData))]
-    public virtual Task Project_trunk_optional(bool async)
-        => AssertQuery(
-            async,
-            ss => ss.Set<RelationshipsRootEntity>().OrderBy(x => x.Id).Select(x => x.OptionalReferenceTrunk),
-            assertOrder: true);
-
-    [ConditionalTheory]
-    [MemberData(nameof(IsAsyncData))]
-    public virtual Task Project_trunk_required(bool async)
-        => AssertQuery(
-            async,
-            ss => ss.Set<RelationshipsRootEntity>().OrderBy(x => x.Id).Select(x => x.RequiredReferenceTrunk),
-            assertOrder: true);
-
-    [ConditionalTheory]
-    [MemberData(nameof(IsAsyncData))]
-    public virtual Task Project_trunk_collection(bool async)
-        => AssertQuery(
-            async,
-            ss => ss.Set<RelationshipsRootEntity>().OrderBy(x => x.Id).Select(x => x.CollectionTrunk),
-            assertOrder: true,
-            elementAsserter: (e, a) => AssertCollection(e, a, elementSorter: ee => ee.Name));
-
-    [ConditionalTheory]
-    [MemberData(nameof(IsAsyncData))]
-    public virtual Task Project_branch_required_required(bool async)
-        => AssertQuery(
-            async,
-            ss => ss.Set<RelationshipsRootEntity>().OrderBy(x => x.Id).Select(x => x.RequiredReferenceTrunk.RequiredReferenceBranch),
-            assertOrder: true);
-
-    [ConditionalTheory]
-    [MemberData(nameof(IsAsyncData))]
-    public virtual Task Project_branch_required_optional(bool async)
-        => AssertQuery(
-            async,
-            ss => ss.Set<RelationshipsRootEntity>().OrderBy(x => x.Id).Select(x => x.RequiredReferenceTrunk.OptionalReferenceBranch),
-            assertOrder: true);
-
-    [ConditionalTheory]
-    [MemberData(nameof(IsAsyncData))]
-    public virtual Task Project_branch_required_collection(bool async)
-        => AssertQuery(
-            async,
-            ss => ss.Set<RelationshipsRootEntity>().OrderBy(x => x.Id).Select(x => x.RequiredReferenceTrunk.CollectionBranch),
-            assertOrder: true,
-            elementAsserter: (e, a) => AssertCollection(e, a, elementSorter: ee => ee.Name));
-
-    [ConditionalTheory]
-    [MemberData(nameof(IsAsyncData))]
-    public virtual Task Project_branch_optional_required(bool async)
-        => AssertQuery(
-            async,
-            ss => ss.Set<RelationshipsRootEntity>().OrderBy(x => x.Id).Select(x => x.RequiredReferenceTrunk.RequiredReferenceBranch),
-            assertOrder: true);
-
-    [ConditionalTheory]
-    [MemberData(nameof(IsAsyncData))]
-    public virtual Task Project_branch_optional_optional(bool async)
-        => AssertQuery(
-            async,
-            ss => ss.Set<RelationshipsRootEntity>().OrderBy(x => x.Id).Select(x => x.RequiredReferenceTrunk.OptionalReferenceBranch),
-            assertOrder: true);
-
-    [ConditionalTheory]
-    [MemberData(nameof(IsAsyncData))]
-    public virtual Task Project_branch_optional_collection(bool async)
-        => AssertQuery(
-            async,
-            ss => ss.Set<RelationshipsRootEntity>().OrderBy(x => x.Id).Select(x => x.RequiredReferenceTrunk.CollectionBranch),
-            assertOrder: true,
-            elementAsserter: (e, a) => AssertCollection(e, a, elementSorter: ee => ee.Name));
-
-    [ConditionalTheory]
-    [MemberData(nameof(IsAsyncData))]
-    public virtual Task Project_root_duplicated(bool async)
-        => AssertQuery(
-            async,
-            ss => ss.Set<RelationshipsRootEntity>().Select(x => new { First = x, Second = x }),
-            elementSorter: e => e.First.Id,
-            elementAsserter: (e, a) =>
-            {
-                AssertEqual(e.First, a.First);
-                AssertEqual(e.Second, a.Second);
-            });
-
-    [ConditionalTheory]
-    [MemberData(nameof(IsAsyncData))]
-    public virtual Task Project_trunk_and_branch_duplicated(bool async)
-        => AssertQuery(
-            async,
-            ss => ss.Set<RelationshipsRootEntity>()
-                .OrderBy(x => x.Id)
-                .Select(
-                    x => new
-                    {
-                        Trunk1 = x.OptionalReferenceTrunk,
-                        Branch1 = x.OptionalReferenceTrunk!.RequiredReferenceBranch,
-                        Trunk2 = x.OptionalReferenceTrunk,
-                        Branch2 = x.OptionalReferenceTrunk.RequiredReferenceBranch,
-                    }),
-            assertOrder: true,
-            elementAsserter: (e, a) =>
-            {
-                AssertEqual(e.Trunk1, a.Trunk1);
-                AssertEqual(e.Trunk2, a.Trunk2);
-                AssertEqual(e.Branch1, a.Branch1);
-                AssertEqual(e.Branch2, a.Branch2);
-            });
-
-    [ConditionalTheory]
-    [MemberData(nameof(IsAsyncData))]
-    public virtual Task Project_trunk_and_trunk_duplicated(bool async)
-        => AssertQuery(
-            async,
-            ss => ss.Set<RelationshipsRootEntity>()
-                .OrderBy(x => x.Id)
-                .Select(
-                    x => new
-                    {
-                        Trunk1 = x.RequiredReferenceTrunk,
-                        Leaf1 = x.RequiredReferenceTrunk!.OptionalReferenceBranch!.RequiredReferenceLeaf,
-                        Trunk2 = x.RequiredReferenceTrunk,
-                        Leaf2 = x.RequiredReferenceTrunk.OptionalReferenceBranch.RequiredReferenceLeaf,
-                    }),
-            assertOrder: true,
-            elementAsserter: (e, a) =>
-            {
-                AssertEqual(e.Trunk1, a.Trunk1);
-                AssertEqual(e.Trunk2, a.Trunk2);
-                AssertEqual(e.Leaf1, a.Leaf1);
-                AssertEqual(e.Leaf2, a.Leaf2);
-            });
-
-    [ConditionalTheory]
-    [MemberData(nameof(IsAsyncData))]
-    public virtual Task Project_multiple_branch_leaf(bool async)
-        => AssertQuery(
-            async,
-            ss => ss.Set<RelationshipsRootEntity>().Select(
-                x => new
-                {
-                    x.Id,
-                    x.RequiredReferenceTrunk.RequiredReferenceBranch,
-                    x.RequiredReferenceTrunk.RequiredReferenceBranch.OptionalReferenceLeaf,
-                    x.RequiredReferenceTrunk.RequiredReferenceBranch.CollectionLeaf,
-                    x.RequiredReferenceTrunk.CollectionBranch,
-                    x.RequiredReferenceTrunk.RequiredReferenceBranch.OptionalReferenceLeaf!.Name
-                }),
-            elementSorter: e => e.Id,
-            elementAsserter: (e, a) =>
-            {
-                Assert.Equal(e.Id, a.Id);
-                AssertEqual(e.RequiredReferenceBranch, a.RequiredReferenceBranch);
-                AssertEqual(e.OptionalReferenceLeaf, a.OptionalReferenceLeaf);
-                AssertCollection(e.CollectionLeaf, a.CollectionLeaf, ordered: true);
-                AssertCollection(e.CollectionBranch, a.CollectionBranch, ordered: true);
-                Assert.Equal(e.Name, a.Name);
-            });
-
-    [ConditionalTheory]
-    [MemberData(nameof(IsAsyncData))]
-    public virtual Task Project_leaf_trunk_root(bool async)
-        => AssertQuery(
-            async,
-            ss => ss.Set<RelationshipsRootEntity>()
-                .Select(
-                    x => new
-                    {
-                        x.RequiredReferenceTrunk.RequiredReferenceBranch.RequiredReferenceLeaf,
-                        x.RequiredReferenceTrunk,
-                        x
-                    }),
-            elementSorter: e => e.x.Id,
-            elementAsserter: (e, a) =>
-            {
-                AssertEqual(e.RequiredReferenceLeaf, a.RequiredReferenceLeaf);
-                AssertEqual(e.RequiredReferenceTrunk, a.RequiredReferenceTrunk);
-                AssertEqual(e.x, a.x);
-            });
-
-    [ConditionalTheory]
-    [MemberData(nameof(IsAsyncData))]
-    public virtual Task Project_subquery_root_set_required_trunk_FirstOrDefault_branch(bool async)
-        => AssertQuery(
-            async,
-            ss => ss.Set<RelationshipsRootEntity>()
-                .OrderBy(x => x.Id)
-                .Select(
-                    x => ss.Set<RelationshipsRootEntity>()
-                        .OrderBy(xx => xx.Id)
-                        .Select(xx => xx.RequiredReferenceTrunk)
-                        .FirstOrDefault()!.RequiredReferenceBranch),
-            assertOrder: true);
-
-    [ConditionalTheory]
-    [MemberData(nameof(IsAsyncData))]
-    public virtual Task Project_subquery_root_set_optional_trunk_FirstOrDefault_branch(bool async)
-        => AssertQuery(
-            async,
-            ss => ss.Set<RelationshipsRootEntity>()
-                .OrderBy(x => x.Id)
-                .Select(
-                    x => ss.Set<RelationshipsRootEntity>()
-                        .OrderBy(xx => xx.Id)
-                        .Select(xx => xx.OptionalReferenceTrunk)
-                        .FirstOrDefault()!.OptionalReferenceBranch),
-            assertOrder: true);
-
-    [ConditionalTheory]
-    [MemberData(nameof(IsAsyncData))]
-    public virtual Task Project_subquery_root_set_trunk_FirstOrDefault_collection(bool async)
-        => AssertQuery(
-            async,
-            ss => ss.Set<RelationshipsRootEntity>()
-                .OrderBy(x => x.Id)
-                .Select(
-                    x => ss.Set<RelationshipsRootEntity>()
-                        .OrderBy(xx => xx.Id)
-                        .Select(xx => xx.RequiredReferenceTrunk)
-                        .FirstOrDefault()!.CollectionBranch),
-            assertOrder: true,
-            elementAsserter: (e, a) => AssertCollection(e, a, elementSorter: ee => ee));
-
-    [ConditionalTheory]
-    [MemberData(nameof(IsAsyncData))]
-    public virtual Task Project_subquery_root_set_complex_projection_including_references_to_outer_FirstOrDefault(bool async)
-        => AssertQuery(
-            async,
-            ss => ss.Set<RelationshipsRootEntity>()
-                .OrderBy(x => x.Id)
-                .Select(
-                    x => ss.Set<RelationshipsRootEntity>()
-                        .OrderBy(xx => xx.Id)
-                        .Select(
-                            xx => new
-                            {
-                                OuterBranch = x.RequiredReferenceTrunk.CollectionBranch,
-                                xx.RequiredReferenceTrunk,
-                                xx.RequiredReferenceTrunk.RequiredReferenceBranch,
-                                xx.RequiredReferenceTrunk.Name,
-                                OuterName = x.RequiredReferenceTrunk!.RequiredReferenceBranch.Name
-                            }).FirstOrDefault()),
-            assertOrder: true,
-            elementAsserter: (e, a) =>
-            {
-                AssertCollection(e.OuterBranch, a.OuterBranch);
-                AssertEqual(e.RequiredReferenceTrunk, a.RequiredReferenceTrunk);
-                AssertEqual(e.RequiredReferenceBranch, a.RequiredReferenceBranch);
-                AssertEqual(e.Name, a.Name);
-                AssertEqual(e.OuterName, a.OuterName);
-            });
-
-    [ConditionalTheory]
-    [MemberData(nameof(IsAsyncData))]
-    public virtual Task Project_subquery_root_set_complex_projection_FirstOrDefault_project_reference_to_outer(bool async)
-        => AssertQuery(
-            async,
-            ss => ss.Set<RelationshipsRootEntity>()
-                .OrderBy(x => x.Id)
-                .Select(
-                    x => ss.Set<RelationshipsRootEntity>()
-                        .OrderBy(xx => xx.Id)
-                        .Select(
-                            xx => new
-                            {
-                                OuterBranchCollection = x.RequiredReferenceTrunk.CollectionBranch,
-                                xx.RequiredReferenceTrunk,
-                                xx.RequiredReferenceTrunk.RequiredReferenceBranch,
-                                xx.RequiredReferenceTrunk.Name,
-                                OuterName = x.RequiredReferenceTrunk.RequiredReferenceBranch.Name
-                            }).FirstOrDefault()!.OuterBranchCollection),
-            assertOrder: true,
-            elementAsserter: (e, a) => AssertCollection(e, a));
-
-    [ConditionalTheory]
-    [MemberData(nameof(IsAsyncData))]
-    public virtual Task SelectMany_trunk_collection(bool async)
-        => AssertQuery(
-            async,
-            ss => ss.Set<RelationshipsRootEntity>()
-                .SelectMany(x => x.CollectionTrunk));
-
-    [ConditionalTheory]
-    [MemberData(nameof(IsAsyncData))]
-    public virtual Task SelectMany_required_trunk_reference_branch_collection(bool async)
-        => AssertQuery(
-            async,
-            ss => ss.Set<RelationshipsRootEntity>()
-                .SelectMany(x => x.RequiredReferenceTrunk.CollectionBranch));
-
-    [ConditionalTheory]
-    [MemberData(nameof(IsAsyncData))]
-    public virtual Task SelectMany_optional_trunk_reference_branch_collection(bool async)
-        => AssertQuery(
-            async,
-            ss => ss.Set<RelationshipsRootEntity>()
-                .SelectMany(x => x.OptionalReferenceTrunk!.CollectionBranch),
-            ss => ss.Set<RelationshipsRootEntity>()
-                .SelectMany(x => x.OptionalReferenceTrunk.Maybe(xx => xx!.CollectionBranch) ?? new List<RelationshipsBranchEntity>()));
-}
diff --git a/test/EFCore.Specification.Tests/Query/Relationships/Include/RelationshipsIncludeQueryTestBase.cs b/test/EFCore.Specification.Tests/Query/Relationships/Include/NavigationIncludeTestBase.cs
similarity index 96%
rename from test/EFCore.Specification.Tests/Query/Relationships/Include/RelationshipsIncludeQueryTestBase.cs
rename to test/EFCore.Specification.Tests/Query/Relationships/Include/NavigationIncludeTestBase.cs
index 6215a29651..d4d7dcedeb 100644
--- a/test/EFCore.Specification.Tests/Query/Relationships/Include/RelationshipsIncludeQueryTestBase.cs
+++ b/test/EFCore.Specification.Tests/Query/Relationships/Include/NavigationIncludeTestBase.cs
@@ -5,8 +5,8 @@
 
 namespace Microsoft.EntityFrameworkCore.Query.Relationships.Include;
 
-public abstract class RelationshipsIncludeQueryTestBase<TFixture>(TFixture fixture) : QueryTestBase<TFixture>(fixture)
-    where TFixture : RelationshipsQueryFixtureBase, new()
+public abstract class NavigationIncludeTestBase<TFixture>(TFixture fixture) : QueryTestBase<TFixture>(fixture)
+    where TFixture : NavigationRelationshipsFixtureBase, new()
 {
     protected RelationshipsContext CreateContext()
         => Fixture.CreateContext();
diff --git a/test/EFCore.Specification.Tests/Query/Relationships/EntityRelationshipsQueryFixtureBase.cs b/test/EFCore.Specification.Tests/Query/Relationships/NavigationRelationshipsFixtureBase.cs
similarity index 97%
rename from test/EFCore.Specification.Tests/Query/Relationships/EntityRelationshipsQueryFixtureBase.cs
rename to test/EFCore.Specification.Tests/Query/Relationships/NavigationRelationshipsFixtureBase.cs
index f0bb3e26a6..f8e61fb57a 100644
--- a/test/EFCore.Specification.Tests/Query/Relationships/EntityRelationshipsQueryFixtureBase.cs
+++ b/test/EFCore.Specification.Tests/Query/Relationships/NavigationRelationshipsFixtureBase.cs
@@ -5,9 +5,9 @@
 
 namespace Microsoft.EntityFrameworkCore.Query.Relationships;
 
-public abstract class EntityRelationshipsQueryFixtureBase : RelationshipsQueryFixtureBase
+public abstract class NavigationRelationshipsFixtureBase : RelationshipsQueryFixtureBase
 {
-    protected override string StoreName => "EntityRelationshipsQueryTest";
+    protected override string StoreName => "NavigationRelationshipsQueryTest";
 
     protected override Task SeedAsync(RelationshipsContext context)
     {
diff --git a/test/EFCore.Specification.Tests/Query/Relationships/JsonRelationshipsQueryFixtureBase.cs b/test/EFCore.Specification.Tests/Query/Relationships/OwnedJsonRelationshipsFixtureBase.cs
similarity index 83%
rename from test/EFCore.Specification.Tests/Query/Relationships/JsonRelationshipsQueryFixtureBase.cs
rename to test/EFCore.Specification.Tests/Query/Relationships/OwnedJsonRelationshipsFixtureBase.cs
index f7cbb45d47..1cbc51d59d 100644
--- a/test/EFCore.Specification.Tests/Query/Relationships/JsonRelationshipsQueryFixtureBase.cs
+++ b/test/EFCore.Specification.Tests/Query/Relationships/OwnedJsonRelationshipsFixtureBase.cs
@@ -5,9 +5,9 @@
 
 namespace Microsoft.EntityFrameworkCore.Query.Relationships;
 
-public abstract class JsonRelationshipsQueryFixtureBase : OwnedRelationshipsQueryFixtureBase
+public abstract class OwnedJsonRelationshipsFixtureBase : OwnedRelationshipsFixtureBase
 {
-    protected override string StoreName => "JsonRelationshipsQueryTest";
+    protected override string StoreName => "OwnedJsonRelationshipsQueryTest";
 
     protected override Task SeedAsync(RelationshipsContext context)
     {
diff --git a/test/EFCore.Specification.Tests/Query/Relationships/OwnedRelationshipsQueryFixtureBase.cs b/test/EFCore.Specification.Tests/Query/Relationships/OwnedRelationshipsFixtureBase.cs
similarity index 99%
rename from test/EFCore.Specification.Tests/Query/Relationships/OwnedRelationshipsQueryFixtureBase.cs
rename to test/EFCore.Specification.Tests/Query/Relationships/OwnedRelationshipsFixtureBase.cs
index 1bff81c89a..6d3e2f1d9b 100644
--- a/test/EFCore.Specification.Tests/Query/Relationships/OwnedRelationshipsQueryFixtureBase.cs
+++ b/test/EFCore.Specification.Tests/Query/Relationships/OwnedRelationshipsFixtureBase.cs
@@ -5,7 +5,7 @@
 
 namespace Microsoft.EntityFrameworkCore.Query.Relationships;
 
-public abstract class OwnedRelationshipsQueryFixtureBase : RelationshipsQueryFixtureBase
+public abstract class OwnedRelationshipsFixtureBase : RelationshipsQueryFixtureBase
 {
     protected override string StoreName => "OwnedRelationshipsQueryTest";
 
diff --git a/test/EFCore.Specification.Tests/Query/Relationships/Projection/ComplexNoTrackingProjectionTestBase.cs b/test/EFCore.Specification.Tests/Query/Relationships/Projection/ComplexNoTrackingProjectionTestBase.cs
new file mode 100644
index 0000000000..e6fdadac40
--- /dev/null
+++ b/test/EFCore.Specification.Tests/Query/Relationships/Projection/ComplexNoTrackingProjectionTestBase.cs
@@ -0,0 +1,18 @@
+﻿// Licensed to the .NET Foundation under one or more agreements.
+// The .NET Foundation licenses this file to you under the MIT license.
+
+namespace Microsoft.EntityFrameworkCore.Query.Relationships.Projection;
+
+public abstract class ComplexNoTrackingProjectionTestBase<TFixture>(TFixture fixture)
+    : ComplexProjectionTestBase<TFixture>(fixture)
+        where TFixture : ComplexRelationshipsFixtureBase, new()
+{
+    private readonly TrackingRewriter _trackingRewriter = new();
+
+    protected override Expression RewriteServerQueryExpression(Expression serverQueryExpression)
+    {
+        var rewritten = _trackingRewriter.Visit(serverQueryExpression);
+
+        return rewritten;
+    }
+}
diff --git a/test/EFCore.Specification.Tests/Query/Relationships/Projection/ComplexProjectionTestBase.cs b/test/EFCore.Specification.Tests/Query/Relationships/Projection/ComplexProjectionTestBase.cs
new file mode 100644
index 0000000000..b0ae65aa9a
--- /dev/null
+++ b/test/EFCore.Specification.Tests/Query/Relationships/Projection/ComplexProjectionTestBase.cs
@@ -0,0 +1,57 @@
+﻿// Licensed to the .NET Foundation under one or more agreements.
+// The .NET Foundation licenses this file to you under the MIT license.
+
+using Microsoft.EntityFrameworkCore.TestModels.RelationshipsModel;
+
+namespace Microsoft.EntityFrameworkCore.Query.Relationships.Projection;
+
+public abstract class ComplexProjectionTestBase<TFixture>(TFixture fixture)
+    : ReferenceProjectionTestBase<TFixture>(fixture)
+        where TFixture : ComplexRelationshipsFixtureBase, new()
+{
+    [ConditionalTheory]
+    [MemberData(nameof(IsAsyncData))]
+    public virtual Task Select_everything(bool async)
+        => AssertQuery(
+            async,
+            ss => from r in ss.Set<RelationshipsRootEntity>()
+                  join t in ss.Set<RelationshipsTrunkEntity>() on r.Id equals t.Id
+                  select new { r, t },
+            elementSorter: e => e.r.Id,
+            elementAsserter: (e, a) =>
+            {
+                AssertEqual(e.r, a.r);
+                AssertEqual(e.t, a.t);
+            });
+
+    [ConditionalTheory(Skip = "issue #31412")]
+    public override Task Select_branch_required_optional(bool async)
+        => base.Select_branch_required_optional(async);
+
+    [ConditionalTheory(Skip = "issue #31376")]
+    public override Task Select_branch_optional_optional(bool async)
+        => base.Select_branch_optional_optional(async);
+
+    [ConditionalTheory(Skip = "issue #31412")]
+    public override Task Select_branch_optional_required(bool async)
+        => base.Select_branch_optional_required(async);
+
+    public override Task Select_root_duplicated(bool async)
+        => base.Select_root_duplicated(async);
+
+    [ConditionalTheory(Skip = "issue #31412")]
+    public override Task Select_trunk_and_branch_duplicated(bool async)
+        => base.Select_trunk_and_branch_duplicated(async);
+
+    [ConditionalTheory(Skip = "issue #31412")]
+    public override Task Select_trunk_and_trunk_duplicated(bool async)
+        => base.Select_trunk_and_trunk_duplicated(async);
+
+    [ConditionalTheory(Skip = "issue #31237")]
+    public override Task Select_subquery_root_set_required_trunk_FirstOrDefault_branch(bool async)
+        => base.Select_subquery_root_set_required_trunk_FirstOrDefault_branch(async);
+
+    [ConditionalTheory(Skip = "issue #31412")]
+    public override Task Select_subquery_root_set_optional_trunk_FirstOrDefault_branch(bool async)
+        => base.Select_subquery_root_set_optional_trunk_FirstOrDefault_branch(async);
+}
diff --git a/test/EFCore.Specification.Tests/Query/Relationships/Projection/NavigationNoTrackingProjectionTestBase.cs b/test/EFCore.Specification.Tests/Query/Relationships/Projection/NavigationNoTrackingProjectionTestBase.cs
new file mode 100644
index 0000000000..9f7574ec18
--- /dev/null
+++ b/test/EFCore.Specification.Tests/Query/Relationships/Projection/NavigationNoTrackingProjectionTestBase.cs
@@ -0,0 +1,18 @@
+﻿// Licensed to the .NET Foundation under one or more agreements.
+// The .NET Foundation licenses this file to you under the MIT license.
+
+namespace Microsoft.EntityFrameworkCore.Query.Relationships.Projection;
+
+public abstract class NavigationNoTrackingProjectionTestBase<TFixture>(TFixture fixture)
+    : NavigationProjectionTestBase<TFixture>(fixture)
+        where TFixture : NavigationRelationshipsFixtureBase, new()
+{
+    private readonly TrackingRewriter _trackingRewriter = new();
+
+    protected override Expression RewriteServerQueryExpression(Expression serverQueryExpression)
+    {
+        var rewritten = _trackingRewriter.Visit(serverQueryExpression);
+
+        return rewritten;
+    }
+}
diff --git a/test/EFCore.Specification.Tests/Query/Relationships/InProjection/EntityRelationshipsInProjectionQueryTestBase.cs b/test/EFCore.Specification.Tests/Query/Relationships/Projection/NavigationProjectionTestBase.cs
similarity index 72%
rename from test/EFCore.Specification.Tests/Query/Relationships/InProjection/EntityRelationshipsInProjectionQueryTestBase.cs
rename to test/EFCore.Specification.Tests/Query/Relationships/Projection/NavigationProjectionTestBase.cs
index 094c77d14e..01ee19666b 100644
--- a/test/EFCore.Specification.Tests/Query/Relationships/InProjection/EntityRelationshipsInProjectionQueryTestBase.cs
+++ b/test/EFCore.Specification.Tests/Query/Relationships/Projection/NavigationProjectionTestBase.cs
@@ -3,15 +3,15 @@
 
 using Microsoft.EntityFrameworkCore.TestModels.RelationshipsModel;
 
-namespace Microsoft.EntityFrameworkCore.Query.Relationships.InProjection;
+namespace Microsoft.EntityFrameworkCore.Query.Relationships.Projection;
 
-public abstract class EntityRelationshipsInProjectionQueryTestBase<TFixture>(TFixture fixture)
-    : RelationshipsInProjectionQueryTestBase<TFixture>(fixture)
-        where TFixture : EntityRelationshipsQueryFixtureBase, new()
+public abstract class NavigationProjectionTestBase<TFixture>(TFixture fixture)
+    : ProjectionTestBase<TFixture>(fixture)
+        where TFixture : NavigationRelationshipsFixtureBase, new()
 {
     [ConditionalTheory]
     [MemberData(nameof(IsAsyncData))]
-    public virtual Task Project_everything(bool async)
+    public virtual Task Select_everything_using_joins(bool async)
         => AssertQuery(
             async,
             ss => from r in ss.Set<RelationshipsRootEntity>()
diff --git a/test/EFCore.Specification.Tests/Query/Relationships/Projection/NavigationReferenceNoTrackingProjectionTestBase.cs b/test/EFCore.Specification.Tests/Query/Relationships/Projection/NavigationReferenceNoTrackingProjectionTestBase.cs
new file mode 100644
index 0000000000..401385aac9
--- /dev/null
+++ b/test/EFCore.Specification.Tests/Query/Relationships/Projection/NavigationReferenceNoTrackingProjectionTestBase.cs
@@ -0,0 +1,18 @@
+﻿// Licensed to the .NET Foundation under one or more agreements.
+// The .NET Foundation licenses this file to you under the MIT license.
+
+namespace Microsoft.EntityFrameworkCore.Query.Relationships.Projection;
+
+public abstract class NavigationReferenceNoTrackingProjectionTestBase<TFixture>(TFixture fixture)
+    : NavigationReferenceProjectionTestBase<TFixture>(fixture)
+        where TFixture : NavigationRelationshipsFixtureBase, new()
+{
+    private readonly TrackingRewriter _trackingRewriter = new();
+
+    protected override Expression RewriteServerQueryExpression(Expression serverQueryExpression)
+    {
+        var rewritten = _trackingRewriter.Visit(serverQueryExpression);
+
+        return rewritten;
+    }
+}
diff --git a/test/EFCore.Specification.Tests/Query/Relationships/Projection/NavigationReferenceProjectionTestBase.cs b/test/EFCore.Specification.Tests/Query/Relationships/Projection/NavigationReferenceProjectionTestBase.cs
new file mode 100644
index 0000000000..9ec8650e60
--- /dev/null
+++ b/test/EFCore.Specification.Tests/Query/Relationships/Projection/NavigationReferenceProjectionTestBase.cs
@@ -0,0 +1,30 @@
+﻿// Licensed to the .NET Foundation under one or more agreements.
+// The .NET Foundation licenses this file to you under the MIT license.
+
+using Microsoft.EntityFrameworkCore.TestModels.RelationshipsModel;
+
+namespace Microsoft.EntityFrameworkCore.Query.Relationships.Projection;
+
+public abstract class NavigationReferenceProjectionTestBase<TFixture>(TFixture fixture)
+    : ReferenceProjectionTestBase<TFixture>(fixture)
+        where TFixture : NavigationRelationshipsFixtureBase, new()
+{
+    [ConditionalTheory]
+    [MemberData(nameof(IsAsyncData))]
+    public virtual Task Select_everything(bool async)
+        => AssertQuery(
+            async,
+            ss => from r in ss.Set<RelationshipsRootEntity>()
+                  join t in ss.Set<RelationshipsTrunkEntity>() on r.Id equals t.Id
+                  join b in ss.Set<RelationshipsBranchEntity>() on t.Id equals b.Id
+                  join l in ss.Set<RelationshipsLeafEntity>() on b.Id equals l.Id
+                  select new { r, t, b, l },
+            elementSorter: e => e.r.Id,
+            elementAsserter: (e, a) =>
+            {
+                AssertEqual(e.r, a.r);
+                AssertEqual(e.t, a.t);
+                AssertEqual(e.b, a.b);
+                AssertEqual(e.l, a.l);
+            });
+}
diff --git a/test/EFCore.Specification.Tests/Query/Relationships/Projection/OwnedJsonNoTrackingProjectionTestBase.cs b/test/EFCore.Specification.Tests/Query/Relationships/Projection/OwnedJsonNoTrackingProjectionTestBase.cs
new file mode 100644
index 0000000000..07ed78d1f6
--- /dev/null
+++ b/test/EFCore.Specification.Tests/Query/Relationships/Projection/OwnedJsonNoTrackingProjectionTestBase.cs
@@ -0,0 +1,18 @@
+﻿// Licensed to the .NET Foundation under one or more agreements.
+// The .NET Foundation licenses this file to you under the MIT license.
+
+namespace Microsoft.EntityFrameworkCore.Query.Relationships.Projection;
+
+public abstract class OwnedJsonNoTrackingProjectionTestBase<TFixture>(TFixture fixture)
+    : OwnedJsonProjectionTestBase<TFixture>(fixture)
+        where TFixture : OwnedJsonRelationshipsFixtureBase, new()
+{
+    private readonly TrackingRewriter _trackingRewriter = new();
+
+    protected override Expression RewriteServerQueryExpression(Expression serverQueryExpression)
+    {
+        var rewritten = _trackingRewriter.Visit(serverQueryExpression);
+
+        return rewritten;
+    }
+}
diff --git a/test/EFCore.Specification.Tests/Query/Relationships/InProjection/JsonRelationshipsInProjectionQueryTestBase.cs b/test/EFCore.Specification.Tests/Query/Relationships/Projection/OwnedJsonProjectionTestBase.cs
similarity index 69%
rename from test/EFCore.Specification.Tests/Query/Relationships/InProjection/JsonRelationshipsInProjectionQueryTestBase.cs
rename to test/EFCore.Specification.Tests/Query/Relationships/Projection/OwnedJsonProjectionTestBase.cs
index 906d36d8e7..6b615495ec 100644
--- a/test/EFCore.Specification.Tests/Query/Relationships/InProjection/JsonRelationshipsInProjectionQueryTestBase.cs
+++ b/test/EFCore.Specification.Tests/Query/Relationships/Projection/OwnedJsonProjectionTestBase.cs
@@ -3,11 +3,11 @@
 
 using Microsoft.EntityFrameworkCore.TestModels.RelationshipsModel;
 
-namespace Microsoft.EntityFrameworkCore.Query.Relationships.InProjection;
+namespace Microsoft.EntityFrameworkCore.Query.Relationships.Projection;
 
-public abstract class JsonRelationshipsInProjectionQueryTestBase<TFixture>(TFixture fixture)
-    : RelationshipsInProjectionQueryTestBase<TFixture>(fixture)
-        where TFixture : JsonRelationshipsQueryFixtureBase, new()
+public abstract class OwnedJsonProjectionTestBase<TFixture>(TFixture fixture)
+    : ProjectionTestBase<TFixture>(fixture)
+        where TFixture : OwnedJsonRelationshipsFixtureBase, new()
 {
     [ConditionalTheory]
     [MemberData(nameof(IsAsyncData))]
@@ -17,6 +17,4 @@ public virtual Task Project_branch_collection_element_using_indexer_constant(boo
             ss => ss.Set<RelationshipsRootEntity>().OrderBy(x => x.Id).Select(x => x.RequiredReferenceTrunk.CollectionBranch),
             assertOrder: true,
             elementAsserter: (e, a) => AssertCollection(e, a, elementSorter: ee => ee.Name));
-
-
 }
diff --git a/test/EFCore.Specification.Tests/Query/Relationships/Projection/OwnedJsonReferenceNoTrackingProjectionTestBase.cs b/test/EFCore.Specification.Tests/Query/Relationships/Projection/OwnedJsonReferenceNoTrackingProjectionTestBase.cs
new file mode 100644
index 0000000000..6964862ae5
--- /dev/null
+++ b/test/EFCore.Specification.Tests/Query/Relationships/Projection/OwnedJsonReferenceNoTrackingProjectionTestBase.cs
@@ -0,0 +1,18 @@
+﻿// Licensed to the .NET Foundation under one or more agreements.
+// The .NET Foundation licenses this file to you under the MIT license.
+
+namespace Microsoft.EntityFrameworkCore.Query.Relationships.Projection;
+
+public abstract class OwnedJsonReferenceNoTrackingProjectionTestBase<TFixture>(TFixture fixture)
+    : OwnedJsonReferenceProjectionTestBase<TFixture>(fixture)
+        where TFixture : OwnedJsonRelationshipsFixtureBase, new()
+{
+    private readonly TrackingRewriter _trackingRewriter = new();
+
+    protected override Expression RewriteServerQueryExpression(Expression serverQueryExpression)
+    {
+        var rewritten = _trackingRewriter.Visit(serverQueryExpression);
+
+        return rewritten;
+    }
+}
diff --git a/test/EFCore.Specification.Tests/Query/Relationships/Projection/OwnedJsonReferenceProjectionTestBase.cs b/test/EFCore.Specification.Tests/Query/Relationships/Projection/OwnedJsonReferenceProjectionTestBase.cs
new file mode 100644
index 0000000000..fb82cc2431
--- /dev/null
+++ b/test/EFCore.Specification.Tests/Query/Relationships/Projection/OwnedJsonReferenceProjectionTestBase.cs
@@ -0,0 +1,10 @@
+﻿// Licensed to the .NET Foundation under one or more agreements.
+// The .NET Foundation licenses this file to you under the MIT license.
+
+namespace Microsoft.EntityFrameworkCore.Query.Relationships.Projection;
+
+public abstract class OwnedJsonReferenceProjectionTestBase<TFixture>(TFixture fixture)
+    : ReferenceProjectionTestBase<TFixture>(fixture)
+        where TFixture : OwnedJsonRelationshipsFixtureBase, new()
+{
+}
diff --git a/test/EFCore.Specification.Tests/Query/Relationships/Projection/OwnedNoTrackingProjectionTestBase.cs b/test/EFCore.Specification.Tests/Query/Relationships/Projection/OwnedNoTrackingProjectionTestBase.cs
new file mode 100644
index 0000000000..a55b81c862
--- /dev/null
+++ b/test/EFCore.Specification.Tests/Query/Relationships/Projection/OwnedNoTrackingProjectionTestBase.cs
@@ -0,0 +1,18 @@
+﻿// Licensed to the .NET Foundation under one or more agreements.
+// The .NET Foundation licenses this file to you under the MIT license.
+
+namespace Microsoft.EntityFrameworkCore.Query.Relationships.Projection;
+
+public abstract class OwnedNoTrackingProjectionTestBase<TFixture>(TFixture fixture)
+    : OwnedProjectionTestBase<TFixture>(fixture)
+        where TFixture : OwnedRelationshipsFixtureBase, new()
+{
+    private readonly TrackingRewriter _trackingRewriter = new();
+
+    protected override Expression RewriteServerQueryExpression(Expression serverQueryExpression)
+    {
+        var rewritten = _trackingRewriter.Visit(serverQueryExpression);
+
+        return rewritten;
+    }
+}
diff --git a/test/EFCore.Specification.Tests/Query/Relationships/Projection/OwnedProjectionTestBase.cs b/test/EFCore.Specification.Tests/Query/Relationships/Projection/OwnedProjectionTestBase.cs
new file mode 100644
index 0000000000..c1f6430833
--- /dev/null
+++ b/test/EFCore.Specification.Tests/Query/Relationships/Projection/OwnedProjectionTestBase.cs
@@ -0,0 +1,10 @@
+﻿// Licensed to the .NET Foundation under one or more agreements.
+// The .NET Foundation licenses this file to you under the MIT license.
+
+namespace Microsoft.EntityFrameworkCore.Query.Relationships.Projection;
+
+public abstract class OwnedProjectionTestBase<TFixture>(TFixture fixture)
+    : ProjectionTestBase<TFixture>(fixture)
+        where TFixture : OwnedRelationshipsFixtureBase, new()
+{
+}
diff --git a/test/EFCore.Specification.Tests/Query/Relationships/Projection/OwnedReferenceNoTrackingProjectionTestBase.cs b/test/EFCore.Specification.Tests/Query/Relationships/Projection/OwnedReferenceNoTrackingProjectionTestBase.cs
new file mode 100644
index 0000000000..28779949bf
--- /dev/null
+++ b/test/EFCore.Specification.Tests/Query/Relationships/Projection/OwnedReferenceNoTrackingProjectionTestBase.cs
@@ -0,0 +1,18 @@
+﻿// Licensed to the .NET Foundation under one or more agreements.
+// The .NET Foundation licenses this file to you under the MIT license.
+
+namespace Microsoft.EntityFrameworkCore.Query.Relationships.Projection;
+
+public abstract class OwnedReferenceNoTrackingProjectionTestBase<TFixture>(TFixture fixture)
+    : OwnedReferenceProjectionTestBase<TFixture>(fixture)
+        where TFixture : OwnedRelationshipsFixtureBase, new()
+{
+    private readonly TrackingRewriter _trackingRewriter = new();
+
+    protected override Expression RewriteServerQueryExpression(Expression serverQueryExpression)
+    {
+        var rewritten = _trackingRewriter.Visit(serverQueryExpression);
+
+        return rewritten;
+    }
+}
diff --git a/test/EFCore.Specification.Tests/Query/Relationships/Projection/OwnedReferenceProjectionTestBase.cs b/test/EFCore.Specification.Tests/Query/Relationships/Projection/OwnedReferenceProjectionTestBase.cs
new file mode 100644
index 0000000000..cb23b46e2c
--- /dev/null
+++ b/test/EFCore.Specification.Tests/Query/Relationships/Projection/OwnedReferenceProjectionTestBase.cs
@@ -0,0 +1,10 @@
+﻿// Licensed to the .NET Foundation under one or more agreements.
+// The .NET Foundation licenses this file to you under the MIT license.
+
+namespace Microsoft.EntityFrameworkCore.Query.Relationships.Projection;
+
+public abstract class OwnedReferenceProjectionTestBase<TFixture>(TFixture fixture)
+    : ReferenceProjectionTestBase<TFixture>(fixture)
+        where TFixture : OwnedRelationshipsFixtureBase, new()
+{
+}
diff --git a/test/EFCore.Specification.Tests/Query/Relationships/Projection/ProjectionTestBase.cs b/test/EFCore.Specification.Tests/Query/Relationships/Projection/ProjectionTestBase.cs
new file mode 100644
index 0000000000..65e2be89cb
--- /dev/null
+++ b/test/EFCore.Specification.Tests/Query/Relationships/Projection/ProjectionTestBase.cs
@@ -0,0 +1,158 @@
+﻿// Licensed to the .NET Foundation under one or more agreements.
+// The .NET Foundation licenses this file to you under the MIT license.
+
+using Microsoft.EntityFrameworkCore.TestModels.RelationshipsModel;
+
+namespace Microsoft.EntityFrameworkCore.Query.Relationships.Projection;
+
+public abstract class ProjectionTestBase<TFixture>(TFixture fixture) : QueryTestBase<TFixture>(fixture)
+    where TFixture : RelationshipsQueryFixtureBase, new()
+{
+    protected RelationshipsContext CreateContext()
+        => Fixture.CreateContext();
+
+    [ConditionalTheory]
+    [MemberData(nameof(IsAsyncData))]
+    public virtual Task Select_trunk_collection(bool async)
+        => AssertQuery(
+            async,
+            ss => ss.Set<RelationshipsRootEntity>().OrderBy(x => x.Id).Select(x => x.CollectionTrunk),
+            assertOrder: true,
+            elementAsserter: (e, a) => AssertCollection(e, a, elementSorter: ee => ee.Name));
+
+    [ConditionalTheory]
+    [MemberData(nameof(IsAsyncData))]
+    public virtual Task Select_branch_required_collection(bool async)
+        => AssertQuery(
+            async,
+            ss => ss.Set<RelationshipsRootEntity>().OrderBy(x => x.Id).Select(x => x.RequiredReferenceTrunk.CollectionBranch),
+            assertOrder: true,
+            elementAsserter: (e, a) => AssertCollection(e, a, elementSorter: ee => ee.Name));
+
+    [ConditionalTheory]
+    [MemberData(nameof(IsAsyncData))]
+    public virtual Task Select_branch_optional_collection(bool async)
+        => AssertQuery(
+            async,
+            ss => ss.Set<RelationshipsRootEntity>().OrderBy(x => x.Id).Select(x => x.RequiredReferenceTrunk.CollectionBranch),
+            assertOrder: true,
+            elementAsserter: (e, a) => AssertCollection(e, a, elementSorter: ee => ee.Name));
+
+    [ConditionalTheory]
+    [MemberData(nameof(IsAsyncData))]
+    public virtual Task Select_multiple_branch_leaf(bool async)
+        => AssertQuery(
+            async,
+            ss => ss.Set<RelationshipsRootEntity>().Select(
+                x => new
+                {
+                    x.Id,
+                    x.RequiredReferenceTrunk.RequiredReferenceBranch,
+                    x.RequiredReferenceTrunk.RequiredReferenceBranch.OptionalReferenceLeaf,
+                    x.RequiredReferenceTrunk.RequiredReferenceBranch.CollectionLeaf,
+                    x.RequiredReferenceTrunk.CollectionBranch,
+                    x.RequiredReferenceTrunk.RequiredReferenceBranch.OptionalReferenceLeaf!.Name
+                }),
+            elementSorter: e => e.Id,
+            elementAsserter: (e, a) =>
+            {
+                Assert.Equal(e.Id, a.Id);
+                AssertEqual(e.RequiredReferenceBranch, a.RequiredReferenceBranch);
+                AssertEqual(e.OptionalReferenceLeaf, a.OptionalReferenceLeaf);
+                AssertCollection(e.CollectionLeaf, a.CollectionLeaf, ordered: true);
+                AssertCollection(e.CollectionBranch, a.CollectionBranch, ordered: true);
+                Assert.Equal(e.Name, a.Name);
+            });
+
+    [ConditionalTheory]
+    [MemberData(nameof(IsAsyncData))]
+    public virtual Task Select_subquery_root_set_trunk_FirstOrDefault_collection(bool async)
+        => AssertQuery(
+            async,
+            ss => ss.Set<RelationshipsRootEntity>()
+                .OrderBy(x => x.Id)
+                .Select(
+                    x => ss.Set<RelationshipsRootEntity>()
+                        .OrderBy(xx => xx.Id)
+                        .Select(xx => xx.RequiredReferenceTrunk)
+                        .FirstOrDefault()!.CollectionBranch),
+            assertOrder: true,
+            elementAsserter: (e, a) => AssertCollection(e, a, elementSorter: ee => ee));
+
+    [ConditionalTheory]
+    [MemberData(nameof(IsAsyncData))]
+    public virtual Task Select_subquery_root_set_complex_projection_including_references_to_outer_FirstOrDefault(bool async)
+        => AssertQuery(
+            async,
+            ss => ss.Set<RelationshipsRootEntity>()
+                .OrderBy(x => x.Id)
+                .Select(
+                    x => ss.Set<RelationshipsRootEntity>()
+                        .OrderBy(xx => xx.Id)
+                        .Select(
+                            xx => new
+                            {
+                                OuterBranch = x.RequiredReferenceTrunk.CollectionBranch,
+                                xx.RequiredReferenceTrunk,
+                                xx.RequiredReferenceTrunk.RequiredReferenceBranch,
+                                xx.RequiredReferenceTrunk.Name,
+                                OuterName = x.RequiredReferenceTrunk!.RequiredReferenceBranch.Name
+                            }).FirstOrDefault()),
+            assertOrder: true,
+            elementAsserter: (e, a) =>
+            {
+                AssertCollection(e.OuterBranch, a.OuterBranch);
+                AssertEqual(e.RequiredReferenceTrunk, a.RequiredReferenceTrunk);
+                AssertEqual(e.RequiredReferenceBranch, a.RequiredReferenceBranch);
+                AssertEqual(e.Name, a.Name);
+                AssertEqual(e.OuterName, a.OuterName);
+            });
+
+    [ConditionalTheory]
+    [MemberData(nameof(IsAsyncData))]
+    public virtual Task Select_subquery_root_set_complex_projection_FirstOrDefault_project_reference_to_outer(bool async)
+        => AssertQuery(
+            async,
+            ss => ss.Set<RelationshipsRootEntity>()
+                .OrderBy(x => x.Id)
+                .Select(
+                    x => ss.Set<RelationshipsRootEntity>()
+                        .OrderBy(xx => xx.Id)
+                        .Select(
+                            xx => new
+                            {
+                                OuterBranchCollection = x.RequiredReferenceTrunk.CollectionBranch,
+                                xx.RequiredReferenceTrunk,
+                                xx.RequiredReferenceTrunk.RequiredReferenceBranch,
+                                xx.RequiredReferenceTrunk.Name,
+                                OuterName = x.RequiredReferenceTrunk.RequiredReferenceBranch.Name
+                            }).FirstOrDefault()!.OuterBranchCollection),
+            assertOrder: true,
+            elementAsserter: (e, a) => AssertCollection(e, a));
+
+    [ConditionalTheory]
+    [MemberData(nameof(IsAsyncData))]
+    public virtual Task SelectMany_trunk_collection(bool async)
+        => AssertQuery(
+            async,
+            ss => ss.Set<RelationshipsRootEntity>()
+                .SelectMany(x => x.CollectionTrunk));
+
+    [ConditionalTheory]
+    [MemberData(nameof(IsAsyncData))]
+    public virtual Task SelectMany_required_trunk_reference_branch_collection(bool async)
+        => AssertQuery(
+            async,
+            ss => ss.Set<RelationshipsRootEntity>()
+                .SelectMany(x => x.RequiredReferenceTrunk.CollectionBranch));
+
+    [ConditionalTheory]
+    [MemberData(nameof(IsAsyncData))]
+    public virtual Task SelectMany_optional_trunk_reference_branch_collection(bool async)
+        => AssertQuery(
+            async,
+            ss => ss.Set<RelationshipsRootEntity>()
+                .SelectMany(x => x.OptionalReferenceTrunk!.CollectionBranch),
+            ss => ss.Set<RelationshipsRootEntity>()
+                .SelectMany(x => x.OptionalReferenceTrunk.Maybe(xx => xx!.CollectionBranch) ?? new List<RelationshipsBranchEntity>()));
+}
diff --git a/test/EFCore.Specification.Tests/Query/Relationships/Projection/ReferenceProjectionTestBase.cs b/test/EFCore.Specification.Tests/Query/Relationships/Projection/ReferenceProjectionTestBase.cs
new file mode 100644
index 0000000000..4ca725db57
--- /dev/null
+++ b/test/EFCore.Specification.Tests/Query/Relationships/Projection/ReferenceProjectionTestBase.cs
@@ -0,0 +1,178 @@
+﻿// Licensed to the .NET Foundation under one or more agreements.
+// The .NET Foundation licenses this file to you under the MIT license.
+
+using Microsoft.EntityFrameworkCore.TestModels.RelationshipsModel;
+
+namespace Microsoft.EntityFrameworkCore.Query.Relationships.Projection;
+
+public abstract class ReferenceProjectionTestBase<TFixture>(TFixture fixture) : QueryTestBase<TFixture>(fixture)
+    where TFixture : RelationshipsQueryFixtureBase, new()
+{
+    protected RelationshipsContext CreateContext()
+        => Fixture.CreateContext();
+
+    [ConditionalTheory]
+    [MemberData(nameof(IsAsyncData))]
+    public virtual Task Select_root(bool async)
+        => AssertQuery(
+            async,
+            ss => ss.Set<RelationshipsRootEntity>());
+
+    [ConditionalTheory]
+    [MemberData(nameof(IsAsyncData))]
+    public virtual Task Select_trunk_optional(bool async)
+        => AssertQuery(
+            async,
+            ss => ss.Set<RelationshipsRootEntity>().OrderBy(x => x.Id).Select(x => x.OptionalReferenceTrunk),
+            assertOrder: true);
+
+    [ConditionalTheory]
+    [MemberData(nameof(IsAsyncData))]
+    public virtual Task Select_trunk_required(bool async)
+        => AssertQuery(
+            async,
+            ss => ss.Set<RelationshipsRootEntity>().OrderBy(x => x.Id).Select(x => x.RequiredReferenceTrunk),
+            assertOrder: true);
+
+    [ConditionalTheory]
+    [MemberData(nameof(IsAsyncData))]
+    public virtual Task Select_branch_required_required(bool async)
+        => AssertQuery(
+            async,
+            ss => ss.Set<RelationshipsRootEntity>().OrderBy(x => x.Id).Select(x => x.RequiredReferenceTrunk.RequiredReferenceBranch),
+            assertOrder: true);
+
+    [ConditionalTheory]
+    [MemberData(nameof(IsAsyncData))]
+    public virtual Task Select_branch_required_optional(bool async)
+        => AssertQuery(
+            async,
+            ss => ss.Set<RelationshipsRootEntity>().OrderBy(x => x.Id).Select(x => x.RequiredReferenceTrunk.OptionalReferenceBranch),
+            assertOrder: true);
+
+    [ConditionalTheory]
+    [MemberData(nameof(IsAsyncData))]
+    public virtual Task Select_branch_optional_required(bool async)
+        => AssertQuery(
+            async,
+            ss => ss.Set<RelationshipsRootEntity>().OrderBy(x => x.Id).Select(x => x.RequiredReferenceTrunk.RequiredReferenceBranch),
+            assertOrder: true);
+
+    [ConditionalTheory]
+    [MemberData(nameof(IsAsyncData))]
+    public virtual Task Select_branch_optional_optional(bool async)
+        => AssertQuery(
+            async,
+            ss => ss.Set<RelationshipsRootEntity>().OrderBy(x => x.Id).Select(x => x.RequiredReferenceTrunk.OptionalReferenceBranch),
+            assertOrder: true);
+
+    [ConditionalTheory]
+    [MemberData(nameof(IsAsyncData))]
+    public virtual Task Select_root_duplicated(bool async)
+        => AssertQuery(
+            async,
+            ss => ss.Set<RelationshipsRootEntity>().Select(x => new { First = x, Second = x }),
+            elementSorter: e => e.First.Id,
+            elementAsserter: (e, a) =>
+            {
+                AssertEqual(e.First, a.First);
+                AssertEqual(e.Second, a.Second);
+            });
+
+    [ConditionalTheory]
+    [MemberData(nameof(IsAsyncData))]
+    public virtual Task Select_trunk_and_branch_duplicated(bool async)
+        => AssertQuery(
+            async,
+            ss => ss.Set<RelationshipsRootEntity>()
+                .OrderBy(x => x.Id)
+                .Select(
+                    x => new
+                    {
+                        Trunk1 = x.OptionalReferenceTrunk,
+                        Branch1 = x.OptionalReferenceTrunk!.RequiredReferenceBranch,
+                        Trunk2 = x.OptionalReferenceTrunk,
+                        Branch2 = x.OptionalReferenceTrunk.RequiredReferenceBranch,
+                    }),
+            assertOrder: true,
+            elementAsserter: (e, a) =>
+            {
+                AssertEqual(e.Trunk1, a.Trunk1);
+                AssertEqual(e.Trunk2, a.Trunk2);
+                AssertEqual(e.Branch1, a.Branch1);
+                AssertEqual(e.Branch2, a.Branch2);
+            });
+
+    [ConditionalTheory]
+    [MemberData(nameof(IsAsyncData))]
+    public virtual Task Select_trunk_and_trunk_duplicated(bool async)
+        => AssertQuery(
+            async,
+            ss => ss.Set<RelationshipsRootEntity>()
+                .OrderBy(x => x.Id)
+                .Select(
+                    x => new
+                    {
+                        Trunk1 = x.RequiredReferenceTrunk,
+                        Leaf1 = x.RequiredReferenceTrunk!.OptionalReferenceBranch!.RequiredReferenceLeaf,
+                        Trunk2 = x.RequiredReferenceTrunk,
+                        Leaf2 = x.RequiredReferenceTrunk.OptionalReferenceBranch.RequiredReferenceLeaf,
+                    }),
+            assertOrder: true,
+            elementAsserter: (e, a) =>
+            {
+                AssertEqual(e.Trunk1, a.Trunk1);
+                AssertEqual(e.Trunk2, a.Trunk2);
+                AssertEqual(e.Leaf1, a.Leaf1);
+                AssertEqual(e.Leaf2, a.Leaf2);
+            });
+
+    [ConditionalTheory]
+    [MemberData(nameof(IsAsyncData))]
+    public virtual Task Select_leaf_trunk_root(bool async)
+        => AssertQuery(
+            async,
+            ss => ss.Set<RelationshipsRootEntity>()
+                .Select(
+                    x => new
+                    {
+                        x.RequiredReferenceTrunk.RequiredReferenceBranch.RequiredReferenceLeaf,
+                        x.RequiredReferenceTrunk,
+                        x
+                    }),
+            elementSorter: e => e.x.Id,
+            elementAsserter: (e, a) =>
+            {
+                AssertEqual(e.RequiredReferenceLeaf, a.RequiredReferenceLeaf);
+                AssertEqual(e.RequiredReferenceTrunk, a.RequiredReferenceTrunk);
+                AssertEqual(e.x, a.x);
+            });
+
+    [ConditionalTheory]
+    [MemberData(nameof(IsAsyncData))]
+    public virtual Task Select_subquery_root_set_required_trunk_FirstOrDefault_branch(bool async)
+        => AssertQuery(
+            async,
+            ss => ss.Set<RelationshipsRootEntity>()
+                .OrderBy(x => x.Id)
+                .Select(
+                    x => ss.Set<RelationshipsRootEntity>()
+                        .OrderBy(xx => xx.Id)
+                        .Select(xx => xx.RequiredReferenceTrunk)
+                        .FirstOrDefault()!.RequiredReferenceBranch),
+            assertOrder: true);
+
+    [ConditionalTheory]
+    [MemberData(nameof(IsAsyncData))]
+    public virtual Task Select_subquery_root_set_optional_trunk_FirstOrDefault_branch(bool async)
+        => AssertQuery(
+            async,
+            ss => ss.Set<RelationshipsRootEntity>()
+                .OrderBy(x => x.Id)
+                .Select(
+                    x => ss.Set<RelationshipsRootEntity>()
+                        .OrderBy(xx => xx.Id)
+                        .Select(xx => xx.OptionalReferenceTrunk)
+                        .FirstOrDefault()!.OptionalReferenceBranch),
+            assertOrder: true);
+}
diff --git a/test/EFCore.Specification.Tests/Query/Relationships/RelationshipsQueryFixtureBase.cs b/test/EFCore.Specification.Tests/Query/Relationships/RelationshipsQueryFixtureBase.cs
index 93af35ad1b..36a6a0a2e9 100644
--- a/test/EFCore.Specification.Tests/Query/Relationships/RelationshipsQueryFixtureBase.cs
+++ b/test/EFCore.Specification.Tests/Query/Relationships/RelationshipsQueryFixtureBase.cs
@@ -22,14 +22,6 @@ protected override Task SeedAsync(RelationshipsContext context)
 
     public abstract IReadOnlyDictionary<Type, object> EntitySorters { get; }
 
-    //public IReadOnlyDictionary<Type, object> EntitySorters { get; } = new Dictionary<Type, Func<object?, object?>>
-    //{
-    //    { typeof(RelationshipsRootEntity), e => ((RelationshipsRootEntity?)e)?.Id },
-    //    { typeof(RelationshipsTrunkEntity), e => ((RelationshipsTrunkEntity?)e)?.Id },
-    //    { typeof(RelationshipsBranchEntity), e => ((RelationshipsBranchEntity?)e)?.Id },
-    //    { typeof(RelationshipsLeafEntity), e => ((RelationshipsLeafEntity?)e)?.Id }
-    //}.ToDictionary(e => e.Key, e => (object)e.Value);
-
     public abstract IReadOnlyDictionary<Type, object> EntityAsserters { get; }
 
     protected override void OnModelCreating(ModelBuilder modelBuilder, DbContext context)
diff --git a/test/EFCore.Specification.Tests/Query/Relationships/TrackingRewriter.cs b/test/EFCore.Specification.Tests/Query/Relationships/TrackingRewriter.cs
new file mode 100644
index 0000000000..f06fcfac00
--- /dev/null
+++ b/test/EFCore.Specification.Tests/Query/Relationships/TrackingRewriter.cs
@@ -0,0 +1,32 @@
+﻿// Licensed to the .NET Foundation under one or more agreements.
+// The .NET Foundation licenses this file to you under the MIT license.
+
+namespace Microsoft.EntityFrameworkCore.Query.Relationships;
+
+public class TrackingRewriter : ExpressionVisitor
+{
+    private readonly bool _noTrackingWithIdentityResolution;
+
+    public TrackingRewriter(bool noTrackingWithIdentityResolution = false)
+    {
+        _noTrackingWithIdentityResolution = noTrackingWithIdentityResolution;
+    }
+
+    private static readonly MethodInfo AsNoTrackingMethodInfo
+        = typeof(EntityFrameworkQueryableExtensions).GetTypeInfo().GetDeclaredMethod(nameof(EntityFrameworkQueryableExtensions.AsNoTracking))!;
+
+    private static readonly MethodInfo AsNoTrackingWithIdentityResolutionMethodInfo
+        = typeof(EntityFrameworkQueryableExtensions).GetTypeInfo().GetDeclaredMethod(nameof(EntityFrameworkQueryableExtensions.AsNoTrackingWithIdentityResolution))!;
+
+    protected override Expression VisitExtension(Expression expression)
+    {
+        if (expression is EntityQueryRootExpression eqr)
+        {
+            return _noTrackingWithIdentityResolution
+                ? Expression.Call(AsNoTrackingWithIdentityResolutionMethodInfo.MakeGenericMethod(eqr.ElementType), eqr)
+                : Expression.Call(AsNoTrackingMethodInfo.MakeGenericMethod(eqr.ElementType), eqr);
+        }
+
+        return base.VisitExtension(expression);
+    }
+}
diff --git a/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/JsonRelationshipsQuerySqlServerFixture.cs b/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/ComplexRelationshipsSqlServerFixture.cs
similarity index 77%
rename from test/EFCore.SqlServer.FunctionalTests/Query/Relationships/JsonRelationshipsQuerySqlServerFixture.cs
rename to test/EFCore.SqlServer.FunctionalTests/Query/Relationships/ComplexRelationshipsSqlServerFixture.cs
index c2a3be4731..cbfea19739 100644
--- a/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/JsonRelationshipsQuerySqlServerFixture.cs
+++ b/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/ComplexRelationshipsSqlServerFixture.cs
@@ -3,7 +3,7 @@
 
 namespace Microsoft.EntityFrameworkCore.Query.Relationships;
 
-public class JsonRelationshipsQuerySqlServerFixture : JsonRelationshipsQueryRelationalFixtureBase, ITestSqlLoggerFactory
+public class ComplexRelationshipsSqlServerFixture : ComplexRelationsjipsRelationalFixtureBase, ITestSqlLoggerFactory
 {
     protected override ITestStoreFactory TestStoreFactory
         => SqlServerTestStoreFactory.Instance;
diff --git a/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/InProjection/ComplexRelationshipsInProjectionNoTrackingQuerySqlServerTest.cs b/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/InProjection/ComplexRelationshipsInProjectionNoTrackingQuerySqlServerTest.cs
deleted file mode 100644
index 7464b3b0f6..0000000000
--- a/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/InProjection/ComplexRelationshipsInProjectionNoTrackingQuerySqlServerTest.cs
+++ /dev/null
@@ -1,228 +0,0 @@
-﻿// Licensed to the .NET Foundation under one or more agreements.
-// The .NET Foundation licenses this file to you under the MIT license.
-
-namespace Microsoft.EntityFrameworkCore.Query.Relationships.InProjection;
-
-public class ComplexRelationshipsInProjectionNoTrackingQuerySqlServerTest
-    : ComplexRelationshipsInProjectionNoTrackingQueryRelationalTestBase<ComplexRelationshipsQuerySqlServerFixture>
-{
-    public ComplexRelationshipsInProjectionNoTrackingQuerySqlServerTest(ComplexRelationshipsQuerySqlServerFixture fixture, ITestOutputHelper testOutputHelper)
-        : base(fixture)
-    {
-        Fixture.TestSqlLoggerFactory.Clear();
-        Fixture.TestSqlLoggerFactory.SetTestOutputHelper(testOutputHelper);
-    }
-
-    public override async Task Project_everything(bool async)
-    {
-        await base.Project_everything(async);
-
-        AssertSql(
-"""
-SELECT [r].[Id], [r].[Name], [r].[OptionalReferenceTrunkId], [r].[RequiredReferenceTrunkId], [t].[Id], [t].[CollectionRootId], [t].[Name], [t].[OptionalReferenceBranchId], [t].[RequiredReferenceBranchId], [t].[RequiredReferenceBranch_Name], [t].[RequiredReferenceBranch_RequiredReferenceLeaf_Name]
-FROM [RootEntities] AS [r]
-INNER JOIN [TrunkEntities] AS [t] ON [r].[Id] = [t].[Id]
-""");
-    }
-
-    public override async Task Project_root(bool async)
-    {
-        await base.Project_root(async);
-
-        AssertSql(
-            """
-SELECT [r].[Id], [r].[Name], [r].[OptionalReferenceTrunkId], [r].[RequiredReferenceTrunkId]
-FROM [RootEntities] AS [r]
-""");
-    }
-
-    public override async Task Project_trunk_optional(bool async)
-    {
-        await base.Project_trunk_optional(async);
-
-        AssertSql(
-            """
-SELECT [t].[Id], [t].[CollectionRootId], [t].[Name], [t].[OptionalReferenceBranchId], [t].[RequiredReferenceBranchId], [t].[RequiredReferenceBranch_Name], [t].[RequiredReferenceBranch_RequiredReferenceLeaf_Name]
-FROM [RootEntities] AS [r]
-LEFT JOIN [TrunkEntities] AS [t] ON [r].[OptionalReferenceTrunkId] = [t].[Id]
-ORDER BY [r].[Id]
-""");
-    }
-
-    public override async Task Project_trunk_required(bool async)
-    {
-        await base.Project_trunk_required(async);
-
-        AssertSql(
-            """
-SELECT [t].[Id], [t].[CollectionRootId], [t].[Name], [t].[OptionalReferenceBranchId], [t].[RequiredReferenceBranchId], [t].[RequiredReferenceBranch_Name], [t].[RequiredReferenceBranch_RequiredReferenceLeaf_Name]
-FROM [RootEntities] AS [r]
-INNER JOIN [TrunkEntities] AS [t] ON [r].[RequiredReferenceTrunkId] = [t].[Id]
-ORDER BY [r].[Id]
-""");
-    }
-
-    public override async Task Project_trunk_collection(bool async)
-    {
-        await base.Project_trunk_collection(async);
-
-        AssertSql(
-            """
-SELECT [r].[Id], [t].[Id], [t].[CollectionRootId], [t].[Name], [t].[OptionalReferenceBranchId], [t].[RequiredReferenceBranchId], [t].[RequiredReferenceBranch_Name], [t].[RequiredReferenceBranch_RequiredReferenceLeaf_Name]
-FROM [RootEntities] AS [r]
-LEFT JOIN [TrunkEntities] AS [t] ON [r].[Id] = [t].[CollectionRootId]
-ORDER BY [r].[Id]
-""");
-    }
-
-    public override async Task Project_branch_required_required(bool async)
-    {
-        await base.Project_branch_required_required(async);
-
-        AssertSql(
-            """
-SELECT [t].[RequiredReferenceBranch_Name], [t].[RequiredReferenceBranch_RequiredReferenceLeaf_Name]
-FROM [RootEntities] AS [r]
-INNER JOIN [TrunkEntities] AS [t] ON [r].[RequiredReferenceTrunkId] = [t].[Id]
-ORDER BY [r].[Id]
-""");
-    }
-
-    public override async Task Project_branch_required_optional(bool async)
-    {
-        await base.Project_branch_required_optional(async);
-
-        AssertSql();
-    }
-
-    public override async Task Project_branch_required_collection(bool async)
-    {
-        await base.Project_branch_required_collection(async);
-
-        AssertSql();
-    }
-
-    public override async Task Project_branch_optional_required(bool async)
-    {
-        await base.Project_branch_optional_required(async);
-
-        AssertSql();
-    }
-
-    public override async Task Project_branch_optional_optional(bool async)
-    {
-        await base.Project_branch_optional_optional(async);
-
-        AssertSql();
-    }
-
-    public override async Task Project_branch_optional_collection(bool async)
-    {
-        await base.Project_branch_optional_collection(async);
-
-        AssertSql();
-    }
-
-    public override async Task Project_root_duplicated(bool async)
-    {
-        await base.Project_root_duplicated(async);
-
-        AssertSql(
-            """
-SELECT [r].[Id], [r].[Name], [r].[OptionalReferenceTrunkId], [r].[RequiredReferenceTrunkId]
-FROM [RootEntities] AS [r]
-""");
-    }
-
-    public override async Task Project_trunk_and_branch_duplicated(bool async)
-    {
-        await base.Project_trunk_and_branch_duplicated(async);
-
-        AssertSql();
-    }
-
-    public override async Task Project_trunk_and_trunk_duplicated(bool async)
-    {
-        await base.Project_trunk_and_trunk_duplicated(async);
-
-        AssertSql();
-    }
-
-    public override async Task Project_multiple_branch_leaf(bool async)
-    {
-        await base.Project_multiple_branch_leaf(async);
-
-        AssertSql();
-    }
-
-    public override async Task Project_leaf_trunk_root(bool async)
-    {
-        await base.Project_leaf_trunk_root(async);
-
-        AssertSql(
-            """
-SELECT [t].[RequiredReferenceBranch_RequiredReferenceLeaf_Name], [t].[Id], [t].[CollectionRootId], [t].[Name], [t].[OptionalReferenceBranchId], [t].[RequiredReferenceBranchId], [t].[RequiredReferenceBranch_Name], [r].[Id], [r].[Name], [r].[OptionalReferenceTrunkId], [r].[RequiredReferenceTrunkId]
-FROM [RootEntities] AS [r]
-INNER JOIN [TrunkEntities] AS [t] ON [r].[RequiredReferenceTrunkId] = [t].[Id]
-""");
-    }
-
-    public override async Task Project_subquery_root_set_required_trunk_FirstOrDefault_branch(bool async)
-    {
-        await base.Project_subquery_root_set_required_trunk_FirstOrDefault_branch(async);
-
-        AssertSql();
-    }
-
-    public override async Task Project_subquery_root_set_optional_trunk_FirstOrDefault_branch(bool async)
-    {
-        await base.Project_subquery_root_set_optional_trunk_FirstOrDefault_branch(async);
-
-        AssertSql();
-    }
-
-    public override async Task Project_subquery_root_set_trunk_FirstOrDefault_collection(bool async)
-    {
-        await base.Project_subquery_root_set_trunk_FirstOrDefault_collection(async);
-
-        AssertSql();
-    }
-
-    public override async Task Project_subquery_root_set_complex_projection_including_references_to_outer_FirstOrDefault(bool async)
-    {
-        await base.Project_subquery_root_set_complex_projection_including_references_to_outer_FirstOrDefault(async);
-
-        AssertSql();
-    }
-
-    public override async Task Project_subquery_root_set_complex_projection_FirstOrDefault_project_reference_to_outer(bool async)
-    {
-        await base.Project_subquery_root_set_complex_projection_FirstOrDefault_project_reference_to_outer(async);
-
-        AssertSql();
-    }
-
-    public override async Task SelectMany_trunk_collection(bool async)
-    {
-        await base.SelectMany_trunk_collection(async);
-
-        AssertSql();
-    }
-
-    public override async Task SelectMany_required_trunk_reference_branch_collection(bool async)
-    {
-        await base.SelectMany_required_trunk_reference_branch_collection(async);
-
-        AssertSql();
-    }
-
-    public override async Task SelectMany_optional_trunk_reference_branch_collection(bool async)
-    {
-        await base.SelectMany_optional_trunk_reference_branch_collection(async);
-
-        AssertSql();
-    }
-
-    private void AssertSql(params string[] expected)
-        => Fixture.TestSqlLoggerFactory.AssertBaseline(expected);
-}
diff --git a/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/InProjection/ComplexRelationshipsInProjectionQuerySqlServerTest.cs b/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/InProjection/ComplexRelationshipsInProjectionQuerySqlServerTest.cs
deleted file mode 100644
index e5ece90314..0000000000
--- a/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/InProjection/ComplexRelationshipsInProjectionQuerySqlServerTest.cs
+++ /dev/null
@@ -1,228 +0,0 @@
-﻿// Licensed to the .NET Foundation under one or more agreements.
-// The .NET Foundation licenses this file to you under the MIT license.
-
-namespace Microsoft.EntityFrameworkCore.Query.Relationships.InProjection;
-
-public class ComplexRelationshipsInProjectionQuerySqlServerTest
-    : ComplexRelationshipsInProjectionQueryRelationalTestBase<ComplexRelationshipsQuerySqlServerFixture>
-{
-    public ComplexRelationshipsInProjectionQuerySqlServerTest(ComplexRelationshipsQuerySqlServerFixture fixture, ITestOutputHelper testOutputHelper)
-        : base(fixture)
-    {
-        Fixture.TestSqlLoggerFactory.Clear();
-        Fixture.TestSqlLoggerFactory.SetTestOutputHelper(testOutputHelper);
-    }
-
-    public override async Task Project_everything(bool async)
-    {
-        await base.Project_everything(async);
-
-        AssertSql(
-"""
-SELECT [r].[Id], [r].[Name], [r].[OptionalReferenceTrunkId], [r].[RequiredReferenceTrunkId], [t].[Id], [t].[CollectionRootId], [t].[Name], [t].[OptionalReferenceBranchId], [t].[RequiredReferenceBranchId], [t].[RequiredReferenceBranch_Name], [t].[RequiredReferenceBranch_RequiredReferenceLeaf_Name]
-FROM [RootEntities] AS [r]
-INNER JOIN [TrunkEntities] AS [t] ON [r].[Id] = [t].[Id]
-""");
-    }
-
-    public override async Task Project_root(bool async)
-    {
-        await base.Project_root(async);
-
-        AssertSql(
-            """
-SELECT [r].[Id], [r].[Name], [r].[OptionalReferenceTrunkId], [r].[RequiredReferenceTrunkId]
-FROM [RootEntities] AS [r]
-""");
-    }
-
-    public override async Task Project_trunk_optional(bool async)
-    {
-        await base.Project_trunk_optional(async);
-
-        AssertSql(
-            """
-SELECT [t].[Id], [t].[CollectionRootId], [t].[Name], [t].[OptionalReferenceBranchId], [t].[RequiredReferenceBranchId], [t].[RequiredReferenceBranch_Name], [t].[RequiredReferenceBranch_RequiredReferenceLeaf_Name]
-FROM [RootEntities] AS [r]
-LEFT JOIN [TrunkEntities] AS [t] ON [r].[OptionalReferenceTrunkId] = [t].[Id]
-ORDER BY [r].[Id]
-""");
-    }
-
-    public override async Task Project_trunk_required(bool async)
-    {
-        await base.Project_trunk_required(async);
-
-        AssertSql(
-            """
-SELECT [t].[Id], [t].[CollectionRootId], [t].[Name], [t].[OptionalReferenceBranchId], [t].[RequiredReferenceBranchId], [t].[RequiredReferenceBranch_Name], [t].[RequiredReferenceBranch_RequiredReferenceLeaf_Name]
-FROM [RootEntities] AS [r]
-INNER JOIN [TrunkEntities] AS [t] ON [r].[RequiredReferenceTrunkId] = [t].[Id]
-ORDER BY [r].[Id]
-""");
-    }
-
-    public override async Task Project_trunk_collection(bool async)
-    {
-        await base.Project_trunk_collection(async);
-
-        AssertSql(
-            """
-SELECT [r].[Id], [t].[Id], [t].[CollectionRootId], [t].[Name], [t].[OptionalReferenceBranchId], [t].[RequiredReferenceBranchId], [t].[RequiredReferenceBranch_Name], [t].[RequiredReferenceBranch_RequiredReferenceLeaf_Name]
-FROM [RootEntities] AS [r]
-LEFT JOIN [TrunkEntities] AS [t] ON [r].[Id] = [t].[CollectionRootId]
-ORDER BY [r].[Id]
-""");
-    }
-
-    public override async Task Project_branch_required_required(bool async)
-    {
-        await base.Project_branch_required_required(async);
-
-        AssertSql(
-            """
-SELECT [t].[RequiredReferenceBranch_Name], [t].[RequiredReferenceBranch_RequiredReferenceLeaf_Name]
-FROM [RootEntities] AS [r]
-INNER JOIN [TrunkEntities] AS [t] ON [r].[RequiredReferenceTrunkId] = [t].[Id]
-ORDER BY [r].[Id]
-""");
-    }
-
-    public override async Task Project_branch_required_optional(bool async)
-    {
-        await base.Project_branch_required_optional(async);
-
-        AssertSql();
-    }
-
-    public override async Task Project_branch_required_collection(bool async)
-    {
-        await base.Project_branch_required_collection(async);
-
-        AssertSql();
-    }       
-
-    public override async Task Project_branch_optional_required(bool async)
-    {
-        await base.Project_branch_optional_required(async);
-
-        AssertSql();
-    }
-
-    public override async Task Project_branch_optional_optional(bool async)
-    {
-        await base.Project_branch_optional_optional(async);
-
-        AssertSql();
-    }
-
-    public override async Task Project_branch_optional_collection(bool async)
-    {
-        await base.Project_branch_optional_collection(async);
-
-        AssertSql();
-    }
-
-    public override async Task Project_root_duplicated(bool async)
-    {
-        await base.Project_root_duplicated(async);
-
-        AssertSql(
-            """
-SELECT [r].[Id], [r].[Name], [r].[OptionalReferenceTrunkId], [r].[RequiredReferenceTrunkId]
-FROM [RootEntities] AS [r]
-""");
-    }
-
-    public override async Task Project_trunk_and_branch_duplicated(bool async)
-    {
-        await base.Project_trunk_and_branch_duplicated(async);
-
-        AssertSql();
-    }
-
-    public override async Task Project_trunk_and_trunk_duplicated(bool async)
-    {
-        await base.Project_trunk_and_trunk_duplicated(async);
-
-        AssertSql();
-    }
-
-    public override async Task Project_multiple_branch_leaf(bool async)
-    {
-        await base.Project_multiple_branch_leaf(async);
-
-        AssertSql();
-    }
-
-    public override async Task Project_leaf_trunk_root(bool async)
-    {
-        await base.Project_leaf_trunk_root(async);
-
-        AssertSql(
-            """
-SELECT [t].[RequiredReferenceBranch_RequiredReferenceLeaf_Name], [t].[Id], [t].[CollectionRootId], [t].[Name], [t].[OptionalReferenceBranchId], [t].[RequiredReferenceBranchId], [t].[RequiredReferenceBranch_Name], [r].[Id], [r].[Name], [r].[OptionalReferenceTrunkId], [r].[RequiredReferenceTrunkId]
-FROM [RootEntities] AS [r]
-INNER JOIN [TrunkEntities] AS [t] ON [r].[RequiredReferenceTrunkId] = [t].[Id]
-""");
-    }
-
-    public override async Task Project_subquery_root_set_required_trunk_FirstOrDefault_branch(bool async)
-    {
-        await base.Project_subquery_root_set_required_trunk_FirstOrDefault_branch(async);
-
-        AssertSql();
-    }
-
-    public override async Task Project_subquery_root_set_optional_trunk_FirstOrDefault_branch(bool async)
-    {
-        await base.Project_subquery_root_set_optional_trunk_FirstOrDefault_branch(async);
-
-        AssertSql();
-    }
-
-    public override async Task Project_subquery_root_set_trunk_FirstOrDefault_collection(bool async)
-    {
-        await base.Project_subquery_root_set_trunk_FirstOrDefault_collection(async);
-
-        AssertSql();
-    }
-
-    public override async Task Project_subquery_root_set_complex_projection_including_references_to_outer_FirstOrDefault(bool async)
-    {
-        await base.Project_subquery_root_set_complex_projection_including_references_to_outer_FirstOrDefault(async);
-
-        AssertSql();
-    }
-
-    public override async Task Project_subquery_root_set_complex_projection_FirstOrDefault_project_reference_to_outer(bool async)
-    {
-        await base.Project_subquery_root_set_complex_projection_FirstOrDefault_project_reference_to_outer(async);
-
-        AssertSql();
-    }
-
-    public override async Task SelectMany_trunk_collection(bool async)
-    {
-        await base.SelectMany_trunk_collection(async);
-
-        AssertSql();
-    }
-
-    public override async Task SelectMany_required_trunk_reference_branch_collection(bool async)
-    {
-        await base.SelectMany_required_trunk_reference_branch_collection(async);
-
-        AssertSql();
-    }
-
-    public override async Task SelectMany_optional_trunk_reference_branch_collection(bool async)
-    {
-        await base.SelectMany_optional_trunk_reference_branch_collection(async);
-
-        AssertSql();
-    }
-
-    private void AssertSql(params string[] expected)
-        => Fixture.TestSqlLoggerFactory.AssertBaseline(expected);
-}
diff --git a/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/InProjection/EntityRelationshipsInProjectionNoTrackingQuerySqlServerTest.cs b/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/InProjection/EntityRelationshipsInProjectionNoTrackingQuerySqlServerTest.cs
deleted file mode 100644
index 6bb058ff27..0000000000
--- a/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/InProjection/EntityRelationshipsInProjectionNoTrackingQuerySqlServerTest.cs
+++ /dev/null
@@ -1,404 +0,0 @@
-﻿// Licensed to the .NET Foundation under one or more agreements.
-// The .NET Foundation licenses this file to you under the MIT license.
-
-
-namespace Microsoft.EntityFrameworkCore.Query.Relationships.InProjection;
-
-public class EntityRelationshipsInProjectionNoTrackingQuerySqlServerTest
-    : EntityRelationshipsInProjectionNoTrackingQueryRelationalTestBase<EntityRelationshipsQuerySqlServerFixture>
-{
-    public EntityRelationshipsInProjectionNoTrackingQuerySqlServerTest(EntityRelationshipsQuerySqlServerFixture fixture, ITestOutputHelper testOutputHelper)
-        : base(fixture)
-    {
-        Fixture.TestSqlLoggerFactory.Clear();
-        Fixture.TestSqlLoggerFactory.SetTestOutputHelper(testOutputHelper);
-    }
-
-    public override async Task Project_everything(bool async)
-    {
-        await base.Project_everything(async);
-
-        AssertSql(
-            """
-SELECT [r].[Id], [r].[Name], [r].[OptionalReferenceTrunkId], [r].[RequiredReferenceTrunkId], [t].[Id], [t].[CollectionRootId], [t].[Name], [t].[OptionalReferenceBranchId], [t].[RequiredReferenceBranchId], [b].[Id], [b].[CollectionTrunkId], [b].[Name], [b].[OptionalReferenceLeafId], [b].[RequiredReferenceLeafId], [l].[Id], [l].[CollectionBranchId], [l].[Name]
-FROM [RootEntities] AS [r]
-INNER JOIN [TrunkEntities] AS [t] ON [r].[Id] = [t].[Id]
-INNER JOIN [BranchEntities] AS [b] ON [t].[Id] = [b].[Id]
-INNER JOIN [LeafEntities] AS [l] ON [b].[Id] = [l].[Id]
-""");
-    }
-
-    public override async Task Project_root(bool async)
-    {
-        await base.Project_root(async);
-
-        AssertSql(
-            """
-SELECT [r].[Id], [r].[Name], [r].[OptionalReferenceTrunkId], [r].[RequiredReferenceTrunkId]
-FROM [RootEntities] AS [r]
-""");
-    }
-
-    public override async Task Project_trunk_optional(bool async)
-    {
-        await base.Project_trunk_optional(async);
-
-        AssertSql(
-            """
-SELECT [t].[Id], [t].[CollectionRootId], [t].[Name], [t].[OptionalReferenceBranchId], [t].[RequiredReferenceBranchId]
-FROM [RootEntities] AS [r]
-LEFT JOIN [TrunkEntities] AS [t] ON [r].[OptionalReferenceTrunkId] = [t].[Id]
-ORDER BY [r].[Id]
-""");
-    }
-
-    public override async Task Project_trunk_required(bool async)
-    {
-        await base.Project_trunk_required(async);
-
-        AssertSql(
-            """
-SELECT [t].[Id], [t].[CollectionRootId], [t].[Name], [t].[OptionalReferenceBranchId], [t].[RequiredReferenceBranchId]
-FROM [RootEntities] AS [r]
-INNER JOIN [TrunkEntities] AS [t] ON [r].[RequiredReferenceTrunkId] = [t].[Id]
-ORDER BY [r].[Id]
-""");
-    }
-
-    public override async Task Project_trunk_collection(bool async)
-    {
-        await base.Project_trunk_collection(async);
-        AssertSql(
-            """
-SELECT [r].[Id], [t].[Id], [t].[CollectionRootId], [t].[Name], [t].[OptionalReferenceBranchId], [t].[RequiredReferenceBranchId]
-FROM [RootEntities] AS [r]
-LEFT JOIN [TrunkEntities] AS [t] ON [r].[Id] = [t].[CollectionRootId]
-ORDER BY [r].[Id]
-""");
-    }
-
-    public override async Task Project_branch_required_required(bool async)
-    {
-        await base.Project_branch_required_required(async);
-
-        AssertSql(
-            """
-SELECT [b].[Id], [b].[CollectionTrunkId], [b].[Name], [b].[OptionalReferenceLeafId], [b].[RequiredReferenceLeafId]
-FROM [RootEntities] AS [r]
-INNER JOIN [TrunkEntities] AS [t] ON [r].[RequiredReferenceTrunkId] = [t].[Id]
-INNER JOIN [BranchEntities] AS [b] ON [t].[RequiredReferenceBranchId] = [b].[Id]
-ORDER BY [r].[Id]
-""");
-    }
-
-    public override async Task Project_branch_required_optional(bool async)
-    {
-        await base.Project_branch_required_optional(async);
-
-        AssertSql(
-            """
-SELECT [b].[Id], [b].[CollectionTrunkId], [b].[Name], [b].[OptionalReferenceLeafId], [b].[RequiredReferenceLeafId]
-FROM [RootEntities] AS [r]
-INNER JOIN [TrunkEntities] AS [t] ON [r].[RequiredReferenceTrunkId] = [t].[Id]
-LEFT JOIN [BranchEntities] AS [b] ON [t].[OptionalReferenceBranchId] = [b].[Id]
-ORDER BY [r].[Id]
-""");
-    }
-
-    public override async Task Project_branch_required_collection(bool async)
-    {
-        await base.Project_branch_required_collection(async);
-
-        AssertSql(
-            """
-SELECT [r].[Id], [t].[Id], [b].[Id], [b].[CollectionTrunkId], [b].[Name], [b].[OptionalReferenceLeafId], [b].[RequiredReferenceLeafId]
-FROM [RootEntities] AS [r]
-INNER JOIN [TrunkEntities] AS [t] ON [r].[RequiredReferenceTrunkId] = [t].[Id]
-LEFT JOIN [BranchEntities] AS [b] ON [t].[Id] = [b].[CollectionTrunkId]
-ORDER BY [r].[Id], [t].[Id]
-""");
-    }
-
-    public override async Task Project_branch_optional_required(bool async)
-    {
-        await base.Project_branch_optional_required(async);
-
-        AssertSql(
-            """
-SELECT [b].[Id], [b].[CollectionTrunkId], [b].[Name], [b].[OptionalReferenceLeafId], [b].[RequiredReferenceLeafId]
-FROM [RootEntities] AS [r]
-INNER JOIN [TrunkEntities] AS [t] ON [r].[RequiredReferenceTrunkId] = [t].[Id]
-INNER JOIN [BranchEntities] AS [b] ON [t].[RequiredReferenceBranchId] = [b].[Id]
-ORDER BY [r].[Id]
-""");
-    }
-
-    public override async Task Project_branch_optional_optional(bool async)
-    {
-        await base.Project_branch_optional_optional(async);
-
-        AssertSql(
-            """
-SELECT [b].[Id], [b].[CollectionTrunkId], [b].[Name], [b].[OptionalReferenceLeafId], [b].[RequiredReferenceLeafId]
-FROM [RootEntities] AS [r]
-INNER JOIN [TrunkEntities] AS [t] ON [r].[RequiredReferenceTrunkId] = [t].[Id]
-LEFT JOIN [BranchEntities] AS [b] ON [t].[OptionalReferenceBranchId] = [b].[Id]
-ORDER BY [r].[Id]
-""");
-    }
-
-    public override async Task Project_branch_optional_collection(bool async)
-    {
-        await base.Project_branch_optional_collection(async);
-
-        AssertSql(
-            """
-SELECT [r].[Id], [t].[Id], [b].[Id], [b].[CollectionTrunkId], [b].[Name], [b].[OptionalReferenceLeafId], [b].[RequiredReferenceLeafId]
-FROM [RootEntities] AS [r]
-INNER JOIN [TrunkEntities] AS [t] ON [r].[RequiredReferenceTrunkId] = [t].[Id]
-LEFT JOIN [BranchEntities] AS [b] ON [t].[Id] = [b].[CollectionTrunkId]
-ORDER BY [r].[Id], [t].[Id]
-""");
-    }
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-    public override async Task Project_root_duplicated(bool async)
-    {
-        await base.Project_root_duplicated(async);
-
-        AssertSql(
-            """
-SELECT [r].[Id], [r].[Name], [r].[OptionalReferenceTrunkId], [r].[RequiredReferenceTrunkId]
-FROM [RootEntities] AS [r]
-""");
-    }
-
-    public override async Task Project_trunk_and_branch_duplicated(bool async)
-    {
-        await base.Project_trunk_and_branch_duplicated(async);
-
-        AssertSql(
-            """
-SELECT [t].[Id], [t].[CollectionRootId], [t].[Name], [t].[OptionalReferenceBranchId], [t].[RequiredReferenceBranchId], [b].[Id], [b].[CollectionTrunkId], [b].[Name], [b].[OptionalReferenceLeafId], [b].[RequiredReferenceLeafId]
-FROM [RootEntities] AS [r]
-LEFT JOIN [TrunkEntities] AS [t] ON [r].[OptionalReferenceTrunkId] = [t].[Id]
-LEFT JOIN [BranchEntities] AS [b] ON [t].[RequiredReferenceBranchId] = [b].[Id]
-ORDER BY [r].[Id]
-""");
-    }
-
-    public override async Task Project_trunk_and_trunk_duplicated(bool async)
-    {
-        await base.Project_trunk_and_trunk_duplicated(async);
-
-        AssertSql(
-            """
-SELECT [t].[Id], [t].[CollectionRootId], [t].[Name], [t].[OptionalReferenceBranchId], [t].[RequiredReferenceBranchId], [l].[Id], [l].[CollectionBranchId], [l].[Name]
-FROM [RootEntities] AS [r]
-INNER JOIN [TrunkEntities] AS [t] ON [r].[RequiredReferenceTrunkId] = [t].[Id]
-LEFT JOIN [BranchEntities] AS [b] ON [t].[OptionalReferenceBranchId] = [b].[Id]
-LEFT JOIN [LeafEntities] AS [l] ON [b].[RequiredReferenceLeafId] = [l].[Id]
-ORDER BY [r].[Id]
-""");
-    }
-
-    public override async Task Project_multiple_branch_leaf(bool async)
-    {
-        await base.Project_multiple_branch_leaf(async);
-
-        AssertSql(
-            """
-SELECT [r].[Id], [b].[Id], [b].[CollectionTrunkId], [b].[Name], [b].[OptionalReferenceLeafId], [b].[RequiredReferenceLeafId], [l].[Id], [l].[CollectionBranchId], [l].[Name], [t].[Id], [l0].[Id], [l0].[CollectionBranchId], [l0].[Name], [b0].[Id], [b0].[CollectionTrunkId], [b0].[Name], [b0].[OptionalReferenceLeafId], [b0].[RequiredReferenceLeafId]
-FROM [RootEntities] AS [r]
-INNER JOIN [TrunkEntities] AS [t] ON [r].[RequiredReferenceTrunkId] = [t].[Id]
-INNER JOIN [BranchEntities] AS [b] ON [t].[RequiredReferenceBranchId] = [b].[Id]
-LEFT JOIN [LeafEntities] AS [l] ON [b].[OptionalReferenceLeafId] = [l].[Id]
-LEFT JOIN [LeafEntities] AS [l0] ON [b].[Id] = [l0].[CollectionBranchId]
-LEFT JOIN [BranchEntities] AS [b0] ON [t].[Id] = [b0].[CollectionTrunkId]
-ORDER BY [r].[Id], [t].[Id], [b].[Id], [l].[Id], [l0].[Id]
-""");
-    }
-
-    public override async Task Project_leaf_trunk_root(bool async)
-    {
-        await base.Project_leaf_trunk_root(async);
-
-        AssertSql(
-            """
-SELECT [l].[Id], [l].[CollectionBranchId], [l].[Name], [t].[Id], [t].[CollectionRootId], [t].[Name], [t].[OptionalReferenceBranchId], [t].[RequiredReferenceBranchId], [r].[Id], [r].[Name], [r].[OptionalReferenceTrunkId], [r].[RequiredReferenceTrunkId]
-FROM [RootEntities] AS [r]
-INNER JOIN [TrunkEntities] AS [t] ON [r].[RequiredReferenceTrunkId] = [t].[Id]
-INNER JOIN [BranchEntities] AS [b] ON [t].[RequiredReferenceBranchId] = [b].[Id]
-INNER JOIN [LeafEntities] AS [l] ON [b].[RequiredReferenceLeafId] = [l].[Id]
-""");
-    }
-
-    public override async Task Project_subquery_root_set_required_trunk_FirstOrDefault_branch(bool async)
-    {
-        await base.Project_subquery_root_set_required_trunk_FirstOrDefault_branch(async);
-
-        AssertSql(
-            """
-SELECT [s].[Id], [s].[CollectionTrunkId], [s].[Name], [s].[OptionalReferenceLeafId], [s].[RequiredReferenceLeafId]
-FROM [RootEntities] AS [r]
-OUTER APPLY (
-    SELECT TOP(1) [b].[Id], [b].[CollectionTrunkId], [b].[Name], [b].[OptionalReferenceLeafId], [b].[RequiredReferenceLeafId]
-    FROM [RootEntities] AS [r0]
-    INNER JOIN [TrunkEntities] AS [t] ON [r0].[RequiredReferenceTrunkId] = [t].[Id]
-    INNER JOIN [BranchEntities] AS [b] ON [t].[RequiredReferenceBranchId] = [b].[Id]
-    ORDER BY [r0].[Id]
-) AS [s]
-ORDER BY [r].[Id]
-""");
-    }
-
-    public override async Task Project_subquery_root_set_optional_trunk_FirstOrDefault_branch(bool async)
-    {
-        await base.Project_subquery_root_set_optional_trunk_FirstOrDefault_branch(async);
-
-        AssertSql(
-            """
-SELECT [s].[Id], [s].[CollectionTrunkId], [s].[Name], [s].[OptionalReferenceLeafId], [s].[RequiredReferenceLeafId]
-FROM [RootEntities] AS [r]
-OUTER APPLY (
-    SELECT TOP(1) [b].[Id], [b].[CollectionTrunkId], [b].[Name], [b].[OptionalReferenceLeafId], [b].[RequiredReferenceLeafId]
-    FROM [RootEntities] AS [r0]
-    LEFT JOIN [TrunkEntities] AS [t] ON [r0].[OptionalReferenceTrunkId] = [t].[Id]
-    LEFT JOIN [BranchEntities] AS [b] ON [t].[OptionalReferenceBranchId] = [b].[Id]
-    ORDER BY [r0].[Id]
-) AS [s]
-ORDER BY [r].[Id]
-""");
-    }
-
-    public override async Task Project_subquery_root_set_trunk_FirstOrDefault_collection(bool async)
-    {
-        await base.Project_subquery_root_set_trunk_FirstOrDefault_collection(async);
-
-        AssertSql(
-            """
-SELECT [r].[Id], [s].[Id], [s].[Id0], [b].[Id], [b].[CollectionTrunkId], [b].[Name], [b].[OptionalReferenceLeafId], [b].[RequiredReferenceLeafId], [s].[c]
-FROM [RootEntities] AS [r]
-OUTER APPLY (
-    SELECT TOP(1) 1 AS [c], [r0].[Id], [t].[Id] AS [Id0]
-    FROM [RootEntities] AS [r0]
-    INNER JOIN [TrunkEntities] AS [t] ON [r0].[RequiredReferenceTrunkId] = [t].[Id]
-    ORDER BY [r0].[Id]
-) AS [s]
-LEFT JOIN [BranchEntities] AS [b] ON [s].[Id0] = [b].[CollectionTrunkId]
-ORDER BY [r].[Id], [s].[Id], [s].[Id0]
-""");
-    }
-
-    public override async Task Project_subquery_root_set_complex_projection_including_references_to_outer_FirstOrDefault(bool async)
-    {
-        await base.Project_subquery_root_set_complex_projection_including_references_to_outer_FirstOrDefault(async);
-
-        AssertSql(
-            """
-SELECT [r].[Id], [t].[Id], [b].[Id], [s].[Id1], [s].[Id], [s].[Id0], [b1].[Id], [b1].[CollectionTrunkId], [b1].[Name], [b1].[OptionalReferenceLeafId], [b1].[RequiredReferenceLeafId], [s].[CollectionRootId], [s].[Name], [s].[OptionalReferenceBranchId], [s].[RequiredReferenceBranchId], [s].[CollectionTrunkId], [s].[Name0], [s].[OptionalReferenceLeafId], [s].[RequiredReferenceLeafId], [s].[Name1], [s].[c]
-FROM [RootEntities] AS [r]
-INNER JOIN [TrunkEntities] AS [t] ON [r].[RequiredReferenceTrunkId] = [t].[Id]
-INNER JOIN [BranchEntities] AS [b] ON [t].[RequiredReferenceBranchId] = [b].[Id]
-OUTER APPLY (
-    SELECT TOP(1) [t0].[Id], [t0].[CollectionRootId], [t0].[Name], [t0].[OptionalReferenceBranchId], [t0].[RequiredReferenceBranchId], [b0].[Id] AS [Id0], [b0].[CollectionTrunkId], [b0].[Name] AS [Name0], [b0].[OptionalReferenceLeafId], [b0].[RequiredReferenceLeafId], [b].[Name] AS [Name1], 1 AS [c], [r0].[Id] AS [Id1]
-    FROM [RootEntities] AS [r0]
-    INNER JOIN [TrunkEntities] AS [t0] ON [r0].[RequiredReferenceTrunkId] = [t0].[Id]
-    INNER JOIN [BranchEntities] AS [b0] ON [t0].[RequiredReferenceBranchId] = [b0].[Id]
-    ORDER BY [r0].[Id]
-) AS [s]
-LEFT JOIN [BranchEntities] AS [b1] ON [t].[Id] = [b1].[CollectionTrunkId]
-ORDER BY [r].[Id], [t].[Id], [b].[Id], [s].[Id1], [s].[Id], [s].[Id0]
-""");
-    }
-
-    public override async Task Project_subquery_root_set_complex_projection_FirstOrDefault_project_reference_to_outer(bool async)
-    {
-        await base.Project_subquery_root_set_complex_projection_FirstOrDefault_project_reference_to_outer(async);
-
-        AssertSql(
-            """
-SELECT [r].[Id], [t].[Id], [r1].[Id], [b].[Id], [b].[CollectionTrunkId], [b].[Name], [b].[OptionalReferenceLeafId], [b].[RequiredReferenceLeafId], [r1].[c]
-FROM [RootEntities] AS [r]
-INNER JOIN [TrunkEntities] AS [t] ON [r].[RequiredReferenceTrunkId] = [t].[Id]
-OUTER APPLY (
-    SELECT TOP(1) 1 AS [c], [r0].[Id]
-    FROM [RootEntities] AS [r0]
-    ORDER BY [r0].[Id]
-) AS [r1]
-LEFT JOIN [BranchEntities] AS [b] ON [t].[Id] = [b].[CollectionTrunkId]
-ORDER BY [r].[Id], [t].[Id], [r1].[Id]
-""");
-    }
-
-    public override async Task SelectMany_trunk_collection(bool async)
-    {
-        await base.SelectMany_trunk_collection(async);
-
-        AssertSql(
-            """
-SELECT [t].[Id], [t].[CollectionRootId], [t].[Name], [t].[OptionalReferenceBranchId], [t].[RequiredReferenceBranchId]
-FROM [RootEntities] AS [r]
-INNER JOIN [TrunkEntities] AS [t] ON [r].[Id] = [t].[CollectionRootId]
-""");
-    }
-
-    public override async Task SelectMany_required_trunk_reference_branch_collection(bool async)
-    {
-        await base.SelectMany_required_trunk_reference_branch_collection(async);
-
-        AssertSql(
-            """
-SELECT [b].[Id], [b].[CollectionTrunkId], [b].[Name], [b].[OptionalReferenceLeafId], [b].[RequiredReferenceLeafId]
-FROM [RootEntities] AS [r]
-INNER JOIN [TrunkEntities] AS [t] ON [r].[RequiredReferenceTrunkId] = [t].[Id]
-INNER JOIN [BranchEntities] AS [b] ON [t].[Id] = [b].[CollectionTrunkId]
-""");
-    }
-
-    public override async Task SelectMany_optional_trunk_reference_branch_collection(bool async)
-    {
-        await base.SelectMany_optional_trunk_reference_branch_collection(async);
-
-        AssertSql(
-            """
-SELECT [b].[Id], [b].[CollectionTrunkId], [b].[Name], [b].[OptionalReferenceLeafId], [b].[RequiredReferenceLeafId]
-FROM [RootEntities] AS [r]
-LEFT JOIN [TrunkEntities] AS [t] ON [r].[OptionalReferenceTrunkId] = [t].[Id]
-INNER JOIN [BranchEntities] AS [b] ON [t].[Id] = [b].[CollectionTrunkId]
-""");
-    }
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-    private void AssertSql(params string[] expected)
-        => Fixture.TestSqlLoggerFactory.AssertBaseline(expected);
-}
diff --git a/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/InProjection/EntityRelationshipsInProjectionQuerySqlServerTest.cs b/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/InProjection/EntityRelationshipsInProjectionQuerySqlServerTest.cs
deleted file mode 100644
index 1643ec4e02..0000000000
--- a/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/InProjection/EntityRelationshipsInProjectionQuerySqlServerTest.cs
+++ /dev/null
@@ -1,373 +0,0 @@
-﻿// Licensed to the .NET Foundation under one or more agreements.
-// The .NET Foundation licenses this file to you under the MIT license.
-
-namespace Microsoft.EntityFrameworkCore.Query.Relationships.InProjection;
-
-public class EntityRelationshipsInProjectionQuerySqlServerTest
-    : EntityRelationshipsInProjectionQueryRelationalTestBase<EntityRelationshipsQuerySqlServerFixture>
-{
-    public EntityRelationshipsInProjectionQuerySqlServerTest(EntityRelationshipsQuerySqlServerFixture fixture, ITestOutputHelper testOutputHelper)
-        : base(fixture)
-    {
-        Fixture.TestSqlLoggerFactory.Clear();
-        Fixture.TestSqlLoggerFactory.SetTestOutputHelper(testOutputHelper);
-    }
-
-    public override async Task Project_everything(bool async)
-    {
-        await base.Project_everything(async);
-
-        AssertSql(
-            """
-SELECT [r].[Id], [r].[Name], [r].[OptionalReferenceTrunkId], [r].[RequiredReferenceTrunkId], [t].[Id], [t].[CollectionRootId], [t].[Name], [t].[OptionalReferenceBranchId], [t].[RequiredReferenceBranchId], [b].[Id], [b].[CollectionTrunkId], [b].[Name], [b].[OptionalReferenceLeafId], [b].[RequiredReferenceLeafId], [l].[Id], [l].[CollectionBranchId], [l].[Name]
-FROM [RootEntities] AS [r]
-INNER JOIN [TrunkEntities] AS [t] ON [r].[Id] = [t].[Id]
-INNER JOIN [BranchEntities] AS [b] ON [t].[Id] = [b].[Id]
-INNER JOIN [LeafEntities] AS [l] ON [b].[Id] = [l].[Id]
-""");
-    }
-
-    public override async Task Project_root(bool async)
-    {
-        await base.Project_root(async);
-
-        AssertSql(
-            """
-SELECT [r].[Id], [r].[Name], [r].[OptionalReferenceTrunkId], [r].[RequiredReferenceTrunkId]
-FROM [RootEntities] AS [r]
-""");
-    }
-
-    public override async Task Project_trunk_optional(bool async)
-    {
-        await base.Project_trunk_optional(async);
-
-        AssertSql(
-            """
-SELECT [t].[Id], [t].[CollectionRootId], [t].[Name], [t].[OptionalReferenceBranchId], [t].[RequiredReferenceBranchId]
-FROM [RootEntities] AS [r]
-LEFT JOIN [TrunkEntities] AS [t] ON [r].[OptionalReferenceTrunkId] = [t].[Id]
-ORDER BY [r].[Id]
-""");
-    }
-
-    public override async Task Project_trunk_required(bool async)
-    {
-        await base.Project_trunk_required(async);
-
-        AssertSql(
-            """
-SELECT [t].[Id], [t].[CollectionRootId], [t].[Name], [t].[OptionalReferenceBranchId], [t].[RequiredReferenceBranchId]
-FROM [RootEntities] AS [r]
-INNER JOIN [TrunkEntities] AS [t] ON [r].[RequiredReferenceTrunkId] = [t].[Id]
-ORDER BY [r].[Id]
-""");
-    }
-
-    public override async Task Project_trunk_collection(bool async)
-    {
-        await base.Project_trunk_collection(async);
-
-        AssertSql(
-            """
-SELECT [r].[Id], [t].[Id], [t].[CollectionRootId], [t].[Name], [t].[OptionalReferenceBranchId], [t].[RequiredReferenceBranchId]
-FROM [RootEntities] AS [r]
-LEFT JOIN [TrunkEntities] AS [t] ON [r].[Id] = [t].[CollectionRootId]
-ORDER BY [r].[Id]
-""");
-    }
-
-    public override async Task Project_branch_required_required(bool async)
-    {
-        await base.Project_branch_required_required(async);
-
-        AssertSql(
-"""
-SELECT [b].[Id], [b].[CollectionTrunkId], [b].[Name], [b].[OptionalReferenceLeafId], [b].[RequiredReferenceLeafId]
-FROM [RootEntities] AS [r]
-INNER JOIN [TrunkEntities] AS [t] ON [r].[RequiredReferenceTrunkId] = [t].[Id]
-INNER JOIN [BranchEntities] AS [b] ON [t].[RequiredReferenceBranchId] = [b].[Id]
-ORDER BY [r].[Id]
-""");
-    }
-
-    public override async Task Project_branch_required_optional(bool async)
-    {
-        await base.Project_branch_required_optional(async);
-
-        AssertSql(
-            """
-SELECT [b].[Id], [b].[CollectionTrunkId], [b].[Name], [b].[OptionalReferenceLeafId], [b].[RequiredReferenceLeafId]
-FROM [RootEntities] AS [r]
-INNER JOIN [TrunkEntities] AS [t] ON [r].[RequiredReferenceTrunkId] = [t].[Id]
-LEFT JOIN [BranchEntities] AS [b] ON [t].[OptionalReferenceBranchId] = [b].[Id]
-ORDER BY [r].[Id]
-""");
-    }
-
-    public override async Task Project_branch_required_collection(bool async)
-    {
-        await base.Project_branch_required_collection(async);
-
-        AssertSql(
-            """
-SELECT [r].[Id], [t].[Id], [b].[Id], [b].[CollectionTrunkId], [b].[Name], [b].[OptionalReferenceLeafId], [b].[RequiredReferenceLeafId]
-FROM [RootEntities] AS [r]
-INNER JOIN [TrunkEntities] AS [t] ON [r].[RequiredReferenceTrunkId] = [t].[Id]
-LEFT JOIN [BranchEntities] AS [b] ON [t].[Id] = [b].[CollectionTrunkId]
-ORDER BY [r].[Id], [t].[Id]
-""");
-    }
-
-    public override async Task Project_branch_optional_required(bool async)
-    {
-        await base.Project_branch_optional_required(async);
-
-        AssertSql(
-            """
-SELECT [b].[Id], [b].[CollectionTrunkId], [b].[Name], [b].[OptionalReferenceLeafId], [b].[RequiredReferenceLeafId]
-FROM [RootEntities] AS [r]
-INNER JOIN [TrunkEntities] AS [t] ON [r].[RequiredReferenceTrunkId] = [t].[Id]
-INNER JOIN [BranchEntities] AS [b] ON [t].[RequiredReferenceBranchId] = [b].[Id]
-ORDER BY [r].[Id]
-""");
-    }
-
-    public override async Task Project_branch_optional_optional(bool async)
-    {
-        await base.Project_branch_optional_optional(async);
-
-        AssertSql(
-            """
-SELECT [b].[Id], [b].[CollectionTrunkId], [b].[Name], [b].[OptionalReferenceLeafId], [b].[RequiredReferenceLeafId]
-FROM [RootEntities] AS [r]
-INNER JOIN [TrunkEntities] AS [t] ON [r].[RequiredReferenceTrunkId] = [t].[Id]
-LEFT JOIN [BranchEntities] AS [b] ON [t].[OptionalReferenceBranchId] = [b].[Id]
-ORDER BY [r].[Id]
-""");
-    }
-
-    public override async Task Project_branch_optional_collection(bool async)
-    {
-        await base.Project_branch_optional_collection(async);
-
-        AssertSql(
-            """
-SELECT [r].[Id], [t].[Id], [b].[Id], [b].[CollectionTrunkId], [b].[Name], [b].[OptionalReferenceLeafId], [b].[RequiredReferenceLeafId]
-FROM [RootEntities] AS [r]
-INNER JOIN [TrunkEntities] AS [t] ON [r].[RequiredReferenceTrunkId] = [t].[Id]
-LEFT JOIN [BranchEntities] AS [b] ON [t].[Id] = [b].[CollectionTrunkId]
-ORDER BY [r].[Id], [t].[Id]
-""");
-    }
-
-    public override async Task Project_root_duplicated(bool async)
-    {
-        await base.Project_root_duplicated(async);
-
-        AssertSql(
-            """
-SELECT [r].[Id], [r].[Name], [r].[OptionalReferenceTrunkId], [r].[RequiredReferenceTrunkId]
-FROM [RootEntities] AS [r]
-""");
-    }
-
-    public override async Task Project_trunk_and_branch_duplicated(bool async)
-    {
-        await base.Project_trunk_and_branch_duplicated(async);
-
-        AssertSql(
-            """
-SELECT [t].[Id], [t].[CollectionRootId], [t].[Name], [t].[OptionalReferenceBranchId], [t].[RequiredReferenceBranchId], [b].[Id], [b].[CollectionTrunkId], [b].[Name], [b].[OptionalReferenceLeafId], [b].[RequiredReferenceLeafId]
-FROM [RootEntities] AS [r]
-LEFT JOIN [TrunkEntities] AS [t] ON [r].[OptionalReferenceTrunkId] = [t].[Id]
-LEFT JOIN [BranchEntities] AS [b] ON [t].[RequiredReferenceBranchId] = [b].[Id]
-ORDER BY [r].[Id]
-""");
-    }
-
-    public override async Task Project_trunk_and_trunk_duplicated(bool async)
-    {
-        await base.Project_trunk_and_trunk_duplicated(async);
-
-        AssertSql(
-            """
-SELECT [t].[Id], [t].[CollectionRootId], [t].[Name], [t].[OptionalReferenceBranchId], [t].[RequiredReferenceBranchId], [l].[Id], [l].[CollectionBranchId], [l].[Name]
-FROM [RootEntities] AS [r]
-INNER JOIN [TrunkEntities] AS [t] ON [r].[RequiredReferenceTrunkId] = [t].[Id]
-LEFT JOIN [BranchEntities] AS [b] ON [t].[OptionalReferenceBranchId] = [b].[Id]
-LEFT JOIN [LeafEntities] AS [l] ON [b].[RequiredReferenceLeafId] = [l].[Id]
-ORDER BY [r].[Id]
-""");
-    }
-
-    public override async Task Project_multiple_branch_leaf(bool async)
-    {
-        await base.Project_multiple_branch_leaf(async);
-
-        AssertSql(
-            """
-SELECT [r].[Id], [b].[Id], [b].[CollectionTrunkId], [b].[Name], [b].[OptionalReferenceLeafId], [b].[RequiredReferenceLeafId], [l].[Id], [l].[CollectionBranchId], [l].[Name], [t].[Id], [l0].[Id], [l0].[CollectionBranchId], [l0].[Name], [b0].[Id], [b0].[CollectionTrunkId], [b0].[Name], [b0].[OptionalReferenceLeafId], [b0].[RequiredReferenceLeafId]
-FROM [RootEntities] AS [r]
-INNER JOIN [TrunkEntities] AS [t] ON [r].[RequiredReferenceTrunkId] = [t].[Id]
-INNER JOIN [BranchEntities] AS [b] ON [t].[RequiredReferenceBranchId] = [b].[Id]
-LEFT JOIN [LeafEntities] AS [l] ON [b].[OptionalReferenceLeafId] = [l].[Id]
-LEFT JOIN [LeafEntities] AS [l0] ON [b].[Id] = [l0].[CollectionBranchId]
-LEFT JOIN [BranchEntities] AS [b0] ON [t].[Id] = [b0].[CollectionTrunkId]
-ORDER BY [r].[Id], [t].[Id], [b].[Id], [l].[Id], [l0].[Id]
-""");
-    }
-
-    public override async Task Project_leaf_trunk_root(bool async)
-    {
-        await base.Project_leaf_trunk_root(async);
-
-        AssertSql(
-            """
-SELECT [l].[Id], [l].[CollectionBranchId], [l].[Name], [t].[Id], [t].[CollectionRootId], [t].[Name], [t].[OptionalReferenceBranchId], [t].[RequiredReferenceBranchId], [r].[Id], [r].[Name], [r].[OptionalReferenceTrunkId], [r].[RequiredReferenceTrunkId]
-FROM [RootEntities] AS [r]
-INNER JOIN [TrunkEntities] AS [t] ON [r].[RequiredReferenceTrunkId] = [t].[Id]
-INNER JOIN [BranchEntities] AS [b] ON [t].[RequiredReferenceBranchId] = [b].[Id]
-INNER JOIN [LeafEntities] AS [l] ON [b].[RequiredReferenceLeafId] = [l].[Id]
-""");
-    }
-
-    public override async Task Project_subquery_root_set_required_trunk_FirstOrDefault_branch(bool async)
-    {
-        await base.Project_subquery_root_set_required_trunk_FirstOrDefault_branch(async);
-
-        AssertSql(
-            """
-SELECT [s].[Id], [s].[CollectionTrunkId], [s].[Name], [s].[OptionalReferenceLeafId], [s].[RequiredReferenceLeafId]
-FROM [RootEntities] AS [r]
-OUTER APPLY (
-    SELECT TOP(1) [b].[Id], [b].[CollectionTrunkId], [b].[Name], [b].[OptionalReferenceLeafId], [b].[RequiredReferenceLeafId]
-    FROM [RootEntities] AS [r0]
-    INNER JOIN [TrunkEntities] AS [t] ON [r0].[RequiredReferenceTrunkId] = [t].[Id]
-    INNER JOIN [BranchEntities] AS [b] ON [t].[RequiredReferenceBranchId] = [b].[Id]
-    ORDER BY [r0].[Id]
-) AS [s]
-ORDER BY [r].[Id]
-""");
-    }
-
-    public override async Task Project_subquery_root_set_optional_trunk_FirstOrDefault_branch(bool async)
-    {
-        await base.Project_subquery_root_set_optional_trunk_FirstOrDefault_branch(async);
-
-        AssertSql(
-            """
-SELECT [s].[Id], [s].[CollectionTrunkId], [s].[Name], [s].[OptionalReferenceLeafId], [s].[RequiredReferenceLeafId]
-FROM [RootEntities] AS [r]
-OUTER APPLY (
-    SELECT TOP(1) [b].[Id], [b].[CollectionTrunkId], [b].[Name], [b].[OptionalReferenceLeafId], [b].[RequiredReferenceLeafId]
-    FROM [RootEntities] AS [r0]
-    LEFT JOIN [TrunkEntities] AS [t] ON [r0].[OptionalReferenceTrunkId] = [t].[Id]
-    LEFT JOIN [BranchEntities] AS [b] ON [t].[OptionalReferenceBranchId] = [b].[Id]
-    ORDER BY [r0].[Id]
-) AS [s]
-ORDER BY [r].[Id]
-""");
-    }
-
-    public override async Task Project_subquery_root_set_trunk_FirstOrDefault_collection(bool async)
-    {
-        await base.Project_subquery_root_set_trunk_FirstOrDefault_collection(async);
-
-        AssertSql(
-            """
-SELECT [r].[Id], [s].[Id], [s].[Id0], [b].[Id], [b].[CollectionTrunkId], [b].[Name], [b].[OptionalReferenceLeafId], [b].[RequiredReferenceLeafId], [s].[c]
-FROM [RootEntities] AS [r]
-OUTER APPLY (
-    SELECT TOP(1) 1 AS [c], [r0].[Id], [t].[Id] AS [Id0]
-    FROM [RootEntities] AS [r0]
-    INNER JOIN [TrunkEntities] AS [t] ON [r0].[RequiredReferenceTrunkId] = [t].[Id]
-    ORDER BY [r0].[Id]
-) AS [s]
-LEFT JOIN [BranchEntities] AS [b] ON [s].[Id0] = [b].[CollectionTrunkId]
-ORDER BY [r].[Id], [s].[Id], [s].[Id0]
-""");
-    }
-
-    public override async Task Project_subquery_root_set_complex_projection_including_references_to_outer_FirstOrDefault(bool async)
-    {
-        await base.Project_subquery_root_set_complex_projection_including_references_to_outer_FirstOrDefault(async);
-
-        AssertSql(
-            """
-SELECT [r].[Id], [t].[Id], [b].[Id], [s].[Id1], [s].[Id], [s].[Id0], [b1].[Id], [b1].[CollectionTrunkId], [b1].[Name], [b1].[OptionalReferenceLeafId], [b1].[RequiredReferenceLeafId], [s].[CollectionRootId], [s].[Name], [s].[OptionalReferenceBranchId], [s].[RequiredReferenceBranchId], [s].[CollectionTrunkId], [s].[Name0], [s].[OptionalReferenceLeafId], [s].[RequiredReferenceLeafId], [s].[Name1], [s].[c]
-FROM [RootEntities] AS [r]
-INNER JOIN [TrunkEntities] AS [t] ON [r].[RequiredReferenceTrunkId] = [t].[Id]
-INNER JOIN [BranchEntities] AS [b] ON [t].[RequiredReferenceBranchId] = [b].[Id]
-OUTER APPLY (
-    SELECT TOP(1) [t0].[Id], [t0].[CollectionRootId], [t0].[Name], [t0].[OptionalReferenceBranchId], [t0].[RequiredReferenceBranchId], [b0].[Id] AS [Id0], [b0].[CollectionTrunkId], [b0].[Name] AS [Name0], [b0].[OptionalReferenceLeafId], [b0].[RequiredReferenceLeafId], [b].[Name] AS [Name1], 1 AS [c], [r0].[Id] AS [Id1]
-    FROM [RootEntities] AS [r0]
-    INNER JOIN [TrunkEntities] AS [t0] ON [r0].[RequiredReferenceTrunkId] = [t0].[Id]
-    INNER JOIN [BranchEntities] AS [b0] ON [t0].[RequiredReferenceBranchId] = [b0].[Id]
-    ORDER BY [r0].[Id]
-) AS [s]
-LEFT JOIN [BranchEntities] AS [b1] ON [t].[Id] = [b1].[CollectionTrunkId]
-ORDER BY [r].[Id], [t].[Id], [b].[Id], [s].[Id1], [s].[Id], [s].[Id0]
-""");
-    }
-
-    public override async Task Project_subquery_root_set_complex_projection_FirstOrDefault_project_reference_to_outer(bool async)
-    {
-        await base.Project_subquery_root_set_complex_projection_FirstOrDefault_project_reference_to_outer(async);
-
-        AssertSql(
-            """
-SELECT [r].[Id], [t].[Id], [r1].[Id], [b].[Id], [b].[CollectionTrunkId], [b].[Name], [b].[OptionalReferenceLeafId], [b].[RequiredReferenceLeafId], [r1].[c]
-FROM [RootEntities] AS [r]
-INNER JOIN [TrunkEntities] AS [t] ON [r].[RequiredReferenceTrunkId] = [t].[Id]
-OUTER APPLY (
-    SELECT TOP(1) 1 AS [c], [r0].[Id]
-    FROM [RootEntities] AS [r0]
-    ORDER BY [r0].[Id]
-) AS [r1]
-LEFT JOIN [BranchEntities] AS [b] ON [t].[Id] = [b].[CollectionTrunkId]
-ORDER BY [r].[Id], [t].[Id], [r1].[Id]
-""");
-    }
-
-    public override async Task SelectMany_trunk_collection(bool async)
-    {
-        await base.SelectMany_trunk_collection(async);
-
-        AssertSql(
-            """
-SELECT [t].[Id], [t].[CollectionRootId], [t].[Name], [t].[OptionalReferenceBranchId], [t].[RequiredReferenceBranchId]
-FROM [RootEntities] AS [r]
-INNER JOIN [TrunkEntities] AS [t] ON [r].[Id] = [t].[CollectionRootId]
-""");
-    }
-
-    public override async Task SelectMany_required_trunk_reference_branch_collection(bool async)
-    {
-        await base.SelectMany_required_trunk_reference_branch_collection(async);
-
-        AssertSql(
-            """
-SELECT [b].[Id], [b].[CollectionTrunkId], [b].[Name], [b].[OptionalReferenceLeafId], [b].[RequiredReferenceLeafId]
-FROM [RootEntities] AS [r]
-INNER JOIN [TrunkEntities] AS [t] ON [r].[RequiredReferenceTrunkId] = [t].[Id]
-INNER JOIN [BranchEntities] AS [b] ON [t].[Id] = [b].[CollectionTrunkId]
-""");
-    }
-
-    public override async Task SelectMany_optional_trunk_reference_branch_collection(bool async)
-    {
-        await base.SelectMany_optional_trunk_reference_branch_collection(async);
-
-        AssertSql(
-            """
-SELECT [b].[Id], [b].[CollectionTrunkId], [b].[Name], [b].[OptionalReferenceLeafId], [b].[RequiredReferenceLeafId]
-FROM [RootEntities] AS [r]
-LEFT JOIN [TrunkEntities] AS [t] ON [r].[OptionalReferenceTrunkId] = [t].[Id]
-INNER JOIN [BranchEntities] AS [b] ON [t].[Id] = [b].[CollectionTrunkId]
-""");
-    }
-
-    private void AssertSql(params string[] expected)
-        => Fixture.TestSqlLoggerFactory.AssertBaseline(expected);
-}
diff --git a/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/InProjection/JsonRelationshipsInProjectionNoTrackingQuerySqlServerTest.cs b/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/InProjection/JsonRelationshipsInProjectionNoTrackingQuerySqlServerTest.cs
deleted file mode 100644
index 932374e6b5..0000000000
--- a/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/InProjection/JsonRelationshipsInProjectionNoTrackingQuerySqlServerTest.cs
+++ /dev/null
@@ -1,371 +0,0 @@
-﻿// Licensed to the .NET Foundation under one or more agreements.
-// The .NET Foundation licenses this file to you under the MIT license.
-
-namespace Microsoft.EntityFrameworkCore.Query.Relationships.InProjection;
-
-public class JsonRelationshipsInProjectionNoTrackingQuerySqlServerTest
-    : JsonRelationshipsInProjectionNoTrackingQueryRelationalTestBase<JsonRelationshipsQuerySqlServerFixture>
-{
-    public JsonRelationshipsInProjectionNoTrackingQuerySqlServerTest(JsonRelationshipsQuerySqlServerFixture fixture, ITestOutputHelper testOutputHelper)
-        : base(fixture)
-    {
-        Fixture.TestSqlLoggerFactory.Clear();
-        Fixture.TestSqlLoggerFactory.SetTestOutputHelper(testOutputHelper);
-    }
-
-    public override async Task Project_root(bool async)
-    {
-        await base.Project_root(async);
-
-        AssertSql(
-"""
-SELECT [r].[Id], [r].[Name], [r].[OptionalReferenceTrunkId], [r].[RequiredReferenceTrunkId], [r].[CollectionTrunk], [r].[OptionalReferenceTrunk], [r].[RequiredReferenceTrunk]
-FROM [RootEntities] AS [r]
-""");
-    }
-
-    public override async Task Project_trunk_optional(bool async)
-    {
-        await base.Project_trunk_optional(async);
-
-        AssertSql(
-            """
-SELECT [r].[OptionalReferenceTrunk], [r].[Id]
-FROM [RootEntities] AS [r]
-ORDER BY [r].[Id]
-""");
-    }
-
-    public override async Task Project_trunk_required(bool async)
-    {
-        await base.Project_trunk_required(async);
-
-        AssertSql(
-            """
-SELECT [r].[RequiredReferenceTrunk], [r].[Id]
-FROM [RootEntities] AS [r]
-ORDER BY [r].[Id]
-""");
-    }
-
-    public override async Task Project_trunk_collection(bool async)
-    {
-        await base.Project_trunk_collection(async);
-
-        AssertSql(
-            """
-SELECT [r].[CollectionTrunk], [r].[Id]
-FROM [RootEntities] AS [r]
-ORDER BY [r].[Id]
-""");
-    }
-
-    public override async Task Project_branch_required_required(bool async)
-    {
-        await base.Project_branch_required_required(async);
-
-        AssertSql(
-            """
-SELECT JSON_QUERY([r].[RequiredReferenceTrunk], '$.RequiredReferenceBranch'), [r].[Id]
-FROM [RootEntities] AS [r]
-ORDER BY [r].[Id]
-""");
-    }
-
-    public override async Task Project_branch_required_optional(bool async)
-    {
-        await base.Project_branch_required_optional(async);
-
-        AssertSql(
-            """
-SELECT JSON_QUERY([r].[RequiredReferenceTrunk], '$.OptionalReferenceBranch'), [r].[Id]
-FROM [RootEntities] AS [r]
-ORDER BY [r].[Id]
-""");
-    }
-
-    public override async Task Project_branch_required_collection(bool async)
-    {
-        await base.Project_branch_required_collection(async);
-
-        AssertSql(
-            """
-SELECT JSON_QUERY([r].[RequiredReferenceTrunk], '$.CollectionBranch'), [r].[Id]
-FROM [RootEntities] AS [r]
-ORDER BY [r].[Id]
-""");
-    }
-
-    public override async Task Project_branch_optional_required(bool async)
-    {
-        await base.Project_branch_optional_required(async);
-
-        AssertSql(
-            """
-SELECT JSON_QUERY([r].[RequiredReferenceTrunk], '$.RequiredReferenceBranch'), [r].[Id]
-FROM [RootEntities] AS [r]
-ORDER BY [r].[Id]
-""");
-    }
-
-    public override async Task Project_branch_optional_optional(bool async)
-    {
-        await base.Project_branch_optional_optional(async);
-
-        AssertSql(
-            """
-SELECT JSON_QUERY([r].[RequiredReferenceTrunk], '$.OptionalReferenceBranch'), [r].[Id]
-FROM [RootEntities] AS [r]
-ORDER BY [r].[Id]
-""");
-    }
-
-    public override async Task Project_branch_optional_collection(bool async)
-    {
-        await base.Project_branch_optional_collection(async);
-
-        AssertSql(
-            """
-SELECT JSON_QUERY([r].[RequiredReferenceTrunk], '$.CollectionBranch'), [r].[Id]
-FROM [RootEntities] AS [r]
-ORDER BY [r].[Id]
-""");
-    }
-
-
-
-
-
-
-
-
-
-
-
-    public override async Task Project_root_duplicated(bool async)
-    {
-        await base.Project_root_duplicated(async);
-
-        AssertSql(
-            """
-SELECT [r].[Id], [r].[Name], [r].[OptionalReferenceTrunkId], [r].[RequiredReferenceTrunkId], [r].[CollectionTrunk], [r].[OptionalReferenceTrunk], [r].[RequiredReferenceTrunk], [r].[CollectionTrunk], [r].[OptionalReferenceTrunk], [r].[RequiredReferenceTrunk]
-FROM [RootEntities] AS [r]
-""");
-    }
-
-    public override async Task Project_trunk_and_branch_duplicated(bool async)
-    {
-        await base.Project_trunk_and_branch_duplicated(async);
-
-        AssertSql(
-            """
-SELECT [r].[OptionalReferenceTrunk], [r].[Id], JSON_QUERY([r].[OptionalReferenceTrunk], '$.RequiredReferenceBranch'), [r].[OptionalReferenceTrunk], JSON_QUERY([r].[OptionalReferenceTrunk], '$.RequiredReferenceBranch')
-FROM [RootEntities] AS [r]
-ORDER BY [r].[Id]
-""");
-    }
-
-    public override async Task Project_trunk_and_trunk_duplicated(bool async)
-    {
-        await base.Project_trunk_and_trunk_duplicated(async);
-
-        AssertSql(
-            """
-SELECT [r].[RequiredReferenceTrunk], [r].[Id], JSON_QUERY([r].[RequiredReferenceTrunk], '$.OptionalReferenceBranch.RequiredReferenceLeaf'), [r].[RequiredReferenceTrunk], JSON_QUERY([r].[RequiredReferenceTrunk], '$.OptionalReferenceBranch.RequiredReferenceLeaf')
-FROM [RootEntities] AS [r]
-ORDER BY [r].[Id]
-""");
-    }
-
-    public override async Task Project_multiple_branch_leaf(bool async)
-    {
-        await base.Project_multiple_branch_leaf(async);
-
-        AssertSql(
-            """
-SELECT [r].[Id], JSON_QUERY([r].[RequiredReferenceTrunk], '$.RequiredReferenceBranch'), JSON_QUERY([r].[RequiredReferenceTrunk], '$.RequiredReferenceBranch.OptionalReferenceLeaf'), JSON_QUERY([r].[RequiredReferenceTrunk], '$.RequiredReferenceBranch.CollectionLeaf'), JSON_QUERY([r].[RequiredReferenceTrunk], '$.CollectionBranch'), JSON_VALUE([r].[RequiredReferenceTrunk], '$.RequiredReferenceBranch.OptionalReferenceLeaf.Name')
-FROM [RootEntities] AS [r]
-""");
-    }
-
-    public override async Task Project_leaf_trunk_root(bool async)
-    {
-        await base.Project_leaf_trunk_root(async);
-
-        AssertSql(
-            """
-SELECT JSON_QUERY([r].[RequiredReferenceTrunk], '$.RequiredReferenceBranch.RequiredReferenceLeaf'), [r].[Id], [r].[RequiredReferenceTrunk], [r].[Name], [r].[OptionalReferenceTrunkId], [r].[RequiredReferenceTrunkId], [r].[CollectionTrunk], [r].[OptionalReferenceTrunk], [r].[RequiredReferenceTrunk]
-FROM [RootEntities] AS [r]
-""");
-    }
-
-    public override async Task Project_subquery_root_set_required_trunk_FirstOrDefault_branch(bool async)
-    {
-        await base.Project_subquery_root_set_required_trunk_FirstOrDefault_branch(async);
-
-        AssertSql(
-            """
-SELECT [r1].[c], [r1].[Id]
-FROM [RootEntities] AS [r]
-OUTER APPLY (
-    SELECT TOP(1) JSON_QUERY([r0].[RequiredReferenceTrunk], '$.RequiredReferenceBranch') AS [c], [r0].[Id]
-    FROM [RootEntities] AS [r0]
-    ORDER BY [r0].[Id]
-) AS [r1]
-ORDER BY [r].[Id]
-""");
-    }
-
-    public override async Task Project_subquery_root_set_optional_trunk_FirstOrDefault_branch(bool async)
-    {
-        await base.Project_subquery_root_set_optional_trunk_FirstOrDefault_branch(async);
-
-        AssertSql(
-            """
-SELECT [r1].[c], [r1].[Id]
-FROM [RootEntities] AS [r]
-OUTER APPLY (
-    SELECT TOP(1) JSON_QUERY([r0].[OptionalReferenceTrunk], '$.OptionalReferenceBranch') AS [c], [r0].[Id]
-    FROM [RootEntities] AS [r0]
-    ORDER BY [r0].[Id]
-) AS [r1]
-ORDER BY [r].[Id]
-""");
-    }
-
-    public override async Task Project_subquery_root_set_trunk_FirstOrDefault_collection(bool async)
-    {
-        await base.Project_subquery_root_set_trunk_FirstOrDefault_collection(async);
-
-        AssertSql(
-            """
-SELECT [r1].[c], [r1].[Id], [r1].[c0]
-FROM [RootEntities] AS [r]
-OUTER APPLY (
-    SELECT TOP(1) JSON_QUERY([r0].[RequiredReferenceTrunk], '$.CollectionBranch') AS [c], [r0].[Id], 1 AS [c0]
-    FROM [RootEntities] AS [r0]
-    ORDER BY [r0].[Id]
-) AS [r1]
-ORDER BY [r].[Id]
-""");
-    }
-
-    public override async Task Project_subquery_root_set_complex_projection_including_references_to_outer_FirstOrDefault(bool async)
-    {
-        await base.Project_subquery_root_set_complex_projection_including_references_to_outer_FirstOrDefault(async);
-
-        AssertSql(
-            """
-SELECT [r1].[c], [r1].[Id], [r1].[c0], [r1].[Id0], [r1].[c1], [r1].[c2], [r1].[c3], [r1].[c4]
-FROM [RootEntities] AS [r]
-OUTER APPLY (
-    SELECT TOP(1) JSON_QUERY([r].[RequiredReferenceTrunk], '$.CollectionBranch') AS [c], [r].[Id], [r0].[RequiredReferenceTrunk] AS [c0], [r0].[Id] AS [Id0], JSON_QUERY([r0].[RequiredReferenceTrunk], '$.RequiredReferenceBranch') AS [c1], JSON_VALUE([r0].[RequiredReferenceTrunk], '$.Name') AS [c2], JSON_VALUE([r].[RequiredReferenceTrunk], '$.RequiredReferenceBranch.Name') AS [c3], 1 AS [c4]
-    FROM [RootEntities] AS [r0]
-    ORDER BY [r0].[Id]
-) AS [r1]
-ORDER BY [r].[Id]
-""");
-    }
-
-    public override async Task Project_subquery_root_set_complex_projection_FirstOrDefault_project_reference_to_outer(bool async)
-    {
-        await base.Project_subquery_root_set_complex_projection_FirstOrDefault_project_reference_to_outer(async);
-
-        AssertSql(
-            """
-SELECT [r1].[c], [r1].[Id], [r1].[c0]
-FROM [RootEntities] AS [r]
-OUTER APPLY (
-    SELECT TOP(1) JSON_QUERY([r].[RequiredReferenceTrunk], '$.CollectionBranch') AS [c], [r].[Id], 1 AS [c0]
-    FROM [RootEntities] AS [r0]
-    ORDER BY [r0].[Id]
-) AS [r1]
-ORDER BY [r].[Id]
-""");
-    }
-
-    public override async Task SelectMany_trunk_collection(bool async)
-    {
-        await base.SelectMany_trunk_collection(async);
-
-        AssertSql(
-            """
-SELECT [r].[Id], [c].[Name], [c].[CollectionBranch], [c].[OptionalReferenceBranch], [c].[RequiredReferenceBranch]
-FROM [RootEntities] AS [r]
-CROSS APPLY OPENJSON([r].[CollectionTrunk], '$') WITH (
-    [Name] nvarchar(max) '$.Name',
-    [CollectionBranch] nvarchar(max) '$.CollectionBranch' AS JSON,
-    [OptionalReferenceBranch] nvarchar(max) '$.OptionalReferenceBranch' AS JSON,
-    [RequiredReferenceBranch] nvarchar(max) '$.RequiredReferenceBranch' AS JSON
-) AS [c]
-""");
-    }
-
-    public override async Task SelectMany_required_trunk_reference_branch_collection(bool async)
-    {
-        await base.SelectMany_required_trunk_reference_branch_collection(async);
-
-        AssertSql(
-            """
-SELECT [r].[Id], [c].[Name], [c].[CollectionLeaf], [c].[OptionalReferenceLeaf], [c].[RequiredReferenceLeaf]
-FROM [RootEntities] AS [r]
-CROSS APPLY OPENJSON([r].[RequiredReferenceTrunk], '$.CollectionBranch') WITH (
-    [Name] nvarchar(max) '$.Name',
-    [CollectionLeaf] nvarchar(max) '$.CollectionLeaf' AS JSON,
-    [OptionalReferenceLeaf] nvarchar(max) '$.OptionalReferenceLeaf' AS JSON,
-    [RequiredReferenceLeaf] nvarchar(max) '$.RequiredReferenceLeaf' AS JSON
-) AS [c]
-""");
-    }
-
-    public override async Task SelectMany_optional_trunk_reference_branch_collection(bool async)
-    {
-        await base.SelectMany_optional_trunk_reference_branch_collection(async);
-
-        AssertSql(
-            """
-SELECT [r].[Id], [c].[Name], [c].[CollectionLeaf], [c].[OptionalReferenceLeaf], [c].[RequiredReferenceLeaf]
-FROM [RootEntities] AS [r]
-CROSS APPLY OPENJSON([r].[OptionalReferenceTrunk], '$.CollectionBranch') WITH (
-    [Name] nvarchar(max) '$.Name',
-    [CollectionLeaf] nvarchar(max) '$.CollectionLeaf' AS JSON,
-    [OptionalReferenceLeaf] nvarchar(max) '$.OptionalReferenceLeaf' AS JSON,
-    [RequiredReferenceLeaf] nvarchar(max) '$.RequiredReferenceLeaf' AS JSON
-) AS [c]
-""");
-    }
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-    private void AssertSql(params string[] expected)
-        => Fixture.TestSqlLoggerFactory.AssertBaseline(expected);
-}
diff --git a/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/InProjection/JsonRelationshipsInProjectionQuerySqlServerTest.cs b/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/InProjection/JsonRelationshipsInProjectionQuerySqlServerTest.cs
deleted file mode 100644
index dc5b5ab10e..0000000000
--- a/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/InProjection/JsonRelationshipsInProjectionQuerySqlServerTest.cs
+++ /dev/null
@@ -1,148 +0,0 @@
-﻿// Licensed to the .NET Foundation under one or more agreements.
-// The .NET Foundation licenses this file to you under the MIT license.
-
-namespace Microsoft.EntityFrameworkCore.Query.Relationships.InProjection;
-
-public class JsonRelationshipsInProjectionQuerySqlServerTest
-    : JsonRelationshipsInProjectionQueryRelationalTestBase<JsonRelationshipsQuerySqlServerFixture>
-{
-    public JsonRelationshipsInProjectionQuerySqlServerTest(JsonRelationshipsQuerySqlServerFixture fixture, ITestOutputHelper testOutputHelper)
-        : base(fixture)
-    {
-        Fixture.TestSqlLoggerFactory.Clear();
-        Fixture.TestSqlLoggerFactory.SetTestOutputHelper(testOutputHelper);
-    }
-
-    public override async Task Project_root(bool async)
-    {
-        await base.Project_root(async);
-
-        AssertSql(
-"""
-SELECT [r].[Id], [r].[Name], [r].[OptionalReferenceTrunkId], [r].[RequiredReferenceTrunkId], [r].[CollectionTrunk], [r].[OptionalReferenceTrunk], [r].[RequiredReferenceTrunk]
-FROM [RootEntities] AS [r]
-""");
-    }
-
-    public override async Task Project_root_duplicated(bool async)
-    {
-        await base.Project_root_duplicated(async);
-
-        AssertSql(
-            """
-SELECT [r].[Id], [r].[Name], [r].[OptionalReferenceTrunkId], [r].[RequiredReferenceTrunkId], [r].[CollectionTrunk], [r].[OptionalReferenceTrunk], [r].[RequiredReferenceTrunk], [r].[CollectionTrunk], [r].[OptionalReferenceTrunk], [r].[RequiredReferenceTrunk]
-FROM [RootEntities] AS [r]
-""");
-    }
-
-    public override Task Project_trunk_optional(bool async)
-        => AssertCantTrackJson(() => base.Project_trunk_optional(async));
-
-    public override Task Project_trunk_required(bool async)
-        => AssertCantTrackJson(() => base.Project_trunk_required(async));
-
-    public override Task Project_trunk_collection(bool async)
-        => AssertCantTrackJson(() => base.Project_trunk_collection(async));
-
-    public override Task Project_branch_required_required(bool async)
-        => AssertCantTrackJson(() => base.Project_branch_required_required(async));
-
-    public override Task Project_branch_required_optional(bool async)
-        => AssertCantTrackJson(() => base.Project_branch_required_optional(async));
-
-    public override Task Project_branch_required_collection(bool async)
-        => AssertCantTrackJson(() => base.Project_branch_required_collection(async));
-
-    public override  Task Project_branch_optional_required(bool async)
-        => AssertCantTrackJson(() => base.Project_branch_optional_required(async));
-
-    public override Task Project_branch_optional_optional(bool async)
-        => AssertCantTrackJson(() => base.Project_branch_optional_optional(async));
-
-    public override Task Project_branch_optional_collection(bool async)
-        => AssertCantTrackJson(() => base.Project_branch_optional_collection(async));
-
-    public override Task Project_branch_collection_element_using_indexer_constant(bool async)
-        => AssertCantTrackJson(() => base.Project_branch_collection_element_using_indexer_constant(async));
-
-
-
-
-
-
-
-
-
-
-
-
-
-    public override Task Project_trunk_and_branch_duplicated(bool async)
-        => AssertCantTrackJson(() => base.Project_trunk_and_branch_duplicated(async));
-
-    public override Task Project_trunk_and_trunk_duplicated(bool async)
-        => AssertCantTrackJson(() => base.Project_trunk_and_trunk_duplicated(async));
-
-    public override Task Project_multiple_branch_leaf(bool async)
-        => AssertCantTrackJson(() => base.Project_multiple_branch_leaf(async));
-
-    public override Task Project_leaf_trunk_root(bool async)
-        => AssertCantTrackJson(() => base.Project_leaf_trunk_root(async));
-
-    public override Task Project_subquery_root_set_required_trunk_FirstOrDefault_branch(bool async)
-        => AssertCantTrackJson(() => base.Project_subquery_root_set_required_trunk_FirstOrDefault_branch(async));
-
-    public override Task Project_subquery_root_set_optional_trunk_FirstOrDefault_branch(bool async)
-        => AssertCantTrackJson(() => base.Project_subquery_root_set_optional_trunk_FirstOrDefault_branch(async));
-
-    public override Task Project_subquery_root_set_trunk_FirstOrDefault_collection(bool async)
-        => AssertCantTrackJson(() => base.Project_subquery_root_set_trunk_FirstOrDefault_collection(async));
-
-    public override Task Project_subquery_root_set_complex_projection_including_references_to_outer_FirstOrDefault(bool async)
-        => AssertCantTrackJson(() => base.Project_subquery_root_set_complex_projection_including_references_to_outer_FirstOrDefault(async));
-
-    public override Task Project_subquery_root_set_complex_projection_FirstOrDefault_project_reference_to_outer(bool async)
-        => AssertCantTrackJson(() => base.Project_subquery_root_set_complex_projection_FirstOrDefault_project_reference_to_outer(async));
-
-    public override Task SelectMany_trunk_collection(bool async)
-        => AssertCantTrackJson(() => base.SelectMany_trunk_collection(async));
-
-    public override Task SelectMany_required_trunk_reference_branch_collection(bool async)
-        => AssertCantTrackJson(() => base.SelectMany_required_trunk_reference_branch_collection(async));
-
-    public override Task SelectMany_optional_trunk_reference_branch_collection(bool async)
-        => AssertCantTrackJson(() => base.SelectMany_optional_trunk_reference_branch_collection(async));
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-    private async Task AssertCantTrackJson(Func<Task> test)
-    {
-        var message = (await Assert.ThrowsAsync<InvalidOperationException>(test)).Message;
-
-        Assert.Equal(RelationalStrings.JsonEntityOrCollectionProjectedAtRootLevelInTrackingQuery("AsNoTracking"), message);
-        AssertSql();
-    }
-
-    private void AssertSql(params string[] expected)
-        => Fixture.TestSqlLoggerFactory.AssertBaseline(expected);
-}
diff --git a/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/InProjection/JsonTypeRelationshipsInProjectionNoTrackingQuerySqlServerTest.cs b/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/InProjection/JsonTypeRelationshipsInProjectionNoTrackingQuerySqlServerTest.cs
deleted file mode 100644
index 8b0050ca09..0000000000
--- a/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/InProjection/JsonTypeRelationshipsInProjectionNoTrackingQuerySqlServerTest.cs
+++ /dev/null
@@ -1,26 +0,0 @@
-﻿// Licensed to the .NET Foundation under one or more agreements.
-// The .NET Foundation licenses this file to you under the MIT license.
-
-namespace Microsoft.EntityFrameworkCore.Query.Relationships.InProjection;
-
-// Only adding NoTracking version - no point to do both and most of the tests don't work in tracking (projecting without owner)
-[SqlServerCondition(SqlServerCondition.SupportsJsonType)]
-public class JsonTypeRelationshipsInProjectionNoTrackingQuerySqlServerTest
-    : RelationshipsInProjectionQueryTestBase<JsonTypeRelationshipsQuerySqlServerFixture>
-{
-    private readonly NoTrackingRewriter _noTrackingRewriter = new();
-
-    public JsonTypeRelationshipsInProjectionNoTrackingQuerySqlServerTest(JsonTypeRelationshipsQuerySqlServerFixture fixture, ITestOutputHelper testOutputHelper)
-        : base(fixture)
-    {
-        Fixture.TestSqlLoggerFactory.Clear();
-        Fixture.TestSqlLoggerFactory.SetTestOutputHelper(testOutputHelper);
-    }
-
-    protected override Expression RewriteServerQueryExpression(Expression serverQueryExpression)
-    {
-        var rewritten = _noTrackingRewriter.Visit(serverQueryExpression);
-
-        return rewritten;
-    }
-}
diff --git a/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/Include/EntityRelationshipsIncludeQuerySqlServerTest.cs b/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/Include/NavigationIncludeSqlServerTest.cs
similarity index 76%
rename from test/EFCore.SqlServer.FunctionalTests/Query/Relationships/Include/EntityRelationshipsIncludeQuerySqlServerTest.cs
rename to test/EFCore.SqlServer.FunctionalTests/Query/Relationships/Include/NavigationIncludeSqlServerTest.cs
index 1f9cdf7b05..ef862de22d 100644
--- a/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/Include/EntityRelationshipsIncludeQuerySqlServerTest.cs
+++ b/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/Include/NavigationIncludeSqlServerTest.cs
@@ -3,10 +3,10 @@
 
 namespace Microsoft.EntityFrameworkCore.Query.Relationships.Include;
 
-public class EntityRelationshipsIncludeQuerySqlServerTest
-    : EntityRelationshipsIncludeQueryRelationalTestBase<EntityRelationshipsQuerySqlServerFixture>
+public class NavigationIncludeSqlServerTest
+    : NavigationIncludeRelationalTestBase<NavigationRelationshipsSqlServerFixture>
 {
-    public EntityRelationshipsIncludeQuerySqlServerTest(EntityRelationshipsQuerySqlServerFixture fixture, ITestOutputHelper testOutputHelper)
+    public NavigationIncludeSqlServerTest(NavigationRelationshipsSqlServerFixture fixture, ITestOutputHelper testOutputHelper)
         : base(fixture)
     {
         Fixture.TestSqlLoggerFactory.Clear();
diff --git a/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/OwnedRelationshipsQuerySqlServerFixture.cs b/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/NavigationRelationshipsSqlServerFixture.cs
similarity index 77%
rename from test/EFCore.SqlServer.FunctionalTests/Query/Relationships/OwnedRelationshipsQuerySqlServerFixture.cs
rename to test/EFCore.SqlServer.FunctionalTests/Query/Relationships/NavigationRelationshipsSqlServerFixture.cs
index 22f1b54995..47a2c9349a 100644
--- a/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/OwnedRelationshipsQuerySqlServerFixture.cs
+++ b/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/NavigationRelationshipsSqlServerFixture.cs
@@ -3,7 +3,7 @@
 
 namespace Microsoft.EntityFrameworkCore.Query.Relationships;
 
-public class OwnedRelationshipsQuerySqlServerFixture : OwnedRelationshipsQueryRelationalFixtureBase, ITestSqlLoggerFactory
+public class NavigationRelationshipsSqlServerFixture : NavigationRelationshipsRelationalFixtureBase, ITestSqlLoggerFactory
 {
     protected override ITestStoreFactory TestStoreFactory
         => SqlServerTestStoreFactory.Instance;
diff --git a/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/EntityRelationshipsQuerySqlServerFixture.cs b/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/OwnedJsonRelationshipsSqlServerFixture.cs
similarity index 76%
rename from test/EFCore.SqlServer.FunctionalTests/Query/Relationships/EntityRelationshipsQuerySqlServerFixture.cs
rename to test/EFCore.SqlServer.FunctionalTests/Query/Relationships/OwnedJsonRelationshipsSqlServerFixture.cs
index aa7473ea62..bcba194e65 100644
--- a/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/EntityRelationshipsQuerySqlServerFixture.cs
+++ b/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/OwnedJsonRelationshipsSqlServerFixture.cs
@@ -3,7 +3,7 @@
 
 namespace Microsoft.EntityFrameworkCore.Query.Relationships;
 
-public class EntityRelationshipsQuerySqlServerFixture : EntityRelationshipsQueryRelationalFixtureBase, ITestSqlLoggerFactory
+public class OwnedJsonRelationshipsSqlServerFixture : OwnedJsonRelationshipsRelationalFixtureBase, ITestSqlLoggerFactory
 {
     protected override ITestStoreFactory TestStoreFactory
         => SqlServerTestStoreFactory.Instance;
diff --git a/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/JsonTypeRelationshipsQuerySqlServerFixture.cs b/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/OwnedJsonTypeRelationshipsSqlServerFixture.cs
similarity index 91%
rename from test/EFCore.SqlServer.FunctionalTests/Query/Relationships/JsonTypeRelationshipsQuerySqlServerFixture.cs
rename to test/EFCore.SqlServer.FunctionalTests/Query/Relationships/OwnedJsonTypeRelationshipsSqlServerFixture.cs
index 15761fb918..71a9d380ec 100644
--- a/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/JsonTypeRelationshipsQuerySqlServerFixture.cs
+++ b/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/OwnedJsonTypeRelationshipsSqlServerFixture.cs
@@ -5,7 +5,7 @@
 
 namespace Microsoft.EntityFrameworkCore.Query.Relationships;
 
-public class JsonTypeRelationshipsQuerySqlServerFixture : JsonRelationshipsQueryRelationalFixtureBase, ITestSqlLoggerFactory
+public class OwnedJsonTypeRelationshipsSqlServerFixture : OwnedJsonRelationshipsRelationalFixtureBase, ITestSqlLoggerFactory
 {
     protected override string StoreName => "JsonTypeRelationshipsQueryTest";
 
diff --git a/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/ComplexRelationshipsQuerySqlServerFixture.cs b/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/OwnedRelationshipsSqlServerFixture.cs
similarity index 76%
rename from test/EFCore.SqlServer.FunctionalTests/Query/Relationships/ComplexRelationshipsQuerySqlServerFixture.cs
rename to test/EFCore.SqlServer.FunctionalTests/Query/Relationships/OwnedRelationshipsSqlServerFixture.cs
index 62fb66d474..35ebf765e0 100644
--- a/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/ComplexRelationshipsQuerySqlServerFixture.cs
+++ b/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/OwnedRelationshipsSqlServerFixture.cs
@@ -3,7 +3,7 @@
 
 namespace Microsoft.EntityFrameworkCore.Query.Relationships;
 
-public class ComplexRelationshipsQuerySqlServerFixture : ComplexRelationshipsQueryRelationalFixtureBase, ITestSqlLoggerFactory
+public class OwnedRelationshipsSqlServerFixture : OwnedRelationshipsRelationalFixtureBase, ITestSqlLoggerFactory
 {
     protected override ITestStoreFactory TestStoreFactory
         => SqlServerTestStoreFactory.Instance;
diff --git a/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/OwnedTableSplittingRelationshipsSqlServerFixture.cs b/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/OwnedTableSplittingRelationshipsSqlServerFixture.cs
new file mode 100644
index 0000000000..bfabcce47a
--- /dev/null
+++ b/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/OwnedTableSplittingRelationshipsSqlServerFixture.cs
@@ -0,0 +1,13 @@
+﻿// Licensed to the .NET Foundation under one or more agreements.
+// The .NET Foundation licenses this file to you under the MIT license.
+
+namespace Microsoft.EntityFrameworkCore.Query.Relationships;
+
+public class OwnedTableSplittingRelationshipsSqlServerFixture : OwnedTableSplittingRelationshipsRelationalFixtureBase, ITestSqlLoggerFactory
+{
+    protected override ITestStoreFactory TestStoreFactory
+        => SqlServerTestStoreFactory.Instance;
+
+    public TestSqlLoggerFactory TestSqlLoggerFactory
+        => (TestSqlLoggerFactory)ListLoggerFactory;
+}
diff --git a/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/Projection/ComplexNoTrackingProjectionSqlServerTest.cs b/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/Projection/ComplexNoTrackingProjectionSqlServerTest.cs
new file mode 100644
index 0000000000..89a259a421
--- /dev/null
+++ b/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/Projection/ComplexNoTrackingProjectionSqlServerTest.cs
@@ -0,0 +1,152 @@
+﻿// Licensed to the .NET Foundation under one or more agreements.
+// The .NET Foundation licenses this file to you under the MIT license.
+
+namespace Microsoft.EntityFrameworkCore.Query.Relationships.Projection;
+
+public class ComplexNoTrackingProjectionSqlServerTest
+    : ComplexNoTrackingProjectionRelationalTestBase<ComplexRelationshipsSqlServerFixture>
+{
+    public ComplexNoTrackingProjectionSqlServerTest(ComplexRelationshipsSqlServerFixture fixture, ITestOutputHelper testOutputHelper)
+        : base(fixture)
+    {
+        Fixture.TestSqlLoggerFactory.Clear();
+        Fixture.TestSqlLoggerFactory.SetTestOutputHelper(testOutputHelper);
+    }
+
+    public override async Task Select_everything(bool async)
+    {
+        await base.Select_everything(async);
+
+        AssertSql(
+"""
+SELECT [r].[Id], [r].[Name], [r].[OptionalReferenceTrunkId], [r].[RequiredReferenceTrunkId], [t].[Id], [t].[CollectionRootId], [t].[Name], [t].[OptionalReferenceBranchId], [t].[RequiredReferenceBranchId], [t].[RequiredReferenceBranch_Name], [t].[RequiredReferenceBranch_RequiredReferenceLeaf_Name]
+FROM [RootEntities] AS [r]
+INNER JOIN [TrunkEntities] AS [t] ON [r].[Id] = [t].[Id]
+""");
+    }
+
+    public override async Task Select_root(bool async)
+    {
+        await base.Select_root(async);
+
+        AssertSql(
+            """
+SELECT [r].[Id], [r].[Name], [r].[OptionalReferenceTrunkId], [r].[RequiredReferenceTrunkId]
+FROM [RootEntities] AS [r]
+""");
+    }
+
+    public override async Task Select_trunk_optional(bool async)
+    {
+        await base.Select_trunk_optional(async);
+
+        AssertSql(
+            """
+SELECT [t].[Id], [t].[CollectionRootId], [t].[Name], [t].[OptionalReferenceBranchId], [t].[RequiredReferenceBranchId], [t].[RequiredReferenceBranch_Name], [t].[RequiredReferenceBranch_RequiredReferenceLeaf_Name]
+FROM [RootEntities] AS [r]
+LEFT JOIN [TrunkEntities] AS [t] ON [r].[OptionalReferenceTrunkId] = [t].[Id]
+ORDER BY [r].[Id]
+""");
+    }
+
+    public override async Task Select_trunk_required(bool async)
+    {
+        await base.Select_trunk_required(async);
+
+        AssertSql(
+            """
+SELECT [t].[Id], [t].[CollectionRootId], [t].[Name], [t].[OptionalReferenceBranchId], [t].[RequiredReferenceBranchId], [t].[RequiredReferenceBranch_Name], [t].[RequiredReferenceBranch_RequiredReferenceLeaf_Name]
+FROM [RootEntities] AS [r]
+INNER JOIN [TrunkEntities] AS [t] ON [r].[RequiredReferenceTrunkId] = [t].[Id]
+ORDER BY [r].[Id]
+""");
+    }
+
+    public override async Task Select_branch_required_required(bool async)
+    {
+        await base.Select_branch_required_required(async);
+
+        AssertSql(
+            """
+SELECT [t].[RequiredReferenceBranch_Name], [t].[RequiredReferenceBranch_RequiredReferenceLeaf_Name]
+FROM [RootEntities] AS [r]
+INNER JOIN [TrunkEntities] AS [t] ON [r].[RequiredReferenceTrunkId] = [t].[Id]
+ORDER BY [r].[Id]
+""");
+    }
+
+    public override async Task Select_branch_required_optional(bool async)
+    {
+        await base.Select_branch_required_optional(async);
+
+        AssertSql();
+    }
+
+    public override async Task Select_branch_optional_required(bool async)
+    {
+        await base.Select_branch_optional_required(async);
+
+        AssertSql();
+    }
+
+    public override async Task Select_branch_optional_optional(bool async)
+    {
+        await base.Select_branch_optional_optional(async);
+
+        AssertSql();
+    }
+
+    public override async Task Select_root_duplicated(bool async)
+    {
+        await base.Select_root_duplicated(async);
+
+        AssertSql(
+            """
+SELECT [r].[Id], [r].[Name], [r].[OptionalReferenceTrunkId], [r].[RequiredReferenceTrunkId]
+FROM [RootEntities] AS [r]
+""");
+    }
+
+    public override async Task Select_trunk_and_branch_duplicated(bool async)
+    {
+        await base.Select_trunk_and_branch_duplicated(async);
+
+        AssertSql();
+    }
+
+    public override async Task Select_trunk_and_trunk_duplicated(bool async)
+    {
+        await base.Select_trunk_and_trunk_duplicated(async);
+
+        AssertSql();
+    }
+
+    public override async Task Select_leaf_trunk_root(bool async)
+    {
+        await base.Select_leaf_trunk_root(async);
+
+        AssertSql(
+            """
+SELECT [t].[RequiredReferenceBranch_RequiredReferenceLeaf_Name], [t].[Id], [t].[CollectionRootId], [t].[Name], [t].[OptionalReferenceBranchId], [t].[RequiredReferenceBranchId], [t].[RequiredReferenceBranch_Name], [r].[Id], [r].[Name], [r].[OptionalReferenceTrunkId], [r].[RequiredReferenceTrunkId]
+FROM [RootEntities] AS [r]
+INNER JOIN [TrunkEntities] AS [t] ON [r].[RequiredReferenceTrunkId] = [t].[Id]
+""");
+    }
+
+    public override async Task Select_subquery_root_set_required_trunk_FirstOrDefault_branch(bool async)
+    {
+        await base.Select_subquery_root_set_required_trunk_FirstOrDefault_branch(async);
+
+        AssertSql();
+    }
+
+    public override async Task Select_subquery_root_set_optional_trunk_FirstOrDefault_branch(bool async)
+    {
+        await base.Select_subquery_root_set_optional_trunk_FirstOrDefault_branch(async);
+
+        AssertSql();
+    }
+
+    private void AssertSql(params string[] expected)
+        => Fixture.TestSqlLoggerFactory.AssertBaseline(expected);
+}
diff --git a/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/Projection/ComplexProjectionSqlServerTest.cs b/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/Projection/ComplexProjectionSqlServerTest.cs
new file mode 100644
index 0000000000..b9ae5113d9
--- /dev/null
+++ b/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/Projection/ComplexProjectionSqlServerTest.cs
@@ -0,0 +1,152 @@
+﻿// Licensed to the .NET Foundation under one or more agreements.
+// The .NET Foundation licenses this file to you under the MIT license.
+
+namespace Microsoft.EntityFrameworkCore.Query.Relationships.Projection;
+
+public class ComplexProjectionSqlServerTest
+    : ComplexProjectionRelationalTestBase<ComplexRelationshipsSqlServerFixture>
+{
+    public ComplexProjectionSqlServerTest(ComplexRelationshipsSqlServerFixture fixture, ITestOutputHelper testOutputHelper)
+        : base(fixture)
+    {
+        Fixture.TestSqlLoggerFactory.Clear();
+        Fixture.TestSqlLoggerFactory.SetTestOutputHelper(testOutputHelper);
+    }
+
+    public override async Task Select_everything(bool async)
+    {
+        await base.Select_everything(async);
+
+        AssertSql(
+"""
+SELECT [r].[Id], [r].[Name], [r].[OptionalReferenceTrunkId], [r].[RequiredReferenceTrunkId], [t].[Id], [t].[CollectionRootId], [t].[Name], [t].[OptionalReferenceBranchId], [t].[RequiredReferenceBranchId], [t].[RequiredReferenceBranch_Name], [t].[RequiredReferenceBranch_RequiredReferenceLeaf_Name]
+FROM [RootEntities] AS [r]
+INNER JOIN [TrunkEntities] AS [t] ON [r].[Id] = [t].[Id]
+""");
+    }
+
+    public override async Task Select_root(bool async)
+    {
+        await base.Select_root(async);
+
+        AssertSql(
+            """
+SELECT [r].[Id], [r].[Name], [r].[OptionalReferenceTrunkId], [r].[RequiredReferenceTrunkId]
+FROM [RootEntities] AS [r]
+""");
+    }
+
+    public override async Task Select_trunk_optional(bool async)
+    {
+        await base.Select_trunk_optional(async);
+
+        AssertSql(
+            """
+SELECT [t].[Id], [t].[CollectionRootId], [t].[Name], [t].[OptionalReferenceBranchId], [t].[RequiredReferenceBranchId], [t].[RequiredReferenceBranch_Name], [t].[RequiredReferenceBranch_RequiredReferenceLeaf_Name]
+FROM [RootEntities] AS [r]
+LEFT JOIN [TrunkEntities] AS [t] ON [r].[OptionalReferenceTrunkId] = [t].[Id]
+ORDER BY [r].[Id]
+""");
+    }
+
+    public override async Task Select_trunk_required(bool async)
+    {
+        await base.Select_trunk_required(async);
+
+        AssertSql(
+            """
+SELECT [t].[Id], [t].[CollectionRootId], [t].[Name], [t].[OptionalReferenceBranchId], [t].[RequiredReferenceBranchId], [t].[RequiredReferenceBranch_Name], [t].[RequiredReferenceBranch_RequiredReferenceLeaf_Name]
+FROM [RootEntities] AS [r]
+INNER JOIN [TrunkEntities] AS [t] ON [r].[RequiredReferenceTrunkId] = [t].[Id]
+ORDER BY [r].[Id]
+""");
+    }
+
+    public override async Task Select_branch_required_required(bool async)
+    {
+        await base.Select_branch_required_required(async);
+
+        AssertSql(
+            """
+SELECT [t].[RequiredReferenceBranch_Name], [t].[RequiredReferenceBranch_RequiredReferenceLeaf_Name]
+FROM [RootEntities] AS [r]
+INNER JOIN [TrunkEntities] AS [t] ON [r].[RequiredReferenceTrunkId] = [t].[Id]
+ORDER BY [r].[Id]
+""");
+    }
+
+    public override async Task Select_branch_required_optional(bool async)
+    {
+        await base.Select_branch_required_optional(async);
+
+        AssertSql();
+    }
+
+    public override async Task Select_branch_optional_required(bool async)
+    {
+        await base.Select_branch_optional_required(async);
+
+        AssertSql();
+    }
+
+    public override async Task Select_branch_optional_optional(bool async)
+    {
+        await base.Select_branch_optional_optional(async);
+
+        AssertSql();
+    }
+
+    public override async Task Select_root_duplicated(bool async)
+    {
+        await base.Select_root_duplicated(async);
+
+        AssertSql(
+            """
+SELECT [r].[Id], [r].[Name], [r].[OptionalReferenceTrunkId], [r].[RequiredReferenceTrunkId]
+FROM [RootEntities] AS [r]
+""");
+    }
+
+    public override async Task Select_trunk_and_branch_duplicated(bool async)
+    {
+        await base.Select_trunk_and_branch_duplicated(async);
+
+        AssertSql();
+    }
+
+    public override async Task Select_trunk_and_trunk_duplicated(bool async)
+    {
+        await base.Select_trunk_and_trunk_duplicated(async);
+
+        AssertSql();
+    }
+
+    public override async Task Select_leaf_trunk_root(bool async)
+    {
+        await base.Select_leaf_trunk_root(async);
+
+        AssertSql(
+            """
+SELECT [t].[RequiredReferenceBranch_RequiredReferenceLeaf_Name], [t].[Id], [t].[CollectionRootId], [t].[Name], [t].[OptionalReferenceBranchId], [t].[RequiredReferenceBranchId], [t].[RequiredReferenceBranch_Name], [r].[Id], [r].[Name], [r].[OptionalReferenceTrunkId], [r].[RequiredReferenceTrunkId]
+FROM [RootEntities] AS [r]
+INNER JOIN [TrunkEntities] AS [t] ON [r].[RequiredReferenceTrunkId] = [t].[Id]
+""");
+    }
+
+    public override async Task Select_subquery_root_set_required_trunk_FirstOrDefault_branch(bool async)
+    {
+        await base.Select_subquery_root_set_required_trunk_FirstOrDefault_branch(async);
+
+        AssertSql();
+    }
+
+    public override async Task Select_subquery_root_set_optional_trunk_FirstOrDefault_branch(bool async)
+    {
+        await base.Select_subquery_root_set_optional_trunk_FirstOrDefault_branch(async);
+
+        AssertSql();
+    }
+
+    private void AssertSql(params string[] expected)
+        => Fixture.TestSqlLoggerFactory.AssertBaseline(expected);
+}
diff --git a/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/Projection/NavigationNoTrackingProjectionSqlServerTest.cs b/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/Projection/NavigationNoTrackingProjectionSqlServerTest.cs
new file mode 100644
index 0000000000..6953a4c074
--- /dev/null
+++ b/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/Projection/NavigationNoTrackingProjectionSqlServerTest.cs
@@ -0,0 +1,188 @@
+﻿// Licensed to the .NET Foundation under one or more agreements.
+// The .NET Foundation licenses this file to you under the MIT license.
+
+
+namespace Microsoft.EntityFrameworkCore.Query.Relationships.Projection;
+
+public class NavigationNoTrackingProjectionSqlServerTest
+    : NavigationNoTrackingProjectionRelationalTestBase<NavigationRelationshipsSqlServerFixture>
+{
+    public NavigationNoTrackingProjectionSqlServerTest(NavigationRelationshipsSqlServerFixture fixture, ITestOutputHelper testOutputHelper)
+        : base(fixture)
+    {
+        Fixture.TestSqlLoggerFactory.Clear();
+        Fixture.TestSqlLoggerFactory.SetTestOutputHelper(testOutputHelper);
+    }
+
+    public override async Task Select_everything_using_joins(bool async)
+    {
+        await base.Select_everything_using_joins(async);
+
+        AssertSql(
+            """
+SELECT [r].[Id], [r].[Name], [r].[OptionalReferenceTrunkId], [r].[RequiredReferenceTrunkId], [t].[Id], [t].[CollectionRootId], [t].[Name], [t].[OptionalReferenceBranchId], [t].[RequiredReferenceBranchId], [b].[Id], [b].[CollectionTrunkId], [b].[Name], [b].[OptionalReferenceLeafId], [b].[RequiredReferenceLeafId], [l].[Id], [l].[CollectionBranchId], [l].[Name]
+FROM [RootEntities] AS [r]
+INNER JOIN [TrunkEntities] AS [t] ON [r].[Id] = [t].[Id]
+INNER JOIN [BranchEntities] AS [b] ON [t].[Id] = [b].[Id]
+INNER JOIN [LeafEntities] AS [l] ON [b].[Id] = [l].[Id]
+""");
+    }
+
+    public override async Task Select_trunk_collection(bool async)
+    {
+        await base.Select_trunk_collection(async);
+        AssertSql(
+            """
+SELECT [r].[Id], [t].[Id], [t].[CollectionRootId], [t].[Name], [t].[OptionalReferenceBranchId], [t].[RequiredReferenceBranchId]
+FROM [RootEntities] AS [r]
+LEFT JOIN [TrunkEntities] AS [t] ON [r].[Id] = [t].[CollectionRootId]
+ORDER BY [r].[Id]
+""");
+    }
+
+    public override async Task Select_branch_required_collection(bool async)
+    {
+        await base.Select_branch_required_collection(async);
+
+        AssertSql(
+            """
+SELECT [r].[Id], [t].[Id], [b].[Id], [b].[CollectionTrunkId], [b].[Name], [b].[OptionalReferenceLeafId], [b].[RequiredReferenceLeafId]
+FROM [RootEntities] AS [r]
+INNER JOIN [TrunkEntities] AS [t] ON [r].[RequiredReferenceTrunkId] = [t].[Id]
+LEFT JOIN [BranchEntities] AS [b] ON [t].[Id] = [b].[CollectionTrunkId]
+ORDER BY [r].[Id], [t].[Id]
+""");
+    }
+
+    public override async Task Select_branch_optional_collection(bool async)
+    {
+        await base.Select_branch_optional_collection(async);
+
+        AssertSql(
+            """
+SELECT [r].[Id], [t].[Id], [b].[Id], [b].[CollectionTrunkId], [b].[Name], [b].[OptionalReferenceLeafId], [b].[RequiredReferenceLeafId]
+FROM [RootEntities] AS [r]
+INNER JOIN [TrunkEntities] AS [t] ON [r].[RequiredReferenceTrunkId] = [t].[Id]
+LEFT JOIN [BranchEntities] AS [b] ON [t].[Id] = [b].[CollectionTrunkId]
+ORDER BY [r].[Id], [t].[Id]
+""");
+    }
+
+    public override async Task Select_multiple_branch_leaf(bool async)
+    {
+        await base.Select_multiple_branch_leaf(async);
+
+        AssertSql(
+            """
+SELECT [r].[Id], [b].[Id], [b].[CollectionTrunkId], [b].[Name], [b].[OptionalReferenceLeafId], [b].[RequiredReferenceLeafId], [l].[Id], [l].[CollectionBranchId], [l].[Name], [t].[Id], [l0].[Id], [l0].[CollectionBranchId], [l0].[Name], [b0].[Id], [b0].[CollectionTrunkId], [b0].[Name], [b0].[OptionalReferenceLeafId], [b0].[RequiredReferenceLeafId]
+FROM [RootEntities] AS [r]
+INNER JOIN [TrunkEntities] AS [t] ON [r].[RequiredReferenceTrunkId] = [t].[Id]
+INNER JOIN [BranchEntities] AS [b] ON [t].[RequiredReferenceBranchId] = [b].[Id]
+LEFT JOIN [LeafEntities] AS [l] ON [b].[OptionalReferenceLeafId] = [l].[Id]
+LEFT JOIN [LeafEntities] AS [l0] ON [b].[Id] = [l0].[CollectionBranchId]
+LEFT JOIN [BranchEntities] AS [b0] ON [t].[Id] = [b0].[CollectionTrunkId]
+ORDER BY [r].[Id], [t].[Id], [b].[Id], [l].[Id], [l0].[Id]
+""");
+    }
+
+    public override async Task Select_subquery_root_set_trunk_FirstOrDefault_collection(bool async)
+    {
+        await base.Select_subquery_root_set_trunk_FirstOrDefault_collection(async);
+
+        AssertSql(
+            """
+SELECT [r].[Id], [s].[Id], [s].[Id0], [b].[Id], [b].[CollectionTrunkId], [b].[Name], [b].[OptionalReferenceLeafId], [b].[RequiredReferenceLeafId], [s].[c]
+FROM [RootEntities] AS [r]
+OUTER APPLY (
+    SELECT TOP(1) 1 AS [c], [r0].[Id], [t].[Id] AS [Id0]
+    FROM [RootEntities] AS [r0]
+    INNER JOIN [TrunkEntities] AS [t] ON [r0].[RequiredReferenceTrunkId] = [t].[Id]
+    ORDER BY [r0].[Id]
+) AS [s]
+LEFT JOIN [BranchEntities] AS [b] ON [s].[Id0] = [b].[CollectionTrunkId]
+ORDER BY [r].[Id], [s].[Id], [s].[Id0]
+""");
+    }
+
+    public override async Task Select_subquery_root_set_complex_projection_including_references_to_outer_FirstOrDefault(bool async)
+    {
+        await base.Select_subquery_root_set_complex_projection_including_references_to_outer_FirstOrDefault(async);
+
+        AssertSql(
+            """
+SELECT [r].[Id], [t].[Id], [b].[Id], [s].[Id1], [s].[Id], [s].[Id0], [b1].[Id], [b1].[CollectionTrunkId], [b1].[Name], [b1].[OptionalReferenceLeafId], [b1].[RequiredReferenceLeafId], [s].[CollectionRootId], [s].[Name], [s].[OptionalReferenceBranchId], [s].[RequiredReferenceBranchId], [s].[CollectionTrunkId], [s].[Name0], [s].[OptionalReferenceLeafId], [s].[RequiredReferenceLeafId], [s].[Name1], [s].[c]
+FROM [RootEntities] AS [r]
+INNER JOIN [TrunkEntities] AS [t] ON [r].[RequiredReferenceTrunkId] = [t].[Id]
+INNER JOIN [BranchEntities] AS [b] ON [t].[RequiredReferenceBranchId] = [b].[Id]
+OUTER APPLY (
+    SELECT TOP(1) [t0].[Id], [t0].[CollectionRootId], [t0].[Name], [t0].[OptionalReferenceBranchId], [t0].[RequiredReferenceBranchId], [b0].[Id] AS [Id0], [b0].[CollectionTrunkId], [b0].[Name] AS [Name0], [b0].[OptionalReferenceLeafId], [b0].[RequiredReferenceLeafId], [b].[Name] AS [Name1], 1 AS [c], [r0].[Id] AS [Id1]
+    FROM [RootEntities] AS [r0]
+    INNER JOIN [TrunkEntities] AS [t0] ON [r0].[RequiredReferenceTrunkId] = [t0].[Id]
+    INNER JOIN [BranchEntities] AS [b0] ON [t0].[RequiredReferenceBranchId] = [b0].[Id]
+    ORDER BY [r0].[Id]
+) AS [s]
+LEFT JOIN [BranchEntities] AS [b1] ON [t].[Id] = [b1].[CollectionTrunkId]
+ORDER BY [r].[Id], [t].[Id], [b].[Id], [s].[Id1], [s].[Id], [s].[Id0]
+""");
+    }
+
+    public override async Task Select_subquery_root_set_complex_projection_FirstOrDefault_project_reference_to_outer(bool async)
+    {
+        await base.Select_subquery_root_set_complex_projection_FirstOrDefault_project_reference_to_outer(async);
+
+        AssertSql(
+            """
+SELECT [r].[Id], [t].[Id], [r1].[Id], [b].[Id], [b].[CollectionTrunkId], [b].[Name], [b].[OptionalReferenceLeafId], [b].[RequiredReferenceLeafId], [r1].[c]
+FROM [RootEntities] AS [r]
+INNER JOIN [TrunkEntities] AS [t] ON [r].[RequiredReferenceTrunkId] = [t].[Id]
+OUTER APPLY (
+    SELECT TOP(1) 1 AS [c], [r0].[Id]
+    FROM [RootEntities] AS [r0]
+    ORDER BY [r0].[Id]
+) AS [r1]
+LEFT JOIN [BranchEntities] AS [b] ON [t].[Id] = [b].[CollectionTrunkId]
+ORDER BY [r].[Id], [t].[Id], [r1].[Id]
+""");
+    }
+
+    public override async Task SelectMany_trunk_collection(bool async)
+    {
+        await base.SelectMany_trunk_collection(async);
+
+        AssertSql(
+            """
+SELECT [t].[Id], [t].[CollectionRootId], [t].[Name], [t].[OptionalReferenceBranchId], [t].[RequiredReferenceBranchId]
+FROM [RootEntities] AS [r]
+INNER JOIN [TrunkEntities] AS [t] ON [r].[Id] = [t].[CollectionRootId]
+""");
+    }
+
+    public override async Task SelectMany_required_trunk_reference_branch_collection(bool async)
+    {
+        await base.SelectMany_required_trunk_reference_branch_collection(async);
+
+        AssertSql(
+            """
+SELECT [b].[Id], [b].[CollectionTrunkId], [b].[Name], [b].[OptionalReferenceLeafId], [b].[RequiredReferenceLeafId]
+FROM [RootEntities] AS [r]
+INNER JOIN [TrunkEntities] AS [t] ON [r].[RequiredReferenceTrunkId] = [t].[Id]
+INNER JOIN [BranchEntities] AS [b] ON [t].[Id] = [b].[CollectionTrunkId]
+""");
+    }
+
+    public override async Task SelectMany_optional_trunk_reference_branch_collection(bool async)
+    {
+        await base.SelectMany_optional_trunk_reference_branch_collection(async);
+
+        AssertSql(
+            """
+SELECT [b].[Id], [b].[CollectionTrunkId], [b].[Name], [b].[OptionalReferenceLeafId], [b].[RequiredReferenceLeafId]
+FROM [RootEntities] AS [r]
+LEFT JOIN [TrunkEntities] AS [t] ON [r].[OptionalReferenceTrunkId] = [t].[Id]
+INNER JOIN [BranchEntities] AS [b] ON [t].[Id] = [b].[CollectionTrunkId]
+""");
+    }
+
+    private void AssertSql(params string[] expected)
+        => Fixture.TestSqlLoggerFactory.AssertBaseline(expected);
+}
diff --git a/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/Projection/NavigationProjectionSqlServerTest.cs b/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/Projection/NavigationProjectionSqlServerTest.cs
new file mode 100644
index 0000000000..75d62b063f
--- /dev/null
+++ b/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/Projection/NavigationProjectionSqlServerTest.cs
@@ -0,0 +1,188 @@
+﻿// Licensed to the .NET Foundation under one or more agreements.
+// The .NET Foundation licenses this file to you under the MIT license.
+
+namespace Microsoft.EntityFrameworkCore.Query.Relationships.Projection;
+
+public class NavigationProjectionSqlServerTest
+    : NavigationProjectionRelationalTestBase<NavigationRelationshipsSqlServerFixture>
+{
+    public NavigationProjectionSqlServerTest(NavigationRelationshipsSqlServerFixture fixture, ITestOutputHelper testOutputHelper)
+        : base(fixture)
+    {
+        Fixture.TestSqlLoggerFactory.Clear();
+        Fixture.TestSqlLoggerFactory.SetTestOutputHelper(testOutputHelper);
+    }
+
+    public override async Task Select_everything_using_joins(bool async)
+    {
+        await base.Select_everything_using_joins(async);
+
+        AssertSql(
+            """
+SELECT [r].[Id], [r].[Name], [r].[OptionalReferenceTrunkId], [r].[RequiredReferenceTrunkId], [t].[Id], [t].[CollectionRootId], [t].[Name], [t].[OptionalReferenceBranchId], [t].[RequiredReferenceBranchId], [b].[Id], [b].[CollectionTrunkId], [b].[Name], [b].[OptionalReferenceLeafId], [b].[RequiredReferenceLeafId], [l].[Id], [l].[CollectionBranchId], [l].[Name]
+FROM [RootEntities] AS [r]
+INNER JOIN [TrunkEntities] AS [t] ON [r].[Id] = [t].[Id]
+INNER JOIN [BranchEntities] AS [b] ON [t].[Id] = [b].[Id]
+INNER JOIN [LeafEntities] AS [l] ON [b].[Id] = [l].[Id]
+""");
+    }
+
+    public override async Task Select_trunk_collection(bool async)
+    {
+        await base.Select_trunk_collection(async);
+
+        AssertSql(
+            """
+SELECT [r].[Id], [t].[Id], [t].[CollectionRootId], [t].[Name], [t].[OptionalReferenceBranchId], [t].[RequiredReferenceBranchId]
+FROM [RootEntities] AS [r]
+LEFT JOIN [TrunkEntities] AS [t] ON [r].[Id] = [t].[CollectionRootId]
+ORDER BY [r].[Id]
+""");
+    }
+
+    public override async Task Select_branch_required_collection(bool async)
+    {
+        await base.Select_branch_required_collection(async);
+
+        AssertSql(
+            """
+SELECT [r].[Id], [t].[Id], [b].[Id], [b].[CollectionTrunkId], [b].[Name], [b].[OptionalReferenceLeafId], [b].[RequiredReferenceLeafId]
+FROM [RootEntities] AS [r]
+INNER JOIN [TrunkEntities] AS [t] ON [r].[RequiredReferenceTrunkId] = [t].[Id]
+LEFT JOIN [BranchEntities] AS [b] ON [t].[Id] = [b].[CollectionTrunkId]
+ORDER BY [r].[Id], [t].[Id]
+""");
+    }
+
+    public override async Task Select_branch_optional_collection(bool async)
+    {
+        await base.Select_branch_optional_collection(async);
+
+        AssertSql(
+            """
+SELECT [r].[Id], [t].[Id], [b].[Id], [b].[CollectionTrunkId], [b].[Name], [b].[OptionalReferenceLeafId], [b].[RequiredReferenceLeafId]
+FROM [RootEntities] AS [r]
+INNER JOIN [TrunkEntities] AS [t] ON [r].[RequiredReferenceTrunkId] = [t].[Id]
+LEFT JOIN [BranchEntities] AS [b] ON [t].[Id] = [b].[CollectionTrunkId]
+ORDER BY [r].[Id], [t].[Id]
+""");
+    }
+
+    public override async Task Select_multiple_branch_leaf(bool async)
+    {
+        await base.Select_multiple_branch_leaf(async);
+
+        AssertSql(
+            """
+SELECT [r].[Id], [b].[Id], [b].[CollectionTrunkId], [b].[Name], [b].[OptionalReferenceLeafId], [b].[RequiredReferenceLeafId], [l].[Id], [l].[CollectionBranchId], [l].[Name], [t].[Id], [l0].[Id], [l0].[CollectionBranchId], [l0].[Name], [b0].[Id], [b0].[CollectionTrunkId], [b0].[Name], [b0].[OptionalReferenceLeafId], [b0].[RequiredReferenceLeafId]
+FROM [RootEntities] AS [r]
+INNER JOIN [TrunkEntities] AS [t] ON [r].[RequiredReferenceTrunkId] = [t].[Id]
+INNER JOIN [BranchEntities] AS [b] ON [t].[RequiredReferenceBranchId] = [b].[Id]
+LEFT JOIN [LeafEntities] AS [l] ON [b].[OptionalReferenceLeafId] = [l].[Id]
+LEFT JOIN [LeafEntities] AS [l0] ON [b].[Id] = [l0].[CollectionBranchId]
+LEFT JOIN [BranchEntities] AS [b0] ON [t].[Id] = [b0].[CollectionTrunkId]
+ORDER BY [r].[Id], [t].[Id], [b].[Id], [l].[Id], [l0].[Id]
+""");
+    }
+
+    public override async Task Select_subquery_root_set_trunk_FirstOrDefault_collection(bool async)
+    {
+        await base.Select_subquery_root_set_trunk_FirstOrDefault_collection(async);
+
+        AssertSql(
+            """
+SELECT [r].[Id], [s].[Id], [s].[Id0], [b].[Id], [b].[CollectionTrunkId], [b].[Name], [b].[OptionalReferenceLeafId], [b].[RequiredReferenceLeafId], [s].[c]
+FROM [RootEntities] AS [r]
+OUTER APPLY (
+    SELECT TOP(1) 1 AS [c], [r0].[Id], [t].[Id] AS [Id0]
+    FROM [RootEntities] AS [r0]
+    INNER JOIN [TrunkEntities] AS [t] ON [r0].[RequiredReferenceTrunkId] = [t].[Id]
+    ORDER BY [r0].[Id]
+) AS [s]
+LEFT JOIN [BranchEntities] AS [b] ON [s].[Id0] = [b].[CollectionTrunkId]
+ORDER BY [r].[Id], [s].[Id], [s].[Id0]
+""");
+    }
+
+    public override async Task Select_subquery_root_set_complex_projection_including_references_to_outer_FirstOrDefault(bool async)
+    {
+        await base.Select_subquery_root_set_complex_projection_including_references_to_outer_FirstOrDefault(async);
+
+        AssertSql(
+            """
+SELECT [r].[Id], [t].[Id], [b].[Id], [s].[Id1], [s].[Id], [s].[Id0], [b1].[Id], [b1].[CollectionTrunkId], [b1].[Name], [b1].[OptionalReferenceLeafId], [b1].[RequiredReferenceLeafId], [s].[CollectionRootId], [s].[Name], [s].[OptionalReferenceBranchId], [s].[RequiredReferenceBranchId], [s].[CollectionTrunkId], [s].[Name0], [s].[OptionalReferenceLeafId], [s].[RequiredReferenceLeafId], [s].[Name1], [s].[c]
+FROM [RootEntities] AS [r]
+INNER JOIN [TrunkEntities] AS [t] ON [r].[RequiredReferenceTrunkId] = [t].[Id]
+INNER JOIN [BranchEntities] AS [b] ON [t].[RequiredReferenceBranchId] = [b].[Id]
+OUTER APPLY (
+    SELECT TOP(1) [t0].[Id], [t0].[CollectionRootId], [t0].[Name], [t0].[OptionalReferenceBranchId], [t0].[RequiredReferenceBranchId], [b0].[Id] AS [Id0], [b0].[CollectionTrunkId], [b0].[Name] AS [Name0], [b0].[OptionalReferenceLeafId], [b0].[RequiredReferenceLeafId], [b].[Name] AS [Name1], 1 AS [c], [r0].[Id] AS [Id1]
+    FROM [RootEntities] AS [r0]
+    INNER JOIN [TrunkEntities] AS [t0] ON [r0].[RequiredReferenceTrunkId] = [t0].[Id]
+    INNER JOIN [BranchEntities] AS [b0] ON [t0].[RequiredReferenceBranchId] = [b0].[Id]
+    ORDER BY [r0].[Id]
+) AS [s]
+LEFT JOIN [BranchEntities] AS [b1] ON [t].[Id] = [b1].[CollectionTrunkId]
+ORDER BY [r].[Id], [t].[Id], [b].[Id], [s].[Id1], [s].[Id], [s].[Id0]
+""");
+    }
+
+    public override async Task Select_subquery_root_set_complex_projection_FirstOrDefault_project_reference_to_outer(bool async)
+    {
+        await base.Select_subquery_root_set_complex_projection_FirstOrDefault_project_reference_to_outer(async);
+
+        AssertSql(
+            """
+SELECT [r].[Id], [t].[Id], [r1].[Id], [b].[Id], [b].[CollectionTrunkId], [b].[Name], [b].[OptionalReferenceLeafId], [b].[RequiredReferenceLeafId], [r1].[c]
+FROM [RootEntities] AS [r]
+INNER JOIN [TrunkEntities] AS [t] ON [r].[RequiredReferenceTrunkId] = [t].[Id]
+OUTER APPLY (
+    SELECT TOP(1) 1 AS [c], [r0].[Id]
+    FROM [RootEntities] AS [r0]
+    ORDER BY [r0].[Id]
+) AS [r1]
+LEFT JOIN [BranchEntities] AS [b] ON [t].[Id] = [b].[CollectionTrunkId]
+ORDER BY [r].[Id], [t].[Id], [r1].[Id]
+""");
+    }
+
+    public override async Task SelectMany_trunk_collection(bool async)
+    {
+        await base.SelectMany_trunk_collection(async);
+
+        AssertSql(
+            """
+SELECT [t].[Id], [t].[CollectionRootId], [t].[Name], [t].[OptionalReferenceBranchId], [t].[RequiredReferenceBranchId]
+FROM [RootEntities] AS [r]
+INNER JOIN [TrunkEntities] AS [t] ON [r].[Id] = [t].[CollectionRootId]
+""");
+    }
+
+    public override async Task SelectMany_required_trunk_reference_branch_collection(bool async)
+    {
+        await base.SelectMany_required_trunk_reference_branch_collection(async);
+
+        AssertSql(
+            """
+SELECT [b].[Id], [b].[CollectionTrunkId], [b].[Name], [b].[OptionalReferenceLeafId], [b].[RequiredReferenceLeafId]
+FROM [RootEntities] AS [r]
+INNER JOIN [TrunkEntities] AS [t] ON [r].[RequiredReferenceTrunkId] = [t].[Id]
+INNER JOIN [BranchEntities] AS [b] ON [t].[Id] = [b].[CollectionTrunkId]
+""");
+    }
+
+    public override async Task SelectMany_optional_trunk_reference_branch_collection(bool async)
+    {
+        await base.SelectMany_optional_trunk_reference_branch_collection(async);
+
+        AssertSql(
+            """
+SELECT [b].[Id], [b].[CollectionTrunkId], [b].[Name], [b].[OptionalReferenceLeafId], [b].[RequiredReferenceLeafId]
+FROM [RootEntities] AS [r]
+LEFT JOIN [TrunkEntities] AS [t] ON [r].[OptionalReferenceTrunkId] = [t].[Id]
+INNER JOIN [BranchEntities] AS [b] ON [t].[Id] = [b].[CollectionTrunkId]
+""");
+    }
+
+    private void AssertSql(params string[] expected)
+        => Fixture.TestSqlLoggerFactory.AssertBaseline(expected);
+}
diff --git a/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/Projection/NavigationReferenceNoTrackingProjectionSqlServerTest.cs b/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/Projection/NavigationReferenceNoTrackingProjectionSqlServerTest.cs
new file mode 100644
index 0000000000..8f163e9fc4
--- /dev/null
+++ b/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/Projection/NavigationReferenceNoTrackingProjectionSqlServerTest.cs
@@ -0,0 +1,217 @@
+﻿// Licensed to the .NET Foundation under one or more agreements.
+// The .NET Foundation licenses this file to you under the MIT license.
+
+namespace Microsoft.EntityFrameworkCore.Query.Relationships.Projection;
+
+public class NavigationReferenceNoTrackingProjectionSqlServerTest
+    : NavigationReferenceNoTrackingProjectionRelationalTestBase<NavigationRelationshipsSqlServerFixture>
+{
+    public NavigationReferenceNoTrackingProjectionSqlServerTest(NavigationRelationshipsSqlServerFixture fixture, ITestOutputHelper testOutputHelper)
+        : base(fixture)
+    {
+        Fixture.TestSqlLoggerFactory.Clear();
+        Fixture.TestSqlLoggerFactory.SetTestOutputHelper(testOutputHelper);
+    }
+
+    public override async Task Select_everything(bool async)
+    {
+        await base.Select_everything(async);
+
+        AssertSql(
+            """
+SELECT [r].[Id], [r].[Name], [r].[OptionalReferenceTrunkId], [r].[RequiredReferenceTrunkId], [t].[Id], [t].[CollectionRootId], [t].[Name], [t].[OptionalReferenceBranchId], [t].[RequiredReferenceBranchId], [b].[Id], [b].[CollectionTrunkId], [b].[Name], [b].[OptionalReferenceLeafId], [b].[RequiredReferenceLeafId], [l].[Id], [l].[CollectionBranchId], [l].[Name]
+FROM [RootEntities] AS [r]
+INNER JOIN [TrunkEntities] AS [t] ON [r].[Id] = [t].[Id]
+INNER JOIN [BranchEntities] AS [b] ON [t].[Id] = [b].[Id]
+INNER JOIN [LeafEntities] AS [l] ON [b].[Id] = [l].[Id]
+""");
+    }
+
+    public override async Task Select_root(bool async)
+    {
+        await base.Select_root(async);
+
+        AssertSql(
+            """
+SELECT [r].[Id], [r].[Name], [r].[OptionalReferenceTrunkId], [r].[RequiredReferenceTrunkId]
+FROM [RootEntities] AS [r]
+""");
+    }
+
+    public override async Task Select_trunk_optional(bool async)
+    {
+        await base.Select_trunk_optional(async);
+
+        AssertSql(
+            """
+SELECT [t].[Id], [t].[CollectionRootId], [t].[Name], [t].[OptionalReferenceBranchId], [t].[RequiredReferenceBranchId]
+FROM [RootEntities] AS [r]
+LEFT JOIN [TrunkEntities] AS [t] ON [r].[OptionalReferenceTrunkId] = [t].[Id]
+ORDER BY [r].[Id]
+""");
+    }
+
+    public override async Task Select_trunk_required(bool async)
+    {
+        await base.Select_trunk_required(async);
+
+        AssertSql(
+            """
+SELECT [t].[Id], [t].[CollectionRootId], [t].[Name], [t].[OptionalReferenceBranchId], [t].[RequiredReferenceBranchId]
+FROM [RootEntities] AS [r]
+INNER JOIN [TrunkEntities] AS [t] ON [r].[RequiredReferenceTrunkId] = [t].[Id]
+ORDER BY [r].[Id]
+""");
+    }
+
+    public override async Task Select_branch_required_required(bool async)
+    {
+        await base.Select_branch_required_required(async);
+
+        AssertSql(
+            """
+SELECT [b].[Id], [b].[CollectionTrunkId], [b].[Name], [b].[OptionalReferenceLeafId], [b].[RequiredReferenceLeafId]
+FROM [RootEntities] AS [r]
+INNER JOIN [TrunkEntities] AS [t] ON [r].[RequiredReferenceTrunkId] = [t].[Id]
+INNER JOIN [BranchEntities] AS [b] ON [t].[RequiredReferenceBranchId] = [b].[Id]
+ORDER BY [r].[Id]
+""");
+    }
+
+    public override async Task Select_branch_required_optional(bool async)
+    {
+        await base.Select_branch_required_optional(async);
+
+        AssertSql(
+            """
+SELECT [b].[Id], [b].[CollectionTrunkId], [b].[Name], [b].[OptionalReferenceLeafId], [b].[RequiredReferenceLeafId]
+FROM [RootEntities] AS [r]
+INNER JOIN [TrunkEntities] AS [t] ON [r].[RequiredReferenceTrunkId] = [t].[Id]
+LEFT JOIN [BranchEntities] AS [b] ON [t].[OptionalReferenceBranchId] = [b].[Id]
+ORDER BY [r].[Id]
+""");
+    }
+
+    public override async Task Select_branch_optional_required(bool async)
+    {
+        await base.Select_branch_optional_required(async);
+
+        AssertSql(
+            """
+SELECT [b].[Id], [b].[CollectionTrunkId], [b].[Name], [b].[OptionalReferenceLeafId], [b].[RequiredReferenceLeafId]
+FROM [RootEntities] AS [r]
+INNER JOIN [TrunkEntities] AS [t] ON [r].[RequiredReferenceTrunkId] = [t].[Id]
+INNER JOIN [BranchEntities] AS [b] ON [t].[RequiredReferenceBranchId] = [b].[Id]
+ORDER BY [r].[Id]
+""");
+    }
+
+    public override async Task Select_branch_optional_optional(bool async)
+    {
+        await base.Select_branch_optional_optional(async);
+
+        AssertSql(
+            """
+SELECT [b].[Id], [b].[CollectionTrunkId], [b].[Name], [b].[OptionalReferenceLeafId], [b].[RequiredReferenceLeafId]
+FROM [RootEntities] AS [r]
+INNER JOIN [TrunkEntities] AS [t] ON [r].[RequiredReferenceTrunkId] = [t].[Id]
+LEFT JOIN [BranchEntities] AS [b] ON [t].[OptionalReferenceBranchId] = [b].[Id]
+ORDER BY [r].[Id]
+""");
+    }
+
+    public override async Task Select_root_duplicated(bool async)
+    {
+        await base.Select_root_duplicated(async);
+
+        AssertSql(
+            """
+SELECT [r].[Id], [r].[Name], [r].[OptionalReferenceTrunkId], [r].[RequiredReferenceTrunkId]
+FROM [RootEntities] AS [r]
+""");
+    }
+
+    public override async Task Select_trunk_and_branch_duplicated(bool async)
+    {
+        await base.Select_trunk_and_branch_duplicated(async);
+
+        AssertSql(
+            """
+SELECT [t].[Id], [t].[CollectionRootId], [t].[Name], [t].[OptionalReferenceBranchId], [t].[RequiredReferenceBranchId], [b].[Id], [b].[CollectionTrunkId], [b].[Name], [b].[OptionalReferenceLeafId], [b].[RequiredReferenceLeafId]
+FROM [RootEntities] AS [r]
+LEFT JOIN [TrunkEntities] AS [t] ON [r].[OptionalReferenceTrunkId] = [t].[Id]
+LEFT JOIN [BranchEntities] AS [b] ON [t].[RequiredReferenceBranchId] = [b].[Id]
+ORDER BY [r].[Id]
+""");
+    }
+
+    public override async Task Select_trunk_and_trunk_duplicated(bool async)
+    {
+        await base.Select_trunk_and_trunk_duplicated(async);
+
+        AssertSql(
+            """
+SELECT [t].[Id], [t].[CollectionRootId], [t].[Name], [t].[OptionalReferenceBranchId], [t].[RequiredReferenceBranchId], [l].[Id], [l].[CollectionBranchId], [l].[Name]
+FROM [RootEntities] AS [r]
+INNER JOIN [TrunkEntities] AS [t] ON [r].[RequiredReferenceTrunkId] = [t].[Id]
+LEFT JOIN [BranchEntities] AS [b] ON [t].[OptionalReferenceBranchId] = [b].[Id]
+LEFT JOIN [LeafEntities] AS [l] ON [b].[RequiredReferenceLeafId] = [l].[Id]
+ORDER BY [r].[Id]
+""");
+    }
+
+    public override async Task Select_leaf_trunk_root(bool async)
+    {
+        await base.Select_leaf_trunk_root(async);
+
+        AssertSql(
+            """
+SELECT [l].[Id], [l].[CollectionBranchId], [l].[Name], [t].[Id], [t].[CollectionRootId], [t].[Name], [t].[OptionalReferenceBranchId], [t].[RequiredReferenceBranchId], [r].[Id], [r].[Name], [r].[OptionalReferenceTrunkId], [r].[RequiredReferenceTrunkId]
+FROM [RootEntities] AS [r]
+INNER JOIN [TrunkEntities] AS [t] ON [r].[RequiredReferenceTrunkId] = [t].[Id]
+INNER JOIN [BranchEntities] AS [b] ON [t].[RequiredReferenceBranchId] = [b].[Id]
+INNER JOIN [LeafEntities] AS [l] ON [b].[RequiredReferenceLeafId] = [l].[Id]
+""");
+    }
+
+    public override async Task Select_subquery_root_set_required_trunk_FirstOrDefault_branch(bool async)
+    {
+        await base.Select_subquery_root_set_required_trunk_FirstOrDefault_branch(async);
+
+        AssertSql(
+            """
+SELECT [s].[Id], [s].[CollectionTrunkId], [s].[Name], [s].[OptionalReferenceLeafId], [s].[RequiredReferenceLeafId]
+FROM [RootEntities] AS [r]
+OUTER APPLY (
+    SELECT TOP(1) [b].[Id], [b].[CollectionTrunkId], [b].[Name], [b].[OptionalReferenceLeafId], [b].[RequiredReferenceLeafId]
+    FROM [RootEntities] AS [r0]
+    INNER JOIN [TrunkEntities] AS [t] ON [r0].[RequiredReferenceTrunkId] = [t].[Id]
+    INNER JOIN [BranchEntities] AS [b] ON [t].[RequiredReferenceBranchId] = [b].[Id]
+    ORDER BY [r0].[Id]
+) AS [s]
+ORDER BY [r].[Id]
+""");
+    }
+
+    public override async Task Select_subquery_root_set_optional_trunk_FirstOrDefault_branch(bool async)
+    {
+        await base.Select_subquery_root_set_optional_trunk_FirstOrDefault_branch(async);
+
+        AssertSql(
+            """
+SELECT [s].[Id], [s].[CollectionTrunkId], [s].[Name], [s].[OptionalReferenceLeafId], [s].[RequiredReferenceLeafId]
+FROM [RootEntities] AS [r]
+OUTER APPLY (
+    SELECT TOP(1) [b].[Id], [b].[CollectionTrunkId], [b].[Name], [b].[OptionalReferenceLeafId], [b].[RequiredReferenceLeafId]
+    FROM [RootEntities] AS [r0]
+    LEFT JOIN [TrunkEntities] AS [t] ON [r0].[OptionalReferenceTrunkId] = [t].[Id]
+    LEFT JOIN [BranchEntities] AS [b] ON [t].[OptionalReferenceBranchId] = [b].[Id]
+    ORDER BY [r0].[Id]
+) AS [s]
+ORDER BY [r].[Id]
+""");
+    }
+
+    private void AssertSql(params string[] expected)
+        => Fixture.TestSqlLoggerFactory.AssertBaseline(expected);
+}
diff --git a/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/Projection/NavigationReferenceProjectionSqlServerTest.cs b/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/Projection/NavigationReferenceProjectionSqlServerTest.cs
new file mode 100644
index 0000000000..c4ffd9c24f
--- /dev/null
+++ b/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/Projection/NavigationReferenceProjectionSqlServerTest.cs
@@ -0,0 +1,217 @@
+﻿// Licensed to the .NET Foundation under one or more agreements.
+// The .NET Foundation licenses this file to you under the MIT license.
+
+namespace Microsoft.EntityFrameworkCore.Query.Relationships.Projection;
+
+public class NavigationReferenceProjectionSqlServerTest
+    : NavigationReferenceProjectionRelationalTestBase<NavigationRelationshipsSqlServerFixture>
+{
+    public NavigationReferenceProjectionSqlServerTest(NavigationRelationshipsSqlServerFixture fixture, ITestOutputHelper testOutputHelper)
+        : base(fixture)
+    {
+        Fixture.TestSqlLoggerFactory.Clear();
+        Fixture.TestSqlLoggerFactory.SetTestOutputHelper(testOutputHelper);
+    }
+
+    public override async Task Select_everything(bool async)
+    {
+        await base.Select_everything(async);
+
+        AssertSql(
+            """
+SELECT [r].[Id], [r].[Name], [r].[OptionalReferenceTrunkId], [r].[RequiredReferenceTrunkId], [t].[Id], [t].[CollectionRootId], [t].[Name], [t].[OptionalReferenceBranchId], [t].[RequiredReferenceBranchId], [b].[Id], [b].[CollectionTrunkId], [b].[Name], [b].[OptionalReferenceLeafId], [b].[RequiredReferenceLeafId], [l].[Id], [l].[CollectionBranchId], [l].[Name]
+FROM [RootEntities] AS [r]
+INNER JOIN [TrunkEntities] AS [t] ON [r].[Id] = [t].[Id]
+INNER JOIN [BranchEntities] AS [b] ON [t].[Id] = [b].[Id]
+INNER JOIN [LeafEntities] AS [l] ON [b].[Id] = [l].[Id]
+""");
+    }
+
+    public override async Task Select_root(bool async)
+    {
+        await base.Select_root(async);
+
+        AssertSql(
+            """
+SELECT [r].[Id], [r].[Name], [r].[OptionalReferenceTrunkId], [r].[RequiredReferenceTrunkId]
+FROM [RootEntities] AS [r]
+""");
+    }
+
+    public override async Task Select_trunk_optional(bool async)
+    {
+        await base.Select_trunk_optional(async);
+
+        AssertSql(
+            """
+SELECT [t].[Id], [t].[CollectionRootId], [t].[Name], [t].[OptionalReferenceBranchId], [t].[RequiredReferenceBranchId]
+FROM [RootEntities] AS [r]
+LEFT JOIN [TrunkEntities] AS [t] ON [r].[OptionalReferenceTrunkId] = [t].[Id]
+ORDER BY [r].[Id]
+""");
+    }
+
+    public override async Task Select_trunk_required(bool async)
+    {
+        await base.Select_trunk_required(async);
+
+        AssertSql(
+            """
+SELECT [t].[Id], [t].[CollectionRootId], [t].[Name], [t].[OptionalReferenceBranchId], [t].[RequiredReferenceBranchId]
+FROM [RootEntities] AS [r]
+INNER JOIN [TrunkEntities] AS [t] ON [r].[RequiredReferenceTrunkId] = [t].[Id]
+ORDER BY [r].[Id]
+""");
+    }
+
+    public override async Task Select_branch_required_required(bool async)
+    {
+        await base.Select_branch_required_required(async);
+
+        AssertSql(
+"""
+SELECT [b].[Id], [b].[CollectionTrunkId], [b].[Name], [b].[OptionalReferenceLeafId], [b].[RequiredReferenceLeafId]
+FROM [RootEntities] AS [r]
+INNER JOIN [TrunkEntities] AS [t] ON [r].[RequiredReferenceTrunkId] = [t].[Id]
+INNER JOIN [BranchEntities] AS [b] ON [t].[RequiredReferenceBranchId] = [b].[Id]
+ORDER BY [r].[Id]
+""");
+    }
+
+    public override async Task Select_branch_required_optional(bool async)
+    {
+        await base.Select_branch_required_optional(async);
+
+        AssertSql(
+            """
+SELECT [b].[Id], [b].[CollectionTrunkId], [b].[Name], [b].[OptionalReferenceLeafId], [b].[RequiredReferenceLeafId]
+FROM [RootEntities] AS [r]
+INNER JOIN [TrunkEntities] AS [t] ON [r].[RequiredReferenceTrunkId] = [t].[Id]
+LEFT JOIN [BranchEntities] AS [b] ON [t].[OptionalReferenceBranchId] = [b].[Id]
+ORDER BY [r].[Id]
+""");
+    }
+
+    public override async Task Select_branch_optional_required(bool async)
+    {
+        await base.Select_branch_optional_required(async);
+
+        AssertSql(
+            """
+SELECT [b].[Id], [b].[CollectionTrunkId], [b].[Name], [b].[OptionalReferenceLeafId], [b].[RequiredReferenceLeafId]
+FROM [RootEntities] AS [r]
+INNER JOIN [TrunkEntities] AS [t] ON [r].[RequiredReferenceTrunkId] = [t].[Id]
+INNER JOIN [BranchEntities] AS [b] ON [t].[RequiredReferenceBranchId] = [b].[Id]
+ORDER BY [r].[Id]
+""");
+    }
+
+    public override async Task Select_branch_optional_optional(bool async)
+    {
+        await base.Select_branch_optional_optional(async);
+
+        AssertSql(
+            """
+SELECT [b].[Id], [b].[CollectionTrunkId], [b].[Name], [b].[OptionalReferenceLeafId], [b].[RequiredReferenceLeafId]
+FROM [RootEntities] AS [r]
+INNER JOIN [TrunkEntities] AS [t] ON [r].[RequiredReferenceTrunkId] = [t].[Id]
+LEFT JOIN [BranchEntities] AS [b] ON [t].[OptionalReferenceBranchId] = [b].[Id]
+ORDER BY [r].[Id]
+""");
+    }
+
+    public override async Task Select_root_duplicated(bool async)
+    {
+        await base.Select_root_duplicated(async);
+
+        AssertSql(
+            """
+SELECT [r].[Id], [r].[Name], [r].[OptionalReferenceTrunkId], [r].[RequiredReferenceTrunkId]
+FROM [RootEntities] AS [r]
+""");
+    }
+
+    public override async Task Select_trunk_and_branch_duplicated(bool async)
+    {
+        await base.Select_trunk_and_branch_duplicated(async);
+
+        AssertSql(
+            """
+SELECT [t].[Id], [t].[CollectionRootId], [t].[Name], [t].[OptionalReferenceBranchId], [t].[RequiredReferenceBranchId], [b].[Id], [b].[CollectionTrunkId], [b].[Name], [b].[OptionalReferenceLeafId], [b].[RequiredReferenceLeafId]
+FROM [RootEntities] AS [r]
+LEFT JOIN [TrunkEntities] AS [t] ON [r].[OptionalReferenceTrunkId] = [t].[Id]
+LEFT JOIN [BranchEntities] AS [b] ON [t].[RequiredReferenceBranchId] = [b].[Id]
+ORDER BY [r].[Id]
+""");
+    }
+
+    public override async Task Select_trunk_and_trunk_duplicated(bool async)
+    {
+        await base.Select_trunk_and_trunk_duplicated(async);
+
+        AssertSql(
+            """
+SELECT [t].[Id], [t].[CollectionRootId], [t].[Name], [t].[OptionalReferenceBranchId], [t].[RequiredReferenceBranchId], [l].[Id], [l].[CollectionBranchId], [l].[Name]
+FROM [RootEntities] AS [r]
+INNER JOIN [TrunkEntities] AS [t] ON [r].[RequiredReferenceTrunkId] = [t].[Id]
+LEFT JOIN [BranchEntities] AS [b] ON [t].[OptionalReferenceBranchId] = [b].[Id]
+LEFT JOIN [LeafEntities] AS [l] ON [b].[RequiredReferenceLeafId] = [l].[Id]
+ORDER BY [r].[Id]
+""");
+    }
+
+    public override async Task Select_leaf_trunk_root(bool async)
+    {
+        await base.Select_leaf_trunk_root(async);
+
+        AssertSql(
+            """
+SELECT [l].[Id], [l].[CollectionBranchId], [l].[Name], [t].[Id], [t].[CollectionRootId], [t].[Name], [t].[OptionalReferenceBranchId], [t].[RequiredReferenceBranchId], [r].[Id], [r].[Name], [r].[OptionalReferenceTrunkId], [r].[RequiredReferenceTrunkId]
+FROM [RootEntities] AS [r]
+INNER JOIN [TrunkEntities] AS [t] ON [r].[RequiredReferenceTrunkId] = [t].[Id]
+INNER JOIN [BranchEntities] AS [b] ON [t].[RequiredReferenceBranchId] = [b].[Id]
+INNER JOIN [LeafEntities] AS [l] ON [b].[RequiredReferenceLeafId] = [l].[Id]
+""");
+    }
+
+    public override async Task Select_subquery_root_set_required_trunk_FirstOrDefault_branch(bool async)
+    {
+        await base.Select_subquery_root_set_required_trunk_FirstOrDefault_branch(async);
+
+        AssertSql(
+            """
+SELECT [s].[Id], [s].[CollectionTrunkId], [s].[Name], [s].[OptionalReferenceLeafId], [s].[RequiredReferenceLeafId]
+FROM [RootEntities] AS [r]
+OUTER APPLY (
+    SELECT TOP(1) [b].[Id], [b].[CollectionTrunkId], [b].[Name], [b].[OptionalReferenceLeafId], [b].[RequiredReferenceLeafId]
+    FROM [RootEntities] AS [r0]
+    INNER JOIN [TrunkEntities] AS [t] ON [r0].[RequiredReferenceTrunkId] = [t].[Id]
+    INNER JOIN [BranchEntities] AS [b] ON [t].[RequiredReferenceBranchId] = [b].[Id]
+    ORDER BY [r0].[Id]
+) AS [s]
+ORDER BY [r].[Id]
+""");
+    }
+
+    public override async Task Select_subquery_root_set_optional_trunk_FirstOrDefault_branch(bool async)
+    {
+        await base.Select_subquery_root_set_optional_trunk_FirstOrDefault_branch(async);
+
+        AssertSql(
+            """
+SELECT [s].[Id], [s].[CollectionTrunkId], [s].[Name], [s].[OptionalReferenceLeafId], [s].[RequiredReferenceLeafId]
+FROM [RootEntities] AS [r]
+OUTER APPLY (
+    SELECT TOP(1) [b].[Id], [b].[CollectionTrunkId], [b].[Name], [b].[OptionalReferenceLeafId], [b].[RequiredReferenceLeafId]
+    FROM [RootEntities] AS [r0]
+    LEFT JOIN [TrunkEntities] AS [t] ON [r0].[OptionalReferenceTrunkId] = [t].[Id]
+    LEFT JOIN [BranchEntities] AS [b] ON [t].[OptionalReferenceBranchId] = [b].[Id]
+    ORDER BY [r0].[Id]
+) AS [s]
+ORDER BY [r].[Id]
+""");
+    }
+
+    private void AssertSql(params string[] expected)
+        => Fixture.TestSqlLoggerFactory.AssertBaseline(expected);
+}
diff --git a/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/Projection/OwnedJsonNoTrackingProjectionSqlServerTest.cs b/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/Projection/OwnedJsonNoTrackingProjectionSqlServerTest.cs
new file mode 100644
index 0000000000..810461aac3
--- /dev/null
+++ b/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/Projection/OwnedJsonNoTrackingProjectionSqlServerTest.cs
@@ -0,0 +1,167 @@
+﻿// Licensed to the .NET Foundation under one or more agreements.
+// The .NET Foundation licenses this file to you under the MIT license.
+
+namespace Microsoft.EntityFrameworkCore.Query.Relationships.Projection;
+
+public class OwnedJsonNoTrackingProjectionSqlServerTest
+    : OwnedJsonNoTrackingProjectionRelationalTestBase<OwnedJsonRelationshipsSqlServerFixture>
+{
+    public OwnedJsonNoTrackingProjectionSqlServerTest(OwnedJsonRelationshipsSqlServerFixture fixture, ITestOutputHelper testOutputHelper)
+        : base(fixture)
+    {
+        Fixture.TestSqlLoggerFactory.Clear();
+        Fixture.TestSqlLoggerFactory.SetTestOutputHelper(testOutputHelper);
+    }
+
+    public override async Task Select_trunk_collection(bool async)
+    {
+        await base.Select_trunk_collection(async);
+
+        AssertSql(
+            """
+SELECT [r].[CollectionTrunk], [r].[Id]
+FROM [RootEntities] AS [r]
+ORDER BY [r].[Id]
+""");
+    }
+
+    public override async Task Select_branch_required_collection(bool async)
+    {
+        await base.Select_branch_required_collection(async);
+
+        AssertSql(
+            """
+SELECT JSON_QUERY([r].[RequiredReferenceTrunk], '$.CollectionBranch'), [r].[Id]
+FROM [RootEntities] AS [r]
+ORDER BY [r].[Id]
+""");
+    }
+
+    public override async Task Select_branch_optional_collection(bool async)
+    {
+        await base.Select_branch_optional_collection(async);
+
+        AssertSql(
+            """
+SELECT JSON_QUERY([r].[RequiredReferenceTrunk], '$.CollectionBranch'), [r].[Id]
+FROM [RootEntities] AS [r]
+ORDER BY [r].[Id]
+""");
+    }
+
+    public override async Task Select_multiple_branch_leaf(bool async)
+    {
+        await base.Select_multiple_branch_leaf(async);
+
+        AssertSql(
+            """
+SELECT [r].[Id], JSON_QUERY([r].[RequiredReferenceTrunk], '$.RequiredReferenceBranch'), JSON_QUERY([r].[RequiredReferenceTrunk], '$.RequiredReferenceBranch.OptionalReferenceLeaf'), JSON_QUERY([r].[RequiredReferenceTrunk], '$.RequiredReferenceBranch.CollectionLeaf'), JSON_QUERY([r].[RequiredReferenceTrunk], '$.CollectionBranch'), JSON_VALUE([r].[RequiredReferenceTrunk], '$.RequiredReferenceBranch.OptionalReferenceLeaf.Name')
+FROM [RootEntities] AS [r]
+""");
+    }
+
+    public override async Task Select_subquery_root_set_trunk_FirstOrDefault_collection(bool async)
+    {
+        await base.Select_subquery_root_set_trunk_FirstOrDefault_collection(async);
+
+        AssertSql(
+            """
+SELECT [r1].[c], [r1].[Id], [r1].[c0]
+FROM [RootEntities] AS [r]
+OUTER APPLY (
+    SELECT TOP(1) JSON_QUERY([r0].[RequiredReferenceTrunk], '$.CollectionBranch') AS [c], [r0].[Id], 1 AS [c0]
+    FROM [RootEntities] AS [r0]
+    ORDER BY [r0].[Id]
+) AS [r1]
+ORDER BY [r].[Id]
+""");
+    }
+
+    public override async Task Select_subquery_root_set_complex_projection_including_references_to_outer_FirstOrDefault(bool async)
+    {
+        await base.Select_subquery_root_set_complex_projection_including_references_to_outer_FirstOrDefault(async);
+
+        AssertSql(
+            """
+SELECT [r1].[c], [r1].[Id], [r1].[c0], [r1].[Id0], [r1].[c1], [r1].[c2], [r1].[c3], [r1].[c4]
+FROM [RootEntities] AS [r]
+OUTER APPLY (
+    SELECT TOP(1) JSON_QUERY([r].[RequiredReferenceTrunk], '$.CollectionBranch') AS [c], [r].[Id], [r0].[RequiredReferenceTrunk] AS [c0], [r0].[Id] AS [Id0], JSON_QUERY([r0].[RequiredReferenceTrunk], '$.RequiredReferenceBranch') AS [c1], JSON_VALUE([r0].[RequiredReferenceTrunk], '$.Name') AS [c2], JSON_VALUE([r].[RequiredReferenceTrunk], '$.RequiredReferenceBranch.Name') AS [c3], 1 AS [c4]
+    FROM [RootEntities] AS [r0]
+    ORDER BY [r0].[Id]
+) AS [r1]
+ORDER BY [r].[Id]
+""");
+    }
+
+    public override async Task Select_subquery_root_set_complex_projection_FirstOrDefault_project_reference_to_outer(bool async)
+    {
+        await base.Select_subquery_root_set_complex_projection_FirstOrDefault_project_reference_to_outer(async);
+
+        AssertSql(
+            """
+SELECT [r1].[c], [r1].[Id], [r1].[c0]
+FROM [RootEntities] AS [r]
+OUTER APPLY (
+    SELECT TOP(1) JSON_QUERY([r].[RequiredReferenceTrunk], '$.CollectionBranch') AS [c], [r].[Id], 1 AS [c0]
+    FROM [RootEntities] AS [r0]
+    ORDER BY [r0].[Id]
+) AS [r1]
+ORDER BY [r].[Id]
+""");
+    }
+
+    public override async Task SelectMany_trunk_collection(bool async)
+    {
+        await base.SelectMany_trunk_collection(async);
+
+        AssertSql(
+            """
+SELECT [r].[Id], [c].[Name], [c].[CollectionBranch], [c].[OptionalReferenceBranch], [c].[RequiredReferenceBranch]
+FROM [RootEntities] AS [r]
+CROSS APPLY OPENJSON([r].[CollectionTrunk], '$') WITH (
+    [Name] nvarchar(max) '$.Name',
+    [CollectionBranch] nvarchar(max) '$.CollectionBranch' AS JSON,
+    [OptionalReferenceBranch] nvarchar(max) '$.OptionalReferenceBranch' AS JSON,
+    [RequiredReferenceBranch] nvarchar(max) '$.RequiredReferenceBranch' AS JSON
+) AS [c]
+""");
+    }
+
+    public override async Task SelectMany_required_trunk_reference_branch_collection(bool async)
+    {
+        await base.SelectMany_required_trunk_reference_branch_collection(async);
+
+        AssertSql(
+            """
+SELECT [r].[Id], [c].[Name], [c].[CollectionLeaf], [c].[OptionalReferenceLeaf], [c].[RequiredReferenceLeaf]
+FROM [RootEntities] AS [r]
+CROSS APPLY OPENJSON([r].[RequiredReferenceTrunk], '$.CollectionBranch') WITH (
+    [Name] nvarchar(max) '$.Name',
+    [CollectionLeaf] nvarchar(max) '$.CollectionLeaf' AS JSON,
+    [OptionalReferenceLeaf] nvarchar(max) '$.OptionalReferenceLeaf' AS JSON,
+    [RequiredReferenceLeaf] nvarchar(max) '$.RequiredReferenceLeaf' AS JSON
+) AS [c]
+""");
+    }
+
+    public override async Task SelectMany_optional_trunk_reference_branch_collection(bool async)
+    {
+        await base.SelectMany_optional_trunk_reference_branch_collection(async);
+
+        AssertSql(
+            """
+SELECT [r].[Id], [c].[Name], [c].[CollectionLeaf], [c].[OptionalReferenceLeaf], [c].[RequiredReferenceLeaf]
+FROM [RootEntities] AS [r]
+CROSS APPLY OPENJSON([r].[OptionalReferenceTrunk], '$.CollectionBranch') WITH (
+    [Name] nvarchar(max) '$.Name',
+    [CollectionLeaf] nvarchar(max) '$.CollectionLeaf' AS JSON,
+    [OptionalReferenceLeaf] nvarchar(max) '$.OptionalReferenceLeaf' AS JSON,
+    [RequiredReferenceLeaf] nvarchar(max) '$.RequiredReferenceLeaf' AS JSON
+) AS [c]
+""");
+    }
+
+    private void AssertSql(params string[] expected)
+        => Fixture.TestSqlLoggerFactory.AssertBaseline(expected);
+}
diff --git a/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/Projection/OwnedJsonProjectionSqlServerTest.cs b/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/Projection/OwnedJsonProjectionSqlServerTest.cs
new file mode 100644
index 0000000000..92d982fff5
--- /dev/null
+++ b/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/Projection/OwnedJsonProjectionSqlServerTest.cs
@@ -0,0 +1,59 @@
+﻿// Licensed to the .NET Foundation under one or more agreements.
+// The .NET Foundation licenses this file to you under the MIT license.
+
+namespace Microsoft.EntityFrameworkCore.Query.Relationships.Projection;
+
+public class OwnedJsonProjectionSqlServerTest
+    : OwnedJsonProjectionRelationalTestBase<OwnedJsonRelationshipsSqlServerFixture>
+{
+    public OwnedJsonProjectionSqlServerTest(OwnedJsonRelationshipsSqlServerFixture fixture, ITestOutputHelper testOutputHelper)
+        : base(fixture)
+    {
+        Fixture.TestSqlLoggerFactory.Clear();
+        Fixture.TestSqlLoggerFactory.SetTestOutputHelper(testOutputHelper);
+    }
+
+    public override Task Select_trunk_collection(bool async)
+        => AssertCantTrackJson(() => base.Select_trunk_collection(async));
+
+    public override Task Select_branch_required_collection(bool async)
+        => AssertCantTrackJson(() => base.Select_branch_required_collection(async));
+
+    public override Task Select_branch_optional_collection(bool async)
+        => AssertCantTrackJson(() => base.Select_branch_optional_collection(async));
+
+    public override Task Project_branch_collection_element_using_indexer_constant(bool async)
+        => AssertCantTrackJson(() => base.Project_branch_collection_element_using_indexer_constant(async));
+
+    public override Task Select_multiple_branch_leaf(bool async)
+        => AssertCantTrackJson(() => base.Select_multiple_branch_leaf(async));
+
+    public override Task Select_subquery_root_set_trunk_FirstOrDefault_collection(bool async)
+        => AssertCantTrackJson(() => base.Select_subquery_root_set_trunk_FirstOrDefault_collection(async));
+
+    public override Task Select_subquery_root_set_complex_projection_including_references_to_outer_FirstOrDefault(bool async)
+        => AssertCantTrackJson(() => base.Select_subquery_root_set_complex_projection_including_references_to_outer_FirstOrDefault(async));
+
+    public override Task Select_subquery_root_set_complex_projection_FirstOrDefault_project_reference_to_outer(bool async)
+        => AssertCantTrackJson(() => base.Select_subquery_root_set_complex_projection_FirstOrDefault_project_reference_to_outer(async));
+
+    public override Task SelectMany_trunk_collection(bool async)
+        => AssertCantTrackJson(() => base.SelectMany_trunk_collection(async));
+
+    public override Task SelectMany_required_trunk_reference_branch_collection(bool async)
+        => AssertCantTrackJson(() => base.SelectMany_required_trunk_reference_branch_collection(async));
+
+    public override Task SelectMany_optional_trunk_reference_branch_collection(bool async)
+        => AssertCantTrackJson(() => base.SelectMany_optional_trunk_reference_branch_collection(async));
+
+    private async Task AssertCantTrackJson(Func<Task> test)
+    {
+        var message = (await Assert.ThrowsAsync<InvalidOperationException>(test)).Message;
+
+        Assert.Equal(RelationalStrings.JsonEntityOrCollectionProjectedAtRootLevelInTrackingQuery("AsNoTracking"), message);
+        AssertSql();
+    }
+
+    private void AssertSql(params string[] expected)
+        => Fixture.TestSqlLoggerFactory.AssertBaseline(expected);
+}
diff --git a/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/Projection/OwnedJsonReferenceNoTrackingProjectionSqlServerTest.cs b/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/Projection/OwnedJsonReferenceNoTrackingProjectionSqlServerTest.cs
new file mode 100644
index 0000000000..87550ade35
--- /dev/null
+++ b/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/Projection/OwnedJsonReferenceNoTrackingProjectionSqlServerTest.cs
@@ -0,0 +1,181 @@
+﻿// Licensed to the .NET Foundation under one or more agreements.
+// The .NET Foundation licenses this file to you under the MIT license.
+
+namespace Microsoft.EntityFrameworkCore.Query.Relationships.Projection;
+
+public class OwnedJsonReferenceNoTrackingProjectionSqlServerTest
+    : OwnedJsonReferenceNoTrackingProjectionRelationalTestBase<OwnedJsonRelationshipsSqlServerFixture>
+{
+    public OwnedJsonReferenceNoTrackingProjectionSqlServerTest(OwnedJsonRelationshipsSqlServerFixture fixture, ITestOutputHelper testOutputHelper)
+        : base(fixture)
+    {
+        Fixture.TestSqlLoggerFactory.Clear();
+        Fixture.TestSqlLoggerFactory.SetTestOutputHelper(testOutputHelper);
+    }
+
+    public override async Task Select_root(bool async)
+    {
+        await base.Select_root(async);
+
+        AssertSql(
+            """
+SELECT [r].[Id], [r].[Name], [r].[OptionalReferenceTrunkId], [r].[RequiredReferenceTrunkId], [r].[CollectionTrunk], [r].[OptionalReferenceTrunk], [r].[RequiredReferenceTrunk]
+FROM [RootEntities] AS [r]
+""");
+    }
+
+    public override async Task Select_trunk_optional(bool async)
+    {
+        await base.Select_trunk_optional(async);
+
+        AssertSql(
+            """
+SELECT [r].[OptionalReferenceTrunk], [r].[Id]
+FROM [RootEntities] AS [r]
+ORDER BY [r].[Id]
+""");
+    }
+
+    public override async Task Select_trunk_required(bool async)
+    {
+        await base.Select_trunk_required(async);
+
+        AssertSql(
+            """
+SELECT [r].[RequiredReferenceTrunk], [r].[Id]
+FROM [RootEntities] AS [r]
+ORDER BY [r].[Id]
+""");
+    }
+
+    public override async Task Select_branch_required_required(bool async)
+    {
+        await base.Select_branch_required_required(async);
+
+        AssertSql(
+            """
+SELECT JSON_QUERY([r].[RequiredReferenceTrunk], '$.RequiredReferenceBranch'), [r].[Id]
+FROM [RootEntities] AS [r]
+ORDER BY [r].[Id]
+""");
+    }
+
+    public override async Task Select_branch_required_optional(bool async)
+    {
+        await base.Select_branch_required_optional(async);
+
+        AssertSql(
+            """
+SELECT JSON_QUERY([r].[RequiredReferenceTrunk], '$.OptionalReferenceBranch'), [r].[Id]
+FROM [RootEntities] AS [r]
+ORDER BY [r].[Id]
+""");
+    }
+
+    public override async Task Select_branch_optional_required(bool async)
+    {
+        await base.Select_branch_optional_required(async);
+
+        AssertSql(
+            """
+SELECT JSON_QUERY([r].[RequiredReferenceTrunk], '$.RequiredReferenceBranch'), [r].[Id]
+FROM [RootEntities] AS [r]
+ORDER BY [r].[Id]
+""");
+    }
+
+    public override async Task Select_branch_optional_optional(bool async)
+    {
+        await base.Select_branch_optional_optional(async);
+
+        AssertSql(
+            """
+SELECT JSON_QUERY([r].[RequiredReferenceTrunk], '$.OptionalReferenceBranch'), [r].[Id]
+FROM [RootEntities] AS [r]
+ORDER BY [r].[Id]
+""");
+    }
+
+    public override async Task Select_root_duplicated(bool async)
+    {
+        await base.Select_root_duplicated(async);
+
+        AssertSql(
+            """
+SELECT [r].[Id], [r].[Name], [r].[OptionalReferenceTrunkId], [r].[RequiredReferenceTrunkId], [r].[CollectionTrunk], [r].[OptionalReferenceTrunk], [r].[RequiredReferenceTrunk], [r].[CollectionTrunk], [r].[OptionalReferenceTrunk], [r].[RequiredReferenceTrunk]
+FROM [RootEntities] AS [r]
+""");
+    }
+
+    public override async Task Select_trunk_and_branch_duplicated(bool async)
+    {
+        await base.Select_trunk_and_branch_duplicated(async);
+
+        AssertSql(
+            """
+SELECT [r].[OptionalReferenceTrunk], [r].[Id], JSON_QUERY([r].[OptionalReferenceTrunk], '$.RequiredReferenceBranch'), [r].[OptionalReferenceTrunk], JSON_QUERY([r].[OptionalReferenceTrunk], '$.RequiredReferenceBranch')
+FROM [RootEntities] AS [r]
+ORDER BY [r].[Id]
+""");
+    }
+
+    public override async Task Select_trunk_and_trunk_duplicated(bool async)
+    {
+        await base.Select_trunk_and_trunk_duplicated(async);
+
+        AssertSql(
+            """
+SELECT [r].[RequiredReferenceTrunk], [r].[Id], JSON_QUERY([r].[RequiredReferenceTrunk], '$.OptionalReferenceBranch.RequiredReferenceLeaf'), [r].[RequiredReferenceTrunk], JSON_QUERY([r].[RequiredReferenceTrunk], '$.OptionalReferenceBranch.RequiredReferenceLeaf')
+FROM [RootEntities] AS [r]
+ORDER BY [r].[Id]
+""");
+    }
+
+    public override async Task Select_leaf_trunk_root(bool async)
+    {
+        await base.Select_leaf_trunk_root(async);
+
+        AssertSql(
+            """
+SELECT JSON_QUERY([r].[RequiredReferenceTrunk], '$.RequiredReferenceBranch.RequiredReferenceLeaf'), [r].[Id], [r].[RequiredReferenceTrunk], [r].[Name], [r].[OptionalReferenceTrunkId], [r].[RequiredReferenceTrunkId], [r].[CollectionTrunk], [r].[OptionalReferenceTrunk], [r].[RequiredReferenceTrunk]
+FROM [RootEntities] AS [r]
+""");
+    }
+
+    public override async Task Select_subquery_root_set_required_trunk_FirstOrDefault_branch(bool async)
+    {
+        await base.Select_subquery_root_set_required_trunk_FirstOrDefault_branch(async);
+
+        AssertSql(
+            """
+SELECT [r1].[c], [r1].[Id]
+FROM [RootEntities] AS [r]
+OUTER APPLY (
+    SELECT TOP(1) JSON_QUERY([r0].[RequiredReferenceTrunk], '$.RequiredReferenceBranch') AS [c], [r0].[Id]
+    FROM [RootEntities] AS [r0]
+    ORDER BY [r0].[Id]
+) AS [r1]
+ORDER BY [r].[Id]
+""");
+    }
+
+    public override async Task Select_subquery_root_set_optional_trunk_FirstOrDefault_branch(bool async)
+    {
+        await base.Select_subquery_root_set_optional_trunk_FirstOrDefault_branch(async);
+
+        AssertSql(
+            """
+SELECT [r1].[c], [r1].[Id]
+FROM [RootEntities] AS [r]
+OUTER APPLY (
+    SELECT TOP(1) JSON_QUERY([r0].[OptionalReferenceTrunk], '$.OptionalReferenceBranch') AS [c], [r0].[Id]
+    FROM [RootEntities] AS [r0]
+    ORDER BY [r0].[Id]
+) AS [r1]
+ORDER BY [r].[Id]
+""");
+    }
+
+    private void AssertSql(params string[] expected)
+        => Fixture.TestSqlLoggerFactory.AssertBaseline(expected);
+}
diff --git a/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/Projection/OwnedJsonReferenceProjectionSqlServerTest.cs b/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/Projection/OwnedJsonReferenceProjectionSqlServerTest.cs
new file mode 100644
index 0000000000..433358b556
--- /dev/null
+++ b/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/Projection/OwnedJsonReferenceProjectionSqlServerTest.cs
@@ -0,0 +1,81 @@
+﻿// Licensed to the .NET Foundation under one or more agreements.
+// The .NET Foundation licenses this file to you under the MIT license.
+
+namespace Microsoft.EntityFrameworkCore.Query.Relationships.Projection;
+
+public class OwnedJsonReferenceProjectionSqlServerTest
+    : OwnedJsonReferenceProjectionRelationalTestBase<OwnedJsonRelationshipsSqlServerFixture>
+{
+    public OwnedJsonReferenceProjectionSqlServerTest(OwnedJsonRelationshipsSqlServerFixture fixture, ITestOutputHelper testOutputHelper)
+        : base(fixture)
+    {
+        Fixture.TestSqlLoggerFactory.Clear();
+        Fixture.TestSqlLoggerFactory.SetTestOutputHelper(testOutputHelper);
+    }
+
+    public override async Task Select_root(bool async)
+    {
+        await base.Select_root(async);
+
+        AssertSql(
+            """
+SELECT [r].[Id], [r].[Name], [r].[OptionalReferenceTrunkId], [r].[RequiredReferenceTrunkId], [r].[CollectionTrunk], [r].[OptionalReferenceTrunk], [r].[RequiredReferenceTrunk]
+FROM [RootEntities] AS [r]
+""");
+    }
+
+    public override async Task Select_root_duplicated(bool async)
+    {
+        await base.Select_root_duplicated(async);
+
+        AssertSql(
+            """
+SELECT [r].[Id], [r].[Name], [r].[OptionalReferenceTrunkId], [r].[RequiredReferenceTrunkId], [r].[CollectionTrunk], [r].[OptionalReferenceTrunk], [r].[RequiredReferenceTrunk], [r].[CollectionTrunk], [r].[OptionalReferenceTrunk], [r].[RequiredReferenceTrunk]
+FROM [RootEntities] AS [r]
+""");
+    }
+
+    public override Task Select_trunk_optional(bool async)
+        => AssertCantTrackJson(() => base.Select_trunk_optional(async));
+
+    public override Task Select_trunk_required(bool async)
+        => AssertCantTrackJson(() => base.Select_trunk_required(async));
+
+    public override Task Select_branch_required_required(bool async)
+        => AssertCantTrackJson(() => base.Select_branch_required_required(async));
+
+    public override Task Select_branch_required_optional(bool async)
+        => AssertCantTrackJson(() => base.Select_branch_required_optional(async));
+
+    public override  Task Select_branch_optional_required(bool async)
+        => AssertCantTrackJson(() => base.Select_branch_optional_required(async));
+
+    public override Task Select_branch_optional_optional(bool async)
+        => AssertCantTrackJson(() => base.Select_branch_optional_optional(async));
+
+    public override Task Select_trunk_and_branch_duplicated(bool async)
+        => AssertCantTrackJson(() => base.Select_trunk_and_branch_duplicated(async));
+
+    public override Task Select_trunk_and_trunk_duplicated(bool async)
+        => AssertCantTrackJson(() => base.Select_trunk_and_trunk_duplicated(async));
+
+    public override Task Select_leaf_trunk_root(bool async)
+        => AssertCantTrackJson(() => base.Select_leaf_trunk_root(async));
+
+    public override Task Select_subquery_root_set_required_trunk_FirstOrDefault_branch(bool async)
+        => AssertCantTrackJson(() => base.Select_subquery_root_set_required_trunk_FirstOrDefault_branch(async));
+
+    public override Task Select_subquery_root_set_optional_trunk_FirstOrDefault_branch(bool async)
+        => AssertCantTrackJson(() => base.Select_subquery_root_set_optional_trunk_FirstOrDefault_branch(async));
+
+    private async Task AssertCantTrackJson(Func<Task> test)
+    {
+        var message = (await Assert.ThrowsAsync<InvalidOperationException>(test)).Message;
+
+        Assert.Equal(RelationalStrings.JsonEntityOrCollectionProjectedAtRootLevelInTrackingQuery("AsNoTracking"), message);
+        AssertSql();
+    }
+
+    private void AssertSql(params string[] expected)
+        => Fixture.TestSqlLoggerFactory.AssertBaseline(expected);
+}
diff --git a/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/Projection/OwnedJsonTypeNoTrackingProjectionSqlServerTest.cs b/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/Projection/OwnedJsonTypeNoTrackingProjectionSqlServerTest.cs
new file mode 100644
index 0000000000..5afb47eff4
--- /dev/null
+++ b/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/Projection/OwnedJsonTypeNoTrackingProjectionSqlServerTest.cs
@@ -0,0 +1,17 @@
+﻿// Licensed to the .NET Foundation under one or more agreements.
+// The .NET Foundation licenses this file to you under the MIT license.
+
+namespace Microsoft.EntityFrameworkCore.Query.Relationships.Projection;
+
+// Only adding NoTracking version - no point to do both and most of the tests don't work in tracking (projecting without owner)
+[SqlServerCondition(SqlServerCondition.SupportsJsonType)]
+public class OwnedJsonTypeNoTrackingProjectionSqlServerTest
+    : ProjectionTestBase<OwnedJsonTypeRelationshipsSqlServerFixture>
+{
+    public OwnedJsonTypeNoTrackingProjectionSqlServerTest(OwnedJsonTypeRelationshipsSqlServerFixture fixture, ITestOutputHelper testOutputHelper)
+        : base(fixture)
+    {
+        Fixture.TestSqlLoggerFactory.Clear();
+        Fixture.TestSqlLoggerFactory.SetTestOutputHelper(testOutputHelper);
+    }
+}
diff --git a/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/Projection/OwnedJsonTypeReferenceNoTrackingProjectionSqlServerTest.cs b/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/Projection/OwnedJsonTypeReferenceNoTrackingProjectionSqlServerTest.cs
new file mode 100644
index 0000000000..9ab6744ce5
--- /dev/null
+++ b/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/Projection/OwnedJsonTypeReferenceNoTrackingProjectionSqlServerTest.cs
@@ -0,0 +1,17 @@
+﻿// Licensed to the .NET Foundation under one or more agreements.
+// The .NET Foundation licenses this file to you under the MIT license.
+
+namespace Microsoft.EntityFrameworkCore.Query.Relationships.Projection;
+
+// Only adding NoTracking version - no point to do both and most of the tests don't work in tracking (projecting without owner)
+[SqlServerCondition(SqlServerCondition.SupportsJsonType)]
+public class OwnedJsonTypeReferenceNoTrackingProjectionSqlServerTest
+    : ReferenceProjectionTestBase<OwnedJsonTypeRelationshipsSqlServerFixture>
+{
+    public OwnedJsonTypeReferenceNoTrackingProjectionSqlServerTest(OwnedJsonTypeRelationshipsSqlServerFixture fixture, ITestOutputHelper testOutputHelper)
+        : base(fixture)
+    {
+        Fixture.TestSqlLoggerFactory.Clear();
+        Fixture.TestSqlLoggerFactory.SetTestOutputHelper(testOutputHelper);
+    }
+}
diff --git a/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/Projection/OwnedNoTrackingProjectionSqlServerTest.cs b/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/Projection/OwnedNoTrackingProjectionSqlServerTest.cs
new file mode 100644
index 0000000000..f1acde489d
--- /dev/null
+++ b/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/Projection/OwnedNoTrackingProjectionSqlServerTest.cs
@@ -0,0 +1,228 @@
+﻿// Licensed to the .NET Foundation under one or more agreements.
+// The .NET Foundation licenses this file to you under the MIT license.
+
+namespace Microsoft.EntityFrameworkCore.Query.Relationships.Projection;
+
+public class OwnedNoTrackingProjectionSqlServerTest
+    : OwnedNoTrackingProjectionRelationalTestBase<OwnedRelationshipsSqlServerFixture>
+{
+    public OwnedNoTrackingProjectionSqlServerTest(OwnedRelationshipsSqlServerFixture fixture, ITestOutputHelper testOutputHelper)
+        : base(fixture)
+    {
+        Fixture.TestSqlLoggerFactory.Clear();
+        Fixture.TestSqlLoggerFactory.SetTestOutputHelper(testOutputHelper);
+    }
+
+    public override async Task Select_trunk_collection(bool async)
+    {
+        await base.Select_trunk_collection(async);
+
+        AssertSql(
+            """
+SELECT [r].[Id], [s0].[RelationshipsRootEntityId], [s0].[Id1], [s0].[Name], [s0].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s0].[RelationshipsTrunkEntityId1], [s0].[Id10], [s0].[Name0], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityId1], [s0].[RelationshipsBranchEntityId1], [s0].[Id100], [s0].[Name00], [s0].[OptionalReferenceLeaf_Name], [s0].[RequiredReferenceLeaf_Name], [s0].[OptionalReferenceBranch_Name], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityId10], [s0].[Id11], [s0].[Name1], [s0].[OptionalReferenceBranch_OptionalReferenceLeaf_Name], [s0].[OptionalReferenceBranch_RequiredReferenceLeaf_Name], [s0].[RequiredReferenceBranch_Name], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityId11], [s0].[Id12], [s0].[Name2], [s0].[RequiredReferenceBranch_OptionalReferenceLeaf_Name], [s0].[RequiredReferenceBranch_RequiredReferenceLeaf_Name]
+FROM [RootEntities] AS [r]
+LEFT JOIN (
+    SELECT [r0].[RelationshipsRootEntityId], [r0].[Id1], [r0].[Name], [s].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s].[RelationshipsTrunkEntityId1], [s].[Id1] AS [Id10], [s].[Name] AS [Name0], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityId1], [s].[RelationshipsBranchEntityId1], [s].[Id10] AS [Id100], [s].[Name0] AS [Name00], [s].[OptionalReferenceLeaf_Name], [s].[RequiredReferenceLeaf_Name], [r0].[OptionalReferenceBranch_Name], [r3].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [r3].[RelationshipsBranchEntityRelationshipsTrunkEntityId1] AS [RelationshipsBranchEntityRelationshipsTrunkEntityId10], [r3].[Id1] AS [Id11], [r3].[Name] AS [Name1], [r0].[OptionalReferenceBranch_OptionalReferenceLeaf_Name], [r0].[OptionalReferenceBranch_RequiredReferenceLeaf_Name], [r0].[RequiredReferenceBranch_Name], [r4].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [r4].[RelationshipsBranchEntityRelationshipsTrunkEntityId1] AS [RelationshipsBranchEntityRelationshipsTrunkEntityId11], [r4].[Id1] AS [Id12], [r4].[Name] AS [Name2], [r0].[RequiredReferenceBranch_OptionalReferenceLeaf_Name], [r0].[RequiredReferenceBranch_RequiredReferenceLeaf_Name]
+    FROM [Root_CollectionTrunk] AS [r0]
+    LEFT JOIN (
+        SELECT [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r1].[RelationshipsTrunkEntityId1], [r1].[Id1], [r1].[Name], [r2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r2].[RelationshipsBranchEntityRelationshipsTrunkEntityId1], [r2].[RelationshipsBranchEntityId1], [r2].[Id1] AS [Id10], [r2].[Name] AS [Name0], [r1].[OptionalReferenceLeaf_Name], [r1].[RequiredReferenceLeaf_Name]
+        FROM [Root_CollectionTrunk_CollectionBranch] AS [r1]
+        LEFT JOIN [Root_CollectionTrunk_CollectionBranch_CollectionLeaf] AS [r2] ON [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r1].[RelationshipsTrunkEntityId1] = [r2].[RelationshipsBranchEntityRelationshipsTrunkEntityId1] AND [r1].[Id1] = [r2].[RelationshipsBranchEntityId1]
+    ) AS [s] ON [r0].[RelationshipsRootEntityId] = [s].[RelationshipsTrunkEntityRelationshipsRootEntityId] AND [r0].[Id1] = [s].[RelationshipsTrunkEntityId1]
+    LEFT JOIN [Root_CollectionTrunk_OptionalReferenceBranch_CollectionLeaf] AS [r3] ON CASE
+        WHEN [r0].[OptionalReferenceBranch_Name] IS NOT NULL THEN [r0].[RelationshipsRootEntityId]
+    END = [r3].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND CASE
+        WHEN [r0].[OptionalReferenceBranch_Name] IS NOT NULL THEN [r0].[Id1]
+    END = [r3].[RelationshipsBranchEntityRelationshipsTrunkEntityId1]
+    LEFT JOIN [Root_CollectionTrunk_RequiredReferenceBranch_CollectionLeaf] AS [r4] ON [r0].[RelationshipsRootEntityId] = [r4].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r0].[Id1] = [r4].[RelationshipsBranchEntityRelationshipsTrunkEntityId1]
+) AS [s0] ON [r].[Id] = [s0].[RelationshipsRootEntityId]
+ORDER BY [r].[Id], [s0].[RelationshipsRootEntityId], [s0].[Id1], [s0].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s0].[RelationshipsTrunkEntityId1], [s0].[Id10], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityId1], [s0].[RelationshipsBranchEntityId1], [s0].[Id100], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityId10], [s0].[Id11], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityId11]
+""");
+    }
+
+    public override async Task Select_branch_required_collection(bool async)
+    {
+        await base.Select_branch_required_collection(async);
+
+        AssertSql(
+"""
+SELECT [r].[Id], [s].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s].[Id1], [s].[Name], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s].[RelationshipsBranchEntityId1], [s].[Id10], [s].[Name0], [s].[OptionalReferenceLeaf_Name], [s].[RequiredReferenceLeaf_Name]
+FROM [RootEntities] AS [r]
+LEFT JOIN (
+    SELECT [r0].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r0].[Id1], [r0].[Name], [r1].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r1].[RelationshipsBranchEntityId1], [r1].[Id1] AS [Id10], [r1].[Name] AS [Name0], [r0].[OptionalReferenceLeaf_Name], [r0].[RequiredReferenceLeaf_Name]
+    FROM [Root_RequiredReferenceTrunk_CollectionBranch] AS [r0]
+    LEFT JOIN [Root_RequiredReferenceTrunk_CollectionBranch_CollectionLeaf] AS [r1] ON [r0].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r1].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r0].[Id1] = [r1].[RelationshipsBranchEntityId1]
+) AS [s] ON [r].[Id] = [s].[RelationshipsTrunkEntityRelationshipsRootEntityId]
+ORDER BY [r].[Id], [s].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s].[Id1], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s].[RelationshipsBranchEntityId1]
+""");
+    }
+
+    public override async Task Select_branch_optional_collection(bool async)
+    {
+        await base.Select_branch_optional_collection(async);
+
+        AssertSql(
+            """
+SELECT [r].[Id], [s].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s].[Id1], [s].[Name], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s].[RelationshipsBranchEntityId1], [s].[Id10], [s].[Name0], [s].[OptionalReferenceLeaf_Name], [s].[RequiredReferenceLeaf_Name]
+FROM [RootEntities] AS [r]
+LEFT JOIN (
+    SELECT [r0].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r0].[Id1], [r0].[Name], [r1].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r1].[RelationshipsBranchEntityId1], [r1].[Id1] AS [Id10], [r1].[Name] AS [Name0], [r0].[OptionalReferenceLeaf_Name], [r0].[RequiredReferenceLeaf_Name]
+    FROM [Root_RequiredReferenceTrunk_CollectionBranch] AS [r0]
+    LEFT JOIN [Root_RequiredReferenceTrunk_CollectionBranch_CollectionLeaf] AS [r1] ON [r0].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r1].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r0].[Id1] = [r1].[RelationshipsBranchEntityId1]
+) AS [s] ON [r].[Id] = [s].[RelationshipsTrunkEntityRelationshipsRootEntityId]
+ORDER BY [r].[Id], [s].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s].[Id1], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s].[RelationshipsBranchEntityId1]
+""");
+    }
+
+    public override async Task Select_multiple_branch_leaf(bool async)
+    {
+        await base.Select_multiple_branch_leaf(async);
+
+        AssertSql(
+            """
+SELECT [r].[Id], [r].[RequiredReferenceTrunk_RequiredReferenceBranch_Name], [r0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r0].[Id1], [r0].[Name], [r].[RequiredReferenceTrunk_RequiredReferenceBranch_OptionalReferenceLeaf_Name], [r].[RequiredReferenceTrunk_RequiredReferenceBranch_RequiredReferenceLeaf_Name], [r1].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r1].[Id1], [r1].[Name], [s].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s].[Id1], [s].[Name], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s].[RelationshipsBranchEntityId1], [s].[Id10], [s].[Name0], [s].[OptionalReferenceLeaf_Name], [s].[RequiredReferenceLeaf_Name]
+FROM [RootEntities] AS [r]
+LEFT JOIN [Root_RequiredReferenceTrunk_RequiredReferenceBranch_CollectionLeaf] AS [r0] ON [r].[Id] = [r0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_RequiredReferenceTrunk_RequiredReferenceBranch_CollectionLeaf] AS [r1] ON [r].[Id] = [r1].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN (
+    SELECT [r2].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r2].[Id1], [r2].[Name], [r3].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r3].[RelationshipsBranchEntityId1], [r3].[Id1] AS [Id10], [r3].[Name] AS [Name0], [r2].[OptionalReferenceLeaf_Name], [r2].[RequiredReferenceLeaf_Name]
+    FROM [Root_RequiredReferenceTrunk_CollectionBranch] AS [r2]
+    LEFT JOIN [Root_RequiredReferenceTrunk_CollectionBranch_CollectionLeaf] AS [r3] ON [r2].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r3].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r2].[Id1] = [r3].[RelationshipsBranchEntityId1]
+) AS [s] ON [r].[Id] = [s].[RelationshipsTrunkEntityRelationshipsRootEntityId]
+ORDER BY [r].[Id], [r0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r0].[Id1], [r1].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r1].[Id1], [s].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s].[Id1], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s].[RelationshipsBranchEntityId1]
+""");
+    }
+
+    public override async Task Select_subquery_root_set_trunk_FirstOrDefault_collection(bool async)
+    {
+        await base.Select_subquery_root_set_trunk_FirstOrDefault_collection(async);
+
+        AssertSql(
+            """
+SELECT [r].[Id], [r3].[Id], [s].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s].[Id1], [s].[Name], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s].[RelationshipsBranchEntityId1], [s].[Id10], [s].[Name0], [s].[OptionalReferenceLeaf_Name], [s].[RequiredReferenceLeaf_Name], [r3].[c]
+FROM [RootEntities] AS [r]
+OUTER APPLY (
+    SELECT TOP(1) 1 AS [c], [r0].[Id]
+    FROM [RootEntities] AS [r0]
+    ORDER BY [r0].[Id]
+) AS [r3]
+LEFT JOIN (
+    SELECT [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r1].[Id1], [r1].[Name], [r2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r2].[RelationshipsBranchEntityId1], [r2].[Id1] AS [Id10], [r2].[Name] AS [Name0], [r1].[OptionalReferenceLeaf_Name], [r1].[RequiredReferenceLeaf_Name]
+    FROM [Root_RequiredReferenceTrunk_CollectionBranch] AS [r1]
+    LEFT JOIN [Root_RequiredReferenceTrunk_CollectionBranch_CollectionLeaf] AS [r2] ON [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r1].[Id1] = [r2].[RelationshipsBranchEntityId1]
+) AS [s] ON [r3].[Id] = [s].[RelationshipsTrunkEntityRelationshipsRootEntityId]
+ORDER BY [r].[Id], [r3].[Id], [s].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s].[Id1], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s].[RelationshipsBranchEntityId1]
+""");
+    }
+
+    public override async Task Select_subquery_root_set_complex_projection_including_references_to_outer_FirstOrDefault(bool async)
+    {
+        await base.Select_subquery_root_set_complex_projection_including_references_to_outer_FirstOrDefault(async);
+
+        AssertSql(
+            """
+SELECT [r].[Id], [r8].[Id], [s].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s].[Id1], [s].[Name], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s].[RelationshipsBranchEntityId1], [s].[Id10], [s].[Name0], [s].[OptionalReferenceLeaf_Name], [s].[RequiredReferenceLeaf_Name], [r8].[RequiredReferenceTrunk_Name], [s0].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s0].[Id1], [s0].[Name], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s0].[RelationshipsBranchEntityId1], [s0].[Id10], [s0].[Name0], [s0].[OptionalReferenceLeaf_Name], [s0].[RequiredReferenceLeaf_Name], [r8].[RequiredReferenceTrunk_OptionalReferenceBranch_Name], [r5].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r5].[Id1], [r5].[Name], [r8].[RequiredReferenceTrunk_OptionalReferenceBranch_OptionalReferenceLeaf_Name], [r8].[RequiredReferenceTrunk_OptionalReferenceBranch_RequiredReferenceLeaf_Name], [r8].[RequiredReferenceTrunk_RequiredReferenceBranch_Name], [r6].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r6].[Id1], [r6].[Name], [r8].[RequiredReferenceTrunk_RequiredReferenceBranch_OptionalReferenceLeaf_Name], [r8].[RequiredReferenceTrunk_RequiredReferenceBranch_RequiredReferenceLeaf_Name], [r7].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r7].[Id1], [r7].[Name], [r8].[RequiredReferenceTrunk_RequiredReferenceBranch_Name0], [r8].[c]
+FROM [RootEntities] AS [r]
+OUTER APPLY (
+    SELECT TOP(1) [r0].[Id], [r0].[RequiredReferenceTrunk_Name], [r0].[RequiredReferenceTrunk_OptionalReferenceBranch_Name], [r0].[RequiredReferenceTrunk_OptionalReferenceBranch_OptionalReferenceLeaf_Name], [r0].[RequiredReferenceTrunk_OptionalReferenceBranch_RequiredReferenceLeaf_Name], [r0].[RequiredReferenceTrunk_RequiredReferenceBranch_Name], [r0].[RequiredReferenceTrunk_RequiredReferenceBranch_OptionalReferenceLeaf_Name], [r0].[RequiredReferenceTrunk_RequiredReferenceBranch_RequiredReferenceLeaf_Name], [r].[RequiredReferenceTrunk_RequiredReferenceBranch_Name] AS [RequiredReferenceTrunk_RequiredReferenceBranch_Name0], 1 AS [c]
+    FROM [RootEntities] AS [r0]
+    ORDER BY [r0].[Id]
+) AS [r8]
+LEFT JOIN (
+    SELECT [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r1].[Id1], [r1].[Name], [r2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r2].[RelationshipsBranchEntityId1], [r2].[Id1] AS [Id10], [r2].[Name] AS [Name0], [r1].[OptionalReferenceLeaf_Name], [r1].[RequiredReferenceLeaf_Name]
+    FROM [Root_RequiredReferenceTrunk_CollectionBranch] AS [r1]
+    LEFT JOIN [Root_RequiredReferenceTrunk_CollectionBranch_CollectionLeaf] AS [r2] ON [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r1].[Id1] = [r2].[RelationshipsBranchEntityId1]
+) AS [s] ON [r].[Id] = [s].[RelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN (
+    SELECT [r3].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r3].[Id1], [r3].[Name], [r4].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r4].[RelationshipsBranchEntityId1], [r4].[Id1] AS [Id10], [r4].[Name] AS [Name0], [r3].[OptionalReferenceLeaf_Name], [r3].[RequiredReferenceLeaf_Name]
+    FROM [Root_RequiredReferenceTrunk_CollectionBranch] AS [r3]
+    LEFT JOIN [Root_RequiredReferenceTrunk_CollectionBranch_CollectionLeaf] AS [r4] ON [r3].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r4].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r3].[Id1] = [r4].[RelationshipsBranchEntityId1]
+) AS [s0] ON [r8].[Id] = [s0].[RelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_RequiredReferenceTrunk_OptionalReferenceBranch_CollectionLeaf] AS [r5] ON CASE
+    WHEN [r8].[RequiredReferenceTrunk_OptionalReferenceBranch_Name] IS NOT NULL THEN [r8].[Id]
+END = [r5].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_RequiredReferenceTrunk_RequiredReferenceBranch_CollectionLeaf] AS [r6] ON [r8].[Id] = [r6].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_RequiredReferenceTrunk_RequiredReferenceBranch_CollectionLeaf] AS [r7] ON [r8].[Id] = [r7].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+ORDER BY [r].[Id], [r8].[Id], [s].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s].[Id1], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s].[RelationshipsBranchEntityId1], [s].[Id10], [s0].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s0].[Id1], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s0].[RelationshipsBranchEntityId1], [s0].[Id10], [r5].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r5].[Id1], [r6].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r6].[Id1], [r7].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+""");
+    }
+
+    public override async Task Select_subquery_root_set_complex_projection_FirstOrDefault_project_reference_to_outer(bool async)
+    {
+        await base.Select_subquery_root_set_complex_projection_FirstOrDefault_project_reference_to_outer(async);
+
+        AssertSql(
+            """
+SELECT [r].[Id], [r3].[Id], [s].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s].[Id1], [s].[Name], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s].[RelationshipsBranchEntityId1], [s].[Id10], [s].[Name0], [s].[OptionalReferenceLeaf_Name], [s].[RequiredReferenceLeaf_Name], [r3].[c]
+FROM [RootEntities] AS [r]
+OUTER APPLY (
+    SELECT TOP(1) 1 AS [c], [r0].[Id]
+    FROM [RootEntities] AS [r0]
+    ORDER BY [r0].[Id]
+) AS [r3]
+LEFT JOIN (
+    SELECT [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r1].[Id1], [r1].[Name], [r2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r2].[RelationshipsBranchEntityId1], [r2].[Id1] AS [Id10], [r2].[Name] AS [Name0], [r1].[OptionalReferenceLeaf_Name], [r1].[RequiredReferenceLeaf_Name]
+    FROM [Root_RequiredReferenceTrunk_CollectionBranch] AS [r1]
+    LEFT JOIN [Root_RequiredReferenceTrunk_CollectionBranch_CollectionLeaf] AS [r2] ON [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r1].[Id1] = [r2].[RelationshipsBranchEntityId1]
+) AS [s] ON [r].[Id] = [s].[RelationshipsTrunkEntityRelationshipsRootEntityId]
+ORDER BY [r].[Id], [r3].[Id], [s].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s].[Id1], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s].[RelationshipsBranchEntityId1]
+""");
+    }
+
+    public override async Task SelectMany_trunk_collection(bool async)
+    {
+        await base.SelectMany_trunk_collection(async);
+
+        AssertSql(
+            """
+SELECT [r0].[RelationshipsRootEntityId], [r0].[Id1], [r0].[Name], [r].[Id], [s].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s].[RelationshipsTrunkEntityId1], [s].[Id1], [s].[Name], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityId1], [s].[RelationshipsBranchEntityId1], [s].[Id10], [s].[Name0], [s].[OptionalReferenceLeaf_Name], [s].[RequiredReferenceLeaf_Name], [r0].[OptionalReferenceBranch_Name], [r3].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r3].[RelationshipsBranchEntityRelationshipsTrunkEntityId1], [r3].[Id1], [r3].[Name], [r0].[OptionalReferenceBranch_OptionalReferenceLeaf_Name], [r0].[OptionalReferenceBranch_RequiredReferenceLeaf_Name], [r0].[RequiredReferenceBranch_Name], [r4].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r4].[RelationshipsBranchEntityRelationshipsTrunkEntityId1], [r4].[Id1], [r4].[Name], [r0].[RequiredReferenceBranch_OptionalReferenceLeaf_Name], [r0].[RequiredReferenceBranch_RequiredReferenceLeaf_Name]
+FROM [RootEntities] AS [r]
+INNER JOIN [Root_CollectionTrunk] AS [r0] ON [r].[Id] = [r0].[RelationshipsRootEntityId]
+LEFT JOIN (
+    SELECT [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r1].[RelationshipsTrunkEntityId1], [r1].[Id1], [r1].[Name], [r2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r2].[RelationshipsBranchEntityRelationshipsTrunkEntityId1], [r2].[RelationshipsBranchEntityId1], [r2].[Id1] AS [Id10], [r2].[Name] AS [Name0], [r1].[OptionalReferenceLeaf_Name], [r1].[RequiredReferenceLeaf_Name]
+    FROM [Root_CollectionTrunk_CollectionBranch] AS [r1]
+    LEFT JOIN [Root_CollectionTrunk_CollectionBranch_CollectionLeaf] AS [r2] ON [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r1].[RelationshipsTrunkEntityId1] = [r2].[RelationshipsBranchEntityRelationshipsTrunkEntityId1] AND [r1].[Id1] = [r2].[RelationshipsBranchEntityId1]
+) AS [s] ON [r0].[RelationshipsRootEntityId] = [s].[RelationshipsTrunkEntityRelationshipsRootEntityId] AND [r0].[Id1] = [s].[RelationshipsTrunkEntityId1]
+LEFT JOIN [Root_CollectionTrunk_OptionalReferenceBranch_CollectionLeaf] AS [r3] ON CASE
+    WHEN [r0].[OptionalReferenceBranch_Name] IS NOT NULL THEN [r0].[RelationshipsRootEntityId]
+END = [r3].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND CASE
+    WHEN [r0].[OptionalReferenceBranch_Name] IS NOT NULL THEN [r0].[Id1]
+END = [r3].[RelationshipsBranchEntityRelationshipsTrunkEntityId1]
+LEFT JOIN [Root_CollectionTrunk_RequiredReferenceBranch_CollectionLeaf] AS [r4] ON [r0].[RelationshipsRootEntityId] = [r4].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r0].[Id1] = [r4].[RelationshipsBranchEntityRelationshipsTrunkEntityId1]
+ORDER BY [r].[Id], [r0].[RelationshipsRootEntityId], [r0].[Id1], [s].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s].[RelationshipsTrunkEntityId1], [s].[Id1], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityId1], [s].[RelationshipsBranchEntityId1], [s].[Id10], [r3].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r3].[RelationshipsBranchEntityRelationshipsTrunkEntityId1], [r3].[Id1], [r4].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r4].[RelationshipsBranchEntityRelationshipsTrunkEntityId1]
+""");
+    }
+
+    public override async Task SelectMany_required_trunk_reference_branch_collection(bool async)
+    {
+        await base.SelectMany_required_trunk_reference_branch_collection(async);
+
+        AssertSql(
+            """
+SELECT [r0].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r0].[Id1], [r0].[Name], [r].[Id], [r1].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r1].[RelationshipsBranchEntityId1], [r1].[Id1], [r1].[Name], [r0].[OptionalReferenceLeaf_Name], [r0].[RequiredReferenceLeaf_Name]
+FROM [RootEntities] AS [r]
+INNER JOIN [Root_RequiredReferenceTrunk_CollectionBranch] AS [r0] ON [r].[Id] = [r0].[RelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_RequiredReferenceTrunk_CollectionBranch_CollectionLeaf] AS [r1] ON [r0].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r1].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r0].[Id1] = [r1].[RelationshipsBranchEntityId1]
+ORDER BY [r].[Id], [r0].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r0].[Id1], [r1].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r1].[RelationshipsBranchEntityId1]
+""");
+    }
+
+    public override async Task SelectMany_optional_trunk_reference_branch_collection(bool async)
+    {
+        await base.SelectMany_optional_trunk_reference_branch_collection(async);
+
+        AssertSql(
+            """
+SELECT [r0].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r0].[Id1], [r0].[Name], [r].[Id], [r1].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r1].[RelationshipsBranchEntityId1], [r1].[Id1], [r1].[Name], [r0].[OptionalReferenceLeaf_Name], [r0].[RequiredReferenceLeaf_Name]
+FROM [RootEntities] AS [r]
+INNER JOIN [Root_OptionalReferenceTrunk_CollectionBranch] AS [r0] ON CASE
+    WHEN [r].[OptionalReferenceTrunk_Name] IS NOT NULL THEN [r].[Id]
+END = [r0].[RelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_OptionalReferenceTrunk_CollectionBranch_CollectionLeaf] AS [r1] ON [r0].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r1].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r0].[Id1] = [r1].[RelationshipsBranchEntityId1]
+ORDER BY [r].[Id], [r0].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r0].[Id1], [r1].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r1].[RelationshipsBranchEntityId1]
+""");
+    }
+
+    private void AssertSql(params string[] expected)
+        => Fixture.TestSqlLoggerFactory.AssertBaseline(expected);
+}
diff --git a/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/Projection/OwnedProjectionSqlServerTest.cs b/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/Projection/OwnedProjectionSqlServerTest.cs
new file mode 100644
index 0000000000..0fff389e2e
--- /dev/null
+++ b/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/Projection/OwnedProjectionSqlServerTest.cs
@@ -0,0 +1,56 @@
+﻿// Licensed to the .NET Foundation under one or more agreements.
+// The .NET Foundation licenses this file to you under the MIT license.
+
+namespace Microsoft.EntityFrameworkCore.Query.Relationships.Projection;
+
+public class OwnedProjectionSqlServerTest
+    : OwnedProjectionRelationalTestBase<OwnedRelationshipsSqlServerFixture>
+{
+    public OwnedProjectionSqlServerTest(OwnedRelationshipsSqlServerFixture fixture, ITestOutputHelper testOutputHelper)
+        : base(fixture)
+    {
+        Fixture.TestSqlLoggerFactory.Clear();
+        Fixture.TestSqlLoggerFactory.SetTestOutputHelper(testOutputHelper);
+    }
+
+    public override Task Select_trunk_collection(bool async)
+        => AssertCantTrackOwned(() => base.Select_trunk_collection(async));
+
+    public override Task Select_branch_required_collection(bool async)
+        => AssertCantTrackOwned(() => base.Select_branch_required_collection(async));
+
+    public override Task Select_branch_optional_collection(bool async)
+        => AssertCantTrackOwned(() => base.Select_branch_optional_collection(async));
+
+    public override Task Select_multiple_branch_leaf(bool async)
+        => AssertCantTrackOwned(() => base.Select_multiple_branch_leaf(async));
+
+    public override Task Select_subquery_root_set_trunk_FirstOrDefault_collection(bool async)
+        => AssertCantTrackOwned(() => base.Select_subquery_root_set_trunk_FirstOrDefault_collection(async));
+
+    public override Task Select_subquery_root_set_complex_projection_including_references_to_outer_FirstOrDefault(bool async)
+        => AssertCantTrackOwned(() => base.Select_subquery_root_set_complex_projection_including_references_to_outer_FirstOrDefault(async));
+
+    public override Task Select_subquery_root_set_complex_projection_FirstOrDefault_project_reference_to_outer(bool async)
+        => AssertCantTrackOwned(() => base.Select_subquery_root_set_complex_projection_FirstOrDefault_project_reference_to_outer(async));
+
+    public override Task SelectMany_trunk_collection(bool async)
+        => AssertCantTrackOwned(() => base.SelectMany_trunk_collection(async));
+
+    public override Task SelectMany_required_trunk_reference_branch_collection(bool async)
+        => AssertCantTrackOwned(() => base.SelectMany_required_trunk_reference_branch_collection(async));
+
+    public override Task SelectMany_optional_trunk_reference_branch_collection(bool async)
+        => AssertCantTrackOwned(() => base.SelectMany_optional_trunk_reference_branch_collection(async));
+
+    private async Task AssertCantTrackOwned(Func<Task> test)
+    {
+        var message = (await Assert.ThrowsAsync<InvalidOperationException>(test)).Message;
+
+        Assert.Equal(CoreStrings.OwnedEntitiesCannotBeTrackedWithoutTheirOwner, message);
+        AssertSql();
+    }
+
+    private void AssertSql(params string[] expected)
+        => Fixture.TestSqlLoggerFactory.AssertBaseline(expected);
+}
diff --git a/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/InProjection/OwnedRelationshipsInProjectionNoTrackingQuerySqlServerTest.cs b/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/Projection/OwnedReferenceNoTrackingProjectionSqlServerTest.cs
similarity index 70%
rename from test/EFCore.SqlServer.FunctionalTests/Query/Relationships/InProjection/OwnedRelationshipsInProjectionNoTrackingQuerySqlServerTest.cs
rename to test/EFCore.SqlServer.FunctionalTests/Query/Relationships/Projection/OwnedReferenceNoTrackingProjectionSqlServerTest.cs
index b750d0deba..e7c149eb3d 100644
--- a/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/InProjection/OwnedRelationshipsInProjectionNoTrackingQuerySqlServerTest.cs
+++ b/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/Projection/OwnedReferenceNoTrackingProjectionSqlServerTest.cs
@@ -1,24 +1,24 @@
 ﻿// Licensed to the .NET Foundation under one or more agreements.
 // The .NET Foundation licenses this file to you under the MIT license.
 
-namespace Microsoft.EntityFrameworkCore.Query.Relationships.InProjection;
+namespace Microsoft.EntityFrameworkCore.Query.Relationships.Projection;
 
-public class OwnedRelationshipsInProjectionNoTrackingQuerySqlServerTest
-    : OwnedRelationshipsInProjectionNoTrackingQueryRelationalTestBase<OwnedRelationshipsQuerySqlServerFixture>
+public class OwnedReferenceNoTrackingProjectionSqlServerTest
+    : OwnedReferenceNoTrackingProjectionRelationalTestBase<OwnedRelationshipsSqlServerFixture>
 {
-    public OwnedRelationshipsInProjectionNoTrackingQuerySqlServerTest(OwnedRelationshipsQuerySqlServerFixture fixture, ITestOutputHelper testOutputHelper)
+    public OwnedReferenceNoTrackingProjectionSqlServerTest(OwnedRelationshipsSqlServerFixture fixture, ITestOutputHelper testOutputHelper)
         : base(fixture)
     {
         Fixture.TestSqlLoggerFactory.Clear();
         Fixture.TestSqlLoggerFactory.SetTestOutputHelper(testOutputHelper);
     }
 
-    public override async Task Project_root(bool async)
+    public override async Task Select_root(bool async)
     {
-        await base.Project_root(async);
+        await base.Select_root(async);
 
         AssertSql(
-"""
+            """
 SELECT [r].[Id], [r].[Name], [r].[OptionalReferenceTrunkId], [r].[RequiredReferenceTrunkId], [s0].[RelationshipsRootEntityId], [s0].[Id1], [s0].[Name], [s0].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s0].[RelationshipsTrunkEntityId1], [s0].[Id10], [s0].[Name0], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityId1], [s0].[RelationshipsBranchEntityId1], [s0].[Id100], [s0].[Name00], [s0].[OptionalReferenceLeaf_Name], [s0].[RequiredReferenceLeaf_Name], [s0].[OptionalReferenceBranch_Name], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityId10], [s0].[Id11], [s0].[Name1], [s0].[OptionalReferenceBranch_OptionalReferenceLeaf_Name], [s0].[OptionalReferenceBranch_RequiredReferenceLeaf_Name], [s0].[RequiredReferenceBranch_Name], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityId11], [s0].[Id12], [s0].[Name2], [s0].[RequiredReferenceBranch_OptionalReferenceLeaf_Name], [s0].[RequiredReferenceBranch_RequiredReferenceLeaf_Name], [r].[OptionalReferenceTrunk_Name], [s1].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s1].[Id1], [s1].[Name], [s1].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s1].[RelationshipsBranchEntityId1], [s1].[Id10], [s1].[Name0], [s1].[OptionalReferenceLeaf_Name], [s1].[RequiredReferenceLeaf_Name], [r].[OptionalReferenceTrunk_OptionalReferenceBranch_Name], [r7].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r7].[Id1], [r7].[Name], [r].[OptionalReferenceTrunk_OptionalReferenceBranch_OptionalReferenceLeaf_Name], [r].[OptionalReferenceTrunk_OptionalReferenceBranch_RequiredReferenceLeaf_Name], [r].[OptionalReferenceTrunk_RequiredReferenceBranch_Name], [r8].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r8].[Id1], [r8].[Name], [r].[OptionalReferenceTrunk_RequiredReferenceBranch_OptionalReferenceLeaf_Name], [r].[OptionalReferenceTrunk_RequiredReferenceBranch_RequiredReferenceLeaf_Name], [r].[RequiredReferenceTrunk_Name], [s2].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s2].[Id1], [s2].[Name], [s2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s2].[RelationshipsBranchEntityId1], [s2].[Id10], [s2].[Name0], [s2].[OptionalReferenceLeaf_Name], [s2].[RequiredReferenceLeaf_Name], [r].[RequiredReferenceTrunk_OptionalReferenceBranch_Name], [r11].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r11].[Id1], [r11].[Name], [r].[RequiredReferenceTrunk_OptionalReferenceBranch_OptionalReferenceLeaf_Name], [r].[RequiredReferenceTrunk_OptionalReferenceBranch_RequiredReferenceLeaf_Name], [r].[RequiredReferenceTrunk_RequiredReferenceBranch_Name], [r12].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r12].[Id1], [r12].[Name], [r].[RequiredReferenceTrunk_RequiredReferenceBranch_OptionalReferenceLeaf_Name], [r].[RequiredReferenceTrunk_RequiredReferenceBranch_RequiredReferenceLeaf_Name]
 FROM [RootEntities] AS [r]
 LEFT JOIN (
@@ -62,9 +62,9 @@ public override async Task Project_root(bool async)
 """);
     }
 
-    public override async Task Project_trunk_optional(bool async)
+    public override async Task Select_trunk_optional(bool async)
     {
-        await base.Project_trunk_optional(async);
+        await base.Select_trunk_optional(async);
 
         AssertSql(
             """
@@ -87,9 +87,9 @@ public override async Task Project_trunk_optional(bool async)
 """);
     }
 
-    public override async Task Project_trunk_required(bool async)
+    public override async Task Select_trunk_required(bool async)
     {
-        await base.Project_trunk_required(async);
+        await base.Select_trunk_required(async);
 
         AssertSql(
             """
@@ -108,36 +108,9 @@ public override async Task Project_trunk_required(bool async)
 """);
     }
 
-    public override async Task Project_trunk_collection(bool async)
-    {
-        await base.Project_trunk_collection(async);
-
-        AssertSql(
-            """
-SELECT [r].[Id], [s0].[RelationshipsRootEntityId], [s0].[Id1], [s0].[Name], [s0].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s0].[RelationshipsTrunkEntityId1], [s0].[Id10], [s0].[Name0], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityId1], [s0].[RelationshipsBranchEntityId1], [s0].[Id100], [s0].[Name00], [s0].[OptionalReferenceLeaf_Name], [s0].[RequiredReferenceLeaf_Name], [s0].[OptionalReferenceBranch_Name], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityId10], [s0].[Id11], [s0].[Name1], [s0].[OptionalReferenceBranch_OptionalReferenceLeaf_Name], [s0].[OptionalReferenceBranch_RequiredReferenceLeaf_Name], [s0].[RequiredReferenceBranch_Name], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityId11], [s0].[Id12], [s0].[Name2], [s0].[RequiredReferenceBranch_OptionalReferenceLeaf_Name], [s0].[RequiredReferenceBranch_RequiredReferenceLeaf_Name]
-FROM [RootEntities] AS [r]
-LEFT JOIN (
-    SELECT [r0].[RelationshipsRootEntityId], [r0].[Id1], [r0].[Name], [s].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s].[RelationshipsTrunkEntityId1], [s].[Id1] AS [Id10], [s].[Name] AS [Name0], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityId1], [s].[RelationshipsBranchEntityId1], [s].[Id10] AS [Id100], [s].[Name0] AS [Name00], [s].[OptionalReferenceLeaf_Name], [s].[RequiredReferenceLeaf_Name], [r0].[OptionalReferenceBranch_Name], [r3].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [r3].[RelationshipsBranchEntityRelationshipsTrunkEntityId1] AS [RelationshipsBranchEntityRelationshipsTrunkEntityId10], [r3].[Id1] AS [Id11], [r3].[Name] AS [Name1], [r0].[OptionalReferenceBranch_OptionalReferenceLeaf_Name], [r0].[OptionalReferenceBranch_RequiredReferenceLeaf_Name], [r0].[RequiredReferenceBranch_Name], [r4].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [r4].[RelationshipsBranchEntityRelationshipsTrunkEntityId1] AS [RelationshipsBranchEntityRelationshipsTrunkEntityId11], [r4].[Id1] AS [Id12], [r4].[Name] AS [Name2], [r0].[RequiredReferenceBranch_OptionalReferenceLeaf_Name], [r0].[RequiredReferenceBranch_RequiredReferenceLeaf_Name]
-    FROM [Root_CollectionTrunk] AS [r0]
-    LEFT JOIN (
-        SELECT [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r1].[RelationshipsTrunkEntityId1], [r1].[Id1], [r1].[Name], [r2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r2].[RelationshipsBranchEntityRelationshipsTrunkEntityId1], [r2].[RelationshipsBranchEntityId1], [r2].[Id1] AS [Id10], [r2].[Name] AS [Name0], [r1].[OptionalReferenceLeaf_Name], [r1].[RequiredReferenceLeaf_Name]
-        FROM [Root_CollectionTrunk_CollectionBranch] AS [r1]
-        LEFT JOIN [Root_CollectionTrunk_CollectionBranch_CollectionLeaf] AS [r2] ON [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r1].[RelationshipsTrunkEntityId1] = [r2].[RelationshipsBranchEntityRelationshipsTrunkEntityId1] AND [r1].[Id1] = [r2].[RelationshipsBranchEntityId1]
-    ) AS [s] ON [r0].[RelationshipsRootEntityId] = [s].[RelationshipsTrunkEntityRelationshipsRootEntityId] AND [r0].[Id1] = [s].[RelationshipsTrunkEntityId1]
-    LEFT JOIN [Root_CollectionTrunk_OptionalReferenceBranch_CollectionLeaf] AS [r3] ON CASE
-        WHEN [r0].[OptionalReferenceBranch_Name] IS NOT NULL THEN [r0].[RelationshipsRootEntityId]
-    END = [r3].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND CASE
-        WHEN [r0].[OptionalReferenceBranch_Name] IS NOT NULL THEN [r0].[Id1]
-    END = [r3].[RelationshipsBranchEntityRelationshipsTrunkEntityId1]
-    LEFT JOIN [Root_CollectionTrunk_RequiredReferenceBranch_CollectionLeaf] AS [r4] ON [r0].[RelationshipsRootEntityId] = [r4].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r0].[Id1] = [r4].[RelationshipsBranchEntityRelationshipsTrunkEntityId1]
-) AS [s0] ON [r].[Id] = [s0].[RelationshipsRootEntityId]
-ORDER BY [r].[Id], [s0].[RelationshipsRootEntityId], [s0].[Id1], [s0].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s0].[RelationshipsTrunkEntityId1], [s0].[Id10], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityId1], [s0].[RelationshipsBranchEntityId1], [s0].[Id100], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityId10], [s0].[Id11], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityId11]
-""");
-    }
-
-    public override async Task Project_branch_required_required(bool async)
+    public override async Task Select_branch_required_required(bool async)
     {
-        await base.Project_branch_required_required(async);
+        await base.Select_branch_required_required(async);
 
         AssertSql(
             """
@@ -148,9 +121,9 @@ public override async Task Project_branch_required_required(bool async)
 """);
     }
 
-    public override async Task Project_branch_required_optional(bool async)
+    public override async Task Select_branch_required_optional(bool async)
     {
-        await base.Project_branch_required_optional(async);
+        await base.Select_branch_required_optional(async);
 
         AssertSql(
             """
@@ -163,26 +136,9 @@ public override async Task Project_branch_required_optional(bool async)
 """);
     }
 
-    public override async Task Project_branch_required_collection(bool async)
+    public override async Task Select_branch_optional_required(bool async)
     {
-        await base.Project_branch_required_collection(async);
-
-        AssertSql(
-"""
-SELECT [r].[Id], [s].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s].[Id1], [s].[Name], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s].[RelationshipsBranchEntityId1], [s].[Id10], [s].[Name0], [s].[OptionalReferenceLeaf_Name], [s].[RequiredReferenceLeaf_Name]
-FROM [RootEntities] AS [r]
-LEFT JOIN (
-    SELECT [r0].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r0].[Id1], [r0].[Name], [r1].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r1].[RelationshipsBranchEntityId1], [r1].[Id1] AS [Id10], [r1].[Name] AS [Name0], [r0].[OptionalReferenceLeaf_Name], [r0].[RequiredReferenceLeaf_Name]
-    FROM [Root_RequiredReferenceTrunk_CollectionBranch] AS [r0]
-    LEFT JOIN [Root_RequiredReferenceTrunk_CollectionBranch_CollectionLeaf] AS [r1] ON [r0].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r1].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r0].[Id1] = [r1].[RelationshipsBranchEntityId1]
-) AS [s] ON [r].[Id] = [s].[RelationshipsTrunkEntityRelationshipsRootEntityId]
-ORDER BY [r].[Id], [s].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s].[Id1], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s].[RelationshipsBranchEntityId1]
-""");
-    }
-
-    public override async Task Project_branch_optional_required(bool async)
-    {
-        await base.Project_branch_optional_required(async);
+        await base.Select_branch_optional_required(async);
 
         AssertSql(
             """
@@ -193,12 +149,12 @@ public override async Task Project_branch_optional_required(bool async)
 """);
     }
 
-    public override async Task Project_branch_optional_optional(bool async)
+    public override async Task Select_branch_optional_optional(bool async)
     {
-        await base.Project_branch_optional_optional(async);
+        await base.Select_branch_optional_optional(async);
 
         AssertSql(
-"""
+            """
 SELECT [r].[Id], [r].[RequiredReferenceTrunk_OptionalReferenceBranch_Name], [r0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r0].[Id1], [r0].[Name], [r].[RequiredReferenceTrunk_OptionalReferenceBranch_OptionalReferenceLeaf_Name], [r].[RequiredReferenceTrunk_OptionalReferenceBranch_RequiredReferenceLeaf_Name]
 FROM [RootEntities] AS [r]
 LEFT JOIN [Root_RequiredReferenceTrunk_OptionalReferenceBranch_CollectionLeaf] AS [r0] ON CASE
@@ -208,26 +164,9 @@ public override async Task Project_branch_optional_optional(bool async)
 """);
     }
 
-    public override async Task Project_branch_optional_collection(bool async)
+    public override async Task Select_root_duplicated(bool async)
     {
-        await base.Project_branch_optional_collection(async);
-
-        AssertSql(
-            """
-SELECT [r].[Id], [s].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s].[Id1], [s].[Name], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s].[RelationshipsBranchEntityId1], [s].[Id10], [s].[Name0], [s].[OptionalReferenceLeaf_Name], [s].[RequiredReferenceLeaf_Name]
-FROM [RootEntities] AS [r]
-LEFT JOIN (
-    SELECT [r0].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r0].[Id1], [r0].[Name], [r1].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r1].[RelationshipsBranchEntityId1], [r1].[Id1] AS [Id10], [r1].[Name] AS [Name0], [r0].[OptionalReferenceLeaf_Name], [r0].[RequiredReferenceLeaf_Name]
-    FROM [Root_RequiredReferenceTrunk_CollectionBranch] AS [r0]
-    LEFT JOIN [Root_RequiredReferenceTrunk_CollectionBranch_CollectionLeaf] AS [r1] ON [r0].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r1].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r0].[Id1] = [r1].[RelationshipsBranchEntityId1]
-) AS [s] ON [r].[Id] = [s].[RelationshipsTrunkEntityRelationshipsRootEntityId]
-ORDER BY [r].[Id], [s].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s].[Id1], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s].[RelationshipsBranchEntityId1]
-""");
-    }
-
-    public override async Task Project_root_duplicated(bool async)
-    {
-        await base.Project_root_duplicated(async);
+        await base.Select_root_duplicated(async);
 
         AssertSql(
             """
@@ -311,9 +250,9 @@ public override async Task Project_root_duplicated(bool async)
 """);
     }
 
-    public override async Task Project_trunk_and_branch_duplicated(bool async)
+    public override async Task Select_trunk_and_branch_duplicated(bool async)
     {
-        await base.Project_trunk_and_branch_duplicated(async);
+        await base.Select_trunk_and_branch_duplicated(async);
 
         AssertSql(
             """
@@ -355,9 +294,9 @@ public override async Task Project_trunk_and_branch_duplicated(bool async)
 """);
     }
 
-    public override async Task Project_trunk_and_trunk_duplicated(bool async)
+    public override async Task Select_trunk_and_trunk_duplicated(bool async)
     {
-        await base.Project_trunk_and_trunk_duplicated(async);
+        await base.Select_trunk_and_trunk_duplicated(async);
 
         AssertSql(
             """
@@ -385,28 +324,9 @@ public override async Task Project_trunk_and_trunk_duplicated(bool async)
 """);
     }
 
-    public override async Task Project_multiple_branch_leaf(bool async)
+    public override async Task Select_leaf_trunk_root(bool async)
     {
-        await base.Project_multiple_branch_leaf(async);
-
-        AssertSql(
-            """
-SELECT [r].[Id], [r].[RequiredReferenceTrunk_RequiredReferenceBranch_Name], [r0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r0].[Id1], [r0].[Name], [r].[RequiredReferenceTrunk_RequiredReferenceBranch_OptionalReferenceLeaf_Name], [r].[RequiredReferenceTrunk_RequiredReferenceBranch_RequiredReferenceLeaf_Name], [r1].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r1].[Id1], [r1].[Name], [s].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s].[Id1], [s].[Name], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s].[RelationshipsBranchEntityId1], [s].[Id10], [s].[Name0], [s].[OptionalReferenceLeaf_Name], [s].[RequiredReferenceLeaf_Name]
-FROM [RootEntities] AS [r]
-LEFT JOIN [Root_RequiredReferenceTrunk_RequiredReferenceBranch_CollectionLeaf] AS [r0] ON [r].[Id] = [r0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
-LEFT JOIN [Root_RequiredReferenceTrunk_RequiredReferenceBranch_CollectionLeaf] AS [r1] ON [r].[Id] = [r1].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
-LEFT JOIN (
-    SELECT [r2].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r2].[Id1], [r2].[Name], [r3].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r3].[RelationshipsBranchEntityId1], [r3].[Id1] AS [Id10], [r3].[Name] AS [Name0], [r2].[OptionalReferenceLeaf_Name], [r2].[RequiredReferenceLeaf_Name]
-    FROM [Root_RequiredReferenceTrunk_CollectionBranch] AS [r2]
-    LEFT JOIN [Root_RequiredReferenceTrunk_CollectionBranch_CollectionLeaf] AS [r3] ON [r2].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r3].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r2].[Id1] = [r3].[RelationshipsBranchEntityId1]
-) AS [s] ON [r].[Id] = [s].[RelationshipsTrunkEntityRelationshipsRootEntityId]
-ORDER BY [r].[Id], [r0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r0].[Id1], [r1].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r1].[Id1], [s].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s].[Id1], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s].[RelationshipsBranchEntityId1]
-""");
-    }
-
-    public override async Task Project_leaf_trunk_root(bool async)
-    {
-        await base.Project_leaf_trunk_root(async);
+        await base.Select_leaf_trunk_root(async);
 
         AssertSql(
             """
@@ -462,9 +382,9 @@ public override async Task Project_leaf_trunk_root(bool async)
 """);
     }
 
-    public override async Task Project_subquery_root_set_required_trunk_FirstOrDefault_branch(bool async)
+    public override async Task Select_subquery_root_set_required_trunk_FirstOrDefault_branch(bool async)
     {
-        await base.Project_subquery_root_set_required_trunk_FirstOrDefault_branch(async);
+        await base.Select_subquery_root_set_required_trunk_FirstOrDefault_branch(async);
 
         AssertSql(
             """
@@ -480,9 +400,9 @@ public override async Task Project_subquery_root_set_required_trunk_FirstOrDefau
 """);
     }
 
-    public override async Task Project_subquery_root_set_optional_trunk_FirstOrDefault_branch(bool async)
+    public override async Task Select_subquery_root_set_optional_trunk_FirstOrDefault_branch(bool async)
     {
-        await base.Project_subquery_root_set_optional_trunk_FirstOrDefault_branch(async);
+        await base.Select_subquery_root_set_optional_trunk_FirstOrDefault_branch(async);
 
         AssertSql(
             """
@@ -500,136 +420,6 @@ public override async Task Project_subquery_root_set_optional_trunk_FirstOrDefau
 """);
     }
 
-    public override async Task Project_subquery_root_set_trunk_FirstOrDefault_collection(bool async)
-    {
-        await base.Project_subquery_root_set_trunk_FirstOrDefault_collection(async);
-
-        AssertSql(
-            """
-SELECT [r].[Id], [r3].[Id], [s].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s].[Id1], [s].[Name], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s].[RelationshipsBranchEntityId1], [s].[Id10], [s].[Name0], [s].[OptionalReferenceLeaf_Name], [s].[RequiredReferenceLeaf_Name], [r3].[c]
-FROM [RootEntities] AS [r]
-OUTER APPLY (
-    SELECT TOP(1) 1 AS [c], [r0].[Id]
-    FROM [RootEntities] AS [r0]
-    ORDER BY [r0].[Id]
-) AS [r3]
-LEFT JOIN (
-    SELECT [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r1].[Id1], [r1].[Name], [r2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r2].[RelationshipsBranchEntityId1], [r2].[Id1] AS [Id10], [r2].[Name] AS [Name0], [r1].[OptionalReferenceLeaf_Name], [r1].[RequiredReferenceLeaf_Name]
-    FROM [Root_RequiredReferenceTrunk_CollectionBranch] AS [r1]
-    LEFT JOIN [Root_RequiredReferenceTrunk_CollectionBranch_CollectionLeaf] AS [r2] ON [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r1].[Id1] = [r2].[RelationshipsBranchEntityId1]
-) AS [s] ON [r3].[Id] = [s].[RelationshipsTrunkEntityRelationshipsRootEntityId]
-ORDER BY [r].[Id], [r3].[Id], [s].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s].[Id1], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s].[RelationshipsBranchEntityId1]
-""");
-    }
-
-    public override async Task Project_subquery_root_set_complex_projection_including_references_to_outer_FirstOrDefault(bool async)
-    {
-        await base.Project_subquery_root_set_complex_projection_including_references_to_outer_FirstOrDefault(async);
-
-        AssertSql(
-            """
-SELECT [r].[Id], [r8].[Id], [s].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s].[Id1], [s].[Name], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s].[RelationshipsBranchEntityId1], [s].[Id10], [s].[Name0], [s].[OptionalReferenceLeaf_Name], [s].[RequiredReferenceLeaf_Name], [r8].[RequiredReferenceTrunk_Name], [s0].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s0].[Id1], [s0].[Name], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s0].[RelationshipsBranchEntityId1], [s0].[Id10], [s0].[Name0], [s0].[OptionalReferenceLeaf_Name], [s0].[RequiredReferenceLeaf_Name], [r8].[RequiredReferenceTrunk_OptionalReferenceBranch_Name], [r5].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r5].[Id1], [r5].[Name], [r8].[RequiredReferenceTrunk_OptionalReferenceBranch_OptionalReferenceLeaf_Name], [r8].[RequiredReferenceTrunk_OptionalReferenceBranch_RequiredReferenceLeaf_Name], [r8].[RequiredReferenceTrunk_RequiredReferenceBranch_Name], [r6].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r6].[Id1], [r6].[Name], [r8].[RequiredReferenceTrunk_RequiredReferenceBranch_OptionalReferenceLeaf_Name], [r8].[RequiredReferenceTrunk_RequiredReferenceBranch_RequiredReferenceLeaf_Name], [r7].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r7].[Id1], [r7].[Name], [r8].[RequiredReferenceTrunk_RequiredReferenceBranch_Name0], [r8].[c]
-FROM [RootEntities] AS [r]
-OUTER APPLY (
-    SELECT TOP(1) [r0].[Id], [r0].[RequiredReferenceTrunk_Name], [r0].[RequiredReferenceTrunk_OptionalReferenceBranch_Name], [r0].[RequiredReferenceTrunk_OptionalReferenceBranch_OptionalReferenceLeaf_Name], [r0].[RequiredReferenceTrunk_OptionalReferenceBranch_RequiredReferenceLeaf_Name], [r0].[RequiredReferenceTrunk_RequiredReferenceBranch_Name], [r0].[RequiredReferenceTrunk_RequiredReferenceBranch_OptionalReferenceLeaf_Name], [r0].[RequiredReferenceTrunk_RequiredReferenceBranch_RequiredReferenceLeaf_Name], [r].[RequiredReferenceTrunk_RequiredReferenceBranch_Name] AS [RequiredReferenceTrunk_RequiredReferenceBranch_Name0], 1 AS [c]
-    FROM [RootEntities] AS [r0]
-    ORDER BY [r0].[Id]
-) AS [r8]
-LEFT JOIN (
-    SELECT [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r1].[Id1], [r1].[Name], [r2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r2].[RelationshipsBranchEntityId1], [r2].[Id1] AS [Id10], [r2].[Name] AS [Name0], [r1].[OptionalReferenceLeaf_Name], [r1].[RequiredReferenceLeaf_Name]
-    FROM [Root_RequiredReferenceTrunk_CollectionBranch] AS [r1]
-    LEFT JOIN [Root_RequiredReferenceTrunk_CollectionBranch_CollectionLeaf] AS [r2] ON [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r1].[Id1] = [r2].[RelationshipsBranchEntityId1]
-) AS [s] ON [r].[Id] = [s].[RelationshipsTrunkEntityRelationshipsRootEntityId]
-LEFT JOIN (
-    SELECT [r3].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r3].[Id1], [r3].[Name], [r4].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r4].[RelationshipsBranchEntityId1], [r4].[Id1] AS [Id10], [r4].[Name] AS [Name0], [r3].[OptionalReferenceLeaf_Name], [r3].[RequiredReferenceLeaf_Name]
-    FROM [Root_RequiredReferenceTrunk_CollectionBranch] AS [r3]
-    LEFT JOIN [Root_RequiredReferenceTrunk_CollectionBranch_CollectionLeaf] AS [r4] ON [r3].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r4].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r3].[Id1] = [r4].[RelationshipsBranchEntityId1]
-) AS [s0] ON [r8].[Id] = [s0].[RelationshipsTrunkEntityRelationshipsRootEntityId]
-LEFT JOIN [Root_RequiredReferenceTrunk_OptionalReferenceBranch_CollectionLeaf] AS [r5] ON CASE
-    WHEN [r8].[RequiredReferenceTrunk_OptionalReferenceBranch_Name] IS NOT NULL THEN [r8].[Id]
-END = [r5].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
-LEFT JOIN [Root_RequiredReferenceTrunk_RequiredReferenceBranch_CollectionLeaf] AS [r6] ON [r8].[Id] = [r6].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
-LEFT JOIN [Root_RequiredReferenceTrunk_RequiredReferenceBranch_CollectionLeaf] AS [r7] ON [r8].[Id] = [r7].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
-ORDER BY [r].[Id], [r8].[Id], [s].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s].[Id1], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s].[RelationshipsBranchEntityId1], [s].[Id10], [s0].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s0].[Id1], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s0].[RelationshipsBranchEntityId1], [s0].[Id10], [r5].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r5].[Id1], [r6].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r6].[Id1], [r7].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
-""");
-    }
-
-    public override async Task Project_subquery_root_set_complex_projection_FirstOrDefault_project_reference_to_outer(bool async)
-    {
-        await base.Project_subquery_root_set_complex_projection_FirstOrDefault_project_reference_to_outer(async);
-
-        AssertSql(
-            """
-SELECT [r].[Id], [r3].[Id], [s].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s].[Id1], [s].[Name], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s].[RelationshipsBranchEntityId1], [s].[Id10], [s].[Name0], [s].[OptionalReferenceLeaf_Name], [s].[RequiredReferenceLeaf_Name], [r3].[c]
-FROM [RootEntities] AS [r]
-OUTER APPLY (
-    SELECT TOP(1) 1 AS [c], [r0].[Id]
-    FROM [RootEntities] AS [r0]
-    ORDER BY [r0].[Id]
-) AS [r3]
-LEFT JOIN (
-    SELECT [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r1].[Id1], [r1].[Name], [r2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r2].[RelationshipsBranchEntityId1], [r2].[Id1] AS [Id10], [r2].[Name] AS [Name0], [r1].[OptionalReferenceLeaf_Name], [r1].[RequiredReferenceLeaf_Name]
-    FROM [Root_RequiredReferenceTrunk_CollectionBranch] AS [r1]
-    LEFT JOIN [Root_RequiredReferenceTrunk_CollectionBranch_CollectionLeaf] AS [r2] ON [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r1].[Id1] = [r2].[RelationshipsBranchEntityId1]
-) AS [s] ON [r].[Id] = [s].[RelationshipsTrunkEntityRelationshipsRootEntityId]
-ORDER BY [r].[Id], [r3].[Id], [s].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s].[Id1], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s].[RelationshipsBranchEntityId1]
-""");
-    }
-
-    public override async Task SelectMany_trunk_collection(bool async)
-    {
-        await base.SelectMany_trunk_collection(async);
-
-        AssertSql(
-            """
-SELECT [r0].[RelationshipsRootEntityId], [r0].[Id1], [r0].[Name], [r].[Id], [s].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s].[RelationshipsTrunkEntityId1], [s].[Id1], [s].[Name], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityId1], [s].[RelationshipsBranchEntityId1], [s].[Id10], [s].[Name0], [s].[OptionalReferenceLeaf_Name], [s].[RequiredReferenceLeaf_Name], [r0].[OptionalReferenceBranch_Name], [r3].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r3].[RelationshipsBranchEntityRelationshipsTrunkEntityId1], [r3].[Id1], [r3].[Name], [r0].[OptionalReferenceBranch_OptionalReferenceLeaf_Name], [r0].[OptionalReferenceBranch_RequiredReferenceLeaf_Name], [r0].[RequiredReferenceBranch_Name], [r4].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r4].[RelationshipsBranchEntityRelationshipsTrunkEntityId1], [r4].[Id1], [r4].[Name], [r0].[RequiredReferenceBranch_OptionalReferenceLeaf_Name], [r0].[RequiredReferenceBranch_RequiredReferenceLeaf_Name]
-FROM [RootEntities] AS [r]
-INNER JOIN [Root_CollectionTrunk] AS [r0] ON [r].[Id] = [r0].[RelationshipsRootEntityId]
-LEFT JOIN (
-    SELECT [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r1].[RelationshipsTrunkEntityId1], [r1].[Id1], [r1].[Name], [r2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r2].[RelationshipsBranchEntityRelationshipsTrunkEntityId1], [r2].[RelationshipsBranchEntityId1], [r2].[Id1] AS [Id10], [r2].[Name] AS [Name0], [r1].[OptionalReferenceLeaf_Name], [r1].[RequiredReferenceLeaf_Name]
-    FROM [Root_CollectionTrunk_CollectionBranch] AS [r1]
-    LEFT JOIN [Root_CollectionTrunk_CollectionBranch_CollectionLeaf] AS [r2] ON [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r1].[RelationshipsTrunkEntityId1] = [r2].[RelationshipsBranchEntityRelationshipsTrunkEntityId1] AND [r1].[Id1] = [r2].[RelationshipsBranchEntityId1]
-) AS [s] ON [r0].[RelationshipsRootEntityId] = [s].[RelationshipsTrunkEntityRelationshipsRootEntityId] AND [r0].[Id1] = [s].[RelationshipsTrunkEntityId1]
-LEFT JOIN [Root_CollectionTrunk_OptionalReferenceBranch_CollectionLeaf] AS [r3] ON CASE
-    WHEN [r0].[OptionalReferenceBranch_Name] IS NOT NULL THEN [r0].[RelationshipsRootEntityId]
-END = [r3].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND CASE
-    WHEN [r0].[OptionalReferenceBranch_Name] IS NOT NULL THEN [r0].[Id1]
-END = [r3].[RelationshipsBranchEntityRelationshipsTrunkEntityId1]
-LEFT JOIN [Root_CollectionTrunk_RequiredReferenceBranch_CollectionLeaf] AS [r4] ON [r0].[RelationshipsRootEntityId] = [r4].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r0].[Id1] = [r4].[RelationshipsBranchEntityRelationshipsTrunkEntityId1]
-ORDER BY [r].[Id], [r0].[RelationshipsRootEntityId], [r0].[Id1], [s].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s].[RelationshipsTrunkEntityId1], [s].[Id1], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityId1], [s].[RelationshipsBranchEntityId1], [s].[Id10], [r3].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r3].[RelationshipsBranchEntityRelationshipsTrunkEntityId1], [r3].[Id1], [r4].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r4].[RelationshipsBranchEntityRelationshipsTrunkEntityId1]
-""");
-    }
-
-    public override async Task SelectMany_required_trunk_reference_branch_collection(bool async)
-    {
-        await base.SelectMany_required_trunk_reference_branch_collection(async);
-
-        AssertSql(
-            """
-SELECT [r0].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r0].[Id1], [r0].[Name], [r].[Id], [r1].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r1].[RelationshipsBranchEntityId1], [r1].[Id1], [r1].[Name], [r0].[OptionalReferenceLeaf_Name], [r0].[RequiredReferenceLeaf_Name]
-FROM [RootEntities] AS [r]
-INNER JOIN [Root_RequiredReferenceTrunk_CollectionBranch] AS [r0] ON [r].[Id] = [r0].[RelationshipsTrunkEntityRelationshipsRootEntityId]
-LEFT JOIN [Root_RequiredReferenceTrunk_CollectionBranch_CollectionLeaf] AS [r1] ON [r0].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r1].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r0].[Id1] = [r1].[RelationshipsBranchEntityId1]
-ORDER BY [r].[Id], [r0].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r0].[Id1], [r1].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r1].[RelationshipsBranchEntityId1]
-""");
-    }
-
-    public override async Task SelectMany_optional_trunk_reference_branch_collection(bool async)
-    {
-        await base.SelectMany_optional_trunk_reference_branch_collection(async);
-
-        AssertSql(
-            """
-SELECT [r0].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r0].[Id1], [r0].[Name], [r].[Id], [r1].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r1].[RelationshipsBranchEntityId1], [r1].[Id1], [r1].[Name], [r0].[OptionalReferenceLeaf_Name], [r0].[RequiredReferenceLeaf_Name]
-FROM [RootEntities] AS [r]
-INNER JOIN [Root_OptionalReferenceTrunk_CollectionBranch] AS [r0] ON CASE
-    WHEN [r].[OptionalReferenceTrunk_Name] IS NOT NULL THEN [r].[Id]
-END = [r0].[RelationshipsTrunkEntityRelationshipsRootEntityId]
-LEFT JOIN [Root_OptionalReferenceTrunk_CollectionBranch_CollectionLeaf] AS [r1] ON [r0].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r1].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r0].[Id1] = [r1].[RelationshipsBranchEntityId1]
-ORDER BY [r].[Id], [r0].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r0].[Id1], [r1].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r1].[RelationshipsBranchEntityId1]
-""");
-    }
-
     private void AssertSql(params string[] expected)
         => Fixture.TestSqlLoggerFactory.AssertBaseline(expected);
 }
diff --git a/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/InProjection/OwnedRelationshipsInProjectionQuerySqlServerTest.cs b/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/Projection/OwnedReferenceProjectionSqlServerTest.cs
similarity index 88%
rename from test/EFCore.SqlServer.FunctionalTests/Query/Relationships/InProjection/OwnedRelationshipsInProjectionQuerySqlServerTest.cs
rename to test/EFCore.SqlServer.FunctionalTests/Query/Relationships/Projection/OwnedReferenceProjectionSqlServerTest.cs
index f6fcfc67c6..18be844f58 100644
--- a/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/InProjection/OwnedRelationshipsInProjectionQuerySqlServerTest.cs
+++ b/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/Projection/OwnedReferenceProjectionSqlServerTest.cs
@@ -1,24 +1,24 @@
 ﻿// Licensed to the .NET Foundation under one or more agreements.
 // The .NET Foundation licenses this file to you under the MIT license.
 
-namespace Microsoft.EntityFrameworkCore.Query.Relationships.InProjection;
+namespace Microsoft.EntityFrameworkCore.Query.Relationships.Projection;
 
-public class OwnedRelationshipsInProjectionQuerySqlServerTest
-    : OwnedRelationshipsInProjectionQueryRelationalTestBase<OwnedRelationshipsQuerySqlServerFixture>
+public class OwnedReferenceProjectionSqlServerTest
+    : OwnedReferenceProjectionRelationalTestBase<OwnedRelationshipsSqlServerFixture>
 {
-    public OwnedRelationshipsInProjectionQuerySqlServerTest(OwnedRelationshipsQuerySqlServerFixture fixture, ITestOutputHelper testOutputHelper)
+    public OwnedReferenceProjectionSqlServerTest(OwnedRelationshipsSqlServerFixture fixture, ITestOutputHelper testOutputHelper)
         : base(fixture)
     {
         Fixture.TestSqlLoggerFactory.Clear();
         Fixture.TestSqlLoggerFactory.SetTestOutputHelper(testOutputHelper);
     }
 
-    public override async Task Project_root(bool async)
+    public override async Task Select_root(bool async)
     {
-        await base.Project_root(async);
+        await base.Select_root(async);
 
         AssertSql(
-"""
+            """
 SELECT [r].[Id], [r].[Name], [r].[OptionalReferenceTrunkId], [r].[RequiredReferenceTrunkId], [s0].[RelationshipsRootEntityId], [s0].[Id1], [s0].[Name], [s0].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s0].[RelationshipsTrunkEntityId1], [s0].[Id10], [s0].[Name0], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityId1], [s0].[RelationshipsBranchEntityId1], [s0].[Id100], [s0].[Name00], [s0].[OptionalReferenceLeaf_Name], [s0].[RequiredReferenceLeaf_Name], [s0].[OptionalReferenceBranch_Name], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityId10], [s0].[Id11], [s0].[Name1], [s0].[OptionalReferenceBranch_OptionalReferenceLeaf_Name], [s0].[OptionalReferenceBranch_RequiredReferenceLeaf_Name], [s0].[RequiredReferenceBranch_Name], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityId11], [s0].[Id12], [s0].[Name2], [s0].[RequiredReferenceBranch_OptionalReferenceLeaf_Name], [s0].[RequiredReferenceBranch_RequiredReferenceLeaf_Name], [r].[OptionalReferenceTrunk_Name], [s1].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s1].[Id1], [s1].[Name], [s1].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s1].[RelationshipsBranchEntityId1], [s1].[Id10], [s1].[Name0], [s1].[OptionalReferenceLeaf_Name], [s1].[RequiredReferenceLeaf_Name], [r].[OptionalReferenceTrunk_OptionalReferenceBranch_Name], [r7].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r7].[Id1], [r7].[Name], [r].[OptionalReferenceTrunk_OptionalReferenceBranch_OptionalReferenceLeaf_Name], [r].[OptionalReferenceTrunk_OptionalReferenceBranch_RequiredReferenceLeaf_Name], [r].[OptionalReferenceTrunk_RequiredReferenceBranch_Name], [r8].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r8].[Id1], [r8].[Name], [r].[OptionalReferenceTrunk_RequiredReferenceBranch_OptionalReferenceLeaf_Name], [r].[OptionalReferenceTrunk_RequiredReferenceBranch_RequiredReferenceLeaf_Name], [r].[RequiredReferenceTrunk_Name], [s2].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s2].[Id1], [s2].[Name], [s2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s2].[RelationshipsBranchEntityId1], [s2].[Id10], [s2].[Name0], [s2].[OptionalReferenceLeaf_Name], [s2].[RequiredReferenceLeaf_Name], [r].[RequiredReferenceTrunk_OptionalReferenceBranch_Name], [r11].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r11].[Id1], [r11].[Name], [r].[RequiredReferenceTrunk_OptionalReferenceBranch_OptionalReferenceLeaf_Name], [r].[RequiredReferenceTrunk_OptionalReferenceBranch_RequiredReferenceLeaf_Name], [r].[RequiredReferenceTrunk_RequiredReferenceBranch_Name], [r12].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r12].[Id1], [r12].[Name], [r].[RequiredReferenceTrunk_RequiredReferenceBranch_OptionalReferenceLeaf_Name], [r].[RequiredReferenceTrunk_RequiredReferenceBranch_RequiredReferenceLeaf_Name]
 FROM [RootEntities] AS [r]
 LEFT JOIN (
@@ -62,12 +62,12 @@ public override async Task Project_root(bool async)
 """);
     }
 
-    public override async Task Project_root_duplicated(bool async)
+    public override async Task Select_root_duplicated(bool async)
     {
-        await base.Project_root_duplicated(async);
+        await base.Select_root_duplicated(async);
 
         AssertSql(
-"""
+            """
 SELECT [r].[Id], [r].[Name], [r].[OptionalReferenceTrunkId], [r].[RequiredReferenceTrunkId], [s0].[RelationshipsRootEntityId], [s0].[Id1], [s0].[Name], [s0].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s0].[RelationshipsTrunkEntityId1], [s0].[Id10], [s0].[Name0], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityId1], [s0].[RelationshipsBranchEntityId1], [s0].[Id100], [s0].[Name00], [s0].[OptionalReferenceLeaf_Name], [s0].[RequiredReferenceLeaf_Name], [s0].[OptionalReferenceBranch_Name], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityId10], [s0].[Id11], [s0].[Name1], [s0].[OptionalReferenceBranch_OptionalReferenceLeaf_Name], [s0].[OptionalReferenceBranch_RequiredReferenceLeaf_Name], [s0].[RequiredReferenceBranch_Name], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityId11], [s0].[Id12], [s0].[Name2], [s0].[RequiredReferenceBranch_OptionalReferenceLeaf_Name], [s0].[RequiredReferenceBranch_RequiredReferenceLeaf_Name], [r].[OptionalReferenceTrunk_Name], [s1].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s1].[Id1], [s1].[Name], [s1].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s1].[RelationshipsBranchEntityId1], [s1].[Id10], [s1].[Name0], [s1].[OptionalReferenceLeaf_Name], [s1].[RequiredReferenceLeaf_Name], [r].[OptionalReferenceTrunk_OptionalReferenceBranch_Name], [r7].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r7].[Id1], [r7].[Name], [r].[OptionalReferenceTrunk_OptionalReferenceBranch_OptionalReferenceLeaf_Name], [r].[OptionalReferenceTrunk_OptionalReferenceBranch_RequiredReferenceLeaf_Name], [r].[OptionalReferenceTrunk_RequiredReferenceBranch_Name], [r8].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r8].[Id1], [r8].[Name], [r].[OptionalReferenceTrunk_RequiredReferenceBranch_OptionalReferenceLeaf_Name], [r].[OptionalReferenceTrunk_RequiredReferenceBranch_RequiredReferenceLeaf_Name], [r].[RequiredReferenceTrunk_Name], [s2].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s2].[Id1], [s2].[Name], [s2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s2].[RelationshipsBranchEntityId1], [s2].[Id10], [s2].[Name0], [s2].[OptionalReferenceLeaf_Name], [s2].[RequiredReferenceLeaf_Name], [r].[RequiredReferenceTrunk_OptionalReferenceBranch_Name], [r11].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r11].[Id1], [r11].[Name], [r].[RequiredReferenceTrunk_OptionalReferenceBranch_OptionalReferenceLeaf_Name], [r].[RequiredReferenceTrunk_OptionalReferenceBranch_RequiredReferenceLeaf_Name], [r].[RequiredReferenceTrunk_RequiredReferenceBranch_Name], [r12].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r12].[Id1], [r12].[Name], [r].[RequiredReferenceTrunk_RequiredReferenceBranch_OptionalReferenceLeaf_Name], [r].[RequiredReferenceTrunk_RequiredReferenceBranch_RequiredReferenceLeaf_Name], [s4].[RelationshipsRootEntityId], [s4].[Id1], [s4].[Name], [s4].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s4].[RelationshipsTrunkEntityId1], [s4].[Id10], [s4].[Name0], [s4].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s4].[RelationshipsBranchEntityRelationshipsTrunkEntityId1], [s4].[RelationshipsBranchEntityId1], [s4].[Id100], [s4].[Name00], [s4].[OptionalReferenceLeaf_Name], [s4].[RequiredReferenceLeaf_Name], [s4].[OptionalReferenceBranch_Name], [s4].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [s4].[RelationshipsBranchEntityRelationshipsTrunkEntityId10], [s4].[Id11], [s4].[Name1], [s4].[OptionalReferenceBranch_OptionalReferenceLeaf_Name], [s4].[OptionalReferenceBranch_RequiredReferenceLeaf_Name], [s4].[RequiredReferenceBranch_Name], [s4].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [s4].[RelationshipsBranchEntityRelationshipsTrunkEntityId11], [s4].[Id12], [s4].[Name2], [s4].[RequiredReferenceBranch_OptionalReferenceLeaf_Name], [s4].[RequiredReferenceBranch_RequiredReferenceLeaf_Name], [s5].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s5].[Id1], [s5].[Name], [s5].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s5].[RelationshipsBranchEntityId1], [s5].[Id10], [s5].[Name0], [s5].[OptionalReferenceLeaf_Name], [s5].[RequiredReferenceLeaf_Name], [r20].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r20].[Id1], [r20].[Name], [r21].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r21].[Id1], [r21].[Name], [s6].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s6].[Id1], [s6].[Name], [s6].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s6].[RelationshipsBranchEntityId1], [s6].[Id10], [s6].[Name0], [s6].[OptionalReferenceLeaf_Name], [s6].[RequiredReferenceLeaf_Name], [r24].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r24].[Id1], [r24].[Name], [r25].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r25].[Id1], [r25].[Name]
 FROM [RootEntities] AS [r]
 LEFT JOIN (
@@ -148,99 +148,38 @@ public override async Task Project_root_duplicated(bool async)
 """);
     }
 
-    public override Task Project_trunk_optional(bool async)
-        => AssertCantTrackOwned(() => base.Project_trunk_optional(async));
-
-    public override Task Project_trunk_required(bool async)
-        => AssertCantTrackOwned(() => base.Project_trunk_required(async));
-
-    public override Task Project_trunk_collection(bool async)
-        => AssertCantTrackOwned(() => base.Project_trunk_collection(async));
-
-    public override Task Project_branch_required_required(bool async)
-        => AssertCantTrackOwned(() => base.Project_branch_required_required(async));
-
-    public override Task Project_branch_required_optional(bool async)
-        => AssertCantTrackOwned(() => base.Project_branch_required_optional(async));
-
-    public override Task Project_branch_required_collection(bool async)
-        => AssertCantTrackOwned(() => base.Project_branch_required_collection(async));
-
-    public override Task Project_branch_optional_required(bool async)
-        => AssertCantTrackOwned(() => base.Project_branch_optional_required(async));
-
-    public override Task Project_branch_optional_optional(bool async)
-        => AssertCantTrackOwned(() => base.Project_branch_optional_optional(async));
-
-    public override Task Project_branch_optional_collection(bool async)
-        => AssertCantTrackOwned(() => base.Project_branch_optional_collection(async));
-
-    public override Task Project_trunk_and_branch_duplicated(bool async)
-        => AssertCantTrackOwned(() => base.Project_trunk_and_branch_duplicated(async));
-
-    public override Task Project_trunk_and_trunk_duplicated(bool async)
-        => AssertCantTrackOwned(() => base.Project_trunk_and_trunk_duplicated(async));
-
-    public override Task Project_multiple_branch_leaf(bool async)
-        => AssertCantTrackOwned(() => base.Project_multiple_branch_leaf(async));
-
-    public override Task Project_leaf_trunk_root(bool async)
-        => AssertCantTrackOwned(() => base.Project_leaf_trunk_root(async));
-
-    public override Task Project_subquery_root_set_required_trunk_FirstOrDefault_branch(bool async)
-        => AssertCantTrackOwned(() => base.Project_subquery_root_set_required_trunk_FirstOrDefault_branch(async));
-
-    public override Task Project_subquery_root_set_optional_trunk_FirstOrDefault_branch(bool async)
-        => AssertCantTrackOwned(() => base.Project_subquery_root_set_optional_trunk_FirstOrDefault_branch(async));
-
-    public override Task Project_subquery_root_set_trunk_FirstOrDefault_collection(bool async)
-        => AssertCantTrackOwned(() => base.Project_subquery_root_set_trunk_FirstOrDefault_collection(async));
-
-    public override Task Project_subquery_root_set_complex_projection_including_references_to_outer_FirstOrDefault(bool async)
-        => AssertCantTrackOwned(() => base.Project_subquery_root_set_complex_projection_including_references_to_outer_FirstOrDefault(async));
-
-    public override Task Project_subquery_root_set_complex_projection_FirstOrDefault_project_reference_to_outer(bool async)
-        => AssertCantTrackOwned(() => base.Project_subquery_root_set_complex_projection_FirstOrDefault_project_reference_to_outer(async));
-
-    public override Task SelectMany_trunk_collection(bool async)
-        => AssertCantTrackOwned(() => base.SelectMany_trunk_collection(async));
-
-    public override Task SelectMany_required_trunk_reference_branch_collection(bool async)
-        => AssertCantTrackOwned(() => base.SelectMany_required_trunk_reference_branch_collection(async));
-
-    public override Task SelectMany_optional_trunk_reference_branch_collection(bool async)
-        => AssertCantTrackOwned(() => base.SelectMany_optional_trunk_reference_branch_collection(async));
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
+    public override Task Select_trunk_optional(bool async)
+        => AssertCantTrackOwned(() => base.Select_trunk_optional(async));
 
+    public override Task Select_trunk_required(bool async)
+        => AssertCantTrackOwned(() => base.Select_trunk_required(async));
 
+    public override Task Select_branch_required_required(bool async)
+        => AssertCantTrackOwned(() => base.Select_branch_required_required(async));
 
+    public override Task Select_branch_required_optional(bool async)
+        => AssertCantTrackOwned(() => base.Select_branch_required_optional(async));
 
+    public override Task Select_branch_optional_required(bool async)
+        => AssertCantTrackOwned(() => base.Select_branch_optional_required(async));
 
+    public override Task Select_branch_optional_optional(bool async)
+        => AssertCantTrackOwned(() => base.Select_branch_optional_optional(async));
 
+    public override Task Select_trunk_and_branch_duplicated(bool async)
+        => AssertCantTrackOwned(() => base.Select_trunk_and_branch_duplicated(async));
 
+    public override Task Select_trunk_and_trunk_duplicated(bool async)
+        => AssertCantTrackOwned(() => base.Select_trunk_and_trunk_duplicated(async));
 
+    public override Task Select_leaf_trunk_root(bool async)
+        => AssertCantTrackOwned(() => base.Select_leaf_trunk_root(async));
 
+    public override Task Select_subquery_root_set_required_trunk_FirstOrDefault_branch(bool async)
+        => AssertCantTrackOwned(() => base.Select_subquery_root_set_required_trunk_FirstOrDefault_branch(async));
 
+    public override Task Select_subquery_root_set_optional_trunk_FirstOrDefault_branch(bool async)
+        => AssertCantTrackOwned(() => base.Select_subquery_root_set_optional_trunk_FirstOrDefault_branch(async));
 
     private async Task AssertCantTrackOwned(Func<Task> test)
     {
diff --git a/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/Projection/OwnedTableSplittingNoTrackingProjectionSqlServerTest.cs b/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/Projection/OwnedTableSplittingNoTrackingProjectionSqlServerTest.cs
new file mode 100644
index 0000000000..21bfe07c1c
--- /dev/null
+++ b/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/Projection/OwnedTableSplittingNoTrackingProjectionSqlServerTest.cs
@@ -0,0 +1,269 @@
+﻿// Licensed to the .NET Foundation under one or more agreements.
+// The .NET Foundation licenses this file to you under the MIT license.
+
+namespace Microsoft.EntityFrameworkCore.Query.Relationships.Projection;
+
+public class OwnedTableSplittingNoTrackingProjectionSqlServerTest
+    : OwnedTableSplittingNoTrackingProjectionRelationalTestBase<OwnedTableSplittingRelationshipsSqlServerFixture>
+{
+    public OwnedTableSplittingNoTrackingProjectionSqlServerTest(OwnedTableSplittingRelationshipsSqlServerFixture fixture, ITestOutputHelper testOutputHelper)
+        : base(fixture)
+    {
+        Fixture.TestSqlLoggerFactory.Clear();
+        Fixture.TestSqlLoggerFactory.SetTestOutputHelper(testOutputHelper);
+    }
+
+    public override async Task Select_trunk_collection(bool async)
+    {
+        await base.Select_trunk_collection(async);
+
+        AssertSql(
+            """
+SELECT [r].[Id], [s0].[RelationshipsRootEntityId], [s0].[Id1], [s0].[Name], [s0].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s0].[RelationshipsTrunkEntityId1], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityId1], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityId10], [s0].[RelationshipsTrunkEntityRelationshipsRootEntityId0], [s0].[RelationshipsTrunkEntityId10], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityId11], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId2], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityId12], [s0].[RelationshipsTrunkEntityRelationshipsRootEntityId1], [s0].[RelationshipsTrunkEntityId11], [s0].[Id10], [s0].[Name0], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId3], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityId13], [s0].[RelationshipsBranchEntityId1], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId00], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityId100], [s0].[RelationshipsBranchEntityId10], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId10], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityId110], [s0].[RelationshipsBranchEntityId11], [s0].[Id100], [s0].[Name00], [s0].[Name1], [s0].[Name2], [s0].[Name3], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId4], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityId14], [s0].[Id11], [s0].[Name4], [s0].[Name5], [s0].[Name6], [s0].[Name7], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId5], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityId15], [s0].[Id12], [s0].[Name8], [s0].[Name9], [s0].[Name10]
+FROM [RootEntities] AS [r]
+LEFT JOIN (
+    SELECT [r0].[RelationshipsRootEntityId], [r0].[Id1], [r0].[Name], [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r1].[RelationshipsTrunkEntityId1], [r2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r2].[RelationshipsBranchEntityRelationshipsTrunkEntityId1], [r3].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [r3].[RelationshipsBranchEntityRelationshipsTrunkEntityId1] AS [RelationshipsBranchEntityRelationshipsTrunkEntityId10], [r4].[RelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsTrunkEntityRelationshipsRootEntityId0], [r4].[RelationshipsTrunkEntityId1] AS [RelationshipsTrunkEntityId10], [r5].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [r5].[RelationshipsBranchEntityRelationshipsTrunkEntityId1] AS [RelationshipsBranchEntityRelationshipsTrunkEntityId11], [r6].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId2], [r6].[RelationshipsBranchEntityRelationshipsTrunkEntityId1] AS [RelationshipsBranchEntityRelationshipsTrunkEntityId12], [s].[RelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsTrunkEntityRelationshipsRootEntityId1], [s].[RelationshipsTrunkEntityId1] AS [RelationshipsTrunkEntityId11], [s].[Id1] AS [Id10], [s].[Name] AS [Name0], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId3], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityId1] AS [RelationshipsBranchEntityRelationshipsTrunkEntityId13], [s].[RelationshipsBranchEntityId1], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId00], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityId10] AS [RelationshipsBranchEntityRelationshipsTrunkEntityId100], [s].[RelationshipsBranchEntityId10], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId10], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityId11] AS [RelationshipsBranchEntityRelationshipsTrunkEntityId110], [s].[RelationshipsBranchEntityId11], [s].[Id10] AS [Id100], [s].[Name0] AS [Name00], [s].[Name1], [s].[Name2], [r1].[Name] AS [Name3], [r11].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId4], [r11].[RelationshipsBranchEntityRelationshipsTrunkEntityId1] AS [RelationshipsBranchEntityRelationshipsTrunkEntityId14], [r11].[Id1] AS [Id11], [r11].[Name] AS [Name4], [r2].[Name] AS [Name5], [r3].[Name] AS [Name6], [r4].[Name] AS [Name7], [r12].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId5], [r12].[RelationshipsBranchEntityRelationshipsTrunkEntityId1] AS [RelationshipsBranchEntityRelationshipsTrunkEntityId15], [r12].[Id1] AS [Id12], [r12].[Name] AS [Name8], [r5].[Name] AS [Name9], [r6].[Name] AS [Name10]
+    FROM [Root_CollectionTrunk] AS [r0]
+    LEFT JOIN [Root_CollectionTrunk_OptionalReferenceBranch] AS [r1] ON [r0].[RelationshipsRootEntityId] = [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId] AND [r0].[Id1] = [r1].[RelationshipsTrunkEntityId1]
+    LEFT JOIN [Root_CollectionTrunk_OptionalReferenceBranch_OptionalReferenceLeaf] AS [r2] ON [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r1].[RelationshipsTrunkEntityId1] = [r2].[RelationshipsBranchEntityRelationshipsTrunkEntityId1]
+    LEFT JOIN [Root_CollectionTrunk_OptionalReferenceBranch_RequiredReferenceLeaf] AS [r3] ON [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r3].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r1].[RelationshipsTrunkEntityId1] = [r3].[RelationshipsBranchEntityRelationshipsTrunkEntityId1]
+    LEFT JOIN [Root_CollectionTrunk_RequiredReferenceBranch] AS [r4] ON [r0].[RelationshipsRootEntityId] = [r4].[RelationshipsTrunkEntityRelationshipsRootEntityId] AND [r0].[Id1] = [r4].[RelationshipsTrunkEntityId1]
+    LEFT JOIN [Root_CollectionTrunk_RequiredReferenceBranch_OptionalReferenceLeaf] AS [r5] ON [r4].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r5].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r4].[RelationshipsTrunkEntityId1] = [r5].[RelationshipsBranchEntityRelationshipsTrunkEntityId1]
+    LEFT JOIN [Root_CollectionTrunk_RequiredReferenceBranch_RequiredReferenceLeaf] AS [r6] ON [r4].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r6].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r4].[RelationshipsTrunkEntityId1] = [r6].[RelationshipsBranchEntityRelationshipsTrunkEntityId1]
+    LEFT JOIN (
+        SELECT [r7].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r7].[RelationshipsTrunkEntityId1], [r7].[Id1], [r7].[Name], [r8].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r8].[RelationshipsBranchEntityRelationshipsTrunkEntityId1], [r8].[RelationshipsBranchEntityId1], [r9].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [r9].[RelationshipsBranchEntityRelationshipsTrunkEntityId1] AS [RelationshipsBranchEntityRelationshipsTrunkEntityId10], [r9].[RelationshipsBranchEntityId1] AS [RelationshipsBranchEntityId10], [r10].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [r10].[RelationshipsBranchEntityRelationshipsTrunkEntityId1] AS [RelationshipsBranchEntityRelationshipsTrunkEntityId11], [r10].[RelationshipsBranchEntityId1] AS [RelationshipsBranchEntityId11], [r10].[Id1] AS [Id10], [r10].[Name] AS [Name0], [r8].[Name] AS [Name1], [r9].[Name] AS [Name2]
+        FROM [Root_CollectionTrunk_CollectionBranch] AS [r7]
+        LEFT JOIN [Root_CollectionTrunk_CollectionBranch_OptionalReferenceLeaf] AS [r8] ON [r7].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r8].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r7].[RelationshipsTrunkEntityId1] = [r8].[RelationshipsBranchEntityRelationshipsTrunkEntityId1] AND [r7].[Id1] = [r8].[RelationshipsBranchEntityId1]
+        LEFT JOIN [Root_CollectionTrunk_CollectionBranch_RequiredReferenceLeaf] AS [r9] ON [r7].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r9].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r7].[RelationshipsTrunkEntityId1] = [r9].[RelationshipsBranchEntityRelationshipsTrunkEntityId1] AND [r7].[Id1] = [r9].[RelationshipsBranchEntityId1]
+        LEFT JOIN [Root_CollectionTrunk_CollectionBranch_CollectionLeaf] AS [r10] ON [r7].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r10].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r7].[RelationshipsTrunkEntityId1] = [r10].[RelationshipsBranchEntityRelationshipsTrunkEntityId1] AND [r7].[Id1] = [r10].[RelationshipsBranchEntityId1]
+    ) AS [s] ON [r0].[RelationshipsRootEntityId] = [s].[RelationshipsTrunkEntityRelationshipsRootEntityId] AND [r0].[Id1] = [s].[RelationshipsTrunkEntityId1]
+    LEFT JOIN [Root_CollectionTrunk_OptionalReferenceBranch_CollectionLeaf] AS [r11] ON [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r11].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r1].[RelationshipsTrunkEntityId1] = [r11].[RelationshipsBranchEntityRelationshipsTrunkEntityId1]
+    LEFT JOIN [Root_CollectionTrunk_RequiredReferenceBranch_CollectionLeaf] AS [r12] ON [r4].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r12].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r4].[RelationshipsTrunkEntityId1] = [r12].[RelationshipsBranchEntityRelationshipsTrunkEntityId1]
+) AS [s0] ON [r].[Id] = [s0].[RelationshipsRootEntityId]
+ORDER BY [r].[Id], [s0].[RelationshipsRootEntityId], [s0].[Id1], [s0].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s0].[RelationshipsTrunkEntityId1], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityId1], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityId10], [s0].[RelationshipsTrunkEntityRelationshipsRootEntityId0], [s0].[RelationshipsTrunkEntityId10], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityId11], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId2], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityId12], [s0].[RelationshipsTrunkEntityRelationshipsRootEntityId1], [s0].[RelationshipsTrunkEntityId11], [s0].[Id10], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId3], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityId13], [s0].[RelationshipsBranchEntityId1], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId00], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityId100], [s0].[RelationshipsBranchEntityId10], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId10], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityId110], [s0].[RelationshipsBranchEntityId11], [s0].[Id100], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId4], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityId14], [s0].[Id11], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId5], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityId15]
+""");
+    }
+
+    public override async Task Select_branch_required_collection(bool async)
+    {
+        await base.Select_branch_required_collection(async);
+
+        AssertSql(
+            """
+SELECT [r].[Id], [r0].[RelationshipsRootEntityId], [s].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s].[Id1], [s].[Name], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s].[RelationshipsBranchEntityId1], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [s].[RelationshipsBranchEntityId10], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [s].[RelationshipsBranchEntityId11], [s].[Id10], [s].[Name0], [s].[Name1], [s].[Name2]
+FROM [RootEntities] AS [r]
+LEFT JOIN [Root_RequiredReferenceTrunk] AS [r0] ON [r].[Id] = [r0].[RelationshipsRootEntityId]
+LEFT JOIN (
+    SELECT [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r1].[Id1], [r1].[Name], [r2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r2].[RelationshipsBranchEntityId1], [r3].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [r3].[RelationshipsBranchEntityId1] AS [RelationshipsBranchEntityId10], [r4].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [r4].[RelationshipsBranchEntityId1] AS [RelationshipsBranchEntityId11], [r4].[Id1] AS [Id10], [r4].[Name] AS [Name0], [r2].[Name] AS [Name1], [r3].[Name] AS [Name2]
+    FROM [Root_RequiredReferenceTrunk_CollectionBranch] AS [r1]
+    LEFT JOIN [Root_RequiredReferenceTrunk_CollectionBranch_OptionalReferenceLeaf] AS [r2] ON [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r1].[Id1] = [r2].[RelationshipsBranchEntityId1]
+    LEFT JOIN [Root_RequiredReferenceTrunk_CollectionBranch_RequiredReferenceLeaf] AS [r3] ON [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r3].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r1].[Id1] = [r3].[RelationshipsBranchEntityId1]
+    LEFT JOIN [Root_RequiredReferenceTrunk_CollectionBranch_CollectionLeaf] AS [r4] ON [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r4].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r1].[Id1] = [r4].[RelationshipsBranchEntityId1]
+) AS [s] ON [r0].[RelationshipsRootEntityId] = [s].[RelationshipsTrunkEntityRelationshipsRootEntityId]
+ORDER BY [r].[Id], [r0].[RelationshipsRootEntityId], [s].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s].[Id1], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s].[RelationshipsBranchEntityId1], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [s].[RelationshipsBranchEntityId10], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [s].[RelationshipsBranchEntityId11]
+""");
+    }
+
+    public override async Task Select_branch_optional_collection(bool async)
+    {
+        await base.Select_branch_optional_collection(async);
+
+        AssertSql(
+            """
+SELECT [r].[Id], [r0].[RelationshipsRootEntityId], [s].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s].[Id1], [s].[Name], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s].[RelationshipsBranchEntityId1], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [s].[RelationshipsBranchEntityId10], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [s].[RelationshipsBranchEntityId11], [s].[Id10], [s].[Name0], [s].[Name1], [s].[Name2]
+FROM [RootEntities] AS [r]
+LEFT JOIN [Root_RequiredReferenceTrunk] AS [r0] ON [r].[Id] = [r0].[RelationshipsRootEntityId]
+LEFT JOIN (
+    SELECT [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r1].[Id1], [r1].[Name], [r2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r2].[RelationshipsBranchEntityId1], [r3].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [r3].[RelationshipsBranchEntityId1] AS [RelationshipsBranchEntityId10], [r4].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [r4].[RelationshipsBranchEntityId1] AS [RelationshipsBranchEntityId11], [r4].[Id1] AS [Id10], [r4].[Name] AS [Name0], [r2].[Name] AS [Name1], [r3].[Name] AS [Name2]
+    FROM [Root_RequiredReferenceTrunk_CollectionBranch] AS [r1]
+    LEFT JOIN [Root_RequiredReferenceTrunk_CollectionBranch_OptionalReferenceLeaf] AS [r2] ON [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r1].[Id1] = [r2].[RelationshipsBranchEntityId1]
+    LEFT JOIN [Root_RequiredReferenceTrunk_CollectionBranch_RequiredReferenceLeaf] AS [r3] ON [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r3].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r1].[Id1] = [r3].[RelationshipsBranchEntityId1]
+    LEFT JOIN [Root_RequiredReferenceTrunk_CollectionBranch_CollectionLeaf] AS [r4] ON [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r4].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r1].[Id1] = [r4].[RelationshipsBranchEntityId1]
+) AS [s] ON [r0].[RelationshipsRootEntityId] = [s].[RelationshipsTrunkEntityRelationshipsRootEntityId]
+ORDER BY [r].[Id], [r0].[RelationshipsRootEntityId], [s].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s].[Id1], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s].[RelationshipsBranchEntityId1], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [s].[RelationshipsBranchEntityId10], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [s].[RelationshipsBranchEntityId11]
+""");
+    }
+
+    public override async Task Select_multiple_branch_leaf(bool async)
+    {
+        await base.Select_multiple_branch_leaf(async);
+
+        AssertSql(
+            """
+SELECT [r].[Id], [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r1].[Name], [r0].[RelationshipsRootEntityId], [r2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r3].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r4].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r4].[Id1], [r4].[Name], [r2].[Name], [r3].[Name], [r5].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r5].[Id1], [r5].[Name], [s].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s].[Id1], [s].[Name], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s].[RelationshipsBranchEntityId1], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [s].[RelationshipsBranchEntityId10], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [s].[RelationshipsBranchEntityId11], [s].[Id10], [s].[Name0], [s].[Name1], [s].[Name2]
+FROM [RootEntities] AS [r]
+LEFT JOIN [Root_RequiredReferenceTrunk] AS [r0] ON [r].[Id] = [r0].[RelationshipsRootEntityId]
+LEFT JOIN [Root_RequiredReferenceTrunk_RequiredReferenceBranch] AS [r1] ON [r0].[RelationshipsRootEntityId] = [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_RequiredReferenceTrunk_RequiredReferenceBranch_OptionalReferenceLeaf] AS [r2] ON [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_RequiredReferenceTrunk_RequiredReferenceBranch_RequiredReferenceLeaf] AS [r3] ON [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r3].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_RequiredReferenceTrunk_RequiredReferenceBranch_CollectionLeaf] AS [r4] ON [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r4].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_RequiredReferenceTrunk_RequiredReferenceBranch_CollectionLeaf] AS [r5] ON [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r5].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN (
+    SELECT [r6].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r6].[Id1], [r6].[Name], [r7].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r7].[RelationshipsBranchEntityId1], [r8].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [r8].[RelationshipsBranchEntityId1] AS [RelationshipsBranchEntityId10], [r9].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [r9].[RelationshipsBranchEntityId1] AS [RelationshipsBranchEntityId11], [r9].[Id1] AS [Id10], [r9].[Name] AS [Name0], [r7].[Name] AS [Name1], [r8].[Name] AS [Name2]
+    FROM [Root_RequiredReferenceTrunk_CollectionBranch] AS [r6]
+    LEFT JOIN [Root_RequiredReferenceTrunk_CollectionBranch_OptionalReferenceLeaf] AS [r7] ON [r6].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r7].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r6].[Id1] = [r7].[RelationshipsBranchEntityId1]
+    LEFT JOIN [Root_RequiredReferenceTrunk_CollectionBranch_RequiredReferenceLeaf] AS [r8] ON [r6].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r8].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r6].[Id1] = [r8].[RelationshipsBranchEntityId1]
+    LEFT JOIN [Root_RequiredReferenceTrunk_CollectionBranch_CollectionLeaf] AS [r9] ON [r6].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r9].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r6].[Id1] = [r9].[RelationshipsBranchEntityId1]
+) AS [s] ON [r0].[RelationshipsRootEntityId] = [s].[RelationshipsTrunkEntityRelationshipsRootEntityId]
+ORDER BY [r].[Id], [r0].[RelationshipsRootEntityId], [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r3].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r4].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r4].[Id1], [r5].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r5].[Id1], [s].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s].[Id1], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s].[RelationshipsBranchEntityId1], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [s].[RelationshipsBranchEntityId10], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [s].[RelationshipsBranchEntityId11]
+""");
+    }
+
+    public override async Task Select_subquery_root_set_trunk_FirstOrDefault_collection(bool async)
+    {
+        await base.Select_subquery_root_set_trunk_FirstOrDefault_collection(async);
+
+        AssertSql(
+            """
+SELECT [r].[Id], [s].[Id], [s].[RelationshipsRootEntityId], [s0].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s0].[Id1], [s0].[Name], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s0].[RelationshipsBranchEntityId1], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [s0].[RelationshipsBranchEntityId10], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [s0].[RelationshipsBranchEntityId11], [s0].[Id10], [s0].[Name0], [s0].[Name1], [s0].[Name2], [s].[c]
+FROM [RootEntities] AS [r]
+OUTER APPLY (
+    SELECT TOP(1) 1 AS [c], [r0].[Id], [r1].[RelationshipsRootEntityId]
+    FROM [RootEntities] AS [r0]
+    LEFT JOIN [Root_RequiredReferenceTrunk] AS [r1] ON [r0].[Id] = [r1].[RelationshipsRootEntityId]
+    ORDER BY [r0].[Id]
+) AS [s]
+LEFT JOIN (
+    SELECT [r2].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r2].[Id1], [r2].[Name], [r3].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r3].[RelationshipsBranchEntityId1], [r4].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [r4].[RelationshipsBranchEntityId1] AS [RelationshipsBranchEntityId10], [r5].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [r5].[RelationshipsBranchEntityId1] AS [RelationshipsBranchEntityId11], [r5].[Id1] AS [Id10], [r5].[Name] AS [Name0], [r3].[Name] AS [Name1], [r4].[Name] AS [Name2]
+    FROM [Root_RequiredReferenceTrunk_CollectionBranch] AS [r2]
+    LEFT JOIN [Root_RequiredReferenceTrunk_CollectionBranch_OptionalReferenceLeaf] AS [r3] ON [r2].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r3].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r2].[Id1] = [r3].[RelationshipsBranchEntityId1]
+    LEFT JOIN [Root_RequiredReferenceTrunk_CollectionBranch_RequiredReferenceLeaf] AS [r4] ON [r2].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r4].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r2].[Id1] = [r4].[RelationshipsBranchEntityId1]
+    LEFT JOIN [Root_RequiredReferenceTrunk_CollectionBranch_CollectionLeaf] AS [r5] ON [r2].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r5].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r2].[Id1] = [r5].[RelationshipsBranchEntityId1]
+) AS [s0] ON [s].[RelationshipsRootEntityId] = [s0].[RelationshipsTrunkEntityRelationshipsRootEntityId]
+ORDER BY [r].[Id], [s].[Id], [s].[RelationshipsRootEntityId], [s0].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s0].[Id1], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s0].[RelationshipsBranchEntityId1], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [s0].[RelationshipsBranchEntityId10], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [s0].[RelationshipsBranchEntityId11]
+""");
+    }
+
+    public override async Task Select_subquery_root_set_complex_projection_including_references_to_outer_FirstOrDefault(bool async)
+    {
+        await base.Select_subquery_root_set_complex_projection_including_references_to_outer_FirstOrDefault(async);
+
+        AssertSql(
+            """
+SELECT [r].[Id], [r0].[RelationshipsRootEntityId], [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s].[Id], [s].[RelationshipsRootEntityId], [s].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [s].[RelationshipsTrunkEntityRelationshipsRootEntityId0], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId2], [s0].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s0].[Id1], [s0].[Name], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s0].[RelationshipsBranchEntityId1], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [s0].[RelationshipsBranchEntityId10], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [s0].[RelationshipsBranchEntityId11], [s0].[Id10], [s0].[Name0], [s0].[Name1], [s0].[Name2], [s].[Name], [s1].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s1].[Id1], [s1].[Name], [s1].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s1].[RelationshipsBranchEntityId1], [s1].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [s1].[RelationshipsBranchEntityId10], [s1].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [s1].[RelationshipsBranchEntityId11], [s1].[Id10], [s1].[Name0], [s1].[Name1], [s1].[Name2], [s].[Name0], [r18].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r18].[Id1], [r18].[Name], [s].[Name1], [s].[Name2], [s].[Name3], [r19].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r19].[Id1], [r19].[Name], [s].[Name4], [s].[Name5], [r20].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r20].[Id1], [r20].[Name], [s].[Name6], [s].[c]
+FROM [RootEntities] AS [r]
+LEFT JOIN [Root_RequiredReferenceTrunk] AS [r0] ON [r].[Id] = [r0].[RelationshipsRootEntityId]
+LEFT JOIN [Root_RequiredReferenceTrunk_RequiredReferenceBranch] AS [r1] ON [r0].[RelationshipsRootEntityId] = [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId]
+OUTER APPLY (
+    SELECT TOP(1) [r3].[RelationshipsRootEntityId], [r3].[Name], [r4].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r4].[Name] AS [Name0], [r5].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r5].[Name] AS [Name1], [r6].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [r6].[Name] AS [Name2], [r7].[RelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsTrunkEntityRelationshipsRootEntityId0], [r7].[Name] AS [Name3], [r8].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [r8].[Name] AS [Name4], [r9].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId2], [r9].[Name] AS [Name5], [r1].[Name] AS [Name6], 1 AS [c], [r2].[Id]
+    FROM [RootEntities] AS [r2]
+    LEFT JOIN [Root_RequiredReferenceTrunk] AS [r3] ON [r2].[Id] = [r3].[RelationshipsRootEntityId]
+    LEFT JOIN [Root_RequiredReferenceTrunk_OptionalReferenceBranch] AS [r4] ON [r3].[RelationshipsRootEntityId] = [r4].[RelationshipsTrunkEntityRelationshipsRootEntityId]
+    LEFT JOIN [Root_RequiredReferenceTrunk_OptionalReferenceBranch_OptionalReferenceLeaf] AS [r5] ON [r4].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r5].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+    LEFT JOIN [Root_RequiredReferenceTrunk_OptionalReferenceBranch_RequiredReferenceLeaf] AS [r6] ON [r4].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r6].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+    LEFT JOIN [Root_RequiredReferenceTrunk_RequiredReferenceBranch] AS [r7] ON [r3].[RelationshipsRootEntityId] = [r7].[RelationshipsTrunkEntityRelationshipsRootEntityId]
+    LEFT JOIN [Root_RequiredReferenceTrunk_RequiredReferenceBranch_OptionalReferenceLeaf] AS [r8] ON [r7].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r8].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+    LEFT JOIN [Root_RequiredReferenceTrunk_RequiredReferenceBranch_RequiredReferenceLeaf] AS [r9] ON [r7].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r9].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+    ORDER BY [r2].[Id]
+) AS [s]
+LEFT JOIN (
+    SELECT [r10].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r10].[Id1], [r10].[Name], [r11].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r11].[RelationshipsBranchEntityId1], [r12].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [r12].[RelationshipsBranchEntityId1] AS [RelationshipsBranchEntityId10], [r13].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [r13].[RelationshipsBranchEntityId1] AS [RelationshipsBranchEntityId11], [r13].[Id1] AS [Id10], [r13].[Name] AS [Name0], [r11].[Name] AS [Name1], [r12].[Name] AS [Name2]
+    FROM [Root_RequiredReferenceTrunk_CollectionBranch] AS [r10]
+    LEFT JOIN [Root_RequiredReferenceTrunk_CollectionBranch_OptionalReferenceLeaf] AS [r11] ON [r10].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r11].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r10].[Id1] = [r11].[RelationshipsBranchEntityId1]
+    LEFT JOIN [Root_RequiredReferenceTrunk_CollectionBranch_RequiredReferenceLeaf] AS [r12] ON [r10].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r12].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r10].[Id1] = [r12].[RelationshipsBranchEntityId1]
+    LEFT JOIN [Root_RequiredReferenceTrunk_CollectionBranch_CollectionLeaf] AS [r13] ON [r10].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r13].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r10].[Id1] = [r13].[RelationshipsBranchEntityId1]
+) AS [s0] ON [r0].[RelationshipsRootEntityId] = [s0].[RelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN (
+    SELECT [r14].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r14].[Id1], [r14].[Name], [r15].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r15].[RelationshipsBranchEntityId1], [r16].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [r16].[RelationshipsBranchEntityId1] AS [RelationshipsBranchEntityId10], [r17].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [r17].[RelationshipsBranchEntityId1] AS [RelationshipsBranchEntityId11], [r17].[Id1] AS [Id10], [r17].[Name] AS [Name0], [r15].[Name] AS [Name1], [r16].[Name] AS [Name2]
+    FROM [Root_RequiredReferenceTrunk_CollectionBranch] AS [r14]
+    LEFT JOIN [Root_RequiredReferenceTrunk_CollectionBranch_OptionalReferenceLeaf] AS [r15] ON [r14].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r15].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r14].[Id1] = [r15].[RelationshipsBranchEntityId1]
+    LEFT JOIN [Root_RequiredReferenceTrunk_CollectionBranch_RequiredReferenceLeaf] AS [r16] ON [r14].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r16].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r14].[Id1] = [r16].[RelationshipsBranchEntityId1]
+    LEFT JOIN [Root_RequiredReferenceTrunk_CollectionBranch_CollectionLeaf] AS [r17] ON [r14].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r17].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r14].[Id1] = [r17].[RelationshipsBranchEntityId1]
+) AS [s1] ON [s].[RelationshipsRootEntityId] = [s1].[RelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_RequiredReferenceTrunk_OptionalReferenceBranch_CollectionLeaf] AS [r18] ON [s].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r18].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_RequiredReferenceTrunk_RequiredReferenceBranch_CollectionLeaf] AS [r19] ON [s].[RelationshipsTrunkEntityRelationshipsRootEntityId0] = [r19].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_RequiredReferenceTrunk_RequiredReferenceBranch_CollectionLeaf] AS [r20] ON [s].[RelationshipsTrunkEntityRelationshipsRootEntityId0] = [r20].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+ORDER BY [r].[Id], [r0].[RelationshipsRootEntityId], [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s].[Id], [s].[RelationshipsRootEntityId], [s].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [s].[RelationshipsTrunkEntityRelationshipsRootEntityId0], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId2], [s0].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s0].[Id1], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s0].[RelationshipsBranchEntityId1], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [s0].[RelationshipsBranchEntityId10], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [s0].[RelationshipsBranchEntityId11], [s0].[Id10], [s1].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s1].[Id1], [s1].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s1].[RelationshipsBranchEntityId1], [s1].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [s1].[RelationshipsBranchEntityId10], [s1].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [s1].[RelationshipsBranchEntityId11], [s1].[Id10], [r18].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r18].[Id1], [r19].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r19].[Id1], [r20].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+""");
+    }
+
+    public override async Task Select_subquery_root_set_complex_projection_FirstOrDefault_project_reference_to_outer(bool async)
+    {
+        await base.Select_subquery_root_set_complex_projection_FirstOrDefault_project_reference_to_outer(async);
+
+        AssertSql(
+            """
+SELECT [r].[Id], [r0].[RelationshipsRootEntityId], [r6].[Id], [s].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s].[Id1], [s].[Name], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s].[RelationshipsBranchEntityId1], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [s].[RelationshipsBranchEntityId10], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [s].[RelationshipsBranchEntityId11], [s].[Id10], [s].[Name0], [s].[Name1], [s].[Name2], [r6].[c]
+FROM [RootEntities] AS [r]
+LEFT JOIN [Root_RequiredReferenceTrunk] AS [r0] ON [r].[Id] = [r0].[RelationshipsRootEntityId]
+OUTER APPLY (
+    SELECT TOP(1) 1 AS [c], [r1].[Id]
+    FROM [RootEntities] AS [r1]
+    ORDER BY [r1].[Id]
+) AS [r6]
+LEFT JOIN (
+    SELECT [r2].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r2].[Id1], [r2].[Name], [r3].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r3].[RelationshipsBranchEntityId1], [r4].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [r4].[RelationshipsBranchEntityId1] AS [RelationshipsBranchEntityId10], [r5].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [r5].[RelationshipsBranchEntityId1] AS [RelationshipsBranchEntityId11], [r5].[Id1] AS [Id10], [r5].[Name] AS [Name0], [r3].[Name] AS [Name1], [r4].[Name] AS [Name2]
+    FROM [Root_RequiredReferenceTrunk_CollectionBranch] AS [r2]
+    LEFT JOIN [Root_RequiredReferenceTrunk_CollectionBranch_OptionalReferenceLeaf] AS [r3] ON [r2].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r3].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r2].[Id1] = [r3].[RelationshipsBranchEntityId1]
+    LEFT JOIN [Root_RequiredReferenceTrunk_CollectionBranch_RequiredReferenceLeaf] AS [r4] ON [r2].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r4].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r2].[Id1] = [r4].[RelationshipsBranchEntityId1]
+    LEFT JOIN [Root_RequiredReferenceTrunk_CollectionBranch_CollectionLeaf] AS [r5] ON [r2].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r5].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r2].[Id1] = [r5].[RelationshipsBranchEntityId1]
+) AS [s] ON [r0].[RelationshipsRootEntityId] = [s].[RelationshipsTrunkEntityRelationshipsRootEntityId]
+ORDER BY [r].[Id], [r0].[RelationshipsRootEntityId], [r6].[Id], [s].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s].[Id1], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s].[RelationshipsBranchEntityId1], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [s].[RelationshipsBranchEntityId10], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [s].[RelationshipsBranchEntityId11]
+""");
+    }
+
+    public override async Task SelectMany_trunk_collection(bool async)
+    {
+        await base.SelectMany_trunk_collection(async);
+
+        AssertSql(
+            """
+SELECT [r0].[RelationshipsRootEntityId], [r0].[Id1], [r0].[Name], [r].[Id], [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r1].[RelationshipsTrunkEntityId1], [r2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r2].[RelationshipsBranchEntityRelationshipsTrunkEntityId1], [r3].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r3].[RelationshipsBranchEntityRelationshipsTrunkEntityId1], [r4].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r4].[RelationshipsTrunkEntityId1], [r5].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r5].[RelationshipsBranchEntityRelationshipsTrunkEntityId1], [r6].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r6].[RelationshipsBranchEntityRelationshipsTrunkEntityId1], [s].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s].[RelationshipsTrunkEntityId1], [s].[Id1], [s].[Name], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityId1], [s].[RelationshipsBranchEntityId1], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityId10], [s].[RelationshipsBranchEntityId10], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityId11], [s].[RelationshipsBranchEntityId11], [s].[Id10], [s].[Name0], [s].[Name1], [s].[Name2], [r1].[Name], [r11].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r11].[RelationshipsBranchEntityRelationshipsTrunkEntityId1], [r11].[Id1], [r11].[Name], [r2].[Name], [r3].[Name], [r4].[Name], [r12].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r12].[RelationshipsBranchEntityRelationshipsTrunkEntityId1], [r12].[Id1], [r12].[Name], [r5].[Name], [r6].[Name]
+FROM [RootEntities] AS [r]
+INNER JOIN [Root_CollectionTrunk] AS [r0] ON [r].[Id] = [r0].[RelationshipsRootEntityId]
+LEFT JOIN [Root_CollectionTrunk_OptionalReferenceBranch] AS [r1] ON [r0].[RelationshipsRootEntityId] = [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId] AND [r0].[Id1] = [r1].[RelationshipsTrunkEntityId1]
+LEFT JOIN [Root_CollectionTrunk_OptionalReferenceBranch_OptionalReferenceLeaf] AS [r2] ON [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r1].[RelationshipsTrunkEntityId1] = [r2].[RelationshipsBranchEntityRelationshipsTrunkEntityId1]
+LEFT JOIN [Root_CollectionTrunk_OptionalReferenceBranch_RequiredReferenceLeaf] AS [r3] ON [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r3].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r1].[RelationshipsTrunkEntityId1] = [r3].[RelationshipsBranchEntityRelationshipsTrunkEntityId1]
+LEFT JOIN [Root_CollectionTrunk_RequiredReferenceBranch] AS [r4] ON [r0].[RelationshipsRootEntityId] = [r4].[RelationshipsTrunkEntityRelationshipsRootEntityId] AND [r0].[Id1] = [r4].[RelationshipsTrunkEntityId1]
+LEFT JOIN [Root_CollectionTrunk_RequiredReferenceBranch_OptionalReferenceLeaf] AS [r5] ON [r4].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r5].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r4].[RelationshipsTrunkEntityId1] = [r5].[RelationshipsBranchEntityRelationshipsTrunkEntityId1]
+LEFT JOIN [Root_CollectionTrunk_RequiredReferenceBranch_RequiredReferenceLeaf] AS [r6] ON [r4].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r6].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r4].[RelationshipsTrunkEntityId1] = [r6].[RelationshipsBranchEntityRelationshipsTrunkEntityId1]
+LEFT JOIN (
+    SELECT [r7].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r7].[RelationshipsTrunkEntityId1], [r7].[Id1], [r7].[Name], [r8].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r8].[RelationshipsBranchEntityRelationshipsTrunkEntityId1], [r8].[RelationshipsBranchEntityId1], [r9].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [r9].[RelationshipsBranchEntityRelationshipsTrunkEntityId1] AS [RelationshipsBranchEntityRelationshipsTrunkEntityId10], [r9].[RelationshipsBranchEntityId1] AS [RelationshipsBranchEntityId10], [r10].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [r10].[RelationshipsBranchEntityRelationshipsTrunkEntityId1] AS [RelationshipsBranchEntityRelationshipsTrunkEntityId11], [r10].[RelationshipsBranchEntityId1] AS [RelationshipsBranchEntityId11], [r10].[Id1] AS [Id10], [r10].[Name] AS [Name0], [r8].[Name] AS [Name1], [r9].[Name] AS [Name2]
+    FROM [Root_CollectionTrunk_CollectionBranch] AS [r7]
+    LEFT JOIN [Root_CollectionTrunk_CollectionBranch_OptionalReferenceLeaf] AS [r8] ON [r7].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r8].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r7].[RelationshipsTrunkEntityId1] = [r8].[RelationshipsBranchEntityRelationshipsTrunkEntityId1] AND [r7].[Id1] = [r8].[RelationshipsBranchEntityId1]
+    LEFT JOIN [Root_CollectionTrunk_CollectionBranch_RequiredReferenceLeaf] AS [r9] ON [r7].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r9].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r7].[RelationshipsTrunkEntityId1] = [r9].[RelationshipsBranchEntityRelationshipsTrunkEntityId1] AND [r7].[Id1] = [r9].[RelationshipsBranchEntityId1]
+    LEFT JOIN [Root_CollectionTrunk_CollectionBranch_CollectionLeaf] AS [r10] ON [r7].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r10].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r7].[RelationshipsTrunkEntityId1] = [r10].[RelationshipsBranchEntityRelationshipsTrunkEntityId1] AND [r7].[Id1] = [r10].[RelationshipsBranchEntityId1]
+) AS [s] ON [r0].[RelationshipsRootEntityId] = [s].[RelationshipsTrunkEntityRelationshipsRootEntityId] AND [r0].[Id1] = [s].[RelationshipsTrunkEntityId1]
+LEFT JOIN [Root_CollectionTrunk_OptionalReferenceBranch_CollectionLeaf] AS [r11] ON [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r11].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r1].[RelationshipsTrunkEntityId1] = [r11].[RelationshipsBranchEntityRelationshipsTrunkEntityId1]
+LEFT JOIN [Root_CollectionTrunk_RequiredReferenceBranch_CollectionLeaf] AS [r12] ON [r4].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r12].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r4].[RelationshipsTrunkEntityId1] = [r12].[RelationshipsBranchEntityRelationshipsTrunkEntityId1]
+ORDER BY [r].[Id], [r0].[RelationshipsRootEntityId], [r0].[Id1], [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r1].[RelationshipsTrunkEntityId1], [r2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r2].[RelationshipsBranchEntityRelationshipsTrunkEntityId1], [r3].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r3].[RelationshipsBranchEntityRelationshipsTrunkEntityId1], [r4].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r4].[RelationshipsTrunkEntityId1], [r5].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r5].[RelationshipsBranchEntityRelationshipsTrunkEntityId1], [r6].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r6].[RelationshipsBranchEntityRelationshipsTrunkEntityId1], [s].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s].[RelationshipsTrunkEntityId1], [s].[Id1], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityId1], [s].[RelationshipsBranchEntityId1], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityId10], [s].[RelationshipsBranchEntityId10], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityId11], [s].[RelationshipsBranchEntityId11], [s].[Id10], [r11].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r11].[RelationshipsBranchEntityRelationshipsTrunkEntityId1], [r11].[Id1], [r12].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r12].[RelationshipsBranchEntityRelationshipsTrunkEntityId1]
+""");
+    }
+
+    public override async Task SelectMany_required_trunk_reference_branch_collection(bool async)
+    {
+        await base.SelectMany_required_trunk_reference_branch_collection(async);
+
+        AssertSql(
+            """
+SELECT [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r1].[Id1], [r1].[Name], [r].[Id], [r0].[RelationshipsRootEntityId], [r2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r2].[RelationshipsBranchEntityId1], [r3].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r3].[RelationshipsBranchEntityId1], [r4].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r4].[RelationshipsBranchEntityId1], [r4].[Id1], [r4].[Name], [r2].[Name], [r3].[Name]
+FROM [RootEntities] AS [r]
+LEFT JOIN [Root_RequiredReferenceTrunk] AS [r0] ON [r].[Id] = [r0].[RelationshipsRootEntityId]
+INNER JOIN [Root_RequiredReferenceTrunk_CollectionBranch] AS [r1] ON [r0].[RelationshipsRootEntityId] = [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_RequiredReferenceTrunk_CollectionBranch_OptionalReferenceLeaf] AS [r2] ON [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r1].[Id1] = [r2].[RelationshipsBranchEntityId1]
+LEFT JOIN [Root_RequiredReferenceTrunk_CollectionBranch_RequiredReferenceLeaf] AS [r3] ON [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r3].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r1].[Id1] = [r3].[RelationshipsBranchEntityId1]
+LEFT JOIN [Root_RequiredReferenceTrunk_CollectionBranch_CollectionLeaf] AS [r4] ON [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r4].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r1].[Id1] = [r4].[RelationshipsBranchEntityId1]
+ORDER BY [r].[Id], [r0].[RelationshipsRootEntityId], [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r1].[Id1], [r2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r2].[RelationshipsBranchEntityId1], [r3].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r3].[RelationshipsBranchEntityId1], [r4].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r4].[RelationshipsBranchEntityId1]
+""");
+    }
+
+    public override async Task SelectMany_optional_trunk_reference_branch_collection(bool async)
+    {
+        await base.SelectMany_optional_trunk_reference_branch_collection(async);
+
+        AssertSql(
+            """
+SELECT [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r1].[Id1], [r1].[Name], [r].[Id], [r0].[RelationshipsRootEntityId], [r2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r2].[RelationshipsBranchEntityId1], [r3].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r3].[RelationshipsBranchEntityId1], [r4].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r4].[RelationshipsBranchEntityId1], [r4].[Id1], [r4].[Name], [r2].[Name], [r3].[Name]
+FROM [RootEntities] AS [r]
+LEFT JOIN [Root_OptionalReferenceTrunk] AS [r0] ON [r].[Id] = [r0].[RelationshipsRootEntityId]
+INNER JOIN [Root_OptionalReferenceTrunk_CollectionBranch] AS [r1] ON [r0].[RelationshipsRootEntityId] = [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_OptionalReferenceTrunk_CollectionBranch_OptionalReferenceLeaf] AS [r2] ON [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r1].[Id1] = [r2].[RelationshipsBranchEntityId1]
+LEFT JOIN [Root_OptionalReferenceTrunk_CollectionBranch_RequiredReferenceLeaf] AS [r3] ON [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r3].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r1].[Id1] = [r3].[RelationshipsBranchEntityId1]
+LEFT JOIN [Root_OptionalReferenceTrunk_CollectionBranch_CollectionLeaf] AS [r4] ON [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r4].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r1].[Id1] = [r4].[RelationshipsBranchEntityId1]
+ORDER BY [r].[Id], [r0].[RelationshipsRootEntityId], [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r1].[Id1], [r2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r2].[RelationshipsBranchEntityId1], [r3].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r3].[RelationshipsBranchEntityId1], [r4].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r4].[RelationshipsBranchEntityId1]
+""");
+    }
+
+    private void AssertSql(params string[] expected)
+        => Fixture.TestSqlLoggerFactory.AssertBaseline(expected);
+}
diff --git a/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/Projection/OwnedTableSplittingReferenceProjectionNoTrackingSqlServerTest.cs b/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/Projection/OwnedTableSplittingReferenceProjectionNoTrackingSqlServerTest.cs
new file mode 100644
index 0000000000..cb7bdc03dd
--- /dev/null
+++ b/test/EFCore.SqlServer.FunctionalTests/Query/Relationships/Projection/OwnedTableSplittingReferenceProjectionNoTrackingSqlServerTest.cs
@@ -0,0 +1,497 @@
+﻿// Licensed to the .NET Foundation under one or more agreements.
+// The .NET Foundation licenses this file to you under the MIT license.
+
+namespace Microsoft.EntityFrameworkCore.Query.Relationships.Projection;
+
+public class OwnedTableSplittingReferenceProjectionNoTrackingSqlServerTest
+    : OwnedTableSplittingReferenceProjectionNoTrackingRelationalTestBase<OwnedTableSplittingRelationshipsSqlServerFixture>
+{
+    public OwnedTableSplittingReferenceProjectionNoTrackingSqlServerTest(OwnedTableSplittingRelationshipsSqlServerFixture fixture, ITestOutputHelper testOutputHelper)
+        : base(fixture)
+    {
+        Fixture.TestSqlLoggerFactory.Clear();
+        Fixture.TestSqlLoggerFactory.SetTestOutputHelper(testOutputHelper);
+    }
+
+    public override async Task Select_root(bool async)
+    {
+        await base.Select_root(async);
+
+        AssertSql(
+            """
+SELECT [r].[Id], [r].[Name], [r].[OptionalReferenceTrunkId], [r].[RequiredReferenceTrunkId], [r0].[RelationshipsRootEntityId], [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r3].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r4].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r5].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r6].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r7].[RelationshipsRootEntityId], [r8].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r9].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r10].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r11].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r12].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r13].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s0].[RelationshipsRootEntityId], [s0].[Id1], [s0].[Name], [s0].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s0].[RelationshipsTrunkEntityId1], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityId1], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityId10], [s0].[RelationshipsTrunkEntityRelationshipsRootEntityId0], [s0].[RelationshipsTrunkEntityId10], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityId11], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId2], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityId12], [s0].[RelationshipsTrunkEntityRelationshipsRootEntityId1], [s0].[RelationshipsTrunkEntityId11], [s0].[Id10], [s0].[Name0], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId3], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityId13], [s0].[RelationshipsBranchEntityId1], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId00], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityId100], [s0].[RelationshipsBranchEntityId10], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId10], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityId110], [s0].[RelationshipsBranchEntityId11], [s0].[Id100], [s0].[Name00], [s0].[Name1], [s0].[Name2], [s0].[Name3], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId4], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityId14], [s0].[Id11], [s0].[Name4], [s0].[Name5], [s0].[Name6], [s0].[Name7], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId5], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityId15], [s0].[Id12], [s0].[Name8], [s0].[Name9], [s0].[Name10], [r0].[Name], [s1].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s1].[Id1], [s1].[Name], [s1].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s1].[RelationshipsBranchEntityId1], [s1].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [s1].[RelationshipsBranchEntityId10], [s1].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [s1].[RelationshipsBranchEntityId11], [s1].[Id10], [s1].[Name0], [s1].[Name1], [s1].[Name2], [r1].[Name], [r31].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r31].[Id1], [r31].[Name], [r2].[Name], [r3].[Name], [r4].[Name], [r32].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r32].[Id1], [r32].[Name], [r5].[Name], [r6].[Name], [r7].[Name], [s2].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s2].[Id1], [s2].[Name], [s2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s2].[RelationshipsBranchEntityId1], [s2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [s2].[RelationshipsBranchEntityId10], [s2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [s2].[RelationshipsBranchEntityId11], [s2].[Id10], [s2].[Name0], [s2].[Name1], [s2].[Name2], [r8].[Name], [r37].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r37].[Id1], [r37].[Name], [r9].[Name], [r10].[Name], [r11].[Name], [r38].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r38].[Id1], [r38].[Name], [r12].[Name], [r13].[Name]
+FROM [RootEntities] AS [r]
+LEFT JOIN [Root_OptionalReferenceTrunk] AS [r0] ON [r].[Id] = [r0].[RelationshipsRootEntityId]
+LEFT JOIN [Root_OptionalReferenceTrunk_OptionalReferenceBranch] AS [r1] ON [r0].[RelationshipsRootEntityId] = [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_OptionalReferenceTrunk_OptionalReferenceBranch_OptionalReferenceLeaf] AS [r2] ON [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_OptionalReferenceTrunk_OptionalReferenceBranch_RequiredReferenceLeaf] AS [r3] ON [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r3].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_OptionalReferenceTrunk_RequiredReferenceBranch] AS [r4] ON [r0].[RelationshipsRootEntityId] = [r4].[RelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_OptionalReferenceTrunk_RequiredReferenceBranch_OptionalReferenceLeaf] AS [r5] ON [r4].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r5].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_OptionalReferenceTrunk_RequiredReferenceBranch_RequiredReferenceLeaf] AS [r6] ON [r4].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r6].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_RequiredReferenceTrunk] AS [r7] ON [r].[Id] = [r7].[RelationshipsRootEntityId]
+LEFT JOIN [Root_RequiredReferenceTrunk_OptionalReferenceBranch] AS [r8] ON [r7].[RelationshipsRootEntityId] = [r8].[RelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_RequiredReferenceTrunk_OptionalReferenceBranch_OptionalReferenceLeaf] AS [r9] ON [r8].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r9].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_RequiredReferenceTrunk_OptionalReferenceBranch_RequiredReferenceLeaf] AS [r10] ON [r8].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r10].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_RequiredReferenceTrunk_RequiredReferenceBranch] AS [r11] ON [r7].[RelationshipsRootEntityId] = [r11].[RelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_RequiredReferenceTrunk_RequiredReferenceBranch_OptionalReferenceLeaf] AS [r12] ON [r11].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r12].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_RequiredReferenceTrunk_RequiredReferenceBranch_RequiredReferenceLeaf] AS [r13] ON [r11].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r13].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN (
+    SELECT [r14].[RelationshipsRootEntityId], [r14].[Id1], [r14].[Name], [r15].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r15].[RelationshipsTrunkEntityId1], [r16].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r16].[RelationshipsBranchEntityRelationshipsTrunkEntityId1], [r17].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [r17].[RelationshipsBranchEntityRelationshipsTrunkEntityId1] AS [RelationshipsBranchEntityRelationshipsTrunkEntityId10], [r18].[RelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsTrunkEntityRelationshipsRootEntityId0], [r18].[RelationshipsTrunkEntityId1] AS [RelationshipsTrunkEntityId10], [r19].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [r19].[RelationshipsBranchEntityRelationshipsTrunkEntityId1] AS [RelationshipsBranchEntityRelationshipsTrunkEntityId11], [r20].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId2], [r20].[RelationshipsBranchEntityRelationshipsTrunkEntityId1] AS [RelationshipsBranchEntityRelationshipsTrunkEntityId12], [s].[RelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsTrunkEntityRelationshipsRootEntityId1], [s].[RelationshipsTrunkEntityId1] AS [RelationshipsTrunkEntityId11], [s].[Id1] AS [Id10], [s].[Name] AS [Name0], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId3], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityId1] AS [RelationshipsBranchEntityRelationshipsTrunkEntityId13], [s].[RelationshipsBranchEntityId1], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId00], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityId10] AS [RelationshipsBranchEntityRelationshipsTrunkEntityId100], [s].[RelationshipsBranchEntityId10], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId10], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityId11] AS [RelationshipsBranchEntityRelationshipsTrunkEntityId110], [s].[RelationshipsBranchEntityId11], [s].[Id10] AS [Id100], [s].[Name0] AS [Name00], [s].[Name1], [s].[Name2], [r15].[Name] AS [Name3], [r25].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId4], [r25].[RelationshipsBranchEntityRelationshipsTrunkEntityId1] AS [RelationshipsBranchEntityRelationshipsTrunkEntityId14], [r25].[Id1] AS [Id11], [r25].[Name] AS [Name4], [r16].[Name] AS [Name5], [r17].[Name] AS [Name6], [r18].[Name] AS [Name7], [r26].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId5], [r26].[RelationshipsBranchEntityRelationshipsTrunkEntityId1] AS [RelationshipsBranchEntityRelationshipsTrunkEntityId15], [r26].[Id1] AS [Id12], [r26].[Name] AS [Name8], [r19].[Name] AS [Name9], [r20].[Name] AS [Name10]
+    FROM [Root_CollectionTrunk] AS [r14]
+    LEFT JOIN [Root_CollectionTrunk_OptionalReferenceBranch] AS [r15] ON [r14].[RelationshipsRootEntityId] = [r15].[RelationshipsTrunkEntityRelationshipsRootEntityId] AND [r14].[Id1] = [r15].[RelationshipsTrunkEntityId1]
+    LEFT JOIN [Root_CollectionTrunk_OptionalReferenceBranch_OptionalReferenceLeaf] AS [r16] ON [r15].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r16].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r15].[RelationshipsTrunkEntityId1] = [r16].[RelationshipsBranchEntityRelationshipsTrunkEntityId1]
+    LEFT JOIN [Root_CollectionTrunk_OptionalReferenceBranch_RequiredReferenceLeaf] AS [r17] ON [r15].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r17].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r15].[RelationshipsTrunkEntityId1] = [r17].[RelationshipsBranchEntityRelationshipsTrunkEntityId1]
+    LEFT JOIN [Root_CollectionTrunk_RequiredReferenceBranch] AS [r18] ON [r14].[RelationshipsRootEntityId] = [r18].[RelationshipsTrunkEntityRelationshipsRootEntityId] AND [r14].[Id1] = [r18].[RelationshipsTrunkEntityId1]
+    LEFT JOIN [Root_CollectionTrunk_RequiredReferenceBranch_OptionalReferenceLeaf] AS [r19] ON [r18].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r19].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r18].[RelationshipsTrunkEntityId1] = [r19].[RelationshipsBranchEntityRelationshipsTrunkEntityId1]
+    LEFT JOIN [Root_CollectionTrunk_RequiredReferenceBranch_RequiredReferenceLeaf] AS [r20] ON [r18].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r20].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r18].[RelationshipsTrunkEntityId1] = [r20].[RelationshipsBranchEntityRelationshipsTrunkEntityId1]
+    LEFT JOIN (
+        SELECT [r21].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r21].[RelationshipsTrunkEntityId1], [r21].[Id1], [r21].[Name], [r22].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r22].[RelationshipsBranchEntityRelationshipsTrunkEntityId1], [r22].[RelationshipsBranchEntityId1], [r23].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [r23].[RelationshipsBranchEntityRelationshipsTrunkEntityId1] AS [RelationshipsBranchEntityRelationshipsTrunkEntityId10], [r23].[RelationshipsBranchEntityId1] AS [RelationshipsBranchEntityId10], [r24].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [r24].[RelationshipsBranchEntityRelationshipsTrunkEntityId1] AS [RelationshipsBranchEntityRelationshipsTrunkEntityId11], [r24].[RelationshipsBranchEntityId1] AS [RelationshipsBranchEntityId11], [r24].[Id1] AS [Id10], [r24].[Name] AS [Name0], [r22].[Name] AS [Name1], [r23].[Name] AS [Name2]
+        FROM [Root_CollectionTrunk_CollectionBranch] AS [r21]
+        LEFT JOIN [Root_CollectionTrunk_CollectionBranch_OptionalReferenceLeaf] AS [r22] ON [r21].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r22].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r21].[RelationshipsTrunkEntityId1] = [r22].[RelationshipsBranchEntityRelationshipsTrunkEntityId1] AND [r21].[Id1] = [r22].[RelationshipsBranchEntityId1]
+        LEFT JOIN [Root_CollectionTrunk_CollectionBranch_RequiredReferenceLeaf] AS [r23] ON [r21].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r23].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r21].[RelationshipsTrunkEntityId1] = [r23].[RelationshipsBranchEntityRelationshipsTrunkEntityId1] AND [r21].[Id1] = [r23].[RelationshipsBranchEntityId1]
+        LEFT JOIN [Root_CollectionTrunk_CollectionBranch_CollectionLeaf] AS [r24] ON [r21].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r24].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r21].[RelationshipsTrunkEntityId1] = [r24].[RelationshipsBranchEntityRelationshipsTrunkEntityId1] AND [r21].[Id1] = [r24].[RelationshipsBranchEntityId1]
+    ) AS [s] ON [r14].[RelationshipsRootEntityId] = [s].[RelationshipsTrunkEntityRelationshipsRootEntityId] AND [r14].[Id1] = [s].[RelationshipsTrunkEntityId1]
+    LEFT JOIN [Root_CollectionTrunk_OptionalReferenceBranch_CollectionLeaf] AS [r25] ON [r15].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r25].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r15].[RelationshipsTrunkEntityId1] = [r25].[RelationshipsBranchEntityRelationshipsTrunkEntityId1]
+    LEFT JOIN [Root_CollectionTrunk_RequiredReferenceBranch_CollectionLeaf] AS [r26] ON [r18].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r26].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r18].[RelationshipsTrunkEntityId1] = [r26].[RelationshipsBranchEntityRelationshipsTrunkEntityId1]
+) AS [s0] ON [r].[Id] = [s0].[RelationshipsRootEntityId]
+LEFT JOIN (
+    SELECT [r27].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r27].[Id1], [r27].[Name], [r28].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r28].[RelationshipsBranchEntityId1], [r29].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [r29].[RelationshipsBranchEntityId1] AS [RelationshipsBranchEntityId10], [r30].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [r30].[RelationshipsBranchEntityId1] AS [RelationshipsBranchEntityId11], [r30].[Id1] AS [Id10], [r30].[Name] AS [Name0], [r28].[Name] AS [Name1], [r29].[Name] AS [Name2]
+    FROM [Root_OptionalReferenceTrunk_CollectionBranch] AS [r27]
+    LEFT JOIN [Root_OptionalReferenceTrunk_CollectionBranch_OptionalReferenceLeaf] AS [r28] ON [r27].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r28].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r27].[Id1] = [r28].[RelationshipsBranchEntityId1]
+    LEFT JOIN [Root_OptionalReferenceTrunk_CollectionBranch_RequiredReferenceLeaf] AS [r29] ON [r27].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r29].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r27].[Id1] = [r29].[RelationshipsBranchEntityId1]
+    LEFT JOIN [Root_OptionalReferenceTrunk_CollectionBranch_CollectionLeaf] AS [r30] ON [r27].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r30].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r27].[Id1] = [r30].[RelationshipsBranchEntityId1]
+) AS [s1] ON [r0].[RelationshipsRootEntityId] = [s1].[RelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_OptionalReferenceTrunk_OptionalReferenceBranch_CollectionLeaf] AS [r31] ON [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r31].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_OptionalReferenceTrunk_RequiredReferenceBranch_CollectionLeaf] AS [r32] ON [r4].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r32].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN (
+    SELECT [r33].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r33].[Id1], [r33].[Name], [r34].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r34].[RelationshipsBranchEntityId1], [r35].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [r35].[RelationshipsBranchEntityId1] AS [RelationshipsBranchEntityId10], [r36].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [r36].[RelationshipsBranchEntityId1] AS [RelationshipsBranchEntityId11], [r36].[Id1] AS [Id10], [r36].[Name] AS [Name0], [r34].[Name] AS [Name1], [r35].[Name] AS [Name2]
+    FROM [Root_RequiredReferenceTrunk_CollectionBranch] AS [r33]
+    LEFT JOIN [Root_RequiredReferenceTrunk_CollectionBranch_OptionalReferenceLeaf] AS [r34] ON [r33].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r34].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r33].[Id1] = [r34].[RelationshipsBranchEntityId1]
+    LEFT JOIN [Root_RequiredReferenceTrunk_CollectionBranch_RequiredReferenceLeaf] AS [r35] ON [r33].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r35].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r33].[Id1] = [r35].[RelationshipsBranchEntityId1]
+    LEFT JOIN [Root_RequiredReferenceTrunk_CollectionBranch_CollectionLeaf] AS [r36] ON [r33].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r36].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r33].[Id1] = [r36].[RelationshipsBranchEntityId1]
+) AS [s2] ON [r7].[RelationshipsRootEntityId] = [s2].[RelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_RequiredReferenceTrunk_OptionalReferenceBranch_CollectionLeaf] AS [r37] ON [r8].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r37].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_RequiredReferenceTrunk_RequiredReferenceBranch_CollectionLeaf] AS [r38] ON [r11].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r38].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+ORDER BY [r].[Id], [r0].[RelationshipsRootEntityId], [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r3].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r4].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r5].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r6].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r7].[RelationshipsRootEntityId], [r8].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r9].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r10].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r11].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r12].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r13].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s0].[RelationshipsRootEntityId], [s0].[Id1], [s0].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s0].[RelationshipsTrunkEntityId1], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityId1], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityId10], [s0].[RelationshipsTrunkEntityRelationshipsRootEntityId0], [s0].[RelationshipsTrunkEntityId10], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityId11], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId2], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityId12], [s0].[RelationshipsTrunkEntityRelationshipsRootEntityId1], [s0].[RelationshipsTrunkEntityId11], [s0].[Id10], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId3], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityId13], [s0].[RelationshipsBranchEntityId1], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId00], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityId100], [s0].[RelationshipsBranchEntityId10], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId10], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityId110], [s0].[RelationshipsBranchEntityId11], [s0].[Id100], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId4], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityId14], [s0].[Id11], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId5], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityId15], [s0].[Id12], [s1].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s1].[Id1], [s1].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s1].[RelationshipsBranchEntityId1], [s1].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [s1].[RelationshipsBranchEntityId10], [s1].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [s1].[RelationshipsBranchEntityId11], [s1].[Id10], [r31].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r31].[Id1], [r32].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r32].[Id1], [s2].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s2].[Id1], [s2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s2].[RelationshipsBranchEntityId1], [s2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [s2].[RelationshipsBranchEntityId10], [s2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [s2].[RelationshipsBranchEntityId11], [s2].[Id10], [r37].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r37].[Id1], [r38].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+""");
+    }
+
+    public override async Task Select_trunk_optional(bool async)
+    {
+        await base.Select_trunk_optional(async);
+
+        AssertSql(
+            """
+SELECT [r0].[RelationshipsRootEntityId], [r0].[Name], [r].[Id], [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r3].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r4].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r5].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r6].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s].[Id1], [s].[Name], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s].[RelationshipsBranchEntityId1], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [s].[RelationshipsBranchEntityId10], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [s].[RelationshipsBranchEntityId11], [s].[Id10], [s].[Name0], [s].[Name1], [s].[Name2], [r1].[Name], [r11].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r11].[Id1], [r11].[Name], [r2].[Name], [r3].[Name], [r4].[Name], [r12].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r12].[Id1], [r12].[Name], [r5].[Name], [r6].[Name]
+FROM [RootEntities] AS [r]
+LEFT JOIN [Root_OptionalReferenceTrunk] AS [r0] ON [r].[Id] = [r0].[RelationshipsRootEntityId]
+LEFT JOIN [Root_OptionalReferenceTrunk_OptionalReferenceBranch] AS [r1] ON [r0].[RelationshipsRootEntityId] = [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_OptionalReferenceTrunk_OptionalReferenceBranch_OptionalReferenceLeaf] AS [r2] ON [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_OptionalReferenceTrunk_OptionalReferenceBranch_RequiredReferenceLeaf] AS [r3] ON [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r3].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_OptionalReferenceTrunk_RequiredReferenceBranch] AS [r4] ON [r0].[RelationshipsRootEntityId] = [r4].[RelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_OptionalReferenceTrunk_RequiredReferenceBranch_OptionalReferenceLeaf] AS [r5] ON [r4].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r5].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_OptionalReferenceTrunk_RequiredReferenceBranch_RequiredReferenceLeaf] AS [r6] ON [r4].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r6].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN (
+    SELECT [r7].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r7].[Id1], [r7].[Name], [r8].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r8].[RelationshipsBranchEntityId1], [r9].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [r9].[RelationshipsBranchEntityId1] AS [RelationshipsBranchEntityId10], [r10].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [r10].[RelationshipsBranchEntityId1] AS [RelationshipsBranchEntityId11], [r10].[Id1] AS [Id10], [r10].[Name] AS [Name0], [r8].[Name] AS [Name1], [r9].[Name] AS [Name2]
+    FROM [Root_OptionalReferenceTrunk_CollectionBranch] AS [r7]
+    LEFT JOIN [Root_OptionalReferenceTrunk_CollectionBranch_OptionalReferenceLeaf] AS [r8] ON [r7].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r8].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r7].[Id1] = [r8].[RelationshipsBranchEntityId1]
+    LEFT JOIN [Root_OptionalReferenceTrunk_CollectionBranch_RequiredReferenceLeaf] AS [r9] ON [r7].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r9].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r7].[Id1] = [r9].[RelationshipsBranchEntityId1]
+    LEFT JOIN [Root_OptionalReferenceTrunk_CollectionBranch_CollectionLeaf] AS [r10] ON [r7].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r10].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r7].[Id1] = [r10].[RelationshipsBranchEntityId1]
+) AS [s] ON [r0].[RelationshipsRootEntityId] = [s].[RelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_OptionalReferenceTrunk_OptionalReferenceBranch_CollectionLeaf] AS [r11] ON [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r11].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_OptionalReferenceTrunk_RequiredReferenceBranch_CollectionLeaf] AS [r12] ON [r4].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r12].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+ORDER BY [r].[Id], [r0].[RelationshipsRootEntityId], [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r3].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r4].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r5].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r6].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s].[Id1], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s].[RelationshipsBranchEntityId1], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [s].[RelationshipsBranchEntityId10], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [s].[RelationshipsBranchEntityId11], [s].[Id10], [r11].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r11].[Id1], [r12].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+""");
+    }
+
+    public override async Task Select_trunk_required(bool async)
+    {
+        await base.Select_trunk_required(async);
+
+        AssertSql(
+            """
+SELECT [r0].[RelationshipsRootEntityId], [r0].[Name], [r].[Id], [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r3].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r4].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r5].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r6].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s].[Id1], [s].[Name], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s].[RelationshipsBranchEntityId1], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [s].[RelationshipsBranchEntityId10], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [s].[RelationshipsBranchEntityId11], [s].[Id10], [s].[Name0], [s].[Name1], [s].[Name2], [r1].[Name], [r11].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r11].[Id1], [r11].[Name], [r2].[Name], [r3].[Name], [r4].[Name], [r12].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r12].[Id1], [r12].[Name], [r5].[Name], [r6].[Name]
+FROM [RootEntities] AS [r]
+LEFT JOIN [Root_RequiredReferenceTrunk] AS [r0] ON [r].[Id] = [r0].[RelationshipsRootEntityId]
+LEFT JOIN [Root_RequiredReferenceTrunk_OptionalReferenceBranch] AS [r1] ON [r0].[RelationshipsRootEntityId] = [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_RequiredReferenceTrunk_OptionalReferenceBranch_OptionalReferenceLeaf] AS [r2] ON [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_RequiredReferenceTrunk_OptionalReferenceBranch_RequiredReferenceLeaf] AS [r3] ON [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r3].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_RequiredReferenceTrunk_RequiredReferenceBranch] AS [r4] ON [r0].[RelationshipsRootEntityId] = [r4].[RelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_RequiredReferenceTrunk_RequiredReferenceBranch_OptionalReferenceLeaf] AS [r5] ON [r4].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r5].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_RequiredReferenceTrunk_RequiredReferenceBranch_RequiredReferenceLeaf] AS [r6] ON [r4].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r6].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN (
+    SELECT [r7].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r7].[Id1], [r7].[Name], [r8].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r8].[RelationshipsBranchEntityId1], [r9].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [r9].[RelationshipsBranchEntityId1] AS [RelationshipsBranchEntityId10], [r10].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [r10].[RelationshipsBranchEntityId1] AS [RelationshipsBranchEntityId11], [r10].[Id1] AS [Id10], [r10].[Name] AS [Name0], [r8].[Name] AS [Name1], [r9].[Name] AS [Name2]
+    FROM [Root_RequiredReferenceTrunk_CollectionBranch] AS [r7]
+    LEFT JOIN [Root_RequiredReferenceTrunk_CollectionBranch_OptionalReferenceLeaf] AS [r8] ON [r7].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r8].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r7].[Id1] = [r8].[RelationshipsBranchEntityId1]
+    LEFT JOIN [Root_RequiredReferenceTrunk_CollectionBranch_RequiredReferenceLeaf] AS [r9] ON [r7].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r9].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r7].[Id1] = [r9].[RelationshipsBranchEntityId1]
+    LEFT JOIN [Root_RequiredReferenceTrunk_CollectionBranch_CollectionLeaf] AS [r10] ON [r7].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r10].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r7].[Id1] = [r10].[RelationshipsBranchEntityId1]
+) AS [s] ON [r0].[RelationshipsRootEntityId] = [s].[RelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_RequiredReferenceTrunk_OptionalReferenceBranch_CollectionLeaf] AS [r11] ON [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r11].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_RequiredReferenceTrunk_RequiredReferenceBranch_CollectionLeaf] AS [r12] ON [r4].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r12].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+ORDER BY [r].[Id], [r0].[RelationshipsRootEntityId], [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r3].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r4].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r5].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r6].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s].[Id1], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s].[RelationshipsBranchEntityId1], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [s].[RelationshipsBranchEntityId10], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [s].[RelationshipsBranchEntityId11], [s].[Id10], [r11].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r11].[Id1], [r12].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+""");
+    }
+
+    public override async Task Select_branch_required_required(bool async)
+    {
+        await base.Select_branch_required_required(async);
+
+        AssertSql(
+            """
+SELECT [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r1].[Name], [r].[Id], [r0].[RelationshipsRootEntityId], [r2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r3].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r4].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r4].[Id1], [r4].[Name], [r2].[Name], [r3].[Name]
+FROM [RootEntities] AS [r]
+LEFT JOIN [Root_RequiredReferenceTrunk] AS [r0] ON [r].[Id] = [r0].[RelationshipsRootEntityId]
+LEFT JOIN [Root_RequiredReferenceTrunk_RequiredReferenceBranch] AS [r1] ON [r0].[RelationshipsRootEntityId] = [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_RequiredReferenceTrunk_RequiredReferenceBranch_OptionalReferenceLeaf] AS [r2] ON [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_RequiredReferenceTrunk_RequiredReferenceBranch_RequiredReferenceLeaf] AS [r3] ON [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r3].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_RequiredReferenceTrunk_RequiredReferenceBranch_CollectionLeaf] AS [r4] ON [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r4].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+ORDER BY [r].[Id], [r0].[RelationshipsRootEntityId], [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r3].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r4].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+""");
+    }
+
+    public override async Task Select_branch_required_optional(bool async)
+    {
+        await base.Select_branch_required_optional(async);
+
+        AssertSql(
+            """
+SELECT [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r1].[Name], [r].[Id], [r0].[RelationshipsRootEntityId], [r2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r3].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r4].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r4].[Id1], [r4].[Name], [r2].[Name], [r3].[Name]
+FROM [RootEntities] AS [r]
+LEFT JOIN [Root_RequiredReferenceTrunk] AS [r0] ON [r].[Id] = [r0].[RelationshipsRootEntityId]
+LEFT JOIN [Root_RequiredReferenceTrunk_OptionalReferenceBranch] AS [r1] ON [r0].[RelationshipsRootEntityId] = [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_RequiredReferenceTrunk_OptionalReferenceBranch_OptionalReferenceLeaf] AS [r2] ON [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_RequiredReferenceTrunk_OptionalReferenceBranch_RequiredReferenceLeaf] AS [r3] ON [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r3].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_RequiredReferenceTrunk_OptionalReferenceBranch_CollectionLeaf] AS [r4] ON [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r4].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+ORDER BY [r].[Id], [r0].[RelationshipsRootEntityId], [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r3].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r4].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+""");
+    }
+
+    public override async Task Select_branch_optional_required(bool async)
+    {
+        await base.Select_branch_optional_required(async);
+
+        AssertSql(
+            """
+SELECT [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r1].[Name], [r].[Id], [r0].[RelationshipsRootEntityId], [r2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r3].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r4].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r4].[Id1], [r4].[Name], [r2].[Name], [r3].[Name]
+FROM [RootEntities] AS [r]
+LEFT JOIN [Root_RequiredReferenceTrunk] AS [r0] ON [r].[Id] = [r0].[RelationshipsRootEntityId]
+LEFT JOIN [Root_RequiredReferenceTrunk_RequiredReferenceBranch] AS [r1] ON [r0].[RelationshipsRootEntityId] = [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_RequiredReferenceTrunk_RequiredReferenceBranch_OptionalReferenceLeaf] AS [r2] ON [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_RequiredReferenceTrunk_RequiredReferenceBranch_RequiredReferenceLeaf] AS [r3] ON [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r3].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_RequiredReferenceTrunk_RequiredReferenceBranch_CollectionLeaf] AS [r4] ON [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r4].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+ORDER BY [r].[Id], [r0].[RelationshipsRootEntityId], [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r3].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r4].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+""");
+    }
+
+    public override async Task Select_branch_optional_optional(bool async)
+    {
+        await base.Select_branch_optional_optional(async);
+
+        AssertSql(
+            """
+SELECT [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r1].[Name], [r].[Id], [r0].[RelationshipsRootEntityId], [r2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r3].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r4].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r4].[Id1], [r4].[Name], [r2].[Name], [r3].[Name]
+FROM [RootEntities] AS [r]
+LEFT JOIN [Root_RequiredReferenceTrunk] AS [r0] ON [r].[Id] = [r0].[RelationshipsRootEntityId]
+LEFT JOIN [Root_RequiredReferenceTrunk_OptionalReferenceBranch] AS [r1] ON [r0].[RelationshipsRootEntityId] = [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_RequiredReferenceTrunk_OptionalReferenceBranch_OptionalReferenceLeaf] AS [r2] ON [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_RequiredReferenceTrunk_OptionalReferenceBranch_RequiredReferenceLeaf] AS [r3] ON [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r3].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_RequiredReferenceTrunk_OptionalReferenceBranch_CollectionLeaf] AS [r4] ON [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r4].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+ORDER BY [r].[Id], [r0].[RelationshipsRootEntityId], [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r3].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r4].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+""");
+    }
+
+    public override async Task Select_root_duplicated(bool async)
+    {
+        await base.Select_root_duplicated(async);
+
+        AssertSql(
+            """
+SELECT [r].[Id], [r].[Name], [r].[OptionalReferenceTrunkId], [r].[RequiredReferenceTrunkId], [r0].[RelationshipsRootEntityId], [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r3].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r4].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r5].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r6].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r7].[RelationshipsRootEntityId], [r8].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r9].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r10].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r11].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r12].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r13].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s0].[RelationshipsRootEntityId], [s0].[Id1], [s0].[Name], [s0].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s0].[RelationshipsTrunkEntityId1], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityId1], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityId10], [s0].[RelationshipsTrunkEntityRelationshipsRootEntityId0], [s0].[RelationshipsTrunkEntityId10], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityId11], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId2], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityId12], [s0].[RelationshipsTrunkEntityRelationshipsRootEntityId1], [s0].[RelationshipsTrunkEntityId11], [s0].[Id10], [s0].[Name0], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId3], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityId13], [s0].[RelationshipsBranchEntityId1], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId00], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityId100], [s0].[RelationshipsBranchEntityId10], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId10], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityId110], [s0].[RelationshipsBranchEntityId11], [s0].[Id100], [s0].[Name00], [s0].[Name1], [s0].[Name2], [s0].[Name3], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId4], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityId14], [s0].[Id11], [s0].[Name4], [s0].[Name5], [s0].[Name6], [s0].[Name7], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId5], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityId15], [s0].[Id12], [s0].[Name8], [s0].[Name9], [s0].[Name10], [r0].[Name], [s1].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s1].[Id1], [s1].[Name], [s1].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s1].[RelationshipsBranchEntityId1], [s1].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [s1].[RelationshipsBranchEntityId10], [s1].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [s1].[RelationshipsBranchEntityId11], [s1].[Id10], [s1].[Name0], [s1].[Name1], [s1].[Name2], [r1].[Name], [r31].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r31].[Id1], [r31].[Name], [r2].[Name], [r3].[Name], [r4].[Name], [r32].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r32].[Id1], [r32].[Name], [r5].[Name], [r6].[Name], [r7].[Name], [s2].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s2].[Id1], [s2].[Name], [s2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s2].[RelationshipsBranchEntityId1], [s2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [s2].[RelationshipsBranchEntityId10], [s2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [s2].[RelationshipsBranchEntityId11], [s2].[Id10], [s2].[Name0], [s2].[Name1], [s2].[Name2], [r8].[Name], [r37].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r37].[Id1], [r37].[Name], [r9].[Name], [r10].[Name], [r11].[Name], [r38].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r38].[Id1], [r38].[Name], [r12].[Name], [r13].[Name], [s4].[RelationshipsRootEntityId], [s4].[Id1], [s4].[Name], [s4].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s4].[RelationshipsTrunkEntityId1], [s4].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s4].[RelationshipsBranchEntityRelationshipsTrunkEntityId1], [s4].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [s4].[RelationshipsBranchEntityRelationshipsTrunkEntityId10], [s4].[RelationshipsTrunkEntityRelationshipsRootEntityId0], [s4].[RelationshipsTrunkEntityId10], [s4].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [s4].[RelationshipsBranchEntityRelationshipsTrunkEntityId11], [s4].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId2], [s4].[RelationshipsBranchEntityRelationshipsTrunkEntityId12], [s4].[RelationshipsTrunkEntityRelationshipsRootEntityId1], [s4].[RelationshipsTrunkEntityId11], [s4].[Id10], [s4].[Name0], [s4].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId3], [s4].[RelationshipsBranchEntityRelationshipsTrunkEntityId13], [s4].[RelationshipsBranchEntityId1], [s4].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId00], [s4].[RelationshipsBranchEntityRelationshipsTrunkEntityId100], [s4].[RelationshipsBranchEntityId10], [s4].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId10], [s4].[RelationshipsBranchEntityRelationshipsTrunkEntityId110], [s4].[RelationshipsBranchEntityId11], [s4].[Id100], [s4].[Name00], [s4].[Name1], [s4].[Name2], [s4].[Name3], [s4].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId4], [s4].[RelationshipsBranchEntityRelationshipsTrunkEntityId14], [s4].[Id11], [s4].[Name4], [s4].[Name5], [s4].[Name6], [s4].[Name7], [s4].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId5], [s4].[RelationshipsBranchEntityRelationshipsTrunkEntityId15], [s4].[Id12], [s4].[Name8], [s4].[Name9], [s4].[Name10], [s5].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s5].[Id1], [s5].[Name], [s5].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s5].[RelationshipsBranchEntityId1], [s5].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [s5].[RelationshipsBranchEntityId10], [s5].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [s5].[RelationshipsBranchEntityId11], [s5].[Id10], [s5].[Name0], [s5].[Name1], [s5].[Name2], [r56].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r56].[Id1], [r56].[Name], [r57].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r57].[Id1], [r57].[Name], [s6].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s6].[Id1], [s6].[Name], [s6].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s6].[RelationshipsBranchEntityId1], [s6].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [s6].[RelationshipsBranchEntityId10], [s6].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [s6].[RelationshipsBranchEntityId11], [s6].[Id10], [s6].[Name0], [s6].[Name1], [s6].[Name2], [r62].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r62].[Id1], [r62].[Name], [r63].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r63].[Id1], [r63].[Name]
+FROM [RootEntities] AS [r]
+LEFT JOIN [Root_OptionalReferenceTrunk] AS [r0] ON [r].[Id] = [r0].[RelationshipsRootEntityId]
+LEFT JOIN [Root_OptionalReferenceTrunk_OptionalReferenceBranch] AS [r1] ON [r0].[RelationshipsRootEntityId] = [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_OptionalReferenceTrunk_OptionalReferenceBranch_OptionalReferenceLeaf] AS [r2] ON [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_OptionalReferenceTrunk_OptionalReferenceBranch_RequiredReferenceLeaf] AS [r3] ON [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r3].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_OptionalReferenceTrunk_RequiredReferenceBranch] AS [r4] ON [r0].[RelationshipsRootEntityId] = [r4].[RelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_OptionalReferenceTrunk_RequiredReferenceBranch_OptionalReferenceLeaf] AS [r5] ON [r4].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r5].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_OptionalReferenceTrunk_RequiredReferenceBranch_RequiredReferenceLeaf] AS [r6] ON [r4].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r6].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_RequiredReferenceTrunk] AS [r7] ON [r].[Id] = [r7].[RelationshipsRootEntityId]
+LEFT JOIN [Root_RequiredReferenceTrunk_OptionalReferenceBranch] AS [r8] ON [r7].[RelationshipsRootEntityId] = [r8].[RelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_RequiredReferenceTrunk_OptionalReferenceBranch_OptionalReferenceLeaf] AS [r9] ON [r8].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r9].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_RequiredReferenceTrunk_OptionalReferenceBranch_RequiredReferenceLeaf] AS [r10] ON [r8].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r10].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_RequiredReferenceTrunk_RequiredReferenceBranch] AS [r11] ON [r7].[RelationshipsRootEntityId] = [r11].[RelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_RequiredReferenceTrunk_RequiredReferenceBranch_OptionalReferenceLeaf] AS [r12] ON [r11].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r12].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_RequiredReferenceTrunk_RequiredReferenceBranch_RequiredReferenceLeaf] AS [r13] ON [r11].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r13].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN (
+    SELECT [r14].[RelationshipsRootEntityId], [r14].[Id1], [r14].[Name], [r15].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r15].[RelationshipsTrunkEntityId1], [r16].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r16].[RelationshipsBranchEntityRelationshipsTrunkEntityId1], [r17].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [r17].[RelationshipsBranchEntityRelationshipsTrunkEntityId1] AS [RelationshipsBranchEntityRelationshipsTrunkEntityId10], [r18].[RelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsTrunkEntityRelationshipsRootEntityId0], [r18].[RelationshipsTrunkEntityId1] AS [RelationshipsTrunkEntityId10], [r19].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [r19].[RelationshipsBranchEntityRelationshipsTrunkEntityId1] AS [RelationshipsBranchEntityRelationshipsTrunkEntityId11], [r20].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId2], [r20].[RelationshipsBranchEntityRelationshipsTrunkEntityId1] AS [RelationshipsBranchEntityRelationshipsTrunkEntityId12], [s].[RelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsTrunkEntityRelationshipsRootEntityId1], [s].[RelationshipsTrunkEntityId1] AS [RelationshipsTrunkEntityId11], [s].[Id1] AS [Id10], [s].[Name] AS [Name0], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId3], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityId1] AS [RelationshipsBranchEntityRelationshipsTrunkEntityId13], [s].[RelationshipsBranchEntityId1], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId00], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityId10] AS [RelationshipsBranchEntityRelationshipsTrunkEntityId100], [s].[RelationshipsBranchEntityId10], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId10], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityId11] AS [RelationshipsBranchEntityRelationshipsTrunkEntityId110], [s].[RelationshipsBranchEntityId11], [s].[Id10] AS [Id100], [s].[Name0] AS [Name00], [s].[Name1], [s].[Name2], [r15].[Name] AS [Name3], [r25].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId4], [r25].[RelationshipsBranchEntityRelationshipsTrunkEntityId1] AS [RelationshipsBranchEntityRelationshipsTrunkEntityId14], [r25].[Id1] AS [Id11], [r25].[Name] AS [Name4], [r16].[Name] AS [Name5], [r17].[Name] AS [Name6], [r18].[Name] AS [Name7], [r26].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId5], [r26].[RelationshipsBranchEntityRelationshipsTrunkEntityId1] AS [RelationshipsBranchEntityRelationshipsTrunkEntityId15], [r26].[Id1] AS [Id12], [r26].[Name] AS [Name8], [r19].[Name] AS [Name9], [r20].[Name] AS [Name10]
+    FROM [Root_CollectionTrunk] AS [r14]
+    LEFT JOIN [Root_CollectionTrunk_OptionalReferenceBranch] AS [r15] ON [r14].[RelationshipsRootEntityId] = [r15].[RelationshipsTrunkEntityRelationshipsRootEntityId] AND [r14].[Id1] = [r15].[RelationshipsTrunkEntityId1]
+    LEFT JOIN [Root_CollectionTrunk_OptionalReferenceBranch_OptionalReferenceLeaf] AS [r16] ON [r15].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r16].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r15].[RelationshipsTrunkEntityId1] = [r16].[RelationshipsBranchEntityRelationshipsTrunkEntityId1]
+    LEFT JOIN [Root_CollectionTrunk_OptionalReferenceBranch_RequiredReferenceLeaf] AS [r17] ON [r15].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r17].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r15].[RelationshipsTrunkEntityId1] = [r17].[RelationshipsBranchEntityRelationshipsTrunkEntityId1]
+    LEFT JOIN [Root_CollectionTrunk_RequiredReferenceBranch] AS [r18] ON [r14].[RelationshipsRootEntityId] = [r18].[RelationshipsTrunkEntityRelationshipsRootEntityId] AND [r14].[Id1] = [r18].[RelationshipsTrunkEntityId1]
+    LEFT JOIN [Root_CollectionTrunk_RequiredReferenceBranch_OptionalReferenceLeaf] AS [r19] ON [r18].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r19].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r18].[RelationshipsTrunkEntityId1] = [r19].[RelationshipsBranchEntityRelationshipsTrunkEntityId1]
+    LEFT JOIN [Root_CollectionTrunk_RequiredReferenceBranch_RequiredReferenceLeaf] AS [r20] ON [r18].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r20].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r18].[RelationshipsTrunkEntityId1] = [r20].[RelationshipsBranchEntityRelationshipsTrunkEntityId1]
+    LEFT JOIN (
+        SELECT [r21].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r21].[RelationshipsTrunkEntityId1], [r21].[Id1], [r21].[Name], [r22].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r22].[RelationshipsBranchEntityRelationshipsTrunkEntityId1], [r22].[RelationshipsBranchEntityId1], [r23].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [r23].[RelationshipsBranchEntityRelationshipsTrunkEntityId1] AS [RelationshipsBranchEntityRelationshipsTrunkEntityId10], [r23].[RelationshipsBranchEntityId1] AS [RelationshipsBranchEntityId10], [r24].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [r24].[RelationshipsBranchEntityRelationshipsTrunkEntityId1] AS [RelationshipsBranchEntityRelationshipsTrunkEntityId11], [r24].[RelationshipsBranchEntityId1] AS [RelationshipsBranchEntityId11], [r24].[Id1] AS [Id10], [r24].[Name] AS [Name0], [r22].[Name] AS [Name1], [r23].[Name] AS [Name2]
+        FROM [Root_CollectionTrunk_CollectionBranch] AS [r21]
+        LEFT JOIN [Root_CollectionTrunk_CollectionBranch_OptionalReferenceLeaf] AS [r22] ON [r21].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r22].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r21].[RelationshipsTrunkEntityId1] = [r22].[RelationshipsBranchEntityRelationshipsTrunkEntityId1] AND [r21].[Id1] = [r22].[RelationshipsBranchEntityId1]
+        LEFT JOIN [Root_CollectionTrunk_CollectionBranch_RequiredReferenceLeaf] AS [r23] ON [r21].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r23].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r21].[RelationshipsTrunkEntityId1] = [r23].[RelationshipsBranchEntityRelationshipsTrunkEntityId1] AND [r21].[Id1] = [r23].[RelationshipsBranchEntityId1]
+        LEFT JOIN [Root_CollectionTrunk_CollectionBranch_CollectionLeaf] AS [r24] ON [r21].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r24].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r21].[RelationshipsTrunkEntityId1] = [r24].[RelationshipsBranchEntityRelationshipsTrunkEntityId1] AND [r21].[Id1] = [r24].[RelationshipsBranchEntityId1]
+    ) AS [s] ON [r14].[RelationshipsRootEntityId] = [s].[RelationshipsTrunkEntityRelationshipsRootEntityId] AND [r14].[Id1] = [s].[RelationshipsTrunkEntityId1]
+    LEFT JOIN [Root_CollectionTrunk_OptionalReferenceBranch_CollectionLeaf] AS [r25] ON [r15].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r25].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r15].[RelationshipsTrunkEntityId1] = [r25].[RelationshipsBranchEntityRelationshipsTrunkEntityId1]
+    LEFT JOIN [Root_CollectionTrunk_RequiredReferenceBranch_CollectionLeaf] AS [r26] ON [r18].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r26].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r18].[RelationshipsTrunkEntityId1] = [r26].[RelationshipsBranchEntityRelationshipsTrunkEntityId1]
+) AS [s0] ON [r].[Id] = [s0].[RelationshipsRootEntityId]
+LEFT JOIN (
+    SELECT [r27].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r27].[Id1], [r27].[Name], [r28].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r28].[RelationshipsBranchEntityId1], [r29].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [r29].[RelationshipsBranchEntityId1] AS [RelationshipsBranchEntityId10], [r30].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [r30].[RelationshipsBranchEntityId1] AS [RelationshipsBranchEntityId11], [r30].[Id1] AS [Id10], [r30].[Name] AS [Name0], [r28].[Name] AS [Name1], [r29].[Name] AS [Name2]
+    FROM [Root_OptionalReferenceTrunk_CollectionBranch] AS [r27]
+    LEFT JOIN [Root_OptionalReferenceTrunk_CollectionBranch_OptionalReferenceLeaf] AS [r28] ON [r27].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r28].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r27].[Id1] = [r28].[RelationshipsBranchEntityId1]
+    LEFT JOIN [Root_OptionalReferenceTrunk_CollectionBranch_RequiredReferenceLeaf] AS [r29] ON [r27].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r29].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r27].[Id1] = [r29].[RelationshipsBranchEntityId1]
+    LEFT JOIN [Root_OptionalReferenceTrunk_CollectionBranch_CollectionLeaf] AS [r30] ON [r27].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r30].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r27].[Id1] = [r30].[RelationshipsBranchEntityId1]
+) AS [s1] ON [r0].[RelationshipsRootEntityId] = [s1].[RelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_OptionalReferenceTrunk_OptionalReferenceBranch_CollectionLeaf] AS [r31] ON [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r31].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_OptionalReferenceTrunk_RequiredReferenceBranch_CollectionLeaf] AS [r32] ON [r4].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r32].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN (
+    SELECT [r33].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r33].[Id1], [r33].[Name], [r34].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r34].[RelationshipsBranchEntityId1], [r35].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [r35].[RelationshipsBranchEntityId1] AS [RelationshipsBranchEntityId10], [r36].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [r36].[RelationshipsBranchEntityId1] AS [RelationshipsBranchEntityId11], [r36].[Id1] AS [Id10], [r36].[Name] AS [Name0], [r34].[Name] AS [Name1], [r35].[Name] AS [Name2]
+    FROM [Root_RequiredReferenceTrunk_CollectionBranch] AS [r33]
+    LEFT JOIN [Root_RequiredReferenceTrunk_CollectionBranch_OptionalReferenceLeaf] AS [r34] ON [r33].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r34].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r33].[Id1] = [r34].[RelationshipsBranchEntityId1]
+    LEFT JOIN [Root_RequiredReferenceTrunk_CollectionBranch_RequiredReferenceLeaf] AS [r35] ON [r33].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r35].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r33].[Id1] = [r35].[RelationshipsBranchEntityId1]
+    LEFT JOIN [Root_RequiredReferenceTrunk_CollectionBranch_CollectionLeaf] AS [r36] ON [r33].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r36].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r33].[Id1] = [r36].[RelationshipsBranchEntityId1]
+) AS [s2] ON [r7].[RelationshipsRootEntityId] = [s2].[RelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_RequiredReferenceTrunk_OptionalReferenceBranch_CollectionLeaf] AS [r37] ON [r8].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r37].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_RequiredReferenceTrunk_RequiredReferenceBranch_CollectionLeaf] AS [r38] ON [r11].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r38].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN (
+    SELECT [r39].[RelationshipsRootEntityId], [r39].[Id1], [r39].[Name], [r40].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r40].[RelationshipsTrunkEntityId1], [r41].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r41].[RelationshipsBranchEntityRelationshipsTrunkEntityId1], [r42].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [r42].[RelationshipsBranchEntityRelationshipsTrunkEntityId1] AS [RelationshipsBranchEntityRelationshipsTrunkEntityId10], [r43].[RelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsTrunkEntityRelationshipsRootEntityId0], [r43].[RelationshipsTrunkEntityId1] AS [RelationshipsTrunkEntityId10], [r44].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [r44].[RelationshipsBranchEntityRelationshipsTrunkEntityId1] AS [RelationshipsBranchEntityRelationshipsTrunkEntityId11], [r45].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId2], [r45].[RelationshipsBranchEntityRelationshipsTrunkEntityId1] AS [RelationshipsBranchEntityRelationshipsTrunkEntityId12], [s3].[RelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsTrunkEntityRelationshipsRootEntityId1], [s3].[RelationshipsTrunkEntityId1] AS [RelationshipsTrunkEntityId11], [s3].[Id1] AS [Id10], [s3].[Name] AS [Name0], [s3].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId3], [s3].[RelationshipsBranchEntityRelationshipsTrunkEntityId1] AS [RelationshipsBranchEntityRelationshipsTrunkEntityId13], [s3].[RelationshipsBranchEntityId1], [s3].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId00], [s3].[RelationshipsBranchEntityRelationshipsTrunkEntityId10] AS [RelationshipsBranchEntityRelationshipsTrunkEntityId100], [s3].[RelationshipsBranchEntityId10], [s3].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId10], [s3].[RelationshipsBranchEntityRelationshipsTrunkEntityId11] AS [RelationshipsBranchEntityRelationshipsTrunkEntityId110], [s3].[RelationshipsBranchEntityId11], [s3].[Id10] AS [Id100], [s3].[Name0] AS [Name00], [s3].[Name1], [s3].[Name2], [r40].[Name] AS [Name3], [r50].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId4], [r50].[RelationshipsBranchEntityRelationshipsTrunkEntityId1] AS [RelationshipsBranchEntityRelationshipsTrunkEntityId14], [r50].[Id1] AS [Id11], [r50].[Name] AS [Name4], [r41].[Name] AS [Name5], [r42].[Name] AS [Name6], [r43].[Name] AS [Name7], [r51].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId5], [r51].[RelationshipsBranchEntityRelationshipsTrunkEntityId1] AS [RelationshipsBranchEntityRelationshipsTrunkEntityId15], [r51].[Id1] AS [Id12], [r51].[Name] AS [Name8], [r44].[Name] AS [Name9], [r45].[Name] AS [Name10]
+    FROM [Root_CollectionTrunk] AS [r39]
+    LEFT JOIN [Root_CollectionTrunk_OptionalReferenceBranch] AS [r40] ON [r39].[RelationshipsRootEntityId] = [r40].[RelationshipsTrunkEntityRelationshipsRootEntityId] AND [r39].[Id1] = [r40].[RelationshipsTrunkEntityId1]
+    LEFT JOIN [Root_CollectionTrunk_OptionalReferenceBranch_OptionalReferenceLeaf] AS [r41] ON [r40].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r41].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r40].[RelationshipsTrunkEntityId1] = [r41].[RelationshipsBranchEntityRelationshipsTrunkEntityId1]
+    LEFT JOIN [Root_CollectionTrunk_OptionalReferenceBranch_RequiredReferenceLeaf] AS [r42] ON [r40].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r42].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r40].[RelationshipsTrunkEntityId1] = [r42].[RelationshipsBranchEntityRelationshipsTrunkEntityId1]
+    LEFT JOIN [Root_CollectionTrunk_RequiredReferenceBranch] AS [r43] ON [r39].[RelationshipsRootEntityId] = [r43].[RelationshipsTrunkEntityRelationshipsRootEntityId] AND [r39].[Id1] = [r43].[RelationshipsTrunkEntityId1]
+    LEFT JOIN [Root_CollectionTrunk_RequiredReferenceBranch_OptionalReferenceLeaf] AS [r44] ON [r43].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r44].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r43].[RelationshipsTrunkEntityId1] = [r44].[RelationshipsBranchEntityRelationshipsTrunkEntityId1]
+    LEFT JOIN [Root_CollectionTrunk_RequiredReferenceBranch_RequiredReferenceLeaf] AS [r45] ON [r43].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r45].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r43].[RelationshipsTrunkEntityId1] = [r45].[RelationshipsBranchEntityRelationshipsTrunkEntityId1]
+    LEFT JOIN (
+        SELECT [r46].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r46].[RelationshipsTrunkEntityId1], [r46].[Id1], [r46].[Name], [r47].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r47].[RelationshipsBranchEntityRelationshipsTrunkEntityId1], [r47].[RelationshipsBranchEntityId1], [r48].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [r48].[RelationshipsBranchEntityRelationshipsTrunkEntityId1] AS [RelationshipsBranchEntityRelationshipsTrunkEntityId10], [r48].[RelationshipsBranchEntityId1] AS [RelationshipsBranchEntityId10], [r49].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [r49].[RelationshipsBranchEntityRelationshipsTrunkEntityId1] AS [RelationshipsBranchEntityRelationshipsTrunkEntityId11], [r49].[RelationshipsBranchEntityId1] AS [RelationshipsBranchEntityId11], [r49].[Id1] AS [Id10], [r49].[Name] AS [Name0], [r47].[Name] AS [Name1], [r48].[Name] AS [Name2]
+        FROM [Root_CollectionTrunk_CollectionBranch] AS [r46]
+        LEFT JOIN [Root_CollectionTrunk_CollectionBranch_OptionalReferenceLeaf] AS [r47] ON [r46].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r47].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r46].[RelationshipsTrunkEntityId1] = [r47].[RelationshipsBranchEntityRelationshipsTrunkEntityId1] AND [r46].[Id1] = [r47].[RelationshipsBranchEntityId1]
+        LEFT JOIN [Root_CollectionTrunk_CollectionBranch_RequiredReferenceLeaf] AS [r48] ON [r46].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r48].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r46].[RelationshipsTrunkEntityId1] = [r48].[RelationshipsBranchEntityRelationshipsTrunkEntityId1] AND [r46].[Id1] = [r48].[RelationshipsBranchEntityId1]
+        LEFT JOIN [Root_CollectionTrunk_CollectionBranch_CollectionLeaf] AS [r49] ON [r46].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r49].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r46].[RelationshipsTrunkEntityId1] = [r49].[RelationshipsBranchEntityRelationshipsTrunkEntityId1] AND [r46].[Id1] = [r49].[RelationshipsBranchEntityId1]
+    ) AS [s3] ON [r39].[RelationshipsRootEntityId] = [s3].[RelationshipsTrunkEntityRelationshipsRootEntityId] AND [r39].[Id1] = [s3].[RelationshipsTrunkEntityId1]
+    LEFT JOIN [Root_CollectionTrunk_OptionalReferenceBranch_CollectionLeaf] AS [r50] ON [r40].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r50].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r40].[RelationshipsTrunkEntityId1] = [r50].[RelationshipsBranchEntityRelationshipsTrunkEntityId1]
+    LEFT JOIN [Root_CollectionTrunk_RequiredReferenceBranch_CollectionLeaf] AS [r51] ON [r43].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r51].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r43].[RelationshipsTrunkEntityId1] = [r51].[RelationshipsBranchEntityRelationshipsTrunkEntityId1]
+) AS [s4] ON [r].[Id] = [s4].[RelationshipsRootEntityId]
+LEFT JOIN (
+    SELECT [r52].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r52].[Id1], [r52].[Name], [r53].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r53].[RelationshipsBranchEntityId1], [r54].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [r54].[RelationshipsBranchEntityId1] AS [RelationshipsBranchEntityId10], [r55].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [r55].[RelationshipsBranchEntityId1] AS [RelationshipsBranchEntityId11], [r55].[Id1] AS [Id10], [r55].[Name] AS [Name0], [r53].[Name] AS [Name1], [r54].[Name] AS [Name2]
+    FROM [Root_OptionalReferenceTrunk_CollectionBranch] AS [r52]
+    LEFT JOIN [Root_OptionalReferenceTrunk_CollectionBranch_OptionalReferenceLeaf] AS [r53] ON [r52].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r53].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r52].[Id1] = [r53].[RelationshipsBranchEntityId1]
+    LEFT JOIN [Root_OptionalReferenceTrunk_CollectionBranch_RequiredReferenceLeaf] AS [r54] ON [r52].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r54].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r52].[Id1] = [r54].[RelationshipsBranchEntityId1]
+    LEFT JOIN [Root_OptionalReferenceTrunk_CollectionBranch_CollectionLeaf] AS [r55] ON [r52].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r55].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r52].[Id1] = [r55].[RelationshipsBranchEntityId1]
+) AS [s5] ON [r0].[RelationshipsRootEntityId] = [s5].[RelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_OptionalReferenceTrunk_OptionalReferenceBranch_CollectionLeaf] AS [r56] ON [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r56].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_OptionalReferenceTrunk_RequiredReferenceBranch_CollectionLeaf] AS [r57] ON [r4].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r57].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN (
+    SELECT [r58].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r58].[Id1], [r58].[Name], [r59].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r59].[RelationshipsBranchEntityId1], [r60].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [r60].[RelationshipsBranchEntityId1] AS [RelationshipsBranchEntityId10], [r61].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [r61].[RelationshipsBranchEntityId1] AS [RelationshipsBranchEntityId11], [r61].[Id1] AS [Id10], [r61].[Name] AS [Name0], [r59].[Name] AS [Name1], [r60].[Name] AS [Name2]
+    FROM [Root_RequiredReferenceTrunk_CollectionBranch] AS [r58]
+    LEFT JOIN [Root_RequiredReferenceTrunk_CollectionBranch_OptionalReferenceLeaf] AS [r59] ON [r58].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r59].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r58].[Id1] = [r59].[RelationshipsBranchEntityId1]
+    LEFT JOIN [Root_RequiredReferenceTrunk_CollectionBranch_RequiredReferenceLeaf] AS [r60] ON [r58].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r60].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r58].[Id1] = [r60].[RelationshipsBranchEntityId1]
+    LEFT JOIN [Root_RequiredReferenceTrunk_CollectionBranch_CollectionLeaf] AS [r61] ON [r58].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r61].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r58].[Id1] = [r61].[RelationshipsBranchEntityId1]
+) AS [s6] ON [r7].[RelationshipsRootEntityId] = [s6].[RelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_RequiredReferenceTrunk_OptionalReferenceBranch_CollectionLeaf] AS [r62] ON [r8].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r62].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_RequiredReferenceTrunk_RequiredReferenceBranch_CollectionLeaf] AS [r63] ON [r11].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r63].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+ORDER BY [r].[Id], [r0].[RelationshipsRootEntityId], [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r3].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r4].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r5].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r6].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r7].[RelationshipsRootEntityId], [r8].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r9].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r10].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r11].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r12].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r13].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s0].[RelationshipsRootEntityId], [s0].[Id1], [s0].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s0].[RelationshipsTrunkEntityId1], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityId1], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityId10], [s0].[RelationshipsTrunkEntityRelationshipsRootEntityId0], [s0].[RelationshipsTrunkEntityId10], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityId11], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId2], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityId12], [s0].[RelationshipsTrunkEntityRelationshipsRootEntityId1], [s0].[RelationshipsTrunkEntityId11], [s0].[Id10], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId3], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityId13], [s0].[RelationshipsBranchEntityId1], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId00], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityId100], [s0].[RelationshipsBranchEntityId10], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId10], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityId110], [s0].[RelationshipsBranchEntityId11], [s0].[Id100], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId4], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityId14], [s0].[Id11], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId5], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityId15], [s0].[Id12], [s1].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s1].[Id1], [s1].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s1].[RelationshipsBranchEntityId1], [s1].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [s1].[RelationshipsBranchEntityId10], [s1].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [s1].[RelationshipsBranchEntityId11], [s1].[Id10], [r31].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r31].[Id1], [r32].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r32].[Id1], [s2].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s2].[Id1], [s2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s2].[RelationshipsBranchEntityId1], [s2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [s2].[RelationshipsBranchEntityId10], [s2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [s2].[RelationshipsBranchEntityId11], [s2].[Id10], [r37].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r37].[Id1], [r38].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r38].[Id1], [s4].[RelationshipsRootEntityId], [s4].[Id1], [s4].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s4].[RelationshipsTrunkEntityId1], [s4].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s4].[RelationshipsBranchEntityRelationshipsTrunkEntityId1], [s4].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [s4].[RelationshipsBranchEntityRelationshipsTrunkEntityId10], [s4].[RelationshipsTrunkEntityRelationshipsRootEntityId0], [s4].[RelationshipsTrunkEntityId10], [s4].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [s4].[RelationshipsBranchEntityRelationshipsTrunkEntityId11], [s4].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId2], [s4].[RelationshipsBranchEntityRelationshipsTrunkEntityId12], [s4].[RelationshipsTrunkEntityRelationshipsRootEntityId1], [s4].[RelationshipsTrunkEntityId11], [s4].[Id10], [s4].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId3], [s4].[RelationshipsBranchEntityRelationshipsTrunkEntityId13], [s4].[RelationshipsBranchEntityId1], [s4].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId00], [s4].[RelationshipsBranchEntityRelationshipsTrunkEntityId100], [s4].[RelationshipsBranchEntityId10], [s4].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId10], [s4].[RelationshipsBranchEntityRelationshipsTrunkEntityId110], [s4].[RelationshipsBranchEntityId11], [s4].[Id100], [s4].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId4], [s4].[RelationshipsBranchEntityRelationshipsTrunkEntityId14], [s4].[Id11], [s4].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId5], [s4].[RelationshipsBranchEntityRelationshipsTrunkEntityId15], [s4].[Id12], [s5].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s5].[Id1], [s5].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s5].[RelationshipsBranchEntityId1], [s5].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [s5].[RelationshipsBranchEntityId10], [s5].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [s5].[RelationshipsBranchEntityId11], [s5].[Id10], [r56].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r56].[Id1], [r57].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r57].[Id1], [s6].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s6].[Id1], [s6].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s6].[RelationshipsBranchEntityId1], [s6].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [s6].[RelationshipsBranchEntityId10], [s6].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [s6].[RelationshipsBranchEntityId11], [s6].[Id10], [r62].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r62].[Id1], [r63].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+""");
+    }
+
+    public override async Task Select_trunk_and_branch_duplicated(bool async)
+    {
+        await base.Select_trunk_and_branch_duplicated(async);
+
+        AssertSql(
+            """
+SELECT [r0].[RelationshipsRootEntityId], [r0].[Name], [r].[Id], [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r3].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r4].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r5].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r6].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s].[Id1], [s].[Name], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s].[RelationshipsBranchEntityId1], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [s].[RelationshipsBranchEntityId10], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [s].[RelationshipsBranchEntityId11], [s].[Id10], [s].[Name0], [s].[Name1], [s].[Name2], [r1].[Name], [r11].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r11].[Id1], [r11].[Name], [r2].[Name], [r3].[Name], [r4].[Name], [r12].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r12].[Id1], [r12].[Name], [r5].[Name], [r6].[Name], [r13].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r13].[Id1], [r13].[Name], [s0].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s0].[Id1], [s0].[Name], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s0].[RelationshipsBranchEntityId1], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [s0].[RelationshipsBranchEntityId10], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [s0].[RelationshipsBranchEntityId11], [s0].[Id10], [s0].[Name0], [s0].[Name1], [s0].[Name2], [r18].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r18].[Id1], [r18].[Name], [r19].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r19].[Id1], [r19].[Name], [r20].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r20].[Id1], [r20].[Name]
+FROM [RootEntities] AS [r]
+LEFT JOIN [Root_OptionalReferenceTrunk] AS [r0] ON [r].[Id] = [r0].[RelationshipsRootEntityId]
+LEFT JOIN [Root_OptionalReferenceTrunk_OptionalReferenceBranch] AS [r1] ON [r0].[RelationshipsRootEntityId] = [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_OptionalReferenceTrunk_OptionalReferenceBranch_OptionalReferenceLeaf] AS [r2] ON [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_OptionalReferenceTrunk_OptionalReferenceBranch_RequiredReferenceLeaf] AS [r3] ON [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r3].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_OptionalReferenceTrunk_RequiredReferenceBranch] AS [r4] ON [r0].[RelationshipsRootEntityId] = [r4].[RelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_OptionalReferenceTrunk_RequiredReferenceBranch_OptionalReferenceLeaf] AS [r5] ON [r4].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r5].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_OptionalReferenceTrunk_RequiredReferenceBranch_RequiredReferenceLeaf] AS [r6] ON [r4].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r6].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN (
+    SELECT [r7].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r7].[Id1], [r7].[Name], [r8].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r8].[RelationshipsBranchEntityId1], [r9].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [r9].[RelationshipsBranchEntityId1] AS [RelationshipsBranchEntityId10], [r10].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [r10].[RelationshipsBranchEntityId1] AS [RelationshipsBranchEntityId11], [r10].[Id1] AS [Id10], [r10].[Name] AS [Name0], [r8].[Name] AS [Name1], [r9].[Name] AS [Name2]
+    FROM [Root_OptionalReferenceTrunk_CollectionBranch] AS [r7]
+    LEFT JOIN [Root_OptionalReferenceTrunk_CollectionBranch_OptionalReferenceLeaf] AS [r8] ON [r7].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r8].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r7].[Id1] = [r8].[RelationshipsBranchEntityId1]
+    LEFT JOIN [Root_OptionalReferenceTrunk_CollectionBranch_RequiredReferenceLeaf] AS [r9] ON [r7].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r9].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r7].[Id1] = [r9].[RelationshipsBranchEntityId1]
+    LEFT JOIN [Root_OptionalReferenceTrunk_CollectionBranch_CollectionLeaf] AS [r10] ON [r7].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r10].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r7].[Id1] = [r10].[RelationshipsBranchEntityId1]
+) AS [s] ON [r0].[RelationshipsRootEntityId] = [s].[RelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_OptionalReferenceTrunk_OptionalReferenceBranch_CollectionLeaf] AS [r11] ON [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r11].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_OptionalReferenceTrunk_RequiredReferenceBranch_CollectionLeaf] AS [r12] ON [r4].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r12].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_OptionalReferenceTrunk_RequiredReferenceBranch_CollectionLeaf] AS [r13] ON [r4].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r13].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN (
+    SELECT [r14].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r14].[Id1], [r14].[Name], [r15].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r15].[RelationshipsBranchEntityId1], [r16].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [r16].[RelationshipsBranchEntityId1] AS [RelationshipsBranchEntityId10], [r17].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [r17].[RelationshipsBranchEntityId1] AS [RelationshipsBranchEntityId11], [r17].[Id1] AS [Id10], [r17].[Name] AS [Name0], [r15].[Name] AS [Name1], [r16].[Name] AS [Name2]
+    FROM [Root_OptionalReferenceTrunk_CollectionBranch] AS [r14]
+    LEFT JOIN [Root_OptionalReferenceTrunk_CollectionBranch_OptionalReferenceLeaf] AS [r15] ON [r14].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r15].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r14].[Id1] = [r15].[RelationshipsBranchEntityId1]
+    LEFT JOIN [Root_OptionalReferenceTrunk_CollectionBranch_RequiredReferenceLeaf] AS [r16] ON [r14].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r16].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r14].[Id1] = [r16].[RelationshipsBranchEntityId1]
+    LEFT JOIN [Root_OptionalReferenceTrunk_CollectionBranch_CollectionLeaf] AS [r17] ON [r14].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r17].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r14].[Id1] = [r17].[RelationshipsBranchEntityId1]
+) AS [s0] ON [r0].[RelationshipsRootEntityId] = [s0].[RelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_OptionalReferenceTrunk_OptionalReferenceBranch_CollectionLeaf] AS [r18] ON [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r18].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_OptionalReferenceTrunk_RequiredReferenceBranch_CollectionLeaf] AS [r19] ON [r4].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r19].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_OptionalReferenceTrunk_RequiredReferenceBranch_CollectionLeaf] AS [r20] ON [r4].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r20].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+ORDER BY [r].[Id], [r0].[RelationshipsRootEntityId], [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r3].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r4].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r5].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r6].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s].[Id1], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s].[RelationshipsBranchEntityId1], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [s].[RelationshipsBranchEntityId10], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [s].[RelationshipsBranchEntityId11], [s].[Id10], [r11].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r11].[Id1], [r12].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r12].[Id1], [r13].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r13].[Id1], [s0].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s0].[Id1], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s0].[RelationshipsBranchEntityId1], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [s0].[RelationshipsBranchEntityId10], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [s0].[RelationshipsBranchEntityId11], [s0].[Id10], [r18].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r18].[Id1], [r19].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r19].[Id1], [r20].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+""");
+    }
+
+    public override async Task Select_trunk_and_trunk_duplicated(bool async)
+    {
+        await base.Select_trunk_and_trunk_duplicated(async);
+
+        AssertSql(
+            """
+SELECT [r0].[RelationshipsRootEntityId], [r0].[Name], [r].[Id], [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r3].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r4].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r5].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r6].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s].[Id1], [s].[Name], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s].[RelationshipsBranchEntityId1], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [s].[RelationshipsBranchEntityId10], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [s].[RelationshipsBranchEntityId11], [s].[Id10], [s].[Name0], [s].[Name1], [s].[Name2], [r1].[Name], [r11].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r11].[Id1], [r11].[Name], [r2].[Name], [r3].[Name], [r4].[Name], [r12].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r12].[Id1], [r12].[Name], [r5].[Name], [r6].[Name], [s0].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s0].[Id1], [s0].[Name], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s0].[RelationshipsBranchEntityId1], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [s0].[RelationshipsBranchEntityId10], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [s0].[RelationshipsBranchEntityId11], [s0].[Id10], [s0].[Name0], [s0].[Name1], [s0].[Name2], [r17].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r17].[Id1], [r17].[Name], [r18].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r18].[Id1], [r18].[Name]
+FROM [RootEntities] AS [r]
+LEFT JOIN [Root_RequiredReferenceTrunk] AS [r0] ON [r].[Id] = [r0].[RelationshipsRootEntityId]
+LEFT JOIN [Root_RequiredReferenceTrunk_OptionalReferenceBranch] AS [r1] ON [r0].[RelationshipsRootEntityId] = [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_RequiredReferenceTrunk_OptionalReferenceBranch_OptionalReferenceLeaf] AS [r2] ON [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_RequiredReferenceTrunk_OptionalReferenceBranch_RequiredReferenceLeaf] AS [r3] ON [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r3].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_RequiredReferenceTrunk_RequiredReferenceBranch] AS [r4] ON [r0].[RelationshipsRootEntityId] = [r4].[RelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_RequiredReferenceTrunk_RequiredReferenceBranch_OptionalReferenceLeaf] AS [r5] ON [r4].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r5].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_RequiredReferenceTrunk_RequiredReferenceBranch_RequiredReferenceLeaf] AS [r6] ON [r4].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r6].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN (
+    SELECT [r7].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r7].[Id1], [r7].[Name], [r8].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r8].[RelationshipsBranchEntityId1], [r9].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [r9].[RelationshipsBranchEntityId1] AS [RelationshipsBranchEntityId10], [r10].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [r10].[RelationshipsBranchEntityId1] AS [RelationshipsBranchEntityId11], [r10].[Id1] AS [Id10], [r10].[Name] AS [Name0], [r8].[Name] AS [Name1], [r9].[Name] AS [Name2]
+    FROM [Root_RequiredReferenceTrunk_CollectionBranch] AS [r7]
+    LEFT JOIN [Root_RequiredReferenceTrunk_CollectionBranch_OptionalReferenceLeaf] AS [r8] ON [r7].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r8].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r7].[Id1] = [r8].[RelationshipsBranchEntityId1]
+    LEFT JOIN [Root_RequiredReferenceTrunk_CollectionBranch_RequiredReferenceLeaf] AS [r9] ON [r7].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r9].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r7].[Id1] = [r9].[RelationshipsBranchEntityId1]
+    LEFT JOIN [Root_RequiredReferenceTrunk_CollectionBranch_CollectionLeaf] AS [r10] ON [r7].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r10].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r7].[Id1] = [r10].[RelationshipsBranchEntityId1]
+) AS [s] ON [r0].[RelationshipsRootEntityId] = [s].[RelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_RequiredReferenceTrunk_OptionalReferenceBranch_CollectionLeaf] AS [r11] ON [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r11].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_RequiredReferenceTrunk_RequiredReferenceBranch_CollectionLeaf] AS [r12] ON [r4].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r12].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN (
+    SELECT [r13].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r13].[Id1], [r13].[Name], [r14].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r14].[RelationshipsBranchEntityId1], [r15].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [r15].[RelationshipsBranchEntityId1] AS [RelationshipsBranchEntityId10], [r16].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [r16].[RelationshipsBranchEntityId1] AS [RelationshipsBranchEntityId11], [r16].[Id1] AS [Id10], [r16].[Name] AS [Name0], [r14].[Name] AS [Name1], [r15].[Name] AS [Name2]
+    FROM [Root_RequiredReferenceTrunk_CollectionBranch] AS [r13]
+    LEFT JOIN [Root_RequiredReferenceTrunk_CollectionBranch_OptionalReferenceLeaf] AS [r14] ON [r13].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r14].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r13].[Id1] = [r14].[RelationshipsBranchEntityId1]
+    LEFT JOIN [Root_RequiredReferenceTrunk_CollectionBranch_RequiredReferenceLeaf] AS [r15] ON [r13].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r15].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r13].[Id1] = [r15].[RelationshipsBranchEntityId1]
+    LEFT JOIN [Root_RequiredReferenceTrunk_CollectionBranch_CollectionLeaf] AS [r16] ON [r13].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r16].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r13].[Id1] = [r16].[RelationshipsBranchEntityId1]
+) AS [s0] ON [r0].[RelationshipsRootEntityId] = [s0].[RelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_RequiredReferenceTrunk_OptionalReferenceBranch_CollectionLeaf] AS [r17] ON [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r17].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_RequiredReferenceTrunk_RequiredReferenceBranch_CollectionLeaf] AS [r18] ON [r4].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r18].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+ORDER BY [r].[Id], [r0].[RelationshipsRootEntityId], [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r3].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r4].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r5].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r6].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s].[Id1], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s].[RelationshipsBranchEntityId1], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [s].[RelationshipsBranchEntityId10], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [s].[RelationshipsBranchEntityId11], [s].[Id10], [r11].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r11].[Id1], [r12].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r12].[Id1], [s0].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s0].[Id1], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s0].[RelationshipsBranchEntityId1], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [s0].[RelationshipsBranchEntityId10], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [s0].[RelationshipsBranchEntityId11], [s0].[Id10], [r17].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r17].[Id1], [r18].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+""");
+    }
+
+    public override async Task Select_leaf_trunk_root(bool async)
+    {
+        await base.Select_leaf_trunk_root(async);
+
+        AssertSql(
+            """
+SELECT [r2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r2].[Name], [r0].[RelationshipsRootEntityId], [r0].[Name], [r].[Id], [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r3].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r4].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r5].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r6].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r7].[RelationshipsRootEntityId], [r8].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r9].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r10].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r11].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r12].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r13].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s].[Id1], [s].[Name], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s].[RelationshipsBranchEntityId1], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [s].[RelationshipsBranchEntityId10], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [s].[RelationshipsBranchEntityId11], [s].[Id10], [s].[Name0], [s].[Name1], [s].[Name2], [r3].[Name], [r18].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r18].[Id1], [r18].[Name], [r4].[Name], [r5].[Name], [r1].[Name], [r19].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r19].[Id1], [r19].[Name], [r6].[Name], [r].[Name], [r].[OptionalReferenceTrunkId], [r].[RequiredReferenceTrunkId], [s1].[RelationshipsRootEntityId], [s1].[Id1], [s1].[Name], [s1].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s1].[RelationshipsTrunkEntityId1], [s1].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s1].[RelationshipsBranchEntityRelationshipsTrunkEntityId1], [s1].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [s1].[RelationshipsBranchEntityRelationshipsTrunkEntityId10], [s1].[RelationshipsTrunkEntityRelationshipsRootEntityId0], [s1].[RelationshipsTrunkEntityId10], [s1].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [s1].[RelationshipsBranchEntityRelationshipsTrunkEntityId11], [s1].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId2], [s1].[RelationshipsBranchEntityRelationshipsTrunkEntityId12], [s1].[RelationshipsTrunkEntityRelationshipsRootEntityId1], [s1].[RelationshipsTrunkEntityId11], [s1].[Id10], [s1].[Name0], [s1].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId3], [s1].[RelationshipsBranchEntityRelationshipsTrunkEntityId13], [s1].[RelationshipsBranchEntityId1], [s1].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId00], [s1].[RelationshipsBranchEntityRelationshipsTrunkEntityId100], [s1].[RelationshipsBranchEntityId10], [s1].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId10], [s1].[RelationshipsBranchEntityRelationshipsTrunkEntityId110], [s1].[RelationshipsBranchEntityId11], [s1].[Id100], [s1].[Name00], [s1].[Name1], [s1].[Name2], [s1].[Name3], [s1].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId4], [s1].[RelationshipsBranchEntityRelationshipsTrunkEntityId14], [s1].[Id11], [s1].[Name4], [s1].[Name5], [s1].[Name6], [s1].[Name7], [s1].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId5], [s1].[RelationshipsBranchEntityRelationshipsTrunkEntityId15], [s1].[Id12], [s1].[Name8], [s1].[Name9], [s1].[Name10], [r7].[Name], [s2].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s2].[Id1], [s2].[Name], [s2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s2].[RelationshipsBranchEntityId1], [s2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [s2].[RelationshipsBranchEntityId10], [s2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [s2].[RelationshipsBranchEntityId11], [s2].[Id10], [s2].[Name0], [s2].[Name1], [s2].[Name2], [r8].[Name], [r37].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r37].[Id1], [r37].[Name], [r9].[Name], [r10].[Name], [r11].[Name], [r38].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r38].[Id1], [r38].[Name], [r12].[Name], [r13].[Name], [s3].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s3].[Id1], [s3].[Name], [s3].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s3].[RelationshipsBranchEntityId1], [s3].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [s3].[RelationshipsBranchEntityId10], [s3].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [s3].[RelationshipsBranchEntityId11], [s3].[Id10], [s3].[Name0], [s3].[Name1], [s3].[Name2], [r43].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r43].[Id1], [r43].[Name], [r44].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r44].[Id1], [r44].[Name]
+FROM [RootEntities] AS [r]
+LEFT JOIN [Root_RequiredReferenceTrunk] AS [r0] ON [r].[Id] = [r0].[RelationshipsRootEntityId]
+LEFT JOIN [Root_RequiredReferenceTrunk_RequiredReferenceBranch] AS [r1] ON [r0].[RelationshipsRootEntityId] = [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_RequiredReferenceTrunk_RequiredReferenceBranch_RequiredReferenceLeaf] AS [r2] ON [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_RequiredReferenceTrunk_OptionalReferenceBranch] AS [r3] ON [r0].[RelationshipsRootEntityId] = [r3].[RelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_RequiredReferenceTrunk_OptionalReferenceBranch_OptionalReferenceLeaf] AS [r4] ON [r3].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r4].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_RequiredReferenceTrunk_OptionalReferenceBranch_RequiredReferenceLeaf] AS [r5] ON [r3].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r5].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_RequiredReferenceTrunk_RequiredReferenceBranch_OptionalReferenceLeaf] AS [r6] ON [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r6].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_OptionalReferenceTrunk] AS [r7] ON [r].[Id] = [r7].[RelationshipsRootEntityId]
+LEFT JOIN [Root_OptionalReferenceTrunk_OptionalReferenceBranch] AS [r8] ON [r7].[RelationshipsRootEntityId] = [r8].[RelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_OptionalReferenceTrunk_OptionalReferenceBranch_OptionalReferenceLeaf] AS [r9] ON [r8].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r9].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_OptionalReferenceTrunk_OptionalReferenceBranch_RequiredReferenceLeaf] AS [r10] ON [r8].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r10].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_OptionalReferenceTrunk_RequiredReferenceBranch] AS [r11] ON [r7].[RelationshipsRootEntityId] = [r11].[RelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_OptionalReferenceTrunk_RequiredReferenceBranch_OptionalReferenceLeaf] AS [r12] ON [r11].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r12].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_OptionalReferenceTrunk_RequiredReferenceBranch_RequiredReferenceLeaf] AS [r13] ON [r11].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r13].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN (
+    SELECT [r14].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r14].[Id1], [r14].[Name], [r15].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r15].[RelationshipsBranchEntityId1], [r16].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [r16].[RelationshipsBranchEntityId1] AS [RelationshipsBranchEntityId10], [r17].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [r17].[RelationshipsBranchEntityId1] AS [RelationshipsBranchEntityId11], [r17].[Id1] AS [Id10], [r17].[Name] AS [Name0], [r15].[Name] AS [Name1], [r16].[Name] AS [Name2]
+    FROM [Root_RequiredReferenceTrunk_CollectionBranch] AS [r14]
+    LEFT JOIN [Root_RequiredReferenceTrunk_CollectionBranch_OptionalReferenceLeaf] AS [r15] ON [r14].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r15].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r14].[Id1] = [r15].[RelationshipsBranchEntityId1]
+    LEFT JOIN [Root_RequiredReferenceTrunk_CollectionBranch_RequiredReferenceLeaf] AS [r16] ON [r14].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r16].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r14].[Id1] = [r16].[RelationshipsBranchEntityId1]
+    LEFT JOIN [Root_RequiredReferenceTrunk_CollectionBranch_CollectionLeaf] AS [r17] ON [r14].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r17].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r14].[Id1] = [r17].[RelationshipsBranchEntityId1]
+) AS [s] ON [r0].[RelationshipsRootEntityId] = [s].[RelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_RequiredReferenceTrunk_OptionalReferenceBranch_CollectionLeaf] AS [r18] ON [r3].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r18].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_RequiredReferenceTrunk_RequiredReferenceBranch_CollectionLeaf] AS [r19] ON [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r19].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN (
+    SELECT [r20].[RelationshipsRootEntityId], [r20].[Id1], [r20].[Name], [r21].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r21].[RelationshipsTrunkEntityId1], [r22].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r22].[RelationshipsBranchEntityRelationshipsTrunkEntityId1], [r23].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [r23].[RelationshipsBranchEntityRelationshipsTrunkEntityId1] AS [RelationshipsBranchEntityRelationshipsTrunkEntityId10], [r24].[RelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsTrunkEntityRelationshipsRootEntityId0], [r24].[RelationshipsTrunkEntityId1] AS [RelationshipsTrunkEntityId10], [r25].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [r25].[RelationshipsBranchEntityRelationshipsTrunkEntityId1] AS [RelationshipsBranchEntityRelationshipsTrunkEntityId11], [r26].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId2], [r26].[RelationshipsBranchEntityRelationshipsTrunkEntityId1] AS [RelationshipsBranchEntityRelationshipsTrunkEntityId12], [s0].[RelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsTrunkEntityRelationshipsRootEntityId1], [s0].[RelationshipsTrunkEntityId1] AS [RelationshipsTrunkEntityId11], [s0].[Id1] AS [Id10], [s0].[Name] AS [Name0], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId3], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityId1] AS [RelationshipsBranchEntityRelationshipsTrunkEntityId13], [s0].[RelationshipsBranchEntityId1], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId00], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityId10] AS [RelationshipsBranchEntityRelationshipsTrunkEntityId100], [s0].[RelationshipsBranchEntityId10], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId10], [s0].[RelationshipsBranchEntityRelationshipsTrunkEntityId11] AS [RelationshipsBranchEntityRelationshipsTrunkEntityId110], [s0].[RelationshipsBranchEntityId11], [s0].[Id10] AS [Id100], [s0].[Name0] AS [Name00], [s0].[Name1], [s0].[Name2], [r21].[Name] AS [Name3], [r31].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId4], [r31].[RelationshipsBranchEntityRelationshipsTrunkEntityId1] AS [RelationshipsBranchEntityRelationshipsTrunkEntityId14], [r31].[Id1] AS [Id11], [r31].[Name] AS [Name4], [r22].[Name] AS [Name5], [r23].[Name] AS [Name6], [r24].[Name] AS [Name7], [r32].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId5], [r32].[RelationshipsBranchEntityRelationshipsTrunkEntityId1] AS [RelationshipsBranchEntityRelationshipsTrunkEntityId15], [r32].[Id1] AS [Id12], [r32].[Name] AS [Name8], [r25].[Name] AS [Name9], [r26].[Name] AS [Name10]
+    FROM [Root_CollectionTrunk] AS [r20]
+    LEFT JOIN [Root_CollectionTrunk_OptionalReferenceBranch] AS [r21] ON [r20].[RelationshipsRootEntityId] = [r21].[RelationshipsTrunkEntityRelationshipsRootEntityId] AND [r20].[Id1] = [r21].[RelationshipsTrunkEntityId1]
+    LEFT JOIN [Root_CollectionTrunk_OptionalReferenceBranch_OptionalReferenceLeaf] AS [r22] ON [r21].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r22].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r21].[RelationshipsTrunkEntityId1] = [r22].[RelationshipsBranchEntityRelationshipsTrunkEntityId1]
+    LEFT JOIN [Root_CollectionTrunk_OptionalReferenceBranch_RequiredReferenceLeaf] AS [r23] ON [r21].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r23].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r21].[RelationshipsTrunkEntityId1] = [r23].[RelationshipsBranchEntityRelationshipsTrunkEntityId1]
+    LEFT JOIN [Root_CollectionTrunk_RequiredReferenceBranch] AS [r24] ON [r20].[RelationshipsRootEntityId] = [r24].[RelationshipsTrunkEntityRelationshipsRootEntityId] AND [r20].[Id1] = [r24].[RelationshipsTrunkEntityId1]
+    LEFT JOIN [Root_CollectionTrunk_RequiredReferenceBranch_OptionalReferenceLeaf] AS [r25] ON [r24].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r25].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r24].[RelationshipsTrunkEntityId1] = [r25].[RelationshipsBranchEntityRelationshipsTrunkEntityId1]
+    LEFT JOIN [Root_CollectionTrunk_RequiredReferenceBranch_RequiredReferenceLeaf] AS [r26] ON [r24].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r26].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r24].[RelationshipsTrunkEntityId1] = [r26].[RelationshipsBranchEntityRelationshipsTrunkEntityId1]
+    LEFT JOIN (
+        SELECT [r27].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r27].[RelationshipsTrunkEntityId1], [r27].[Id1], [r27].[Name], [r28].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r28].[RelationshipsBranchEntityRelationshipsTrunkEntityId1], [r28].[RelationshipsBranchEntityId1], [r29].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [r29].[RelationshipsBranchEntityRelationshipsTrunkEntityId1] AS [RelationshipsBranchEntityRelationshipsTrunkEntityId10], [r29].[RelationshipsBranchEntityId1] AS [RelationshipsBranchEntityId10], [r30].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [r30].[RelationshipsBranchEntityRelationshipsTrunkEntityId1] AS [RelationshipsBranchEntityRelationshipsTrunkEntityId11], [r30].[RelationshipsBranchEntityId1] AS [RelationshipsBranchEntityId11], [r30].[Id1] AS [Id10], [r30].[Name] AS [Name0], [r28].[Name] AS [Name1], [r29].[Name] AS [Name2]
+        FROM [Root_CollectionTrunk_CollectionBranch] AS [r27]
+        LEFT JOIN [Root_CollectionTrunk_CollectionBranch_OptionalReferenceLeaf] AS [r28] ON [r27].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r28].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r27].[RelationshipsTrunkEntityId1] = [r28].[RelationshipsBranchEntityRelationshipsTrunkEntityId1] AND [r27].[Id1] = [r28].[RelationshipsBranchEntityId1]
+        LEFT JOIN [Root_CollectionTrunk_CollectionBranch_RequiredReferenceLeaf] AS [r29] ON [r27].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r29].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r27].[RelationshipsTrunkEntityId1] = [r29].[RelationshipsBranchEntityRelationshipsTrunkEntityId1] AND [r27].[Id1] = [r29].[RelationshipsBranchEntityId1]
+        LEFT JOIN [Root_CollectionTrunk_CollectionBranch_CollectionLeaf] AS [r30] ON [r27].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r30].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r27].[RelationshipsTrunkEntityId1] = [r30].[RelationshipsBranchEntityRelationshipsTrunkEntityId1] AND [r27].[Id1] = [r30].[RelationshipsBranchEntityId1]
+    ) AS [s0] ON [r20].[RelationshipsRootEntityId] = [s0].[RelationshipsTrunkEntityRelationshipsRootEntityId] AND [r20].[Id1] = [s0].[RelationshipsTrunkEntityId1]
+    LEFT JOIN [Root_CollectionTrunk_OptionalReferenceBranch_CollectionLeaf] AS [r31] ON [r21].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r31].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r21].[RelationshipsTrunkEntityId1] = [r31].[RelationshipsBranchEntityRelationshipsTrunkEntityId1]
+    LEFT JOIN [Root_CollectionTrunk_RequiredReferenceBranch_CollectionLeaf] AS [r32] ON [r24].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r32].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r24].[RelationshipsTrunkEntityId1] = [r32].[RelationshipsBranchEntityRelationshipsTrunkEntityId1]
+) AS [s1] ON [r].[Id] = [s1].[RelationshipsRootEntityId]
+LEFT JOIN (
+    SELECT [r33].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r33].[Id1], [r33].[Name], [r34].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r34].[RelationshipsBranchEntityId1], [r35].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [r35].[RelationshipsBranchEntityId1] AS [RelationshipsBranchEntityId10], [r36].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [r36].[RelationshipsBranchEntityId1] AS [RelationshipsBranchEntityId11], [r36].[Id1] AS [Id10], [r36].[Name] AS [Name0], [r34].[Name] AS [Name1], [r35].[Name] AS [Name2]
+    FROM [Root_OptionalReferenceTrunk_CollectionBranch] AS [r33]
+    LEFT JOIN [Root_OptionalReferenceTrunk_CollectionBranch_OptionalReferenceLeaf] AS [r34] ON [r33].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r34].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r33].[Id1] = [r34].[RelationshipsBranchEntityId1]
+    LEFT JOIN [Root_OptionalReferenceTrunk_CollectionBranch_RequiredReferenceLeaf] AS [r35] ON [r33].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r35].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r33].[Id1] = [r35].[RelationshipsBranchEntityId1]
+    LEFT JOIN [Root_OptionalReferenceTrunk_CollectionBranch_CollectionLeaf] AS [r36] ON [r33].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r36].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r33].[Id1] = [r36].[RelationshipsBranchEntityId1]
+) AS [s2] ON [r7].[RelationshipsRootEntityId] = [s2].[RelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_OptionalReferenceTrunk_OptionalReferenceBranch_CollectionLeaf] AS [r37] ON [r8].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r37].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_OptionalReferenceTrunk_RequiredReferenceBranch_CollectionLeaf] AS [r38] ON [r11].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r38].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN (
+    SELECT [r39].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r39].[Id1], [r39].[Name], [r40].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r40].[RelationshipsBranchEntityId1], [r41].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [r41].[RelationshipsBranchEntityId1] AS [RelationshipsBranchEntityId10], [r42].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [r42].[RelationshipsBranchEntityId1] AS [RelationshipsBranchEntityId11], [r42].[Id1] AS [Id10], [r42].[Name] AS [Name0], [r40].[Name] AS [Name1], [r41].[Name] AS [Name2]
+    FROM [Root_RequiredReferenceTrunk_CollectionBranch] AS [r39]
+    LEFT JOIN [Root_RequiredReferenceTrunk_CollectionBranch_OptionalReferenceLeaf] AS [r40] ON [r39].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r40].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r39].[Id1] = [r40].[RelationshipsBranchEntityId1]
+    LEFT JOIN [Root_RequiredReferenceTrunk_CollectionBranch_RequiredReferenceLeaf] AS [r41] ON [r39].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r41].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r39].[Id1] = [r41].[RelationshipsBranchEntityId1]
+    LEFT JOIN [Root_RequiredReferenceTrunk_CollectionBranch_CollectionLeaf] AS [r42] ON [r39].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r42].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AND [r39].[Id1] = [r42].[RelationshipsBranchEntityId1]
+) AS [s3] ON [r0].[RelationshipsRootEntityId] = [s3].[RelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_RequiredReferenceTrunk_OptionalReferenceBranch_CollectionLeaf] AS [r43] ON [r3].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r43].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+LEFT JOIN [Root_RequiredReferenceTrunk_RequiredReferenceBranch_CollectionLeaf] AS [r44] ON [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r44].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+ORDER BY [r].[Id], [r0].[RelationshipsRootEntityId], [r1].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r3].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r4].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r5].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r6].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r7].[RelationshipsRootEntityId], [r8].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r9].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r10].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r11].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r12].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r13].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s].[Id1], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s].[RelationshipsBranchEntityId1], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [s].[RelationshipsBranchEntityId10], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [s].[RelationshipsBranchEntityId11], [s].[Id10], [r18].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r18].[Id1], [r19].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r19].[Id1], [s1].[RelationshipsRootEntityId], [s1].[Id1], [s1].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s1].[RelationshipsTrunkEntityId1], [s1].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s1].[RelationshipsBranchEntityRelationshipsTrunkEntityId1], [s1].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [s1].[RelationshipsBranchEntityRelationshipsTrunkEntityId10], [s1].[RelationshipsTrunkEntityRelationshipsRootEntityId0], [s1].[RelationshipsTrunkEntityId10], [s1].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [s1].[RelationshipsBranchEntityRelationshipsTrunkEntityId11], [s1].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId2], [s1].[RelationshipsBranchEntityRelationshipsTrunkEntityId12], [s1].[RelationshipsTrunkEntityRelationshipsRootEntityId1], [s1].[RelationshipsTrunkEntityId11], [s1].[Id10], [s1].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId3], [s1].[RelationshipsBranchEntityRelationshipsTrunkEntityId13], [s1].[RelationshipsBranchEntityId1], [s1].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId00], [s1].[RelationshipsBranchEntityRelationshipsTrunkEntityId100], [s1].[RelationshipsBranchEntityId10], [s1].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId10], [s1].[RelationshipsBranchEntityRelationshipsTrunkEntityId110], [s1].[RelationshipsBranchEntityId11], [s1].[Id100], [s1].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId4], [s1].[RelationshipsBranchEntityRelationshipsTrunkEntityId14], [s1].[Id11], [s1].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId5], [s1].[RelationshipsBranchEntityRelationshipsTrunkEntityId15], [s1].[Id12], [s2].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s2].[Id1], [s2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s2].[RelationshipsBranchEntityId1], [s2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [s2].[RelationshipsBranchEntityId10], [s2].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [s2].[RelationshipsBranchEntityId11], [s2].[Id10], [r37].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r37].[Id1], [r38].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r38].[Id1], [s3].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s3].[Id1], [s3].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s3].[RelationshipsBranchEntityId1], [s3].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [s3].[RelationshipsBranchEntityId10], [s3].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId1], [s3].[RelationshipsBranchEntityId11], [s3].[Id10], [r43].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r43].[Id1], [r44].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+""");
+    }
+
+    public override async Task Select_subquery_root_set_required_trunk_FirstOrDefault_branch(bool async)
+    {
+        await base.Select_subquery_root_set_required_trunk_FirstOrDefault_branch(async);
+
+        AssertSql(
+            """
+SELECT [s].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s].[Name], [r].[Id], [s].[Id], [s].[RelationshipsRootEntityId], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [r5].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r5].[Id1], [r5].[Name], [s].[Name0], [s].[Name1]
+FROM [RootEntities] AS [r]
+OUTER APPLY (
+    SELECT TOP(1) [r2].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r2].[Name], [r3].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r3].[Name] AS [Name0], [r4].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [r4].[Name] AS [Name1], [r0].[Id], [r1].[RelationshipsRootEntityId]
+    FROM [RootEntities] AS [r0]
+    LEFT JOIN [Root_RequiredReferenceTrunk] AS [r1] ON [r0].[Id] = [r1].[RelationshipsRootEntityId]
+    LEFT JOIN [Root_RequiredReferenceTrunk_RequiredReferenceBranch] AS [r2] ON [r1].[RelationshipsRootEntityId] = [r2].[RelationshipsTrunkEntityRelationshipsRootEntityId]
+    LEFT JOIN [Root_RequiredReferenceTrunk_RequiredReferenceBranch_OptionalReferenceLeaf] AS [r3] ON [r2].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r3].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+    LEFT JOIN [Root_RequiredReferenceTrunk_RequiredReferenceBranch_RequiredReferenceLeaf] AS [r4] ON [r2].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r4].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+    ORDER BY [r0].[Id]
+) AS [s]
+LEFT JOIN [Root_RequiredReferenceTrunk_RequiredReferenceBranch_CollectionLeaf] AS [r5] ON [s].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r5].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+ORDER BY [r].[Id], [s].[Id], [s].[RelationshipsRootEntityId], [s].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [r5].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+""");
+    }
+
+    public override async Task Select_subquery_root_set_optional_trunk_FirstOrDefault_branch(bool async)
+    {
+        await base.Select_subquery_root_set_optional_trunk_FirstOrDefault_branch(async);
+
+        AssertSql(
+            """
+SELECT [s].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s].[Name], [r].[Id], [s].[Id], [s].[RelationshipsRootEntityId], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [r5].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r5].[Id1], [r5].[Name], [s].[Name0], [s].[Name1]
+FROM [RootEntities] AS [r]
+OUTER APPLY (
+    SELECT TOP(1) [r2].[RelationshipsTrunkEntityRelationshipsRootEntityId], [r2].[Name], [r3].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [r3].[Name] AS [Name0], [r4].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId] AS [RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [r4].[Name] AS [Name1], [r0].[Id], [r1].[RelationshipsRootEntityId]
+    FROM [RootEntities] AS [r0]
+    LEFT JOIN [Root_OptionalReferenceTrunk] AS [r1] ON [r0].[Id] = [r1].[RelationshipsRootEntityId]
+    LEFT JOIN [Root_OptionalReferenceTrunk_OptionalReferenceBranch] AS [r2] ON [r1].[RelationshipsRootEntityId] = [r2].[RelationshipsTrunkEntityRelationshipsRootEntityId]
+    LEFT JOIN [Root_OptionalReferenceTrunk_OptionalReferenceBranch_OptionalReferenceLeaf] AS [r3] ON [r2].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r3].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+    LEFT JOIN [Root_OptionalReferenceTrunk_OptionalReferenceBranch_RequiredReferenceLeaf] AS [r4] ON [r2].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r4].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+    ORDER BY [r0].[Id]
+) AS [s]
+LEFT JOIN [Root_OptionalReferenceTrunk_OptionalReferenceBranch_CollectionLeaf] AS [r5] ON [s].[RelationshipsTrunkEntityRelationshipsRootEntityId] = [r5].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+ORDER BY [r].[Id], [s].[Id], [s].[RelationshipsRootEntityId], [s].[RelationshipsTrunkEntityRelationshipsRootEntityId], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId], [s].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId0], [r5].[RelationshipsBranchEntityRelationshipsTrunkEntityRelationshipsRootEntityId]
+""");
+    }
+
+    private void AssertSql(params string[] expected)
+        => Fixture.TestSqlLoggerFactory.AssertBaseline(expected);
+}
diff --git a/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/JsonRelationshipsQuerySqliteFixture.cs b/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/ComplexRelationshipsSqliteFixture.cs
similarity index 77%
rename from test/EFCore.Sqlite.FunctionalTests/Query/Relationships/JsonRelationshipsQuerySqliteFixture.cs
rename to test/EFCore.Sqlite.FunctionalTests/Query/Relationships/ComplexRelationshipsSqliteFixture.cs
index e6ac7ee8cd..60cb1fb42b 100644
--- a/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/JsonRelationshipsQuerySqliteFixture.cs
+++ b/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/ComplexRelationshipsSqliteFixture.cs
@@ -3,7 +3,7 @@
 
 namespace Microsoft.EntityFrameworkCore.Query.Relationships;
 
-public class JsonRelationshipsQuerySqliteFixture : JsonRelationshipsQueryRelationalFixtureBase, ITestSqlLoggerFactory
+public class ComplexRelationshipsSqliteFixture : ComplexRelationsjipsRelationalFixtureBase, ITestSqlLoggerFactory
 {
     protected override ITestStoreFactory TestStoreFactory
         => SqliteTestStoreFactory.Instance;
diff --git a/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/InProjection/ComplexRelationshipsInProjectionNoTrackingQuerySqliteTest.cs b/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/InProjection/ComplexRelationshipsInProjectionNoTrackingQuerySqliteTest.cs
deleted file mode 100644
index 0e1b771a6e..0000000000
--- a/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/InProjection/ComplexRelationshipsInProjectionNoTrackingQuerySqliteTest.cs
+++ /dev/null
@@ -1,18 +0,0 @@
-﻿// Licensed to the .NET Foundation under one or more agreements.
-// The .NET Foundation licenses this file to you under the MIT license.
-
-namespace Microsoft.EntityFrameworkCore.Query.Relationships.InProjection;
-
-public class ComplexRelationshipsInProjectionNoTrackingQuerySqliteTest
-    : ComplexRelationshipsInProjectionNoTrackingQueryRelationalTestBase<ComplexRelationshipsQuerySqliteFixture>
-{
-    public ComplexRelationshipsInProjectionNoTrackingQuerySqliteTest(ComplexRelationshipsQuerySqliteFixture fixture, ITestOutputHelper testOutputHelper)
-        : base(fixture)
-    {
-        Fixture.TestSqlLoggerFactory.Clear();
-        Fixture.TestSqlLoggerFactory.SetTestOutputHelper(testOutputHelper);
-    }
-
-    private void AssertSql(params string[] expected)
-        => Fixture.TestSqlLoggerFactory.AssertBaseline(expected);
-}
diff --git a/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/InProjection/ComplexRelationshipsInProjectionQuerySqliteTest.cs b/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/InProjection/ComplexRelationshipsInProjectionQuerySqliteTest.cs
deleted file mode 100644
index f72c0a8b82..0000000000
--- a/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/InProjection/ComplexRelationshipsInProjectionQuerySqliteTest.cs
+++ /dev/null
@@ -1,18 +0,0 @@
-﻿// Licensed to the .NET Foundation under one or more agreements.
-// The .NET Foundation licenses this file to you under the MIT license.
-
-namespace Microsoft.EntityFrameworkCore.Query.Relationships.InProjection;
-
-public class ComplexRelationshipsInProjectionQuerySqliteTest
-    : ComplexRelationshipsInProjectionQueryRelationalTestBase<ComplexRelationshipsQuerySqliteFixture>
-{
-    public ComplexRelationshipsInProjectionQuerySqliteTest(ComplexRelationshipsQuerySqliteFixture fixture, ITestOutputHelper testOutputHelper)
-        : base(fixture)
-    {
-        Fixture.TestSqlLoggerFactory.Clear();
-        Fixture.TestSqlLoggerFactory.SetTestOutputHelper(testOutputHelper);
-    }
-
-    private void AssertSql(params string[] expected)
-        => Fixture.TestSqlLoggerFactory.AssertBaseline(expected);
-}
diff --git a/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/InProjection/EntityRelationshipsInProjectionNoTrackingQuerySqliteTest.cs b/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/InProjection/EntityRelationshipsInProjectionNoTrackingQuerySqliteTest.cs
deleted file mode 100644
index f3713f77b5..0000000000
--- a/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/InProjection/EntityRelationshipsInProjectionNoTrackingQuerySqliteTest.cs
+++ /dev/null
@@ -1,52 +0,0 @@
-﻿// Licensed to the .NET Foundation under one or more agreements.
-// The .NET Foundation licenses this file to you under the MIT license.
-
-using Microsoft.EntityFrameworkCore.Sqlite.Internal;
-
-namespace Microsoft.EntityFrameworkCore.Query.Relationships.InProjection;
-
-public class EntityRelationshipsInProjectionNoTrackingQuerySqliteTest
-    : EntityRelationshipsInProjectionNoTrackingQueryRelationalTestBase<EntityRelationshipsQuerySqliteFixture>
-{
-    public EntityRelationshipsInProjectionNoTrackingQuerySqliteTest(EntityRelationshipsQuerySqliteFixture fixture, ITestOutputHelper testOutputHelper)
-        : base(fixture)
-    {
-        Fixture.TestSqlLoggerFactory.Clear();
-        Fixture.TestSqlLoggerFactory.SetTestOutputHelper(testOutputHelper);
-    }
-
-    public override async Task Project_subquery_root_set_complex_projection_FirstOrDefault_project_reference_to_outer(bool async)
-        => Assert.Equal(
-            SqliteStrings.ApplyNotSupported,
-            (await Assert.ThrowsAsync<InvalidOperationException>(
-                () => base.Project_subquery_root_set_complex_projection_FirstOrDefault_project_reference_to_outer(async)))
-            .Message);
-
-    public override async Task Project_subquery_root_set_complex_projection_including_references_to_outer_FirstOrDefault(bool async)
-        => Assert.Equal(
-            SqliteStrings.ApplyNotSupported,
-            (await Assert.ThrowsAsync<InvalidOperationException>(
-                () => base.Project_subquery_root_set_complex_projection_including_references_to_outer_FirstOrDefault(async)))
-            .Message);
-
-    public override async Task Project_subquery_root_set_optional_trunk_FirstOrDefault_branch(bool async)
-        => Assert.Equal(
-            SqliteStrings.ApplyNotSupported,
-            (await Assert.ThrowsAsync<InvalidOperationException>(
-                () => base.Project_subquery_root_set_optional_trunk_FirstOrDefault_branch(async)))
-            .Message);
-
-    public override async Task Project_subquery_root_set_required_trunk_FirstOrDefault_branch(bool async)
-        => Assert.Equal(
-            SqliteStrings.ApplyNotSupported,
-            (await Assert.ThrowsAsync<InvalidOperationException>(
-                () => base.Project_subquery_root_set_required_trunk_FirstOrDefault_branch(async)))
-            .Message);
-
-    public override async Task Project_subquery_root_set_trunk_FirstOrDefault_collection(bool async)
-        => Assert.Equal(
-            SqliteStrings.ApplyNotSupported,
-            (await Assert.ThrowsAsync<InvalidOperationException>(
-                () => base.Project_subquery_root_set_trunk_FirstOrDefault_collection(async)))
-            .Message);
-}
diff --git a/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/InProjection/EntityRelationshipsInProjectionQuerySqliteTest.cs b/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/InProjection/EntityRelationshipsInProjectionQuerySqliteTest.cs
deleted file mode 100644
index a469c8be6f..0000000000
--- a/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/InProjection/EntityRelationshipsInProjectionQuerySqliteTest.cs
+++ /dev/null
@@ -1,52 +0,0 @@
-﻿// Licensed to the .NET Foundation under one or more agreements.
-// The .NET Foundation licenses this file to you under the MIT license.
-
-using Microsoft.EntityFrameworkCore.Sqlite.Internal;
-
-namespace Microsoft.EntityFrameworkCore.Query.Relationships.InProjection;
-
-public class EntityRelationshipsInProjectionQuerySqliteTest
-    : EntityRelationshipsInProjectionQueryRelationalTestBase<EntityRelationshipsQuerySqliteFixture>
-{
-    public EntityRelationshipsInProjectionQuerySqliteTest(EntityRelationshipsQuerySqliteFixture fixture, ITestOutputHelper testOutputHelper)
-        : base(fixture)
-    {
-        Fixture.TestSqlLoggerFactory.Clear();
-        Fixture.TestSqlLoggerFactory.SetTestOutputHelper(testOutputHelper);
-    }
-
-    public override async Task Project_subquery_root_set_complex_projection_FirstOrDefault_project_reference_to_outer(bool async)
-        => Assert.Equal(
-            SqliteStrings.ApplyNotSupported,
-            (await Assert.ThrowsAsync<InvalidOperationException>(
-                () => base.Project_subquery_root_set_complex_projection_FirstOrDefault_project_reference_to_outer(async)))
-            .Message);
-
-    public override async Task Project_subquery_root_set_complex_projection_including_references_to_outer_FirstOrDefault(bool async)
-        => Assert.Equal(
-            SqliteStrings.ApplyNotSupported,
-            (await Assert.ThrowsAsync<InvalidOperationException>(
-                () => base.Project_subquery_root_set_complex_projection_including_references_to_outer_FirstOrDefault(async)))
-            .Message);
-
-    public override async Task Project_subquery_root_set_optional_trunk_FirstOrDefault_branch(bool async)
-        => Assert.Equal(
-            SqliteStrings.ApplyNotSupported,
-            (await Assert.ThrowsAsync<InvalidOperationException>(
-                () => base.Project_subquery_root_set_optional_trunk_FirstOrDefault_branch(async)))
-            .Message);
-
-    public override async Task Project_subquery_root_set_required_trunk_FirstOrDefault_branch(bool async)
-        => Assert.Equal(
-            SqliteStrings.ApplyNotSupported,
-            (await Assert.ThrowsAsync<InvalidOperationException>(
-                () => base.Project_subquery_root_set_required_trunk_FirstOrDefault_branch(async)))
-            .Message);
-
-    public override async Task Project_subquery_root_set_trunk_FirstOrDefault_collection(bool async)
-        => Assert.Equal(
-            SqliteStrings.ApplyNotSupported,
-            (await Assert.ThrowsAsync<InvalidOperationException>(
-                () => base.Project_subquery_root_set_trunk_FirstOrDefault_collection(async)))
-            .Message);
-}
diff --git a/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/InProjection/JsonRelationshipsInProjectionNoTrackingQuerySqliteTest.cs b/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/InProjection/JsonRelationshipsInProjectionNoTrackingQuerySqliteTest.cs
deleted file mode 100644
index 77d9360116..0000000000
--- a/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/InProjection/JsonRelationshipsInProjectionNoTrackingQuerySqliteTest.cs
+++ /dev/null
@@ -1,254 +0,0 @@
-﻿// Licensed to the .NET Foundation under one or more agreements.
-// The .NET Foundation licenses this file to you under the MIT license.
-
-using Microsoft.EntityFrameworkCore.Sqlite.Internal;
-
-namespace Microsoft.EntityFrameworkCore.Query.Relationships.InProjection;
-
-public class JsonRelationshipsInProjectionNoTrackingQuerySqliteTest
-    : JsonRelationshipsInProjectionNoTrackingQueryRelationalTestBase<JsonRelationshipsQuerySqliteFixture>
-{
-    public JsonRelationshipsInProjectionNoTrackingQuerySqliteTest(JsonRelationshipsQuerySqliteFixture fixture, ITestOutputHelper testOutputHelper)
-        : base(fixture)
-    {
-        Fixture.TestSqlLoggerFactory.Clear();
-        Fixture.TestSqlLoggerFactory.SetTestOutputHelper(testOutputHelper);
-    }
-
-    public override async Task Project_root(bool async)
-    {
-        await base.Project_root(async);
-
-        AssertSql(
-            """
-SELECT "r"."Id", "r"."Name", "r"."OptionalReferenceTrunkId", "r"."RequiredReferenceTrunkId", "r"."CollectionTrunk", "r"."OptionalReferenceTrunk", "r"."RequiredReferenceTrunk"
-FROM "RootEntities" AS "r"
-""");
-    }
-
-    public override async Task Project_trunk_optional(bool async)
-    {
-        await base.Project_trunk_optional(async);
-
-        AssertSql(
-            """
-SELECT "r"."OptionalReferenceTrunk", "r"."Id"
-FROM "RootEntities" AS "r"
-ORDER BY "r"."Id"
-""");
-    }
-
-    public override async Task Project_trunk_required(bool async)
-    {
-        await base.Project_trunk_required(async);
-
-        AssertSql(
-            """
-SELECT "r"."RequiredReferenceTrunk", "r"."Id"
-FROM "RootEntities" AS "r"
-ORDER BY "r"."Id"
-""");
-    }
-
-    public override async Task Project_trunk_collection(bool async)
-    {
-        await base.Project_trunk_collection(async);
-
-        AssertSql(
-            """
-SELECT "r"."CollectionTrunk", "r"."Id"
-FROM "RootEntities" AS "r"
-ORDER BY "r"."Id"
-""");
-    }
-
-    public override async Task Project_branch_required_required(bool async)
-    {
-        await base.Project_branch_required_required(async);
-
-        AssertSql(
-            """
-SELECT "r"."RequiredReferenceTrunk" ->> 'RequiredReferenceBranch', "r"."Id"
-FROM "RootEntities" AS "r"
-ORDER BY "r"."Id"
-""");
-    }
-
-    public override async Task Project_branch_required_optional(bool async)
-    {
-        await base.Project_branch_required_optional(async);
-
-        AssertSql(
-            """
-SELECT "r"."RequiredReferenceTrunk" ->> 'OptionalReferenceBranch', "r"."Id"
-FROM "RootEntities" AS "r"
-ORDER BY "r"."Id"
-""");
-    }
-
-    public override async Task Project_branch_required_collection(bool async)
-    {
-        await base.Project_branch_required_collection(async);
-
-        AssertSql(
-            """
-SELECT "r"."RequiredReferenceTrunk" ->> 'CollectionBranch', "r"."Id"
-FROM "RootEntities" AS "r"
-ORDER BY "r"."Id"
-""");
-    }
-
-    public override async Task Project_branch_optional_required(bool async)
-    {
-        await base.Project_branch_optional_required(async);
-
-        AssertSql(
-            """
-SELECT "r"."RequiredReferenceTrunk" ->> 'RequiredReferenceBranch', "r"."Id"
-FROM "RootEntities" AS "r"
-ORDER BY "r"."Id"
-""");
-    }
-
-    public override async Task Project_branch_optional_optional(bool async)
-    {
-        await base.Project_branch_optional_optional(async);
-
-        AssertSql(
-            """
-SELECT "r"."RequiredReferenceTrunk" ->> 'OptionalReferenceBranch', "r"."Id"
-FROM "RootEntities" AS "r"
-ORDER BY "r"."Id"
-""");
-    }
-
-    public override async Task Project_branch_optional_collection(bool async)
-    {
-        await base.Project_branch_optional_collection(async);
-
-        AssertSql(
-            """
-SELECT "r"."RequiredReferenceTrunk" ->> 'CollectionBranch', "r"."Id"
-FROM "RootEntities" AS "r"
-ORDER BY "r"."Id"
-""");
-    }
-
-    public override async Task Project_root_duplicated(bool async)
-    {
-        await base.Project_root_duplicated(async);
-
-        AssertSql(
-            """
-SELECT "r"."Id", "r"."Name", "r"."OptionalReferenceTrunkId", "r"."RequiredReferenceTrunkId", "r"."CollectionTrunk", "r"."OptionalReferenceTrunk", "r"."RequiredReferenceTrunk", "r"."CollectionTrunk", "r"."OptionalReferenceTrunk", "r"."RequiredReferenceTrunk"
-FROM "RootEntities" AS "r"
-""");
-    }
-
-    public override async Task Project_trunk_and_branch_duplicated(bool async)
-    {
-        await base.Project_trunk_and_branch_duplicated(async);
-
-        AssertSql(
-            """
-SELECT "r"."OptionalReferenceTrunk", "r"."Id", "r"."OptionalReferenceTrunk" ->> 'RequiredReferenceBranch', "r"."OptionalReferenceTrunk", "r"."OptionalReferenceTrunk" ->> 'RequiredReferenceBranch'
-FROM "RootEntities" AS "r"
-ORDER BY "r"."Id"
-""");
-    }
-
-    public override async Task Project_trunk_and_trunk_duplicated(bool async)
-    {
-        await base.Project_trunk_and_trunk_duplicated(async);
-
-        AssertSql(
-            """
-SELECT "r"."RequiredReferenceTrunk", "r"."Id", "r"."RequiredReferenceTrunk" ->> '$.OptionalReferenceBranch.RequiredReferenceLeaf', "r"."RequiredReferenceTrunk", "r"."RequiredReferenceTrunk" ->> '$.OptionalReferenceBranch.RequiredReferenceLeaf'
-FROM "RootEntities" AS "r"
-ORDER BY "r"."Id"
-""");
-    }
-
-    public override async Task Project_multiple_branch_leaf(bool async)
-    {
-        await base.Project_multiple_branch_leaf(async);
-
-        AssertSql(
-            """
-SELECT "r"."Id", "r"."RequiredReferenceTrunk" ->> 'RequiredReferenceBranch', "r"."RequiredReferenceTrunk" ->> '$.RequiredReferenceBranch.OptionalReferenceLeaf', "r"."RequiredReferenceTrunk" ->> '$.RequiredReferenceBranch.CollectionLeaf', "r"."RequiredReferenceTrunk" ->> 'CollectionBranch', "r"."RequiredReferenceTrunk" ->> '$.RequiredReferenceBranch.OptionalReferenceLeaf.Name'
-FROM "RootEntities" AS "r"
-""");
-    }
-
-    public override async Task Project_leaf_trunk_root(bool async)
-    {
-        await base.Project_leaf_trunk_root(async);
-
-        AssertSql(
-            """
-SELECT "r"."RequiredReferenceTrunk" ->> '$.RequiredReferenceBranch.RequiredReferenceLeaf', "r"."Id", "r"."RequiredReferenceTrunk", "r"."Name", "r"."OptionalReferenceTrunkId", "r"."RequiredReferenceTrunkId", "r"."CollectionTrunk", "r"."OptionalReferenceTrunk", "r"."RequiredReferenceTrunk"
-FROM "RootEntities" AS "r"
-""");
-    }
-
-    public override async Task Project_subquery_root_set_complex_projection_FirstOrDefault_project_reference_to_outer(bool async)
-        => Assert.Equal(
-            SqliteStrings.ApplyNotSupported,
-            (await Assert.ThrowsAsync<InvalidOperationException>(
-                () => base.Project_subquery_root_set_complex_projection_FirstOrDefault_project_reference_to_outer(async)))
-            .Message);
-
-    public override async Task Project_subquery_root_set_complex_projection_including_references_to_outer_FirstOrDefault(bool async)
-        => Assert.Equal(
-            SqliteStrings.ApplyNotSupported,
-            (await Assert.ThrowsAsync<InvalidOperationException>(
-                () => base.Project_subquery_root_set_complex_projection_including_references_to_outer_FirstOrDefault(async)))
-            .Message);
-
-    public override async Task Project_subquery_root_set_optional_trunk_FirstOrDefault_branch(bool async)
-        => Assert.Equal(
-            SqliteStrings.ApplyNotSupported,
-            (await Assert.ThrowsAsync<InvalidOperationException>(
-                () => base.Project_subquery_root_set_optional_trunk_FirstOrDefault_branch(async)))
-            .Message);
-
-    public override async Task Project_subquery_root_set_required_trunk_FirstOrDefault_branch(bool async)
-        => Assert.Equal(
-            SqliteStrings.ApplyNotSupported,
-            (await Assert.ThrowsAsync<InvalidOperationException>(
-                () => base.Project_subquery_root_set_required_trunk_FirstOrDefault_branch(async)))
-            .Message);
-
-    public override async Task Project_subquery_root_set_trunk_FirstOrDefault_collection(bool async)
-        => Assert.Equal(
-            SqliteStrings.ApplyNotSupported,
-            (await Assert.ThrowsAsync<InvalidOperationException>(
-                () => base.Project_subquery_root_set_trunk_FirstOrDefault_collection(async)))
-            .Message);
-
-    public override async Task SelectMany_optional_trunk_reference_branch_collection(bool async)
-        => Assert.Equal(
-            SqliteStrings.ApplyNotSupported,
-            (await Assert.ThrowsAsync<InvalidOperationException>(
-                () => base.SelectMany_optional_trunk_reference_branch_collection(async)))
-            .Message);
-
-
-    public override async Task SelectMany_required_trunk_reference_branch_collection(bool async)
-        => Assert.Equal(
-            SqliteStrings.ApplyNotSupported,
-            (await Assert.ThrowsAsync<InvalidOperationException>(
-                () => base.SelectMany_required_trunk_reference_branch_collection(async)))
-            .Message);
-
-
-    public override async Task SelectMany_trunk_collection(bool async)
-        => Assert.Equal(
-            SqliteStrings.ApplyNotSupported,
-            (await Assert.ThrowsAsync<InvalidOperationException>(
-                () => base.SelectMany_trunk_collection(async)))
-            .Message);
-
-    private void AssertSql(params string[] expected)
-        => Fixture.TestSqlLoggerFactory.AssertBaseline(expected);
-}
diff --git a/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/InProjection/JsonRelationshipsInProjectionQuerySqliteTest.cs b/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/InProjection/JsonRelationshipsInProjectionQuerySqliteTest.cs
deleted file mode 100644
index 9345b9c0ec..0000000000
--- a/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/InProjection/JsonRelationshipsInProjectionQuerySqliteTest.cs
+++ /dev/null
@@ -1,150 +0,0 @@
-﻿// Licensed to the .NET Foundation under one or more agreements.
-// The .NET Foundation licenses this file to you under the MIT license.
-
-using Microsoft.EntityFrameworkCore.Sqlite.Internal;
-
-namespace Microsoft.EntityFrameworkCore.Query.Relationships.InProjection;
-
-public class JsonRelationshipsInProjectionQuerySqliteTest
-    : JsonRelationshipsInProjectionQueryRelationalTestBase<JsonRelationshipsQuerySqliteFixture>
-{
-    public JsonRelationshipsInProjectionQuerySqliteTest(JsonRelationshipsQuerySqliteFixture fixture, ITestOutputHelper testOutputHelper)
-        : base(fixture)
-    {
-        Fixture.TestSqlLoggerFactory.Clear();
-        Fixture.TestSqlLoggerFactory.SetTestOutputHelper(testOutputHelper);
-    }
-
-    public override async Task Project_root(bool async)
-    {
-        await base.Project_root(async);
-
-        AssertSql(
-            """
-SELECT "r"."Id", "r"."Name", "r"."OptionalReferenceTrunkId", "r"."RequiredReferenceTrunkId", "r"."CollectionTrunk", "r"."OptionalReferenceTrunk", "r"."RequiredReferenceTrunk"
-FROM "RootEntities" AS "r"
-""");
-    }
-
-    public override async Task Project_root_duplicated(bool async)
-    {
-        await base.Project_root_duplicated(async);
-
-    AssertSql(
-        """
-SELECT "r"."Id", "r"."Name", "r"."OptionalReferenceTrunkId", "r"."RequiredReferenceTrunkId", "r"."CollectionTrunk", "r"."OptionalReferenceTrunk", "r"."RequiredReferenceTrunk", "r"."CollectionTrunk", "r"."OptionalReferenceTrunk", "r"."RequiredReferenceTrunk"
-FROM "RootEntities" AS "r"
-""");
-    }
-
-    public override Task Project_trunk_optional(bool async)
-        => AssertCantTrackJson(() => base.Project_trunk_optional(async));
-
-    public override Task Project_trunk_required(bool async)
-        => AssertCantTrackJson(() => base.Project_trunk_required(async));
-
-    public override Task Project_trunk_collection(bool async)
-        => AssertCantTrackJson(() => base.Project_trunk_collection(async));
-
-    public override Task Project_branch_required_required(bool async)
-        => AssertCantTrackJson(() => base.Project_branch_required_required(async));
-
-    public override Task Project_branch_required_optional(bool async)
-        => AssertCantTrackJson(() => base.Project_branch_required_optional(async));
-
-    public override Task Project_branch_required_collection(bool async)
-        => AssertCantTrackJson(() => base.Project_branch_required_collection(async));
-
-    public override  Task Project_branch_optional_required(bool async)
-        => AssertCantTrackJson(() => base.Project_branch_optional_required(async));
-
-    public override Task Project_branch_optional_optional(bool async)
-        => AssertCantTrackJson(() => base.Project_branch_optional_optional(async));
-
-    public override Task Project_branch_optional_collection(bool async)
-        => AssertCantTrackJson(() => base.Project_branch_optional_collection(async));
-
-    public override Task Project_branch_collection_element_using_indexer_constant(bool async)
-        => AssertCantTrackJson(() => base.Project_branch_collection_element_using_indexer_constant(async));
-
-    public override Task Project_leaf_trunk_root(bool async)
-        => AssertCantTrackJson(() => base.Project_leaf_trunk_root(async));
-
-    public override Task Project_multiple_branch_leaf(bool async)
-        => AssertCantTrackJson(() => base.Project_multiple_branch_leaf(async));
-
-    public override Task Project_trunk_and_branch_duplicated(bool async)
-        => AssertCantTrackJson(() => base.Project_trunk_and_branch_duplicated(async));
-
-    public override Task Project_trunk_and_trunk_duplicated(bool async)
-        => AssertCantTrackJson(() => base.Project_trunk_and_trunk_duplicated(async));
-
-    public override async Task Project_subquery_root_set_complex_projection_FirstOrDefault_project_reference_to_outer(bool async)
-        => Assert.Equal(
-            SqliteStrings.ApplyNotSupported,
-            (await Assert.ThrowsAsync<InvalidOperationException>(
-                () => base.Project_subquery_root_set_complex_projection_FirstOrDefault_project_reference_to_outer(async)))
-            .Message);
-
-    public override async Task Project_subquery_root_set_complex_projection_including_references_to_outer_FirstOrDefault(bool async)
-        => Assert.Equal(
-            SqliteStrings.ApplyNotSupported,
-            (await Assert.ThrowsAsync<InvalidOperationException>(
-                () => base.Project_subquery_root_set_complex_projection_including_references_to_outer_FirstOrDefault(async)))
-            .Message);
-
-    public override async Task Project_subquery_root_set_optional_trunk_FirstOrDefault_branch(bool async)
-        => Assert.Equal(
-            SqliteStrings.ApplyNotSupported,
-            (await Assert.ThrowsAsync<InvalidOperationException>(
-                () => base.Project_subquery_root_set_optional_trunk_FirstOrDefault_branch(async)))
-            .Message);
-
-    public override async Task Project_subquery_root_set_required_trunk_FirstOrDefault_branch(bool async)
-        => Assert.Equal(
-            SqliteStrings.ApplyNotSupported,
-            (await Assert.ThrowsAsync<InvalidOperationException>(
-                () => base.Project_subquery_root_set_required_trunk_FirstOrDefault_branch(async)))
-            .Message);
-
-    public override async Task Project_subquery_root_set_trunk_FirstOrDefault_collection(bool async)
-        => Assert.Equal(
-            SqliteStrings.ApplyNotSupported,
-            (await Assert.ThrowsAsync<InvalidOperationException>(
-                () => base.Project_subquery_root_set_trunk_FirstOrDefault_collection(async)))
-            .Message);
-
-    public override async Task SelectMany_optional_trunk_reference_branch_collection(bool async)
-        => Assert.Equal(
-            SqliteStrings.ApplyNotSupported,
-            (await Assert.ThrowsAsync<InvalidOperationException>(
-                () => base.SelectMany_optional_trunk_reference_branch_collection(async)))
-            .Message);
-
-
-    public override async Task SelectMany_required_trunk_reference_branch_collection(bool async)
-        => Assert.Equal(
-            SqliteStrings.ApplyNotSupported,
-            (await Assert.ThrowsAsync<InvalidOperationException>(
-                () => base.SelectMany_required_trunk_reference_branch_collection(async)))
-            .Message);
-
-
-    public override async Task SelectMany_trunk_collection(bool async)
-        => Assert.Equal(
-            SqliteStrings.ApplyNotSupported,
-            (await Assert.ThrowsAsync<InvalidOperationException>(
-                () => base.SelectMany_trunk_collection(async)))
-            .Message);
-
-    private async Task AssertCantTrackJson(Func<Task> test)
-    {
-        var message = (await Assert.ThrowsAsync<InvalidOperationException>(test)).Message;
-
-        Assert.Equal(RelationalStrings.JsonEntityOrCollectionProjectedAtRootLevelInTrackingQuery("AsNoTracking"), message);
-        AssertSql();
-    }
-
-    private void AssertSql(params string[] expected)
-        => Fixture.TestSqlLoggerFactory.AssertBaseline(expected);
-}
diff --git a/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/InProjection/OwnedRelationshipsInProjectionNoTrackingQuerySqliteTest.cs b/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/InProjection/OwnedRelationshipsInProjectionNoTrackingQuerySqliteTest.cs
deleted file mode 100644
index e290a4d704..0000000000
--- a/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/InProjection/OwnedRelationshipsInProjectionNoTrackingQuerySqliteTest.cs
+++ /dev/null
@@ -1,107 +0,0 @@
-﻿// Licensed to the .NET Foundation under one or more agreements.
-// The .NET Foundation licenses this file to you under the MIT license.
-
-namespace Microsoft.EntityFrameworkCore.Query.Relationships.InProjection;
-
-public class OwnedRelationshipsInProjectionNoTrackingQuerySqliteTest
-    : OwnedRelationshipsInProjectionNoTrackingQueryRelationalTestBase<OwnedRelationshipsQuerySqliteFixture>
-{
-    public OwnedRelationshipsInProjectionNoTrackingQuerySqliteTest(OwnedRelationshipsQuerySqliteFixture fixture, ITestOutputHelper testOutputHelper)
-        : base(fixture)
-    {
-        Fixture.TestSqlLoggerFactory.Clear();
-        Fixture.TestSqlLoggerFactory.SetTestOutputHelper(testOutputHelper);
-    }
-
-    [ConditionalTheory(Skip = "issue 26708")]
-    public override Task Project_root(bool async)
-        => base.Project_root(async);
-
-    [ConditionalTheory(Skip = "issue 26708")]
-    public override Task Project_trunk_optional(bool async)
-        => base.Project_trunk_optional(async);
-
-    [ConditionalTheory(Skip = "issue 26708")]
-    public override Task Project_trunk_required(bool async)
-        => base.Project_trunk_required(async);
-
-    [ConditionalTheory(Skip = "issue 26708")]
-    public override Task Project_trunk_collection(bool async)
-        => base.Project_trunk_collection(async);
-
-    [ConditionalTheory(Skip = "issue 26708")]
-    public override Task Project_branch_required_required(bool async)
-        => base.Project_branch_required_required(async);
-
-    [ConditionalTheory(Skip = "issue 26708")]
-    public override Task Project_branch_required_optional(bool async)
-        => base.Project_branch_required_optional(async);
-
-    [ConditionalTheory(Skip = "issue 26708")]
-    public override Task Project_branch_required_collection(bool async)
-        => base.Project_branch_required_collection(async);
-
-    [ConditionalTheory(Skip = "issue 26708")]
-    public override Task Project_branch_optional_required(bool async)
-        => base.Project_branch_optional_required(async);
-
-    [ConditionalTheory(Skip = "issue 26708")]
-    public override Task Project_branch_optional_optional(bool async)
-        => base.Project_branch_optional_optional(async);
-
-    [ConditionalTheory(Skip = "issue 26708")]
-    public override Task Project_branch_optional_collection(bool async)
-        => base.Project_branch_optional_collection(async);
-
-    [ConditionalTheory(Skip = "issue 26708")]
-    public override Task Project_root_duplicated(bool async)
-        => base.Project_root_duplicated(async);
-
-    [ConditionalTheory(Skip = "issue 26708")]
-    public override Task Project_trunk_and_branch_duplicated(bool async)
-        => base.Project_trunk_and_branch_duplicated(async);
-
-    [ConditionalTheory(Skip = "issue 26708")]
-    public override Task Project_trunk_and_trunk_duplicated(bool async)
-        => base.Project_trunk_and_trunk_duplicated(async);
-
-    [ConditionalTheory(Skip = "issue 26708")]
-    public override Task Project_multiple_branch_leaf(bool async)
-        => base.Project_multiple_branch_leaf(async);
-
-    [ConditionalTheory(Skip = "issue 26708")]
-    public override Task Project_leaf_trunk_root(bool async)
-        => base.Project_leaf_trunk_root(async);
-
-    [ConditionalTheory(Skip = "issue 26708")]
-    public override Task Project_subquery_root_set_required_trunk_FirstOrDefault_branch(bool async)
-        => base.Project_subquery_root_set_required_trunk_FirstOrDefault_branch(async);
-
-    [ConditionalTheory(Skip = "issue 26708")]
-    public override Task Project_subquery_root_set_optional_trunk_FirstOrDefault_branch(bool async)
-        => base.Project_subquery_root_set_optional_trunk_FirstOrDefault_branch(async);
-
-    [ConditionalTheory(Skip = "issue 26708")]
-    public override Task Project_subquery_root_set_trunk_FirstOrDefault_collection(bool async)
-        => base.Project_subquery_root_set_trunk_FirstOrDefault_collection(async);
-
-    [ConditionalTheory(Skip = "issue 26708")]
-    public override Task Project_subquery_root_set_complex_projection_including_references_to_outer_FirstOrDefault(bool async)
-        => base.Project_subquery_root_set_complex_projection_including_references_to_outer_FirstOrDefault(async);
-
-    [ConditionalTheory(Skip = "issue 26708")]
-    public override Task Project_subquery_root_set_complex_projection_FirstOrDefault_project_reference_to_outer(bool async)
-        => base.Project_subquery_root_set_complex_projection_FirstOrDefault_project_reference_to_outer(async);
-
-    [ConditionalTheory(Skip = "issue 26708")]
-    public override Task SelectMany_trunk_collection(bool async)
-        => base.SelectMany_trunk_collection(async);
-
-    [ConditionalTheory(Skip = "issue 26708")]
-    public override Task SelectMany_required_trunk_reference_branch_collection(bool async)
-        => base.SelectMany_required_trunk_reference_branch_collection(async);
-
-    [ConditionalTheory(Skip = "issue 26708")]
-    public override Task SelectMany_optional_trunk_reference_branch_collection(bool async)
-        => base.SelectMany_optional_trunk_reference_branch_collection(async);
-}
diff --git a/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/InProjection/OwnedRelationshipsInProjectionQuerySqliteTest.cs b/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/InProjection/OwnedRelationshipsInProjectionQuerySqliteTest.cs
deleted file mode 100644
index bb3c608242..0000000000
--- a/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/InProjection/OwnedRelationshipsInProjectionQuerySqliteTest.cs
+++ /dev/null
@@ -1,107 +0,0 @@
-﻿// Licensed to the .NET Foundation under one or more agreements.
-// The .NET Foundation licenses this file to you under the MIT license.
-
-namespace Microsoft.EntityFrameworkCore.Query.Relationships.InProjection;
-
-public class OwnedRelationshipsInProjectionQuerySqliteTest
-    : OwnedRelationshipsInProjectionQueryRelationalTestBase<OwnedRelationshipsQuerySqliteFixture>
-{
-    public OwnedRelationshipsInProjectionQuerySqliteTest(OwnedRelationshipsQuerySqliteFixture fixture, ITestOutputHelper testOutputHelper)
-        : base(fixture)
-    {
-        Fixture.TestSqlLoggerFactory.Clear();
-        Fixture.TestSqlLoggerFactory.SetTestOutputHelper(testOutputHelper);
-    }
-
-    [ConditionalTheory(Skip = "issue 26708")]
-    public override Task Project_root(bool async)
-        => base.Project_root(async);
-
-    [ConditionalTheory(Skip = "issue 26708")]
-    public override Task Project_trunk_optional(bool async)
-        => base.Project_trunk_optional(async);
-
-    [ConditionalTheory(Skip = "issue 26708")]
-    public override Task Project_trunk_required(bool async)
-        => base.Project_trunk_required(async);
-
-    [ConditionalTheory(Skip = "issue 26708")]
-    public override Task Project_trunk_collection(bool async)
-        => base.Project_trunk_collection(async);
-
-    [ConditionalTheory(Skip = "issue 26708")]
-    public override Task Project_branch_required_required(bool async)
-        => base.Project_branch_required_required(async);
-
-    [ConditionalTheory(Skip = "issue 26708")]
-    public override Task Project_branch_required_optional(bool async)
-        => base.Project_branch_required_optional(async);
-
-    [ConditionalTheory(Skip = "issue 26708")]
-    public override Task Project_branch_required_collection(bool async)
-        => base.Project_branch_required_collection(async);
-
-    [ConditionalTheory(Skip = "issue 26708")]
-    public override Task Project_branch_optional_required(bool async)
-        => base.Project_branch_optional_required(async);
-
-    [ConditionalTheory(Skip = "issue 26708")]
-    public override Task Project_branch_optional_optional(bool async)
-        => base.Project_branch_optional_optional(async);
-
-    [ConditionalTheory(Skip = "issue 26708")]
-    public override Task Project_branch_optional_collection(bool async)
-        => base.Project_branch_optional_collection(async);
-
-    [ConditionalTheory(Skip = "issue 26708")]
-    public override Task Project_root_duplicated(bool async)
-        => base.Project_root_duplicated(async);
-
-    [ConditionalTheory(Skip = "issue 26708")]
-    public override Task Project_trunk_and_branch_duplicated(bool async)
-        => base.Project_trunk_and_branch_duplicated(async);
-
-    [ConditionalTheory(Skip = "issue 26708")]
-    public override Task Project_trunk_and_trunk_duplicated(bool async)
-        => base.Project_trunk_and_trunk_duplicated(async);
-
-    [ConditionalTheory(Skip = "issue 26708")]
-    public override Task Project_multiple_branch_leaf(bool async)
-        => base.Project_multiple_branch_leaf(async);
-
-    [ConditionalTheory(Skip = "issue 26708")]
-    public override Task Project_leaf_trunk_root(bool async)
-        => base.Project_leaf_trunk_root(async);
-
-    [ConditionalTheory(Skip = "issue 26708")]
-    public override Task Project_subquery_root_set_required_trunk_FirstOrDefault_branch(bool async)
-        => base.Project_subquery_root_set_required_trunk_FirstOrDefault_branch(async);
-
-    [ConditionalTheory(Skip = "issue 26708")]
-    public override Task Project_subquery_root_set_optional_trunk_FirstOrDefault_branch(bool async)
-        => base.Project_subquery_root_set_optional_trunk_FirstOrDefault_branch(async);
-
-    [ConditionalTheory(Skip = "issue 26708")]
-    public override Task Project_subquery_root_set_trunk_FirstOrDefault_collection(bool async)
-        => base.Project_subquery_root_set_trunk_FirstOrDefault_collection(async);
-
-    [ConditionalTheory(Skip = "issue 26708")]
-    public override Task Project_subquery_root_set_complex_projection_including_references_to_outer_FirstOrDefault(bool async)
-        => base.Project_subquery_root_set_complex_projection_including_references_to_outer_FirstOrDefault(async);
-
-    [ConditionalTheory(Skip = "issue 26708")]
-    public override Task Project_subquery_root_set_complex_projection_FirstOrDefault_project_reference_to_outer(bool async)
-        => base.Project_subquery_root_set_complex_projection_FirstOrDefault_project_reference_to_outer(async);
-
-    [ConditionalTheory(Skip = "issue 26708")]
-    public override Task SelectMany_trunk_collection(bool async)
-        => base.SelectMany_trunk_collection(async);
-
-    [ConditionalTheory(Skip = "issue 26708")]
-    public override Task SelectMany_required_trunk_reference_branch_collection(bool async)
-        => base.SelectMany_required_trunk_reference_branch_collection(async);
-
-    [ConditionalTheory(Skip = "issue 26708")]
-    public override Task SelectMany_optional_trunk_reference_branch_collection(bool async)
-        => base.SelectMany_optional_trunk_reference_branch_collection(async);
-}
diff --git a/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/Include/EntityRelationshipsIncludeQuerySqliteTest.cs b/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/Include/NavigationIncludeSqliteTest.cs
similarity index 56%
rename from test/EFCore.Sqlite.FunctionalTests/Query/Relationships/Include/EntityRelationshipsIncludeQuerySqliteTest.cs
rename to test/EFCore.Sqlite.FunctionalTests/Query/Relationships/Include/NavigationIncludeSqliteTest.cs
index 6215b08395..7e0896d0b4 100644
--- a/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/Include/EntityRelationshipsIncludeQuerySqliteTest.cs
+++ b/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/Include/NavigationIncludeSqliteTest.cs
@@ -3,10 +3,10 @@
 
 namespace Microsoft.EntityFrameworkCore.Query.Relationships.Include;
 
-public class EntityRelationshipsIncludeQuerySqliteTest
-    : EntityRelationshipsIncludeQueryRelationalTestBase<EntityRelationshipsQuerySqliteFixture>
+public class NavigationIncludeSqliteTest
+    : NavigationIncludeRelationalTestBase<NavigationRelationshipsSqliteFixture>
 {
-    public EntityRelationshipsIncludeQuerySqliteTest(EntityRelationshipsQuerySqliteFixture fixture, ITestOutputHelper testOutputHelper)
+    public NavigationIncludeSqliteTest(NavigationRelationshipsSqliteFixture fixture, ITestOutputHelper testOutputHelper)
         : base(fixture)
     {
         Fixture.TestSqlLoggerFactory.Clear();
diff --git a/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/EntityRelationshipsQuerySqliteFixture.cs b/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/NavigationRelationshipsSqliteFixture.cs
similarity index 77%
rename from test/EFCore.Sqlite.FunctionalTests/Query/Relationships/EntityRelationshipsQuerySqliteFixture.cs
rename to test/EFCore.Sqlite.FunctionalTests/Query/Relationships/NavigationRelationshipsSqliteFixture.cs
index f322b0ae77..54f04a6627 100644
--- a/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/EntityRelationshipsQuerySqliteFixture.cs
+++ b/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/NavigationRelationshipsSqliteFixture.cs
@@ -3,7 +3,7 @@
 
 namespace Microsoft.EntityFrameworkCore.Query.Relationships;
 
-public class EntityRelationshipsQuerySqliteFixture : EntityRelationshipsQueryRelationalFixtureBase, ITestSqlLoggerFactory
+public class NavigationRelationshipsSqliteFixture : NavigationRelationshipsRelationalFixtureBase, ITestSqlLoggerFactory
 {
     protected override ITestStoreFactory TestStoreFactory
         => SqliteTestStoreFactory.Instance;
diff --git a/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/ComplexRelationshipsQuerySqliteFixture.cs b/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/OwnedJsonRelationshipsSqliteFixture.cs
similarity index 76%
rename from test/EFCore.Sqlite.FunctionalTests/Query/Relationships/ComplexRelationshipsQuerySqliteFixture.cs
rename to test/EFCore.Sqlite.FunctionalTests/Query/Relationships/OwnedJsonRelationshipsSqliteFixture.cs
index 0da93356f1..fb692c7111 100644
--- a/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/ComplexRelationshipsQuerySqliteFixture.cs
+++ b/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/OwnedJsonRelationshipsSqliteFixture.cs
@@ -3,7 +3,7 @@
 
 namespace Microsoft.EntityFrameworkCore.Query.Relationships;
 
-public class ComplexRelationshipsQuerySqliteFixture : ComplexRelationshipsQueryRelationalFixtureBase, ITestSqlLoggerFactory
+public class OwnedJsonRelationshipsSqliteFixture : OwnedJsonRelationshipsRelationalFixtureBase, ITestSqlLoggerFactory
 {
     protected override ITestStoreFactory TestStoreFactory
         => SqliteTestStoreFactory.Instance;
diff --git a/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/OwnedRelationshipsQuerySqliteFixture.cs b/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/OwnedRelationshipsSqliteFixture.cs
similarity index 83%
rename from test/EFCore.Sqlite.FunctionalTests/Query/Relationships/OwnedRelationshipsQuerySqliteFixture.cs
rename to test/EFCore.Sqlite.FunctionalTests/Query/Relationships/OwnedRelationshipsSqliteFixture.cs
index 733591a11a..7015a6ff4d 100644
--- a/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/OwnedRelationshipsQuerySqliteFixture.cs
+++ b/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/OwnedRelationshipsSqliteFixture.cs
@@ -4,7 +4,7 @@
 
 namespace Microsoft.EntityFrameworkCore.Query.Relationships;
 
-public class OwnedRelationshipsQuerySqliteFixture : OwnedRelationshipsQueryRelationalFixtureBase, ITestSqlLoggerFactory
+public class OwnedRelationshipsSqliteFixture : OwnedRelationshipsRelationalFixtureBase, ITestSqlLoggerFactory
 {
     protected override ITestStoreFactory TestStoreFactory
         => SqliteTestStoreFactory.Instance;
diff --git a/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/OwnedTableSplittingRelationshipsSqliteFixture.cs b/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/OwnedTableSplittingRelationshipsSqliteFixture.cs
new file mode 100644
index 0000000000..dac7a91434
--- /dev/null
+++ b/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/OwnedTableSplittingRelationshipsSqliteFixture.cs
@@ -0,0 +1,16 @@
+﻿// Licensed to the .NET Foundation under one or more agreements.
+// The .NET Foundation licenses this file to you under the MIT license.
+
+namespace Microsoft.EntityFrameworkCore.Query.Relationships;
+
+public class OwnedTableSplittingRelationshipsSqliteFixture : OwnedTableSplittingRelationshipsRelationalFixtureBase, ITestSqlLoggerFactory
+{
+    protected override ITestStoreFactory TestStoreFactory
+        => SqliteTestStoreFactory.Instance;
+
+    public TestSqlLoggerFactory TestSqlLoggerFactory
+        => (TestSqlLoggerFactory)ListLoggerFactory;
+
+    public override DbContextOptionsBuilder AddOptions(DbContextOptionsBuilder builder)
+        => base.AddOptions(builder.ConfigureWarnings(b => b.Ignore(SqliteEventId.CompositeKeyWithValueGeneration)));
+}
diff --git a/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/Projection/ComplexNoTrackingProjectionSqliteTest.cs b/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/Projection/ComplexNoTrackingProjectionSqliteTest.cs
new file mode 100644
index 0000000000..20c2ab9892
--- /dev/null
+++ b/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/Projection/ComplexNoTrackingProjectionSqliteTest.cs
@@ -0,0 +1,15 @@
+﻿// Licensed to the .NET Foundation under one or more agreements.
+// The .NET Foundation licenses this file to you under the MIT license.
+
+namespace Microsoft.EntityFrameworkCore.Query.Relationships.Projection;
+
+public class ComplexNoTrackingProjectionSqliteTest
+    : ComplexNoTrackingProjectionRelationalTestBase<ComplexRelationshipsSqliteFixture>
+{
+    public ComplexNoTrackingProjectionSqliteTest(ComplexRelationshipsSqliteFixture fixture, ITestOutputHelper testOutputHelper)
+        : base(fixture)
+    {
+        Fixture.TestSqlLoggerFactory.Clear();
+        Fixture.TestSqlLoggerFactory.SetTestOutputHelper(testOutputHelper);
+    }
+}
diff --git a/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/Projection/ComplexProjectionSqliteTest.cs b/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/Projection/ComplexProjectionSqliteTest.cs
new file mode 100644
index 0000000000..9f4eeb9c8e
--- /dev/null
+++ b/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/Projection/ComplexProjectionSqliteTest.cs
@@ -0,0 +1,15 @@
+﻿// Licensed to the .NET Foundation under one or more agreements.
+// The .NET Foundation licenses this file to you under the MIT license.
+
+namespace Microsoft.EntityFrameworkCore.Query.Relationships.Projection;
+
+public class ComplexProjectionSqliteTest
+    : ComplexProjectionRelationalTestBase<ComplexRelationshipsSqliteFixture>
+{
+    public ComplexProjectionSqliteTest(ComplexRelationshipsSqliteFixture fixture, ITestOutputHelper testOutputHelper)
+        : base(fixture)
+    {
+        Fixture.TestSqlLoggerFactory.Clear();
+        Fixture.TestSqlLoggerFactory.SetTestOutputHelper(testOutputHelper);
+    }
+}
diff --git a/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/Projection/NavigationNoTrackingProjectionSqliteTest.cs b/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/Projection/NavigationNoTrackingProjectionSqliteTest.cs
new file mode 100644
index 0000000000..c2eb5c7a7f
--- /dev/null
+++ b/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/Projection/NavigationNoTrackingProjectionSqliteTest.cs
@@ -0,0 +1,38 @@
+﻿// Licensed to the .NET Foundation under one or more agreements.
+// The .NET Foundation licenses this file to you under the MIT license.
+
+using Microsoft.EntityFrameworkCore.Sqlite.Internal;
+
+namespace Microsoft.EntityFrameworkCore.Query.Relationships.Projection;
+
+public class NavigationNoTrackingProjectionSqliteTest
+    : NavigationNoTrackingProjectionRelationalTestBase<NavigationRelationshipsSqliteFixture>
+{
+    public NavigationNoTrackingProjectionSqliteTest(NavigationRelationshipsSqliteFixture fixture, ITestOutputHelper testOutputHelper)
+        : base(fixture)
+    {
+        Fixture.TestSqlLoggerFactory.Clear();
+        Fixture.TestSqlLoggerFactory.SetTestOutputHelper(testOutputHelper);
+    }
+
+    public override async Task Select_subquery_root_set_complex_projection_FirstOrDefault_project_reference_to_outer(bool async)
+        => Assert.Equal(
+            SqliteStrings.ApplyNotSupported,
+            (await Assert.ThrowsAsync<InvalidOperationException>(
+                () => base.Select_subquery_root_set_complex_projection_FirstOrDefault_project_reference_to_outer(async)))
+            .Message);
+
+    public override async Task Select_subquery_root_set_complex_projection_including_references_to_outer_FirstOrDefault(bool async)
+        => Assert.Equal(
+            SqliteStrings.ApplyNotSupported,
+            (await Assert.ThrowsAsync<InvalidOperationException>(
+                () => base.Select_subquery_root_set_complex_projection_including_references_to_outer_FirstOrDefault(async)))
+            .Message);
+
+    public override async Task Select_subquery_root_set_trunk_FirstOrDefault_collection(bool async)
+        => Assert.Equal(
+            SqliteStrings.ApplyNotSupported,
+            (await Assert.ThrowsAsync<InvalidOperationException>(
+                () => base.Select_subquery_root_set_trunk_FirstOrDefault_collection(async)))
+            .Message);
+}
diff --git a/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/Projection/NavigationProjectionSqliteTest.cs b/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/Projection/NavigationProjectionSqliteTest.cs
new file mode 100644
index 0000000000..c2cc4657d1
--- /dev/null
+++ b/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/Projection/NavigationProjectionSqliteTest.cs
@@ -0,0 +1,38 @@
+﻿// Licensed to the .NET Foundation under one or more agreements.
+// The .NET Foundation licenses this file to you under the MIT license.
+
+using Microsoft.EntityFrameworkCore.Sqlite.Internal;
+
+namespace Microsoft.EntityFrameworkCore.Query.Relationships.Projection;
+
+public class NavigationProjectionSqliteTest
+    : NavigationProjectionRelationalTestBase<NavigationRelationshipsSqliteFixture>
+{
+    public NavigationProjectionSqliteTest(NavigationRelationshipsSqliteFixture fixture, ITestOutputHelper testOutputHelper)
+        : base(fixture)
+    {
+        Fixture.TestSqlLoggerFactory.Clear();
+        Fixture.TestSqlLoggerFactory.SetTestOutputHelper(testOutputHelper);
+    }
+
+    public override async Task Select_subquery_root_set_complex_projection_FirstOrDefault_project_reference_to_outer(bool async)
+        => Assert.Equal(
+            SqliteStrings.ApplyNotSupported,
+            (await Assert.ThrowsAsync<InvalidOperationException>(
+                () => base.Select_subquery_root_set_complex_projection_FirstOrDefault_project_reference_to_outer(async)))
+            .Message);
+
+    public override async Task Select_subquery_root_set_complex_projection_including_references_to_outer_FirstOrDefault(bool async)
+        => Assert.Equal(
+            SqliteStrings.ApplyNotSupported,
+            (await Assert.ThrowsAsync<InvalidOperationException>(
+                () => base.Select_subquery_root_set_complex_projection_including_references_to_outer_FirstOrDefault(async)))
+            .Message);
+
+    public override async Task Select_subquery_root_set_trunk_FirstOrDefault_collection(bool async)
+        => Assert.Equal(
+            SqliteStrings.ApplyNotSupported,
+            (await Assert.ThrowsAsync<InvalidOperationException>(
+                () => base.Select_subquery_root_set_trunk_FirstOrDefault_collection(async)))
+            .Message);
+}
diff --git a/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/Projection/NavigationReferenceNoTrackingProjectionSqliteTest.cs b/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/Projection/NavigationReferenceNoTrackingProjectionSqliteTest.cs
new file mode 100644
index 0000000000..2e65e6cbab
--- /dev/null
+++ b/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/Projection/NavigationReferenceNoTrackingProjectionSqliteTest.cs
@@ -0,0 +1,31 @@
+﻿// Licensed to the .NET Foundation under one or more agreements.
+// The .NET Foundation licenses this file to you under the MIT license.
+
+using Microsoft.EntityFrameworkCore.Sqlite.Internal;
+
+namespace Microsoft.EntityFrameworkCore.Query.Relationships.Projection;
+
+public class NavigationReferenceNoTrackingProjectionSqliteTest
+    : NavigationReferenceNoTrackingProjectionRelationalTestBase<NavigationRelationshipsSqliteFixture>
+{
+    public NavigationReferenceNoTrackingProjectionSqliteTest(NavigationRelationshipsSqliteFixture fixture, ITestOutputHelper testOutputHelper)
+        : base(fixture)
+    {
+        Fixture.TestSqlLoggerFactory.Clear();
+        Fixture.TestSqlLoggerFactory.SetTestOutputHelper(testOutputHelper);
+    }
+
+    public override async Task Select_subquery_root_set_optional_trunk_FirstOrDefault_branch(bool async)
+        => Assert.Equal(
+            SqliteStrings.ApplyNotSupported,
+            (await Assert.ThrowsAsync<InvalidOperationException>(
+                () => base.Select_subquery_root_set_optional_trunk_FirstOrDefault_branch(async)))
+            .Message);
+
+    public override async Task Select_subquery_root_set_required_trunk_FirstOrDefault_branch(bool async)
+        => Assert.Equal(
+            SqliteStrings.ApplyNotSupported,
+            (await Assert.ThrowsAsync<InvalidOperationException>(
+                () => base.Select_subquery_root_set_required_trunk_FirstOrDefault_branch(async)))
+            .Message);
+}
diff --git a/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/Projection/NavigationReferenceProjectionSqliteTest.cs b/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/Projection/NavigationReferenceProjectionSqliteTest.cs
new file mode 100644
index 0000000000..71fa016f66
--- /dev/null
+++ b/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/Projection/NavigationReferenceProjectionSqliteTest.cs
@@ -0,0 +1,31 @@
+﻿// Licensed to the .NET Foundation under one or more agreements.
+// The .NET Foundation licenses this file to you under the MIT license.
+
+using Microsoft.EntityFrameworkCore.Sqlite.Internal;
+
+namespace Microsoft.EntityFrameworkCore.Query.Relationships.Projection;
+
+public class NavigationReferenceProjectionSqliteTest
+    : NavigationReferenceProjectionRelationalTestBase<NavigationRelationshipsSqliteFixture>
+{
+    public NavigationReferenceProjectionSqliteTest(NavigationRelationshipsSqliteFixture fixture, ITestOutputHelper testOutputHelper)
+        : base(fixture)
+    {
+        Fixture.TestSqlLoggerFactory.Clear();
+        Fixture.TestSqlLoggerFactory.SetTestOutputHelper(testOutputHelper);
+    }
+
+    public override async Task Select_subquery_root_set_optional_trunk_FirstOrDefault_branch(bool async)
+        => Assert.Equal(
+            SqliteStrings.ApplyNotSupported,
+            (await Assert.ThrowsAsync<InvalidOperationException>(
+                () => base.Select_subquery_root_set_optional_trunk_FirstOrDefault_branch(async)))
+            .Message);
+
+    public override async Task Select_subquery_root_set_required_trunk_FirstOrDefault_branch(bool async)
+        => Assert.Equal(
+            SqliteStrings.ApplyNotSupported,
+            (await Assert.ThrowsAsync<InvalidOperationException>(
+                () => base.Select_subquery_root_set_required_trunk_FirstOrDefault_branch(async)))
+            .Message);
+}
diff --git a/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/Projection/OwnedJsonNoTrackingProjectionSqliteTest.cs b/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/Projection/OwnedJsonNoTrackingProjectionSqliteTest.cs
new file mode 100644
index 0000000000..c2742daecf
--- /dev/null
+++ b/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/Projection/OwnedJsonNoTrackingProjectionSqliteTest.cs
@@ -0,0 +1,109 @@
+﻿// Licensed to the .NET Foundation under one or more agreements.
+// The .NET Foundation licenses this file to you under the MIT license.
+
+using Microsoft.EntityFrameworkCore.Sqlite.Internal;
+
+namespace Microsoft.EntityFrameworkCore.Query.Relationships.Projection;
+
+public class OwnedJsonNoTrackingProjectionSqliteTest
+    : OwnedJsonNoTrackingProjectionRelationalTestBase<OwnedJsonRelationshipsSqliteFixture>
+{
+    public OwnedJsonNoTrackingProjectionSqliteTest(OwnedJsonRelationshipsSqliteFixture fixture, ITestOutputHelper testOutputHelper)
+        : base(fixture)
+    {
+        Fixture.TestSqlLoggerFactory.Clear();
+        Fixture.TestSqlLoggerFactory.SetTestOutputHelper(testOutputHelper);
+    }
+
+    public override async Task Select_trunk_collection(bool async)
+    {
+        await base.Select_trunk_collection(async);
+
+        AssertSql(
+            """
+SELECT "r"."CollectionTrunk", "r"."Id"
+FROM "RootEntities" AS "r"
+ORDER BY "r"."Id"
+""");
+    }
+
+    public override async Task Select_branch_required_collection(bool async)
+    {
+        await base.Select_branch_required_collection(async);
+
+        AssertSql(
+            """
+SELECT "r"."RequiredReferenceTrunk" ->> 'CollectionBranch', "r"."Id"
+FROM "RootEntities" AS "r"
+ORDER BY "r"."Id"
+""");
+    }
+
+    public override async Task Select_branch_optional_collection(bool async)
+    {
+        await base.Select_branch_optional_collection(async);
+
+        AssertSql(
+            """
+SELECT "r"."RequiredReferenceTrunk" ->> 'CollectionBranch', "r"."Id"
+FROM "RootEntities" AS "r"
+ORDER BY "r"."Id"
+""");
+    }
+
+    public override async Task Select_multiple_branch_leaf(bool async)
+    {
+        await base.Select_multiple_branch_leaf(async);
+
+        AssertSql(
+            """
+SELECT "r"."Id", "r"."RequiredReferenceTrunk" ->> 'RequiredReferenceBranch', "r"."RequiredReferenceTrunk" ->> '$.RequiredReferenceBranch.OptionalReferenceLeaf', "r"."RequiredReferenceTrunk" ->> '$.RequiredReferenceBranch.CollectionLeaf', "r"."RequiredReferenceTrunk" ->> 'CollectionBranch', "r"."RequiredReferenceTrunk" ->> '$.RequiredReferenceBranch.OptionalReferenceLeaf.Name'
+FROM "RootEntities" AS "r"
+""");
+    }
+
+    public override async Task Select_subquery_root_set_complex_projection_FirstOrDefault_project_reference_to_outer(bool async)
+        => Assert.Equal(
+            SqliteStrings.ApplyNotSupported,
+            (await Assert.ThrowsAsync<InvalidOperationException>(
+                () => base.Select_subquery_root_set_complex_projection_FirstOrDefault_project_reference_to_outer(async)))
+            .Message);
+
+    public override async Task Select_subquery_root_set_complex_projection_including_references_to_outer_FirstOrDefault(bool async)
+        => Assert.Equal(
+            SqliteStrings.ApplyNotSupported,
+            (await Assert.ThrowsAsync<InvalidOperationException>(
+                () => base.Select_subquery_root_set_complex_projection_including_references_to_outer_FirstOrDefault(async)))
+            .Message);
+
+    public override async Task Select_subquery_root_set_trunk_FirstOrDefault_collection(bool async)
+        => Assert.Equal(
+            SqliteStrings.ApplyNotSupported,
+            (await Assert.ThrowsAsync<InvalidOperationException>(
+                () => base.Select_subquery_root_set_trunk_FirstOrDefault_collection(async)))
+            .Message);
+
+    public override async Task SelectMany_optional_trunk_reference_branch_collection(bool async)
+        => Assert.Equal(
+            SqliteStrings.ApplyNotSupported,
+            (await Assert.ThrowsAsync<InvalidOperationException>(
+                () => base.SelectMany_optional_trunk_reference_branch_collection(async)))
+            .Message);
+
+    public override async Task SelectMany_required_trunk_reference_branch_collection(bool async)
+        => Assert.Equal(
+            SqliteStrings.ApplyNotSupported,
+            (await Assert.ThrowsAsync<InvalidOperationException>(
+                () => base.SelectMany_required_trunk_reference_branch_collection(async)))
+            .Message);
+
+    public override async Task SelectMany_trunk_collection(bool async)
+        => Assert.Equal(
+            SqliteStrings.ApplyNotSupported,
+            (await Assert.ThrowsAsync<InvalidOperationException>(
+                () => base.SelectMany_trunk_collection(async)))
+            .Message);
+
+    private void AssertSql(params string[] expected)
+        => Fixture.TestSqlLoggerFactory.AssertBaseline(expected);
+}
diff --git a/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/Projection/OwnedJsonProjectionSqliteTest.cs b/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/Projection/OwnedJsonProjectionSqliteTest.cs
new file mode 100644
index 0000000000..265accb6ee
--- /dev/null
+++ b/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/Projection/OwnedJsonProjectionSqliteTest.cs
@@ -0,0 +1,85 @@
+﻿// Licensed to the .NET Foundation under one or more agreements.
+// The .NET Foundation licenses this file to you under the MIT license.
+
+using Microsoft.EntityFrameworkCore.Sqlite.Internal;
+
+namespace Microsoft.EntityFrameworkCore.Query.Relationships.Projection;
+
+public class OwnedJsonProjectionSqliteTest
+    : OwnedJsonProjectionRelationalTestBase<OwnedJsonRelationshipsSqliteFixture>
+{
+    public OwnedJsonProjectionSqliteTest(OwnedJsonRelationshipsSqliteFixture fixture, ITestOutputHelper testOutputHelper)
+        : base(fixture)
+    {
+        Fixture.TestSqlLoggerFactory.Clear();
+        Fixture.TestSqlLoggerFactory.SetTestOutputHelper(testOutputHelper);
+    }
+
+    public override Task Select_trunk_collection(bool async)
+        => AssertCantTrackJson(() => base.Select_trunk_collection(async));
+
+     public override Task Select_branch_required_collection(bool async)
+        => AssertCantTrackJson(() => base.Select_branch_required_collection(async));
+
+    public override Task Select_branch_optional_collection(bool async)
+        => AssertCantTrackJson(() => base.Select_branch_optional_collection(async));
+
+    public override Task Project_branch_collection_element_using_indexer_constant(bool async)
+        => AssertCantTrackJson(() => base.Project_branch_collection_element_using_indexer_constant(async));
+
+    public override Task Select_multiple_branch_leaf(bool async)
+        => AssertCantTrackJson(() => base.Select_multiple_branch_leaf(async));
+
+    public override async Task Select_subquery_root_set_complex_projection_FirstOrDefault_project_reference_to_outer(bool async)
+        => Assert.Equal(
+            SqliteStrings.ApplyNotSupported,
+            (await Assert.ThrowsAsync<InvalidOperationException>(
+                () => base.Select_subquery_root_set_complex_projection_FirstOrDefault_project_reference_to_outer(async)))
+            .Message);
+
+    public override async Task Select_subquery_root_set_complex_projection_including_references_to_outer_FirstOrDefault(bool async)
+        => Assert.Equal(
+            SqliteStrings.ApplyNotSupported,
+            (await Assert.ThrowsAsync<InvalidOperationException>(
+                () => base.Select_subquery_root_set_complex_projection_including_references_to_outer_FirstOrDefault(async)))
+            .Message);
+
+    public override async Task Select_subquery_root_set_trunk_FirstOrDefault_collection(bool async)
+        => Assert.Equal(
+            SqliteStrings.ApplyNotSupported,
+            (await Assert.ThrowsAsync<InvalidOperationException>(
+                () => base.Select_subquery_root_set_trunk_FirstOrDefault_collection(async)))
+            .Message);
+
+    public override async Task SelectMany_optional_trunk_reference_branch_collection(bool async)
+        => Assert.Equal(
+            SqliteStrings.ApplyNotSupported,
+            (await Assert.ThrowsAsync<InvalidOperationException>(
+                () => base.SelectMany_optional_trunk_reference_branch_collection(async)))
+            .Message);
+
+    public override async Task SelectMany_required_trunk_reference_branch_collection(bool async)
+        => Assert.Equal(
+            SqliteStrings.ApplyNotSupported,
+            (await Assert.ThrowsAsync<InvalidOperationException>(
+                () => base.SelectMany_required_trunk_reference_branch_collection(async)))
+            .Message);
+
+    public override async Task SelectMany_trunk_collection(bool async)
+        => Assert.Equal(
+            SqliteStrings.ApplyNotSupported,
+            (await Assert.ThrowsAsync<InvalidOperationException>(
+                () => base.SelectMany_trunk_collection(async)))
+            .Message);
+
+    private async Task AssertCantTrackJson(Func<Task> test)
+    {
+        var message = (await Assert.ThrowsAsync<InvalidOperationException>(test)).Message;
+
+        Assert.Equal(RelationalStrings.JsonEntityOrCollectionProjectedAtRootLevelInTrackingQuery("AsNoTracking"), message);
+        AssertSql();
+    }
+
+    private void AssertSql(params string[] expected)
+        => Fixture.TestSqlLoggerFactory.AssertBaseline(expected);
+}
diff --git a/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/Projection/OwnedJsonReferenceNoTrackingProjectionSqliteTest.cs b/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/Projection/OwnedJsonReferenceNoTrackingProjectionSqliteTest.cs
new file mode 100644
index 0000000000..eb307a883b
--- /dev/null
+++ b/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/Projection/OwnedJsonReferenceNoTrackingProjectionSqliteTest.cs
@@ -0,0 +1,163 @@
+﻿// Licensed to the .NET Foundation under one or more agreements.
+// The .NET Foundation licenses this file to you under the MIT license.
+
+using Microsoft.EntityFrameworkCore.Sqlite.Internal;
+
+namespace Microsoft.EntityFrameworkCore.Query.Relationships.Projection;
+
+public class OwnedJsonReferenceNoTrackingProjectionSqliteTest
+    : OwnedJsonReferenceNoTrackingProjectionRelationalTestBase<OwnedJsonRelationshipsSqliteFixture>
+{
+    public OwnedJsonReferenceNoTrackingProjectionSqliteTest(OwnedJsonRelationshipsSqliteFixture fixture, ITestOutputHelper testOutputHelper)
+        : base(fixture)
+    {
+        Fixture.TestSqlLoggerFactory.Clear();
+        Fixture.TestSqlLoggerFactory.SetTestOutputHelper(testOutputHelper);
+    }
+
+    public override async Task Select_root(bool async)
+    {
+        await base.Select_root(async);
+
+        AssertSql(
+            """
+SELECT "r"."Id", "r"."Name", "r"."OptionalReferenceTrunkId", "r"."RequiredReferenceTrunkId", "r"."CollectionTrunk", "r"."OptionalReferenceTrunk", "r"."RequiredReferenceTrunk"
+FROM "RootEntities" AS "r"
+""");
+    }
+
+    public override async Task Select_trunk_optional(bool async)
+    {
+        await base.Select_trunk_optional(async);
+
+        AssertSql(
+            """
+SELECT "r"."OptionalReferenceTrunk", "r"."Id"
+FROM "RootEntities" AS "r"
+ORDER BY "r"."Id"
+""");
+    }
+
+    public override async Task Select_trunk_required(bool async)
+    {
+        await base.Select_trunk_required(async);
+
+        AssertSql(
+            """
+SELECT "r"."RequiredReferenceTrunk", "r"."Id"
+FROM "RootEntities" AS "r"
+ORDER BY "r"."Id"
+""");
+    }
+
+    public override async Task Select_branch_required_required(bool async)
+    {
+        await base.Select_branch_required_required(async);
+
+        AssertSql(
+            """
+SELECT "r"."RequiredReferenceTrunk" ->> 'RequiredReferenceBranch', "r"."Id"
+FROM "RootEntities" AS "r"
+ORDER BY "r"."Id"
+""");
+    }
+
+    public override async Task Select_branch_required_optional(bool async)
+    {
+        await base.Select_branch_required_optional(async);
+
+        AssertSql(
+            """
+SELECT "r"."RequiredReferenceTrunk" ->> 'OptionalReferenceBranch', "r"."Id"
+FROM "RootEntities" AS "r"
+ORDER BY "r"."Id"
+""");
+    }
+
+    public override async Task Select_branch_optional_required(bool async)
+    {
+        await base.Select_branch_optional_required(async);
+
+        AssertSql(
+            """
+SELECT "r"."RequiredReferenceTrunk" ->> 'RequiredReferenceBranch', "r"."Id"
+FROM "RootEntities" AS "r"
+ORDER BY "r"."Id"
+""");
+    }
+
+    public override async Task Select_branch_optional_optional(bool async)
+    {
+        await base.Select_branch_optional_optional(async);
+
+        AssertSql(
+            """
+SELECT "r"."RequiredReferenceTrunk" ->> 'OptionalReferenceBranch', "r"."Id"
+FROM "RootEntities" AS "r"
+ORDER BY "r"."Id"
+""");
+    }
+
+    public override async Task Select_root_duplicated(bool async)
+    {
+        await base.Select_root_duplicated(async);
+
+        AssertSql(
+            """
+SELECT "r"."Id", "r"."Name", "r"."OptionalReferenceTrunkId", "r"."RequiredReferenceTrunkId", "r"."CollectionTrunk", "r"."OptionalReferenceTrunk", "r"."RequiredReferenceTrunk", "r"."CollectionTrunk", "r"."OptionalReferenceTrunk", "r"."RequiredReferenceTrunk"
+FROM "RootEntities" AS "r"
+""");
+    }
+
+    public override async Task Select_trunk_and_branch_duplicated(bool async)
+    {
+        await base.Select_trunk_and_branch_duplicated(async);
+
+        AssertSql(
+            """
+SELECT "r"."OptionalReferenceTrunk", "r"."Id", "r"."OptionalReferenceTrunk" ->> 'RequiredReferenceBranch', "r"."OptionalReferenceTrunk", "r"."OptionalReferenceTrunk" ->> 'RequiredReferenceBranch'
+FROM "RootEntities" AS "r"
+ORDER BY "r"."Id"
+""");
+    }
+
+    public override async Task Select_trunk_and_trunk_duplicated(bool async)
+    {
+        await base.Select_trunk_and_trunk_duplicated(async);
+
+        AssertSql(
+            """
+SELECT "r"."RequiredReferenceTrunk", "r"."Id", "r"."RequiredReferenceTrunk" ->> '$.OptionalReferenceBranch.RequiredReferenceLeaf', "r"."RequiredReferenceTrunk", "r"."RequiredReferenceTrunk" ->> '$.OptionalReferenceBranch.RequiredReferenceLeaf'
+FROM "RootEntities" AS "r"
+ORDER BY "r"."Id"
+""");
+    }
+
+    public override async Task Select_leaf_trunk_root(bool async)
+    {
+        await base.Select_leaf_trunk_root(async);
+
+        AssertSql(
+            """
+SELECT "r"."RequiredReferenceTrunk" ->> '$.RequiredReferenceBranch.RequiredReferenceLeaf', "r"."Id", "r"."RequiredReferenceTrunk", "r"."Name", "r"."OptionalReferenceTrunkId", "r"."RequiredReferenceTrunkId", "r"."CollectionTrunk", "r"."OptionalReferenceTrunk", "r"."RequiredReferenceTrunk"
+FROM "RootEntities" AS "r"
+""");
+    }
+
+    public override async Task Select_subquery_root_set_optional_trunk_FirstOrDefault_branch(bool async)
+        => Assert.Equal(
+            SqliteStrings.ApplyNotSupported,
+            (await Assert.ThrowsAsync<InvalidOperationException>(
+                () => base.Select_subquery_root_set_optional_trunk_FirstOrDefault_branch(async)))
+            .Message);
+
+    public override async Task Select_subquery_root_set_required_trunk_FirstOrDefault_branch(bool async)
+        => Assert.Equal(
+            SqliteStrings.ApplyNotSupported,
+            (await Assert.ThrowsAsync<InvalidOperationException>(
+                () => base.Select_subquery_root_set_required_trunk_FirstOrDefault_branch(async)))
+            .Message);
+
+    private void AssertSql(params string[] expected)
+        => Fixture.TestSqlLoggerFactory.AssertBaseline(expected);
+}
diff --git a/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/Projection/OwnedJsonReferenceProjectionSqliteTest.cs b/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/Projection/OwnedJsonReferenceProjectionSqliteTest.cs
new file mode 100644
index 0000000000..0ceba3f140
--- /dev/null
+++ b/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/Projection/OwnedJsonReferenceProjectionSqliteTest.cs
@@ -0,0 +1,91 @@
+﻿// Licensed to the .NET Foundation under one or more agreements.
+// The .NET Foundation licenses this file to you under the MIT license.
+
+using Microsoft.EntityFrameworkCore.Sqlite.Internal;
+
+namespace Microsoft.EntityFrameworkCore.Query.Relationships.Projection;
+
+public class OwnedJsonReferenceProjectionSqliteTest
+    : OwnedJsonReferenceProjectionRelationalTestBase<OwnedJsonRelationshipsSqliteFixture>
+{
+    public OwnedJsonReferenceProjectionSqliteTest(OwnedJsonRelationshipsSqliteFixture fixture, ITestOutputHelper testOutputHelper)
+        : base(fixture)
+    {
+        Fixture.TestSqlLoggerFactory.Clear();
+        Fixture.TestSqlLoggerFactory.SetTestOutputHelper(testOutputHelper);
+    }
+
+    public override async Task Select_root(bool async)
+    {
+        await base.Select_root(async);
+
+        AssertSql(
+            """
+SELECT "r"."Id", "r"."Name", "r"."OptionalReferenceTrunkId", "r"."RequiredReferenceTrunkId", "r"."CollectionTrunk", "r"."OptionalReferenceTrunk", "r"."RequiredReferenceTrunk"
+FROM "RootEntities" AS "r"
+""");
+    }
+
+    public override async Task Select_root_duplicated(bool async)
+    {
+        await base.Select_root_duplicated(async);
+
+    AssertSql(
+        """
+SELECT "r"."Id", "r"."Name", "r"."OptionalReferenceTrunkId", "r"."RequiredReferenceTrunkId", "r"."CollectionTrunk", "r"."OptionalReferenceTrunk", "r"."RequiredReferenceTrunk", "r"."CollectionTrunk", "r"."OptionalReferenceTrunk", "r"."RequiredReferenceTrunk"
+FROM "RootEntities" AS "r"
+""");
+    }
+
+    public override Task Select_trunk_optional(bool async)
+        => AssertCantTrackJson(() => base.Select_trunk_optional(async));
+
+    public override Task Select_trunk_required(bool async)
+        => AssertCantTrackJson(() => base.Select_trunk_required(async));
+
+    public override Task Select_branch_required_required(bool async)
+        => AssertCantTrackJson(() => base.Select_branch_required_required(async));
+
+    public override Task Select_branch_required_optional(bool async)
+        => AssertCantTrackJson(() => base.Select_branch_required_optional(async));
+
+    public override  Task Select_branch_optional_required(bool async)
+        => AssertCantTrackJson(() => base.Select_branch_optional_required(async));
+
+    public override Task Select_branch_optional_optional(bool async)
+        => AssertCantTrackJson(() => base.Select_branch_optional_optional(async));
+
+    public override Task Select_leaf_trunk_root(bool async)
+        => AssertCantTrackJson(() => base.Select_leaf_trunk_root(async));
+
+    public override Task Select_trunk_and_branch_duplicated(bool async)
+        => AssertCantTrackJson(() => base.Select_trunk_and_branch_duplicated(async));
+
+    public override Task Select_trunk_and_trunk_duplicated(bool async)
+        => AssertCantTrackJson(() => base.Select_trunk_and_trunk_duplicated(async));
+
+    public override async Task Select_subquery_root_set_optional_trunk_FirstOrDefault_branch(bool async)
+        => Assert.Equal(
+            SqliteStrings.ApplyNotSupported,
+            (await Assert.ThrowsAsync<InvalidOperationException>(
+                () => base.Select_subquery_root_set_optional_trunk_FirstOrDefault_branch(async)))
+            .Message);
+
+    public override async Task Select_subquery_root_set_required_trunk_FirstOrDefault_branch(bool async)
+        => Assert.Equal(
+            SqliteStrings.ApplyNotSupported,
+            (await Assert.ThrowsAsync<InvalidOperationException>(
+                () => base.Select_subquery_root_set_required_trunk_FirstOrDefault_branch(async)))
+            .Message);
+
+    private async Task AssertCantTrackJson(Func<Task> test)
+    {
+        var message = (await Assert.ThrowsAsync<InvalidOperationException>(test)).Message;
+
+        Assert.Equal(RelationalStrings.JsonEntityOrCollectionProjectedAtRootLevelInTrackingQuery("AsNoTracking"), message);
+        AssertSql();
+    }
+
+    private void AssertSql(params string[] expected)
+        => Fixture.TestSqlLoggerFactory.AssertBaseline(expected);
+}
diff --git a/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/Projection/OwnedNoTrackingProjectionSqliteTest.cs b/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/Projection/OwnedNoTrackingProjectionSqliteTest.cs
new file mode 100644
index 0000000000..d4abbae84d
--- /dev/null
+++ b/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/Projection/OwnedNoTrackingProjectionSqliteTest.cs
@@ -0,0 +1,55 @@
+﻿// Licensed to the .NET Foundation under one or more agreements.
+// The .NET Foundation licenses this file to you under the MIT license.
+
+namespace Microsoft.EntityFrameworkCore.Query.Relationships.Projection;
+
+public class OwnedNoTrackingProjectionSqliteTest
+    : OwnedNoTrackingProjectionRelationalTestBase<OwnedRelationshipsSqliteFixture>
+{
+    public OwnedNoTrackingProjectionSqliteTest(OwnedRelationshipsSqliteFixture fixture, ITestOutputHelper testOutputHelper)
+        : base(fixture)
+    {
+        Fixture.TestSqlLoggerFactory.Clear();
+        Fixture.TestSqlLoggerFactory.SetTestOutputHelper(testOutputHelper);
+    }
+
+    [ConditionalTheory(Skip = "issue 26708")]
+    public override Task Select_trunk_collection(bool async)
+        => base.Select_trunk_collection(async);
+
+    [ConditionalTheory(Skip = "issue 26708")]
+    public override Task Select_branch_required_collection(bool async)
+        => base.Select_branch_required_collection(async);
+
+    [ConditionalTheory(Skip = "issue 26708")]
+    public override Task Select_branch_optional_collection(bool async)
+        => base.Select_branch_optional_collection(async);
+
+    [ConditionalTheory(Skip = "issue 26708")]
+    public override Task Select_multiple_branch_leaf(bool async)
+        => base.Select_multiple_branch_leaf(async);
+
+    [ConditionalTheory(Skip = "issue 26708")]
+    public override Task Select_subquery_root_set_trunk_FirstOrDefault_collection(bool async)
+        => base.Select_subquery_root_set_trunk_FirstOrDefault_collection(async);
+
+    [ConditionalTheory(Skip = "issue 26708")]
+    public override Task Select_subquery_root_set_complex_projection_including_references_to_outer_FirstOrDefault(bool async)
+        => base.Select_subquery_root_set_complex_projection_including_references_to_outer_FirstOrDefault(async);
+
+    [ConditionalTheory(Skip = "issue 26708")]
+    public override Task Select_subquery_root_set_complex_projection_FirstOrDefault_project_reference_to_outer(bool async)
+        => base.Select_subquery_root_set_complex_projection_FirstOrDefault_project_reference_to_outer(async);
+
+    [ConditionalTheory(Skip = "issue 26708")]
+    public override Task SelectMany_trunk_collection(bool async)
+        => base.SelectMany_trunk_collection(async);
+
+    [ConditionalTheory(Skip = "issue 26708")]
+    public override Task SelectMany_required_trunk_reference_branch_collection(bool async)
+        => base.SelectMany_required_trunk_reference_branch_collection(async);
+
+    [ConditionalTheory(Skip = "issue 26708")]
+    public override Task SelectMany_optional_trunk_reference_branch_collection(bool async)
+        => base.SelectMany_optional_trunk_reference_branch_collection(async);
+}
diff --git a/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/Projection/OwnedProjectionSqliteTest.cs b/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/Projection/OwnedProjectionSqliteTest.cs
new file mode 100644
index 0000000000..58204ff9f2
--- /dev/null
+++ b/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/Projection/OwnedProjectionSqliteTest.cs
@@ -0,0 +1,55 @@
+﻿// Licensed to the .NET Foundation under one or more agreements.
+// The .NET Foundation licenses this file to you under the MIT license.
+
+namespace Microsoft.EntityFrameworkCore.Query.Relationships.Projection;
+
+public class OwnedProjectionSqliteTest
+    : OwnedProjectionRelationalTestBase<OwnedRelationshipsSqliteFixture>
+{
+    public OwnedProjectionSqliteTest(OwnedRelationshipsSqliteFixture fixture, ITestOutputHelper testOutputHelper)
+        : base(fixture)
+    {
+        Fixture.TestSqlLoggerFactory.Clear();
+        Fixture.TestSqlLoggerFactory.SetTestOutputHelper(testOutputHelper);
+    }
+
+    [ConditionalTheory(Skip = "issue 26708")]
+    public override Task Select_trunk_collection(bool async)
+        => base.Select_trunk_collection(async);
+
+    [ConditionalTheory(Skip = "issue 26708")]
+    public override Task Select_branch_required_collection(bool async)
+        => base.Select_branch_required_collection(async);
+
+    [ConditionalTheory(Skip = "issue 26708")]
+    public override Task Select_branch_optional_collection(bool async)
+        => base.Select_branch_optional_collection(async);
+
+    [ConditionalTheory(Skip = "issue 26708")]
+    public override Task Select_multiple_branch_leaf(bool async)
+        => base.Select_multiple_branch_leaf(async);
+
+    [ConditionalTheory(Skip = "issue 26708")]
+    public override Task Select_subquery_root_set_trunk_FirstOrDefault_collection(bool async)
+        => base.Select_subquery_root_set_trunk_FirstOrDefault_collection(async);
+
+    [ConditionalTheory(Skip = "issue 26708")]
+    public override Task Select_subquery_root_set_complex_projection_including_references_to_outer_FirstOrDefault(bool async)
+        => base.Select_subquery_root_set_complex_projection_including_references_to_outer_FirstOrDefault(async);
+
+    [ConditionalTheory(Skip = "issue 26708")]
+    public override Task Select_subquery_root_set_complex_projection_FirstOrDefault_project_reference_to_outer(bool async)
+        => base.Select_subquery_root_set_complex_projection_FirstOrDefault_project_reference_to_outer(async);
+
+    [ConditionalTheory(Skip = "issue 26708")]
+    public override Task SelectMany_trunk_collection(bool async)
+        => base.SelectMany_trunk_collection(async);
+
+    [ConditionalTheory(Skip = "issue 26708")]
+    public override Task SelectMany_required_trunk_reference_branch_collection(bool async)
+        => base.SelectMany_required_trunk_reference_branch_collection(async);
+
+    [ConditionalTheory(Skip = "issue 26708")]
+    public override Task SelectMany_optional_trunk_reference_branch_collection(bool async)
+        => base.SelectMany_optional_trunk_reference_branch_collection(async);
+}
diff --git a/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/Projection/OwnedReferenceNoTrackingProjectionSqliteTest.cs b/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/Projection/OwnedReferenceNoTrackingProjectionSqliteTest.cs
new file mode 100644
index 0000000000..e9aa3b7256
--- /dev/null
+++ b/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/Projection/OwnedReferenceNoTrackingProjectionSqliteTest.cs
@@ -0,0 +1,67 @@
+﻿// Licensed to the .NET Foundation under one or more agreements.
+// The .NET Foundation licenses this file to you under the MIT license.
+
+namespace Microsoft.EntityFrameworkCore.Query.Relationships.Projection;
+
+public class OwnedReferenceNoTrackingProjectionSqliteTest
+    : OwnedReferenceNoTrackingProjectionRelationalTestBase<OwnedRelationshipsSqliteFixture>
+{
+    public OwnedReferenceNoTrackingProjectionSqliteTest(OwnedRelationshipsSqliteFixture fixture, ITestOutputHelper testOutputHelper)
+        : base(fixture)
+    {
+        Fixture.TestSqlLoggerFactory.Clear();
+        Fixture.TestSqlLoggerFactory.SetTestOutputHelper(testOutputHelper);
+    }
+
+    [ConditionalTheory(Skip = "issue 26708")]
+    public override Task Select_root(bool async)
+        => base.Select_root(async);
+
+    [ConditionalTheory(Skip = "issue 26708")]
+    public override Task Select_trunk_optional(bool async)
+        => base.Select_trunk_optional(async);
+
+    [ConditionalTheory(Skip = "issue 26708")]
+    public override Task Select_trunk_required(bool async)
+        => base.Select_trunk_required(async);
+
+    [ConditionalTheory(Skip = "issue 26708")]
+    public override Task Select_branch_required_required(bool async)
+        => base.Select_branch_required_required(async);
+
+    [ConditionalTheory(Skip = "issue 26708")]
+    public override Task Select_branch_required_optional(bool async)
+        => base.Select_branch_required_optional(async);
+
+    [ConditionalTheory(Skip = "issue 26708")]
+    public override Task Select_branch_optional_required(bool async)
+        => base.Select_branch_optional_required(async);
+
+    [ConditionalTheory(Skip = "issue 26708")]
+    public override Task Select_branch_optional_optional(bool async)
+        => base.Select_branch_optional_optional(async);
+
+    [ConditionalTheory(Skip = "issue 26708")]
+    public override Task Select_root_duplicated(bool async)
+        => base.Select_root_duplicated(async);
+
+    [ConditionalTheory(Skip = "issue 26708")]
+    public override Task Select_trunk_and_branch_duplicated(bool async)
+        => base.Select_trunk_and_branch_duplicated(async);
+
+    [ConditionalTheory(Skip = "issue 26708")]
+    public override Task Select_trunk_and_trunk_duplicated(bool async)
+        => base.Select_trunk_and_trunk_duplicated(async);
+
+    [ConditionalTheory(Skip = "issue 26708")]
+    public override Task Select_leaf_trunk_root(bool async)
+        => base.Select_leaf_trunk_root(async);
+
+    [ConditionalTheory(Skip = "issue 26708")]
+    public override Task Select_subquery_root_set_required_trunk_FirstOrDefault_branch(bool async)
+        => base.Select_subquery_root_set_required_trunk_FirstOrDefault_branch(async);
+
+    [ConditionalTheory(Skip = "issue 26708")]
+    public override Task Select_subquery_root_set_optional_trunk_FirstOrDefault_branch(bool async)
+        => base.Select_subquery_root_set_optional_trunk_FirstOrDefault_branch(async);
+}
diff --git a/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/Projection/OwnedReferenceProjectionSqliteTest.cs b/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/Projection/OwnedReferenceProjectionSqliteTest.cs
new file mode 100644
index 0000000000..380c7fa854
--- /dev/null
+++ b/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/Projection/OwnedReferenceProjectionSqliteTest.cs
@@ -0,0 +1,71 @@
+﻿// Licensed to the .NET Foundation under one or more agreements.
+// The .NET Foundation licenses this file to you under the MIT license.
+
+
+// Licensed to the .NET Foundation under one or more agreements.
+// The .NET Foundation licenses this file to you under the MIT license.
+
+namespace Microsoft.EntityFrameworkCore.Query.Relationships.Projection;
+
+public class OwnedReferenceProjectionSqliteTest
+    : OwnedReferenceProjectionRelationalTestBase<OwnedRelationshipsSqliteFixture>
+{
+    public OwnedReferenceProjectionSqliteTest(OwnedRelationshipsSqliteFixture fixture, ITestOutputHelper testOutputHelper)
+        : base(fixture)
+    {
+        Fixture.TestSqlLoggerFactory.Clear();
+        Fixture.TestSqlLoggerFactory.SetTestOutputHelper(testOutputHelper);
+    }
+
+    [ConditionalTheory(Skip = "issue 26708")]
+    public override Task Select_root(bool async)
+        => base.Select_root(async);
+
+    [ConditionalTheory(Skip = "issue 26708")]
+    public override Task Select_trunk_optional(bool async)
+        => base.Select_trunk_optional(async);
+
+    [ConditionalTheory(Skip = "issue 26708")]
+    public override Task Select_trunk_required(bool async)
+        => base.Select_trunk_required(async);
+
+    [ConditionalTheory(Skip = "issue 26708")]
+    public override Task Select_branch_required_required(bool async)
+        => base.Select_branch_required_required(async);
+
+    [ConditionalTheory(Skip = "issue 26708")]
+    public override Task Select_branch_required_optional(bool async)
+        => base.Select_branch_required_optional(async);
+
+    [ConditionalTheory(Skip = "issue 26708")]
+    public override Task Select_branch_optional_required(bool async)
+        => base.Select_branch_optional_required(async);
+
+    [ConditionalTheory(Skip = "issue 26708")]
+    public override Task Select_branch_optional_optional(bool async)
+        => base.Select_branch_optional_optional(async);
+
+    [ConditionalTheory(Skip = "issue 26708")]
+    public override Task Select_root_duplicated(bool async)
+        => base.Select_root_duplicated(async);
+
+    [ConditionalTheory(Skip = "issue 26708")]
+    public override Task Select_trunk_and_branch_duplicated(bool async)
+        => base.Select_trunk_and_branch_duplicated(async);
+
+    [ConditionalTheory(Skip = "issue 26708")]
+    public override Task Select_trunk_and_trunk_duplicated(bool async)
+        => base.Select_trunk_and_trunk_duplicated(async);
+
+    [ConditionalTheory(Skip = "issue 26708")]
+    public override Task Select_leaf_trunk_root(bool async)
+        => base.Select_leaf_trunk_root(async);
+
+    [ConditionalTheory(Skip = "issue 26708")]
+    public override Task Select_subquery_root_set_required_trunk_FirstOrDefault_branch(bool async)
+        => base.Select_subquery_root_set_required_trunk_FirstOrDefault_branch(async);
+
+    [ConditionalTheory(Skip = "issue 26708")]
+    public override Task Select_subquery_root_set_optional_trunk_FirstOrDefault_branch(bool async)
+        => base.Select_subquery_root_set_optional_trunk_FirstOrDefault_branch(async);
+}
diff --git a/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/Projection/OwnedTableSplittingNoTrackingProjectionSqliteTest.cs b/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/Projection/OwnedTableSplittingNoTrackingProjectionSqliteTest.cs
new file mode 100644
index 0000000000..75b85b0c71
--- /dev/null
+++ b/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/Projection/OwnedTableSplittingNoTrackingProjectionSqliteTest.cs
@@ -0,0 +1,55 @@
+﻿// Licensed to the .NET Foundation under one or more agreements.
+// The .NET Foundation licenses this file to you under the MIT license.
+
+namespace Microsoft.EntityFrameworkCore.Query.Relationships.Projection;
+
+public class OwnedTableSplittingNoTrackingProjectionSqliteTest
+    : OwnedTableSplittingNoTrackingProjectionRelationalTestBase<OwnedTableSplittingRelationshipsSqliteFixture>
+{
+    public OwnedTableSplittingNoTrackingProjectionSqliteTest(OwnedTableSplittingRelationshipsSqliteFixture fixture, ITestOutputHelper testOutputHelper)
+        : base(fixture)
+    {
+        Fixture.TestSqlLoggerFactory.Clear();
+        Fixture.TestSqlLoggerFactory.SetTestOutputHelper(testOutputHelper);
+    }
+
+    [ConditionalTheory(Skip = "issue 26708")]
+    public override Task Select_trunk_collection(bool async)
+        => base.Select_trunk_collection(async);
+
+    [ConditionalTheory(Skip = "issue 26708")]
+    public override Task Select_branch_required_collection(bool async)
+        => base.Select_branch_required_collection(async);
+
+    [ConditionalTheory(Skip = "issue 26708")]
+    public override Task Select_branch_optional_collection(bool async)
+        => base.Select_branch_optional_collection(async);
+
+    [ConditionalTheory(Skip = "issue 26708")]
+    public override Task Select_multiple_branch_leaf(bool async)
+        => base.Select_multiple_branch_leaf(async);
+
+    [ConditionalTheory(Skip = "issue 26708")]
+    public override Task Select_subquery_root_set_trunk_FirstOrDefault_collection(bool async)
+        => base.Select_subquery_root_set_trunk_FirstOrDefault_collection(async);
+
+    [ConditionalTheory(Skip = "issue 26708")]
+    public override Task Select_subquery_root_set_complex_projection_including_references_to_outer_FirstOrDefault(bool async)
+        => base.Select_subquery_root_set_complex_projection_including_references_to_outer_FirstOrDefault(async);
+
+    [ConditionalTheory(Skip = "issue 26708")]
+    public override Task Select_subquery_root_set_complex_projection_FirstOrDefault_project_reference_to_outer(bool async)
+        => base.Select_subquery_root_set_complex_projection_FirstOrDefault_project_reference_to_outer(async);
+
+    [ConditionalTheory(Skip = "issue 26708")]
+    public override Task SelectMany_trunk_collection(bool async)
+        => base.SelectMany_trunk_collection(async);
+
+    [ConditionalTheory(Skip = "issue 26708")]
+    public override Task SelectMany_required_trunk_reference_branch_collection(bool async)
+        => base.SelectMany_required_trunk_reference_branch_collection(async);
+
+    [ConditionalTheory(Skip = "issue 26708")]
+    public override Task SelectMany_optional_trunk_reference_branch_collection(bool async)
+        => base.SelectMany_optional_trunk_reference_branch_collection(async);
+}
diff --git a/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/Projection/OwnedTableSplittingReferenceProjectionNoTrackingSqliteTest.cs b/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/Projection/OwnedTableSplittingReferenceProjectionNoTrackingSqliteTest.cs
new file mode 100644
index 0000000000..7f7068f18c
--- /dev/null
+++ b/test/EFCore.Sqlite.FunctionalTests/Query/Relationships/Projection/OwnedTableSplittingReferenceProjectionNoTrackingSqliteTest.cs
@@ -0,0 +1,67 @@
+﻿// Licensed to the .NET Foundation under one or more agreements.
+// The .NET Foundation licenses this file to you under the MIT license.
+
+namespace Microsoft.EntityFrameworkCore.Query.Relationships.Projection;
+
+public class OwnedTableSplittingReferenceProjectionNoTrackingSqliteTest
+    : OwnedTableSplittingReferenceProjectionNoTrackingRelationalTestBase<OwnedTableSplittingRelationshipsSqliteFixture>
+{
+    public OwnedTableSplittingReferenceProjectionNoTrackingSqliteTest(OwnedTableSplittingRelationshipsSqliteFixture fixture, ITestOutputHelper testOutputHelper)
+        : base(fixture)
+    {
+        Fixture.TestSqlLoggerFactory.Clear();
+        Fixture.TestSqlLoggerFactory.SetTestOutputHelper(testOutputHelper);
+    }
+
+    [ConditionalTheory(Skip = "issue 26708")]
+    public override Task Select_root(bool async)
+        => base.Select_root(async);
+
+    [ConditionalTheory(Skip = "issue 26708")]
+    public override Task Select_trunk_optional(bool async)
+        => base.Select_trunk_optional(async);
+
+    [ConditionalTheory(Skip = "issue 26708")]
+    public override Task Select_trunk_required(bool async)
+        => base.Select_trunk_required(async);
+
+    [ConditionalTheory(Skip = "issue 26708")]
+    public override Task Select_branch_required_required(bool async)
+        => base.Select_branch_required_required(async);
+
+    [ConditionalTheory(Skip = "issue 26708")]
+    public override Task Select_branch_required_optional(bool async)
+        => base.Select_branch_required_optional(async);
+
+    [ConditionalTheory(Skip = "issue 26708")]
+    public override Task Select_branch_optional_required(bool async)
+        => base.Select_branch_optional_required(async);
+
+    [ConditionalTheory(Skip = "issue 26708")]
+    public override Task Select_branch_optional_optional(bool async)
+        => base.Select_branch_optional_optional(async);
+
+    [ConditionalTheory(Skip = "issue 26708")]
+    public override Task Select_root_duplicated(bool async)
+        => base.Select_root_duplicated(async);
+
+    [ConditionalTheory(Skip = "issue 26708")]
+    public override Task Select_trunk_and_branch_duplicated(bool async)
+        => base.Select_trunk_and_branch_duplicated(async);
+
+    [ConditionalTheory(Skip = "issue 26708")]
+    public override Task Select_trunk_and_trunk_duplicated(bool async)
+        => base.Select_trunk_and_trunk_duplicated(async);
+
+    [ConditionalTheory(Skip = "issue 26708")]
+    public override Task Select_leaf_trunk_root(bool async)
+        => base.Select_leaf_trunk_root(async);
+
+    [ConditionalTheory(Skip = "issue 26708")]
+    public override Task Select_subquery_root_set_required_trunk_FirstOrDefault_branch(bool async)
+        => base.Select_subquery_root_set_required_trunk_FirstOrDefault_branch(async);
+
+    [ConditionalTheory(Skip = "issue 26708")]
+    public override Task Select_subquery_root_set_optional_trunk_FirstOrDefault_branch(bool async)
+        => base.Select_subquery_root_set_optional_trunk_FirstOrDefault_branch(async);
+}
