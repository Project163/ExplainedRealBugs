diff --git a/test/EFCore.Relational.Specification.Tests/BulkUpdates/TPCInheritanceBulkUpdatesFixture.cs b/test/EFCore.Relational.Specification.Tests/BulkUpdates/TPCInheritanceBulkUpdatesFixture.cs
index 79ba1b4538..d83b98af05 100644
--- a/test/EFCore.Relational.Specification.Tests/BulkUpdates/TPCInheritanceBulkUpdatesFixture.cs
+++ b/test/EFCore.Relational.Specification.Tests/BulkUpdates/TPCInheritanceBulkUpdatesFixture.cs
@@ -5,7 +5,7 @@
 
 namespace Microsoft.EntityFrameworkCore.BulkUpdates;
 
-public abstract class TPCInheritanceBulkUpdatesFixture : InheritanceBulkUpdatesFixtureBase
+public abstract class TPCInheritanceBulkUpdatesFixture : InheritanceBulkUpdatesFixtureBase, ITestSqlLoggerFactory
 {
     protected override string StoreName
         => "TPCInheritanceBulkUpdatesTest";
diff --git a/test/EFCore.Relational.Specification.Tests/BulkUpdates/TPHInheritanceBulkUpdatesFixture.cs b/test/EFCore.Relational.Specification.Tests/BulkUpdates/TPHInheritanceBulkUpdatesFixture.cs
index 65fa0d0938..c0761fa28c 100644
--- a/test/EFCore.Relational.Specification.Tests/BulkUpdates/TPHInheritanceBulkUpdatesFixture.cs
+++ b/test/EFCore.Relational.Specification.Tests/BulkUpdates/TPHInheritanceBulkUpdatesFixture.cs
@@ -5,7 +5,7 @@
 
 namespace Microsoft.EntityFrameworkCore.BulkUpdates;
 
-public abstract class TPHInheritanceBulkUpdatesFixture : InheritanceBulkUpdatesFixtureBase
+public abstract class TPHInheritanceBulkUpdatesFixture : InheritanceBulkUpdatesFixtureBase, ITestSqlLoggerFactory
 {
     protected override string StoreName
         => "TPHInheritanceBulkUpdatesTest";
diff --git a/test/EFCore.Relational.Specification.Tests/BulkUpdates/TPTInheritanceBulkUpdatesFixture.cs b/test/EFCore.Relational.Specification.Tests/BulkUpdates/TPTInheritanceBulkUpdatesFixture.cs
index f6b64ef0a1..17690ad4b0 100644
--- a/test/EFCore.Relational.Specification.Tests/BulkUpdates/TPTInheritanceBulkUpdatesFixture.cs
+++ b/test/EFCore.Relational.Specification.Tests/BulkUpdates/TPTInheritanceBulkUpdatesFixture.cs
@@ -5,7 +5,7 @@
 
 namespace Microsoft.EntityFrameworkCore.BulkUpdates;
 
-public abstract class TPTInheritanceBulkUpdatesFixture : InheritanceBulkUpdatesFixtureBase
+public abstract class TPTInheritanceBulkUpdatesFixture : InheritanceBulkUpdatesFixtureBase, ITestSqlLoggerFactory
 {
     protected override string StoreName
         => "TPTInheritanceBulkUpdatesTest";
diff --git a/test/EFCore.Relational.Specification.Tests/Query/ComplexNavigationsQueryRelationalFixtureBase.cs b/test/EFCore.Relational.Specification.Tests/Query/ComplexNavigationsQueryRelationalFixtureBase.cs
index cba9b3b1f3..77c562d325 100644
--- a/test/EFCore.Relational.Specification.Tests/Query/ComplexNavigationsQueryRelationalFixtureBase.cs
+++ b/test/EFCore.Relational.Specification.Tests/Query/ComplexNavigationsQueryRelationalFixtureBase.cs
@@ -3,7 +3,7 @@
 
 namespace Microsoft.EntityFrameworkCore.Query;
 
-public abstract class ComplexNavigationsQueryRelationalFixtureBase : ComplexNavigationsQueryFixtureBase
+public abstract class ComplexNavigationsQueryRelationalFixtureBase : ComplexNavigationsQueryFixtureBase, ITestSqlLoggerFactory
 {
     public TestSqlLoggerFactory TestSqlLoggerFactory
         => (TestSqlLoggerFactory)ListLoggerFactory;
diff --git a/test/EFCore.Relational.Specification.Tests/Query/ComplexNavigationsSharedTypeQueryRelationalFixtureBase.cs b/test/EFCore.Relational.Specification.Tests/Query/ComplexNavigationsSharedTypeQueryRelationalFixtureBase.cs
index 7587a266b9..6eb60da7e8 100644
--- a/test/EFCore.Relational.Specification.Tests/Query/ComplexNavigationsSharedTypeQueryRelationalFixtureBase.cs
+++ b/test/EFCore.Relational.Specification.Tests/Query/ComplexNavigationsSharedTypeQueryRelationalFixtureBase.cs
@@ -5,7 +5,7 @@
 
 namespace Microsoft.EntityFrameworkCore.Query;
 
-public abstract class ComplexNavigationsSharedTypeQueryRelationalFixtureBase : ComplexNavigationsSharedTypeQueryFixtureBase
+public abstract class ComplexNavigationsSharedTypeQueryRelationalFixtureBase : ComplexNavigationsSharedTypeQueryFixtureBase, ITestSqlLoggerFactory
 {
     public TestSqlLoggerFactory TestSqlLoggerFactory
         => (TestSqlLoggerFactory)ListLoggerFactory;
diff --git a/test/EFCore.Relational.Specification.Tests/Query/ComplexTypeQueryRelationalFixtureBase.cs b/test/EFCore.Relational.Specification.Tests/Query/ComplexTypeQueryRelationalFixtureBase.cs
index 9351a80fbc..6cc3e67a57 100644
--- a/test/EFCore.Relational.Specification.Tests/Query/ComplexTypeQueryRelationalFixtureBase.cs
+++ b/test/EFCore.Relational.Specification.Tests/Query/ComplexTypeQueryRelationalFixtureBase.cs
@@ -3,7 +3,7 @@
 
 namespace Microsoft.EntityFrameworkCore.Query;
 
-public abstract class ComplexTypeQueryRelationalFixtureBase : ComplexTypeQueryFixtureBase
+public abstract class ComplexTypeQueryRelationalFixtureBase : ComplexTypeQueryFixtureBase, ITestSqlLoggerFactory
 {
     public TestSqlLoggerFactory TestSqlLoggerFactory
         => (TestSqlLoggerFactory)ListLoggerFactory;
diff --git a/test/EFCore.Relational.Specification.Tests/Query/CompositeKeysQueryRelationalFixtureBase.cs b/test/EFCore.Relational.Specification.Tests/Query/CompositeKeysQueryRelationalFixtureBase.cs
index d112efacf3..98de49904f 100644
--- a/test/EFCore.Relational.Specification.Tests/Query/CompositeKeysQueryRelationalFixtureBase.cs
+++ b/test/EFCore.Relational.Specification.Tests/Query/CompositeKeysQueryRelationalFixtureBase.cs
@@ -3,7 +3,7 @@
 
 namespace Microsoft.EntityFrameworkCore.Query;
 
-public abstract class CompositeKeysQueryRelationalFixtureBase : CompositeKeysQueryFixtureBase
+public abstract class CompositeKeysQueryRelationalFixtureBase : CompositeKeysQueryFixtureBase, ITestSqlLoggerFactory
 {
     public TestSqlLoggerFactory TestSqlLoggerFactory
         => (TestSqlLoggerFactory)ListLoggerFactory;
diff --git a/test/EFCore.Relational.Specification.Tests/Query/GearsOfWarQueryRelationalFixture.cs b/test/EFCore.Relational.Specification.Tests/Query/GearsOfWarQueryRelationalFixture.cs
index 6b5cc83071..13c9c9c5a9 100644
--- a/test/EFCore.Relational.Specification.Tests/Query/GearsOfWarQueryRelationalFixture.cs
+++ b/test/EFCore.Relational.Specification.Tests/Query/GearsOfWarQueryRelationalFixture.cs
@@ -5,7 +5,7 @@
 
 namespace Microsoft.EntityFrameworkCore.Query;
 
-public abstract class GearsOfWarQueryRelationalFixture : GearsOfWarQueryFixtureBase
+public abstract class GearsOfWarQueryRelationalFixture : GearsOfWarQueryFixtureBase, ITestSqlLoggerFactory
 {
     public override Dictionary<(Type, string), Func<object, object>> GetShadowPropertyMappings()
     {
diff --git a/test/EFCore.Relational.Specification.Tests/Query/InheritanceRelationshipsQueryRelationalFixture.cs b/test/EFCore.Relational.Specification.Tests/Query/InheritanceRelationshipsQueryRelationalFixture.cs
index 3035c75873..1760a9e60b 100644
--- a/test/EFCore.Relational.Specification.Tests/Query/InheritanceRelationshipsQueryRelationalFixture.cs
+++ b/test/EFCore.Relational.Specification.Tests/Query/InheritanceRelationshipsQueryRelationalFixture.cs
@@ -3,7 +3,7 @@
 
 namespace Microsoft.EntityFrameworkCore.Query;
 
-public abstract class InheritanceRelationshipsQueryRelationalFixture : InheritanceRelationshipsQueryFixtureBase
+public abstract class InheritanceRelationshipsQueryRelationalFixture : InheritanceRelationshipsQueryFixtureBase, ITestSqlLoggerFactory
 {
     public TestSqlLoggerFactory TestSqlLoggerFactory
         => (TestSqlLoggerFactory)ListLoggerFactory;
diff --git a/test/EFCore.Relational.Specification.Tests/Query/JsonQueryFixtureBase.cs b/test/EFCore.Relational.Specification.Tests/Query/JsonQueryFixtureBase.cs
index a6d6e12fd4..b0a1ba912a 100644
--- a/test/EFCore.Relational.Specification.Tests/Query/JsonQueryFixtureBase.cs
+++ b/test/EFCore.Relational.Specification.Tests/Query/JsonQueryFixtureBase.cs
@@ -5,7 +5,7 @@
 
 namespace Microsoft.EntityFrameworkCore.Query;
 
-public abstract class JsonQueryFixtureBase : SharedStoreFixtureBase<JsonQueryContext>, IQueryFixtureBase
+public abstract class JsonQueryFixtureBase : SharedStoreFixtureBase<JsonQueryContext>, IQueryFixtureBase, ITestSqlLoggerFactory
 {
     private JsonQueryData _expectedData;
 
diff --git a/test/EFCore.Relational.Specification.Tests/Query/ManyToManyQueryRelationalFixture.cs b/test/EFCore.Relational.Specification.Tests/Query/ManyToManyQueryRelationalFixture.cs
index 9cd62ea895..a3bf2b7aae 100644
--- a/test/EFCore.Relational.Specification.Tests/Query/ManyToManyQueryRelationalFixture.cs
+++ b/test/EFCore.Relational.Specification.Tests/Query/ManyToManyQueryRelationalFixture.cs
@@ -5,7 +5,7 @@
 
 namespace Microsoft.EntityFrameworkCore.Query;
 
-public abstract class ManyToManyQueryRelationalFixture : ManyToManyQueryFixtureBase
+public abstract class ManyToManyQueryRelationalFixture : ManyToManyQueryFixtureBase, ITestSqlLoggerFactory
 {
     public TestSqlLoggerFactory TestSqlLoggerFactory
         => (TestSqlLoggerFactory)ListLoggerFactory;
diff --git a/test/EFCore.Relational.Specification.Tests/Query/MappingQueryTestBase.cs b/test/EFCore.Relational.Specification.Tests/Query/MappingQueryTestBase.cs
index 92f2ed8d75..235e1928b9 100644
--- a/test/EFCore.Relational.Specification.Tests/Query/MappingQueryTestBase.cs
+++ b/test/EFCore.Relational.Specification.Tests/Query/MappingQueryTestBase.cs
@@ -86,7 +86,7 @@ protected enum ShipVia
         Three
     }
 
-    public abstract class MappingQueryFixtureBase : SharedStoreFixtureBase<PoolableDbContext>
+    public abstract class MappingQueryFixtureBase : SharedStoreFixtureBase<PoolableDbContext>, ITestSqlLoggerFactory
     {
         protected abstract string DatabaseSchema { get; }
 
diff --git a/test/EFCore.Relational.Specification.Tests/Query/NorthwindQueryRelationalFixture.cs b/test/EFCore.Relational.Specification.Tests/Query/NorthwindQueryRelationalFixture.cs
index b6a0da4048..d47921768f 100644
--- a/test/EFCore.Relational.Specification.Tests/Query/NorthwindQueryRelationalFixture.cs
+++ b/test/EFCore.Relational.Specification.Tests/Query/NorthwindQueryRelationalFixture.cs
@@ -3,7 +3,7 @@
 
 namespace Microsoft.EntityFrameworkCore.Query;
 
-public abstract class NorthwindQueryRelationalFixture<TModelCustomizer> : NorthwindQueryFixtureBase<TModelCustomizer>
+public abstract class NorthwindQueryRelationalFixture<TModelCustomizer> : NorthwindQueryFixtureBase<TModelCustomizer>, ITestSqlLoggerFactory
     where TModelCustomizer : ITestModelCustomizer, new()
 {
     public new RelationalTestStore TestStore
diff --git a/test/EFCore.Relational.Specification.Tests/Query/NullSemanticsQueryFixtureBase.cs b/test/EFCore.Relational.Specification.Tests/Query/NullSemanticsQueryFixtureBase.cs
index d87451177d..25d39a3af7 100644
--- a/test/EFCore.Relational.Specification.Tests/Query/NullSemanticsQueryFixtureBase.cs
+++ b/test/EFCore.Relational.Specification.Tests/Query/NullSemanticsQueryFixtureBase.cs
@@ -5,7 +5,7 @@
 
 namespace Microsoft.EntityFrameworkCore.Query;
 
-public abstract class NullSemanticsQueryFixtureBase : SharedStoreFixtureBase<NullSemanticsContext>, IQueryFixtureBase
+public abstract class NullSemanticsQueryFixtureBase : SharedStoreFixtureBase<NullSemanticsContext>, IQueryFixtureBase, ITestSqlLoggerFactory
 {
     public Func<DbContext> GetContextCreator()
         => () => CreateContext();
diff --git a/test/EFCore.Relational.Specification.Tests/Query/OptionalDependentQueryFixtureBase.cs b/test/EFCore.Relational.Specification.Tests/Query/OptionalDependentQueryFixtureBase.cs
index 90a507ff82..cfda91fafe 100644
--- a/test/EFCore.Relational.Specification.Tests/Query/OptionalDependentQueryFixtureBase.cs
+++ b/test/EFCore.Relational.Specification.Tests/Query/OptionalDependentQueryFixtureBase.cs
@@ -5,7 +5,7 @@
 
 namespace Microsoft.EntityFrameworkCore.Query;
 
-public abstract class OptionalDependentQueryFixtureBase : SharedStoreFixtureBase<OptionalDependentContext>, IQueryFixtureBase
+public abstract class OptionalDependentQueryFixtureBase : SharedStoreFixtureBase<OptionalDependentContext>, IQueryFixtureBase, ITestSqlLoggerFactory
 {
     private OptionalDependentData _expectedData;
 
diff --git a/test/EFCore.Relational.Specification.Tests/Query/OwnedQueryRelationalTestBase.cs b/test/EFCore.Relational.Specification.Tests/Query/OwnedQueryRelationalTestBase.cs
index 836bc16b44..e2003f9fe9 100644
--- a/test/EFCore.Relational.Specification.Tests/Query/OwnedQueryRelationalTestBase.cs
+++ b/test/EFCore.Relational.Specification.Tests/Query/OwnedQueryRelationalTestBase.cs
@@ -118,7 +118,7 @@ protected override QueryAsserter CreateQueryAsserter(TFixture fixture)
         => new RelationalQueryAsserter(
             fixture, RewriteExpectedQueryExpression, RewriteServerQueryExpression, canExecuteQueryString: CanExecuteQueryString);
 
-    public abstract class RelationalOwnedQueryFixture : OwnedQueryFixtureBase
+    public abstract class RelationalOwnedQueryFixture : OwnedQueryFixtureBase, ITestSqlLoggerFactory
     {
         public new RelationalTestStore TestStore
             => (RelationalTestStore)base.TestStore;
diff --git a/test/EFCore.Relational.Specification.Tests/Query/QueryFilterFuncletizationRelationalFixture.cs b/test/EFCore.Relational.Specification.Tests/Query/QueryFilterFuncletizationRelationalFixture.cs
index 54329c6b73..75c07462e8 100644
--- a/test/EFCore.Relational.Specification.Tests/Query/QueryFilterFuncletizationRelationalFixture.cs
+++ b/test/EFCore.Relational.Specification.Tests/Query/QueryFilterFuncletizationRelationalFixture.cs
@@ -3,7 +3,7 @@
 
 namespace Microsoft.EntityFrameworkCore.Query;
 
-public abstract class QueryFilterFuncletizationRelationalFixture : QueryFilterFuncletizationFixtureBase
+public abstract class QueryFilterFuncletizationRelationalFixture : QueryFilterFuncletizationFixtureBase, ITestSqlLoggerFactory
 {
     public TestSqlLoggerFactory TestSqlLoggerFactory
         => (TestSqlLoggerFactory)ListLoggerFactory;
diff --git a/test/EFCore.Relational.Specification.Tests/Query/SpatialQueryRelationalFixture.cs b/test/EFCore.Relational.Specification.Tests/Query/SpatialQueryRelationalFixture.cs
index f2b706de0e..9442663125 100644
--- a/test/EFCore.Relational.Specification.Tests/Query/SpatialQueryRelationalFixture.cs
+++ b/test/EFCore.Relational.Specification.Tests/Query/SpatialQueryRelationalFixture.cs
@@ -3,7 +3,7 @@
 
 namespace Microsoft.EntityFrameworkCore.Query;
 
-public abstract class SpatialQueryRelationalFixture : SpatialQueryFixtureBase
+public abstract class SpatialQueryRelationalFixture : SpatialQueryFixtureBase, ITestSqlLoggerFactory
 {
     public new RelationalTestStore TestStore
         => (RelationalTestStore)base.TestStore;
diff --git a/test/EFCore.Relational.Specification.Tests/Query/TPCGearsOfWarQueryRelationalFixture.cs b/test/EFCore.Relational.Specification.Tests/Query/TPCGearsOfWarQueryRelationalFixture.cs
index 08922f2b49..7b4f8d1c0f 100644
--- a/test/EFCore.Relational.Specification.Tests/Query/TPCGearsOfWarQueryRelationalFixture.cs
+++ b/test/EFCore.Relational.Specification.Tests/Query/TPCGearsOfWarQueryRelationalFixture.cs
@@ -5,7 +5,7 @@
 
 namespace Microsoft.EntityFrameworkCore.Query;
 
-public abstract class TPCGearsOfWarQueryRelationalFixture : GearsOfWarQueryFixtureBase
+public abstract class TPCGearsOfWarQueryRelationalFixture : GearsOfWarQueryFixtureBase, ITestSqlLoggerFactory
 {
     protected override string StoreName
         => "TPCGearsOfWarQueryTest";
diff --git a/test/EFCore.Relational.Specification.Tests/Query/TPCInheritanceQueryFixture.cs b/test/EFCore.Relational.Specification.Tests/Query/TPCInheritanceQueryFixture.cs
index 3d82aced6a..d7e6e36eed 100644
--- a/test/EFCore.Relational.Specification.Tests/Query/TPCInheritanceQueryFixture.cs
+++ b/test/EFCore.Relational.Specification.Tests/Query/TPCInheritanceQueryFixture.cs
@@ -5,7 +5,7 @@
 
 namespace Microsoft.EntityFrameworkCore.Query;
 
-public abstract class TPCInheritanceQueryFixture : InheritanceQueryFixtureBase
+public abstract class TPCInheritanceQueryFixture : InheritanceQueryFixtureBase, ITestSqlLoggerFactory
 {
     protected override string StoreName
         => "TPCInheritanceTest";
diff --git a/test/EFCore.Relational.Specification.Tests/Query/TPHInheritanceQueryFixture.cs b/test/EFCore.Relational.Specification.Tests/Query/TPHInheritanceQueryFixture.cs
index d409ea3a2a..d912bafa3a 100644
--- a/test/EFCore.Relational.Specification.Tests/Query/TPHInheritanceQueryFixture.cs
+++ b/test/EFCore.Relational.Specification.Tests/Query/TPHInheritanceQueryFixture.cs
@@ -5,7 +5,7 @@
 
 namespace Microsoft.EntityFrameworkCore.Query;
 
-public abstract class TPHInheritanceQueryFixture : InheritanceQueryFixtureBase
+public abstract class TPHInheritanceQueryFixture : InheritanceQueryFixtureBase, ITestSqlLoggerFactory
 {
     public TestSqlLoggerFactory TestSqlLoggerFactory
         => (TestSqlLoggerFactory)ListLoggerFactory;
diff --git a/test/EFCore.Relational.Specification.Tests/Query/TPTGearsOfWarQueryRelationalFixture.cs b/test/EFCore.Relational.Specification.Tests/Query/TPTGearsOfWarQueryRelationalFixture.cs
index 80665734a2..1c99e9a341 100644
--- a/test/EFCore.Relational.Specification.Tests/Query/TPTGearsOfWarQueryRelationalFixture.cs
+++ b/test/EFCore.Relational.Specification.Tests/Query/TPTGearsOfWarQueryRelationalFixture.cs
@@ -5,7 +5,7 @@
 
 namespace Microsoft.EntityFrameworkCore.Query;
 
-public abstract class TPTGearsOfWarQueryRelationalFixture : GearsOfWarQueryFixtureBase
+public abstract class TPTGearsOfWarQueryRelationalFixture : GearsOfWarQueryFixtureBase, ITestSqlLoggerFactory
 {
     protected override string StoreName
         => "TPTGearsOfWarQueryTest";
diff --git a/test/EFCore.Relational.Specification.Tests/Query/TPTInheritanceQueryFixture.cs b/test/EFCore.Relational.Specification.Tests/Query/TPTInheritanceQueryFixture.cs
index 4e3926f3ec..1565467359 100644
--- a/test/EFCore.Relational.Specification.Tests/Query/TPTInheritanceQueryFixture.cs
+++ b/test/EFCore.Relational.Specification.Tests/Query/TPTInheritanceQueryFixture.cs
@@ -5,7 +5,7 @@
 
 namespace Microsoft.EntityFrameworkCore.Query;
 
-public abstract class TPTInheritanceQueryFixture : InheritanceQueryFixtureBase
+public abstract class TPTInheritanceQueryFixture : InheritanceQueryFixtureBase, ITestSqlLoggerFactory
 {
     protected override string StoreName
         => "TPTInheritanceTest";
diff --git a/test/EFCore.Relational.Specification.Tests/Query/UdfDbFunctionTestBase.cs b/test/EFCore.Relational.Specification.Tests/Query/UdfDbFunctionTestBase.cs
index c071976950..9f5874e89c 100644
--- a/test/EFCore.Relational.Specification.Tests/Query/UdfDbFunctionTestBase.cs
+++ b/test/EFCore.Relational.Specification.Tests/Query/UdfDbFunctionTestBase.cs
@@ -366,7 +366,7 @@ protected override void OnModelCreating(ModelBuilder modelBuilder)
         }
     }
 
-    public abstract class UdfFixtureBase : SharedStoreFixtureBase<DbContext>
+    public abstract class UdfFixtureBase : SharedStoreFixtureBase<DbContext>, ITestSqlLoggerFactory
     {
         protected override Type ContextType { get; } = typeof(UDFSqlContext);
 
diff --git a/test/EFCore.Relational.Specification.Tests/RelationalComplianceTestBase.cs b/test/EFCore.Relational.Specification.Tests/RelationalComplianceTestBase.cs
index d5d706a8d6..7ecb1223ac 100644
--- a/test/EFCore.Relational.Specification.Tests/RelationalComplianceTestBase.cs
+++ b/test/EFCore.Relational.Specification.Tests/RelationalComplianceTestBase.cs
@@ -8,4 +8,21 @@ public abstract class RelationalComplianceTestBase : ComplianceTestBase
     protected override IEnumerable<Type> GetBaseTestClasses()
         => base.GetBaseTestClasses().Concat(
             typeof(RelationalComplianceTestBase).Assembly.ExportedTypes.Where(t => t.Name.Contains("TestBase")));
+
+    [ConditionalFact]
+    public virtual void All_query_test_fixtures_must_implement_ITestSqlLoggerFactory()
+    {
+        var queryFixturesWithoutTestSqlLogger = TargetAssembly
+            .GetTypes()
+            .Where(x => x.BaseType != typeof(object) && (x.IsPublic || x.IsNestedPublic))
+            .Select(x => new { Type = x, Interfaces = x.GetInterfaces().ToList() })
+            .Where(x => x.Interfaces.Contains(typeof(IQueryFixtureBase)))
+            .Where(x => !x.Interfaces.Contains(typeof(ITestSqlLoggerFactory)))
+            .Select(x => x.Type)
+            .ToList();
+
+        Assert.False(
+            queryFixturesWithoutTestSqlLogger.Count > 0,
+            "\r\n-- Missing ITestSqlLoggerFactory implementation for relational QueryFixtures --\r\n" + string.Join(Environment.NewLine, queryFixturesWithoutTestSqlLogger));
+    }
 }
diff --git a/test/EFCore.Relational.Specification.Tests/TestUtilities/ITestSqlLoggerFactory.cs b/test/EFCore.Relational.Specification.Tests/TestUtilities/ITestSqlLoggerFactory.cs
new file mode 100644
index 0000000000..41db3eb19b
--- /dev/null
+++ b/test/EFCore.Relational.Specification.Tests/TestUtilities/ITestSqlLoggerFactory.cs
@@ -0,0 +1,9 @@
+ï»¿// Licensed to the .NET Foundation under one or more agreements.
+// The .NET Foundation licenses this file to you under the MIT license.
+
+namespace Microsoft.EntityFrameworkCore.TestUtilities;
+
+public interface ITestSqlLoggerFactory
+{
+    TestSqlLoggerFactory TestSqlLoggerFactory { get; }
+}
diff --git a/test/EFCore.Relational.Specification.Tests/TestUtilities/RelationalQueryAsserter.cs b/test/EFCore.Relational.Specification.Tests/TestUtilities/RelationalQueryAsserter.cs
index 34d06b1430..4bf4ba8a7d 100644
--- a/test/EFCore.Relational.Specification.Tests/TestUtilities/RelationalQueryAsserter.cs
+++ b/test/EFCore.Relational.Specification.Tests/TestUtilities/RelationalQueryAsserter.cs
@@ -89,4 +89,701 @@ private static int ExecuteReader(DbCommand command)
 
         return count;
     }
+
+    public override async Task AssertSingleResult<TResult>(
+        Expression<Func<ISetSource, TResult>> actualSyncQuery,
+        Expression<Func<ISetSource, Task<TResult>>> actualAsyncQuery,
+        Expression<Func<ISetSource, TResult>> expectedQuery,
+        Action<TResult, TResult> asserter,
+        bool async,
+        bool filteredQuery = false)
+    {
+        var outputSql = true;
+        try
+        {
+            await base.AssertSingleResult(actualSyncQuery, actualAsyncQuery, expectedQuery, asserter, async, filteredQuery);
+            outputSql = false;
+        }
+        finally
+        {
+            if (outputSql)
+            {
+                ((ITestSqlLoggerFactory)QueryFixture).TestSqlLoggerFactory.OutputSql();
+            }
+        }
+    }
+
+    public override async Task AssertQuery<TResult>(
+        Func<ISetSource, IQueryable<TResult>> actualQuery,
+        Func<ISetSource, IQueryable<TResult>> expectedQuery,
+        Func<TResult, object> elementSorter,
+        Action<TResult, TResult> elementAsserter,
+        bool assertOrder,
+        bool assertEmpty,
+        bool async,
+        string testMethodName,
+        bool filteredQuery = false)
+    {
+        var outputSql = true;
+        try
+        {
+            await base.AssertQuery(actualQuery, expectedQuery, elementSorter, elementAsserter, assertOrder, assertEmpty, async, testMethodName, filteredQuery);
+            outputSql = false;
+        }
+        finally
+        {
+            if (outputSql)
+            {
+                ((ITestSqlLoggerFactory)QueryFixture).TestSqlLoggerFactory.OutputSql();
+            }
+        }
+    }
+
+    public override async Task AssertQueryScalar<TResult>(
+        Func<ISetSource, IQueryable<TResult>> actualQuery,
+        Func<ISetSource, IQueryable<TResult>> expectedQuery,
+        Action<TResult, TResult> asserter,
+        bool assertOrder,
+        bool assertEmpty,
+        bool async,
+        string testMethodName,
+        bool filteredQuery = false)
+    {
+        var outputSql = true;
+        try
+        {
+            await base.AssertQueryScalar(actualQuery, expectedQuery, asserter, assertOrder, assertEmpty, async, testMethodName, filteredQuery);
+            outputSql = false;
+        }
+        finally
+        {
+            if (outputSql)
+            {
+                ((ITestSqlLoggerFactory)QueryFixture).TestSqlLoggerFactory.OutputSql();
+            }
+        }
+    }
+
+    public override async Task AssertQueryScalar<TResult>(
+        Func<ISetSource, IQueryable<TResult?>> actualQuery,
+        Func<ISetSource, IQueryable<TResult?>> expectedQuery,
+        Action<TResult?, TResult?> asserter,
+        bool assertOrder,
+        bool assertEmpty,
+        bool async,
+        string testMethodName,
+        bool filteredQuery = false)
+    {
+        var outputSql = true;
+        try
+        {
+            await base.AssertQueryScalar(actualQuery, expectedQuery, asserter, assertOrder, assertEmpty, async, testMethodName, filteredQuery);
+            outputSql = false;
+        }
+        finally
+        {
+            if (outputSql)
+            {
+                ((ITestSqlLoggerFactory)QueryFixture).TestSqlLoggerFactory.OutputSql();
+            }
+        }
+    }
+
+    private async Task RunAndOutputSqlOnFailure(Func<Task> assertQuery)
+    {
+        var outputSql = true;
+        try
+        {
+            await assertQuery();
+            outputSql = false;
+        }
+        finally
+        {
+            if (outputSql)
+            {
+                ((ITestSqlLoggerFactory)QueryFixture).TestSqlLoggerFactory.OutputSql();
+            }
+        }
+    }
+
+    public override Task AssertAll<TResult>(
+        Func<ISetSource, IQueryable<TResult>> actualQuery,
+        Func<ISetSource, IQueryable<TResult>> expectedQuery,
+        Expression<Func<TResult, bool>> actualPredicate,
+        Expression<Func<TResult, bool>> expectedPredicate,
+        bool async = false,
+        bool filteredQuery = false)
+        => RunAndOutputSqlOnFailure(() => base.AssertAll(actualQuery, expectedQuery, actualPredicate, expectedPredicate, async, filteredQuery));
+
+    public override Task AssertAny<TResult>(
+        Func<ISetSource, IQueryable<TResult>> actualQuery,
+        Func<ISetSource, IQueryable<TResult>> expectedQuery,
+        bool async = false,
+        bool filteredQuery = false)
+        => RunAndOutputSqlOnFailure(() => base.AssertAny(actualQuery, expectedQuery, async, filteredQuery));
+
+    public override Task AssertAny<TResult>(
+        Func<ISetSource, IQueryable<TResult>> actualQuery,
+        Func<ISetSource, IQueryable<TResult>> expectedQuery,
+        Expression<Func<TResult, bool>> actualPredicate,
+        Expression<Func<TResult, bool>> expectedPredicate,
+        bool async = false,
+        bool filteredQuery = false)
+        => RunAndOutputSqlOnFailure(() => base.AssertAny(actualQuery, expectedQuery, actualPredicate, expectedPredicate, async, filteredQuery));
+
+    public override Task AssertAverage(
+        Func<ISetSource, IQueryable<decimal>> actualQuery,
+        Func<ISetSource, IQueryable<decimal>> expectedQuery,
+        Action<decimal, decimal> asserter = null,
+        bool async = false,
+        bool filteredQuery = false)
+        => RunAndOutputSqlOnFailure(() => base.AssertAverage(actualQuery, expectedQuery, asserter, async, filteredQuery));
+
+    public override Task AssertAverage(
+        Func<ISetSource, IQueryable<decimal?>> actualQuery,
+        Func<ISetSource, IQueryable<decimal?>> expectedQuery,
+        Action<decimal?, decimal?> asserter = null,
+        bool async = false,
+        bool filteredQuery = false)
+        => RunAndOutputSqlOnFailure(() => base.AssertAverage(actualQuery, expectedQuery, asserter, async, filteredQuery));
+
+    public override Task AssertAverage(
+        Func<ISetSource, IQueryable<double>> actualQuery,
+        Func<ISetSource, IQueryable<double>> expectedQuery,
+        Action<double, double> asserter = null,
+        bool async = false,
+        bool filteredQuery = false)
+        => RunAndOutputSqlOnFailure(() => base.AssertAverage(actualQuery, expectedQuery, asserter, async, filteredQuery));
+
+    public override Task AssertAverage(
+        Func<ISetSource, IQueryable<double?>> actualQuery,
+        Func<ISetSource, IQueryable<double?>> expectedQuery,
+        Action<double?, double?> asserter = null,
+        bool async = false,
+        bool filteredQuery = false)
+        => RunAndOutputSqlOnFailure(() => base.AssertAverage(actualQuery, expectedQuery, asserter, async, filteredQuery));
+
+    public override Task AssertAverage(
+        Func<ISetSource, IQueryable<float>> actualQuery,
+        Func<ISetSource, IQueryable<float>> expectedQuery,
+        Action<float, float> asserter = null,
+        bool async = false,
+        bool filteredQuery = false)
+        => RunAndOutputSqlOnFailure(() => base.AssertAverage(actualQuery, expectedQuery, asserter, async, filteredQuery));
+
+    public override Task AssertAverage(
+        Func<ISetSource, IQueryable<float?>> actualQuery,
+        Func<ISetSource, IQueryable<float?>> expectedQuery,
+        Action<float?, float?> asserter = null,
+        bool async = false,
+        bool filteredQuery = false)
+        => RunAndOutputSqlOnFailure(() => base.AssertAverage(actualQuery, expectedQuery, asserter, async, filteredQuery));
+
+    public override Task AssertAverage(
+        Func<ISetSource, IQueryable<int>> actualQuery,
+        Func<ISetSource, IQueryable<int>> expectedQuery,
+        Action<double, double> asserter = null,
+        bool async = false,
+        bool filteredQuery = false)
+        => RunAndOutputSqlOnFailure(() => base.AssertAverage(actualQuery, expectedQuery, asserter, async, filteredQuery));
+
+    public override Task AssertAverage(
+        Func<ISetSource, IQueryable<int?>> actualQuery,
+        Func<ISetSource, IQueryable<int?>> expectedQuery,
+        Action<double?, double?> asserter = null,
+        bool async = false,
+        bool filteredQuery = false)
+        => RunAndOutputSqlOnFailure(() => base.AssertAverage(actualQuery, expectedQuery, asserter, async, filteredQuery));
+
+    public override Task AssertAverage(
+        Func<ISetSource, IQueryable<long>> actualQuery,
+        Func<ISetSource, IQueryable<long>> expectedQuery,
+        Action<double, double> asserter = null,
+        bool async = false,
+        bool filteredQuery = false)
+        => RunAndOutputSqlOnFailure(() => base.AssertAverage(actualQuery, expectedQuery, asserter, async, filteredQuery));
+
+    public override Task AssertAverage(
+        Func<ISetSource, IQueryable<long?>> actualQuery,
+        Func<ISetSource, IQueryable<long?>> expectedQuery,
+        Action<double?, double?> asserter = null,
+        bool async = false,
+        bool filteredQuery = false)
+        => RunAndOutputSqlOnFailure(() => base.AssertAverage(actualQuery, expectedQuery, asserter, async, filteredQuery));
+
+    public override Task AssertAverage<TResult>(
+        Func<ISetSource, IQueryable<TResult>> actualQuery,
+        Func<ISetSource, IQueryable<TResult>> expectedQuery,
+        Expression<Func<TResult, decimal>> actualSelector,
+        Expression<Func<TResult, decimal>> expectedSelector,
+        Action<decimal, decimal> asserter = null,
+        bool async = false,
+        bool filteredQuery = false)
+        => RunAndOutputSqlOnFailure(() => base.AssertAverage(actualQuery, expectedQuery, actualSelector, expectedSelector, asserter, async, filteredQuery));
+
+    public override Task AssertAverage<TResult>(
+        Func<ISetSource, IQueryable<TResult>> actualQuery,
+        Func<ISetSource, IQueryable<TResult>> expectedQuery,
+        Expression<Func<TResult, decimal?>> actualSelector,
+        Expression<Func<TResult, decimal?>> expectedSelector,
+        Action<decimal?, decimal?> asserter = null,
+        bool async = false,
+        bool filteredQuery = false)
+        => RunAndOutputSqlOnFailure(() => base.AssertAverage(actualQuery, expectedQuery, actualSelector, expectedSelector, asserter, async, filteredQuery));
+
+    public override Task AssertAverage<TResult>(
+        Func<ISetSource, IQueryable<TResult>> actualQuery,
+        Func<ISetSource, IQueryable<TResult>> expectedQuery,
+        Expression<Func<TResult, double>> actualSelector,
+        Expression<Func<TResult, double>> expectedSelector,
+        Action<double, double> asserter = null,
+        bool async = false,
+        bool filteredQuery = false)
+        => RunAndOutputSqlOnFailure(() => base.AssertAverage(actualQuery, expectedQuery, actualSelector, expectedSelector, asserter, async, filteredQuery));
+
+    public override Task AssertAverage<TResult>(
+        Func<ISetSource, IQueryable<TResult>> actualQuery,
+        Func<ISetSource, IQueryable<TResult>> expectedQuery,
+        Expression<Func<TResult, double?>> actualSelector,
+        Expression<Func<TResult, double?>> expectedSelector,
+        Action<double?, double?> asserter = null,
+        bool async = false,
+        bool filteredQuery = false)
+        => RunAndOutputSqlOnFailure(() => base.AssertAverage(actualQuery, expectedQuery, actualSelector, expectedSelector, asserter, async, filteredQuery));
+
+    public override Task AssertAverage<TResult>(
+        Func<ISetSource, IQueryable<TResult>> actualQuery,
+        Func<ISetSource, IQueryable<TResult>> expectedQuery,
+        Expression<Func<TResult, float>> actualSelector,
+        Expression<Func<TResult, float>> expectedSelector,
+        Action<float, float> asserter = null,
+        bool async = false,
+        bool filteredQuery = false)
+        => RunAndOutputSqlOnFailure(() => base.AssertAverage(actualQuery, expectedQuery, actualSelector, expectedSelector, asserter, async, filteredQuery));
+
+    public override Task AssertAverage<TResult>(
+        Func<ISetSource, IQueryable<TResult>> actualQuery,
+        Func<ISetSource, IQueryable<TResult>> expectedQuery,
+        Expression<Func<TResult, float?>> actualSelector,
+        Expression<Func<TResult, float?>> expectedSelector,
+        Action<float?, float?> asserter = null,
+        bool async = false,
+        bool filteredQuery = false)
+        => RunAndOutputSqlOnFailure(() => base.AssertAverage(actualQuery, expectedQuery, actualSelector, expectedSelector, asserter, async, filteredQuery));
+
+    public override Task AssertAverage<TResult>(
+        Func<ISetSource, IQueryable<TResult>> actualQuery,
+        Func<ISetSource, IQueryable<TResult>> expectedQuery,
+        Expression<Func<TResult, int>> actualSelector,
+        Expression<Func<TResult, int>> expectedSelector,
+        Action<double, double> asserter = null,
+        bool async = false,
+        bool filteredQuery = false)
+        => RunAndOutputSqlOnFailure(() => base.AssertAverage(actualQuery, expectedQuery, actualSelector, expectedSelector, asserter, async, filteredQuery));
+
+    public override Task AssertAverage<TResult>(
+        Func<ISetSource, IQueryable<TResult>> actualQuery,
+        Func<ISetSource, IQueryable<TResult>> expectedQuery,
+        Expression<Func<TResult, int?>> actualSelector,
+        Expression<Func<TResult, int?>> expectedSelector,
+        Action<double?, double?> asserter = null,
+        bool async = false,
+        bool filteredQuery = false)
+        => RunAndOutputSqlOnFailure(() => base.AssertAverage(actualQuery, expectedQuery, actualSelector, expectedSelector, asserter, async, filteredQuery));
+
+    public override Task AssertAverage<TResult>(
+        Func<ISetSource, IQueryable<TResult>> actualQuery,
+        Func<ISetSource, IQueryable<TResult>> expectedQuery,
+        Expression<Func<TResult, long>> actualSelector,
+        Expression<Func<TResult, long>> expectedSelector,
+        Action<double, double> asserter = null,
+        bool async = false,
+        bool filteredQuery = false)
+        => RunAndOutputSqlOnFailure(() => base.AssertAverage(actualQuery, expectedQuery, actualSelector, expectedSelector, asserter, async, filteredQuery));
+
+    public override Task AssertAverage<TResult>(
+        Func<ISetSource, IQueryable<TResult>> actualQuery,
+        Func<ISetSource, IQueryable<TResult>> expectedQuery,
+        Expression<Func<TResult, long?>> actualSelector,
+        Expression<Func<TResult, long?>> expectedSelector,
+        Action<double?, double?> asserter = null,
+        bool async = false,
+        bool filteredQuery = false)
+        => RunAndOutputSqlOnFailure(() => base.AssertAverage(actualQuery, expectedQuery, actualSelector, expectedSelector, asserter, async, filteredQuery));
+
+    public override Task AssertCount<TResult>(
+        Func<ISetSource, IQueryable<TResult>> actualQuery,
+        Func<ISetSource, IQueryable<TResult>> expectedQuery,
+        bool async = false,
+        bool filteredQuery = false)
+        => RunAndOutputSqlOnFailure(() => base.AssertCount(actualQuery, expectedQuery, async, filteredQuery));
+
+    public override Task AssertCount<TResult>(
+        Func<ISetSource, IQueryable<TResult>> actualQuery,
+        Func<ISetSource, IQueryable<TResult>> expectedQuery,
+        Expression<Func<TResult, bool>> actualPredicate,
+        Expression<Func<TResult, bool>> expectedPredicate,
+        bool async = false,
+        bool filteredQuery = false)
+        => RunAndOutputSqlOnFailure(() => base.AssertCount(actualQuery, expectedQuery, actualPredicate, expectedPredicate, async, filteredQuery));
+
+    public override Task AssertElementAt<TResult>(
+        Func<ISetSource, IQueryable<TResult>> actualQuery,
+        Func<ISetSource, IQueryable<TResult>> expectedQuery,
+        Func<int> actualIndex,
+        Func<int> expectedIndex,
+        Action<TResult, TResult> asserter = null,
+        bool async = false,
+        bool filteredQuery = false)
+        => RunAndOutputSqlOnFailure(() => base.AssertElementAt(actualQuery, expectedQuery, actualIndex, expectedIndex, asserter, async, filteredQuery));
+
+    public override Task AssertElementAtOrDefault<TResult>(
+        Func<ISetSource, IQueryable<TResult>> actualQuery,
+        Func<ISetSource, IQueryable<TResult>> expectedQuery,
+        Func<int> actualIndex,
+        Func<int> expectedIndex,
+        Action<TResult, TResult> asserter = null,
+        bool async = false,
+        bool filteredQuery = false)
+        => RunAndOutputSqlOnFailure(() => base.AssertElementAtOrDefault(actualQuery, expectedQuery, actualIndex, expectedIndex, asserter, async, filteredQuery));
+
+    public override Task AssertFirst<TResult>(
+        Func<ISetSource, IQueryable<TResult>> actualQuery,
+        Func<ISetSource, IQueryable<TResult>> expectedQuery,
+        Action<TResult, TResult> asserter = null,
+        bool async = false,
+        bool filteredQuery = false)
+        => RunAndOutputSqlOnFailure(() => base.AssertFirst(actualQuery, expectedQuery, asserter, async, filteredQuery));
+
+    public override Task AssertFirst<TResult>(
+        Func<ISetSource, IQueryable<TResult>> actualQuery,
+        Func<ISetSource, IQueryable<TResult>> expectedQuery,
+        Expression<Func<TResult, bool>> actualPredicate,
+        Expression<Func<TResult, bool>> expectedPredicate,
+        Action<TResult, TResult> asserter = null,
+        bool async = false,
+        bool filteredQuery = false)
+        => RunAndOutputSqlOnFailure(() => base.AssertFirst(actualQuery, expectedQuery, actualPredicate, expectedPredicate, asserter, async, filteredQuery));
+
+    public override Task AssertFirstOrDefault<TResult>(
+        Func<ISetSource, IQueryable<TResult>> actualQuery,
+        Func<ISetSource, IQueryable<TResult>> expectedQuery,
+        Action<TResult, TResult> asserter = null,
+        bool async = false,
+        bool filteredQuery = false)
+        => RunAndOutputSqlOnFailure(() => base.AssertFirstOrDefault(actualQuery, expectedQuery, asserter, async, filteredQuery));
+
+    public override Task AssertFirstOrDefault<TResult>(
+        Func<ISetSource, IQueryable<TResult>> actualQuery,
+        Func<ISetSource, IQueryable<TResult>> expectedQuery,
+        Expression<Func<TResult, bool>> actualPredicate,
+        Expression<Func<TResult, bool>> expectedPredicate,
+        Action<TResult, TResult> asserter = null,
+        bool async = false,
+        bool filteredQuery = false)
+        => RunAndOutputSqlOnFailure(() => base.AssertFirstOrDefault(actualQuery, expectedQuery, actualPredicate, expectedPredicate, asserter, async, filteredQuery));
+
+    public override Task AssertLast<TResult>(
+        Func<ISetSource, IQueryable<TResult>> actualQuery,
+        Func<ISetSource, IQueryable<TResult>> expectedQuery,
+        Action<TResult, TResult> asserter = null,
+        bool async = false,
+        bool filteredQuery = false)
+        => RunAndOutputSqlOnFailure(() => base.AssertLast(actualQuery, expectedQuery, asserter, async, filteredQuery));
+
+    public override Task AssertLast<TResult>(
+        Func<ISetSource, IQueryable<TResult>> actualQuery,
+        Func<ISetSource, IQueryable<TResult>> expectedQuery,
+        Expression<Func<TResult, bool>> actualPredicate,
+        Expression<Func<TResult, bool>> expectedPredicate,
+        Action<TResult, TResult> asserter = null,
+        bool async = false,
+        bool filteredQuery = false)
+        => RunAndOutputSqlOnFailure(() => base.AssertLast(actualQuery, expectedQuery, actualPredicate, expectedPredicate, asserter, async, filteredQuery));
+
+    public override Task AssertLastOrDefault<TResult>(
+        Func<ISetSource, IQueryable<TResult>> actualQuery,
+        Func<ISetSource, IQueryable<TResult>> expectedQuery,
+        Action<TResult, TResult> asserter = null,
+        bool async = false,
+        bool filteredQuery = false)
+        => RunAndOutputSqlOnFailure(() => base.AssertLastOrDefault(actualQuery, expectedQuery, asserter, async, filteredQuery));
+
+    public override Task AssertLastOrDefault<TResult>(
+        Func<ISetSource, IQueryable<TResult>> actualQuery,
+        Func<ISetSource, IQueryable<TResult>> expectedQuery,
+        Expression<Func<TResult, bool>> actualPredicate,
+        Expression<Func<TResult, bool>> expectedPredicate,
+        Action<TResult, TResult> asserter = null,
+        bool async = false,
+        bool filteredQuery = false)
+        => RunAndOutputSqlOnFailure(() => base.AssertLastOrDefault(actualQuery, expectedQuery, actualPredicate, expectedPredicate, asserter, async, filteredQuery));
+
+    public override Task AssertLongCount<TResult>(
+        Func<ISetSource, IQueryable<TResult>> actualQuery,
+        Func<ISetSource, IQueryable<TResult>> expectedQuery,
+        bool async = false,
+        bool filteredQuery = false)
+        => RunAndOutputSqlOnFailure(() => base.AssertLongCount(actualQuery, expectedQuery, async, filteredQuery));
+
+    public override Task AssertLongCount<TResult>(
+        Func<ISetSource, IQueryable<TResult>> actualQuery,
+        Func<ISetSource, IQueryable<TResult>> expectedQuery,
+        Expression<Func<TResult, bool>> actualPredicate,
+        Expression<Func<TResult, bool>> expectedPredicate,
+        bool async = false,
+        bool filteredQuery = false)
+        => RunAndOutputSqlOnFailure(() => base.AssertLongCount(actualQuery, expectedQuery, actualPredicate, expectedPredicate, async, filteredQuery));
+
+    public override Task AssertMax<TResult, TSelector>(
+        Func<ISetSource, IQueryable<TResult>> actualQuery,
+        Func<ISetSource, IQueryable<TResult>> expectedQuery,
+        Expression<Func<TResult, TSelector>> actualSelector,
+        Expression<Func<TResult, TSelector>> expectedSelector,
+        Action<TSelector, TSelector> asserter = null,
+        bool async = false,
+        bool filteredQuery = false)
+        => RunAndOutputSqlOnFailure(() => base.AssertMax(actualQuery, expectedQuery, actualSelector, expectedSelector, asserter, async, filteredQuery));
+
+    public override Task AssertMax<TResult>(
+        Func<ISetSource, IQueryable<TResult>> actualQuery,
+        Func<ISetSource, IQueryable<TResult>> expectedQuery,
+        Action<TResult, TResult> asserter = null,
+        bool async = false,
+        bool filteredQuery = false)
+        => RunAndOutputSqlOnFailure(() => base.AssertMax(actualQuery, expectedQuery, asserter, async, filteredQuery));
+
+    public override Task AssertMin<TResult, TSelector>(
+        Func<ISetSource, IQueryable<TResult>> actualQuery,
+        Func<ISetSource, IQueryable<TResult>> expectedQuery,
+        Expression<Func<TResult, TSelector>> actualSelector,
+        Expression<Func<TResult, TSelector>> expectedSelector,
+        Action<TSelector, TSelector> asserter = null,
+        bool async = false,
+        bool filteredQuery = false)
+        => RunAndOutputSqlOnFailure(() => base.AssertMin(actualQuery, expectedQuery, actualSelector, expectedSelector, asserter, async, filteredQuery));
+
+    public override Task AssertMin<TResult>(
+        Func<ISetSource, IQueryable<TResult>> actualQuery,
+        Func<ISetSource, IQueryable<TResult>> expectedQuery,
+        Action<TResult, TResult> asserter = null,
+        bool async = false,
+        bool filteredQuery = false)
+        => RunAndOutputSqlOnFailure(() => base.AssertMin(actualQuery, expectedQuery, asserter, async, filteredQuery));
+
+    public override Task AssertSingle<TResult>(
+        Func<ISetSource, IQueryable<TResult>> actualQuery,
+        Func<ISetSource, IQueryable<TResult>> expectedQuery,
+        Action<TResult, TResult> asserter = null,
+        bool async = false,
+        bool filteredQuery = false)
+        => RunAndOutputSqlOnFailure(() => base.AssertSingle(actualQuery, expectedQuery, asserter, async, filteredQuery));
+
+    public override Task AssertSingle<TResult>(
+        Func<ISetSource, IQueryable<TResult>> actualQuery,
+        Func<ISetSource, IQueryable<TResult>> expectedQuery,
+        Expression<Func<TResult, bool>> actualPredicate,
+        Expression<Func<TResult, bool>> expectedPredicate,
+        Action<TResult, TResult> asserter = null,
+        bool async = false,
+        bool filteredQuery = false)
+        => RunAndOutputSqlOnFailure(() => base.AssertSingle(actualQuery, expectedQuery, actualPredicate, expectedPredicate, asserter, async, filteredQuery));
+
+    public override Task AssertSingleOrDefault<TResult>(
+        Func<ISetSource, IQueryable<TResult>> actualQuery,
+        Func<ISetSource, IQueryable<TResult>> expectedQuery,
+        Action<TResult, TResult> asserter = null,
+        bool async = false,
+        bool filteredQuery = false)
+        => RunAndOutputSqlOnFailure(() => base.AssertSingleOrDefault(actualQuery, expectedQuery, asserter, async, filteredQuery));
+
+    public override Task AssertSingleOrDefault<TResult>(
+        Func<ISetSource, IQueryable<TResult>> actualQuery,
+        Func<ISetSource, IQueryable<TResult>> expectedQuery,
+        Expression<Func<TResult, bool>> actualPredicate,
+        Expression<Func<TResult, bool>> expectedPredicate,
+        Action<TResult, TResult> asserter = null,
+        bool async = false,
+        bool filteredQuery = false)
+        => RunAndOutputSqlOnFailure(() => base.AssertSingleOrDefault(actualQuery, expectedQuery, actualPredicate, expectedPredicate, asserter, async, filteredQuery));
+
+    public override Task AssertSum(
+        Func<ISetSource, IQueryable<decimal>> actualQuery,
+        Func<ISetSource, IQueryable<decimal>> expectedQuery,
+        Action<decimal, decimal> asserter = null,
+        bool async = false,
+        bool filteredQuery = false)
+        => RunAndOutputSqlOnFailure(() => base.AssertSum(actualQuery, expectedQuery, asserter, async, filteredQuery));
+
+    public override Task AssertSum(
+        Func<ISetSource, IQueryable<decimal?>> actualQuery,
+        Func<ISetSource, IQueryable<decimal?>> expectedQuery,
+        Action<decimal?, decimal?> asserter = null,
+        bool async = false,
+        bool filteredQuery = false)
+        => RunAndOutputSqlOnFailure(() => base.AssertSum(actualQuery, expectedQuery, asserter, async, filteredQuery));
+
+    public override Task AssertSum(
+        Func<ISetSource, IQueryable<double>> actualQuery,
+        Func<ISetSource, IQueryable<double>> expectedQuery,
+        Action<double, double> asserter = null,
+        bool async = false,
+        bool filteredQuery = false)
+        => RunAndOutputSqlOnFailure(() => base.AssertSum(actualQuery, expectedQuery, asserter, async, filteredQuery));
+
+    public override Task AssertSum(
+        Func<ISetSource, IQueryable<double?>> actualQuery,
+        Func<ISetSource, IQueryable<double?>> expectedQuery,
+        Action<double?, double?> asserter = null,
+        bool async = false,
+        bool filteredQuery = false)
+        => RunAndOutputSqlOnFailure(() => base.AssertSum(actualQuery, expectedQuery, asserter, async, filteredQuery));
+
+    public override Task AssertSum(
+        Func<ISetSource, IQueryable<float>> actualQuery,
+        Func<ISetSource, IQueryable<float>> expectedQuery,
+        Action<float, float> asserter = null,
+        bool async = false,
+        bool filteredQuery = false)
+        => RunAndOutputSqlOnFailure(() => base.AssertSum(actualQuery, expectedQuery, asserter, async, filteredQuery));
+
+    public override Task AssertSum(
+        Func<ISetSource, IQueryable<float?>> actualQuery,
+        Func<ISetSource, IQueryable<float?>> expectedQuery,
+        Action<float?, float?> asserter = null,
+        bool async = false,
+        bool filteredQuery = false)
+        => RunAndOutputSqlOnFailure(() => base.AssertSum(actualQuery, expectedQuery, asserter, async, filteredQuery));
+
+    public override Task AssertSum(
+        Func<ISetSource, IQueryable<int>> actualQuery,
+        Func<ISetSource, IQueryable<int>> expectedQuery,
+        Action<int, int> asserter = null,
+        bool async = false,
+        bool filteredQuery = false)
+        => RunAndOutputSqlOnFailure(() => base.AssertSum(actualQuery, expectedQuery, asserter, async, filteredQuery));
+
+    public override Task AssertSum(
+        Func<ISetSource, IQueryable<int?>> actualQuery,
+        Func<ISetSource, IQueryable<int?>> expectedQuery,
+        Action<int?, int?> asserter = null,
+        bool async = false,
+        bool filteredQuery = false)
+        => RunAndOutputSqlOnFailure(() => base.AssertSum(actualQuery, expectedQuery, asserter, async, filteredQuery));
+
+    public override Task AssertSum(
+        Func<ISetSource, IQueryable<long>> actualQuery,
+        Func<ISetSource, IQueryable<long>> expectedQuery,
+        Action<long, long> asserter = null,
+        bool async = false,
+        bool filteredQuery = false)
+        => RunAndOutputSqlOnFailure(() => base.AssertSum(actualQuery, expectedQuery, asserter, async, filteredQuery));
+
+    public override Task AssertSum(
+        Func<ISetSource, IQueryable<long?>> actualQuery,
+        Func<ISetSource, IQueryable<long?>> expectedQuery,
+        Action<long?, long?> asserter = null,
+        bool async = false,
+        bool filteredQuery = false)
+        => RunAndOutputSqlOnFailure(() => base.AssertSum(actualQuery, expectedQuery, asserter, async, filteredQuery));
+
+    public override Task AssertSum<TResult>(
+        Func<ISetSource, IQueryable<TResult>> actualQuery,
+        Func<ISetSource, IQueryable<TResult>> expectedQuery,
+        Expression<Func<TResult, decimal>> actualSelector,
+        Expression<Func<TResult, decimal>> expectedSelector,
+        Action<decimal, decimal> asserter = null,
+        bool async = false,
+        bool filteredQuery = false)
+        => RunAndOutputSqlOnFailure(() => base.AssertSum(actualQuery, expectedQuery, actualSelector, expectedSelector, asserter, async, filteredQuery));
+
+    public override Task AssertSum<TResult>(
+        Func<ISetSource, IQueryable<TResult>> actualQuery,
+        Func<ISetSource, IQueryable<TResult>> expectedQuery,
+        Expression<Func<TResult, decimal?>> actualSelector,
+        Expression<Func<TResult, decimal?>> expectedSelector,
+        Action<decimal?, decimal?> asserter = null,
+        bool async = false,
+        bool filteredQuery = false)
+        => RunAndOutputSqlOnFailure(() => base.AssertSum(actualQuery, expectedQuery, actualSelector, expectedSelector, asserter, async, filteredQuery));
+
+    public override Task AssertSum<TResult>(
+        Func<ISetSource, IQueryable<TResult>> actualQuery,
+        Func<ISetSource, IQueryable<TResult>> expectedQuery,
+        Expression<Func<TResult, double>> actualSelector,
+        Expression<Func<TResult, double>> expectedSelector,
+        Action<double, double> asserter = null,
+        bool async = false,
+        bool filteredQuery = false)
+        => RunAndOutputSqlOnFailure(() => base.AssertSum(actualQuery, expectedQuery, actualSelector, expectedSelector, asserter, async, filteredQuery));
+
+    public override Task AssertSum<TResult>(
+        Func<ISetSource, IQueryable<TResult>> actualQuery,
+        Func<ISetSource, IQueryable<TResult>> expectedQuery,
+        Expression<Func<TResult, double?>> actualSelector,
+        Expression<Func<TResult, double?>> expectedSelector,
+        Action<double?, double?> asserter = null,
+        bool async = false,
+        bool filteredQuery = false)
+        => RunAndOutputSqlOnFailure(() => base.AssertSum(actualQuery, expectedQuery, actualSelector, expectedSelector, asserter, async, filteredQuery));
+
+    public override Task AssertSum<TResult>(
+        Func<ISetSource, IQueryable<TResult>> actualQuery,
+        Func<ISetSource, IQueryable<TResult>> expectedQuery,
+        Expression<Func<TResult, float>> actualSelector,
+        Expression<Func<TResult, float>> expectedSelector,
+        Action<float, float> asserter = null,
+        bool async = false,
+        bool filteredQuery = false)
+        => RunAndOutputSqlOnFailure(() => base.AssertSum(actualQuery, expectedQuery, actualSelector, expectedSelector, asserter, async, filteredQuery));
+
+    public override Task AssertSum<TResult>(
+        Func<ISetSource, IQueryable<TResult>> actualQuery,
+        Func<ISetSource, IQueryable<TResult>> expectedQuery,
+        Expression<Func<TResult, float?>> actualSelector,
+        Expression<Func<TResult, float?>> expectedSelector,
+        Action<float?, float?> asserter = null,
+        bool async = false,
+        bool filteredQuery = false)
+        => RunAndOutputSqlOnFailure(() => base.AssertSum(actualQuery, expectedQuery, actualSelector, expectedSelector, asserter, async, filteredQuery));
+
+    public override Task AssertSum<TResult>(
+        Func<ISetSource, IQueryable<TResult>> actualQuery,
+        Func<ISetSource, IQueryable<TResult>> expectedQuery,
+        Expression<Func<TResult, int>> actualSelector,
+        Expression<Func<TResult, int>> expectedSelector,
+        Action<int, int> asserter = null,
+        bool async = false,
+        bool filteredQuery = false)
+        => RunAndOutputSqlOnFailure(() => base.AssertSum(actualQuery, expectedQuery, actualSelector, expectedSelector, asserter, async, filteredQuery));
+
+    public override Task AssertSum<TResult>(
+        Func<ISetSource, IQueryable<TResult>> actualQuery,
+        Func<ISetSource, IQueryable<TResult>> expectedQuery,
+        Expression<Func<TResult, int?>> actualSelector,
+        Expression<Func<TResult, int?>> expectedSelector,
+        Action<int?, int?> asserter = null,
+        bool async = false,
+        bool filteredQuery = false)
+        => RunAndOutputSqlOnFailure(() => base.AssertSum(actualQuery, expectedQuery, actualSelector, expectedSelector, asserter, async, filteredQuery));
+
+    public override Task AssertSum<TResult>(
+        Func<ISetSource, IQueryable<TResult>> actualQuery,
+        Func<ISetSource, IQueryable<TResult>> expectedQuery,
+        Expression<Func<TResult, long>> actualSelector,
+        Expression<Func<TResult, long>> expectedSelector,
+        Action<long, long> asserter = null,
+        bool async = false,
+        bool filteredQuery = false)
+        => RunAndOutputSqlOnFailure(() => base.AssertSum(actualQuery, expectedQuery, actualSelector, expectedSelector, asserter, async, filteredQuery));
+
+    public override Task AssertSum<TResult>(
+        Func<ISetSource, IQueryable<TResult>> actualQuery,
+        Func<ISetSource, IQueryable<TResult>> expectedQuery,
+        Expression<Func<TResult, long?>> actualSelector,
+        Expression<Func<TResult, long?>> expectedSelector,
+        Action<long?, long?> asserter = null,
+        bool async = false,
+        bool filteredQuery = false)
+        => RunAndOutputSqlOnFailure(() => base.AssertSum(actualQuery, expectedQuery, actualSelector, expectedSelector, asserter, async, filteredQuery));
 }
diff --git a/test/EFCore.Relational.Specification.Tests/TestUtilities/TestSqlLoggerFactory.cs b/test/EFCore.Relational.Specification.Tests/TestUtilities/TestSqlLoggerFactory.cs
index 5d010ffee1..0c4bf2265f 100644
--- a/test/EFCore.Relational.Specification.Tests/TestUtilities/TestSqlLoggerFactory.cs
+++ b/test/EFCore.Relational.Specification.Tests/TestUtilities/TestSqlLoggerFactory.cs
@@ -41,6 +41,12 @@ public IReadOnlyList<string> Parameters
     public string Sql
         => string.Join(_eol + _eol, SqlStatements);
 
+    public void OutputSql()
+    {
+        Logger.TestOutputHelper?.WriteLine("SQL sent to the database:");
+        Logger.TestOutputHelper?.WriteLine(Sql);
+    }
+
     public void AssertBaseline(string[] expected, bool assertOrder = true, bool forUpdate = false)
     {
         if (_proceduralQueryGeneration)
diff --git a/test/EFCore.Specification.Tests/TestUtilities/QueryAsserter.cs b/test/EFCore.Specification.Tests/TestUtilities/QueryAsserter.cs
index 2629742c55..7d89e3dc7a 100644
--- a/test/EFCore.Specification.Tests/TestUtilities/QueryAsserter.cs
+++ b/test/EFCore.Specification.Tests/TestUtilities/QueryAsserter.cs
@@ -44,7 +44,7 @@ protected virtual void AssertRogueExecution(int expectedCount, IQueryable querya
     protected ISetSource GetExpectedData(DbContext context, bool filteredQuery)
         => filteredQuery ? ((IFilteredQueryFixtureBase)QueryFixture).GetFilteredExpectedData(context) : _expectedData;
 
-    public async Task AssertSingleResult<TResult>(
+    public virtual async Task AssertSingleResult<TResult>(
         Expression<Func<ISetSource, TResult>> actualSyncQuery,
         Expression<Func<ISetSource, Task<TResult>>> actualAsyncQuery,
         Expression<Func<ISetSource, TResult>> expectedQuery,
@@ -64,7 +64,7 @@ protected ISetSource GetExpectedData(DbContext context, bool filteredQuery)
         AssertEqual(expected, actual, asserter);
     }
 
-    public async Task AssertQuery<TResult>(
+    public virtual async Task AssertQuery<TResult>(
         Func<ISetSource, IQueryable<TResult>> actualQuery,
         Func<ISetSource, IQueryable<TResult>> expectedQuery,
         Func<TResult, object> elementSorter,
@@ -155,7 +155,7 @@ private void OrderingSettingsVerifier(bool assertOrder, Type type, object elemen
         }
     }
 
-    public async Task AssertQueryScalar<TResult>(
+    public virtual async Task AssertQueryScalar<TResult>(
         Func<ISetSource, IQueryable<TResult>> actualQuery,
         Func<ISetSource, IQueryable<TResult>> expectedQuery,
         Action<TResult, TResult> asserter,
@@ -196,7 +196,7 @@ private void OrderingSettingsVerifier(bool assertOrder, Type type, object elemen
         AssertResultCount(actual.Count, assertEmpty);
     }
 
-    public async Task AssertQueryScalar<TResult>(
+    public virtual async Task AssertQueryScalar<TResult>(
         Func<ISetSource, IQueryable<TResult?>> actualQuery,
         Func<ISetSource, IQueryable<TResult?>> expectedQuery,
         Action<TResult?, TResult?> asserter,
@@ -239,7 +239,7 @@ private void OrderingSettingsVerifier(bool assertOrder, Type type, object elemen
 
     #region Assert termination operation methods
 
-    public async Task AssertAny<TResult>(
+    public virtual async Task AssertAny<TResult>(
         Func<ISetSource, IQueryable<TResult>> actualQuery,
         Func<ISetSource, IQueryable<TResult>> expectedQuery,
         bool async = false,
@@ -256,7 +256,7 @@ private void OrderingSettingsVerifier(bool assertOrder, Type type, object elemen
         Assert.Equal(expected, actual);
     }
 
-    public async Task AssertAny<TResult>(
+    public virtual async Task AssertAny<TResult>(
         Func<ISetSource, IQueryable<TResult>> actualQuery,
         Func<ISetSource, IQueryable<TResult>> expectedQuery,
         Expression<Func<TResult, bool>> actualPredicate,
@@ -277,7 +277,7 @@ private void OrderingSettingsVerifier(bool assertOrder, Type type, object elemen
         Assert.Equal(expected, actual);
     }
 
-    public async Task AssertAll<TResult>(
+    public virtual async Task AssertAll<TResult>(
         Func<ISetSource, IQueryable<TResult>> actualQuery,
         Func<ISetSource, IQueryable<TResult>> expectedQuery,
         Expression<Func<TResult, bool>> actualPredicate,
@@ -298,7 +298,7 @@ private void OrderingSettingsVerifier(bool assertOrder, Type type, object elemen
         Assert.Equal(expected, actual);
     }
 
-    public async Task AssertElementAt<TResult>(
+    public virtual async Task AssertElementAt<TResult>(
         Func<ISetSource, IQueryable<TResult>> actualQuery,
         Func<ISetSource, IQueryable<TResult>> expectedQuery,
         Func<int> actualIndex,
@@ -318,7 +318,7 @@ private void OrderingSettingsVerifier(bool assertOrder, Type type, object elemen
         AssertEqual(expected, actual, asserter);
     }
 
-    public async Task AssertElementAtOrDefault<TResult>(
+    public virtual async Task AssertElementAtOrDefault<TResult>(
         Func<ISetSource, IQueryable<TResult>> actualQuery,
         Func<ISetSource, IQueryable<TResult>> expectedQuery,
         Func<int> actualIndex,
@@ -338,7 +338,7 @@ private void OrderingSettingsVerifier(bool assertOrder, Type type, object elemen
         AssertEqual(expected, actual, asserter);
     }
 
-    public async Task AssertFirst<TResult>(
+    public virtual async Task AssertFirst<TResult>(
         Func<ISetSource, IQueryable<TResult>> actualQuery,
         Func<ISetSource, IQueryable<TResult>> expectedQuery,
         Action<TResult, TResult> asserter = null,
@@ -356,7 +356,7 @@ private void OrderingSettingsVerifier(bool assertOrder, Type type, object elemen
         AssertEqual(expected, actual, asserter);
     }
 
-    public async Task AssertFirst<TResult>(
+    public virtual async Task AssertFirst<TResult>(
         Func<ISetSource, IQueryable<TResult>> actualQuery,
         Func<ISetSource, IQueryable<TResult>> expectedQuery,
         Expression<Func<TResult, bool>> actualPredicate,
@@ -378,7 +378,7 @@ private void OrderingSettingsVerifier(bool assertOrder, Type type, object elemen
         AssertEqual(expected, actual, asserter);
     }
 
-    public async Task AssertFirstOrDefault<TResult>(
+    public virtual async Task AssertFirstOrDefault<TResult>(
         Func<ISetSource, IQueryable<TResult>> actualQuery,
         Func<ISetSource, IQueryable<TResult>> expectedQuery,
         Action<TResult, TResult> asserter = null,
@@ -396,7 +396,7 @@ private void OrderingSettingsVerifier(bool assertOrder, Type type, object elemen
         AssertEqual(expected, actual, asserter);
     }
 
-    public async Task AssertFirstOrDefault<TResult>(
+    public virtual async Task AssertFirstOrDefault<TResult>(
         Func<ISetSource, IQueryable<TResult>> actualQuery,
         Func<ISetSource, IQueryable<TResult>> expectedQuery,
         Expression<Func<TResult, bool>> actualPredicate,
@@ -418,7 +418,7 @@ private void OrderingSettingsVerifier(bool assertOrder, Type type, object elemen
         AssertEqual(expected, actual, asserter);
     }
 
-    public async Task AssertSingle<TResult>(
+    public virtual async Task AssertSingle<TResult>(
         Func<ISetSource, IQueryable<TResult>> actualQuery,
         Func<ISetSource, IQueryable<TResult>> expectedQuery,
         Action<TResult, TResult> asserter = null,
@@ -436,7 +436,7 @@ private void OrderingSettingsVerifier(bool assertOrder, Type type, object elemen
         AssertEqual(expected, actual, asserter);
     }
 
-    public async Task AssertSingle<TResult>(
+    public virtual async Task AssertSingle<TResult>(
         Func<ISetSource, IQueryable<TResult>> actualQuery,
         Func<ISetSource, IQueryable<TResult>> expectedQuery,
         Expression<Func<TResult, bool>> actualPredicate,
@@ -458,7 +458,7 @@ private void OrderingSettingsVerifier(bool assertOrder, Type type, object elemen
         AssertEqual(expected, actual, asserter);
     }
 
-    public async Task AssertSingleOrDefault<TResult>(
+    public virtual async Task AssertSingleOrDefault<TResult>(
         Func<ISetSource, IQueryable<TResult>> actualQuery,
         Func<ISetSource, IQueryable<TResult>> expectedQuery,
         Action<TResult, TResult> asserter = null,
@@ -476,7 +476,7 @@ private void OrderingSettingsVerifier(bool assertOrder, Type type, object elemen
         AssertEqual(expected, actual, asserter);
     }
 
-    public async Task AssertSingleOrDefault<TResult>(
+    public virtual async Task AssertSingleOrDefault<TResult>(
         Func<ISetSource, IQueryable<TResult>> actualQuery,
         Func<ISetSource, IQueryable<TResult>> expectedQuery,
         Expression<Func<TResult, bool>> actualPredicate,
@@ -498,7 +498,7 @@ private void OrderingSettingsVerifier(bool assertOrder, Type type, object elemen
         AssertEqual(expected, actual, asserter);
     }
 
-    public async Task AssertLast<TResult>(
+    public virtual async Task AssertLast<TResult>(
         Func<ISetSource, IQueryable<TResult>> actualQuery,
         Func<ISetSource, IQueryable<TResult>> expectedQuery,
         Action<TResult, TResult> asserter = null,
@@ -516,7 +516,7 @@ private void OrderingSettingsVerifier(bool assertOrder, Type type, object elemen
         AssertEqual(expected, actual, asserter);
     }
 
-    public async Task AssertLast<TResult>(
+    public virtual async Task AssertLast<TResult>(
         Func<ISetSource, IQueryable<TResult>> actualQuery,
         Func<ISetSource, IQueryable<TResult>> expectedQuery,
         Expression<Func<TResult, bool>> actualPredicate,
@@ -538,7 +538,7 @@ private void OrderingSettingsVerifier(bool assertOrder, Type type, object elemen
         AssertEqual(expected, actual, asserter);
     }
 
-    public async Task AssertLastOrDefault<TResult>(
+    public virtual async Task AssertLastOrDefault<TResult>(
         Func<ISetSource, IQueryable<TResult>> actualQuery,
         Func<ISetSource, IQueryable<TResult>> expectedQuery,
         Action<TResult, TResult> asserter = null,
@@ -556,7 +556,7 @@ private void OrderingSettingsVerifier(bool assertOrder, Type type, object elemen
         AssertEqual(expected, actual, asserter);
     }
 
-    public async Task AssertLastOrDefault<TResult>(
+    public virtual async Task AssertLastOrDefault<TResult>(
         Func<ISetSource, IQueryable<TResult>> actualQuery,
         Func<ISetSource, IQueryable<TResult>> expectedQuery,
         Expression<Func<TResult, bool>> actualPredicate,
@@ -578,7 +578,7 @@ private void OrderingSettingsVerifier(bool assertOrder, Type type, object elemen
         AssertEqual(expected, actual, asserter);
     }
 
-    public async Task AssertCount<TResult>(
+    public virtual async Task AssertCount<TResult>(
         Func<ISetSource, IQueryable<TResult>> actualQuery,
         Func<ISetSource, IQueryable<TResult>> expectedQuery,
         bool async = false,
@@ -596,7 +596,7 @@ private void OrderingSettingsVerifier(bool assertOrder, Type type, object elemen
         Assert.Empty(context.ChangeTracker.Entries());
     }
 
-    public async Task AssertCount<TResult>(
+    public virtual async Task AssertCount<TResult>(
         Func<ISetSource, IQueryable<TResult>> actualQuery,
         Func<ISetSource, IQueryable<TResult>> expectedQuery,
         Expression<Func<TResult, bool>> actualPredicate,
@@ -618,7 +618,7 @@ private void OrderingSettingsVerifier(bool assertOrder, Type type, object elemen
         Assert.Empty(context.ChangeTracker.Entries());
     }
 
-    public async Task AssertLongCount<TResult>(
+    public virtual async Task AssertLongCount<TResult>(
         Func<ISetSource, IQueryable<TResult>> actualQuery,
         Func<ISetSource, IQueryable<TResult>> expectedQuery,
         bool async = false,
@@ -636,7 +636,7 @@ private void OrderingSettingsVerifier(bool assertOrder, Type type, object elemen
         Assert.Empty(context.ChangeTracker.Entries());
     }
 
-    public async Task AssertLongCount<TResult>(
+    public virtual async Task AssertLongCount<TResult>(
         Func<ISetSource, IQueryable<TResult>> actualQuery,
         Func<ISetSource, IQueryable<TResult>> expectedQuery,
         Expression<Func<TResult, bool>> actualPredicate,
@@ -658,7 +658,7 @@ private void OrderingSettingsVerifier(bool assertOrder, Type type, object elemen
         Assert.Empty(context.ChangeTracker.Entries());
     }
 
-    public async Task AssertMin<TResult>(
+    public virtual async Task AssertMin<TResult>(
         Func<ISetSource, IQueryable<TResult>> actualQuery,
         Func<ISetSource, IQueryable<TResult>> expectedQuery,
         Action<TResult, TResult> asserter = null,
@@ -676,7 +676,7 @@ private void OrderingSettingsVerifier(bool assertOrder, Type type, object elemen
         AssertEqual(expected, actual, asserter);
     }
 
-    public async Task AssertMin<TResult, TSelector>(
+    public virtual async Task AssertMin<TResult, TSelector>(
         Func<ISetSource, IQueryable<TResult>> actualQuery,
         Func<ISetSource, IQueryable<TResult>> expectedQuery,
         Expression<Func<TResult, TSelector>> actualSelector,
@@ -699,7 +699,7 @@ private void OrderingSettingsVerifier(bool assertOrder, Type type, object elemen
         AssertEqual(expected, actual, asserter);
     }
 
-    public async Task AssertMax<TResult>(
+    public virtual async Task AssertMax<TResult>(
         Func<ISetSource, IQueryable<TResult>> actualQuery,
         Func<ISetSource, IQueryable<TResult>> expectedQuery,
         Action<TResult, TResult> asserter = null,
@@ -717,7 +717,7 @@ private void OrderingSettingsVerifier(bool assertOrder, Type type, object elemen
         AssertEqual(expected, actual, asserter);
     }
 
-    public async Task AssertMax<TResult, TSelector>(
+    public virtual async Task AssertMax<TResult, TSelector>(
         Func<ISetSource, IQueryable<TResult>> actualQuery,
         Func<ISetSource, IQueryable<TResult>> expectedQuery,
         Expression<Func<TResult, TSelector>> actualSelector,
@@ -740,7 +740,7 @@ private void OrderingSettingsVerifier(bool assertOrder, Type type, object elemen
         AssertEqual(expected, actual, asserter);
     }
 
-    public async Task AssertSum(
+    public virtual async Task AssertSum(
         Func<ISetSource, IQueryable<int>> actualQuery,
         Func<ISetSource, IQueryable<int>> expectedQuery,
         Action<int, int> asserter = null,
@@ -759,7 +759,7 @@ private void OrderingSettingsVerifier(bool assertOrder, Type type, object elemen
         Assert.Empty(context.ChangeTracker.Entries());
     }
 
-    public async Task AssertSum(
+    public virtual async Task AssertSum(
         Func<ISetSource, IQueryable<int?>> actualQuery,
         Func<ISetSource, IQueryable<int?>> expectedQuery,
         Action<int?, int?> asserter = null,
@@ -778,7 +778,7 @@ private void OrderingSettingsVerifier(bool assertOrder, Type type, object elemen
         Assert.Empty(context.ChangeTracker.Entries());
     }
 
-    public async Task AssertSum(
+    public virtual async Task AssertSum(
         Func<ISetSource, IQueryable<long>> actualQuery,
         Func<ISetSource, IQueryable<long>> expectedQuery,
         Action<long, long> asserter = null,
@@ -797,7 +797,7 @@ private void OrderingSettingsVerifier(bool assertOrder, Type type, object elemen
         Assert.Empty(context.ChangeTracker.Entries());
     }
 
-    public async Task AssertSum(
+    public virtual async Task AssertSum(
         Func<ISetSource, IQueryable<long?>> actualQuery,
         Func<ISetSource, IQueryable<long?>> expectedQuery,
         Action<long?, long?> asserter = null,
@@ -816,7 +816,7 @@ private void OrderingSettingsVerifier(bool assertOrder, Type type, object elemen
         Assert.Empty(context.ChangeTracker.Entries());
     }
 
-    public async Task AssertSum(
+    public virtual async Task AssertSum(
         Func<ISetSource, IQueryable<decimal>> actualQuery,
         Func<ISetSource, IQueryable<decimal>> expectedQuery,
         Action<decimal, decimal> asserter = null,
@@ -835,7 +835,7 @@ private void OrderingSettingsVerifier(bool assertOrder, Type type, object elemen
         Assert.Empty(context.ChangeTracker.Entries());
     }
 
-    public async Task AssertSum(
+    public virtual async Task AssertSum(
         Func<ISetSource, IQueryable<decimal?>> actualQuery,
         Func<ISetSource, IQueryable<decimal?>> expectedQuery,
         Action<decimal?, decimal?> asserter = null,
@@ -854,7 +854,7 @@ private void OrderingSettingsVerifier(bool assertOrder, Type type, object elemen
         Assert.Empty(context.ChangeTracker.Entries());
     }
 
-    public async Task AssertSum(
+    public virtual async Task AssertSum(
         Func<ISetSource, IQueryable<float>> actualQuery,
         Func<ISetSource, IQueryable<float>> expectedQuery,
         Action<float, float> asserter = null,
@@ -873,7 +873,7 @@ private void OrderingSettingsVerifier(bool assertOrder, Type type, object elemen
         Assert.Empty(context.ChangeTracker.Entries());
     }
 
-    public async Task AssertSum(
+    public virtual async Task AssertSum(
         Func<ISetSource, IQueryable<float?>> actualQuery,
         Func<ISetSource, IQueryable<float?>> expectedQuery,
         Action<float?, float?> asserter = null,
@@ -892,7 +892,7 @@ private void OrderingSettingsVerifier(bool assertOrder, Type type, object elemen
         Assert.Empty(context.ChangeTracker.Entries());
     }
 
-    public async Task AssertSum(
+    public virtual async Task AssertSum(
         Func<ISetSource, IQueryable<double>> actualQuery,
         Func<ISetSource, IQueryable<double>> expectedQuery,
         Action<double, double> asserter = null,
@@ -911,7 +911,7 @@ private void OrderingSettingsVerifier(bool assertOrder, Type type, object elemen
         Assert.Empty(context.ChangeTracker.Entries());
     }
 
-    public async Task AssertSum(
+    public virtual async Task AssertSum(
         Func<ISetSource, IQueryable<double?>> actualQuery,
         Func<ISetSource, IQueryable<double?>> expectedQuery,
         Action<double?, double?> asserter = null,
@@ -930,7 +930,7 @@ private void OrderingSettingsVerifier(bool assertOrder, Type type, object elemen
         Assert.Empty(context.ChangeTracker.Entries());
     }
 
-    public async Task AssertSum<TResult>(
+    public virtual async Task AssertSum<TResult>(
         Func<ISetSource, IQueryable<TResult>> actualQuery,
         Func<ISetSource, IQueryable<TResult>> expectedQuery,
         Expression<Func<TResult, int>> actualSelector,
@@ -953,7 +953,7 @@ private void OrderingSettingsVerifier(bool assertOrder, Type type, object elemen
         Assert.Empty(context.ChangeTracker.Entries());
     }
 
-    public async Task AssertSum<TResult>(
+    public virtual async Task AssertSum<TResult>(
         Func<ISetSource, IQueryable<TResult>> actualQuery,
         Func<ISetSource, IQueryable<TResult>> expectedQuery,
         Expression<Func<TResult, int?>> actualSelector,
@@ -976,7 +976,7 @@ private void OrderingSettingsVerifier(bool assertOrder, Type type, object elemen
         Assert.Empty(context.ChangeTracker.Entries());
     }
 
-    public async Task AssertSum<TResult>(
+    public virtual async Task AssertSum<TResult>(
         Func<ISetSource, IQueryable<TResult>> actualQuery,
         Func<ISetSource, IQueryable<TResult>> expectedQuery,
         Expression<Func<TResult, long>> actualSelector,
@@ -999,7 +999,7 @@ private void OrderingSettingsVerifier(bool assertOrder, Type type, object elemen
         Assert.Empty(context.ChangeTracker.Entries());
     }
 
-    public async Task AssertSum<TResult>(
+    public virtual async Task AssertSum<TResult>(
         Func<ISetSource, IQueryable<TResult>> actualQuery,
         Func<ISetSource, IQueryable<TResult>> expectedQuery,
         Expression<Func<TResult, long?>> actualSelector,
@@ -1022,7 +1022,7 @@ private void OrderingSettingsVerifier(bool assertOrder, Type type, object elemen
         Assert.Empty(context.ChangeTracker.Entries());
     }
 
-    public async Task AssertSum<TResult>(
+    public virtual async Task AssertSum<TResult>(
         Func<ISetSource, IQueryable<TResult>> actualQuery,
         Func<ISetSource, IQueryable<TResult>> expectedQuery,
         Expression<Func<TResult, decimal>> actualSelector,
@@ -1045,7 +1045,7 @@ private void OrderingSettingsVerifier(bool assertOrder, Type type, object elemen
         Assert.Empty(context.ChangeTracker.Entries());
     }
 
-    public async Task AssertSum<TResult>(
+    public virtual async Task AssertSum<TResult>(
         Func<ISetSource, IQueryable<TResult>> actualQuery,
         Func<ISetSource, IQueryable<TResult>> expectedQuery,
         Expression<Func<TResult, decimal?>> actualSelector,
@@ -1069,7 +1069,7 @@ private void OrderingSettingsVerifier(bool assertOrder, Type type, object elemen
         Assert.Empty(context.ChangeTracker.Entries());
     }
 
-    public async Task AssertSum<TResult>(
+    public virtual async Task AssertSum<TResult>(
         Func<ISetSource, IQueryable<TResult>> actualQuery,
         Func<ISetSource, IQueryable<TResult>> expectedQuery,
         Expression<Func<TResult, float>> actualSelector,
@@ -1092,7 +1092,7 @@ private void OrderingSettingsVerifier(bool assertOrder, Type type, object elemen
         Assert.Empty(context.ChangeTracker.Entries());
     }
 
-    public async Task AssertSum<TResult>(
+    public virtual async Task AssertSum<TResult>(
         Func<ISetSource, IQueryable<TResult>> actualQuery,
         Func<ISetSource, IQueryable<TResult>> expectedQuery,
         Expression<Func<TResult, float?>> actualSelector,
@@ -1115,7 +1115,7 @@ private void OrderingSettingsVerifier(bool assertOrder, Type type, object elemen
         Assert.Empty(context.ChangeTracker.Entries());
     }
 
-    public async Task AssertSum<TResult>(
+    public virtual async Task AssertSum<TResult>(
         Func<ISetSource, IQueryable<TResult>> actualQuery,
         Func<ISetSource, IQueryable<TResult>> expectedQuery,
         Expression<Func<TResult, double>> actualSelector,
@@ -1138,7 +1138,7 @@ private void OrderingSettingsVerifier(bool assertOrder, Type type, object elemen
         Assert.Empty(context.ChangeTracker.Entries());
     }
 
-    public async Task AssertSum<TResult>(
+    public virtual async Task AssertSum<TResult>(
         Func<ISetSource, IQueryable<TResult>> actualQuery,
         Func<ISetSource, IQueryable<TResult>> expectedQuery,
         Expression<Func<TResult, double?>> actualSelector,
@@ -1161,7 +1161,7 @@ private void OrderingSettingsVerifier(bool assertOrder, Type type, object elemen
         Assert.Empty(context.ChangeTracker.Entries());
     }
 
-    public async Task AssertAverage(
+    public virtual async Task AssertAverage(
         Func<ISetSource, IQueryable<int>> actualQuery,
         Func<ISetSource, IQueryable<int>> expectedQuery,
         Action<double, double> asserter = null,
@@ -1180,7 +1180,7 @@ private void OrderingSettingsVerifier(bool assertOrder, Type type, object elemen
         Assert.Empty(context.ChangeTracker.Entries());
     }
 
-    public async Task AssertAverage(
+    public virtual async Task AssertAverage(
         Func<ISetSource, IQueryable<int?>> actualQuery,
         Func<ISetSource, IQueryable<int?>> expectedQuery,
         Action<double?, double?> asserter = null,
@@ -1199,7 +1199,7 @@ private void OrderingSettingsVerifier(bool assertOrder, Type type, object elemen
         Assert.Empty(context.ChangeTracker.Entries());
     }
 
-    public async Task AssertAverage(
+    public virtual async Task AssertAverage(
         Func<ISetSource, IQueryable<long>> actualQuery,
         Func<ISetSource, IQueryable<long>> expectedQuery,
         Action<double, double> asserter = null,
@@ -1218,7 +1218,7 @@ private void OrderingSettingsVerifier(bool assertOrder, Type type, object elemen
         Assert.Empty(context.ChangeTracker.Entries());
     }
 
-    public async Task AssertAverage(
+    public virtual async Task AssertAverage(
         Func<ISetSource, IQueryable<long?>> actualQuery,
         Func<ISetSource, IQueryable<long?>> expectedQuery,
         Action<double?, double?> asserter = null,
@@ -1237,7 +1237,7 @@ private void OrderingSettingsVerifier(bool assertOrder, Type type, object elemen
         Assert.Empty(context.ChangeTracker.Entries());
     }
 
-    public async Task AssertAverage(
+    public virtual async Task AssertAverage(
         Func<ISetSource, IQueryable<decimal>> actualQuery,
         Func<ISetSource, IQueryable<decimal>> expectedQuery,
         Action<decimal, decimal> asserter = null,
@@ -1256,7 +1256,7 @@ private void OrderingSettingsVerifier(bool assertOrder, Type type, object elemen
         Assert.Empty(context.ChangeTracker.Entries());
     }
 
-    public async Task AssertAverage(
+    public virtual async Task AssertAverage(
         Func<ISetSource, IQueryable<decimal?>> actualQuery,
         Func<ISetSource, IQueryable<decimal?>> expectedQuery,
         Action<decimal?, decimal?> asserter = null,
@@ -1275,7 +1275,7 @@ private void OrderingSettingsVerifier(bool assertOrder, Type type, object elemen
         Assert.Empty(context.ChangeTracker.Entries());
     }
 
-    public async Task AssertAverage(
+    public virtual async Task AssertAverage(
         Func<ISetSource, IQueryable<float>> actualQuery,
         Func<ISetSource, IQueryable<float>> expectedQuery,
         Action<float, float> asserter = null,
@@ -1294,7 +1294,7 @@ private void OrderingSettingsVerifier(bool assertOrder, Type type, object elemen
         Assert.Empty(context.ChangeTracker.Entries());
     }
 
-    public async Task AssertAverage(
+    public virtual async Task AssertAverage(
         Func<ISetSource, IQueryable<float?>> actualQuery,
         Func<ISetSource, IQueryable<float?>> expectedQuery,
         Action<float?, float?> asserter = null,
@@ -1313,7 +1313,7 @@ private void OrderingSettingsVerifier(bool assertOrder, Type type, object elemen
         Assert.Empty(context.ChangeTracker.Entries());
     }
 
-    public async Task AssertAverage(
+    public virtual async Task AssertAverage(
         Func<ISetSource, IQueryable<double>> actualQuery,
         Func<ISetSource, IQueryable<double>> expectedQuery,
         Action<double, double> asserter = null,
@@ -1332,7 +1332,7 @@ private void OrderingSettingsVerifier(bool assertOrder, Type type, object elemen
         Assert.Empty(context.ChangeTracker.Entries());
     }
 
-    public async Task AssertAverage(
+    public virtual async Task AssertAverage(
         Func<ISetSource, IQueryable<double?>> actualQuery,
         Func<ISetSource, IQueryable<double?>> expectedQuery,
         Action<double?, double?> asserter = null,
@@ -1351,7 +1351,7 @@ private void OrderingSettingsVerifier(bool assertOrder, Type type, object elemen
         Assert.Empty(context.ChangeTracker.Entries());
     }
 
-    public async Task AssertAverage<TResult>(
+    public virtual async Task AssertAverage<TResult>(
         Func<ISetSource, IQueryable<TResult>> actualQuery,
         Func<ISetSource, IQueryable<TResult>> expectedQuery,
         Expression<Func<TResult, int>> actualSelector,
@@ -1374,7 +1374,7 @@ private void OrderingSettingsVerifier(bool assertOrder, Type type, object elemen
         Assert.Empty(context.ChangeTracker.Entries());
     }
 
-    public async Task AssertAverage<TResult>(
+    public virtual async Task AssertAverage<TResult>(
         Func<ISetSource, IQueryable<TResult>> actualQuery,
         Func<ISetSource, IQueryable<TResult>> expectedQuery,
         Expression<Func<TResult, int?>> actualSelector,
@@ -1397,7 +1397,7 @@ private void OrderingSettingsVerifier(bool assertOrder, Type type, object elemen
         Assert.Empty(context.ChangeTracker.Entries());
     }
 
-    public async Task AssertAverage<TResult>(
+    public virtual async Task AssertAverage<TResult>(
         Func<ISetSource, IQueryable<TResult>> actualQuery,
         Func<ISetSource, IQueryable<TResult>> expectedQuery,
         Expression<Func<TResult, long>> actualSelector,
@@ -1420,7 +1420,7 @@ private void OrderingSettingsVerifier(bool assertOrder, Type type, object elemen
         Assert.Empty(context.ChangeTracker.Entries());
     }
 
-    public async Task AssertAverage<TResult>(
+    public virtual async Task AssertAverage<TResult>(
         Func<ISetSource, IQueryable<TResult>> actualQuery,
         Func<ISetSource, IQueryable<TResult>> expectedQuery,
         Expression<Func<TResult, long?>> actualSelector,
@@ -1443,7 +1443,7 @@ private void OrderingSettingsVerifier(bool assertOrder, Type type, object elemen
         Assert.Empty(context.ChangeTracker.Entries());
     }
 
-    public async Task AssertAverage<TResult>(
+    public virtual async Task AssertAverage<TResult>(
         Func<ISetSource, IQueryable<TResult>> actualQuery,
         Func<ISetSource, IQueryable<TResult>> expectedQuery,
         Expression<Func<TResult, decimal>> actualSelector,
@@ -1466,7 +1466,7 @@ private void OrderingSettingsVerifier(bool assertOrder, Type type, object elemen
         Assert.Empty(context.ChangeTracker.Entries());
     }
 
-    public async Task AssertAverage<TResult>(
+    public virtual async Task AssertAverage<TResult>(
         Func<ISetSource, IQueryable<TResult>> actualQuery,
         Func<ISetSource, IQueryable<TResult>> expectedQuery,
         Expression<Func<TResult, decimal?>> actualSelector,
@@ -1490,7 +1490,7 @@ private void OrderingSettingsVerifier(bool assertOrder, Type type, object elemen
         Assert.Empty(context.ChangeTracker.Entries());
     }
 
-    public async Task AssertAverage<TResult>(
+    public virtual async Task AssertAverage<TResult>(
         Func<ISetSource, IQueryable<TResult>> actualQuery,
         Func<ISetSource, IQueryable<TResult>> expectedQuery,
         Expression<Func<TResult, float>> actualSelector,
@@ -1513,7 +1513,7 @@ private void OrderingSettingsVerifier(bool assertOrder, Type type, object elemen
         Assert.Empty(context.ChangeTracker.Entries());
     }
 
-    public async Task AssertAverage<TResult>(
+    public virtual async Task AssertAverage<TResult>(
         Func<ISetSource, IQueryable<TResult>> actualQuery,
         Func<ISetSource, IQueryable<TResult>> expectedQuery,
         Expression<Func<TResult, float?>> actualSelector,
@@ -1536,7 +1536,7 @@ private void OrderingSettingsVerifier(bool assertOrder, Type type, object elemen
         Assert.Empty(context.ChangeTracker.Entries());
     }
 
-    public async Task AssertAverage<TResult>(
+    public virtual async Task AssertAverage<TResult>(
         Func<ISetSource, IQueryable<TResult>> actualQuery,
         Func<ISetSource, IQueryable<TResult>> expectedQuery,
         Expression<Func<TResult, double>> actualSelector,
@@ -1559,7 +1559,7 @@ private void OrderingSettingsVerifier(bool assertOrder, Type type, object elemen
         Assert.Empty(context.ChangeTracker.Entries());
     }
 
-    public async Task AssertAverage<TResult>(
+    public virtual async Task AssertAverage<TResult>(
         Func<ISetSource, IQueryable<TResult>> actualQuery,
         Func<ISetSource, IQueryable<TResult>> expectedQuery,
         Expression<Func<TResult, double?>> actualSelector,
diff --git a/test/EFCore.SqlServer.FunctionalTests/ManyToManyFieldsLoadSqlServerTest.cs b/test/EFCore.SqlServer.FunctionalTests/ManyToManyFieldsLoadSqlServerTest.cs
index b4c5b41dd8..0dd96633ff 100644
--- a/test/EFCore.SqlServer.FunctionalTests/ManyToManyFieldsLoadSqlServerTest.cs
+++ b/test/EFCore.SqlServer.FunctionalTests/ManyToManyFieldsLoadSqlServerTest.cs
@@ -270,7 +270,7 @@ private void AssertSql(string expected)
 
     private string Sql { get; set; }
 
-    public class ManyToManyFieldsLoadSqlServerFixture : ManyToManyFieldsLoadFixtureBase
+    public class ManyToManyFieldsLoadSqlServerFixture : ManyToManyFieldsLoadFixtureBase, ITestSqlLoggerFactory
     {
         public TestSqlLoggerFactory TestSqlLoggerFactory
             => (TestSqlLoggerFactory)ListLoggerFactory;
diff --git a/test/EFCore.SqlServer.FunctionalTests/ManyToManyLoadSqlServerTest.cs b/test/EFCore.SqlServer.FunctionalTests/ManyToManyLoadSqlServerTest.cs
index aa592f2fc7..3846a2ae19 100644
--- a/test/EFCore.SqlServer.FunctionalTests/ManyToManyLoadSqlServerTest.cs
+++ b/test/EFCore.SqlServer.FunctionalTests/ManyToManyLoadSqlServerTest.cs
@@ -289,7 +289,7 @@ private void AssertSql(string expected)
 
     private string Sql { get; set; }
 
-    public class ManyToManyLoadSqlServerFixture : ManyToManyLoadFixtureBase
+    public class ManyToManyLoadSqlServerFixture : ManyToManyLoadFixtureBase, ITestSqlLoggerFactory
     {
         public TestSqlLoggerFactory TestSqlLoggerFactory
             => (TestSqlLoggerFactory)ListLoggerFactory;
diff --git a/test/EFCore.SqlServer.FunctionalTests/ManyToManyTrackingSqlServerTestBase.cs b/test/EFCore.SqlServer.FunctionalTests/ManyToManyTrackingSqlServerTestBase.cs
index f75a331bc0..f1f5e72dd3 100644
--- a/test/EFCore.SqlServer.FunctionalTests/ManyToManyTrackingSqlServerTestBase.cs
+++ b/test/EFCore.SqlServer.FunctionalTests/ManyToManyTrackingSqlServerTestBase.cs
@@ -26,8 +26,11 @@ protected ManyToManyTrackingSqlServerTestBase(TFixture fixture)
         { "UnidirectionalEntityTwo.SelfSkipSharedRight", DeleteBehavior.ClientCascade },
     };
 
-    public class ManyToManyTrackingSqlServerFixtureBase : ManyToManyTrackingRelationalFixture
+    public class ManyToManyTrackingSqlServerFixtureBase : ManyToManyTrackingRelationalFixture, ITestSqlLoggerFactory
     {
+        public TestSqlLoggerFactory TestSqlLoggerFactory
+            => (TestSqlLoggerFactory)ListLoggerFactory;
+
         protected override ITestStoreFactory TestStoreFactory
             => SqlServerTestStoreFactory.Instance;
 
diff --git a/test/EFCore.SqlServer.FunctionalTests/Query/Ef6GroupBySqlServerTest.cs b/test/EFCore.SqlServer.FunctionalTests/Query/Ef6GroupBySqlServerTest.cs
index 9c4569220b..9aa64119a5 100644
--- a/test/EFCore.SqlServer.FunctionalTests/Query/Ef6GroupBySqlServerTest.cs
+++ b/test/EFCore.SqlServer.FunctionalTests/Query/Ef6GroupBySqlServerTest.cs
@@ -917,7 +917,7 @@ public override async Task Whats_new_2021_sample_11(bool async)
     private void AssertSql(params string[] expected)
         => Fixture.TestSqlLoggerFactory.AssertBaseline(expected);
 
-    public class Ef6GroupBySqlServerFixture : Ef6GroupByFixtureBase
+    public class Ef6GroupBySqlServerFixture : Ef6GroupByFixtureBase, ITestSqlLoggerFactory
     {
         public TestSqlLoggerFactory TestSqlLoggerFactory
             => (TestSqlLoggerFactory)ListLoggerFactory;
diff --git a/test/EFCore.SqlServer.FunctionalTests/Query/FunkyDataQuerySqlServerTest.cs b/test/EFCore.SqlServer.FunctionalTests/Query/FunkyDataQuerySqlServerTest.cs
index 34894f1f2f..013a548642 100644
--- a/test/EFCore.SqlServer.FunctionalTests/Query/FunkyDataQuerySqlServerTest.cs
+++ b/test/EFCore.SqlServer.FunctionalTests/Query/FunkyDataQuerySqlServerTest.cs
@@ -602,7 +602,7 @@ protected override void ClearLog()
     private void AssertSql(params string[] expected)
         => Fixture.TestSqlLoggerFactory.AssertBaseline(expected);
 
-    public class FunkyDataQuerySqlServerFixture : FunkyDataQueryFixtureBase
+    public class FunkyDataQuerySqlServerFixture : FunkyDataQueryFixtureBase, ITestSqlLoggerFactory
     {
         public TestSqlLoggerFactory TestSqlLoggerFactory
             => (TestSqlLoggerFactory)ListLoggerFactory;
diff --git a/test/EFCore.SqlServer.FunctionalTests/Query/IncludeOneToOneSqlServerTest.cs b/test/EFCore.SqlServer.FunctionalTests/Query/IncludeOneToOneSqlServerTest.cs
index 261901a7cc..59c23f7ac8 100644
--- a/test/EFCore.SqlServer.FunctionalTests/Query/IncludeOneToOneSqlServerTest.cs
+++ b/test/EFCore.SqlServer.FunctionalTests/Query/IncludeOneToOneSqlServerTest.cs
@@ -62,7 +62,7 @@ public override void Include_address_shadow()
     private void AssertSql(params string[] expected)
         => Fixture.TestSqlLoggerFactory.AssertBaseline(expected);
 
-    public class OneToOneQuerySqlServerFixture : OneToOneQueryFixtureBase
+    public class OneToOneQuerySqlServerFixture : OneToOneQueryFixtureBase, ITestSqlLoggerFactory
     {
         protected override ITestStoreFactory TestStoreFactory
             => SqlServerTestStoreFactory.Instance;
diff --git a/test/EFCore.SqlServer.FunctionalTests/Query/PrimitiveCollectionsQueryOldSqlServerTest.cs b/test/EFCore.SqlServer.FunctionalTests/Query/PrimitiveCollectionsQueryOldSqlServerTest.cs
index 65721ff787..2295dfd0cc 100644
--- a/test/EFCore.SqlServer.FunctionalTests/Query/PrimitiveCollectionsQueryOldSqlServerTest.cs
+++ b/test/EFCore.SqlServer.FunctionalTests/Query/PrimitiveCollectionsQueryOldSqlServerTest.cs
@@ -833,7 +833,7 @@ private void AssertSql(params string[] expected)
     private PrimitiveCollectionsContext CreateContext()
         => Fixture.CreateContext();
 
-    public class PrimitiveCollectionsQueryOldSqlServerFixture : PrimitiveCollectionsQueryFixtureBase
+    public class PrimitiveCollectionsQueryOldSqlServerFixture : PrimitiveCollectionsQueryFixtureBase, ITestSqlLoggerFactory
     {
         // Use a different store name to prevent concurrency issues with the non-old PrimitiveCollectionsQuerySqlServerTest
         protected override string StoreName
diff --git a/test/EFCore.SqlServer.FunctionalTests/Query/PrimitiveCollectionsQuerySqlServerTest.cs b/test/EFCore.SqlServer.FunctionalTests/Query/PrimitiveCollectionsQuerySqlServerTest.cs
index 355d372930..5e204386f5 100644
--- a/test/EFCore.SqlServer.FunctionalTests/Query/PrimitiveCollectionsQuerySqlServerTest.cs
+++ b/test/EFCore.SqlServer.FunctionalTests/Query/PrimitiveCollectionsQuerySqlServerTest.cs
@@ -1530,7 +1530,7 @@ private void AssertSql(params string[] expected)
     private PrimitiveCollectionsContext CreateContext()
         => Fixture.CreateContext();
 
-    public class PrimitiveCollectionsQuerySqlServerFixture : PrimitiveCollectionsQueryFixtureBase
+    public class PrimitiveCollectionsQuerySqlServerFixture : PrimitiveCollectionsQueryFixtureBase, ITestSqlLoggerFactory
     {
         public TestSqlLoggerFactory TestSqlLoggerFactory
             => (TestSqlLoggerFactory)ListLoggerFactory;
diff --git a/test/EFCore.SqlServer.FunctionalTests/Query/TemporalManyToManyQuerySqlServerFixture.cs b/test/EFCore.SqlServer.FunctionalTests/Query/TemporalManyToManyQuerySqlServerFixture.cs
index 385c9f68e6..298f7a37de 100644
--- a/test/EFCore.SqlServer.FunctionalTests/Query/TemporalManyToManyQuerySqlServerFixture.cs
+++ b/test/EFCore.SqlServer.FunctionalTests/Query/TemporalManyToManyQuerySqlServerFixture.cs
@@ -5,7 +5,7 @@
 
 namespace Microsoft.EntityFrameworkCore.Query;
 
-public class TemporalManyToManyQuerySqlServerFixture : ManyToManyQueryFixtureBase
+public class TemporalManyToManyQuerySqlServerFixture : ManyToManyQueryFixtureBase, ITestSqlLoggerFactory
 {
     protected override string StoreName
         => "TemporalManyToManyQueryTest";
diff --git a/test/EFCore.Sqlite.FunctionalTests/BuiltInDataTypesSqliteTest.cs b/test/EFCore.Sqlite.FunctionalTests/BuiltInDataTypesSqliteTest.cs
index aaeacfb7f9..1e2e0bccf2 100644
--- a/test/EFCore.Sqlite.FunctionalTests/BuiltInDataTypesSqliteTest.cs
+++ b/test/EFCore.Sqlite.FunctionalTests/BuiltInDataTypesSqliteTest.cs
@@ -1835,7 +1835,7 @@ private void AssertTranslationFailed(Action testCode)
     private void AssertSql(params string[] expected)
         => Fixture.TestSqlLoggerFactory.AssertBaseline(expected);
 
-    public class BuiltInDataTypesSqliteFixture : BuiltInDataTypesFixtureBase
+    public class BuiltInDataTypesSqliteFixture : BuiltInDataTypesFixtureBase, ITestSqlLoggerFactory
     {
         public override bool StrictEquality
             => false;
diff --git a/test/EFCore.Sqlite.FunctionalTests/ComplexTypesTrackingSqliteTest.cs b/test/EFCore.Sqlite.FunctionalTests/ComplexTypesTrackingSqliteTest.cs
index 980ff315e9..7404b7ccfe 100644
--- a/test/EFCore.Sqlite.FunctionalTests/ComplexTypesTrackingSqliteTest.cs
+++ b/test/EFCore.Sqlite.FunctionalTests/ComplexTypesTrackingSqliteTest.cs
@@ -15,7 +15,7 @@ public ComplexTypesTrackingSqliteTest(SqliteFixture fixture, ITestOutputHelper t
     protected override void UseTransaction(DatabaseFacade facade, IDbContextTransaction transaction)
         => facade.UseTransaction(transaction.GetDbTransaction());
 
-    public class SqliteFixture : FixtureBase
+    public class SqliteFixture : FixtureBase, ITestSqlLoggerFactory
     {
         protected override ITestStoreFactory TestStoreFactory
             => SqliteTestStoreFactory.Instance;
diff --git a/test/EFCore.Sqlite.FunctionalTests/ConcurrencyDetectorDisabledSqliteTest.cs b/test/EFCore.Sqlite.FunctionalTests/ConcurrencyDetectorDisabledSqliteTest.cs
index 87ae7276fe..89c9d5b4f7 100644
--- a/test/EFCore.Sqlite.FunctionalTests/ConcurrencyDetectorDisabledSqliteTest.cs
+++ b/test/EFCore.Sqlite.FunctionalTests/ConcurrencyDetectorDisabledSqliteTest.cs
@@ -6,7 +6,7 @@ namespace Microsoft.EntityFrameworkCore;
 public class ConcurrencyDetectorDisabledSqliteTest(ConcurrencyDetectorDisabledSqliteTest.ConcurrencyDetectorSqlServerFixture fixture) : ConcurrencyDetectorDisabledRelationalTestBase<
     ConcurrencyDetectorDisabledSqliteTest.ConcurrencyDetectorSqlServerFixture>(fixture)
 {
-    public class ConcurrencyDetectorSqlServerFixture : ConcurrencyDetectorFixtureBase
+    public class ConcurrencyDetectorSqlServerFixture : ConcurrencyDetectorFixtureBase, ITestSqlLoggerFactory
     {
         protected override ITestStoreFactory TestStoreFactory
             => SqliteTestStoreFactory.Instance;
diff --git a/test/EFCore.Sqlite.FunctionalTests/ConcurrencyDetectorEnabledSqliteTest.cs b/test/EFCore.Sqlite.FunctionalTests/ConcurrencyDetectorEnabledSqliteTest.cs
index 3491e03b73..91ae4a5986 100644
--- a/test/EFCore.Sqlite.FunctionalTests/ConcurrencyDetectorEnabledSqliteTest.cs
+++ b/test/EFCore.Sqlite.FunctionalTests/ConcurrencyDetectorEnabledSqliteTest.cs
@@ -6,7 +6,7 @@ namespace Microsoft.EntityFrameworkCore;
 public class ConcurrencyDetectorEnabledSqliteTest(ConcurrencyDetectorEnabledSqliteTest.ConcurrencyDetectorSqlServerFixture fixture) : ConcurrencyDetectorEnabledRelationalTestBase<
     ConcurrencyDetectorEnabledSqliteTest.ConcurrencyDetectorSqlServerFixture>(fixture)
 {
-    public class ConcurrencyDetectorSqlServerFixture : ConcurrencyDetectorFixtureBase
+    public class ConcurrencyDetectorSqlServerFixture : ConcurrencyDetectorFixtureBase, ITestSqlLoggerFactory
     {
         protected override ITestStoreFactory TestStoreFactory
             => SqliteTestStoreFactory.Instance;
diff --git a/test/EFCore.Sqlite.FunctionalTests/ConvertToProviderTypesSqliteTest.cs b/test/EFCore.Sqlite.FunctionalTests/ConvertToProviderTypesSqliteTest.cs
index e31b4585d0..0fe95c10a7 100644
--- a/test/EFCore.Sqlite.FunctionalTests/ConvertToProviderTypesSqliteTest.cs
+++ b/test/EFCore.Sqlite.FunctionalTests/ConvertToProviderTypesSqliteTest.cs
@@ -13,7 +13,7 @@ public ConvertToProviderTypesSqliteTest(ConvertToProviderTypesSqliteFixture fixt
         fixture.TestSqlLoggerFactory.SetTestOutputHelper(testOutputHelper);
     }
 
-    public class ConvertToProviderTypesSqliteFixture : ConvertToProviderTypesFixtureBase
+    public class ConvertToProviderTypesSqliteFixture : ConvertToProviderTypesFixtureBase, ITestSqlLoggerFactory
     {
         public override bool StrictEquality
             => false;
diff --git a/test/EFCore.Sqlite.FunctionalTests/CustomConvertersSqliteTest.cs b/test/EFCore.Sqlite.FunctionalTests/CustomConvertersSqliteTest.cs
index fbf865c566..f9a3ac24d1 100644
--- a/test/EFCore.Sqlite.FunctionalTests/CustomConvertersSqliteTest.cs
+++ b/test/EFCore.Sqlite.FunctionalTests/CustomConvertersSqliteTest.cs
@@ -137,7 +137,7 @@ public override void Value_conversion_on_enum_collection_contains()
     private void AssertSql(params string[] expected)
         => Fixture.TestSqlLoggerFactory.AssertBaseline(expected);
 
-    public class CustomConvertersSqliteFixture : CustomConvertersFixtureBase
+    public class CustomConvertersSqliteFixture : CustomConvertersFixtureBase, ITestSqlLoggerFactory
     {
         public override bool StrictEquality
             => false;
diff --git a/test/EFCore.Sqlite.FunctionalTests/DataAnnotationSqliteTest.cs b/test/EFCore.Sqlite.FunctionalTests/DataAnnotationSqliteTest.cs
index 6f624082a1..bf1bdca403 100644
--- a/test/EFCore.Sqlite.FunctionalTests/DataAnnotationSqliteTest.cs
+++ b/test/EFCore.Sqlite.FunctionalTests/DataAnnotationSqliteTest.cs
@@ -173,7 +173,7 @@ public override void TimestampAttribute_throws_if_value_in_database_changed()
     private void AssertSql(params string[] expected)
         => Fixture.TestSqlLoggerFactory.AssertBaseline(expected);
 
-    public class DataAnnotationSqliteFixture : DataAnnotationRelationalFixtureBase
+    public class DataAnnotationSqliteFixture : DataAnnotationRelationalFixtureBase, ITestSqlLoggerFactory
     {
         protected override ITestStoreFactory TestStoreFactory
             => SqliteTestStoreFactory.Instance;
diff --git a/test/EFCore.Sqlite.FunctionalTests/ManyToManyFieldsLoadSqliteTestBase.cs b/test/EFCore.Sqlite.FunctionalTests/ManyToManyFieldsLoadSqliteTestBase.cs
index b8575fc26d..f66ea6fd0e 100644
--- a/test/EFCore.Sqlite.FunctionalTests/ManyToManyFieldsLoadSqliteTestBase.cs
+++ b/test/EFCore.Sqlite.FunctionalTests/ManyToManyFieldsLoadSqliteTestBase.cs
@@ -8,8 +8,11 @@ namespace Microsoft.EntityFrameworkCore;
 public class ManyToManyFieldsLoadSqliteTest(ManyToManyFieldsLoadSqliteTest.ManyToManyFieldsLoadSqliteFixture fixture)
     : ManyToManyFieldsLoadTestBase<ManyToManyFieldsLoadSqliteTest.ManyToManyFieldsLoadSqliteFixture>(fixture)
 {
-    public class ManyToManyFieldsLoadSqliteFixture : ManyToManyFieldsLoadFixtureBase
+    public class ManyToManyFieldsLoadSqliteFixture : ManyToManyFieldsLoadFixtureBase, ITestSqlLoggerFactory
     {
+        public TestSqlLoggerFactory TestSqlLoggerFactory
+            => (TestSqlLoggerFactory)ListLoggerFactory;
+
         protected override ITestStoreFactory TestStoreFactory
             => SqliteTestStoreFactory.Instance;
 
diff --git a/test/EFCore.Sqlite.FunctionalTests/ManyToManyLoadSqliteTestBase.cs b/test/EFCore.Sqlite.FunctionalTests/ManyToManyLoadSqliteTestBase.cs
index 53591c0e81..c986fa21e7 100644
--- a/test/EFCore.Sqlite.FunctionalTests/ManyToManyLoadSqliteTestBase.cs
+++ b/test/EFCore.Sqlite.FunctionalTests/ManyToManyLoadSqliteTestBase.cs
@@ -13,8 +13,11 @@ protected ManyToManyLoadSqliteTestBase(TFixture fixture)
     {
     }
 
-    public class ManyToManyLoadSqliteFixtureBase : ManyToManyLoadFixtureBase
+    public class ManyToManyLoadSqliteFixtureBase : ManyToManyLoadFixtureBase, ITestSqlLoggerFactory
     {
+        public TestSqlLoggerFactory TestSqlLoggerFactory
+            => (TestSqlLoggerFactory)ListLoggerFactory;
+
         protected override ITestStoreFactory TestStoreFactory
             => SqliteTestStoreFactory.Instance;
 
diff --git a/test/EFCore.Sqlite.FunctionalTests/ManyToManyTrackingSqliteTest.cs b/test/EFCore.Sqlite.FunctionalTests/ManyToManyTrackingSqliteTest.cs
index d75376551b..01eab0d454 100644
--- a/test/EFCore.Sqlite.FunctionalTests/ManyToManyTrackingSqliteTest.cs
+++ b/test/EFCore.Sqlite.FunctionalTests/ManyToManyTrackingSqliteTest.cs
@@ -8,8 +8,11 @@ namespace Microsoft.EntityFrameworkCore;
 public class ManyToManyTrackingSqliteTest(ManyToManyTrackingSqliteTest.ManyToManyTrackingSqliteFixture fixture)
     : ManyToManyTrackingRelationalTestBase<ManyToManyTrackingSqliteTest.ManyToManyTrackingSqliteFixture>(fixture)
 {
-    public class ManyToManyTrackingSqliteFixture : ManyToManyTrackingRelationalFixture
+    public class ManyToManyTrackingSqliteFixture : ManyToManyTrackingRelationalFixture, ITestSqlLoggerFactory
     {
+        public TestSqlLoggerFactory TestSqlLoggerFactory
+            => (TestSqlLoggerFactory)ListLoggerFactory;
+
         protected override ITestStoreFactory TestStoreFactory
             => SqliteTestStoreFactory.Instance;
 
diff --git a/test/EFCore.Sqlite.FunctionalTests/NonLoadingNavigationsManyToManyLoadSqliteTest.cs b/test/EFCore.Sqlite.FunctionalTests/NonLoadingNavigationsManyToManyLoadSqliteTest.cs
index f47b8fcbb2..04924d5e63 100644
--- a/test/EFCore.Sqlite.FunctionalTests/NonLoadingNavigationsManyToManyLoadSqliteTest.cs
+++ b/test/EFCore.Sqlite.FunctionalTests/NonLoadingNavigationsManyToManyLoadSqliteTest.cs
@@ -8,11 +8,14 @@ namespace Microsoft.EntityFrameworkCore;
 public class NonLoadingNavigationsManyToManyLoadSqliteTest(NonLoadingNavigationsManyToManyLoadSqliteTest.NonLoadingNavigationsManyToManyLoadSqliteFixture fixture)
     : ManyToManyLoadTestBase<NonLoadingNavigationsManyToManyLoadSqliteTest.NonLoadingNavigationsManyToManyLoadSqliteFixture>(fixture)
 {
-    public class NonLoadingNavigationsManyToManyLoadSqliteFixture : ManyToManyLoadFixtureBase
+    public class NonLoadingNavigationsManyToManyLoadSqliteFixture : ManyToManyLoadFixtureBase, ITestSqlLoggerFactory
     {
         protected override string StoreName
             => "NonLoadingNavigationsManyToMany";
 
+        public TestSqlLoggerFactory TestSqlLoggerFactory
+            => (TestSqlLoggerFactory)ListLoggerFactory;
+
         protected override ITestStoreFactory TestStoreFactory
             => SqliteTestStoreFactory.Instance;
 
diff --git a/test/EFCore.Sqlite.FunctionalTests/Query/Ef6GroupBySqliteTest.cs b/test/EFCore.Sqlite.FunctionalTests/Query/Ef6GroupBySqliteTest.cs
index 22327c5738..e4b794d613 100644
--- a/test/EFCore.Sqlite.FunctionalTests/Query/Ef6GroupBySqliteTest.cs
+++ b/test/EFCore.Sqlite.FunctionalTests/Query/Ef6GroupBySqliteTest.cs
@@ -47,7 +47,7 @@ public override async Task Group_Join_from_LINQ_101(bool async)
             (await Assert.ThrowsAsync<InvalidOperationException>(
                 () => base.Group_Join_from_LINQ_101(async))).Message);
 
-    public class Ef6GroupBySqliteFixture : Ef6GroupByFixtureBase
+    public class Ef6GroupBySqliteFixture : Ef6GroupByFixtureBase, ITestSqlLoggerFactory
     {
         public TestSqlLoggerFactory TestSqlLoggerFactory
             => (TestSqlLoggerFactory)ListLoggerFactory;
diff --git a/test/EFCore.Sqlite.FunctionalTests/Query/FunkyDataQuerySqliteTest.cs b/test/EFCore.Sqlite.FunctionalTests/Query/FunkyDataQuerySqliteTest.cs
index 57587c59d1..7104827eb6 100644
--- a/test/EFCore.Sqlite.FunctionalTests/Query/FunkyDataQuerySqliteTest.cs
+++ b/test/EFCore.Sqlite.FunctionalTests/Query/FunkyDataQuerySqliteTest.cs
@@ -37,7 +37,7 @@ protected override QueryAsserter CreateQueryAsserter(FunkyDataQuerySqliteFixture
     private void AssertSql(params string[] expected)
         => Fixture.TestSqlLoggerFactory.AssertBaseline(expected);
 
-    public class FunkyDataQuerySqliteFixture : FunkyDataQueryFixtureBase
+    public class FunkyDataQuerySqliteFixture : FunkyDataQueryFixtureBase, ITestSqlLoggerFactory
     {
         public TestSqlLoggerFactory TestSqlLoggerFactory
             => (TestSqlLoggerFactory)ListLoggerFactory;
diff --git a/test/EFCore.Sqlite.FunctionalTests/Query/IncludeOneToOneSqliteTest.cs b/test/EFCore.Sqlite.FunctionalTests/Query/IncludeOneToOneSqliteTest.cs
index c5fcf9a616..62c79ae589 100644
--- a/test/EFCore.Sqlite.FunctionalTests/Query/IncludeOneToOneSqliteTest.cs
+++ b/test/EFCore.Sqlite.FunctionalTests/Query/IncludeOneToOneSqliteTest.cs
@@ -5,7 +5,7 @@ namespace Microsoft.EntityFrameworkCore.Query;
 
 public class IncludeOneToOneSqliteTest(IncludeOneToOneSqliteTest.OneToOneQuerySqliteFixture fixture) : IncludeOneToOneTestBase<IncludeOneToOneSqliteTest.OneToOneQuerySqliteFixture>(fixture)
 {
-    public class OneToOneQuerySqliteFixture : OneToOneQueryFixtureBase
+    public class OneToOneQuerySqliteFixture : OneToOneQueryFixtureBase, ITestSqlLoggerFactory
     {
         protected override ITestStoreFactory TestStoreFactory
             => SqliteTestStoreFactory.Instance;
diff --git a/test/EFCore.Sqlite.FunctionalTests/Query/PrimitiveCollectionsQuerySqliteTest.cs b/test/EFCore.Sqlite.FunctionalTests/Query/PrimitiveCollectionsQuerySqliteTest.cs
index 415eb4cd03..4542ee4027 100644
--- a/test/EFCore.Sqlite.FunctionalTests/Query/PrimitiveCollectionsQuerySqliteTest.cs
+++ b/test/EFCore.Sqlite.FunctionalTests/Query/PrimitiveCollectionsQuerySqliteTest.cs
@@ -1437,7 +1437,7 @@ private void AssertSql(params string[] expected)
     private PrimitiveCollectionsContext CreateContext()
         => Fixture.CreateContext();
 
-    public class PrimitiveCollectionsQuerySqlServerFixture : PrimitiveCollectionsQueryFixtureBase
+    public class PrimitiveCollectionsQuerySqlServerFixture : PrimitiveCollectionsQueryFixtureBase, ITestSqlLoggerFactory
     {
         public TestSqlLoggerFactory TestSqlLoggerFactory
             => (TestSqlLoggerFactory)ListLoggerFactory;
