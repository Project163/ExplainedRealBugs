diff --git a/src/EFCore.Cosmos/Metadata/Conventions/Internal/CosmosConventionSetBuilder.cs b/src/EFCore.Cosmos/Metadata/Conventions/Internal/CosmosConventionSetBuilder.cs
index 160f4bdeb2..b33bb113a2 100644
--- a/src/EFCore.Cosmos/Metadata/Conventions/Internal/CosmosConventionSetBuilder.cs
+++ b/src/EFCore.Cosmos/Metadata/Conventions/Internal/CosmosConventionSetBuilder.cs
@@ -82,7 +82,7 @@ private static IServiceScope CreateServiceScope()
         var serviceProvider = new ServiceCollection()
             .AddEntityFrameworkCosmos()
             .AddDbContext<DbContext>((p, o) =>
-                o.UseCosmos("localhost", "_", "_")
+                o.UseCosmos("https://localhost:8081", "C2y6yDjf5/R+ob0N8A7Cgv30VRDJIWEHLM+4QDU5DE2nQ9nDuVTqobD4b8mGGyPMbIZnqyMsEcaGQy67XIw/Jw==", "_")
                     .UseInternalServiceProvider(p))
             .BuildServiceProvider();
 
diff --git a/src/EFCore.Cosmos/Query/Internal/CosmosQueryTranslationPostprocessorFactory.cs b/src/EFCore.Cosmos/Query/Internal/CosmosQueryTranslationPostprocessorFactory.cs
index ee03bfcfd0..a04f8f090d 100644
--- a/src/EFCore.Cosmos/Query/Internal/CosmosQueryTranslationPostprocessorFactory.cs
+++ b/src/EFCore.Cosmos/Query/Internal/CosmosQueryTranslationPostprocessorFactory.cs
@@ -25,6 +25,7 @@ public class CosmosQueryTranslationPostprocessorFactory(
     ///     any release. You should only use it directly in your code with extreme caution and knowing that
     ///     doing so can result in application failures when updating to a new Entity Framework Core release.
     /// </summary>
+    [DebuggerStepThrough]
     public virtual QueryTranslationPostprocessor Create(QueryCompilationContext queryCompilationContext)
         => new CosmosQueryTranslationPostprocessor(
             Dependencies,
diff --git a/src/EFCore.Cosmos/Query/Internal/CosmosQueryTranslationPreprocessorFactory.cs b/src/EFCore.Cosmos/Query/Internal/CosmosQueryTranslationPreprocessorFactory.cs
index 08c763a999..d5a8dc1881 100644
--- a/src/EFCore.Cosmos/Query/Internal/CosmosQueryTranslationPreprocessorFactory.cs
+++ b/src/EFCore.Cosmos/Query/Internal/CosmosQueryTranslationPreprocessorFactory.cs
@@ -23,6 +23,7 @@ public class CosmosQueryTranslationPreprocessorFactory(QueryTranslationPreproces
     ///     any release. You should only use it directly in your code with extreme caution and knowing that
     ///     doing so can result in application failures when updating to a new Entity Framework Core release.
     /// </summary>
+    [DebuggerStepThrough]
     public virtual QueryTranslationPreprocessor Create(QueryCompilationContext queryCompilationContext)
         => new CosmosQueryTranslationPreprocessor(Dependencies, (CosmosQueryCompilationContext)queryCompilationContext);
 }
diff --git a/src/EFCore.Cosmos/Query/Internal/CosmosQueryableMethodTranslatingExpressionVisitorFactory.cs b/src/EFCore.Cosmos/Query/Internal/CosmosQueryableMethodTranslatingExpressionVisitorFactory.cs
index b89f6d202b..21222ce5d4 100644
--- a/src/EFCore.Cosmos/Query/Internal/CosmosQueryableMethodTranslatingExpressionVisitorFactory.cs
+++ b/src/EFCore.Cosmos/Query/Internal/CosmosQueryableMethodTranslatingExpressionVisitorFactory.cs
@@ -28,6 +28,7 @@ public class CosmosQueryableMethodTranslatingExpressionVisitorFactory(
     ///     any release. You should only use it directly in your code with extreme caution and knowing that
     ///     doing so can result in application failures when updating to a new Entity Framework Core release.
     /// </summary>
+    [DebuggerStepThrough]
     public virtual QueryableMethodTranslatingExpressionVisitor Create(QueryCompilationContext queryCompilationContext)
         => new CosmosQueryableMethodTranslatingExpressionVisitor(
             Dependencies,
diff --git a/src/EFCore.Cosmos/Query/Internal/CosmosShapedQueryCompilingExpressionVisitorFactory.cs b/src/EFCore.Cosmos/Query/Internal/CosmosShapedQueryCompilingExpressionVisitorFactory.cs
index 28797214e2..cba22f4c8a 100644
--- a/src/EFCore.Cosmos/Query/Internal/CosmosShapedQueryCompilingExpressionVisitorFactory.cs
+++ b/src/EFCore.Cosmos/Query/Internal/CosmosShapedQueryCompilingExpressionVisitorFactory.cs
@@ -28,6 +28,7 @@ public class CosmosShapedQueryCompilingExpressionVisitorFactory(
     ///     any release. You should only use it directly in your code with extreme caution and knowing that
     ///     doing so can result in application failures when updating to a new Entity Framework Core release.
     /// </summary>
+    [DebuggerStepThrough]
     public virtual ShapedQueryCompilingExpressionVisitor Create(QueryCompilationContext queryCompilationContext)
         => new CosmosShapedQueryCompilingExpressionVisitor(
             Dependencies,
diff --git a/src/EFCore.Cosmos/Storage/Internal/SingletonCosmosClientWrapper.cs b/src/EFCore.Cosmos/Storage/Internal/SingletonCosmosClientWrapper.cs
index 3e090616a8..38a820e421 100644
--- a/src/EFCore.Cosmos/Storage/Internal/SingletonCosmosClientWrapper.cs
+++ b/src/EFCore.Cosmos/Storage/Internal/SingletonCosmosClientWrapper.cs
@@ -16,12 +16,7 @@ namespace Microsoft.EntityFrameworkCore.Cosmos.Storage.Internal;
 public class SingletonCosmosClientWrapper : ISingletonCosmosClientWrapper
 {
     private static readonly string UserAgent = " Microsoft.EntityFrameworkCore.Cosmos/" + ProductInfo.GetVersion();
-    private readonly CosmosClientOptions _options;
-    private readonly string? _endpoint;
-    private readonly string? _key;
-    private readonly string? _connectionString;
-    private readonly TokenCredential? _tokenCredential;
-    private CosmosClient? _client;
+    private readonly CosmosClient _client;
 
     /// <summary>
     ///     This is an internal API that supports the Entity Framework Core infrastructure and not subject to
@@ -31,10 +26,6 @@ public class SingletonCosmosClientWrapper : ISingletonCosmosClientWrapper
     /// </summary>
     public SingletonCosmosClientWrapper(ICosmosSingletonOptions options)
     {
-        _endpoint = options.AccountEndpoint;
-        _key = options.AccountKey;
-        _connectionString = options.ConnectionString;
-        _tokenCredential = options.TokenCredential;
         var configuration = new CosmosClientOptions { ApplicationName = UserAgent, Serializer = new JsonCosmosSerializer() };
 
         if (options.Region != null)
@@ -97,7 +88,13 @@ public SingletonCosmosClientWrapper(ICosmosSingletonOptions options)
             configuration.HttpClientFactory = options.HttpClientFactory;
         }
 
-        _options = configuration;
+        _client = options switch
+        {
+            { ConnectionString: not null and not "" } => new CosmosClient(options.ConnectionString, configuration),
+            { TokenCredential: not null } => new CosmosClient(options.AccountEndpoint, options.TokenCredential, configuration),
+            { AccountEndpoint: not null } => new CosmosClient(options.AccountEndpoint, options.AccountKey, configuration),
+            _ => throw new InvalidOperationException(CosmosStrings.ConnectionInfoMissing)
+        };
     }
 
     /// <summary>
@@ -106,14 +103,7 @@ public SingletonCosmosClientWrapper(ICosmosSingletonOptions options)
     ///     any release. You should only use it directly in your code with extreme caution and knowing that
     ///     doing so can result in application failures when updating to a new Entity Framework Core release.
     /// </summary>
-    public virtual CosmosClient Client
-        => _client ??= string.IsNullOrEmpty(_connectionString)
-            ? _tokenCredential == null
-                ? _endpoint == null
-                    ? throw new InvalidOperationException(CosmosStrings.ConnectionInfoMissing)
-                    : new CosmosClient(_endpoint, _key, _options)
-                : new CosmosClient(_endpoint, _tokenCredential, _options)
-            : new CosmosClient(_connectionString, _options);
+    public virtual CosmosClient Client => _client;
 
     /// <summary>
     ///     This is an internal API that supports the Entity Framework Core infrastructure and not subject to
@@ -123,7 +113,6 @@ public virtual CosmosClient Client
     /// </summary>
     public virtual void Dispose()
     {
-        _client?.Dispose();
-        _client = null;
+        _client.Dispose();
     }
 }
diff --git a/src/EFCore.InMemory/Query/Internal/InMemoryQueryTranslationPreprocessorFactory.cs b/src/EFCore.InMemory/Query/Internal/InMemoryQueryTranslationPreprocessorFactory.cs
index 12b62bafc4..38320bc973 100644
--- a/src/EFCore.InMemory/Query/Internal/InMemoryQueryTranslationPreprocessorFactory.cs
+++ b/src/EFCore.InMemory/Query/Internal/InMemoryQueryTranslationPreprocessorFactory.cs
@@ -32,6 +32,7 @@ public class InMemoryQueryTranslationPreprocessorFactory : IQueryTranslationPrep
     ///     any release. You should only use it directly in your code with extreme caution and knowing that
     ///     doing so can result in application failures when updating to a new Entity Framework Core release.
     /// </summary>
+    [DebuggerStepThrough]
     public virtual QueryTranslationPreprocessor Create(QueryCompilationContext queryCompilationContext)
         => new InMemoryQueryTranslationPreprocessor(Dependencies, queryCompilationContext);
 }
diff --git a/src/EFCore.InMemory/Query/Internal/InMemoryQueryableMethodTranslatingExpressionVisitorFactory.cs b/src/EFCore.InMemory/Query/Internal/InMemoryQueryableMethodTranslatingExpressionVisitorFactory.cs
index 17325d1bc9..82d4d33a58 100644
--- a/src/EFCore.InMemory/Query/Internal/InMemoryQueryableMethodTranslatingExpressionVisitorFactory.cs
+++ b/src/EFCore.InMemory/Query/Internal/InMemoryQueryableMethodTranslatingExpressionVisitorFactory.cs
@@ -32,6 +32,7 @@ public class InMemoryQueryableMethodTranslatingExpressionVisitorFactory : IQuery
     ///     any release. You should only use it directly in your code with extreme caution and knowing that
     ///     doing so can result in application failures when updating to a new Entity Framework Core release.
     /// </summary>
+    [DebuggerStepThrough]
     public virtual QueryableMethodTranslatingExpressionVisitor Create(QueryCompilationContext queryCompilationContext)
         => new InMemoryQueryableMethodTranslatingExpressionVisitor(Dependencies, queryCompilationContext);
 }
diff --git a/src/EFCore.InMemory/Query/Internal/InMemoryShapedQueryExpressionVisitorFactory.cs b/src/EFCore.InMemory/Query/Internal/InMemoryShapedQueryExpressionVisitorFactory.cs
index 192cef1760..ec085fdba4 100644
--- a/src/EFCore.InMemory/Query/Internal/InMemoryShapedQueryExpressionVisitorFactory.cs
+++ b/src/EFCore.InMemory/Query/Internal/InMemoryShapedQueryExpressionVisitorFactory.cs
@@ -32,6 +32,7 @@ public class InMemoryShapedQueryCompilingExpressionVisitorFactory : IShapedQuery
     ///     any release. You should only use it directly in your code with extreme caution and knowing that
     ///     doing so can result in application failures when updating to a new Entity Framework Core release.
     /// </summary>
+    [DebuggerStepThrough]
     public virtual ShapedQueryCompilingExpressionVisitor Create(QueryCompilationContext queryCompilationContext)
         => new InMemoryShapedQueryCompilingExpressionVisitor(Dependencies, queryCompilationContext);
 }
diff --git a/src/EFCore.Relational/Properties/RelationalStrings.Designer.cs b/src/EFCore.Relational/Properties/RelationalStrings.Designer.cs
index 8b07ae84bf..f6d60578c5 100644
--- a/src/EFCore.Relational/Properties/RelationalStrings.Designer.cs
+++ b/src/EFCore.Relational/Properties/RelationalStrings.Designer.cs
@@ -1627,6 +1627,14 @@ public static string NullTypeMappingInSqlTree(object? sqlExpression)
                 GetString("NullTypeMappingInSqlTree", nameof(sqlExpression)),
                 sqlExpression);
 
+        /// <summary>
+        ///     Required JSON property '{property}' cannot contain null.
+        /// </summary>
+        public static string NullValueInRequiredJsonProperty(object? property)
+            => string.Format(
+                GetString("NullValueInRequiredJsonProperty", nameof(property)),
+                property);
+
         /// <summary>
         ///     Exactly one of '{param1}', '{param2}' or '{param3}' must be set.
         /// </summary>
diff --git a/src/EFCore.Relational/Properties/RelationalStrings.resx b/src/EFCore.Relational/Properties/RelationalStrings.resx
index 5c882e634d..7b095e1373 100644
--- a/src/EFCore.Relational/Properties/RelationalStrings.resx
+++ b/src/EFCore.Relational/Properties/RelationalStrings.resx
@@ -1069,6 +1069,9 @@
   <data name="NullTypeMappingInSqlTree" xml:space="preserve">
     <value>Expression '{sqlExpression}' in the SQL tree does not have a type mapping assigned.</value>
   </data>
+  <data name="NullValueInRequiredJsonProperty" xml:space="preserve">
+    <value>Required JSON property '{property}' cannot contain null.</value>
+  </data>
   <data name="OneOfThreeValuesMustBeSet" xml:space="preserve">
     <value>Exactly one of '{param1}', '{param2}' or '{param3}' must be set.</value>
   </data>
diff --git a/src/EFCore.Relational/Query/Internal/RelationalJsonUtilities.cs b/src/EFCore.Relational/Query/Internal/RelationalJsonUtilities.cs
index 8b2fa7e291..88162c03f9 100644
--- a/src/EFCore.Relational/Query/Internal/RelationalJsonUtilities.cs
+++ b/src/EFCore.Relational/Query/Internal/RelationalJsonUtilities.cs
@@ -92,6 +92,11 @@ void WriteJsonObject(Utf8JsonWriter writer, IComplexType complexType, object? ob
                 var propertyValue = property.GetGetter().GetClrValue(objectValue);
                 if (propertyValue is null)
                 {
+                    if (!property.IsNullable)
+                    {
+                        throw new InvalidOperationException(RelationalStrings.NullValueInRequiredJsonProperty(property.Name));
+                    }
+
                     writer.WriteNullValue();
                 }
                 else
@@ -110,6 +115,11 @@ void WriteJsonObject(Utf8JsonWriter writer, IComplexType complexType, object? ob
 
                 var propertyValue = complexProperty.GetGetter().GetClrValue(objectValue);
 
+                if (propertyValue is null && !complexProperty.IsNullable)
+                {
+                    throw new InvalidOperationException(RelationalStrings.NullValueInRequiredJsonProperty(complexProperty.Name));
+                }
+
                 WriteJson(writer, complexProperty.ComplexType, propertyValue, complexProperty.IsCollection);
             }
 
diff --git a/src/EFCore.Relational/Query/Internal/RelationalQueryTranslationPostprocessorFactory.cs b/src/EFCore.Relational/Query/Internal/RelationalQueryTranslationPostprocessorFactory.cs
index 62a29b841e..5d26c80e9a 100644
--- a/src/EFCore.Relational/Query/Internal/RelationalQueryTranslationPostprocessorFactory.cs
+++ b/src/EFCore.Relational/Query/Internal/RelationalQueryTranslationPostprocessorFactory.cs
@@ -41,6 +41,7 @@ public class RelationalQueryTranslationPostprocessorFactory : IQueryTranslationP
     ///     any release. You should only use it directly in your code with extreme caution and knowing that
     ///     doing so can result in application failures when updating to a new Entity Framework Core release.
     /// </summary>
+    [DebuggerStepThrough]
     public virtual QueryTranslationPostprocessor Create(QueryCompilationContext queryCompilationContext)
         => new RelationalQueryTranslationPostprocessor(
             Dependencies,
diff --git a/src/EFCore.Relational/Query/Internal/RelationalQueryTranslationPreprocessorFactory.cs b/src/EFCore.Relational/Query/Internal/RelationalQueryTranslationPreprocessorFactory.cs
index d8deb533e3..87088640b3 100644
--- a/src/EFCore.Relational/Query/Internal/RelationalQueryTranslationPreprocessorFactory.cs
+++ b/src/EFCore.Relational/Query/Internal/RelationalQueryTranslationPreprocessorFactory.cs
@@ -41,6 +41,7 @@ public class RelationalQueryTranslationPreprocessorFactory : IQueryTranslationPr
     ///     any release. You should only use it directly in your code with extreme caution and knowing that
     ///     doing so can result in application failures when updating to a new Entity Framework Core release.
     /// </summary>
+    [DebuggerStepThrough]
     public virtual QueryTranslationPreprocessor Create(QueryCompilationContext queryCompilationContext)
         => new RelationalQueryTranslationPreprocessor(Dependencies, RelationalDependencies, queryCompilationContext);
 }
diff --git a/src/EFCore.Relational/Query/Internal/RelationalQueryableMethodTranslatingExpressionVisitorFactory.cs b/src/EFCore.Relational/Query/Internal/RelationalQueryableMethodTranslatingExpressionVisitorFactory.cs
index f32df7f3f6..c856333f71 100644
--- a/src/EFCore.Relational/Query/Internal/RelationalQueryableMethodTranslatingExpressionVisitorFactory.cs
+++ b/src/EFCore.Relational/Query/Internal/RelationalQueryableMethodTranslatingExpressionVisitorFactory.cs
@@ -41,6 +41,7 @@ public class RelationalQueryableMethodTranslatingExpressionVisitorFactory : IQue
     ///     any release. You should only use it directly in your code with extreme caution and knowing that
     ///     doing so can result in application failures when updating to a new Entity Framework Core release.
     /// </summary>
+    [DebuggerStepThrough]
     public virtual QueryableMethodTranslatingExpressionVisitor Create(QueryCompilationContext queryCompilationContext)
         => new RelationalQueryableMethodTranslatingExpressionVisitor(
             Dependencies,
diff --git a/src/EFCore.Relational/Query/Internal/RelationalShapedQueryCompilingExpressionVisitorFactory.cs b/src/EFCore.Relational/Query/Internal/RelationalShapedQueryCompilingExpressionVisitorFactory.cs
index 3f830b01d0..7b96013454 100644
--- a/src/EFCore.Relational/Query/Internal/RelationalShapedQueryCompilingExpressionVisitorFactory.cs
+++ b/src/EFCore.Relational/Query/Internal/RelationalShapedQueryCompilingExpressionVisitorFactory.cs
@@ -41,6 +41,7 @@ public class RelationalShapedQueryCompilingExpressionVisitorFactory : IShapedQue
     ///     any release. You should only use it directly in your code with extreme caution and knowing that
     ///     doing so can result in application failures when updating to a new Entity Framework Core release.
     /// </summary>
+    [DebuggerStepThrough]
     public virtual ShapedQueryCompilingExpressionVisitor Create(QueryCompilationContext queryCompilationContext)
         => new RelationalShapedQueryCompilingExpressionVisitor(
             Dependencies,
diff --git a/src/EFCore.Relational/Query/RelationalQueryableMethodTranslatingExpressionVisitor.ExecuteUpdate.cs b/src/EFCore.Relational/Query/RelationalQueryableMethodTranslatingExpressionVisitor.ExecuteUpdate.cs
index 21893c7289..1d0221dada 100644
--- a/src/EFCore.Relational/Query/RelationalQueryableMethodTranslatingExpressionVisitor.ExecuteUpdate.cs
+++ b/src/EFCore.Relational/Query/RelationalQueryableMethodTranslatingExpressionVisitor.ExecuteUpdate.cs
@@ -2,6 +2,7 @@
 // The .NET Foundation licenses this file to you under the MIT license.
 
 using System.Diagnostics.CodeAnalysis;
+using System.Text;
 using Microsoft.EntityFrameworkCore.Metadata.Internal;
 using Microsoft.EntityFrameworkCore.Query.Internal;
 using Microsoft.EntityFrameworkCore.Query.SqlExpressions;
@@ -636,10 +637,17 @@ Expression Core(Expression target, IProperty property)
                                         Expression.Constant(property, typeof(IProperty))),
                                     QueryCompilationContext.QueryContextParameter);
 
-                                var newParameterName =
-                                    $"{ExecuteUpdateRuntimeParameterPrefix}{chainExpression.ParameterExpression.Name}_{property.Name}";
+                                var parameterNameBuilder = new StringBuilder(ExecuteUpdateRuntimeParameterPrefix)
+                                    .Append(chainExpression.ParameterExpression.Name);
 
-                                return _queryCompilationContext.RegisterRuntimeParameter(newParameterName, lambda);
+                                foreach (var complexProperty in chainExpression.ComplexPropertyChain)
+                                {
+                                    parameterNameBuilder.Append('_').Append(complexProperty.Name);
+                                }
+
+                                parameterNameBuilder.Append('_').Append(property.Name);
+
+                                return _queryCompilationContext.RegisterRuntimeParameter(parameterNameBuilder.ToString(), lambda);
                             }
 
                             case MemberInitExpression memberInitExpression
diff --git a/src/EFCore.SqlServer/Query/Internal/SqlServerQueryTranslationPostprocessorFactory.cs b/src/EFCore.SqlServer/Query/Internal/SqlServerQueryTranslationPostprocessorFactory.cs
index a7b5e069d2..de87040705 100644
--- a/src/EFCore.SqlServer/Query/Internal/SqlServerQueryTranslationPostprocessorFactory.cs
+++ b/src/EFCore.SqlServer/Query/Internal/SqlServerQueryTranslationPostprocessorFactory.cs
@@ -41,6 +41,7 @@ public class SqlServerQueryTranslationPostprocessorFactory : IQueryTranslationPo
     ///     any release. You should only use it directly in your code with extreme caution and knowing that
     ///     doing so can result in application failures when updating to a new Entity Framework Core release.
     /// </summary>
+    [DebuggerStepThrough]
     public virtual QueryTranslationPostprocessor Create(QueryCompilationContext queryCompilationContext)
         => new SqlServerQueryTranslationPostprocessor(
             Dependencies, RelationalDependencies, (SqlServerQueryCompilationContext)queryCompilationContext);
diff --git a/src/EFCore.SqlServer/Query/Internal/SqlServerQueryableMethodTranslatingExpressionVisitorFactory.cs b/src/EFCore.SqlServer/Query/Internal/SqlServerQueryableMethodTranslatingExpressionVisitorFactory.cs
index f8c045a5e7..b1d5f19f8d 100644
--- a/src/EFCore.SqlServer/Query/Internal/SqlServerQueryableMethodTranslatingExpressionVisitorFactory.cs
+++ b/src/EFCore.SqlServer/Query/Internal/SqlServerQueryableMethodTranslatingExpressionVisitorFactory.cs
@@ -47,6 +47,7 @@ public class SqlServerQueryableMethodTranslatingExpressionVisitorFactory : IQuer
     ///     any release. You should only use it directly in your code with extreme caution and knowing that
     ///     doing so can result in application failures when updating to a new Entity Framework Core release.
     /// </summary>
+    [DebuggerStepThrough]
     public virtual QueryableMethodTranslatingExpressionVisitor Create(QueryCompilationContext queryCompilationContext)
         => new SqlServerQueryableMethodTranslatingExpressionVisitor(
             Dependencies, RelationalDependencies, (SqlServerQueryCompilationContext)queryCompilationContext, _sqlServerSingletonOptions);
diff --git a/src/EFCore.Sqlite.Core/Query/Internal/SqliteQueryTranslationPostprocessorFactory.cs b/src/EFCore.Sqlite.Core/Query/Internal/SqliteQueryTranslationPostprocessorFactory.cs
index 6699738c1d..f3668f80bd 100644
--- a/src/EFCore.Sqlite.Core/Query/Internal/SqliteQueryTranslationPostprocessorFactory.cs
+++ b/src/EFCore.Sqlite.Core/Query/Internal/SqliteQueryTranslationPostprocessorFactory.cs
@@ -41,6 +41,7 @@ public class SqliteQueryTranslationPostprocessorFactory : IQueryTranslationPostp
     ///     any release. You should only use it directly in your code with extreme caution and knowing that
     ///     doing so can result in application failures when updating to a new Entity Framework Core release.
     /// </summary>
+    [DebuggerStepThrough]
     public virtual QueryTranslationPostprocessor Create(QueryCompilationContext queryCompilationContext)
         => new SqliteQueryTranslationPostprocessor(
             Dependencies,
diff --git a/src/EFCore.Sqlite.Core/Query/Internal/SqliteQueryableMethodTranslatingExpressionVisitorFactory.cs b/src/EFCore.Sqlite.Core/Query/Internal/SqliteQueryableMethodTranslatingExpressionVisitorFactory.cs
index 5cb7e2dab7..8020b3c6b0 100644
--- a/src/EFCore.Sqlite.Core/Query/Internal/SqliteQueryableMethodTranslatingExpressionVisitorFactory.cs
+++ b/src/EFCore.Sqlite.Core/Query/Internal/SqliteQueryableMethodTranslatingExpressionVisitorFactory.cs
@@ -41,6 +41,7 @@ public class SqliteQueryableMethodTranslatingExpressionVisitorFactory : IQueryab
     ///     any release. You should only use it directly in your code with extreme caution and knowing that
     ///     doing so can result in application failures when updating to a new Entity Framework Core release.
     /// </summary>
+    [DebuggerStepThrough]
     public virtual QueryableMethodTranslatingExpressionVisitor Create(QueryCompilationContext queryCompilationContext)
         => new SqliteQueryableMethodTranslatingExpressionVisitor(
             Dependencies, RelationalDependencies, (RelationalQueryCompilationContext)queryCompilationContext);
diff --git a/src/EFCore/Query/IQueryTranslationPreprocessorFactory.cs b/src/EFCore/Query/IQueryTranslationPreprocessorFactory.cs
index 4aa8a1cb67..3196394521 100644
--- a/src/EFCore/Query/IQueryTranslationPreprocessorFactory.cs
+++ b/src/EFCore/Query/IQueryTranslationPreprocessorFactory.cs
@@ -25,5 +25,6 @@ public interface IQueryTranslationPreprocessorFactory
     /// </summary>
     /// <param name="queryCompilationContext">The query compilation context to use.</param>
     /// <returns>The created visitor.</returns>
+    [DebuggerStepThrough]
     QueryTranslationPreprocessor Create(QueryCompilationContext queryCompilationContext);
 }
diff --git a/src/EFCore/Query/Internal/NavigationExpandingExpressionVisitor.ExpressionVisitors.cs b/src/EFCore/Query/Internal/NavigationExpandingExpressionVisitor.ExpressionVisitors.cs
index 4cb34b5161..8ce5687a98 100644
--- a/src/EFCore/Query/Internal/NavigationExpandingExpressionVisitor.ExpressionVisitors.cs
+++ b/src/EFCore/Query/Internal/NavigationExpandingExpressionVisitor.ExpressionVisitors.cs
@@ -48,7 +48,7 @@ protected override Expression VisitExtension(Expression expression)
         protected override Expression VisitMember(MemberExpression memberExpression)
         {
             var innerExpression = Visit(memberExpression.Expression);
-            return TryExpandRelationship(innerExpression, MemberIdentity.Create(memberExpression.Member))
+            return TryExpandRelationship(innerExpression, MemberIdentity.Create(memberExpression.Member), memberExpression)
                 ?? memberExpression.Update(innerExpression);
         }
 
@@ -57,21 +57,21 @@ protected override Expression VisitMethodCall(MethodCallExpression methodCallExp
             if (methodCallExpression.TryGetEFPropertyArguments(out var source, out var navigationName))
             {
                 source = Visit(source);
-                return TryExpandRelationship(source, MemberIdentity.Create(navigationName))
+                return TryExpandRelationship(source, MemberIdentity.Create(navigationName), methodCallExpression)
                     ?? methodCallExpression.Update(null, [source, methodCallExpression.Arguments[1]]);
             }
 
             if (methodCallExpression.TryGetIndexerArguments(Model, out source, out navigationName))
             {
                 source = Visit(source);
-                return TryExpandRelationship(source, MemberIdentity.Create(navigationName))
+                return TryExpandRelationship(source, MemberIdentity.Create(navigationName), methodCallExpression)
                     ?? methodCallExpression.Update(source, [methodCallExpression.Arguments[0]]);
             }
 
             return base.VisitMethodCall(methodCallExpression);
         }
 
-        private Expression? TryExpandRelationship(Expression? root, MemberIdentity memberIdentity)
+        private Expression? TryExpandRelationship(Expression? root, MemberIdentity memberIdentity, Expression originalExpression)
         {
             if (root == null)
             {
@@ -130,7 +130,7 @@ protected override Expression VisitMethodCall(MethodCallExpression methodCallExp
                         : null;
                 if (complexProperty is not null)
                 {
-                    return new ComplexPropertyReference(root, complexProperty);
+                    return new ComplexPropertyReference(root, complexProperty, originalExpression);
                 }
 
                 var property = memberIdentity.MemberInfo != null
@@ -1020,8 +1020,14 @@ private sealed class ReducingExpressionVisitor : ExpressionVisitor
                     return Visit(queryablePropertyReference.Parent).CreateEFPropertyExpression(queryablePropertyReference.Property);
 
                 case ComplexPropertyReference complexPropertyReference:
-                    return Visit(complexPropertyReference.Parent).CreateEFPropertyExpression(
-                        complexPropertyReference.Property, makeNullable: false);
+                    return complexPropertyReference.OriginalExpression switch
+                    {
+                        MemberExpression e
+                            => e.Update(Visit(complexPropertyReference.Parent)),
+                        MethodCallExpression e when e.Method.IsEFPropertyMethod()
+                            => e.Update(@object: null, [Visit(complexPropertyReference.Parent), e.Arguments[1]]),
+                        _ => throw new UnreachableException()
+                    };
 
                 case IncludeExpression includeExpression:
                     var entityExpression = Visit(includeExpression.EntityExpression);
diff --git a/src/EFCore/Query/Internal/NavigationExpandingExpressionVisitor.Expressions.cs b/src/EFCore/Query/Internal/NavigationExpandingExpressionVisitor.Expressions.cs
index bf9e123556..6daddc1d03 100644
--- a/src/EFCore/Query/Internal/NavigationExpandingExpressionVisitor.Expressions.cs
+++ b/src/EFCore/Query/Internal/NavigationExpandingExpressionVisitor.Expressions.cs
@@ -477,7 +477,7 @@ void IPrintableExpression.Print(ExpressionPrinter expressionPrinter)
     /// <summary>
     ///     Queryable properties are not expanded (similar to <see cref="OwnedNavigationReference" />.
     /// </summary>
-    private sealed class ComplexPropertyReference(Expression parent, IComplexProperty complexProperty)
+    private sealed class ComplexPropertyReference(Expression parent, IComplexProperty complexProperty, Expression originalExpression)
         : Expression, IPrintableExpression
     {
         protected override Expression VisitChildren(ExpressionVisitor visitor)
@@ -489,6 +489,7 @@ protected override Expression VisitChildren(ExpressionVisitor visitor)
 
         public Expression Parent { get; private set; } = parent;
         public new IComplexProperty Property { get; } = complexProperty;
+        public Expression OriginalExpression { get; private set; } = originalExpression;
         public ComplexTypeReference ComplexTypeReference { get; } = new(complexProperty.ComplexType);
 
         public override Type Type
diff --git a/src/EFCore/Query/Internal/NavigationExpandingExpressionVisitor.cs b/src/EFCore/Query/Internal/NavigationExpandingExpressionVisitor.cs
index 6a5c7715f0..77cb0b5d73 100644
--- a/src/EFCore/Query/Internal/NavigationExpandingExpressionVisitor.cs
+++ b/src/EFCore/Query/Internal/NavigationExpandingExpressionVisitor.cs
@@ -276,7 +276,7 @@ protected override Expression VisitMember(MemberExpression memberExpression)
             } complexPropertyReference
             && complexProperty.ComplexType.FindComplexProperty(memberExpression.Member) is { } nestedComplexProperty)
         {
-            return new ComplexPropertyReference(complexPropertyReference, nestedComplexProperty);
+            return new ComplexPropertyReference(complexPropertyReference, nestedComplexProperty, memberExpression);
         }
 
         // Convert ICollection<T>.Count to Count<T>()
diff --git a/src/EFCore/Query/Internal/QueryTranslationPostprocessorFactory.cs b/src/EFCore/Query/Internal/QueryTranslationPostprocessorFactory.cs
index 2ecf73545f..01d895451b 100644
--- a/src/EFCore/Query/Internal/QueryTranslationPostprocessorFactory.cs
+++ b/src/EFCore/Query/Internal/QueryTranslationPostprocessorFactory.cs
@@ -34,6 +34,7 @@ public QueryTranslationPostprocessorFactory(QueryTranslationPostprocessorDepende
     ///     any release. You should only use it directly in your code with extreme caution and knowing that
     ///     doing so can result in application failures when updating to a new Entity Framework Core release.
     /// </summary>
+    [DebuggerStepThrough]
     public virtual QueryTranslationPostprocessor Create(QueryCompilationContext queryCompilationContext)
         => new(Dependencies, queryCompilationContext);
 }
diff --git a/src/EFCore/Query/Internal/QueryTranslationPreprocessorFactory.cs b/src/EFCore/Query/Internal/QueryTranslationPreprocessorFactory.cs
index c28ced7b45..f6c24355b4 100644
--- a/src/EFCore/Query/Internal/QueryTranslationPreprocessorFactory.cs
+++ b/src/EFCore/Query/Internal/QueryTranslationPreprocessorFactory.cs
@@ -34,6 +34,7 @@ public QueryTranslationPreprocessorFactory(QueryTranslationPreprocessorDependenc
     ///     any release. You should only use it directly in your code with extreme caution and knowing that
     ///     doing so can result in application failures when updating to a new Entity Framework Core release.
     /// </summary>
+    [DebuggerStepThrough]
     public virtual QueryTranslationPreprocessor Create(QueryCompilationContext queryCompilationContext)
         => new(Dependencies, queryCompilationContext);
 }
diff --git a/src/EFCore/Query/QueryableMethodTranslatingExpressionVisitor.cs b/src/EFCore/Query/QueryableMethodTranslatingExpressionVisitor.cs
index 0a5fd294b1..0f316a4787 100644
--- a/src/EFCore/Query/QueryableMethodTranslatingExpressionVisitor.cs
+++ b/src/EFCore/Query/QueryableMethodTranslatingExpressionVisitor.cs
@@ -580,9 +580,11 @@ protected override Expression VisitMethodCall(MethodCallExpression methodCallExp
                         when genericMethod == QueryableMethods.Where:
                         return CheckTranslated(TranslateWhere(shapedQueryExpression, GetLambdaExpressionFromArgument(1)));
 
+                        [DebuggerStepThrough]
                         LambdaExpression GetLambdaExpressionFromArgument(int argumentIndex)
                             => methodCallExpression.Arguments[argumentIndex].UnwrapLambdaFromQuote();
 
+                        [DebuggerStepThrough]
                         Expression CheckTranslated(ShapedQueryExpression? translated)
                         {
                             if (translated is not null)
@@ -604,7 +606,8 @@ Expression CheckTranslated(ShapedQueryExpression? translated)
 
         // The method isn't a LINQ operator on Queryable/QueryableExtensions.
 
-        // Identify property access, e.g. primitive collection property (context.Blogs.Where(b => b.Tags.Contains(...)))
+        // Identify property access, i.e. primitive collection property (context.Blogs.Where(b => b.Tags.Contains(...))),
+        // complex collection property...
         if (IsMemberAccess(methodCallExpression, QueryCompilationContext.Model, out var propertyAccessSource, out var propertyName)
             && TranslateMemberAccess(propertyAccessSource, propertyName) is { } translation)
         {
@@ -619,6 +622,25 @@ Expression CheckTranslated(ShapedQueryExpression? translated)
                     CoreStrings.TranslationFailedWithDetails(methodCallExpression.Print(), TranslationErrorDetails));
     }
 
+    /// <inheritdoc />
+    protected override Expression VisitMember(MemberExpression memberExpression)
+    {
+        // Identify property access, i.e. primitive collection property (context.Blogs.Where(b => b.Tags.Contains(...))),
+        // complex collection property...
+        if (IsMemberAccess(memberExpression, QueryCompilationContext.Model, out var propertyAccessSource, out var propertyName)
+            && TranslateMemberAccess(propertyAccessSource, propertyName) is { } translation)
+        {
+            return translation;
+        }
+
+        return _subquery
+            ? QueryCompilationContext.NotTranslatedExpression
+            : TranslationErrorDetails is null
+                ? throw new InvalidOperationException(CoreStrings.TranslationFailed(memberExpression.Print()))
+                : throw new InvalidOperationException(
+                    CoreStrings.TranslationFailedWithDetails(memberExpression.Print(), TranslationErrorDetails));
+    }
+
     private sealed class EntityShaperNullableMarkingExpressionVisitor : ExpressionVisitor
     {
         protected override Expression VisitExtension(Expression extensionExpression)
diff --git a/test/EFCore.Cosmos.FunctionalTests/ConfigPatternsCosmosTest.cs b/test/EFCore.Cosmos.FunctionalTests/ConfigPatternsCosmosTest.cs
index ac49b58f69..6f77d5d867 100644
--- a/test/EFCore.Cosmos.FunctionalTests/ConfigPatternsCosmosTest.cs
+++ b/test/EFCore.Cosmos.FunctionalTests/ConfigPatternsCosmosTest.cs
@@ -1,6 +1,7 @@
 // Licensed to the .NET Foundation under one or more agreements.
 // The .NET Foundation licenses this file to you under the MIT license.
 
+using System.Collections.Concurrent;
 using Microsoft.Azure.Cosmos;
 
 // ReSharper disable UnusedAutoPropertyAccessor.Local
@@ -124,6 +125,41 @@ public async Task Should_throw_if_specified_connection_mode_is_wrong()
         });
     }
 
+    [ConditionalFact]
+    public async Task Cosmos_client_instance_is_thread_safe()
+    {
+        await using var testDatabase = await CosmosTestStore.CreateInitializedAsync(DatabaseName);
+        var options = CreateOptions(testDatabase);
+
+        var threadCount = Environment.ProcessorCount;
+        const int iterationsPerThread = 2;
+        var clients = new ConcurrentBag<CosmosClient>();
+        var tasks = new List<Task>();
+
+        for (var i = 0; i < threadCount; i++)
+        {
+            tasks.Add(Task.Run(async () =>
+            {
+                for (var j = 0; j < iterationsPerThread; j++)
+                {
+                    await Task.Yield(); // Force context switching
+                    using var context = new CustomerContext(options);
+                    var client = context.Database.GetCosmosClient();
+                    clients.Add(client);
+                }
+            }));
+        }
+
+        await Task.WhenAll(tasks);
+
+        // All retrieved clients should be the same instance
+        var clientsArray = clients.ToArray();
+        Assert.Equal(threadCount * iterationsPerThread, clientsArray.Length);
+        
+        var uniqueClients = clientsArray.Distinct().ToArray();
+        Assert.Single(uniqueClients); // Should only have one unique client instance
+    }
+
     private DbContextOptions CreateOptions(CosmosTestStore testDatabase, Action<DbContextOptionsBuilder> configure = null)
     {
         var builder = Fixture.AddOptions(testDatabase.AddProviderOptions(new DbContextOptionsBuilder()))
diff --git a/test/EFCore.Cosmos.FunctionalTests/ConnectionSpecificationTest.cs b/test/EFCore.Cosmos.FunctionalTests/ConnectionSpecificationTest.cs
index 267ce8f173..83b3867ae4 100644
--- a/test/EFCore.Cosmos.FunctionalTests/ConnectionSpecificationTest.cs
+++ b/test/EFCore.Cosmos.FunctionalTests/ConnectionSpecificationTest.cs
@@ -36,11 +36,10 @@ protected override void OnConfiguring(DbContextOptionsBuilder optionsBuilder)
     public async Task Throws_for_missing_connection_info()
     {
         using var context = new NoConnectionContext();
-        var creator = context.GetService<IDatabaseCreator>();
 
         Assert.Equal(
             CosmosStrings.ConnectionInfoMissing,
-            (await Assert.ThrowsAsync<InvalidOperationException>(() => creator.EnsureDeletedAsync())).Message);
+            (await Assert.ThrowsAsync<InvalidOperationException>(() => context.GetService<IDatabaseCreator>().EnsureDeletedAsync())).Message);
     }
 
     public class NoConnectionContext : DbContext
diff --git a/test/EFCore.Cosmos.FunctionalTests/Query/Associations/OwnedNavigations/OwnedNavigationsProjectionCosmosTest.cs b/test/EFCore.Cosmos.FunctionalTests/Query/Associations/OwnedNavigations/OwnedNavigationsProjectionCosmosTest.cs
index 6e2fe7bf4b..dc98beefba 100644
--- a/test/EFCore.Cosmos.FunctionalTests/Query/Associations/OwnedNavigations/OwnedNavigationsProjectionCosmosTest.cs
+++ b/test/EFCore.Cosmos.FunctionalTests/Query/Associations/OwnedNavigations/OwnedNavigationsProjectionCosmosTest.cs
@@ -23,7 +23,7 @@ public override async Task Select_root(QueryTrackingBehavior queryTrackingBehavi
 """);
     }
 
-    #region Simple properties
+    #region Scalar properties
 
     public override async Task Select_property_on_required_related(QueryTrackingBehavior queryTrackingBehavior)
     {
@@ -84,9 +84,9 @@ public override async Task Select_nullable_value_type_property_on_null_related(Q
 """);
     }
 
-    #endregion Simple properties
+    #endregion Scalar properties
 
-    #region Non-collection
+    #region Structural properties
 
     public override async Task Select_related(QueryTrackingBehavior queryTrackingBehavior)
     {
@@ -194,9 +194,34 @@ public override Task Select_required_related_via_optional_navigation(QueryTracki
         // We don't support (inter-document) navigations with Cosmos.
         => Assert.ThrowsAsync<InvalidOperationException>(() => base.Select_required_related_via_optional_navigation(queryTrackingBehavior));
 
-    #endregion Non-collection
+    public override async Task Select_unmapped_related_scalar_property(QueryTrackingBehavior queryTrackingBehavior)
+    {
+        await base.Select_unmapped_related_scalar_property(queryTrackingBehavior);
+
+        if (queryTrackingBehavior is not QueryTrackingBehavior.TrackAll)
+        {
+            AssertSql(
+                """
+SELECT VALUE c
+FROM root c
+""");
+        }
+    }
+
+    public override async Task Select_untranslatable_method_on_related_scalar_property(QueryTrackingBehavior queryTrackingBehavior)
+    {
+        await base.Select_untranslatable_method_on_related_scalar_property(queryTrackingBehavior);
+
+        AssertSql(
+            """
+SELECT VALUE c["RequiredRelated"]["Int"]
+FROM root c
+""");
+    }
+
+    #endregion Structural properties
 
-    #region Collection
+    #region Structural collection properties
 
     public override async Task Select_related_collection(QueryTrackingBehavior queryTrackingBehavior)
     {
@@ -280,7 +305,7 @@ await Assert.ThrowsAsync<KeyNotFoundException>(()
         }
     }
 
-    #endregion Collection
+    #endregion Structural collection properties
 
     #region Multiple
 
diff --git a/test/EFCore.Cosmos.Tests/Extensions/PartitionKeyBuilderExtensionsTest.cs b/test/EFCore.Cosmos.Tests/Extensions/PartitionKeyBuilderExtensionsTest.cs
index 09a9b73554..112c76f539 100644
--- a/test/EFCore.Cosmos.Tests/Extensions/PartitionKeyBuilderExtensionsTest.cs
+++ b/test/EFCore.Cosmos.Tests/Extensions/PartitionKeyBuilderExtensionsTest.cs
@@ -120,7 +120,7 @@ protected override void OnModelCreating(ModelBuilder modelBuilder)
         }
 
         protected override void OnConfiguring(DbContextOptionsBuilder optionsBuilder)
-            => optionsBuilder.UseCosmos("localhost", "_", "_");
+            => optionsBuilder.UseCosmos("https://localhost:8081", "C2y6yDjf5/R+ob0N8A7Cgv30VRDJIWEHLM+4QDU5DE2nQ9nDuVTqobD4b8mGGyPMbIZnqyMsEcaGQy67XIw/Jw==", "_");
     }
 
     public class Customer1
diff --git a/test/EFCore.Relational.Specification.Tests/Query/Associations/ComplexTableSplitting/ComplexTableSplittingProjectionRelationalTestBase.cs b/test/EFCore.Relational.Specification.Tests/Query/Associations/ComplexTableSplitting/ComplexTableSplittingProjectionRelationalTestBase.cs
index 086f1699ec..41de9bd8d9 100644
--- a/test/EFCore.Relational.Specification.Tests/Query/Associations/ComplexTableSplitting/ComplexTableSplittingProjectionRelationalTestBase.cs
+++ b/test/EFCore.Relational.Specification.Tests/Query/Associations/ComplexTableSplitting/ComplexTableSplittingProjectionRelationalTestBase.cs
@@ -15,14 +15,6 @@ public ComplexTableSplittingProjectionRelationalTestBase(TFixture fixture, ITest
         Fixture.TestSqlLoggerFactory.SetTestOutputHelper(testOutputHelper);
     }
 
-    // Collections are not supported with table splitting, only JSON
-    public override Task Select_nested_collection_on_required_related(QueryTrackingBehavior queryTrackingBehavior)
-        => Assert.ThrowsAsync<InvalidOperationException>(() => base.Select_nested_collection_on_required_related(queryTrackingBehavior));
-
-    // Collections are not supported with table splitting, only JSON
-    public override Task Select_nested_collection_on_optional_related(QueryTrackingBehavior queryTrackingBehavior)
-        => Assert.ThrowsAsync<InvalidOperationException>(() => base.Select_nested_collection_on_optional_related(queryTrackingBehavior));
-
     // Collections are not supported with table splitting, only JSON
     public override Task SelectMany_related_collection(QueryTrackingBehavior queryTrackingBehavior)
         => Assert.ThrowsAsync<InvalidOperationException>(() => base.SelectMany_related_collection(queryTrackingBehavior));
diff --git a/test/EFCore.Relational.Specification.Tests/Query/PrecompiledQueryRelationalFixture.cs b/test/EFCore.Relational.Specification.Tests/Query/PrecompiledQueryRelationalFixture.cs
index a557ec7a11..f5067aff11 100644
--- a/test/EFCore.Relational.Specification.Tests/Query/PrecompiledQueryRelationalFixture.cs
+++ b/test/EFCore.Relational.Specification.Tests/Query/PrecompiledQueryRelationalFixture.cs
@@ -102,6 +102,7 @@ public class NonSqlGeneratingShapedQueryCompilingExpressionVisitorFactory(
         RelationalShapedQueryCompilingExpressionVisitorDependencies relationalDependencies)
         : IShapedQueryCompilingExpressionVisitorFactory
     {
+        [DebuggerStepThrough]
         public ShapedQueryCompilingExpressionVisitor Create(QueryCompilationContext queryCompilationContext)
             => new NonSqlGeneratingShapedQueryCompilingExpressionVisitor(
                 dependencies,
diff --git a/test/EFCore.Specification.Tests/Query/Associations/AssociationsBulkUpdateTestBase.cs b/test/EFCore.Specification.Tests/Query/Associations/AssociationsBulkUpdateTestBase.cs
index c350d781dd..d4fdfabaa8 100644
--- a/test/EFCore.Specification.Tests/Query/Associations/AssociationsBulkUpdateTestBase.cs
+++ b/test/EFCore.Specification.Tests/Query/Associations/AssociationsBulkUpdateTestBase.cs
@@ -79,6 +79,25 @@ public virtual Task Update_property_on_projected_association_with_OrderBy_Skip()
             s => s.SetProperty(c => c.String, "foo_updated"),
             rowsAffectedCount: 3);
 
+    [ConditionalFact]
+    public virtual async Task Update_association_with_null_required_property()
+    {
+        using var context = Fixture.CreateContext();
+
+        var invalidRelated = Fixture.Data.RootEntities.Single(e => e.Id == 1).RequiredRelated;
+        var originalValue = invalidRelated.String;
+        invalidRelated.String = null!;
+
+        await Assert.ThrowsAnyAsync<Exception>(() =>
+            context.Set<RootEntity>().ExecuteUpdateAsync(s => s.SetProperty(x => x.RequiredRelated, invalidRelated)));
+
+        // Make sure no update actually occurred in the database
+        using (Fixture.ListLoggerFactory.SuspendRecordingEvents())
+        {
+            Assert.Equal(originalValue, (await context.Set<RootEntity>().SingleAsync(e => e.Id == 1)).RequiredRelated.String);
+        }
+    }
+
     #endregion Update properties
 
     #region Update association
@@ -249,6 +268,27 @@ public virtual Task Update_association_to_null_parameter()
                 rowsAffectedCount: 7);
     }
 
+    [ConditionalFact]
+    public virtual async Task Update_association_with_null_required_nested_association()
+    {
+        using var context = Fixture.CreateContext();
+
+        var invalidRelated = Fixture.Data.RootEntities.Single(e => e.Id == 1).RequiredRelated;
+        var originalNested = invalidRelated.RequiredNested;
+        invalidRelated.RequiredNested = null!;
+
+        await Assert.ThrowsAnyAsync<Exception>(() =>
+            context.Set<RootEntity>().ExecuteUpdateAsync(s => s.SetProperty(x => x.RequiredRelated, invalidRelated)));
+
+        // Make sure no update actually occurred in the database
+        using (Fixture.ListLoggerFactory.SuspendRecordingEvents())
+        {
+            Assert.Equal(
+                originalNested.String,
+                (await context.Set<RootEntity>().SingleAsync(e => e.Id == 1)).RequiredRelated.RequiredNested.String);
+        }
+    }
+
     #endregion Update association
 
     #region Update collection
diff --git a/test/EFCore.Specification.Tests/Query/Associations/AssociationsModel.cs b/test/EFCore.Specification.Tests/Query/Associations/AssociationsModel.cs
index 4408c2fdd0..ece8b3a9e3 100644
--- a/test/EFCore.Specification.Tests/Query/Associations/AssociationsModel.cs
+++ b/test/EFCore.Specification.Tests/Query/Associations/AssociationsModel.cs
@@ -45,6 +45,8 @@ public class RelatedType : IEquatable<RelatedType>
     public required string String { get; set; }
     public required List<int> Ints { get; set; }
 
+    public int Unmapped => Int + 1;
+
     public required NestedType RequiredNested { get; set; }
     public NestedType? OptionalNested { get; set; }
     public List<NestedType> NestedCollection { get; set; } = null!;
diff --git a/test/EFCore.Specification.Tests/Query/Associations/AssociationsProjectionTestBase.cs b/test/EFCore.Specification.Tests/Query/Associations/AssociationsProjectionTestBase.cs
index 0084750d43..81a01e343e 100644
--- a/test/EFCore.Specification.Tests/Query/Associations/AssociationsProjectionTestBase.cs
+++ b/test/EFCore.Specification.Tests/Query/Associations/AssociationsProjectionTestBase.cs
@@ -12,7 +12,7 @@ public virtual Task Select_root(QueryTrackingBehavior queryTrackingBehavior)
             ss => ss.Set<RootEntity>(),
             queryTrackingBehavior: queryTrackingBehavior);
 
-    #region Simple properties
+    #region Scalar properties
 
     [ConditionalTheory, MemberData(nameof(TrackingData))]
     public virtual Task Select_property_on_required_related(QueryTrackingBehavior queryTrackingBehavior)
@@ -41,9 +41,9 @@ public virtual Task Select_nullable_value_type_property_on_null_related(QueryTra
             ss => ss.Set<RootEntity>().Select(x => (int?)x.OptionalRelated!.Int),
             queryTrackingBehavior: queryTrackingBehavior);
 
-    #endregion Simple properties
+    #endregion Scalar properties
 
-    #region Non-collection
+    #region Structural properties
 
     [ConditionalTheory, MemberData(nameof(TrackingData))]
     public virtual Task Select_related(QueryTrackingBehavior queryTrackingBehavior)
@@ -87,9 +87,23 @@ public virtual Task Select_required_related_via_optional_navigation(QueryTrackin
             ss => ss.Set<RootReferencingEntity>().Select(e => e.Root!.RequiredRelated),
             queryTrackingBehavior: queryTrackingBehavior);
 
-    #endregion Non-collection
+    [ConditionalTheory, MemberData(nameof(TrackingData))]
+    public virtual Task Select_unmapped_related_scalar_property(QueryTrackingBehavior queryTrackingBehavior)
+        => AssertQuery(
+            ss => ss.Set<RootEntity>().Select(e => e.RequiredRelated.Unmapped),
+            queryTrackingBehavior: queryTrackingBehavior);
+
+    [ConditionalTheory, MemberData(nameof(TrackingData))]
+    public virtual Task Select_untranslatable_method_on_related_scalar_property(QueryTrackingBehavior queryTrackingBehavior)
+        => AssertQuery(
+            ss => ss.Set<RootEntity>().Select(e => UntranslatableMethod(e.RequiredRelated.Int)),
+            queryTrackingBehavior: queryTrackingBehavior);
+
+    private static int UntranslatableMethod(int i) => i + 1;
+
+    #endregion Structural properties
 
-    #region Collection
+    #region Structural collection properties
 
     // Note we order via the Id (server-side) to ensure the collections come back in deterministic order,
     // otherwise it's difficult/unreliable to compare client-side.
@@ -139,7 +153,7 @@ public virtual Task SelectMany_nested_collection_on_optional_related(QueryTracki
                 .SelectMany(x => x.OptionalRelated.Maybe(xx => xx!.NestedCollection) ?? new List<NestedType>()),
             queryTrackingBehavior: queryTrackingBehavior);
 
-    #endregion Collection
+    #endregion Structural collection properties
 
     #region Multiple
 
diff --git a/test/EFCore.Specification.Tests/Query/Associations/OwnedNavigations/OwnedNavigationsProjectionTestBase.cs b/test/EFCore.Specification.Tests/Query/Associations/OwnedNavigations/OwnedNavigationsProjectionTestBase.cs
index 8f773a69f6..c99169c51b 100644
--- a/test/EFCore.Specification.Tests/Query/Associations/OwnedNavigations/OwnedNavigationsProjectionTestBase.cs
+++ b/test/EFCore.Specification.Tests/Query/Associations/OwnedNavigations/OwnedNavigationsProjectionTestBase.cs
@@ -6,7 +6,7 @@ namespace Microsoft.EntityFrameworkCore.Query.Associations.OwnedNavigations;
 public abstract class OwnedNavigationsProjectionTestBase<TFixture>(TFixture fixture) : AssociationsProjectionTestBase<TFixture>(fixture)
     where TFixture : OwnedNavigationsFixtureBase, new()
 {
-    #region Non-collection
+    #region Structural properties
 
     public override Task Select_related(QueryTrackingBehavior queryTrackingBehavior)
         => AssertOwnedTrackingQuery(queryTrackingBehavior, () => base.Select_related(queryTrackingBehavior));
@@ -26,9 +26,14 @@ public override Task Select_required_nested_on_optional_related(QueryTrackingBeh
     public override Task Select_optional_nested_on_optional_related(QueryTrackingBehavior queryTrackingBehavior)
         => AssertOwnedTrackingQuery(queryTrackingBehavior, () => base.Select_optional_nested_on_optional_related(queryTrackingBehavior));
 
-    #endregion Non-collection
+    public override Task Select_unmapped_related_scalar_property(QueryTrackingBehavior queryTrackingBehavior)
+        => AssertOwnedTrackingQuery(
+            queryTrackingBehavior,
+            () => base.Select_unmapped_related_scalar_property(queryTrackingBehavior));
+
+    #endregion Structural properties
 
-    #region Collection
+    #region Structural collection properties
 
     public override Task Select_related_collection(QueryTrackingBehavior queryTrackingBehavior)
         => AssertOwnedTrackingQuery(queryTrackingBehavior, () => base.Select_related_collection(queryTrackingBehavior));
@@ -50,7 +55,7 @@ public override Task SelectMany_nested_collection_on_optional_related(QueryTrack
         => AssertOwnedTrackingQuery(
             queryTrackingBehavior, () => base.SelectMany_nested_collection_on_optional_related(queryTrackingBehavior));
 
-    #endregion Collection
+    #endregion Structural collection properties
 
     #region Multiple
 
diff --git a/test/EFCore.SqlServer.FunctionalTests/Query/Associations/ComplexJson/ComplexJsonBulkUpdateSqlServerTest.cs b/test/EFCore.SqlServer.FunctionalTests/Query/Associations/ComplexJson/ComplexJsonBulkUpdateSqlServerTest.cs
index 847f8fa298..86ea03f7b1 100644
--- a/test/EFCore.SqlServer.FunctionalTests/Query/Associations/ComplexJson/ComplexJsonBulkUpdateSqlServerTest.cs
+++ b/test/EFCore.SqlServer.FunctionalTests/Query/Associations/ComplexJson/ComplexJsonBulkUpdateSqlServerTest.cs
@@ -159,6 +159,13 @@ public override async Task Update_property_on_projected_association_with_OrderBy
         AssertExecuteUpdateSql();
     }
 
+    public override async Task Update_association_with_null_required_property()
+    {
+        await base.Update_association_with_null_required_property();
+
+        AssertExecuteUpdateSql();
+    }
+
     #endregion Update properties
 
     #region Update association
@@ -327,6 +334,13 @@ public override async Task Update_association_to_null_parameter()
 """);
     }
 
+    public override async Task Update_association_with_null_required_nested_association()
+    {
+        await base.Update_association_with_null_required_nested_association();
+
+        AssertExecuteUpdateSql();
+    }
+
     #endregion Update association
 
     #region Update collection
diff --git a/test/EFCore.SqlServer.FunctionalTests/Query/Associations/ComplexJson/ComplexJsonProjectionSqlServerTest.cs b/test/EFCore.SqlServer.FunctionalTests/Query/Associations/ComplexJson/ComplexJsonProjectionSqlServerTest.cs
index c80f71682a..55a9318a0e 100644
--- a/test/EFCore.SqlServer.FunctionalTests/Query/Associations/ComplexJson/ComplexJsonProjectionSqlServerTest.cs
+++ b/test/EFCore.SqlServer.FunctionalTests/Query/Associations/ComplexJson/ComplexJsonProjectionSqlServerTest.cs
@@ -17,7 +17,7 @@ public override async Task Select_root(QueryTrackingBehavior queryTrackingBehavi
 """);
     }
 
-    #region Simple properties
+    #region Scalar properties
 
     public override async Task Select_property_on_required_related(QueryTrackingBehavior queryTrackingBehavior)
     {
@@ -107,9 +107,9 @@ SELECT CAST(JSON_VALUE([r].[OptionalRelated], '$.Int') AS int)
         }
     }
 
-    #endregion Simple properties
+    #endregion Scalar properties
 
-    #region Non-collection
+    #region Structural properties
 
     public override async Task Select_related(QueryTrackingBehavior queryTrackingBehavior)
     {
@@ -189,9 +189,42 @@ public override async Task Select_required_related_via_optional_navigation(Query
 """);
     }
 
-    #endregion Non-collection
+    public override async Task Select_unmapped_related_scalar_property(QueryTrackingBehavior queryTrackingBehavior)
+    {
+        await base.Select_unmapped_related_scalar_property(queryTrackingBehavior);
+
+        AssertSql(
+            """
+SELECT [r].[Id], [r].[Name], [r].[OptionalRelated], [r].[RelatedCollection], [r].[RequiredRelated]
+FROM [RootEntity] AS [r]
+""");
+    }
+
+    public override async Task Select_untranslatable_method_on_related_scalar_property(QueryTrackingBehavior queryTrackingBehavior)
+    {
+        await base.Select_untranslatable_method_on_related_scalar_property(queryTrackingBehavior);
+
+        if (Fixture.UsingJsonType)
+        {
+            AssertSql(
+                """
+SELECT JSON_VALUE([r].[RequiredRelated], '$.Int' RETURNING int)
+FROM [RootEntity] AS [r]
+""");
+        }
+        else
+        {
+            AssertSql(
+                """
+SELECT CAST(JSON_VALUE([r].[RequiredRelated], '$.Int') AS int)
+FROM [RootEntity] AS [r]
+""");
+        }
+    }
+
+    #endregion Structural properties
 
-    #region Collection
+    #region Structural collection properties
 
     public override async Task Select_related_collection(QueryTrackingBehavior queryTrackingBehavior)
     {
@@ -343,7 +376,7 @@ public override async Task SelectMany_nested_collection_on_optional_related(Quer
         }
     }
 
-    #endregion Collection
+    #endregion Structural collection properties
 
     #region Multiple
 
diff --git a/test/EFCore.SqlServer.FunctionalTests/Query/Associations/ComplexTableSplitting/ComplexTableSplittingBulkUpdateSqlServerTest.cs b/test/EFCore.SqlServer.FunctionalTests/Query/Associations/ComplexTableSplitting/ComplexTableSplittingBulkUpdateSqlServerTest.cs
index 738afe2292..a4ec5bee91 100644
--- a/test/EFCore.SqlServer.FunctionalTests/Query/Associations/ComplexTableSplitting/ComplexTableSplittingBulkUpdateSqlServerTest.cs
+++ b/test/EFCore.SqlServer.FunctionalTests/Query/Associations/ComplexTableSplitting/ComplexTableSplittingBulkUpdateSqlServerTest.cs
@@ -104,6 +104,13 @@ public override async Task Update_property_on_projected_association_with_OrderBy
         AssertExecuteUpdateSql();
     }
 
+    public override async Task Update_association_with_null_required_property()
+    {
+        await base.Update_association_with_null_required_property();
+
+        AssertExecuteUpdateSql();
+    }
+
     #endregion Update properties
 
     #region Update association
@@ -119,6 +126,11 @@ public override async Task Update_association_to_parameter()
 @complex_type_p_Ints='?' (Size = 4000)
 @complex_type_p_Name='?' (Size = 4000)
 @complex_type_p_String='?' (Size = 4000)
+@complex_type_p_RequiredNested_Id='?' (DbType = Int32)
+@complex_type_p_RequiredNested_Int='?' (DbType = Int32)
+@complex_type_p_RequiredNested_Ints='?' (Size = 4000)
+@complex_type_p_RequiredNested_Name='?' (Size = 4000)
+@complex_type_p_RequiredNested_String='?' (Size = 4000)
 
 UPDATE [r]
 SET [r].[RequiredRelated_Id] = @complex_type_p_Id,
@@ -126,16 +138,16 @@ public override async Task Update_association_to_parameter()
     [r].[RequiredRelated_Ints] = @complex_type_p_Ints,
     [r].[RequiredRelated_Name] = @complex_type_p_Name,
     [r].[RequiredRelated_String] = @complex_type_p_String,
-    [r].[RequiredRelated_OptionalNested_Id] = @complex_type_p_Id,
-    [r].[RequiredRelated_OptionalNested_Int] = @complex_type_p_Int,
-    [r].[RequiredRelated_OptionalNested_Ints] = @complex_type_p_Ints,
-    [r].[RequiredRelated_OptionalNested_Name] = @complex_type_p_Name,
-    [r].[RequiredRelated_OptionalNested_String] = @complex_type_p_String,
-    [r].[RequiredRelated_RequiredNested_Id] = @complex_type_p_Id,
-    [r].[RequiredRelated_RequiredNested_Int] = @complex_type_p_Int,
-    [r].[RequiredRelated_RequiredNested_Ints] = @complex_type_p_Ints,
-    [r].[RequiredRelated_RequiredNested_Name] = @complex_type_p_Name,
-    [r].[RequiredRelated_RequiredNested_String] = @complex_type_p_String
+    [r].[RequiredRelated_OptionalNested_Id] = NULL,
+    [r].[RequiredRelated_OptionalNested_Int] = NULL,
+    [r].[RequiredRelated_OptionalNested_Ints] = NULL,
+    [r].[RequiredRelated_OptionalNested_Name] = NULL,
+    [r].[RequiredRelated_OptionalNested_String] = NULL,
+    [r].[RequiredRelated_RequiredNested_Id] = @complex_type_p_RequiredNested_Id,
+    [r].[RequiredRelated_RequiredNested_Int] = @complex_type_p_RequiredNested_Int,
+    [r].[RequiredRelated_RequiredNested_Ints] = @complex_type_p_RequiredNested_Ints,
+    [r].[RequiredRelated_RequiredNested_Name] = @complex_type_p_RequiredNested_Name,
+    [r].[RequiredRelated_RequiredNested_String] = @complex_type_p_RequiredNested_String
 FROM [RootEntity] AS [r]
 """);
     }
@@ -215,6 +227,11 @@ public override async Task Update_association_to_inline()
 @complex_type_p_Ints='?' (Size = 4000)
 @complex_type_p_Name='?' (Size = 4000)
 @complex_type_p_String='?' (Size = 4000)
+@complex_type_p_RequiredNested_Id='?' (DbType = Int32)
+@complex_type_p_RequiredNested_Int='?' (DbType = Int32)
+@complex_type_p_RequiredNested_Ints='?' (Size = 4000)
+@complex_type_p_RequiredNested_Name='?' (Size = 4000)
+@complex_type_p_RequiredNested_String='?' (Size = 4000)
 
 UPDATE [r]
 SET [r].[RequiredRelated_Id] = @complex_type_p_Id,
@@ -222,16 +239,16 @@ public override async Task Update_association_to_inline()
     [r].[RequiredRelated_Ints] = @complex_type_p_Ints,
     [r].[RequiredRelated_Name] = @complex_type_p_Name,
     [r].[RequiredRelated_String] = @complex_type_p_String,
-    [r].[RequiredRelated_OptionalNested_Id] = @complex_type_p_Id,
-    [r].[RequiredRelated_OptionalNested_Int] = @complex_type_p_Int,
-    [r].[RequiredRelated_OptionalNested_Ints] = @complex_type_p_Ints,
-    [r].[RequiredRelated_OptionalNested_Name] = @complex_type_p_Name,
-    [r].[RequiredRelated_OptionalNested_String] = @complex_type_p_String,
-    [r].[RequiredRelated_RequiredNested_Id] = @complex_type_p_Id,
-    [r].[RequiredRelated_RequiredNested_Int] = @complex_type_p_Int,
-    [r].[RequiredRelated_RequiredNested_Ints] = @complex_type_p_Ints,
-    [r].[RequiredRelated_RequiredNested_Name] = @complex_type_p_Name,
-    [r].[RequiredRelated_RequiredNested_String] = @complex_type_p_String
+    [r].[RequiredRelated_OptionalNested_Id] = NULL,
+    [r].[RequiredRelated_OptionalNested_Int] = NULL,
+    [r].[RequiredRelated_OptionalNested_Ints] = NULL,
+    [r].[RequiredRelated_OptionalNested_Name] = NULL,
+    [r].[RequiredRelated_OptionalNested_String] = NULL,
+    [r].[RequiredRelated_RequiredNested_Id] = @complex_type_p_RequiredNested_Id,
+    [r].[RequiredRelated_RequiredNested_Int] = @complex_type_p_RequiredNested_Int,
+    [r].[RequiredRelated_RequiredNested_Ints] = @complex_type_p_RequiredNested_Ints,
+    [r].[RequiredRelated_RequiredNested_Name] = @complex_type_p_RequiredNested_Name,
+    [r].[RequiredRelated_RequiredNested_String] = @complex_type_p_RequiredNested_String
 FROM [RootEntity] AS [r]
 """);
     }
@@ -356,6 +373,13 @@ public override async Task Update_association_to_null_parameter()
 """);
     }
 
+    public override async Task Update_association_with_null_required_nested_association()
+    {
+        await base.Update_association_with_null_required_nested_association();
+
+        AssertExecuteUpdateSql();
+    }
+
     #endregion Update association
 
     #region Update collection
diff --git a/test/EFCore.SqlServer.FunctionalTests/Query/Associations/ComplexTableSplitting/ComplexTableSplittingProjectionSqlServerTest.cs b/test/EFCore.SqlServer.FunctionalTests/Query/Associations/ComplexTableSplitting/ComplexTableSplittingProjectionSqlServerTest.cs
index 34aaf66ea2..68db2bb3f2 100644
--- a/test/EFCore.SqlServer.FunctionalTests/Query/Associations/ComplexTableSplitting/ComplexTableSplittingProjectionSqlServerTest.cs
+++ b/test/EFCore.SqlServer.FunctionalTests/Query/Associations/ComplexTableSplitting/ComplexTableSplittingProjectionSqlServerTest.cs
@@ -8,30 +8,6 @@ public class ComplexTableSplittingProjectionSqlServerTest(
     ITestOutputHelper testOutputHelper)
     : ComplexTableSplittingProjectionRelationalTestBase<ComplexTableSplittingSqlServerFixture>(fixture, testOutputHelper)
 {
-    public override async Task Select_related_collection(QueryTrackingBehavior queryTrackingBehavior)
-    {
-        await base.Select_related_collection(queryTrackingBehavior);
-
-        AssertSql(
-            """
-SELECT [r].[Id], [r].[Name], [r].[OptionalRelated_Id], [r].[OptionalRelated_Int], [r].[OptionalRelated_Ints], [r].[OptionalRelated_Name], [r].[OptionalRelated_String], [r].[OptionalRelated_OptionalNested_Id], [r].[OptionalRelated_OptionalNested_Int], [r].[OptionalRelated_OptionalNested_Ints], [r].[OptionalRelated_OptionalNested_Name], [r].[OptionalRelated_OptionalNested_String], [r].[OptionalRelated_RequiredNested_Id], [r].[OptionalRelated_RequiredNested_Int], [r].[OptionalRelated_RequiredNested_Ints], [r].[OptionalRelated_RequiredNested_Name], [r].[OptionalRelated_RequiredNested_String], [r].[RequiredRelated_Id], [r].[RequiredRelated_Int], [r].[RequiredRelated_Ints], [r].[RequiredRelated_Name], [r].[RequiredRelated_String], [r].[RequiredRelated_OptionalNested_Id], [r].[RequiredRelated_OptionalNested_Int], [r].[RequiredRelated_OptionalNested_Ints], [r].[RequiredRelated_OptionalNested_Name], [r].[RequiredRelated_OptionalNested_String], [r].[RequiredRelated_RequiredNested_Id], [r].[RequiredRelated_RequiredNested_Int], [r].[RequiredRelated_RequiredNested_Ints], [r].[RequiredRelated_RequiredNested_Name], [r].[RequiredRelated_RequiredNested_String]
-FROM [RootEntity] AS [r]
-ORDER BY [r].[Id]
-""");
-    }
-
-    public override async Task Select_nested_collection_on_required_related(QueryTrackingBehavior queryTrackingBehavior)
-    {
-        await base.Select_nested_collection_on_required_related(queryTrackingBehavior);
-
-        AssertSql(
-            """
-SELECT [r].[Id], [r].[Name], [r].[OptionalRelated_Id], [r].[OptionalRelated_Int], [r].[OptionalRelated_Ints], [r].[OptionalRelated_Name], [r].[OptionalRelated_String], [r].[OptionalRelated_OptionalNested_Id], [r].[OptionalRelated_OptionalNested_Int], [r].[OptionalRelated_OptionalNested_Ints], [r].[OptionalRelated_OptionalNested_Name], [r].[OptionalRelated_OptionalNested_String], [r].[OptionalRelated_RequiredNested_Id], [r].[OptionalRelated_RequiredNested_Int], [r].[OptionalRelated_RequiredNested_Ints], [r].[OptionalRelated_RequiredNested_Name], [r].[OptionalRelated_RequiredNested_String], [r].[RequiredRelated_Id], [r].[RequiredRelated_Int], [r].[RequiredRelated_Ints], [r].[RequiredRelated_Name], [r].[RequiredRelated_String], [r].[RequiredRelated_OptionalNested_Id], [r].[RequiredRelated_OptionalNested_Int], [r].[RequiredRelated_OptionalNested_Ints], [r].[RequiredRelated_OptionalNested_Name], [r].[RequiredRelated_OptionalNested_String], [r].[RequiredRelated_RequiredNested_Id], [r].[RequiredRelated_RequiredNested_Int], [r].[RequiredRelated_RequiredNested_Ints], [r].[RequiredRelated_RequiredNested_Name], [r].[RequiredRelated_RequiredNested_String]
-FROM [RootEntity] AS [r]
-ORDER BY [r].[Id]
-""");
-    }
-
     public override async Task Select_root(QueryTrackingBehavior queryTrackingBehavior)
     {
         await base.Select_root(queryTrackingBehavior);
@@ -43,6 +19,8 @@ public override async Task Select_root(QueryTrackingBehavior queryTrackingBehavi
 """);
     }
 
+    #region Scalar properties
+
     public override async Task Select_property_on_required_related(QueryTrackingBehavior queryTrackingBehavior)
     {
         await base.Select_property_on_required_related(queryTrackingBehavior);
@@ -87,6 +65,10 @@ public override async Task Select_nullable_value_type_property_on_null_related(Q
 """);
     }
 
+    #endregion Scalar properties
+
+    #region Structural properties
+
     public override async Task Select_related(QueryTrackingBehavior queryTrackingBehavior)
     {
         await base.Select_related(queryTrackingBehavior);
@@ -165,10 +147,64 @@ public override async Task Select_required_related_via_optional_navigation(Query
 """);
     }
 
+    public override async Task Select_unmapped_related_scalar_property(QueryTrackingBehavior queryTrackingBehavior)
+    {
+        await base.Select_unmapped_related_scalar_property(queryTrackingBehavior);
+
+        AssertSql(
+            """
+SELECT [r].[Id], [r].[Name], [r].[OptionalRelated_Id], [r].[OptionalRelated_Int], [r].[OptionalRelated_Ints], [r].[OptionalRelated_Name], [r].[OptionalRelated_String], [r].[OptionalRelated_OptionalNested_Id], [r].[OptionalRelated_OptionalNested_Int], [r].[OptionalRelated_OptionalNested_Ints], [r].[OptionalRelated_OptionalNested_Name], [r].[OptionalRelated_OptionalNested_String], [r].[OptionalRelated_RequiredNested_Id], [r].[OptionalRelated_RequiredNested_Int], [r].[OptionalRelated_RequiredNested_Ints], [r].[OptionalRelated_RequiredNested_Name], [r].[OptionalRelated_RequiredNested_String], [r].[RequiredRelated_Id], [r].[RequiredRelated_Int], [r].[RequiredRelated_Ints], [r].[RequiredRelated_Name], [r].[RequiredRelated_String], [r].[RequiredRelated_OptionalNested_Id], [r].[RequiredRelated_OptionalNested_Int], [r].[RequiredRelated_OptionalNested_Ints], [r].[RequiredRelated_OptionalNested_Name], [r].[RequiredRelated_OptionalNested_String], [r].[RequiredRelated_RequiredNested_Id], [r].[RequiredRelated_RequiredNested_Int], [r].[RequiredRelated_RequiredNested_Ints], [r].[RequiredRelated_RequiredNested_Name], [r].[RequiredRelated_RequiredNested_String]
+FROM [RootEntity] AS [r]
+""");
+    }
+
+    public override async Task Select_untranslatable_method_on_related_scalar_property(QueryTrackingBehavior queryTrackingBehavior)
+    {
+        await base.Select_untranslatable_method_on_related_scalar_property(queryTrackingBehavior);
+
+        AssertSql(
+            """
+SELECT [r].[RequiredRelated_Int]
+FROM [RootEntity] AS [r]
+""");
+    }
+
+    #endregion Structural properties
+
+    #region Structural collection properties
+
+    public override async Task Select_related_collection(QueryTrackingBehavior queryTrackingBehavior)
+    {
+        await base.Select_related_collection(queryTrackingBehavior);
+
+        AssertSql(
+            """
+SELECT [r].[Id], [r].[Name], [r].[OptionalRelated_Id], [r].[OptionalRelated_Int], [r].[OptionalRelated_Ints], [r].[OptionalRelated_Name], [r].[OptionalRelated_String], [r].[OptionalRelated_OptionalNested_Id], [r].[OptionalRelated_OptionalNested_Int], [r].[OptionalRelated_OptionalNested_Ints], [r].[OptionalRelated_OptionalNested_Name], [r].[OptionalRelated_OptionalNested_String], [r].[OptionalRelated_RequiredNested_Id], [r].[OptionalRelated_RequiredNested_Int], [r].[OptionalRelated_RequiredNested_Ints], [r].[OptionalRelated_RequiredNested_Name], [r].[OptionalRelated_RequiredNested_String], [r].[RequiredRelated_Id], [r].[RequiredRelated_Int], [r].[RequiredRelated_Ints], [r].[RequiredRelated_Name], [r].[RequiredRelated_String], [r].[RequiredRelated_OptionalNested_Id], [r].[RequiredRelated_OptionalNested_Int], [r].[RequiredRelated_OptionalNested_Ints], [r].[RequiredRelated_OptionalNested_Name], [r].[RequiredRelated_OptionalNested_String], [r].[RequiredRelated_RequiredNested_Id], [r].[RequiredRelated_RequiredNested_Int], [r].[RequiredRelated_RequiredNested_Ints], [r].[RequiredRelated_RequiredNested_Name], [r].[RequiredRelated_RequiredNested_String]
+FROM [RootEntity] AS [r]
+ORDER BY [r].[Id]
+""");
+    }
+
+    public override async Task Select_nested_collection_on_required_related(QueryTrackingBehavior queryTrackingBehavior)
+    {
+        // Note that collections are not supported with table splitting, only JSON;
+        // the collection selected here is unmapped, and so the test does client evaluation.
+        await base.Select_nested_collection_on_required_related(queryTrackingBehavior);
+
+        AssertSql(
+            """
+SELECT [r].[Id], [r].[Name], [r].[OptionalRelated_Id], [r].[OptionalRelated_Int], [r].[OptionalRelated_Ints], [r].[OptionalRelated_Name], [r].[OptionalRelated_String], [r].[OptionalRelated_OptionalNested_Id], [r].[OptionalRelated_OptionalNested_Int], [r].[OptionalRelated_OptionalNested_Ints], [r].[OptionalRelated_OptionalNested_Name], [r].[OptionalRelated_OptionalNested_String], [r].[OptionalRelated_RequiredNested_Id], [r].[OptionalRelated_RequiredNested_Int], [r].[OptionalRelated_RequiredNested_Ints], [r].[OptionalRelated_RequiredNested_Name], [r].[OptionalRelated_RequiredNested_String], [r].[RequiredRelated_Id], [r].[RequiredRelated_Int], [r].[RequiredRelated_Ints], [r].[RequiredRelated_Name], [r].[RequiredRelated_String], [r].[RequiredRelated_OptionalNested_Id], [r].[RequiredRelated_OptionalNested_Int], [r].[RequiredRelated_OptionalNested_Ints], [r].[RequiredRelated_OptionalNested_Name], [r].[RequiredRelated_OptionalNested_String], [r].[RequiredRelated_RequiredNested_Id], [r].[RequiredRelated_RequiredNested_Int], [r].[RequiredRelated_RequiredNested_Ints], [r].[RequiredRelated_RequiredNested_Name], [r].[RequiredRelated_RequiredNested_String]
+FROM [RootEntity] AS [r]
+ORDER BY [r].[Id]
+""");
+    }
+
     public override async Task Select_nested_collection_on_optional_related(QueryTrackingBehavior queryTrackingBehavior)
     {
         await base.Select_nested_collection_on_optional_related(queryTrackingBehavior);
 
+        // Note that collections are not supported with table splitting, only JSON;
+        // the collection selected here is unmapped, and so the test does client evaluation.
         AssertSql(
             """
 SELECT [r].[Id], [r].[Name], [r].[OptionalRelated_Id], [r].[OptionalRelated_Int], [r].[OptionalRelated_Ints], [r].[OptionalRelated_Name], [r].[OptionalRelated_String], [r].[OptionalRelated_OptionalNested_Id], [r].[OptionalRelated_OptionalNested_Int], [r].[OptionalRelated_OptionalNested_Ints], [r].[OptionalRelated_OptionalNested_Name], [r].[OptionalRelated_OptionalNested_String], [r].[OptionalRelated_RequiredNested_Id], [r].[OptionalRelated_RequiredNested_Int], [r].[OptionalRelated_RequiredNested_Ints], [r].[OptionalRelated_RequiredNested_Name], [r].[OptionalRelated_RequiredNested_String], [r].[RequiredRelated_Id], [r].[RequiredRelated_Int], [r].[RequiredRelated_Ints], [r].[RequiredRelated_Name], [r].[RequiredRelated_String], [r].[RequiredRelated_OptionalNested_Id], [r].[RequiredRelated_OptionalNested_Int], [r].[RequiredRelated_OptionalNested_Ints], [r].[RequiredRelated_OptionalNested_Name], [r].[RequiredRelated_OptionalNested_String], [r].[RequiredRelated_RequiredNested_Id], [r].[RequiredRelated_RequiredNested_Int], [r].[RequiredRelated_RequiredNested_Ints], [r].[RequiredRelated_RequiredNested_Name], [r].[RequiredRelated_RequiredNested_String]
@@ -198,6 +234,10 @@ public override async Task SelectMany_nested_collection_on_optional_related(Quer
         AssertSql();
     }
 
+    #endregion Structural collection properties
+
+    #region Multiple
+
     public override async Task Select_root_duplicated(QueryTrackingBehavior queryTrackingBehavior)
     {
         await base.Select_root_duplicated(queryTrackingBehavior);
@@ -209,6 +249,10 @@ public override async Task Select_root_duplicated(QueryTrackingBehavior queryTra
 """);
     }
 
+    #endregion Multiple
+
+    #region Subquery
+
     public override async Task Select_subquery_required_related_FirstOrDefault(QueryTrackingBehavior queryTrackingBehavior)
     {
         await base.Select_subquery_required_related_FirstOrDefault(queryTrackingBehavior);
@@ -241,6 +285,8 @@ public override async Task Select_subquery_optional_related_FirstOrDefault(Query
 """);
     }
 
+    #endregion Subquery
+
     #region Value types
 
     public override async Task Select_root_with_value_types(QueryTrackingBehavior queryTrackingBehavior)
diff --git a/test/EFCore.SqlServer.FunctionalTests/Query/Associations/Navigations/NavigationsProjectionSqlServerTest.cs b/test/EFCore.SqlServer.FunctionalTests/Query/Associations/Navigations/NavigationsProjectionSqlServerTest.cs
index c573bdfe59..855291be53 100644
--- a/test/EFCore.SqlServer.FunctionalTests/Query/Associations/Navigations/NavigationsProjectionSqlServerTest.cs
+++ b/test/EFCore.SqlServer.FunctionalTests/Query/Associations/Navigations/NavigationsProjectionSqlServerTest.cs
@@ -33,7 +33,7 @@ public override async Task Select_root(QueryTrackingBehavior queryTrackingBehavi
 """);
     }
 
-    #region Simple properties
+    #region Scalar properties
 
     public override async Task Select_property_on_required_related(QueryTrackingBehavior queryTrackingBehavior)
     {
@@ -83,9 +83,9 @@ public override async Task Select_nullable_value_type_property_on_null_related(Q
 """);
     }
 
-    #endregion Simple properties
+    #endregion Scalar properties
 
-    #region Non-collection
+    #region Structural properties
 
     public override async Task Select_related(QueryTrackingBehavior queryTrackingBehavior)
     {
@@ -188,9 +188,37 @@ public override async Task Select_required_related_via_optional_navigation(Query
 """);
     }
 
-    #endregion Non-collection
+    public override async Task Select_unmapped_related_scalar_property(QueryTrackingBehavior queryTrackingBehavior)
+    {
+        await base.Select_unmapped_related_scalar_property(queryTrackingBehavior);
+
+        AssertSql(
+            """
+SELECT [r0].[Id], [r0].[CollectionRootId], [r0].[Int], [r0].[Ints], [r0].[Name], [r0].[OptionalNestedId], [r0].[RequiredNestedId], [r0].[String], [r].[Id], [n].[Id], [n0].[Id], [n1].[Id], [n1].[CollectionRelatedId], [n1].[Int], [n1].[Ints], [n1].[Name], [n1].[String], [n].[CollectionRelatedId], [n].[Int], [n].[Ints], [n].[Name], [n].[String], [n0].[CollectionRelatedId], [n0].[Int], [n0].[Ints], [n0].[Name], [n0].[String]
+FROM [RootEntity] AS [r]
+INNER JOIN [RelatedType] AS [r0] ON [r].[RequiredRelatedId] = [r0].[Id]
+LEFT JOIN [NestedType] AS [n] ON [r0].[OptionalNestedId] = [n].[Id]
+INNER JOIN [NestedType] AS [n0] ON [r0].[RequiredNestedId] = [n0].[Id]
+LEFT JOIN [NestedType] AS [n1] ON [r0].[Id] = [n1].[CollectionRelatedId]
+ORDER BY [r].[Id], [r0].[Id], [n].[Id], [n0].[Id]
+""");
+    }
+
+    public override async Task Select_untranslatable_method_on_related_scalar_property(QueryTrackingBehavior queryTrackingBehavior)
+    {
+        await base.Select_untranslatable_method_on_related_scalar_property(queryTrackingBehavior);
+
+        AssertSql(
+            """
+SELECT [r0].[Int]
+FROM [RootEntity] AS [r]
+INNER JOIN [RelatedType] AS [r0] ON [r].[RequiredRelatedId] = [r0].[Id]
+""");
+    }
+
+    #endregion Structural properties
 
-    #region Collection
+    #region Structural collection properties
 
     public override async Task Select_related_collection(QueryTrackingBehavior queryTrackingBehavior)
     {
@@ -281,7 +309,7 @@ public override async Task SelectMany_nested_collection_on_optional_related(Quer
 """);
     }
 
-    #endregion Collection
+    #endregion Structural collection properties
 
     #region Multiple
 
diff --git a/test/EFCore.SqlServer.FunctionalTests/Query/Associations/OwnedJson/OwnedJsonProjectionSqlServerTest.cs b/test/EFCore.SqlServer.FunctionalTests/Query/Associations/OwnedJson/OwnedJsonProjectionSqlServerTest.cs
index b2f121103d..2c51abda98 100644
--- a/test/EFCore.SqlServer.FunctionalTests/Query/Associations/OwnedJson/OwnedJsonProjectionSqlServerTest.cs
+++ b/test/EFCore.SqlServer.FunctionalTests/Query/Associations/OwnedJson/OwnedJsonProjectionSqlServerTest.cs
@@ -17,7 +17,7 @@ public override async Task Select_root(QueryTrackingBehavior queryTrackingBehavi
 """);
     }
 
-    #region Simple properties
+    #region Scalar properties
 
     public override async Task Select_property_on_required_related(QueryTrackingBehavior queryTrackingBehavior)
     {
@@ -107,9 +107,9 @@ SELECT CAST(JSON_VALUE([r].[OptionalRelated], '$.Int') AS int)
         }
     }
 
-    #endregion Simple properties
+    #endregion Scalar properties
 
-    #region Non-collection
+    #region Structural properties
 
     public override async Task Select_related(QueryTrackingBehavior queryTrackingBehavior)
     {
@@ -210,9 +210,45 @@ public override async Task Select_required_related_via_optional_navigation(Query
         }
     }
 
-    #endregion Non-collection
+    public override async Task Select_unmapped_related_scalar_property(QueryTrackingBehavior queryTrackingBehavior)
+    {
+        await base.Select_unmapped_related_scalar_property(queryTrackingBehavior);
+
+        if (queryTrackingBehavior is not QueryTrackingBehavior.TrackAll)
+        {
+            AssertSql(
+                """
+SELECT [r].[RequiredRelated], [r].[Id]
+FROM [RootEntity] AS [r]
+""");
+        }
+    }
+
+    public override async Task Select_untranslatable_method_on_related_scalar_property(QueryTrackingBehavior queryTrackingBehavior)
+    {
+        await base.Select_untranslatable_method_on_related_scalar_property(queryTrackingBehavior);
+
+        if (Fixture.UsingJsonType)
+        {
+            AssertSql(
+                """
+SELECT JSON_VALUE([r].[RequiredRelated], '$.Int' RETURNING int)
+FROM [RootEntity] AS [r]
+""");
+        }
+        else
+        {
+            AssertSql(
+                """
+SELECT CAST(JSON_VALUE([r].[RequiredRelated], '$.Int') AS int)
+FROM [RootEntity] AS [r]
+""");
+        }
+    }
+
+    #endregion Structural properties
 
-    #region Collection
+    #region Structural collection properties
 
     public override async Task Select_related_collection(QueryTrackingBehavior queryTrackingBehavior)
     {
@@ -382,7 +418,7 @@ public override async Task SelectMany_nested_collection_on_optional_related(Quer
         }
     }
 
-    #endregion Collection
+    #endregion Structural collection properties
 
     #region Multiple
 
diff --git a/test/EFCore.SqlServer.FunctionalTests/Query/Associations/OwnedNavigations/OwnedNavigationsProjectionSqlServerTest.cs b/test/EFCore.SqlServer.FunctionalTests/Query/Associations/OwnedNavigations/OwnedNavigationsProjectionSqlServerTest.cs
index 6e5dcd6d3a..240e85688c 100644
--- a/test/EFCore.SqlServer.FunctionalTests/Query/Associations/OwnedNavigations/OwnedNavigationsProjectionSqlServerTest.cs
+++ b/test/EFCore.SqlServer.FunctionalTests/Query/Associations/OwnedNavigations/OwnedNavigationsProjectionSqlServerTest.cs
@@ -33,7 +33,7 @@ public override async Task Select_root(QueryTrackingBehavior queryTrackingBehavi
 """);
     }
 
-    #region Simple properties
+    #region Scalar properties
 
     public override async Task Select_property_on_required_related(QueryTrackingBehavior queryTrackingBehavior)
     {
@@ -83,9 +83,9 @@ public override async Task Select_nullable_value_type_property_on_null_related(Q
 """);
     }
 
-    #endregion Simple properties
+    #endregion Scalar properties
 
-    #region Non-collection
+    #region Structural properties
 
     public override async Task Select_related(QueryTrackingBehavior queryTrackingBehavior)
     {
@@ -209,9 +209,40 @@ public override async Task Select_required_related_via_optional_navigation(Query
         }
     }
 
-    #endregion Non-collection
+    public override async Task Select_unmapped_related_scalar_property(QueryTrackingBehavior queryTrackingBehavior)
+    {
+        await base.Select_unmapped_related_scalar_property(queryTrackingBehavior);
+
+        if (queryTrackingBehavior is not QueryTrackingBehavior.TrackAll)
+        {
+            AssertSql(
+                """
+SELECT [r0].[RootEntityId], [r0].[Id], [r0].[Int], [r0].[Ints], [r0].[Name], [r0].[String], [r].[Id], [r1].[RelatedTypeRootEntityId], [r2].[RelatedTypeRootEntityId], [r3].[RelatedTypeRootEntityId], [r3].[Id], [r3].[Int], [r3].[Ints], [r3].[Name], [r3].[String], [r1].[Id], [r1].[Int], [r1].[Ints], [r1].[Name], [r1].[String], [r2].[Id], [r2].[Int], [r2].[Ints], [r2].[Name], [r2].[String]
+FROM [RootEntity] AS [r]
+LEFT JOIN [RequiredRelated] AS [r0] ON [r].[Id] = [r0].[RootEntityId]
+LEFT JOIN [RequiredRelated_OptionalNested] AS [r1] ON [r0].[RootEntityId] = [r1].[RelatedTypeRootEntityId]
+LEFT JOIN [RequiredRelated_RequiredNested] AS [r2] ON [r0].[RootEntityId] = [r2].[RelatedTypeRootEntityId]
+LEFT JOIN [RequiredRelated_NestedCollection] AS [r3] ON [r0].[RootEntityId] = [r3].[RelatedTypeRootEntityId]
+ORDER BY [r].[Id], [r0].[RootEntityId], [r1].[RelatedTypeRootEntityId], [r2].[RelatedTypeRootEntityId], [r3].[RelatedTypeRootEntityId]
+""");
+        }
+    }
+
+    public override async Task Select_untranslatable_method_on_related_scalar_property(QueryTrackingBehavior queryTrackingBehavior)
+    {
+        await base.Select_untranslatable_method_on_related_scalar_property(queryTrackingBehavior);
+
+        AssertSql(
+            """
+SELECT [r0].[Int]
+FROM [RootEntity] AS [r]
+LEFT JOIN [RequiredRelated] AS [r0] ON [r].[Id] = [r0].[RootEntityId]
+""");
+    }
+
+    #endregion Structural properties
 
-    #region Collection
+    #region Structural collection properties
 
     public override async Task Select_related_collection(QueryTrackingBehavior queryTrackingBehavior)
     {
@@ -320,7 +351,7 @@ public override async Task SelectMany_nested_collection_on_optional_related(Quer
         }
     }
 
-    #endregion Collection
+    #endregion Structural collection properties
 
     #region Multiple
 
diff --git a/test/EFCore.SqlServer.FunctionalTests/Query/Associations/OwnedTableSplitting/OwnedTableSplittingProjectionSqlServerTest.cs b/test/EFCore.SqlServer.FunctionalTests/Query/Associations/OwnedTableSplitting/OwnedTableSplittingProjectionSqlServerTest.cs
index b098d2b3a6..6beb4793d7 100644
--- a/test/EFCore.SqlServer.FunctionalTests/Query/Associations/OwnedTableSplitting/OwnedTableSplittingProjectionSqlServerTest.cs
+++ b/test/EFCore.SqlServer.FunctionalTests/Query/Associations/OwnedTableSplitting/OwnedTableSplittingProjectionSqlServerTest.cs
@@ -27,7 +27,7 @@ public override async Task Select_root(QueryTrackingBehavior queryTrackingBehavi
 """);
     }
 
-    #region Simple properties
+    #region Scalar properties
 
     public override async Task Select_property_on_required_related(QueryTrackingBehavior queryTrackingBehavior)
     {
@@ -73,9 +73,9 @@ public override async Task Select_nullable_value_type_property_on_null_related(Q
 """);
     }
 
-    #endregion Simple properties
+    #endregion Scalar properties
 
-    #region Non-collection
+    #region Structural properties
 
     public override async Task Select_related(QueryTrackingBehavior queryTrackingBehavior)
     {
@@ -184,9 +184,36 @@ public override async Task Select_required_related_via_optional_navigation(Query
         }
     }
 
-    #endregion Non-collection
+    public override async Task Select_unmapped_related_scalar_property(QueryTrackingBehavior queryTrackingBehavior)
+    {
+        await base.Select_unmapped_related_scalar_property(queryTrackingBehavior);
+
+        if (queryTrackingBehavior is not QueryTrackingBehavior.TrackAll)
+        {
+            AssertSql(
+                """
+SELECT [r].[Id], [r].[RequiredRelated_Id], [r].[RequiredRelated_Int], [r].[RequiredRelated_Ints], [r].[RequiredRelated_Name], [r].[RequiredRelated_String], [r0].[RelatedTypeRootEntityId], [r0].[Id], [r0].[Int], [r0].[Ints], [r0].[Name], [r0].[String], [r].[RequiredRelated_OptionalNested_Id], [r].[RequiredRelated_OptionalNested_Int], [r].[RequiredRelated_OptionalNested_Ints], [r].[RequiredRelated_OptionalNested_Name], [r].[RequiredRelated_OptionalNested_String], [r].[RequiredRelated_RequiredNested_Id], [r].[RequiredRelated_RequiredNested_Int], [r].[RequiredRelated_RequiredNested_Ints], [r].[RequiredRelated_RequiredNested_Name], [r].[RequiredRelated_RequiredNested_String]
+FROM [RootEntity] AS [r]
+LEFT JOIN [RequiredRelated_NestedCollection] AS [r0] ON [r].[Id] = [r0].[RelatedTypeRootEntityId]
+ORDER BY [r].[Id], [r0].[RelatedTypeRootEntityId]
+""");
+        }
+    }
+
+    public override async Task Select_untranslatable_method_on_related_scalar_property(QueryTrackingBehavior queryTrackingBehavior)
+    {
+        await base.Select_untranslatable_method_on_related_scalar_property(queryTrackingBehavior);
+
+        AssertSql(
+            """
+SELECT [r].[RequiredRelated_Int]
+FROM [RootEntity] AS [r]
+""");
+    }
+
+    #endregion Structural properties
 
-    #region Collection
+    #region Structural collection properties
 
     public override async Task Select_related_collection(QueryTrackingBehavior queryTrackingBehavior)
     {
@@ -291,7 +318,7 @@ public override async Task SelectMany_nested_collection_on_optional_related(Quer
         }
     }
 
-    #endregion Collection
+    #endregion Structural collection properties
 
     #region Multiple
 
