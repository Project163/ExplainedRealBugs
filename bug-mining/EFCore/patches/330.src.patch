diff --git a/src/EFCore.Cosmos/Extensions/CosmosPropertyExtensions.cs b/src/EFCore.Cosmos/Extensions/CosmosPropertyExtensions.cs
index 08c7ec8646..a397598c50 100644
--- a/src/EFCore.Cosmos/Extensions/CosmosPropertyExtensions.cs
+++ b/src/EFCore.Cosmos/Extensions/CosmosPropertyExtensions.cs
@@ -34,8 +34,8 @@ private static string GetDefaultJsonPropertyName(IReadOnlyProperty property)
         {
             var pk = property.FindContainingPrimaryKey();
             if (pk != null
-                && (property.ClrType == typeof(int) || ownership.Properties.Contains(property))
-                && property.IsShadowProperty()
+                && ((property.ClrType == typeof(int) && property.IsShadowProperty())
+                    || ownership.Properties.Contains(property))
                 && pk.Properties.Count == ownership.Properties.Count + (ownership.IsUnique ? 0 : 1)
                 && ownership.Properties.All(fkProperty => pk.Properties.Contains(fkProperty)))
             {
diff --git a/src/EFCore.Cosmos/Query/Internal/CosmosShapedQueryCompilingExpressionVisitor.CosmosProjectionBindingRemovingExpressionVisitorBase.cs b/src/EFCore.Cosmos/Query/Internal/CosmosShapedQueryCompilingExpressionVisitor.CosmosProjectionBindingRemovingExpressionVisitorBase.cs
index 2a1724b2e6..bc799a3d16 100644
--- a/src/EFCore.Cosmos/Query/Internal/CosmosShapedQueryCompilingExpressionVisitor.CosmosProjectionBindingRemovingExpressionVisitorBase.cs
+++ b/src/EFCore.Cosmos/Query/Internal/CosmosShapedQueryCompilingExpressionVisitor.CosmosProjectionBindingRemovingExpressionVisitorBase.cs
@@ -596,25 +596,27 @@ private static Expression CreateReadJTokenExpression(Expression jObjectExpressio
                 return _projectionBindings[jObjectExpression];
             }
 
+            var entityType = property.DeclaringType as IEntityType;
+            var ownership = entityType?.FindOwnership();
             var storeName = property.GetJsonPropertyName();
             if (storeName.Length == 0)
             {
-                var entityType = property.DeclaringType as IEntityType;
                 if (entityType == null
                     || !entityType.IsDocumentRoot())
                 {
-                    var ownership = entityType?.FindOwnership();
                     if (ownership != null
-                        && !ownership.IsUnique
-                        && property.IsOrdinalKeyProperty())
+                        && !ownership.IsUnique)
                     {
-                        var readExpression = _ordinalParameterBindings[jObjectExpression];
-                        if (readExpression.Type != type)
+                        if (property.IsOrdinalKeyProperty())
                         {
-                            readExpression = Convert(readExpression, type);
-                        }
+                            var ordinalExpression = _ordinalParameterBindings[jObjectExpression];
+                            if (ordinalExpression.Type != type)
+                            {
+                                ordinalExpression = Convert(ordinalExpression, type);
+                            }
 
-                        return readExpression;
+                            return ordinalExpression;
+                        }
                     }
 
                     var principalProperty = property.FindFirstPrincipal();
@@ -648,6 +650,37 @@ private static Expression CreateReadJTokenExpression(Expression jObjectExpressio
                 return Default(type);
             }
 
+            // Workaround for old databases that didn't store the key property
+            if (ownership != null
+                && !ownership.IsUnique
+                && !entityType.IsDocumentRoot()
+                && property.ClrType == typeof(int)
+                && !property.IsForeignKey()
+                && property.FindContainingPrimaryKey() is { Properties.Count: > 1 }
+                && property.GetJsonPropertyName().Length != 0
+                && !property.IsShadowProperty())
+            {
+                var readExpression = CreateGetValueExpression(
+                    jObjectExpression, storeName, type.MakeNullable(), property.GetTypeMapping());
+
+                var nonNullReadExpression = readExpression;
+                if (nonNullReadExpression.Type != type)
+                {
+                    nonNullReadExpression = Convert(nonNullReadExpression, type);
+                }
+
+                var ordinalExpression = _ordinalParameterBindings[jObjectExpression];
+                if (ordinalExpression.Type != type)
+                {
+                    ordinalExpression = Convert(ordinalExpression, type);
+                }
+
+                return Condition(
+                    Equal(readExpression, Constant(null, readExpression.Type)),
+                    ordinalExpression,
+                    nonNullReadExpression);
+            }
+
             return Convert(
                 CreateGetValueExpression(jObjectExpression, storeName, type.MakeNullable(), property.GetTypeMapping()),
                 type);
diff --git a/test/EFCore.Cosmos.FunctionalTests/EmbeddedDocumentsTest.cs b/test/EFCore.Cosmos.FunctionalTests/EmbeddedDocumentsTest.cs
index eac7800712..963eebaf1f 100644
--- a/test/EFCore.Cosmos.FunctionalTests/EmbeddedDocumentsTest.cs
+++ b/test/EFCore.Cosmos.FunctionalTests/EmbeddedDocumentsTest.cs
@@ -103,6 +103,14 @@ public virtual async Task Can_attach_owner_with_dependents()
     public virtual async Task Can_manipulate_embedded_collections(bool useIds)
     {
         var options = Fixture.CreateOptions(seed: false);
+        var swappedOptions = Fixture.CreateOptions(modelBuilder => modelBuilder.Entity<Person>(
+                eb => eb.OwnsMany(
+                    v => v.Addresses, b =>
+                    {
+                        b.OwnsMany(a => a.Notes).ToJsonProperty("IdNotes");
+                        b.OwnsMany(a => a.IdNotes).ToJsonProperty("Notes");
+                    })),
+                seed: false);
 
         Address existingAddress1Person2;
         Address existingAddress1Person3;
@@ -201,6 +209,10 @@ public virtual async Task Can_manipulate_embedded_collections(bool useIds)
             if (useIds)
             {
                 addedAddress2.IdNotes = existingAddress1Person2.IdNotes;
+                foreach (var note in addedAddress2.IdNotes)
+                {
+                    note.AddressId = 0;
+                }
             }
             else
             {
@@ -373,6 +385,75 @@ async Task AssertState(EmbeddedTransportationContext context, bool useIds)
         }
     }
 
+    [ConditionalFact]
+    public virtual async Task Old_still_works()
+    {
+        var options = Fixture.CreateOptions(seed: false);
+        var swappedOptions = Fixture.CreateOptions(modelBuilder => modelBuilder.Entity<Person>(
+                eb => eb.OwnsMany(
+                    v => v.Addresses, b =>
+                    {
+                        b.OwnsMany(a => a.Notes).ToJsonProperty("IdNotes");
+                        b.OwnsMany(a => a.IdNotes).ToJsonProperty("Notes");
+                    })),
+                seed: false);
+
+        using (var context = new EmbeddedTransportationContext(options))
+        {
+            await context.AddAsync(new Person
+            {
+                Id = 1,
+                Addresses = new List<Address>
+                {
+                    new()
+                    {
+                        Street = "Second",
+                        City = "Village",
+                        Notes = new List<Note>
+                        {
+                            new() { Content = "First note" }
+                        },
+                        IdNotes = new List<NoteWithId>
+                        {
+                            new() { Id = 3, Content = "Second note" }
+                        }
+                    }
+                }
+            });
+
+            await context.SaveChangesAsync();
+        }
+
+        using (var context = new EmbeddedTransportationContext(options))
+        {
+            var people = await context.Set<Person>().ToListAsync();
+            var address = people.Single().Addresses.Single();
+
+            Assert.Equal("First note", address.Notes.Single().Content);
+
+            var idNote = address.IdNotes.Single();
+            Assert.Equal(3, idNote.Id);
+            Assert.Equal("Second note", idNote.Content);
+
+            var noteEntry = context.Entry(idNote);
+            var noteJson = noteEntry.Property<JObject>("__jObject").CurrentValue;
+
+            Assert.Equal(3, noteJson[nameof(NoteWithId.Id)]);
+            Assert.Null(noteJson[nameof(NoteWithId.AddressId)]);
+        }
+
+        using (var context = new EmbeddedTransportationContext(swappedOptions))
+        {
+            var people = await context.Set<Person>().ToListAsync();
+            var address = people.Single().Addresses.Single();
+
+            Assert.Equal("Second note", address.Notes.Single().Content);
+            Assert.Equal("First note", address.IdNotes.Single().Content);
+        }
+    }
+
+    public record struct CosmosPage<T>(List<T> Results, string ContinuationToken);
+
     [ConditionalFact]
     public virtual async Task Properties_on_owned_types_can_be_client_generated()
     {
@@ -408,6 +489,7 @@ public virtual async Task Can_use_non_int_keys_for_embedded_entities()
                         v => v.Addresses, b =>
                         {
                             b.Property<Guid>("Id");
+                            b.Ignore(a => a.IdNotes);
                         }));
             },
             seed: false);
@@ -600,19 +682,15 @@ protected override ITestStoreFactory TestStoreFactory
             => CosmosTestStoreFactory.Instance;
 
         public virtual CosmosTestStore TestStore { get; }
-        private Action<ModelBuilder> OnModelCreatingAction { get; set; }
-
-        protected override void OnModelCreating(ModelBuilder modelBuilder, DbContext context)
-            => OnModelCreatingAction?.Invoke(modelBuilder);
 
-        public DbContextOptions CreateOptions(
+        public EmbeddedTransportationContextOptions CreateOptions(
             Action<ModelBuilder> onModelCreating = null,
             bool seed = true)
         {
-            OnModelCreatingAction = onModelCreating;
             var options = CreateOptions(TestStore);
+            var embeddedOptions = new EmbeddedTransportationContextOptions(options, onModelCreating);
             TestStore.Initialize(
-                ServiceProvider, () => new EmbeddedTransportationContext(options), c =>
+                ServiceProvider, () => new EmbeddedTransportationContext(embeddedOptions), c =>
                 {
                     if (seed)
                     {
@@ -621,14 +699,19 @@ protected override void OnModelCreating(ModelBuilder modelBuilder, DbContext con
                 });
 
             ListLoggerFactory.Clear();
-            return options;
+            return embeddedOptions;
         }
 
-        protected override IServiceCollection AddServices(IServiceCollection serviceCollection)
-            => base.AddServices(serviceCollection);
+        protected override void OnModelCreating(ModelBuilder modelBuilder, DbContext context)
+            => ((EmbeddedTransportationContext)context).Options.OnModelCreating?.Invoke(modelBuilder);
 
         protected override object GetAdditionalModelCacheKey(DbContext context)
-            => OnModelCreatingAction?.GetHashCode();
+        {
+            var options = ((EmbeddedTransportationContext)context).Options;
+            return options.OnModelCreating  == null
+                ? null
+                : options;
+        }
 
         public Task InitializeAsync()
             => Task.CompletedTask;
@@ -637,13 +720,18 @@ public Task DisposeAsync()
             => TestStore.DisposeAsync();
     }
 
+    public record class EmbeddedTransportationContextOptions(DbContextOptions Options, Action<ModelBuilder> OnModelCreating);
+
     protected class EmbeddedTransportationContext : TransportationContext
     {
-        public EmbeddedTransportationContext(DbContextOptions options)
-            : base(options)
+        public EmbeddedTransportationContext(EmbeddedTransportationContextOptions options)
+            : base(options.Options)
         {
+            Options = options;
         }
 
+        public EmbeddedTransportationContextOptions Options { get; }
+
         protected override void OnModelCreating(ModelBuilder modelBuilder)
         {
             modelBuilder.Entity<Vehicle>(
@@ -734,6 +822,7 @@ public class Note
     public class NoteWithId
     {
         public int Id { get; set; }
+        public int AddressId { get; set; }
         public string Content { get; set; }
     }
 }
