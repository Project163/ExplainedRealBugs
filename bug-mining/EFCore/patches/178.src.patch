diff --git a/src/Microsoft.Data.Sqlite.Core/SqliteConnectionFactory.cs b/src/Microsoft.Data.Sqlite.Core/SqliteConnectionFactory.cs
index 1103aaf2fe..7377236d55 100644
--- a/src/Microsoft.Data.Sqlite.Core/SqliteConnectionFactory.cs
+++ b/src/Microsoft.Data.Sqlite.Core/SqliteConnectionFactory.cs
@@ -9,6 +9,9 @@ namespace Microsoft.Data.Sqlite
 {
     internal class SqliteConnectionFactory
     {
+        private static readonly bool QuirkEnabled29952
+            = AppContext.TryGetSwitch("Microsoft.EntityFrameworkCore.Issue29952", out var enabled) && enabled;
+
         public static readonly SqliteConnectionFactory Instance = new();
 
 #pragma warning disable IDE0052 // Remove unread private members
@@ -138,40 +141,83 @@ private void PruneCallback(object? _)
                 }
             }
 
-            for (var i = _idlePoolGroups.Count - 1; i >= 0; i--)
+            if (QuirkEnabled29952)
             {
-                var poolGroup = _idlePoolGroups[i];
+                for (var i = _idlePoolGroups.Count - 1; i >= 0; i--)
+                {
+                    var poolGroup = _idlePoolGroups[i];
+
+                    if (!poolGroup.Clear())
+                    {
+                        _idlePoolGroups.Remove(poolGroup);
+                    }
+                }
+
+                _lock.EnterWriteLock();
+
+                try
+                {
+                    var activePoolGroups = new Dictionary<string, SqliteConnectionPoolGroup>();
+                    foreach (var entry in _poolGroups)
+                    {
+                        var poolGroup = entry.Value;
 
-                if (!poolGroup.Clear())
+                        if (poolGroup.Prune())
+                        {
+                            _idlePoolGroups.Add(poolGroup);
+                        }
+                        else
+                        {
+                            activePoolGroups.Add(entry.Key, poolGroup);
+                        }
+                    }
+
+                    _poolGroups = activePoolGroups;
+                }
+                finally
                 {
-                    _idlePoolGroups.Remove(poolGroup);
+                    _lock.ExitWriteLock();
                 }
             }
 
-            _lock.EnterWriteLock();
-
-            try
+            else
             {
-                var activePoolGroups = new Dictionary<string, SqliteConnectionPoolGroup>();
-                foreach (var entry in _poolGroups)
+                _lock.EnterWriteLock();
+
+                try
                 {
-                    var poolGroup = entry.Value;
 
-                    if (poolGroup.Prune())
+                    for (var i = _idlePoolGroups.Count - 1; i >= 0; i--)
                     {
-                        _idlePoolGroups.Add(poolGroup);
+                        var poolGroup = _idlePoolGroups[i];
+
+                        if (!poolGroup.Clear())
+                        {
+                            _idlePoolGroups.Remove(poolGroup);
+                        }
                     }
-                    else
+
+                    var activePoolGroups = new Dictionary<string, SqliteConnectionPoolGroup>();
+                    foreach (var entry in _poolGroups)
                     {
-                        activePoolGroups.Add(entry.Key, poolGroup);
+                        var poolGroup = entry.Value;
+
+                        if (poolGroup.Prune())
+                        {
+                            _idlePoolGroups.Add(poolGroup);
+                        }
+                        else
+                        {
+                            activePoolGroups.Add(entry.Key, poolGroup);
+                        }
                     }
-                }
 
-                _poolGroups = activePoolGroups;
-            }
-            finally
-            {
-                _lock.ExitWriteLock();
+                    _poolGroups = activePoolGroups;
+                }
+                finally
+                {
+                    _lock.ExitWriteLock();
+                }
             }
         }
     }
