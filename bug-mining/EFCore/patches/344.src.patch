diff --git a/src/EFCore.Design/Extensions/ScaffoldingModelExtensions.cs b/src/EFCore.Design/Extensions/ScaffoldingModelExtensions.cs
index 405c2bb814..d984178aba 100644
--- a/src/EFCore.Design/Extensions/ScaffoldingModelExtensions.cs
+++ b/src/EFCore.Design/Extensions/ScaffoldingModelExtensions.cs
@@ -27,7 +27,9 @@ public static bool IsSimpleManyToManyJoinEntityType(this IEntityType entityType)
             var primaryKey = entityType.FindPrimaryKey();
             var properties = entityType.GetProperties().ToList();
             var foreignKeys = entityType.GetForeignKeys().ToList();
+            var referencingForeignKeys = entityType.GetReferencingForeignKeys().ToList();
             if (primaryKey is { Properties.Count: > 1 }
+                && referencingForeignKeys.Count == 0
                 && foreignKeys.Count == 2
                 && primaryKey.Properties.Count == properties.Count
                 && foreignKeys[0].Properties.Count + foreignKeys[1].Properties.Count == properties.Count
diff --git a/test/EFCore.SqlServer.FunctionalTests/Scaffolding/SqlServerDatabaseModelFactoryTest.cs b/test/EFCore.SqlServer.FunctionalTests/Scaffolding/SqlServerDatabaseModelFactoryTest.cs
index 4be187fdea..b57b949022 100644
--- a/test/EFCore.SqlServer.FunctionalTests/Scaffolding/SqlServerDatabaseModelFactoryTest.cs
+++ b/test/EFCore.SqlServer.FunctionalTests/Scaffolding/SqlServerDatabaseModelFactoryTest.cs
@@ -40,7 +40,7 @@ MAXVALUE 8
     CYCLE;",
             Enumerable.Empty<string>(),
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var defaultSequence = dbModel.Sequences.First(ds => ds.Name == "DefaultFacetsSequence");
                 Assert.Equal("dbo", defaultSequence.Schema);
@@ -80,7 +80,7 @@ public void Sequence_min_max_start_values_are_null_if_default()
 CREATE SEQUENCE [BigIntSequence] AS bigint;",
             Enumerable.Empty<string>(),
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 Assert.All(
                     dbModel.Sequences,
@@ -109,7 +109,7 @@ public void Sequence_min_max_start_values_are_not_null_if_decimal()
 CREATE SEQUENCE [NumericSequence] AS numeric;",
             Enumerable.Empty<string>(),
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 Assert.All(
                     dbModel.Sequences,
@@ -138,7 +138,7 @@ MAXVALUE 99999999999999999999999999999999999999
  CACHE;",
             Enumerable.Empty<string>(),
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 Assert.All(
                     dbModel.Sequences,
@@ -167,7 +167,7 @@ public void Sequence_using_type_alias()
 CREATE SEQUENCE [TypeAliasSequence] AS [dbo].[TestTypeAlias];",
             Enumerable.Empty<string>(),
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var sequence = Assert.Single(dbModel.Sequences);
                 // ReSharper disable once PossibleNullReferenceException
@@ -192,7 +192,7 @@ public void Sequence_using_type_with_facets()
 CREATE SEQUENCE [TypeFacetSequence] AS decimal(10, 0);",
             Enumerable.Empty<string>(),
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var sequence = Assert.Single(dbModel.Sequences);
                 // ReSharper disable once PossibleNullReferenceException
@@ -214,7 +214,7 @@ public void Filter_sequences_based_on_schema()
 CREATE SEQUENCE [db2].[Sequence]",
             Enumerable.Empty<string>(),
             new[] { "db2" },
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var sequence = Assert.Single(dbModel.Sequences);
                 // ReSharper disable once PossibleNullReferenceException
@@ -239,7 +239,7 @@ public void Set_default_schema()
             "SELECT 1",
             Enumerable.Empty<string>(),
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var defaultSchema = Fixture.TestStore.ExecuteScalar<string>("SELECT SCHEMA_NAME()");
                 Assert.Equal(defaultSchema, dbModel.DefaultSchema);
@@ -255,7 +255,7 @@ public void Create_tables()
 CREATE TABLE [dbo].[Denali] ( id int );",
             Enumerable.Empty<string>(),
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 Assert.Collection(
                     dbModel.Tables.OrderBy(t => t.Name),
@@ -275,13 +275,162 @@ public void Create_tables()
 
 DROP TABLE [dbo].[Denali];");
 
+    [ConditionalFact]
+    public void Expose_join_table_when_interloper_reference()
+        => Test(
+            @"
+CREATE TABLE BBlogs (Id int IDENTITY CONSTRAINT [PK_BBlogs] PRIMARY KEY,);
+CREATE TABLE PPosts (Id int IDENTITY CONSTRAINT [PK_PPosts] PRIMARY KEY,);
+
+CREATE TABLE BBlogPPosts (
+    BBlogId int NOT NULL CONSTRAINT [FK_BBlogPPosts_BBlogs] REFERENCES BBlogs ON DELETE CASCADE,
+    PPostId int NOT NULL CONSTRAINT [FK_BBlogPPosts_PPosts] REFERENCES PPosts ON DELETE CASCADE,
+    CONSTRAINT [PK_BBlogPPosts ] PRIMARY KEY (BBlogId, PPostId));
+
+CREATE TABLE LinkToBBlogPPosts (
+    LinkId1 int NOT NULL,
+    LinkId2 int NOT NULL,
+    CONSTRAINT [PK_LinkToBBlogPPosts] PRIMARY KEY (LinkId1, LinkId2),
+    CONSTRAINT [FK_LinkToBBlogPPosts_BlogPosts] FOREIGN KEY (LinkId1, LinkId2) REFERENCES BBlogPPosts);
+",
+            Enumerable.Empty<string>(),
+            Enumerable.Empty<string>(),
+            (dbModel, scaffoldingFactory) =>
+            {
+                Assert.Collection(
+                    dbModel.Tables.OrderBy(t => t.Name),
+                    t =>
+                    {
+                        Assert.Equal("dbo", t.Schema);
+                        Assert.Equal("BBlogPPosts", t.Name);
+                        Assert.Collection(t.Columns,
+                            c => Assert.Equal("BBlogId", c.Name),
+                            c => Assert.Equal("PPostId", c.Name));
+                        Assert.Collection(t.ForeignKeys,
+                            c =>
+                            {
+                                Assert.Equal("BBlogs", c.PrincipalTable.Name);
+                                Assert.Equal("BBlogPPosts", c.Table.Name);
+                                Assert.Collection(c.Columns, c => Assert.Equal("BBlogId", c.Name));
+                            },
+                            c =>
+                            {
+                                Assert.Equal("PPosts", c.PrincipalTable.Name);
+                                Assert.Equal("BBlogPPosts", c.Table.Name);
+                                Assert.Collection(c.Columns, c => Assert.Equal("PPostId", c.Name));
+                            });
+                    },
+                    t =>
+                    {
+                        Assert.Equal("dbo", t.Schema);
+                        Assert.Equal("BBlogs", t.Name);
+                        Assert.Collection(t.Columns, c => Assert.Equal("Id", c.Name));
+                    },
+                    t =>
+                    {
+                        Assert.Equal("dbo", t.Schema);
+                        Assert.Equal("LinkToBBlogPPosts", t.Name);
+                        Assert.Collection(t.Columns,
+                            c => Assert.Equal("LinkId1", c.Name),
+                            c => Assert.Equal("LinkId2", c.Name));
+                        Assert.Collection(t.ForeignKeys,
+                            c =>
+                            {
+                                Assert.Equal("BBlogPPosts", c.PrincipalTable.Name);
+                                Assert.Equal("LinkToBBlogPPosts", c.Table.Name);
+                                Assert.Collection(
+                                    c.Columns,
+                                    c => Assert.Equal("LinkId1", c.Name),
+                                    c => Assert.Equal("LinkId2", c.Name));
+                            });
+                    },
+                    t =>
+                    {
+                        Assert.Equal("dbo", t.Schema);
+                        Assert.Equal("PPosts", t.Name);
+                        Assert.Collection(t.Columns, c => Assert.Equal("Id", c.Name));
+                    });
+
+                var model = scaffoldingFactory.Create(dbModel, new ModelReverseEngineerOptions());
+
+                Assert.Collection(
+                    model.GetEntityTypes(),
+                    e =>
+                    {
+                        Assert.Equal("Bblog", e.Name);
+                        Assert.Collection(e.GetProperties(), p => Assert.Equal("Id", p.Name));
+                        Assert.Empty(e.GetForeignKeys());
+                        Assert.Empty(e.GetSkipNavigations());
+                        Assert.Collection(e.GetNavigations(), p => Assert.Equal("BblogPposts", p.Name));
+                    },
+                    e =>
+                    {
+                        Assert.Equal("BblogPpost", e.Name);
+                        Assert.Collection(e.GetProperties(),
+                            p => Assert.Equal("BblogId", p.Name),
+                            p => Assert.Equal("PpostId", p.Name));
+                        Assert.Collection(e.GetForeignKeys(),
+                            k =>
+                            {
+                                Assert.Equal("Bblog", k.PrincipalEntityType.Name);
+                                Assert.Equal("BblogPpost", k.DeclaringEntityType.Name);
+                                Assert.Collection(k.Properties, p => Assert.Equal("BblogId", p.Name));
+                            },
+                            k =>
+                            {
+                                Assert.Equal("Ppost", k.PrincipalEntityType.Name);
+                                Assert.Equal("BblogPpost", k.DeclaringEntityType.Name);
+                                Assert.Collection(k.Properties, p => Assert.Equal("PpostId", p.Name));
+                            });
+                        Assert.Empty(e.GetSkipNavigations());
+                        Assert.Collection(e.GetNavigations(),
+                            p => Assert.Equal("Bblog", p.Name),
+                            p => Assert.Equal("LinkToBblogPpost", p.Name),
+                            p => Assert.Equal("Ppost", p.Name));
+                    },
+                    e =>
+                    {
+                        Assert.Equal("LinkToBblogPpost", e.Name);
+                        Assert.Collection(e.GetProperties(),
+                            p => Assert.Equal("LinkId1", p.Name),
+                            p => Assert.Equal("LinkId2", p.Name));
+                        Assert.Collection(e.GetForeignKeys(),
+                            k =>
+                            {
+                                Assert.Equal("BblogPpost", k.PrincipalEntityType.Name);
+                                Assert.Equal("LinkToBblogPpost", k.DeclaringEntityType.Name);
+                                Assert.Collection(k.Properties,
+                                    p => Assert.Equal("LinkId1", p.Name),
+                                    p => Assert.Equal("LinkId2", p.Name));
+                                Assert.Collection(k.PrincipalKey.Properties,
+                                    p => Assert.Equal("BblogId", p.Name),
+                                    p => Assert.Equal("PpostId", p.Name));
+                            });
+                        Assert.Empty(e.GetSkipNavigations());
+                        Assert.Collection(e.GetNavigations(), p => Assert.Equal("BblogPpost", p.Name));
+                    },
+                    e =>
+                    {
+                        Assert.Equal("Ppost", e.Name);
+                        Assert.Collection(e.GetProperties(), p => Assert.Equal("Id", p.Name));
+                        Assert.Empty(e.GetForeignKeys());
+                        Assert.Empty(e.GetSkipNavigations());
+                        Assert.Collection(e.GetNavigations(), p => Assert.Equal("BblogPposts", p.Name));
+                    });
+            },
+            @"
+DROP TABLE [dbo].[LinkToBBlogPPosts];
+DROP TABLE [dbo].[BBlogPPosts];
+DROP TABLE [dbo].[PPosts];
+DROP TABLE [dbo].[BBlogs];");
+
     [ConditionalFact]
     public void Default_database_collation_is_not_scaffolded()
         => Test(
             @"",
             Enumerable.Empty<string>(),
             Enumerable.Empty<string>(),
-            dbModel => Assert.Null(dbModel.Collation),
+            (dbModel, scaffoldingFactory) => Assert.Null(dbModel.Collation),
             @"");
 
     #endregion
@@ -297,7 +446,7 @@ public void Filter_schemas()
 CREATE TABLE [dbo].[Kilimanjaro] ( Id int, B varchar, UNIQUE (B));",
             Enumerable.Empty<string>(),
             new[] { "db2" },
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var table = Assert.Single(dbModel.Tables);
                 // ReSharper disable once PossibleNullReferenceException
@@ -320,7 +469,7 @@ public void Filter_tables()
 CREATE TABLE [dbo].[Kilimanjaro] ( Id int, B varchar, UNIQUE (B), FOREIGN KEY (B) REFERENCES K2 (A) );",
             new[] { "K2" },
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var table = Assert.Single(dbModel.Tables);
                 // ReSharper disable once PossibleNullReferenceException
@@ -343,7 +492,7 @@ public void Filter_tables_with_quote_in_name()
 CREATE TABLE [dbo].[Kilimanjaro] ( Id int, B varchar, UNIQUE (B), FOREIGN KEY (B) REFERENCES [K2'] (A) );",
             new[] { "K2'" },
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var table = Assert.Single(dbModel.Tables);
                 // ReSharper disable once PossibleNullReferenceException
@@ -366,7 +515,7 @@ public void Filter_tables_with_qualified_name()
 CREATE TABLE [dbo].[Kilimanjaro] ( Id int, B varchar, UNIQUE (B) );",
             new[] { "[K.2]" },
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var table = Assert.Single(dbModel.Tables);
                 // ReSharper disable once PossibleNullReferenceException
@@ -391,7 +540,7 @@ public void Filter_tables_with_schema_qualified_name1()
 CREATE TABLE [dbo].[Kilimanjaro] ( Id int, B varchar, UNIQUE (B) );",
             new[] { "dbo.K2" },
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var table = Assert.Single(dbModel.Tables);
                 // ReSharper disable once PossibleNullReferenceException
@@ -418,7 +567,7 @@ public void Filter_tables_with_schema_qualified_name2()
 CREATE TABLE [db.2].[Kilimanjaro] ( Id int, B varchar, UNIQUE (B) );",
             new[] { "[db.2].[K.2]" },
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var table = Assert.Single(dbModel.Tables);
                 // ReSharper disable once PossibleNullReferenceException
@@ -445,7 +594,7 @@ public void Filter_tables_with_schema_qualified_name3()
 CREATE TABLE [dbo].[Kilimanjaro] ( Id int, B varchar, UNIQUE (B) );",
             new[] { "dbo.[K.2]" },
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var table = Assert.Single(dbModel.Tables);
                 // ReSharper disable once PossibleNullReferenceException
@@ -472,7 +621,7 @@ public void Filter_tables_with_schema_qualified_name4()
 CREATE TABLE [db.2].[Kilimanjaro] ( Id int, B varchar, UNIQUE (B) );",
             new[] { "[db.2].K2" },
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var table = Assert.Single(dbModel.Tables);
                 // ReSharper disable once PossibleNullReferenceException
@@ -529,7 +678,7 @@ Index2 bigint
 );",
             new[] { "[db.2].[QuotedTableName]", "[db.2].SimpleTableName", "dbo.[Table.With.Dot]", "dbo.SimpleTableName", "JustTableName" },
             new[] { "db2" },
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var sequence = Assert.Single(dbModel.Sequences);
                 // ReSharper disable once PossibleNullReferenceException
@@ -630,7 +779,7 @@ ADD FILE (NAME=''' + @filename + ''', filename=''' + @new_path + ''')
 ) WITH (MEMORY_OPTIMIZED = ON);",
             Enumerable.Empty<string>(),
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var table = Assert.Single(dbModel.Tables.Where(t => t.Name == "Blogs"));
 
@@ -658,7 +807,7 @@ public void Create_columns()
 ",
             Enumerable.Empty<string>(),
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var table = dbModel.Tables.Single();
 
@@ -691,7 +840,7 @@ public void Create_view_columns()
  CAST(N'' AS nvarchar(100)) AS Name;",
             Enumerable.Empty<string>(),
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var table = Assert.IsType<DatabaseView>(dbModel.Tables.Single());
 
@@ -718,7 +867,7 @@ public void Create_primary_key()
 );",
             Enumerable.Empty<string>(),
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var pk = dbModel.Tables.Single().PrimaryKey;
 
@@ -744,7 +893,7 @@ public void Create_unique_constraints()
 CREATE INDEX IX_INDEX on UniqueConstraint ( IndexProperty );",
             Enumerable.Empty<string>(),
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var uniqueConstraint = Assert.Single(dbModel.Tables.Single().UniqueConstraints);
 
@@ -772,7 +921,7 @@ public void Create_indexes()
 CREATE INDEX IX_INDEX on IndexTable ( IndexProperty );",
             Enumerable.Empty<string>(),
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var table = dbModel.Tables.Single();
 
@@ -802,7 +951,7 @@ IndexProperty int
 CREATE INDEX IX_Two on IndexTable ( IndexProperty ) WITH (FILLFACTOR = 50);",
             Enumerable.Empty<string>(),
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var table = dbModel.Tables.Single();
 
@@ -849,7 +998,7 @@ public void Create_foreign_keys()
 );",
             Enumerable.Empty<string>(),
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var firstFk = Assert.Single(dbModel.Tables.Single(t => t.Name == "FirstDependent").ForeignKeys);
 
@@ -911,7 +1060,7 @@ ON SomeTable
             },
             Enumerable.Empty<string>(),
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var table = dbModel.Tables.Single();
                 var triggers = table.Triggers;
@@ -943,7 +1092,7 @@ public void Column_with_type_alias_assigns_underlying_store_type()
 );",
             Enumerable.Empty<string>(),
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var column = Assert.Single(dbModel.Tables.Single().Columns.Where(c => c.Name == "typeAliasColumn"));
 
@@ -966,7 +1115,7 @@ typeAliasColumn sysname
 );",
             Enumerable.Empty<string>(),
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var column = Assert.Single(dbModel.Tables.Single().Columns.Where(c => c.Name == "typeAliasColumn"));
 
@@ -993,7 +1142,7 @@ public void Decimal_numeric_types_have_precision_scale()
 );",
             Enumerable.Empty<string>(),
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var columns = dbModel.Tables.Single().Columns;
 
@@ -1024,7 +1173,7 @@ public void Max_length_of_negative_one_translate_to_max_in_store_type()
 );",
             Enumerable.Empty<string>(),
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var columns = dbModel.Tables.Single().Columns;
 
@@ -1060,7 +1209,7 @@ public void Specific_max_length_are_add_to_store_type()
 );",
             Enumerable.Empty<string>(),
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var columns = dbModel.Tables.Single().Columns;
 
@@ -1092,7 +1241,7 @@ varbinaryColumn varbinary(8000)
 );",
             Enumerable.Empty<string>(),
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var columns = dbModel.Tables.Single().Columns;
 
@@ -1112,7 +1261,7 @@ charColumn char(8000)
 );",
             Enumerable.Empty<string>(),
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var columns = dbModel.Tables.Single().Columns;
 
@@ -1130,7 +1279,7 @@ characterColumn character(8000)
 );",
             Enumerable.Empty<string>(),
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var columns = dbModel.Tables.Single().Columns;
 
@@ -1150,7 +1299,7 @@ varcharColumn varchar(8000)
 );",
             Enumerable.Empty<string>(),
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var columns = dbModel.Tables.Single().Columns;
 
@@ -1170,7 +1319,7 @@ public void Default_max_length_are_added_to_nchar_1()
 );",
             Enumerable.Empty<string>(),
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var columns = dbModel.Tables.Single().Columns;
 
@@ -1188,7 +1337,7 @@ public void Default_max_length_are_added_to_nchar_2()
 );",
             Enumerable.Empty<string>(),
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var columns = dbModel.Tables.Single().Columns;
 
@@ -1206,7 +1355,7 @@ public void Default_max_length_are_added_to_nchar_3()
 );",
             Enumerable.Empty<string>(),
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var columns = dbModel.Tables.Single().Columns;
 
@@ -1226,7 +1375,7 @@ nvarcharColumn nvarchar(4000)
 );",
             Enumerable.Empty<string>(),
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var columns = dbModel.Tables.Single().Columns;
 
@@ -1248,7 +1397,7 @@ public void Datetime_types_have_precision_if_non_null_scale()
 );",
             Enumerable.Empty<string>(),
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var columns = dbModel.Tables.Single().Columns;
 
@@ -1281,7 +1430,7 @@ public void Types_with_required_length_uses_length_of_one()
 );",
             Enumerable.Empty<string>(),
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var columns = dbModel.Tables.Single().Columns;
 
@@ -1341,7 +1490,7 @@ public void Store_types_without_any_facets()
 );",
             Enumerable.Empty<string>(),
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var columns = dbModel.Tables.Single(t => t.Name == "NoFacetTypes").Columns;
 
@@ -1393,7 +1542,7 @@ public void Default_and_computed_values_are_stored()
 );",
             Enumerable.Empty<string>(),
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var columns = dbModel.Tables.Single().Columns;
 
@@ -1428,7 +1577,7 @@ public void Non_literal_bool_default_values_are_passed_through()
 );",
             Enumerable.Empty<string>(),
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var columns = dbModel.Tables.Single().Columns;
 
@@ -1461,7 +1610,7 @@ public void Simple_int_literals_are_parsed_for_HasDefaultValue()
 );",
             Enumerable.Empty<string>(),
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var columns = dbModel.Tables.Single().Columns;
 
@@ -1519,7 +1668,7 @@ public void Simple_short_literals_are_parsed_for_HasDefaultValue()
 );",
             Enumerable.Empty<string>(),
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var columns = dbModel.Tables.Single().Columns;
 
@@ -1549,7 +1698,7 @@ public void Simple_long_literals_are_parsed_for_HasDefaultValue()
 );",
             Enumerable.Empty<string>(),
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var columns = dbModel.Tables.Single().Columns;
 
@@ -1579,7 +1728,7 @@ public void Simple_byte_literals_are_parsed_for_HasDefaultValue()
 );",
             Enumerable.Empty<string>(),
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var columns = dbModel.Tables.Single().Columns;
 
@@ -1608,7 +1757,7 @@ public void Non_literal_int_default_values_are_passed_through()
 );",
             Enumerable.Empty<string>(),
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var columns = dbModel.Tables.Single().Columns;
 
@@ -1635,7 +1784,7 @@ public void Simple_double_literals_are_parsed_for_HasDefaultValue()
 );",
             Enumerable.Empty<string>(),
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var columns = dbModel.Tables.Single().Columns;
 
@@ -1670,7 +1819,7 @@ public void Simple_float_literals_are_parsed_for_HasDefaultValue()
 );",
             Enumerable.Empty<string>(),
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var columns = dbModel.Tables.Single().Columns;
 
@@ -1705,7 +1854,7 @@ public void Simple_decimal_literals_are_parsed_for_HasDefaultValue()
 );",
             Enumerable.Empty<string>(),
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var columns = dbModel.Tables.Single().Columns;
 
@@ -1743,7 +1892,7 @@ public void Simple_bool_literals_are_parsed_for_HasDefaultValue()
 );",
             Enumerable.Empty<string>(),
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var columns = dbModel.Tables.Single().Columns;
 
@@ -1790,7 +1939,7 @@ public void Simple_DateTime_literals_are_parsed_for_HasDefaultValue()
 );",
             Enumerable.Empty<string>(),
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var columns = dbModel.Tables.Single().Columns;
 
@@ -1826,7 +1975,7 @@ public void Non_literal_or_non_parsable_DateTime_default_values_are_passed_throu
 );",
             Enumerable.Empty<string>(),
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var columns = dbModel.Tables.Single().Columns;
 
@@ -1855,7 +2004,7 @@ public void Simple_DateOnly_literals_are_parsed_for_HasDefaultValue()
 );",
             Enumerable.Empty<string>(),
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var columns = dbModel.Tables.Single().Columns;
 
@@ -1880,7 +2029,7 @@ public void Simple_TimeOnly_literals_are_parsed_for_HasDefaultValue()
 );",
             Enumerable.Empty<string>(),
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var columns = dbModel.Tables.Single().Columns;
 
@@ -1905,7 +2054,7 @@ public void Simple_DateTimeOffset_literals_are_parsed_for_HasDefaultValue()
 );",
             Enumerable.Empty<string>(),
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var columns = dbModel.Tables.Single().Columns;
 
@@ -1934,7 +2083,7 @@ public void Simple_Guid_literals_are_parsed_for_HasDefaultValue()
 );",
             Enumerable.Empty<string>(),
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var columns = dbModel.Tables.Single().Columns;
 
@@ -1959,7 +2108,7 @@ public void Non_literal_Guid_default_values_are_passed_through()
 );",
             Enumerable.Empty<string>(),
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var columns = dbModel.Tables.Single().Columns;
 
@@ -1989,7 +2138,7 @@ public void Simple_string_literals_are_parsed_for_HasDefaultValue()
 );",
             Enumerable.Empty<string>(),
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var columns = dbModel.Tables.Single().Columns;
 
@@ -2036,7 +2185,7 @@ public void ValueGenerated_is_set_for_identity_and_computed_column()
 );",
             Enumerable.Empty<string>(),
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var columns = dbModel.Tables.Single().Columns;
 
@@ -2058,7 +2207,7 @@ public void ConcurrencyToken_is_set_for_rowVersion()
 );",
             Enumerable.Empty<string>(),
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var columns = dbModel.Tables.Single().Columns;
 
@@ -2077,7 +2226,7 @@ public void Column_nullability_is_set()
 );",
             Enumerable.Empty<string>(),
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var columns = dbModel.Tables.Single().Columns;
 
@@ -2097,7 +2246,7 @@ public void Column_collation_is_set()
 );",
             Enumerable.Empty<string>(),
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var columns = dbModel.Tables.Single().Columns;
 
@@ -2117,7 +2266,7 @@ public void Column_sparseness_is_set()
 );",
             Enumerable.Empty<string>(),
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var columns = dbModel.Tables.Single().Columns;
 
@@ -2146,7 +2295,7 @@ public void Hidden_period_columns_are_not_created()
 ",
             Enumerable.Empty<string>(),
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var columns = dbModel.Tables.Single().Columns;
 
@@ -2181,7 +2330,7 @@ public void Period_columns_are_not_created()
 ",
             Enumerable.Empty<string>(),
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var columns = dbModel.Tables.Single().Columns;
 
@@ -2211,7 +2360,7 @@ PRIMARY KEY (Id2, Id1)
 );",
             Enumerable.Empty<string>(),
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var pk = dbModel.Tables.Single().PrimaryKey;
 
@@ -2233,7 +2382,7 @@ public void Set_clustered_false_for_non_clustered_primary_key()
 );",
             Enumerable.Empty<string>(),
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var pk = dbModel.Tables.Single().PrimaryKey;
 
@@ -2258,7 +2407,7 @@ public void Set_clustered_false_for_primary_key_if_different_clustered_index()
 CREATE CLUSTERED INDEX ClusteredIndex ON NonClusteredPrimaryKeyTableWithClusteredIndex( Id2 );",
             Enumerable.Empty<string>(),
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var pk = dbModel.Tables.Single().PrimaryKey;
 
@@ -2282,7 +2431,7 @@ public void Set_clustered_false_for_primary_key_if_different_clustered_constrain
 );",
             Enumerable.Empty<string>(),
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var pk = dbModel.Tables.Single().PrimaryKey;
 
@@ -2306,7 +2455,7 @@ public void Set_primary_key_name_from_index()
 );",
             Enumerable.Empty<string>(),
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var pk = dbModel.Tables.Single().PrimaryKey;
 
@@ -2334,7 +2483,7 @@ public void Create_composite_unique_constraint()
 );",
             Enumerable.Empty<string>(),
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var uniqueConstraint = Assert.Single(dbModel.Tables.Single().UniqueConstraints);
 
@@ -2357,7 +2506,7 @@ public void Set_clustered_true_for_clustered_unique_constraint()
 );",
             Enumerable.Empty<string>(),
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var uniqueConstraint = Assert.Single(dbModel.Tables.Single().UniqueConstraints);
 
@@ -2382,7 +2531,7 @@ public void Set_unique_constraint_name_from_index()
 );",
             Enumerable.Empty<string>(),
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var uniqueConstraint = Assert.Single(dbModel.Tables.Single().UniqueConstraints);
 
@@ -2411,7 +2560,7 @@ public void Create_composite_index()
 CREATE INDEX IX_COMPOSITE ON CompositeIndexTable ( Id2, Id1 );",
             Enumerable.Empty<string>(),
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var index = Assert.Single(dbModel.Tables.Single().Indexes);
 
@@ -2436,7 +2585,7 @@ public void Set_clustered_true_for_clustered_index()
 CREATE CLUSTERED INDEX IX_CLUSTERED ON ClusteredIndexTable ( Id2 );",
             Enumerable.Empty<string>(),
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var index = Assert.Single(dbModel.Tables.Single().Indexes);
 
@@ -2462,7 +2611,7 @@ public void Set_unique_true_for_unique_index()
 CREATE UNIQUE INDEX IX_UNIQUE ON UniqueIndexTable ( Id2 );",
             Enumerable.Empty<string>(),
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var index = Assert.Single(dbModel.Tables.Single().Indexes);
 
@@ -2489,7 +2638,7 @@ public void Set_filter_for_filtered_index()
 CREATE UNIQUE INDEX IX_UNIQUE ON FilteredIndexTable ( Id2 ) WHERE Id2 > 10;",
             Enumerable.Empty<string>(),
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var index = Assert.Single(dbModel.Tables.Single().Indexes);
 
@@ -2515,7 +2664,7 @@ public void Ignore_hypothetical_index()
 CREATE INDEX ixHypo ON HypotheticalIndexTable ( Id1 ) WITH STATISTICS_ONLY = -1;",
             Enumerable.Empty<string>(),
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 Assert.Empty(dbModel.Tables.Single().Indexes);
             },
@@ -2533,7 +2682,7 @@ public void Ignore_columnstore_index()
 CREATE NONCLUSTERED COLUMNSTORE INDEX ixColumnStore ON ColumnStoreIndexTable ( Id1, Id2 )",
             Enumerable.Empty<string>(),
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 Assert.Empty(dbModel.Tables.Single().Indexes);
             },
@@ -2552,7 +2701,7 @@ IncludeProperty int
 CREATE INDEX IX_INCLUDE ON IncludeIndexTable(IndexProperty) INCLUDE (IncludeProperty);",
             Enumerable.Empty<string>(),
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var index = Assert.Single(dbModel.Tables.Single().Indexes);
                 Assert.Equal(new[] { "IndexProperty" }, index.Columns.Select(ic => ic.Name).ToList());
@@ -2577,7 +2726,7 @@ [Name] ASC
 WITH (FILLFACTOR = 80) ON [PRIMARY]",
             Enumerable.Empty<string>(),
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var index = Assert.Single(dbModel.Tables.Single().Indexes);
                 Assert.Equal(new[] { "Name" }, index.Columns.Select(ic => ic.Name).ToList());
@@ -2607,7 +2756,7 @@ PRIMARY KEY (Id1, Id2)
 );",
             Enumerable.Empty<string>(),
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var fk = Assert.Single(dbModel.Tables.Single(t => t.Name == "DependentTable").ForeignKeys);
 
@@ -2647,7 +2796,7 @@ public void Create_multiple_foreign_key_in_same_table()
 );",
             Enumerable.Empty<string>(),
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var foreignKeys = dbModel.Tables.Single(t => t.Name == "DependentTable").ForeignKeys;
 
@@ -2700,7 +2849,7 @@ public void Create_foreign_key_referencing_unique_constraint()
 );",
             Enumerable.Empty<string>(),
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var fk = Assert.Single(dbModel.Tables.Single(t => t.Name == "DependentTable").ForeignKeys);
 
@@ -2734,7 +2883,7 @@ public void Set_name_for_foreign_key()
 );",
             Enumerable.Empty<string>(),
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var fk = Assert.Single(dbModel.Tables.Single(t => t.Name == "DependentTable").ForeignKeys);
 
@@ -2769,7 +2918,7 @@ public void Set_referential_action_for_foreign_key()
 );",
             Enumerable.Empty<string>(),
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var fk = Assert.Single(dbModel.Tables.Single(t => t.Name == "DependentTable").ForeignKeys);
 
@@ -2801,7 +2950,7 @@ public void Warn_missing_schema()
 );",
             Enumerable.Empty<string>(),
             new[] { "MySchema" },
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 Assert.Empty(dbModel.Tables);
 
@@ -2822,7 +2971,7 @@ public void Warn_missing_table()
 );",
             new[] { "MyTable" },
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 Assert.Empty(dbModel.Tables);
 
@@ -2849,7 +2998,7 @@ public void Warn_missing_principal_table_for_foreign_key()
 );",
             new[] { "DependentTable" },
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var message = Fixture.OperationReporter.Messages.Single(m => m.Level == LogLevel.Warning).Message;
 
@@ -2872,7 +3021,7 @@ public void Skip_reflexive_foreign_key()
 );",
             Enumerable.Empty<string>(),
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var level = Fixture.OperationReporter.Messages
                     .Single(
@@ -2915,7 +3064,7 @@ public void Skip_duplicate_foreign_key()
 );",
             Enumerable.Empty<string>(),
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var level = Fixture.OperationReporter.Messages
                     .Single(
@@ -2941,7 +3090,7 @@ public void No_warning_missing_view_definition()
 );",
             Enumerable.Empty<string>(),
             Enumerable.Empty<string>(),
-            dbModel =>
+            (dbModel, scaffoldingFactory) =>
             {
                 var message = Fixture.OperationReporter.Messages
                     .SingleOrDefault(
@@ -2960,7 +3109,7 @@ public void No_warning_missing_view_definition()
         string? createSql,
         IEnumerable<string> tables,
         IEnumerable<string> schemas,
-        Action<DatabaseModel> asserter,
+        Action<DatabaseModel, IScaffoldingModelFactory> asserter,
         string? cleanupSql)
         => Test(
             string.IsNullOrEmpty(createSql) ? Array.Empty<string>() : new[] { createSql },
@@ -2973,7 +3122,7 @@ public void No_warning_missing_view_definition()
         string[] createSqls,
         IEnumerable<string> tables,
         IEnumerable<string> schemas,
-        Action<DatabaseModel> asserter,
+        Action<DatabaseModel, IScaffoldingModelFactory> asserter,
         string? cleanupSql)
     {
         foreach (var createSql in createSqls)
@@ -2983,15 +3132,18 @@ public void No_warning_missing_view_definition()
 
         try
         {
-            var databaseModelFactory = SqlServerTestHelpers.Instance.CreateDesignServiceProvider(
-                    reporter: Fixture.OperationReporter)
-                .CreateScope().ServiceProvider.GetRequiredService<IDatabaseModelFactory>();
+            var serviceProvider = SqlServerTestHelpers.Instance.CreateDesignServiceProvider(reporter: Fixture.OperationReporter)
+                .CreateScope().ServiceProvider;
+
+            var databaseModelFactory = serviceProvider.GetRequiredService<IDatabaseModelFactory>();
 
             var databaseModel = databaseModelFactory.Create(
                 Fixture.TestStore.ConnectionString,
                 new DatabaseModelFactoryOptions(tables, schemas));
+
             Assert.NotNull(databaseModel);
-            asserter(databaseModel);
+
+            asserter(databaseModel, serviceProvider.GetRequiredService<IScaffoldingModelFactory>());
         }
         finally
         {
