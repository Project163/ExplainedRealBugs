<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 17:24:07 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CODEC-84] Double Metaphone bugs in alternative encoding</title>
                <link>https://issues.apache.org/jira/browse/CODEC-84</link>
                <project id="12310464" key="CODEC">Commons Codec</project>
                    <description>&lt;p&gt;The new test case (&lt;a href=&quot;https://issues.apache.org/jira/browse/CODEC-83&quot; title=&quot;Improve Double Metaphone test coverage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CODEC-83&quot;&gt;&lt;del&gt;CODEC-83&lt;/del&gt;&lt;/a&gt;) has highlighted a number of issues with the &quot;alternative&quot; encoding in the Double Metaphone implementation&lt;/p&gt;

&lt;p&gt;1) Bug in the handleG method when &quot;G&quot; is followed by &quot;IER&quot; &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;The alternative encoding of &quot;Angier&quot; results in &quot;ANKR&quot; rather than &quot;ANJR&quot;&lt;/li&gt;
	&lt;li&gt;The alternative encoding of &quot;rogier&quot; results in &quot;RKR&quot; rather than &quot;RJR&quot;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;The problem is in the handleG() method and is caused by the wrong length (4 instead of 3) being used in the contains() method:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt; } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (contains(value, index + 1, 4, &lt;span class=&quot;code-quote&quot;&gt;&quot;IER&quot;&lt;/span&gt;)) {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;...this should be&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt; } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (contains(value, index + 1, 3, &lt;span class=&quot;code-quote&quot;&gt;&quot;IER&quot;&lt;/span&gt;)) {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;


&lt;p&gt;2)  Bug in the handleL method&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;The alternative encoding of &quot;cabrillo&quot; results in &quot;KPRL &quot; rather than &quot;KPR&quot;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;The problem is that the first thing this method does is append an &quot;L&quot; to both primary &amp;amp; alternative encoding. When the conditionL0() method returns true then the &quot;L&quot; should not be appended for the alternative encoding&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;result.append(&lt;span class=&quot;code-quote&quot;&gt;&apos;L&apos;&lt;/span&gt;);
&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (charAt(value, index + 1) == &lt;span class=&quot;code-quote&quot;&gt;&apos;L&apos;&lt;/span&gt;) {
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (conditionL0(value, index)) {
        result.appendAlternate(&lt;span class=&quot;code-quote&quot;&gt;&apos; &apos;&lt;/span&gt;);
    }
    index += 2;
} &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
    index++;
}
&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; index;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Suggest refeactoring this to&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (charAt(value, index + 1) == &lt;span class=&quot;code-quote&quot;&gt;&apos;L&apos;&lt;/span&gt;) {
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (conditionL0(value, index)) {
        result.appendPrimary(&lt;span class=&quot;code-quote&quot;&gt;&apos;L&apos;&lt;/span&gt;);
    } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
        result.append(&lt;span class=&quot;code-quote&quot;&gt;&apos;L&apos;&lt;/span&gt;);
    }
    index += 2;
} &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
    result.append(&lt;span class=&quot;code-quote&quot;&gt;&apos;L&apos;&lt;/span&gt;);
    index++;
}
&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; index;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;3) Bug in the conditionL0() method for words ending in &quot;AS&quot; and &quot;OS&quot;&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;The alternative encoding of &quot;gallegos&quot; results in &quot;KLKS&quot; rather than &quot;KKS&quot;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;The problem is caused by the wrong start position being used in the contains() method, which means its not checking the last two characters of the word but checks the previous &amp;amp; current position instead:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;        } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; ((contains(value, index - 1, 2, &lt;span class=&quot;code-quote&quot;&gt;&quot;AS&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;OS&quot;&lt;/span&gt;) || 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;...this should be&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;        } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; ((contains(value, value.length() - 2, 2, &lt;span class=&quot;code-quote&quot;&gt;&quot;AS&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;OS&quot;&lt;/span&gt;) || 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I&apos;ll attach a patch for review&lt;/p&gt;</description>
                <environment></environment>
        <key id="12431978">CODEC-84</key>
            <summary>Double Metaphone bugs in alternative encoding</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="niallp">Niall Pemberton</reporter>
                        <labels>
                    </labels>
                <created>Sun, 2 Aug 2009 00:09:31 +0000</created>
                <updated>Fri, 7 Aug 2009 08:10:57 +0000</updated>
                            <resolved>Mon, 3 Aug 2009 00:38:21 +0000</resolved>
                                    <version>1.3</version>
                                    <fixVersion>1.4</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                        <attachments>
                            <attachment id="12415255" name="CODEC-84-DoubleMetaphone-Alternate-bugs.patch" size="4132" author="niallp" created="Sun, 2 Aug 2009 00:22:17 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>40252</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            16 years, 16 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0ep7z:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>83848</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>