<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 17:25:50 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CODEC-267] MurmurHash3.hash32() does not process trailing bytes as unsigned</title>
                <link>https://issues.apache.org/jira/browse/CODEC-267</link>
                <project id="12310464" key="CODEC">Commons Codec</project>
                    <description>&lt;p&gt;The hash32() algorithm processes blocks of 4 bytes. Trailing bytes of 1, 2 or 3 that are negative are not masked to unsigned leading to an error.&lt;/p&gt;

&lt;p&gt;This test passes using data generated from the Python mmh3 library which calls the MurmurHash3 c++ code (modified for Python):&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
/**
 * Test to demonstrate the errors in
 * {@link MurmurHash3#hash32(&lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt;[], &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)}
 * &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; the &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; 1, 2, or 3 bytes are negative.
 */
@Test
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void testHash32With1TrailingSignedByteIsInvalid() {
    &lt;span class=&quot;code-comment&quot;&gt;// Generate test data:
&lt;/span&gt;    &lt;span class=&quot;code-comment&quot;&gt;// &lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; mmh3
&lt;/span&gt;    &lt;span class=&quot;code-comment&quot;&gt;// &lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; numpy as np
&lt;/span&gt;    &lt;span class=&quot;code-comment&quot;&gt;// mmh3.hash(np.uint8([-1]))
&lt;/span&gt;    &lt;span class=&quot;code-comment&quot;&gt;// mmh3.hash(np.uint8([0, -1]))
&lt;/span&gt;    &lt;span class=&quot;code-comment&quot;&gt;// mmh3.hash(np.uint8([0, 0, -1]))
&lt;/span&gt;    &lt;span class=&quot;code-comment&quot;&gt;// mmh3.hash(np.uint8([-1, 0]))
&lt;/span&gt;    &lt;span class=&quot;code-comment&quot;&gt;// mmh3.hash(np.uint8([-1, 0, 0]))
&lt;/span&gt;    &lt;span class=&quot;code-comment&quot;&gt;// mmh3.hash(np.uint8([0, -1, 0]))
&lt;/span&gt;    Assert.assertNotEquals(-43192051, MurmurHash3.hash32(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt;[] {-1}, 0, 1, 0));
    Assert.assertNotEquals(-582037868, MurmurHash3.hash32(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt;[] {0, -1}, 0, 1, 0));
    Assert.assertNotEquals(922088087, MurmurHash3.hash32(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt;[] {0, 0, -1}, 0, 1, 0));
    Assert.assertNotEquals(-1309567588, MurmurHash3.hash32(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt;[] {-1, 0}, 0, 1, 0));
    Assert.assertNotEquals(-363779670, MurmurHash3.hash32(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt;[] {-1, 0, 0}, 0, 1, 0));
    Assert.assertNotEquals(-225068062, MurmurHash3.hash32(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt;[] {0, -1, 0}, 0, 1, 0));
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;This test passes with &lt;tt&gt;assertEquals&lt;/tt&gt;&#160;when the code is fixed to apply masking to the final 3 bytes:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
        &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt; 3:
            k1 ^= (data[index + 2] &amp;amp; 0xff) &amp;lt;&amp;lt; 16;
        &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt; 2:
            k1 ^= (data[index + 1] &amp;amp; 0xff) &amp;lt;&amp;lt; 8;
        &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt; 1:
            k1 ^= (data[index] &amp;amp; 0xff);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Fixing this error will be a behavioural change.&lt;/p&gt;

&lt;p&gt;It is recommended to leave this method alone and implement a new hash32x86 method that should match the &lt;tt&gt;MurmurHash3_x86_32&lt;/tt&gt; method from the c++ source code.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13269834">CODEC-267</key>
            <summary>MurmurHash3.hash32() does not process trailing bytes as unsigned</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="aherbert">Alex Herbert</assignee>
                                    <reporter username="claude">Claude Warren</reporter>
                        <labels>
                    </labels>
                <created>Thu, 21 Nov 2019 12:56:44 +0000</created>
                <updated>Sun, 24 Nov 2019 12:42:12 +0000</updated>
                            <resolved>Sun, 24 Nov 2019 12:42:12 +0000</resolved>
                                    <version>1.13</version>
                                    <fixVersion>1.14</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="16979251" author="alexherbert" created="Thu, 21 Nov 2019 12:58:01 +0000"  >&lt;p&gt;Another bug related to sign extension is in hash128()&lt;/p&gt;</comment>
                            <comment id="16981063" author="alexherbert" created="Sun, 24 Nov 2019 12:42:12 +0000"  >&lt;p&gt;New method hash32x86 with fix for trailing negative bytes added to master.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13265875">CODEC-264</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 50 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z08vfk:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>