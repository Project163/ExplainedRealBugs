<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 17:26:10 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CODEC-324] BeiderMorse engine doesn&apos;t work with JPMS enabled</title>
                <link>https://issues.apache.org/jira/browse/CODEC-324</link>
                <project id="12310464" key="CODEC">Commons Codec</project>
                    <description>&lt;p&gt;With the upgrade of commons-parent from 58 to 66 in the 1.16.1 release, commons-codec started using Moditect to generate a modules-info.class file as part of the jar (which I think was added in commons-parent 59). &lt;/p&gt;

&lt;p&gt;A decompiled version of the modules-info looks like:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
module org.apache.commons.codec {
    exports org.apache.commons.codec;
    exports org.apache.commons.codec.binary;
    exports org.apache.commons.codec.cli;
    exports org.apache.commons.codec.digest;
    exports org.apache.commons.codec.language;
    exports org.apache.commons.codec.language.bm;
    exports org.apache.commons.codec.net;
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Unfortunately, the Lang class uses reflection to load language rules. &lt;/p&gt;

&lt;p&gt;Eventually, it gets to the isOpen check in BuiltinClassLoader (called from BuiltInClassLoader&apos;s findResource), which finds that the commons-codec module is not open and the org.apache.commons.codec.language.bm package is not open. As a result, attempting to load any of the language rule files returns `null`, and the Resources class throws an IllegalArgumentException.&lt;/p&gt;

&lt;p&gt;You can see a stack trace of one such failure when trying to upgrade Lucene to commons-codec 1.16.1: &lt;a href=&quot;https://github.com/apache/lucene/pull/13269&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/lucene/pull/13269&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I think there might need to be a way to pass a hint to commons-parent&apos;s pom to specify &quot;opensResources&quot; configuration for Moditect to allow the language rules to be loaded.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Corretto JDK21&lt;br/&gt;
JPMS enabled&lt;/p&gt;</environment>
        <key id="13603243">CODEC-324</key>
            <summary>BeiderMorse engine doesn&apos;t work with JPMS enabled</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="msfroh">Michael Froh</reporter>
                        <labels>
                    </labels>
                <created>Fri, 27 Dec 2024 01:30:34 +0000</created>
                <updated>Sat, 28 Dec 2024 03:00:14 +0000</updated>
                            <resolved>Sat, 28 Dec 2024 02:59:30 +0000</resolved>
                                    <version>1.16.1</version>
                    <version>1.17.0</version>
                    <version>1.17.1</version>
                                    <fixVersion>1.17.2</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="17908359" author="msfroh" created="Fri, 27 Dec 2024 01:49:08 +0000"  >&lt;p&gt;Oh &amp;#8211; looks like there&apos;s a similar issue with DaitchMokotoffSoundex, where it fails to load org/apache/commons/codec/language/dmrules.txt since it&apos;s not in an open resource package.&lt;/p&gt;</comment>
                            <comment id="17908486" author="garydgregory" created="Fri, 27 Dec 2024 15:24:09 +0000"  >&lt;p&gt;Hello &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=msfroh&quot; class=&quot;user-hover&quot; rel=&quot;msfroh&quot;&gt;msfroh&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Thank you for your report.&lt;/p&gt;

&lt;p&gt;Can you provide a PR or patch for a failing test? I&apos;ll pick it up from there.&lt;/p&gt;

&lt;p&gt;I wonder how the test passes on Java 21 and 23 with:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;mvn test -Dtest=DaitchMokotoffSoundexTest
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Aside:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;the Lang class uses reflection to load language rules.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;We don&apos;t use reflection here, we use &lt;tt&gt;java.lang.ClassLoader.getResourceAsStream(String)&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;See also &lt;tt&gt;org.apache.commons.codec.ResourcesTest&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;If I modify this test like this:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;ResourcesTest {

    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void main(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] args) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException {
        &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ResourcesTest().testGetInputStream(&lt;span class=&quot;code-quote&quot;&gt;&quot;org/apache/commons/codec/language/dmrules.txt&quot;&lt;/span&gt;);
        &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(&lt;span class=&quot;code-quote&quot;&gt;&quot;Done.&quot;&lt;/span&gt;);
    }

    &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; List&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt; getResourceNames() {
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; Arrays.asList(&lt;span class=&quot;code-quote&quot;&gt;&quot;org/apache/commons/codec/language/dmrules.txt&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;org/apache/commons/codec/language/bm/lang.txt&quot;&lt;/span&gt;);
    }

    @ParameterizedTest
    @MethodSource(&lt;span class=&quot;code-quote&quot;&gt;&quot;getResourceNames&quot;&lt;/span&gt;)
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void testGetInputStream(&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; resName) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException {
        &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; (InputStream in = Resources.getInputStream(resName)) {
            &lt;span class=&quot;code-comment&quot;&gt;// empty
&lt;/span&gt;        }
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;and tun:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;mvn clean package
java -cp target/commons-codec-1.17.2-SNAPSHOT.jar:target/test-classes org.apache.commons.codec.ResourcesTest
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Using:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;openjdk version &quot;23.0.1&quot; 2024-10-15
OpenJDK Runtime Environment Homebrew (build 23.0.1)
OpenJDK 64-Bit Server VM Homebrew (build 23.0.1, mixed mode, sharing)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;It works:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Done.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;


&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17908538" author="msfroh" created="Fri, 27 Dec 2024 22:41:29 +0000"  >&lt;p&gt;I&apos;ve been struggling to reproduce it within the commons-codec project itself. I&apos;m not very good with Maven (being more of an Ant/Gradle person) and I&apos;m pretty new to JPMS (besides the debugging through BuiltInClassLoader I did yesterday).&lt;/p&gt;

&lt;p&gt;I was able to reproduce it pretty easily with a tiny project that depends on commons-codec and loads it as a module: &lt;a href=&quot;https://github.com/msfroh/commons-codec-test/commit/ad95b12204191996d20ecf7a111811806a3ce2fd&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/msfroh/commons-codec-test/commit/ad95b12204191996d20ecf7a111811806a3ce2fd&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I&apos;m going to see if I can figure out how to modify the generated module-info.java for commons-codec to &quot;open&quot; access to the resources for getResourceAsStream.&lt;/p&gt;</comment>
                            <comment id="17908542" author="msfroh" created="Fri, 27 Dec 2024 23:03:43 +0000"  >&lt;p&gt;Aha &amp;#8211; I found the following StackOverflow message: &lt;a href=&quot;https://stackoverflow.com/questions/45166757/loading-classes-and-resources-post-java-9&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://stackoverflow.com/questions/45166757/loading-classes-and-resources-post-java-9&lt;/a&gt;, where there was hint from the top answer:&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;A final important difference is that non-class-file resources in a module are encapsulated by default, and hence cannot be located from outside the module unless their effective package is open. To load resources from your own module it&#8217;s best to use the resource-lookup methods in Class or Module, which can locate any resource in your module, rather than those in ClassLoader, which can only locate non-class-file resources in the open packages of a module.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;So, I decided to give that a shot &amp;#8211; letting the Resources class load the resources rather than asking its classloader to do it. &lt;/p&gt;

&lt;p&gt;Note that in order to get it to work, I needed to switch to absolute paths, since they&apos;re assumed to be relative otherwise. (Maybe relative paths wouldn&apos;t be a bad idea?)&lt;/p&gt;

&lt;p&gt;With this PR: &lt;a href=&quot;https://github.com/apache/commons-codec/pull/353&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/commons-codec/pull/353&lt;/a&gt;, the commons-codec-test project I created above is able to run just fine.&lt;/p&gt;</comment>
                            <comment id="17908547" author="garydgregory" created="Sat, 28 Dec 2024 03:00:14 +0000"  >&lt;p&gt;In git master now and snapshot builds here: &lt;a href=&quot;https://repository.apache.org/content/repositories/snapshots/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://repository.apache.org/content/repositories/snapshots/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            45 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1tbfs:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>