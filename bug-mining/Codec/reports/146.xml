<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 17:25:53 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CODEC-270] Base32 and Base64 still allow decoding some invalid trailing characters</title>
                <link>https://issues.apache.org/jira/browse/CODEC-270</link>
                <project id="12310464" key="CODEC">Commons Codec</project>
                    <description>&lt;p&gt;Both Base32 and Base64 check that the final bits from the trailing digit that will be discarded are zero.&lt;/p&gt;

&lt;p&gt;The test for the trailing bits in the final digits in Base64 is:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; validateCharacter(&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; numBitsToDrop, &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Context context) {
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; ((context.ibitWorkArea &amp;amp; numBitsToDrop) != 0) {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;It should be:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; validateCharacter(&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; numBitsToDrop, &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Context context) {
    &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; mask = (1 &amp;lt;&amp;lt; numBitsToDrop) - 1;
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; ((context.ibitWorkArea &amp;amp; mask) != 0) {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Likewise in Base32.&lt;/p&gt;

&lt;p&gt;The following base64 is illegal but is still decoded:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;AB==

A : 000000
B : 000001

byte = 00000000 + 0001 discarded 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Here the check for the 4 trailing bits to drop in this case checks only bit 3 and ignores bit 1 which is set.&lt;/p&gt;

&lt;p&gt;Same for Base32, this is illegal:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;AB======

A : 00000
B : 00001

byte = 00000000 + 01 discarded
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;But the check for the 2 trailing bits to drop in this case checks bit 2 and ignores bit 1 which is set.&lt;/p&gt;

&lt;p&gt;Note: The test cases using &quot;AC&quot; has bit 2 set and so is flagged as invalid.&lt;/p&gt;
</description>
                <environment></environment>
        <key id="13270340">CODEC-270</key>
            <summary>Base32 and Base64 still allow decoding some invalid trailing characters</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="aherbert">Alex Herbert</assignee>
                                    <reporter username="aherbert">Alex Herbert</reporter>
                        <labels>
                    </labels>
                <created>Sun, 24 Nov 2019 22:46:17 +0000</created>
                <updated>Tue, 21 Jan 2020 13:25:49 +0000</updated>
                            <resolved>Thu, 28 Nov 2019 10:54:07 +0000</resolved>
                                    <version>1.13</version>
                                    <fixVersion>1.14</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="1200">20m</timespent>
                                <comments>
                            <comment id="16981218" author="alexherbert" created="Mon, 25 Nov 2019 00:09:13 +0000"  >&lt;p&gt;Fix is in PR #29.&lt;/p&gt;

&lt;p&gt;When implementing the fix I noticed that Base64 ignores a single trailing base 64 character. This encodes only 6-bits and is not enough to create a byte. But for consistency should this:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
            &lt;span class=&quot;code-keyword&quot;&gt;switch&lt;/span&gt; (context.modulus) {
&lt;span class=&quot;code-comment&quot;&gt;//              &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt; 0 : // impossible, as excluded above
&lt;/span&gt;                &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt; 1 : &lt;span class=&quot;code-comment&quot;&gt;// 6 bits - ignore entirely
&lt;/span&gt;                    &lt;span class=&quot;code-comment&quot;&gt;// TODO not currently tested; perhaps it is impossible?
&lt;/span&gt;                    &lt;span class=&quot;code-keyword&quot;&gt;break&lt;/span&gt;;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;be changed to:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
            &lt;span class=&quot;code-keyword&quot;&gt;switch&lt;/span&gt; (context.modulus) {
&lt;span class=&quot;code-comment&quot;&gt;//              &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt; 0 : // impossible, as excluded above
&lt;/span&gt;                &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt; 1 : &lt;span class=&quot;code-comment&quot;&gt;// 6 bits = no bytes
&lt;/span&gt;                    validateCharacter(MASK_6BITS, context);
                    &lt;span class=&quot;code-keyword&quot;&gt;break&lt;/span&gt;;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;This would then throw under all circumstances except if the single trailing digit encoded zero. Given that this is confusing (the &apos;=&apos; character is padding) I would instead just throw an exception:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
            &lt;span class=&quot;code-keyword&quot;&gt;switch&lt;/span&gt; (context.modulus) {
&lt;span class=&quot;code-comment&quot;&gt;//              &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt; 0 : // impossible, as excluded above
&lt;/span&gt;                &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt; 1 : &lt;span class=&quot;code-comment&quot;&gt;// 6 bits = no bytes
&lt;/span&gt;                    &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; IllegalArgumentException(&lt;span class=&quot;code-quote&quot;&gt;&quot;Single trailing character is not allowed&quot;&lt;/span&gt;);
                    &lt;span class=&quot;code-keyword&quot;&gt;break&lt;/span&gt;;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;This would make the following impossible to decode by throwing:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; text = &lt;span class=&quot;code-quote&quot;&gt;&quot;A&quot;&lt;/span&gt;;
&lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt;[] bytes = Base64.decodeBase64(text);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Currently it returns a zero length byte[] as this test currently passes:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
@Test
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void decodeSmallString() {
    &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; text = &lt;span class=&quot;code-quote&quot;&gt;&quot;A&quot;&lt;/span&gt;;
    &lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt;[] bytes = Base64.decodeBase64(text);
    Assert.assertArrayEquals(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt;[0], bytes);
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="16984319" author="alexherbert" created="Thu, 28 Nov 2019 10:53:51 +0000"  >&lt;p&gt;The fix to ensure all trailing bits are zero introduces a behaviour change. A future version could correct this with a property to not throw an exception if trailing bits are non-zero. Such behaviour would miss detection of incomplete messages when decoding.&lt;/p&gt;</comment>
                            <comment id="16984320" author="alexherbert" created="Thu, 28 Nov 2019 10:54:07 +0000"  >&lt;p&gt;In git master&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13280554">CODEC-279</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13280756">CODEC-280</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12545065">CODEC-134</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 50 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z08yk0:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>