diff --git a/httpcore5/src/test/java/org/apache/hc/core5/ssl/TestSSLContextBuilder.java b/httpcore5/src/test/java/org/apache/hc/core5/ssl/TestSSLContextBuilder.java
index 6dd8e58aa..5e4cbbc8c 100644
--- a/httpcore5/src/test/java/org/apache/hc/core5/ssl/TestSSLContextBuilder.java
+++ b/httpcore5/src/test/java/org/apache/hc/core5/ssl/TestSSLContextBuilder.java
@@ -64,6 +64,7 @@
 import javax.net.ssl.SSLSocketFactory;
 import javax.net.ssl.TrustManagerFactory;
 
+import org.apache.hc.core5.util.Timeout;
 import org.junit.After;
 import org.junit.Assert;
 import org.junit.Rule;
@@ -80,6 +81,7 @@ public class TestSSLContextBuilder {
     @Rule
     public ExpectedException thrown = ExpectedException.none();
 
+    private static final Timeout TIMEOUT = Timeout.ofSeconds(5);
     private ExecutorService executorService;
 
     @After
@@ -263,7 +265,8 @@ public Boolean call() throws Exception {
 
         final int localPort = serverSocket.getLocalPort();
         try (final Socket clientSocket = clientSslContext.getSocketFactory().createSocket()) {
-            clientSocket.connect(new InetSocketAddress("localhost", localPort), 5000);
+            clientSocket.connect(new InetSocketAddress("localhost", localPort), TIMEOUT.toMillisIntBound());
+            clientSocket.setSoTimeout(TIMEOUT.toMillisIntBound());
             final InputStream inputStream = clientSocket.getInputStream();
             Assert.assertEquals('H', inputStream.read());
             Assert.assertEquals('i', inputStream.read());
@@ -309,7 +312,8 @@ public Boolean call() throws Exception {
         });
         final int localPort = serverSocket.getLocalPort();
         try (final SSLSocket clientSocket = (SSLSocket) clientSslContext.getSocketFactory().createSocket()) {
-            clientSocket.connect(new InetSocketAddress("localhost", localPort), 5000);
+            clientSocket.connect(new InetSocketAddress("localhost", localPort), TIMEOUT.toMillisIntBound());
+            clientSocket.setSoTimeout(TIMEOUT.toMillisIntBound());
             clientSocket.startHandshake();
         }
     }
@@ -363,7 +367,8 @@ public Boolean call() throws Exception {
 
         final int localPort = serverSocket.getLocalPort();
         try (final SSLSocket clientSocket = (SSLSocket) clientSslContext.getSocketFactory().createSocket()) {
-            clientSocket.connect(new InetSocketAddress("localhost", localPort), 5000);
+            clientSocket.connect(new InetSocketAddress("localhost", localPort), TIMEOUT.toMillisIntBound());
+            clientSocket.setSoTimeout(TIMEOUT.toMillisIntBound());
             final InputStream inputStream = clientSocket.getInputStream();
             Assert.assertEquals('H', inputStream.read());
             Assert.assertEquals('i', inputStream.read());
@@ -379,8 +384,7 @@ public Boolean call() throws Exception {
         final X509Certificate cert1 = certs[0];
         final Principal subjectDN1 = cert1.getSubjectDN();
         Assert.assertNotNull(subjectDN1);
-        Assert.assertEquals("CN=Test Server, OU=HttpComponents Project, O=Apache Software Foundation, " +
-                "L=Unknown, ST=Unknown, C=Unknown", subjectDN1.getName());
+        Assert.assertEquals("CN=Test Server, OU=HttpComponents Project, O=Apache Software Foundation", subjectDN1.getName());
         final X509Certificate cert2 = certs[1];
         final Principal subjectDN2 = cert2.getSubjectDN();
         Assert.assertNotNull(subjectDN2);
@@ -435,7 +439,8 @@ public Principal call() throws Exception {
 
         final int localPort = serverSocket.getLocalPort();
         try (final SSLSocket clientSocket = (SSLSocket) clientSslContext.getSocketFactory().createSocket()) {
-            clientSocket.connect(new InetSocketAddress("localhost", localPort), 5000);
+            clientSocket.connect(new InetSocketAddress("localhost", localPort), TIMEOUT.toMillisIntBound());
+            clientSocket.setSoTimeout(TIMEOUT.toMillisIntBound());
             clientSocket.startHandshake();
             final InputStream inputStream = clientSocket.getInputStream();
             Assert.assertEquals('H', inputStream.read());
@@ -484,7 +489,8 @@ public Boolean call() throws Exception {
 
         final int localPort = serverSocket.getLocalPort();
         try (final SSLSocket clientSocket = (SSLSocket) clientSslContext.getSocketFactory().createSocket()) {
-            clientSocket.connect(new InetSocketAddress("localhost", localPort), 5000);
+            clientSocket.connect(new InetSocketAddress("localhost", localPort), TIMEOUT.toMillisIntBound());
+            clientSocket.setSoTimeout(TIMEOUT.toMillisIntBound());
             clientSocket.startHandshake();
         }
     }
@@ -528,7 +534,8 @@ public Principal call() throws Exception {
         });
         final int localPort = serverSocket.getLocalPort();
         try (final SSLSocket clientSocket = (SSLSocket) clientSslContext.getSocketFactory().createSocket()) {
-            clientSocket.connect(new InetSocketAddress("localhost", localPort), 5000);
+            clientSocket.connect(new InetSocketAddress("localhost", localPort), TIMEOUT.toMillisIntBound());
+            clientSocket.setSoTimeout(TIMEOUT.toMillisIntBound());
             clientSocket.startHandshake();
             final InputStream inputStream = clientSocket.getInputStream();
             Assert.assertEquals('H', inputStream.read());
@@ -591,7 +598,8 @@ public Principal call() throws Exception {
         });
         final int localPort = serverSocket.getLocalPort();
         try (final SSLSocket clientSocket = (SSLSocket) clientSslContext.getSocketFactory().createSocket()) {
-            clientSocket.connect(new InetSocketAddress("localhost", localPort), 5000);
+            clientSocket.connect(new InetSocketAddress("localhost", localPort), TIMEOUT.toMillisIntBound());
+            clientSocket.setSoTimeout(TIMEOUT.toMillisIntBound());
             clientSocket.startHandshake();
             final InputStream inputStream = clientSocket.getInputStream();
             Assert.assertEquals('H', inputStream.read());
@@ -601,8 +609,7 @@ public Principal call() throws Exception {
 
         final Principal clientPrincipal = future.get(5, TimeUnit.SECONDS);
         Assert.assertNotNull(clientPrincipal);
-        Assert.assertEquals("CN=Test Client 2,OU=HttpComponents Project,O=Apache Software Foundation," +
-                "L=Unknown,ST=Unknown,C=Unknown", clientPrincipal.getName());
+        Assert.assertEquals("CN=Test Client 2,OU=HttpComponents Project,O=Apache Software Foundation", clientPrincipal.getName());
     }
 
 
@@ -648,7 +655,8 @@ public Boolean call() throws Exception {
             final Set<String> supportedClientProtocols = new LinkedHashSet<>(Arrays.asList(clientSocket.getSupportedProtocols()));
             Assert.assertTrue(supportedClientProtocols.contains("SSLv3"));
             clientSocket.setEnabledProtocols(new String[] {"SSLv3"} );
-            clientSocket.connect(new InetSocketAddress("localhost", localPort), 5000);
+            clientSocket.connect(new InetSocketAddress("localhost", localPort), TIMEOUT.toMillisIntBound());
+            clientSocket.setSoTimeout(TIMEOUT.toMillisIntBound());
             clientSocket.startHandshake();
         }
     }
@@ -700,7 +708,8 @@ public Boolean call() throws Exception {
                     Arrays.asList(clientSocket.getSupportedProtocols()));
             Assert.assertTrue(supportedClientProtocols.contains("TLSv1"));
             clientSocket.setEnabledProtocols(new String[] { "TLSv1" });
-            clientSocket.connect(new InetSocketAddress("localhost", localPort), 5000);
+            clientSocket.connect(new InetSocketAddress("localhost", localPort), TIMEOUT.toMillisIntBound());
+            clientSocket.setSoTimeout(TIMEOUT.toMillisIntBound());
             clientSocket.startHandshake();
         }
     }
diff --git a/httpcore5/src/test/resources/ca.keystore b/httpcore5/src/test/resources/ca.keystore
new file mode 100644
index 000000000..2c93a6078
Binary files /dev/null and b/httpcore5/src/test/resources/ca.keystore differ
diff --git a/httpcore5/src/test/resources/test-client.keystore b/httpcore5/src/test/resources/test-client.keystore
index d3c741f39..0cf5dd9df 100644
Binary files a/httpcore5/src/test/resources/test-client.keystore and b/httpcore5/src/test/resources/test-client.keystore differ
diff --git a/httpcore5/src/test/resources/test-keypasswd.keystore b/httpcore5/src/test/resources/test-keypasswd.keystore
index 01dd1bbee..b063cb3c6 100644
Binary files a/httpcore5/src/test/resources/test-keypasswd.keystore and b/httpcore5/src/test/resources/test-keypasswd.keystore differ
diff --git a/httpcore5/src/test/resources/test-server.keystore b/httpcore5/src/test/resources/test-server.keystore
index a88ee08c1..595a92513 100644
Binary files a/httpcore5/src/test/resources/test-server.keystore and b/httpcore5/src/test/resources/test-server.keystore differ
diff --git a/httpcore5/src/test/resources/test-ssl.txt b/httpcore5/src/test/resources/test-ssl.txt
new file mode 100644
index 000000000..222c4d672
--- /dev/null
+++ b/httpcore5/src/test/resources/test-ssl.txt
@@ -0,0 +1,193 @@
+# ====================================================================
+# Licensed to the Apache Software Foundation (ASF) under one
+# or more contributor license agreements.  See the NOTICE file
+# distributed with this work for additional information
+# regarding copyright ownership.  The ASF licenses this file
+# to you under the Apache License, Version 2.0 (the
+# "License"); you may not use this file except in compliance
+# with the License.  You may obtain a copy of the License at
+#
+#   http://www.apache.org/licenses/LICENSE-2.0
+#
+# Unless required by applicable law or agreed to in writing,
+# software distributed under the License is distributed on an
+# "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+# KIND, either express or implied.  See the License for the
+# specific language governing permissions and limitations
+# under the License.
+# ====================================================================
+#
+# This software consists of voluntary contributions made by many
+# individuals on behalf of the Apache Software Foundation.  For more
+# information on the Apache Software Foundation, please see
+# <http://www.apache.org/>.
+
+== generate test key store with a self signed key
+
+---
+keytool -genkey \
+  -keystore test.keystore -storepass nopassword \
+  -keyalg RSA -keysize 2048 \
+  -alias simple-http-server \
+  -validity 100000 \
+  -dname "CN=localhost, OU=Apache HttpComponents, O=Apache Software Foundation" \
+  -ext SAN="DNS:localhost"
+---
+
+== generate test key store with a self signed key protected with a key password
+
+---
+keytool -genkey \
+  -keystore test-keypasswd.keystore -storepass nopassword \
+  -keyalg RSA -keysize 2048 -keypass password \
+  -alias simple-http-server \
+  -validity 100000 \
+  -dname "CN=localhost, OU=Apache HttpComponents, O=Apache Software Foundation" \
+  -ext SAN="DNS:localhost"
+---
+
+== generate test CA
+
+---
+keytool -genkeypair \
+  -keystore ca.keystore -storepass nopassword \
+  -keyalg RSA -keysize 2048 -keypass password \
+  -alias ca \
+  -validity 100000 \
+  -dname "EMAILADDRESS=dev@hc.apache.org, CN=Test CA, OU=HttpComponents Project, O=Apache Software Foundation" \
+  -ext KeyUsage:critical="keyCertSign" \
+  -ext BasicConstraints:critical="ca:true" \
+  -ext SAN="EMAIL:dev@hc.apache.org"
+---
+
+== export test CA certificate
+
+---
+keytool -export \
+  -keystore ca.keystore -storepass nopassword -keypass password \
+  -alias ca \
+  -file test-ca.crt \
+  -rfc
+---
+
+== generate test server key
+
+---
+keytool -genkeypair \
+  -keystore test-server.keystore -storepass nopassword \
+  -keyalg RSA -keysize 2048 \
+  -alias server \
+  -validity 100000 \
+  -dname "CN=Test Server, OU=HttpComponents Project, O=Apache Software Foundation"
+---
+
+== create server certificate signing request
+
+---
+keytool -certreq \
+  -keystore test-server.keystore -storepass nopassword \
+  -alias server \
+  -file server.csr
+---
+
+== sign server certificate
+
+---
+keytool -gencert \
+  -keystore ca.keystore -storepass nopassword -keypass password \
+  -alias ca \
+  -infile server.csr \
+  -outfile server.crt \
+  -ext KeyUsage:critical="digitalSignature,keyEncipherment" \
+  -ext EKU="serverAuth" \
+  -ext SAN="DNS:localhost" \
+  -rfc
+---
+
+== import CA root certificate and signed server certificate
+
+---
+keytool -importcert \
+  -keystore test-server.keystore -storepass nopassword \
+  -file test-ca.crt \
+  -alias caroot
+---
+keytool -importcert \
+  -keystore test-server.keystore -storepass nopassword \
+  -file server.crt \
+  -alias server
+---
+
+== generate client keys
+
+---
+keytool -genkeypair \
+  -keystore test-client.keystore -storepass nopassword \
+  -keyalg RSA -keysize 2048 \
+  -alias client1 \
+  -validity 100000 \
+  -dname "CN=Test Client 1, OU=HttpComponents Project, O=Apache Software Foundation"
+---
+keytool -genkeypair \
+  -keystore test-client.keystore -storepass nopassword \
+  -keyalg RSA -keysize 2048 \
+  -alias client2 \
+  -validity 100000 \
+  -dname "CN=Test Client 2, OU=HttpComponents Project, O=Apache Software Foundation"
+---
+
+== create client certificate signing requests
+
+---
+keytool -certreq \
+  -keystore test-client.keystore -storepass nopassword \
+  -alias client1 \
+  -file client1.csr
+---
+keytool -certreq \
+  -keystore test-client.keystore -storepass nopassword \
+  -alias client2 \
+  -file client2.csr
+---
+
+== sign client certificates
+
+---
+keytool -gencert \
+  -keystore ca.keystore -storepass nopassword -keypass password \
+  -alias ca \
+  -infile client1.csr \
+  -outfile client1.crt \
+  -ext EKU="clientAuth" \
+  -ext SAN="EMAIL:test-client-1@hc.apache.org" \
+  -rfc
+---
+keytool -gencert \
+  -keystore ca.keystore -storepass nopassword -keypass password \
+  -alias ca \
+  -infile client2.csr \
+  -outfile client2.crt \
+  -ext EKU="clientAuth" \
+  -ext SAN="EMAIL:test-client-2@hc.apache.org" \
+  -rfc
+---
+
+== import CA root certificate and signed server certificate
+
+---
+keytool -importcert \
+  -keystore test-client.keystore -storepass nopassword \
+  -file test-ca.crt \
+  -alias caroot
+---
+keytool -importcert \
+  -keystore test-client.keystore -storepass nopassword \
+  -file client1.crt \
+  -alias client1
+---
+keytool -importcert \
+  -keystore test-client.keystore -storepass nopassword \
+  -file client2.crt \
+  -alias client2
+---
+
diff --git a/httpcore5/src/test/resources/test.keystore b/httpcore5/src/test/resources/test.keystore
index 917f83ea7..50106696c 100644
Binary files a/httpcore5/src/test/resources/test.keystore and b/httpcore5/src/test/resources/test.keystore differ
