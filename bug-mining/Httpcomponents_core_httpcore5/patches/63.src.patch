diff --git a/httpcore5/src/main/java/org/apache/hc/core5/reactor/AbstractIOSessionPool.java b/httpcore5/src/main/java/org/apache/hc/core5/reactor/AbstractIOSessionPool.java
index 2bc396ace..efe855d95 100644
--- a/httpcore5/src/main/java/org/apache/hc/core5/reactor/AbstractIOSessionPool.java
+++ b/httpcore5/src/main/java/org/apache/hc/core5/reactor/AbstractIOSessionPool.java
@@ -182,6 +182,9 @@ private void getSessionInternal(
                 callback.completed(poolEntry.session);
             } else {
                 poolEntry.requestQueue.add(callback);
+                if (poolEntry.sessionFuture != null && poolEntry.sessionFuture.isDone()) {
+                    poolEntry.sessionFuture = null;
+                }
                 if (poolEntry.sessionFuture == null) {
                     poolEntry.sessionFuture = connectSession(
                             namedEndpoint,
@@ -192,7 +195,6 @@ private void getSessionInternal(
                                 public void completed(final IOSession result) {
                                     synchronized (poolEntry) {
                                         poolEntry.session = result;
-                                        poolEntry.sessionFuture = null;
                                         for (;;) {
                                             final FutureCallback<IOSession> callback = poolEntry.requestQueue.poll();
                                             if (callback != null) {
@@ -208,7 +210,6 @@ public void completed(final IOSession result) {
                                 public void failed(final Exception ex) {
                                     synchronized (poolEntry) {
                                         poolEntry.session = null;
-                                        poolEntry.sessionFuture = null;
                                         for (;;) {
                                             final FutureCallback<IOSession> callback = poolEntry.requestQueue.poll();
                                             if (callback != null) {
diff --git a/httpcore5/src/test/java/org/apache/hc/core5/reactor/TestAbstractIOSessionPool.java b/httpcore5/src/test/java/org/apache/hc/core5/reactor/TestAbstractIOSessionPool.java
index 04f3dd49d..c1f167277 100644
--- a/httpcore5/src/test/java/org/apache/hc/core5/reactor/TestAbstractIOSessionPool.java
+++ b/httpcore5/src/test/java/org/apache/hc/core5/reactor/TestAbstractIOSessionPool.java
@@ -26,6 +26,7 @@
  */
 package org.apache.hc.core5.reactor;
 
+import java.net.UnknownHostException;
 import java.util.concurrent.Future;
 
 import org.apache.hc.core5.concurrent.FutureCallback;
@@ -35,11 +36,14 @@
 import org.apache.hc.core5.util.Timeout;
 import org.hamcrest.CoreMatchers;
 import org.hamcrest.MatcherAssert;
+import org.junit.Assert;
 import org.junit.Before;
 import org.junit.Test;
 import org.junit.runner.RunWith;
 import org.mockito.Answers;
+import org.mockito.ArgumentCaptor;
 import org.mockito.ArgumentMatchers;
+import org.mockito.Captor;
 import org.mockito.Mock;
 import org.mockito.Mockito;
 import org.mockito.junit.MockitoJUnitRunner;
@@ -57,6 +61,8 @@ public class TestAbstractIOSessionPool {
     private IOSession ioSession1;
     @Mock
     private IOSession ioSession2;
+    @Captor
+    ArgumentCaptor<FutureCallback<IOSession>> connectCallbackCaptor;
 
     private AbstractIOSessionPool<String> impl;
 
@@ -128,7 +134,7 @@ public void testGetSessions() throws Exception {
     }
 
     @Test
-    public void testGetSessionFailure() throws Exception {
+    public void testGetSessionConnectFailure() throws Exception {
 
         Mockito.when(impl.connectSession(
                 ArgumentMatchers.anyString(),
@@ -143,21 +149,18 @@ public void testGetSessionFailure() throws Exception {
         Mockito.verify(impl).connectSession(
                 ArgumentMatchers.eq("somehost"),
                 ArgumentMatchers.eq(Timeout.ofSeconds(123L)),
-                ArgumentMatchers.any());
+                connectCallbackCaptor.capture());
 
         final Future<IOSession> future2 = impl.getSession("somehost", Timeout.ofSeconds(123L), null);
         MatcherAssert.assertThat(future2, CoreMatchers.notNullValue());
         MatcherAssert.assertThat(future2.isDone(), CoreMatchers.equalTo(false));
         MatcherAssert.assertThat(impl.getRoutes(), CoreMatchers.hasItem("somehost"));
 
-        Mockito.verify(impl, Mockito.times(1)).connectSession(
-                ArgumentMatchers.eq("somehost"),
-                ArgumentMatchers.any(),
-                ArgumentMatchers.argThat(callback -> {
-                    callback.failed(new Exception("Boom"));
-                    return true;
-                }));
+        final FutureCallback<IOSession> connectCallback = connectCallbackCaptor.getValue();
+        Assert.assertNotNull(connectCallback);
+        connectCallback.failed(new Exception("Boom"));
 
+        // Ensure connect failure invalidates all pending futures
         MatcherAssert.assertThat(future1.isDone(), CoreMatchers.equalTo(true));
         MatcherAssert.assertThat(future2.isDone(), CoreMatchers.equalTo(true));
     }
@@ -258,4 +261,25 @@ public void testGetSessionReconnectIfClosed() throws Exception {
                 ArgumentMatchers.any());
     }
 
+    @Test
+    public void testGetSessionConnectUnknownHost() throws Exception {
+
+        Mockito.when(connectFuture.isDone()).thenReturn(true);
+        Mockito.when(impl.connectSession(
+                ArgumentMatchers.anyString(),
+                ArgumentMatchers.any(),
+                ArgumentMatchers.argThat(callback -> {
+                    callback.failed(new UnknownHostException("Boom"));
+                    return true;
+                }))).thenReturn(connectFuture);
+
+        final Future<IOSession> future1 = impl.getSession("somehost", Timeout.ofSeconds(123L), null);
+        MatcherAssert.assertThat(future1, CoreMatchers.notNullValue());
+        MatcherAssert.assertThat(future1.isDone(), CoreMatchers.equalTo(true));
+
+        final Future<IOSession> future2 = impl.getSession("somehost", Timeout.ofSeconds(123L), null);
+        MatcherAssert.assertThat(future2, CoreMatchers.notNullValue());
+        MatcherAssert.assertThat(future2.isDone(), CoreMatchers.equalTo(true));
+    }
+
 }
