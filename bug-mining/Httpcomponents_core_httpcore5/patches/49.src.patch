diff --git a/httpcore5/src/main/java/org/apache/hc/core5/reactor/AbstractSingleCoreIOReactor.java b/httpcore5/src/main/java/org/apache/hc/core5/reactor/AbstractSingleCoreIOReactor.java
index 86f32cc96..3989e7368 100644
--- a/httpcore5/src/main/java/org/apache/hc/core5/reactor/AbstractSingleCoreIOReactor.java
+++ b/httpcore5/src/main/java/org/apache/hc/core5/reactor/AbstractSingleCoreIOReactor.java
@@ -33,6 +33,7 @@
 import java.nio.channels.SelectionKey;
 import java.nio.channels.Selector;
 import java.util.Set;
+import java.util.concurrent.atomic.AtomicBoolean;
 import java.util.concurrent.atomic.AtomicReference;
 
 import org.apache.hc.core5.function.Callback;
@@ -45,6 +46,7 @@ abstract class AbstractSingleCoreIOReactor implements IOReactor {
 
     private final Callback<Exception> exceptionCallback;
     private final AtomicReference<IOReactorStatus> status;
+    private final AtomicBoolean terminated;
     private final Object shutdownMutex;
 
     final Selector selector;
@@ -54,6 +56,7 @@ abstract class AbstractSingleCoreIOReactor implements IOReactor {
         this.exceptionCallback = exceptionCallback;
         this.shutdownMutex = new Object();
         this.status = new AtomicReference<>(IOReactorStatus.INACTIVE);
+        this.terminated = new AtomicBoolean();
         try {
             this.selector = Selector.open();
         } catch (final IOException ex) {
@@ -87,27 +90,10 @@ public void execute() {
             } finally {
                 try {
                     doTerminate();
-                    final Set<SelectionKey> keys = this.selector.keys();
-                    for (final SelectionKey key : keys) {
-                        try {
-                            Closer.close((Closeable) key.attachment());
-                        } catch (final IOException ex) {
-                            logException(ex);
-                        }
-                        key.channel().close();
-                    }
-                    try {
-                        this.selector.close();
-                    } catch (final IOException ex) {
-                        logException(ex);
-                    }
                 } catch (final Exception ex) {
                     logException(ex);
                 } finally {
-                    this.status.set(IOReactorStatus.SHUT_DOWN);
-                    synchronized (this.shutdownMutex) {
-                        this.shutdownMutex.notifyAll();
-                    }
+                    close(CloseMode.IMMEDIATE);
                 }
             }
         }
@@ -149,15 +135,27 @@ public final void close(final CloseMode closeMode) {
             } catch (final InterruptedException e) {
                 Thread.currentThread().interrupt();
             }
-        } else {
-            final IOReactorStatus previousStatus = this.status.getAndSet(IOReactorStatus.SHUT_DOWN);
-            if (previousStatus == IOReactorStatus.ACTIVE) {
-                this.selector.wakeup();
-            }
-            synchronized (this.shutdownMutex) {
-                this.shutdownMutex.notifyAll();
+        }
+        this.status.set(IOReactorStatus.SHUT_DOWN);
+        if (terminated.compareAndSet(false, true)) {
+            try {
+                final Set<SelectionKey> keys = this.selector.keys();
+                for (final SelectionKey key : keys) {
+                    try {
+                        Closer.close((Closeable) key.attachment());
+                    } catch (final IOException ex) {
+                        logException(ex);
+                    }
+                    key.channel().close();
+                }
+                selector.close();
+            } catch (final Exception ex) {
+                logException(ex);
             }
         }
+        synchronized (this.shutdownMutex) {
+            this.shutdownMutex.notifyAll();
+        }
     }
 
     @Override
diff --git a/httpcore5/src/main/java/org/apache/hc/core5/reactor/MultiCoreIOReactor.java b/httpcore5/src/main/java/org/apache/hc/core5/reactor/MultiCoreIOReactor.java
index d41d1f323..d4d4868ab 100644
--- a/httpcore5/src/main/java/org/apache/hc/core5/reactor/MultiCoreIOReactor.java
+++ b/httpcore5/src/main/java/org/apache/hc/core5/reactor/MultiCoreIOReactor.java
@@ -28,6 +28,7 @@
 package org.apache.hc.core5.reactor;
 
 import java.util.concurrent.TimeUnit;
+import java.util.concurrent.atomic.AtomicBoolean;
 import java.util.concurrent.atomic.AtomicReference;
 
 import org.apache.hc.core5.io.CloseMode;
@@ -40,12 +41,14 @@ class MultiCoreIOReactor implements IOReactor {
     private final IOReactor[] ioReactors;
     private final Thread[] threads;
     private final AtomicReference<IOReactorStatus> status;
+    private final AtomicBoolean terminated;
 
     MultiCoreIOReactor(final IOReactor[] ioReactors, final Thread[] threads) {
         super();
         this.ioReactors = ioReactors.clone();
         this.threads = threads.clone();
         this.status = new AtomicReference<>(IOReactorStatus.INACTIVE);
+        this.terminated = new AtomicBoolean();
     }
 
     @Override
@@ -70,7 +73,8 @@ public final void start() {
 
     @Override
     public final void initiateShutdown() {
-        if (this.status.compareAndSet(IOReactorStatus.ACTIVE, IOReactorStatus.SHUTTING_DOWN)) {
+        if (this.status.compareAndSet(IOReactorStatus.INACTIVE, IOReactorStatus.SHUT_DOWN) ||
+                this.status.compareAndSet(IOReactorStatus.ACTIVE, IOReactorStatus.SHUTTING_DOWN)) {
             for (int i = 0; i < this.ioReactors.length; i++) {
                 final IOReactor ioReactor = this.ioReactors[i];
                 ioReactor.initiateShutdown();
@@ -105,10 +109,6 @@ public final void awaitShutdown(final TimeValue waitTime) throws InterruptedExce
 
     @Override
     public final void close(final CloseMode closeMode) {
-        final IOReactorStatus currentStatus = this.status.get();
-        if (currentStatus == IOReactorStatus.INACTIVE || currentStatus == IOReactorStatus.SHUT_DOWN) {
-            return;
-        }
         if (closeMode == CloseMode.GRACEFUL) {
             initiateShutdown();
             try {
@@ -116,8 +116,9 @@ public final void close(final CloseMode closeMode) {
             } catch (final InterruptedException e) {
                 Thread.currentThread().interrupt();
             }
-        } else {
-            this.status.compareAndSet(IOReactorStatus.ACTIVE, IOReactorStatus.SHUTTING_DOWN);
+        }
+        this.status.set(IOReactorStatus.SHUT_DOWN);
+        if (this.terminated.compareAndSet(false, true)) {
             for (int i = 0; i < this.ioReactors.length; i++) {
                 Closer.close(this.ioReactors[i], CloseMode.IMMEDIATE);
             }
@@ -125,7 +126,6 @@ public final void close(final CloseMode closeMode) {
                 this.threads[i].interrupt();
             }
         }
-        this.status.set(IOReactorStatus.SHUT_DOWN);
     }
 
     @Override
