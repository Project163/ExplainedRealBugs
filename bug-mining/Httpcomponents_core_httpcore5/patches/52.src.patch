diff --git a/httpcore5/src/main/java/org/apache/hc/core5/http/impl/nio/SessionInputBufferImpl.java b/httpcore5/src/main/java/org/apache/hc/core5/http/impl/nio/SessionInputBufferImpl.java
index 52f9b29b7..cab13b7e4 100644
--- a/httpcore5/src/main/java/org/apache/hc/core5/http/impl/nio/SessionInputBufferImpl.java
+++ b/httpcore5/src/main/java/org/apache/hc/core5/http/impl/nio/SessionInputBufferImpl.java
@@ -250,7 +250,7 @@ public boolean readLine(
                 final byte[] b = buffer().array();
                 final int off = buffer().position();
                 final int len = buffer().remaining();
-                lineBuffer.append(b, off, len);
+                lineBuffer.append(b, buffer().arrayOffset() + off, len);
                 buffer().position(off + len);
             } else {
                 while (buffer().hasRemaining()) {
@@ -275,7 +275,7 @@ public boolean readLine(
                     this.charbuffer.flip();
                     lineBuffer.append(
                             this.charbuffer.array(),
-                            this.charbuffer.position(),
+                            this.charbuffer.arrayOffset() + this.charbuffer.position(),
                             this.charbuffer.remaining());
                     this.charbuffer.clear();
                 }
@@ -291,7 +291,7 @@ public boolean readLine(
             if (this.charbuffer.hasRemaining()) {
                 lineBuffer.append(
                         this.charbuffer.array(),
-                        this.charbuffer.position(),
+                        this.charbuffer.arrayOffset() + this.charbuffer.position(),
                         this.charbuffer.remaining());
             }
 
diff --git a/httpcore5/src/main/java/org/apache/hc/core5/http/impl/nio/SessionOutputBufferImpl.java b/httpcore5/src/main/java/org/apache/hc/core5/http/impl/nio/SessionOutputBufferImpl.java
index bfc81df15..23b8da2b6 100644
--- a/httpcore5/src/main/java/org/apache/hc/core5/http/impl/nio/SessionOutputBufferImpl.java
+++ b/httpcore5/src/main/java/org/apache/hc/core5/http/impl/nio/SessionOutputBufferImpl.java
@@ -169,8 +169,9 @@ public void writeLine(final CharArrayBuffer lineBuffer) throws CharacterCodingEx
                     final byte[] b = buffer().array();
                     final int len = lineBuffer.length();
                     final int off = buffer().position();
+                    final int arrayOffset = buffer().arrayOffset();
                     for (int i = 0; i < len; i++) {
-                        b[off + i]  = (byte) lineBuffer.charAt(i);
+                        b[arrayOffset + off + i]  = (byte) lineBuffer.charAt(i);
                     }
                     buffer().position(off + len);
                 } else {
