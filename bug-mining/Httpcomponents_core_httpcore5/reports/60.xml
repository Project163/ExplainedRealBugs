<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 18:24:32 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HTTPCORE-666] Upgrade to 5.1-beta3 breaks behaviour from 5.0.x code</title>
                <link>https://issues.apache.org/jira/browse/HTTPCORE-666</link>
                <project id="12310340" key="HTTPCORE">HttpComponents HttpCore</project>
                    <description>&lt;p&gt;Here is the commit that broke the behaviour: &lt;a href=&quot;https://github.com/apache/httpcomponents-core/commit/49591ef92cf6900e71d77e3c84e660b57dd25e1a&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/httpcomponents-core/commit/49591ef92cf6900e71d77e3c84e660b57dd25e1a&lt;/a&gt;&lt;br/&gt;
And more specifically the change to {{ServerHttp1IOEventHandlerFactory.createHandler(): &lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/httpcomponents-core/commit/49591ef92cf6900e71d77e3c84e660b57dd25e1a#diff-20589ec1cfdba10cb3a20ca94611e09a928e533fa60d311af1a25e8157ca01bf&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/httpcomponents-core/commit/49591ef92cf6900e71d77e3c84e660b57dd25e1a#diff-20589ec1cfdba10cb3a20ca94611e09a928e533fa60d311af1a25e8157ca01bf&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Our code takes the else branch, and the behaviour has changed there.&lt;br/&gt;
To make all our tests pass again, the following patch restores the previous behaviour:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
diff --git a/httpcore5/src/main/java/org/apache/hc/core5/http/impl/nio/ServerHttp1IOEventHandlerFactory.java b/httpcore5/src/main/java/org/apache/hc/core5/http/impl/nio/ServerHttp1IOEventHandlerFactory.java
index 111f6152d..db316097d 100644
--- a/httpcore5/src/main/java/org/apache/hc/core5/http/impl/nio/ServerHttp1IOEventHandlerFactory.java
+++ b/httpcore5/src/main/java/org/apache/hc/core5/http/impl/nio/ServerHttp1IOEventHandlerFactory.java
@@ -75,13 +75,15 @@ &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; IOEventHandler createHandler(&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; ProtocolIOSession ioSession, &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Obj
                         handshakeTimeout);
             }
         } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
-            tlsStrategy.upgrade(
-                    ioSession,
-                    &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;,
-                    ioSession.getLocalAddress(),
-                    ioSession.getRemoteAddress(),
-                    attachment,
-                    handshakeTimeout);
+            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (tlsStrategy != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; &amp;amp;&amp;amp; tlsStrategy.upgrade(
+                        ioSession,
+                        &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;,
+                        ioSession.getLocalAddress(),
+                        ioSession.getRemoteAddress(),
+                        attachment,
+                        handshakeTimeout)) {
+                endpointScheme = URIScheme.HTTPS.id;
+            }
         }
         &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ServerHttp1IOEventHandler(streamDuplexerFactory.create(endpointScheme, ioSession));
     }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;tt&gt;(attachment instanceof EndpointParameters)&lt;/tt&gt; returns &lt;tt&gt;false&lt;/tt&gt; in our case.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13357139">HTTPCORE-666</key>
            <summary>Upgrade to 5.1-beta3 breaks behaviour from 5.0.x code</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="jnrouvignac">Jean-Noel Rouvignac</reporter>
                        <labels>
                    </labels>
                <created>Fri, 5 Feb 2021 17:31:09 +0000</created>
                <updated>Fri, 5 Feb 2021 20:45:15 +0000</updated>
                            <resolved>Fri, 5 Feb 2021 19:00:08 +0000</resolved>
                                    <version>5.1-beta1</version>
                    <version>5.1-beta2</version>
                    <version>5.1-beta3</version>
                                    <fixVersion>5.1</fixVersion>
                                    <component>HttpCore NIO</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="17279842" author="jnrouvignac" created="Fri, 5 Feb 2021 17:32:49 +0000"  >&lt;p&gt;Sorry I don&apos;t have time to submit a patch / unit tests for now since I&apos;ll be on holidays for the coming week.&lt;/p&gt;</comment>
                            <comment id="17279845" author="olegk" created="Fri, 5 Feb 2021 17:39:46 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jnrouvignac&quot; class=&quot;user-hover&quot; rel=&quot;jnrouvignac&quot;&gt;jnrouvignac&lt;/a&gt; Does your code throw an NPE?&lt;/p&gt;

&lt;p&gt;Oleg&lt;/p&gt;</comment>
                            <comment id="17279916" author="jira-bot" created="Fri, 5 Feb 2021 18:58:40 +0000"  >&lt;p&gt;Commit 69133eb372906334f9dad2b86f2748d0c0acb941 in httpcomponents-core&apos;s branch refs/heads/master from Oleg Kalnichevski&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=httpcomponents-core.git;h=69133eb&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=httpcomponents-core.git;h=69133eb&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HTTPCORE-666&quot; title=&quot;Upgrade to 5.1-beta3 breaks behaviour from 5.0.x code&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HTTPCORE-666&quot;&gt;&lt;del&gt;HTTPCORE-666&lt;/del&gt;&lt;/a&gt;, regression: fixed NPE in ServerHttp1IOEventHandlerFactory&lt;/p&gt;</comment>
                            <comment id="17279920" author="jnrouvignac" created="Fri, 5 Feb 2021 19:06:14 +0000"  >&lt;p&gt;Yes it did throw an NPE first. After that was fixed, an HTTPS call was not recognized as HTTPS anymore&lt;/p&gt;</comment>
                            <comment id="17279942" author="jnrouvignac" created="Fri, 5 Feb 2021 19:35:12 +0000"  >&lt;p&gt;Thanks for the quick merge!&lt;br/&gt;
Now we need to wait for a new release. Possibly before the end of February, but if not that&apos;s not the end of the world.&lt;/p&gt;</comment>
                            <comment id="17279980" author="olegk" created="Fri, 5 Feb 2021 20:45:15 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jnrouvignac&quot; class=&quot;user-hover&quot; rel=&quot;jnrouvignac&quot;&gt;jnrouvignac&lt;/a&gt; 5.1 GA is likely by the end of the month but do not take it as  a promise.&lt;/p&gt;

&lt;p&gt;Oleg&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 40 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0nf9c:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>