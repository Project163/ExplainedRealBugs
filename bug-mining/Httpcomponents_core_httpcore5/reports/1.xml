<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 18:23:43 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HTTPCORE-417] Infinite loop in LengthDelimitedEncoder due to negative return from SSLIOSession.writePlain()</title>
                <link>https://issues.apache.org/jira/browse/HTTPCORE-417</link>
                <project id="12310340" key="HTTPCORE">HttpComponents HttpCore</project>
                    <description>&lt;p&gt;SSLIOSession.InternalByteChannel.write(ByteBuffer) does not obey the WriteableByteChannel contract. In writePlain(), if the channel is closed, -1 is returned, but WriteableByteChannel should throw ClosedChannelException in this case, and should certainly never return a negative value.&lt;/p&gt;

&lt;p&gt;This leads to an infinite loop in LengthDelimitedEncoder.write(). AbstractContentEncoder.writeToChannel() returns the -1 from SSLIOSession.InternalByteChannel, and this causes remaining to grow without bound (&lt;a href=&quot;https://hc.apache.org/httpcomponents-core-4.4.x/httpcore-nio/xref/org/apache/http/impl/nio/codecs/LengthDelimitedEncoder.html#133&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://hc.apache.org/httpcomponents-core-4.4.x/httpcore-nio/xref/org/apache/http/impl/nio/codecs/LengthDelimitedEncoder.html#133&lt;/a&gt;).&lt;/p&gt;

&lt;p&gt;In my application, I see a stack trace similar to the following:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;I/O dispatcher 2 tid=199 [RUNNABLE]
org.apache.http.nio.reactor.ssl.SSLIOSession.access$100(SSLIOSession, ByteBuffer) SSLIOSession.java:72
org.apache.http.nio.reactor.ssl.SSLIOSession$InternalByteChannel.write(ByteBuffer) SSLIOSession.java:811
org.apache.http.impl.nio.codecs.AbstractContentEncoder.doWriteChunk(ByteBuffer, &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;) AbstractContentEncoder.java:173
org.apache.http.impl.nio.codecs.AbstractContentEncoder.doWriteChunk(ByteBuffer, &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;) AbstractContentEncoder.java:166
org.apache.http.impl.nio.codecs.AbstractContentEncoder.writeToChannel(ByteBuffer, &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;) AbstractContentEncoder.java:140
org.apache.http.impl.nio.codecs.LengthDelimitedEncoder.write(ByteBuffer) LengthDelimitedEncoder.java:132
com.box.http.apacheasync.compat.request.ActorSubscriberContentProducer$ContentProducer$.produceContent(ContentEncoder, IOControl) ActorSubscriberContentProducer.scala:114
com.box.http.apacheasync.compat.request.RequestConverter$$anon$1.produceContent(ContentEncoder, IOControl) RequestConverter.scala:78
org.apache.http.nio.protocol.BasicAsyncRequestProducer.produceContent(ContentEncoder, IOControl) BasicAsyncRequestProducer.java:125
org.apache.http.impl.nio.client.MainClientExec.produceContent(InternalState, ContentEncoder, IOControl) MainClientExec.java:262
org.apache.http.impl.nio.client.DefaultClientExchangeHandlerImpl.produceContent(ContentEncoder, IOControl) DefaultClientExchangeHandlerImpl.java:136
org.apache.http.nio.protocol.HttpAsyncRequestExecutor.outputReady(NHttpClientConnection, ContentEncoder) HttpAsyncRequestExecutor.java:229
org.apache.http.impl.nio.DefaultNHttpClientConnection.produceOutput(NHttpClientEventHandler) DefaultNHttpClientConnection.java:292
org.apache.http.impl.nio.client.InternalIODispatch.onOutputReady(DefaultNHttpClientConnection) InternalIODispatch.java:86
org.apache.http.impl.nio.client.InternalIODispatch.onOutputReady(&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;) InternalIODispatch.java:39
org.apache.http.impl.nio.reactor.AbstractIODispatch.outputReady(IOSession) AbstractIODispatch.java:154
org.apache.http.impl.nio.reactor.BaseIOReactor.writable(SelectionKey) BaseIOReactor.java:190
org.apache.http.impl.nio.reactor.AbstractIOReactor.processEvent(SelectionKey) AbstractIOReactor.java:343
org.apache.http.impl.nio.reactor.AbstractIOReactor.processEvents(Set) AbstractIOReactor.java:317
org.apache.http.impl.nio.reactor.AbstractIOReactor.execute() AbstractIOReactor.java:278
org.apache.http.impl.nio.reactor.BaseIOReactor.execute(IOEventDispatch) BaseIOReactor.java:106
org.apache.http.impl.nio.reactor.AbstractMultiworkerIOReactor$Worker.run() AbstractMultiworkerIOReactor.java:590
java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run() &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:744
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12932505">HTTPCORE-417</key>
            <summary>Infinite loop in LengthDelimitedEncoder due to negative return from SSLIOSession.writePlain()</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="olegk">Oleg Kalnichevski</assignee>
                                    <reporter username="mspielberg">Miles Spielberg</reporter>
                        <labels>
                    </labels>
                <created>Tue, 19 Jan 2016 19:49:38 +0000</created>
                <updated>Wed, 9 Mar 2016 08:34:26 +0000</updated>
                            <resolved>Wed, 27 Jan 2016 09:51:02 +0000</resolved>
                                    <version>4.4.4</version>
                                    <fixVersion>4.4.5</fixVersion>
                    <fixVersion>5.0-alpha2</fixVersion>
                                    <component>HttpCore NIO</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="15109120" author="olegk" created="Wed, 20 Jan 2016 18:47:54 +0000"  >&lt;p&gt;Miles&lt;br/&gt;
Could you please test this patch locally and let me know if that fixes the problem for you?&lt;br/&gt;
&lt;a href=&quot;https://github.com/ok2c/httpcore/commit/02fad7338c843f76232fa11b2a8252c055e61805&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/ok2c/httpcore/commit/02fad7338c843f76232fa11b2a8252c055e61805&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Oleg &lt;/p&gt;</comment>
                            <comment id="15118943" author="olegk" created="Wed, 27 Jan 2016 09:51:02 +0000"  >&lt;p&gt;Fixed in SVN trunk and 4.4.x branch.&lt;/p&gt;

&lt;p&gt;Oleg&lt;/p&gt;</comment>
                            <comment id="15186223" author="kmgreen2" created="Wed, 9 Mar 2016 00:55:20 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=olegk&quot; class=&quot;user-hover&quot; rel=&quot;olegk&quot;&gt;olegk&lt;/a&gt; Do you know when 4.4.5 will be released (i.e. Maven)?  We cannot reproduce in our development load-testing environment and cannot run in production with a snapshot.  The easiest way to repo will be in a sandbox in prod.&lt;/p&gt;

&lt;p&gt;Thanks!&lt;/p&gt;</comment>
                            <comment id="15186755" author="olegk" created="Wed, 9 Mar 2016 08:34:26 +0000"  >&lt;p&gt;Kevin&lt;br/&gt;
Some time in April, but please do not take it as a promise.&lt;/p&gt;

&lt;p&gt;Oleg&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 36 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2rp9b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>