<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 18:24:01 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HTTPCORE-559] The DefaultBHttpClientConnection will not read a simple end-of-stream terminated HTTP response body</title>
                <link>https://issues.apache.org/jira/browse/HTTPCORE-559</link>
                <project id="12310340" key="HTTPCORE">HttpComponents HttpCore</project>
                    <description>&lt;p&gt;When you use the Classic HttpClient to execute a GET request for a resource which is returned with no Content-Length or Transfer-Encoding header then the response body (which should be now terminated by the closing of the stream) is not read.&#160; Instead the client returns an empty response with no attempt made to read from the stream.&lt;/p&gt;

&lt;p&gt;I realize that virtually no responses are ever sent this way, they almost always either have a content length or use chunked transfer encoding, but it is still legal as per the HTTP spec to return a response without using either of these and relying on the end-of-stream to terminate the response body.&#160; Currently if a server is doing this, the HttpClient won&apos;t receive the response.&lt;/p&gt;

&lt;p&gt;I found this problem testing the HttpClient, but I believe the root source of the problem is in the DefaultBHttpClientConnection implementation.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13190796">HTTPCORE-559</key>
            <summary>The DefaultBHttpClientConnection will not read a simple end-of-stream terminated HTTP response body</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="dmaplesden">David Maplesden</reporter>
                        <labels>
                    </labels>
                <created>Thu, 11 Oct 2018 00:33:48 +0000</created>
                <updated>Mon, 22 Oct 2018 09:05:33 +0000</updated>
                            <resolved>Thu, 11 Oct 2018 08:08:29 +0000</resolved>
                                    <version>5.0-beta3</version>
                                    <fixVersion>5.0-beta5</fixVersion>
                                    <component>HttpCore</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="16645795" author="dmaplesden" created="Thu, 11 Oct 2018 01:03:47 +0000"  >&lt;p&gt;You need to add a unit test that looks something like the below to &lt;tt&gt;org.apache.hc.core5.http.impl.io.TestDefaultBHttpClientConnection&lt;/tt&gt;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&#160;&#160;&#160; @Test
&#160;&#160;&#160; &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void testReadResponseEntityWithoutContentLength() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {
&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; s = &lt;span class=&quot;code-quote&quot;&gt;&quot;HTTP/1.1 200 OK\r\nServer: test\r\n\r\n123&quot;&lt;/span&gt;;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; ByteArrayInputStream inStream = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ByteArrayInputStream(s.getBytes(StandardCharsets.US_ASCII));
&#160;&#160;&#160;&#160;&#160;&#160;&#160; Mockito.when(socket.getInputStream()).thenReturn(inStream);

&#160;&#160;&#160;&#160;&#160;&#160;&#160; conn.bind(socket);

&#160;&#160;&#160;&#160;&#160;&#160;&#160; Assert.assertEquals(0, conn.getEndpointDetails().getResponseCount());

&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; ClassicHttpResponse response = conn.receiveResponseHeader();

&#160;&#160;&#160;&#160;&#160;&#160;&#160; Assert.assertNotNull(response);
&#160;&#160;&#160;&#160;&#160;&#160;&#160; Assert.assertEquals(200, response.getCode());
&#160;&#160;&#160;&#160;&#160;&#160;&#160; Assert.assertTrue(response.containsHeader(&lt;span class=&quot;code-quote&quot;&gt;&quot;Server&quot;&lt;/span&gt;));
&#160;&#160;&#160;&#160;&#160;&#160;&#160; Assert.assertEquals(1, conn.getEndpointDetails().getResponseCount());

&#160;&#160;&#160;&#160;&#160;&#160;&#160; conn.receiveResponseEntity(response);

&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; HttpEntity entity = response.getEntity();
&#160;&#160;&#160;&#160;&#160;&#160;&#160; Assert.assertNotNull(entity);
&#160;&#160;&#160;&#160;&#160;&#160;&#160; Assert.assertEquals(-1, entity.getContentLength());
&#160;&#160;&#160;&#160;&#160;&#160;&#160; Assert.assertEquals(1, conn.getEndpointDetails().getResponseCount());

&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; InputStream content = entity.getContent();
&#160;&#160;&#160;&#160;&#160;&#160;&#160; Assert.assertNotNull(content);
&#160;&#160;&#160;&#160;&#160;&#160;&#160; Assert.assertEquals(3, content.available());
&#160;&#160;&#160;&#160;&#160;&#160;&#160; Assert.assertEquals(&lt;span class=&quot;code-quote&quot;&gt;&apos;1&apos;&lt;/span&gt;, content.read());
&#160;&#160;&#160;&#160;&#160;&#160;&#160; Assert.assertEquals(&lt;span class=&quot;code-quote&quot;&gt;&apos;2&apos;&lt;/span&gt;, content.read());
&#160;&#160;&#160;&#160;&#160;&#160;&#160; Assert.assertEquals(&lt;span class=&quot;code-quote&quot;&gt;&apos;3&apos;&lt;/span&gt;, content.read());
&#160;&#160;&#160; }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="16645807" author="githubbot" created="Thu, 11 Oct 2018 01:18:37 +0000"  >&lt;p&gt;GitHub user dmap opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/httpcomponents-core/pull/89&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/httpcomponents-core/pull/89&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Allow default http client connection to read simple streamed responses&lt;/p&gt;

&lt;p&gt;    As per spec these responses are terminated by the end of stream.&lt;/p&gt;

&lt;p&gt;    Issue: &lt;a href=&quot;https://issues.apache.org/jira/browse/HTTPCORE-559&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HTTPCORE-559&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Note: this PR breaks one existing unit test - namely &lt;tt&gt;testReadResponseNoEntity&lt;/tt&gt; from &lt;tt&gt;TestDefaultBHttpClientConnection&lt;/tt&gt;.  The test is trivial to fix, but I&apos;m not sure what you want the desired behaviour to be when an &apos;empty&apos; response is returned.  Previously the result was a null entity, but with my change the result is now an empty entity, an entity with no content.  I think this is fine, but you may not.&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/dmap/httpcomponents-core&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/dmap/httpcomponents-core&lt;/a&gt; bugfix/&lt;a href=&quot;https://issues.apache.org/jira/browse/HTTPCORE-559&quot; title=&quot;The DefaultBHttpClientConnection will not read a simple end-of-stream terminated HTTP response body&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HTTPCORE-559&quot;&gt;&lt;del&gt;HTTPCORE-559&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/httpcomponents-core/pull/89.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/httpcomponents-core/pull/89.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #89&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 9a286c925288e4488ac3edd084c662143738ec2f&lt;br/&gt;
Author: David Maplesden &amp;lt;david@...&amp;gt;&lt;br/&gt;
Date:   2018-10-11T01:11:39Z&lt;/p&gt;

&lt;p&gt;    Allow default http client connection to read simple streamed responses&lt;/p&gt;

&lt;p&gt;    As per spec these responses are terminated by the end of stream.&lt;/p&gt;

&lt;p&gt;    Issue: &lt;a href=&quot;https://issues.apache.org/jira/browse/HTTPCORE-559&quot; title=&quot;The DefaultBHttpClientConnection will not read a simple end-of-stream terminated HTTP response body&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HTTPCORE-559&quot;&gt;&lt;del&gt;HTTPCORE-559&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="16645808" author="dmaplesden" created="Thu, 11 Oct 2018 01:19:12 +0000"  >&lt;p&gt;I have created a PR for this issue &lt;a href=&quot;https://github.com/apache/httpcomponents-core/pull/89&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/httpcomponents-core/pull/89&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16646091" author="githubbot" created="Thu, 11 Oct 2018 08:03:14 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/httpcomponents-core/pull/89&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/httpcomponents-core/pull/89&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16646094" author="olegk" created="Thu, 11 Oct 2018 08:08:16 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dmaplesden&quot; class=&quot;user-hover&quot; rel=&quot;dmaplesden&quot;&gt;dmaplesden&lt;/a&gt; I committed your patch and also corrected the failing test case. It&#160;was obviously built to match the&#160;actual behavior of the class rather&#160;the expected behavior defined by the HTTP spec.&lt;/p&gt;

&lt;p&gt;Many thanks for contributing this PR.&lt;/p&gt;

&lt;p&gt;Oleg&#160;&lt;/p&gt;</comment>
                            <comment id="16646166" author="dmaplesden" created="Thu, 11 Oct 2018 09:05:15 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=olegk&quot; class=&quot;user-hover&quot; rel=&quot;olegk&quot;&gt;olegk&lt;/a&gt; thanks for the quick follow up.&#160; Happy to help out.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 5 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3z29z:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>