<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 18:23:45 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HTTPCORE-423] Content-Type is wrongly handled in case of empty body during a PUT</title>
                <link>https://issues.apache.org/jira/browse/HTTPCORE-423</link>
                <project id="12310340" key="HTTPCORE">HttpComponents HttpCore</project>
                    <description>&lt;p&gt;We use Zuul to forward requests.&lt;/p&gt;

&lt;p&gt;We have a PUT without body, in this case the content-type is null,  and content-length = 0&lt;br/&gt;
But in the below code, we get the content-type from the request ans handle it badly:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-style: solid;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;border-bottom-style: solid;&quot;&gt;&lt;b&gt;org.springframework.cloud.netflix.zuul.filters.route.SimpleHostRoutingFilter.java&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;method &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; HttpResponse forward(HttpClient httpclient, &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; verb, &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; uri,
			HttpServletRequest request, MultiValueMap&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt; headers,
			MultiValueMap&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt; params, InputStream requestEntity)
					&lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {
		Map&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;&amp;gt; info = &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.helper.debug(verb, uri, headers, params,
				requestEntity);
		URL host = RequestContext.getCurrentContext().getRouteHost();
		HttpHost httpHost = getHttpHost(host);
		uri = StringUtils.cleanPath((host.getPath() + uri).replaceAll(&lt;span class=&quot;code-quote&quot;&gt;&quot;/{2,}&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;/&quot;&lt;/span&gt;));
		HttpRequest httpRequest;
		&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; contentLength = request.getContentLength();
{color:red}
		InputStreamEntity entity = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; InputStreamEntity(requestEntity, contentLength,
				ContentType.create(request.getContentType()));
{color}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ContentType.create() calls a InputStreamEntity constructor:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-style: solid;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;border-bottom-style: solid;&quot;&gt;&lt;b&gt;org.apache.http.entity.InputStreamEntity.java&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; InputStreamEntity(&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; InputStream instream, &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; length, &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; ContentType contentType) {
        &lt;span class=&quot;code-keyword&quot;&gt;super&lt;/span&gt;();
        &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.content = Args.notNull(instream, &lt;span class=&quot;code-quote&quot;&gt;&quot;Source input stream&quot;&lt;/span&gt;);
        &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.length = length;
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (contentType != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
{color:red}
            setContentType(contentType.toString());
{color}
        }
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;


&lt;p&gt;toString() is called on contentType which has a null mimeType member.&lt;/p&gt;

&lt;p&gt;This is wrong:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Never call toString() in &lt;b&gt;REAL&lt;/b&gt; code, only for debugging&lt;/li&gt;
	&lt;li&gt;the method return &quot;null&quot; (not the null value of the pointer but a string of 4 chars containing &quot;null&quot;)&lt;/li&gt;
&lt;/ul&gt;
</description>
                <environment></environment>
        <key id="12977158">HTTPCORE-423</key>
            <summary>Content-Type is wrongly handled in case of empty body during a PUT</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="jecuendet">Jean-Eric Cuendet</reporter>
                        <labels>
                    </labels>
                <created>Thu, 9 Jun 2016 09:17:39 +0000</created>
                <updated>Sat, 11 Jun 2016 14:59:25 +0000</updated>
                            <resolved>Sat, 11 Jun 2016 14:59:25 +0000</resolved>
                                    <version>4.4.4</version>
                    <version>4.4.5</version>
                                    <fixVersion>4.4.6</fixVersion>
                                    <component>HttpCore</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="15322373" author="olegk" created="Thu, 9 Jun 2016 11:27:02 +0000"  >&lt;blockquote&gt;&lt;p&gt;- Never call toString() in &lt;b&gt;REAL&lt;/b&gt; code, only for debugging&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I have to disgree with this statement. There are enough examples of #toString being used in productive code&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://docs.oracle.com/javase/7/docs/api/java/io/StringWriter.html#toString(&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://docs.oracle.com/javase/7/docs/api/java/io/StringWriter.html#toString(&lt;/a&gt;)&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;- the method return &quot;null&quot; (not the null value of the pointer but a string of 4 chars containing &quot;null&quot;)&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;This is clearly a bug though minor in my opinion.&lt;/p&gt;

&lt;p&gt;Oleg&lt;/p&gt;</comment>
                            <comment id="15325895" author="olegk" created="Sat, 11 Jun 2016 14:59:25 +0000"  >&lt;p&gt;Fixed in SVN trunk and 4.4.x branch. Please review / re-test and close.&lt;/p&gt;

&lt;p&gt;Oleg&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 23 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2z7lr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>