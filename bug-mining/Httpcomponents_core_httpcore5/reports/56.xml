<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 18:24:29 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HTTPCORE-653] CancelledKeyException Triggers Reactor to Shutdown</title>
                <link>https://issues.apache.org/jira/browse/HTTPCORE-653</link>
                <project id="12310340" key="HTTPCORE">HttpComponents HttpCore</project>
                    <description>&lt;p&gt;Recently I noticed the I/O Reactor of my application always shuts down unexpectedly, so I tried to remote debug my application and found shutting down process is triggered by CancelledKeyException, and since I&apos;m not an expert of NIO therefore I did my best to assist you to diagnose the problem with thread dump and stacktrace attached.&lt;/p&gt;

&lt;p&gt;Apart from that, I also attached the code of how I use HttpClient in order to make sure, such exception is not caused in correct usage of HttpClient.&lt;/p&gt;

&lt;p&gt;Let me know if you need more details please.&lt;/p&gt;

&lt;p&gt; &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/13014790/13014790_AbstractHttpClientDownloader.java&quot; title=&quot;AbstractHttpClientDownloader.java attached to HTTPCORE-653&quot;&gt;AbstractHttpClientDownloader.java&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt; &lt;br/&gt;
 &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/13014789/13014789_LimitedAsyncResponseConsumer.java&quot; title=&quot;LimitedAsyncResponseConsumer.java attached to HTTPCORE-653&quot;&gt;LimitedAsyncResponseConsumer.java&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt; &lt;/p&gt;

&lt;p&gt;And I found a similar &lt;em&gt;processEvent&lt;/em&gt; in HttpAsyncClient 4.1.4, and it seems to be &lt;em&gt;CancelledKeyException&lt;/em&gt; is handled without shutting the reactor down.&lt;br/&gt;
HttpAsyncClient 4.1.4&lt;br/&gt;
 &lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/13014791/13014791_Screen+Shot+2020-11-06+at+00.05.00.png&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt; &lt;/p&gt;

&lt;p&gt;HttpClient 5.0.3&lt;br/&gt;
 &lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/13014788/13014788_Screen+Shot+2020-11-05+at+23.50.46.png&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt; &lt;/p&gt;

&lt;p&gt;Exception details&lt;br/&gt;
 &lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/13014782/13014782_Screen+Shot+2020-11-05+at+23.12.44.png&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt; &lt;br/&gt;
 &lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/13014783/13014783_Screen+Shot+2020-11-05+at+23.12.53.png&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt; &lt;/p&gt;

&lt;p&gt;Thank you very much.&lt;/p&gt;</description>
                <environment>linux</environment>
        <key id="13339038">HTTPCORE-653</key>
            <summary>CancelledKeyException Triggers Reactor to Shutdown</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="tudanmeng">Danmeng Tu</reporter>
                        <labels>
                    </labels>
                <created>Thu, 5 Nov 2020 15:19:49 +0000</created>
                <updated>Sun, 22 Nov 2020 10:07:54 +0000</updated>
                            <resolved>Thu, 5 Nov 2020 21:15:14 +0000</resolved>
                                    <version>5.0.2</version>
                                    <fixVersion>5.0.3</fixVersion>
                    <fixVersion>5.1-beta2</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="17226798" author="olegk" created="Thu, 5 Nov 2020 16:13:50 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tudanmeng&quot; class=&quot;user-hover&quot; rel=&quot;tudanmeng&quot;&gt;tudanmeng&lt;/a&gt;&#160;Shutdown of the reactor in case of a single cancelled channel looks wrong. I will look into it.&lt;/p&gt;

&lt;p&gt;Oleg&lt;/p&gt;</comment>
                            <comment id="17226989" author="jira-bot" created="Thu, 5 Nov 2020 21:06:42 +0000"  >&lt;p&gt;Commit 342f395fa5db5e67b9b258068698a13e37ab7fee in httpcomponents-core&apos;s branch refs/heads/5.0.x from Oleg Kalnichevski&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=httpcomponents-core.git;h=342f395&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=httpcomponents-core.git;h=342f395&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HTTPCORE-653&quot; title=&quot;CancelledKeyException Triggers Reactor to Shutdown&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HTTPCORE-653&quot;&gt;&lt;del&gt;HTTPCORE-653&lt;/del&gt;&lt;/a&gt;: CancelledKeyException triggers I/O reactor shutdown&lt;/p&gt;</comment>
                            <comment id="17226994" author="jira-bot" created="Thu, 5 Nov 2020 21:14:01 +0000"  >&lt;p&gt;Commit e67a509e3533d4b993f066ec97b5777f963e7d08 in httpcomponents-core&apos;s branch refs/heads/master from Oleg Kalnichevski&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=httpcomponents-core.git;h=e67a509&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=httpcomponents-core.git;h=e67a509&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HTTPCORE-653&quot; title=&quot;CancelledKeyException Triggers Reactor to Shutdown&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HTTPCORE-653&quot;&gt;&lt;del&gt;HTTPCORE-653&lt;/del&gt;&lt;/a&gt;: CancelledKeyException triggers I/O reactor shutdown&lt;/p&gt;</comment>
                            <comment id="17226995" author="olegk" created="Thu, 5 Nov 2020 21:15:14 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tudanmeng&quot; class=&quot;user-hover&quot; rel=&quot;tudanmeng&quot;&gt;tudanmeng&lt;/a&gt;&#160;Fixed in 5.0.x and master. Thank you so much for reporting it.&lt;/p&gt;

&lt;p&gt;Oleg&lt;/p&gt;</comment>
                            <comment id="17227403" author="tudanmeng" created="Fri, 6 Nov 2020 13:25:44 +0000"  >&lt;p&gt;Oleg, thanks for your quick responding, and I&apos;m really glad helping.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="13014790" name="AbstractHttpClientDownloader.java" size="8898" author="tudanmeng" created="Thu, 5 Nov 2020 15:53:34 +0000"/>
                            <attachment id="13014789" name="LimitedAsyncResponseConsumer.java" size="3725" author="tudanmeng" created="Thu, 5 Nov 2020 15:53:34 +0000"/>
                            <attachment id="13014782" name="Screen Shot 2020-11-05 at 23.12.44.png" size="729661" author="tudanmeng" created="Thu, 5 Nov 2020 15:16:36 +0000"/>
                            <attachment id="13014783" name="Screen Shot 2020-11-05 at 23.12.53.png" size="785114" author="tudanmeng" created="Thu, 5 Nov 2020 15:16:36 +0000"/>
                            <attachment id="13014788" name="Screen Shot 2020-11-05 at 23.50.46.png" size="241389" author="tudanmeng" created="Thu, 5 Nov 2020 15:51:01 +0000"/>
                            <attachment id="13014791" name="Screen Shot 2020-11-06 at 00.05.00.png" size="386370" author="tudanmeng" created="Thu, 5 Nov 2020 16:05:34 +0000"/>
                            <attachment id="13014784" name="threads_report.txt" size="76332" author="tudanmeng" created="Thu, 5 Nov 2020 15:16:24 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>7.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 1 week, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0kbh4:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>