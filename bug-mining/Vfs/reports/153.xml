<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:14:33 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[VFS-236] SmbFileObject throws NPE when used without authentication</title>
                <link>https://issues.apache.org/jira/browse/VFS-236</link>
                <project id="12310495" key="VFS">Commons VFS</project>
                    <description>&lt;p&gt;If you have a shared folder without authentication, SmbFileObject throws an NPE in method createSmbFile().&lt;/p&gt;

&lt;p&gt;Here is what I changed to get it to run:&lt;/p&gt;

&lt;p&gt;    private SmbFile createSmbFile(FileName fileName) throws MalformedURLException, SmbException, FileSystemException&lt;br/&gt;
    {&lt;br/&gt;
        SmbFileName smbFileName = (SmbFileName) fileName;&lt;/p&gt;

&lt;p&gt;        String path = smbFileName.getUriWithoutAuth();&lt;/p&gt;

&lt;p&gt;		UserAuthenticationData authData = null;&lt;br/&gt;
		SmbFile file;&lt;br/&gt;
		NtlmPasswordAuthentication auth;&lt;br/&gt;
		try&lt;br/&gt;
		{&lt;br/&gt;
			authData = UserAuthenticatorUtils.authenticate(getFileSystem().getFileSystemOptions(), SmbFileProvider.AUTHENTICATOR_TYPES);&lt;br/&gt;
			if (authData!=null) &lt;/p&gt;
{
				auth = new NtlmPasswordAuthentication(
					UserAuthenticatorUtils.toString(
						UserAuthenticatorUtils.getData(
							authData,
							UserAuthenticationData.DOMAIN,
							UserAuthenticatorUtils.toChar(smbFileName.getDomain()))),
					UserAuthenticatorUtils.toString(
						UserAuthenticatorUtils.getData(
							authData,
							UserAuthenticationData.USERNAME,
							UserAuthenticatorUtils.toChar(smbFileName.getUserName()))),
					UserAuthenticatorUtils.toString(
						UserAuthenticatorUtils.getData(
							authData,
							UserAuthenticationData.PASSWORD,
							UserAuthenticatorUtils.toChar(smbFileName.getPassword()))));
				file = new SmbFile(path, auth);
			}
&lt;p&gt; else &lt;/p&gt;
{
				auth=null;
				file = new SmbFile(path);
			}
&lt;p&gt;		}&lt;br/&gt;
		finally&lt;/p&gt;
		{
			UserAuthenticatorUtils.cleanup(authData);
		}

&lt;p&gt;		if (file.isDirectory() &amp;amp;&amp;amp; !file.toString().endsWith(&quot;/&quot;))&lt;br/&gt;
		{&lt;br/&gt;
			if (auth!=null) &lt;/p&gt;
{
				file = new SmbFile(path + &quot;/&quot;, auth);
			}
&lt;p&gt; else &lt;/p&gt;
{
				file = new SmbFile(path + &quot;/&quot;);
			}
&lt;p&gt;		}&lt;/p&gt;

&lt;p&gt;		return file;&lt;br/&gt;
    }&lt;/p&gt;</description>
                <environment></environment>
        <key id="12414155">VFS-236</key>
            <summary>SmbFileObject throws NPE when used without authentication</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="b.eckenfels">Bernd Eckenfels</assignee>
                                    <reporter username="mattcasters">Matt Casters</reporter>
                        <labels>
                    </labels>
                <created>Thu, 5 Feb 2009 23:06:53 +0000</created>
                <updated>Thu, 19 May 2016 18:25:34 +0000</updated>
                            <resolved>Sun, 12 Apr 2015 17:46:18 +0000</resolved>
                                    <version>Nightly Builds</version>
                                    <fixVersion>2.1</fixVersion>
                                        <due></due>
                            <votes>1</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="12706033" author="gerritcap" created="Tue, 5 May 2009 13:57:33 +0000"  >&lt;p&gt;Personally I think that this is a better solution:&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;
	&lt;ol&gt;
		&lt;li&gt;
		&lt;ol&gt;
			&lt;li&gt;Eclipse Workspace Patch 1.0&lt;br/&gt;
#P commons_vfs&lt;br/&gt;
Index: sandbox/src/main/java/org/apache/commons/vfs/provider/smb/SmbFileObject.java&lt;br/&gt;
===================================================================&lt;/li&gt;
		&lt;/ol&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;sandbox/src/main/java/org/apache/commons/vfs/provider/smb/SmbFileObject.java	(revision 771693)&lt;br/&gt;
+++ sandbox/src/main/java/org/apache/commons/vfs/provider/smb/SmbFileObject.java	(working copy)&lt;br/&gt;
@@ -82,22 +82,28 @@
 		{
 			authData = UserAuthenticatorUtils.authenticate(getFileSystem().getFileSystemOptions(), SmbFileProvider.AUTHENTICATOR_TYPES);
 
-			auth = new NtlmPasswordAuthentication(
-				UserAuthenticatorUtils.toString(
-					UserAuthenticatorUtils.getData(
-						authData,
-						UserAuthenticationData.DOMAIN,
-						UserAuthenticatorUtils.toChar(smbFileName.getDomain()))),
-				UserAuthenticatorUtils.toString(
-					UserAuthenticatorUtils.getData(
-						authData,
-						UserAuthenticationData.USERNAME,
-						UserAuthenticatorUtils.toChar(smbFileName.getUserName()))),
-				UserAuthenticatorUtils.toString(
-					UserAuthenticatorUtils.getData(
-						authData,
-						UserAuthenticationData.PASSWORD,
-						UserAuthenticatorUtils.toChar(smbFileName.getPassword()))));
+			String domain = UserAuthenticatorUtils.toString(
+				UserAuthenticatorUtils.getData(
+					authData,
+					UserAuthenticationData.DOMAIN,
+					UserAuthenticatorUtils.toChar(smbFileName.getDomain())));
+			
+			String username = UserAuthenticatorUtils.toString(
+				UserAuthenticatorUtils.getData(
+					authData,
+					UserAuthenticationData.USERNAME,
+					UserAuthenticatorUtils.toChar(smbFileName.getUserName())));
+			
+			String password = UserAuthenticatorUtils.toString(
+				UserAuthenticatorUtils.getData(
+					authData,
+					UserAuthenticationData.PASSWORD,
+					UserAuthenticatorUtils.toChar(smbFileName.getPassword())));
+			
+			auth = username == null ? NtlmPasswordAuthentication.ANONYMOUS : new NtlmPasswordAuthentication(
+				domain,
+				username,
+				password);
 
 			file = new SmbFile(path, auth);
 		}&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;
</comment>
                            <comment id="14489118" author="fiveo" created="Fri, 10 Apr 2015 07:54:06 +0000"  >&lt;p&gt;The difference of above solutions is finally just the different call of the constructor of the jcifs SmbFile class when the authentication is null:&lt;/p&gt;

&lt;p&gt;Solution A) new SmbFile(path);&lt;br/&gt;
Solution B) new SmbFile(path,  NtlmPasswordAuthentication.ANONYMOUS);&lt;/p&gt;

&lt;p&gt;While solution A) does not change the semantic of the SmbFile usage, just fixes the NullPointerException, solution B) does modify the usage of SmbFile. &lt;/p&gt;

&lt;p&gt;I would recommend to implement solution A) for fixing the NPE. If Solution B) is a change of the usage. SmbFile class offers the Constructor without auth.&lt;/p&gt;</comment>
                            <comment id="14491608" author="b.eckenfels" created="Sun, 12 Apr 2015 17:46:18 +0000"  >&lt;p&gt;Since this did not worked before the new behavior can be either GUEST or ANONYMOUS.&lt;/p&gt;

&lt;p&gt;The code looks best with just passing null to SmbFile (which internally will be a Guest login).&lt;/p&gt;

&lt;p&gt;If you need Anonymous access instead one would have to set up a ANONYMOUS=(&quot;&quot;\&quot;&quot;:&quot;&quot;) credential. I guess the later could not be done by purely using the URL syntax (but you could use the smb system properties).&lt;/p&gt;

&lt;p&gt;Committed in &lt;a href=&quot;http://svn.apache.org/r1673034&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/r1673034&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15291715" author="b.eckenfels" created="Thu, 19 May 2016 18:25:34 +0000"  >&lt;p&gt;Apache Commons VFS 2.1 has been released. It includes this (total 171) resolved issues.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>200287</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 26 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i14msv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>235158</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>