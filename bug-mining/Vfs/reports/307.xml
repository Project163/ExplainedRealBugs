<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:15:34 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[VFS-524] A URI with an IPv6 address can&apos;t be parsed correctly</title>
                <link>https://issues.apache.org/jira/browse/VFS-524</link>
                <project id="12310495" key="VFS">Commons VFS</project>
                    <description>&lt;p&gt;I am using apache commons vfs2 to read and download file in ipv6 enviroment, but it seems can&apos;t parse out ipv6 address correctly&lt;br/&gt;
The URI is just like:&lt;br/&gt;
&lt;a href=&quot;ftp://[2002:9ba:b4e:6:a052:5792:c0c9:2330]/test&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;ftp://[2002:9ba:b4e:6:a052:5792:c0c9:2330]/test&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;The error message:&lt;br/&gt;
Invalid absolute URI &quot;ftp://[2002:9ba:b4e:6:a052:5792:c0c9:2330]/test&quot;.&lt;/p&gt;

&lt;p&gt;Caused by : Expecting / to follow the hostname in URI &quot;ftp://[2002:9ba:b4e:6:a052:5792:c0c9:2330]/test&quot;.&lt;/p&gt;

&lt;p&gt;Deep into the code, I found the root cause is that HostFileNameParser&apos;s extractHostName can&apos;t parse out the host name correctly&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;/**
     * Extracts the hostname from a URI.  The scheme://userinfo@ part has
     * been removed.
     */
    protected String extractHostName(final StringBuilder name)
    {
        final int maxlen = name.length();
        int pos = 0;
        for (; pos &amp;lt; maxlen; pos++)
        {
            final char ch = name.charAt(pos);
            if (ch == &apos;/&apos; || ch == &apos;;&apos; || ch == &apos;?&apos; || ch == &apos;:&apos;
                || ch == &apos;@&apos; || ch == &apos;&amp;amp;&apos; || ch == &apos;=&apos; || ch == &apos;+&apos;
                || ch == &apos;$&apos; || ch == &apos;,&apos;)
            {
                break;
            }
        }
        if (pos == 0)
        {
            return null;
        }

        final String hostname = name.substring(0, pos);
        name.delete(0, pos);
        return hostname;
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;From the code, we are able to know it will  parse out the host name by colon, but for ipv6, it will get a wrong host name&lt;/p&gt;

&lt;p&gt;There is the same problem with the other protocol like sftp and cifs&lt;/p&gt;</description>
                <environment></environment>
        <key id="12712738">VFS-524</key>
            <summary>A URI with an IPv6 address can&apos;t be parsed correctly</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="zhihaoli">Alex</reporter>
                        <labels>
                    </labels>
                <created>Wed, 7 May 2014 02:04:13 +0000</created>
                <updated>Wed, 25 Oct 2023 11:03:41 +0000</updated>
                            <resolved>Wed, 25 Oct 2023 11:03:01 +0000</resolved>
                                    <version>2.0</version>
                                    <fixVersion>2.10.0</fixVersion>
                                        <due></due>
                            <votes>1</votes>
                                    <watches>7</watches>
                                                                                                                <comments>
                            <comment id="13991482" author="zhihaoli" created="Wed, 7 May 2014 02:19:38 +0000"  >&lt;p&gt;I make some fix in order to the method into parse out ipv6, for ftp, it works well&lt;br/&gt;
So could I fix  FtpFileNameParser(SftpFileNameParser, SmbFileNameParser ) to  overrides the extractHostName of HostFileNameParser? I am not sure whether it will bring in some problems else?&lt;br/&gt;
Thanks a lot&lt;/p&gt;
</comment>
                            <comment id="14494042" author="fiveo" created="Tue, 14 Apr 2015 12:29:34 +0000"  >&lt;p&gt;The  RFC 3986 &lt;a href=&quot;http://tools.ietf.org/html/rfc3986&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;RFC 3986&lt;/a&gt;  defines the usage of IPv6 adresses inside of brackets []. &lt;/p&gt;

&lt;p&gt;The following change of the method adds the extraction of IPv6 adresses:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-style: solid;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;border-bottom-style: solid;&quot;&gt;&lt;b&gt;HostFileNameParser.java&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;protected&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; extractHostName(&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; StringBuilder name)
    {
        &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; maxlen = name.length();
        &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; startPos = 0;
        &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; endPos = 0;
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt;(name.charAt(0) == &lt;span class=&quot;code-quote&quot;&gt;&apos;[&apos;&lt;/span&gt;){
            &lt;span class=&quot;code-comment&quot;&gt;//RFC-3986 IPv6address  
&lt;/span&gt;            startPos = 1;
            &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (; endPos &amp;lt; maxlen; endPos++)
            {            
                &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;char&lt;/span&gt; ch = name.charAt(endPos);
                &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (ch == &lt;span class=&quot;code-quote&quot;&gt;&apos;]&apos;&lt;/span&gt;)
                {
                    &lt;span class=&quot;code-keyword&quot;&gt;break&lt;/span&gt;;
                }
            }     
        }
        &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
            &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (; endPos &amp;lt; maxlen; endPos++)
            {            
                &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;char&lt;/span&gt; ch = name.charAt(endPos);
                &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (ch == &lt;span class=&quot;code-quote&quot;&gt;&apos;/&apos;&lt;/span&gt; || ch == &lt;span class=&quot;code-quote&quot;&gt;&apos;;&apos;&lt;/span&gt; || ch == &lt;span class=&quot;code-quote&quot;&gt;&apos;?&apos;&lt;/span&gt; || ch == &lt;span class=&quot;code-quote&quot;&gt;&apos;:&apos;&lt;/span&gt;
                    || ch == &lt;span class=&quot;code-quote&quot;&gt;&apos;@&apos;&lt;/span&gt; || ch == &lt;span class=&quot;code-quote&quot;&gt;&apos;&amp;amp;&apos;&lt;/span&gt; || ch == &lt;span class=&quot;code-quote&quot;&gt;&apos;=&apos;&lt;/span&gt; || ch == &lt;span class=&quot;code-quote&quot;&gt;&apos;+&apos;&lt;/span&gt;
                    || ch == &lt;span class=&quot;code-quote&quot;&gt;&apos;$&apos;&lt;/span&gt; || ch == &lt;span class=&quot;code-quote&quot;&gt;&apos;,&apos;&lt;/span&gt;)
                {
                    &lt;span class=&quot;code-keyword&quot;&gt;break&lt;/span&gt;;
                }
            }
        }
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (endPos == 0)
        {
            &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;
        }

        &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; hostname = name.substring(startPos, endPos);
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt;(name.charAt(0) == &lt;span class=&quot;code-quote&quot;&gt;&apos;[&apos;&lt;/span&gt;){
            &lt;span class=&quot;code-comment&quot;&gt;//RFC-3986 IPv6address remove &lt;span class=&quot;code-quote&quot;&gt;&apos;]&apos;&lt;/span&gt; at the end
&lt;/span&gt;            name.delete(0, endPos+1);
        }
        &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt;
        {
            name.delete(0, endPos);
        }
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; hostname;
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Please add this feature of supporting IPv6 to the SVN or schedule this feature for a future release.&lt;/p&gt;</comment>
                            <comment id="14876467" author="simon04" created="Fri, 18 Sep 2015 21:27:28 +0000"  >&lt;p&gt;Updated patch to not break existing tests in &lt;tt&gt;GenericFileNameTestCase&lt;/tt&gt;. Plus, added one IPv6 test from the description.&lt;/p&gt;</comment>
                            <comment id="14905278" author="b.eckenfels" created="Wed, 23 Sep 2015 21:17:00 +0000"  >&lt;p&gt;I think parsing is only half the work, the URLs should also be created with []. This testcase here should work (using a named interface scope and a non-default port):&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;        name = (GenericFileName) urlParser.parseUri(&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;ftp:&lt;span class=&quot;code-comment&quot;&gt;//[2002:9ba:b4e:6:a052:5792:c0c9:2330%em4]:2222/test&quot;&lt;/span&gt;);
&lt;/span&gt;        assertEquals(&lt;span class=&quot;code-quote&quot;&gt;&quot;2002:9ba:b4e:6:a052:5792:c0c9:2330%em4&quot;&lt;/span&gt;, name.getHostName());
        assertEquals(2222, name.getPort());
        assertEquals(&lt;span class=&quot;code-quote&quot;&gt;&quot;ftp:&lt;span class=&quot;code-comment&quot;&gt;//[2002:9ba:b4e:6:a052:5792:c0c9:2330%em4]:2222/test&quot;&lt;/span&gt;, name.getURI());&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;getURI() could skip the brackets when it does not need port or scope, but I think adding it in all cases is better. I think it should not be returned by getHostName() (even when it makes the thing more complicated).&lt;/p&gt;</comment>
                            <comment id="14906921" author="simon04" created="Thu, 24 Sep 2015 20:10:56 +0000"  >&lt;p&gt;v3 also includes the brackets in &lt;tt&gt;name.getURI()&lt;/tt&gt;.&lt;/p&gt;</comment>
                            <comment id="16195950" author="sod" created="Sun, 8 Oct 2017 00:12:27 +0000"  >&lt;p&gt;Hi.&lt;br/&gt;
Version 2.2.1 &amp;amp; 2.2.2 did not list this issue as fixed in the readme. Is there an ETA? thanks&lt;/p&gt;</comment>
                            <comment id="16196175" author="garydgregory" created="Sun, 8 Oct 2017 15:43:39 +0000"  >&lt;p&gt;don&apos;t set version until the fix is in.&lt;/p&gt;</comment>
                            <comment id="16196179" author="garydgregory" created="Sun, 8 Oct 2017 15:45:29 +0000"  >&lt;p&gt;How about a fresh PR on Githubwith tests &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;I just pushed out version 2.2 but there is no reason not to have a 2.2.1 around the corner.&lt;/p&gt;</comment>
                            <comment id="16197650" author="sod" created="Mon, 9 Oct 2017 20:26:46 +0000"  >&lt;p&gt;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/thumbs_up.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; That will be great.&lt;/p&gt;</comment>
                            <comment id="16197676" author="garydgregory" created="Mon, 9 Oct 2017 20:47:05 +0000"  >&lt;p&gt;I just need a fresh PR &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="16725672" author="urkens_jp" created="Thu, 20 Dec 2018 08:51:21 +0000"  >&lt;p&gt;I am trying to setup an FTP connection to the IPv6 loopback address using commons-vfs2 version 2.2 and commons-net v3.6.&lt;/p&gt;

&lt;p&gt;I tried following URI&apos;S: [ftp://[::1]|ftp://[:1]] and [ftp://[0:0:0:0:0:0:0:1]|ftp://[::1]/] but I am allways getting the error:&lt;/p&gt;

&lt;p&gt;&#160;org.apache.commons.vfs2.FileSystemException: Invalid absolute URI &quot;[ftp://[0:0:0:0:0:0:0:1]|ftp://[::1]/]&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Isn&apos;t the fix present in v2.2 or am I missing something here?&lt;/p&gt;</comment>
                            <comment id="16725698" author="urkens_jp" created="Thu, 20 Dec 2018 09:16:39 +0000"  >&lt;p&gt;Ok, checked the v2.2 code and the fix isn&apos;t yet present.&lt;/p&gt;</comment>
                            <comment id="17779458" author="garydgregory" created="Wed, 25 Oct 2023 11:03:01 +0000"  >&lt;p&gt;In git master, thank you &lt;a href=&quot;https://github.com/fyudanov&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Fedor Yudanov&lt;/a&gt; for &lt;a href=&quot;https://github.com/apache/commons-vfs/pull/438&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/commons-vfs/pull/438&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12761198" name="VFS-524-v2.patch" size="3442" author="simon04" created="Fri, 18 Sep 2015 21:27:28 +0000"/>
                            <attachment id="12762223" name="VFS-524-v3.patch" size="3028" author="simon04" created="Thu, 24 Sep 2015 20:10:56 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>391054</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 2 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1vcp3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>391276</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>