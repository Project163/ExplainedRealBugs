<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:14:19 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[VFS-437] [FTP] StackOverFlowError getting the type of a directory with a symbolic link to a parent directory with the same name</title>
                <link>https://issues.apache.org/jira/browse/VFS-437</link>
                <project id="12310495" key="VFS">Commons VFS</project>
                    <description>&lt;p&gt;With the setting below, StackOverFlow exceptions occur and server crashes&lt;/p&gt;

&lt;p&gt;set the builder.setUserDirlsRoot (opt, true)&lt;/p&gt;

&lt;p&gt;Attept to pull with:&lt;br/&gt;
&lt;a href=&quot;ftp://root:password@ip:/Vol1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;ftp://root:password@ip:/Vol1&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Vol directory has the following info&lt;br/&gt;
lrwxrwxrwx  1 root root        5 Oct  5  2007 Vol1 -&amp;gt; /Vol1&lt;/p&gt;


&lt;p&gt;When it tries to look for the parent of the Vol1, it goes back to the same Vol1, which causes a infinite loop that eventually creates stackoverflow exception.&lt;/p&gt;

&lt;p&gt;The problem is inside the doGetType() method in FtpFileObject&lt;br/&gt;
    @Override&lt;br/&gt;
    protected FileType doGetType()&lt;br/&gt;
        throws Exception&lt;br/&gt;
    {&lt;br/&gt;
        // &lt;a href=&quot;https://issues.apache.org/jira/browse/VFS-210&quot; title=&quot;Wrapper-Mode VFS&quot; class=&quot;issue-link&quot; data-issue-key=&quot;VFS-210&quot;&gt;VFS-210&lt;/a&gt;&lt;br/&gt;
        synchronized (getFileSystem())&lt;br/&gt;
        {&lt;br/&gt;
            if (this.fileInfo == null)&lt;/p&gt;
            {
                getInfo(false);
            }

&lt;p&gt;            if (this.fileInfo == UNKNOWN)&lt;/p&gt;
            {
                return FileType.IMAGINARY;
            }
&lt;p&gt;            else if (this.fileInfo.isDirectory())&lt;/p&gt;
            {
                return FileType.FOLDER;
            }
&lt;p&gt;            else if (this.fileInfo.isFile())&lt;/p&gt;
            {
                return FileType.FILE;
            }
&lt;p&gt;            else if (this.fileInfo.isSymbolicLink())&lt;/p&gt;
            {
                return getLinkDestination().getType();
            }
&lt;p&gt;        }&lt;/p&gt;

&lt;p&gt;        throw new FileSystemException(&quot;vfs.provider.ftp/get-type.error&quot;, getName());&lt;br/&gt;
    }&lt;/p&gt;

&lt;p&gt;It will keep hitting the &quot;else if (this.fileinfo.isSymbolicLink())&quot; condition and the fileinfo displayed is always the Vol1 under root directory.&lt;/p&gt;

&lt;p&gt;Exception is shown below&lt;br/&gt;
java.lang.StackOverflowError&lt;br/&gt;
	at org.apache.commons.net.ftp.FTPFile.isDirectory(FTPFile.java:116)&lt;br/&gt;
	at org.apache.commons.vfs2.provider.ftp.FtpFileObject.doGetType(FtpFileObject.java:334)&lt;br/&gt;
	at org.apache.commons.vfs2.provider.AbstractFileObject.getType(AbstractFileObject.java:496)&lt;br/&gt;
	at org.apache.commons.vfs2.provider.ftp.FtpFileObject.doGetType(FtpFileObject.java:344)&lt;br/&gt;
	at org.apache.commons.vfs2.provider.AbstractFileObject.getType(AbstractFileObject.java:496)&lt;br/&gt;
	at org.apache.commons.vfs2.provider.ftp.FtpFileObject.doGetType(FtpFileObject.java:344)&lt;br/&gt;
	at org.apache.commons.vfs2.provider.AbstractFileObject.getType(AbstractFileObject.java:496)&lt;br/&gt;
	at org.apache.commons.vfs2.provider.ftp.FtpFileObject.doGetType(FtpFileObject.java:344)&lt;br/&gt;
	at org.apache.commons.vfs2.provider.AbstractFileObject.getType(AbstractFileObject.java:496)&lt;br/&gt;
	at org.apache.commons.vfs2.provider.ftp.FtpFileObject.doGetType(FtpFileObject.java:344)&lt;br/&gt;
	at org.apache.commons.vfs2.provider.AbstractFileObject.getType(AbstractFileObject.java:496)&lt;br/&gt;
	at org.apache.commons.vfs2.provider.ftp.FtpFileObject.doGetType(FtpFileObject.java:344)&lt;br/&gt;
	at org.apache.commons.vfs2.provider.AbstractFileObject.getType(AbstractFileObject.java:496)&lt;br/&gt;
	at org.apache.commons.vfs2.provider.ftp.FtpFileObject.doGetType(FtpFileObject.java:344)&lt;br/&gt;
	at org.apache.commons.vfs2.provider.AbstractFileObject.getType(AbstractFileObject.java:496)&lt;br/&gt;
	at org.apache.commons.vfs2.provider.ftp.FtpFileObject.doGetType(FtpFileObject.java:344)&lt;br/&gt;
	at org.apache.commons.vfs2.provider.AbstractFileObject.getType(AbstractFileObject.java:496)&lt;br/&gt;
	at org.apache.commons.vfs2.provider.ftp.FtpFileObject.doGetType(FtpFileObject.java:344)&lt;br/&gt;
	at org.apache.commons.vfs2.provider.AbstractFileObject.getType(AbstractFileObject.java:496)&lt;br/&gt;
	at org.apache.commons.vfs2.provider.ftp.FtpFileObject.doGetType(FtpFileObject.java:344)&lt;br/&gt;
	at org.apache.commons.vfs2.provider.AbstractFileObject.getType(AbstractFileObject.java:496)&lt;br/&gt;
	at org.apache.commons.vfs2.provider.ftp.FtpFileObject.doGetType(FtpFileObject.java:344)&lt;br/&gt;
	at org.apache.commons.vfs2.provider.AbstractFileObject.getType(AbstractFileObject.java:496)&lt;br/&gt;
	at org.apache.commons.vfs2.provider.ftp.FtpFileObject.doGetType(FtpFileObject.java:344)&lt;br/&gt;
	at org.apache.commons.vfs2.provider.AbstractFileObject.getType(AbstractFileObject.java:496)&lt;br/&gt;
	at org.apache.commons.vfs2.provider.ftp.FtpFileObject.doGetType(FtpFileObject.java:344)&lt;/p&gt;
</description>
                <environment>&lt;p&gt;java version &quot;1.7.0_02&quot;&lt;br/&gt;
Java(TM) SE Runtime Environment (build 1.7.0_02-b13)&lt;br/&gt;
Java HotSpot(TM) 64-Bit Server VM (build 22.0-b10, mixed mode)&lt;/p&gt;

&lt;p&gt;Linux version 2.6.18-238.el5 (mockbuild@builder10.centos.org) (gcc version 4.1.2 20080704 (Red Hat 4.1.2-48)) #1 SMP Thu Jan 13 15:51:15 EST 2011&lt;/p&gt;</environment>
        <key id="12607979">VFS-437</key>
            <summary>[FTP] StackOverFlowError getting the type of a directory with a symbolic link to a parent directory with the same name</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="jpowang">Jason</reporter>
                        <labels>
                    </labels>
                <created>Mon, 17 Sep 2012 23:40:05 +0000</created>
                <updated>Thu, 19 May 2016 18:26:10 +0000</updated>
                            <resolved>Sat, 6 Oct 2012 11:41:43 +0000</resolved>
                                    <version>2.0</version>
                                    <fixVersion>2.1</fixVersion>
                                        <due></due>
                            <votes>2</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="13458338" author="garydgregory" created="Wed, 19 Sep 2012 01:09:16 +0000"  >&lt;p&gt;Hello Jason,&lt;/p&gt;

&lt;p&gt;Can you give more details please?&lt;/p&gt;

&lt;p&gt;This works for me:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Vfs437TestCase
{

    /**
     * On Windows 7:
     * 
     * md /Vol1
     * 
     * cd /Vol1
     * 
     * mklink /D Vol1 \Vol1
     * 
     * @&lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; FileSystemException
     */
    @Test
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void test() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; FileSystemException
    {
        FileSystemOptions opts = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; FileSystemOptions();
        FtpFileSystemConfigBuilder.getInstance().setUserDirIsRoot(opts, &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;);
        &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; FileObject file = VFS.getManager().resolveFile(&lt;span class=&quot;code-quote&quot;&gt;&quot;ftp:&lt;span class=&quot;code-comment&quot;&gt;//test:zing1@localhost/Vol1&quot;&lt;/span&gt;, opts);
&lt;/span&gt;        &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(file);
        &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (FileObject child : file.getChildren())
        {
            &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(child);
            &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (FileObject child2 : child.getChildren())
            {
                &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(child2);
            }
        }
    }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I am using FileZilla as a test server locally.&lt;/p&gt;</comment>
                            <comment id="13458342" author="jpowang" created="Wed, 19 Sep 2012 01:14:56 +0000"  >&lt;p&gt;The ftp server should be linux system&lt;/p&gt;</comment>
                            <comment id="13458990" author="garydgregory" created="Wed, 19 Sep 2012 19:12:59 +0000"  >&lt;p&gt;I have VirtualBox already installed with Ubuntu 12 and I can ping it from my Windows 7 host.&lt;/p&gt;

&lt;p&gt;Can you provide instructions to duplicate your issue please?&lt;/p&gt;</comment>
                            <comment id="13459111" author="jpowang" created="Wed, 19 Sep 2012 21:23:40 +0000"  >&lt;p&gt;On the remote ftp server (I used CentOs distribution)&lt;br/&gt;
1. Create a Voll directory under file system so the path is &quot;/Vol&quot;&lt;br/&gt;
2. Create a Vol1 directory under the user&apos;s home directory so the path is &quot;/user/Vol1&quot;&lt;br/&gt;
3. Make the Vol1 under step two soft link to the Vol1 in step one, so &quot;ls -al&quot; would show the following &lt;br/&gt;
        &quot;lrwxrwxrwx 1 root root 5 Oct 5 2007 Vol1 -&amp;gt; /Vol1&quot;&lt;/p&gt;

&lt;p&gt;I used the test case you&apos;ve written, I can actually reproduce the exception also. The only difference is my ftp server is not a localhost.&lt;/p&gt;

&lt;p&gt;    @Test&lt;br/&gt;
    public void test() throws FileSystemException&lt;br/&gt;
    {&lt;br/&gt;
        FileSystemOptions opts = new FileSystemOptions();&lt;br/&gt;
        FtpFileSystemConfigBuilder.getInstance().setUserDirIsRoot(opts, true);&lt;br/&gt;
        final FileObject file = VFS.getManager().resolveFile(&quot;ftp://test1:test1@remoteIp/Vol1&quot;, opts);&lt;br/&gt;
        System.out.println(file);&lt;br/&gt;
        for (FileObject child : file.getChildren())&lt;br/&gt;
        {&lt;br/&gt;
            System.out.println(child);&lt;br/&gt;
            for (FileObject child2 : child.getChildren())&lt;/p&gt;
            {
                System.out.println(child2);
            }
&lt;p&gt;        }&lt;br/&gt;
    }&lt;/p&gt;

&lt;p&gt;I reproduce this issue with scenario of Windows 7 and Linux(Centos) trying to access a Linux ftp remote server.&lt;/p&gt;</comment>
                            <comment id="13466076" author="denniszhu" created="Sat, 29 Sep 2012 01:26:09 +0000"  >&lt;p&gt;There is more to this problem:&lt;/p&gt;

&lt;p&gt;It will arise when the FTP&apos;s local_root directory is also set to Vol1&lt;/p&gt;

&lt;p&gt;so in the vsftpd.conf file, we have &quot;local_root=/Vol1/&quot;&lt;/p&gt;

&lt;p&gt;Inside this /Vol1/ folder, we have a symlink called Vol1 that links back to /Vol1&lt;/p&gt;

&lt;p&gt;This causes the getInfo( boolean flush) method in FtpFileObject to have problems at the lines:&lt;/p&gt;

&lt;p&gt;        if ( parent != null ) &lt;/p&gt;
{
            newFileInfo = parent.getChildFile( UriParser.decode( getName().getBaseName() ), flush );
        }

&lt;p&gt;Parent here is supposed to be &quot;/&quot; and we are looking for child file &quot;/Vol1&quot;, but getChildFile calls doGetChildren which instantiantiates another FtpClient object, and this object is looking at the local_root /Vol1 instead of looking at the &quot;/&quot; directory.&lt;/p&gt;</comment>
                            <comment id="13467637" author="garydgregory" created="Tue, 2 Oct 2012 12:11:07 +0000"  >&lt;p&gt;I&apos;m willing to take a look at this but I do not want to spend 1/2 day setting it up. Can you provide step by step instructions on creating the test bed?&lt;/p&gt;</comment>
                            <comment id="13467966" author="denniszhu" created="Tue, 2 Oct 2012 18:52:28 +0000"  >&lt;p&gt;Here it is:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/VFS-437&quot; title=&quot;[FTP] StackOverFlowError getting the type of a directory with a symbolic link to a parent directory with the same name&quot; class=&quot;issue-link&quot; data-issue-key=&quot;VFS-437&quot;&gt;&lt;del&gt;VFS-437&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;1. Configure the remote FTP server&apos;s local_root to be a certain directory by modifying vsftpd.conf, for example &quot;local_root=/Vol1&quot;. This will cause all users who log in to this FTP server to see &quot;/Vol1&quot; as the root &quot;/&quot; folder.&lt;br/&gt;
2. Navigate to this local_root folder, and create a symbolic link with the same name that links to this folder. For example, we create a symlink also called &quot;Vol1&quot; that links to &quot;/Vol1&quot;, so that &quot;Vol1 -&amp;gt; /Vol1&quot;.&lt;br/&gt;
3. Use VFS to access this FTP server using a URL such as &quot;ftp://test:password@ftp.example.server/Vol1&quot;. For example, using the following test code:&lt;/p&gt;

&lt;p&gt;@Test&lt;br/&gt;
    public void test()&lt;br/&gt;
        throws FileSystemException {&lt;br/&gt;
        FileSystemOptions opts = new FileSystemOptions();&lt;br/&gt;
        FtpFileSystemConfigBuilder.getInstance().setUserDirIsRoot( opts, true );&lt;br/&gt;
        final FileObject file = VFS.getManager().resolveFile( &quot;ftp://test:password@ftp.example.server/Vol1&quot;, opts );&lt;br/&gt;
        System.out.println( file );&lt;br/&gt;
        for ( FileObject child : file.getChildren() ) {&lt;br/&gt;
            System.out.println( child );&lt;br/&gt;
            if ( child.getType() == FileType.FOLDER )&lt;br/&gt;
                for ( FileObject child2 : child.getChildren() ) &lt;/p&gt;
{
                    System.out.println( child2 );
                }
&lt;p&gt;        }&lt;br/&gt;
    }&lt;/p&gt;

&lt;p&gt;This will reproduce the StackOverFlow Exception because our URL tries to resolve the directory &quot;/Vol1&quot;, thinking that our root directory is the &quot;/&quot; directory. However, what actually happens is that our URL actually will try to resolve &quot;/Vol1/Vol1&quot; on the FTP file system. This is due to the fact that we have setUserDirIsRoot( opts, true ). Now, since resolving &quot;/Vol1&quot; will bring us back to the &quot;Vol1&quot; symbolic link itself and not the actual directory, we&apos;ll be infinitely trying to perform doGetType() in FtpFileObject on the symbolic link.&lt;/p&gt;

&lt;p&gt;In summary, the StackOverFlow is guaranteed to happen when the user is in relative path mode (setUserDirIsRoot to true) and using a symbolic link to access a file or directory, with the same name as the symbolic link, on the file system that he doesn&apos;t have access to. This is an edge case that is only likly to happen when the user sets up these kind of symbolic links that he&apos;s not supposed to use in an FTP server. However, this case WILL crash applications when it comes up.&lt;/p&gt;</comment>
                            <comment id="13468041" author="danttran" created="Tue, 2 Oct 2012 20:26:26 +0000"  >&lt;p&gt;Hi Gary, &lt;/p&gt;

&lt;p&gt;Dennis, Jason, and I work on the same team.  Other way to reproduce this issue is &lt;/p&gt;

&lt;p&gt;  1. use anonymous account on a linux ftp server &lt;br/&gt;
  2. On your anonymous workspace create a symlink ( Vol1 to /Vol1 ). The ftp&apos;ls command should show&lt;/p&gt;

&lt;p&gt;     ftp&amp;gt; ls -al&lt;br/&gt;
     200 PORT command successful. Consider using PASV.&lt;br/&gt;
     150 Here comes the directory listing.&lt;br/&gt;
     drwxr-xr-x    4 0        0            4096 Oct 02 19:02 .&lt;br/&gt;
     drwxr-xr-x    4 0        0            4096 Oct 02 19:02 ..&lt;br/&gt;
     lrwxrwxrwx    1 0        0               5 Oct 02 19:02 Vol1 -&amp;gt; /Vol1&lt;br/&gt;
     drwxr-xr-x    2 0        0            4096 Sep 03  2009 pub&lt;br/&gt;
     &lt;del&gt;rw-r&lt;/del&gt;&lt;del&gt;r&lt;/del&gt;-    1 0        0             224 Nov 09  2004 welcome.msg&lt;br/&gt;
     226 Directory send OK.&lt;br/&gt;
     ftp:385 bytes received in 0.00Seconds 385000.00Kbytes/sec.&lt;/p&gt;


&lt;p&gt;  3. Use vfs-maven-plugin to issue the following command ( provided that you have access to codehaus&apos;s snapshot repository&lt;/p&gt;


&lt;p&gt;     mvn vfs:list -DsourceId=ftp.anonymous -Dsource=&lt;a href=&quot;ftp://your.ftp.host/Vol1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;ftp://your.ftp.host/Vol1&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;This is very edgecase, however, it crashes our server application.  &lt;/p&gt;</comment>
                            <comment id="13468268" author="denniszhu" created="Wed, 3 Oct 2012 02:34:58 +0000"  >&lt;p&gt;Here&apos;s a proposed fix for the problem in FtpFileObject.java under the method doGetType() inside the if block that checks for the type of this.fileInfo:&lt;/p&gt;

&lt;p&gt;else if ( this.fileInfo.isSymbolicLink() ) {&lt;br/&gt;
                FileObject linkDest = getLinkDestination();&lt;/p&gt;

&lt;p&gt;                // &lt;a href=&quot;https://issues.apache.org/jira/browse/VFS-437&quot; title=&quot;[FTP] StackOverFlowError getting the type of a directory with a symbolic link to a parent directory with the same name&quot; class=&quot;issue-link&quot; data-issue-key=&quot;VFS-437&quot;&gt;&lt;del&gt;VFS-437&lt;/del&gt;&lt;/a&gt;: We need to check if the symbolic link links back to the symbolic link itself&lt;br/&gt;
                if ( linkDest.getName().getPathDecoded().equals( this.getName().getPathDecoded() ) ) &lt;/p&gt;
{

                    // If the symbolic link links back to itself, treat it as an imaginary file to prevent following
                    // this link. If the user tries to access the link as a file or directory, the user will end up with
                    // a FileSystemException warning that the file cannot be accessed. This is to prevent the infinite
                    // call back to doGetType() to prevent the StackOverFlow
                    return FileType.IMAGINARY;

                }
&lt;p&gt;                return linkDest.getType();&lt;br/&gt;
            }&lt;/p&gt;

&lt;p&gt;The idea here is that if we detect this kind of a bad symbolic link, we return the type of the link as a &quot;FileType.IMAGINARY&quot; file, which means it cannot be accessed by any means through VFS. This will prevent the user from trying to open the link or navigate into the link as a directory.&lt;/p&gt;

&lt;p&gt;svndiff report and patch file comparing FtpFileObject.java is also attached&lt;/p&gt;</comment>
                            <comment id="13468694" author="danttran" created="Wed, 3 Oct 2012 17:39:21 +0000"  >&lt;p&gt;Proposed solution ( from Dennis )&lt;/p&gt;</comment>
                            <comment id="13469352" author="garydgregory" created="Thu, 4 Oct 2012 13:04:06 +0000"  >&lt;p&gt;The patch does break existing unit tests, which is nice &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;Can you test this for longer circular dependencies?&lt;/p&gt;

&lt;p&gt;This patch looks to work for Vol1 -&amp;gt; /Vol1, but what about for Vol1 -&amp;gt; ... -&amp;gt; /Vol1?&lt;/p&gt;</comment>
                            <comment id="13469408" author="garydgregory" created="Thu, 4 Oct 2012 14:35:39 +0000"  >&lt;p&gt;Also, what about:&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;doGetChildren()&lt;/li&gt;
	&lt;li&gt;doGetContentSize()&lt;/li&gt;
	&lt;li&gt;doGetLastModifiedTime()&lt;/li&gt;
	&lt;li&gt;doListChildrenResolved()&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;?&lt;/p&gt;</comment>
                            <comment id="13469475" author="garydgregory" created="Thu, 4 Oct 2012 16:14:02 +0000"  >&lt;p&gt;Use the same kind of logic as the first patch but fore more methods.&lt;/p&gt;</comment>
                            <comment id="13469476" author="garydgregory" created="Thu, 4 Oct 2012 16:15:09 +0000"  >&lt;p&gt;I&apos;ve attached a new patch that implements the same kind of logic but for more methods. &lt;/p&gt;

&lt;p&gt;Can you test this in your set up?&lt;/p&gt;

&lt;p&gt;Also, do you see doGetChildren() as needing to check for circular links as well?&lt;/p&gt;</comment>
                            <comment id="13470857" author="denniszhu" created="Sat, 6 Oct 2012 01:57:33 +0000"  >&lt;p&gt;I just tested again with my setup with your patch applied and the code seems to work: if the link is circular, then we return it as imaginary and does not allow the user to access it. Furthermore, I tested it on the case of Vol1 -&amp;gt; ... -&amp;gt; /Vol1 and ultimately VFS will evaluate through all the links and arrive at the same /Vol1 and catch the imaginary file and refuse to access the link. My setup was such that Vol1 will link to vol1, vol1 then links to vol3, then vol3 ultimately links back to /Vol1, so Vol1 -&amp;gt; vol1 -&amp;gt; vol3 -&amp;gt; /Vol1.&lt;/p&gt;

&lt;p&gt;Now, I am able to see a problem if I have this setup:&lt;/p&gt;

&lt;p&gt;Vol1 -&amp;gt; Vol3&lt;br/&gt;
Vol3 -&amp;gt; Vol1&lt;/p&gt;

&lt;p&gt;That WILL cause a StackOverFlowError. However, even though the user is allowed to setup that link, the Linux file system itself refuses to evaluate those links with the error &quot;-bash: cd: Vol1: Too many levels of symbolic links&quot;.&lt;/p&gt;

&lt;p&gt;As far as checking for circular links in doGetChildren(), I don&apos;t think there is a need because before we ever hit the doGetChildren code, we&apos;ll always hit the doGetType code first. Having a circular link check inside doGetChildren would be redundant. &lt;/p&gt;</comment>
                            <comment id="13470977" author="garydgregory" created="Sat, 6 Oct 2012 11:41:43 +0000"  >&lt;p&gt;commit -m &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/VFS-437&quot; title=&quot;[FTP] StackOverFlowError getting the type of a directory with a symbolic link to a parent directory with the same name&quot; class=&quot;issue-link&quot; data-issue-key=&quot;VFS-437&quot;&gt;&lt;del&gt;VFS-437&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;FTP&amp;#93;&lt;/span&gt; StackOverFlowError getting the type of a directory with a symbolic link to a parent directory with the same name.&quot; C:/svn/org/apache/commons/trunks-proper/vfs/src/changes/changes.xml C:/svn/org/apache/commons/trunks-proper/vfs/core/src/main/java/org/apache/commons/vfs2/provider/ftp/FtpFileObject.java&lt;br/&gt;
    Sending        C:/svn/org/apache/commons/trunks-proper/vfs/core/src/main/java/org/apache/commons/vfs2/provider/ftp/FtpFileObject.java&lt;br/&gt;
    Sending        C:/svn/org/apache/commons/trunks-proper/vfs/src/changes/changes.xml&lt;br/&gt;
    Transmitting file data ...&lt;br/&gt;
    Committed revision 1395004.&lt;/p&gt;</comment>
                            <comment id="15291814" author="b.eckenfels" created="Thu, 19 May 2016 18:26:10 +0000"  >&lt;p&gt;Apache Commons VFS 2.1 has been released. It includes this (total 171) resolved issues.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12547564" name="VFS-437.diff" size="1457" author="danttran" created="Wed, 3 Oct 2012 17:39:21 +0000"/>
                            <attachment id="12547775" name="vfs-437-v2-gg.diff" size="4027" author="ggregory" created="Thu, 4 Oct 2012 16:14:02 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>239983</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 26 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i00v8v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2994</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>