<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:15:11 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[VFS-753] NumberFormatException in SftpFileSystem::getUId</title>
                <link>https://issues.apache.org/jira/browse/VFS-753</link>
                <project id="12310495" key="VFS">Commons VFS</project>
                    <description>&lt;p&gt;When calling&#160;FileSystemManager::resolveFile(...) connecting to a specific sftp server a NumberFormat exception is thrown and a FileObject is not returned.&lt;/p&gt;

&lt;p&gt;When the&#160;SftpFileSystem constructor is called there is a call to&#160;detectExecDisabled which in turn calls getUid.&#160;SftpFileSystem::getUId assumes that executeCommand(...) will always return non zero (the channel exit status) for execution failure.&lt;/p&gt;

&lt;p&gt;In the case of the sftp server that we are connecting to, the channel exit status remains zero however the returned buffer contains the string &quot;This server does not provide shell access, only SFTP. Goodbye.&quot;. This causes a NumberFormatException in getUId.&lt;/p&gt;

&lt;p&gt;This behaviour does not occur in version 2.4.1&lt;/p&gt;

&lt;p&gt;Here is the relevent snippet from the stack trace:&lt;br/&gt;
java.lang.NumberFormatException: For input string: &quot;This server does not provide shell access, only SFTP. Goodbye.&quot;&lt;/p&gt;

&lt;p&gt;&#160;&#160;&#160;&#160;&#160;&#160; at java.lang.NumberFormatException.forInputString(NumberFormatException.java:65)&lt;/p&gt;

&lt;p&gt;&#160;&#160;&#160;&#160;&#160;&#160; at java.lang.Integer.parseInt(Integer.java:580)&lt;/p&gt;

&lt;p&gt;&#160;&#160;&#160;&#160;&#160;&#160; at java.lang.Integer.parseInt(Integer.java:615)&lt;/p&gt;

&lt;p&gt;&#160;&#160;&#160;&#160;&#160;&#160; at org.apache.commons.vfs2.provider.sftp.SftpFileSystem.getUId(SftpFileSystem.java:281)&lt;/p&gt;

&lt;p&gt;&#160;&#160;&#160;&#160;&#160;&#160; at org.apache.commons.vfs2.provider.sftp.SftpFileSystem.detectExecDisabled(SftpFileSystem.java:344)&lt;/p&gt;

&lt;p&gt;&#160;&#160;&#160;&#160;&#160;&#160; at org.apache.commons.vfs2.provider.sftp.SftpFileSystem.&amp;lt;init&amp;gt;(SftpFileSystem.java:94)&lt;/p&gt;

&lt;p&gt;&#160;&#160;&#160;&#160;&#160;&#160; at org.apache.commons.vfs2.provider.sftp.SftpFileProvider.doCreateFileSystem(SftpFileProvider.java:93)&lt;/p&gt;

&lt;p&gt;&#160;&#160;&#160;&#160;&#160;&#160; at org.apache.commons.vfs2.provider.AbstractOriginatingFileProvider.getFileSystem(AbstractOriginatingFileProvider.java:93)&lt;/p&gt;

&lt;p&gt;&#160;&#160;&#160;&#160;&#160;&#160; at org.apache.commons.vfs2.provider.AbstractOriginatingFileProvider.findFile(AbstractOriginatingFileProvider.java:72)&lt;/p&gt;

&lt;p&gt;&#160;&#160;&#160;&#160;&#160;&#160; at org.apache.commons.vfs2.provider.AbstractOriginatingFileProvider.findFile(AbstractOriginatingFileProvider.java:56)&lt;/p&gt;

&lt;p&gt;&#160;&#160;&#160;&#160;&#160;&#160; at org.apache.commons.vfs2.impl.DefaultFileSystemManager.resolveFile(DefaultFileSystemManager.java:717)&lt;/p&gt;

&lt;p&gt;&#160;&#160;&#160;&#160;&#160;&#160; at org.apache.commons.vfs2.impl.DefaultFileSystemManager.resolveFile(DefaultFileSystemManager.java:654)&lt;/p&gt;

&lt;p&gt;&#160;&#160;&#160;&#160;&#160;&#160; at com.shortcuts.lambda.google_reserve_sftp.util.SFTPUtil.ls(SFTPUtil.java:68)&lt;/p&gt;

&lt;p&gt;&#160;&#160;&#160;&#160;&#160;&#160; at com.shortcuts.lambda.google_reserve_sftp.util.SFTPUtilTest.testConnectToGoogle(SFTPUtilTest.java:48)&lt;/p&gt;

&lt;p&gt;&#160;&#160;&#160;&#160;&#160;&#160; at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;/p&gt;</description>
                <environment></environment>
        <key id="13283379">VFS-753</key>
            <summary>NumberFormatException in SftpFileSystem::getUId</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="JohnWebb">John Webb</reporter>
                        <labels>
                    </labels>
                <created>Wed, 5 Feb 2020 06:12:30 +0000</created>
                <updated>Fri, 7 Feb 2020 03:18:11 +0000</updated>
                            <resolved>Wed, 5 Feb 2020 15:40:18 +0000</resolved>
                                    <version>2.5.0</version>
                                    <fixVersion>2.7.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="17030747" author="garydgregory" created="Wed, 5 Feb 2020 15:40:18 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=JohnWebb&quot; class=&quot;user-hover&quot; rel=&quot;JohnWebb&quot;&gt;JohnWebb&lt;/a&gt;&lt;br/&gt;
Thank you for your report.&lt;/p&gt;

&lt;p&gt;Please try the latest from git or a snapshot build from&#160;&lt;a href=&quot;https://repository.apache.org/content/repositories/snapshots/org/apache/commons/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://repository.apache.org/content/repositories/snapshots/org/apache/commons/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17031078" author="johnwebb" created="Wed, 5 Feb 2020 22:07:10 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ggregory&quot; class=&quot;user-hover&quot; rel=&quot;ggregory&quot;&gt;ggregory&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I suspect the fix has the side effect of telling the class that execution is enabled on the server when it isn&apos;t. detectExecDisabled relies on a throw to return true however the fix simply catches and logs. I obviously don&apos;t know the code as well as you but worry that a false negative from&#160;detectExecDisabled may lead to undesirable behaviour.&lt;/p&gt;</comment>
                            <comment id="17031103" author="garydgregory" created="Wed, 5 Feb 2020 22:52:03 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=JohnWebb&quot; class=&quot;user-hover&quot; rel=&quot;JohnWebb&quot;&gt;JohnWebb&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I adjusted the test in &lt;tt&gt;detectExecDisabled&lt;/tt&gt; to check for a return value from&#160;&lt;tt&gt;getUId()&lt;/tt&gt; that corresponds to the internal call having failed.&lt;/p&gt;

&lt;p&gt;If you can think of something better, please provide a PR on GitHub. If you think this fix is still too risky, I can back it out.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17031112" author="johnwebb" created="Wed, 5 Feb 2020 23:11:24 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ggregory&quot; class=&quot;user-hover&quot; rel=&quot;ggregory&quot;&gt;ggregory&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;The new test in&#160;&lt;tt&gt;detectExecDisabled&lt;/tt&gt;&#160;looks good to me.&lt;/p&gt;

&lt;p&gt;Thanks for you help mate.&lt;/p&gt;</comment>
                            <comment id="17031182" author="garydgregory" created="Thu, 6 Feb 2020 01:39:35 +0000"  >&lt;p&gt;YW. Please make a note here if this addresses your issue in your actual testing (beyond reviewing in the code.)&lt;/p&gt;</comment>
                            <comment id="17032078" author="johnwebb" created="Fri, 7 Feb 2020 03:11:26 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ggregory&quot; class=&quot;user-hover&quot; rel=&quot;ggregory&quot;&gt;ggregory&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I downloaded&#160;commons-vfs2-2.6.1-20200205.225124-2.jar and built and tested against this. Works fine.&lt;/p&gt;</comment>
                            <comment id="17032082" author="garydgregory" created="Fri, 7 Feb 2020 03:16:12 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=JohnWebb&quot; class=&quot;user-hover&quot; rel=&quot;JohnWebb&quot;&gt;JohnWebb&lt;/a&gt;&#160;Great, thanks for the update.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 40 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0b5zs:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>