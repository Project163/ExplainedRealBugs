{"url":"https://api.github.com/repos/catchorg/Catch2/issues/1110","repository_url":"https://api.github.com/repos/catchorg/Catch2","labels_url":"https://api.github.com/repos/catchorg/Catch2/issues/1110/labels{/name}","comments_url":"https://api.github.com/repos/catchorg/Catch2/issues/1110/comments","events_url":"https://api.github.com/repos/catchorg/Catch2/issues/1110/events","html_url":"https://github.com/catchorg/Catch2/issues/1110","id":275126608,"node_id":"MDU6SXNzdWUyNzUxMjY2MDg=","number":1110,"title":"Make Catch_global_namespace_dummy a complete type","user":{"login":"AndrewPaxie","id":11957419,"node_id":"MDQ6VXNlcjExOTU3NDE5","avatar_url":"https://avatars.githubusercontent.com/u/11957419?v=4","gravatar_id":"","url":"https://api.github.com/users/AndrewPaxie","html_url":"https://github.com/AndrewPaxie","followers_url":"https://api.github.com/users/AndrewPaxie/followers","following_url":"https://api.github.com/users/AndrewPaxie/following{/other_user}","gists_url":"https://api.github.com/users/AndrewPaxie/gists{/gist_id}","starred_url":"https://api.github.com/users/AndrewPaxie/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AndrewPaxie/subscriptions","organizations_url":"https://api.github.com/users/AndrewPaxie/orgs","repos_url":"https://api.github.com/users/AndrewPaxie/repos","events_url":"https://api.github.com/users/AndrewPaxie/events{/privacy}","received_events_url":"https://api.github.com/users/AndrewPaxie/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":513089868,"node_id":"MDU6TGFiZWw1MTMwODk4Njg=","url":"https://api.github.com/repos/catchorg/Catch2/labels/Possible%20bug","name":"Possible bug","color":"fbca04","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2017-11-19T02:31:00Z","updated_at":"2017-11-19T13:48:49Z","closed_at":"2017-11-19T13:48:39Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Description\r\n\r\nCompile the unit tests for the [Trompeloeil](https://github.com/rollbear/trompeloeil) mock object library,\r\nin this particular combination of C++ Standard Library and compiler,\r\n\r\n**Operating system**: Ubuntu 17.10 (Artful Aardvark)\r\n**Compiler**: `g++-7` (from package `g++-7 7.2.0-8ubuntu3`)\r\n**Standard C++ Library**: `libc++` (from package `libc++-dev:amd64 3.9.1-3`)\r\n**Catch version**: v2.0.1\r\n\r\n**Expected result**: The unit tests compile and pass.\r\n\r\n**Actual result**: The compilation fails with an error message,\r\n```\r\n/usr/include/c++/v1/type_traits:2928:50:\r\nerror: invalid use of incomplete type ‘struct Catch_global_namespace_dummy’\r\n   decltype(__is_constructible_test(declval<_Tp>(), declval<_Args>()...))\r\n            ~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n```\r\n\r\nOther combinations that fail: any other supported version of `g++` with `libc++`.\r\n\r\nOther combinations that succeed:\r\n- Any supported version of `g++` with `libstd++-v3`.\r\n- Any supported version of `clang++` with `libstdc++-v3`.\r\n- Any supported version of `clang++` with `libc++`.\r\n\r\n### Steps to reproduce\r\n\r\n```\r\n# Assume packages g++-7, libc++-dev are installed\r\n\r\n$ mkdir trompeloeil-scratch\r\n$ git clone https://github.com/AndrewPaxie/trompeloeil trompeloeil-scratch\r\n$ cd trompeloeil-scratch\r\n$ git checkout c++11\r\n\r\n$ wget https://raw.githubusercontent.com/catchorg/Catch2/v2.0.1/single_include/catch.hpp\r\n\r\n$ g++-7 -std=c++14 -nostdinc++ \\\r\n-isystem/usr/include/c++/v1 \\\r\n-ftemplate-backtrace-limit=0 \\\r\n-Wall -Wextra -Wpedantic -Wshadow \\\r\n-I . -I ./include \\\r\n-o compiling_tests \\\r\ntest/compiling_tests.cpp test/compiling_tests_11.cpp test/compiling_tests_14.cpp \\\r\n-nodefaultlibs -lc++ -lc++abi -lm -lc -lgcc_s -lgcc\r\n```\r\n\r\n### Extra information\r\n\r\n#### Supposed cause\r\n\r\nIn `include/internal/catch_tostring.h` there is the code\r\n```Cpp\r\n// We need a dummy global operator<< so we can bring it into Catch namespace later\r\nstruct Catch_global_namespace_dummy;\r\nstd::ostream& operator<<(std::ostream&, Catch_global_namespace_dummy);\r\n\r\nnamespace Catch {\r\n    // Bring in operator<< from global namespace into Catch namespace\r\n    using ::operator<<;\r\n```\r\n\r\n#### Suggested fix\r\n\r\nWhen `Catch_global_namespace_dummy` is changed to\r\n```Cpp\r\nstruct Catch_global_namespace_dummy {};\r\n```\r\nthe Trompeloeil unit test code compiles with success.\r\n","closed_by":{"login":"horenmar","id":9026413,"node_id":"MDQ6VXNlcjkwMjY0MTM=","avatar_url":"https://avatars.githubusercontent.com/u/9026413?v=4","gravatar_id":"","url":"https://api.github.com/users/horenmar","html_url":"https://github.com/horenmar","followers_url":"https://api.github.com/users/horenmar/followers","following_url":"https://api.github.com/users/horenmar/following{/other_user}","gists_url":"https://api.github.com/users/horenmar/gists{/gist_id}","starred_url":"https://api.github.com/users/horenmar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/horenmar/subscriptions","organizations_url":"https://api.github.com/users/horenmar/orgs","repos_url":"https://api.github.com/users/horenmar/repos","events_url":"https://api.github.com/users/horenmar/events{/privacy}","received_events_url":"https://api.github.com/users/horenmar/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/catchorg/Catch2/issues/1110/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/catchorg/Catch2/issues/1110/timeline","performed_via_github_app":null,"state_reason":"completed"}