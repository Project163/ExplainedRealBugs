[{"url":"https://api.github.com/repos/catchorg/Catch2/issues/comments/1295042606","html_url":"https://github.com/catchorg/Catch2/issues/2555#issuecomment-1295042606","issue_url":"https://api.github.com/repos/catchorg/Catch2/issues/2555","id":1295042606,"node_id":"IC_kwDOABA2rM5NMMgu","user":{"login":"horenmar","id":9026413,"node_id":"MDQ6VXNlcjkwMjY0MTM=","avatar_url":"https://avatars.githubusercontent.com/u/9026413?v=4","gravatar_id":"","url":"https://api.github.com/users/horenmar","html_url":"https://github.com/horenmar","followers_url":"https://api.github.com/users/horenmar/followers","following_url":"https://api.github.com/users/horenmar/following{/other_user}","gists_url":"https://api.github.com/users/horenmar/gists{/gist_id}","starred_url":"https://api.github.com/users/horenmar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/horenmar/subscriptions","organizations_url":"https://api.github.com/users/horenmar/orgs","repos_url":"https://api.github.com/users/horenmar/repos","events_url":"https://api.github.com/users/horenmar/events{/privacy}","received_events_url":"https://api.github.com/users/horenmar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-10-28T14:05:02Z","updated_at":"2022-10-28T14:05:02Z","body":"I looked into this a bit -> it should be fixable, but the fix is going to be annoying because it will require adding bunch of code conditional on C++20.","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/catchorg/Catch2/issues/comments/1295042606/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"horenmar","id":9026413,"node_id":"MDQ6VXNlcjkwMjY0MTM=","avatar_url":"https://avatars.githubusercontent.com/u/9026413?v=4","gravatar_id":"","url":"https://api.github.com/users/horenmar","html_url":"https://github.com/horenmar","followers_url":"https://api.github.com/users/horenmar/followers","following_url":"https://api.github.com/users/horenmar/following{/other_user}","gists_url":"https://api.github.com/users/horenmar/gists{/gist_id}","starred_url":"https://api.github.com/users/horenmar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/horenmar/subscriptions","organizations_url":"https://api.github.com/users/horenmar/orgs","repos_url":"https://api.github.com/users/horenmar/repos","events_url":"https://api.github.com/users/horenmar/events{/privacy}","received_events_url":"https://api.github.com/users/horenmar/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":7692018415,"node_id":"LE_lADOABA2rM5U_SRuzwAAAAHKeuLv","url":"https://api.github.com/repos/catchorg/Catch2/issues/events/7692018415","actor":{"login":"horenmar","id":9026413,"node_id":"MDQ6VXNlcjkwMjY0MTM=","avatar_url":"https://avatars.githubusercontent.com/u/9026413?v=4","gravatar_id":"","url":"https://api.github.com/users/horenmar","html_url":"https://github.com/horenmar","followers_url":"https://api.github.com/users/horenmar/followers","following_url":"https://api.github.com/users/horenmar/following{/other_user}","gists_url":"https://api.github.com/users/horenmar/gists{/gist_id}","starred_url":"https://api.github.com/users/horenmar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/horenmar/subscriptions","organizations_url":"https://api.github.com/users/horenmar/orgs","repos_url":"https://api.github.com/users/horenmar/repos","events_url":"https://api.github.com/users/horenmar/events{/privacy}","received_events_url":"https://api.github.com/users/horenmar/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2022-10-28T14:05:08Z","label":{"name":"Bug","color":"e99695"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/catchorg/Catch2/issues/comments/1295410387","html_url":"https://github.com/catchorg/Catch2/issues/2555#issuecomment-1295410387","issue_url":"https://api.github.com/repos/catchorg/Catch2/issues/2555","id":1295410387,"node_id":"IC_kwDOABA2rM5NNmTT","user":{"login":"vsaulue","id":34475300,"node_id":"MDQ6VXNlcjM0NDc1MzAw","avatar_url":"https://avatars.githubusercontent.com/u/34475300?v=4","gravatar_id":"","url":"https://api.github.com/users/vsaulue","html_url":"https://github.com/vsaulue","followers_url":"https://api.github.com/users/vsaulue/followers","following_url":"https://api.github.com/users/vsaulue/following{/other_user}","gists_url":"https://api.github.com/users/vsaulue/gists{/gist_id}","starred_url":"https://api.github.com/users/vsaulue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vsaulue/subscriptions","organizations_url":"https://api.github.com/users/vsaulue/orgs","repos_url":"https://api.github.com/users/vsaulue/repos","events_url":"https://api.github.com/users/vsaulue/events{/privacy}","received_events_url":"https://api.github.com/users/vsaulue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-10-28T20:00:15Z","updated_at":"2022-10-28T20:01:26Z","body":"From what I've seen, compilers & standard libraries abuse the fact that literal `0` can be interpreted as a pointer value during overload resolution, to prevent users from comparing `std::strong_ordering` to any other int value.\r\n\r\n```c++\r\nvoid f(std::nullptr_t);\r\n\r\nint main(int argc, char** argv) {\r\n  f(0); // correct\r\n  f(1); // compiler error\r\n  f(argc); // compiler error\r\n}\r\n```\r\n\r\nI'm not familiar with Catch2's internals (I just had a quick look at it today), but it might be possible to also abuse this feature to enable the decomposer to detect a literal `0`, and generate an appropriate comparison . Here's a [proof of concept on godbolt](https://godbolt.org/z/s6oz3Wvrv).\r\n\r\nIt would be much more generic, in case people use this \"0 to pointer\" trick outside the standard library. It doesn't require conditionals on C++20 nor an exhaustive list of classes having such unconventional comparison operators. This trick seems to work on Clang, g++ and MSVC for now at least.\r\n\r\nOf course it's assuming that the literal zero detector works flawlessly (I can't really tell. This is dark magic for me, I just took the implementation from Clang's source code). If it can match other expressions, it could cause quite a few bugs.","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/catchorg/Catch2/issues/comments/1295410387/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"vsaulue","id":34475300,"node_id":"MDQ6VXNlcjM0NDc1MzAw","avatar_url":"https://avatars.githubusercontent.com/u/34475300?v=4","gravatar_id":"","url":"https://api.github.com/users/vsaulue","html_url":"https://github.com/vsaulue","followers_url":"https://api.github.com/users/vsaulue/followers","following_url":"https://api.github.com/users/vsaulue/following{/other_user}","gists_url":"https://api.github.com/users/vsaulue/gists{/gist_id}","starred_url":"https://api.github.com/users/vsaulue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vsaulue/subscriptions","organizations_url":"https://api.github.com/users/vsaulue/orgs","repos_url":"https://api.github.com/users/vsaulue/repos","events_url":"https://api.github.com/users/vsaulue/events{/privacy}","received_events_url":"https://api.github.com/users/vsaulue/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/catchorg/Catch2/issues/comments/1296289494","html_url":"https://github.com/catchorg/Catch2/issues/2555#issuecomment-1296289494","issue_url":"https://api.github.com/repos/catchorg/Catch2/issues/2555","id":1296289494,"node_id":"IC_kwDOABA2rM5NQ87W","user":{"login":"horenmar","id":9026413,"node_id":"MDQ6VXNlcjkwMjY0MTM=","avatar_url":"https://avatars.githubusercontent.com/u/9026413?v=4","gravatar_id":"","url":"https://api.github.com/users/horenmar","html_url":"https://github.com/horenmar","followers_url":"https://api.github.com/users/horenmar/followers","following_url":"https://api.github.com/users/horenmar/following{/other_user}","gists_url":"https://api.github.com/users/horenmar/gists{/gist_id}","starred_url":"https://api.github.com/users/horenmar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/horenmar/subscriptions","organizations_url":"https://api.github.com/users/horenmar/orgs","repos_url":"https://api.github.com/users/horenmar/repos","events_url":"https://api.github.com/users/horenmar/events{/privacy}","received_events_url":"https://api.github.com/users/horenmar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-10-30T15:53:42Z","updated_at":"2022-10-30T15:53:42Z","body":"This actually came up in the lib-ext mailing list. There is no 100% fool-proof way to detect literal 0, which is why comparing orderings with anything that is not literal 0 is UB (ill-formed cannot be standardized without new language features).\r\n\r\nI poked around a bit, and different stdlibs currently perform the check with different strictness -> e.g. MSVC's `strong_ordering` can be compared with `nullptr`, while libstdc++'s cannot be compared with `NULL`, because it is defined as `0L`, which is not compatible with `int`. The difference mainly seems to come down to how costly are they willing to make the cost - MSVC's trick is just using `nullptr_t` as the unspecified type, without further TMP, because 0 converts to nullptr, while other integer constants do not. And if the user passes in nullptr, well that's where library-UB comes in and it is the user's fault.\r\n\r\n\r\nI also poked around with the implementation, and I am considering using the zero detection trick, but I have misgivings about it's compilation costs, as it will add a bunch of overloads and TMP to all assertions. It is possible that it will be hidden behind C++20 switch anyway, to avoid imposing the costs on everyone.","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/catchorg/Catch2/issues/comments/1296289494/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"horenmar","id":9026413,"node_id":"MDQ6VXNlcjkwMjY0MTM=","avatar_url":"https://avatars.githubusercontent.com/u/9026413?v=4","gravatar_id":"","url":"https://api.github.com/users/horenmar","html_url":"https://github.com/horenmar","followers_url":"https://api.github.com/users/horenmar/followers","following_url":"https://api.github.com/users/horenmar/following{/other_user}","gists_url":"https://api.github.com/users/horenmar/gists{/gist_id}","starred_url":"https://api.github.com/users/horenmar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/horenmar/subscriptions","organizations_url":"https://api.github.com/users/horenmar/orgs","repos_url":"https://api.github.com/users/horenmar/repos","events_url":"https://api.github.com/users/horenmar/events{/privacy}","received_events_url":"https://api.github.com/users/horenmar/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/catchorg/Catch2/issues/comments/1296306297","html_url":"https://github.com/catchorg/Catch2/issues/2555#issuecomment-1296306297","issue_url":"https://api.github.com/repos/catchorg/Catch2/issues/2555","id":1296306297,"node_id":"IC_kwDOABA2rM5NRBB5","user":{"login":"horenmar","id":9026413,"node_id":"MDQ6VXNlcjkwMjY0MTM=","avatar_url":"https://avatars.githubusercontent.com/u/9026413?v=4","gravatar_id":"","url":"https://api.github.com/users/horenmar","html_url":"https://github.com/horenmar","followers_url":"https://api.github.com/users/horenmar/followers","following_url":"https://api.github.com/users/horenmar/following{/other_user}","gists_url":"https://api.github.com/users/horenmar/gists{/gist_id}","starred_url":"https://api.github.com/users/horenmar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/horenmar/subscriptions","organizations_url":"https://api.github.com/users/horenmar/orgs","repos_url":"https://api.github.com/users/horenmar/repos","events_url":"https://api.github.com/users/horenmar/events{/privacy}","received_events_url":"https://api.github.com/users/horenmar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-10-30T17:16:41Z","updated_at":"2022-10-30T17:16:41Z","body":"Also I don't see a way to extend the detector hack to handle `0 < (1 <=> 2)`, because when the `LhsExpr` is being instantiated, we have no idea what is going to be on the right hand side, and can't easily distinguish between needing to try implicit conversion, or capturing proper `int`, and I don't see a way to craft an overload set that handles this properly.\r\n\r\n","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/catchorg/Catch2/issues/comments/1296306297/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"horenmar","id":9026413,"node_id":"MDQ6VXNlcjkwMjY0MTM=","avatar_url":"https://avatars.githubusercontent.com/u/9026413?v=4","gravatar_id":"","url":"https://api.github.com/users/horenmar","html_url":"https://github.com/horenmar","followers_url":"https://api.github.com/users/horenmar/followers","following_url":"https://api.github.com/users/horenmar/following{/other_user}","gists_url":"https://api.github.com/users/horenmar/gists{/gist_id}","starred_url":"https://api.github.com/users/horenmar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/horenmar/subscriptions","organizations_url":"https://api.github.com/users/horenmar/orgs","repos_url":"https://api.github.com/users/horenmar/repos","events_url":"https://api.github.com/users/horenmar/events{/privacy}","received_events_url":"https://api.github.com/users/horenmar/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":7741208258,"node_id":"REFE_lADOABA2rM5U_SRuzwAAAAHNaXbC","url":"https://api.github.com/repos/catchorg/Catch2/issues/events/7741208258","actor":{"login":"horenmar","id":9026413,"node_id":"MDQ6VXNlcjkwMjY0MTM=","avatar_url":"https://avatars.githubusercontent.com/u/9026413?v=4","gravatar_id":"","url":"https://api.github.com/users/horenmar","html_url":"https://github.com/horenmar","followers_url":"https://api.github.com/users/horenmar/followers","following_url":"https://api.github.com/users/horenmar/following{/other_user}","gists_url":"https://api.github.com/users/horenmar/gists{/gist_id}","starred_url":"https://api.github.com/users/horenmar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/horenmar/subscriptions","organizations_url":"https://api.github.com/users/horenmar/orgs","repos_url":"https://api.github.com/users/horenmar/repos","events_url":"https://api.github.com/users/horenmar/events{/privacy}","received_events_url":"https://api.github.com/users/horenmar/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"369e95d46d3429c8c7800074ccd811be721e6593","commit_url":"https://api.github.com/repos/catchorg/Catch2/commits/369e95d46d3429c8c7800074ccd811be721e6593","created_at":"2022-11-04T14:23:42Z","performed_via_github_app":null},{"id":7743113913,"node_id":"CE_lADOABA2rM5U_SRuzwAAAAHNhoq5","url":"https://api.github.com/repos/catchorg/Catch2/issues/events/7743113913","actor":{"login":"horenmar","id":9026413,"node_id":"MDQ6VXNlcjkwMjY0MTM=","avatar_url":"https://avatars.githubusercontent.com/u/9026413?v=4","gravatar_id":"","url":"https://api.github.com/users/horenmar","html_url":"https://github.com/horenmar","followers_url":"https://api.github.com/users/horenmar/followers","following_url":"https://api.github.com/users/horenmar/following{/other_user}","gists_url":"https://api.github.com/users/horenmar/gists{/gist_id}","starred_url":"https://api.github.com/users/horenmar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/horenmar/subscriptions","organizations_url":"https://api.github.com/users/horenmar/orgs","repos_url":"https://api.github.com/users/horenmar/repos","events_url":"https://api.github.com/users/horenmar/events{/privacy}","received_events_url":"https://api.github.com/users/horenmar/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"closed","commit_id":"ec59cd8736b7ee8fcd69c76c71c2a0b72293b00c","commit_url":"https://api.github.com/repos/catchorg/Catch2/commits/ec59cd8736b7ee8fcd69c76c71c2a0b72293b00c","created_at":"2022-11-04T18:36:10Z","state_reason":null,"performed_via_github_app":null},{"id":11644587303,"node_id":"REFE_lADOABA2rM5U_SRuzwAAAAK2Ek0n","url":"https://api.github.com/repos/catchorg/Catch2/issues/events/11644587303","actor":{"login":"nicramage","id":6319714,"node_id":"MDQ6VXNlcjYzMTk3MTQ=","avatar_url":"https://avatars.githubusercontent.com/u/6319714?v=4","gravatar_id":"","url":"https://api.github.com/users/nicramage","html_url":"https://github.com/nicramage","followers_url":"https://api.github.com/users/nicramage/followers","following_url":"https://api.github.com/users/nicramage/following{/other_user}","gists_url":"https://api.github.com/users/nicramage/gists{/gist_id}","starred_url":"https://api.github.com/users/nicramage/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nicramage/subscriptions","organizations_url":"https://api.github.com/users/nicramage/orgs","repos_url":"https://api.github.com/users/nicramage/repos","events_url":"https://api.github.com/users/nicramage/events{/privacy}","received_events_url":"https://api.github.com/users/nicramage/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"ec59cd8736b7ee8fcd69c76c71c2a0b72293b00c","commit_url":"https://api.github.com/repos/nicramage/Catch2/commits/ec59cd8736b7ee8fcd69c76c71c2a0b72293b00c","created_at":"2024-01-30T16:40:47Z","performed_via_github_app":null}]