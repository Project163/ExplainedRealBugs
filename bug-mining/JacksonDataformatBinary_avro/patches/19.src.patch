diff --git a/avro/pom.xml b/avro/pom.xml
index 71b14bad..37eb21c1 100644
--- a/avro/pom.xml
+++ b/avro/pom.xml
@@ -47,7 +47,7 @@ abstractions.
     <dependency>
       <groupId>org.apache.avro</groupId>
       <artifactId>avro</artifactId>
-      <version>1.8.2</version>
+      <version>1.11.3</version>
     </dependency>
 
     <!-- and for testing we need logback -->
diff --git a/avro/src/main/java/com/fasterxml/jackson/dataformat/avro/schema/AvroSchemaHelper.java b/avro/src/main/java/com/fasterxml/jackson/dataformat/avro/schema/AvroSchemaHelper.java
index 007e2efc..00f0592f 100644
--- a/avro/src/main/java/com/fasterxml/jackson/dataformat/avro/schema/AvroSchemaHelper.java
+++ b/avro/src/main/java/com/fasterxml/jackson/dataformat/avro/schema/AvroSchemaHelper.java
@@ -108,7 +108,9 @@ public abstract class AvroSchemaHelper
         //   NOTE: was reverted in 2.8.8, but is enabled for Jackson 2.9.
         Class<?> enclosing = cls.getEnclosingClass();
         if (enclosing != null) {
-            return enclosing.getName() + "$";
+            // 23-Aug-2024: Changed as per [dataformats-binary#167] 
+            // Enclosing class may also be nested
+            return enclosing.getName().replace('$', '.');
         }
         Package pkg = cls.getPackage();
         return (pkg == null) ? "" : pkg.getName();
@@ -351,6 +353,8 @@ public abstract class AvroSchemaHelper
             if (namespace == null) {
                 return name;
             }
+            // 23-Aug-2024: [dataformats-binary#167] Still needed for backwards-compatibility
+            // with schemas that use dollar sign for nested classes (Apache Avro before 1.9)
             final int len = namespace.length();
             if (namespace.charAt(len-1) == '$') {
                 return namespace + name;
@@ -441,13 +445,25 @@ public abstract class AvroSchemaHelper
             //     Check if this is a nested class
             // 19-Sep-2020, tatu: This is a horrible, horribly inefficient and all-around
             //    wrong mechanism. To be abolished if possible.
-            final String nestedClassName = key.nameWithSeparator('$');
-            try {
-                Class.forName(nestedClassName);
-                return nestedClassName;
-            } catch (ClassNotFoundException e) {
-                // Could not find a nested class, must be a regular class
-                return key.nameWithSeparator('.');
+            // 23-Aug-2024:[dataformats-binary#167] Based on SpecificData::getClass
+            //   from Apache Avro. Initially assume that namespace is a Java package
+            StringBuilder sb = new StringBuilder(key.nameWithSeparator('.'));
+            int lastDot = sb.length();
+            while (true) {
+                try {
+                    // Try to resolve the class
+                    String className = sb.toString();
+                    Class.forName(className);
+                    return className;
+                } catch (ClassNotFoundException e) {
+                    // Class does not exist - perhaps last dot is actually a nested class
+                    lastDot = sb.lastIndexOf(".", lastDot);
+                    if (lastDot == -1) {
+                        // No more dots so we are unable to resolve, should we throw an exception?
+                        return key.nameWithSeparator('.');
+                    }
+                    sb.setCharAt(lastDot, '$');
+                }
             }
         }
     }
diff --git a/avro/src/test/java/com/fasterxml/jackson/dataformat/avro/annotation/AvroNamespaceTest.java b/avro/src/test/java/com/fasterxml/jackson/dataformat/avro/annotation/AvroNamespaceTest.java
index fe4639f4..ce3160cc 100644
--- a/avro/src/test/java/com/fasterxml/jackson/dataformat/avro/annotation/AvroNamespaceTest.java
+++ b/avro/src/test/java/com/fasterxml/jackson/dataformat/avro/annotation/AvroNamespaceTest.java
@@ -23,6 +23,15 @@ public class AvroNamespaceTest {
     @AvroNamespace("EnumWithAvroNamespaceAnnotation.namespace")
     enum EnumWithAvroNamespaceAnnotation {FOO, BAR;}
 
+    static class Foo {
+        static class Bar {
+            static class ClassWithMultipleNestingLevels {
+            }
+
+            enum EnumWithMultipleNestingLevels {FOO, BAR;}
+        }
+    }
+
     @Test
     public void class_without_AvroNamespace_test() throws Exception {
         // GIVEN
@@ -35,7 +44,7 @@ public class AvroNamespaceTest {
 
         // THEN
         assertThat(actualSchema.getNamespace())
-                .isEqualTo("com.fasterxml.jackson.dataformat.avro.annotation.AvroNamespaceTest$");
+                .isEqualTo("com.fasterxml.jackson.dataformat.avro.annotation.AvroNamespaceTest");
     }
 
     @Test
@@ -53,6 +62,21 @@ public class AvroNamespaceTest {
                 .isEqualTo("ClassWithAvroNamespaceAnnotation.namespace");
     }
 
+    @Test
+    public void class_with_multiple_nesting_levels_test() throws Exception {
+        // GIVEN
+        AvroMapper mapper = new AvroMapper();
+        AvroSchemaGenerator gen = new AvroSchemaGenerator();
+
+        // WHEN
+        mapper.acceptJsonFormatVisitor(Foo.Bar.ClassWithMultipleNestingLevels.class, gen);
+        Schema actualSchema = gen.getGeneratedSchema().getAvroSchema();
+
+        // THEN
+        assertThat(actualSchema.getNamespace())
+                .isEqualTo("com.fasterxml.jackson.dataformat.avro.annotation.AvroNamespaceTest.Foo.Bar");
+    }
+
     @Test
     public void enum_without_AvroNamespace_test() throws Exception {
         // GIVEN
@@ -65,7 +89,7 @@ public class AvroNamespaceTest {
 
         // THEN
         assertThat(actualSchema.getNamespace())
-                .isEqualTo("com.fasterxml.jackson.dataformat.avro.annotation.AvroNamespaceTest$");
+                .isEqualTo("com.fasterxml.jackson.dataformat.avro.annotation.AvroNamespaceTest");
     }
 
     @Test
@@ -83,4 +107,18 @@ public class AvroNamespaceTest {
                 .isEqualTo("EnumWithAvroNamespaceAnnotation.namespace");
     }
 
+    @Test
+    public void enum_with_multiple_nesting_levels_test() throws Exception {
+        // GIVEN
+        AvroMapper mapper = new AvroMapper();
+        AvroSchemaGenerator gen = new AvroSchemaGenerator();
+
+        // WHEN
+        mapper.acceptJsonFormatVisitor(Foo.Bar.EnumWithMultipleNestingLevels.class, gen);
+        Schema actualSchema = gen.getGeneratedSchema().getAvroSchema();
+
+        // THEN
+        assertThat(actualSchema.getNamespace())
+                .isEqualTo("com.fasterxml.jackson.dataformat.avro.annotation.AvroNamespaceTest.Foo.Bar");
+    }
 }
diff --git a/avro/src/test/java/com/fasterxml/jackson/dataformat/avro/interop/annotations/AvroAliasTest.java b/avro/src/test/java/com/fasterxml/jackson/dataformat/avro/interop/annotations/AvroAliasTest.java
index 2ce2e43c..357f5641 100644
--- a/avro/src/test/java/com/fasterxml/jackson/dataformat/avro/interop/annotations/AvroAliasTest.java
+++ b/avro/src/test/java/com/fasterxml/jackson/dataformat/avro/interop/annotations/AvroAliasTest.java
@@ -15,7 +15,7 @@ import static org.assertj.core.api.Assertions.assertThat;
 
 public class AvroAliasTest extends InteropTestBase {
 
-    @AvroAlias(alias = "Employee", space = "com.fasterxml.jackson.dataformat.avro.AvroTestBase$")
+    @AvroAlias(alias = "Employee", space = "com.fasterxml.jackson.dataformat.avro.AvroTestBase")
     public static class NewEmployee {
 
         public String name;
@@ -40,7 +40,7 @@ public class AvroAliasTest extends InteropTestBase {
         public AliasedNameEmployee boss;
     }
 
-    @AvroAlias(alias = "Size", space = "com.fasterxml.jackson.dataformat.avro.AvroTestBase$")
+    @AvroAlias(alias = "Size", space = "com.fasterxml.jackson.dataformat.avro.AvroTestBase")
     public enum NewSize {
         SMALL,
         LARGE;
