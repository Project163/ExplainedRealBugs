diff --git a/junit-vintage-engine/src/main/java/org/junit/vintage/engine/discovery/UniqueIdSelectorResolver.java b/junit-vintage-engine/src/main/java/org/junit/vintage/engine/discovery/UniqueIdSelectorResolver.java
index 028d8f544..711f1a7a9 100644
--- a/junit-vintage-engine/src/main/java/org/junit/vintage/engine/discovery/UniqueIdSelectorResolver.java
+++ b/junit-vintage-engine/src/main/java/org/junit/vintage/engine/discovery/UniqueIdSelectorResolver.java
@@ -11,14 +11,16 @@
 package org.junit.vintage.engine.discovery;
 
 import static java.lang.String.format;
+import static java.util.function.Predicate.isEqual;
 import static org.junit.vintage.engine.descriptor.VintageTestDescriptor.ENGINE_ID;
+import static org.junit.vintage.engine.descriptor.VintageTestDescriptor.SEGMENT_TYPE_RUNNER;
 
-import java.util.List;
 import java.util.Optional;
 import java.util.logging.Logger;
 
 import org.junit.platform.commons.util.ReflectionUtils;
 import org.junit.platform.engine.UniqueId;
+import org.junit.platform.engine.UniqueId.Segment;
 import org.junit.platform.engine.discovery.UniqueIdSelector;
 
 /**
@@ -41,12 +43,9 @@ class UniqueIdSelectorResolver extends DiscoverySelectorResolver<UniqueIdSelecto
 				() -> format("Unresolvable Unique ID (%s): Cannot resolve the engine's unique ID", uniqueId));
 		}
 		else {
-			uniqueId.getEngineId().ifPresent(engineId -> {
-				if (engineId.equals(ENGINE_ID)) {
-					String testClassName = determineTestClassName(uniqueId);
-					resolveIntoFilteredTestClass(testClassName, uniqueId, collector);
-				}
-			});
+			uniqueId.getEngineId().filter(isEqual(ENGINE_ID)).ifPresent(
+				engineId -> determineTestClassName(uniqueId).ifPresent(
+					testClassName -> resolveIntoFilteredTestClass(testClassName, uniqueId, collector)));
 		}
 	}
 
@@ -60,12 +59,16 @@ class UniqueIdSelectorResolver extends DiscoverySelectorResolver<UniqueIdSelecto
 		}
 	}
 
-	private String determineTestClassName(UniqueId uniqueId) {
-		List<UniqueId.Segment> segments = uniqueId.getSegments();
-		segments.remove(0); // drop engine node
-		UniqueId.Segment runnerSegment = segments.remove(0);
-		// TODO [#337] Check that it really is a runner segment
-		return runnerSegment.getValue();
+	private Optional<String> determineTestClassName(UniqueId uniqueId) {
+		Segment runnerSegment = uniqueId.getSegments().get(1); // skip engine node
+		if (SEGMENT_TYPE_RUNNER.equals(runnerSegment.getType())) {
+			return Optional.of(runnerSegment.getValue());
+		}
+		logger.warning(
+			() -> format("Unresolvable Unique ID (%s): Unique ID segment after engine segment must be of type \""
+					+ SEGMENT_TYPE_RUNNER + "\"",
+				uniqueId));
+		return Optional.empty();
 	}
 
 }
diff --git a/junit-vintage-engine/src/test/java/org/junit/vintage/engine/discovery/UniqueIdSelectorResolverTests.java b/junit-vintage-engine/src/test/java/org/junit/vintage/engine/discovery/UniqueIdSelectorResolverTests.java
index c21b77f40..31b611425 100644
--- a/junit-vintage-engine/src/test/java/org/junit/vintage/engine/discovery/UniqueIdSelectorResolverTests.java
+++ b/junit-vintage-engine/src/test/java/org/junit/vintage/engine/discovery/UniqueIdSelectorResolverTests.java
@@ -15,6 +15,7 @@ import static org.junit.jupiter.api.Assertions.assertEquals;
 import static org.junit.platform.commons.util.CollectionUtils.getOnlyElement;
 import static org.junit.platform.engine.discovery.DiscoverySelectors.selectUniqueId;
 import static org.junit.vintage.engine.VintageUniqueIdBuilder.engineId;
+import static org.junit.vintage.engine.descriptor.VintageTestDescriptor.ENGINE_ID;
 
 import java.util.Set;
 import java.util.logging.Level;
@@ -31,54 +32,64 @@ import org.junit.vintage.engine.VintageUniqueIdBuilder;
  */
 class UniqueIdSelectorResolverTests {
 
+	private RecordCollectingLogger logger = new RecordCollectingLogger();
+	private TestClassCollector collector = new TestClassCollector();
+
 	@Test
 	void logsWarningOnUnloadableTestClass() {
 		UniqueId uniqueId = VintageUniqueIdBuilder.uniqueIdForClass("foo.bar.UnknownClass");
-		RecordCollectingLogger logger = new RecordCollectingLogger();
 		UniqueIdSelector selector = selectUniqueId(uniqueId);
-		TestClassCollector collector = new TestClassCollector();
 
 		new UniqueIdSelectorResolver(logger).resolve(selector, collector);
 
-		Set<TestClassRequest> requests = collector.toRequests(c -> true);
-		assertThat(requests).isEmpty();
-		assertThat(logger.getLogRecords()).hasSize(1);
-		LogRecord logRecord = getOnlyElement(logger.getLogRecords());
-		assertEquals(Level.WARNING, logRecord.getLevel());
-		assertEquals("Unresolvable Unique ID (" + uniqueId + "): Unknown class foo.bar.UnknownClass",
-			logRecord.getMessage());
+		assertNoRequests();
+		assertLoggedWarning("Unresolvable Unique ID (" + uniqueId + "): Unknown class foo.bar.UnknownClass");
 	}
 
 	@Test
 	void logsWarningForEngineUniqueId() {
 		String uniqueId = engineId().toString();
-		RecordCollectingLogger logger = new RecordCollectingLogger();
 		UniqueIdSelector selector = selectUniqueId(uniqueId);
-		TestClassCollector collector = new TestClassCollector();
 
 		new UniqueIdSelectorResolver(logger).resolve(selector, collector);
 
-		Set<TestClassRequest> requests = collector.toRequests(c -> true);
-		assertThat(requests).isEmpty();
-		assertThat(logger.getLogRecords()).hasSize(1);
-		LogRecord logRecord = getOnlyElement(logger.getLogRecords());
-		assertEquals(Level.WARNING, logRecord.getLevel());
-		assertEquals("Unresolvable Unique ID (" + engineId() + "): Cannot resolve the engine's unique ID",
-			logRecord.getMessage());
+		assertNoRequests();
+		assertLoggedWarning("Unresolvable Unique ID (" + engineId() + "): Cannot resolve the engine's unique ID");
 	}
 
 	@Test
 	void ignoresUniqueIdsOfOtherEngines() {
 		UniqueId uniqueId = UniqueId.forEngine("someEngine");
-		RecordCollectingLogger logger = new RecordCollectingLogger();
 		UniqueIdSelector selector = selectUniqueId(uniqueId);
-		TestClassCollector collector = new TestClassCollector();
 
 		new UniqueIdSelectorResolver(logger).resolve(selector, collector);
 
+		assertNoRequests();
+		assertThat(logger.getLogRecords()).isEmpty();
+	}
+
+	@Test
+	void logsWarningOnUnexpectedTestDescriptor() {
+		UniqueId uniqueId = UniqueId.forEngine(ENGINE_ID).append("wrong-type", "foo:bar");
+		UniqueIdSelector selector = selectUniqueId(uniqueId);
+
+		new UniqueIdSelectorResolver(logger).resolve(selector, collector);
+
+		assertNoRequests();
+		assertLoggedWarning("Unresolvable Unique ID (" + uniqueId
+				+ "): Unique ID segment after engine segment must be of type \"runner\"");
+	}
+
+	private void assertLoggedWarning(String expectedMessage) {
+		assertThat(logger.getLogRecords()).hasSize(1);
+		LogRecord logRecord = getOnlyElement(logger.getLogRecords());
+		assertEquals(Level.WARNING, logRecord.getLevel());
+		assertEquals(expectedMessage, logRecord.getMessage());
+	}
+
+	private void assertNoRequests() {
 		Set<TestClassRequest> requests = collector.toRequests(c -> true);
 		assertThat(requests).isEmpty();
-		assertThat(logger.getLogRecords()).isEmpty();
 	}
 
 }
