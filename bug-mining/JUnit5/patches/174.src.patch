diff --git a/junit-jupiter-engine/src/test/java/org/junit/jupiter/engine/ExceptionHandlingTests.java b/junit-jupiter-engine/src/test/java/org/junit/jupiter/engine/ExceptionHandlingTests.java
index ab83b01d1..0f4982049 100644
--- a/junit-jupiter-engine/src/test/java/org/junit/jupiter/engine/ExceptionHandlingTests.java
+++ b/junit-jupiter-engine/src/test/java/org/junit/jupiter/engine/ExceptionHandlingTests.java
@@ -12,6 +12,8 @@ package org.junit.jupiter.engine;
 
 import static org.assertj.core.api.Assertions.allOf;
 import static org.junit.jupiter.api.Assertions.assertEquals;
+import static org.junit.jupiter.api.TestInstance.Lifecycle.PER_CLASS;
+import static org.junit.platform.engine.discovery.DiscoverySelectors.selectClass;
 import static org.junit.platform.engine.discovery.DiscoverySelectors.selectMethod;
 import static org.junit.platform.engine.test.event.ExecutionEventConditions.assertRecordedExecutionEventsContainsExactly;
 import static org.junit.platform.engine.test.event.ExecutionEventConditions.container;
@@ -36,6 +38,10 @@ import org.junit.jupiter.api.Assertions;
 import org.junit.jupiter.api.BeforeAll;
 import org.junit.jupiter.api.BeforeEach;
 import org.junit.jupiter.api.Test;
+import org.junit.jupiter.api.TestInstance;
+import org.junit.jupiter.api.extension.AfterAllCallback;
+import org.junit.jupiter.api.extension.ExtendWith;
+import org.junit.jupiter.api.extension.ExtensionContext;
 import org.junit.platform.engine.test.event.ExecutionEventRecorder;
 import org.junit.platform.launcher.LauncherDiscoveryRequest;
 import org.opentest4j.AssertionFailedError;
@@ -182,8 +188,26 @@ class ExceptionHandlingTests extends AbstractJupiterTestEngineTests {
 			event(engine(), finishedSuccessfully()));
 	}
 
+	@Test
+	void exceptionInAfterAllCallbackDoesNotHideFailureWhenTestInstancePerClassIsUsed() {
+		LauncherDiscoveryRequest request = request().selectors(
+			selectClass(TestCaseWithInvalidConstructorAndThrowingAfterAllCallback.class)).build();
+
+		FailureTestCase.exceptionToThrowInAfterAll = Optional.of(new IOException("after"));
+
+		ExecutionEventRecorder eventRecorder = executeTests(request);
+
+		assertRecordedExecutionEventsContainsExactly(eventRecorder.getExecutionEvents(), //
+			event(engine(), started()), //
+			event(container(TestCaseWithInvalidConstructorAndThrowingAfterAllCallback.class), started()), //
+			event(container(TestCaseWithInvalidConstructorAndThrowingAfterAllCallback.class), finishedWithFailure(allOf( //
+				message(m -> m.contains("constructor")), //
+				suppressed(0, message("callback"))))), //
+			event(engine(), finishedSuccessfully()));
+	}
+
 	@AfterEach
-	public void cleanUpExceptions() {
+	void cleanUpExceptions() {
 		FailureTestCase.exceptionToThrowInBeforeAll = Optional.empty();
 		FailureTestCase.exceptionToThrowInAfterAll = Optional.empty();
 		FailureTestCase.exceptionToThrowInBeforeEach = Optional.empty();
@@ -242,4 +266,26 @@ class ExceptionHandlingTests extends AbstractJupiterTestEngineTests {
 
 	}
 
+	@TestInstance(PER_CLASS)
+	@ExtendWith(ThrowingAfterAllCallback.class)
+	static class TestCaseWithInvalidConstructorAndThrowingAfterAllCallback {
+		TestCaseWithInvalidConstructorAndThrowingAfterAllCallback() {
+		}
+
+		@SuppressWarnings("unused")
+		TestCaseWithInvalidConstructorAndThrowingAfterAllCallback(String unused) {
+		}
+
+		@Test
+		void test() {
+		}
+	}
+
+	static class ThrowingAfterAllCallback implements AfterAllCallback {
+		@Override
+		public void afterAll(ExtensionContext context) {
+			throw new IllegalStateException("callback");
+		}
+	}
+
 }
diff --git a/junit-platform-engine/src/main/java/org/junit/platform/engine/support/hierarchical/HierarchicalTestExecutor.java b/junit-platform-engine/src/main/java/org/junit/platform/engine/support/hierarchical/HierarchicalTestExecutor.java
index c9959ee21..ace06d253 100644
--- a/junit-platform-engine/src/main/java/org/junit/platform/engine/support/hierarchical/HierarchicalTestExecutor.java
+++ b/junit-platform-engine/src/main/java/org/junit/platform/engine/support/hierarchical/HierarchicalTestExecutor.java
@@ -106,6 +106,7 @@ class HierarchicalTestExecutor<C extends EngineExecutionContext> {
 			listener.executionStarted(testDescriptor);
 
 			executionResult = singleTestExecutor.executeSafely(() -> {
+				Throwable failure = null;
 				try {
 					context = node.before(context);
 
@@ -120,12 +121,31 @@ class HierarchicalTestExecutor<C extends EngineExecutionContext> {
 							.forEach(child -> new NodeExecutor(child).execute(context, tracker));
 					// @formatter:on
 				}
+				catch (Throwable t) {
+					failure = t;
+				}
 				finally {
-					node.after(context);
+					executeAfter(failure);
 				}
 			});
 		}
 
+		private void executeAfter(Throwable failure) throws Throwable {
+			try {
+				node.after(context);
+				if (failure != null) {
+					throw failure;
+				}
+			}
+			catch (Throwable t) {
+				if (failure != null && failure != t) {
+					failure.addSuppressed(t);
+					throw failure;
+				}
+				throw t;
+			}
+		}
+
 		private void cleanUp() {
 			try {
 				node.cleanUp(context);
diff --git a/junit-platform-engine/src/test/java/org/junit/platform/engine/test/event/TestExecutionResultConditions.java b/junit-platform-engine/src/test/java/org/junit/platform/engine/test/event/TestExecutionResultConditions.java
index 7073786fe..b2f90c7b8 100644
--- a/junit-platform-engine/src/test/java/org/junit/platform/engine/test/event/TestExecutionResultConditions.java
+++ b/junit-platform-engine/src/test/java/org/junit/platform/engine/test/event/TestExecutionResultConditions.java
@@ -45,7 +45,8 @@ public class TestExecutionResultConditions {
 	}
 
 	public static Condition<Throwable> suppressed(int index, Condition<Throwable> checked) {
-		return new Condition<>(throwable -> checked.matches(throwable.getSuppressed()[index]),
+		return new Condition<>(
+			throwable -> throwable.getSuppressed().length > index && checked.matches(throwable.getSuppressed()[index]),
 			"suppressed at index %d matches %s", index, checked);
 
 	}
diff --git a/platform-tests/src/test/java/org/junit/platform/engine/support/hierarchical/HierarchicalTestExecutorTests.java b/platform-tests/src/test/java/org/junit/platform/engine/support/hierarchical/HierarchicalTestExecutorTests.java
index f4c6e5caf..4efbcfea6 100644
--- a/platform-tests/src/test/java/org/junit/platform/engine/support/hierarchical/HierarchicalTestExecutorTests.java
+++ b/platform-tests/src/test/java/org/junit/platform/engine/support/hierarchical/HierarchicalTestExecutorTests.java
@@ -13,7 +13,9 @@ package org.junit.platform.engine.support.hierarchical;
 import static org.assertj.core.api.Assertions.assertThat;
 import static org.junit.jupiter.api.Assertions.assertSame;
 import static org.junit.jupiter.api.Assertions.assertThrows;
-import static org.junit.jupiter.api.Assertions.assertTrue;
+import static org.junit.platform.engine.TestExecutionResult.Status.ABORTED;
+import static org.junit.platform.engine.TestExecutionResult.Status.FAILED;
+import static org.junit.platform.engine.TestExecutionResult.Status.SUCCESSFUL;
 import static org.mockito.ArgumentMatchers.any;
 import static org.mockito.ArgumentMatchers.eq;
 import static org.mockito.Mockito.doThrow;
@@ -75,8 +77,7 @@ class HierarchicalTestExecutorTests {
 		inOrder.verify(root).after(rootContext);
 		inOrder.verify(listener).executionFinished(eq(root), rootExecutionResult.capture());
 
-		assertTrue(rootExecutionResult.getValue().getStatus() == TestExecutionResult.Status.SUCCESSFUL,
-			"Execution of root should be successful.");
+		assertThat(rootExecutionResult.getValue().getStatus()).isEqualTo(SUCCESSFUL);
 	}
 
 	@Test
@@ -99,8 +100,7 @@ class HierarchicalTestExecutorTests {
 		inOrder.verify(listener).executionFinished(eq(child), childExecutionResult.capture());
 		inOrder.verify(listener).executionFinished(eq(root), any(TestExecutionResult.class));
 
-		assertTrue(childExecutionResult.getValue().getStatus() == TestExecutionResult.Status.SUCCESSFUL,
-			"Execution of child container should be successful.");
+		assertThat(childExecutionResult.getValue().getStatus()).isEqualTo(SUCCESSFUL);
 	}
 
 	@Test
@@ -122,8 +122,7 @@ class HierarchicalTestExecutorTests {
 		inOrder.verify(listener).executionFinished(eq(child), aTestExecutionResult.capture());
 		inOrder.verify(listener).executionFinished(eq(root), any(TestExecutionResult.class));
 
-		assertTrue(aTestExecutionResult.getValue().getStatus() == TestExecutionResult.Status.SUCCESSFUL,
-			"Execution of child leaf be successful.");
+		assertThat(aTestExecutionResult.getValue().getStatus()).isEqualTo(SUCCESSFUL);
 	}
 
 	@Test
@@ -193,9 +192,8 @@ class HierarchicalTestExecutorTests {
 
 		verifyNoMoreInteractions(child);
 
-		assertTrue(childExecutionResult.getValue().getStatus() == TestExecutionResult.Status.FAILED,
-			"Execution of child should fail.");
-		assertSame(childExecutionResult.getValue().getThrowable().get(), anException);
+		assertThat(childExecutionResult.getValue().getStatus()).isEqualTo(FAILED);
+		assertThat(childExecutionResult.getValue().getThrowable()).containsSame(anException);
 	}
 
 	@Test
@@ -218,9 +216,8 @@ class HierarchicalTestExecutorTests {
 		inOrder.verify(root).after(rootContext);
 		inOrder.verify(listener).executionFinished(eq(root), rootExecutionResult.capture());
 
-		assertTrue(rootExecutionResult.getValue().getStatus() == TestExecutionResult.Status.FAILED,
-			"Execution of root should fail.");
-		assertSame(rootExecutionResult.getValue().getThrowable().get(), anException);
+		assertThat(rootExecutionResult.getValue().getStatus()).isEqualTo(FAILED);
+		assertThat(rootExecutionResult.getValue().getThrowable()).containsSame(anException);
 
 		verifyNoMoreInteractions(child);
 	}
@@ -251,7 +248,7 @@ class HierarchicalTestExecutorTests {
 		inOrder.verify(listener).executionFinished(eq(root), rootExecutionResult.capture());
 		inOrder.verifyNoMoreInteractions();
 
-		assertThat(rootExecutionResult.getValue().getStatus()).isEqualTo(TestExecutionResult.Status.FAILED);
+		assertThat(rootExecutionResult.getValue().getStatus()).isEqualTo(FAILED);
 		assertThat(rootExecutionResult.getValue().getThrowable()).containsSame(afterException);
 		assertThat(afterException.getSuppressed()).containsExactly(cleanUpException);
 	}
@@ -270,7 +267,7 @@ class HierarchicalTestExecutorTests {
 		inOrder.verify(listener).executionFinished(eq(root), rootExecutionResult.capture());
 		inOrder.verifyNoMoreInteractions();
 
-		assertThat(rootExecutionResult.getValue().getStatus()).isEqualTo(TestExecutionResult.Status.FAILED);
+		assertThat(rootExecutionResult.getValue().getStatus()).isEqualTo(FAILED);
 		assertThat(rootExecutionResult.getValue().getThrowable()).containsSame(prepareException);
 		assertThat(prepareException.getSuppressed()).isEmpty();
 	}
@@ -293,7 +290,7 @@ class HierarchicalTestExecutorTests {
 		inOrder.verify(listener).executionFinished(eq(root), rootExecutionResult.capture());
 		inOrder.verifyNoMoreInteractions();
 
-		assertThat(rootExecutionResult.getValue().getStatus()).isEqualTo(TestExecutionResult.Status.FAILED);
+		assertThat(rootExecutionResult.getValue().getStatus()).isEqualTo(FAILED);
 		assertThat(rootExecutionResult.getValue().getThrowable()).containsSame(cleanUpException);
 		assertThat(cleanUpException.getSuppressed()).isEmpty();
 	}
@@ -316,7 +313,7 @@ class HierarchicalTestExecutorTests {
 		inOrder.verify(listener).executionFinished(eq(root), rootExecutionResult.capture());
 		inOrder.verifyNoMoreInteractions();
 
-		assertThat(rootExecutionResult.getValue().getStatus()).isEqualTo(TestExecutionResult.Status.FAILED);
+		assertThat(rootExecutionResult.getValue().getStatus()).isEqualTo(FAILED);
 		assertThat(rootExecutionResult.getValue().getThrowable()).containsSame(shouldBeSkippedException);
 		assertThat(shouldBeSkippedException.getSuppressed()).containsExactly(cleanUpException);
 	}
@@ -342,9 +339,8 @@ class HierarchicalTestExecutorTests {
 		inOrder.verify(root).after(rootContext);
 		inOrder.verify(listener).executionFinished(eq(root), any(TestExecutionResult.class));
 
-		assertTrue(childExecutionResult.getValue().getStatus() == TestExecutionResult.Status.FAILED,
-			"Execution of child should fail.");
-		assertSame(childExecutionResult.getValue().getThrowable().get(), anException);
+		assertThat(childExecutionResult.getValue().getStatus()).isEqualTo(FAILED);
+		assertThat(childExecutionResult.getValue().getThrowable()).containsSame(anException);
 	}
 
 	@Test
@@ -367,9 +363,8 @@ class HierarchicalTestExecutorTests {
 		inOrder.verify(root).after(rootContext);
 		inOrder.verify(listener).executionFinished(eq(root), rootExecutionResult.capture());
 
-		assertTrue(rootExecutionResult.getValue().getStatus() == TestExecutionResult.Status.ABORTED,
-			"Execution of root should abort.");
-		assertSame(rootExecutionResult.getValue().getThrowable().get(), anAbortedException);
+		assertThat(rootExecutionResult.getValue().getStatus()).isEqualTo(ABORTED);
+		assertThat(rootExecutionResult.getValue().getThrowable()).containsSame(anAbortedException);
 
 		verifyNoMoreInteractions(child);
 	}
@@ -395,9 +390,8 @@ class HierarchicalTestExecutorTests {
 		inOrder.verify(root).after(rootContext);
 		inOrder.verify(listener).executionFinished(eq(root), any(TestExecutionResult.class));
 
-		assertTrue(childExecutionResult.getValue().getStatus() == TestExecutionResult.Status.ABORTED,
-			"Execution of child should abort.");
-		assertSame(childExecutionResult.getValue().getThrowable().get(), anAbortedException);
+		assertThat(childExecutionResult.getValue().getStatus()).isEqualTo(ABORTED);
+		assertThat(childExecutionResult.getValue().getThrowable()).containsSame(anAbortedException);
 	}
 
 	@Test
@@ -434,7 +428,7 @@ class HierarchicalTestExecutorTests {
 		inOrder.verify(listener).executionFinished(eq(root), any(TestExecutionResult.class));
 
 		assertThat(aTestExecutionResult.getAllValues()).extracting(TestExecutionResult::getStatus).containsExactly(
-			TestExecutionResult.Status.SUCCESSFUL, TestExecutionResult.Status.SUCCESSFUL);
+			SUCCESSFUL, SUCCESSFUL);
 	}
 
 	@Test
@@ -482,8 +476,7 @@ class HierarchicalTestExecutorTests {
 		inOrder.verify(listener).executionFinished(eq(root), any(TestExecutionResult.class));
 
 		assertThat(aTestExecutionResult.getAllValues()).extracting(TestExecutionResult::getStatus).containsExactly(
-			TestExecutionResult.Status.FAILED, TestExecutionResult.Status.SUCCESSFUL,
-			TestExecutionResult.Status.SUCCESSFUL);
+			FAILED, SUCCESSFUL, SUCCESSFUL);
 	}
 
 	private Answer<Object> registerAndExecute(TestDescriptor dynamicChild) {
@@ -522,6 +515,30 @@ class HierarchicalTestExecutorTests {
 		assertSame(outOfMemoryError, actualException);
 	}
 
+	@Test
+	void exceptionInAfterDoesNotHideEarlierException() throws Exception {
+
+		MyLeaf child = spy(new MyLeaf(UniqueId.root("leaf", "leaf")));
+		Exception exceptionInExecute = new RuntimeException("execute");
+		Exception exceptionInAfter = new RuntimeException("after");
+		doThrow(exceptionInExecute).when(child).execute(eq(rootContext), any());
+		doThrow(exceptionInAfter).when(child).after(eq(rootContext));
+		root.addChild(child);
+
+		InOrder inOrder = inOrder(listener, child);
+
+		executor.execute();
+
+		ArgumentCaptor<TestExecutionResult> childExecutionResult = ArgumentCaptor.forClass(TestExecutionResult.class);
+		inOrder.verify(child).execute(eq(rootContext), any());
+		inOrder.verify(child).after(eq(rootContext));
+		inOrder.verify(listener).executionFinished(eq(child), childExecutionResult.capture());
+
+		assertThat(childExecutionResult.getValue().getStatus()).isEqualTo(FAILED);
+		assertThat(childExecutionResult.getValue().getThrowable().get()).isSameAs(
+			exceptionInExecute).hasSuppressedException(exceptionInAfter);
+	}
+
 	// -------------------------------------------------------------------
 
 	private static class MyEngineExecutionContext implements EngineExecutionContext {
