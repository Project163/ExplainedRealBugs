diff --git a/junit-jupiter-engine/src/main/java/org/junit/jupiter/engine/extension/TempDirectory.java b/junit-jupiter-engine/src/main/java/org/junit/jupiter/engine/extension/TempDirectory.java
index 39b60df1b..4155a3a21 100644
--- a/junit-jupiter-engine/src/main/java/org/junit/jupiter/engine/extension/TempDirectory.java
+++ b/junit-jupiter-engine/src/main/java/org/junit/jupiter/engine/extension/TempDirectory.java
@@ -71,7 +71,7 @@ class TempDirectory implements BeforeAllCallback, BeforeEachCallback, ParameterR
 	 */
 	@Override
 	public void beforeAll(ExtensionContext context) throws Exception {
-		injectFields(context, null, ReflectionUtils::isStatic);
+		injectFields(context, null, context.getRequiredTestClass(), ReflectionUtils::isStatic);
 	}
 
 	/**
@@ -80,12 +80,19 @@ class TempDirectory implements BeforeAllCallback, BeforeEachCallback, ParameterR
 	 * with {@link TempDir @TempDir}.
 	 */
 	@Override
-	public void beforeEach(ExtensionContext context) throws Exception {
-		injectFields(context, context.getRequiredTestInstance(), ReflectionUtils::isNotStatic);
+	public void beforeEach(ExtensionContext context) throws RuntimeException {
+		injectFields(context, context.getRequiredTestInstance(), context.getRequiredTestClass(),
+			ReflectionUtils::isNotStatic);
+		context.getTestInstances().ifPresent(testinstances -> {
+			testinstances.getEnclosingInstances().forEach(enclosingInstance -> injectFields(context, enclosingInstance,
+				enclosingInstance.getClass(), ReflectionUtils::isNotStatic));
+		});
 	}
 
-	private void injectFields(ExtensionContext context, Object testInstance, Predicate<Field> predicate) {
-		findAnnotatedFields(context.getRequiredTestClass(), TempDir.class, predicate).forEach(field -> {
+	private void injectFields(ExtensionContext context, Object testInstance, Class<?> testClass,
+			Predicate<Field> predicate) {
+
+		findAnnotatedFields(testClass, TempDir.class, predicate).forEach(field -> {
 			assertValidFieldCandidate(field);
 			try {
 				makeAccessible(field).set(testInstance, getPathOrFile(field.getType(), context));
diff --git a/junit-jupiter-engine/src/test/java/org/junit/jupiter/engine/extension/TempDirectoryTests.java b/junit-jupiter-engine/src/test/java/org/junit/jupiter/engine/extension/TempDirectoryTests.java
index 19316dcd2..4250dad96 100644
--- a/junit-jupiter-engine/src/test/java/org/junit/jupiter/engine/extension/TempDirectoryTests.java
+++ b/junit-jupiter-engine/src/test/java/org/junit/jupiter/engine/extension/TempDirectoryTests.java
@@ -89,6 +89,13 @@ class TempDirectoryTests extends AbstractJupiterTestEngineTests {
 				.assertStatistics(stats -> stats.started(1).succeeded(1));
 	}
 
+	@Test
+	@DisplayName("can be used in nested test class")
+	void canBeUsedInNestedTestClass() {
+		executeTestsForClass(TempDirCanBeUsedInNestedTestClass.class).testEvents()//
+				.assertStatistics(stats -> stats.started(2).succeeded(2));
+	}
+
 	@Nested
 	@DisplayName("resolves shared temp dir")
 	@TestMethodOrder(OrderAnnotation.class)
@@ -766,4 +773,30 @@ class TempDirectoryTests extends AbstractJupiterTestEngineTests {
 
 	}
 
+	// https://github.com/junit-team/junit5/issues/2079
+	static class TempDirCanBeUsedInNestedTestClass {
+
+		@TempDir
+		File tempDir;
+
+		@Nested
+		class NestedTestClass {
+
+			@Test
+			void testNested() {
+				assertNotNull(tempDir);
+				assertTrue(tempDir.exists());
+			}
+
+			@Nested
+			class EvenDeeperNestedTestClass {
+
+				@Test
+				void testDeepNested() {
+					assertNotNull(tempDir);
+					assertTrue(tempDir.exists());
+				}
+			}
+		}
+	}
 }
