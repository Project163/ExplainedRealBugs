{"url":"https://api.github.com/repos/junit-team/junit-framework/issues/1524","repository_url":"https://api.github.com/repos/junit-team/junit-framework","labels_url":"https://api.github.com/repos/junit-team/junit-framework/issues/1524/labels{/name}","comments_url":"https://api.github.com/repos/junit-team/junit-framework/issues/1524/comments","events_url":"https://api.github.com/repos/junit-team/junit-framework/issues/1524/events","html_url":"https://github.com/junit-team/junit-framework/issues/1524","id":347711328,"node_id":"MDU6SXNzdWUzNDc3MTEzMjg=","number":1524,"title":"Inconsistent output from TreePrinter in ConsoleLauncher with parallel test execution","user":{"login":"littleclay","id":14144383,"node_id":"MDQ6VXNlcjE0MTQ0Mzgz","avatar_url":"https://avatars.githubusercontent.com/u/14144383?v=4","gravatar_id":"","url":"https://api.github.com/users/littleclay","html_url":"https://github.com/littleclay","followers_url":"https://api.github.com/users/littleclay/followers","following_url":"https://api.github.com/users/littleclay/following{/other_user}","gists_url":"https://api.github.com/users/littleclay/gists{/gist_id}","starred_url":"https://api.github.com/users/littleclay/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/littleclay/subscriptions","organizations_url":"https://api.github.com/users/littleclay/orgs","repos_url":"https://api.github.com/users/littleclay/repos","events_url":"https://api.github.com/users/littleclay/events{/privacy}","received_events_url":"https://api.github.com/users/littleclay/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":165165178,"node_id":"MDU6TGFiZWwxNjUxNjUxNzg=","url":"https://api.github.com/repos/junit-team/junit-framework/labels/type:%20bug","name":"type: bug","color":"fc2929","default":false,"description":null},{"id":420911923,"node_id":"MDU6TGFiZWw0MjA5MTE5MjM=","url":"https://api.github.com/repos/junit-team/junit-framework/labels/component:%20Jupiter","name":"component: Jupiter","color":"11ee99","default":false,"description":null},{"id":420912036,"node_id":"MDU6TGFiZWw0MjA5MTIwMzY=","url":"https://api.github.com/repos/junit-team/junit-framework/labels/component:%20Platform","name":"component: Platform","color":"11dd99","default":false,"description":null}],"state":"closed","locked":false,"assignee":{"login":"sormuras","id":2319838,"node_id":"MDQ6VXNlcjIzMTk4Mzg=","avatar_url":"https://avatars.githubusercontent.com/u/2319838?v=4","gravatar_id":"","url":"https://api.github.com/users/sormuras","html_url":"https://github.com/sormuras","followers_url":"https://api.github.com/users/sormuras/followers","following_url":"https://api.github.com/users/sormuras/following{/other_user}","gists_url":"https://api.github.com/users/sormuras/gists{/gist_id}","starred_url":"https://api.github.com/users/sormuras/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sormuras/subscriptions","organizations_url":"https://api.github.com/users/sormuras/orgs","repos_url":"https://api.github.com/users/sormuras/repos","events_url":"https://api.github.com/users/sormuras/events{/privacy}","received_events_url":"https://api.github.com/users/sormuras/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"marcphilipp","id":214207,"node_id":"MDQ6VXNlcjIxNDIwNw==","avatar_url":"https://avatars.githubusercontent.com/u/214207?v=4","gravatar_id":"","url":"https://api.github.com/users/marcphilipp","html_url":"https://github.com/marcphilipp","followers_url":"https://api.github.com/users/marcphilipp/followers","following_url":"https://api.github.com/users/marcphilipp/following{/other_user}","gists_url":"https://api.github.com/users/marcphilipp/gists{/gist_id}","starred_url":"https://api.github.com/users/marcphilipp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marcphilipp/subscriptions","organizations_url":"https://api.github.com/users/marcphilipp/orgs","repos_url":"https://api.github.com/users/marcphilipp/repos","events_url":"https://api.github.com/users/marcphilipp/events{/privacy}","received_events_url":"https://api.github.com/users/marcphilipp/received_events","type":"User","user_view_type":"public","site_admin":false},{"login":"sormuras","id":2319838,"node_id":"MDQ6VXNlcjIzMTk4Mzg=","avatar_url":"https://avatars.githubusercontent.com/u/2319838?v=4","gravatar_id":"","url":"https://api.github.com/users/sormuras","html_url":"https://github.com/sormuras","followers_url":"https://api.github.com/users/sormuras/followers","following_url":"https://api.github.com/users/sormuras/following{/other_user}","gists_url":"https://api.github.com/users/sormuras/gists{/gist_id}","starred_url":"https://api.github.com/users/sormuras/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sormuras/subscriptions","organizations_url":"https://api.github.com/users/sormuras/orgs","repos_url":"https://api.github.com/users/sormuras/repos","events_url":"https://api.github.com/users/sormuras/events{/privacy}","received_events_url":"https://api.github.com/users/sormuras/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":{"url":"https://api.github.com/repos/junit-team/junit-framework/milestones/27","html_url":"https://github.com/junit-team/junit-framework/milestone/27","labels_url":"https://api.github.com/repos/junit-team/junit-framework/milestones/27/labels","id":3427464,"node_id":"MDk6TWlsZXN0b25lMzQyNzQ2NA==","number":27,"title":"5.3 RC1","description":"*Scope:* Finishing touches on parallel test execution and output capturing, bug fixes and miscellaneous usability improvements.","creator":{"login":"sormuras","id":2319838,"node_id":"MDQ6VXNlcjIzMTk4Mzg=","avatar_url":"https://avatars.githubusercontent.com/u/2319838?v=4","gravatar_id":"","url":"https://api.github.com/users/sormuras","html_url":"https://github.com/sormuras","followers_url":"https://api.github.com/users/sormuras/followers","following_url":"https://api.github.com/users/sormuras/following{/other_user}","gists_url":"https://api.github.com/users/sormuras/gists{/gist_id}","starred_url":"https://api.github.com/users/sormuras/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sormuras/subscriptions","organizations_url":"https://api.github.com/users/sormuras/orgs","repos_url":"https://api.github.com/users/sormuras/repos","events_url":"https://api.github.com/users/sormuras/events{/privacy}","received_events_url":"https://api.github.com/users/sormuras/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":42,"state":"closed","created_at":"2018-06-15T10:22:15Z","updated_at":"2018-08-14T19:11:27Z","due_on":"2018-08-13T07:00:00Z","closed_at":"2018-08-13T19:14:17Z"},"comments":9,"created_at":"2018-08-05T16:20:08Z","updated_at":"2018-08-09T07:21:44Z","closed_at":"2018-08-09T07:21:41Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"When running all the tests in a few simple test classes with the 1.3.0-M1 ConsoleLauncher standalone jar with the parallel test execution, I am seeing inconsistent output. Sometimes there will be a NullPointerException in the TreePrinter, sometimes it will execute but some of the executed tests will not show up in the tree output (though they are in the final summary), sometimes it will display the ConsoleLauncher help output, and sometimes there is a mix of all of those behaviors. One example is:\r\n\r\n```\r\n(aaron) $ java -jar junit-platform-console-standalone-1.3.0-M1.jar --cp tests.jar -p com.foo --config junit.jupiter.execution.parallel.enabled=true --details tree\r\n\r\njava.lang.NullPointerException\r\n\tat org.junit.platform.console.tasks.TreePrinter.print(TreePrinter.java:54)\r\n\tat org.junit.platform.console.tasks.TreePrinter.print(TreePrinter.java:65)\r\n\tat org.junit.platform.console.tasks.TreePrinter.print(TreePrinter.java:65)\r\n\tat org.junit.platform.console.tasks.TreePrinter.print(TreePrinter.java:65)\r\n\tat org.junit.platform.console.tasks.TreePrinter.print(TreePrinter.java:49)\r\n\tat org.junit.platform.console.tasks.TreePrintingListener.testPlanExecutionFinished(TreePrintingListener.java:56)\r\n\tat org.junit.platform.launcher.core.TestExecutionListenerRegistry$CompositeTestExecutionListener.lambda$testPlanExecutionFinished$7(TestExecutionListenerRegistry.java:102)\r\n\tat java.util.ArrayList.forEach(ArrayList.java:1257)\r\n\tat org.junit.platform.launcher.core.TestExecutionListenerRegistry.notifyTestExecutionListeners(TestExecutionListenerRegistry.java:59)\r\n\tat org.junit.platform.launcher.core.TestExecutionListenerRegistry.access$100(TestExecutionListenerRegistry.java:28)\r\n\tat org.junit.platform.launcher.core.TestExecutionListenerRegistry$CompositeTestExecutionListener.testPlanExecutionFinished(TestExecutionListenerRegistry.java:102)\r\n\tat org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:155)\r\n\tat org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:166)\r\n\tat org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:145)\r\n\tat org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:92)\r\n\tat org.junit.platform.console.tasks.ConsoleTestExecutor.executeTests(ConsoleTestExecutor.java:65)\r\n\tat org.junit.platform.console.tasks.ConsoleTestExecutor.lambda$execute$0(ConsoleTestExecutor.java:57)\r\n\tat org.junit.platform.console.tasks.CustomContextClassLoaderExecutor.replaceThreadContextClassLoaderAndInvoke(CustomContextClassLoaderExecutor.java:41)\r\n\tat org.junit.platform.console.tasks.CustomContextClassLoaderExecutor.invoke(CustomContextClassLoaderExecutor.java:31)\r\n\tat org.junit.platform.console.tasks.ConsoleTestExecutor.execute(ConsoleTestExecutor.java:57)\r\n\tat org.junit.platform.console.ConsoleLauncher.executeTests(ConsoleLauncher.java:84)\r\n\tat org.junit.platform.console.ConsoleLauncher.execute(ConsoleLauncher.java:74)\r\n\tat org.junit.platform.console.ConsoleLauncher.execute(ConsoleLauncher.java:47)\r\n\tat org.junit.platform.console.ConsoleLauncher.main(ConsoleLauncher.java:39)\r\n\r\n╷\r\n├─ JUnit Jupiter ✔\r\n│  ├─ BarTest ✔\r\n│  │     2018-08-05T09:09:25.959 log = `started class  BarTest`\r\n│  │     2018-08-05T09:09:26.980 log = `finished class BarTest`\r\n│  │  ├─ testBar1(TestReporter, TestInfo) ✔\r\n│  │  │     2018-08-05T09:09:25.970 log = `started testBar1(TestReporter, TestInfo)`\r\n│  │  │     2018-08-05T09:09:26.972 log = `finished testBar1(TestReporter, TestInfo)`\r\n│  │  └─ testBar2(TestReporter, TestInfo) ✔\r\n│  │        2018-08-05T09:09:25.970 log = `started testBar2(TestReporter, TestInfo)`\r\n│  │        2018-08-05T09:09:26.972 log = `finished testBar2(TestReporter, TestInfo)`\r\n│  ├─ BazTest ✔\r\n│  │     2018-08-05T09:09:25.959 log = `started class  BazTest`\r\n│  │     2018-08-05T09:09:28.989 log = `finished class BazTest`\r\n│  │  ├─ testBaz03(TestReporter, TestInfo) ✔\r\n│  │  │     2018-08-05T09:09:25.970 log = `started testBaz03(TestReporter, TestInfo)`\r\n│  │  │     2018-08-05T09:09:26.972 log = `finished testBaz03(TestReporter, TestInfo)`\r\n│  │  ├─ testBaz02(TestReporter, TestInfo) ✔\r\n│  │  │     2018-08-05T09:09:25.970 log = `started testBaz02(TestReporter, TestInfo)`\r\n│  │  │     2018-08-05T09:09:26.972 log = `finished testBaz02(TestReporter, TestInfo)`\r\n│  │  ├─ testBaz01(TestReporter, TestInfo) ✔\r\n│  │  │     2018-08-05T09:09:25.970 log = `started testBaz01(TestReporter, TestInfo)`\r\n│  │  │     2018-08-05T09:09:26.972 log = `finished testBaz01(TestReporter, TestInfo)`\r\n│  │  ├─ testBaz20(TestReporter, TestInfo) ✔\r\n│  │  │     2018-08-05T09:09:25.970 log = `started testBaz20(TestReporter, TestInfo)`\r\n│  │  │     2018-08-05T09:09:26.972 log = `finished testBaz20(TestReporter, TestInfo)`\r\n│  │  ├─ testBaz19(TestReporter, TestInfo) ✔\r\n│  │  │     2018-08-05T09:09:26.980 log = `started testBaz19(TestReporter, TestInfo)`\r\n│  │  │     2018-08-05T09:09:27.985 log = `finished testBaz19(TestReporter, TestInfo)`\r\n│  │  ├─ testBaz08(TestReporter, TestInfo) ✔\r\n│  │  │     2018-08-05T09:09:26.980 log = `started testBaz08(TestReporter, TestInfo)`\r\n│  │  │     2018-08-05T09:09:27.985 log = `finished testBaz08(TestReporter, TestInfo)`\r\n│  │  ├─ testBaz07(TestReporter, TestInfo) ✔\r\n│  │  │     2018-08-05T09:09:26.980 log = `started testBaz07(TestReporter, TestInfo)`\r\n│  │  │     2018-08-05T09:09:27.985 log = `finished testBaz07(TestReporter, TestInfo)`\r\n│  │  ├─ testBaz05(TestReporter, TestInfo) ✔\r\n│  │  │     2018-08-05T09:09:26.980 log = `started testBaz05(TestReporter, TestInfo)`\r\n│  │  │     2018-08-05T09:09:27.985 log = `finished testBaz05(TestReporter, TestInfo)`\r\n│  │  ├─ testBaz04(TestReporter, TestInfo) ✔\r\n│  │  │     2018-08-05T09:09:26.980 log = `started testBaz04(TestReporter, TestInfo)`\r\n│  │  │     2018-08-05T09:09:27.985 log = `finished testBaz04(TestReporter, TestInfo)`\r\n│  │  ├─ testBaz06(TestReporter, TestInfo) ✔\r\n│  │  │     2018-08-05T09:09:26.980 log = `started testBaz06(TestReporter, TestInfo)`\r\n│  │  │     2018-08-05T09:09:27.985 log = `finished testBaz06(TestReporter, TestInfo)`\r\n│  │  ├─ testBaz10(TestReporter, TestInfo) ✔\r\n│  │  │     2018-08-05T09:09:26.982 log = `started testBaz10(TestReporter, TestInfo)`\r\n│  │  │     2018-08-05T09:09:27.985 log = `finished testBaz10(TestReporter, TestInfo)`\r\n│  │  ├─ testBaz09(TestReporter, TestInfo) ✔\r\n│  │  │     2018-08-05T09:09:26.982 log = `started testBaz09(TestReporter, TestInfo)`\r\n│  │  │     2018-08-05T09:09:27.985 log = `finished testBaz09(TestReporter, TestInfo)`\r\n│  │  ├─ testBaz12(TestReporter, TestInfo) ✔\r\n│  │  │     2018-08-05T09:09:27.987 log = `started testBaz12(TestReporter, TestInfo)`\r\n│  │  │     2018-08-05T09:09:28.988 log = `finished testBaz12(TestReporter, TestInfo)`\r\n│  │  ├─ testBaz17(TestReporter, TestInfo) ✔\r\n│  │  │     2018-08-05T09:09:27.987 log = `started testBaz17(TestReporter, TestInfo)`\r\n│  │  │     2018-08-05T09:09:28.988 log = `finished testBaz17(TestReporter, TestInfo)`\r\n│  │  ├─ testBaz13(TestReporter, TestInfo) ✔\r\n│  │  │     2018-08-05T09:09:27.987 log = `started testBaz13(TestReporter, TestInfo)`\r\n│  │  │     2018-08-05T09:09:28.988 log = `finished testBaz13(TestReporter, TestInfo)`\r\nOption                                         Description                                \r\n------                                         -----------                                \r\n-h, --help                                     Display help information.                  \r\n--disable-ansi-colors                          Disable ANSI colors in output (not         \r\n                                                 supported by all terminals).             \r\n--details <[none,summary,flat,tree,verbose]    Select an output details mode for when     \r\n  >                                              tests are executed. Use one of: [none,   \r\n\r\n... more following this\r\n```\r\n\r\nThe test classes are very simple, and here is an example of one of them:\r\n\r\n```java\r\nfinal class BarTest {\r\n\r\n    @BeforeAll\r\n    static void setup(TestReporter reporter, TestInfo testInfo) {\r\n        reporter.publishEntry(\"log\", \"started class  \" + testInfo.getDisplayName());\r\n    }\r\n\r\n    @AfterAll\r\n    static void tearDown(TestReporter reporter, TestInfo testInfo) {\r\n        reporter.publishEntry(\"log\", \"finished class \" + testInfo.getDisplayName());\r\n    }\r\n\r\n    @Test\r\n    void testBar1(TestReporter reporter, TestInfo testInfo) throws Exception {\r\n        reporter.publishEntry(\"log\", \"started \" + testInfo.getDisplayName());\r\n        Thread.sleep(1_000);\r\n        reporter.publishEntry(\"log\", \"finished \" + testInfo.getDisplayName());\r\n    }\r\n\r\n    @Test\r\n    void testBar2(TestReporter reporter, TestInfo testInfo) throws Exception {\r\n        reporter.publishEntry(\"log\", \"started \" + testInfo.getDisplayName());\r\n        Thread.sleep(1_000);\r\n        reporter.publishEntry(\"log\", \"finished \" + testInfo.getDisplayName());\r\n    }\r\n}\r\n```","closed_by":{"login":"marcphilipp","id":214207,"node_id":"MDQ6VXNlcjIxNDIwNw==","avatar_url":"https://avatars.githubusercontent.com/u/214207?v=4","gravatar_id":"","url":"https://api.github.com/users/marcphilipp","html_url":"https://github.com/marcphilipp","followers_url":"https://api.github.com/users/marcphilipp/followers","following_url":"https://api.github.com/users/marcphilipp/following{/other_user}","gists_url":"https://api.github.com/users/marcphilipp/gists{/gist_id}","starred_url":"https://api.github.com/users/marcphilipp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marcphilipp/subscriptions","organizations_url":"https://api.github.com/users/marcphilipp/orgs","repos_url":"https://api.github.com/users/marcphilipp/repos","events_url":"https://api.github.com/users/marcphilipp/events{/privacy}","received_events_url":"https://api.github.com/users/marcphilipp/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/junit-team/junit-framework/issues/1524/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/junit-team/junit-framework/issues/1524/timeline","performed_via_github_app":null,"state_reason":"completed"}