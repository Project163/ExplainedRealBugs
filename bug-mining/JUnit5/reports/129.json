{"url":"https://api.github.com/repos/junit-team/junit-framework/issues/1048","repository_url":"https://api.github.com/repos/junit-team/junit-framework","labels_url":"https://api.github.com/repos/junit-team/junit-framework/issues/1048/labels{/name}","comments_url":"https://api.github.com/repos/junit-team/junit-framework/issues/1048/comments","events_url":"https://api.github.com/repos/junit-team/junit-framework/issues/1048/events","html_url":"https://github.com/junit-team/junit-framework/issues/1048","id":256254464,"node_id":"MDU6SXNzdWUyNTYyNTQ0NjQ=","number":1048,"title":"Implementation of AbstractExtensionContext#getRoot is wrong","user":{"login":"VagrantBlackbird","id":19990276,"node_id":"MDQ6VXNlcjE5OTkwMjc2","avatar_url":"https://avatars.githubusercontent.com/u/19990276?v=4","gravatar_id":"","url":"https://api.github.com/users/VagrantBlackbird","html_url":"https://github.com/VagrantBlackbird","followers_url":"https://api.github.com/users/VagrantBlackbird/followers","following_url":"https://api.github.com/users/VagrantBlackbird/following{/other_user}","gists_url":"https://api.github.com/users/VagrantBlackbird/gists{/gist_id}","starred_url":"https://api.github.com/users/VagrantBlackbird/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/VagrantBlackbird/subscriptions","organizations_url":"https://api.github.com/users/VagrantBlackbird/orgs","repos_url":"https://api.github.com/users/VagrantBlackbird/repos","events_url":"https://api.github.com/users/VagrantBlackbird/events{/privacy}","received_events_url":"https://api.github.com/users/VagrantBlackbird/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":165165178,"node_id":"MDU6TGFiZWwxNjUxNjUxNzg=","url":"https://api.github.com/repos/junit-team/junit-framework/labels/type:%20bug","name":"type: bug","color":"fc2929","default":false,"description":null},{"id":420911923,"node_id":"MDU6TGFiZWw0MjA5MTE5MjM=","url":"https://api.github.com/repos/junit-team/junit-framework/labels/component:%20Jupiter","name":"component: Jupiter","color":"11ee99","default":false,"description":null}],"state":"closed","locked":false,"assignee":{"login":"marcphilipp","id":214207,"node_id":"MDQ6VXNlcjIxNDIwNw==","avatar_url":"https://avatars.githubusercontent.com/u/214207?v=4","gravatar_id":"","url":"https://api.github.com/users/marcphilipp","html_url":"https://github.com/marcphilipp","followers_url":"https://api.github.com/users/marcphilipp/followers","following_url":"https://api.github.com/users/marcphilipp/following{/other_user}","gists_url":"https://api.github.com/users/marcphilipp/gists{/gist_id}","starred_url":"https://api.github.com/users/marcphilipp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marcphilipp/subscriptions","organizations_url":"https://api.github.com/users/marcphilipp/orgs","repos_url":"https://api.github.com/users/marcphilipp/repos","events_url":"https://api.github.com/users/marcphilipp/events{/privacy}","received_events_url":"https://api.github.com/users/marcphilipp/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"marcphilipp","id":214207,"node_id":"MDQ6VXNlcjIxNDIwNw==","avatar_url":"https://avatars.githubusercontent.com/u/214207?v=4","gravatar_id":"","url":"https://api.github.com/users/marcphilipp","html_url":"https://github.com/marcphilipp","followers_url":"https://api.github.com/users/marcphilipp/followers","following_url":"https://api.github.com/users/marcphilipp/following{/other_user}","gists_url":"https://api.github.com/users/marcphilipp/gists{/gist_id}","starred_url":"https://api.github.com/users/marcphilipp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marcphilipp/subscriptions","organizations_url":"https://api.github.com/users/marcphilipp/orgs","repos_url":"https://api.github.com/users/marcphilipp/repos","events_url":"https://api.github.com/users/marcphilipp/events{/privacy}","received_events_url":"https://api.github.com/users/marcphilipp/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":{"url":"https://api.github.com/repos/junit-team/junit-framework/milestones/10","html_url":"https://github.com/junit-team/junit-framework/milestone/10","labels_url":"https://api.github.com/repos/junit-team/junit-framework/milestones/10/labels","id":2299774,"node_id":"MDk6TWlsZXN0b25lMjI5OTc3NA==","number":10,"title":"5.0 GA","description":"First General Availability Release","creator":{"login":"marcphilipp","id":214207,"node_id":"MDQ6VXNlcjIxNDIwNw==","avatar_url":"https://avatars.githubusercontent.com/u/214207?v=4","gravatar_id":"","url":"https://api.github.com/users/marcphilipp","html_url":"https://github.com/marcphilipp","followers_url":"https://api.github.com/users/marcphilipp/followers","following_url":"https://api.github.com/users/marcphilipp/following{/other_user}","gists_url":"https://api.github.com/users/marcphilipp/gists{/gist_id}","starred_url":"https://api.github.com/users/marcphilipp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marcphilipp/subscriptions","organizations_url":"https://api.github.com/users/marcphilipp/orgs","repos_url":"https://api.github.com/users/marcphilipp/repos","events_url":"https://api.github.com/users/marcphilipp/events{/privacy}","received_events_url":"https://api.github.com/users/marcphilipp/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":13,"state":"closed","created_at":"2017-02-04T15:48:18Z","updated_at":"2017-09-10T18:44:31Z","due_on":"2017-09-10T07:00:00Z","closed_at":"2017-09-10T18:44:31Z"},"comments":4,"created_at":"2017-09-08T13:29:57Z","updated_at":"2017-09-08T14:35:31Z","closed_at":"2017-09-08T13:49:02Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"## Overview\r\n\r\nIn RC3, `AbstractExtensionContext` implements `ExtensionContext#getRoot`. The documentation suggests that this method will return the top level `ExtensionContext` (in other words, the result of `getRoot` should be context independent), but the implementation is written such that it terminates after traversing one level of `ExtensionContext` at most.\r\n\r\nHere's a unit test that fails both its tests:\r\n\r\n```java\r\nimport static org.junit.jupiter.api.Assertions.*;\r\n\r\nimport org.junit.jupiter.api.Nested;\r\nimport org.junit.jupiter.api.Test;\r\nimport org.junit.jupiter.api.extension.ExtendWith;\r\nimport org.junit.jupiter.api.extension.ExtensionContext;\r\nimport org.junit.jupiter.api.extension.ParameterContext;\r\nimport org.junit.jupiter.api.extension.ParameterResolutionException;\r\nimport org.junit.jupiter.api.extension.ParameterResolver;\r\n\r\nimport com.topdesk.stanchion.ExtensionContextGetRootTest.RootExtensionContextInjector;\r\n\r\n@ExtendWith(RootExtensionContextInjector.class)\r\npublic class ExtensionContextGetRootTest {\r\n\t\r\n\tprivate final ExtensionContext rootExtensionContext;\r\n\t\r\n\tExtensionContextGetRootTest(ExtensionContext rootExtensionContext) {\r\n\t\tthis.rootExtensionContext = rootExtensionContext;\r\n\t}\r\n\t\r\n\t@Test\r\n\tvoid topLevelMethod(ExtensionContext shouldBeRootExtensionContext) {\r\n\t\tassertEquals(rootExtensionContext, shouldBeRootExtensionContext);\r\n\t}\r\n\t\r\n\t@Nested\r\n\tclass NestedTest {\r\n\t\t\r\n\t\t@Test\r\n\t\tvoid nestedLevelMethod(ExtensionContext shouldBeRootExtensionContext) {\r\n\t\t\tassertEquals(rootExtensionContext, shouldBeRootExtensionContext);\r\n\t\t}\r\n\t}\r\n\t\r\n\tstatic class RootExtensionContextInjector implements ParameterResolver {\r\n\t\t\r\n\t\t@Override\r\n\t\tpublic boolean supportsParameter(ParameterContext parameterContext, ExtensionContext extensionContext) throws ParameterResolutionException {\r\n\t\t\treturn parameterContext.getParameter().getType() == ExtensionContext.class;\r\n\t\t}\r\n\t\t\r\n\t\t@Override\r\n\t\tpublic ExtensionContext resolveParameter(ParameterContext parameterContext, ExtensionContext extensionContext) throws ParameterResolutionException {\r\n\t\t\treturn extensionContext.getRoot();\r\n\t\t}\r\n\t}\r\n}\r\n```\r\n\r\nFrom the failure messages, it becomes clear that all three injected extension contexts have a different root:\r\n\r\n> org.opentest4j.AssertionFailedError: \r\n> Expected :org.junit.jupiter.engine.descriptor.JupiterEngineExtensionContext@184cf7cf\r\n> Actual   :org.junit.jupiter.engine.descriptor.ClassExtensionContext@2fd6b6c7\r\n\r\nAnd\r\n\r\n> org.opentest4j.AssertionFailedError: \r\n> Expected :org.junit.jupiter.engine.descriptor.JupiterEngineExtensionContext@184cf7cf\r\n> Actual   :org.junit.jupiter.engine.descriptor.ClassExtensionContext@63a65a25\r\n\r\n## Deliverables\r\n\r\n- [x] Add tests to test this behavior\r\n- [x] Fix the bug","closed_by":{"login":"marcphilipp","id":214207,"node_id":"MDQ6VXNlcjIxNDIwNw==","avatar_url":"https://avatars.githubusercontent.com/u/214207?v=4","gravatar_id":"","url":"https://api.github.com/users/marcphilipp","html_url":"https://github.com/marcphilipp","followers_url":"https://api.github.com/users/marcphilipp/followers","following_url":"https://api.github.com/users/marcphilipp/following{/other_user}","gists_url":"https://api.github.com/users/marcphilipp/gists{/gist_id}","starred_url":"https://api.github.com/users/marcphilipp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marcphilipp/subscriptions","organizations_url":"https://api.github.com/users/marcphilipp/orgs","repos_url":"https://api.github.com/users/marcphilipp/repos","events_url":"https://api.github.com/users/marcphilipp/events{/privacy}","received_events_url":"https://api.github.com/users/marcphilipp/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/junit-team/junit-framework/issues/1048/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/junit-team/junit-framework/issues/1048/timeline","performed_via_github_app":null,"state_reason":"completed"}