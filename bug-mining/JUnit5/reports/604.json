{"url":"https://api.github.com/repos/junit-team/junit-framework/issues/3745","repository_url":"https://api.github.com/repos/junit-team/junit-framework","labels_url":"https://api.github.com/repos/junit-team/junit-framework/issues/3745/labels{/name}","comments_url":"https://api.github.com/repos/junit-team/junit-framework/issues/3745/comments","events_url":"https://api.github.com/repos/junit-team/junit-framework/issues/3745/events","html_url":"https://github.com/junit-team/junit-framework/issues/3745","id":2203974189,"node_id":"I_kwDOAbwRH86DXfot","number":3745,"title":"`@EnabledInNativeImage` is not properly supported at the class level","user":{"login":"linghengqian","id":20187731,"node_id":"MDQ6VXNlcjIwMTg3NzMx","avatar_url":"https://avatars.githubusercontent.com/u/20187731?v=4","gravatar_id":"","url":"https://api.github.com/users/linghengqian","html_url":"https://github.com/linghengqian","followers_url":"https://api.github.com/users/linghengqian/followers","following_url":"https://api.github.com/users/linghengqian/following{/other_user}","gists_url":"https://api.github.com/users/linghengqian/gists{/gist_id}","starred_url":"https://api.github.com/users/linghengqian/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/linghengqian/subscriptions","organizations_url":"https://api.github.com/users/linghengqian/orgs","repos_url":"https://api.github.com/users/linghengqian/repos","events_url":"https://api.github.com/users/linghengqian/events{/privacy}","received_events_url":"https://api.github.com/users/linghengqian/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":165165178,"node_id":"MDU6TGFiZWwxNjUxNjUxNzg=","url":"https://api.github.com/repos/junit-team/junit-framework/labels/type:%20bug","name":"type: bug","color":"fc2929","default":false,"description":null},{"id":420911923,"node_id":"MDU6TGFiZWw0MjA5MTE5MjM=","url":"https://api.github.com/repos/junit-team/junit-framework/labels/component:%20Jupiter","name":"component: Jupiter","color":"11ee99","default":false,"description":null}],"state":"closed","locked":false,"assignee":{"login":"marcphilipp","id":214207,"node_id":"MDQ6VXNlcjIxNDIwNw==","avatar_url":"https://avatars.githubusercontent.com/u/214207?v=4","gravatar_id":"","url":"https://api.github.com/users/marcphilipp","html_url":"https://github.com/marcphilipp","followers_url":"https://api.github.com/users/marcphilipp/followers","following_url":"https://api.github.com/users/marcphilipp/following{/other_user}","gists_url":"https://api.github.com/users/marcphilipp/gists{/gist_id}","starred_url":"https://api.github.com/users/marcphilipp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marcphilipp/subscriptions","organizations_url":"https://api.github.com/users/marcphilipp/orgs","repos_url":"https://api.github.com/users/marcphilipp/repos","events_url":"https://api.github.com/users/marcphilipp/events{/privacy}","received_events_url":"https://api.github.com/users/marcphilipp/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"marcphilipp","id":214207,"node_id":"MDQ6VXNlcjIxNDIwNw==","avatar_url":"https://avatars.githubusercontent.com/u/214207?v=4","gravatar_id":"","url":"https://api.github.com/users/marcphilipp","html_url":"https://github.com/marcphilipp","followers_url":"https://api.github.com/users/marcphilipp/followers","following_url":"https://api.github.com/users/marcphilipp/following{/other_user}","gists_url":"https://api.github.com/users/marcphilipp/gists{/gist_id}","starred_url":"https://api.github.com/users/marcphilipp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marcphilipp/subscriptions","organizations_url":"https://api.github.com/users/marcphilipp/orgs","repos_url":"https://api.github.com/users/marcphilipp/repos","events_url":"https://api.github.com/users/marcphilipp/events{/privacy}","received_events_url":"https://api.github.com/users/marcphilipp/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":{"url":"https://api.github.com/repos/junit-team/junit-framework/milestones/78","html_url":"https://github.com/junit-team/junit-framework/milestone/78","labels_url":"https://api.github.com/repos/junit-team/junit-framework/milestones/78/labels","id":11195620,"node_id":"MI_kwDOAbwRH84AqtTk","number":78,"title":"5.10.3","description":"","creator":{"login":"marcphilipp","id":214207,"node_id":"MDQ6VXNlcjIxNDIwNw==","avatar_url":"https://avatars.githubusercontent.com/u/214207?v=4","gravatar_id":"","url":"https://api.github.com/users/marcphilipp","html_url":"https://github.com/marcphilipp","followers_url":"https://api.github.com/users/marcphilipp/followers","following_url":"https://api.github.com/users/marcphilipp/following{/other_user}","gists_url":"https://api.github.com/users/marcphilipp/gists{/gist_id}","starred_url":"https://api.github.com/users/marcphilipp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marcphilipp/subscriptions","organizations_url":"https://api.github.com/users/marcphilipp/orgs","repos_url":"https://api.github.com/users/marcphilipp/repos","events_url":"https://api.github.com/users/marcphilipp/events{/privacy}","received_events_url":"https://api.github.com/users/marcphilipp/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":9,"state":"closed","created_at":"2024-06-17T10:16:10Z","updated_at":"2024-06-27T14:23:51Z","due_on":"2024-06-27T07:00:00Z","closed_at":"2024-06-27T14:23:51Z"},"comments":12,"created_at":"2024-03-23T17:33:31Z","updated_at":"2024-10-16T12:43:01Z","closed_at":"2024-04-18T14:10:16Z","author_association":"NONE","type":{"id":146627,"node_id":"IT_kwDOAA1WZs4AAjzD","name":"Bug","description":"An unexpected problem or behavior","color":"red","created_at":"2024-01-25T09:15:40Z","updated_at":"2024-07-26T10:05:45Z","is_enabled":true},"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"<!-- Please provide us the version of JUnit 5 you are using and, if possible, a failing unit test with your bug report. Don't forget to describe the rationale for this issue (e.g. expected vs. actual behavior). -->\r\n\r\n## Steps to reproduce\r\n\r\n<!-- Please insert a code snippet or a link to another repo along with instructions how to reproduce the issue here. The example should be minimal, complete and verifiable (see https://stackoverflow.com/help/mcve). -->\r\n\r\n- `@EnabledInNativeImage` is only valid when marked on the function body and has no effect when marked on the class. This means that the following snippet has no problem.\r\n```java\r\nimport org.junit.jupiter.api.Test;\r\nimport org.junit.jupiter.api.condition.EnabledInNativeImage;\r\n\r\nimport static org.junit.jupiter.api.Assertions.assertEquals;\r\n\r\npublic class FunctionLevelTest {\r\n    @Test\r\n    @EnabledInNativeImage\r\n    void testOnFunction() {\r\n        assertEquals(1 + 2, 3);\r\n    }\r\n}\r\n```\r\n- But in the following snippet, `@EnabledInNativeImage` is invalid.\r\n```java\r\nimport org.junit.jupiter.api.Test;\r\nimport org.junit.jupiter.api.condition.EnabledInNativeImage;\r\n\r\nimport static org.junit.jupiter.api.Assertions.assertEquals;\r\n\r\n@EnabledInNativeImage\r\npublic class ClassLevelTest {\r\n\r\n    @Test\r\n    void testOnClass(){\r\n        assertEquals(1 + 2, 3);\r\n    }\r\n}\r\n```\r\n- I created https://github.com/linghengqian/junit5-native-image-annotation-test to demonstrate. Here are the steps to reproduce.\r\n```shell\r\nsdk install java 21.0.2-graalce\r\nsdk use java 21.0.2-graalce\r\n\r\ngit clone git@github.com:linghengqian/junit5-native-image-annotation-test.git\r\ncd ./junit5-native-image-annotation-test/\r\n./mvnw -T1C -e clean test\r\n./mvnw -PnativeTestInJunit -T1C -e clean test\r\n```\r\n\r\n- In the final Log, we can see that `com.lingh.ClassLevelTest.testOnClass()` is not executed in nativeTest.\r\n```shell\r\nFinished generating 'native-tests' in 25.1s.\r\n[INFO] Executing: /home/linghengqian/IdeaProjects/junit5-native-image-annotation-test/target/native-tests --xml-output-dir /home/linghengqian/IdeaProjects/junit5-native-image-annotation-test/target/native-test-reports -Djunit.platform.listeners.uid.tracking.output.dir=/home/linghengqian/IdeaProjects/junit5-native-image-annotation-test/target/test-ids\r\nJUnit Platform on Native Image - report\r\n----------------------------------------\r\n\r\ncom.lingh.FunctionLevelTest > testOnFunction() SUCCESSFUL\r\n\r\n\r\nTest run finished after 1 ms\r\n[         2 containers found      ]\r\n[         0 containers skipped    ]\r\n[         2 containers started    ]\r\n[         0 containers aborted    ]\r\n[         2 containers successful ]\r\n[         0 containers failed     ]\r\n[         1 tests found           ]\r\n[         0 tests skipped         ]\r\n[         1 tests started         ]\r\n[         0 tests aborted         ]\r\n[         1 tests successful      ]\r\n[         0 tests failed          ]\r\n```\r\n\r\n- More early investigations are from https://github.com/apache/shardingsphere/pull/30031 and https://github.com/apache/shardingsphere/issues/29052 .\r\n\r\n## Context\r\n\r\n - Used versions (Jupiter/Vintage/Platform): `Jupiter`\r\n - Build Tool/IDE: `Maven Wrapper 3.9.5`/`IntelliJ IDEA 2023.3.6 (Ultimate Edition)`\r\n\r\n## Deliverables\r\n\r\n- Null.\r\n","closed_by":{"login":"marcphilipp","id":214207,"node_id":"MDQ6VXNlcjIxNDIwNw==","avatar_url":"https://avatars.githubusercontent.com/u/214207?v=4","gravatar_id":"","url":"https://api.github.com/users/marcphilipp","html_url":"https://github.com/marcphilipp","followers_url":"https://api.github.com/users/marcphilipp/followers","following_url":"https://api.github.com/users/marcphilipp/following{/other_user}","gists_url":"https://api.github.com/users/marcphilipp/gists{/gist_id}","starred_url":"https://api.github.com/users/marcphilipp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marcphilipp/subscriptions","organizations_url":"https://api.github.com/users/marcphilipp/orgs","repos_url":"https://api.github.com/users/marcphilipp/repos","events_url":"https://api.github.com/users/marcphilipp/events{/privacy}","received_events_url":"https://api.github.com/users/marcphilipp/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/junit-team/junit-framework/issues/3745/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/junit-team/junit-framework/issues/3745/timeline","performed_via_github_app":null,"state_reason":"completed"}