{"url":"https://api.github.com/repos/junit-team/junit-framework/issues/2609","repository_url":"https://api.github.com/repos/junit-team/junit-framework","labels_url":"https://api.github.com/repos/junit-team/junit-framework/issues/2609/labels{/name}","comments_url":"https://api.github.com/repos/junit-team/junit-framework/issues/2609/comments","events_url":"https://api.github.com/repos/junit-team/junit-framework/issues/2609/events","html_url":"https://github.com/junit-team/junit-framework/issues/2609","id":876796840,"node_id":"MDU6SXNzdWU4NzY3OTY4NDA=","number":2609,"title":"Make @TempDir restore mint permissions before closing context to avoid `AccessDeniedException`","user":{"login":"Philzen","id":1634615,"node_id":"MDQ6VXNlcjE2MzQ2MTU=","avatar_url":"https://avatars.githubusercontent.com/u/1634615?v=4","gravatar_id":"","url":"https://api.github.com/users/Philzen","html_url":"https://github.com/Philzen","followers_url":"https://api.github.com/users/Philzen/followers","following_url":"https://api.github.com/users/Philzen/following{/other_user}","gists_url":"https://api.github.com/users/Philzen/gists{/gist_id}","starred_url":"https://api.github.com/users/Philzen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Philzen/subscriptions","organizations_url":"https://api.github.com/users/Philzen/orgs","repos_url":"https://api.github.com/users/Philzen/repos","events_url":"https://api.github.com/users/Philzen/events{/privacy}","received_events_url":"https://api.github.com/users/Philzen/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":165165180,"node_id":"MDU6TGFiZWwxNjUxNjUxODA=","url":"https://api.github.com/repos/junit-team/junit-framework/labels/type:%20enhancement","name":"type: enhancement","color":"84b6eb","default":false,"description":null},{"id":293473932,"node_id":"MDU6TGFiZWwyOTM0NzM5MzI=","url":"https://api.github.com/repos/junit-team/junit-framework/labels/theme:%20programming%20model","name":"theme: programming model","color":"c7def8","default":false,"description":null},{"id":420911923,"node_id":"MDU6TGFiZWw0MjA5MTE5MjM=","url":"https://api.github.com/repos/junit-team/junit-framework/labels/component:%20Jupiter","name":"component: Jupiter","color":"11ee99","default":false,"description":null}],"state":"closed","locked":false,"assignee":{"login":"Philzen","id":1634615,"node_id":"MDQ6VXNlcjE2MzQ2MTU=","avatar_url":"https://avatars.githubusercontent.com/u/1634615?v=4","gravatar_id":"","url":"https://api.github.com/users/Philzen","html_url":"https://github.com/Philzen","followers_url":"https://api.github.com/users/Philzen/followers","following_url":"https://api.github.com/users/Philzen/following{/other_user}","gists_url":"https://api.github.com/users/Philzen/gists{/gist_id}","starred_url":"https://api.github.com/users/Philzen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Philzen/subscriptions","organizations_url":"https://api.github.com/users/Philzen/orgs","repos_url":"https://api.github.com/users/Philzen/repos","events_url":"https://api.github.com/users/Philzen/events{/privacy}","received_events_url":"https://api.github.com/users/Philzen/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"Philzen","id":1634615,"node_id":"MDQ6VXNlcjE2MzQ2MTU=","avatar_url":"https://avatars.githubusercontent.com/u/1634615?v=4","gravatar_id":"","url":"https://api.github.com/users/Philzen","html_url":"https://github.com/Philzen","followers_url":"https://api.github.com/users/Philzen/followers","following_url":"https://api.github.com/users/Philzen/following{/other_user}","gists_url":"https://api.github.com/users/Philzen/gists{/gist_id}","starred_url":"https://api.github.com/users/Philzen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Philzen/subscriptions","organizations_url":"https://api.github.com/users/Philzen/orgs","repos_url":"https://api.github.com/users/Philzen/repos","events_url":"https://api.github.com/users/Philzen/events{/privacy}","received_events_url":"https://api.github.com/users/Philzen/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":{"url":"https://api.github.com/repos/junit-team/junit-framework/milestones/55","html_url":"https://github.com/junit-team/junit-framework/milestone/55","labels_url":"https://api.github.com/repos/junit-team/junit-framework/milestones/55/labels","id":6429412,"node_id":"MDk6TWlsZXN0b25lNjQyOTQxMg==","number":55,"title":"5.8 RC1","description":"","creator":{"login":"marcphilipp","id":214207,"node_id":"MDQ6VXNlcjIxNDIwNw==","avatar_url":"https://avatars.githubusercontent.com/u/214207?v=4","gravatar_id":"","url":"https://api.github.com/users/marcphilipp","html_url":"https://github.com/marcphilipp","followers_url":"https://api.github.com/users/marcphilipp/followers","following_url":"https://api.github.com/users/marcphilipp/following{/other_user}","gists_url":"https://api.github.com/users/marcphilipp/gists{/gist_id}","starred_url":"https://api.github.com/users/marcphilipp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marcphilipp/subscriptions","organizations_url":"https://api.github.com/users/marcphilipp/orgs","repos_url":"https://api.github.com/users/marcphilipp/repos","events_url":"https://api.github.com/users/marcphilipp/events{/privacy}","received_events_url":"https://api.github.com/users/marcphilipp/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":40,"state":"closed","created_at":"2021-02-13T19:49:34Z","updated_at":"2021-08-17T17:47:37Z","due_on":"2021-08-17T07:00:00Z","closed_at":"2021-08-17T17:47:37Z"},"comments":9,"created_at":"2021-05-05T20:12:08Z","updated_at":"2021-08-17T09:46:01Z","closed_at":"2021-06-11T15:31:27Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"Suppose the following test which throws an `AccessDeniedException`:\r\n\r\n```java\r\nvoid givesNullIfFolderNotExecutable(@TempDir Path tempFolder) throws IOException {\r\n\tPath testFile = Files.createFile(tempFolder.resolve(\"test-file.txt\"));\r\n\ttempFolder.toFile().setExecutable(false);\r\n\r\n\tString result = new MyObjectUnderTest().analyzeFile(testFile);\r\n\r\n\tassertThat(result).isEqualTo(null);   // file info could not be retrieved\r\n}\r\n```\r\n\r\nTo make this test functional i'll have to change the last line to:\r\n``` java\r\n\ttry {\r\n\t\tassertThat(result).isEqualTo(null);\r\n\t} finally {\r\n\t\ttempFolder.toFile().setExecutable(true);\r\n\t}\r\n```\r\n\r\nBut this introduces 4 additional lines of bloat, hence decreasing brevity and readability of an otherwise simple test.\r\n\r\nSo my basic feature suggestion is to restore initial permissions on the tempFolder before trying to delete it. Bonus feature would be to have that done to any entities *within* it recursively as well, though i see a potential performance overhead concern. However, at the end of the day it would be a real win not having to think about restoring the initial state \"manually\" like i currently need to do.\r\n\r\nMaybe there are reasons why this feature is a really bad idea, but i can't point my finger on it and am thankful for your reviews. \r\n\r\nI am filing this as a feature rather than a bug b/c this was the default behavior in Junit4, as there is currently no standard Java API available that allows deleting a folder with such permissions.\r\n\r\n---\r\n\r\nOne thing to add (unrelated to feature request): Junit5 Doc explicitly encourages to provide feedback for this feature so it can be promoted, so i'd like to support that by saying i really like it b/c it provides a much better encapsulated scope than the old JUnit4-rule. It  made me discover and utilize the whole `nio` package where i enjoy the much leaner API (imho, now that i have wrapped my head around it). Hence i'd love to see it promoted to `MAINTAINED`. And *pleeaase* don't remove it, and i'm not only saying this b/c i just reworked a large test suite from Junit4 to Jupiter, but i guess that'd also be a real bummer. :wink: ","closed_by":{"login":"marcphilipp","id":214207,"node_id":"MDQ6VXNlcjIxNDIwNw==","avatar_url":"https://avatars.githubusercontent.com/u/214207?v=4","gravatar_id":"","url":"https://api.github.com/users/marcphilipp","html_url":"https://github.com/marcphilipp","followers_url":"https://api.github.com/users/marcphilipp/followers","following_url":"https://api.github.com/users/marcphilipp/following{/other_user}","gists_url":"https://api.github.com/users/marcphilipp/gists{/gist_id}","starred_url":"https://api.github.com/users/marcphilipp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marcphilipp/subscriptions","organizations_url":"https://api.github.com/users/marcphilipp/orgs","repos_url":"https://api.github.com/users/marcphilipp/repos","events_url":"https://api.github.com/users/marcphilipp/events{/privacy}","received_events_url":"https://api.github.com/users/marcphilipp/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/junit-team/junit-framework/issues/2609/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/junit-team/junit-framework/issues/2609/timeline","performed_via_github_app":null,"state_reason":"completed"}