{"url":"https://api.github.com/repos/junit-team/junit-framework/issues/2438","repository_url":"https://api.github.com/repos/junit-team/junit-framework","labels_url":"https://api.github.com/repos/junit-team/junit-framework/issues/2438/labels{/name}","comments_url":"https://api.github.com/repos/junit-team/junit-framework/issues/2438/comments","events_url":"https://api.github.com/repos/junit-team/junit-framework/issues/2438/events","html_url":"https://github.com/junit-team/junit-framework/issues/2438","id":714169157,"node_id":"MDU6SXNzdWU3MTQxNjkxNTc=","number":2438,"title":"junit-platform-commons 1.7.0 does not contain MANIFEST.MF as first JAR entry","user":{"login":"jsedding","id":797695,"node_id":"MDQ6VXNlcjc5NzY5NQ==","avatar_url":"https://avatars.githubusercontent.com/u/797695?v=4","gravatar_id":"","url":"https://api.github.com/users/jsedding","html_url":"https://github.com/jsedding","followers_url":"https://api.github.com/users/jsedding/followers","following_url":"https://api.github.com/users/jsedding/following{/other_user}","gists_url":"https://api.github.com/users/jsedding/gists{/gist_id}","starred_url":"https://api.github.com/users/jsedding/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jsedding/subscriptions","organizations_url":"https://api.github.com/users/jsedding/orgs","repos_url":"https://api.github.com/users/jsedding/repos","events_url":"https://api.github.com/users/jsedding/events{/privacy}","received_events_url":"https://api.github.com/users/jsedding/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":165165178,"node_id":"MDU6TGFiZWwxNjUxNjUxNzg=","url":"https://api.github.com/repos/junit-team/junit-framework/labels/type:%20bug","name":"type: bug","color":"fc2929","default":false,"description":null},{"id":371966680,"node_id":"MDU6TGFiZWwzNzE5NjY2ODA=","url":"https://api.github.com/repos/junit-team/junit-framework/labels/theme:%20build","name":"theme: build","color":"0052cc","default":false,"description":null}],"state":"closed","locked":false,"assignee":{"login":"jsedding","id":797695,"node_id":"MDQ6VXNlcjc5NzY5NQ==","avatar_url":"https://avatars.githubusercontent.com/u/797695?v=4","gravatar_id":"","url":"https://api.github.com/users/jsedding","html_url":"https://github.com/jsedding","followers_url":"https://api.github.com/users/jsedding/followers","following_url":"https://api.github.com/users/jsedding/following{/other_user}","gists_url":"https://api.github.com/users/jsedding/gists{/gist_id}","starred_url":"https://api.github.com/users/jsedding/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jsedding/subscriptions","organizations_url":"https://api.github.com/users/jsedding/orgs","repos_url":"https://api.github.com/users/jsedding/repos","events_url":"https://api.github.com/users/jsedding/events{/privacy}","received_events_url":"https://api.github.com/users/jsedding/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"jsedding","id":797695,"node_id":"MDQ6VXNlcjc5NzY5NQ==","avatar_url":"https://avatars.githubusercontent.com/u/797695?v=4","gravatar_id":"","url":"https://api.github.com/users/jsedding","html_url":"https://github.com/jsedding","followers_url":"https://api.github.com/users/jsedding/followers","following_url":"https://api.github.com/users/jsedding/following{/other_user}","gists_url":"https://api.github.com/users/jsedding/gists{/gist_id}","starred_url":"https://api.github.com/users/jsedding/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jsedding/subscriptions","organizations_url":"https://api.github.com/users/jsedding/orgs","repos_url":"https://api.github.com/users/jsedding/repos","events_url":"https://api.github.com/users/jsedding/events{/privacy}","received_events_url":"https://api.github.com/users/jsedding/received_events","type":"User","user_view_type":"public","site_admin":false},{"login":"sormuras","id":2319838,"node_id":"MDQ6VXNlcjIzMTk4Mzg=","avatar_url":"https://avatars.githubusercontent.com/u/2319838?v=4","gravatar_id":"","url":"https://api.github.com/users/sormuras","html_url":"https://github.com/sormuras","followers_url":"https://api.github.com/users/sormuras/followers","following_url":"https://api.github.com/users/sormuras/following{/other_user}","gists_url":"https://api.github.com/users/sormuras/gists{/gist_id}","starred_url":"https://api.github.com/users/sormuras/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sormuras/subscriptions","organizations_url":"https://api.github.com/users/sormuras/orgs","repos_url":"https://api.github.com/users/sormuras/repos","events_url":"https://api.github.com/users/sormuras/events{/privacy}","received_events_url":"https://api.github.com/users/sormuras/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":{"url":"https://api.github.com/repos/junit-team/junit-framework/milestones/52","html_url":"https://github.com/junit-team/junit-framework/milestone/52","labels_url":"https://api.github.com/repos/junit-team/junit-framework/milestones/52/labels","id":5947389,"node_id":"MDk6TWlsZXN0b25lNTk0NzM4OQ==","number":52,"title":"5.7.1","description":"Bug fixes since 5.7.0","creator":{"login":"marcphilipp","id":214207,"node_id":"MDQ6VXNlcjIxNDIwNw==","avatar_url":"https://avatars.githubusercontent.com/u/214207?v=4","gravatar_id":"","url":"https://api.github.com/users/marcphilipp","html_url":"https://github.com/marcphilipp","followers_url":"https://api.github.com/users/marcphilipp/followers","following_url":"https://api.github.com/users/marcphilipp/following{/other_user}","gists_url":"https://api.github.com/users/marcphilipp/gists{/gist_id}","starred_url":"https://api.github.com/users/marcphilipp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marcphilipp/subscriptions","organizations_url":"https://api.github.com/users/marcphilipp/orgs","repos_url":"https://api.github.com/users/marcphilipp/repos","events_url":"https://api.github.com/users/marcphilipp/events{/privacy}","received_events_url":"https://api.github.com/users/marcphilipp/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":12,"state":"closed","created_at":"2020-10-04T07:30:29Z","updated_at":"2021-05-07T12:49:52Z","due_on":"2021-02-04T08:00:00Z","closed_at":"2021-02-04T20:01:17Z"},"comments":2,"created_at":"2020-10-03T20:23:53Z","updated_at":"2020-10-25T05:07:23Z","closed_at":"2020-10-25T05:07:23Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"While the JAR file specification doesn't mention this, the `java.util.jar.JarInputStream` implementation assumes that `META-INF/MANIFEST.MF` is the first or second entry in a jar file.\r\n\r\nFrom the `JarInputStream` sources:\r\n> // This implementation assumes the META-INF/MANIFEST.MF entry\r\n> // should be either the first or the second entry (when preceded\r\n> // by the dir META-INF/). It skips the META-INF/ and then\r\n> // \"consumes\" the MANIFEST.MF to initialize the Manifest object.\r\n\r\nAlso the [Java Archive Tool Documentation](https://docs.oracle.com/javase/7/docs/technotes/tools/solaris/jar.html) mentions:\r\n\r\n> The jar tool automatically generates a manifest file entry named META-INF/MANIFEST.MF. It is always the first entry in the jar file. \r\n\r\nCommit 5631ebc (#2217) introduced reproducible builds. Part of this is `java-repackage-jars` plugin, which sorts jar entries alphabetically. For junit-platform-commons, this results in the following first entries:\r\n\r\n> META-INF/\r\n> META-INF/LICENSE-notice.md\r\n> META-INF/LICENSE.md\r\n> META-INF/MANIFEST.MF\r\n\r\nEvidently, this causes issues with any tools implemented using `JarInputStream`.\r\n\r\n## Steps to reproduce\r\n\r\n- download [junit-platform-commons-1.7.0.jar](https://search.maven.org/remotecontent?filepath=org/junit/platform/junit-platform-commons/1.7.0/junit-platform-commons-1.7.0.jar)\r\n- `unzip -l junit-platform-commons-1.7.0.jar` (or list the file contents in another way)\r\n\r\nNote: my real scenario involved [code in an Apache Sling module](https://github.com/apache/sling-org-apache-sling-installer-core/blob/master/src/main/java/org/apache/sling/installer/core/impl/Util.java#L74)\r\n\r\n## Desired outcome\r\n\r\nIt would be nice if `MANIFEST.MF` could be sorted to the top of the list for reproducible builds.\r\n\r\n\r\n","closed_by":{"login":"sormuras","id":2319838,"node_id":"MDQ6VXNlcjIzMTk4Mzg=","avatar_url":"https://avatars.githubusercontent.com/u/2319838?v=4","gravatar_id":"","url":"https://api.github.com/users/sormuras","html_url":"https://github.com/sormuras","followers_url":"https://api.github.com/users/sormuras/followers","following_url":"https://api.github.com/users/sormuras/following{/other_user}","gists_url":"https://api.github.com/users/sormuras/gists{/gist_id}","starred_url":"https://api.github.com/users/sormuras/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sormuras/subscriptions","organizations_url":"https://api.github.com/users/sormuras/orgs","repos_url":"https://api.github.com/users/sormuras/repos","events_url":"https://api.github.com/users/sormuras/events{/privacy}","received_events_url":"https://api.github.com/users/sormuras/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/junit-team/junit-framework/issues/2438/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/junit-team/junit-framework/issues/2438/timeline","performed_via_github_app":null,"state_reason":"completed"}