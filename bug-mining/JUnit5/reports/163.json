{"url":"https://api.github.com/repos/junit-team/junit-framework/issues/1234","repository_url":"https://api.github.com/repos/junit-team/junit-framework","labels_url":"https://api.github.com/repos/junit-team/junit-framework/issues/1234/labels{/name}","comments_url":"https://api.github.com/repos/junit-team/junit-framework/issues/1234/comments","events_url":"https://api.github.com/repos/junit-team/junit-framework/issues/1234/events","html_url":"https://github.com/junit-team/junit-framework/issues/1234","id":286639074,"node_id":"MDU6SXNzdWUyODY2MzkwNzQ=","number":1234,"title":"Setting launcher main class name to an empty string breaks test execution on Linux","user":{"login":"cmakshin","id":26673754,"node_id":"MDQ6VXNlcjI2NjczNzU0","avatar_url":"https://avatars.githubusercontent.com/u/26673754?v=4","gravatar_id":"","url":"https://api.github.com/users/cmakshin","html_url":"https://github.com/cmakshin","followers_url":"https://api.github.com/users/cmakshin/followers","following_url":"https://api.github.com/users/cmakshin/following{/other_user}","gists_url":"https://api.github.com/users/cmakshin/gists{/gist_id}","starred_url":"https://api.github.com/users/cmakshin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cmakshin/subscriptions","organizations_url":"https://api.github.com/users/cmakshin/orgs","repos_url":"https://api.github.com/users/cmakshin/repos","events_url":"https://api.github.com/users/cmakshin/events{/privacy}","received_events_url":"https://api.github.com/users/cmakshin/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":165165178,"node_id":"MDU6TGFiZWwxNjUxNjUxNzg=","url":"https://api.github.com/repos/junit-team/junit-framework/labels/type:%20bug","name":"type: bug","color":"fc2929","default":false,"description":null},{"id":420912036,"node_id":"MDU6TGFiZWw0MjA5MTIwMzY=","url":"https://api.github.com/repos/junit-team/junit-framework/labels/component:%20Platform","name":"component: Platform","color":"11dd99","default":false,"description":null},{"id":579366233,"node_id":"MDU6TGFiZWw1NzkzNjYyMzM=","url":"https://api.github.com/repos/junit-team/junit-framework/labels/theme:%20modules","name":"theme: modules","color":"C3A77B","default":false,"description":""},{"id":629660080,"node_id":"MDU6TGFiZWw2Mjk2NjAwODA=","url":"https://api.github.com/repos/junit-team/junit-framework/labels/3rd-party:%20Gradle","name":"3rd-party: Gradle","color":"23427f","default":false,"description":""}],"state":"closed","locked":false,"assignee":{"login":"sormuras","id":2319838,"node_id":"MDQ6VXNlcjIzMTk4Mzg=","avatar_url":"https://avatars.githubusercontent.com/u/2319838?v=4","gravatar_id":"","url":"https://api.github.com/users/sormuras","html_url":"https://github.com/sormuras","followers_url":"https://api.github.com/users/sormuras/followers","following_url":"https://api.github.com/users/sormuras/following{/other_user}","gists_url":"https://api.github.com/users/sormuras/gists{/gist_id}","starred_url":"https://api.github.com/users/sormuras/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sormuras/subscriptions","organizations_url":"https://api.github.com/users/sormuras/orgs","repos_url":"https://api.github.com/users/sormuras/repos","events_url":"https://api.github.com/users/sormuras/events{/privacy}","received_events_url":"https://api.github.com/users/sormuras/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"sormuras","id":2319838,"node_id":"MDQ6VXNlcjIzMTk4Mzg=","avatar_url":"https://avatars.githubusercontent.com/u/2319838?v=4","gravatar_id":"","url":"https://api.github.com/users/sormuras","html_url":"https://github.com/sormuras","followers_url":"https://api.github.com/users/sormuras/followers","following_url":"https://api.github.com/users/sormuras/following{/other_user}","gists_url":"https://api.github.com/users/sormuras/gists{/gist_id}","starred_url":"https://api.github.com/users/sormuras/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sormuras/subscriptions","organizations_url":"https://api.github.com/users/sormuras/orgs","repos_url":"https://api.github.com/users/sormuras/repos","events_url":"https://api.github.com/users/sormuras/events{/privacy}","received_events_url":"https://api.github.com/users/sormuras/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":{"url":"https://api.github.com/repos/junit-team/junit-framework/milestones/18","html_url":"https://github.com/junit-team/junit-framework/milestone/18","labels_url":"https://api.github.com/repos/junit-team/junit-framework/milestones/18/labels","id":2919347,"node_id":"MDk6TWlsZXN0b25lMjkxOTM0Nw==","number":18,"title":"5.1 M2","description":"Programmatic extension registration via `@RegisterExtension`, `@EnabledIf` annotation for conditional test execution controlled by dynamic scripting languages, improved implicit conversion support for `@ParameterizedTest` arguments, refinements to the `ExtensionContext` API, support for re-running individual dynamic test and test template invocations within an IDE, new tag expression language, minor bug fixes, and various additional enhancements.\r\n","creator":{"login":"marcphilipp","id":214207,"node_id":"MDQ6VXNlcjIxNDIwNw==","avatar_url":"https://avatars.githubusercontent.com/u/214207?v=4","gravatar_id":"","url":"https://api.github.com/users/marcphilipp","html_url":"https://github.com/marcphilipp","followers_url":"https://api.github.com/users/marcphilipp/followers","following_url":"https://api.github.com/users/marcphilipp/following{/other_user}","gists_url":"https://api.github.com/users/marcphilipp/gists{/gist_id}","starred_url":"https://api.github.com/users/marcphilipp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marcphilipp/subscriptions","organizations_url":"https://api.github.com/users/marcphilipp/orgs","repos_url":"https://api.github.com/users/marcphilipp/repos","events_url":"https://api.github.com/users/marcphilipp/events{/privacy}","received_events_url":"https://api.github.com/users/marcphilipp/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":41,"state":"closed","created_at":"2017-11-17T09:42:01Z","updated_at":"2018-01-28T20:31:33Z","due_on":"2018-01-28T08:00:00Z","closed_at":"2018-01-28T19:55:17Z"},"comments":3,"created_at":"2018-01-08T04:05:51Z","updated_at":"2018-01-16T09:59:21Z","closed_at":"2018-01-16T09:59:21Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"Using Java 9 module path instead of classpath by specifying\r\n```\r\njunitPlatform {\r\n   enableModulePath = true\r\n}\r\n```\r\nmakes Gradle plugin clear the main class name string:\r\nhttps://github.com/junit-team/junit5/blob/a94ef93a68edd481673a81db86b2f4d844a3e063/junit-platform-gradle-plugin/src/main/groovy/org/junit/platform/gradle/plugin/JUnitPlatformPlugin.groovy#L133\r\n\r\nThe problem is that Gradle's `JavaExec` task unconditionally adds the main class name to the list of command line parameters:\r\nhttps://github.com/gradle/gradle/blob/master/subprojects/core/src/main/java/org/gradle/process/internal/JavaExecHandleBuilder.java#L219\r\n```\r\npublic List<String> getAllArguments() {\r\n    List<String> arguments = new ArrayList<String>();\r\n    arguments.addAll(getAllJvmArgs());\r\n    arguments.add(mainClass);\r\n    arguments.addAll(getArgs());\r\n    return arguments;\r\n}\r\n```\r\nThis breaks test execution on systems which natively support passing command line parameters as an array of strings (at least on Linux but other Unix-like systems are likely to be affected too) because JVM launcher treats this empty string as the main class name (_By default, the first argument that isnâ€™t an option of the `java` command is the fully qualified name of the class to be called_) and fails with the following error:\r\n```\r\nError: Could not find or load main class \r\nCaused by: java.lang.ClassNotFoundException: \r\njava.lang.ClassNotFoundException: \r\n\tat java.base/java.lang.Class.forName0(Native Method)\r\n\tat java.base/java.lang.Class.forName(Class.java:375)\r\n\tat java.base/sun.launcher.LauncherHelper.loadMainClass(LauncherHelper.java:654)\r\n\tat java.base/sun.launcher.LauncherHelper.checkAndLoadMain(LauncherHelper.java:551)\r\n```\r\n\r\nGradle's bug tracker already contains a somewhat related report (https://github.com/gradle/gradle/issues/1346) about the \"-jar\" option for executable JARs. `main = '-jar'` is suggested as a workaround there so moving the \"--module\" option from `args` to `main` may be used in this case.\r\n\r\nTemporary solution for end-users:\r\n```\r\njunitPlatformTest {\r\n    doFirst {\r\n        args = args.subList(1, args.size())\r\n        main = '--module'\r\n    }\r\n}\r\n```\r\n\r\nGradle 4.4.1\r\nOracle JDK 9.0.1 on Debian GNU/Linux\r\nJUnit Platform 1.1.0-M1\r\nJUnit Jupiter 5.1.0-M1\r\nTest project: https://github.com/cmakshin/junit5-bugs (does not include the temporary solution shown above)","closed_by":{"login":"sormuras","id":2319838,"node_id":"MDQ6VXNlcjIzMTk4Mzg=","avatar_url":"https://avatars.githubusercontent.com/u/2319838?v=4","gravatar_id":"","url":"https://api.github.com/users/sormuras","html_url":"https://github.com/sormuras","followers_url":"https://api.github.com/users/sormuras/followers","following_url":"https://api.github.com/users/sormuras/following{/other_user}","gists_url":"https://api.github.com/users/sormuras/gists{/gist_id}","starred_url":"https://api.github.com/users/sormuras/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sormuras/subscriptions","organizations_url":"https://api.github.com/users/sormuras/orgs","repos_url":"https://api.github.com/users/sormuras/repos","events_url":"https://api.github.com/users/sormuras/events{/privacy}","received_events_url":"https://api.github.com/users/sormuras/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/junit-team/junit-framework/issues/1234/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/junit-team/junit-framework/issues/1234/timeline","performed_via_github_app":null,"state_reason":"completed"}