{"url":"https://api.github.com/repos/junit-team/junit-framework/issues/2982","repository_url":"https://api.github.com/repos/junit-team/junit-framework","labels_url":"https://api.github.com/repos/junit-team/junit-framework/issues/2982/labels{/name}","comments_url":"https://api.github.com/repos/junit-team/junit-framework/issues/2982/comments","events_url":"https://api.github.com/repos/junit-team/junit-framework/issues/2982/events","html_url":"https://github.com/junit-team/junit-framework/issues/2982","id":1315895681,"node_id":"I_kwDOAbwRH85ObvmB","number":2982,"title":"Execution mode is needlessly restrictive for containers without execution behavior but with isolated children","user":{"login":"mpkorstanje","id":6946919,"node_id":"MDQ6VXNlcjY5NDY5MTk=","avatar_url":"https://avatars.githubusercontent.com/u/6946919?v=4","gravatar_id":"","url":"https://api.github.com/users/mpkorstanje","html_url":"https://github.com/mpkorstanje","followers_url":"https://api.github.com/users/mpkorstanje/followers","following_url":"https://api.github.com/users/mpkorstanje/following{/other_user}","gists_url":"https://api.github.com/users/mpkorstanje/gists{/gist_id}","starred_url":"https://api.github.com/users/mpkorstanje/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mpkorstanje/subscriptions","organizations_url":"https://api.github.com/users/mpkorstanje/orgs","repos_url":"https://api.github.com/users/mpkorstanje/repos","events_url":"https://api.github.com/users/mpkorstanje/events{/privacy}","received_events_url":"https://api.github.com/users/mpkorstanje/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":165165180,"node_id":"MDU6TGFiZWwxNjUxNjUxODA=","url":"https://api.github.com/repos/junit-team/junit-framework/labels/type:%20enhancement","name":"type: enhancement","color":"84b6eb","default":false,"description":null},{"id":293488747,"node_id":"MDU6TGFiZWwyOTM0ODg3NDc=","url":"https://api.github.com/repos/junit-team/junit-framework/labels/theme:%20execution","name":"theme: execution","color":"fbca04","default":false,"description":null},{"id":318079877,"node_id":"MDU6TGFiZWwzMTgwNzk4Nzc=","url":"https://api.github.com/repos/junit-team/junit-framework/labels/theme:%20concurrency","name":"theme: concurrency","color":"eeccff","default":false,"description":null},{"id":420912036,"node_id":"MDU6TGFiZWw0MjA5MTIwMzY=","url":"https://api.github.com/repos/junit-team/junit-framework/labels/component:%20Platform","name":"component: Platform","color":"11dd99","default":false,"description":null}],"state":"closed","locked":false,"assignee":{"login":"marcphilipp","id":214207,"node_id":"MDQ6VXNlcjIxNDIwNw==","avatar_url":"https://avatars.githubusercontent.com/u/214207?v=4","gravatar_id":"","url":"https://api.github.com/users/marcphilipp","html_url":"https://github.com/marcphilipp","followers_url":"https://api.github.com/users/marcphilipp/followers","following_url":"https://api.github.com/users/marcphilipp/following{/other_user}","gists_url":"https://api.github.com/users/marcphilipp/gists{/gist_id}","starred_url":"https://api.github.com/users/marcphilipp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marcphilipp/subscriptions","organizations_url":"https://api.github.com/users/marcphilipp/orgs","repos_url":"https://api.github.com/users/marcphilipp/repos","events_url":"https://api.github.com/users/marcphilipp/events{/privacy}","received_events_url":"https://api.github.com/users/marcphilipp/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"marcphilipp","id":214207,"node_id":"MDQ6VXNlcjIxNDIwNw==","avatar_url":"https://avatars.githubusercontent.com/u/214207?v=4","gravatar_id":"","url":"https://api.github.com/users/marcphilipp","html_url":"https://github.com/marcphilipp","followers_url":"https://api.github.com/users/marcphilipp/followers","following_url":"https://api.github.com/users/marcphilipp/following{/other_user}","gists_url":"https://api.github.com/users/marcphilipp/gists{/gist_id}","starred_url":"https://api.github.com/users/marcphilipp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marcphilipp/subscriptions","organizations_url":"https://api.github.com/users/marcphilipp/orgs","repos_url":"https://api.github.com/users/marcphilipp/repos","events_url":"https://api.github.com/users/marcphilipp/events{/privacy}","received_events_url":"https://api.github.com/users/marcphilipp/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":{"url":"https://api.github.com/repos/junit-team/junit-framework/milestones/104","html_url":"https://github.com/junit-team/junit-framework/milestone/104","labels_url":"https://api.github.com/repos/junit-team/junit-framework/milestones/104/labels","id":13496059,"node_id":"MI_kwDOAbwRH84Aze77","number":104,"title":"6.1.0-M1","description":null,"creator":{"login":"marcphilipp","id":214207,"node_id":"MDQ6VXNlcjIxNDIwNw==","avatar_url":"https://avatars.githubusercontent.com/u/214207?v=4","gravatar_id":"","url":"https://api.github.com/users/marcphilipp","html_url":"https://github.com/marcphilipp","followers_url":"https://api.github.com/users/marcphilipp/followers","following_url":"https://api.github.com/users/marcphilipp/following{/other_user}","gists_url":"https://api.github.com/users/marcphilipp/gists{/gist_id}","starred_url":"https://api.github.com/users/marcphilipp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marcphilipp/subscriptions","organizations_url":"https://api.github.com/users/marcphilipp/orgs","repos_url":"https://api.github.com/users/marcphilipp/repos","events_url":"https://api.github.com/users/marcphilipp/events{/privacy}","received_events_url":"https://api.github.com/users/marcphilipp/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":5,"closed_issues":13,"state":"open","created_at":"2025-08-15T10:55:40Z","updated_at":"2025-11-07T16:58:56Z","due_on":null,"closed_at":null},"comments":2,"created_at":"2022-07-24T12:32:44Z","updated_at":"2025-10-29T15:43:17Z","closed_at":"2025-10-29T15:43:05Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"## Step to reproduce\r\n\r\nOriginally reported at: https://github.com/cucumber/cucumber-jvm/issues/2589. \r\n\r\nGiven a tree of test descriptors where one test declares a global resource lock:\r\n\r\n```\r\n|- Container A\r\n| |- Test 1 ( .getExclusiveResources() => GLOBAL_READ_WRITE )\r\n| |- Test 2\r\n| \\- Test 3\r\n\\- Container B\r\n  |- Test 4\r\n  |- Test 5\r\n  \\- Test 6\r\n```\r\n\r\nWhen executed in parallel `Container A` is executed with `ExecutionMode.SAME_THREAD`. This reduces the efficiency of parallel execution somewhat as the serial part of the execution now also includes tests 2 and 3.\r\n\r\n## Analysis \r\n\r\nThe same thread execution mode is applied to a container if any of its children has a `GLOBAL_READ_WRITE` lock:\r\n\r\nhttps://github.com/junit-team/junit5/blob/5fdb138924f59703a6a4fcd0cdcde6d1a224a950/junit-platform-engine/src/main/java/org/junit/platform/engine/support/hierarchical/NodeTreeWalker.java#L73-L76\r\n\r\nThe rationale for this behaviour is given in https://github.com/junit-team/junit5/issues/2038#issuecomment-541171707:\r\n> The (pessimistic) assumption behind forcing children of containers with resource locks to use execution mode SAME_THREAD is that the resource might not be safe to access in e.g. `@BeforeAll` methods and in different threads from `@Test` methods. Thus it's not the same as having `@ResourceLock` on every `@Test` method. IIRC we had a similar issue for `@Execution` only applying to methods while being declared on the class level.\r\n\r\nWhile this is true for JUnit Jupiter, this is not the case for Cucumber. In Cucumber containers do not execute any hooks.\r\n\r\nProviding containers with a way to signal that they are mere containers would allow the coarsened execution mode to be applied more selectively.","closed_by":{"login":"marcphilipp","id":214207,"node_id":"MDQ6VXNlcjIxNDIwNw==","avatar_url":"https://avatars.githubusercontent.com/u/214207?v=4","gravatar_id":"","url":"https://api.github.com/users/marcphilipp","html_url":"https://github.com/marcphilipp","followers_url":"https://api.github.com/users/marcphilipp/followers","following_url":"https://api.github.com/users/marcphilipp/following{/other_user}","gists_url":"https://api.github.com/users/marcphilipp/gists{/gist_id}","starred_url":"https://api.github.com/users/marcphilipp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marcphilipp/subscriptions","organizations_url":"https://api.github.com/users/marcphilipp/orgs","repos_url":"https://api.github.com/users/marcphilipp/repos","events_url":"https://api.github.com/users/marcphilipp/events{/privacy}","received_events_url":"https://api.github.com/users/marcphilipp/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/junit-team/junit-framework/issues/2982/reactions","total_count":6,"+1":6,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/junit-team/junit-framework/issues/2982/timeline","performed_via_github_app":null,"state_reason":"completed"}