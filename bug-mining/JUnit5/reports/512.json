{"url":"https://api.github.com/repos/junit-team/junit-framework/issues/3000","repository_url":"https://api.github.com/repos/junit-team/junit-framework","labels_url":"https://api.github.com/repos/junit-team/junit-framework/issues/3000/labels{/name}","comments_url":"https://api.github.com/repos/junit-team/junit-framework/issues/3000/comments","events_url":"https://api.github.com/repos/junit-team/junit-framework/issues/3000/events","html_url":"https://github.com/junit-team/junit-framework/issues/3000","id":1331591248,"node_id":"I_kwDOAbwRH85PXnhQ","number":3000,"title":"Timeout incorrectly reported instead of actual failing assertion when using isEqualTo with SEPARATE_THREAD","user":{"login":"mabre","id":7281921,"node_id":"MDQ6VXNlcjcyODE5MjE=","avatar_url":"https://avatars.githubusercontent.com/u/7281921?v=4","gravatar_id":"","url":"https://api.github.com/users/mabre","html_url":"https://github.com/mabre","followers_url":"https://api.github.com/users/mabre/followers","following_url":"https://api.github.com/users/mabre/following{/other_user}","gists_url":"https://api.github.com/users/mabre/gists{/gist_id}","starred_url":"https://api.github.com/users/mabre/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mabre/subscriptions","organizations_url":"https://api.github.com/users/mabre/orgs","repos_url":"https://api.github.com/users/mabre/repos","events_url":"https://api.github.com/users/mabre/events{/privacy}","received_events_url":"https://api.github.com/users/mabre/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":165165178,"node_id":"MDU6TGFiZWwxNjUxNjUxNzg=","url":"https://api.github.com/repos/junit-team/junit-framework/labels/type:%20bug","name":"type: bug","color":"fc2929","default":false,"description":null},{"id":293488747,"node_id":"MDU6TGFiZWwyOTM0ODg3NDc=","url":"https://api.github.com/repos/junit-team/junit-framework/labels/theme:%20execution","name":"theme: execution","color":"fbca04","default":false,"description":null},{"id":420911923,"node_id":"MDU6TGFiZWw0MjA5MTE5MjM=","url":"https://api.github.com/repos/junit-team/junit-framework/labels/component:%20Jupiter","name":"component: Jupiter","color":"11ee99","default":false,"description":null}],"state":"closed","locked":false,"assignee":{"login":"gilbertojrequena","id":3902492,"node_id":"MDQ6VXNlcjM5MDI0OTI=","avatar_url":"https://avatars.githubusercontent.com/u/3902492?v=4","gravatar_id":"","url":"https://api.github.com/users/gilbertojrequena","html_url":"https://github.com/gilbertojrequena","followers_url":"https://api.github.com/users/gilbertojrequena/followers","following_url":"https://api.github.com/users/gilbertojrequena/following{/other_user}","gists_url":"https://api.github.com/users/gilbertojrequena/gists{/gist_id}","starred_url":"https://api.github.com/users/gilbertojrequena/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gilbertojrequena/subscriptions","organizations_url":"https://api.github.com/users/gilbertojrequena/orgs","repos_url":"https://api.github.com/users/gilbertojrequena/repos","events_url":"https://api.github.com/users/gilbertojrequena/events{/privacy}","received_events_url":"https://api.github.com/users/gilbertojrequena/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"gilbertojrequena","id":3902492,"node_id":"MDQ6VXNlcjM5MDI0OTI=","avatar_url":"https://avatars.githubusercontent.com/u/3902492?v=4","gravatar_id":"","url":"https://api.github.com/users/gilbertojrequena","html_url":"https://github.com/gilbertojrequena","followers_url":"https://api.github.com/users/gilbertojrequena/followers","following_url":"https://api.github.com/users/gilbertojrequena/following{/other_user}","gists_url":"https://api.github.com/users/gilbertojrequena/gists{/gist_id}","starred_url":"https://api.github.com/users/gilbertojrequena/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gilbertojrequena/subscriptions","organizations_url":"https://api.github.com/users/gilbertojrequena/orgs","repos_url":"https://api.github.com/users/gilbertojrequena/repos","events_url":"https://api.github.com/users/gilbertojrequena/events{/privacy}","received_events_url":"https://api.github.com/users/gilbertojrequena/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":{"url":"https://api.github.com/repos/junit-team/junit-framework/milestones/63","html_url":"https://github.com/junit-team/junit-framework/milestone/63","labels_url":"https://api.github.com/repos/junit-team/junit-framework/milestones/63/labels","id":8265813,"node_id":"MI_kwDOAbwRH84AfiBV","number":63,"title":"5.9.1","description":"","creator":{"login":"sbrannen","id":104798,"node_id":"MDQ6VXNlcjEwNDc5OA==","avatar_url":"https://avatars.githubusercontent.com/u/104798?v=4","gravatar_id":"","url":"https://api.github.com/users/sbrannen","html_url":"https://github.com/sbrannen","followers_url":"https://api.github.com/users/sbrannen/followers","following_url":"https://api.github.com/users/sbrannen/following{/other_user}","gists_url":"https://api.github.com/users/sbrannen/gists{/gist_id}","starred_url":"https://api.github.com/users/sbrannen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sbrannen/subscriptions","organizations_url":"https://api.github.com/users/sbrannen/orgs","repos_url":"https://api.github.com/users/sbrannen/repos","events_url":"https://api.github.com/users/sbrannen/events{/privacy}","received_events_url":"https://api.github.com/users/sbrannen/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":9,"state":"closed","created_at":"2022-08-03T15:43:07Z","updated_at":"2022-09-20T19:33:07Z","due_on":"2022-09-20T07:00:00Z","closed_at":"2022-09-20T19:33:07Z"},"comments":7,"created_at":"2022-08-08T09:29:53Z","updated_at":"2022-09-11T15:26:48Z","closed_at":"2022-09-11T15:26:26Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"In some cases, JUnit reports an exceeded timeout although it is not exceeded. This seems to happen when using `SEPARATE_THREAD` and `isEqualTo`.\r\n\r\n## Steps to reproduce\r\n\r\ncode to reproduce: https://github.com/hhu-progra/junit-timeout/\r\n\r\nrun `./gradlew test`\r\n\r\n### Actual result:\r\n\r\nThe project contains two unit tests. Both (deliberatly) have failing assertions, but no timeout should occur.\r\n\r\nFor the first test (which uses `isEqualTo`), JUnit reports:\r\n\r\n```\r\nExampleTest > test_reports_timeout_incorrectly() FAILED\r\n    java.util.concurrent.TimeoutException: test_reports_timeout_incorrectly() timed out after 10 seconds\r\n        at org.junit.jupiter.engine.extension.TimeoutExceptionFactory.create(TimeoutExceptionFactory.java:29)\r\n        at org.junit.jupiter.engine.extension.SeparateThreadTimeoutInvocation.proceed(SeparateThreadTimeoutInvocation.java:43)\r\n        at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:156)\r\nâ€¦\r\n```\r\n\r\nThe tests run within 2 seconds, so reporting an exceeded timeout seems like a bug.\r\n\r\n\r\n### Expected:\r\n\r\n```\r\nExampleTest > test_reports_timeout_incorrectly() FAILED\r\n    org.opentest4j.AssertionFailedError: \r\n    expected: 21\r\n     but was: 42\r\n        at java.base@17.0.3/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\r\n        at java.base@17.0.3/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:77)\r\n        at java.base@17.0.3/jdk.internal.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)\r\n        at java.base@17.0.3/java.lang.reflect.Constructor.newInstanceWithCaller(Constructor.java:499)\r\n        at app//ExampleTest.test_reports_timeout_incorrectly(ExampleTest.java:8)\r\n```\r\n\r\nYou get this expected output when removing `systemProperty \"junit.jupiter.execution.timeout.default\", \"10\"` or `systemProperty \"junit.jupiter.execution.timeout.thread.mode.default\", \"SEPARATE_THREAD\"` from `build.gradle`.\r\n\r\nNote that the test using `contains` (and no `isEqualTo`) runs just fine in any case.\r\n\r\nI just skimmed through the code and would guess that `SeparateThreadTimeoutInvocation` should check whether `failure.cause` is an `ExecutionTimeoutException` [here](https://github.com/junit-team/junit5/blob/e7130723ba11f8a6e14db141f5239d132f8284d4/junit-jupiter-engine/src/main/java/org/junit/jupiter/engine/extension/SeparateThreadTimeoutInvocation.java#L42).\r\n\r\n## Context\r\n\r\n - Used versions (Jupiter/Vintage/Platform): JUnit 5.9.0, Platform 1.9.0, AssertJ 3.23.1\r\n - Build Tool/IDE: Gradle 7.4","closed_by":{"login":"marcphilipp","id":214207,"node_id":"MDQ6VXNlcjIxNDIwNw==","avatar_url":"https://avatars.githubusercontent.com/u/214207?v=4","gravatar_id":"","url":"https://api.github.com/users/marcphilipp","html_url":"https://github.com/marcphilipp","followers_url":"https://api.github.com/users/marcphilipp/followers","following_url":"https://api.github.com/users/marcphilipp/following{/other_user}","gists_url":"https://api.github.com/users/marcphilipp/gists{/gist_id}","starred_url":"https://api.github.com/users/marcphilipp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marcphilipp/subscriptions","organizations_url":"https://api.github.com/users/marcphilipp/orgs","repos_url":"https://api.github.com/users/marcphilipp/repos","events_url":"https://api.github.com/users/marcphilipp/events{/privacy}","received_events_url":"https://api.github.com/users/marcphilipp/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/junit-team/junit-framework/issues/3000/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/junit-team/junit-framework/issues/3000/timeline","performed_via_github_app":null,"state_reason":"completed"}