{"url":"https://api.github.com/repos/remix-run/react-router/issues/14368","repository_url":"https://api.github.com/repos/remix-run/react-router","labels_url":"https://api.github.com/repos/remix-run/react-router/issues/14368/labels{/name}","comments_url":"https://api.github.com/repos/remix-run/react-router/issues/14368/comments","events_url":"https://api.github.com/repos/remix-run/react-router/issues/14368/events","html_url":"https://github.com/remix-run/react-router/issues/14368","id":3443089736,"node_id":"I_kwDOAS86yM7NOWFI","number":14368,"title":"Preset future flags are completely ignored","user":{"login":"juanpprieto","id":12080141,"node_id":"MDQ6VXNlcjEyMDgwMTQx","avatar_url":"https://avatars.githubusercontent.com/u/12080141?v=4","gravatar_id":"","url":"https://api.github.com/users/juanpprieto","html_url":"https://github.com/juanpprieto","followers_url":"https://api.github.com/users/juanpprieto/followers","following_url":"https://api.github.com/users/juanpprieto/following{/other_user}","gists_url":"https://api.github.com/users/juanpprieto/gists{/gist_id}","starred_url":"https://api.github.com/users/juanpprieto/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/juanpprieto/subscriptions","organizations_url":"https://api.github.com/users/juanpprieto/orgs","repos_url":"https://api.github.com/users/juanpprieto/repos","events_url":"https://api.github.com/users/juanpprieto/events{/privacy}","received_events_url":"https://api.github.com/users/juanpprieto/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":7739672529,"node_id":"LA_kwDOAS86yM8AAAABzVIH0Q","url":"https://api.github.com/repos/remix-run/react-router/labels/pkg:@react-router/dev","name":"pkg:@react-router/dev","color":"3992ff","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2025-09-22T23:18:32Z","updated_at":"2025-09-24T15:44:44Z","closed_at":"2025-09-23T15:25:39Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"## Description\n\nPreset-defined future flags are completely ignored during configuration resolution. The bug prevents presets from enabling experimental features, which is critical functionality for third-party integrations and hosting providers.\n\n## Current Behavior\n\nWhen a preset defines future flags in its `reactRouterConfig` hook, these flags are ignored and always resolve to `false`, regardless of the preset's configuration.\n\n## Expected Behavior\n\nPresets should be able to set future flags that are properly merged with user configuration, following the documented preset merging order where user config takes precedence over preset config.\n\n\n# Repro\n\nhttps://stackblitz.com/edit/github-9jrvk31k?file=react-router.config.ts\n\n\n### Failing Test\n\n```\npnpm test:integration --grep=\"presets\"\n\n  16 failed\n    [chromium] › vite-presets-test.ts:159:5 › Vite / presets › Vite 5\n    [chromium] › vite-presets-test.ts:159:5 › Vite / presets › Vite 6\n    ...\n\nError: Expected: {\n  v8_middleware: true,\n  unstable_optimizeDeps: true,\n  unstable_splitRouteModules: false,\n  unstable_subResourceIntegrity: false,\n  unstable_viteEnvironmentApi: false\n}\n\nReceived: {\n  v8_middleware: false,\n  unstable_optimizeDeps: false,\n  unstable_splitRouteModules: false,\n  unstable_subResourceIntegrity: false,\n  unstable_viteEnvironmentApi: false\n}\n\n  245 |       expect(buildEndArgsMeta.futureFlags).toEqual({\n  246 |         v8_middleware: true,\n  247 |         unstable_optimizeDeps: true,\n  248 |         unstable_splitRouteModules: false,\n      at /Users/juanp.prieto/github.com/Shopify/react-router/integration/vite-presets-test.ts:245:44\n```\n\n## Failing Test Case\n\n```typescript\n// Preset that sets future flags\n{\n  name: \"test-preset\",\n  reactRouterConfig: async () => ({\n    future: {\n      v8_middleware: true,\n      unstable_optimizeDeps: true,\n    },\n  }),\n},\n\n// Test assertion\nexpect(buildEndArgsMeta.futureFlags).toEqual({\n  v8_middleware: true,\n  unstable_optimizeDeps: true,\n  unstable_splitRouteModules: false,\n  unstable_subResourceIntegrity: false,\n  unstable_viteEnvironmentApi: false,\n});\n```\n","closed_by":{"login":"brophdawg11","id":1609022,"node_id":"MDQ6VXNlcjE2MDkwMjI=","avatar_url":"https://avatars.githubusercontent.com/u/1609022?v=4","gravatar_id":"","url":"https://api.github.com/users/brophdawg11","html_url":"https://github.com/brophdawg11","followers_url":"https://api.github.com/users/brophdawg11/followers","following_url":"https://api.github.com/users/brophdawg11/following{/other_user}","gists_url":"https://api.github.com/users/brophdawg11/gists{/gist_id}","starred_url":"https://api.github.com/users/brophdawg11/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/brophdawg11/subscriptions","organizations_url":"https://api.github.com/users/brophdawg11/orgs","repos_url":"https://api.github.com/users/brophdawg11/repos","events_url":"https://api.github.com/users/brophdawg11/events{/privacy}","received_events_url":"https://api.github.com/users/brophdawg11/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/remix-run/react-router/issues/14368/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/remix-run/react-router/issues/14368/timeline","performed_via_github_app":null,"state_reason":"completed"}