{"url":"https://api.github.com/repos/teamcapybara/capybara/issues/982","repository_url":"https://api.github.com/repos/teamcapybara/capybara","labels_url":"https://api.github.com/repos/teamcapybara/capybara/issues/982/labels{/name}","comments_url":"https://api.github.com/repos/teamcapybara/capybara/issues/982/comments","events_url":"https://api.github.com/repos/teamcapybara/capybara/issues/982/events","html_url":"https://github.com/teamcapybara/capybara/issues/982","id":11460748,"node_id":"MDU6SXNzdWUxMTQ2MDc0OA==","number":982,"title":"Create `have_disabled_field` matcher","user":{"login":"sobrinho","id":26460,"node_id":"MDQ6VXNlcjI2NDYw","avatar_url":"https://avatars.githubusercontent.com/u/26460?v=4","gravatar_id":"","url":"https://api.github.com/users/sobrinho","html_url":"https://github.com/sobrinho","followers_url":"https://api.github.com/users/sobrinho/followers","following_url":"https://api.github.com/users/sobrinho/following{/other_user}","gists_url":"https://api.github.com/users/sobrinho/gists{/gist_id}","starred_url":"https://api.github.com/users/sobrinho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sobrinho/subscriptions","organizations_url":"https://api.github.com/users/sobrinho/orgs","repos_url":"https://api.github.com/users/sobrinho/repos","events_url":"https://api.github.com/users/sobrinho/events{/privacy}","received_events_url":"https://api.github.com/users/sobrinho/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":37721,"node_id":"MDU6TGFiZWwzNzcyMQ==","url":"https://api.github.com/repos/teamcapybara/capybara/labels/Feature","name":"Feature","color":"6ef203","default":false,"description":null}],"state":"closed","locked":true,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/teamcapybara/capybara/milestones/6","html_url":"https://github.com/teamcapybara/capybara/milestone/6","labels_url":"https://api.github.com/repos/teamcapybara/capybara/milestones/6/labels","id":171620,"node_id":"MDk6TWlsZXN0b25lMTcxNjIw","number":6,"title":"Capybara 2.1","description":"","creator":{"login":"jnicklas","id":134,"node_id":"MDQ6VXNlcjEzNA==","avatar_url":"https://avatars.githubusercontent.com/u/134?v=4","gravatar_id":"","url":"https://api.github.com/users/jnicklas","html_url":"https://github.com/jnicklas","followers_url":"https://api.github.com/users/jnicklas/followers","following_url":"https://api.github.com/users/jnicklas/following{/other_user}","gists_url":"https://api.github.com/users/jnicklas/gists{/gist_id}","starred_url":"https://api.github.com/users/jnicklas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jnicklas/subscriptions","organizations_url":"https://api.github.com/users/jnicklas/orgs","repos_url":"https://api.github.com/users/jnicklas/repos","events_url":"https://api.github.com/users/jnicklas/events{/privacy}","received_events_url":"https://api.github.com/users/jnicklas/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":16,"state":"closed","created_at":"2012-09-07T18:27:51Z","updated_at":"2013-04-09T15:34:27Z","due_on":null,"closed_at":"2013-04-09T15:34:27Z"},"comments":10,"created_at":"2013-02-27T15:47:29Z","updated_at":"2019-08-17T07:13:57Z","closed_at":"2013-03-16T01:10:35Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"Hi,\n\nWhat do you think about creating a `have_disabled_field` matcher?\n\nI often create it in my applications and maybe it fits on capybara by default since it's pretty common.\n\nAn example of usage:\n\n``` ruby\nfill_in 'Value', with: '100.00'\nfill_in 'Discount', with: '10.00%'\n\nexpect(page).to have_disabled_field 'Total', with: '90.00'\n```\n\nThe total field must not be editable and must have the value `90.00` in this example.\n\nI have this one:\n\n``` ruby\nmodule Application                                                                                                                                                   \n  module Matchers                                                                                                                                             \n    extend RSpec::Matchers::DSL                                                                                                                               \n\n    matcher :have_disabled_field do |name, options|                                                                                                           \n      match do |page|                                                                                                                                         \n        selector = XPath.descendant(:input)[XPath.attr(:id).equals(XPath.anywhere(:label)[XPath.string.n.contains(name)].attr(:for))]                         \n\n        field = page.find(:xpath, selector)                                                                                                                   \n\n        expect(field[:disabled]).to eq 'disabled'                                                                                                             \n\n        if options && options.key?(:with)                                                                                                                     \n          expect(field[:value]).to eq options[:with]                                                                                                          \n        end                                                                                                                                                   \n      end                                                                                                                                                     \n\n      failure_message_for_should do |page|                                                                                                                    \n        \"expected page to have disabled field #{name.inspect}\"                                                                                                \n      end                                                                                                                                                     \n\n      failure_message_for_should_not do |page|                                                                                                                \n        \"expected page not to have disabled field #{name.inspect}\"                                                                                            \n      end                                                                                                                                                     \n    end                                                                                                                                                       \n  end                                                                                                                                                         \nend                                                                                                                                                           \n\nRSpec.configure do |config|                                                                                                                                   \n  config.include Application::Matchers, :type => :feature                                                                                                            \nend\n```\n\nIt is not strictly and the error message is useless but it's just an idea.\n\nI would be happy to work in a pull request to add it but I'm not sure where to put it (capybara or `XPath::HTML.disabled_field`).\n\nAn second implementation would be an option on `have_field`:\n\n``` ruby\nfill_in 'Value', with: '100.00'\nfill_in 'Discount', with: '10.00%'\n\nexpect(page).to have_field 'Total', disabled: true, with: '90.00'\n```\n\nI prefer the latter but it requires more effort since `XPath::HTML.field` ignores disabled elements.\n","closed_by":{"login":"jnicklas","id":134,"node_id":"MDQ6VXNlcjEzNA==","avatar_url":"https://avatars.githubusercontent.com/u/134?v=4","gravatar_id":"","url":"https://api.github.com/users/jnicklas","html_url":"https://github.com/jnicklas","followers_url":"https://api.github.com/users/jnicklas/followers","following_url":"https://api.github.com/users/jnicklas/following{/other_user}","gists_url":"https://api.github.com/users/jnicklas/gists{/gist_id}","starred_url":"https://api.github.com/users/jnicklas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jnicklas/subscriptions","organizations_url":"https://api.github.com/users/jnicklas/orgs","repos_url":"https://api.github.com/users/jnicklas/repos","events_url":"https://api.github.com/users/jnicklas/events{/privacy}","received_events_url":"https://api.github.com/users/jnicklas/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/teamcapybara/capybara/issues/982/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/teamcapybara/capybara/issues/982/timeline","performed_via_github_app":null,"state_reason":"completed"}