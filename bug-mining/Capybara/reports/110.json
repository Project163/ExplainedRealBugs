{"url":"https://api.github.com/repos/teamcapybara/capybara/issues/2705","repository_url":"https://api.github.com/repos/teamcapybara/capybara","labels_url":"https://api.github.com/repos/teamcapybara/capybara/issues/2705/labels{/name}","comments_url":"https://api.github.com/repos/teamcapybara/capybara/issues/2705/comments","events_url":"https://api.github.com/repos/teamcapybara/capybara/issues/2705/events","html_url":"https://github.com/teamcapybara/capybara/issues/2705","id":1894785161,"node_id":"I_kwDOAAWDXs5w8CCJ","number":2705,"title":"`Rack::Handler is deprecated` warning when using Rails 7.1 beta and Rack 3","user":{"login":"mattbrictson","id":189693,"node_id":"MDQ6VXNlcjE4OTY5Mw==","avatar_url":"https://avatars.githubusercontent.com/u/189693?v=4","gravatar_id":"","url":"https://api.github.com/users/mattbrictson","html_url":"https://github.com/mattbrictson","followers_url":"https://api.github.com/users/mattbrictson/followers","following_url":"https://api.github.com/users/mattbrictson/following{/other_user}","gists_url":"https://api.github.com/users/mattbrictson/gists{/gist_id}","starred_url":"https://api.github.com/users/mattbrictson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mattbrictson/subscriptions","organizations_url":"https://api.github.com/users/mattbrictson/orgs","repos_url":"https://api.github.com/users/mattbrictson/repos","events_url":"https://api.github.com/users/mattbrictson/events{/privacy}","received_events_url":"https://api.github.com/users/mattbrictson/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2023-09-13T15:33:18Z","updated_at":"2023-12-12T15:57:10Z","closed_at":"2023-10-08T19:40:26Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"## Meta\r\n\r\n- capybara 3.39.2\r\n- rack 3.0.8\r\n- rails 7.1.0.beta1\r\n- selenium-webdriver 4.12.0\r\n- ChromeDriver 116.0.5845.96\r\n- ruby 3.2.2 (2023-03-30 revision e51014f9c0) [x86_64-darwin22]\r\n\r\nUsing the following system test case config:\r\n\r\n```ruby\r\nclass ApplicationSystemTestCase < ActionDispatch::SystemTestCase\r\n  driven_by :selenium,\r\n    using: (ENV[\"SHOW_BROWSER\"] ? :chrome : :headless_chrome),\r\n    screen_size: [1400, 1400] do |options|\r\n      options.add_argument(\"--disable-dev-shm-usage\")\r\n      options.add_argument(\"--no-sandbox\")\r\n    end\r\n\r\n  setup do\r\n    Capybara.default_max_wait_time = 2\r\n    Capybara.disable_animation = true\r\n    Capybara.server = :puma, {Silent: true}\r\n  end\r\nend\r\n```\r\n\r\n## Expected Behavior\r\n\r\nCapybara can be used with Rails 7.1 and Rack 3 without warnings.\r\n\r\n## Actual Behavior\r\n\r\nThe following warning is printed to stderr:\r\n\r\n```\r\nRack::Handler is deprecated and replaced by Rackup::Handler\r\n```\r\n\r\n## Steps to reproduce\r\n\r\nUpgrade a Rails app to Rails 7.1.0.beta1 and run a system test that uses Capybara.\r\n\r\n```\r\n$ bin/rails test:system\r\nRunning 4 tests in a single process (parallelization threshold is 50)\r\nRun options: --seed 27755\r\n\r\n# Running:\r\n\r\nRack::Handler is deprecated and replaced by Rackup::Handler\r\n....\r\n\r\nFinished in 4.122453s, 0.9703 runs/s, 12.1287 assertions/s.\r\n4 runs, 50 assertions, 0 failures, 0 errors, 0 skips\r\n```\r\n\r\n## Workaround\r\n\r\nThe warning goes away if Rack is pinned at 2.x. (Rails 7.1 beta works with Rack 2 and Rack 3.)\r\n\r\n```ruby\r\ngem \"rack\", \"< 3\"\r\n```","closed_by":{"login":"twalpole","id":16556,"node_id":"MDQ6VXNlcjE2NTU2","avatar_url":"https://avatars.githubusercontent.com/u/16556?v=4","gravatar_id":"","url":"https://api.github.com/users/twalpole","html_url":"https://github.com/twalpole","followers_url":"https://api.github.com/users/twalpole/followers","following_url":"https://api.github.com/users/twalpole/following{/other_user}","gists_url":"https://api.github.com/users/twalpole/gists{/gist_id}","starred_url":"https://api.github.com/users/twalpole/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/twalpole/subscriptions","organizations_url":"https://api.github.com/users/twalpole/orgs","repos_url":"https://api.github.com/users/twalpole/repos","events_url":"https://api.github.com/users/twalpole/events{/privacy}","received_events_url":"https://api.github.com/users/twalpole/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/teamcapybara/capybara/issues/2705/reactions","total_count":6,"+1":6,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/teamcapybara/capybara/issues/2705/timeline","performed_via_github_app":null,"state_reason":"completed"}