{"url":"https://api.github.com/repos/teamcapybara/capybara/issues/2","repository_url":"https://api.github.com/repos/teamcapybara/capybara","labels_url":"https://api.github.com/repos/teamcapybara/capybara/issues/2/labels{/name}","comments_url":"https://api.github.com/repos/teamcapybara/capybara/issues/2/comments","events_url":"https://api.github.com/repos/teamcapybara/capybara/issues/2/events","html_url":"https://github.com/teamcapybara/capybara/issues/2","id":86098,"node_id":"MDU6SXNzdWU4NjA5OA==","number":2,"title":"Assorted errors with Culerity","user":{"login":"wincent","id":7074,"node_id":"MDQ6VXNlcjcwNzQ=","avatar_url":"https://avatars.githubusercontent.com/u/7074?v=4","gravatar_id":"","url":"https://api.github.com/users/wincent","html_url":"https://github.com/wincent","followers_url":"https://api.github.com/users/wincent/followers","following_url":"https://api.github.com/users/wincent/following{/other_user}","gists_url":"https://api.github.com/users/wincent/gists{/gist_id}","starred_url":"https://api.github.com/users/wincent/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wincent/subscriptions","organizations_url":"https://api.github.com/users/wincent/orgs","repos_url":"https://api.github.com/users/wincent/repos","events_url":"https://api.github.com/users/wincent/events{/privacy}","received_events_url":"https://api.github.com/users/wincent/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":true,"assignee":null,"assignees":[],"milestone":null,"comments":8,"created_at":"2009-11-21T11:58:00Z","updated_at":"2019-08-18T12:14:09Z","closed_at":"2009-11-24T20:51:26Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"All my features that use the standard rack-test driver have ported across from webrat without any real difficulties, but I'm having some issues with Culerity-based features.\n\nHere's an example:\n\n```\n@javascript\nScenario:\n  Given I log in as an admin user\n  Then I should see \"Successfully logged in\"\n```\n\nAnd the corresponding step definition:\n\n```\nWhen /^I log in as an admin user$/ do\n  user = create_user :superuser => true\n  visit login_path\n  fill_in 'Email address', :with => user.emails.first.address\n  fill_in 'Passphrase', :with => FixtureReplacement::PASSPHRASE\n  click_button 'Log in'\nend\n```\n\nHere's a stripped down version of the login form:\n\n```\n<form action=\"/sessions\" method=\"post\"><p>\n  <label for=\"email\">Email address</label>\n  <input id=\"email\" name=\"email\" type=\"text\" />\n  <label for=\"passphrase\">Passphrase</label></div>\n  <input id=\"passphrase\" name=\"passphrase\" type=\"password\" />\n  <input name=\"commit\" type=\"submit\" value=\"Log in\" />\n</form>\n```\n\nI'm getting an exception on hitting the \"fill_in\" line:\n\n```\n  undefined method `for' for \"Culerity::RemoteObjectProxy.new(22, @io)\":String (NoMethodError)\n  /Library/Ruby/Gems/1.8/gems/capybara-0.1.1/lib/capybara/driver/culerity_driver.rb:13:in `send'\n  /Library/Ruby/Gems/1.8/gems/capybara-0.1.1/lib/capybara/driver/culerity_driver.rb:13:in `[]'\n  /Library/Ruby/Gems/1.8/gems/capybara-0.1.1/lib/capybara/session.rb:170:in `find_field_by_label'\n  /Library/Ruby/Gems/1.8/gems/capybara-0.1.1/lib/capybara/session.rb:167:in `each'\n  /Library/Ruby/Gems/1.8/gems/capybara-0.1.1/lib/capybara/session.rb:167:in `find_field_by_label'\n  /Library/Ruby/Gems/1.8/gems/capybara-0.1.1/lib/capybara/session.rb:98:in `find_field'\n  /Library/Ruby/Gems/1.8/gems/capybara-0.1.1/lib/capybara/session.rb:35:in `fill_in'\n  /Library/Ruby/Gems/1.8/gems/capybara-0.1.1/lib/capybara/dsl.rb:53:in `fill_in'\n  ./features/step_definitions/common.rb:7\n```\n\nIf I comment out that line for testing purposes then I get a similar exception on hitting the \"click_button\" line:\n\n```\n  undefined method `click' for \"Culerity::RemoteObjectProxy.new(22, @io)\":String (NoMethodError)\n  /Library/Ruby/Gems/1.8/gems/capybara-0.1.1/lib/capybara/driver/culerity_driver.rb:27:in `click'\n  /Library/Ruby/Gems/1.8/gems/capybara-0.1.1/lib/capybara/session.rb:31:in `click_button'\n  /Library/Ruby/Gems/1.8/gems/capybara-0.1.1/lib/capybara/dsl.rb:53:in `click_button'\n  ./features/step_definitions/common.rb:9\n```\n\nGem versions I'm working with:\n- capybara (0.1.1)\n- cucumber (0.4.3)\n- culerity (0.2.3)\n- nokogiri (1.3.3)\n- rack (1.0.1)\n- rack-test (0.5.2)\n- database_cleaner (0.2.3)\n- rails (2.3.4)\n\nAnd I'm using jarib-celerity (0.0.7.1) from GitHub as noted in the \"Gotchas\"; celerity (0.7.5) from GemCutter fails too.\n\nJRuby is 1.4.0, installed and with its \"bin\" directory exported via the PATH environment variable.\n\nAll references to webrat remove from \"features/support/env.rb\" and have:\n\n```\nCucumber::Rails::World.use_transactional_fixtures = false\nrequire 'capybara/rails'\nrequire 'capybara/cucumber'\nCapybara.javascript_driver = :culerity\n```\n\nThe scenario in question basically works if I remove the @javascript tag, but to properly test I do need JavaScript because the \"Successfully logged in\" flash message is actually shown using JS.\n\nNot sure if I am overlooking anything obvious, perhaps just another case of PEBKAC...   Let me know if you need any further information.\n\nCheers,\nWincent\n","closed_by":null,"reactions":{"url":"https://api.github.com/repos/teamcapybara/capybara/issues/2/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/teamcapybara/capybara/issues/2/timeline","performed_via_github_app":null,"state_reason":"completed"}