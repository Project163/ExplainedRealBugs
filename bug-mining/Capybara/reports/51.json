{"url":"https://api.github.com/repos/teamcapybara/capybara/issues/639","repository_url":"https://api.github.com/repos/teamcapybara/capybara","labels_url":"https://api.github.com/repos/teamcapybara/capybara/issues/639/labels{/name}","comments_url":"https://api.github.com/repos/teamcapybara/capybara/issues/639/comments","events_url":"https://api.github.com/repos/teamcapybara/capybara/issues/639/events","html_url":"https://github.com/teamcapybara/capybara/issues/639","id":3224799,"node_id":"MDU6SXNzdWUzMjI0Nzk5","number":639,"title":"Behavior with Javascript pushState/replaceState","user":{"login":"joliss","id":524783,"node_id":"MDQ6VXNlcjUyNDc4Mw==","avatar_url":"https://avatars.githubusercontent.com/u/524783?v=4","gravatar_id":"","url":"https://api.github.com/users/joliss","html_url":"https://github.com/joliss","followers_url":"https://api.github.com/users/joliss/followers","following_url":"https://api.github.com/users/joliss/following{/other_user}","gists_url":"https://api.github.com/users/joliss/gists{/gist_id}","starred_url":"https://api.github.com/users/joliss/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/joliss/subscriptions","organizations_url":"https://api.github.com/users/joliss/orgs","repos_url":"https://api.github.com/users/joliss/repos","events_url":"https://api.github.com/users/joliss/events{/privacy}","received_events_url":"https://api.github.com/users/joliss/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":true,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2012-02-14T19:36:40Z","updated_at":"2019-08-17T22:14:15Z","closed_at":"2012-07-10T13:12:03Z","author_association":"COLLABORATOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"On Sun, Jan 22, 2012 at 23:18, Marc Schwieterman (@marcisme) wrote:\n\n> The behavior of current_url and current_path when pushState/\n> replaceState are used appears to currently be undefined in the\n> Capybara specs. This allows for inconsistent behavior between\n> different driver implementations. For example at the time of this\n> writing the Selenium driver included with Capybara returns the value\n> as modified by Javascript, but capybara-webkit does not.\n> \n> I would be happy to contribute some specs, but I wanted to get input\n> on where they should go, and what they should cover. It appears that\n> all the Javascript related specs live in lib/capybara/spec/session/\n> javascript.rb. I came up with the following to cover the specific\n> cases that have been causing me trouble.\n> \n> --- a/lib/capybara/spec/session/javascript.rb\n> +++ b/lib/capybara/spec/session/javascript.rb\n> @@ -297,6 +297,20 @@ shared_examples_for \"session with javascript\n> support\" do\n>         @session.should have_no_text(\"I changed it\")\n>       end\n>     end\n> +\n> -    describe \"#current_path\" do\n> -      it \"is affected by pushState\" do\n> -        @session.visit(\"/with_js\")\n> -        @session.execute_script(\"window.history.pushState({}, '', '/\n>   pushed')\")\n> -        @session.current_path.should == \"/pushed\"\n> -      end\n>   +\n> -      it \"is affected by replaceState\" do\n> -        @session.visit(\"/with_js\")\n> -        @session.execute_script(\"window.history.replaceState({}, '',\n>   '/replaced\n> -        @session.current_path.should == \"/replaced\"\n> -      end\n> -    end\n>     end\n>    end\n> \n> Is this something that should be covered in the specs?\n> \n> -Marc\n","closed_by":{"login":"jnicklas","id":134,"node_id":"MDQ6VXNlcjEzNA==","avatar_url":"https://avatars.githubusercontent.com/u/134?v=4","gravatar_id":"","url":"https://api.github.com/users/jnicklas","html_url":"https://github.com/jnicklas","followers_url":"https://api.github.com/users/jnicklas/followers","following_url":"https://api.github.com/users/jnicklas/following{/other_user}","gists_url":"https://api.github.com/users/jnicklas/gists{/gist_id}","starred_url":"https://api.github.com/users/jnicklas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jnicklas/subscriptions","organizations_url":"https://api.github.com/users/jnicklas/orgs","repos_url":"https://api.github.com/users/jnicklas/repos","events_url":"https://api.github.com/users/jnicklas/events{/privacy}","received_events_url":"https://api.github.com/users/jnicklas/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/teamcapybara/capybara/issues/639/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/teamcapybara/capybara/issues/639/timeline","performed_via_github_app":null,"state_reason":"completed"}