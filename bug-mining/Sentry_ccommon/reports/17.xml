<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:34:10 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SENTRY-2039] KeyValue is case sensitive and it causes incompatibility issues with external components</title>
                <link>https://issues.apache.org/jira/browse/SENTRY-2039</link>
                <project id="12314720" key="SENTRY">Sentry (Retired)</project>
                    <description>&lt;p&gt;A refactor done on &lt;a href=&quot;https://issues.apache.org/jira/browse/SENTRY-999&quot; title=&quot;Refactor the sentry to integrate with external components quickly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SENTRY-999&quot;&gt;&lt;del&gt;SENTRY-999&lt;/del&gt;&lt;/a&gt; changed the way KeyValue.equals() checks for equality. It used to be case insensitive and now it is case sensitive. This may cause issues (like hbase indexer) when policies are written with case insensitive.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13117082">SENTRY-2039</key>
            <summary>KeyValue is case sensitive and it causes incompatibility issues with external components</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="2">Won&apos;t Fix</resolution>
                                        <assignee username="spena">Sergio Pe&#241;a</assignee>
                                    <reporter username="spena">Sergio Pe&#241;a</reporter>
                        <labels>
                    </labels>
                <created>Wed, 8 Nov 2017 20:03:33 +0000</created>
                <updated>Tue, 14 Nov 2017 17:12:29 +0000</updated>
                            <resolved>Tue, 14 Nov 2017 17:12:29 +0000</resolved>
                                    <version>1.8.0</version>
                                    <fixVersion>2.0.0</fixVersion>
                                    <component>Sentry</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="16244656" author="hadoopqa" created="Wed, 8 Nov 2017 20:14:22 +0000"  >&lt;p&gt;Here are the results of testing the latest attachment&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12896717/SENTRY-2039.1.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12896717/SENTRY-2039.1.patch&lt;/a&gt; against master.&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;Overall:&lt;/font&gt; -1 due to 2 errors&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; mvn test exited 1&lt;br/&gt;
&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; Failed: org.apache.sentry.policy.common.TestCommonPrivilege&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-SENTRY-Build/3424/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-SENTRY-Build/3424/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="16244943" author="hadoopqa" created="Wed, 8 Nov 2017 23:40:55 +0000"  >&lt;p&gt;Here are the results of testing the latest attachment&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12896730/SENTRY-2039.2.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12896730/SENTRY-2039.2.patch&lt;/a&gt; against master.&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;Overall:&lt;/font&gt; +1 all checks pass&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;SUCCESS:&lt;/font&gt; all tests passed&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-SENTRY-Build/3425/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-SENTRY-Build/3425/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="16244945" author="spena" created="Wed, 8 Nov 2017 23:44:21 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=coheig&quot; class=&quot;user-hover&quot; rel=&quot;coheig&quot;&gt;coheig&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=akolb&quot; class=&quot;user-hover&quot; rel=&quot;akolb&quot;&gt;akolb&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kkalyan&quot; class=&quot;user-hover&quot; rel=&quot;kkalyan&quot;&gt;kkalyan&lt;/a&gt; I&apos;m bringing back the equalsIgnoreCase() to the KeyValue.equals() method. It was removed on Sentry 1.8 for unknown reasons.&lt;/p&gt;

&lt;p&gt;Could you review the patch?&lt;/p&gt;</comment>
                            <comment id="16244953" author="akolb" created="Wed, 8 Nov 2017 23:53:53 +0000"  >&lt;p&gt;If key and value are case-insensitive, would it make sense to convert both to canonical case in constructor?&lt;/p&gt;</comment>
                            <comment id="16244965" author="spena" created="Thu, 9 Nov 2017 00:05:14 +0000"  >&lt;p&gt;Probably true. &lt;/p&gt;

&lt;p&gt;I picked what it was already committed from Sentry 1.7 and lower versions.&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/sentry/blob/branch-1.7.0/sentry-policy/sentry-policy-common/src/main/java/org/apache/sentry/policy/common/KeyValue.java#L87&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/sentry/blob/branch-1.7.0/sentry-policy/sentry-policy-common/src/main/java/org/apache/sentry/policy/common/KeyValue.java#L87&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;But we could lower the case in the constructor as well to save time on the equals() method. Should I go with that approach or keep it consistent with older code?&lt;/p&gt;</comment>
                            <comment id="16245070" author="akolb" created="Thu, 9 Nov 2017 01:29:06 +0000"  >&lt;p&gt;We shouldn&apos;t treat older code as the final source of truth. What do you think makes most sense semantics-wise? Are keys and values case-insensitive? Looks like the keys can be used for some enums at least so it would make sense to keep them in upcase always. I am not sure about values. I don&apos;t really know how they are used. If they are inherently case-insensitive, converting to a standard case makes sense.&lt;/p&gt;</comment>
                            <comment id="16245959" author="spena" created="Thu, 9 Nov 2017 16:25:08 +0000"  >&lt;p&gt;I noticed that components authorizables are obtained from &lt;tt&gt;*ModelAuthorizable.from(KeyValue keyValue)&lt;/tt&gt; and that differs a little between them. &lt;/p&gt;

&lt;p&gt;For instance:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
IndexerModelAuthorizables, SolrModelAuthorizables, SqoopModelAuthorizables: These lower the &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt; on both key and value strings, compare it and &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; an Authorizable object with both string cases lowered.

KafkaModelAuthorizables, DBModelAuthorizables: These lower the &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt; on the key only, but compares key and value as lower &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt;. However, they &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; an Authorizable object with the key (lowercase) but the value as original.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I&apos;m not sure how Kafka and DB can be affected if I lower the case automatically on the constructor. It might need probably more investigation on those components to understand the behavior (especially Kafka which I don&apos;t know how it works yet).&lt;/p&gt;

&lt;p&gt;Perhaps is good to keep the equalsIgnoreCase() for now on the KeyValue.equals() as it used to work before? then create a follow-up jira to revisit the KeyValue class. Seems this KeyValue can be replaced by a common API, like the Pair class. That would worth the investigation.&lt;/p&gt;</comment>
                            <comment id="16246232" author="hadoopqa" created="Thu, 9 Nov 2017 18:37:38 +0000"  >&lt;p&gt;Here are the results of testing the latest attachment&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12896896/SENTRY-2039.3.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12896896/SENTRY-2039.3.patch&lt;/a&gt; against master.&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;Overall:&lt;/font&gt; +1 all checks pass&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;SUCCESS:&lt;/font&gt; all tests passed&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-SENTRY-Build/3427/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-SENTRY-Build/3427/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="16246499" author="hadoopqa" created="Thu, 9 Nov 2017 20:57:52 +0000"  >&lt;p&gt;Here are the results of testing the latest attachment&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12896922/SENTRY-2039.4.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12896922/SENTRY-2039.4.patch&lt;/a&gt; against master.&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;Overall:&lt;/font&gt; +1 all checks pass&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;SUCCESS:&lt;/font&gt; all tests passed&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-SENTRY-Build/3431/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-SENTRY-Build/3431/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="16249836" author="spena" created="Mon, 13 Nov 2017 17:14:12 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=akolb&quot; class=&quot;user-hover&quot; rel=&quot;akolb&quot;&gt;akolb&lt;/a&gt; for the review. I will create a follow up jira to deep into the KeyValue design and see if we can use a more generic class, such as Pair(), and how the sensitive vs insensitive functionality works.&lt;/p&gt;</comment>
                            <comment id="16251758" author="spena" created="Tue, 14 Nov 2017 17:12:29 +0000"  >&lt;p&gt;The case-sensitive issue is solved by each of the external components by using a specific model and using the CommonPrivilege interface. My old tests were based on a different Privilege interface (such as IndexerWildcardPrivilege), so my tests were failing, but I learned that Kafka, Solr, hive and Sqoop use the same CommonPrivilege and they work.&lt;/p&gt;

&lt;p&gt;By switching the hbase-indexer to the CommonPolicyEngine which uses the CommonPrivilege, then the tests work correctly.&lt;/p&gt;

&lt;p&gt;FYI &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=akolb&quot; class=&quot;user-hover&quot; rel=&quot;akolb&quot;&gt;akolb&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13118012">SENTRY-2043</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12896717" name="SENTRY-2039.1.patch" size="973" author="spena" created="Wed, 8 Nov 2017 20:04:02 +0000"/>
                            <attachment id="12896730" name="SENTRY-2039.2.patch" size="3552" author="spena" created="Wed, 8 Nov 2017 21:35:37 +0000"/>
                            <attachment id="12896896" name="SENTRY-2039.3.patch" size="4264" author="spena" created="Thu, 9 Nov 2017 16:33:26 +0000"/>
                            <attachment id="12896922" name="SENTRY-2039.4.patch" size="4264" author="spena" created="Thu, 9 Nov 2017 18:51:25 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[no_permission]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3mk7r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>