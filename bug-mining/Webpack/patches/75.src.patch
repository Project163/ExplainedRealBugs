diff --git a/lib/dependencies/CommonJsImportsParserPlugin.js b/lib/dependencies/CommonJsImportsParserPlugin.js
index 5ffde80c6..c71de3e88 100644
--- a/lib/dependencies/CommonJsImportsParserPlugin.js
+++ b/lib/dependencies/CommonJsImportsParserPlugin.js
@@ -238,6 +238,7 @@ class CommonJsImportsParserPlugin {
 					members
 				);
 				dep.asiSafe = !parser.isAsiPosition(expr.range[0]);
+				dep.optional = !!parser.scope.inTry;
 				dep.loc = expr.loc;
 				parser.state.module.addDependency(dep);
 				return true;
@@ -254,6 +255,7 @@ class CommonJsImportsParserPlugin {
 				);
 				dep.call = true;
 				dep.asiSafe = !parser.isAsiPosition(expr.range[0]);
+				dep.optional = !!parser.scope.inTry;
 				dep.loc = expr.callee.loc;
 				parser.state.module.addDependency(dep);
 				parser.walkExpressions(expr.arguments);
diff --git a/test/cases/runtime/missing-module-exception/index.js b/test/cases/runtime/missing-module-exception/index.js
index 3351fb7a5..366bdfd74 100644
--- a/test/cases/runtime/missing-module-exception/index.js
+++ b/test/cases/runtime/missing-module-exception/index.js
@@ -1,7 +1,9 @@
-it("should have correct error code", function() {
+it("should have correct error code", function () {
 	try {
-		require("./fail");
-	} catch(e) {
+		require("./fail-1");
+		require("./fail-2").property;
+		require("./fail-3").property.sub();
+	} catch (e) {
 		expect(e.code).toBe("MODULE_NOT_FOUND");
 	}
 });
diff --git a/test/cases/runtime/missing-module-exception/warnings.js b/test/cases/runtime/missing-module-exception/warnings.js
index fd523a239..f0cafe0c4 100644
--- a/test/cases/runtime/missing-module-exception/warnings.js
+++ b/test/cases/runtime/missing-module-exception/warnings.js
@@ -1,3 +1,5 @@
 module.exports = [
-	[/Module not found/, /Can't resolve '\.\/fail' /]
-];
\ No newline at end of file
+	[/Module not found/, /Can't resolve '\.\/fail-1' /],
+	[/Module not found/, /Can't resolve '\.\/fail-2' /],
+	[/Module not found/, /Can't resolve '\.\/fail-3' /]
+];
