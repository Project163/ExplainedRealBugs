diff --git a/lib/config/defaults.js b/lib/config/defaults.js
index 8b5add3f1..f3a45fe2a 100644
--- a/lib/config/defaults.js
+++ b/lib/config/defaults.js
@@ -581,9 +581,9 @@ const applyOutputDefaults = (
 	});
 	F(output, "chunkFormat", () => {
 		if (tp) {
+			if (tp.document) return "array-push";
 			if (tp.require) return "commonjs";
 			if (tp.nodeBuiltins) return "commonjs";
-			if (tp.document) return "array-push";
 			if (tp.importScripts) return "array-push";
 			if (tp.dynamicImport && output.module) return "module";
 		}
@@ -591,9 +591,9 @@ const applyOutputDefaults = (
 	});
 	F(output, "chunkLoading", () => {
 		if (tp) {
+			if (tp.document) return "jsonp";
 			if (tp.require) return "require";
 			if (tp.nodeBuiltins) return "async-node";
-			if (tp.document) return "jsonp";
 			if (tp.importScripts) return "import-scripts";
 			if (tp.dynamicImport && output.module) return "import";
 			if (
diff --git a/lib/electron/ElectronTargetPlugin.js b/lib/electron/ElectronTargetPlugin.js
index 118dd774c..256c4fb49 100644
--- a/lib/electron/ElectronTargetPlugin.js
+++ b/lib/electron/ElectronTargetPlugin.js
@@ -31,7 +31,7 @@ class ElectronTargetPlugin {
 			"original-fs",
 			"screen",
 			"shell"
-		]);
+		]).apply(compiler);
 		switch (this._context) {
 			case "main":
 				new ExternalsPlugin("commonjs", [
