diff --git a/lib/dependencies/HarmonyImportDependencyParserPlugin.js b/lib/dependencies/HarmonyImportDependencyParserPlugin.js
index 583c5c58a..53efc949b 100644
--- a/lib/dependencies/HarmonyImportDependencyParserPlugin.js
+++ b/lib/dependencies/HarmonyImportDependencyParserPlugin.js
@@ -59,9 +59,13 @@ module.exports = class HarmonyImportDependencyParserPlugin {
 			(statement, source) => {
 				parser.state.lastHarmonyImportOrder =
 					(parser.state.lastHarmonyImportOrder || 0) + 1;
-				const clearDep = new ConstDependency("", statement.range);
+				const clearDep = new ConstDependency(
+					parser.isAsiPosition(statement.range[0]) ? ";" : "",
+					statement.range
+				);
 				clearDep.loc = statement.loc;
 				parser.state.module.addPresentationalDependency(clearDep);
+				parser.unsetAsiPosition(statement.range[1]);
 				const sideEffectDep = new HarmonyImportSideEffectDependency(
 					source,
 					parser.state.lastHarmonyImportOrder
diff --git a/lib/javascript/JavascriptParser.js b/lib/javascript/JavascriptParser.js
index 023c69661..20f1bef74 100644
--- a/lib/javascript/JavascriptParser.js
+++ b/lib/javascript/JavascriptParser.js
@@ -1405,7 +1405,11 @@ class JavascriptParser extends Parser {
 	}
 
 	preWalkStatement(statement) {
-		if (this.hooks.preStatement.call(statement)) return;
+		this.statementPath.push(statement);
+		if (this.hooks.preStatement.call(statement)) {
+			this.prevStatement = this.statementPath.pop();
+			return;
+		}
 		switch (statement.type) {
 			case "BlockStatement":
 				this.preWalkBlockStatement(statement);
@@ -1447,10 +1451,15 @@ class JavascriptParser extends Parser {
 				this.preWalkWithStatement(statement);
 				break;
 		}
+		this.prevStatement = this.statementPath.pop();
 	}
 
 	blockPreWalkStatement(statement) {
-		if (this.hooks.blockPreStatement.call(statement)) return;
+		this.statementPath.push(statement);
+		if (this.hooks.blockPreStatement.call(statement)) {
+			this.prevStatement = this.statementPath.pop();
+			return;
+		}
 		switch (statement.type) {
 			case "ImportDeclaration":
 				this.blockPreWalkImportDeclaration(statement);
@@ -1471,6 +1480,7 @@ class JavascriptParser extends Parser {
 				this.blockPreWalkClassDeclaration(statement);
 				break;
 		}
+		this.prevStatement = this.statementPath.pop();
 	}
 
 	walkStatement(statement) {
@@ -1549,7 +1559,9 @@ class JavascriptParser extends Parser {
 	walkBlockStatement(statement) {
 		this.inBlockScope(() => {
 			const body = statement.body;
+			const prev = this.prevStatement;
 			this.blockPreWalkStatements(body);
+			this.prevStatement = prev;
 			this.walkStatements(body);
 		});
 	}
@@ -1689,7 +1701,9 @@ class JavascriptParser extends Parser {
 			const body = statement.body;
 			if (body.type === "BlockStatement") {
 				// no need to add additional scope
+				const prev = this.prevStatement;
 				this.blockPreWalkStatements(body.body);
+				this.prevStatement = prev;
 				this.walkStatements(body.body);
 			} else {
 				this.walkStatement(body);
@@ -1716,7 +1730,9 @@ class JavascriptParser extends Parser {
 			const body = statement.body;
 			if (body.type === "BlockStatement") {
 				// no need to add additional scope
+				const prev = this.prevStatement;
 				this.blockPreWalkStatements(body.body);
+				this.prevStatement = prev;
 				this.walkStatements(body.body);
 			} else {
 				this.walkStatement(body);
@@ -1746,7 +1762,9 @@ class JavascriptParser extends Parser {
 			const body = statement.body;
 			if (body.type === "BlockStatement") {
 				// no need to add additional scope
+				const prev = this.prevStatement;
 				this.blockPreWalkStatements(body.body);
+				this.prevStatement = prev;
 				this.walkStatements(body.body);
 			} else {
 				this.walkStatement(body);
@@ -1770,7 +1788,9 @@ class JavascriptParser extends Parser {
 			}
 			if (statement.body.type === "BlockStatement") {
 				this.detectMode(statement.body.body);
+				const prev = this.prevStatement;
 				this.preWalkStatement(statement.body);
+				this.prevStatement = prev;
 				this.walkStatement(statement.body);
 			} else {
 				this.walkExpression(statement.body);
@@ -1848,7 +1868,9 @@ class JavascriptParser extends Parser {
 			if (
 				!this.hooks.exportDeclaration.call(statement, statement.declaration)
 			) {
+				const prev = this.prevStatement;
 				this.preWalkStatement(statement.declaration);
+				this.prevStatement = prev;
 				this.blockPreWalkStatement(statement.declaration);
 				let index = 0;
 				this.enterDeclaration(statement.declaration, def => {
@@ -1896,7 +1918,9 @@ class JavascriptParser extends Parser {
 	}
 
 	blockPreWalkExportDefaultDeclaration(statement) {
+		const prev = this.prevStatement;
 		this.preWalkStatement(statement.declaration);
+		this.prevStatement = prev;
 		this.blockPreWalkStatement(statement.declaration);
 		if (
 			statement.declaration.id &&
@@ -2049,7 +2073,9 @@ class JavascriptParser extends Parser {
 				const switchCase = switchCases[index];
 
 				if (switchCase.consequent.length > 0) {
+					const prev = this.prevStatement;
 					this.blockPreWalkStatements(switchCase.consequent);
+					this.prevStatement = prev;
 				}
 			}
 
@@ -2079,7 +2105,9 @@ class JavascriptParser extends Parser {
 				});
 				this.walkPattern(catchClause.param);
 			}
+			const prev = this.prevStatement;
 			this.blockPreWalkStatement(catchClause.body);
+			this.prevStatement = prev;
 			this.walkStatement(catchClause.body);
 		});
 	}
@@ -2276,7 +2304,9 @@ class JavascriptParser extends Parser {
 			}
 			if (expression.body.type === "BlockStatement") {
 				this.detectMode(expression.body.body);
+				const prev = this.prevStatement;
 				this.preWalkStatement(expression.body);
+				this.prevStatement = prev;
 				this.walkStatement(expression.body);
 			} else {
 				this.walkExpression(expression.body);
@@ -2294,7 +2324,9 @@ class JavascriptParser extends Parser {
 			}
 			if (expression.body.type === "BlockStatement") {
 				this.detectMode(expression.body.body);
+				const prev = this.prevStatement;
 				this.preWalkStatement(expression.body);
+				this.prevStatement = prev;
 				this.walkStatement(expression.body);
 			} else {
 				this.walkExpression(expression.body);
@@ -2561,7 +2593,9 @@ class JavascriptParser extends Parser {
 			}
 			if (functionExpression.body.type === "BlockStatement") {
 				this.detectMode(functionExpression.body.body);
+				const prev = this.prevStatement;
 				this.preWalkStatement(functionExpression.body);
+				this.prevStatement = prev;
 				this.walkStatement(functionExpression.body);
 			} else {
 				this.walkExpression(functionExpression.body);
@@ -3224,7 +3258,9 @@ class JavascriptParser extends Parser {
 		if (this.hooks.program.call(ast, comments) === undefined) {
 			this.detectMode(ast.body);
 			this.preWalkStatements(ast.body);
+			this.prevStatement = undefined;
 			this.blockPreWalkStatements(ast.body);
+			this.prevStatement = undefined;
 			this.walkStatements(ast.body);
 		}
 		this.hooks.finish.call(ast, comments);
@@ -3337,14 +3373,24 @@ class JavascriptParser extends Parser {
 	 * @returns {boolean} true when a semicolon has been inserted before this position, false if not
 	 */
 	isAsiPosition(pos) {
-		if (this.prevStatement === undefined) return false;
 		const currentStatement = this.statementPath[this.statementPath.length - 1];
+		if (currentStatement === undefined) return true;
 		return (
-			currentStatement.range[0] === pos &&
-			this.semicolons.has(this.prevStatement.range[1])
+			(currentStatement.range[1] === pos && this.semicolons.has(pos)) ||
+			(currentStatement.range[0] === pos &&
+				(this.prevStatement === undefined ||
+					this.semicolons.has(this.prevStatement.range[1])))
 		);
 	}
 
+	/**
+	 * @param {number} pos source code position
+	 * @returns {void}
+	 */
+	unsetAsiPosition(pos) {
+		this.semicolons.delete(pos);
+	}
+
 	isStatementLevelExpression(expr) {
 		const currentStatement = this.statementPath[this.statementPath.length - 1];
 		return (
diff --git a/test/cases/scope-hoisting/issue-11897/cjs.js b/test/cases/scope-hoisting/issue-11897/cjs.js
new file mode 100644
index 000000000..4b1b961ab
--- /dev/null
+++ b/test/cases/scope-hoisting/issue-11897/cjs.js
@@ -0,0 +1 @@
+module.exports = { flag: true };
diff --git a/test/cases/scope-hoisting/issue-11897/index.js b/test/cases/scope-hoisting/issue-11897/index.js
new file mode 100644
index 000000000..0edb77f45
--- /dev/null
+++ b/test/cases/scope-hoisting/issue-11897/index.js
@@ -0,0 +1,12 @@
+import obj from "./cjs";
+// prettier-ignore
+obj.flag = true
+import { value } from "./module";
+import { value as value2 } from "./module?2";
+obj.flag = true;
+
+it("should not break on ASI-code", () => {
+	expect(obj.flag).toBe(true);
+	expect(value).toBe(true);
+	expect(value2).toBe(true);
+});
diff --git a/test/cases/scope-hoisting/issue-11897/module.js b/test/cases/scope-hoisting/issue-11897/module.js
new file mode 100644
index 000000000..e76db3f11
--- /dev/null
+++ b/test/cases/scope-hoisting/issue-11897/module.js
@@ -0,0 +1,4 @@
+obj.flag++;
+import obj from "./cjs";
+// prettier-ignore
+export const value = true
