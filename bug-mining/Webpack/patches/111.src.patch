diff --git a/lib/FlagDependencyUsagePlugin.js b/lib/FlagDependencyUsagePlugin.js
index f86e2a35a..dfe0759be 100644
--- a/lib/FlagDependencyUsagePlugin.js
+++ b/lib/FlagDependencyUsagePlugin.js
@@ -161,9 +161,10 @@ class FlagDependencyUsagePlugin {
 					/**
 					 * @param {DependenciesBlock} module the module
 					 * @param {RuntimeSpec} runtime part of which runtime
+					 * @param {boolean} forceSideEffects always apply side effects
 					 * @returns {void}
 					 */
-					const processModule = (module, runtime) => {
+					const processModule = (module, runtime, forceSideEffects) => {
 						/** @type {Map<Module, (string[] | ReferencedExport)[] | Map<string, string[] | ReferencedExport>>} */
 						const map = new Map();
 
@@ -179,7 +180,7 @@ class FlagDependencyUsagePlugin {
 									b.groupOptions &&
 									b.groupOptions.entryOptions
 								) {
-									processModule(b, b.groupOptions.entryOptions.runtime);
+									processModule(b, b.groupOptions.entryOptions.runtime, true);
 								} else {
 									queue.enqueue(b);
 								}
@@ -193,7 +194,7 @@ class FlagDependencyUsagePlugin {
 								if (activeState === false) continue;
 								const { module } = connection;
 								if (activeState === ModuleGraphConnection.TRANSITIVE_ONLY) {
-									processModule(module, runtime);
+									processModule(module, runtime, false);
 									continue;
 								}
 								const oldReferencedExports = map.get(module);
@@ -263,14 +264,14 @@ class FlagDependencyUsagePlugin {
 									module,
 									referencedExports,
 									runtime,
-									false
+									forceSideEffects
 								);
 							} else {
 								processReferencedModule(
 									module,
 									Array.from(referencedExports.values()),
 									runtime,
-									false
+									forceSideEffects
 								);
 							}
 						}
@@ -327,7 +328,7 @@ class FlagDependencyUsagePlugin {
 
 					while (queue.length) {
 						const [module, runtime] = queue.dequeue();
-						processModule(module, runtime);
+						processModule(module, runtime, false);
 					}
 					logger.timeEnd("trace exports usage in graph");
 				}
diff --git a/test/configCases/split-chunks/asnyc-entries/chunk.js b/test/configCases/split-chunks/asnyc-entries/chunk.js
new file mode 100644
index 000000000..3a0b527ff
--- /dev/null
+++ b/test/configCases/split-chunks/asnyc-entries/chunk.js
@@ -0,0 +1,3 @@
+export function upper(str) {
+	return str.toUpperCase();
+}
diff --git a/test/configCases/split-chunks/asnyc-entries/index.js b/test/configCases/split-chunks/asnyc-entries/index.js
new file mode 100644
index 000000000..6d110da92
--- /dev/null
+++ b/test/configCases/split-chunks/asnyc-entries/index.js
@@ -0,0 +1,13 @@
+import { Worker } from "worker_threads";
+
+it("should generate valid code when entrypoints are flagged side-effect-free", async () => {
+	const worker = new Worker(new URL("./worker.js", import.meta.url));
+	worker.postMessage("ok");
+	const result = await new Promise(resolve => {
+		worker.on("message", data => {
+			resolve(data);
+		});
+	});
+	expect(result).toBe("data: OK, value: 42, thanks");
+	await worker.terminate();
+});
diff --git a/test/configCases/split-chunks/asnyc-entries/module.js b/test/configCases/split-chunks/asnyc-entries/module.js
new file mode 100644
index 000000000..7a4e8a723
--- /dev/null
+++ b/test/configCases/split-chunks/asnyc-entries/module.js
@@ -0,0 +1 @@
+export default 42;
diff --git a/test/configCases/split-chunks/asnyc-entries/package.json b/test/configCases/split-chunks/asnyc-entries/package.json
new file mode 100644
index 000000000..a43829151
--- /dev/null
+++ b/test/configCases/split-chunks/asnyc-entries/package.json
@@ -0,0 +1,3 @@
+{
+  "sideEffects": false
+}
diff --git a/test/configCases/split-chunks/asnyc-entries/test.config.js b/test/configCases/split-chunks/asnyc-entries/test.config.js
new file mode 100644
index 000000000..65ddf7b1d
--- /dev/null
+++ b/test/configCases/split-chunks/asnyc-entries/test.config.js
@@ -0,0 +1,5 @@
+module.exports = {
+	findBundle: function(i, options) {
+		return ["main.js"];
+	}
+};
diff --git a/test/configCases/split-chunks/asnyc-entries/test.filter.js b/test/configCases/split-chunks/asnyc-entries/test.filter.js
new file mode 100644
index 000000000..703962334
--- /dev/null
+++ b/test/configCases/split-chunks/asnyc-entries/test.filter.js
@@ -0,0 +1,5 @@
+var supportsWorker = require("../../../helpers/supportsWorker");
+
+module.exports = function (config) {
+	return supportsWorker();
+};
diff --git a/test/configCases/split-chunks/asnyc-entries/webpack.config.js b/test/configCases/split-chunks/asnyc-entries/webpack.config.js
new file mode 100644
index 000000000..aaf5279b8
--- /dev/null
+++ b/test/configCases/split-chunks/asnyc-entries/webpack.config.js
@@ -0,0 +1,5 @@
+module.exports = {
+	output: {
+		filename: "[name].js"
+	}
+};
diff --git a/test/configCases/split-chunks/asnyc-entries/worker.js b/test/configCases/split-chunks/asnyc-entries/worker.js
new file mode 100644
index 000000000..c3ad8998a
--- /dev/null
+++ b/test/configCases/split-chunks/asnyc-entries/worker.js
@@ -0,0 +1,7 @@
+import { parentPort } from "worker_threads";
+import value from "./module";
+
+parentPort.on("message", async data => {
+	const { upper } = await import("./chunk");
+	parentPort.postMessage(`data: ${upper(data)}, value: ${value}, thanks`);
+});
