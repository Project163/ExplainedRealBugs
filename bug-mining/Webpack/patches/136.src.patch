diff --git a/lib/Compilation.js b/lib/Compilation.js
index 9a6c74040..445dd08e2 100644
--- a/lib/Compilation.js
+++ b/lib/Compilation.js
@@ -1574,10 +1574,11 @@ BREAKING CHANGE: Asset processing hooks in Compilation has been merged into a si
 				if (err) {
 					if (dependencies.every(d => d.optional)) {
 						this.warnings.push(err);
+						return callback();
 					} else {
 						this.errors.push(err);
+						return callback(err);
 					}
-					return callback(err);
 				}
 
 				if (!newModule) {
diff --git a/test/configCases/parsing/optional/index.js b/test/configCases/parsing/optional/index.js
new file mode 100644
index 000000000..cca013cc0
--- /dev/null
+++ b/test/configCases/parsing/optional/index.js
@@ -0,0 +1,11 @@
+it("should not fail for optional modules with bail", () => {
+	let error;
+	try {
+		require("./not-existing");
+	} catch (e) {
+		error = e;
+	}
+	expect(() => {
+		throw error;
+	}).toThrowError();
+});
diff --git a/test/configCases/parsing/optional/warnings.js b/test/configCases/parsing/optional/warnings.js
new file mode 100644
index 000000000..e011edaca
--- /dev/null
+++ b/test/configCases/parsing/optional/warnings.js
@@ -0,0 +1,7 @@
+module.exports = [
+	[
+		/Module not found/,
+		/Can't resolve '\.\/not-existing' /,
+		{ details: /not-existing\.js/ }
+	]
+];
diff --git a/test/configCases/parsing/optional/webpack.config.js b/test/configCases/parsing/optional/webpack.config.js
new file mode 100644
index 000000000..61694bc09
--- /dev/null
+++ b/test/configCases/parsing/optional/webpack.config.js
@@ -0,0 +1,4 @@
+/** @type {import("../../../../").Configuration} */
+module.exports = {
+	bail: true
+};
