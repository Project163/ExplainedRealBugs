{"url":"https://api.github.com/repos/webpack/webpack/issues/11673","repository_url":"https://api.github.com/repos/webpack/webpack","labels_url":"https://api.github.com/repos/webpack/webpack/issues/11673/labels{/name}","comments_url":"https://api.github.com/repos/webpack/webpack/issues/11673/comments","events_url":"https://api.github.com/repos/webpack/webpack/issues/11673/events","html_url":"https://github.com/webpack/webpack/issues/11673","id":720592014,"node_id":"MDU6SXNzdWU3MjA1OTIwMTQ=","number":11673,"title":"`exports.nodeType`: Self-reference dependency has unused export name","user":{"login":"Knagis","id":8700285,"node_id":"MDQ6VXNlcjg3MDAyODU=","avatar_url":"https://avatars.githubusercontent.com/u/8700285?v=4","gravatar_id":"","url":"https://api.github.com/users/Knagis","html_url":"https://github.com/Knagis","followers_url":"https://api.github.com/users/Knagis/followers","following_url":"https://api.github.com/users/Knagis/following{/other_user}","gists_url":"https://api.github.com/users/Knagis/gists{/gist_id}","starred_url":"https://api.github.com/users/Knagis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Knagis/subscriptions","organizations_url":"https://api.github.com/users/Knagis/orgs","repos_url":"https://api.github.com/users/Knagis/repos","events_url":"https://api.github.com/users/Knagis/events{/privacy}","received_events_url":"https://api.github.com/users/Knagis/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":816832417,"node_id":"MDU6TGFiZWw4MTY4MzI0MTc=","url":"https://api.github.com/repos/webpack/webpack/labels/webpack-5","name":"webpack-5","color":"c5def5","default":false,"description":""},{"id":2424789964,"node_id":"MDU6TGFiZWwyNDI0Nzg5OTY0","url":"https://api.github.com/repos/webpack/webpack/labels/critical-bug","name":"critical-bug","color":"d93f0b","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":22,"created_at":"2020-10-13T17:39:31Z","updated_at":"2022-06-27T18:12:33Z","closed_at":"2020-10-16T13:34:53Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"<!-- Please don't delete this template because we'll close your issue -->\r\n<!-- Before creating an issue please make sure you are using the latest version of webpack. -->\r\n\r\n# Bug report\r\n\r\nImporting a library built by webpack 4 (amd) into webpack 5 project results in\r\n\r\n```\r\nSelf-reference dependency has unused export name\r\n```\r\n\r\nAdding log to the error shows that it is caused by\r\n\r\n```\r\nCommonJsSelfReferenceDependency {\r\n  weak: false,\r\n  optional: false,\r\n  loc: SourceLocation {\r\n    start: Position { line: 6, column: 4686 },\r\n    end: Position { line: 6, column: 4702 }\r\n  },\r\n  range: [ 31441, 31457 ],\r\n  base: 'exports',\r\n  names: [ 'nodeType' ],\r\n  call: false\r\n}\r\n```\r\n<!-- Please ask questions on StackOverflow or the webpack Gitter. -->\r\n<!-- https://stackoverflow.com/questions/ask?tags=webpack -->\r\n<!-- https://gitter.im/webpack/webpack -->\r\n<!-- Issues which contain questions or support requests will be closed. -->\r\n\r\n**What is the current behavior?**\r\n\r\nBuild fails with error.\r\n\r\n**If the current behavior is a bug, please provide the steps to reproduce.**\r\n\r\nSeeing how `export.nodeType` seems to be rather common approach I hope that reproduction code is not needed. I can provide the code we have privately.\r\n\r\nSo far it looks like it is one of the buffer related files from lodash that is bundled and minified by webpack 4. Then it is imported into webpack 5 project (the same code builds fine with webpack 4).\r\n\r\nThe build only fails in production mode, development mode works fine.\r\n\r\n<!-- A great way to do this is to provide your configuration via a GitHub repository -->\r\n<!-- The most helpful is a minimal reproduction with instructions on how to reproduce -->\r\n<!-- Repositories with too many files or large `webpack.config.js` files are not suitable -->\r\n<!-- Please only add small code snippets directly into this issue -->\r\n<!-- https://gist.github.com is a good place for longer code snippets -->\r\n<!-- If your issue is caused by a plugin or loader, please create an issue on the loader/plugin repository instead -->\r\n\r\n**What is the expected behavior?**\r\n\r\nNo error as `exports.nodeType` is used to check for exports variable, it is not intended to be defined by the module.\r\n\r\n<!-- \"It should work\" is not a helpful explanation -->\r\n<!-- Explain exactly how it should behave -->\r\n\r\n**Other relevant information:**\r\nwebpack version:  5.1.0\r\nNode.js version: 12.13.1\r\nOperating System: Win10\r\nAdditional tools:\r\n","closed_by":{"login":"sokra","id":1365881,"node_id":"MDQ6VXNlcjEzNjU4ODE=","avatar_url":"https://avatars.githubusercontent.com/u/1365881?v=4","gravatar_id":"","url":"https://api.github.com/users/sokra","html_url":"https://github.com/sokra","followers_url":"https://api.github.com/users/sokra/followers","following_url":"https://api.github.com/users/sokra/following{/other_user}","gists_url":"https://api.github.com/users/sokra/gists{/gist_id}","starred_url":"https://api.github.com/users/sokra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sokra/subscriptions","organizations_url":"https://api.github.com/users/sokra/orgs","repos_url":"https://api.github.com/users/sokra/repos","events_url":"https://api.github.com/users/sokra/events{/privacy}","received_events_url":"https://api.github.com/users/sokra/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/webpack/webpack/issues/11673/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/webpack/webpack/issues/11673/timeline","performed_via_github_app":null,"state_reason":"completed"}