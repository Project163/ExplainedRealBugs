{"url":"https://api.github.com/repos/webpack/webpack/issues/8455","repository_url":"https://api.github.com/repos/webpack/webpack","labels_url":"https://api.github.com/repos/webpack/webpack/issues/8455/labels{/name}","comments_url":"https://api.github.com/repos/webpack/webpack/issues/8455/comments","events_url":"https://api.github.com/repos/webpack/webpack/issues/8455/events","html_url":"https://github.com/webpack/webpack/issues/8455","id":386929189,"node_id":"MDU6SXNzdWUzODY5MjkxODk=","number":8455,"title":"Missing module dependency between shared and async bundles causing code updates to disappear","user":{"login":"AnujRNair","id":1011628,"node_id":"MDQ6VXNlcjEwMTE2Mjg=","avatar_url":"https://avatars.githubusercontent.com/u/1011628?v=4","gravatar_id":"","url":"https://api.github.com/users/AnujRNair","html_url":"https://github.com/AnujRNair","followers_url":"https://api.github.com/users/AnujRNair/followers","following_url":"https://api.github.com/users/AnujRNair/following{/other_user}","gists_url":"https://api.github.com/users/AnujRNair/gists{/gist_id}","starred_url":"https://api.github.com/users/AnujRNair/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AnujRNair/subscriptions","organizations_url":"https://api.github.com/users/AnujRNair/orgs","repos_url":"https://api.github.com/users/AnujRNair/repos","events_url":"https://api.github.com/users/AnujRNair/events{/privacy}","received_events_url":"https://api.github.com/users/AnujRNair/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2018-12-03T17:40:50Z","updated_at":"2018-12-04T09:18:36Z","closed_at":"2018-12-04T09:18:36Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"# Bug report\r\n\r\n**What is the current behavior?**\r\n\r\nI'm not sure if this is a webpack or a webpack dev server bug, but it looks like there might be a missing module dependency between async and shared bundles in some edge cases.\r\n\r\nAt @slackhq, we've run into an interesting bug where changing code, and allowing webpack-dev-server to recompile the code, has resulted in code simply disappearing from the updated bundles!\r\n\r\nIt's strange because webpack produces the correct bundles on initial load, but loses the dependency link on recompilations (when running webpack-dev-server for instance). Killing webpack and starting the bundling over again results in the correct bundles being produced with the updated code as expected.\r\n\r\nI've narrowed this down to the relationship between shared bundles and async bundles which webpack / webpack-dev-server eventually creates - if you have a long dependency tree where you reexport modules over and over, webpack updates the import definitions for code in the shared bundle, but not in the async bundle. This means that there is a mismatch in variable names, and so that variable becomes undefined.\r\n\r\nNote that this is only a bug with recompilations - when you use webpack to recompile code from cold, the updated code will be reflected in the changeset.\r\n\r\nAlso reported to webpack-dev-server here: https://github.com/webpack/webpack-dev-server/issues/1584 but it was recommended I post here from @evilebottnawi \r\n\r\n**If the current behavior is a bug, please provide the steps to reproduce.**\r\n\r\nThe bug has been replicated in this minimal reproducible repo here. Instructions on how to run have also been provided: https://github.com/AnujRNair/webpack-missing-module-dependency\r\n\r\n**What is the expected behavior?**\r\n\r\nBoth the shared bundle and the async bundle should be updated to reflect the latest code changes.\r\n\r\n**Other relevant information:**\r\nwebpack version: 4.26.1\r\nNode.js version: 10.1.0\r\nOperating System: Mac\r\nAdditional tools: NPM 6.0.1","closed_by":{"login":"sokra","id":1365881,"node_id":"MDQ6VXNlcjEzNjU4ODE=","avatar_url":"https://avatars.githubusercontent.com/u/1365881?v=4","gravatar_id":"","url":"https://api.github.com/users/sokra","html_url":"https://github.com/sokra","followers_url":"https://api.github.com/users/sokra/followers","following_url":"https://api.github.com/users/sokra/following{/other_user}","gists_url":"https://api.github.com/users/sokra/gists{/gist_id}","starred_url":"https://api.github.com/users/sokra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sokra/subscriptions","organizations_url":"https://api.github.com/users/sokra/orgs","repos_url":"https://api.github.com/users/sokra/repos","events_url":"https://api.github.com/users/sokra/events{/privacy}","received_events_url":"https://api.github.com/users/sokra/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/webpack/webpack/issues/8455/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/webpack/webpack/issues/8455/timeline","performed_via_github_app":null,"state_reason":"completed"}