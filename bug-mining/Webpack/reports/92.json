{"url":"https://api.github.com/repos/webpack/webpack/issues/11995","repository_url":"https://api.github.com/repos/webpack/webpack","labels_url":"https://api.github.com/repos/webpack/webpack/issues/11995/labels{/name}","comments_url":"https://api.github.com/repos/webpack/webpack/issues/11995/comments","events_url":"https://api.github.com/repos/webpack/webpack/issues/11995/events","html_url":"https://github.com/webpack/webpack/issues/11995","id":743366831,"node_id":"MDU6SXNzdWU3NDMzNjY4MzE=","number":11995,"title":"Non-enumerable properties and __esModule are inconsistently imported","user":{"login":"evanw","id":406394,"node_id":"MDQ6VXNlcjQwNjM5NA==","avatar_url":"https://avatars.githubusercontent.com/u/406394?v=4","gravatar_id":"","url":"https://api.github.com/users/evanw","html_url":"https://github.com/evanw","followers_url":"https://api.github.com/users/evanw/followers","following_url":"https://api.github.com/users/evanw/following{/other_user}","gists_url":"https://api.github.com/users/evanw/gists{/gist_id}","starred_url":"https://api.github.com/users/evanw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/evanw/subscriptions","organizations_url":"https://api.github.com/users/evanw/orgs","repos_url":"https://api.github.com/users/evanw/repos","events_url":"https://api.github.com/users/evanw/events{/privacy}","received_events_url":"https://api.github.com/users/evanw/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":1089820,"node_id":"MDU6TGFiZWwxMDg5ODIw","url":"https://api.github.com/repos/webpack/webpack/labels/bug","name":"bug","color":"fbca04","default":true,"description":null},{"id":816832417,"node_id":"MDU6TGFiZWw4MTY4MzI0MTc=","url":"https://api.github.com/repos/webpack/webpack/labels/webpack-5","name":"webpack-5","color":"c5def5","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2020-11-15T23:00:50Z","updated_at":"2020-11-17T13:15:44Z","closed_at":"2020-11-17T13:15:44Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"<!-- Please don't delete this template because we'll close your issue -->\r\n<!-- Before creating an issue please make sure you are using the latest version of webpack. -->\r\n\r\n# Bug report\r\n\r\n<!-- Please ask questions on StackOverflow or the webpack Gitter. -->\r\n<!-- https://stackoverflow.com/questions/ask?tags=webpack -->\r\n<!-- https://gitter.im/webpack/webpack -->\r\n<!-- Issues which contain questions or support requests will be closed. -->\r\n\r\n**What is the current behavior?**\r\n\r\nIf you import a CommonJS module from an ES6 module, non-enumerable properties are sometimes imported and sometimes not imported depending on the import syntax used. This situation comes up when a CommonJS module does `module.exports = class { static property() {} }`. In that case `property` is non-enumerable.\r\n\r\n**If the current behavior is a bug, please provide the steps to reproduce.**\r\n\r\nRepro: https://repl.it/@EvanWallace1/webpack-commonjs-import-inconsistency\r\n\r\n```js\r\n// import.mjs\r\nimport * as test from './test/index.js'\r\n\r\nconsole.log('nonEnumerable (direct):', test.nonEnumerable)\r\nconsole.log('nonEnumerable (indirect):', test[Math.random() < 2 && 'nonEnumerable'])\r\n\r\nconsole.log('__esModule (direct):', test.__esModule)\r\nconsole.log('__esModule (indirect):', test[Math.random() < 2 && '__esModule'])\r\n```\r\n\r\n```js\r\n// test/index.js\r\nObject.defineProperty(exports, 'nonEnumerable', {value: true})\r\n```\r\n\r\nNote that the code above uses `test[Math.random() < 2 && 'property']` to represent a dynamic property access. It's not the intention of this issue to special-case that syntax to behave like `test.property`.\r\n\r\n<!-- A great way to do this is to provide your configuration via a GitHub repository -->\r\n<!-- The most helpful is a minimal reproduction with instructions on how to reproduce -->\r\n<!-- Repositories with too many files or large `webpack.config.js` files are not suitable -->\r\n<!-- Please only add small code snippets directly into this issue -->\r\n<!-- https://gist.github.com is a good place for longer code snippets -->\r\n<!-- If your issue is caused by a plugin or loader, please create an issue on the loader/plugin repository instead -->\r\n\r\n**What is the expected behavior?**\r\n\r\n_Expected:_\r\n\r\nEither this:\r\n\r\n```\r\nnonEnumerable (direct): true\r\nnonEnumerable (indirect): true\r\n__esModule (direct): true\r\n__esModule (indirect): true\r\n```\r\n\r\nOr this:\r\n\r\n```\r\nnonEnumerable (direct): true\r\nnonEnumerable (indirect): true\r\n__esModule (direct): undefined\r\n__esModule (indirect): undefined\r\n```\r\n\r\n_Observed:_\r\n\r\n```\r\nnonEnumerable (direct): true\r\nnonEnumerable (indirect): undefined\r\n__esModule (direct): undefined\r\n__esModule (indirect): true\r\n```\r\n\r\n<!-- \"It should work\" is not a helpful explanation -->\r\n<!-- Explain exactly how it should behave -->\r\n\r\n**Other relevant information:**\r\nwebpack version: 5.4.0\r\nNode.js version: v12.18.3\r\nOperating System: linux\r\nAdditional tools:\r\n\r\nI'm working on improving esbuild's compatibility with other bundlers. This inconsistency tripped me up in the past when trying to figure out what forms of importing Webpack supports. Ideally it would be consistent. I'm guessing no one else has pointed this out yet so I figured I should log an issue. Here's the context: https://github.com/evanw/esbuild/issues/532#issuecomment-727647005.\r\n","closed_by":{"login":"sokra","id":1365881,"node_id":"MDQ6VXNlcjEzNjU4ODE=","avatar_url":"https://avatars.githubusercontent.com/u/1365881?v=4","gravatar_id":"","url":"https://api.github.com/users/sokra","html_url":"https://github.com/sokra","followers_url":"https://api.github.com/users/sokra/followers","following_url":"https://api.github.com/users/sokra/following{/other_user}","gists_url":"https://api.github.com/users/sokra/gists{/gist_id}","starred_url":"https://api.github.com/users/sokra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sokra/subscriptions","organizations_url":"https://api.github.com/users/sokra/orgs","repos_url":"https://api.github.com/users/sokra/repos","events_url":"https://api.github.com/users/sokra/events{/privacy}","received_events_url":"https://api.github.com/users/sokra/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/webpack/webpack/issues/11995/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/webpack/webpack/issues/11995/timeline","performed_via_github_app":null,"state_reason":"completed"}