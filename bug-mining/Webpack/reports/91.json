{"url":"https://api.github.com/repos/webpack/webpack/issues/11990","repository_url":"https://api.github.com/repos/webpack/webpack","labels_url":"https://api.github.com/repos/webpack/webpack/issues/11990/labels{/name}","comments_url":"https://api.github.com/repos/webpack/webpack/issues/11990/comments","events_url":"https://api.github.com/repos/webpack/webpack/issues/11990/events","html_url":"https://github.com/webpack/webpack/issues/11990","id":742596579,"node_id":"MDU6SXNzdWU3NDI1OTY1Nzk=","number":11990,"title":"Webpack 5 incorrectly marking a reexport as unused","user":{"login":"christiango","id":1581488,"node_id":"MDQ6VXNlcjE1ODE0ODg=","avatar_url":"https://avatars.githubusercontent.com/u/1581488?v=4","gravatar_id":"","url":"https://api.github.com/users/christiango","html_url":"https://github.com/christiango","followers_url":"https://api.github.com/users/christiango/followers","following_url":"https://api.github.com/users/christiango/following{/other_user}","gists_url":"https://api.github.com/users/christiango/gists{/gist_id}","starred_url":"https://api.github.com/users/christiango/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/christiango/subscriptions","organizations_url":"https://api.github.com/users/christiango/orgs","repos_url":"https://api.github.com/users/christiango/repos","events_url":"https://api.github.com/users/christiango/events{/privacy}","received_events_url":"https://api.github.com/users/christiango/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":816832417,"node_id":"MDU6TGFiZWw4MTY4MzI0MTc=","url":"https://api.github.com/repos/webpack/webpack/labels/webpack-5","name":"webpack-5","color":"c5def5","default":false,"description":""},{"id":2424789964,"node_id":"MDU6TGFiZWwyNDI0Nzg5OTY0","url":"https://api.github.com/repos/webpack/webpack/labels/critical-bug","name":"critical-bug","color":"d93f0b","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":7,"created_at":"2020-11-13T16:44:32Z","updated_at":"2021-01-22T19:20:28Z","closed_at":"2020-11-16T15:52:24Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"<!-- Please don't delete this template because we'll close your issue -->\r\n<!-- Before creating an issue please make sure you are using the latest version of webpack. -->\r\n\r\n# Bug report\r\n\r\n**What is the current behavior?**\r\nWhen upgrading our app (a large Microsoft Office web application) from webpack 4 to webpack 5 we are getting an error like this:\r\n\r\nboot.js:3914 Uncaught TypeError: (0 , lib.createTheme) is not a function\r\n    at Object.844 (boot.js:3914)\r\n    at __webpack_require__ (boot.js:3966)\r\n    at boot.js:4207\r\n    at boot.js:4208 \r\n\r\nThis issue only happens in production mode. More specifically, it happens when concatenateModules and unusedExports are set to true. \r\n\r\nTo debug, I turned off minification and export mangling (the issue still repros) and I found that the 'createTheme' module is incorrectly being marked as 'unused'. One interesting thing to note about createTheme is that it is being imported from the `office-ui-fabric-react` npm package, which internally reexports that module from the `@uifabric/\r\n\r\nHere is the chain of the re-exports from office-ui-fabric-react (which is in the middle of a rename to fluent-ui)\r\nhttps://github.com/microsoft/fluentui/blob/master/packages/react/src/Theme.ts\r\nhttps://github.com/microsoft/fluentui/blob/master/packages/react-internal/src/Theme.ts\r\nhttps://github.com/microsoft/fluentui/blob/master/packages/theme/src/index.ts#L8\r\n\r\nHere is the interesting code from the bundle, with comments saying it is an unused re-export\r\n```javascript\r\n  \"createTheme\": () => /* reexport */ /* unused export */ undefined,\r\n```\r\n\r\n**If the current behavior is a bug, please provide the steps to reproduce.**\r\nI was able to strip down our app into a minimal repro of the issue, it is in this github repo: https://github.com/christiango/webpack5-unused-export-bug\r\n\r\nThe readme there contains some notes from the investigation. One of the most interesting bits is that if we change any of these things, the issue no longer reproduces:\r\n\r\n1. Making it only a single entry point (remove the logout entrypoint)\r\n2. Switch the webpack mode to development\r\n3. Set optimization.concatenateModules to false in the webpack config\r\n4. Set optimization.usedExports to false in the webpack config\r\n5. Switch the dynamic import in ErrorDialog.js to a static import\r\n\r\n**What is the expected behavior?**\r\nThe \"createTheme\" function in the repro should not crash\r\n\r\n<!-- \"It should work\" is not a helpful explanation -->\r\n<!-- Explain exactly how it should behave -->\r\n\r\n**Other relevant information:**\r\nwebpack version:  5.4.0\r\nNode.js version:  12.14.0\r\nOperating System: Windows 10\r\nAdditional tools:\r\n","closed_by":{"login":"sokra","id":1365881,"node_id":"MDQ6VXNlcjEzNjU4ODE=","avatar_url":"https://avatars.githubusercontent.com/u/1365881?v=4","gravatar_id":"","url":"https://api.github.com/users/sokra","html_url":"https://github.com/sokra","followers_url":"https://api.github.com/users/sokra/followers","following_url":"https://api.github.com/users/sokra/following{/other_user}","gists_url":"https://api.github.com/users/sokra/gists{/gist_id}","starred_url":"https://api.github.com/users/sokra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sokra/subscriptions","organizations_url":"https://api.github.com/users/sokra/orgs","repos_url":"https://api.github.com/users/sokra/repos","events_url":"https://api.github.com/users/sokra/events{/privacy}","received_events_url":"https://api.github.com/users/sokra/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/webpack/webpack/issues/11990/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/webpack/webpack/issues/11990/timeline","performed_via_github_app":null,"state_reason":"completed"}