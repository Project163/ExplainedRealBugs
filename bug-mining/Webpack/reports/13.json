{"url":"https://api.github.com/repos/webpack/webpack/issues/8522","repository_url":"https://api.github.com/repos/webpack/webpack","labels_url":"https://api.github.com/repos/webpack/webpack/issues/8522/labels{/name}","comments_url":"https://api.github.com/repos/webpack/webpack/issues/8522/comments","events_url":"https://api.github.com/repos/webpack/webpack/issues/8522/events","html_url":"https://github.com/webpack/webpack/issues/8522","id":392883518,"node_id":"MDU6SXNzdWUzOTI4ODM1MTg=","number":8522,"title":"replacing node module with externals fails (Module not found: TypeError: Cannot read property 'test' of undefined)","user":{"login":"clayrisser","id":6234038,"node_id":"MDQ6VXNlcjYyMzQwMzg=","avatar_url":"https://avatars.githubusercontent.com/u/6234038?v=4","gravatar_id":"","url":"https://api.github.com/users/clayrisser","html_url":"https://github.com/clayrisser","followers_url":"https://api.github.com/users/clayrisser/followers","following_url":"https://api.github.com/users/clayrisser/following{/other_user}","gists_url":"https://api.github.com/users/clayrisser/gists{/gist_id}","starred_url":"https://api.github.com/users/clayrisser/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clayrisser/subscriptions","organizations_url":"https://api.github.com/users/clayrisser/orgs","repos_url":"https://api.github.com/users/clayrisser/repos","events_url":"https://api.github.com/users/clayrisser/events{/privacy}","received_events_url":"https://api.github.com/users/clayrisser/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2018-12-20T04:26:51Z","updated_at":"2018-12-21T20:24:33Z","closed_at":"2018-12-20T17:08:48Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"# Bug report\r\n\r\nI get the following error when running the newest version of webpack `v4.28.0`.\r\n\r\n```\r\nModule not found: TypeError: Cannot read property 'test' of undefined\r\n```\r\n\r\nIt happens whenever I try and import a dependency that only works on Node.JS that I've set to an empty object (for example `fs`).\r\n\r\nHere is my webpack externals config.\r\n\r\n```js\r\nwebpackConfig.externals = {\r\n  child_process: {},\r\n  deasync: {},\r\n  fs: {},\r\n  winston: {}\r\n}\r\n```\r\n\r\nPlease note that this works fine on webpack `v4.27.1`.\r\n\r\nHere is the full stack trace.\r\n\r\n```\r\nERROR in ./node_modules/@reactant/core/lib/log/winston.js\r\nModule not found: TypeError: Cannot read property 'test' of undefined\r\n @ ./node_modules/@reactant/core/lib/log/winston.js 17:15-33\r\n @ ./node_modules/@reactant/core/lib/log/index.js\r\n @ ./node_modules/@reactant/core/lib/index.js\r\n @ /Users/codejamninja/Projects/reactant/packages/web/lib/hotDevClient.js\r\n @ multi (webpack)-dev-server/client?http://0.0.0.0:6002 (webpack)/hot/dev-server.js ./web/client.js /Users/codejamninja/Projects/reactant/packages/web/lib/hotDevClient.js\r\n```\r\n\r\nInstead of throwing an error, it should simply require the module as an empty object.\r\nBecause the error is happening inside of webpack, the stack trace does not tell me what is going wrong. I've searched all over for this supposed 'test' property. I am not using a property called test anywhere in my code.\r\n\r\nThis also fails with other node-specific npm modules, such as `winston` and `deasync`.\r\n\r\n**Other relevant information:**\r\nwebpack version:  \r\nNode.js version: v8.14.0\r\nAlso tested on Node.js version: v10.14.\r\nOperating System: Ubuntu 18.10\r\n","closed_by":{"login":"sokra","id":1365881,"node_id":"MDQ6VXNlcjEzNjU4ODE=","avatar_url":"https://avatars.githubusercontent.com/u/1365881?v=4","gravatar_id":"","url":"https://api.github.com/users/sokra","html_url":"https://github.com/sokra","followers_url":"https://api.github.com/users/sokra/followers","following_url":"https://api.github.com/users/sokra/following{/other_user}","gists_url":"https://api.github.com/users/sokra/gists{/gist_id}","starred_url":"https://api.github.com/users/sokra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sokra/subscriptions","organizations_url":"https://api.github.com/users/sokra/orgs","repos_url":"https://api.github.com/users/sokra/repos","events_url":"https://api.github.com/users/sokra/events{/privacy}","received_events_url":"https://api.github.com/users/sokra/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/webpack/webpack/issues/8522/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/webpack/webpack/issues/8522/timeline","performed_via_github_app":null,"state_reason":"completed"}