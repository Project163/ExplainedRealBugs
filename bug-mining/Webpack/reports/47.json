{"url":"https://api.github.com/repos/webpack/webpack/issues/10283","repository_url":"https://api.github.com/repos/webpack/webpack","labels_url":"https://api.github.com/repos/webpack/webpack/issues/10283/labels{/name}","comments_url":"https://api.github.com/repos/webpack/webpack/issues/10283/comments","events_url":"https://api.github.com/repos/webpack/webpack/issues/10283/events","html_url":"https://github.com/webpack/webpack/issues/10283","id":552405882,"node_id":"MDU6SXNzdWU1NTI0MDU4ODI=","number":10283,"title":"ConstPlugin invalidates asm.js code","user":{"login":"ngg","id":550654,"node_id":"MDQ6VXNlcjU1MDY1NA==","avatar_url":"https://avatars.githubusercontent.com/u/550654?v=4","gravatar_id":"","url":"https://api.github.com/users/ngg","html_url":"https://github.com/ngg","followers_url":"https://api.github.com/users/ngg/followers","following_url":"https://api.github.com/users/ngg/following{/other_user}","gists_url":"https://api.github.com/users/ngg/gists{/gist_id}","starred_url":"https://api.github.com/users/ngg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ngg/subscriptions","organizations_url":"https://api.github.com/users/ngg/orgs","repos_url":"https://api.github.com/users/ngg/repos","events_url":"https://api.github.com/users/ngg/events{/privacy}","received_events_url":"https://api.github.com/users/ngg/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":841723323,"node_id":"MDU6TGFiZWw4NDE3MjMzMjM=","url":"https://api.github.com/repos/webpack/webpack/labels/Send%20a%20PR","name":"Send a PR","color":"0054d3","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2020-01-20T16:37:32Z","updated_at":"2020-01-23T08:16:39Z","closed_at":"2020-01-23T08:16:39Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"<!-- Please don't delete this template because we'll close your issue -->\r\n<!-- Before creating an issue please make sure you are using the latest version of webpack. -->\r\n\r\n# Bug report\r\n\r\n<!-- Please ask questions on StackOverflow or the webpack Gitter. -->\r\n<!-- https://stackoverflow.com/questions/ask?tags=webpack -->\r\n<!-- https://gitter.im/webpack/webpack -->\r\n<!-- Issues which contain questions or support requests will be closed. -->\r\n\r\n**What is the current behavior?**\r\n\r\nConstPlugin can change asm.js (\"use asm\") functions and invalidate them by inserting \"false\", \"true\", \"undefined\" values. In asm.js, using these identifiers are not allowed.\r\n\r\n**If the current behavior is a bug, please provide the steps to reproduce.**\r\n\r\nI'm currently trying to use https://www.npmjs.com/package/viz.js and compiling that with webpack causes it to no longer be valid asm.js code.\r\nBut this can be seen with much smaller codes as well, basically with any const conditional. (`0==0` becomes `true`, `truthy() ? 0 : 1` can become `truthy() ? 0 : undefined`, etc)\r\n\r\n<!-- A great way to do this is to provide your configuration via a GitHub repository -->\r\n<!-- The most helpful is a minimal reproduction with instructions on how to reproduce -->\r\n<!-- Repositories with too many files or large `webpack.config.js` files are not suitable -->\r\n<!-- Please only add small code snippets directly into this issue -->\r\n<!-- https://gist.github.com is a good place for longer code snippets -->\r\n<!-- If your issue is caused by a plugin or loader, please create an issue on the loader/plugin repository instead -->\r\n\r\n**What is the expected behavior?**\r\n\r\nI think the best would be to simply disable ConstPlugin inside asm.js functions as it would be much harder to properly inject valid asm.js code there. The Parser's scope could be extended to check for \"use asm\" expressions just like it checks \"use strict\", and then ConstPlugin could use that info to skip those parts.\r\n\r\n<!-- \"It should work\" is not a helpful explanation -->\r\n<!-- Explain exactly how it should behave -->\r\n\r\n**Other relevant information:**\r\nwebpack version: 4.41.5\r\n","closed_by":{"login":"sokra","id":1365881,"node_id":"MDQ6VXNlcjEzNjU4ODE=","avatar_url":"https://avatars.githubusercontent.com/u/1365881?v=4","gravatar_id":"","url":"https://api.github.com/users/sokra","html_url":"https://github.com/sokra","followers_url":"https://api.github.com/users/sokra/followers","following_url":"https://api.github.com/users/sokra/following{/other_user}","gists_url":"https://api.github.com/users/sokra/gists{/gist_id}","starred_url":"https://api.github.com/users/sokra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sokra/subscriptions","organizations_url":"https://api.github.com/users/sokra/orgs","repos_url":"https://api.github.com/users/sokra/repos","events_url":"https://api.github.com/users/sokra/events{/privacy}","received_events_url":"https://api.github.com/users/sokra/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/webpack/webpack/issues/10283/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/webpack/webpack/issues/10283/timeline","performed_via_github_app":null,"state_reason":"completed"}