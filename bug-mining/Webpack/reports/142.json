{"url":"https://api.github.com/repos/webpack/webpack/issues/14379","repository_url":"https://api.github.com/repos/webpack/webpack","labels_url":"https://api.github.com/repos/webpack/webpack/issues/14379/labels{/name}","comments_url":"https://api.github.com/repos/webpack/webpack/issues/14379/comments","events_url":"https://api.github.com/repos/webpack/webpack/issues/14379/events","html_url":"https://github.com/webpack/webpack/issues/14379","id":1012227397,"node_id":"I_kwDOADgiC848VV1F","number":14379,"title":"BuildCycleError with a module blocking itself","user":{"login":"dreyks","id":1481264,"node_id":"MDQ6VXNlcjE0ODEyNjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1481264?v=4","gravatar_id":"","url":"https://api.github.com/users/dreyks","html_url":"https://github.com/dreyks","followers_url":"https://api.github.com/users/dreyks/followers","following_url":"https://api.github.com/users/dreyks/following{/other_user}","gists_url":"https://api.github.com/users/dreyks/gists{/gist_id}","starred_url":"https://api.github.com/users/dreyks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dreyks/subscriptions","organizations_url":"https://api.github.com/users/dreyks/orgs","repos_url":"https://api.github.com/users/dreyks/repos","events_url":"https://api.github.com/users/dreyks/events{/privacy}","received_events_url":"https://api.github.com/users/dreyks/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":1089824,"node_id":"MDU6TGFiZWwxMDg5ODI0","url":"https://api.github.com/repos/webpack/webpack/labels/question","name":"question","color":"cc317c","default":true,"description":null},{"id":816832417,"node_id":"MDU6TGFiZWw4MTY4MzI0MTc=","url":"https://api.github.com/repos/webpack/webpack/labels/webpack-5","name":"webpack-5","color":"c5def5","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":13,"created_at":"2021-09-30T14:06:41Z","updated_at":"2021-10-18T22:22:35Z","closed_at":"2021-10-18T22:22:35Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"DISCLAIMER: I don't have a minimal reproduction example, I only have this issue in a big project which I can't share. I understand that the issue might be closed because of this, but maybe you'll help me to understand if it's even a bug of webpack\r\n\r\n<!-- Please don't delete this template because we'll close your issue -->\r\n<!-- Before creating an issue please make sure you are using the latest version of webpack. -->\r\n\r\n# Bug report\r\n\r\n<!-- Please ask questions on StackOverflow or the webpack Gitter. -->\r\n<!-- https://stackoverflow.com/questions/ask?tags=webpack -->\r\n<!-- https://gitter.im/webpack/webpack -->\r\n<!-- Issues which contain questions or support requests will be closed. -->\r\n\r\n**What is the current behavior?**\r\n\r\nI have a big project that uses https://github.com/4Catalyzer/astroturf for styling. I have several places where I have a ton of styles interpolating each other but this is working fine with webpack@4.\r\n\r\nNow I am trying to upgrade to webpack@5 and I'm getting an error saying `There is a circular build dependency, which makes it impossible to create this module`\r\n\r\n\r\n**If the current behavior is a bug, please provide the steps to reproduce.**\r\n\r\nUnfortunately, I am unable to create a minimal example, see the disclaimer above.\r\n\r\n\r\n<!-- A great way to do this is to provide your configuration via a GitHub repository -->\r\n<!-- The most helpful is a minimal reproduction with instructions on how to reproduce -->\r\n<!-- Repositories with too many files or large `webpack.config.js` files are not suitable -->\r\n<!-- Please only add small code snippets directly into this issue -->\r\n<!-- https://gist.github.com is a good place for longer code snippets -->\r\n<!-- If your issue is caused by a plugin or loader, please create an issue on the loader/plugin repository instead -->\r\n\r\n**What is the expected behavior?**\r\n\r\nThere should not be any unsolvable cyclic dependencies because webpack 4 is able to build the same app\r\n\r\n<!-- \"It should work\" is not a helpful explanation -->\r\n<!-- Explain exactly how it should behave -->\r\n\r\nI've tried to solve it myself which lead me to here\r\nhttps://github.com/webpack/webpack/blob/b7f382878e50452d02c7ad1eeaf28f14d40b29ce/lib/Compilation.js#L1814-L1831\r\n\r\nAfter some debugging I found out that the blockReasons of the module that causes the cycle is that same module (and it is the only item in the blockReasons), so looks like it \"imports itself\". This might be an issue in astroturf (so I'm tagging @jquense as its author) but my question to webpack team is the following: \r\n\r\n_Is it an intended thing that a module can potentially end up blocking itself?_ \r\nI've tried adding a line `if (item === module) continue` after line 1821 and this resolved all my issues so there's no real deadlock - the build completes\r\n\r\n\r\n\r\n**Other relevant information:**\r\nwebpack version:  5.55.1\r\nNode.js version: v14.17.0\r\nOperating System:  MacOS\r\nAdditional tools: astroturf version 1.0.0-beta22 (latest)\r\n","closed_by":{"login":"sokra","id":1365881,"node_id":"MDQ6VXNlcjEzNjU4ODE=","avatar_url":"https://avatars.githubusercontent.com/u/1365881?v=4","gravatar_id":"","url":"https://api.github.com/users/sokra","html_url":"https://github.com/sokra","followers_url":"https://api.github.com/users/sokra/followers","following_url":"https://api.github.com/users/sokra/following{/other_user}","gists_url":"https://api.github.com/users/sokra/gists{/gist_id}","starred_url":"https://api.github.com/users/sokra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sokra/subscriptions","organizations_url":"https://api.github.com/users/sokra/orgs","repos_url":"https://api.github.com/users/sokra/repos","events_url":"https://api.github.com/users/sokra/events{/privacy}","received_events_url":"https://api.github.com/users/sokra/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/webpack/webpack/issues/14379/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/webpack/webpack/issues/14379/timeline","performed_via_github_app":null,"state_reason":"completed"}