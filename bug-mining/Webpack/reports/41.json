{"url":"https://api.github.com/repos/webpack/webpack/issues/10152","repository_url":"https://api.github.com/repos/webpack/webpack","labels_url":"https://api.github.com/repos/webpack/webpack/issues/10152/labels{/name}","comments_url":"https://api.github.com/repos/webpack/webpack/issues/10152/comments","events_url":"https://api.github.com/repos/webpack/webpack/issues/10152/events","html_url":"https://github.com/webpack/webpack/issues/10152","id":540366886,"node_id":"MDU6SXNzdWU1NDAzNjY4ODY=","number":10152,"title":"Detecting deadlock in loadModule for cyclical dependencies","user":{"login":"jquense","id":339286,"node_id":"MDQ6VXNlcjMzOTI4Ng==","avatar_url":"https://avatars.githubusercontent.com/u/339286?v=4","gravatar_id":"","url":"https://api.github.com/users/jquense","html_url":"https://github.com/jquense","followers_url":"https://api.github.com/users/jquense/followers","following_url":"https://api.github.com/users/jquense/following{/other_user}","gists_url":"https://api.github.com/users/jquense/gists{/gist_id}","starred_url":"https://api.github.com/users/jquense/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jquense/subscriptions","organizations_url":"https://api.github.com/users/jquense/orgs","repos_url":"https://api.github.com/users/jquense/repos","events_url":"https://api.github.com/users/jquense/events{/privacy}","received_events_url":"https://api.github.com/users/jquense/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2019-12-19T15:01:41Z","updated_at":"2019-12-20T16:15:28Z","closed_at":"2019-12-20T15:37:16Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"I've already read #6836 and #4959 which are related but not the same thing. \r\n\r\nAs it works now `loader.loadModule` will hang indefinitely for a loader that calls `loadModule` in the context of a cyclical dependency, e.g.\r\n\r\n**a.js**\r\n```\r\nimport 'test-loader!./b'\r\n```\r\n**b.js**\r\n```\r\nimport 'test-loader!./a'\r\n```\r\n\r\nand `loader.loadModule(depRequest)` in `test-loader`. We do this in `astroturf` to resolve stying dependencies in interpolated css tags (see: https://github.com/4Catalyzer/astroturf/blob/master/test/integration/cycle.js for an integration test)\r\n\r\nI don't actually care _that_ much that this case isn't supported, but I'd really like to detect and error in these cases. The naive approach we've tried of having a timeout on the loadModule call doesn't work super well because even at 10seconds, thats still an amount of time webpack can take to reasonable resolve the tree for that call. e.g. we get a lot of false positives from this warning.\r\n\r\nSo *question is* can  i avoid this deadlock in some simple fashion and baring that is there a better way to test if webpack is currently locked up?\r\n","closed_by":{"login":"sokra","id":1365881,"node_id":"MDQ6VXNlcjEzNjU4ODE=","avatar_url":"https://avatars.githubusercontent.com/u/1365881?v=4","gravatar_id":"","url":"https://api.github.com/users/sokra","html_url":"https://github.com/sokra","followers_url":"https://api.github.com/users/sokra/followers","following_url":"https://api.github.com/users/sokra/following{/other_user}","gists_url":"https://api.github.com/users/sokra/gists{/gist_id}","starred_url":"https://api.github.com/users/sokra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sokra/subscriptions","organizations_url":"https://api.github.com/users/sokra/orgs","repos_url":"https://api.github.com/users/sokra/repos","events_url":"https://api.github.com/users/sokra/events{/privacy}","received_events_url":"https://api.github.com/users/sokra/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/webpack/webpack/issues/10152/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/webpack/webpack/issues/10152/timeline","performed_via_github_app":null,"state_reason":"completed"}