{"url":"https://api.github.com/repos/python-pillow/Pillow/issues/6652","repository_url":"https://api.github.com/repos/python-pillow/Pillow","labels_url":"https://api.github.com/repos/python-pillow/Pillow/issues/6652/labels{/name}","comments_url":"https://api.github.com/repos/python-pillow/Pillow/issues/6652/comments","events_url":"https://api.github.com/repos/python-pillow/Pillow/issues/6652/events","html_url":"https://github.com/python-pillow/Pillow/issues/6652","id":1402117034,"node_id":"I_kwDOAE7pkM5Tkpuq","number":6652,"title":"ImagePalette: loading a translucent RGBA color into an RGB palette will break the palette","user":{"login":"jsbueno","id":535236,"node_id":"MDQ6VXNlcjUzNTIzNg==","avatar_url":"https://avatars.githubusercontent.com/u/535236?v=4","gravatar_id":"","url":"https://api.github.com/users/jsbueno","html_url":"https://github.com/jsbueno","followers_url":"https://api.github.com/users/jsbueno/followers","following_url":"https://api.github.com/users/jsbueno/following{/other_user}","gists_url":"https://api.github.com/users/jsbueno/gists{/gist_id}","starred_url":"https://api.github.com/users/jsbueno/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jsbueno/subscriptions","organizations_url":"https://api.github.com/users/jsbueno/orgs","repos_url":"https://api.github.com/users/jsbueno/repos","events_url":"https://api.github.com/users/jsbueno/events{/privacy}","received_events_url":"https://api.github.com/users/jsbueno/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":400993500,"node_id":"MDU6TGFiZWw0MDA5OTM1MDA=","url":"https://api.github.com/repos/python-pillow/Pillow/labels/Palette","name":"Palette","color":"5319e7","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2022-10-09T01:47:35Z","updated_at":"2024-03-28T08:39:46Z","closed_at":"2022-10-10T08:23:19Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"This is a minor thing:\r\n\r\nIn PIL/ImagePalette.py, we have\r\nhttps://github.com/python-pillow/Pillow/blob/243402e78e2bf2b7af478c6d891816e372b5c3f9/src/PIL/ImagePalette.py#L118-L119\r\n\r\nAnd then, this `color` is consumed in line 151, always assuming it is 3-bytes long (and having 4 would make colors from that point on \"out of sync\") . I was about to send a small PR raising value error in the unchecked case: \r\n\r\n ```python\r\n    if len(color) == 4 and color[3] < 255:\r\n           raise ValueError(...)\r\n```\r\nBut then, why not just truncate the alpha away, and always use the RGB value if an RGBA color is added to an RGB palette?\r\nCan we do that?\r\n\r\n(the sole purpose of this issue is to ask this question - I should submit fix + test afterwards)","closed_by":{"login":"radarhere","id":3112309,"node_id":"MDQ6VXNlcjMxMTIzMDk=","avatar_url":"https://avatars.githubusercontent.com/u/3112309?v=4","gravatar_id":"","url":"https://api.github.com/users/radarhere","html_url":"https://github.com/radarhere","followers_url":"https://api.github.com/users/radarhere/followers","following_url":"https://api.github.com/users/radarhere/following{/other_user}","gists_url":"https://api.github.com/users/radarhere/gists{/gist_id}","starred_url":"https://api.github.com/users/radarhere/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/radarhere/subscriptions","organizations_url":"https://api.github.com/users/radarhere/orgs","repos_url":"https://api.github.com/users/radarhere/repos","events_url":"https://api.github.com/users/radarhere/events{/privacy}","received_events_url":"https://api.github.com/users/radarhere/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/python-pillow/Pillow/issues/6652/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/python-pillow/Pillow/issues/6652/timeline","performed_via_github_app":null,"state_reason":"completed"}