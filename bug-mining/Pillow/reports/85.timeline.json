[{"id":2151125931,"node_id":"MDE3OlJlbmFtZWRUaXRsZUV2ZW50MjE1MTEyNTkzMQ==","url":"https://api.github.com/repos/python-pillow/Pillow/issues/events/2151125931","actor":{"login":"radarhere","id":3112309,"node_id":"MDQ6VXNlcjMxMTIzMDk=","avatar_url":"https://avatars.githubusercontent.com/u/3112309?v=4","gravatar_id":"","url":"https://api.github.com/users/radarhere","html_url":"https://github.com/radarhere","followers_url":"https://api.github.com/users/radarhere/followers","following_url":"https://api.github.com/users/radarhere/following{/other_user}","gists_url":"https://api.github.com/users/radarhere/gists{/gist_id}","starred_url":"https://api.github.com/users/radarhere/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/radarhere/subscriptions","organizations_url":"https://api.github.com/users/radarhere/orgs","repos_url":"https://api.github.com/users/radarhere/repos","events_url":"https://api.github.com/users/radarhere/events{/privacy}","received_events_url":"https://api.github.com/users/radarhere/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"renamed","commit_id":null,"commit_url":null,"created_at":"2019-02-20T08:00:46Z","rename":{"from":"animated, transparent GIFs not calculating diff correctly","to":"Animated, transparent GIFs not calculating diff correctly"},"performed_via_github_app":null},{"id":2151126864,"node_id":"MDEyOkxhYmVsZWRFdmVudDIxNTExMjY4NjQ=","url":"https://api.github.com/repos/python-pillow/Pillow/issues/events/2151126864","actor":{"login":"radarhere","id":3112309,"node_id":"MDQ6VXNlcjMxMTIzMDk=","avatar_url":"https://avatars.githubusercontent.com/u/3112309?v=4","gravatar_id":"","url":"https://api.github.com/users/radarhere","html_url":"https://github.com/radarhere","followers_url":"https://api.github.com/users/radarhere/followers","following_url":"https://api.github.com/users/radarhere/following{/other_user}","gists_url":"https://api.github.com/users/radarhere/gists{/gist_id}","starred_url":"https://api.github.com/users/radarhere/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/radarhere/subscriptions","organizations_url":"https://api.github.com/users/radarhere/orgs","repos_url":"https://api.github.com/users/radarhere/repos","events_url":"https://api.github.com/users/radarhere/events{/privacy}","received_events_url":"https://api.github.com/users/radarhere/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2019-02-20T08:01:17Z","label":{"name":"GIF","color":"fbca04"},"performed_via_github_app":null},{"actor":{"login":"Artheau","id":87869,"node_id":"MDQ6VXNlcjg3ODY5","avatar_url":"https://avatars.githubusercontent.com/u/87869?v=4","gravatar_id":"","url":"https://api.github.com/users/Artheau","html_url":"https://github.com/Artheau","followers_url":"https://api.github.com/users/Artheau/followers","following_url":"https://api.github.com/users/Artheau/following{/other_user}","gists_url":"https://api.github.com/users/Artheau/gists{/gist_id}","starred_url":"https://api.github.com/users/Artheau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Artheau/subscriptions","organizations_url":"https://api.github.com/users/Artheau/orgs","repos_url":"https://api.github.com/users/Artheau/repos","events_url":"https://api.github.com/users/Artheau/events{/privacy}","received_events_url":"https://api.github.com/users/Artheau/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-03-08T16:49:31Z","updated_at":"2019-03-08T16:49:31Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/python-pillow/Pillow/issues/3660","repository_url":"https://api.github.com/repos/python-pillow/Pillow","labels_url":"https://api.github.com/repos/python-pillow/Pillow/issues/3660/labels{/name}","comments_url":"https://api.github.com/repos/python-pillow/Pillow/issues/3660/comments","events_url":"https://api.github.com/repos/python-pillow/Pillow/issues/3660/events","html_url":"https://github.com/python-pillow/Pillow/issues/3660","id":411129140,"node_id":"MDU6SXNzdWU0MTExMjkxNDA=","number":3660,"title":"Are frames compressed or changed when creating gifs?","user":{"login":"dhsdshdhk","id":28062763,"node_id":"MDQ6VXNlcjI4MDYyNzYz","avatar_url":"https://avatars.githubusercontent.com/u/28062763?v=4","gravatar_id":"","url":"https://api.github.com/users/dhsdshdhk","html_url":"https://github.com/dhsdshdhk","followers_url":"https://api.github.com/users/dhsdshdhk/followers","following_url":"https://api.github.com/users/dhsdshdhk/following{/other_user}","gists_url":"https://api.github.com/users/dhsdshdhk/gists{/gist_id}","starred_url":"https://api.github.com/users/dhsdshdhk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dhsdshdhk/subscriptions","organizations_url":"https://api.github.com/users/dhsdshdhk/orgs","repos_url":"https://api.github.com/users/dhsdshdhk/repos","events_url":"https://api.github.com/users/dhsdshdhk/events{/privacy}","received_events_url":"https://api.github.com/users/dhsdshdhk/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":341437806,"node_id":"MDU6TGFiZWwzNDE0Mzc4MDY=","url":"https://api.github.com/repos/python-pillow/Pillow/labels/GIF","name":"GIF","color":"fbca04","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":16,"created_at":"2019-02-16T23:57:04Z","updated_at":"2019-03-30T21:02:13Z","closed_at":"2019-03-30T21:02:13Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"repository":{"id":5171600,"node_id":"MDEwOlJlcG9zaXRvcnk1MTcxNjAw","name":"Pillow","full_name":"python-pillow/Pillow","private":false,"owner":{"login":"python-pillow","id":2036701,"node_id":"MDEyOk9yZ2FuaXphdGlvbjIwMzY3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/2036701?v=4","gravatar_id":"","url":"https://api.github.com/users/python-pillow","html_url":"https://github.com/python-pillow","followers_url":"https://api.github.com/users/python-pillow/followers","following_url":"https://api.github.com/users/python-pillow/following{/other_user}","gists_url":"https://api.github.com/users/python-pillow/gists{/gist_id}","starred_url":"https://api.github.com/users/python-pillow/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/python-pillow/subscriptions","organizations_url":"https://api.github.com/users/python-pillow/orgs","repos_url":"https://api.github.com/users/python-pillow/repos","events_url":"https://api.github.com/users/python-pillow/events{/privacy}","received_events_url":"https://api.github.com/users/python-pillow/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/python-pillow/Pillow","description":"Python Imaging Library (Fork)","fork":false,"url":"https://api.github.com/repos/python-pillow/Pillow","forks_url":"https://api.github.com/repos/python-pillow/Pillow/forks","keys_url":"https://api.github.com/repos/python-pillow/Pillow/keys{/key_id}","collaborators_url":"https://api.github.com/repos/python-pillow/Pillow/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/python-pillow/Pillow/teams","hooks_url":"https://api.github.com/repos/python-pillow/Pillow/hooks","issue_events_url":"https://api.github.com/repos/python-pillow/Pillow/issues/events{/number}","events_url":"https://api.github.com/repos/python-pillow/Pillow/events","assignees_url":"https://api.github.com/repos/python-pillow/Pillow/assignees{/user}","branches_url":"https://api.github.com/repos/python-pillow/Pillow/branches{/branch}","tags_url":"https://api.github.com/repos/python-pillow/Pillow/tags","blobs_url":"https://api.github.com/repos/python-pillow/Pillow/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/python-pillow/Pillow/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/python-pillow/Pillow/git/refs{/sha}","trees_url":"https://api.github.com/repos/python-pillow/Pillow/git/trees{/sha}","statuses_url":"https://api.github.com/repos/python-pillow/Pillow/statuses/{sha}","languages_url":"https://api.github.com/repos/python-pillow/Pillow/languages","stargazers_url":"https://api.github.com/repos/python-pillow/Pillow/stargazers","contributors_url":"https://api.github.com/repos/python-pillow/Pillow/contributors","subscribers_url":"https://api.github.com/repos/python-pillow/Pillow/subscribers","subscription_url":"https://api.github.com/repos/python-pillow/Pillow/subscription","commits_url":"https://api.github.com/repos/python-pillow/Pillow/commits{/sha}","git_commits_url":"https://api.github.com/repos/python-pillow/Pillow/git/commits{/sha}","comments_url":"https://api.github.com/repos/python-pillow/Pillow/comments{/number}","issue_comment_url":"https://api.github.com/repos/python-pillow/Pillow/issues/comments{/number}","contents_url":"https://api.github.com/repos/python-pillow/Pillow/contents/{+path}","compare_url":"https://api.github.com/repos/python-pillow/Pillow/compare/{base}...{head}","merges_url":"https://api.github.com/repos/python-pillow/Pillow/merges","archive_url":"https://api.github.com/repos/python-pillow/Pillow/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/python-pillow/Pillow/downloads","issues_url":"https://api.github.com/repos/python-pillow/Pillow/issues{/number}","pulls_url":"https://api.github.com/repos/python-pillow/Pillow/pulls{/number}","milestones_url":"https://api.github.com/repos/python-pillow/Pillow/milestones{/number}","notifications_url":"https://api.github.com/repos/python-pillow/Pillow/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/python-pillow/Pillow/labels{/name}","releases_url":"https://api.github.com/repos/python-pillow/Pillow/releases{/id}","deployments_url":"https://api.github.com/repos/python-pillow/Pillow/deployments","created_at":"2012-07-24T21:38:39Z","updated_at":"2025-11-09T17:08:02Z","pushed_at":"2025-11-05T17:24:43Z","git_url":"git://github.com/python-pillow/Pillow.git","ssh_url":"git@github.com:python-pillow/Pillow.git","clone_url":"https://github.com/python-pillow/Pillow.git","svn_url":"https://github.com/python-pillow/Pillow","homepage":"https://python-pillow.github.io","size":209075,"stargazers_count":13177,"watchers_count":13177,"language":"Python","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":true,"has_discussions":true,"forks_count":2359,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":117,"license":{"key":"other","name":"Other","spdx_id":"NOASSERTION","url":null,"node_id":"MDc6TGljZW5zZTA="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["c","cross-platform","image","image-processing","pil","pillow","python","python-3"],"visibility":"public","forks":2359,"open_issues":117,"watchers":13177,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"body":"### What did you do?\r\nEdited frames of a gif and saved them.\r\n### What did you expect to happen?\r\nExpected them to be exactly as I saved.\r\n### What actually happened?\r\nWhen I reopened, the frames were not the same.\r\n### What are your OS, Python and Pillow versions?\r\nLinux, Python3.5, Pillow 5.4.1\r\n\r\n```python\r\n# opening a gif\r\nimage = Image.open(host_path)\r\n        if host_path.lower().endswith('gif'):\r\n            frames = []\r\n            try:\r\n                while True:\r\n                    frames.append(numpy.array(image.convert('RGB')))\r\n                    image.seek(image.tell()+1)\r\n            except EOFError:\r\n                pass\r\n            return numpy.asarray(frames)\r\n```\r\n`[operations with the array...]`\r\n```python\r\n# saving a gif\r\n    elif host_path.lower().endswith('gif'):\r\n        frames = []\r\n        for f in array:\r\n            frames.append(Image.fromarray(f))\r\n        frames[0].save(host_path, save_all=True, append_images=frames[1:], loop=0)\r\n```","reactions":{"url":"https://api.github.com/repos/python-pillow/Pillow/issues/3660/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/python-pillow/Pillow/issues/3660/timeline","performed_via_github_app":null,"state_reason":"completed"}},"event":"cross-referenced"},{"actor":{"login":"Artheau","id":87869,"node_id":"MDQ6VXNlcjg3ODY5","avatar_url":"https://avatars.githubusercontent.com/u/87869?v=4","gravatar_id":"","url":"https://api.github.com/users/Artheau","html_url":"https://github.com/Artheau","followers_url":"https://api.github.com/users/Artheau/followers","following_url":"https://api.github.com/users/Artheau/following{/other_user}","gists_url":"https://api.github.com/users/Artheau/gists{/gist_id}","starred_url":"https://api.github.com/users/Artheau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Artheau/subscriptions","organizations_url":"https://api.github.com/users/Artheau/orgs","repos_url":"https://api.github.com/users/Artheau/repos","events_url":"https://api.github.com/users/Artheau/events{/privacy}","received_events_url":"https://api.github.com/users/Artheau/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-03-08T16:50:07Z","updated_at":"2019-03-08T16:50:07Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/python-pillow/Pillow/issues/3603","repository_url":"https://api.github.com/repos/python-pillow/Pillow","labels_url":"https://api.github.com/repos/python-pillow/Pillow/issues/3603/labels{/name}","comments_url":"https://api.github.com/repos/python-pillow/Pillow/issues/3603/comments","events_url":"https://api.github.com/repos/python-pillow/Pillow/issues/3603/events","html_url":"https://github.com/python-pillow/Pillow/issues/3603","id":402445224,"node_id":"MDU6SXNzdWU0MDI0NDUyMjQ=","number":3603,"title":"Option to disable gif delta frame optimizations","user":{"login":"FelixWolf","id":6495643,"node_id":"MDQ6VXNlcjY0OTU2NDM=","avatar_url":"https://avatars.githubusercontent.com/u/6495643?v=4","gravatar_id":"","url":"https://api.github.com/users/FelixWolf","html_url":"https://github.com/FelixWolf","followers_url":"https://api.github.com/users/FelixWolf/followers","following_url":"https://api.github.com/users/FelixWolf/following{/other_user}","gists_url":"https://api.github.com/users/FelixWolf/gists{/gist_id}","starred_url":"https://api.github.com/users/FelixWolf/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/FelixWolf/subscriptions","organizations_url":"https://api.github.com/users/FelixWolf/orgs","repos_url":"https://api.github.com/users/FelixWolf/repos","events_url":"https://api.github.com/users/FelixWolf/events{/privacy}","received_events_url":"https://api.github.com/users/FelixWolf/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":341437806,"node_id":"MDU6TGFiZWwzNDE0Mzc4MDY=","url":"https://api.github.com/repos/python-pillow/Pillow/labels/GIF","name":"GIF","color":"fbca04","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":7,"created_at":"2019-01-23T21:50:08Z","updated_at":"2021-04-01T12:34:17Z","closed_at":"2021-04-01T12:34:17Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"repository":{"id":5171600,"node_id":"MDEwOlJlcG9zaXRvcnk1MTcxNjAw","name":"Pillow","full_name":"python-pillow/Pillow","private":false,"owner":{"login":"python-pillow","id":2036701,"node_id":"MDEyOk9yZ2FuaXphdGlvbjIwMzY3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/2036701?v=4","gravatar_id":"","url":"https://api.github.com/users/python-pillow","html_url":"https://github.com/python-pillow","followers_url":"https://api.github.com/users/python-pillow/followers","following_url":"https://api.github.com/users/python-pillow/following{/other_user}","gists_url":"https://api.github.com/users/python-pillow/gists{/gist_id}","starred_url":"https://api.github.com/users/python-pillow/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/python-pillow/subscriptions","organizations_url":"https://api.github.com/users/python-pillow/orgs","repos_url":"https://api.github.com/users/python-pillow/repos","events_url":"https://api.github.com/users/python-pillow/events{/privacy}","received_events_url":"https://api.github.com/users/python-pillow/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/python-pillow/Pillow","description":"Python Imaging Library (Fork)","fork":false,"url":"https://api.github.com/repos/python-pillow/Pillow","forks_url":"https://api.github.com/repos/python-pillow/Pillow/forks","keys_url":"https://api.github.com/repos/python-pillow/Pillow/keys{/key_id}","collaborators_url":"https://api.github.com/repos/python-pillow/Pillow/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/python-pillow/Pillow/teams","hooks_url":"https://api.github.com/repos/python-pillow/Pillow/hooks","issue_events_url":"https://api.github.com/repos/python-pillow/Pillow/issues/events{/number}","events_url":"https://api.github.com/repos/python-pillow/Pillow/events","assignees_url":"https://api.github.com/repos/python-pillow/Pillow/assignees{/user}","branches_url":"https://api.github.com/repos/python-pillow/Pillow/branches{/branch}","tags_url":"https://api.github.com/repos/python-pillow/Pillow/tags","blobs_url":"https://api.github.com/repos/python-pillow/Pillow/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/python-pillow/Pillow/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/python-pillow/Pillow/git/refs{/sha}","trees_url":"https://api.github.com/repos/python-pillow/Pillow/git/trees{/sha}","statuses_url":"https://api.github.com/repos/python-pillow/Pillow/statuses/{sha}","languages_url":"https://api.github.com/repos/python-pillow/Pillow/languages","stargazers_url":"https://api.github.com/repos/python-pillow/Pillow/stargazers","contributors_url":"https://api.github.com/repos/python-pillow/Pillow/contributors","subscribers_url":"https://api.github.com/repos/python-pillow/Pillow/subscribers","subscription_url":"https://api.github.com/repos/python-pillow/Pillow/subscription","commits_url":"https://api.github.com/repos/python-pillow/Pillow/commits{/sha}","git_commits_url":"https://api.github.com/repos/python-pillow/Pillow/git/commits{/sha}","comments_url":"https://api.github.com/repos/python-pillow/Pillow/comments{/number}","issue_comment_url":"https://api.github.com/repos/python-pillow/Pillow/issues/comments{/number}","contents_url":"https://api.github.com/repos/python-pillow/Pillow/contents/{+path}","compare_url":"https://api.github.com/repos/python-pillow/Pillow/compare/{base}...{head}","merges_url":"https://api.github.com/repos/python-pillow/Pillow/merges","archive_url":"https://api.github.com/repos/python-pillow/Pillow/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/python-pillow/Pillow/downloads","issues_url":"https://api.github.com/repos/python-pillow/Pillow/issues{/number}","pulls_url":"https://api.github.com/repos/python-pillow/Pillow/pulls{/number}","milestones_url":"https://api.github.com/repos/python-pillow/Pillow/milestones{/number}","notifications_url":"https://api.github.com/repos/python-pillow/Pillow/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/python-pillow/Pillow/labels{/name}","releases_url":"https://api.github.com/repos/python-pillow/Pillow/releases{/id}","deployments_url":"https://api.github.com/repos/python-pillow/Pillow/deployments","created_at":"2012-07-24T21:38:39Z","updated_at":"2025-11-09T17:08:02Z","pushed_at":"2025-11-05T17:24:43Z","git_url":"git://github.com/python-pillow/Pillow.git","ssh_url":"git@github.com:python-pillow/Pillow.git","clone_url":"https://github.com/python-pillow/Pillow.git","svn_url":"https://github.com/python-pillow/Pillow","homepage":"https://python-pillow.github.io","size":209075,"stargazers_count":13177,"watchers_count":13177,"language":"Python","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":true,"has_discussions":true,"forks_count":2359,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":117,"license":{"key":"other","name":"Other","spdx_id":"NOASSERTION","url":null,"node_id":"MDc6TGljZW5zZTA="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["c","cross-platform","image","image-processing","pil","pillow","python","python-3"],"visibility":"public","forks":2359,"open_issues":117,"watchers":13177,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"body":"I feel it would be nice/useful to have the option to disable delta frame (allowing full frame redraw). Delta Frame can cause issues with specific types of animations.\r\nA case example would be a animation which uses transparency. It will need to overwrite pixels that are no longer used, but delta frames *will* crop out these pixels resulting in a broken animation, leaving the programmer with one of two types of images:\r\n1. A animation with random cropping(Notice the feet/head): https://i.imgur.com/xnh6Lq5.gif\r\n2. A animation with ghosting: https://i.imgur.com/uCekDte.gif\r\n\r\nExample of a implementation:\r\n[GifImagePlugin.py.diff.txt](https://github.com/python-pillow/Pillow/files/2789326/GifImagePlugin.py.diff.txt) (Had to save it as a .txt because for some reason Github doesn't allow diff of all file types to reject)\r\nAttached diff is messy, could be optimized (doesn't disable cropping code), and the name probably could be less long.\r\n\r\n--\r\nEdit: This might actually be a bug?\r\nTurns out the issue only seems to occur if the background transparency data in a png contains color information and isn't empty/same color.","reactions":{"url":"https://api.github.com/repos/python-pillow/Pillow/issues/3603/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/python-pillow/Pillow/issues/3603/timeline","performed_via_github_app":null,"state_reason":"completed"}},"event":"cross-referenced"},{"actor":{"login":"Artheau","id":87869,"node_id":"MDQ6VXNlcjg3ODY5","avatar_url":"https://avatars.githubusercontent.com/u/87869?v=4","gravatar_id":"","url":"https://api.github.com/users/Artheau","html_url":"https://github.com/Artheau","followers_url":"https://api.github.com/users/Artheau/followers","following_url":"https://api.github.com/users/Artheau/following{/other_user}","gists_url":"https://api.github.com/users/Artheau/gists{/gist_id}","starred_url":"https://api.github.com/users/Artheau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Artheau/subscriptions","organizations_url":"https://api.github.com/users/Artheau/orgs","repos_url":"https://api.github.com/users/Artheau/repos","events_url":"https://api.github.com/users/Artheau/events{/privacy}","received_events_url":"https://api.github.com/users/Artheau/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-03-08T16:50:43Z","updated_at":"2019-03-08T16:50:43Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/python-pillow/Pillow/issues/3433","repository_url":"https://api.github.com/repos/python-pillow/Pillow","labels_url":"https://api.github.com/repos/python-pillow/Pillow/issues/3433/labels{/name}","comments_url":"https://api.github.com/repos/python-pillow/Pillow/issues/3433/comments","events_url":"https://api.github.com/repos/python-pillow/Pillow/issues/3433/events","html_url":"https://github.com/python-pillow/Pillow/issues/3433","id":373301981,"node_id":"MDU6SXNzdWUzNzMzMDE5ODE=","number":3433,"title":"GIF transparency not applied correctly","user":{"login":"zewt","id":286287,"node_id":"MDQ6VXNlcjI4NjI4Nw==","avatar_url":"https://avatars.githubusercontent.com/u/286287?v=4","gravatar_id":"","url":"https://api.github.com/users/zewt","html_url":"https://github.com/zewt","followers_url":"https://api.github.com/users/zewt/followers","following_url":"https://api.github.com/users/zewt/following{/other_user}","gists_url":"https://api.github.com/users/zewt/gists{/gist_id}","starred_url":"https://api.github.com/users/zewt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zewt/subscriptions","organizations_url":"https://api.github.com/users/zewt/orgs","repos_url":"https://api.github.com/users/zewt/repos","events_url":"https://api.github.com/users/zewt/events{/privacy}","received_events_url":"https://api.github.com/users/zewt/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":341437806,"node_id":"MDU6TGFiZWwzNDE0Mzc4MDY=","url":"https://api.github.com/repos/python-pillow/Pillow/labels/GIF","name":"GIF","color":"fbca04","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2018-10-24T04:38:52Z","updated_at":"2021-02-26T10:47:16Z","closed_at":"2021-02-26T10:47:15Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"repository":{"id":5171600,"node_id":"MDEwOlJlcG9zaXRvcnk1MTcxNjAw","name":"Pillow","full_name":"python-pillow/Pillow","private":false,"owner":{"login":"python-pillow","id":2036701,"node_id":"MDEyOk9yZ2FuaXphdGlvbjIwMzY3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/2036701?v=4","gravatar_id":"","url":"https://api.github.com/users/python-pillow","html_url":"https://github.com/python-pillow","followers_url":"https://api.github.com/users/python-pillow/followers","following_url":"https://api.github.com/users/python-pillow/following{/other_user}","gists_url":"https://api.github.com/users/python-pillow/gists{/gist_id}","starred_url":"https://api.github.com/users/python-pillow/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/python-pillow/subscriptions","organizations_url":"https://api.github.com/users/python-pillow/orgs","repos_url":"https://api.github.com/users/python-pillow/repos","events_url":"https://api.github.com/users/python-pillow/events{/privacy}","received_events_url":"https://api.github.com/users/python-pillow/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/python-pillow/Pillow","description":"Python Imaging Library (Fork)","fork":false,"url":"https://api.github.com/repos/python-pillow/Pillow","forks_url":"https://api.github.com/repos/python-pillow/Pillow/forks","keys_url":"https://api.github.com/repos/python-pillow/Pillow/keys{/key_id}","collaborators_url":"https://api.github.com/repos/python-pillow/Pillow/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/python-pillow/Pillow/teams","hooks_url":"https://api.github.com/repos/python-pillow/Pillow/hooks","issue_events_url":"https://api.github.com/repos/python-pillow/Pillow/issues/events{/number}","events_url":"https://api.github.com/repos/python-pillow/Pillow/events","assignees_url":"https://api.github.com/repos/python-pillow/Pillow/assignees{/user}","branches_url":"https://api.github.com/repos/python-pillow/Pillow/branches{/branch}","tags_url":"https://api.github.com/repos/python-pillow/Pillow/tags","blobs_url":"https://api.github.com/repos/python-pillow/Pillow/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/python-pillow/Pillow/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/python-pillow/Pillow/git/refs{/sha}","trees_url":"https://api.github.com/repos/python-pillow/Pillow/git/trees{/sha}","statuses_url":"https://api.github.com/repos/python-pillow/Pillow/statuses/{sha}","languages_url":"https://api.github.com/repos/python-pillow/Pillow/languages","stargazers_url":"https://api.github.com/repos/python-pillow/Pillow/stargazers","contributors_url":"https://api.github.com/repos/python-pillow/Pillow/contributors","subscribers_url":"https://api.github.com/repos/python-pillow/Pillow/subscribers","subscription_url":"https://api.github.com/repos/python-pillow/Pillow/subscription","commits_url":"https://api.github.com/repos/python-pillow/Pillow/commits{/sha}","git_commits_url":"https://api.github.com/repos/python-pillow/Pillow/git/commits{/sha}","comments_url":"https://api.github.com/repos/python-pillow/Pillow/comments{/number}","issue_comment_url":"https://api.github.com/repos/python-pillow/Pillow/issues/comments{/number}","contents_url":"https://api.github.com/repos/python-pillow/Pillow/contents/{+path}","compare_url":"https://api.github.com/repos/python-pillow/Pillow/compare/{base}...{head}","merges_url":"https://api.github.com/repos/python-pillow/Pillow/merges","archive_url":"https://api.github.com/repos/python-pillow/Pillow/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/python-pillow/Pillow/downloads","issues_url":"https://api.github.com/repos/python-pillow/Pillow/issues{/number}","pulls_url":"https://api.github.com/repos/python-pillow/Pillow/pulls{/number}","milestones_url":"https://api.github.com/repos/python-pillow/Pillow/milestones{/number}","notifications_url":"https://api.github.com/repos/python-pillow/Pillow/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/python-pillow/Pillow/labels{/name}","releases_url":"https://api.github.com/repos/python-pillow/Pillow/releases{/id}","deployments_url":"https://api.github.com/repos/python-pillow/Pillow/deployments","created_at":"2012-07-24T21:38:39Z","updated_at":"2025-11-09T17:08:02Z","pushed_at":"2025-11-05T17:24:43Z","git_url":"git://github.com/python-pillow/Pillow.git","ssh_url":"git@github.com:python-pillow/Pillow.git","clone_url":"https://github.com/python-pillow/Pillow.git","svn_url":"https://github.com/python-pillow/Pillow","homepage":"https://python-pillow.github.io","size":209075,"stargazers_count":13177,"watchers_count":13177,"language":"Python","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":true,"has_discussions":true,"forks_count":2359,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":117,"license":{"key":"other","name":"Other","spdx_id":"NOASSERTION","url":null,"node_id":"MDc6TGljZW5zZTA="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["c","cross-platform","image","image-processing","pil","pillow","python","python-3"],"visibility":"public","forks":2359,"open_issues":117,"watchers":13177,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"body":"The attached animated GIF image is decoded incorrectly (testing with master).  This was exported by Photoshop and is decoded correctly by ffmpeg and other decoders.\r\n\r\nThe file is 3x1 pixels and three frames: XBX GBG XBX (X: transparent, G: green, B: blue).\r\nPillow decodes it as: XBX GXG XBX, leaving pixel 1x0 in the second frame transparent when it should be blue.\r\n\r\nThe issue seems to be that the transparent color index isn't handled correctly.  It should leave the existing pixel in the buffer unchanged.  Instead, the decoder overwrites the pixel with the transparent index, changing the blue pixel to transparent.  There's a special case for dispose mode 1 in load_end, but it's a little odd.  (The dispose mode only affects the next frame, but this is affecting the current frame, and it doesn't do anything with other dispose modes.)\r\n\r\nI'll send a PR shortly to fix this.  It adds two tests using this image: one for this issue, and one for an issue that came up while implementing this.  (Reading img.n_pixels changed the image, since the image wasn't being reset when decoding frame 0 after rewinding.  This didn't matter before, since the decoder overwrote the whole image, but it matters now.)  The load_end special case is removed, since the compositing happens in the decoder.  Background dispose clears to the transparency color if one is set, which matches other decoders.\r\n\r\nIf anyone's interested in trying to make the decoder work everywhere, it might be useful to check other projects for comprehensive GIF tests.  There's probably one in Chromium.\r\n\r\n![test](https://user-images.githubusercontent.com/286287/47406301-2df63880-d71b-11e8-894f-d09e9f176247.gif)","reactions":{"url":"https://api.github.com/repos/python-pillow/Pillow/issues/3433/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/python-pillow/Pillow/issues/3433/timeline","performed_via_github_app":null,"state_reason":"completed"}},"event":"cross-referenced"},{"actor":{"login":"Artheau","id":87869,"node_id":"MDQ6VXNlcjg3ODY5","avatar_url":"https://avatars.githubusercontent.com/u/87869?v=4","gravatar_id":"","url":"https://api.github.com/users/Artheau","html_url":"https://github.com/Artheau","followers_url":"https://api.github.com/users/Artheau/followers","following_url":"https://api.github.com/users/Artheau/following{/other_user}","gists_url":"https://api.github.com/users/Artheau/gists{/gist_id}","starred_url":"https://api.github.com/users/Artheau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Artheau/subscriptions","organizations_url":"https://api.github.com/users/Artheau/orgs","repos_url":"https://api.github.com/users/Artheau/repos","events_url":"https://api.github.com/users/Artheau/events{/privacy}","received_events_url":"https://api.github.com/users/Artheau/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-03-08T16:51:00Z","updated_at":"2019-03-08T16:51:00Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/python-pillow/Pillow/issues/3357","repository_url":"https://api.github.com/repos/python-pillow/Pillow","labels_url":"https://api.github.com/repos/python-pillow/Pillow/issues/3357/labels{/name}","comments_url":"https://api.github.com/repos/python-pillow/Pillow/issues/3357/comments","events_url":"https://api.github.com/repos/python-pillow/Pillow/issues/3357/events","html_url":"https://github.com/python-pillow/Pillow/issues/3357","id":360596256,"node_id":"MDU6SXNzdWUzNjA1OTYyNTY=","number":3357,"title":"How to save a gif with transparency without ruining all of it?","user":{"login":"jamuwu","id":14200370,"node_id":"MDQ6VXNlcjE0MjAwMzcw","avatar_url":"https://avatars.githubusercontent.com/u/14200370?v=4","gravatar_id":"","url":"https://api.github.com/users/jamuwu","html_url":"https://github.com/jamuwu","followers_url":"https://api.github.com/users/jamuwu/followers","following_url":"https://api.github.com/users/jamuwu/following{/other_user}","gists_url":"https://api.github.com/users/jamuwu/gists{/gist_id}","starred_url":"https://api.github.com/users/jamuwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jamuwu/subscriptions","organizations_url":"https://api.github.com/users/jamuwu/orgs","repos_url":"https://api.github.com/users/jamuwu/repos","events_url":"https://api.github.com/users/jamuwu/events{/privacy}","received_events_url":"https://api.github.com/users/jamuwu/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":10115804,"node_id":"MDU6TGFiZWwxMDExNTgwNA==","url":"https://api.github.com/repos/python-pillow/Pillow/labels/Bug","name":"Bug","color":"fef2c0","default":false,"description":"Any unexpected behavior, until confirmed feature."},{"id":341437806,"node_id":"MDU6TGFiZWwzNDE0Mzc4MDY=","url":"https://api.github.com/repos/python-pillow/Pillow/labels/GIF","name":"GIF","color":"fbca04","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":6,"created_at":"2018-09-16T03:02:10Z","updated_at":"2019-04-10T19:37:00Z","closed_at":"2019-04-10T03:11:55Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"repository":{"id":5171600,"node_id":"MDEwOlJlcG9zaXRvcnk1MTcxNjAw","name":"Pillow","full_name":"python-pillow/Pillow","private":false,"owner":{"login":"python-pillow","id":2036701,"node_id":"MDEyOk9yZ2FuaXphdGlvbjIwMzY3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/2036701?v=4","gravatar_id":"","url":"https://api.github.com/users/python-pillow","html_url":"https://github.com/python-pillow","followers_url":"https://api.github.com/users/python-pillow/followers","following_url":"https://api.github.com/users/python-pillow/following{/other_user}","gists_url":"https://api.github.com/users/python-pillow/gists{/gist_id}","starred_url":"https://api.github.com/users/python-pillow/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/python-pillow/subscriptions","organizations_url":"https://api.github.com/users/python-pillow/orgs","repos_url":"https://api.github.com/users/python-pillow/repos","events_url":"https://api.github.com/users/python-pillow/events{/privacy}","received_events_url":"https://api.github.com/users/python-pillow/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/python-pillow/Pillow","description":"Python Imaging Library (Fork)","fork":false,"url":"https://api.github.com/repos/python-pillow/Pillow","forks_url":"https://api.github.com/repos/python-pillow/Pillow/forks","keys_url":"https://api.github.com/repos/python-pillow/Pillow/keys{/key_id}","collaborators_url":"https://api.github.com/repos/python-pillow/Pillow/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/python-pillow/Pillow/teams","hooks_url":"https://api.github.com/repos/python-pillow/Pillow/hooks","issue_events_url":"https://api.github.com/repos/python-pillow/Pillow/issues/events{/number}","events_url":"https://api.github.com/repos/python-pillow/Pillow/events","assignees_url":"https://api.github.com/repos/python-pillow/Pillow/assignees{/user}","branches_url":"https://api.github.com/repos/python-pillow/Pillow/branches{/branch}","tags_url":"https://api.github.com/repos/python-pillow/Pillow/tags","blobs_url":"https://api.github.com/repos/python-pillow/Pillow/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/python-pillow/Pillow/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/python-pillow/Pillow/git/refs{/sha}","trees_url":"https://api.github.com/repos/python-pillow/Pillow/git/trees{/sha}","statuses_url":"https://api.github.com/repos/python-pillow/Pillow/statuses/{sha}","languages_url":"https://api.github.com/repos/python-pillow/Pillow/languages","stargazers_url":"https://api.github.com/repos/python-pillow/Pillow/stargazers","contributors_url":"https://api.github.com/repos/python-pillow/Pillow/contributors","subscribers_url":"https://api.github.com/repos/python-pillow/Pillow/subscribers","subscription_url":"https://api.github.com/repos/python-pillow/Pillow/subscription","commits_url":"https://api.github.com/repos/python-pillow/Pillow/commits{/sha}","git_commits_url":"https://api.github.com/repos/python-pillow/Pillow/git/commits{/sha}","comments_url":"https://api.github.com/repos/python-pillow/Pillow/comments{/number}","issue_comment_url":"https://api.github.com/repos/python-pillow/Pillow/issues/comments{/number}","contents_url":"https://api.github.com/repos/python-pillow/Pillow/contents/{+path}","compare_url":"https://api.github.com/repos/python-pillow/Pillow/compare/{base}...{head}","merges_url":"https://api.github.com/repos/python-pillow/Pillow/merges","archive_url":"https://api.github.com/repos/python-pillow/Pillow/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/python-pillow/Pillow/downloads","issues_url":"https://api.github.com/repos/python-pillow/Pillow/issues{/number}","pulls_url":"https://api.github.com/repos/python-pillow/Pillow/pulls{/number}","milestones_url":"https://api.github.com/repos/python-pillow/Pillow/milestones{/number}","notifications_url":"https://api.github.com/repos/python-pillow/Pillow/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/python-pillow/Pillow/labels{/name}","releases_url":"https://api.github.com/repos/python-pillow/Pillow/releases{/id}","deployments_url":"https://api.github.com/repos/python-pillow/Pillow/deployments","created_at":"2012-07-24T21:38:39Z","updated_at":"2025-11-09T17:08:02Z","pushed_at":"2025-11-05T17:24:43Z","git_url":"git://github.com/python-pillow/Pillow.git","ssh_url":"git@github.com:python-pillow/Pillow.git","clone_url":"https://github.com/python-pillow/Pillow.git","svn_url":"https://github.com/python-pillow/Pillow","homepage":"https://python-pillow.github.io","size":209075,"stargazers_count":13177,"watchers_count":13177,"language":"Python","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":true,"has_discussions":true,"forks_count":2359,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":117,"license":{"key":"other","name":"Other","spdx_id":"NOASSERTION","url":null,"node_id":"MDc6TGljZW5zZTA="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["c","cross-platform","image","image-processing","pil","pillow","python","python-3"],"visibility":"public","forks":2359,"open_issues":117,"watchers":13177,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"body":"### What did you do?\r\nTried to save a transparent gif\r\n### What did you expect to happen?\r\nI expected the gif to maintain transparency without issue\r\n### What actually happened?\r\nIt did not maintain transparency without issue\r\n### What versions of Pillow and Python are you using?\r\nUsing Python 3.7 with pillow 5.2.0\r\n\r\n```python\r\ndef makegif(path, images):\r\n    images[0].save(\r\n        path,\r\n        save_all=True,\r\n        append_images=images[1:],\r\n        duration=16,\r\n        transparency=0,\r\n        disposal=3)\r\n```\r\nThis example doesn't have transparency, but I need to support transparency for rounded corners.\r\nWhen saving without the transparency and disposal kwargs:\r\n![test2](https://user-images.githubusercontent.com/14200370/45592413-a73f8600-b93a-11e8-8033-d5a3656e8449.gif)\r\n\r\nWhen saving without the disposal kwarg:\r\n![test3](https://user-images.githubusercontent.com/14200370/45592414-b292b180-b93a-11e8-8f37-567fe3ebf9a5.gif)\r\n\r\nEventually someone told me disposal=3 was what I wanted, but this is what that produces:\r\n![test](https://user-images.githubusercontent.com/14200370/45592402-fc2ecc80-b939-11e8-8a7a-553baee154f1.gif)\r\n\r\nI tried to google a solution, but couldn't find anything similar to this? I probably suck at googling, but here I am anyways.\r\n","reactions":{"url":"https://api.github.com/repos/python-pillow/Pillow/issues/3357/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/python-pillow/Pillow/issues/3357/timeline","performed_via_github_app":null,"state_reason":"completed"}},"event":"cross-referenced"},{"url":"https://api.github.com/repos/python-pillow/Pillow/issues/comments/471003372","html_url":"https://github.com/python-pillow/Pillow/issues/3665#issuecomment-471003372","issue_url":"https://api.github.com/repos/python-pillow/Pillow/issues/3665","id":471003372,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3MTAwMzM3Mg==","user":{"login":"dhsdshdhk","id":28062763,"node_id":"MDQ6VXNlcjI4MDYyNzYz","avatar_url":"https://avatars.githubusercontent.com/u/28062763?v=4","gravatar_id":"","url":"https://api.github.com/users/dhsdshdhk","html_url":"https://github.com/dhsdshdhk","followers_url":"https://api.github.com/users/dhsdshdhk/followers","following_url":"https://api.github.com/users/dhsdshdhk/following{/other_user}","gists_url":"https://api.github.com/users/dhsdshdhk/gists{/gist_id}","starred_url":"https://api.github.com/users/dhsdshdhk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dhsdshdhk/subscriptions","organizations_url":"https://api.github.com/users/dhsdshdhk/orgs","repos_url":"https://api.github.com/users/dhsdshdhk/repos","events_url":"https://api.github.com/users/dhsdshdhk/events{/privacy}","received_events_url":"https://api.github.com/users/dhsdshdhk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-03-08T17:09:40Z","updated_at":"2019-03-08T17:09:40Z","body":"Can you make a pull request to fix that?","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/python-pillow/Pillow/issues/comments/471003372/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"dhsdshdhk","id":28062763,"node_id":"MDQ6VXNlcjI4MDYyNzYz","avatar_url":"https://avatars.githubusercontent.com/u/28062763?v=4","gravatar_id":"","url":"https://api.github.com/users/dhsdshdhk","html_url":"https://github.com/dhsdshdhk","followers_url":"https://api.github.com/users/dhsdshdhk/followers","following_url":"https://api.github.com/users/dhsdshdhk/following{/other_user}","gists_url":"https://api.github.com/users/dhsdshdhk/gists{/gist_id}","starred_url":"https://api.github.com/users/dhsdshdhk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dhsdshdhk/subscriptions","organizations_url":"https://api.github.com/users/dhsdshdhk/orgs","repos_url":"https://api.github.com/users/dhsdshdhk/repos","events_url":"https://api.github.com/users/dhsdshdhk/events{/privacy}","received_events_url":"https://api.github.com/users/dhsdshdhk/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":2191009375,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDIxOTEwMDkzNzU=","url":"https://api.github.com/repos/python-pillow/Pillow/issues/events/2191009375","actor":{"login":"sircinnamon","id":16858312,"node_id":"MDQ6VXNlcjE2ODU4MzEy","avatar_url":"https://avatars.githubusercontent.com/u/16858312?v=4","gravatar_id":"","url":"https://api.github.com/users/sircinnamon","html_url":"https://github.com/sircinnamon","followers_url":"https://api.github.com/users/sircinnamon/followers","following_url":"https://api.github.com/users/sircinnamon/following{/other_user}","gists_url":"https://api.github.com/users/sircinnamon/gists{/gist_id}","starred_url":"https://api.github.com/users/sircinnamon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sircinnamon/subscriptions","organizations_url":"https://api.github.com/users/sircinnamon/orgs","repos_url":"https://api.github.com/users/sircinnamon/repos","events_url":"https://api.github.com/users/sircinnamon/events{/privacy}","received_events_url":"https://api.github.com/users/sircinnamon/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"ae194096d064d6dd02d2a0cfa147fa4730d81f57","commit_url":"https://api.github.com/repos/sircinnamon/Pillow/commits/ae194096d064d6dd02d2a0cfa147fa4730d81f57","created_at":"2019-03-08T19:48:34Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/python-pillow/Pillow/issues/comments/471062288","html_url":"https://github.com/python-pillow/Pillow/issues/3665#issuecomment-471062288","issue_url":"https://api.github.com/repos/python-pillow/Pillow/issues/3665","id":471062288,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3MTA2MjI4OA==","user":{"login":"sircinnamon","id":16858312,"node_id":"MDQ6VXNlcjE2ODU4MzEy","avatar_url":"https://avatars.githubusercontent.com/u/16858312?v=4","gravatar_id":"","url":"https://api.github.com/users/sircinnamon","html_url":"https://github.com/sircinnamon","followers_url":"https://api.github.com/users/sircinnamon/followers","following_url":"https://api.github.com/users/sircinnamon/following{/other_user}","gists_url":"https://api.github.com/users/sircinnamon/gists{/gist_id}","starred_url":"https://api.github.com/users/sircinnamon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sircinnamon/subscriptions","organizations_url":"https://api.github.com/users/sircinnamon/orgs","repos_url":"https://api.github.com/users/sircinnamon/repos","events_url":"https://api.github.com/users/sircinnamon/events{/privacy}","received_events_url":"https://api.github.com/users/sircinnamon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-03-08T20:15:34Z","updated_at":"2019-03-12T09:28:04Z","body":"```diff\r\n--- a/src/PIL/GifImagePlugin.py\r\n+++ b/src/PIL/GifImagePlugin.py\r\n@@ -443,7 +443,10 @@ def _write_multiple_frames(im, fp, palette):\r\n             if im_frames:\r\n                 # delta frame\r\n                 previous = im_frames[-1]\r\n-                if _get_palette_bytes(im_frame) == \\\r\n+                if \"disposal\" in encoderinfo and encoderinfo[\"disposal\"] == 2:\r\n+                    # If diposing whole frame, treat full new frame as delta\r\n+                    delta = im_frame\r\n+                elif _get_palette_bytes(im_frame) == \\\r\n                    _get_palette_bytes(previous['im']):\r\n                     delta = ImageChops.subtract_modulo(im_frame,\r\n                                                        previous['im'])\r\n```\r\n\r\nTried this out in a fork, but the [travisCI build](https://travis-ci.org/sircinnamon/Pillow/builds/503766822) failed on the test_save_dispose test, it seems like it's causing it to drop a frame somewhere, although I honestly cannot tell why. Open to ideas.","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/python-pillow/Pillow/issues/comments/471062288/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"sircinnamon","id":16858312,"node_id":"MDQ6VXNlcjE2ODU4MzEy","avatar_url":"https://avatars.githubusercontent.com/u/16858312?v=4","gravatar_id":"","url":"https://api.github.com/users/sircinnamon","html_url":"https://github.com/sircinnamon","followers_url":"https://api.github.com/users/sircinnamon/followers","following_url":"https://api.github.com/users/sircinnamon/following{/other_user}","gists_url":"https://api.github.com/users/sircinnamon/gists{/gist_id}","starred_url":"https://api.github.com/users/sircinnamon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sircinnamon/subscriptions","organizations_url":"https://api.github.com/users/sircinnamon/orgs","repos_url":"https://api.github.com/users/sircinnamon/repos","events_url":"https://api.github.com/users/sircinnamon/events{/privacy}","received_events_url":"https://api.github.com/users/sircinnamon/received_events","type":"User","user_view_type":"public","site_admin":false}},{"actor":{"login":"sircinnamon","id":16858312,"node_id":"MDQ6VXNlcjE2ODU4MzEy","avatar_url":"https://avatars.githubusercontent.com/u/16858312?v=4","gravatar_id":"","url":"https://api.github.com/users/sircinnamon","html_url":"https://github.com/sircinnamon","followers_url":"https://api.github.com/users/sircinnamon/followers","following_url":"https://api.github.com/users/sircinnamon/following{/other_user}","gists_url":"https://api.github.com/users/sircinnamon/gists{/gist_id}","starred_url":"https://api.github.com/users/sircinnamon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sircinnamon/subscriptions","organizations_url":"https://api.github.com/users/sircinnamon/orgs","repos_url":"https://api.github.com/users/sircinnamon/repos","events_url":"https://api.github.com/users/sircinnamon/events{/privacy}","received_events_url":"https://api.github.com/users/sircinnamon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-03-08T22:15:27Z","updated_at":"2019-03-08T22:15:27Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/python-pillow/Pillow/issues/3704","repository_url":"https://api.github.com/repos/python-pillow/Pillow","labels_url":"https://api.github.com/repos/python-pillow/Pillow/issues/3704/labels{/name}","comments_url":"https://api.github.com/repos/python-pillow/Pillow/issues/3704/comments","events_url":"https://api.github.com/repos/python-pillow/Pillow/issues/3704/events","html_url":"https://github.com/python-pillow/Pillow/issues/3704","id":418978720,"node_id":"MDU6SXNzdWU0MTg5Nzg3MjA=","number":3704,"title":"GifImagePlugin normalize_palette destroys bounding box of frame","user":{"login":"sircinnamon","id":16858312,"node_id":"MDQ6VXNlcjE2ODU4MzEy","avatar_url":"https://avatars.githubusercontent.com/u/16858312?v=4","gravatar_id":"","url":"https://api.github.com/users/sircinnamon","html_url":"https://github.com/sircinnamon","followers_url":"https://api.github.com/users/sircinnamon/followers","following_url":"https://api.github.com/users/sircinnamon/following{/other_user}","gists_url":"https://api.github.com/users/sircinnamon/gists{/gist_id}","starred_url":"https://api.github.com/users/sircinnamon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sircinnamon/subscriptions","organizations_url":"https://api.github.com/users/sircinnamon/orgs","repos_url":"https://api.github.com/users/sircinnamon/repos","events_url":"https://api.github.com/users/sircinnamon/events{/privacy}","received_events_url":"https://api.github.com/users/sircinnamon/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":341437806,"node_id":"MDU6TGFiZWwzNDE0Mzc4MDY=","url":"https://api.github.com/repos/python-pillow/Pillow/labels/GIF","name":"GIF","color":"fbca04","default":false,"description":null},{"id":400993500,"node_id":"MDU6TGFiZWw0MDA5OTM1MDA=","url":"https://api.github.com/repos/python-pillow/Pillow/labels/Palette","name":"Palette","color":"5319e7","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2019-03-08T22:15:27Z","updated_at":"2021-04-05T10:57:44Z","closed_at":"2021-04-05T10:57:44Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"repository":{"id":5171600,"node_id":"MDEwOlJlcG9zaXRvcnk1MTcxNjAw","name":"Pillow","full_name":"python-pillow/Pillow","private":false,"owner":{"login":"python-pillow","id":2036701,"node_id":"MDEyOk9yZ2FuaXphdGlvbjIwMzY3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/2036701?v=4","gravatar_id":"","url":"https://api.github.com/users/python-pillow","html_url":"https://github.com/python-pillow","followers_url":"https://api.github.com/users/python-pillow/followers","following_url":"https://api.github.com/users/python-pillow/following{/other_user}","gists_url":"https://api.github.com/users/python-pillow/gists{/gist_id}","starred_url":"https://api.github.com/users/python-pillow/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/python-pillow/subscriptions","organizations_url":"https://api.github.com/users/python-pillow/orgs","repos_url":"https://api.github.com/users/python-pillow/repos","events_url":"https://api.github.com/users/python-pillow/events{/privacy}","received_events_url":"https://api.github.com/users/python-pillow/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/python-pillow/Pillow","description":"Python Imaging Library (Fork)","fork":false,"url":"https://api.github.com/repos/python-pillow/Pillow","forks_url":"https://api.github.com/repos/python-pillow/Pillow/forks","keys_url":"https://api.github.com/repos/python-pillow/Pillow/keys{/key_id}","collaborators_url":"https://api.github.com/repos/python-pillow/Pillow/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/python-pillow/Pillow/teams","hooks_url":"https://api.github.com/repos/python-pillow/Pillow/hooks","issue_events_url":"https://api.github.com/repos/python-pillow/Pillow/issues/events{/number}","events_url":"https://api.github.com/repos/python-pillow/Pillow/events","assignees_url":"https://api.github.com/repos/python-pillow/Pillow/assignees{/user}","branches_url":"https://api.github.com/repos/python-pillow/Pillow/branches{/branch}","tags_url":"https://api.github.com/repos/python-pillow/Pillow/tags","blobs_url":"https://api.github.com/repos/python-pillow/Pillow/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/python-pillow/Pillow/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/python-pillow/Pillow/git/refs{/sha}","trees_url":"https://api.github.com/repos/python-pillow/Pillow/git/trees{/sha}","statuses_url":"https://api.github.com/repos/python-pillow/Pillow/statuses/{sha}","languages_url":"https://api.github.com/repos/python-pillow/Pillow/languages","stargazers_url":"https://api.github.com/repos/python-pillow/Pillow/stargazers","contributors_url":"https://api.github.com/repos/python-pillow/Pillow/contributors","subscribers_url":"https://api.github.com/repos/python-pillow/Pillow/subscribers","subscription_url":"https://api.github.com/repos/python-pillow/Pillow/subscription","commits_url":"https://api.github.com/repos/python-pillow/Pillow/commits{/sha}","git_commits_url":"https://api.github.com/repos/python-pillow/Pillow/git/commits{/sha}","comments_url":"https://api.github.com/repos/python-pillow/Pillow/comments{/number}","issue_comment_url":"https://api.github.com/repos/python-pillow/Pillow/issues/comments{/number}","contents_url":"https://api.github.com/repos/python-pillow/Pillow/contents/{+path}","compare_url":"https://api.github.com/repos/python-pillow/Pillow/compare/{base}...{head}","merges_url":"https://api.github.com/repos/python-pillow/Pillow/merges","archive_url":"https://api.github.com/repos/python-pillow/Pillow/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/python-pillow/Pillow/downloads","issues_url":"https://api.github.com/repos/python-pillow/Pillow/issues{/number}","pulls_url":"https://api.github.com/repos/python-pillow/Pillow/pulls{/number}","milestones_url":"https://api.github.com/repos/python-pillow/Pillow/milestones{/number}","notifications_url":"https://api.github.com/repos/python-pillow/Pillow/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/python-pillow/Pillow/labels{/name}","releases_url":"https://api.github.com/repos/python-pillow/Pillow/releases{/id}","deployments_url":"https://api.github.com/repos/python-pillow/Pillow/deployments","created_at":"2012-07-24T21:38:39Z","updated_at":"2025-11-09T17:08:02Z","pushed_at":"2025-11-05T17:24:43Z","git_url":"git://github.com/python-pillow/Pillow.git","ssh_url":"git@github.com:python-pillow/Pillow.git","clone_url":"https://github.com/python-pillow/Pillow.git","svn_url":"https://github.com/python-pillow/Pillow","homepage":"https://python-pillow.github.io","size":209075,"stargazers_count":13177,"watchers_count":13177,"language":"Python","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":true,"has_discussions":true,"forks_count":2359,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":117,"license":{"key":"other","name":"Other","spdx_id":"NOASSERTION","url":null,"node_id":"MDc6TGljZW5zZTA="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["c","cross-platform","image","image-processing","pil","pillow","python","python-3"],"visibility":"public","forks":2359,"open_issues":117,"watchers":13177,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"body":"### What did you do?\r\nRan single colour frames through GifImagePlugin _normalize_palette\r\n### What did you expect to happen?\r\nImage object palette changes, nothing else\r\n\r\n### What actually happened?\r\nImage.getbbox()  went from 100x100 to None\r\n\r\n### What are your OS, Python and Pillow versions?\r\n\r\n* OS: Archlinux\r\n* Python: 3.4.9 (in venv)\r\n* Pillow: 5.4.1\r\n\r\nTo reproduce:\r\n(This is a modification of the test_save_dispose test from the test suite - I think it's preventing a valid fix for something else but unsure)\r\n\r\n```python\r\nfrom PIL import Image\r\nout = \"realtest.gif\"\r\nim_list = [\r\n\tImage.new('L', (100, 100), 255),\r\n\tImage.new('L', (100, 100), 127),\r\n\tImage.new('L', (100, 100), 0),\r\n]\r\nfor method in range(0, 4):\r\n\tprint(\"========= {} ========\".format(method))\r\n\tim_list[0].save(\r\n\t\tstr(method)+out,\r\n\t\tsave_all=True,\r\n\t\tappend_images=im_list[1:],\r\n\t\tdisposal=method\r\n\t)\r\n\timg = Image.open(str(method)+out)\r\n\tfor _ in range(2):\r\n\t\timg.seek(img.tell() + 1)\r\n\t\tprint(\"{} == {}\".format(img.disposal_method, method))\r\n# check per frame disposal\r\nim_list[0].save(\r\n\tout,\r\n\tsave_all=True,\r\n\tappend_images=im_list[1:],\r\n\tdisposal=tuple(range(len(im_list)))\r\n\t)\r\n\r\nimg = Image.open(out)\r\n\r\nfor i in range(2):\r\n\timg.seek(img.tell() + 1)\r\n\tprint(\"{} == {}\".format(img.disposal_method, i+1))\r\n```\r\nAlso, modify `_write_multiple_frames` in `GifImagePlugin.py` to contain a log of the image bounding box before and after the '_normalize_palette` call (around line 407):\r\n```python\r\nfor imSequence in itertools.chain([im],\r\n                                      im.encoderinfo.get(\"append_images\", [])):\r\n        for im_frame in ImageSequence.Iterator(imSequence):\r\n            # a copy is required here since seek can still mutate the image\r\n            print(\"NEWFRAME\")\r\n            print(im_frame.getbbox())\r\n            im_frame = _normalize_mode(im_frame.copy())\r\n            print(\"MODE\")\r\n            print(im_frame.getbbox())\r\n            im_frame = _normalize_palette(im_frame, palette, im.encoderinfo)\r\n            print(\"PALETTE\")\r\n            print(im_frame.getbbox())\r\n\r\n            encoderinfo = im.encoderinfo.copy()\r\n            if isinstance(duration, (list, tuple)):\r\n                encoderinfo['duration'] = duration[frame_count]\r\n            if isinstance(disposal, (list, tuple)):\r\n                encoderinfo[\"disposal\"] = disposal[frame_count]\r\n            frame_count += 1\r\n```\r\n\r\nEach time I see: \r\n```\r\nNEWFRAME\r\n(0, 0, 100, 100)\r\nMODE\r\n(0, 0, 100, 100)\r\nPALETTE\r\nNone\r\n```\r\nIs it possible that the `Image.remap_palette` being done by `_normalize_palette` is putting the only colour as colour 0, which causes the `Image.getbbox` to see the whole image as colour 0 and therefore not at all filled?\r\n\r\nThe frame having no bounding box results in the gif optimisation essentially ignoring the frame and extending the previous one.\r\n\r\nI ran into this while trying to work on #3665 ","reactions":{"url":"https://api.github.com/repos/python-pillow/Pillow/issues/3704/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/python-pillow/Pillow/issues/3704/timeline","performed_via_github_app":null,"state_reason":"completed"}},"event":"cross-referenced"},{"url":"https://api.github.com/repos/python-pillow/Pillow/issues/comments/471192132","html_url":"https://github.com/python-pillow/Pillow/issues/3665#issuecomment-471192132","issue_url":"https://api.github.com/repos/python-pillow/Pillow/issues/3665","id":471192132,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3MTE5MjEzMg==","user":{"login":"Artheau","id":87869,"node_id":"MDQ6VXNlcjg3ODY5","avatar_url":"https://avatars.githubusercontent.com/u/87869?v=4","gravatar_id":"","url":"https://api.github.com/users/Artheau","html_url":"https://github.com/Artheau","followers_url":"https://api.github.com/users/Artheau/followers","following_url":"https://api.github.com/users/Artheau/following{/other_user}","gists_url":"https://api.github.com/users/Artheau/gists{/gist_id}","starred_url":"https://api.github.com/users/Artheau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Artheau/subscriptions","organizations_url":"https://api.github.com/users/Artheau/orgs","repos_url":"https://api.github.com/users/Artheau/repos","events_url":"https://api.github.com/users/Artheau/events{/privacy}","received_events_url":"https://api.github.com/users/Artheau/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-03-09T15:45:00Z","updated_at":"2019-03-12T09:27:57Z","body":"I haven't dev'd on this project before, so please save me from myself, but I think the following snippet works.  I didn't fork and pull request because the code needs a little love.  It, for instance, creates a new background image on every iteration of the loop.  That should probably be moved out of the loop, but then it would not have access to `im_frame.size`.  Also, the new image should probably be created with the same palette, but again, if it is created outside of the loop then it is not clear how this would be accomplished.\r\n\r\nImportantly, this code does not just use the whole frame as the delta.  It does continue to try to optimize the frames as much as possible by comparing against the background color.\r\n\r\nIn any case, I think this code works, but please help me optimize the number of calls to `Image.new`:\r\n\r\n\r\n\r\n```python\r\n            if im_frames:\r\n                # delta frame\r\n                previous = im_frames[-1]\r\n                if (\"disposal\" in im.encoderinfo and im.encoderinfo[\"disposal\"] == 2):\r\n                    base_image = Image.new(\"P\", im_frame.size, 0)\r\n                else:\r\n                    base_image = previous[\"im\"]\r\n\r\n                if _get_palette_bytes(im_frame) == \\\r\n                   _get_palette_bytes(base_image):\r\n                    delta = ImageChops.subtract_modulo(im_frame,\r\n                                                       base_image)\r\n                else:\r\n                    delta = ImageChops.subtract_modulo(\r\n                        im_frame.convert('RGB'), base_image.convert('RGB'))\r\n                bbox = delta.getbbox()\r\n                if not bbox and not (\"disposal\" in im.encoderinfo and im.encoderinfo[\"disposal\"] == 2):\r\n                    # This frame is identical to the previous frame\r\n                    if duration:\r\n                        previous['encoderinfo']['duration'] += \\\r\n                            encoderinfo['duration']\r\n                    continue\r\n```","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/python-pillow/Pillow/issues/comments/471192132/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":1,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Artheau","id":87869,"node_id":"MDQ6VXNlcjg3ODY5","avatar_url":"https://avatars.githubusercontent.com/u/87869?v=4","gravatar_id":"","url":"https://api.github.com/users/Artheau","html_url":"https://github.com/Artheau","followers_url":"https://api.github.com/users/Artheau/followers","following_url":"https://api.github.com/users/Artheau/following{/other_user}","gists_url":"https://api.github.com/users/Artheau/gists{/gist_id}","starred_url":"https://api.github.com/users/Artheau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Artheau/subscriptions","organizations_url":"https://api.github.com/users/Artheau/orgs","repos_url":"https://api.github.com/users/Artheau/repos","events_url":"https://api.github.com/users/Artheau/events{/privacy}","received_events_url":"https://api.github.com/users/Artheau/received_events","type":"User","user_view_type":"public","site_admin":false}},{"actor":{"login":"sircinnamon","id":16858312,"node_id":"MDQ6VXNlcjE2ODU4MzEy","avatar_url":"https://avatars.githubusercontent.com/u/16858312?v=4","gravatar_id":"","url":"https://api.github.com/users/sircinnamon","html_url":"https://github.com/sircinnamon","followers_url":"https://api.github.com/users/sircinnamon/followers","following_url":"https://api.github.com/users/sircinnamon/following{/other_user}","gists_url":"https://api.github.com/users/sircinnamon/gists{/gist_id}","starred_url":"https://api.github.com/users/sircinnamon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sircinnamon/subscriptions","organizations_url":"https://api.github.com/users/sircinnamon/orgs","repos_url":"https://api.github.com/users/sircinnamon/repos","events_url":"https://api.github.com/users/sircinnamon/events{/privacy}","received_events_url":"https://api.github.com/users/sircinnamon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-03-11T15:15:45Z","updated_at":"2019-03-11T15:15:45Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/python-pillow/Pillow/issues/3708","repository_url":"https://api.github.com/repos/python-pillow/Pillow","labels_url":"https://api.github.com/repos/python-pillow/Pillow/issues/3708/labels{/name}","comments_url":"https://api.github.com/repos/python-pillow/Pillow/issues/3708/comments","events_url":"https://api.github.com/repos/python-pillow/Pillow/issues/3708/events","html_url":"https://github.com/python-pillow/Pillow/pull/3708","id":419525089,"node_id":"MDExOlB1bGxSZXF1ZXN0MjYwMDExMzM2","number":3708,"title":"Create GIF deltas from background colour of GIF frames if disposal mode is 2","user":{"login":"sircinnamon","id":16858312,"node_id":"MDQ6VXNlcjE2ODU4MzEy","avatar_url":"https://avatars.githubusercontent.com/u/16858312?v=4","gravatar_id":"","url":"https://api.github.com/users/sircinnamon","html_url":"https://github.com/sircinnamon","followers_url":"https://api.github.com/users/sircinnamon/followers","following_url":"https://api.github.com/users/sircinnamon/following{/other_user}","gists_url":"https://api.github.com/users/sircinnamon/gists{/gist_id}","starred_url":"https://api.github.com/users/sircinnamon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sircinnamon/subscriptions","organizations_url":"https://api.github.com/users/sircinnamon/orgs","repos_url":"https://api.github.com/users/sircinnamon/repos","events_url":"https://api.github.com/users/sircinnamon/events{/privacy}","received_events_url":"https://api.github.com/users/sircinnamon/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":341437806,"node_id":"MDU6TGFiZWwzNDE0Mzc4MDY=","url":"https://api.github.com/repos/python-pillow/Pillow/labels/GIF","name":"GIF","color":"fbca04","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":9,"created_at":"2019-03-11T15:15:45Z","updated_at":"2019-06-29T20:08:14Z","closed_at":"2019-06-29T20:08:12Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"draft":false,"repository":{"id":5171600,"node_id":"MDEwOlJlcG9zaXRvcnk1MTcxNjAw","name":"Pillow","full_name":"python-pillow/Pillow","private":false,"owner":{"login":"python-pillow","id":2036701,"node_id":"MDEyOk9yZ2FuaXphdGlvbjIwMzY3MDE=","avatar_url":"https://avatars.githubusercontent.com/u/2036701?v=4","gravatar_id":"","url":"https://api.github.com/users/python-pillow","html_url":"https://github.com/python-pillow","followers_url":"https://api.github.com/users/python-pillow/followers","following_url":"https://api.github.com/users/python-pillow/following{/other_user}","gists_url":"https://api.github.com/users/python-pillow/gists{/gist_id}","starred_url":"https://api.github.com/users/python-pillow/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/python-pillow/subscriptions","organizations_url":"https://api.github.com/users/python-pillow/orgs","repos_url":"https://api.github.com/users/python-pillow/repos","events_url":"https://api.github.com/users/python-pillow/events{/privacy}","received_events_url":"https://api.github.com/users/python-pillow/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/python-pillow/Pillow","description":"Python Imaging Library (Fork)","fork":false,"url":"https://api.github.com/repos/python-pillow/Pillow","forks_url":"https://api.github.com/repos/python-pillow/Pillow/forks","keys_url":"https://api.github.com/repos/python-pillow/Pillow/keys{/key_id}","collaborators_url":"https://api.github.com/repos/python-pillow/Pillow/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/python-pillow/Pillow/teams","hooks_url":"https://api.github.com/repos/python-pillow/Pillow/hooks","issue_events_url":"https://api.github.com/repos/python-pillow/Pillow/issues/events{/number}","events_url":"https://api.github.com/repos/python-pillow/Pillow/events","assignees_url":"https://api.github.com/repos/python-pillow/Pillow/assignees{/user}","branches_url":"https://api.github.com/repos/python-pillow/Pillow/branches{/branch}","tags_url":"https://api.github.com/repos/python-pillow/Pillow/tags","blobs_url":"https://api.github.com/repos/python-pillow/Pillow/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/python-pillow/Pillow/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/python-pillow/Pillow/git/refs{/sha}","trees_url":"https://api.github.com/repos/python-pillow/Pillow/git/trees{/sha}","statuses_url":"https://api.github.com/repos/python-pillow/Pillow/statuses/{sha}","languages_url":"https://api.github.com/repos/python-pillow/Pillow/languages","stargazers_url":"https://api.github.com/repos/python-pillow/Pillow/stargazers","contributors_url":"https://api.github.com/repos/python-pillow/Pillow/contributors","subscribers_url":"https://api.github.com/repos/python-pillow/Pillow/subscribers","subscription_url":"https://api.github.com/repos/python-pillow/Pillow/subscription","commits_url":"https://api.github.com/repos/python-pillow/Pillow/commits{/sha}","git_commits_url":"https://api.github.com/repos/python-pillow/Pillow/git/commits{/sha}","comments_url":"https://api.github.com/repos/python-pillow/Pillow/comments{/number}","issue_comment_url":"https://api.github.com/repos/python-pillow/Pillow/issues/comments{/number}","contents_url":"https://api.github.com/repos/python-pillow/Pillow/contents/{+path}","compare_url":"https://api.github.com/repos/python-pillow/Pillow/compare/{base}...{head}","merges_url":"https://api.github.com/repos/python-pillow/Pillow/merges","archive_url":"https://api.github.com/repos/python-pillow/Pillow/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/python-pillow/Pillow/downloads","issues_url":"https://api.github.com/repos/python-pillow/Pillow/issues{/number}","pulls_url":"https://api.github.com/repos/python-pillow/Pillow/pulls{/number}","milestones_url":"https://api.github.com/repos/python-pillow/Pillow/milestones{/number}","notifications_url":"https://api.github.com/repos/python-pillow/Pillow/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/python-pillow/Pillow/labels{/name}","releases_url":"https://api.github.com/repos/python-pillow/Pillow/releases{/id}","deployments_url":"https://api.github.com/repos/python-pillow/Pillow/deployments","created_at":"2012-07-24T21:38:39Z","updated_at":"2025-11-09T17:08:02Z","pushed_at":"2025-11-05T17:24:43Z","git_url":"git://github.com/python-pillow/Pillow.git","ssh_url":"git@github.com:python-pillow/Pillow.git","clone_url":"https://github.com/python-pillow/Pillow.git","svn_url":"https://github.com/python-pillow/Pillow","homepage":"https://python-pillow.github.io","size":209075,"stargazers_count":13177,"watchers_count":13177,"language":"Python","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":true,"has_discussions":true,"forks_count":2359,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":117,"license":{"key":"other","name":"Other","spdx_id":"NOASSERTION","url":null,"node_id":"MDc6TGljZW5zZTA="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["c","cross-platform","image","image-processing","pil","pillow","python","python-3"],"visibility":"public","forks":2359,"open_issues":117,"watchers":13177,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/python-pillow/Pillow/pulls/3708","html_url":"https://github.com/python-pillow/Pillow/pull/3708","diff_url":"https://github.com/python-pillow/Pillow/pull/3708.diff","patch_url":"https://github.com/python-pillow/Pillow/pull/3708.patch","merged_at":"2019-06-29T20:08:11Z"},"body":"Fixes #3665 \r\n All credit to @Artheau who figured out the method, I just tidied up and made sure it passed the tests+lint\r\n\r\nChanges proposed in this pull request:\r\n\r\n * Save a \"background colour\" image from the first frame image, and use that to create gif deltas if disposal mode is 2\r\n","reactions":{"url":"https://api.github.com/repos/python-pillow/Pillow/issues/3708/reactions","total_count":2,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":2,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/python-pillow/Pillow/issues/3708/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"url":"https://api.github.com/repos/python-pillow/Pillow/issues/comments/471911528","html_url":"https://github.com/python-pillow/Pillow/issues/3665#issuecomment-471911528","issue_url":"https://api.github.com/repos/python-pillow/Pillow/issues/3665","id":471911528,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3MTkxMTUyOA==","user":{"login":"radarhere","id":3112309,"node_id":"MDQ6VXNlcjMxMTIzMDk=","avatar_url":"https://avatars.githubusercontent.com/u/3112309?v=4","gravatar_id":"","url":"https://api.github.com/users/radarhere","html_url":"https://github.com/radarhere","followers_url":"https://api.github.com/users/radarhere/followers","following_url":"https://api.github.com/users/radarhere/following{/other_user}","gists_url":"https://api.github.com/users/radarhere/gists{/gist_id}","starred_url":"https://api.github.com/users/radarhere/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/radarhere/subscriptions","organizations_url":"https://api.github.com/users/radarhere/orgs","repos_url":"https://api.github.com/users/radarhere/repos","events_url":"https://api.github.com/users/radarhere/events{/privacy}","received_events_url":"https://api.github.com/users/radarhere/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-03-12T08:55:39Z","updated_at":"2019-03-12T08:55:39Z","body":"Is there sample code that demonstrates this problem?","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/python-pillow/Pillow/issues/comments/471911528/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"radarhere","id":3112309,"node_id":"MDQ6VXNlcjMxMTIzMDk=","avatar_url":"https://avatars.githubusercontent.com/u/3112309?v=4","gravatar_id":"","url":"https://api.github.com/users/radarhere","html_url":"https://github.com/radarhere","followers_url":"https://api.github.com/users/radarhere/followers","following_url":"https://api.github.com/users/radarhere/following{/other_user}","gists_url":"https://api.github.com/users/radarhere/gists{/gist_id}","starred_url":"https://api.github.com/users/radarhere/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/radarhere/subscriptions","organizations_url":"https://api.github.com/users/radarhere/orgs","repos_url":"https://api.github.com/users/radarhere/repos","events_url":"https://api.github.com/users/radarhere/events{/privacy}","received_events_url":"https://api.github.com/users/radarhere/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/python-pillow/Pillow/issues/comments/471973989","html_url":"https://github.com/python-pillow/Pillow/issues/3665#issuecomment-471973989","issue_url":"https://api.github.com/repos/python-pillow/Pillow/issues/3665","id":471973989,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3MTk3Mzk4OQ==","user":{"login":"burnoo","id":17478192,"node_id":"MDQ6VXNlcjE3NDc4MTky","avatar_url":"https://avatars.githubusercontent.com/u/17478192?v=4","gravatar_id":"","url":"https://api.github.com/users/burnoo","html_url":"https://github.com/burnoo","followers_url":"https://api.github.com/users/burnoo/followers","following_url":"https://api.github.com/users/burnoo/following{/other_user}","gists_url":"https://api.github.com/users/burnoo/gists{/gist_id}","starred_url":"https://api.github.com/users/burnoo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/burnoo/subscriptions","organizations_url":"https://api.github.com/users/burnoo/orgs","repos_url":"https://api.github.com/users/burnoo/repos","events_url":"https://api.github.com/users/burnoo/events{/privacy}","received_events_url":"https://api.github.com/users/burnoo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-03-12T12:08:38Z","updated_at":"2019-03-12T12:29:44Z","body":"@radarhere\r\n```python\r\nimport requests\r\nfrom PIL import Image\r\nresponse = requests.get('https://66.media.tumblr.com/tumblr_lzkp40b0Sl1qhwcy0.gif')\r\nim = Image.open(BytesIO(response.content))\r\nim.save('1.png', 'PNG')\r\nim.seek(1)\r\nim.load()\r\nim.save('2.png', 'PNG')\r\n```\r\nThe `2.png` has second frame pasted onto first.\r\nExpected result is second frame pasted into background (transparent).\r\n","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/python-pillow/Pillow/issues/comments/471973989/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"burnoo","id":17478192,"node_id":"MDQ6VXNlcjE3NDc4MTky","avatar_url":"https://avatars.githubusercontent.com/u/17478192?v=4","gravatar_id":"","url":"https://api.github.com/users/burnoo","html_url":"https://github.com/burnoo","followers_url":"https://api.github.com/users/burnoo/followers","following_url":"https://api.github.com/users/burnoo/following{/other_user}","gists_url":"https://api.github.com/users/burnoo/gists{/gist_id}","starred_url":"https://api.github.com/users/burnoo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/burnoo/subscriptions","organizations_url":"https://api.github.com/users/burnoo/orgs","repos_url":"https://api.github.com/users/burnoo/repos","events_url":"https://api.github.com/users/burnoo/events{/privacy}","received_events_url":"https://api.github.com/users/burnoo/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":2196912821,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjE5NjkxMjgyMQ==","url":"https://api.github.com/repos/python-pillow/Pillow/issues/events/2196912821","actor":{"login":"radarhere","id":3112309,"node_id":"MDQ6VXNlcjMxMTIzMDk=","avatar_url":"https://avatars.githubusercontent.com/u/3112309?v=4","gravatar_id":"","url":"https://api.github.com/users/radarhere","html_url":"https://github.com/radarhere","followers_url":"https://api.github.com/users/radarhere/followers","following_url":"https://api.github.com/users/radarhere/following{/other_user}","gists_url":"https://api.github.com/users/radarhere/gists{/gist_id}","starred_url":"https://api.github.com/users/radarhere/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/radarhere/subscriptions","organizations_url":"https://api.github.com/users/radarhere/orgs","repos_url":"https://api.github.com/users/radarhere/repos","events_url":"https://api.github.com/users/radarhere/events{/privacy}","received_events_url":"https://api.github.com/users/radarhere/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-03-12T12:10:18Z","performed_via_github_app":null},{"id":2196912822,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDIxOTY5MTI4MjI=","url":"https://api.github.com/repos/python-pillow/Pillow/issues/events/2196912822","actor":{"login":"radarhere","id":3112309,"node_id":"MDQ6VXNlcjMxMTIzMDk=","avatar_url":"https://avatars.githubusercontent.com/u/3112309?v=4","gravatar_id":"","url":"https://api.github.com/users/radarhere","html_url":"https://github.com/radarhere","followers_url":"https://api.github.com/users/radarhere/followers","following_url":"https://api.github.com/users/radarhere/following{/other_user}","gists_url":"https://api.github.com/users/radarhere/gists{/gist_id}","starred_url":"https://api.github.com/users/radarhere/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/radarhere/subscriptions","organizations_url":"https://api.github.com/users/radarhere/orgs","repos_url":"https://api.github.com/users/radarhere/repos","events_url":"https://api.github.com/users/radarhere/events{/privacy}","received_events_url":"https://api.github.com/users/radarhere/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-03-12T12:10:18Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/python-pillow/Pillow/issues/comments/472625846","html_url":"https://github.com/python-pillow/Pillow/issues/3665#issuecomment-472625846","issue_url":"https://api.github.com/repos/python-pillow/Pillow/issues/3665","id":472625846,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3MjYyNTg0Ng==","user":{"login":"sircinnamon","id":16858312,"node_id":"MDQ6VXNlcjE2ODU4MzEy","avatar_url":"https://avatars.githubusercontent.com/u/16858312?v=4","gravatar_id":"","url":"https://api.github.com/users/sircinnamon","html_url":"https://github.com/sircinnamon","followers_url":"https://api.github.com/users/sircinnamon/followers","following_url":"https://api.github.com/users/sircinnamon/following{/other_user}","gists_url":"https://api.github.com/users/sircinnamon/gists{/gist_id}","starred_url":"https://api.github.com/users/sircinnamon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sircinnamon/subscriptions","organizations_url":"https://api.github.com/users/sircinnamon/orgs","repos_url":"https://api.github.com/users/sircinnamon/repos","events_url":"https://api.github.com/users/sircinnamon/events{/privacy}","received_events_url":"https://api.github.com/users/sircinnamon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-03-13T22:10:25Z","updated_at":"2019-03-13T22:10:25Z","body":"@Artheau With further testing, this introduces a new problem - each frame generates a diff compared to a `colour 0` image - but each frame calculates its own palette and so colour 0 is not the same (nor are and colours necessarily.\r\n\r\nI've tested and it seems like if every colour that appears in any frame appears in the first frame, it all works great. Trying to work out a solution where a palette that includes every colour from every frame can be generated and used for every frame.","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/python-pillow/Pillow/issues/comments/472625846/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"sircinnamon","id":16858312,"node_id":"MDQ6VXNlcjE2ODU4MzEy","avatar_url":"https://avatars.githubusercontent.com/u/16858312?v=4","gravatar_id":"","url":"https://api.github.com/users/sircinnamon","html_url":"https://github.com/sircinnamon","followers_url":"https://api.github.com/users/sircinnamon/followers","following_url":"https://api.github.com/users/sircinnamon/following{/other_user}","gists_url":"https://api.github.com/users/sircinnamon/gists{/gist_id}","starred_url":"https://api.github.com/users/sircinnamon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sircinnamon/subscriptions","organizations_url":"https://api.github.com/users/sircinnamon/orgs","repos_url":"https://api.github.com/users/sircinnamon/repos","events_url":"https://api.github.com/users/sircinnamon/events{/privacy}","received_events_url":"https://api.github.com/users/sircinnamon/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":2201760465,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjIwMTc2MDQ2NQ==","url":"https://api.github.com/repos/python-pillow/Pillow/issues/events/2201760465","actor":{"login":"Artheau","id":87869,"node_id":"MDQ6VXNlcjg3ODY5","avatar_url":"https://avatars.githubusercontent.com/u/87869?v=4","gravatar_id":"","url":"https://api.github.com/users/Artheau","html_url":"https://github.com/Artheau","followers_url":"https://api.github.com/users/Artheau/followers","following_url":"https://api.github.com/users/Artheau/following{/other_user}","gists_url":"https://api.github.com/users/Artheau/gists{/gist_id}","starred_url":"https://api.github.com/users/Artheau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Artheau/subscriptions","organizations_url":"https://api.github.com/users/Artheau/orgs","repos_url":"https://api.github.com/users/Artheau/repos","events_url":"https://api.github.com/users/Artheau/events{/privacy}","received_events_url":"https://api.github.com/users/Artheau/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-03-13T22:10:25Z","performed_via_github_app":null},{"id":2201760466,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDIyMDE3NjA0NjY=","url":"https://api.github.com/repos/python-pillow/Pillow/issues/events/2201760466","actor":{"login":"Artheau","id":87869,"node_id":"MDQ6VXNlcjg3ODY5","avatar_url":"https://avatars.githubusercontent.com/u/87869?v=4","gravatar_id":"","url":"https://api.github.com/users/Artheau","html_url":"https://github.com/Artheau","followers_url":"https://api.github.com/users/Artheau/followers","following_url":"https://api.github.com/users/Artheau/following{/other_user}","gists_url":"https://api.github.com/users/Artheau/gists{/gist_id}","starred_url":"https://api.github.com/users/Artheau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Artheau/subscriptions","organizations_url":"https://api.github.com/users/Artheau/orgs","repos_url":"https://api.github.com/users/Artheau/repos","events_url":"https://api.github.com/users/Artheau/events{/privacy}","received_events_url":"https://api.github.com/users/Artheau/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-03-13T22:10:25Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/python-pillow/Pillow/issues/comments/472675433","html_url":"https://github.com/python-pillow/Pillow/issues/3665#issuecomment-472675433","issue_url":"https://api.github.com/repos/python-pillow/Pillow/issues/3665","id":472675433,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3MjY3NTQzMw==","user":{"login":"Artheau","id":87869,"node_id":"MDQ6VXNlcjg3ODY5","avatar_url":"https://avatars.githubusercontent.com/u/87869?v=4","gravatar_id":"","url":"https://api.github.com/users/Artheau","html_url":"https://github.com/Artheau","followers_url":"https://api.github.com/users/Artheau/followers","following_url":"https://api.github.com/users/Artheau/following{/other_user}","gists_url":"https://api.github.com/users/Artheau/gists{/gist_id}","starred_url":"https://api.github.com/users/Artheau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Artheau/subscriptions","organizations_url":"https://api.github.com/users/Artheau/orgs","repos_url":"https://api.github.com/users/Artheau/repos","events_url":"https://api.github.com/users/Artheau/events{/privacy}","received_events_url":"https://api.github.com/users/Artheau/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-03-14T02:04:51Z","updated_at":"2019-03-14T02:04:51Z","body":"Yeah, it seems like that could come up for some cases.\r\n\r\nSo, the code seems to already compare the palettes: `if _get_palette_bytes(im_frame) == _get_palette_bytes(base_image):`, and in the best case, the palettes are the same, so the zero palette comparison will work.\r\n\r\nI think an elegant solution would probably try to intelligently compare the palettes and find out what the palette position is in the new palette, defaulting to using the whole image as the diff if the color is not in the new palette...somehow this seems like overkill, because the existing code doesn't do that at all.\r\n\r\nIf we riff off of the existing code, the corresponding `else` clause handles the case where the palettes do not exactly match, which includes the case you are concerned about.  In such a case, the existing code resolves the paletted images to RGB equivalents.  `delta = ImageChops.subtract_modulo(im_frame.convert('RGB'), base_image.convert('RGB'))`  So...it makes sense that in such cases, we could just compare against some kind of `Image.new(\"RGB\", im_frame.size, <background_color>)`.  Perhaps there is there a convenient way to extract the RGB color corresponding to palette position 0 of the first image, or somehow give the `base_image` enough information to be able to natively `convert` correctly to RGB?","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/python-pillow/Pillow/issues/comments/472675433/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Artheau","id":87869,"node_id":"MDQ6VXNlcjg3ODY5","avatar_url":"https://avatars.githubusercontent.com/u/87869?v=4","gravatar_id":"","url":"https://api.github.com/users/Artheau","html_url":"https://github.com/Artheau","followers_url":"https://api.github.com/users/Artheau/followers","following_url":"https://api.github.com/users/Artheau/following{/other_user}","gists_url":"https://api.github.com/users/Artheau/gists{/gist_id}","starred_url":"https://api.github.com/users/Artheau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Artheau/subscriptions","organizations_url":"https://api.github.com/users/Artheau/orgs","repos_url":"https://api.github.com/users/Artheau/repos","events_url":"https://api.github.com/users/Artheau/events{/privacy}","received_events_url":"https://api.github.com/users/Artheau/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/python-pillow/Pillow/issues/comments/472861367","html_url":"https://github.com/python-pillow/Pillow/issues/3665#issuecomment-472861367","issue_url":"https://api.github.com/repos/python-pillow/Pillow/issues/3665","id":472861367,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3Mjg2MTM2Nw==","user":{"login":"sircinnamon","id":16858312,"node_id":"MDQ6VXNlcjE2ODU4MzEy","avatar_url":"https://avatars.githubusercontent.com/u/16858312?v=4","gravatar_id":"","url":"https://api.github.com/users/sircinnamon","html_url":"https://github.com/sircinnamon","followers_url":"https://api.github.com/users/sircinnamon/followers","following_url":"https://api.github.com/users/sircinnamon/following{/other_user}","gists_url":"https://api.github.com/users/sircinnamon/gists{/gist_id}","starred_url":"https://api.github.com/users/sircinnamon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sircinnamon/subscriptions","organizations_url":"https://api.github.com/users/sircinnamon/orgs","repos_url":"https://api.github.com/users/sircinnamon/repos","events_url":"https://api.github.com/users/sircinnamon/events{/privacy}","received_events_url":"https://api.github.com/users/sircinnamon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-03-14T13:47:05Z","updated_at":"2019-03-14T13:47:05Z","body":"Unfortunately, even if we use the whole frame as the diff, if it doesn't have the same palette as the first frame the colour mapping will be wrong. We will need to enforce the same palette onto every frame I think.","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/python-pillow/Pillow/issues/comments/472861367/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"sircinnamon","id":16858312,"node_id":"MDQ6VXNlcjE2ODU4MzEy","avatar_url":"https://avatars.githubusercontent.com/u/16858312?v=4","gravatar_id":"","url":"https://api.github.com/users/sircinnamon","html_url":"https://github.com/sircinnamon","followers_url":"https://api.github.com/users/sircinnamon/followers","following_url":"https://api.github.com/users/sircinnamon/following{/other_user}","gists_url":"https://api.github.com/users/sircinnamon/gists{/gist_id}","starred_url":"https://api.github.com/users/sircinnamon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sircinnamon/subscriptions","organizations_url":"https://api.github.com/users/sircinnamon/orgs","repos_url":"https://api.github.com/users/sircinnamon/repos","events_url":"https://api.github.com/users/sircinnamon/events{/privacy}","received_events_url":"https://api.github.com/users/sircinnamon/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/python-pillow/Pillow/issues/comments/472889989","html_url":"https://github.com/python-pillow/Pillow/issues/3665#issuecomment-472889989","issue_url":"https://api.github.com/repos/python-pillow/Pillow/issues/3665","id":472889989,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3Mjg4OTk4OQ==","user":{"login":"Artheau","id":87869,"node_id":"MDQ6VXNlcjg3ODY5","avatar_url":"https://avatars.githubusercontent.com/u/87869?v=4","gravatar_id":"","url":"https://api.github.com/users/Artheau","html_url":"https://github.com/Artheau","followers_url":"https://api.github.com/users/Artheau/followers","following_url":"https://api.github.com/users/Artheau/following{/other_user}","gists_url":"https://api.github.com/users/Artheau/gists{/gist_id}","starred_url":"https://api.github.com/users/Artheau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Artheau/subscriptions","organizations_url":"https://api.github.com/users/Artheau/orgs","repos_url":"https://api.github.com/users/Artheau/repos","events_url":"https://api.github.com/users/Artheau/events{/privacy}","received_events_url":"https://api.github.com/users/Artheau/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-03-14T14:37:01Z","updated_at":"2019-03-14T14:37:01Z","body":"What does the code do presently if images are presented with different palettes but disposal mode 2 is not activated?  Does it work correctly?  If so, I think we should just create an RGB background image to compare against instead of comparing against the paletted version.","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/python-pillow/Pillow/issues/comments/472889989/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Artheau","id":87869,"node_id":"MDQ6VXNlcjg3ODY5","avatar_url":"https://avatars.githubusercontent.com/u/87869?v=4","gravatar_id":"","url":"https://api.github.com/users/Artheau","html_url":"https://github.com/Artheau","followers_url":"https://api.github.com/users/Artheau/followers","following_url":"https://api.github.com/users/Artheau/following{/other_user}","gists_url":"https://api.github.com/users/Artheau/gists{/gist_id}","starred_url":"https://api.github.com/users/Artheau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Artheau/subscriptions","organizations_url":"https://api.github.com/users/Artheau/orgs","repos_url":"https://api.github.com/users/Artheau/repos","events_url":"https://api.github.com/users/Artheau/events{/privacy}","received_events_url":"https://api.github.com/users/Artheau/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/python-pillow/Pillow/issues/comments/472915376","html_url":"https://github.com/python-pillow/Pillow/issues/3665#issuecomment-472915376","issue_url":"https://api.github.com/repos/python-pillow/Pillow/issues/3665","id":472915376,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3MjkxNTM3Ng==","user":{"login":"sircinnamon","id":16858312,"node_id":"MDQ6VXNlcjE2ODU4MzEy","avatar_url":"https://avatars.githubusercontent.com/u/16858312?v=4","gravatar_id":"","url":"https://api.github.com/users/sircinnamon","html_url":"https://github.com/sircinnamon","followers_url":"https://api.github.com/users/sircinnamon/followers","following_url":"https://api.github.com/users/sircinnamon/following{/other_user}","gists_url":"https://api.github.com/users/sircinnamon/gists{/gist_id}","starred_url":"https://api.github.com/users/sircinnamon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sircinnamon/subscriptions","organizations_url":"https://api.github.com/users/sircinnamon/orgs","repos_url":"https://api.github.com/users/sircinnamon/repos","events_url":"https://api.github.com/users/sircinnamon/events{/privacy}","received_events_url":"https://api.github.com/users/sircinnamon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-03-14T15:21:39Z","updated_at":"2019-03-14T15:21:39Z","body":"```python\r\n        im_list = [\r\n            Image.new('RGB', (100, 100), '#fff'),\r\n            Image.new('RGB', (100, 100), '#999'),\r\n            Image.new('RGB', (100, 100), '#000'),\r\n        ]\r\n        for img in im_list:\r\n            d = ImageDraw.Draw(img)\r\n            d.ellipse([(0,0),(100,100)], fill='#f00')\r\n            # d.ellipse([(0,0),(1,1)], fill='#fff')\r\n            # d.ellipse([(2,2),(3,3)], fill='#999')\r\n            # d.ellipse([(4,4),(5,5)], fill='#000')\r\n        im_list[0].save(\"test0.png\")\r\n        im_list[1].save(\"test1.png\")\r\n        im_list[2].save(\"test2.png\")\r\n\r\n        # check per frame disposal\r\n        im_list[0].save(\r\n            out,\r\n            save_all=True,\r\n            append_images=im_list[1:],\r\n            disposal=0\r\n            )\r\n```\r\n\r\nThis is my test case - a red circle over a background changing white to gray to black. Right now, regardless of disposal mode, the output frames are: red circle on white (correct), red circle on white (incorrect) and white circle on red (very incorrect). My assumption is that the colours of the first frame are being mapped to the other frames (though that could be incorrect)","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/python-pillow/Pillow/issues/comments/472915376/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"sircinnamon","id":16858312,"node_id":"MDQ6VXNlcjE2ODU4MzEy","avatar_url":"https://avatars.githubusercontent.com/u/16858312?v=4","gravatar_id":"","url":"https://api.github.com/users/sircinnamon","html_url":"https://github.com/sircinnamon","followers_url":"https://api.github.com/users/sircinnamon/followers","following_url":"https://api.github.com/users/sircinnamon/following{/other_user}","gists_url":"https://api.github.com/users/sircinnamon/gists{/gist_id}","starred_url":"https://api.github.com/users/sircinnamon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sircinnamon/subscriptions","organizations_url":"https://api.github.com/users/sircinnamon/orgs","repos_url":"https://api.github.com/users/sircinnamon/repos","events_url":"https://api.github.com/users/sircinnamon/events{/privacy}","received_events_url":"https://api.github.com/users/sircinnamon/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/python-pillow/Pillow/issues/comments/472924300","html_url":"https://github.com/python-pillow/Pillow/issues/3665#issuecomment-472924300","issue_url":"https://api.github.com/repos/python-pillow/Pillow/issues/3665","id":472924300,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3MjkyNDMwMA==","user":{"login":"sircinnamon","id":16858312,"node_id":"MDQ6VXNlcjE2ODU4MzEy","avatar_url":"https://avatars.githubusercontent.com/u/16858312?v=4","gravatar_id":"","url":"https://api.github.com/users/sircinnamon","html_url":"https://github.com/sircinnamon","followers_url":"https://api.github.com/users/sircinnamon/followers","following_url":"https://api.github.com/users/sircinnamon/following{/other_user}","gists_url":"https://api.github.com/users/sircinnamon/gists{/gist_id}","starred_url":"https://api.github.com/users/sircinnamon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sircinnamon/subscriptions","organizations_url":"https://api.github.com/users/sircinnamon/orgs","repos_url":"https://api.github.com/users/sircinnamon/repos","events_url":"https://api.github.com/users/sircinnamon/events{/privacy}","received_events_url":"https://api.github.com/users/sircinnamon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-03-14T15:38:45Z","updated_at":"2019-03-14T15:38:45Z","body":"Okay, I've made a discovery which might totally shift how I do this:\r\n\r\nEach frame is capable of storing it's own palette locally, so we don't have to worry about all frames sharing a palette\r\n\r\nIn order to include that local colour table header, the frame info must include `include_color_table:True` and have a non-zero size (as determined by _get_color_table_size in GifImagePlugin.py)\r\n\r\nThe formula for the colour table size \r\nis `int(math.ceil(math.log(len(palette_bytes)//3, 2)))-1` which I can't fully understand - the divide by 3 makes sense because each colour is stored as 3 bytes, but the log, ceil and -1 are confusing to me. I checked and if a frame has only 2 colours, this get colour table size returns a 0. I tried upping the frames to have 3 colours and suddenly the test worked.","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/python-pillow/Pillow/issues/comments/472924300/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"sircinnamon","id":16858312,"node_id":"MDQ6VXNlcjE2ODU4MzEy","avatar_url":"https://avatars.githubusercontent.com/u/16858312?v=4","gravatar_id":"","url":"https://api.github.com/users/sircinnamon","html_url":"https://github.com/sircinnamon","followers_url":"https://api.github.com/users/sircinnamon/followers","following_url":"https://api.github.com/users/sircinnamon/following{/other_user}","gists_url":"https://api.github.com/users/sircinnamon/gists{/gist_id}","starred_url":"https://api.github.com/users/sircinnamon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sircinnamon/subscriptions","organizations_url":"https://api.github.com/users/sircinnamon/orgs","repos_url":"https://api.github.com/users/sircinnamon/repos","events_url":"https://api.github.com/users/sircinnamon/events{/privacy}","received_events_url":"https://api.github.com/users/sircinnamon/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/python-pillow/Pillow/issues/comments/472933065","html_url":"https://github.com/python-pillow/Pillow/issues/3665#issuecomment-472933065","issue_url":"https://api.github.com/repos/python-pillow/Pillow/issues/3665","id":472933065,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3MjkzMzA2NQ==","user":{"login":"sircinnamon","id":16858312,"node_id":"MDQ6VXNlcjE2ODU4MzEy","avatar_url":"https://avatars.githubusercontent.com/u/16858312?v=4","gravatar_id":"","url":"https://api.github.com/users/sircinnamon","html_url":"https://github.com/sircinnamon","followers_url":"https://api.github.com/users/sircinnamon/followers","following_url":"https://api.github.com/users/sircinnamon/following{/other_user}","gists_url":"https://api.github.com/users/sircinnamon/gists{/gist_id}","starred_url":"https://api.github.com/users/sircinnamon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sircinnamon/subscriptions","organizations_url":"https://api.github.com/users/sircinnamon/orgs","repos_url":"https://api.github.com/users/sircinnamon/repos","events_url":"https://api.github.com/users/sircinnamon/events{/privacy}","received_events_url":"https://api.github.com/users/sircinnamon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-03-14T15:57:01Z","updated_at":"2019-03-14T22:26:23Z","body":"@radarhere It looks like the color_table_size calculation was written by you, I'm wondering if you have any insight? It looks like a frame with the colours `b'\\x00\\x00\\x00\\xff\\x00\\x00'` comes back as a 0 for color_table_size but `b'\\x00\\x00\\x00\\xff\\x00\\x00\\x00\\x00\\xff'`comes back fine. I mean I'm clearly missing something because it works for every other image except this case.\r\n\r\nWhere does the -1 come from? Would it be appropriate to just force a >3 len palette for disposal=2 frames?","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/python-pillow/Pillow/issues/comments/472933065/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"sircinnamon","id":16858312,"node_id":"MDQ6VXNlcjE2ODU4MzEy","avatar_url":"https://avatars.githubusercontent.com/u/16858312?v=4","gravatar_id":"","url":"https://api.github.com/users/sircinnamon","html_url":"https://github.com/sircinnamon","followers_url":"https://api.github.com/users/sircinnamon/followers","following_url":"https://api.github.com/users/sircinnamon/following{/other_user}","gists_url":"https://api.github.com/users/sircinnamon/gists{/gist_id}","starred_url":"https://api.github.com/users/sircinnamon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sircinnamon/subscriptions","organizations_url":"https://api.github.com/users/sircinnamon/orgs","repos_url":"https://api.github.com/users/sircinnamon/repos","events_url":"https://api.github.com/users/sircinnamon/events{/privacy}","received_events_url":"https://api.github.com/users/sircinnamon/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":2203913881,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjIwMzkxMzg4MQ==","url":"https://api.github.com/repos/python-pillow/Pillow/issues/events/2203913881","actor":{"login":"radarhere","id":3112309,"node_id":"MDQ6VXNlcjMxMTIzMDk=","avatar_url":"https://avatars.githubusercontent.com/u/3112309?v=4","gravatar_id":"","url":"https://api.github.com/users/radarhere","html_url":"https://github.com/radarhere","followers_url":"https://api.github.com/users/radarhere/followers","following_url":"https://api.github.com/users/radarhere/following{/other_user}","gists_url":"https://api.github.com/users/radarhere/gists{/gist_id}","starred_url":"https://api.github.com/users/radarhere/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/radarhere/subscriptions","organizations_url":"https://api.github.com/users/radarhere/orgs","repos_url":"https://api.github.com/users/radarhere/repos","events_url":"https://api.github.com/users/radarhere/events{/privacy}","received_events_url":"https://api.github.com/users/radarhere/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-03-14T15:57:01Z","performed_via_github_app":null},{"id":2203913884,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDIyMDM5MTM4ODQ=","url":"https://api.github.com/repos/python-pillow/Pillow/issues/events/2203913884","actor":{"login":"radarhere","id":3112309,"node_id":"MDQ6VXNlcjMxMTIzMDk=","avatar_url":"https://avatars.githubusercontent.com/u/3112309?v=4","gravatar_id":"","url":"https://api.github.com/users/radarhere","html_url":"https://github.com/radarhere","followers_url":"https://api.github.com/users/radarhere/followers","following_url":"https://api.github.com/users/radarhere/following{/other_user}","gists_url":"https://api.github.com/users/radarhere/gists{/gist_id}","starred_url":"https://api.github.com/users/radarhere/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/radarhere/subscriptions","organizations_url":"https://api.github.com/users/radarhere/orgs","repos_url":"https://api.github.com/users/radarhere/repos","events_url":"https://api.github.com/users/radarhere/events{/privacy}","received_events_url":"https://api.github.com/users/radarhere/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-03-14T15:57:01Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/python-pillow/Pillow/issues/comments/473094595","html_url":"https://github.com/python-pillow/Pillow/issues/3665#issuecomment-473094595","issue_url":"https://api.github.com/repos/python-pillow/Pillow/issues/3665","id":473094595,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3MzA5NDU5NQ==","user":{"login":"radarhere","id":3112309,"node_id":"MDQ6VXNlcjMxMTIzMDk=","avatar_url":"https://avatars.githubusercontent.com/u/3112309?v=4","gravatar_id":"","url":"https://api.github.com/users/radarhere","html_url":"https://github.com/radarhere","followers_url":"https://api.github.com/users/radarhere/followers","following_url":"https://api.github.com/users/radarhere/following{/other_user}","gists_url":"https://api.github.com/users/radarhere/gists{/gist_id}","starred_url":"https://api.github.com/users/radarhere/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/radarhere/subscriptions","organizations_url":"https://api.github.com/users/radarhere/orgs","repos_url":"https://api.github.com/users/radarhere/repos","events_url":"https://api.github.com/users/radarhere/events{/privacy}","received_events_url":"https://api.github.com/users/radarhere/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-03-14T22:46:02Z","updated_at":"2019-03-14T22:46:02Z","body":"That calculation was actually added in https://github.com/python-pillow/Pillow/commit/a466b3e09982ebcf5aee2cbe957ce90e6ddfd0ae, not written by me. That said, https://www.w3.org/Graphics/GIF/spec-gif89a.txt states that\r\n\r\n> the value in this field is used to calculate the number of bytes contained in the Global Color Table. To determine that actual size of the color table, raise 2 to [the value of the field + 1]\r\n\r\nSo `int(math.ceil(math.log(..., 2)))-1` is just the inverse of that.","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/python-pillow/Pillow/issues/comments/473094595/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"radarhere","id":3112309,"node_id":"MDQ6VXNlcjMxMTIzMDk=","avatar_url":"https://avatars.githubusercontent.com/u/3112309?v=4","gravatar_id":"","url":"https://api.github.com/users/radarhere","html_url":"https://github.com/radarhere","followers_url":"https://api.github.com/users/radarhere/followers","following_url":"https://api.github.com/users/radarhere/following{/other_user}","gists_url":"https://api.github.com/users/radarhere/gists{/gist_id}","starred_url":"https://api.github.com/users/radarhere/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/radarhere/subscriptions","organizations_url":"https://api.github.com/users/radarhere/orgs","repos_url":"https://api.github.com/users/radarhere/repos","events_url":"https://api.github.com/users/radarhere/events{/privacy}","received_events_url":"https://api.github.com/users/radarhere/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/python-pillow/Pillow/issues/comments/473102163","html_url":"https://github.com/python-pillow/Pillow/issues/3665#issuecomment-473102163","issue_url":"https://api.github.com/repos/python-pillow/Pillow/issues/3665","id":473102163,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3MzEwMjE2Mw==","user":{"login":"sircinnamon","id":16858312,"node_id":"MDQ6VXNlcjE2ODU4MzEy","avatar_url":"https://avatars.githubusercontent.com/u/16858312?v=4","gravatar_id":"","url":"https://api.github.com/users/sircinnamon","html_url":"https://github.com/sircinnamon","followers_url":"https://api.github.com/users/sircinnamon/followers","following_url":"https://api.github.com/users/sircinnamon/following{/other_user}","gists_url":"https://api.github.com/users/sircinnamon/gists{/gist_id}","starred_url":"https://api.github.com/users/sircinnamon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sircinnamon/subscriptions","organizations_url":"https://api.github.com/users/sircinnamon/orgs","repos_url":"https://api.github.com/users/sircinnamon/repos","events_url":"https://api.github.com/users/sircinnamon/events{/privacy}","received_events_url":"https://api.github.com/users/sircinnamon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-03-14T23:21:31Z","updated_at":"2019-03-14T23:21:31Z","body":"That's on me for not reading the history close enough, I just saw the last modification and assumed, I apologize for that!\r\n\r\nOkay so that confirms that the color table basically has a minimum palette size of 3 colors (or two if we remove the statement that considers 0 invalid) and that padding out the palette if it's too small is probably the way to go! Thank you!","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/python-pillow/Pillow/issues/comments/473102163/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"sircinnamon","id":16858312,"node_id":"MDQ6VXNlcjE2ODU4MzEy","avatar_url":"https://avatars.githubusercontent.com/u/16858312?v=4","gravatar_id":"","url":"https://api.github.com/users/sircinnamon","html_url":"https://github.com/sircinnamon","followers_url":"https://api.github.com/users/sircinnamon/followers","following_url":"https://api.github.com/users/sircinnamon/following{/other_user}","gists_url":"https://api.github.com/users/sircinnamon/gists{/gist_id}","starred_url":"https://api.github.com/users/sircinnamon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sircinnamon/subscriptions","organizations_url":"https://api.github.com/users/sircinnamon/orgs","repos_url":"https://api.github.com/users/sircinnamon/repos","events_url":"https://api.github.com/users/sircinnamon/events{/privacy}","received_events_url":"https://api.github.com/users/sircinnamon/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/python-pillow/Pillow/issues/comments/474651101","html_url":"https://github.com/python-pillow/Pillow/issues/3665#issuecomment-474651101","issue_url":"https://api.github.com/repos/python-pillow/Pillow/issues/3665","id":474651101,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3NDY1MTEwMQ==","user":{"login":"radarhere","id":3112309,"node_id":"MDQ6VXNlcjMxMTIzMDk=","avatar_url":"https://avatars.githubusercontent.com/u/3112309?v=4","gravatar_id":"","url":"https://api.github.com/users/radarhere","html_url":"https://github.com/radarhere","followers_url":"https://api.github.com/users/radarhere/followers","following_url":"https://api.github.com/users/radarhere/following{/other_user}","gists_url":"https://api.github.com/users/radarhere/gists{/gist_id}","starred_url":"https://api.github.com/users/radarhere/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/radarhere/subscriptions","organizations_url":"https://api.github.com/users/radarhere/orgs","repos_url":"https://api.github.com/users/radarhere/repos","events_url":"https://api.github.com/users/radarhere/events{/privacy}","received_events_url":"https://api.github.com/users/radarhere/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-03-20T01:45:33Z","updated_at":"2019-03-20T02:15:13Z","body":"[The sample code](https://github.com/python-pillow/Pillow/issues/3665#issuecomment-471973989) provided by @burnoo is not actually solved by #3708 - that's okay though, because it is solved by #3434. I'm going to suggest that any discussion of that problem is moved to #3153, which looks like the same issue.","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/python-pillow/Pillow/issues/comments/474651101/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"radarhere","id":3112309,"node_id":"MDQ6VXNlcjMxMTIzMDk=","avatar_url":"https://avatars.githubusercontent.com/u/3112309?v=4","gravatar_id":"","url":"https://api.github.com/users/radarhere","html_url":"https://github.com/radarhere","followers_url":"https://api.github.com/users/radarhere/followers","following_url":"https://api.github.com/users/radarhere/following{/other_user}","gists_url":"https://api.github.com/users/radarhere/gists{/gist_id}","starred_url":"https://api.github.com/users/radarhere/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/radarhere/subscriptions","organizations_url":"https://api.github.com/users/radarhere/orgs","repos_url":"https://api.github.com/users/radarhere/repos","events_url":"https://api.github.com/users/radarhere/events{/privacy}","received_events_url":"https://api.github.com/users/radarhere/received_events","type":"User","user_view_type":"public","site_admin":false}}]