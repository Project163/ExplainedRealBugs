{"url":"https://api.github.com/repos/rspec/rspec-core/issues/1961","repository_url":"https://api.github.com/repos/rspec/rspec-core","labels_url":"https://api.github.com/repos/rspec/rspec-core/issues/1961/labels{/name}","comments_url":"https://api.github.com/repos/rspec/rspec-core/issues/1961/comments","events_url":"https://api.github.com/repos/rspec/rspec-core/issues/1961/events","html_url":"https://github.com/rspec/rspec-core/issues/1961","id":75133338,"node_id":"MDU6SXNzdWU3NTEzMzMzOA==","number":1961,"title":"3.2.2 breaks line number filter when external shared examples are included","user":{"login":"ben-axnick","id":638997,"node_id":"MDQ6VXNlcjYzODk5Nw==","avatar_url":"https://avatars.githubusercontent.com/u/638997?v=4","gravatar_id":"","url":"https://api.github.com/users/ben-axnick","html_url":"https://github.com/ben-axnick","followers_url":"https://api.github.com/users/ben-axnick/followers","following_url":"https://api.github.com/users/ben-axnick/following{/other_user}","gists_url":"https://api.github.com/users/ben-axnick/gists{/gist_id}","starred_url":"https://api.github.com/users/ben-axnick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ben-axnick/subscriptions","organizations_url":"https://api.github.com/users/ben-axnick/orgs","repos_url":"https://api.github.com/users/ben-axnick/repos","events_url":"https://api.github.com/users/ben-axnick/events{/privacy}","received_events_url":"https://api.github.com/users/ben-axnick/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":true,"assignee":null,"assignees":[],"milestone":null,"comments":7,"created_at":"2015-05-11T08:18:56Z","updated_at":"2015-05-18T07:35:38Z","closed_at":"2015-05-18T07:35:38Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"In going from `rspec-core` 3.2.1 to `rspec-core` 3.2.2 (included into the bundle via `rspec-rails`), I've noticed that CLI commands in the form:\n\n```\n> bundle exec foo.rb:123\n```\n\nwhere `123` is the start/inner line of an `it` block no longer behave as expected. In 3.2.1, only that single test would be run. In 3.2.2 all `it_behaves_like` blocks in the file get executed before running the indicated test. This can add significantly to the amount of time needed to interactively run tests if there are many tests defined inside the `shared_examples` block that `it_behaves_like` refers to.\n\nThe bug/change is still present in 3.2.3 but I have not tested against `master`.\n## Issue\n\nAppears to occur when shared examples are `require`d from an external file.\n## Reproducing\n\nSetup files as below (or `git clone https://github.com/bentheax/sample-rspec-for-bug-report.git`) and run\n\n```\n> bundle exec rspec spec/minimal_spec.rb:7\n```\n\n**`Gemfile`**\n\n``` ruby\nsource \"https://rubygems.org\"\n\ngem \"rspec\"\ngem \"rspec-core\", \"=3.2.2\"\n```\n\n**`Gemfile.lock`**\n\n```\nGEM\n  remote: https://rubygems.org/\n  specs:\n    diff-lcs (1.2.5)\n    rspec (3.2.0)\n      rspec-core (~> 3.2.0)\n      rspec-expectations (~> 3.2.0)\n      rspec-mocks (~> 3.2.0)\n    rspec-core (3.2.2)\n      rspec-support (~> 3.2.0)\n    rspec-expectations (3.2.1)\n      diff-lcs (>= 1.2.0, < 2.0)\n      rspec-support (~> 3.2.0)\n    rspec-mocks (3.2.1)\n      diff-lcs (>= 1.2.0, < 2.0)\n      rspec-support (~> 3.2.0)\n    rspec-support (3.2.2)\n\nPLATFORMS\n  ruby\n\nDEPENDENCIES\n  rspec\n  rspec-core (= 3.2.2)\n```\n\n**`spec/a_test_that_always_runs_external_examples.rb`**\n\n``` ruby\nshared_examples \"a test that always runs external examples\" do\n  it \"runs me, for instance\" do\n    raise \"this line should never be executed\"\n  end\nend\n```\n\n**`spec/minimal_spec.rb`**\n\n``` ruby\nrequire_relative \"./a_test_that_always_runs_external_examples\"\n\ndescribe \"rspec_with_line_number\" do\n  it_behaves_like \"a test that always runs external examples\"\n\n  it \"has a test that I'd like to run on its own\" do\n    expect(1).to eq(1)\n  end\nend\n```\n## Output\n\n```\n> bundle exec rspec -fd spec/minimal_spec.rb:7\nRun options: include {:locations=>{\"./spec/minimal_spec.rb\"=>[7]}}\n\nrspec_with_line_number\n  has a test that I'd like to run on its own\n  behaves like a test that always runs external examples\n    runs me, for instance (FAILED - 1)\n\nFailures:\n\n  1) rspec_with_line_number behaves like a test that always runs external examples runs me, for instance\n     Failure/Error: raise \"this line should never be executed\"\n     RuntimeError:\n       this line should never be executed\n     Shared Example Group: \"a test that always runs external examples\" called from ./spec/minimal_spec.rb:4\n     # ./spec/a_test_that_always_runs_external_examples.rb:3:in `block (2 levels) in <top (required)>'\n\nFinished in 0.00151 seconds (files took 0.0792 seconds to load)\n2 examples, 1 failure\n\nFailed examples:\n\nrspec ./spec/minimal_spec.rb:4 # rspec_with_line_number behaves like a test that always runs external examples runs me, for instance\n```\n","closed_by":{"login":"JonRowe","id":162976,"node_id":"MDQ6VXNlcjE2Mjk3Ng==","avatar_url":"https://avatars.githubusercontent.com/u/162976?v=4","gravatar_id":"","url":"https://api.github.com/users/JonRowe","html_url":"https://github.com/JonRowe","followers_url":"https://api.github.com/users/JonRowe/followers","following_url":"https://api.github.com/users/JonRowe/following{/other_user}","gists_url":"https://api.github.com/users/JonRowe/gists{/gist_id}","starred_url":"https://api.github.com/users/JonRowe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JonRowe/subscriptions","organizations_url":"https://api.github.com/users/JonRowe/orgs","repos_url":"https://api.github.com/users/JonRowe/repos","events_url":"https://api.github.com/users/JonRowe/events{/privacy}","received_events_url":"https://api.github.com/users/JonRowe/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/rspec/rspec-core/issues/1961/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/rspec/rspec-core/issues/1961/timeline","performed_via_github_app":null,"state_reason":"completed"}