diff --git a/History.markdown b/History.markdown
index 510dade6..0811a573 100644
--- a/History.markdown
+++ b/History.markdown
@@ -9,6 +9,7 @@
     (Clifford Heath)
   * HTML Formatter _finally_ properly displays nested groups (Jarmo Pertman)
   * apply hook filtering to examples as well as groups (Myron Marston)
+  * support multiple formatters, each with their own output
 
 * Bug fixes
   * send debugger warning message to $stdout if RSpec.configuration.error_stream
diff --git a/features/command_line/README.md b/features/command_line/README.md
new file mode 100644
index 00000000..d7955c3f
--- /dev/null
+++ b/features/command_line/README.md
@@ -0,0 +1,6 @@
+The `rspec` command comes with several options you can use to customize RSpec's
+behavior, including output formats, filtering examples, etc.
+
+For a full list of options, run the `rspec` command with the `--help` flag:
+
+    $ rspec --help
diff --git a/features/command_line/configure.feature b/features/command_line/configure.feature
index a1c5c2ef..54827be1 100644
--- a/features/command_line/configure.feature
+++ b/features/command_line/configure.feature
@@ -1,4 +1,4 @@
-Feature: configure
+Feature: --configure option
 
   Use the --configure option on the command line to generate configuration
   files.
diff --git a/features/command_line/example_name_option.feature b/features/command_line/example_name_option.feature
index 56d92792..38de2ab3 100644
--- a/features/command_line/example_name_option.feature
+++ b/features/command_line/example_name_option.feature
@@ -1,13 +1,13 @@
-Feature: example name option
+Feature: --example option
 
-  Use the --example (or -e) option to filter the examples to be run by name.
+  Use the --example (or -e) option to filter examples by name.
 
   The argument is compiled to a Ruby Regexp, and matched against the full
   description of the example, which is the concatenation of descriptions of the
   group (including any nested groups) and the example.
 
   This allows you to run a single uniquely named example, all examples with
-  similar names, all the example in a uniquely named group, etc, etc.
+  similar names, all the examples in a uniquely named group, etc, etc.
 
   Background:
     Given a file named "first_spec.rb" with:
diff --git a/features/command_line/format_option.feature b/features/command_line/format_option.feature
new file mode 100644
index 00000000..3e88678a
--- /dev/null
+++ b/features/command_line/format_option.feature
@@ -0,0 +1,73 @@
+Feature: --formatt option
+
+  Use the --format option to tell RSpec how to format the output.
+
+  RSpec ships with a few formatters built in. By default, it uses the progress
+  formatter, which generates output like this:
+    
+      ....F.....*.....
+
+  A '.' represents a passing example, 'F' is failing, and '*' is pending.
+
+  To see the documentation strings passed to each describe(), context(), and it()
+  method, use the documentation formatter:
+
+      $ rspec spec --format documentation
+
+  You can also specify an output target (STDOUT by default) by appending a
+  filename to the argument:
+
+    $ rspec spec --format documentation:rspec.output.txt
+
+  Background:
+    Given a file named "example_spec.rb" with:
+      """
+      describe "something" do
+        it "does something that passes" do
+          5.should eq(5)
+        end
+
+        it "does something that fails" do
+          5.should eq(4)
+        end
+
+        it "does something that is pending", :pending => true do
+          5.should be > 3
+        end
+      end
+      """
+
+  Scenario: progress bar format (default)
+    When I run "rspec example_spec.rb"
+    Then the output should contain ".F*"
+
+  Scenario: documentation format
+    When I run "rspec example_spec.rb --format documentation"
+    Then the output should contain:
+      """
+      something
+        does something that passes
+        does something that fails (FAILED - 1)
+        does something that is pending (PENDING: Not Yet Implemented)
+      """
+
+  Scenario: documentation format saved to a file
+    When I run "rspec example_spec.rb --format documentation --out rspec.txt"
+    Then the file "rspec.txt" should contain:
+      """
+      something
+        does something that passes
+        does something that fails (FAILED - 1)
+        does something that is pending (PENDING: Not Yet Implemented)
+      """
+
+  Scenario: multiple formats
+    When I run "rspec example_spec.rb --format progress --format documentation --out rspec.txt"
+    Then the output should contain ".F*"
+    And the file "rspec.txt" should contain:
+      """
+      something
+        does something that passes
+        does something that fails (FAILED - 1)
+        does something that is pending (PENDING: Not Yet Implemented)
+      """
diff --git a/features/command_line/line_number_appended_to_path.feature b/features/command_line/line_number_appended_to_path.feature
index 5fd98ef5..738fb48c 100644
--- a/features/command_line/line_number_appended_to_path.feature
+++ b/features/command_line/line_number_appended_to_path.feature
@@ -2,7 +2,7 @@ Feature: line number appended to file path
 
   To run a single example or group, you can append the line number to the path, e.g.
 
-    rspec path/to/example_spec.rb:37
+      rspec path/to/example_spec.rb:37
   
   Background:
     Given a file named "example_spec.rb" with:
diff --git a/features/command_line/line_number_option.feature b/features/command_line/line_number_option.feature
index 0a3f409f..2b4c89ad 100644
--- a/features/command_line/line_number_option.feature
+++ b/features/command_line/line_number_option.feature
@@ -1,8 +1,8 @@
-Feature: line number option
+Feature: --line option
 
   To run a single example or group, you can use the --line option:
 
-    rspec path/to/example_spec.rb --line 37
+      rspec path/to/example_spec.rb --line 37
 
   Scenario: standard examples
     Given a file named "example_spec.rb" with:
diff --git a/features/command_line/tag.feature b/features/command_line/tag.feature
index 62567fe3..47dccfa8 100644
--- a/features/command_line/tag.feature
+++ b/features/command_line/tag.feature
@@ -1,18 +1,18 @@
-Feature: tag option
+Feature: --tag option
 
-  Use the --tag (or -t) option to filter the examples to be run by tag.
+  Use the --tag (or -t) option to filter the examples by tags.
   
   The tag can be a simple name or a name:value pair. In the first case,
   examples with :name => true will be filtered. In the second case, examples
-  with :name => value will be filtered, where value is always a string.
-  In both cases, name is converted to a symbol.
+  with :name => value will be filtered, where value is always a string.  In
+  both cases, name is converted to a symbol.
   
-  Tags can also be used to exclude examples by adding a ~ before the tag.
-  For example ~tag will exclude all examples marked with :tag => true and
+  Tags can also be used to exclude examples by adding a ~ before the tag.  For
+  example ~tag will exclude all examples marked with :tag => true and
   ~tag:value will exclude all examples marked with :tag => value.
   
   To be compatible with the Cucumber syntax, tags can optionally start with
-  a @, that will be ignored.
+  an @ symbol, which will be ignored.
 
   Background:
     Given a file named "tagged_spec.rb" with:
diff --git a/features/configuration/read_options_from_file.feature b/features/configuration/read_options_from_file.feature
index 09bec30c..9a0fa584 100644
--- a/features/configuration/read_options_from_file.feature
+++ b/features/configuration/read_options_from_file.feature
@@ -42,7 +42,7 @@ Feature: read command line configuration options from files
       """
       describe "formatter set in custom options file" do
         it "sets formatter" do
-          RSpec.configuration.formatter.
+          RSpec.configuration.formatters.first.
             should be_a(RSpec::Core::Formatters::DocumentationFormatter)
         end
       end
@@ -70,30 +70,6 @@ Feature: read command line configuration options from files
     When I run "rspec spec/example_spec.rb --options my.options"
     Then the output should contain "1 example, 0 failures"
 
-  Scenario: formatter set in RSpec.configure overrides .rspec
-    Given a file named ".rspec" with:
-      """
-      --format progress
-      """
-    And a file named "spec/spec_helper.rb" with:
-      """
-      RSpec.configure {|c| c.formatter = 'documentation'}
-      """
-    And a file named "spec/example_spec.rb" with:
-      """
-      require "spec_helper"
-
-      describe "formatter" do
-        context "when set with RSpec.configure and in spec.opts" do
-          it "takes the value set in spec.opts" do
-            RSpec.configuration.formatter.should be_an(RSpec::Core::Formatters::DocumentationFormatter)
-          end
-        end
-      end
-      """
-    When I run "rspec ./spec/example_spec.rb"
-    Then the output should contain "1 example, 0 failures"
-    
   Scenario: using ERB in .rspec
     Given a file named ".rspec" with:
       """
@@ -103,7 +79,7 @@ Feature: read command line configuration options from files
       """
       describe "formatter" do
         it "is set to documentation" do
-          RSpec.configuration.formatter.should be_an(RSpec::Core::Formatters::DocumentationFormatter)
+          RSpec.configuration.formatters.first.should be_an(RSpec::Core::Formatters::DocumentationFormatter)
         end
       end
       """
diff --git a/features/step_definitions/additional_cli_steps.rb b/features/step_definitions/additional_cli_steps.rb
index dc7c5a4d..4d07f99c 100644
--- a/features/step_definitions/additional_cli_steps.rb
+++ b/features/step_definitions/additional_cli_steps.rb
@@ -14,3 +14,7 @@ Then /^the example(s)? should( all)? pass$/ do |*|
   Then %q{the output should contain "0 failures"}
   Then %q{the exit status should be 0}
 end
+
+Then /^the file "([^"]*)" should contain:$/ do |file, partial_content|
+  check_file_content(file, partial_content, true)
+end
diff --git a/lib/rspec/core/configuration.rb b/lib/rspec/core/configuration.rb
index 611f94ae..d9393845 100644
--- a/lib/rspec/core/configuration.rb
+++ b/lib/rspec/core/configuration.rb
@@ -263,28 +263,33 @@ EOM
         filter_run({ :full_description => /#{description}/ }, true)
       end
 
-      attr_writer :formatter_class
-
-      def formatter_class
-        @formatter_class ||= begin
-                               require 'rspec/core/formatters/progress_formatter'
-                               RSpec::Core::Formatters::ProgressFormatter
-                             end
-      end
-
-      def formatter=(formatter_to_use)
-        self.formatter_class =
+      def add_formatter(formatter_to_use, output=nil)
+        formatter_class =
           built_in_formatter(formatter_to_use) ||
           custom_formatter(formatter_to_use) ||
           (raise ArgumentError, "Formatter '#{formatter_to_use}' unknown - maybe you meant 'documentation' or 'progress'?.")
+
+        formatters << formatter_class.new(output || self.output)
       end
 
-      def formatter
-        @formatter ||= formatter_class.new(output)
+      alias_method :formatter=, :add_formatter
+
+      def formatters
+        @formatters ||= []
       end
 
       def reporter
-        @reporter ||= Reporter.new(formatter)
+        @reporter ||= begin
+                        add_formatter('progress') if formatters.empty?
+                        Reporter.new(*formatters)
+                      end
+      end
+
+      def default_formatter
+        @default_formatter ||= begin
+                                 require 'rspec/core/formatters/progress_formatter'
+                                 RSpec::Core::Formatters::ProgressFormatter.new(output)
+                               end
       end
 
       def files_or_directories_to_run=(*files)
diff --git a/lib/rspec/core/configuration_options.rb b/lib/rspec/core/configuration_options.rb
index 0677f675..408356dd 100644
--- a/lib/rspec/core/configuration_options.rb
+++ b/lib/rspec/core/configuration_options.rb
@@ -18,9 +18,15 @@ module RSpec
         keys = options.keys
         keys.unshift(:requires) if keys.delete(:requires)
         keys.unshift(:libs)     if keys.delete(:libs)
+        formatters = options[:formatters] if keys.delete(:formatters)
         keys.each do |key|
           config.send("#{key}=", options[key]) if config.respond_to?("#{key}=")
         end
+        if formatters
+          formatters.each do |pair|
+            config.add_formatter(*pair)
+          end
+        end
       end
 
       def drb_argv
@@ -30,10 +36,17 @@ module RSpec
         argv << "--backtrace" if options[:full_backtrace]
         argv << "--tty"       if options[:tty]
         argv << "--fail-fast"  if options[:fail_fast]
-        argv << "--format"       << options[:formatter]               if options[:formatter]
         argv << "--line_number"  << options[:line_number]             if options[:line_number]
         argv << "--options"      << options[:custom_options_file]            if options[:custom_options_file]
         argv << "--example"      << options[:full_description].source if options[:full_description]
+        if options[:formatters]
+          options[:formatters].each do |pair|
+            argv << "--format" << pair.shift
+            unless pair.empty?
+              argv << "--out" << pair.shift
+            end
+          end
+        end
         (options[:libs] || []).each do |path|
           argv << "-I" << path
         end
diff --git a/lib/rspec/core/option_parser.rb b/lib/rspec/core/option_parser.rb
index fcb18f07..1ba3da60 100644
--- a/lib/rspec/core/option_parser.rb
+++ b/lib/rspec/core/option_parser.rb
@@ -47,12 +47,18 @@ module RSpec::Core
                 '  [d]ocumentation (group and example names)',
                 '  [h]tml',
                 '  [t]extmate',
-                '  custom formatter class name') do |o|
-          options[:formatter] = o
-        end
-
-        parser.on('-o', '--out FILE', 'output to a file instead of STDOUT') do |o|
-          options[:output_stream] = File.open(o,'w')
+                '  custom formatter class name') do |f|
+          options[:formatters] ||= []
+          options[:formatters] << [f]
+        end
+
+        parser.on('-o', '--out FILE',
+                  'Write output to a file instead of STDOUT. This option applies',
+                  'to the previously specified --format, or the default format if',
+                  'no format is specified.'
+                 ) do |o|
+          options[:formatters] ||= [['progress']]
+          options[:formatters].last << File.open(o,'w')
         end
 
         parser.on_tail('-h', '--help', "You're looking at it.") do
diff --git a/spec/rspec/core/configuration_options_spec.rb b/spec/rspec/core/configuration_options_spec.rb
index 102ab4a8..f8727c7b 100644
--- a/spec/rspec/core/configuration_options_spec.rb
+++ b/spec/rspec/core/configuration_options_spec.rb
@@ -27,7 +27,7 @@ describe RSpec::Core::ConfigurationOptions do
       opts = config_options_object(*%w[--require a/path -f a/formatter])
       config = double("config").as_null_object
       config.should_receive(:requires=).ordered
-      config.should_receive(:formatter=).ordered
+      config.should_receive(:add_formatter).ordered
       opts.configure(config)
     end
   end
@@ -66,13 +66,13 @@ describe RSpec::Core::ConfigurationOptions do
 
   describe "--format, -f" do
     it "sets :formatter" do
-      parse_options('--format', 'd').should include(:formatter => 'd')
-      parse_options('-f', 'd').should include(:formatter => 'd')
-      parse_options('-fd').should include(:formatter => 'd')
+      parse_options('--format', 'd').should include(:formatters => [['d']])
+      parse_options('-f', 'd').should include(:formatters => [['d']])
+      parse_options('-fd').should include(:formatters => [['d']])
     end
 
     example "can accept a class name" do
-      parse_options('-fSome::Formatter::Class').should include(:formatter => 'Some::Formatter::Class')
+      parse_options('-fSome::Formatter::Class').should include(:formatters => [['Some::Formatter::Class']])
     end
   end
 
@@ -207,7 +207,7 @@ describe RSpec::Core::ConfigurationOptions do
     context "--drb specified in ARGV" do
       it "renders all the original arguments except --drb" do
         config_options_object(*%w[ --drb --color --format s --line_number 1 --example pattern --profile --backtrace -I path/a -I path/b --require path/c --require path/d]).
-          drb_argv.should eq(%w[ --color --profile --backtrace --format s --line_number 1 --example pattern -I path/a -I path/b --require path/c --require path/d])
+          drb_argv.should eq(%w[ --color --profile --backtrace --line_number 1 --example pattern --format s -I path/a -I path/b --require path/c --require path/d])
       end
     end
 
@@ -216,7 +216,7 @@ describe RSpec::Core::ConfigurationOptions do
         File.stub(:exist?) { true }
         IO.stub(:read) { "--drb --color" }
         config_options_object(*%w[ --tty --format s --line_number 1 --example pattern --profile --backtrace ]).
-          drb_argv.should eq(%w[ --color --profile --backtrace --tty --format s --line_number 1 --example pattern ])
+          drb_argv.should eq(%w[ --color --profile --backtrace --tty --line_number 1 --example pattern --format s])
       end
     end
 
@@ -225,7 +225,7 @@ describe RSpec::Core::ConfigurationOptions do
         File.stub(:exist?) { true }
         IO.stub(:read) { "--drb --color" }
         config_options_object(*%w[ --drb --format s --line_number 1 --example pattern --profile --backtrace]).
-          drb_argv.should eq(%w[ --color --profile --backtrace --format s --line_number 1 --example pattern ])
+          drb_argv.should eq(%w[ --color --profile --backtrace --line_number 1 --example pattern --format s])
       end
     end
 
@@ -234,7 +234,7 @@ describe RSpec::Core::ConfigurationOptions do
         File.stub(:exist?) { true }
         IO.stub(:read) { "--drb --color" }
         config_options_object(*%w[ --drb --format s --line_number 1 --example pattern --profile --backtrace]).
-          drb_argv.should eq(%w[ --color --profile --backtrace --format s --line_number 1 --example pattern ])
+          drb_argv.should eq(%w[ --color --profile --backtrace --line_number 1 --example pattern --format s ])
       end
     end
   end
@@ -272,30 +272,30 @@ describe RSpec::Core::ConfigurationOptions do
     it "merges global, local, SPEC_OPTS, and CLI" do
       write_options(:global, "--color")
       write_options(:local,  "--line 37")
-      ENV["SPEC_OPTS"] = "--format documentation"
+      ENV["SPEC_OPTS"] = "--debug"
       options = parse_options("--drb")
       options[:color_enabled].should be_true
       options[:line_number].should eq("37")
-      options[:formatter].should eq("documentation")
+      options[:debug].should be_true
       options[:drb].should be_true
     end
 
     it "prefers CLI over SPEC_OPTS" do
       ENV["SPEC_OPTS"] = "--format spec_opts"
-      parse_options("--format", "cli")[:formatter].should eq('cli')
+      parse_options("--format", "cli")[:formatters].should eq([['cli']])
     end
 
     it "prefers SPEC_OPTS over file options" do
       write_options(:local,  "--format local")
       write_options(:global, "--format global")
       ENV["SPEC_OPTS"] = "--format spec_opts"
-      parse_options[:formatter].should eq('spec_opts')
+      parse_options[:formatters].should eq([['spec_opts']])
     end
 
     it "prefers local file options over global" do
       write_options(:local,  "--format local")
       write_options(:global, "--format global")
-      parse_options[:formatter].should eq('local')
+      parse_options[:formatters].should eq([['local']])
     end
 
     context "with custom options file" do
diff --git a/spec/rspec/core/configuration_spec.rb b/spec/rspec/core/configuration_spec.rb
index d99c9166..160180f3 100644
--- a/spec/rspec/core/configuration_spec.rb
+++ b/spec/rspec/core/configuration_spec.rb
@@ -1,4 +1,5 @@
 require 'spec_helper'
+require 'tmpdir'
 
 module RSpec::Core
 
@@ -350,47 +351,71 @@ module RSpec::Core
     end
 
     describe 'formatter=' do
+      it "delegates to add_formatter (better API for user-facing configuration)" do
+        config.should_receive(:add_formatter).with('these','options')
+        config.add_formatter('these','options')
+      end
+    end
+
+    describe "add_formatter" do
+
+      it "adds to the list of formatters" do
+        config.add_formatter :documentation
+        config.formatters.first.should be_an_instance_of(Formatters::DocumentationFormatter)
+      end
 
-      it "sets formatter_to_use based on name" do
-        config.formatter = :documentation
-        config.formatter.should be_an_instance_of(Formatters::DocumentationFormatter)
-        config.formatter = 'documentation'
-        config.formatter.should be_an_instance_of(Formatters::DocumentationFormatter)
+      it "finds a formatter by name (w/ Symbol)" do
+        config.add_formatter :documentation
+        config.formatters.first.should be_an_instance_of(Formatters::DocumentationFormatter)
       end
 
-      it "sets a formatter based on its class" do
+      it "finds a formatter by name (w/ String)" do
+        config.add_formatter 'documentation'
+        config.formatters.first.should be_an_instance_of(Formatters::DocumentationFormatter)
+      end
+
+      it "finds a formatter by class" do
         formatter_class = Class.new(Formatters::BaseTextFormatter)
-        config.formatter = formatter_class
-        config.formatter.should be_an_instance_of(formatter_class)
+        config.add_formatter formatter_class
+        config.formatters.first.should be_an_instance_of(formatter_class)
       end
 
-      it "sets a formatter based on its class name" do
+      it "finds a formatter by class name" do
         Object.const_set("CustomFormatter", Class.new(Formatters::BaseFormatter))
-        config.formatter = "CustomFormatter"
-        config.formatter.should be_an_instance_of(CustomFormatter)
+        config.add_formatter "CustomFormatter"
+        config.formatters.first.should be_an_instance_of(CustomFormatter)
       end
 
-      it "sets a formatter based on its class fully qualified name" do
+      it "finds a formatter by class fully qualified name" do
         RSpec.const_set("CustomFormatter", Class.new(Formatters::BaseFormatter))
-        config.formatter = "RSpec::CustomFormatter"
-        config.formatter.should be_an_instance_of(RSpec::CustomFormatter)
+        config.add_formatter "RSpec::CustomFormatter"
+        config.formatters.first.should be_an_instance_of(RSpec::CustomFormatter)
       end
 
-      it "requires and sets a formatter based on its class fully qualified name" do
+      it "requires a formatter file based on its fully qualified name" do
         config.should_receive(:require).with('rspec/custom_formatter2') do
           RSpec.const_set("CustomFormatter2", Class.new(Formatters::BaseFormatter))
         end
-        config.formatter = "RSpec::CustomFormatter2"
-        config.formatter.should be_an_instance_of(RSpec::CustomFormatter2)
+        config.add_formatter "RSpec::CustomFormatter2"
+        config.formatters.first.should be_an_instance_of(RSpec::CustomFormatter2)
       end
 
       it "raises NameError if class is unresolvable" do
         config.should_receive(:require).with('rspec/custom_formatter3')
-        lambda { config.formatter = "RSpec::CustomFormatter3" }.should raise_error(NameError)
+        lambda { config.add_formatter "RSpec::CustomFormatter3" }.should raise_error(NameError)
       end
 
       it "raises ArgumentError if formatter is unknown" do
-        lambda { config.formatter = :progresss }.should raise_error(ArgumentError)
+        lambda { config.add_formatter :progresss }.should raise_error(ArgumentError)
+      end
+
+      context "with a 2nd arg defining the output" do
+        it "sets that as the output" do
+          file = File.join(Dir.tmpdir, 'output.txt')
+          config.add_formatter('doc', file)
+          config.formatters.first.should be_a(RSpec::Core::Formatters::DocumentationFormatter)
+          config.formatters.first.output.should eq(file)
+        end
       end
 
     end
diff --git a/spec/rspec/core/option_parser_spec.rb b/spec/rspec/core/option_parser_spec.rb
index c4e61acd..feb4f075 100644
--- a/spec/rspec/core/option_parser_spec.rb
+++ b/spec/rspec/core/option_parser_spec.rb
@@ -8,14 +8,8 @@ module RSpec::Core
 
     let(:output_file){ mock File }
 
-    it "deprecates the --formatter option" do
-      RSpec.should_receive(:deprecate)
-      Parser.parse!(%w[--formatter doc])
-    end
-
-    it "converts --formatter to --format" do
-      options = Parser.parse!(%w[--formatter doc])
-      options.should eq( {:formatter=>"doc"} )
+    before do
+      File.stub(:open).with("foo.txt",'w') { (output_file) }
     end
 
     it "does not parse empty args" do
@@ -24,16 +18,58 @@ module RSpec::Core
       parser.parse!([])
     end
 
-    it "parses output stream from --out" do
-      File.should_receive(:open).with("foo.txt",'w').and_return(output_file)
-      options = Parser.parse!(%w[--out foo.txt])
-      options.should eq( {:output_stream=>output_file} )
+    describe "--formatter" do
+      it "is deprecated" do
+        RSpec.should_receive(:deprecate)
+        Parser.parse!(%w[--formatter doc])
+      end
+
+      it "gets converted to --format" do
+        options = Parser.parse!(%w[--formatter doc])
+        options[:formatters].first.should eq(["doc"])
+      end
+    end
+
+    describe "--format" do
+      it "defines the formatter" do
+        options = Parser.parse!(%w[--format doc])
+        options[:formatters].first.should eq(["doc"])
+      end
     end
 
-    it "parses output stream from -o" do
-      File.should_receive(:open).with("foo.txt",'w').and_return(output_file)
-      options = Parser.parse!(%w[-o foo.txt])
-      options.should eq( {:output_stream=>output_file} )
+    describe "-f" do
+      it "defines the formatter" do
+        options = Parser.parse!(%w[-f doc])
+        options[:formatters].first.should eq(["doc"])
+      end
+    end
+
+    %w[--out -o].each do |option|
+      describe option do
+        let(:options) { Parser.parse!([option, 'foo.txt']) }
+
+        it "sets the output stream for the formatter" do
+          options[:formatters].last.should eq(['progress', output_file])
+        end
+
+        context "with multiple formatters" do
+          context "after last formatter" do
+            it "sets the output stream for the last formatter" do
+              options = Parser.parse!(['-f', 'progress', '-f', 'doc', option, 'foo.txt'])
+              options[:formatters][0].should eq(['progress'])
+              options[:formatters][1].should eq(['doc', output_file])
+            end
+          end
+
+          context "after first formatter" do
+            it "sets the output stream for the first formatter" do
+              options = Parser.parse!(['-f', 'progress', option, 'foo.txt', '-f', 'doc'])
+              options[:formatters][0].should eq(['progress', output_file])
+              options[:formatters][1].should eq(['doc'])
+            end
+          end
+        end
+      end
     end
   end
-end
\ No newline at end of file
+end
