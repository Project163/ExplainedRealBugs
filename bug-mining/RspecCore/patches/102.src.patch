diff --git a/features/Changelog.md b/features/Changelog.md
index b94ab8de..37382c83 100644
--- a/features/Changelog.md
+++ b/features/Changelog.md
@@ -15,6 +15,8 @@
   * don't stumble over an exception without a message (Hans Hasselberg)
   * remove non-ascii characters from comments that were choking rcov (Geoffrey
     Byers)
+  * fixed backtrace so it doesn't include lines from before the autorun at_exit
+    hook (Myron Marston)
 
 ### 2.5.1 / 2011-02-06
 
diff --git a/features/formatters/text_formatter.feature b/features/formatters/text_formatter.feature
new file mode 100644
index 00000000..a34e9fdd
--- /dev/null
+++ b/features/formatters/text_formatter.feature
@@ -0,0 +1,45 @@
+Feature: text formatter
+
+  In order to easily see the result of running my specs
+  As an RSpec user
+  I want clear, concise, well-formatted output
+
+  Scenario: Backtrace formatting for failing specs in multiple files
+    Given a file named "string_spec.rb" with:
+      """
+      require 'rspec/core'
+
+      describe String do
+        it "has a failing example" do
+          "foo".reverse.should == "ofo"
+        end
+      end
+      """
+    And a file named "integer_spec.rb" with:
+      """
+      require 'rspec/core'
+
+      describe Integer do
+        it "has a failing example" do
+          (7 + 5).should == 11
+        end
+      end
+      """
+    When I run "ruby ./integer_spec.rb ./string_spec.rb"
+    Then the backtrace-normalized output should contain:
+      """
+      Failures:
+
+        1) Integer has a failing example
+           Failure/Error: (7 + 5).should == 11
+             expected: 11
+                  got: 12 (using ==)
+           # ./integer_spec.rb:5
+
+        2) String has a failing example
+           Failure/Error: "foo".reverse.should == "ofo"
+             expected: "ofo"
+                  got: "oof" (using ==)
+           # ./string_spec.rb:5
+      """
+
diff --git a/features/step_definitions/additional_cli_steps.rb b/features/step_definitions/additional_cli_steps.rb
index 51e1e6a4..ddf0e38b 100644
--- a/features/step_definitions/additional_cli_steps.rb
+++ b/features/step_definitions/additional_cli_steps.rb
@@ -18,3 +18,13 @@ end
 Then /^the file "([^"]*)" should contain:$/ do |file, partial_content|
   check_file_content(file, partial_content, true)
 end
+
+Then /^the backtrace\-normalized output should contain:$/ do |partial_output|
+  # ruby 1.9 includes additional stuff in the backtrace,
+  # so we need to normalize it to compare it with our expected output.
+  normalized_output = combined_output.split("\n").map do |line|
+    line =~ /(^\s+# [^:]+:\d+)/ ? $1 : line # http://rubular.com/r/zDD7DdWyzF
+  end.join("\n")
+
+  normalized_output.should =~ compile_and_escape(partial_output)
+end
diff --git a/lib/rspec/core/formatters/base_formatter.rb b/lib/rspec/core/formatters/base_formatter.rb
index 497a4a62..410a3387 100644
--- a/lib/rspec/core/formatters/base_formatter.rb
+++ b/lib/rspec/core/formatters/base_formatter.rb
@@ -95,6 +95,11 @@ module RSpec
         def format_backtrace(backtrace, example)
           return "" unless backtrace
           return backtrace if example.metadata[:full_backtrace] == true
+
+          if at_exit_index = backtrace.index(RSpec::Core::Runner::AT_EXIT_HOOK_BACKTRACE_LINE)
+            backtrace = backtrace[0, at_exit_index]
+          end
+
           cleansed = backtrace.map { |line| backtrace_line(line) }.compact
           cleansed.empty? ? backtrace : cleansed
         end
diff --git a/lib/rspec/core/runner.rb b/lib/rspec/core/runner.rb
index dc54debf..860d2d67 100644
--- a/lib/rspec/core/runner.rb
+++ b/lib/rspec/core/runner.rb
@@ -9,6 +9,7 @@ module RSpec
         @installed_at_exit = true
         at_exit { run(ARGV, $stderr, $stdout) ? exit(0) : exit(1) }
       end
+      AT_EXIT_HOOK_BACKTRACE_LINE = "#{__FILE__}:#{__LINE__ - 2}:in `autorun'"
 
       def self.autorun_disabled?
         @autorun_disabled ||= false
diff --git a/spec/rspec/core/formatters/base_formatter_spec.rb b/spec/rspec/core/formatters/base_formatter_spec.rb
index 56b39430..de5f6478 100644
--- a/spec/rspec/core/formatters/base_formatter_spec.rb
+++ b/spec/rspec/core/formatters/base_formatter_spec.rb
@@ -56,4 +56,24 @@ describe RSpec::Core::Formatters::BaseFormatter do
     end
   end
 
+  describe "#format_backtrace" do
+    let(:rspec_expectations_dir) { "/path/to/rspec-expectations/lib" }
+    let(:rspec_core_dir) { "/path/to/rspec-core/lib" }
+    let(:backtrace) do
+      [
+        "#{rspec_expectations_dir}/rspec/matchers/operator_matcher.rb:51:in `eval_match'",
+        "#{rspec_expectations_dir}/rspec/matchers/operator_matcher.rb:29:in `=='",
+        "./my_spec.rb:5",
+        "#{rspec_core_dir}/rspec/core/example.rb:52:in `run'",
+        "#{rspec_core_dir}/rspec/core/runner.rb:37:in `run'",
+        RSpec::Core::Runner::AT_EXIT_HOOK_BACKTRACE_LINE,
+        "./my_spec.rb:3"
+      ]
+    end
+
+    it "removes lines from rspec and lines that come before the invocation of the at_exit autorun hook" do
+      formatter.format_backtrace(backtrace, stub.as_null_object).should == ["./my_spec.rb:5"]
+    end
+  end
+
 end
