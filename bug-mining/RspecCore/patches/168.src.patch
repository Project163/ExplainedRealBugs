diff --git a/lib/rspec/core/configuration.rb b/lib/rspec/core/configuration.rb
index 648355c7..791ce4cc 100644
--- a/lib/rspec/core/configuration.rb
+++ b/lib/rspec/core/configuration.rb
@@ -405,8 +405,11 @@ MESSAGE
         @backtrace_clean_patterns = true_or_false ? [] : DEFAULT_BACKTRACE_PATTERNS
       end
 
-      def color
-        return false unless output_to_tty?
+      def color(output=output_stream)
+        # rspec's built-in formatters all call this with the output argument,
+        # but defaulting to output_stream for backward compatibility with
+        # formatters in extension libs
+        return false unless output_to_tty?(output)
         value_for(:color, @color)
       end
 
@@ -929,12 +932,8 @@ MESSAGE
         end
       end
 
-      def output_to_tty?
-        begin
-          output_stream.tty? || tty?
-        rescue NoMethodError
-          false
-        end
+      def output_to_tty?(output=output_stream)
+        tty? || (output.respond_to?(:tty?) && output.tty?)
       end
 
       def built_in_formatter(key)
diff --git a/lib/rspec/core/formatters/base_formatter.rb b/lib/rspec/core/formatters/base_formatter.rb
index e1a9e37c..4fadbd46 100644
--- a/lib/rspec/core/formatters/base_formatter.rb
+++ b/lib/rspec/core/formatters/base_formatter.rb
@@ -181,11 +181,9 @@ module RSpec
         end
 
         def color_enabled?
-          configuration.color_enabled?
+          configuration.color_enabled?(output)
         end
-
       end
-
     end
   end
 end
diff --git a/spec/rspec/core/configuration_spec.rb b/spec/rspec/core/configuration_spec.rb
index 5e0407ce..23f08b94 100644
--- a/spec/rspec/core/configuration_spec.rb
+++ b/spec/rspec/core/configuration_spec.rb
@@ -533,33 +533,57 @@ module RSpec::Core
     %w[color color_enabled].each do |color_option|
       describe "##{color_option}=" do
         context "given true" do
-          context "with non-tty output and no autotest" do
+          before { config.send "#{color_option}=", true }
+
+          context "with config.tty? and output.tty?" do
             it "does not set color_enabled" do
-              config.output_stream = StringIO.new
-              config.output_stream.stub(:tty?) { false }
-              config.tty = false
-              config.send "#{color_option}=", true
-              config.send(color_option).should be_false
+              output = StringIO.new
+              config.output_stream = output
+
+              config.tty = true
+              config.output_stream.stub :tty? => true
+
+              config.send(color_option).should be_true
+              config.send(color_option, output).should be_true
+            end
+          end
+
+          context "with config.tty? and !output.tty?" do
+            it "sets color_enabled" do
+              output = StringIO.new
+              config.output_stream = output
+
+              config.tty = true
+              config.output_stream.stub :tty? => false
+
+              config.send(color_option).should be_true
+              config.send(color_option, output).should be_true
             end
           end
 
-          context "with tty output" do
+          context "with config.tty? and !output.tty?" do
             it "does not set color_enabled" do
-              config.output_stream = StringIO.new
-              config.output_stream.stub(:tty?) { true }
+              output = StringIO.new
+              config.output_stream = output
+
               config.tty = false
-              config.send "#{color_option}=", true
+              config.output_stream.stub :tty? => true
+
               config.send(color_option).should be_true
+              config.send(color_option, output).should be_true
             end
           end
 
-          context "with tty set" do
+          context "with !config.tty? and !output.tty?" do
             it "does not set color_enabled" do
-              config.output_stream = StringIO.new
-              config.output_stream.stub(:tty?) { false }
-              config.tty = true
-              config.send "#{color_option}=", true
-              config.send(color_option).should be_true
+              output = StringIO.new
+              config.output_stream = output
+
+              config.tty = false
+              config.output_stream.stub :tty? => false
+
+              config.send(color_option).should be_false
+              config.send(color_option, output).should be_false
             end
           end
 
@@ -580,7 +604,7 @@ module RSpec::Core
 
               it "enables colors" do
                 config.output_stream = StringIO.new
-                config.output_stream.stub(:tty?) { true }
+                config.output_stream.stub :tty? => true
                 config.send "#{color_option}=", true
                 config.send(color_option).should be_true
               end
