diff --git a/lib/rspec/core/configuration.rb b/lib/rspec/core/configuration.rb
index eaa1a7cb..10a03c12 100644
--- a/lib/rspec/core/configuration.rb
+++ b/lib/rspec/core/configuration.rb
@@ -197,18 +197,20 @@ EOM
       alias_method :reporter, :formatter
 
       def files_or_directories_to_run=(*files)
-        self.files_to_run = files.flatten.inject([]) do |result, file|
+        self.files_to_run = files.flatten.collect do |file|
           if File.directory?(file)
-            filename_pattern.split(",").each do |pattern|
-              result += Dir["#{file}/#{pattern.strip}"]
+            filename_pattern.split(",").collect do |pattern|
+              Dir["#{file}/#{pattern.strip}"]
             end
           else
-            path, line_number = file.split(':')
-            self.line_number = line_number if line_number
-            result << path
+            if file =~ /(\:(\d+))$/
+              self.line_number = $2
+              file.sub($1,'')
+            else
+              file
+            end
           end
-          result
-        end
+        end.flatten
       end
 
       # E.g. alias_example_to :crazy_slow, :speed => 'crazy_slow' defines
diff --git a/spec/rspec/core/configuration_spec.rb b/spec/rspec/core/configuration_spec.rb
index 69ab7a90..0611cb4c 100644
--- a/spec/rspec/core/configuration_spec.rb
+++ b/spec/rspec/core/configuration_spec.rb
@@ -40,7 +40,7 @@ module RSpec::Core
    
     context "setting the files to run" do
 
-      it "should load files not following pattern if named explicitly" do
+      it "loads files not following pattern if named explicitly" do
         file = "./spec/rspec/core/resources/a_bar.rb"
         config.files_or_directories_to_run = file
         config.files_to_run.should == [file]
@@ -48,12 +48,18 @@ module RSpec::Core
 
       describe "with default --pattern" do
 
-        it "should load files named _spec.rb" do
+        it "loads files named _spec.rb" do
           dir = "./spec/rspec/core/resources"
           config.files_or_directories_to_run = dir
           config.files_to_run.should == ["#{dir}/a_spec.rb"]
         end
 
+        it "loads files in Windows" do
+          file = "C:\\path\\to\\project\\spec\\sub\\foo_spec.rb"
+          config.files_or_directories_to_run = file
+          config.files_to_run.should == [file]
+        end
+
       end
 
       describe "with explicit pattern (single)" do
