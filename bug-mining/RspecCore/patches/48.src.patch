diff --git a/features/configuration/options_file.feature b/features/configuration/options_file.feature
index b8ae06d2..07028d3b 100644
--- a/features/configuration/options_file.feature
+++ b/features/configuration/options_file.feature
@@ -1,27 +1,21 @@
-Feature: spec/spec.opts
+Feature: options file
+  
+  To load in configuration options from a file, RSpec will look
+  for a ".rspec" file.
+  
+  There are two types of ".rspec" files: local and global. Local
+  exists in the project root directory, while global exists in
+  the system root directory (~). Examples:
+  
+    Local:  "~/path/to/project/.rspec"
+    Global: "~/.rspec"
 
-  For backwards compatibility with rspec-1, you can write command
-  line options in a spec/spec.opts file and it will be loaded
-  automatically.
-
-  Options declared in spec/spec.opts will override configuration
-  set up in RSpec.configure blocks.
-
-  Scenario: color set in RSpec.configure
-    Given a file named "spec/example_spec.rb" with:
-      """
-      RSpec.configure {|c| c.color_enabled = true }
-
-      describe "color_enabled" do
-        context "when set with RSpec.configure" do
-          it "is true" do
-            RSpec.configuration.color_enabled?.should be_true
-          end
-        end
-      end
-      """
-    When I run "rspec ./spec/example_spec.rb"
-    Then the output should contain "1 example, 0 failures"
+  The local file will override the global file, while options
+  declared in RSpec.configure will override any ".rspec" file.
+  
+  NOTE: For backwards compatibility with rspec-1, you can write
+  command line options in a "spec/spec.opts" file and it will be
+  loaded automatically.
             
   Scenario: color set in .rspec
     Given a file named ".rspec" with:
@@ -33,7 +27,7 @@ Feature: spec/spec.opts
       describe "color_enabled" do
         context "when set with RSpec.configure" do
           it "is true" do
-            RSpec.configuration.color_enabled?.should be_true
+            RSpec.configuration.should be_color_enabled
           end
         end
       end
@@ -41,7 +35,7 @@ Feature: spec/spec.opts
     When I run "rspec ./spec/example_spec.rb"
     Then the output should contain "1 example, 0 failures"
 
-  Scenario: formatter set in both (RSpec.configure wins)
+  Scenario: formatter set in RSpec.configure overrides .rspec
     Given a file named ".rspec" with:
       """
       --format progress
@@ -64,4 +58,19 @@ Feature: spec/spec.opts
       """
     When I run "rspec ./spec/example_spec.rb"
     Then the output should contain "1 example, 0 failures"
-
+    
+  Scenario: using ERB in .rspec
+    Given a file named ".rspec" with:
+      """
+      --format <%= true ? 'documentation' : 'progress' %>
+      """
+    And a file named "spec/example_spec.rb" with:
+      """
+      describe "formatter" do
+        it "is set to documentation" do
+          RSpec.configuration.formatter.should be_an(RSpec::Core::Formatters::DocumentationFormatter)
+        end
+      end
+      """
+    When I run "rspec ./spec/example_spec.rb"
+    Then the output should contain "1 example, 0 failures"
\ No newline at end of file
diff --git a/lib/rspec/core/configuration_options.rb b/lib/rspec/core/configuration_options.rb
index c94abcce..236140a7 100644
--- a/lib/rspec/core/configuration_options.rb
+++ b/lib/rspec/core/configuration_options.rb
@@ -77,10 +77,15 @@ module RSpec
       def parse_options_file(path)
         Parser.parse(args_from_options_file(path))
       end
-
+      
       def args_from_options_file(path)
         return [] unless File.exist?(path)
-        File.readlines(path).map {|l| l.split}.flatten
+        config_string = options_file_as_erb_string(path)
+        config_string.split(/\n+/).map {|l| l.split}.flatten
+      end
+      
+      def options_file_as_erb_string(path)
+        ERB.new(IO.read(path)).result(binding)
       end
 
       def local_options_file(options)
diff --git a/spec/rspec/core/configuration_options_spec.rb b/spec/rspec/core/configuration_options_spec.rb
index cf0280b6..7b1e7ef5 100644
--- a/spec/rspec/core/configuration_options_spec.rb
+++ b/spec/rspec/core/configuration_options_spec.rb
@@ -159,14 +159,14 @@ describe RSpec::Core::ConfigurationOptions do
 
       it "turns off the debugger option if --drb is specified in the options file" do
         File.stub(:exist?) { true }
-        File.stub(:readlines) { %w[ --drb  ] }
+        IO.stub(:read) { "--drb" }
         config_options_object("--debug").drb_argv.should_not include("--debug")
         config_options_object("-d"     ).drb_argv.should_not include("--debug")
       end
 
       it "turns off the debugger option if --debug is specified in the options file" do
         File.stub(:exist?) { true }
-        File.stub(:readlines) { %w[ --debug  ] }
+        IO.stub(:read) { "--debug" }
         config_options_object("--drb").drb_argv.should_not include("--debug")
         config_options_object("-X"   ).drb_argv.should_not include("--debug")
       end
@@ -197,7 +197,7 @@ describe RSpec::Core::ConfigurationOptions do
     context "--drb specified in the options file" do
       it "renders all the original arguments except --drb" do
         File.stub(:exist?) { true }
-        File.stub(:readlines) { %w[ --drb --color ] }
+        IO.stub(:read) { "--drb --color" }
         config_options_object(*%w[ --format s --line_number 1 --example pattern --profile --backtrace ]).
           drb_argv.should eq(%w[ --color --profile --backtrace --format s --line_number 1 --example pattern ])
       end
@@ -206,7 +206,7 @@ describe RSpec::Core::ConfigurationOptions do
     context "--drb specified in ARGV and the options file" do
       it "renders all the original arguments except --drb" do
         File.stub(:exist?) { true }
-        File.stub(:readlines) { %w[ --drb --color ] }
+        IO.stub(:read) { "--drb --color" }
         config_options_object(*%w[ --drb --format s --line_number 1 --example pattern --profile --backtrace]).
           drb_argv.should eq(%w[ --color --profile --backtrace --format s --line_number 1 --example pattern ])
       end
@@ -215,7 +215,7 @@ describe RSpec::Core::ConfigurationOptions do
     context "--drb specified in ARGV and in as ARGV-specified --options file" do
       it "renders all the original arguments except --drb and --options" do
         File.stub(:exist?) { true }
-        File.stub(:readlines) { %w[ --drb --color ] }
+        IO.stub(:read) { "--drb --color" }
         config_options_object(*%w[ --drb --format s --line_number 1 --example pattern --profile --backtrace]).
           drb_argv.should eq(%w[ --color --profile --backtrace --format s --line_number 1 --example pattern ])
       end
@@ -227,17 +227,7 @@ describe RSpec::Core::ConfigurationOptions do
 
     it "loads automatically" do
       File.stub(:exist?) { true }
-      File.stub(:readlines) { ["--format", "doc"] }
-
-      config_options = RSpec::Core::ConfigurationOptions.new([])
-      config_options.parse_options
-      config_options.configure(config)
-      config.formatter.should == 'doc'
-    end
-
-    it "allows options on one line" do
-      File.stub(:exist?) { true }
-      File.stub(:readlines) { ["--format doc"] }
+      IO.stub(:read) { "--format doc" }
 
       config_options = RSpec::Core::ConfigurationOptions.new([])
       config_options.parse_options
@@ -247,12 +237,12 @@ describe RSpec::Core::ConfigurationOptions do
 
     it "merges options from the global and local .rspec and the command line" do
       File.stub(:exist?){ true }
-      File.stub(:readlines) do |path|
+      IO.stub(:read) do |path|
         case path
         when ".rspec"
-          ["--format", "documentation"]
+          "--format documentation"
         when /\.rspec/
-          ["--line", "37"]
+          "--line 37"
         else
           raise "Unexpected path: #{path}"
         end
@@ -269,12 +259,12 @@ describe RSpec::Core::ConfigurationOptions do
 
     it "prefers local options over global" do
       File.stub(:exist?){ true }
-      File.stub(:readlines) do |path|
+      IO.stub(:read) do |path|
         case path
         when ".rspec"
-          ["--format", "local"]
+          "--format local"
         when /\.rspec/
-          ["--format", "global"]
+          "--format global"
         else
           raise "Unexpected path: #{path}"
         end
