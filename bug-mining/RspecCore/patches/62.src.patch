diff --git a/lib/rspec/core/command_line.rb b/lib/rspec/core/command_line.rb
index c1ec6872..3844fdbb 100644
--- a/lib/rspec/core/command_line.rb
+++ b/lib/rspec/core/command_line.rb
@@ -12,9 +12,9 @@ module RSpec
       end
 
       def run(err, out)
-        @options.configure(@configuration)
         @configuration.error_stream = err
         @configuration.output_stream ||= out
+        @options.configure(@configuration)
         @configuration.load_spec_files
         @configuration.configure_mock_framework
         @world.announce_inclusion_filter
diff --git a/lib/rspec/core/configuration.rb b/lib/rspec/core/configuration.rb
index af7dda55..1fc41a09 100644
--- a/lib/rspec/core/configuration.rb
+++ b/lib/rspec/core/configuration.rb
@@ -136,11 +136,11 @@ module RSpec
         settings[:color_enabled] = true
         if bool && ::RbConfig::CONFIG['host_os'] =~ /mswin|mingw/
           using_stdout = settings[:output_stream] == $stdout
-          using_stderr = settings[:error_stream] == $stderr
+          using_stderr = settings[:error_stream]  == $stderr
           begin
             require 'Win32/Console/ANSI'
             settings[:output_stream] = $stdout if using_stdout
-            settings[:error_stream] = $stderr if using_stderr
+            settings[:error_stream]  = $stderr if using_stderr
           rescue LoadError
             warn "You must 'gem install win32console' to use colour on Windows"
             settings[:color_enabled] = false
diff --git a/spec/rspec/core/command_line_spec.rb b/spec/rspec/core/command_line_spec.rb
index 0a421d92..14af5313 100644
--- a/spec/rspec/core/command_line_spec.rb
+++ b/spec/rspec/core/command_line_spec.rb
@@ -39,20 +39,29 @@ module RSpec::Core
         RSpec::Core::Configuration.new
       end
 
+      let(:err) { ::StringIO.new }
       let(:out) { ::StringIO.new }
 
       before do
         config.stub(:run_hook)
       end
 
+      it "configures streams before command line options" do
+        # this is necessary to ensure that color works correctly on windows
+        config.should_receive(:error_stream=).ordered
+        config.should_receive(:output_stream=).ordered
+        config.should_receive(:color_enabled=).ordered
+        command_line.run(err, out) rescue nil
+      end
+
       it "runs before suite hooks" do
         config.should_receive(:run_hook).with(:before, :suite)
-        command_line.run(out, out)
+        command_line.run(err, out)
       end
 
       it "runs after suite hooks" do
         config.should_receive(:run_hook).with(:after, :suite)
-        command_line.run(out, out)
+        command_line.run(err, out)
       end
 
       it "runs after suite hooks even after an error" do
@@ -66,10 +75,11 @@ module RSpec::Core
           end
         end
         expect do
-          command_line.run(out, out)
+          command_line.run(err, out)
         end.to raise_error
         after_suite_called.should be_true
       end
+
     end
 
     describe "#run with custom output" do
