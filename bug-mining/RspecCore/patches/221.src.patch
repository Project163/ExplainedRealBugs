diff --git a/Changelog.md b/Changelog.md
index 76ce98d7..37bfba9d 100644
--- a/Changelog.md
+++ b/Changelog.md
@@ -5,6 +5,9 @@ Bug Fixes:
 
 * Fix `BaseTextFormatter` so that it does not re-close a closed output
   stream. (Myron Marston)
+* Fix regression in metadata that caused the metadata hash of a top-level
+  example group to have a `:parent_example_group` key even though it has
+  no parent example group. (Myron Marston)
 
 Enhancements:
 
diff --git a/lib/rspec/core/example_group.rb b/lib/rspec/core/example_group.rb
index 46e6278d..bc960662 100644
--- a/lib/rspec/core/example_group.rb
+++ b/lib/rspec/core/example_group.rb
@@ -355,7 +355,7 @@ module RSpec
         args.unshift(description)
 
         @metadata = Metadata::ExampleGroupHash.create(
-          superclass_metadata || {}, user_metadata, *args, &example_group_block
+          superclass_metadata, user_metadata, *args, &example_group_block
         )
 
         hooks.register_globals(self, RSpec.configuration.hooks)
diff --git a/lib/rspec/core/metadata.rb b/lib/rspec/core/metadata.rb
index 9d7be320..f9d15d32 100644
--- a/lib/rspec/core/metadata.rb
+++ b/lib/rspec/core/metadata.rb
@@ -181,8 +181,11 @@ module RSpec
       class ExampleGroupHash < HashPopulator
         def self.create(parent_group_metadata, user_metadata, *args, &block)
           group_metadata = hash_with_backwards_compatibility_default_proc
-          group_metadata.update(parent_group_metadata)
-          group_metadata[:parent_example_group] = parent_group_metadata
+
+          if parent_group_metadata
+            group_metadata.update(parent_group_metadata)
+            group_metadata[:parent_example_group] = parent_group_metadata
+          end
 
           hash = new(group_metadata, user_metadata, args, block)
           hash.populate
@@ -201,7 +204,8 @@ module RSpec
                               :replacement => "the example group's hash directly for the " +
                               "computed keys and `:parent_example_group` to access the parent " +
                               "example group metadata")
-              LegacyExampleGroupHash.new(example_group_selector.call(hash))
+              group_hash = example_group_selector.call(hash)
+              LegacyExampleGroupHash.new(group_hash) if group_hash
             when :example_group_block
               RSpec.deprecate("`metadata[:example_group_block]`",
                               :replacement => "`metadata[:block]`")
@@ -226,10 +230,9 @@ module RSpec
         def full_description
           description          = metadata[:description]
           parent_example_group = metadata[:parent_example_group]
-          parent_description   = parent_example_group[:full_description]
-
-          return description unless parent_description
+          return description unless parent_example_group
 
+          parent_description   = parent_example_group[:full_description]
           separator = description_separator(parent_example_group[:description_args].last,
                                             metadata[:description_args].first)
 
diff --git a/lib/rspec/core/metadata_filter.rb b/lib/rspec/core/metadata_filter.rb
index 74f8c901..4c4a96e2 100644
--- a/lib/rspec/core/metadata_filter.rb
+++ b/lib/rspec/core/metadata_filter.rb
@@ -75,10 +75,10 @@ module RSpec
       end
 
       def parent_of(metadata)
-        if metadata.has_key?(:parent_example_group)
-          metadata[:parent_example_group]
-        else
+        if metadata.key?(:example_group)
           metadata[:example_group]
+        else
+          metadata[:parent_example_group]
         end
       end
     end
diff --git a/spec/rspec/core/metadata_spec.rb b/spec/rspec/core/metadata_spec.rb
index 6c884c8d..7d433257 100644
--- a/spec/rspec/core/metadata_spec.rb
+++ b/spec/rspec/core/metadata_spec.rb
@@ -435,6 +435,11 @@ module RSpec
         end
       end
 
+      it 'does not have a `:parent_example_group` key for a top level group' do
+        meta = RSpec.describe(Object).metadata
+        expect(meta).not_to include(:parent_example_group)
+      end
+
       describe "backwards compatibility" do
         before { allow_deprecation }
 
@@ -496,9 +501,7 @@ module RSpec
 
             expect(inner_metadata[:description]).to eq("Level 2")
             expect(inner_metadata[:example_group][:description]).to eq("Level 1")
-
-            # On 2.99 this was nil, but I haven't found a way to achieve that behavior, so this is close enough...
-            expect(inner_metadata[:example_group][:example_group].to_h).to eq({})
+            expect(inner_metadata[:example_group][:example_group]).to be_nil
           end
 
           it 'allows integration libraries like VCR to infer a fixture name from the example description by walking up nesting structure' do
@@ -524,8 +527,7 @@ module RSpec
 
             raise ex.execution_result.exception if ex.execution_result.exception
 
-            # On 2.x this returns "Group/ex", no leading slash, but this is close enough...
-            expect(inferred_fixture_name).to eq("/Group/ex")
+            expect(inferred_fixture_name).to eq("Group/ex")
           end
 
           it 'can mutate attributes when accessing them via [:example_group]' do
