<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:02:43 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[TIKA-2934] OOXML parser fails to parse XLSX files with missing cellRef properties</title>
                <link>https://issues.apache.org/jira/browse/TIKA-2934</link>
                <project id="12310631" key="TIKA">Tika</project>
                    <description>&lt;p&gt;A NullPointerException is thrown when parsing xlsx documents that don&#8217;t have CellRef property:&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Caused by: java.lang.NullPointerException: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
    at org.apache.poi.util.StringUtil.endsWithIgnoreCase(StringUtil.java:317)
    at org.apache.poi.ss.util.CellReference.&amp;lt;init&amp;gt;(CellReference.java:109)
    at org.apache.tika.parser.microsoft.ooxml.XSSFExcelExtractorDecorator$SheetTextAsHTML.cell(XSSFExcelExtractorDecorator.java:452)
    at org.apache.poi.xssf.eventusermodel.XSSFSheetXMLHandler.endElement(XSSFSheetXMLHandler.java:379)
    at org.apache.tika.parser.microsoft.ooxml.XSSFExcelExtractorDecorator$XSSFSheetInterestingPartsCapturer.endElement(XSSFExcelExtractorDecorator.java:553)
    at org.apache.xerces.parsers.AbstractSAXParser.endElement(Unknown Source)
    at org.apache.xerces.impl.XMLNSDocumentScannerImpl.scanEndElement(Unknown Source)
    at org.apache.xerces.impl.XMLDocumentFragmentScannerImpl$FragmentContentDispatcher.dispatch(Unknown Source)
    at org.apache.xerces.impl.XMLDocumentFragmentScannerImpl.scanDocument(Unknown Source)
    at org.apache.xerces.parsers.XML11Configuration.parse(Unknown Source)
    at org.apache.xerces.parsers.XML11Configuration.parse(Unknown Source)
    at org.apache.xerces.parsers.XMLParser.parse(Unknown Source)
    at org.apache.xerces.parsers.AbstractSAXParser.parse(Unknown Source)
    at org.apache.xerces.jaxp.SAXParserImpl$JAXPSAXParser.parse(Unknown Source)
    at org.apache.xerces.jaxp.SAXParserImpl.parse(Unknown Source)
    at javax.xml.parsers.SAXParser.parse(SAXParser.java:195)
    at org.apache.tika.utils.XMLReaderUtils.parseSAX(XMLReaderUtils.java:452)
    at org.apache.tika.parser.microsoft.ooxml.XSSFExcelExtractorDecorator.processSheet(XSSFExcelExtractorDecorator.java:352)
    at org.apache.tika.parser.microsoft.ooxml.XSSFExcelExtractorDecorator.buildXHTML(XSSFExcelExtractorDecorator.java:168)
    at org.apache.tika.parser.microsoft.ooxml.AbstractOOXMLExtractor.getXHTML(AbstractOOXMLExtractor.java:136)
    at org.apache.tika.parser.microsoft.ooxml.XSSFExcelExtractorDecorator.getXHTML(XSSFExcelExtractorDecorator.java:122)
    at org.apache.tika.parser.microsoft.ooxml.OOXMLExtractorFactory.parse(OOXMLExtractorFactory.java:201)
    at org.apache.tika.parser.microsoft.ooxml.OOXMLParser.parse(OOXMLParser.java:110)
    at org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:280)

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;According to latest OOXML standard ECMA-376 5th edition Part 1 (released on December 2016), Cell Reference (18.18.7, ST_CellRef) property on a Cell (18.3.1.4, CT_Cell) is optional.&#160;&lt;/p&gt;

&lt;p&gt;Actually, we believe an abandoned pull request was supposed to fix this issue and it wasn&#8217;t merged eventually: &lt;a href=&quot;https://github.com/apache/tika/pull/214/commits/d79aa3baf33d4f859e4daa8ef251721f3ac2a198.&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/pull/214/commits/d79aa3baf33d4f859e4daa8ef251721f3ac2a198.&lt;/a&gt;&#160;Look at the safety block commented with:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-comment&quot;&gt;// gracefully handle missing CellRef here in a similar way as XSSFCell does&lt;/span&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13254663">TIKA-2934</key>
            <summary>OOXML parser fails to parse XLSX files with missing cellRef properties</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="yahavamsi">Yahav Amsalem</reporter>
                        <labels>
                    </labels>
                <created>Wed, 4 Sep 2019 09:22:33 +0000</created>
                <updated>Wed, 23 Oct 2019 19:32:16 +0000</updated>
                            <resolved>Wed, 23 Oct 2019 17:45:26 +0000</resolved>
                                    <version>1.22</version>
                                    <fixVersion>1.23</fixVersion>
                                    <component>parser</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="16922591" author="tallison@mitre.org" created="Wed, 4 Sep 2019 15:10:34 +0000"  >&lt;p&gt;Thank you for opening this issue.  Would you be able to share a triggering file with us?&lt;/p&gt;</comment>
                            <comment id="16925750" author="yahavamsi" created="Mon, 9 Sep 2019 14:48:50 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tallison%40apache.org&quot; class=&quot;user-hover&quot; rel=&quot;tallison@apache.org&quot;&gt;tallison@apache.org&lt;/a&gt;&#160;- I have uploaded a sample file which should trigger the bug.&lt;/p&gt;</comment>
                            <comment id="16957856" author="yahavamsi" created="Wed, 23 Oct 2019 13:04:15 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tallison&quot; class=&quot;user-hover&quot; rel=&quot;tallison&quot;&gt;tallison&lt;/a&gt;&#160;- Did you get to reproduce this issue?&lt;/p&gt;</comment>
                            <comment id="16958071" author="tallison@mitre.org" created="Wed, 23 Oct 2019 17:45:11 +0000"  >&lt;p&gt;Fixed now.  Thank you for raising the issue and pinging me.&lt;/p&gt;</comment>
                            <comment id="16958176" author="hudson" created="Wed, 23 Oct 2019 19:17:45 +0000"  >&lt;p&gt;FAILURE: Integrated in Jenkins build Tika-trunk #1720 (See &lt;a href=&quot;https://builds.apache.org/job/Tika-trunk/1720/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Tika-trunk/1720/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2934&quot; title=&quot;OOXML parser fails to parse XLSX files with missing cellRef properties&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2934&quot;&gt;&lt;del&gt;TIKA-2934&lt;/del&gt;&lt;/a&gt; &amp;#8211; gracefully handel null cellref (tallison: &lt;a href=&quot;https://github.com/apache/tika/commit/182566114e368ed068ffd9707d77a37ff545efab&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/182566114e368ed068ffd9707d77a37ff545efab&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/microsoft/ooxml/XSSFExcelExtractorDecorator.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="16958188" author="hudson" created="Wed, 23 Oct 2019 19:32:16 +0000"  >&lt;p&gt;SUCCESS: Integrated in Jenkins build tika-branch-1x #257 (See &lt;a href=&quot;https://builds.apache.org/job/tika-branch-1x/257/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/tika-branch-1x/257/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2934&quot; title=&quot;OOXML parser fails to parse XLSX files with missing cellRef properties&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2934&quot;&gt;&lt;del&gt;TIKA-2934&lt;/del&gt;&lt;/a&gt; &amp;#8211; gracefully handel null cellref (tallison: &lt;a href=&quot;https://github.com/apache/tika/commit/ce5b33799129debe2727a548b57f6e60ce06d8d1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/ce5b33799129debe2727a548b57f6e60ce06d8d1&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/microsoft/ooxml/XSSFExcelExtractorDecorator.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12979864" name="sample.xlsx" size="8352" author="yahavamsi" created="Mon, 9 Sep 2019 14:46:50 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 3 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z06b80:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>