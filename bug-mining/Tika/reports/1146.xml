<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:02:58 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[TIKA-3034] Detector always returns text/plain when scanning Mathematica files</title>
                <link>https://issues.apache.org/jira/browse/TIKA-3034</link>
                <project id="12310631" key="TIKA">Tika</project>
                    <description>&lt;p&gt;We are working with Tika to implement our mime types detection module. The library seemingly cannot detect Mathematica files although the documentation confirmed it does &lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;. The Tika detector always returns `text/plain` instead of `application/mathematica` as described in the documentation as well as unit tests &lt;span class=&quot;error&quot;&gt;&amp;#91;2&amp;#93;&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;By doing the same need with Python code as below, we can obtain the right mime types for any Mathematica file downloaded from the Wolfram Library Archive &lt;span class=&quot;error&quot;&gt;&amp;#91;3&amp;#93;&lt;/span&gt;.&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
#!/usr/bin/python3
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; mimetypes, os, sys
test_file = sys.argv[1]
print(mimetypes.MimeTypes().guess_type(test_file)[0])
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Therefore, we suspected there is a bug in Tika detector where it tries to guess mime types for Mathematica files.&lt;/p&gt;

&lt;p&gt;Also, there is an existing ticket asking for the implementation of Mathematica file detector. Here it is:&#160;&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1520&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/TIKA-1520&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;References:&lt;/p&gt;

&lt;p&gt;&#160;&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;&#160;&lt;a href=&quot;https://tika.apache.org/1.23/formats.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://tika.apache.org/1.23/formats.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;span class=&quot;error&quot;&gt;&amp;#91;2&amp;#93;&lt;/span&gt;&#160;&lt;a href=&quot;https://github.com/apache/tika/blob/master/tika-core/src/test/java/org/apache/tika/TikaDetectionTest.java#L64&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/blob/master/tika-core/src/test/java/org/apache/tika/TikaDetectionTest.java#L64&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;span class=&quot;error&quot;&gt;&amp;#91;3&amp;#93;&lt;/span&gt;&#160;&lt;a href=&quot;https://library.wolfram.com/infocenter/Courseware/4706/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://library.wolfram.com/infocenter/Courseware/4706/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13282636">TIKA-3034</key>
            <summary>Detector always returns text/plain when scanning Mathematica files</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="nvntung@gmail.com">Tung Nguyen</reporter>
                        <labels>
                            <label>math</label>
                    </labels>
                <created>Fri, 31 Jan 2020 14:56:14 +0000</created>
                <updated>Wed, 12 Feb 2020 15:56:30 +0000</updated>
                                            <version>1.23</version>
                                    <fixVersion>1.23</fixVersion>
                                    <component>detector</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="17027621" author="gagravarr" created="Fri, 31 Jan 2020 16:16:20 +0000"  >&lt;p&gt;Can you try and pass the filename along with the contents when you detect?&lt;/p&gt;

&lt;p&gt;Detection of text-based file formats is very tricky, as there is often very little that&apos;s unique to tell them apart. For Mathematica, we don&apos;t actually have any magic at all (some programming languages we do), so we need the filename to specialise the text/plain type.&lt;/p&gt;


&lt;p&gt;Without the code that you&apos;re using to call Tika, it&apos;s a bit tricky to know how to tell you to pass the filename in too! (It depends if you&apos;re using the App, the Server, Tika Facade class or Detector directly)&lt;/p&gt;


&lt;p&gt;Otherwise, if you do know of a unique bit of text that could be found near the top of a Mathematica file, but not of other text files, please let us know and we can add that in for more effective detection&lt;/p&gt;</comment>
                            <comment id="17027781" author="nvntung@gmail.com" created="Fri, 31 Jan 2020 19:47:38 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=nick&quot; class=&quot;user-hover&quot; rel=&quot;nick&quot;&gt;nick&lt;/a&gt;,&lt;/p&gt;

&lt;p&gt;Thank you for your swift reply.&lt;/p&gt;

&lt;p&gt;As I said in the issue description, we try Tika Detector with Mathematica files downloaded from this link&#160;&lt;a href=&quot;https://library.wolfram.com/infocenter/Courseware/4706/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://library.wolfram.com/infocenter/Courseware/4706/&lt;/a&gt;. The attachments downloaded from that link are examples.&lt;/p&gt;

&lt;p&gt;The first file is &lt;a href=&quot;https://library.wolfram.com/infocenter/Courseware/4706/ex16.nb?file_id=4246&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://library.wolfram.com/infocenter/Courseware/4706/ex16.nb?file_id=4246&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;The second file is&#160;&lt;a href=&quot;https://library.wolfram.com/infocenter/Courseware/4706/ex16.ma?file_id=4245&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://library.wolfram.com/infocenter/Courseware/4706/ex16.ma?file_id=4245&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17028898" author="mglont" created="Mon, 3 Feb 2020 12:27:44 +0000"  >&lt;p&gt;Hi Nick,&lt;/p&gt;

&lt;p&gt;We do specify the file name in the metadata instance we pass to the &lt;tt&gt;DefaultDetector&lt;/tt&gt;. The problem was that we were sending a plain InputStream to the detector rather than a TikaInputStream, which, according to &lt;a href=&quot;https://tika.apache.org/1.4/detection.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://tika.apache.org/1.4/detection.html&lt;/a&gt;, disables all but the MIME type checks&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;Because these container detectors needs to read the whole file to open and inspect the container, they must be used with a &lt;a href=&quot;https://tika.apache.org/1.4/api/org/apache/tika/io/TikaInputStream.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;org.apache.tika.io.TikaInputStream&lt;/a&gt;. If called with a regular &lt;tt&gt;InputStream&lt;/tt&gt;, then all work will be done by the default Mime Magic detection only.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;The fix in our case was to use &lt;a href=&quot;https://tika.apache.org/1.4/api/org/apache/tika/io/TikaInputStream.html#get(java.io.InputStream)&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;TikaInputStream.get&lt;/a&gt; to cast our input to a &lt;tt&gt;TikaInputStream.&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;Thanks for your help, this issue can now be closed.&lt;/p&gt;</comment>
                            <comment id="17029736" author="gagravarr" created="Tue, 4 Feb 2020 10:34:07 +0000"  >&lt;p&gt;Mathematica does have a fairly unusual start-of-comment structure, so I&apos;ve added some mime magic in &lt;tt&gt;f5571fa99&lt;/tt&gt; for that which would help if the file began with a comment. Will only help for some files though, so passing the filename in such that it can be used too is the &quot;best&quot; option overall&lt;/p&gt;</comment>
                            <comment id="17029796" author="hudson" created="Tue, 4 Feb 2020 12:05:39 +0000"  >&lt;p&gt;UNSTABLE: Integrated in Jenkins build Tika-trunk #1767 (See &lt;a href=&quot;https://builds.apache.org/job/Tika-trunk/1767/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Tika-trunk/1767/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-3034&quot; title=&quot;Detector always returns text/plain when scanning Mathematica files&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-3034&quot;&gt;TIKA-3034&lt;/a&gt; Mathematica files don&apos;t have a unique magic, but try to detect (nick: &lt;a href=&quot;https://github.com/apache/tika/commit/f5571fa99ef6f178a16bd1bd3a3cded83c7b0013&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/f5571fa99ef6f178a16bd1bd3a3cded83c7b0013&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) tika-core/src/main/resources/org/apache/tika/mime/tika-mimetypes.xml&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="17030665" author="mglont" created="Wed, 5 Feb 2020 13:51:58 +0000"  >&lt;p&gt;Hi Nick,&lt;/p&gt;

&lt;p&gt;Apologies for my earlier comment which was referring to other formats, but not Mathematica.&lt;/p&gt;

&lt;p&gt;Thanks for the change you pushed yesterday, I built a version of Tika containing it and I can now confirm that files which were previously detected as &lt;tt&gt;text/plain&lt;/tt&gt; are now &lt;tt&gt;application/mathematica&lt;/tt&gt;, which is great!&lt;/p&gt;

&lt;p&gt;Are there any plans to release this fix any time soon?&lt;/p&gt;

&lt;p&gt;Thanks again,&lt;br/&gt;
Mihai.&lt;/p&gt;</comment>
                            <comment id="17030686" author="gagravarr" created="Wed, 5 Feb 2020 14:12:47 +0000"  >&lt;p&gt;We tend to do 3ish releases a year. Last release was in December, so it&apos;s probably a month or two until there will be enough bug fixes / dependency upgrades / new features to convince our hard-working release manager &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tallison&quot; class=&quot;user-hover&quot; rel=&quot;tallison&quot;&gt;tallison&lt;/a&gt; to tackle it!&lt;/p&gt;

&lt;p&gt;In the mean time, if you put the latest tika mimetypes file on your classpath ahead of the Tika Core jar, it&apos;ll be used instead of the built-in one, avoiding the need to use a full nightly build while you wait&lt;/p&gt;</comment>
                            <comment id="17030701" author="tallison@mitre.org" created="Wed, 5 Feb 2020 14:43:32 +0000"  >&lt;p&gt;Y, let&apos;s discuss on dev list...three-ish weeks?&lt;/p&gt;</comment>
                            <comment id="17030749" author="nvntung@gmail.com" created="Wed, 5 Feb 2020 15:43:52 +0000"  >&lt;p&gt;I&apos;ve updated the ticket to add the others&apos; request&#160;&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1520&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/TIKA-1520&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Some also need a parser or detector for Mathematica files.&lt;/p&gt;</comment>
                            <comment id="17035473" author="hudson" created="Wed, 12 Feb 2020 15:56:30 +0000"  >&lt;p&gt;SUCCESS: Integrated in Jenkins build tika-branch-1x #303 (See &lt;a href=&quot;https://builds.apache.org/job/tika-branch-1x/303/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/tika-branch-1x/303/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-3034&quot; title=&quot;Detector always returns text/plain when scanning Mathematica files&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-3034&quot;&gt;TIKA-3034&lt;/a&gt; Mathematica files don&apos;t have a unique magic, but try to detect (tallison: &lt;a href=&quot;https://github.com/apache/tika/commit/5b88431a5135c9cf1ab00624a26d3f0fdec36a2b&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/5b88431a5135c9cf1ab00624a26d3f0fdec36a2b&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) tika-core/src/main/resources/org/apache/tika/mime/tika-mimetypes.xml&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 39 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0b1pc:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>