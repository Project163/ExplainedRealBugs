<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:01:20 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[TIKA-2475] discrepancy between CharsetDetector APIs</title>
                <link>https://issues.apache.org/jira/browse/TIKA-2475</link>
                <project id="12310631" key="TIKA">Tika</project>
                    <description>&lt;h3&gt;&lt;a name=&quot;Problem&quot;&gt;&lt;/a&gt;Problem&lt;/h3&gt;
&lt;p&gt;I ran into this trying to use CharsetDetector to detect charsets of attachments on emails when the mail client doesn&apos;t specify one. This used to work for us in tika 1.10, but in a recent upgrade to 1.14, behavior seems to have changed. I&apos;ve attached a sample file, whose charset is ISO-8859-1, and was detected as such with Tika 1.10. When we updated our tika dependency, we noticed that this sample data (a mix of English, Portuguese, and Spanish language) was getting output as a lot of junk Chinese characters. Upon inspection, it was determined that this was because our usage of the newer tika dep was detecting the file as UTF-16LE, instead of ISO-8859-1.&lt;/p&gt;

&lt;p&gt;I&apos;ve attached a sample file (multi-language.txt)&lt;/p&gt;

&lt;p&gt;Below is a Spock test that demonstrates the issue:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;    def &quot;test charset detection on multilingual file&quot;(){
        setup:
        def file = new File(&quot;src/test/resources/data/multi-language.txt&quot;)

        when: &quot;using the InputStream api&quot;
        def detector = new CharsetDetector()
        detector.setText(file.newInputStream())
        def fileCharSet = detector.detect()

        then: &quot;successfully detects the charset&quot;
        fileCharSet.name.startsWith(&quot;ISO&quot;)

        when: &quot;using the byte[] api, and munging the input&quot;
        detector = new CharsetDetector()
        detector.setText(file.newInputStream().bytes)
        detector.MungeInput()
        fileCharSet = detector.detect()

        then: &quot;sucessfully detects the charset&quot;
        fileCharSet.name.startsWith(&quot;ISO&quot;)

        when: &quot;using the byte[] api alone&quot;
        detector = new CharsetDetector()
        detector.setText(file.newInputStream().bytes)
        fileCharSet = detector.detect()

        then: &quot;this will fail - detects UTF-16LE instead&quot;
        fileCharSet.name.startsWith(&quot;ISO&quot;)
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;As is shown in the above test, I believe the issue is that the CharsetDetector&apos;s various &lt;tt&gt;setText()&lt;/tt&gt; functions do not delegate to one another, and in one the &lt;tt&gt;MungeInput()&lt;/tt&gt; function is called, and in the other it is not.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Mac OSX 10.12.6, Java 1.8.0_111&lt;/p&gt;</environment>
        <key id="13108398">TIKA-2475</key>
            <summary>discrepancy between CharsetDetector APIs</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="seanstory">Sean Story</reporter>
                        <labels>
                    </labels>
                <created>Tue, 10 Oct 2017 20:31:28 +0000</created>
                <updated>Wed, 11 Oct 2017 15:10:28 +0000</updated>
                            <resolved>Wed, 11 Oct 2017 13:21:38 +0000</resolved>
                                    <version>1.14</version>
                    <version>1.15</version>
                    <version>1.16</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="16199367" author="githubbot" created="Tue, 10 Oct 2017 21:14:01 +0000"  >&lt;p&gt;seanstory opened a new pull request #210: fix for &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2475&quot; title=&quot;discrepancy between CharsetDetector APIs&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2475&quot;&gt;&lt;del&gt;TIKA-2475&lt;/del&gt;&lt;/a&gt; contributed by seanstory&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/tika/pull/210&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/pull/210&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16200255" author="githubbot" created="Wed, 11 Oct 2017 13:19:07 +0000"  >&lt;p&gt;tballison closed pull request #210: fix for &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2475&quot; title=&quot;discrepancy between CharsetDetector APIs&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2475&quot;&gt;&lt;del&gt;TIKA-2475&lt;/del&gt;&lt;/a&gt; contributed by seanstory&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/tika/pull/210&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/pull/210&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16200256" author="githubbot" created="Wed, 11 Oct 2017 13:19:48 +0000"  >&lt;p&gt;tballison commented on issue #210: fix for &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2475&quot; title=&quot;discrepancy between CharsetDetector APIs&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2475&quot;&gt;&lt;del&gt;TIKA-2475&lt;/del&gt;&lt;/a&gt; contributed by seanstory&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/tika/pull/210#issuecomment-335806695&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/pull/210#issuecomment-335806695&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   Thank you, @seanstory!&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16200263" author="tallison@mitre.org" created="Wed, 11 Oct 2017 13:21:38 +0000"  >&lt;p&gt;Thank you!  &lt;/p&gt;

&lt;p&gt;Note: If you want to be the second person in the world to try tika-eval, you can easily identify diffs in output between different versions of Tika.  See: &lt;a href=&quot;https://wiki.apache.org/tika/TikaEval&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://wiki.apache.org/tika/TikaEval&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16200426" author="hudson" created="Wed, 11 Oct 2017 15:10:28 +0000"  >&lt;p&gt;FAILURE: Integrated in Jenkins build Tika-trunk #1378 (See &lt;a href=&quot;https://builds.apache.org/job/Tika-trunk/1378/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Tika-trunk/1378/&lt;/a&gt;)&lt;br/&gt;
fix for &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2475&quot; title=&quot;discrepancy between CharsetDetector APIs&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2475&quot;&gt;&lt;del&gt;TIKA-2475&lt;/del&gt;&lt;/a&gt; contributed by seanstory (sean.story: &lt;a href=&quot;https://github.com/apache/tika/commit/1f38be359b2735de94e9ae5850a3622e5393f77b&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/1f38be359b2735de94e9ae5850a3622e5393f77b&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) tika-parsers/src/test/java/org/apache/tika/parser/txt/CharsetDetectorTest.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/txt/CharsetDetector.java&lt;/li&gt;
	&lt;li&gt;(add) tika-parsers/src/test/resources/test-documents/multi-language.txt&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2475&quot; title=&quot;discrepancy between CharsetDetector APIs&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2475&quot;&gt;&lt;del&gt;TIKA-2475&lt;/del&gt;&lt;/a&gt; mods and some new tests/cleanup for CharsetDetector. This (tallison: &lt;a href=&quot;https://github.com/apache/tika/commit/94850f2e7c7d3df6a06a924fc6d643c0f6181643&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/94850f2e7c7d3df6a06a924fc6d643c0f6181643&lt;/a&gt;)&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/test/java/org/apache/tika/parser/txt/CharsetDetectorTest.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/txt/CharsetDetector.java&lt;/li&gt;
	&lt;li&gt;(edit) CHANGES.txt&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12891338" name="multi-language.txt" size="1631" author="seanstory" created="Tue, 10 Oct 2017 20:32:00 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 5 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3l3n3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>