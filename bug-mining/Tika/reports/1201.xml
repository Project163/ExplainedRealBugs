<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:03:22 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[TIKA-3332] Embedded files not extracted from PDF files with multilevel EmbeddedFiles tree</title>
                <link>https://issues.apache.org/jira/browse/TIKA-3332</link>
                <project id="12310631" key="TIKA">Tika</project>
                    <description>&lt;p&gt;I have come across some portfolio PDFs that have many attachments / embedded files, but Tika is not detecting or extracting them as it does with some other portfolio PDFs. The issue may be that these files have a multilevel EmbeddedFiles name tree that is not being handled properly by PDFBox.&lt;/p&gt;


&lt;p&gt;Here is the EmbeddedFiles structure of one of the PDF portfolios in question. Notice that the root EmbeddedFiles dictionary has a Kids array that only consists of intermediate dictionaries, with the actual Names array being one more level down.&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/13022722/13022722_image-2021-03-20-13-36-48-525.png&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13366522">TIKA-3332</key>
            <summary>Embedded files not extracted from PDF files with multilevel EmbeddedFiles tree</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="rossj">Ross Johnson</reporter>
                        <labels>
                    </labels>
                <created>Sat, 20 Mar 2021 17:41:28 +0000</created>
                <updated>Wed, 20 Oct 2021 14:45:18 +0000</updated>
                            <resolved>Mon, 22 Mar 2021 19:25:26 +0000</resolved>
                                    <version>1.25</version>
                                    <fixVersion>1.26</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="17305547" author="tilman" created="Sat, 20 Mar 2021 18:56:31 +0000"  >&lt;p&gt;The ExtractEmbeddedFiles.java example code in PDFBox is flawed because it extracts only one level. The Tika code is aware of this flaw because there is a comment&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
        &lt;span class=&quot;code-comment&quot;&gt;//If there is a need we could add a fully recursive search to find a non-&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
&lt;/span&gt;        &lt;span class=&quot;code-comment&quot;&gt;//Map&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;, COSObjectable&amp;gt; that contains the doc info. &lt;/span&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Can you attach one of these files?&lt;/p&gt;</comment>
                            <comment id="17305559" author="rossj" created="Sat, 20 Mar 2021 20:28:10 +0000"  >&lt;p&gt;The PDF files I&apos;m dealing with are all &amp;gt; 1 GB in size, but I&apos;ll see if I can generate a small sample file that demonstrates this issue.&lt;/p&gt;</comment>
                            <comment id="17306245" author="tallison@mitre.org" created="Mon, 22 Mar 2021 14:30:16 +0000"  >&lt;p&gt;Does this one work as an example?&#160;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://corpora.tika.apache.org/base/docs/bug_trackers/pdfcpu/pdfcpu-201-0.zip-0.pdf&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://corpora.tika.apache.org/base/docs/bug_trackers/pdfcpu/pdfcpu-201-0.zip-0.pdf&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;This file derives from:&#160;&lt;a href=&quot;https://github.com/pdfcpu/pdfcpu/issues/201&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/pdfcpu/pdfcpu/issues/201&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17306376" author="tilman" created="Mon, 22 Mar 2021 16:53:33 +0000"  >&lt;p&gt;Yes! I created &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-5138&quot; title=&quot;Embedded files not extracted from PDF files with multilevel EmbeddedFiles tree&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-5138&quot;&gt;&lt;del&gt;PDFBOX-5138&lt;/del&gt;&lt;/a&gt; to fix this on our side, then I&apos;ll look at the tika code again.&lt;/p&gt;</comment>
                            <comment id="17306412" author="tilman" created="Mon, 22 Mar 2021 17:14:29 +0000"  >&lt;p&gt;this segment&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
        Map&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;, PDComplexFileSpecification&amp;gt; embeddedFileNames = efTree.getNames();
        &lt;span class=&quot;code-comment&quot;&gt;//For now, &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; to get the embeddedFileNames out of embeddedFiles or its kids.
&lt;/span&gt;        &lt;span class=&quot;code-comment&quot;&gt;//This code follows: pdfbox/examples/pdmodel/ExtractEmbeddedFiles.java
&lt;/span&gt;        &lt;span class=&quot;code-comment&quot;&gt;//If there is a need we could add a fully recursive search to find a non-&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
&lt;/span&gt;        &lt;span class=&quot;code-comment&quot;&gt;//Map&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;, COSObjectable&amp;gt; that contains the doc info.
&lt;/span&gt;        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (embeddedFileNames != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
            processEmbeddedDocNames(embeddedFileNames);
        } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
            List&amp;lt;PDNameTreeNode&amp;lt;PDComplexFileSpecification&amp;gt;&amp;gt; kids = efTree.getKids();
            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (kids == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
                &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt;;
            }
            &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (PDNameTreeNode&amp;lt;PDComplexFileSpecification&amp;gt; node : kids) {
                embeddedFileNames = node.getNames();
                &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (embeddedFileNames != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
                    processEmbeddedDocNames(embeddedFileNames);
                }
            }
        }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;should be extracted so that it is something like &lt;tt&gt;extractFilesFromEFTree(PDNameTreeNode efTree....)&lt;/tt&gt; and this segment&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
            &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (PDNameTreeNode&amp;lt;PDComplexFileSpecification&amp;gt; node : kids) {
                embeddedFileNames = node.getNames();
                &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (embeddedFileNames != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
                    processEmbeddedDocNames(embeddedFileNames);
                }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;should be changed to&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
            &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (PDNameTreeNode&amp;lt;PDComplexFileSpecification&amp;gt; node : kids)
            {
                extractFilesFromEFTree(node, .....);
            }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17306418" author="tallison@mitre.org" created="Mon, 22 Mar 2021 17:17:56 +0000"  >&lt;p&gt;Great.&#160; Will take a first pass!&#160; Thank you!&lt;/p&gt;</comment>
                            <comment id="17306419" author="tallison@mitre.org" created="Mon, 22 Mar 2021 17:18:17 +0000"  >&lt;p&gt;Unless you have it already?&lt;/p&gt;</comment>
                            <comment id="17306469" author="tilman" created="Mon, 22 Mar 2021 18:05:47 +0000"  >&lt;p&gt;No I haven&apos;t&lt;/p&gt;</comment>
                            <comment id="17306471" author="tallison@mitre.org" created="Mon, 22 Mar 2021 18:06:29 +0000"  >&lt;p&gt;Will commit shortly.&#160; Thank you!&lt;/p&gt;</comment>
                            <comment id="17306512" author="tallison@mitre.org" created="Mon, 22 Mar 2021 19:25:26 +0000"  >&lt;p&gt;Thank you &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rossj&quot; class=&quot;user-hover&quot; rel=&quot;rossj&quot;&gt;rossj&lt;/a&gt; for reporting this issue!&#160; Thank you, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt;, for fixing this in PDFBox and the help with the fix here.&lt;/p&gt;</comment>
                            <comment id="17306514" author="hudson" created="Mon, 22 Mar 2021 19:29:35 +0000"  >&lt;p&gt;UNSTABLE: Integrated in Jenkins build Tika &#187; tika-branch1x-jdk8 #109 (See &lt;a href=&quot;https://ci-builds.apache.org/job/Tika/job/tika-branch1x-jdk8/109/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://ci-builds.apache.org/job/Tika/job/tika-branch1x-jdk8/109/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-3332&quot; title=&quot;Embedded files not extracted from PDF files with multilevel EmbeddedFiles tree&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-3332&quot;&gt;&lt;del&gt;TIKA-3332&lt;/del&gt;&lt;/a&gt; &amp;#8211; recursively process the embedded file tree in PDFs. (tallison: &lt;a href=&quot;https://github.com/apache/tika/commit/8bf65c01e174e1ba872e813089b076f21ddb4410&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/8bf65c01e174e1ba872e813089b076f21ddb4410&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) tika-core/src/test/java/org/apache/tika/TikaTest.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/test/java/org/apache/tika/parser/pdf/PDFParserTest.java&lt;/li&gt;
	&lt;li&gt;(edit) CHANGES.txt&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/pdf/AbstractPDF2XHTML.java&lt;/li&gt;
	&lt;li&gt;(add) tika-parsers/src/test/resources/test-documents/testPDF_deeplyEmbeddedAttachments.pdf&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="17306542" author="hudson" created="Mon, 22 Mar 2021 20:11:11 +0000"  >&lt;p&gt;FAILURE: Integrated in Jenkins build Tika &#187; tika-main-jdk8 #178 (See &lt;a href=&quot;https://ci-builds.apache.org/job/Tika/job/tika-main-jdk8/178/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://ci-builds.apache.org/job/Tika/job/tika-main-jdk8/178/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-3332&quot; title=&quot;Embedded files not extracted from PDF files with multilevel EmbeddedFiles tree&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-3332&quot;&gt;&lt;del&gt;TIKA-3332&lt;/del&gt;&lt;/a&gt; &amp;#8211; recursively search embedded file tree for attachments (tallison: &lt;a href=&quot;https://github.com/apache/tika/commit/29ef4b5919375d0915c260b6d632ca706ed7e46d&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/29ef4b5919375d0915c260b6d632ca706ed7e46d&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(add) tika-parsers/tika-parsers-classic/tika-parsers-classic-modules/tika-parser-pdf-module/src/test/resources/test-documents/testPDF_deeplyEmbeddedAttachments.pdf&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/tika-parsers-classic/tika-parsers-classic-modules/tika-parser-pdf-module/src/main/java/org/apache/tika/parser/pdf/AbstractPDF2XHTML.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/tika-parsers-classic/tika-parsers-classic-modules/tika-parser-pdf-module/src/test/java/org/apache/tika/parser/pdf/PDFParserTest.java&lt;/li&gt;
	&lt;li&gt;(edit) CHANGES.txt&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="17306605" author="hudson" created="Mon, 22 Mar 2021 21:47:01 +0000"  >&lt;p&gt;SUCCESS: Integrated in Jenkins build Tika &#187; tika-main-jdk8 #179 (See &lt;a href=&quot;https://ci-builds.apache.org/job/Tika/job/tika-main-jdk8/179/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://ci-builds.apache.org/job/Tika/job/tika-main-jdk8/179/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-3332&quot; title=&quot;Embedded files not extracted from PDF files with multilevel EmbeddedFiles tree&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-3332&quot;&gt;&lt;del&gt;TIKA-3332&lt;/del&gt;&lt;/a&gt; &amp;#8211; checkstyle fix (tallison: &lt;a href=&quot;https://github.com/apache/tika/commit/5da9984cf226ac7ab517fb6fbd2f2fb7ca504079&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/5da9984cf226ac7ab517fb6fbd2f2fb7ca504079&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) tika-parsers/tika-parsers-classic/tika-parsers-classic-modules/tika-parser-pdf-module/src/main/java/org/apache/tika/parser/pdf/AbstractPDF2XHTML.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13407558">TIKA-3579</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13366780">PDFBOX-5138</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="13022785" name="Screen Shot 2021-03-22 at 10.29.51 AM.png" size="250048" author="tallison" created="Mon, 22 Mar 2021 14:30:12 +0000"/>
                            <attachment id="13022788" name="Screenshot (5).png" size="68641" author="tallison" created="Mon, 22 Mar 2021 15:19:37 +0000"/>
                            <attachment id="13022722" name="image-2021-03-20-13-36-48-525.png" size="51815" author="rossj" created="Sat, 20 Mar 2021 17:36:51 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 33 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0p0dc:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>