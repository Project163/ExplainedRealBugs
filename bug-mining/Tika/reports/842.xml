<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:00:40 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[TIKA-2123] CommonsDigester calculates wrong hashes on large files</title>
                <link>https://issues.apache.org/jira/browse/TIKA-2123</link>
                <project id="12310631" key="TIKA">Tika</project>
                    <description>&lt;p&gt;When passing more than one algorithm to CommonsDigester constructor and&lt;br/&gt;
then trying to digest a file which is larger than 7.5 MB, results wrong&lt;br/&gt;
hashe calculation for all the algorithms except the first.&lt;/p&gt;

&lt;p&gt;The next code will reproduce the bug:&lt;/p&gt;

&lt;p&gt;// The file that was used w as a simple plain text file with size &amp;gt; 7.5 MB &lt;br/&gt;
File file = new File(&quot;testLargeFile.txt&quot;);&lt;/p&gt;

&lt;p&gt;BufferedInputStream bufferedInputStream = new BufferedInputStream(new FileInputStream(file));&lt;/p&gt;

&lt;p&gt;Metadata metadata = new Metadata();&lt;/p&gt;

&lt;p&gt;CommonsDigester digester = new CommonsDigester(20000000,&lt;br/&gt;
                CommonsDigester.DigestAlgorithm.MD5,&lt;br/&gt;
                CommonsDigester.DigestAlgorithm.SHA1,&lt;br/&gt;
                CommonsDigester.DigestAlgorithm.SHA256);&lt;/p&gt;

&lt;p&gt;digester.digest(bufferedInputStream, metadata, null);&lt;/p&gt;

&lt;p&gt;// Will print correct MD5 but wrong SHA1 and wrong SHA256&lt;br/&gt;
System.out.println(metadata);&lt;/p&gt;

&lt;p&gt;Initial direction: it seems that the inner buffered stream that is being used doesn&apos;t reset to 0 position after the first algorithm.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13013486">TIKA-2123</key>
            <summary>CommonsDigester calculates wrong hashes on large files</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="yahavamsi">Yahav Amsalem</reporter>
                        <labels>
                    </labels>
                <created>Wed, 19 Oct 2016 11:55:53 +0000</created>
                <updated>Mon, 12 Apr 2021 13:00:59 +0000</updated>
                            <resolved>Wed, 19 Oct 2016 15:55:29 +0000</resolved>
                                    <version>1.13</version>
                                    <fixVersion>1.14</fixVersion>
                    <fixVersion>2.0.0</fixVersion>
                                    <component>metadata</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="15588996" author="tallison@mitre.org" created="Wed, 19 Oct 2016 15:02:10 +0000"  >&lt;p&gt;Thank you for opening this.  I can replicate it.  Testing the fix now.  I think the problem was that &lt;tt&gt;hitBound&lt;/tt&gt; wasn&apos;t set to true in &lt;tt&gt;read(byte[]...)&lt;/tt&gt;.&lt;/p&gt;</comment>
                            <comment id="15589142" author="hudson" created="Wed, 19 Oct 2016 16:16:26 +0000"  >&lt;p&gt;FAILURE: Integrated in Jenkins build tika-2.x-windows #64 (See &lt;a href=&quot;https://builds.apache.org/job/tika-2.x-windows/64/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/tika-2.x-windows/64/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2123&quot; title=&quot;CommonsDigester calculates wrong hashes on large files&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2123&quot;&gt;&lt;del&gt;TIKA-2123&lt;/del&gt;&lt;/a&gt;: digester fails with multiple digests on large files (tallison: rev 7e66e49797b7bfcfe7928d442e1d04b924bf2b6c)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) tika-app/src/test/java/org/apache/tika/parser/DigestingParserTest.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-core/src/main/java/org/apache/tika/parser/digesting/CommonsDigester.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15589216" author="hudson" created="Wed, 19 Oct 2016 16:49:16 +0000"  >&lt;p&gt;SUCCESS: Integrated in Jenkins build Tika-trunk #1119 (See &lt;a href=&quot;https://builds.apache.org/job/Tika-trunk/1119/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Tika-trunk/1119/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2123&quot; title=&quot;CommonsDigester calculates wrong hashes on large files&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2123&quot;&gt;&lt;del&gt;TIKA-2123&lt;/del&gt;&lt;/a&gt; : digester fails when multiple digest values on large files; (tallison: rev 02425b290ce5ba2adbbc3951c7f04c8435692696)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/utils/CommonsDigester.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/test/java/org/apache/tika/parser/DigestingParserTest.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15589252" author="hudson" created="Wed, 19 Oct 2016 16:57:54 +0000"  >&lt;p&gt;SUCCESS: Integrated in Jenkins build tika-2.x #162 (See &lt;a href=&quot;https://builds.apache.org/job/tika-2.x/162/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/tika-2.x/162/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2123&quot; title=&quot;CommonsDigester calculates wrong hashes on large files&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2123&quot;&gt;&lt;del&gt;TIKA-2123&lt;/del&gt;&lt;/a&gt;: digester fails with multiple digests on large files (tallison: rev 7e66e49797b7bfcfe7928d442e1d04b924bf2b6c)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) tika-app/src/test/java/org/apache/tika/parser/DigestingParserTest.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-core/src/main/java/org/apache/tika/parser/digesting/CommonsDigester.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 4 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3536f:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>