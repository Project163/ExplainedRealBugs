<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:00:22 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[TIKA-1938] HtmlParser drops &lt;script&gt; elements found inside &lt;head&gt;</title>
                <link>https://issues.apache.org/jira/browse/TIKA-1938</link>
                <project id="12310631" key="TIKA">Tika</project>
                    <description>&lt;p&gt;HtmlParser&apos;s HtmlHandler does not check for &quot;SCRIPT&quot; in &lt;tt&gt;startElement&lt;/tt&gt; when parsing &amp;lt;head&amp;gt; (i.e. &lt;tt&gt;bodylevel == 0 &amp;amp;&amp;amp; discardLevel ==0&lt;/tt&gt;). This causes &amp;lt;script&amp;gt; elements found within &amp;lt;head&amp;gt; to be dropped altogether. They should be treated in the same manner as &quot;LINK&quot; elements.&lt;/p&gt;

&lt;p&gt;Here is a sample test case that demonstrates the problem and can be run from within &lt;tt&gt;HtmlParserTest.java&lt;/tt&gt;, although it could be generalized to check for &amp;lt;a&amp;gt;, &amp;lt;link&amp;gt; and &amp;lt;img&amp;gt; links by using the &lt;tt&gt;LinkContentHandler&lt;/tt&gt;.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;@Test
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void testScriptSrc() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {
    &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; url = &lt;span class=&quot;code-quote&quot;&gt;&quot;http:&lt;span class=&quot;code-comment&quot;&gt;//domain.com/logic.js&quot;&lt;/span&gt;;
&lt;/span&gt;    &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; scriptInBody =
            &lt;span class=&quot;code-quote&quot;&gt;&quot;&amp;lt;html&amp;gt;&amp;lt;body&amp;gt;&amp;lt;script src=\&quot;&lt;/span&gt;&lt;span class=&quot;code-quote&quot;&gt;&quot; + url + &quot;&lt;/span&gt;\&lt;span class=&quot;code-quote&quot;&gt;&quot;&amp;gt;&amp;lt;/script&amp;gt;&amp;lt;/body&amp;gt;&amp;lt;/html&amp;gt;&quot;&lt;/span&gt;;
    &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; scriptInHead =
            &lt;span class=&quot;code-quote&quot;&gt;&quot;&amp;lt;html&amp;gt;&amp;lt;head&amp;gt;&amp;lt;script src=\&quot;&lt;/span&gt;&lt;span class=&quot;code-quote&quot;&gt;&quot; + url + &quot;&lt;/span&gt;\&lt;span class=&quot;code-quote&quot;&gt;&quot;&amp;gt;&amp;lt;/script&amp;gt;&amp;lt;/head&amp;gt;&amp;lt;/html&amp;gt;&quot;&lt;/span&gt;;

    assertScriptLink(scriptInBody, url);
    assertScriptLink(scriptInHead, url);
}

&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; void assertScriptLink(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; html, &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; url) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {
    &lt;span class=&quot;code-comment&quot;&gt;// IdentityHtmlMapper needed to extract &amp;lt;script&amp;gt; tags
&lt;/span&gt;    ParseContext context = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ParseContext();
    context.set(HtmlMapper.class, IdentityHtmlMapper.INSTANCE);
    Metadata metadata = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Metadata();
    metadata.set(Metadata.CONTENT_TYPE, &lt;span class=&quot;code-quote&quot;&gt;&quot;text/html&quot;&lt;/span&gt;);

    &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; List&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt; links = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ArrayList&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt;();
    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; HtmlParser().parse(
            &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ByteArrayInputStream(html.getBytes(UTF_8)),
            &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; DefaultHandler() {
                @Override
                &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void startElement(
                        &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; u, &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; l, &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; name, Attributes atts) {
                    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (name.equals(&lt;span class=&quot;code-quote&quot;&gt;&quot;script&quot;&lt;/span&gt;) &amp;amp;&amp;amp; atts.getValue(&lt;span class=&quot;code-quote&quot;&gt;&quot;&quot;, &quot;&lt;/span&gt;src&quot;) != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
                        links.add(atts.getValue(&lt;span class=&quot;code-quote&quot;&gt;&quot;&quot;, &quot;&lt;/span&gt;src&quot;));
                    }
                }
            },
            metadata,
            context);

    assertEquals(1, links.size());
    assertEquals(url, links.get(0));
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12956917">TIKA-1938</key>
            <summary>HtmlParser drops &lt;script&gt; elements found inside &lt;head&gt;</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="kkrugler">Kenneth William Krugler</assignee>
                                    <reporter username="naegelejd">Joseph Naegele</reporter>
                        <labels>
                    </labels>
                <created>Thu, 7 Apr 2016 16:12:11 +0000</created>
                <updated>Mon, 12 Apr 2021 12:59:06 +0000</updated>
                            <resolved>Fri, 13 May 2016 14:50:24 +0000</resolved>
                                    <version>1.12</version>
                                    <fixVersion>1.14</fixVersion>
                    <fixVersion>2.0.0</fixVersion>
                                    <component>parser</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="15260771" author="githubbot" created="Wed, 27 Apr 2016 19:13:18 +0000"  >&lt;p&gt;GitHub user naegelejd opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/tika/pull/111&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/pull/111&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    fix for &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1938&quot; title=&quot;HtmlParser drops &amp;lt;script&amp;gt; elements found inside &amp;lt;head&amp;gt;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1938&quot;&gt;&lt;del&gt;TIKA-1938&lt;/del&gt;&lt;/a&gt; contributed by naegelejd&lt;/p&gt;

&lt;p&gt;    Adds HtmlParser support for &amp;lt;script&amp;gt; tags within &amp;lt;head&amp;gt;&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/naegelejd/tika&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/naegelejd/tika&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1938&quot; title=&quot;HtmlParser drops &amp;lt;script&amp;gt; elements found inside &amp;lt;head&amp;gt;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1938&quot;&gt;&lt;del&gt;TIKA-1938&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/tika/pull/111.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/pull/111.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #111&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit b6d23c189e852fa2e41b441c18bfe3e66e3f67c4&lt;br/&gt;
Author: Joseph Naegele &amp;lt;jnaegele@grierforensics.com&amp;gt;&lt;br/&gt;
Date:   2016-04-27T18:35:11Z&lt;/p&gt;

&lt;p&gt;    fix for &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1938&quot; title=&quot;HtmlParser drops &amp;lt;script&amp;gt; elements found inside &amp;lt;head&amp;gt;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1938&quot;&gt;&lt;del&gt;TIKA-1938&lt;/del&gt;&lt;/a&gt; contributed by naegelejd&lt;/p&gt;

&lt;p&gt;    add HtmlParser support for &amp;lt;script&amp;gt; tags within &amp;lt;head&amp;gt;&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15278119" author="naegelejd" created="Tue, 10 May 2016 13:51:39 +0000"  >&lt;p&gt;This is a very simple PR if anyone is able to review and merge. I had hoped to get it into 1.13.&lt;/p&gt;</comment>
                            <comment id="15278290" author="githubbot" created="Tue, 10 May 2016 15:36:53 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/tika/pull/111&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/pull/111&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15278294" author="kkrugler" created="Tue, 10 May 2016 15:37:24 +0000"  >&lt;p&gt;Fix with commit da5bbbe..46d5775.&lt;/p&gt;

&lt;p&gt;Thanks Joseph!&lt;/p&gt;</comment>
                            <comment id="15278455" author="hudson" created="Tue, 10 May 2016 16:59:30 +0000"  >&lt;p&gt;SUCCESS: Integrated in tika-trunk-jdk1.7 #988 (See &lt;a href=&quot;https://builds.apache.org/job/tika-trunk-jdk1.7/988/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/tika-trunk-jdk1.7/988/&lt;/a&gt;)&lt;br/&gt;
fix for &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1938&quot; title=&quot;HtmlParser drops &amp;lt;script&amp;gt; elements found inside &amp;lt;head&amp;gt;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1938&quot;&gt;&lt;del&gt;TIKA-1938&lt;/del&gt;&lt;/a&gt; contributed by naegelejd (jnaegele: rev b6d23c189e852fa2e41b441c18bfe3e66e3f67c4)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;tika-parsers/src/test/java/org/apache/tika/parser/html/HtmlParserTest.java&lt;/li&gt;
	&lt;li&gt;tika-parsers/src/main/java/org/apache/tika/parser/html/HtmlHandler.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15282748" author="grossws" created="Fri, 13 May 2016 14:50:08 +0000"  >&lt;p&gt;to set fix version&lt;/p&gt;</comment>
                            <comment id="15419101" author="tallison@mitre.org" created="Fri, 12 Aug 2016 16:47:36 +0000"  >&lt;p&gt;I just applied this to 2.x.&lt;/p&gt;</comment>
                            <comment id="15419149" author="hudson" created="Fri, 12 Aug 2016 17:16:22 +0000"  >&lt;p&gt;FAILURE: Integrated in tika-2.x-windows #34 (See &lt;a href=&quot;https://builds.apache.org/job/tika-2.x-windows/34/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/tika-2.x-windows/34/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1938&quot; title=&quot;HtmlParser drops &amp;lt;script&amp;gt; elements found inside &amp;lt;head&amp;gt;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1938&quot;&gt;&lt;del&gt;TIKA-1938&lt;/del&gt;&lt;/a&gt; via Joseph Naegele (tallison: rev 5358bf1e142ae486fee63bc2e3b166e7a5b3ea8f)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;tika-parser-modules/tika-parser-web-module/src/main/java/org/apache/tika/parser/html/HtmlHandler.java&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1938&quot; title=&quot;HtmlParser drops &amp;lt;script&amp;gt; elements found inside &amp;lt;head&amp;gt;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1938&quot;&gt;&lt;del&gt;TIKA-1938&lt;/del&gt;&lt;/a&gt; via Joseph Naegele (tallison: rev 09bd22fb4bd67979070e1f57d43f6a4bff755ff0)&lt;/li&gt;
	&lt;li&gt;tika-parser-modules/tika-parser-web-module/src/test/java/org/apache/tika/parser/html/HtmlParserTest.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15419202" author="hudson" created="Fri, 12 Aug 2016 17:52:31 +0000"  >&lt;p&gt;SUCCESS: Integrated in tika-2.x #130 (See &lt;a href=&quot;https://builds.apache.org/job/tika-2.x/130/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/tika-2.x/130/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1938&quot; title=&quot;HtmlParser drops &amp;lt;script&amp;gt; elements found inside &amp;lt;head&amp;gt;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1938&quot;&gt;&lt;del&gt;TIKA-1938&lt;/del&gt;&lt;/a&gt; via Joseph Naegele (tallison: rev 5358bf1e142ae486fee63bc2e3b166e7a5b3ea8f)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;tika-parser-modules/tika-parser-web-module/src/main/java/org/apache/tika/parser/html/HtmlHandler.java&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1938&quot; title=&quot;HtmlParser drops &amp;lt;script&amp;gt; elements found inside &amp;lt;head&amp;gt;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1938&quot;&gt;&lt;del&gt;TIKA-1938&lt;/del&gt;&lt;/a&gt; via Joseph Naegele (tallison: rev 09bd22fb4bd67979070e1f57d43f6a4bff755ff0)&lt;/li&gt;
	&lt;li&gt;tika-parser-modules/tika-parser-web-module/src/test/java/org/apache/tika/parser/html/HtmlParserTest.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 14 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2vskf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>