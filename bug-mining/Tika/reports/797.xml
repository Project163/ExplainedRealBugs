<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:00:23 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[TIKA-1454] Extracting as HTML loses links in xlsx, ppt, and pptx files</title>
                <link>https://issues.apache.org/jira/browse/TIKA-1454</link>
                <project id="12310631" key="TIKA">Tika</project>
                    <description>&lt;p&gt;I am trying to convert documents to HTML, then looking through the HTML for anchor tags to find links to external URLs.  This works fine when looking at some document types, including PDFs, Open Document formats, Microsoft Word formats .doc and .docx, and the older Microsoft Excel .xls format, but it does not work for any Microsoft Powerpoint formats (.ppt or .pptx) and it does not work for the newer Excel .xlsx format.  For the .ppt, .pptx, and .xlsx formats, the text is extracted properly and formatted into HTML, but the link is not converted to an anchor tag.&lt;/p&gt;

&lt;p&gt;I am running tika in --server --html mode.&lt;/p&gt;

&lt;p&gt;I included samples of .xlsx, .ppt, and .pptx files that do not properly extract links, and also included samples of .ods and .odp files that do extract links properly.&lt;/p&gt;</description>
                <environment>&lt;p&gt;RedHat EL5, EL6, EL7&lt;/p&gt;</environment>
        <key id="12749848">TIKA-1454</key>
            <summary>Extracting as HTML loses links in xlsx, ppt, and pptx files</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tallison">Tim Allison</assignee>
                                    <reporter username="cbryant">Chris Bryant</reporter>
                        <labels>
                    </labels>
                <created>Wed, 22 Oct 2014 19:01:07 +0000</created>
                <updated>Tue, 3 Oct 2023 19:55:22 +0000</updated>
                            <resolved>Tue, 3 Oct 2023 19:55:22 +0000</resolved>
                                    <version>1.6</version>
                    <version>1.7</version>
                    <version>1.8</version>
                    <version>1.9</version>
                    <version>1.10</version>
                    <version>1.11</version>
                    <version>1.12</version>
                                    <fixVersion>1.17</fixVersion>
                    <fixVersion>2.0.0-BETA</fixVersion>
                    <fixVersion>2.1.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="15281524" author="tallison@mitre.org" created="Thu, 12 May 2016 13:42:46 +0000"  >&lt;p&gt;Thank you for opening this issue and supplying test docs.  For ppt and pptx, I have a reasonable patch.  We&apos;ll need to add some things into POI to make the extraction cleaner, but this should be good to go soonish.&lt;/p&gt;

&lt;p&gt;For xlsx, it looks like we&apos;ll have to dump hyperlinks at the bottom of each sheet...we&apos;d have to do a double pass to cache hyperlinks and insert them in the proper cells.  Not great, but at least we should be able to get the hyperlinks for your purposes.&lt;/p&gt;</comment>
                            <comment id="15282751" author="hudson" created="Fri, 13 May 2016 14:51:50 +0000"  >&lt;p&gt;SUCCESS: Integrated in tika-trunk-jdk1.7 #989 (See &lt;a href=&quot;https://builds.apache.org/job/tika-trunk-jdk1.7/989/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/tika-trunk-jdk1.7/989/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1454&quot; title=&quot;Extracting as HTML loses links in xlsx, ppt, and pptx files&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1454&quot;&gt;&lt;del&gt;TIKA-1454&lt;/del&gt;&lt;/a&gt; &amp;#8211; added initial hyperlink extraction for ppt, pptx, xlsx.  (tallison: rev 69852e4cb55d34e6513e0b66af7d75cb1b1408ba)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;tika-parsers/src/test/resources/test-documents/testEXCEL_hyperlinks.xlsx&lt;/li&gt;
	&lt;li&gt;tika-parsers/src/test/java/org/apache/tika/parser/microsoft/PowerPointParserTest.java&lt;/li&gt;
	&lt;li&gt;tika-parsers/src/test/java/org/apache/tika/parser/microsoft/ExcelParserTest.java&lt;/li&gt;
	&lt;li&gt;tika-parsers/src/main/java/org/apache/tika/parser/microsoft/HSLFExtractor.java&lt;/li&gt;
	&lt;li&gt;tika-parsers/src/test/java/org/apache/tika/parser/microsoft/ooxml/OOXMLParserTest.java&lt;/li&gt;
	&lt;li&gt;tika-parsers/src/main/java/org/apache/tika/parser/microsoft/ooxml/XSSFExcelExtractorDecorator.java&lt;/li&gt;
	&lt;li&gt;tika-parsers/src/main/java/org/apache/tika/parser/microsoft/ooxml/XSLFPowerPointExtractorDecorator.java&lt;/li&gt;
	&lt;li&gt;tika-parsers/src/test/resources/test-documents/testEXCEL_hyperlinks.xls&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15282760" author="tallison@mitre.org" created="Fri, 13 May 2016 14:59:34 +0000"  >&lt;p&gt;I added preliminary extraction from xlsx, ppt, pptx.&lt;/p&gt;

&lt;p&gt;For ppt and pptx, it would be helpful if we could distinguish external (actual hyperlinks) from internal (references to a footnote)...this will have to be made at the POI level.  For now, there&apos;s a bit of a hack to make the distinction and only href-ify external.&lt;/p&gt;

&lt;p&gt;For xlsx, for now, we are dumping the hyperlinks at the bottom of each sheet.  If we ran the sheet reader twice, we&apos;d be able to cache the hyperlinks and put them in the cells in which they belong.  I&apos;m not sure we want to add that double parsing unless there is demand.&lt;/p&gt;

&lt;p&gt;For xls, I found no way to extract a hyperlink associated with a text box.  I have no doubt that there is a way...I couldn&apos;t find it.&lt;/p&gt;

&lt;p&gt;We could add more tests for ppt and pptx.&lt;/p&gt;

&lt;p&gt;I would close this issue now, but we also have to add extraction for ods and odp.&lt;/p&gt;</comment>
                            <comment id="15282811" author="hudson" created="Fri, 13 May 2016 15:40:21 +0000"  >&lt;p&gt;UNSTABLE: Integrated in tika-2.x #91 (See &lt;a href=&quot;https://builds.apache.org/job/tika-2.x/91/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/tika-2.x/91/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1454&quot; title=&quot;Extracting as HTML loses links in xlsx, ppt, and pptx files&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1454&quot;&gt;&lt;del&gt;TIKA-1454&lt;/del&gt;&lt;/a&gt;: extract hyperlinks from ppt, pptx and xlsx (tallison: rev 229329d6ea58d5ef90aef7887bdf444463aed127)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;tika-parser-modules/tika-parser-office-module/src/test/java/org/apache/tika/parser/microsoft/ooxml/OOXMLParserTest.java&lt;/li&gt;
	&lt;li&gt;tika-parser-modules/tika-parser-office-module/src/test/java/org/apache/tika/parser/microsoft/PowerPointParserTest.java&lt;/li&gt;
	&lt;li&gt;CHANGES.txt&lt;/li&gt;
	&lt;li&gt;tika-parser-modules/tika-parser-office-module/src/main/java/org/apache/tika/parser/microsoft/ooxml/XSSFExcelExtractorDecorator.java&lt;/li&gt;
	&lt;li&gt;tika-parser-modules/tika-parser-office-module/src/test/java/org/apache/tika/parser/microsoft/ExcelParserTest.java&lt;/li&gt;
	&lt;li&gt;tika-parser-modules/tika-parser-office-module/src/main/java/org/apache/tika/parser/microsoft/ooxml/XSLFPowerPointExtractorDecorator.java&lt;/li&gt;
	&lt;li&gt;tika-parser-modules/tika-parser-office-module/src/main/java/org/apache/tika/parser/microsoft/HSLFExtractor.java&lt;/li&gt;
	&lt;li&gt;tika-parser-modules/tika-parser-package-module/src/test/java/org/apache/tika/parser/pkg/ArParserTest.java&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1454&quot; title=&quot;Extracting as HTML loses links in xlsx, ppt, and pptx files&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1454&quot;&gt;&lt;del&gt;TIKA-1454&lt;/del&gt;&lt;/a&gt;: extract hyperlinks from ppt, pptx and xlsx &amp;#8211; undo ignoring (tallison: rev 6f5e7f94e6f4f01b4d2a7c453d025f0d1750817a)&lt;/li&gt;
	&lt;li&gt;tika-parser-modules/tika-parser-package-module/src/test/java/org/apache/tika/parser/pkg/ArParserTest.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15282825" author="hudson" created="Fri, 13 May 2016 15:51:59 +0000"  >&lt;p&gt;SUCCESS: Integrated in tika-trunk-jdk1.7 #990 (See &lt;a href=&quot;https://builds.apache.org/job/tika-trunk-jdk1.7/990/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/tika-trunk-jdk1.7/990/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1454&quot; title=&quot;Extracting as HTML loses links in xlsx, ppt, and pptx files&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1454&quot;&gt;&lt;del&gt;TIKA-1454&lt;/del&gt;&lt;/a&gt; &amp;#8211; clean up and add entry to CHANGES.txt (tallison: rev bb78082b0028b57a5bf1ae30858dda6aebeacf63)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;CHANGES.txt&lt;/li&gt;
	&lt;li&gt;tika-parsers/src/main/java/org/apache/tika/parser/microsoft/HSLFExtractor.java&lt;/li&gt;
	&lt;li&gt;tika-parsers/src/main/java/org/apache/tika/parser/microsoft/ooxml/XSLFPowerPointExtractorDecorator.java&lt;/li&gt;
	&lt;li&gt;tika-parsers/src/test/java/org/apache/tika/parser/microsoft/PowerPointParserTest.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15282904" author="hudson" created="Fri, 13 May 2016 17:39:14 +0000"  >&lt;p&gt;SUCCESS: Integrated in tika-2.x #92 (See &lt;a href=&quot;https://builds.apache.org/job/tika-2.x/92/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/tika-2.x/92/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1454&quot; title=&quot;Extracting as HTML loses links in xlsx, ppt, and pptx files&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1454&quot;&gt;&lt;del&gt;TIKA-1454&lt;/del&gt;&lt;/a&gt;: extract hyperlinks from ppt, pptx and xlsx &amp;#8211; actually add (tallison: rev c53d5385aac0bad7fec8e86fa0c455790006b437)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;tika-test-resources/src/test/resources/test-documents/testEXCEL_hyperlinks.xlsx&lt;/li&gt;
	&lt;li&gt;tika-test-resources/src/test/resources/test-documents/testEXCEL_hyperlinks.xls&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="17771629" author="tallison@mitre.org" created="Tue, 3 Oct 2023 19:55:22 +0000"  >&lt;p&gt;I think we&apos;re good here.  Please reopen if not.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12676398" name="testurl.ods" size="9254" author="cbryant" created="Wed, 22 Oct 2014 19:02:45 +0000"/>
                            <attachment id="12676399" name="testurl.xlsx" size="29078" author="cbryant" created="Wed, 22 Oct 2014 19:02:45 +0000"/>
                            <attachment id="12676395" name="urltest.odp" size="12180" author="cbryant" created="Wed, 22 Oct 2014 19:02:45 +0000"/>
                            <attachment id="12676396" name="urltest.ppt" size="47104" author="cbryant" created="Wed, 22 Oct 2014 19:02:45 +0000"/>
                            <attachment id="12676397" name="urltest.pptx" size="38043" author="cbryant" created="Wed, 22 Oct 2014 19:02:45 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 5 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i21gkf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>