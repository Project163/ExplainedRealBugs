<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:03:23 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[TIKA-2787] Make WriteLimitReachedException public and not subclass of SAXException</title>
                <link>https://issues.apache.org/jira/browse/TIKA-2787</link>
                <project id="12310631" key="TIKA">Tika</project>
                    <description>&lt;p&gt;The idea behind being able to set a limit on text extraction is to be able to get up to N characters extracted back. We just got tripped up by the fact that Tika throws an exception once the limit has been reached.&lt;/p&gt;

&lt;p&gt;This, in and of itself, is not a major hindrance especially since the error message itself clearly states that the extracted text is, &quot;however, available&quot;.&lt;/p&gt;

&lt;p&gt;OK, but why is WriteLimitReachedException private? why not public so it can be explicitly caught when the parse() method is called? and why not add it to the signature of the parse method? I don&apos;t think it should extend SAXException, either; just cleanly throw it as is.&lt;/p&gt;

&lt;p&gt;Right now, our code makes this cumbersome adjustment around the condition:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
ContentHandler handler = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; BodyContentHandler(limit); &lt;span class=&quot;code-comment&quot;&gt;// &amp;lt;-- e.g. set to 1000000
&lt;/span&gt;&lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
&#160; &#160; parser.parse(dataStream, handler, metadata, parseCtx);
} &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (IOException | TikaException ex) {
    &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; ex;
} &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (SAXException ex) {
    &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; message = (ex.getMessage() == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) ? &quot;&quot; : ex.getMessage();
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!message.contains(&lt;span class=&quot;code-quote&quot;&gt;&quot;Your document contained more than&quot;&lt;/span&gt;)) {
        &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; TikaException(&lt;span class=&quot;code-quote&quot;&gt;&quot;Tika error has occurred.&quot;&lt;/span&gt;, ex);
    } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
        log.warn(&lt;span class=&quot;code-quote&quot;&gt;&quot;TE limit reached on file {}.&quot;&lt;/span&gt;, filePath);
    }
}

&lt;span class=&quot;code-comment&quot;&gt;// Keep the extracted text regardless of WriteLimitReachedException
&lt;/span&gt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; text = handler.toString();

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;




&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13200708">TIKA-2787</key>
            <summary>Make WriteLimitReachedException public and not subclass of SAXException</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="dgoldenberg123">Dmitry Goldenberg</reporter>
                        <labels>
                    </labels>
                <created>Mon, 26 Nov 2018 23:17:39 +0000</created>
                <updated>Wed, 28 Apr 2021 17:48:34 +0000</updated>
                            <resolved>Wed, 28 Apr 2021 16:17:59 +0000</resolved>
                                    <version>1.19.1</version>
                                    <fixVersion>2.0.0</fixVersion>
                                    <component>core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="16729706" author="cott@redstonecontentsolutions.com" created="Thu, 27 Dec 2018 16:22:17 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dgoldenberg123&quot; class=&quot;user-hover&quot; rel=&quot;dgoldenberg123&quot;&gt;dgoldenberg123&lt;/a&gt; I agree with what you are saying here. I have also had similar issues noted in this ticket: &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2627&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/TIKA-2627&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;A slightly nicer workaround is to use the &quot;isWriteLimitReached&quot; method on WriteOutContentHandler. See the updated code.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
WriteOutContentHandler writer = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; WriteOutContentHandler(limit); &lt;span class=&quot;code-comment&quot;&gt;// &amp;lt;-- e.g. set to 1000000
&lt;/span&gt;ContentHandler handler = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; BodyContentHandler(writer); 
&lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
&#160; &#160; parser.parse(dataStream, handler, metadata, parseCtx);
} &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (Exception ex) {
    &lt;span class=&quot;code-comment&quot;&gt;// Write limit exception could be wrapped in a TikaException
&lt;/span&gt;    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!writer.isWriteLimitReached(ex)) {
        &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; ex;
    } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
        log.warn(&lt;span class=&quot;code-quote&quot;&gt;&quot;TE limit reached on file {}.&quot;&lt;/span&gt;, filePath);
    }
}

&lt;span class=&quot;code-comment&quot;&gt;// Keep the extracted text regardless of WriteLimitReachedException
&lt;/span&gt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; text = handler.toString();

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Edit: The more I think about it, I am not sure making the exception public would help very much. The exception usually gets wrapped up in other SAX and Tika Exceptions as their causes. &quot;isWriteLimitReached&quot; recursively checks the exception to see if any of the causes are the write limit exception. That will probably work better than having the exception public.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="16733276" author="tallison@mitre.org" created="Thu, 3 Jan 2019 17:41:28 +0000"  >&lt;blockquote&gt;&lt;p&gt;That will probably work better than having the exception public.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I agree generally, and I&apos;m grateful for your example above.  Within the RecursiveParserWrapper (and somewhere else?), we have special handling for WriteLimitReached even though we don&apos;t necessarily have access to the WriteoutContentHandler (perhaps it is wrapped in another handler).  So, for this use case, it would be useful to have a public exception. &lt;/p&gt;

&lt;p&gt;I&apos;ve been wondering if we might consider having a TikaSAXException (extends SAXException, or maybe RuntimeException?) that we can use for what are actually parse exceptions but are thrown in code that override methods that only throw SAXExceptions.  If we went this route, we could have WriteLimitReached extend TikaSAXException.&lt;/p&gt;</comment>
                            <comment id="17304312" author="tallison@mitre.org" created="Thu, 18 Mar 2021 17:43:48 +0000"  >&lt;p&gt;Unless there are objections, let&apos;s make WriteLimitReached a public Exception that continues to extend SAXException for Tika 2.x&lt;/p&gt;</comment>
                            <comment id="17334904" author="hudson" created="Wed, 28 Apr 2021 17:48:34 +0000"  >&lt;p&gt;SUCCESS: Integrated in Jenkins build Tika &#187; tika-main-jdk8 #211 (See &lt;a href=&quot;https://ci-builds.apache.org/job/Tika/job/tika-main-jdk8/211/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://ci-builds.apache.org/job/Tika/job/tika-main-jdk8/211/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2787&quot; title=&quot;Make WriteLimitReachedException public and not subclass of SAXException&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2787&quot;&gt;&lt;del&gt;TIKA-2787&lt;/del&gt;&lt;/a&gt; &amp;#8211; make WriteLimitReachedException public for Tika 2.x (tallison: &lt;a href=&quot;https://github.com/apache/tika/commit/fa08843cec46e8564a060d2c2ba2a05ad2f8df1e&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/fa08843cec46e8564a060d2c2ba2a05ad2f8df1e&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) tika-server/tika-server-core/src/test/java/org/apache/tika/server/core/TikaResourceTest.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-core/src/test/java/org/apache/tika/sax/BasicContentHandlerFactoryTest.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-core/src/main/java/org/apache/tika/sax/WriteOutContentHandler.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-core/src/main/java/org/apache/tika/Tika.java&lt;/li&gt;
	&lt;li&gt;(add) tika-core/src/main/java/org/apache/tika/exception/WriteLimitReachedException.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-server/tika-server-classic/src/test/java/org/apache/tika/server/classic/TikaResourceTest.java&lt;/li&gt;
	&lt;li&gt;(delete) tika-core/src/main/java/org/apache/tika/exception/WriteLimitReached.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-core/src/main/java/org/apache/tika/parser/RecursiveParserWrapper.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 28 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|s00vww:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>