<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:02:09 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[TIKA-2735] notes and footer contents are duplicated in extracting text from power point slides</title>
                <link>https://issues.apache.org/jira/browse/TIKA-2735</link>
                <project id="12310631" key="TIKA">Tika</project>
                    <description>&lt;p&gt;notes and footer contents are duplicated at the end when extract text from ppt slides (like the one in the attachment). Both the input file and the text results are attached.&#160;&lt;/p&gt;

&lt;p&gt;Is there a configuration option that can be used to suppress this kind of duplication?&lt;/p&gt;</description>
                <environment></environment>
        <key id="13187169">TIKA-2735</key>
            <summary>notes and footer contents are duplicated in extracting text from power point slides</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tallison">Tim Allison</assignee>
                                    <reporter username="fyemaple">feng ye</reporter>
                        <labels>
                    </labels>
                <created>Tue, 25 Sep 2018 02:26:36 +0000</created>
                <updated>Wed, 31 Oct 2018 17:53:44 +0000</updated>
                            <resolved>Wed, 31 Oct 2018 17:52:21 +0000</resolved>
                                    <version>1.18</version>
                                    <fixVersion>1.20</fixVersion>
                                    <component>handler</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="16637457" author="tallison@mitre.org" created="Wed, 3 Oct 2018 19:58:41 +0000"  >&lt;p&gt;I&apos;m sorry for my delay.&#160;&#160;If you&apos;re talking about the copyright statement, as you point out, it is getting extracted from the slide-master and from the slide notes.&#160; We don&apos;t have a configuration option to turn off the master or notes.&#160; We could easily add &lt;tt&gt;includeSlideMasterContent(boolean b)&lt;/tt&gt; and &lt;tt&gt;includeSlideNoteContent(boolean b)&lt;/tt&gt; with defaults of &lt;tt&gt;true&lt;/tt&gt;, but that seems quite use case specific.  What do you think?&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;&amp;lt;title&amp;gt;Slide 1&amp;lt;/title&amp;gt;
&amp;lt;/head&amp;gt;
&amp;lt;body&amp;gt;&amp;lt;div class=&quot;slideShow&quot;&amp;gt;&amp;lt;div class=&quot;slide&quot;&amp;gt;&amp;lt;div class=&quot;slide-master-content&quot;&amp;gt;&amp;lt;p&amp;gt;Copyright &#169; 2007, SAS Institute Inc. All rights reserved.&amp;lt;/p&amp;gt;
&amp;lt;/div&amp;gt;
&amp;lt;div class=&quot;slide-content&quot;&amp;gt;&amp;lt;p&amp;gt;Text Miner/Teragram Integration&amp;lt;/p&amp;gt;
&amp;lt;p&amp;gt;Jim Cox&amp;lt;/p&amp;gt;
&amp;lt;/div&amp;gt;
&amp;lt;div class=&quot;slide-notes&quot;&amp;gt;&amp;lt;p&amp;gt;Copyright &#169; 2007, SAS Institute Inc. All rights reserved.&amp;lt;/p&amp;gt;
&amp;lt;p&amp;gt;*&amp;lt;/p&amp;gt;
&amp;lt;p /&amp;gt;
&amp;lt;/div&amp;gt;
&amp;lt;/div&amp;gt;&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="16638585" author="tallison@mitre.org" created="Thu, 4 Oct 2018 17:32:14 +0000"  >&lt;p&gt;On the master branch, I just added configurability for allowing the user to turn off extraction from notes sections and from master sections.  There are three types of masters: master slide, master notes, master handout.  I think one variable should handle all of those.&lt;/p&gt;

&lt;p&gt;There are some new unit tests that aren&apos;t passing, and I can&apos;t figure out if this is user error, a bug in POI or a happenstance of how the documents were generated.&lt;/p&gt;

&lt;p&gt;I also cleaned up, and I think, improved extraction from the notes section in ppt.&lt;/p&gt;

&lt;p&gt;IMHO, these changes are too big to make it into 1.19.1, but they should be ok (after large scale regression tests) to go into 1.20.&lt;/p&gt;</comment>
                            <comment id="16638669" author="hudson" created="Thu, 4 Oct 2018 18:35:53 +0000"  >&lt;p&gt;UNSTABLE: Integrated in Jenkins build tika-2.x-windows #329 (See &lt;a href=&quot;https://builds.apache.org/job/tika-2.x-windows/329/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/tika-2.x-windows/329/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2735&quot; title=&quot;notes and footer contents are duplicated in extracting text from power point slides&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2735&quot;&gt;&lt;del&gt;TIKA-2735&lt;/del&gt;&lt;/a&gt; &amp;#8211; allow user to avoid extracting &quot;master&quot; sections and notes (tallison: rev 0b2575b272c727f7c20cc58149dfec9a258ac799)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/microsoft/OfficeParserConfig.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/test/java/org/apache/tika/parser/microsoft/PowerPointParserTest.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/test/java/org/apache/tika/parser/microsoft/ooxml/SXSLFExtractorTest.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/microsoft/HSLFExtractor.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/microsoft/ooxml/XSLFPowerPointExtractorDecorator.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/microsoft/ooxml/SXSLFPowerPointExtractorDecorator.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/test/java/org/apache/tika/parser/microsoft/ooxml/OOXMLParserTest.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="16638746" author="hudson" created="Thu, 4 Oct 2018 19:39:58 +0000"  >&lt;p&gt;SUCCESS: Integrated in Jenkins build Tika-trunk #1573 (See &lt;a href=&quot;https://builds.apache.org/job/Tika-trunk/1573/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Tika-trunk/1573/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2735&quot; title=&quot;notes and footer contents are duplicated in extracting text from power point slides&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2735&quot;&gt;&lt;del&gt;TIKA-2735&lt;/del&gt;&lt;/a&gt; &amp;#8211; allow user to avoid extracting &quot;master&quot; sections and notes (tallison: &lt;a href=&quot;https://github.com/apache/tika/commit/0b2575b272c727f7c20cc58149dfec9a258ac799&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/0b2575b272c727f7c20cc58149dfec9a258ac799&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) tika-parsers/src/test/java/org/apache/tika/parser/microsoft/ooxml/SXSLFExtractorTest.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/test/java/org/apache/tika/parser/microsoft/ooxml/OOXMLParserTest.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/microsoft/HSLFExtractor.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/microsoft/ooxml/SXSLFPowerPointExtractorDecorator.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/microsoft/ooxml/XSLFPowerPointExtractorDecorator.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/test/java/org/apache/tika/parser/microsoft/PowerPointParserTest.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/microsoft/OfficeParserConfig.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="16638801" author="fyemaple" created="Thu, 4 Oct 2018 20:09:53 +0000"  >&lt;p&gt;Really appreciate it Tim for addressing this issue. Yes, having these options is a nice enhancement that enables the user to avoid duplicated contents in the text result.&#160;&lt;/p&gt;</comment>
                            <comment id="16646969" author="hudson" created="Thu, 11 Oct 2018 19:48:27 +0000"  >&lt;p&gt;FAILURE: Integrated in Jenkins build tika-branch-1x #113 (See &lt;a href=&quot;https://builds.apache.org/job/tika-branch-1x/113/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/tika-branch-1x/113/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2735&quot; title=&quot;notes and footer contents are duplicated in extracting text from power point slides&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2735&quot;&gt;&lt;del&gt;TIKA-2735&lt;/del&gt;&lt;/a&gt; &amp;#8211; allow user to avoid extracting &quot;master&quot; sections and notes (tallison: &lt;a href=&quot;https://github.com/apache/tika/commit/307a8bd592d6e25419bbad19aac47cc7de201c4d&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/307a8bd592d6e25419bbad19aac47cc7de201c4d&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) tika-parsers/src/test/java/org/apache/tika/parser/microsoft/ooxml/OOXMLParserTest.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/microsoft/ooxml/XSLFPowerPointExtractorDecorator.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/microsoft/HSLFExtractor.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/test/java/org/apache/tika/parser/microsoft/PowerPointParserTest.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/microsoft/OfficeParserConfig.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/microsoft/ooxml/SXSLFPowerPointExtractorDecorator.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/test/java/org/apache/tika/parser/microsoft/ooxml/SXSLFExtractorTest.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="16670460" author="tallison@mitre.org" created="Wed, 31 Oct 2018 17:51:11 +0000"  >&lt;p&gt;While fixing this, I found that we were definitely duplicating notes.  We were writing them at the end of each slide, and then we repeated them at the end of the presentation.  This is now fixed in 1.20, and the content comparisons are eye-opening.  See the attached report.&lt;/p&gt;</comment>
                            <comment id="16670462" author="fyemaple" created="Wed, 31 Oct 2018 17:53:44 +0000"  >&lt;p&gt;appreciate your efforts and the update Tim!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12941142" name="Oneslide.ppt" size="613376" author="fyemaple" created="Tue, 25 Sep 2018 02:25:53 +0000"/>
                            <attachment id="12946421" name="content_diffs_with_exceptions.xlsx" size="4047805" author="tallison" created="Wed, 31 Oct 2018 17:51:41 +0000"/>
                            <attachment id="12941141" name="pptTextResults.txt" size="5988" author="fyemaple" created="Tue, 25 Sep 2018 02:26:20 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 2 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3yg1b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>