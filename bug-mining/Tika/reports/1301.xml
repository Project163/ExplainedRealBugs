<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:04:08 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[TIKA-3829] java.lang.IllegalArgumentException: The document is really a XLS file exception while parsing doc file</title>
                <link>https://issues.apache.org/jira/browse/TIKA-3829</link>
                <project id="12310631" key="TIKA">Tika</project>
                    <description>&lt;p&gt;Getting following exception while parsing doc file:&lt;/p&gt;

&lt;p&gt;WARN &#160;Ignoring unexpected exception while parsing summary entry �DocumentSummaryInformation&lt;br/&gt;
java.lang.IllegalArgumentException: The document is really a XLS file&lt;br/&gt;
&#160; &#160; at org.apache.poi.poifs.filesystem.DirectoryNode.getEntry(DirectoryNode.java:322)&lt;br/&gt;
&#160; &#160; at org.apache.tika.parser.microsoft.SummaryExtractor.parseSummaryEntryIfExists(SummaryExtractor.java:82)&lt;br/&gt;
&#160; &#160; at org.apache.tika.parser.microsoft.SummaryExtractor.parseSummaries(SummaryExtractor.java:74)&lt;br/&gt;
&#160; &#160; at org.apache.tika.parser.microsoft.OfficeParser.parse(OfficeParser.java:155)&lt;br/&gt;
&#160; &#160; at org.apache.tika.parser.microsoft.OfficeParser.parse(OfficeParser.java:131)&lt;br/&gt;
&#160; &#160; at org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:280)&lt;br/&gt;
&#160; &#160; at org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:280)&lt;br/&gt;
&#160; &#160; at org.apache.tika.parser.AutoDetectParser.parse(AutoDetectParser.java:143)&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;What is the meaning of this exception? when it will be thrown?&lt;/p&gt;</description>
                <environment></environment>
        <key id="13474860">TIKA-3829</key>
            <summary>java.lang.IllegalArgumentException: The document is really a XLS file exception while parsing doc file</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="2">Won&apos;t Fix</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="Little John">John</reporter>
                        <labels>
                    </labels>
                <created>Wed, 3 Aug 2022 10:10:23 +0000</created>
                <updated>Thu, 29 Sep 2022 19:52:06 +0000</updated>
                            <resolved>Thu, 29 Sep 2022 19:52:06 +0000</resolved>
                                    <version>1.23</version>
                                                    <component>parser</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="17574656" author="gagravarr" created="Wed, 3 Aug 2022 10:19:51 +0000"  >&lt;p&gt;Can you share a file that triggers this bug?&lt;/p&gt;

&lt;p&gt;The method in question should only process the summary stream if it exists, so something very odd is going on here&lt;/p&gt;</comment>
                            <comment id="17574659" author="JIRAUSER292452" created="Wed, 3 Aug 2022 10:29:32 +0000"  >&lt;p&gt;Currently, i don&apos;t have the file.&lt;/p&gt;

&lt;p&gt;i also getting exception for DocumentSummaryInformation as well.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&#160;&lt;/p&gt;

&lt;p&gt;WARN &#160;Ignoring unexpected exception while parsing summary entry �DocumentSummaryInformation&lt;br/&gt;
java.lang.IllegalArgumentException: The document is really a XLS file&lt;br/&gt;
&#160; &#160; at org.apache.poi.poifs.filesystem.DirectoryNode.getEntry(DirectoryNode.java:322)&lt;br/&gt;
&#160; &#160; at org.apache.tika.parser.microsoft.SummaryExtractor.parseSummaryEntryIfExists(SummaryExtractor.java:82)&lt;br/&gt;
&#160; &#160; at org.apache.tika.parser.microsoft.SummaryExtractor.parseSummaries(SummaryExtractor.java:74)&lt;br/&gt;
&#160; &#160; at org.apache.tika.parser.microsoft.OfficeParser.parse(OfficeParser.java:155)&lt;br/&gt;
&#160; &#160; at org.apache.tika.parser.microsoft.OfficeParser.parse(OfficeParser.java:131)&lt;br/&gt;
&#160; &#160; at org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:280)&lt;br/&gt;
&#160; &#160; at org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:280)&lt;br/&gt;
&#160; &#160; at org.apache.tika.parser.AutoDetectParser.parse(AutoDetectParser.java:143)&lt;br/&gt;
&#160; &#160; at org.apache.tika.parser.DelegatingParser.parse(DelegatingParser.java:72)&lt;br/&gt;
&#160; &#160; at org.apache.tika.extractor.ParsingEmbeddedDocumentExtractor.parseEmbedded(ParsingEmbeddedDocumentExtractor.java:104)&lt;br/&gt;
&#160; &#160; at org.apache.tika.extractor.EmbeddedDocumentUtil.parseEmbedded(EmbeddedDocumentUtil.java:220)&lt;br/&gt;
&#160; &#160; at org.apache.tika.parser.microsoft.AbstractPOIFSExtractor.handleEmbeddedOfficeDoc(AbstractPOIFSExtractor.java:261)&lt;br/&gt;
&#160; &#160; at org.apache.tika.parser.microsoft.AbstractPOIFSExtractor.handleEmbeddedOfficeDoc(AbstractPOIFSExtractor.java:146)&lt;br/&gt;
&#160; &#160; at org.apache.tika.parser.microsoft.WordExtractor.parse(WordExtractor.java:229)&lt;br/&gt;
&#160; &#160; at org.apache.tika.parser.microsoft.OfficeParser.parse(OfficeParser.java:175)&lt;br/&gt;
&#160; &#160; at org.apache.tika.parser.microsoft.OfficeParser.parse(OfficeParser.java:131)&lt;br/&gt;
&#160; &#160; at org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:280)&lt;br/&gt;
&#160; &#160; at org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:280)&lt;br/&gt;
&#160; &#160; at org.apache.tika.parser.AutoDetectParser.parse(AutoDetectParser.java:143)&lt;/p&gt;

&lt;p&gt;------------------------------------------------------------------------------------&lt;/p&gt;

&lt;p&gt;WARN &#160;Ignoring unexpected exception while parsing summary entry �SummaryInformation&lt;br/&gt;
java.lang.IllegalArgumentException: The document is really a XLS file&lt;br/&gt;
&#160; &#160; at org.apache.poi.poifs.filesystem.DirectoryNode.getEntry(DirectoryNode.java:322)&lt;br/&gt;
&#160; &#160; at org.apache.tika.parser.microsoft.SummaryExtractor.parseSummaryEntryIfExists(SummaryExtractor.java:82)&lt;br/&gt;
&#160; &#160; at org.apache.tika.parser.microsoft.SummaryExtractor.parseSummaries(SummaryExtractor.java:73)&lt;br/&gt;
&#160; &#160; at org.apache.tika.parser.microsoft.OfficeParser.parse(OfficeParser.java:155)&lt;br/&gt;
&#160; &#160; at org.apache.tika.parser.microsoft.OfficeParser.parse(OfficeParser.java:131)&lt;br/&gt;
&#160; &#160; at org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:280)&lt;br/&gt;
&#160; &#160; at org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:280)&lt;br/&gt;
&#160; &#160; at org.apache.tika.parser.AutoDetectParser.parse(AutoDetectParser.java:143)&lt;br/&gt;
&#160; &#160; at org.apache.tika.parser.DelegatingParser.parse(DelegatingParser.java:72)&lt;br/&gt;
&#160; &#160; at org.apache.tika.extractor.ParsingEmbeddedDocumentExtractor.parseEmbedded(ParsingEmbeddedDocumentExtractor.java:104)&lt;br/&gt;
&#160; &#160; at org.apache.tika.extractor.EmbeddedDocumentUtil.parseEmbedded(EmbeddedDocumentUtil.java:220)&lt;br/&gt;
&#160; &#160; at org.apache.tika.parser.microsoft.AbstractPOIFSExtractor.handleEmbeddedOfficeDoc(AbstractPOIFSExtractor.java:261)&lt;br/&gt;
&#160; &#160; at org.apache.tika.parser.microsoft.AbstractPOIFSExtractor.handleEmbeddedOfficeDoc(AbstractPOIFSExtractor.java:146)&lt;br/&gt;
&#160; &#160; at org.apache.tika.parser.microsoft.WordExtractor.parse(WordExtractor.java:229)&lt;br/&gt;
&#160; &#160; at org.apache.tika.parser.microsoft.OfficeParser.parse(OfficeParser.java:175)&lt;br/&gt;
&#160; &#160; at org.apache.tika.parser.microsoft.OfficeParser.parse(OfficeParser.java:131)&lt;br/&gt;
&#160; &#160; at org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:280)&lt;br/&gt;
&#160; &#160; at org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:280)&lt;br/&gt;
&#160; &#160; at org.apache.tika.parser.AutoDetectParser.parse(AutoDetectParser.java:143)&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17574660" author="JIRAUSER292452" created="Wed, 3 Aug 2022 10:33:03 +0000"  >&lt;p&gt;What does it mean? where the problem is in DocumentSummaryInformation and SummaryInformation files or in the tika side.&lt;/p&gt;</comment>
                            <comment id="17574730" author="tallison@mitre.org" created="Wed, 3 Aug 2022 13:35:00 +0000"  >&lt;p&gt;It is difficult to tell without a triggering file.  At least in the development version of 1.x, you get to this warning if the DirectoryNode has a key for summary information, but the value in the map for that key is null.&lt;/p&gt;

&lt;p&gt;Tika&apos;s code:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;            if (! root.hasEntry(entryName)) {
                return;
            }
            DocumentEntry entry =
                    (DocumentEntry) root.getEntry(entryName);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;POI&apos;s code:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;
 public boolean hasEntry(String name) {
        return name != null &amp;amp;&amp;amp; this._byname.containsKey(name);
    }

    public Entry getEntry(String name) throws FileNotFoundException {
        Entry rval = null;
        if (name != null) {
            rval = (Entry)this._byname.get(name);
        }

        if (rval == null) {
            if (this._byname.containsKey(&quot;Workbook&quot;)) {
                throw new IllegalArgumentException(&quot;The document is really a XLS file&quot;);
...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17574733" author="tallison@mitre.org" created="Wed, 3 Aug 2022 13:39:01 +0000"  >&lt;p&gt;Tika 2.x has the same code path.  What I can&apos;t figure out yet from just looking at POI&apos;s code is how there would be an entry with a null value.&lt;/p&gt;</comment>
                            <comment id="17574858" author="hudson" created="Wed, 3 Aug 2022 16:23:18 +0000"  >&lt;p&gt;SUCCESS: Integrated in Jenkins build Tika &#187; tika-main-jdk8 #727 (See &lt;a href=&quot;https://ci-builds.apache.org/job/Tika/job/tika-main-jdk8/727/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://ci-builds.apache.org/job/Tika/job/tika-main-jdk8/727/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-3829&quot; title=&quot;java.lang.IllegalArgumentException: The document is really a XLS file exception while parsing doc file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-3829&quot;&gt;&lt;del&gt;TIKA-3829&lt;/del&gt;&lt;/a&gt; &amp;#8211; shortcut and avoid logging if the summary entry is null (tallison: &lt;a href=&quot;https://github.com/apache/tika/commit/754d6b7fbb6f8fbaa5485b653a2ecb13e086eec8&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/754d6b7fbb6f8fbaa5485b653a2ecb13e086eec8&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-microsoft-module/src/main/java/org/apache/tika/parser/microsoft/SummaryExtractor.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="17574859" author="tallison@mitre.org" created="Wed, 3 Aug 2022 16:25:55 +0000"  >&lt;p&gt;I turned off the warning in 2.x.  If we have an example file, we can try to figure out how that value can be null and determine if that is a parse error or expected.&lt;/p&gt;</comment>
                            <comment id="17575607" author="JIRAUSER292452" created="Fri, 5 Aug 2022 07:00:46 +0000"  >&lt;p&gt;Ok. Will check and get you back if we faced this problem again.&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;There is any way in tika to exclude some file types from extracting content? It also should be excluded even if files are available inside embedded files.&lt;/p&gt;</comment>
                            <comment id="17575883" author="tallison@mitre.org" created="Fri, 5 Aug 2022 14:46:40 +0000"  >&lt;p&gt;You can exclude parsers and exclude specific mime types from parsers via tika-config.  See: &lt;a href=&quot;https://tika.apache.org/2.4.1/configuring.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://tika.apache.org/2.4.1/configuring.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I&apos;m not sure how that would help you.&lt;/p&gt;

&lt;p&gt;You can also turn off this logging via configuration of log4j2.xml.&lt;/p&gt;</comment>
                            <comment id="17611223" author="tallison@mitre.org" created="Thu, 29 Sep 2022 19:52:06 +0000"  >&lt;p&gt;Please reopen if there&apos;s anything that we can do on the Tika side...even if that&apos;s update POI.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 6 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z17fa0:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>