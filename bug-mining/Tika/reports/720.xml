<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:59:46 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[TIKA-1700] tika-config.xml does not provide a way to set ServiceLoader to dynamic</title>
                <link>https://issues.apache.org/jira/browse/TIKA-1700</link>
                <project id="12310631" key="TIKA">Tika</project>
                    <description>&lt;p&gt;Currently if you create a TikaConfig from a file (ex tika-config.xml).  There is no way to specify that you want to use a ServiceLoader with dynamic set.  Prior to tika 1.7 this was not an issue since the during the tika-config.xml parse Tika would instantiate parsers using the default constructor which in turn would instantiate a new ServiceLoader.  The default ServiceLoader constructor sets dynamic to true which allows dynamic loading of parsers.  &lt;/p&gt;

&lt;p&gt;Changes to TikaConfig now cause the tika-config.xml parse to call a constructor which passes the ServiceLoader to be passed as a parameter.  This ServiceLoader is always constructed with a Classloader which will cause dynamic to always be set to false.  This breaks Tika in OSGi environments which depend on dynamic being set to true (for example Apache Sling). &lt;/p&gt;

&lt;p&gt;I&apos;m proposing adding an xml attribute to the parser element to instantiate the parser with dynamic set to true.  This allows users of tika-config.xml to determine how they want parsers loaded. &lt;/p&gt;
</description>
                <environment>&lt;p&gt;OSGi&lt;/p&gt;</environment>
        <key id="12850233">TIKA-1700</key>
            <summary>tika-config.xml does not provide a way to set ServiceLoader to dynamic</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="bobpaulin">Bob Paulin</reporter>
                        <labels>
                    </labels>
                <created>Thu, 30 Jul 2015 12:54:29 +0000</created>
                <updated>Tue, 29 Oct 2019 15:52:15 +0000</updated>
                            <resolved>Sat, 1 Aug 2015 22:11:36 +0000</resolved>
                                    <version>1.7</version>
                    <version>1.8</version>
                    <version>1.9</version>
                    <version>1.10</version>
                                    <fixVersion>1.10</fixVersion>
                                    <component>core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="14647595" author="gagravarr" created="Thu, 30 Jul 2015 13:11:18 +0000"  >&lt;p&gt;We&apos;ve had some discussions on passing options to parsers when they&apos;re created based on the Tika Config xml definition, on the mailing list I think. We should try to make this follow that pattern, but no reason why we can&apos;t then do this first. (This should be easier than the generic case!)&lt;/p&gt;</comment>
                            <comment id="14647654" author="bobpaulin" created="Thu, 30 Jul 2015 13:59:35 +0000"  >&lt;p&gt;Yes I think this allows developers more control over how the services get loaded.  It appears that much of the code in OSGi environments built assumptions around the no arg parser and subsequently the no arg ServiceLoader constructors.  So now that those assumptions can&apos;t be taken for granted I think providing some configuration in the xml is a good approach.&lt;/p&gt;</comment>
                            <comment id="14648404" author="bobpaulin" created="Thu, 30 Jul 2015 22:22:29 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=nick&quot; class=&quot;user-hover&quot; rel=&quot;nick&quot;&gt;nick&lt;/a&gt; Do you have a specific thread from the mailing list you can link in here.  I was having some trouble finding the pattern you&apos;re referring to.  Does the attached Patch fall inline to the pattern you previously discussed?&lt;/p&gt;</comment>
                            <comment id="14648429" author="gagravarr" created="Thu, 30 Jul 2015 22:51:13 +0000"  >&lt;p&gt;The thread you want is &quot;Configuring parsers and translators&quot; which started with this post:&lt;br/&gt;
&lt;a href=&quot;http://mail-archives.apache.org/mod_mbox/incubator-tika-dev/201505.mbox/%3Calpine.DEB.2.02.1505071441170.1392@urchin.earth.li%3E&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://mail-archives.apache.org/mod_mbox/incubator-tika-dev/201505.mbox/%3Calpine.DEB.2.02.1505071441170.1392@urchin.earth.li%3E&lt;/a&gt;&lt;br/&gt;
But was mostly in June.&lt;/p&gt;

&lt;p&gt;Not sure about doing it with an attribute, child elements might work better for the other kinds of parameters/options we need to be able to give to parsers (eg the OCR parser, or the Translation classes)&lt;/p&gt;</comment>
                            <comment id="14649120" author="bobpaulin" created="Fri, 31 Jul 2015 11:55:37 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=nick&quot; class=&quot;user-hover&quot; rel=&quot;nick&quot;&gt;nick&lt;/a&gt; After reading the discussion I think this patch falls more inline with the existing patterns.&lt;/p&gt;</comment>
                            <comment id="14650483" author="gagravarr" created="Sat, 1 Aug 2015 18:06:29 +0000"  >&lt;p&gt;Unfortunately, your patch doesn&apos;t apply any more, as I refactored a lot of that logic just now, sorry!&lt;/p&gt;

&lt;p&gt;However, having looked at the patch, I&apos;m not sure it&apos;s tackling the problem in the right place. Why would you want to set dynamic loading to true or false in the tika config xml for a parser? Would we not be better to add an overloaded method to TikaConfig that took a ServiceLoader, alongside the ClassLoader one? That way, instead of needing to mess around in the config xml, for your OSGi case you could instead do:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;  ServiceLoader loader = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ServiceLoader(dynamicClassLoader, LoadErrorHandler.THROW, &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;);
  TikaConfig config = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; TikaConfig(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; File(&lt;span class=&quot;code-quote&quot;&gt;&quot;/path/to/config.xml&quot;&lt;/span&gt;).toURL(), loader);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Or have I missed something about the need / use-case?&lt;/p&gt;</comment>
                            <comment id="14650530" author="gagravarr" created="Sat, 1 Aug 2015 20:59:17 +0000"  >&lt;p&gt;As of r1693762, there are TikaConfig overloaded constructors that take a ServiceLoader. There are also unit tests showing that they&apos;re being used, though only for the load error handler part, not the dynamic part&lt;/p&gt;</comment>
                            <comment id="14650546" author="bobpaulin" created="Sat, 1 Aug 2015 21:47:07 +0000"  >&lt;p&gt;Apache Jackrabbit for example may be used inside or outside the OSGi environment.  Using the code above for example would require Jackrabbit to have a toggle to determine what to pass for dynamic to the ServiceLoader object.  If it can be done via the tika-config.xml then Jackrabbit does not need to be responsible for this toggle because Tika has already provided it.  Tika owns the service loader logic so I feel it&apos;s best that it provides the switches.  I agree that the parser is the wrong spot to tackle this problem.  I&apos;ve moved higher up in the TikaConfig Logic in the next patch.  I also added some logic to allow the LoadErrorHandler to be defined in xml as well.  &lt;/p&gt;</comment>
                            <comment id="14650549" author="gagravarr" created="Sat, 1 Aug 2015 22:11:36 +0000"  >&lt;p&gt;Thanks for that! Patch applied (with the odd tweak) in r1693773.&lt;/p&gt;

&lt;p&gt;Also, any chance you could add this to our OSGi documentation? And/or start our OSGi documentation and add it in? &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="14650567" author="bobpaulin" created="Sun, 2 Aug 2015 01:04:00 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=nick&quot; class=&quot;user-hover&quot; rel=&quot;nick&quot;&gt;nick&lt;/a&gt; Sure where do you keep your docs?&lt;/p&gt;</comment>
                            <comment id="14650573" author="gagravarr" created="Sun, 2 Aug 2015 02:20:48 +0000"  >&lt;p&gt;Canonical stuff lives in version-specific folders under &lt;a href=&quot;https://svn.apache.org/repos/asf/tika/site/src/site/apt&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/repos/asf/tika/site/src/site/apt&lt;/a&gt; , which gets published onto the main site, while stuff that&apos;s crowdsourced and/or up-for-debate goes in &lt;a href=&quot;http://wiki.apache.org/tika/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://wiki.apache.org/tika/&lt;/a&gt; . I&apos;d suggest going for whichever you feel is the best fit!&lt;/p&gt;</comment>
                            <comment id="14650640" author="hudson" created="Sun, 2 Aug 2015 08:21:21 +0000"  >&lt;p&gt;SUCCESS: Integrated in tika-trunk-jdk1.7 #809 (See &lt;a href=&quot;https://builds.apache.org/job/tika-trunk-jdk1.7/809/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/tika-trunk-jdk1.7/809/&lt;/a&gt;)&lt;br/&gt;
Patch from Bob Paulin from &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1700&quot; title=&quot;tika-config.xml does not provide a way to set ServiceLoader to dynamic&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1700&quot;&gt;&lt;del&gt;TIKA-1700&lt;/del&gt;&lt;/a&gt; - Allow setting the Service Loader dynamic flag and load error handler from the tika config xml (nick: &lt;a href=&quot;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1693773&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1693773&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/tika/trunk/tika-core/src/main/java/org/apache/tika/config/ServiceLoader.java&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-core/src/main/java/org/apache/tika/config/TikaConfig.java&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-core/src/test/java/org/apache/tika/config/DummyParser.java&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-core/src/test/java/org/apache/tika/config/TikaConfigTest.java&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-core/src/test/resources/org/apache/tika/config/&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1700&quot; title=&quot;tika-config.xml does not provide a way to set ServiceLoader to dynamic&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1700&quot;&gt;&lt;del&gt;TIKA-1700&lt;/del&gt;&lt;/a&gt;-dynamic.xml&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1700&quot; title=&quot;tika-config.xml does not provide a way to set ServiceLoader to dynamic&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1700&quot;&gt;&lt;del&gt;TIKA-1700&lt;/del&gt;&lt;/a&gt; Add TikaConfig constructors that take a ServiceLoader, and add a unit test that shows we (now) use the LoadErrorHandler on that properly for reporting problems with listed class names (nick: &lt;a href=&quot;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1693759&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1693759&lt;/a&gt;)&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-core/src/main/java/org/apache/tika/config/ServiceLoader.java&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-core/src/main/java/org/apache/tika/config/TikaConfig.java&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-core/src/test/java/org/apache/tika/config/AbstractTikaConfigTest.java&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-core/src/test/java/org/apache/tika/config/TikaConfigTest.java&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-core/src/test/resources/org/apache/tika/config/&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1700&quot; title=&quot;tika-config.xml does not provide a way to set ServiceLoader to dynamic&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1700&quot;&gt;&lt;del&gt;TIKA-1700&lt;/del&gt;&lt;/a&gt;-unknown-parser.xml&lt;br/&gt;
Move AbstractTikaConfigTest to Core, and use that to shorten TikaConfigTest &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1700&quot; title=&quot;tika-config.xml does not provide a way to set ServiceLoader to dynamic&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1700&quot;&gt;&lt;del&gt;TIKA-1700&lt;/del&gt;&lt;/a&gt; (nick: &lt;a href=&quot;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1693753&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1693753&lt;/a&gt;)&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-core/src/test/java/org/apache/tika/config/AbstractTikaConfigTest.java&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-core/src/test/java/org/apache/tika/config/TikaConfigTest.java&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-parsers/src/test/java/org/apache/tika/config/AbstractTikaConfigTest.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12822690">SLING-4645</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12844623">TIKA-1677</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13265070">TIKA-2977</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13017185">OAK-5048</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12747989" name="TIKA-1700.patch" size="5908" author="bobpaulin" created="Thu, 30 Jul 2015 13:53:25 +0000"/>
                            <attachment id="12748160" name="TIKA-1700A.patch" size="5646" author="bobpaulin" created="Fri, 31 Jul 2015 11:55:37 +0000"/>
                            <attachment id="12748332" name="TIKA-1700B.patch" size="6739" author="bobpaulin" created="Sat, 1 Aug 2015 21:47:07 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310250" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10430"><![CDATA[Patch]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 15 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2i4br:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>