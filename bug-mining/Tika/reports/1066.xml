<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:02:14 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[TIKA-2776] Tika server child restart</title>
                <link>https://issues.apache.org/jira/browse/TIKA-2776</link>
                <project id="12310631" key="TIKA">Tika</project>
                    <description>&lt;p&gt;Hallo.&lt;br/&gt;
I use tika server standalone started with the option:&lt;br/&gt;
java -jar /opt/tika/tika-server-1.19.1.jar -spawnChild&lt;/p&gt;

&lt;p&gt;I use ManifoldCF and Solr to index file using tika server.&lt;br/&gt;
It happens that indexing is continuously crashed because I obtain many:&lt;br/&gt;
Tika down, retrying: Connection reset&lt;br/&gt;
etc.&lt;/p&gt;

&lt;p&gt;I suspect that, when a process is restarted, the client crash as mentioned here:&lt;br/&gt;
&lt;em&gt;If the child process is in the process of shutting down, and it gets a new request it will return 503 &amp;#8211; Service Unavailable. If the server times out on a file, the client will receive an IOException from the closed socket. Note that all other files that are being processed will end with an IOException from a closed socket when the child process shuts down; e.g. if you send three files to tika-server concurrently, and one of them causes a catastrophic problem requiring the child to shut down, you won&apos;t be able to tell which file caused the problems. In the future, we may implement a gentler shutdown than we currently have.&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;as reported here &lt;a href=&quot;https://wiki.apache.org/tika/TikaJAXRS&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://wiki.apache.org/tika/TikaJAXRS&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;How could I workaround it ?&lt;/p&gt;

&lt;p&gt;Thanks a lot&lt;/p&gt;

&lt;p&gt;Mario&lt;/p&gt;</description>
                <environment></environment>
        <key id="13197444">TIKA-2776</key>
            <summary>Tika server child restart</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tallison">Tim Allison</assignee>
                                    <reporter username="bisontim">Mario Bisonti</reporter>
                        <labels>
                    </labels>
                <created>Fri, 9 Nov 2018 15:26:37 +0000</created>
                <updated>Fri, 30 Nov 2018 21:11:49 +0000</updated>
                            <resolved>Wed, 14 Nov 2018 21:49:56 +0000</resolved>
                                                    <fixVersion>2.0.0</fixVersion>
                    <fixVersion>1.20</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="16681992" author="tallison@mitre.org" created="Fri, 9 Nov 2018 22:09:17 +0000"  >&lt;p&gt;How often is the child crashing?  Can you tell what is causing the problems?  Is the child actually starting successfully...are you getting any files parsed?&lt;/p&gt;</comment>
                            <comment id="16684907" author="bisontim" created="Tue, 13 Nov 2018 09:00:40 +0000"  >&lt;p&gt;Hallo Tim.&lt;br/&gt;
I have the response:&lt;br/&gt;
Error: Repeated service interruptions - failure processing document: The target server failed to respond&lt;/p&gt;

&lt;p&gt;From the ManifoldCF side I read the log:&lt;br/&gt;
org.apache.manifoldcf.core.interfaces.ManifoldCFException: Repeated service interruptions - failure processing document: The target server failed to respond&lt;br/&gt;
	at org.apache.manifoldcf.crawler.system.WorkerThread.run(WorkerThread.java:489) &lt;span class=&quot;error&quot;&gt;&amp;#91;mcf-pull-agent.jar:?&amp;#93;&lt;/span&gt;&lt;br/&gt;
Caused by: org.apache.http.NoHttpResponseException: The target server failed to respond&lt;br/&gt;
	at org.apache.http.impl.conn.DefaultHttpResponseParser.parseHead(DefaultHttpResponseParser.java:141) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;httpclient-4.5.6.jar:4.5.6&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.apache.http.impl.conn.DefaultHttpResponseParser.parseHead(DefaultHttpResponseParser.java:56) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;httpclient-4.5.6.jar:4.5.6&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.apache.http.impl.io.AbstractMessageParser.parse(AbstractMessageParser.java:259) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;httpcore-4.4.10.jar:4.4.10&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.apache.http.impl.DefaultBHttpClientConnection.receiveResponseHeader(DefaultBHttpClientConnection.java:163) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;httpcore-4.4.10.jar:4.4.10&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.apache.http.impl.conn.CPoolProxy.receiveResponseHeader(CPoolProxy.java:165) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;httpclient-4.5.6.jar:4.5.6&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.apache.http.protocol.HttpRequestExecutor.doReceiveResponse(HttpRequestExecutor.java:273) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;httpcore-4.4.10.jar:4.4.10&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.apache.http.protocol.HttpRequestExecutor.execute(HttpRequestExecutor.java:125) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;httpcore-4.4.10.jar:4.4.10&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.apache.http.impl.execchain.MainClientExec.execute(MainClientExec.java:272) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;httpclient-4.5.6.jar:4.5.6&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.apache.http.impl.execchain.ProtocolExec.execute(ProtocolExec.java:185) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;httpclient-4.5.6.jar:4.5.6&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.apache.http.impl.execchain.RedirectExec.execute(RedirectExec.java:110) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;httpclient-4.5.6.jar:4.5.6&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.apache.http.impl.client.InternalHttpClient.doExecute(InternalHttpClient.java:185) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;httpclient-4.5.6.jar:4.5.6&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.apache.http.impl.client.CloseableHttpClient.execute(CloseableHttpClient.java:118) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;httpclient-4.5.6.jar:4.5.6&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.apache.http.impl.client.CloseableHttpClient.execute(CloseableHttpClient.java:56) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;httpclient-4.5.6.jar:4.5.6&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.apache.manifoldcf.agents.transformation.tikaservice.TikaExtractor.addOrReplaceDocumentWithException(TikaExtractor.java:608) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;?:?&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.apache.manifoldcf.agents.incrementalingest.IncrementalIngester$PipelineAddEntryPoint.addOrReplaceDocumentWithException(IncrementalIngester.java:3226) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;mcf-agents.jar:?&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.apache.manifoldcf.agents.incrementalingest.IncrementalIngester$PipelineAddFanout.sendDocument(IncrementalIngester.java:3077) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;mcf-agents.jar:?&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.apache.manifoldcf.agents.incrementalingest.IncrementalIngester$MonitoredAddActivityWrapper.sendDocument(IncrementalIngester.java:3471) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;mcf-agents.jar:?&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.apache.manifoldcf.agents.transformation.documentfilter.DocumentFilter.addOrReplaceDocumentWithException(DocumentFilter.java:208) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;?:?&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.apache.manifoldcf.agents.incrementalingest.IncrementalIngester$PipelineAddEntryPoint.addOrReplaceDocumentWithException(IncrementalIngester.java:3226) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;mcf-agents.jar:?&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.apache.manifoldcf.agents.incrementalingest.IncrementalIngester$PipelineAddFanout.sendDocument(IncrementalIngester.java:3077) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;mcf-agents.jar:?&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.apache.manifoldcf.agents.incrementalingest.IncrementalIngester$PipelineObjectWithVersions.addOrReplaceDocumentWithException(IncrementalIngester.java:2708) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;mcf-agents.jar:?&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.apache.manifoldcf.agents.incrementalingest.IncrementalIngester.documentIngest(IncrementalIngester.java:756) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;mcf-agents.jar:?&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.apache.manifoldcf.crawler.system.WorkerThread$ProcessActivity.ingestDocumentWithException(WorkerThread.java:1583) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;mcf-pull-agent.jar:?&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.apache.manifoldcf.crawler.system.WorkerThread$ProcessActivity.ingestDocumentWithException(WorkerThread.java:1548) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;mcf-pull-agent.jar:?&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.apache.manifoldcf.crawler.connectors.sharedrive.SharedDriveConnector.processDocuments(SharedDriveConnector.java:939) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;?:?&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.apache.manifoldcf.crawler.system.WorkerThread.run(WorkerThread.java:399) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;mcf-pull-agent.jar:?&amp;#93;&lt;/span&gt;&lt;br/&gt;
 WARN 2018-11-13T09:50:58,546 (Worker thread &apos;48&apos;) - Service interruption reported for job 1533797717712 connection &apos;WinShare&apos;: Tika down, retrying: Connect to localhost:9998 &lt;span class=&quot;error&quot;&gt;&amp;#91;localhost/127.0.0.1, localhost/0:0:0:0:0:0:0:1&amp;#93;&lt;/span&gt; failed: Connection refused (Connection refused)&lt;br/&gt;
 WARN 2018-11-13T09:50:58,606 (Worker thread &apos;34&apos;) - Service interruption reported for job 1533797717712 connection &apos;WinShare&apos;: Tika down, retrying: Connect to localhost:9998 &lt;span class=&quot;error&quot;&gt;&amp;#91;localhost/127.0.0.1, localhost/0:0:0:0:0:0:0:1&amp;#93;&lt;/span&gt; failed: Connection refused (Connection refused)&lt;br/&gt;
 WARN 2018-11-13T09:50:58,947 (Worker thread &apos;0&apos;) - Service interruption reported for job 1533797717712 connection &apos;WinShare&apos;: Tika down, retrying: Connect to localhost:9998 &lt;span class=&quot;error&quot;&gt;&amp;#91;localhost/127.0.0.1, localhost/0:0:0:0:0:0:0:1&amp;#93;&lt;/span&gt; failed: Connection refused (Connection refused)&lt;br/&gt;
 WARN 2018-11-13T09:50:58,948 (Worker thread &apos;61&apos;) - Service interruption reported for job 1533797717712 connection &apos;WinShare&apos;: Tika down, retrying: Connect to localhost:9998 &lt;span class=&quot;error&quot;&gt;&amp;#91;localhost/127.0.0.1, localhost/0:0:0:0:0:0:0:1&amp;#93;&lt;/span&gt; failed: Connection refused (Connection refused)&lt;br/&gt;
 WARN 2018-11-13T09:50:58,947 (Worker thread &apos;10&apos;) - Service interruption reported for job 1533797717712 connection &apos;WinShare&apos;: Tika down, retrying: Connect to localhost:9998 &lt;span class=&quot;error&quot;&gt;&amp;#91;localhost/127.0.0.1, localhost/0:0:0:0:0:0:0:1&amp;#93;&lt;/span&gt; failed: Connection refused (Connection refused)&lt;br/&gt;
 WARN 2018-11-13T09:50:59,344 (Worker thread &apos;5&apos;) - Service interruption reported for job 1533797717712 connection &apos;WinShare&apos;: Tika down, retrying: Connect to localhost:9998 &lt;span class=&quot;error&quot;&gt;&amp;#91;localhost/127.0.0.1, localhost/0:0:0:0:0:0:0:1&amp;#93;&lt;/span&gt; failed: Connection refused (Connection refused)&lt;/p&gt;

&lt;p&gt;I see that Tika server restarts correctly the child but I hav no log from Tika server.&lt;/p&gt;

&lt;p&gt;For me is very difficult to investigate why tika server child is restarted/crashed.&lt;/p&gt;

&lt;p&gt;Is there any way to log Tika server?&lt;/p&gt;


&lt;p&gt;Thanks a lot&lt;br/&gt;
Mario&lt;/p&gt;</comment>
                            <comment id="16685640" author="tallison@mitre.org" created="Tue, 13 Nov 2018 19:27:08 +0000"  >&lt;blockquote&gt;&lt;p&gt;For me is very difficult to investigate why tika server child is restarted/crashed. Is there any way to log Tika server?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;You should be able to use log4j for the parent process as you would expect: &lt;br/&gt;
&lt;tt&gt;-Dlog4j.configuration=&lt;a href=&quot;file://log4j.xml/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;file:log4j.xml&lt;/a&gt;&lt;/tt&gt;. You can select between &lt;tt&gt;info&lt;/tt&gt; and &lt;tt&gt;debug&lt;/tt&gt; when you start the server: &lt;tt&gt;-log info&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;To specify jvm arguments for the child process, add &lt;tt&gt;-J&lt;/tt&gt; to the beginning &lt;br/&gt;
&lt;tt&gt;-JDlog4j.configuration=&lt;a href=&quot;file://log4j_child.xml/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;file:log4j_child.xml&lt;/a&gt;&lt;/tt&gt;.&lt;/p&gt;</comment>
                            <comment id="16685641" author="tallison@mitre.org" created="Tue, 13 Nov 2018 19:27:49 +0000"  >&lt;p&gt;I haven&apos;t actually tried the above yet... Will do so soon, though, and update our wiki.&lt;/p&gt;</comment>
                            <comment id="16685853" author="tallison@mitre.org" created="Tue, 13 Nov 2018 22:44:38 +0000"  >&lt;p&gt;Y, the above works with the caveat that log appenders should not go to STDOUT in the child process:&#160; See:&#160;&lt;a href=&quot;https://wiki.apache.org/tika/TikaJAXRS#Logging&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://wiki.apache.org/tika/TikaJAXRS#Logging&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16685881" author="tallison@mitre.org" created="Tue, 13 Nov 2018 23:15:55 +0000"  >&lt;p&gt;The limitation on STDOUT is a serious (but trivial-to-fix) bug: &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2782&quot; title=&quot;Protect IPC via stdout in child process in tika-server in -spawnChild mode&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2782&quot;&gt;&lt;del&gt;TIKA-2782&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;I wonder if that&apos;s causing your problems?&lt;/p&gt;</comment>
                            <comment id="16686191" author="bisontim" created="Wed, 14 Nov 2018 08:19:59 +0000"  >&lt;p&gt;Hallo Tim.&lt;br/&gt;
I am not so expert on logging.. be patient please &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;I configures log4j.xml and log4j_child.xml as in the attachment&lt;br/&gt;
I started:&lt;br/&gt;
java -jar /opt/tika/tika-server-1.19.1.jar -Dlog4j.configuration=&lt;a href=&quot;file:log4j.xml&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;file:log4j.xml&lt;/a&gt; -JDlog4j.configuration=&lt;a href=&quot;file:log4j_child.xml&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;file:log4j_child.xml&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;but I obtain:&lt;br/&gt;
administrator@sengvivv02:/opt/tika$ java -jar /opt/tika/tika-server-1.19.1.jar -Dlog4j.configuration=&lt;a href=&quot;file:log4j.xml&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;file:log4j.xml&lt;/a&gt; -JDlog4j.configuration=&lt;a href=&quot;file:log4j_child.xml&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;file:log4j_child.xml&lt;/a&gt;&lt;br/&gt;
Nov 14, 2018 9:14:58 AM org.apache.tika.config.InitializableProblemHandler$3 handleInitializableProblem&lt;br/&gt;
WARNING: J2KImageReader not loaded. JPEG2000 files will not be processed.&lt;br/&gt;
See &lt;a href=&quot;https://pdfbox.apache.org/2.0/dependencies.html#jai-image-io&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://pdfbox.apache.org/2.0/dependencies.html#jai-image-io&lt;/a&gt;&lt;br/&gt;
for optional dependencies.&lt;/p&gt;

&lt;p&gt;Nov 14, 2018 9:14:58 AM org.apache.tika.config.InitializableProblemHandler$3 handleInitializableProblem&lt;br/&gt;
WARNING: org.xerial&apos;s sqlite-jdbc is not loaded.&lt;br/&gt;
Please provide the jar on your classpath to parse sqlite files.&lt;br/&gt;
See tika-parsers/pom.xml for the correct version.&lt;br/&gt;
INFO  Starting Apache Tika 1.19.1 server&lt;br/&gt;
org.apache.commons.cli.UnrecognizedOptionException: Unrecognized option: -Dlog4j.configuration=&lt;a href=&quot;file:log4j.xml&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;file:log4j.xml&lt;/a&gt;&lt;br/&gt;
        at org.apache.commons.cli.Parser.processOption(Parser.java:363)&lt;br/&gt;
        at org.apache.commons.cli.Parser.parse(Parser.java:199)&lt;br/&gt;
        at org.apache.commons.cli.Parser.parse(Parser.java:85)&lt;br/&gt;
        at org.apache.tika.server.TikaServerCli.execute(TikaServerCli.java:133)&lt;br/&gt;
        at org.apache.tika.server.TikaServerCli.main(TikaServerCli.java:117)&lt;br/&gt;
ERROR Can&apos;t start:&lt;br/&gt;
org.apache.commons.cli.UnrecognizedOptionException: Unrecognized option: -Dlog4j.configuration=&lt;a href=&quot;file:log4j.xml&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;file:log4j.xml&lt;/a&gt;&lt;br/&gt;
        at org.apache.commons.cli.Parser.processOption(Parser.java:363)&lt;br/&gt;
        at org.apache.commons.cli.Parser.parse(Parser.java:199)&lt;br/&gt;
        at org.apache.commons.cli.Parser.parse(Parser.java:85)&lt;br/&gt;
        at org.apache.tika.server.TikaServerCli.execute(TikaServerCli.java:133)&lt;br/&gt;
        at org.apache.tika.server.TikaServerCli.main(TikaServerCli.java:117)&lt;/p&gt;

&lt;p&gt;and no log in the directory.&lt;br/&gt;
What&apos;s wrong?&lt;/p&gt;

&lt;p&gt;Thanks&lt;br/&gt;
Mario&lt;/p&gt;


&lt;p&gt; &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12949050/12949050_log4j_child.xml&quot; title=&quot;log4j_child.xml attached to TIKA-2776&quot;&gt;log4j_child.xml&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;  &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12948097/12948097_log4j.xml&quot; title=&quot;log4j.xml attached to TIKA-2776&quot;&gt;log4j.xml&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt; &lt;/p&gt;</comment>
                            <comment id="16686336" author="bisontim" created="Wed, 14 Nov 2018 10:39:46 +0000"  >&lt;p&gt;This is the errors that I see on my screen:&lt;br/&gt;
ERROR Problem with writing the data, class org.apache.tika.server.resource.TikaResource$5, ContentType: text/plain&lt;br/&gt;
WARN  Interceptor for &lt;/p&gt;
{http://resource.server.tika.apache.org/}
&lt;p&gt;MetadataResource has thrown exception, unwinding now&lt;br/&gt;
org.apache.cxf.interceptor.Fault: Java heap space&lt;br/&gt;
        at org.apache.cxf.jaxrs.interceptor.JAXRSOutInterceptor.handleWriteException(JAXRSOutInterceptor.java:396)&lt;br/&gt;
        at org.apache.cxf.jaxrs.interceptor.JAXRSOutInterceptor.serializeMessage(JAXRSOutInterceptor.java:272)&lt;br/&gt;
        at org.apache.cxf.jaxrs.interceptor.JAXRSOutInterceptor.processResponse(JAXRSOutInterceptor.java:122)&lt;br/&gt;
        at org.apache.cxf.jaxrs.interceptor.JAXRSOutInterceptor.handleMessage(JAXRSOutInterceptor.java:84)&lt;br/&gt;
        at org.apache.cxf.phase.PhaseInterceptorChain.doIntercept(PhaseInterceptorChain.java:308)&lt;br/&gt;
        at org.apache.cxf.interceptor.OutgoingChainInterceptor.handleMessage(OutgoingChainInterceptor.java:90)&lt;br/&gt;
        at org.apache.cxf.phase.PhaseInterceptorChain.doIntercept(PhaseInterceptorChain.java:308)&lt;br/&gt;
        at org.apache.cxf.transport.ChainInitiationObserver.onMessage(ChainInitiationObserver.java:121)&lt;br/&gt;
        at org.apache.cxf.transport.http.AbstractHTTPDestination.invoke(AbstractHTTPDestination.java:267)&lt;br/&gt;
        at org.apache.cxf.transport.http_jetty.JettyHTTPDestination.doService(JettyHTTPDestination.java:247)&lt;br/&gt;
        at org.apache.cxf.transport.http_jetty.JettyHTTPHandler.handle(JettyHTTPHandler.java:79)&lt;br/&gt;
        at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:132)&lt;br/&gt;
        at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:257)&lt;br/&gt;
        at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1317)&lt;br/&gt;
        at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:205)&lt;br/&gt;
        at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1219)&lt;br/&gt;
        at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:144)&lt;br/&gt;
        at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:219)&lt;br/&gt;
        at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:132)&lt;br/&gt;
        at org.eclipse.jetty.server.Server.handle(Server.java:531)&lt;br/&gt;
        at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:352)&lt;br/&gt;
        at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:260)&lt;br/&gt;
        at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:281)&lt;br/&gt;
        at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:102)&lt;br/&gt;
        at org.eclipse.jetty.io.ChannelEndPoint$2.run(ChannelEndPoint.java:118)&lt;br/&gt;
        at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:333)&lt;br/&gt;
        at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:310)&lt;br/&gt;
        at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:168)&lt;br/&gt;
        at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:126)&lt;br/&gt;
        at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:366)&lt;br/&gt;
        at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:762)&lt;br/&gt;
        at org.eclipse.jetty.util.thread.QueuedThreadPool$2.run(QueuedThreadPool.java:680)&lt;br/&gt;
        at java.lang.Thread.run(Unknown Source)&lt;br/&gt;
Caused by: java.lang.OutOfMemoryError: Java heap space&lt;br/&gt;
        at java.util.Arrays.copyOf(Unknown Source)&lt;br/&gt;
        at java.io.ByteArrayOutputStream.toByteArray(Unknown Source)&lt;br/&gt;
        at org.apache.poi.util.IOUtils.toByteArray(IOUtils.java:166)&lt;br/&gt;
        at org.apache.poi.util.IOUtils.toByteArray(IOUtils.java:120)&lt;br/&gt;
        at org.apache.poi.openxml4j.util.ZipArchiveFakeEntry.&amp;lt;init&amp;gt;(ZipArchiveFakeEntry.java:47)&lt;br/&gt;
        at org.apache.poi.openxml4j.util.ZipInputStreamZipEntrySource.&amp;lt;init&amp;gt;(ZipInputStreamZipEntrySource.java:51)&lt;br/&gt;
        at org.apache.poi.openxml4j.opc.ZipPackage.&amp;lt;init&amp;gt;(ZipPackage.java:106)&lt;br/&gt;
        at org.apache.poi.openxml4j.opc.OPCPackage.open(OPCPackage.java:298)&lt;br/&gt;
        at org.apache.tika.parser.microsoft.ooxml.OOXMLExtractorFactory.parse(OOXMLExtractorFactory.java:85)&lt;br/&gt;
        at org.apache.tika.parser.microsoft.ooxml.OOXMLParser.parse(OOXMLParser.java:110)&lt;br/&gt;
        at org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:280)&lt;br/&gt;
        at org.apache.tika.parser.ParserDecorator.parse(ParserDecorator.java:188)&lt;br/&gt;
        at org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:280)&lt;br/&gt;
        at org.apache.tika.parser.AutoDetectParser.parse(AutoDetectParser.java:143)&lt;br/&gt;
        at org.apache.tika.parser.DelegatingParser.parse(DelegatingParser.java:72)&lt;br/&gt;
        at org.apache.tika.extractor.ParsingEmbeddedDocumentExtractor.parseEmbedded(ParsingEmbeddedDocumentExtractor.java:102)&lt;br/&gt;
        at org.apache.tika.parser.microsoft.ooxml.AbstractOOXMLExtractor.handleEmbeddedFile(AbstractOOXMLExtractor.java:391)&lt;br/&gt;
        at org.apache.tika.parser.microsoft.ooxml.AbstractOOXMLExtractor.handleEmbeddedPart(AbstractOOXMLExtractor.java:264)&lt;br/&gt;
        at org.apache.tika.parser.microsoft.ooxml.AbstractOOXMLExtractor.handleEmbeddedParts(AbstractOOXMLExtractor.java:206)&lt;br/&gt;
        at org.apache.tika.parser.microsoft.ooxml.AbstractOOXMLExtractor.getXHTML(AbstractOOXMLExtractor.java:139)&lt;br/&gt;
        at org.apache.tika.parser.microsoft.ooxml.OOXMLExtractorFactory.parse(OOXMLExtractorFactory.java:156)&lt;br/&gt;
        at org.apache.tika.parser.microsoft.ooxml.OOXMLParser.parse(OOXMLParser.java:110)&lt;br/&gt;
        at org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:280)&lt;br/&gt;
        at org.apache.tika.parser.ParserDecorator.parse(ParserDecorator.java:188)&lt;br/&gt;
        at org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:280)&lt;br/&gt;
        at org.apache.tika.parser.AutoDetectParser.parse(AutoDetectParser.java:143)&lt;br/&gt;
        at org.apache.tika.server.resource.TikaResource.parse(TikaResource.java:402)&lt;br/&gt;
        at org.apache.tika.server.resource.TikaResource$5.write(TikaResource.java:513)&lt;br/&gt;
        at org.apache.cxf.jaxrs.provider.BinaryDataProvider.writeTo(BinaryDataProvider.java:177)&lt;br/&gt;
        at org.apache.cxf.jaxrs.utils.JAXRSUtils.writeMessageBody(JAXRSUtils.java:1391)&lt;br/&gt;
        at org.apache.cxf.jaxrs.interceptor.JAXRSOutInterceptor.serializeMessage(JAXRSOutInterceptor.java:246)&lt;br/&gt;
        at org.apache.cxf.jaxrs.interceptor.JAXRSOutInterceptor.processResponse(JAXRSOutInterceptor.java:122)&lt;br/&gt;
INFO  meta (application/pdf)&lt;br/&gt;
WARN  javax.ws.rs.WebApplicationException: HTTP 503 Service Unavailable&lt;br/&gt;
        at org.apache.tika.server.resource.TikaResource.checkIsOperating(TikaResource.java:423)&lt;br/&gt;
        at org.apache.tika.server.resource.TikaResource.parse(TikaResource.java:397)&lt;br/&gt;
        at org.apache.tika.server.resource.MetadataResource.parseMetadata(MetadataResource.java:126)&lt;br/&gt;
        at org.apache.tika.server.resource.MetadataResource.getMetadata(MetadataResource.java:60)&lt;br/&gt;
        at sun.reflect.GeneratedMethodAccessor3.invoke(Unknown Source)&lt;br/&gt;
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)&lt;br/&gt;
        at java.lang.reflect.Method.invoke(Unknown Source)&lt;br/&gt;
        at org.apache.cxf.service.invoker.AbstractInvoker.performInvocation(AbstractInvoker.java:179)&lt;br/&gt;
        at org.apache.cxf.service.invoker.AbstractInvoker.invoke(AbstractInvoker.java:96)&lt;br/&gt;
        at org.apache.cxf.jaxrs.JAXRSInvoker.invoke(JAXRSInvoker.java:193)&lt;br/&gt;
        at org.apache.cxf.jaxrs.JAXRSInvoker.invoke(JAXRSInvoker.java:103)&lt;br/&gt;
        at org.apache.cxf.interceptor.ServiceInvokerInterceptor$1.run(ServiceInvokerInterceptor.java:59)&lt;br/&gt;
        at org.apache.cxf.interceptor.ServiceInvokerInterceptor.handleMessage(ServiceInvokerInterceptor.java:96)&lt;br/&gt;
        at org.apache.cxf.phase.PhaseInterceptorChain.doIntercept(PhaseInterceptorChain.java:308)&lt;br/&gt;
        at org.apache.cxf.transport.ChainInitiationObserver.onMessage(ChainInitiationObserver.java:121)&lt;br/&gt;
        at org.apache.cxf.transport.http.AbstractHTTPDestination.invoke(AbstractHTTPDestination.java:267)&lt;br/&gt;
        at org.apache.cxf.transport.http_jetty.JettyHTTPDestination.doService(JettyHTTPDestination.java:247)&lt;br/&gt;
        at org.apache.cxf.transport.http_jetty.JettyHTTPHandler.handle(JettyHTTPHandler.java:79)&lt;br/&gt;
        at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:132)&lt;br/&gt;
        at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:257)&lt;br/&gt;
        at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1317)&lt;br/&gt;
        at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:205)&lt;br/&gt;
        at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1219)&lt;br/&gt;
        at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:144)&lt;br/&gt;
        at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:219)&lt;br/&gt;
        at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:132)&lt;br/&gt;
        at org.eclipse.jetty.server.Server.handle(Server.java:531)&lt;br/&gt;
        at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:352)&lt;br/&gt;
        at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:260)&lt;br/&gt;
        at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:281)&lt;br/&gt;
        at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:102)&lt;br/&gt;
        at org.eclipse.jetty.io.ChannelEndPoint$2.run(ChannelEndPoint.java:118)&lt;br/&gt;
        at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:333)&lt;br/&gt;
        at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:310)&lt;br/&gt;
        at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:168)&lt;br/&gt;
        at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:126)&lt;br/&gt;
        at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:366)&lt;br/&gt;
        at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:762)&lt;br/&gt;
        at org.eclipse.jetty.util.thread.QueuedThreadPool$2.run(QueuedThreadPool.java:680)&lt;br/&gt;
        at java.lang.Thread.run(Unknown Source)&lt;/p&gt;

&lt;p&gt;INFO  meta (application/pdf)&lt;br/&gt;
WARN  javax.ws.rs.WebApplicationException: HTTP 503 Service Unavailable&lt;br/&gt;
        at org.apache.tika.server.resource.TikaResource.checkIsOperating(TikaResource.java:423)&lt;br/&gt;
        at org.apache.tika.server.resource.TikaResource.parse(TikaResource.java:397)&lt;br/&gt;
        at org.apache.tika.server.resource.MetadataResource.parseMetadata(MetadataResource.java:126)&lt;br/&gt;
        at org.apache.tika.server.resource.MetadataResource.getMetadata(MetadataResource.java:60)&lt;br/&gt;
        at sun.reflect.GeneratedMethodAccessor3.invoke(Unknown Source)&lt;br/&gt;
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)&lt;br/&gt;
        at java.lang.reflect.Method.invoke(Unknown Source)&lt;br/&gt;
        at org.apache.cxf.service.invoker.AbstractInvoker.performInvocation(AbstractInvoker.java:179)&lt;br/&gt;
        at org.apache.cxf.service.invoker.AbstractInvoker.invoke(AbstractInvoker.java:96)&lt;br/&gt;
        at org.apache.cxf.jaxrs.JAXRSInvoker.invoke(JAXRSInvoker.java:193)&lt;br/&gt;
        at org.apache.cxf.jaxrs.JAXRSInvoker.invoke(JAXRSInvoker.java:103)&lt;br/&gt;
        at org.apache.cxf.interceptor.ServiceInvokerInterceptor$1.run(ServiceInvokerInterceptor.java:59)&lt;br/&gt;
        at org.apache.cxf.interceptor.ServiceInvokerInterceptor.handleMessage(ServiceInvokerInterceptor.java:96)&lt;br/&gt;
        at org.apache.cxf.phase.PhaseInterceptorChain.doIntercept(PhaseInterceptorChain.java:308)&lt;br/&gt;
        at org.apache.cxf.transport.ChainInitiationObserver.onMessage(ChainInitiationObserver.java:121)&lt;br/&gt;
        at org.apache.cxf.transport.http.AbstractHTTPDestination.invoke(AbstractHTTPDestination.java:267)&lt;br/&gt;
        at org.apache.cxf.transport.http_jetty.JettyHTTPDestination.doService(JettyHTTPDestination.java:247)&lt;br/&gt;
        at org.apache.cxf.transport.http_jetty.JettyHTTPHandler.handle(JettyHTTPHandler.java:79)&lt;br/&gt;
        at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:132)&lt;br/&gt;
        at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:257)&lt;br/&gt;
        at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1317)&lt;br/&gt;
        at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:205)&lt;br/&gt;
        at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1219)&lt;br/&gt;
        at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:144)&lt;br/&gt;
        at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:219)&lt;br/&gt;
        at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:132)&lt;br/&gt;
        at org.eclipse.jetty.server.Server.handle(Server.java:531)&lt;br/&gt;
        at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:352)&lt;br/&gt;
        at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:260)&lt;br/&gt;
        at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:281)&lt;br/&gt;
        at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:102)&lt;br/&gt;
        at org.eclipse.jetty.io.ChannelEndPoint$2.run(ChannelEndPoint.java:118)&lt;br/&gt;
        at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:333)&lt;br/&gt;
        at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:310)&lt;br/&gt;
        at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:168)&lt;br/&gt;
        at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:126)&lt;br/&gt;
        at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:366)&lt;br/&gt;
        at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:762)&lt;br/&gt;
        at org.eclipse.jetty.util.thread.QueuedThreadPool$2.run(QueuedThreadPool.java:680)&lt;br/&gt;
        at java.lang.Thread.run(Unknown Source)&lt;/p&gt;

&lt;p&gt;INFO  meta (application/pdf)&lt;br/&gt;
WARN  javax.ws.rs.WebApplicationException: HTTP 503 Service Unavailable&lt;br/&gt;
        at org.apache.tika.server.resource.TikaResource.checkIsOperating(TikaResource.java:423)&lt;br/&gt;
        at org.apache.tika.server.resource.TikaResource.parse(TikaResource.java:397)&lt;br/&gt;
        at org.apache.tika.server.resource.MetadataResource.parseMetadata(MetadataResource.java:126)&lt;br/&gt;
        at org.apache.tika.server.resource.MetadataResource.getMetadata(MetadataResource.java:60)&lt;br/&gt;
        at sun.reflect.GeneratedMethodAccessor3.invoke(Unknown Source)&lt;br/&gt;
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)&lt;br/&gt;
        at java.lang.reflect.Method.invoke(Unknown Source)&lt;br/&gt;
        at org.apache.cxf.service.invoker.AbstractInvoker.performInvocation(AbstractInvoker.java:179)&lt;br/&gt;
        at org.apache.cxf.service.invoker.AbstractInvoker.invoke(AbstractInvoker.java:96)&lt;br/&gt;
        at org.apache.cxf.jaxrs.JAXRSInvoker.invoke(JAXRSInvoker.java:193)&lt;br/&gt;
        at org.apache.cxf.jaxrs.JAXRSInvoker.invoke(JAXRSInvoker.java:103)&lt;br/&gt;
        at org.apache.cxf.interceptor.ServiceInvokerInterceptor$1.run(ServiceInvokerInterceptor.java:59)&lt;br/&gt;
        at org.apache.cxf.interceptor.ServiceInvokerInterceptor.handleMessage(ServiceInvokerInterceptor.java:96)&lt;br/&gt;
        at org.apache.cxf.phase.PhaseInterceptorChain.doIntercept(PhaseInterceptorChain.java:308)&lt;br/&gt;
        at org.apache.cxf.transport.ChainInitiationObserver.onMessage(ChainInitiationObserver.java:121)&lt;br/&gt;
        at org.apache.cxf.transport.http.AbstractHTTPDestination.invoke(AbstractHTTPDestination.java:267)&lt;br/&gt;
        at org.apache.cxf.transport.http_jetty.JettyHTTPDestination.doService(JettyHTTPDestination.java:247)&lt;br/&gt;
        at org.apache.cxf.transport.http_jetty.JettyHTTPHandler.handle(JettyHTTPHandler.java:79)&lt;br/&gt;
        at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:132)&lt;br/&gt;
        at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:257)&lt;br/&gt;
        at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1317)&lt;br/&gt;
        at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:205)&lt;br/&gt;
        at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1219)&lt;br/&gt;
        at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:144)&lt;br/&gt;
        at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:219)&lt;br/&gt;
        at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:132)&lt;br/&gt;
        at org.eclipse.jetty.server.Server.handle(Server.java:531)&lt;br/&gt;
        at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:352)&lt;br/&gt;
        at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:260)&lt;br/&gt;
        at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:281)&lt;br/&gt;
        at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:102)&lt;br/&gt;
        at org.eclipse.jetty.io.ChannelEndPoint$2.run(ChannelEndPoint.java:118)&lt;br/&gt;
        at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:333)&lt;br/&gt;
        at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:310)&lt;br/&gt;
        at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:168)&lt;br/&gt;
        at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:126)&lt;br/&gt;
        at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:366)&lt;br/&gt;
        at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:762)&lt;br/&gt;
        at org.eclipse.jetty.util.thread.QueuedThreadPool$2.run(QueuedThreadPool.java:680)&lt;br/&gt;
        at java.lang.Thread.run(Unknown Source)&lt;/p&gt;

&lt;p&gt;INFO  meta (application/pdf)&lt;br/&gt;
WARN  javax.ws.rs.WebApplicationException: HTTP 503 Service Unavailable&lt;br/&gt;
        at org.apache.tika.server.resource.TikaResource.checkIsOperating(TikaResource.java:423)&lt;br/&gt;
        at org.apache.tika.server.resource.TikaResource.parse(TikaResource.java:397)&lt;br/&gt;
        at org.apache.tika.server.resource.MetadataResource.parseMetadata(MetadataResource.java:126)&lt;br/&gt;
        at org.apache.tika.server.resource.MetadataResource.getMetadata(MetadataResource.java:60)&lt;br/&gt;
        at sun.reflect.GeneratedMethodAccessor3.invoke(Unknown Source)&lt;br/&gt;
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)&lt;br/&gt;
        at java.lang.reflect.Method.invoke(Unknown Source)&lt;br/&gt;
        at org.apache.cxf.service.invoker.AbstractInvoker.performInvocation(AbstractInvoker.java:179)&lt;br/&gt;
        at org.apache.cxf.service.invoker.AbstractInvoker.invoke(AbstractInvoker.java:96)&lt;br/&gt;
        at org.apache.cxf.jaxrs.JAXRSInvoker.invoke(JAXRSInvoker.java:193)&lt;br/&gt;
        at org.apache.cxf.jaxrs.JAXRSInvoker.invoke(JAXRSInvoker.java:103)&lt;br/&gt;
        at org.apache.cxf.interceptor.ServiceInvokerInterceptor$1.run(ServiceInvokerInterceptor.java:59)&lt;br/&gt;
        at org.apache.cxf.interceptor.ServiceInvokerInterceptor.handleMessage(ServiceInvokerInterceptor.java:96)&lt;br/&gt;
        at org.apache.cxf.phase.PhaseInterceptorChain.doIntercept(PhaseInterceptorChain.java:308)&lt;br/&gt;
        at org.apache.cxf.transport.ChainInitiationObserver.onMessage(ChainInitiationObserver.java:121)&lt;br/&gt;
        at org.apache.cxf.transport.http.AbstractHTTPDestination.invoke(AbstractHTTPDestination.java:267)&lt;br/&gt;
        at org.apache.cxf.transport.http_jetty.JettyHTTPDestination.doService(JettyHTTPDestination.java:247)&lt;br/&gt;
        at org.apache.cxf.transport.http_jetty.JettyHTTPHandler.handle(JettyHTTPHandler.java:79)&lt;br/&gt;
        at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:132)&lt;br/&gt;
        at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:257)&lt;br/&gt;
        at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1317)&lt;br/&gt;
        at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:205)&lt;br/&gt;
        at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1219)&lt;br/&gt;
        at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:144)&lt;br/&gt;
        at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:219)&lt;br/&gt;
        at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:132)&lt;br/&gt;
        at org.eclipse.jetty.server.Server.handle(Server.java:531)&lt;br/&gt;
        at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:352)&lt;br/&gt;
        at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:260)&lt;br/&gt;
        at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:281)&lt;br/&gt;
        at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:102)&lt;br/&gt;
        at org.eclipse.jetty.io.ChannelEndPoint$2.run(ChannelEndPoint.java:118)&lt;br/&gt;
        at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:333)&lt;br/&gt;
        at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:310)&lt;br/&gt;
        at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:168)&lt;br/&gt;
        at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:126)&lt;br/&gt;
        at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:366)&lt;br/&gt;
        at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:762)&lt;br/&gt;
        at org.eclipse.jetty.util.thread.QueuedThreadPool$2.run(QueuedThreadPool.java:680)&lt;br/&gt;
        at java.lang.Thread.run(Unknown Source)&lt;/p&gt;

&lt;p&gt;INFO  meta (application/pdf)&lt;br/&gt;
WARN  javax.ws.rs.WebApplicationException: HTTP 503 Service Unavailable&lt;br/&gt;
        at org.apache.tika.server.resource.TikaResource.checkIsOperating(TikaResource.java:423)&lt;br/&gt;
        at org.apache.tika.server.resource.TikaResource.parse(TikaResource.java:397)&lt;br/&gt;
        at org.apache.tika.server.resource.MetadataResource.parseMetadata(MetadataResource.java:126)&lt;br/&gt;
        at org.apache.tika.server.resource.MetadataResource.getMetadata(MetadataResource.java:60)&lt;br/&gt;
        at sun.reflect.GeneratedMethodAccessor3.invoke(Unknown Source)&lt;br/&gt;
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)&lt;br/&gt;
        at java.lang.reflect.Method.invoke(Unknown Source)&lt;br/&gt;
        at org.apache.cxf.service.invoker.AbstractInvoker.performInvocation(AbstractInvoker.java:179)&lt;br/&gt;
        at org.apache.cxf.service.invoker.AbstractInvoker.invoke(AbstractInvoker.java:96)&lt;br/&gt;
        at org.apache.cxf.jaxrs.JAXRSInvoker.invoke(JAXRSInvoker.java:193)&lt;br/&gt;
        at org.apache.cxf.jaxrs.JAXRSInvoker.invoke(JAXRSInvoker.java:103)&lt;br/&gt;
        at org.apache.cxf.interceptor.ServiceInvokerInterceptor$1.run(ServiceInvokerInterceptor.java:59)&lt;br/&gt;
        at org.apache.cxf.interceptor.ServiceInvokerInterceptor.handleMessage(ServiceInvokerInterceptor.java:96)&lt;br/&gt;
        at org.apache.cxf.phase.PhaseInterceptorChain.doIntercept(PhaseInterceptorChain.java:308)&lt;br/&gt;
        at org.apache.cxf.transport.ChainInitiationObserver.onMessage(ChainInitiationObserver.java:121)&lt;br/&gt;
        at org.apache.cxf.transport.http.AbstractHTTPDestination.invoke(AbstractHTTPDestination.java:267)&lt;br/&gt;
        at org.apache.cxf.transport.http_jetty.JettyHTTPDestination.doService(JettyHTTPDestination.java:247)&lt;br/&gt;
        at org.apache.cxf.transport.http_jetty.JettyHTTPHandler.handle(JettyHTTPHandler.java:79)&lt;br/&gt;
        at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:132)&lt;br/&gt;
        at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:257)&lt;br/&gt;
        at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1317)&lt;br/&gt;
        at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:205)&lt;br/&gt;
        at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1219)&lt;br/&gt;
        at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:144)&lt;br/&gt;
        at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:219)&lt;br/&gt;
        at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:132)&lt;br/&gt;
        at org.eclipse.jetty.server.Server.handle(Server.java:531)&lt;br/&gt;
        at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:352)&lt;br/&gt;
        at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:260)&lt;br/&gt;
        at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:281)&lt;br/&gt;
        at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:102)&lt;br/&gt;
        at org.eclipse.jetty.io.ChannelEndPoint$2.run(ChannelEndPoint.java:118)&lt;br/&gt;
        at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:333)&lt;br/&gt;
        at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:310)&lt;br/&gt;
        at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:168)&lt;br/&gt;
        at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:126)&lt;br/&gt;
        at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:366)&lt;br/&gt;
        at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:762)&lt;br/&gt;
        at org.eclipse.jetty.util.thread.QueuedThreadPool$2.run(QueuedThreadPool.java:680)&lt;br/&gt;
        at java.lang.Thread.run(Unknown Source)&lt;/p&gt;

&lt;p&gt;INFO  meta (application/pdf)&lt;br/&gt;
WARN  javax.ws.rs.WebApplicationException: HTTP 503 Service Unavailable&lt;br/&gt;
        at org.apache.tika.server.resource.TikaResource.checkIsOperating(TikaResource.java:423)&lt;br/&gt;
        at org.apache.tika.server.resource.TikaResource.parse(TikaResource.java:397)&lt;br/&gt;
        at org.apache.tika.server.resource.MetadataResource.parseMetadata(MetadataResource.java:126)&lt;br/&gt;
        at org.apache.tika.server.resource.MetadataResource.getMetadata(MetadataResource.java:60)&lt;br/&gt;
        at sun.reflect.GeneratedMethodAccessor3.invoke(Unknown Source)&lt;br/&gt;
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)&lt;br/&gt;
        at java.lang.reflect.Method.invoke(Unknown Source)&lt;br/&gt;
        at org.apache.cxf.service.invoker.AbstractInvoker.performInvocation(AbstractInvoker.java:179)&lt;br/&gt;
        at org.apache.cxf.service.invoker.AbstractInvoker.invoke(AbstractInvoker.java:96)&lt;br/&gt;
        at org.apache.cxf.jaxrs.JAXRSInvoker.invoke(JAXRSInvoker.java:193)&lt;br/&gt;
        at org.apache.cxf.jaxrs.JAXRSInvoker.invoke(JAXRSInvoker.java:103)&lt;br/&gt;
        at org.apache.cxf.interceptor.ServiceInvokerInterceptor$1.run(ServiceInvokerInterceptor.java:59)&lt;br/&gt;
        at org.apache.cxf.interceptor.ServiceInvokerInterceptor.handleMessage(ServiceInvokerInterceptor.java:96)&lt;br/&gt;
        at org.apache.cxf.phase.PhaseInterceptorChain.doIntercept(PhaseInterceptorChain.java:308)&lt;br/&gt;
        at org.apache.cxf.transport.ChainInitiationObserver.onMessage(ChainInitiationObserver.java:121)&lt;br/&gt;
        at org.apache.cxf.transport.http.AbstractHTTPDestination.invoke(AbstractHTTPDestination.java:267)&lt;br/&gt;
        at org.apache.cxf.transport.http_jetty.JettyHTTPDestination.doService(JettyHTTPDestination.java:247)&lt;br/&gt;
        at org.apache.cxf.transport.http_jetty.JettyHTTPHandler.handle(JettyHTTPHandler.java:79)&lt;br/&gt;
        at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:132)&lt;br/&gt;
        at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:257)&lt;br/&gt;
        at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1317)&lt;br/&gt;
        at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:205)&lt;br/&gt;
        at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1219)&lt;br/&gt;
        at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:144)&lt;br/&gt;
        at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:219)&lt;br/&gt;
        at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:132)&lt;br/&gt;
        at org.eclipse.jetty.server.Server.handle(Server.java:531)&lt;br/&gt;
        at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:352)&lt;br/&gt;
        at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:260)&lt;br/&gt;
        at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:281)&lt;br/&gt;
        at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:102)&lt;br/&gt;
        at org.eclipse.jetty.io.ChannelEndPoint$2.run(ChannelEndPoint.java:118)&lt;br/&gt;
        at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:333)&lt;br/&gt;
        at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:310)&lt;br/&gt;
        at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:168)&lt;br/&gt;
        at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:126)&lt;br/&gt;
        at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:366)&lt;br/&gt;
        at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:762)&lt;br/&gt;
        at org.eclipse.jetty.util.thread.QueuedThreadPool$2.run(QueuedThreadPool.java:680)&lt;br/&gt;
        at java.lang.Thread.run(Unknown Source)&lt;/p&gt;











</comment>
                            <comment id="16686522" author="tallison@mitre.org" created="Wed, 14 Nov 2018 13:57:48 +0000"  >&lt;blockquote&gt;&lt;p&gt;I am not so expert on logging.. be patient please &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Ha!  No problem at all! &lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;I configures log4j.xml and log4j_child.xml as in the attachment...&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I &lt;em&gt;think&lt;/em&gt; I just fixed this in &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2782&quot; title=&quot;Protect IPC via stdout in child process in tika-server in -spawnChild mode&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2782&quot;&gt;&lt;del&gt;TIKA-2782&lt;/del&gt;&lt;/a&gt;.  For now, you have to avoid &lt;tt&gt;debug=&quot;true&quot;&lt;/tt&gt;&lt;/p&gt;

</comment>
                            <comment id="16686597" author="tallison@mitre.org" created="Wed, 14 Nov 2018 14:39:03 +0000"  >&lt;blockquote&gt;&lt;p&gt;Caused by: java.lang.OutOfMemoryError: Java heap space&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Victory!!!  Try bumping up your -Xmx for the child process: &lt;tt&gt;-JXmx2g&lt;/tt&gt; or similar.&lt;/p&gt;

&lt;p&gt;This actually shows that &lt;tt&gt;-spawnChild&lt;/tt&gt; is working...I think?&lt;/p&gt;</comment>
                            <comment id="16686620" author="tallison@mitre.org" created="Wed, 14 Nov 2018 14:52:49 +0000"  >&lt;p&gt;The other thing you might want to do...if you aren&apos;t already...is add a &lt;tt&gt;waitForServer&lt;/tt&gt; loop along the lines of what I did in TikaServerIntegrationTest...for when your client hits a 503.&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;    private void awaitServerStartup() throws Exception {

        Instant started = Instant.now();
        long elapsed = Duration.between(started, Instant.now()).toMillis();
        while (elapsed &amp;lt; 30000) {
            try {
                Response response = WebClient
                        .create(endPoint + &quot;/tika&quot;)
                        .accept(&quot;text/plain&quot;)
                        .get();
                if (response.getStatus() == 200) {
                    return;
                }
            } catch (javax.ws.rs.ProcessingException e) {
            }
            Thread.sleep(100);
            elapsed = Duration.between(started, Instant.now()).toMillis();
        }

    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="16686689" author="bisontim" created="Wed, 14 Nov 2018 15:25:53 +0000"  >&lt;p&gt;Hallo Tim.&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;The error &quot;Caused by: java.lang.OutOfMemoryError: Java heap space&quot; happened when I tried to use Tika, launching&lt;br/&gt;
 java -jar /opt/tika/tika-server-1.19.1.jar&lt;br/&gt;
 so WITHOUT the option &quot;-spawnChild&quot;.&lt;/li&gt;
	&lt;li&gt;When you said&#160;&lt;em&gt;The other thing you might want to do...if you aren&apos;t already...is add a&#160;&lt;tt&gt;waitForServer&lt;/tt&gt;&#160;loop along the lines of what I did in TikaServerIntegrationTest...for when your client hits a 503.&lt;/em&gt;&#160;&lt;br/&gt;
 Do you mean to put the code that you mention, in the client that calls tika server?&lt;br/&gt;
 In my case ManifoldCF ?&lt;br/&gt;
 If yes, I will forward your suggestion to the ManifoldCF owner&lt;/li&gt;
	&lt;li&gt;Now I tried to start tika server in my windows host, with the option -spawnChild, to split ManildCF-Solr and Tika server, and the job is working by 5 hours without crash!&lt;br/&gt;
 Note that in my widows host I use:&lt;br/&gt;
 java -version&lt;br/&gt;
 java version &quot;1.8.0_92&quot;&lt;br/&gt;
 Java(TM) SE Runtime Environment (build 1.8.0_92-b14)&lt;br/&gt;
 Java HotSpot(TM) 64-Bit Server VM (build 25.92-b14, mixed mode)&lt;br/&gt;
 instead, in the Ubuntu host, where there are ManildCF-Solr and where I used, before this test of splitting, the tika server with the job that stpped repeatedly, I use:&lt;br/&gt;
 java -version&lt;br/&gt;
openjdk version &quot;10.0.2&quot; 2018-07-17&lt;br/&gt;
OpenJDK Runtime Environment (build 10.0.2+13-Ubuntu-1ubuntu0.18.04.3)&lt;br/&gt;
OpenJDK 64-Bit Server VM (build 10.0.2+13-Ubuntu-1ubuntu0.18.04.3, mixed mode)&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;Do you know if there is any issue about the java version where tika server runs?&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Thanks a lot a lot.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Mario&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="16687043" author="tallison@mitre.org" created="Wed, 14 Nov 2018 19:55:30 +0000"  >&lt;p&gt;&amp;gt;&amp;gt;. 1. Problem wasn&#8217;t with -spawnChild&lt;/p&gt;

&lt;p&gt;OMG...legacy mode shouldn&#8217;t check if server is shutting down.  This is a bad bug.  If running in legacy mode, once you hit an oom, the server now returns 503 indefinitely...ugh... at least you can use the new feature -spawnChild to get around the bug I introduced into legacy when I added -spawnChild...head in hands...will fix ASAP.&lt;/p&gt;

&lt;p&gt;&amp;gt;&amp;gt; 2. Still seems to be running...&lt;br/&gt;
Great! Y. That&#8217;s the goal of -spawnChild. The server will restart itself on serious error/timeout.&lt;/p&gt;

&lt;p&gt;&amp;gt;&amp;gt;3. On diff versions of java&lt;/p&gt;

&lt;p&gt;I&#8217;m not aware of any significant differences, but I haven&#8217;t looked yet.&lt;/p&gt;</comment>
                            <comment id="16687047" author="tallison@mitre.org" created="Wed, 14 Nov 2018 19:58:48 +0000"  >&lt;p&gt;Oops...on mobile...2... should you notify Manifold project. Yes, once they are comfortable with the -spawnChild option, the client has to be able to handle the tika-server being actually down or 503 intermittently when it restarts on serious problem.&lt;/p&gt;

&lt;p&gt;As for logging, let me know if you&#8217;ve gotten that working...that is critical.&lt;/p&gt;</comment>
                            <comment id="16687175" author="tallison@mitre.org" created="Wed, 14 Nov 2018 21:49:56 +0000"  >&lt;p&gt;This is a really bad bug that I introduced into regular/legacy &lt;tt&gt;tika-server&lt;/tt&gt;.  Because of this bug, tika-server will return 503 on every document you try to send to it after it hits an OOM.  The workaround in versions &amp;lt; 1.20 is to use the &lt;tt&gt;-spawnChild&lt;/tt&gt; mode.&lt;/p&gt;

&lt;p&gt;Frankly, it is a bad thing that the server hit an OOM and something should happen, but we absolutely should not have changed the legacy behavior ... albeit accidentally.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=bisontim&quot; class=&quot;user-hover&quot; rel=&quot;bisontim&quot;&gt;bisontim&lt;/a&gt;, thank you for sharing this with us!  Again, please let us know if you need help with configuring logging.&lt;/p&gt;</comment>
                            <comment id="16687197" author="hudson" created="Wed, 14 Nov 2018 22:05:37 +0000"  >&lt;p&gt;SUCCESS: Integrated in Jenkins build Tika-trunk #1595 (See &lt;a href=&quot;https://builds.apache.org/job/Tika-trunk/1595/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Tika-trunk/1595/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2776&quot; title=&quot;Tika server child restart&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2776&quot;&gt;&lt;del&gt;TIKA-2776&lt;/del&gt;&lt;/a&gt; &amp;#8211; tika-server in legacy mode should ignore oom. (tallison: &lt;a href=&quot;https://github.com/apache/tika/commit/8d9061d281f7f46ecae8b902e27c49777ec43919&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/8d9061d281f7f46ecae8b902e27c49777ec43919&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) tika-server/src/test/java/org/apache/tika/server/TikaServerIntegrationTest.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-server/src/main/java/org/apache/tika/server/TikaServerCli.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-server/src/main/java/org/apache/tika/server/ServerStatus.java&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2776&quot; title=&quot;Tika server child restart&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2776&quot;&gt;&lt;del&gt;TIKA-2776&lt;/del&gt;&lt;/a&gt; &amp;#8211; update CHANGES.txt (tallison: &lt;a href=&quot;https://github.com/apache/tika/commit/6710c52efe3cf8b220773ac9df85bb2f292d4415&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/6710c52efe3cf8b220773ac9df85bb2f292d4415&lt;/a&gt;)&lt;/li&gt;
	&lt;li&gt;(edit) CHANGES.txt&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="16687208" author="hudson" created="Wed, 14 Nov 2018 22:12:44 +0000"  >&lt;p&gt;SUCCESS: Integrated in Jenkins build tika-branch-1x #128 (See &lt;a href=&quot;https://builds.apache.org/job/tika-branch-1x/128/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/tika-branch-1x/128/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2776&quot; title=&quot;Tika server child restart&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2776&quot;&gt;&lt;del&gt;TIKA-2776&lt;/del&gt;&lt;/a&gt; &amp;#8211; tika-server in legacy mode should ignore oom. (tallison: &lt;a href=&quot;https://github.com/apache/tika/commit/22f57072dfc96da6ef27e053a09f9b648552f2f2&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/22f57072dfc96da6ef27e053a09f9b648552f2f2&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) tika-server/src/main/java/org/apache/tika/server/TikaServerCli.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-server/src/main/java/org/apache/tika/server/ServerStatus.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-server/src/test/java/org/apache/tika/server/TikaServerIntegrationTest.java&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2776&quot; title=&quot;Tika server child restart&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2776&quot;&gt;&lt;del&gt;TIKA-2776&lt;/del&gt;&lt;/a&gt; &amp;#8211; update CHANGES.txt (tallison: &lt;a href=&quot;https://github.com/apache/tika/commit/9e2a9bbd6e6ec6dc1ec6ecf39b6b850318df3219&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/9e2a9bbd6e6ec6dc1ec6ecf39b6b850318df3219&lt;/a&gt;)&lt;/li&gt;
	&lt;li&gt;(edit) CHANGES.txt&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="16687242" author="hudson" created="Wed, 14 Nov 2018 22:37:07 +0000"  >&lt;p&gt;UNSTABLE: Integrated in Jenkins build tika-2.x-windows #350 (See &lt;a href=&quot;https://builds.apache.org/job/tika-2.x-windows/350/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/tika-2.x-windows/350/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2776&quot; title=&quot;Tika server child restart&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2776&quot;&gt;&lt;del&gt;TIKA-2776&lt;/del&gt;&lt;/a&gt; &amp;#8211; tika-server in legacy mode should ignore oom. (tallison: rev 8d9061d281f7f46ecae8b902e27c49777ec43919)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) tika-server/src/main/java/org/apache/tika/server/ServerStatus.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-server/src/test/java/org/apache/tika/server/TikaServerIntegrationTest.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-server/src/main/java/org/apache/tika/server/TikaServerCli.java&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2776&quot; title=&quot;Tika server child restart&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2776&quot;&gt;&lt;del&gt;TIKA-2776&lt;/del&gt;&lt;/a&gt; &amp;#8211; update CHANGES.txt (tallison: rev 6710c52efe3cf8b220773ac9df85bb2f292d4415)&lt;/li&gt;
	&lt;li&gt;(edit) CHANGES.txt&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2776&quot; title=&quot;Tika server child restart&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2776&quot;&gt;&lt;del&gt;TIKA-2776&lt;/del&gt;&lt;/a&gt; &amp;#8211; update CHANGES.txt (tallison: rev c037fb71e1d5e9e549a12f77c620229465763abf)&lt;/li&gt;
	&lt;li&gt;(edit) CHANGES.txt&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="16687264" author="hudson" created="Wed, 14 Nov 2018 23:05:30 +0000"  >&lt;p&gt;SUCCESS: Integrated in Jenkins build tika-branch-1x #129 (See &lt;a href=&quot;https://builds.apache.org/job/tika-branch-1x/129/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/tika-branch-1x/129/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2776&quot; title=&quot;Tika server child restart&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2776&quot;&gt;&lt;del&gt;TIKA-2776&lt;/del&gt;&lt;/a&gt; &amp;#8211; update CHANGES.txt (tallison: &lt;a href=&quot;https://github.com/apache/tika/commit/0a3a8be32659f1f0e5c29eb602d8caf149c347e5&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/0a3a8be32659f1f0e5c29eb602d8caf149c347e5&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) CHANGES.txt&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="16687267" author="hudson" created="Wed, 14 Nov 2018 23:08:42 +0000"  >&lt;p&gt;SUCCESS: Integrated in Jenkins build Tika-trunk #1596 (See &lt;a href=&quot;https://builds.apache.org/job/Tika-trunk/1596/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Tika-trunk/1596/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2776&quot; title=&quot;Tika server child restart&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2776&quot;&gt;&lt;del&gt;TIKA-2776&lt;/del&gt;&lt;/a&gt; &amp;#8211; update CHANGES.txt (tallison: &lt;a href=&quot;https://github.com/apache/tika/commit/c037fb71e1d5e9e549a12f77c620229465763abf&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/c037fb71e1d5e9e549a12f77c620229465763abf&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) CHANGES.txt&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="16688313" author="bisontim" created="Thu, 15 Nov 2018 16:34:52 +0000"  >&lt;p&gt;Hallo Tim&lt;/p&gt;

&lt;p&gt;I delayed the client to avoid the 503 error and I am using on another ubuntu host, the tika server snapshot:&lt;br/&gt;
&#160;java -jar /opt/tika/tika-server-1.20-20181114.215706-48.jar --host=hostnameubuntu&#160;-spawnChild&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;I will update you if the scanning works.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Thanks a lot!&lt;/p&gt;

&lt;p&gt;Mario&lt;/p&gt;</comment>
                            <comment id="16691675" author="bisontim" created="Mon, 19 Nov 2018 13:04:41 +0000"  >&lt;p&gt;Hallo.&lt;/p&gt;

&lt;p&gt;I obtained, from the client calling Tika server, after 5 hours of processing files, the error:&lt;/p&gt;

&lt;p&gt;WARN 2018-11-19T13:47:17,888 (Worker thread &apos;56&apos;) - Service interruption reported for job 1533797717712 connection &apos;WinShare&apos;: Tika down, retrying: Connect to hostanmeubuntu:9998 &lt;span class=&quot;error&quot;&gt;&amp;#91;hostanmeubuntu/172.16.1.135&amp;#93;&lt;/span&gt; failed: Connection refused (Connection refused)&lt;br/&gt;
 WARN 2018-11-19T13:47:18,006 (Worker thread &apos;96&apos;) - Service interruption reported for job 1533797717712 connection &apos;WinShare&apos;: Tika down, retrying: Connect to hostanmeubuntu:9998 &lt;span class=&quot;error&quot;&gt;&amp;#91;hostanmeubuntu/172.16.1.135&amp;#93;&lt;/span&gt; failed: Connection refused (Connection refused)&lt;br/&gt;
 WARN 2018-11-19T13:47:18,006 (Worker thread &apos;20&apos;) - Service interruption reported for job 1533797717712 connection &apos;WinShare&apos;: Tika down, retrying: Connect to hostanmeubuntu:9998 &lt;span class=&quot;error&quot;&gt;&amp;#91;hostanmeubuntu/172.16.1.135&amp;#93;&lt;/span&gt; failed: Connection refused (Connection refused)&lt;br/&gt;
 WARN 2018-11-19T13:47:18,071 (Worker thread &apos;26&apos;) - Service interruption reported for job 1533797717712 connection &apos;WinShare&apos;: Tika down, retrying: Connect to hostanmeubuntu:9998 &lt;span class=&quot;error&quot;&gt;&amp;#91;hostanmeubuntu/172.16.1.135&amp;#93;&lt;/span&gt; failed: Connection refused (Connection refused)&lt;br/&gt;
 WARN 2018-11-19T13:47:18,116 (Worker thread &apos;27&apos;) - JCIFS: Possibly transient exception detected on attempt 1 while getting share security: All pipe instances are busy.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Perhaps it could due to:&lt;br/&gt;
 &lt;em&gt;If the server times out on a file, the client will receive an IOException from the closed socket. Note that all other files that are being processed will end with an IOException from a closed socket when the child process shuts down; e.g. if you send three files to tika-server concurrently, and one of them causes a catastrophic problem requiring the child to shut down, you won&apos;t be able to tell which file caused the problems. In the future, we may implement a gentler shutdown than we currently have.&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Perhaps could a gentler shutdown solve the problem?&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Thanks&lt;/p&gt;

&lt;p&gt;Mario&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="16693784" author="tallison@mitre.org" created="Tue, 20 Nov 2018 20:59:43 +0000"  >&lt;p&gt;I don&apos;t &lt;em&gt;think&lt;/em&gt; that&apos;s the problem.  From the logs above, it looks like the client only waited a quarter of a second.  It can take 20-30 seconds to restart tika-server.&lt;/p&gt;

&lt;p&gt;If I can help you configure the logs for the child process, that&apos;s probably best to figure out what&apos;s going on.&lt;/p&gt;</comment>
                            <comment id="16694508" author="bisontim" created="Wed, 21 Nov 2018 10:05:32 +0000"  >&lt;p&gt;I tried to start:&lt;br/&gt;
C:\Temp\Tika&amp;gt;java -jar tika-server-1.19.1.jar --host=myhostname -spawnchild -JDlog4j.configuration=file:&quot;log4j_child.xml&quot; -log info&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Where log4_child.xml is:&lt;/p&gt;

&lt;p&gt;&lt;em&gt;&amp;lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&amp;gt;&lt;/em&gt;&lt;br/&gt;
&lt;em&gt;&amp;lt;!DOCTYPE log4j:configuration SYSTEM &quot;log4j.dtd&quot;&amp;gt;&lt;/em&gt;&lt;br/&gt;
&lt;em&gt;&amp;lt;log4j:configuration debug=&quot;false&quot;&lt;/em&gt;&lt;br/&gt;
 &lt;em&gt;xmlns:log4j=&apos;http://jakarta.apache.org/log4j/&apos;&amp;gt;&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;&amp;lt;appender name=&quot;console&quot; class=&quot;org.apache.log4j.ConsoleAppender&quot;&amp;gt;&lt;/em&gt;&lt;br/&gt;
 &lt;em&gt;&amp;lt;layout class=&quot;org.apache.log4j.PatternLayout&quot;&amp;gt;&lt;/em&gt;&lt;br/&gt;
 &lt;em&gt;&amp;lt;param name=&quot;ConversionPattern&quot;&lt;/em&gt; &lt;br/&gt;
 &lt;em&gt;value=&quot;%d{yyyy-MM-dd HH:mm:ss} %-5p %c{1}:%L - %m%n&quot; /&amp;gt;&lt;/em&gt;&lt;br/&gt;
 &lt;em&gt;&amp;lt;/layout&amp;gt;&lt;/em&gt;&lt;br/&gt;
 &lt;em&gt;&amp;lt;/appender&amp;gt;&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;&amp;lt;appender name=&quot;file&quot; class=&quot;org.apache.log4j.RollingFileAppender&quot;&amp;gt;&lt;/em&gt;&lt;br/&gt;
 &lt;em&gt;&amp;lt;param name=&quot;append&quot; value=&quot;false&quot; /&amp;gt;&lt;/em&gt;&lt;br/&gt;
 &lt;em&gt;&amp;lt;param name=&quot;maxFileSize&quot; value=&quot;10MB&quot; /&amp;gt;&lt;/em&gt;&lt;br/&gt;
 &lt;em&gt;&amp;lt;param name=&quot;maxBackupIndex&quot; value=&quot;10&quot; /&amp;gt;&lt;/em&gt;&lt;br/&gt;
 &lt;em&gt;&amp;lt;param name=&quot;file&quot; value=&quot;C:/Temp/tika/tikalog_child.log&quot; /&amp;gt;&lt;/em&gt;&lt;br/&gt;
 &lt;em&gt;&amp;lt;layout class=&quot;org.apache.log4j.PatternLayout&quot;&amp;gt;&lt;/em&gt;&lt;br/&gt;
 &lt;em&gt;&amp;lt;param name=&quot;ConversionPattern&quot;&lt;/em&gt; &lt;br/&gt;
 &lt;em&gt;value=&quot;%d{yyyy-MM-dd HH:mm:ss} %-5p %c{1}:%L - %m%n&quot; /&amp;gt;&lt;/em&gt;&lt;br/&gt;
 &lt;em&gt;&amp;lt;/layout&amp;gt;&lt;/em&gt;&lt;br/&gt;
 &lt;em&gt;&amp;lt;/appender&amp;gt;&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;&amp;lt;root&amp;gt;&lt;/em&gt;&lt;br/&gt;
 &lt;em&gt;&amp;lt;level value=&quot;info&quot; /&amp;gt;&lt;/em&gt;&lt;br/&gt;
 &lt;em&gt;&amp;lt;appender-ref ref=&quot;console&quot; /&amp;gt;&lt;/em&gt;&lt;br/&gt;
 &lt;em&gt;&amp;lt;appender-ref ref=&quot;file&quot; /&amp;gt;&lt;/em&gt;&lt;br/&gt;
 &lt;em&gt;&amp;lt;/root&amp;gt;&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;&amp;lt;/log4j:configuration&amp;gt;&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;but It doesn&apos;t produce any log in file system :&#160;C:/Temp/tika/tikalog_child.log wasn&apos;t created&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;What&apos;s wrong?&lt;/p&gt;

&lt;p&gt;Thanks a lot&lt;/p&gt;

&lt;p&gt;Mario&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="16694671" author="tallison@mitre.org" created="Wed, 21 Nov 2018 12:56:28 +0000"  >&lt;p&gt;If you&apos;re using 1.19.1, you&apos;ve hit &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2785&quot; title=&quot;Switch parent/child IPC to mmap file from stdout/stderr in tika-server&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2785&quot;&gt;&lt;del&gt;TIKA-2785&lt;/del&gt;&lt;/a&gt;. The temporary fix is to have the ConsoleAppender write to stderr:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;&amp;lt;appender name=&quot;console&quot; class=&quot;org.apache.log4j.ConsoleAppender&quot;&amp;gt;
 &amp;lt;param name=&quot;target&quot; value=&quot;System.err&quot;/&amp;gt;
 &amp;lt;layout class=&quot;org.apache.log4j.PatternLayout&quot;&amp;gt;
 &amp;lt;param name=&quot;ConversionPattern&quot; 
 value=&quot;%d\{yyyy-MM-dd HH:mm:ss} %-5p %c\{1}:%L - %m%n&quot; /&amp;gt;
 &amp;lt;/layout&amp;gt;
 &amp;lt;/appender&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;I tested this with 1.19.1 on Windows, and I had success.&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;java -jar tika-server-1.19.1.jar -JDlog4j.configuration=file:log4j_child.xml -spawnChild&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;If you have an interest in testing the new mechanism, grab a nightly build of tika-server from, e.g. &lt;a href=&quot;https://builds.apache.org/job/tika-branch-1x/131/org.apache.tika$tika-server/artifact/org.apache.tika/tika-server/1.20-20181120.215531-52/tika-server-1.20-20181120.215531-52.jar&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt;, and you can use the log file as you had it configured. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/biggrin.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="16694694" author="tallison@mitre.org" created="Wed, 21 Nov 2018 13:18:59 +0000"  >&lt;blockquote&gt;&lt;p&gt;&#160;it looks like the client only waited a quarter of a second. It can take 20-30 seconds to restart tika-server.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Make that 1-3 seconds...from semi-manual integration tests outside of the Tika test framework.&lt;/p&gt;</comment>
                            <comment id="16694760" author="bisontim" created="Wed, 21 Nov 2018 14:16:30 +0000"  >&lt;p&gt;Hallo.&lt;/p&gt;

&lt;p&gt;Tim, I have no log on filesystem with this log4j_child.xml&lt;/p&gt;



&lt;p&gt;&lt;em&gt;&amp;lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&amp;gt;&lt;/em&gt;&lt;br/&gt;
&lt;em&gt;&amp;lt;!DOCTYPE log4j:configuration SYSTEM &quot;log4j.dtd&quot;&amp;gt;&lt;/em&gt;&lt;br/&gt;
&lt;em&gt;&amp;lt;log4j:configuration debug=&quot;false&quot;&lt;/em&gt;&lt;br/&gt;
 &lt;em&gt;xmlns:log4j=&apos;http://jakarta.apache.org/log4j/&apos;&amp;gt;&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;&amp;lt;appender name=&quot;console&quot; class=&quot;org.apache.log4j.ConsoleAppender&quot;&amp;gt;&lt;/em&gt;&lt;br/&gt;
 &lt;em&gt;&amp;lt;param name=&quot;target&quot; value=&quot;System.err&quot;/&amp;gt;&lt;/em&gt;&lt;br/&gt;
 &lt;em&gt;&amp;lt;layout class=&quot;org.apache.log4j.PatternLayout&quot;&amp;gt;&lt;/em&gt;&lt;br/&gt;
 &lt;em&gt;&amp;lt;param name=&quot;ConversionPattern&quot;&lt;/em&gt; &lt;br/&gt;
 _value=&quot;%d&lt;br class=&quot;atl-forced-newline&quot; /&gt;&lt;/p&gt;
{yyyy-MM-dd HH:mm:ss}
&lt;p&gt; %-5p %c&lt;br class=&quot;atl-forced-newline&quot; /&gt;&lt;/p&gt;
{1}
&lt;p&gt;:%L - %m%n&quot; /&amp;gt;_&lt;br/&gt;
 &lt;em&gt;&amp;lt;/layout&amp;gt;&lt;/em&gt;&lt;br/&gt;
 &lt;em&gt;&amp;lt;/appender&amp;gt;&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;&amp;lt;appender name=&quot;file&quot; class=&quot;org.apache.log4j.RollingFileAppender&quot;&amp;gt;&lt;/em&gt;&lt;br/&gt;
 &lt;em&gt;&amp;lt;param name=&quot;append&quot; value=&quot;false&quot; /&amp;gt;&lt;/em&gt;&lt;br/&gt;
 &lt;em&gt;&amp;lt;param name=&quot;maxFileSize&quot; value=&quot;10MB&quot; /&amp;gt;&lt;/em&gt;&lt;br/&gt;
 &lt;em&gt;&amp;lt;param name=&quot;maxBackupIndex&quot; value=&quot;10&quot; /&amp;gt;&lt;/em&gt;&lt;br/&gt;
 &lt;em&gt;&amp;lt;param name=&quot;file&quot; value=&quot;C:/Temp/tika/tikalog_child.log&quot; /&amp;gt;&lt;/em&gt;&lt;br/&gt;
 &lt;em&gt;&amp;lt;layout class=&quot;org.apache.log4j.PatternLayout&quot;&amp;gt;&lt;/em&gt;&lt;br/&gt;
 &lt;em&gt;&amp;lt;param name=&quot;ConversionPattern&quot;&lt;/em&gt; &lt;br/&gt;
 &lt;em&gt;value=&quot;%d{yyyy-MM-dd HH:mm:ss} %-5p %c{1}:%L - %m%n&quot; /&amp;gt;&lt;/em&gt;&lt;br/&gt;
 &lt;em&gt;&amp;lt;/layout&amp;gt;&lt;/em&gt;&lt;br/&gt;
 &lt;em&gt;&amp;lt;/appender&amp;gt;&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;&amp;lt;root&amp;gt;&lt;/em&gt;&lt;br/&gt;
 &lt;em&gt;&amp;lt;level value=&quot;info&quot; /&amp;gt;&lt;/em&gt;&lt;br/&gt;
 &lt;em&gt;&amp;lt;appender-ref ref=&quot;console&quot; /&amp;gt;&lt;/em&gt;&lt;br/&gt;
 &lt;em&gt;&amp;lt;appender-ref ref=&quot;file&quot; /&amp;gt;&lt;/em&gt;&lt;br/&gt;
 &lt;em&gt;&amp;lt;/root&amp;gt;&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;&amp;lt;/log4j:configuration&amp;gt;&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;I don&apos;t understand if you have a log produced on the filesystem or not.&lt;/p&gt;</comment>
                            <comment id="16694777" author="tallison@mitre.org" created="Wed, 21 Nov 2018 14:33:09 +0000"  >&lt;p&gt;Sorry.&#160; I do have a file produced on the file system.&#160; I just attached the literal .xml log config file and the log that was written to my file system.&lt;/p&gt;


&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;
C:\data\tika_server&amp;gt;java -jar tika-server-1.19.1.jar -JDlog4j.configuration=file:log4j_child.xml -spawnChild

Nov 21, 2018 9:30:08 AM org.apache.tika.config.InitializableProblemHandler$3 handleInitializableProblem
WARNING: J2KImageReader not loaded. JPEG2000 files will not be processed.
See https://pdfbox.apache.org/2.0/dependencies.html#jai-image-io
for optional dependencies.

Nov 21, 2018 9:30:08 AM org.apache.tika.config.InitializableProblemHandler$3 handleInitializableProblem
WARNING: org.xerial&apos;s sqlite-jdbc is not loaded.
Please provide the jar on your classpath to parse sqlite files.
See tika-parsers/pom.xml for the correct version.
INFO Starting Apache Tika 1.19.1 server
Nov 21, 2018 9:30:09 AM org.apache.tika.config.InitializableProblemHandler$3 handleInitializableProblem
WARNING: J2KImageReader not loaded. JPEG2000 files will not be processed.
See https://pdfbox.apache.org/2.0/dependencies.html#jai-image-io
for optional dependencies.

Nov 21, 2018 9:30:09 AM org.apache.tika.config.InitializableProblemHandler$3 handleInitializableProblem
WARNING: org.xerial&apos;s sqlite-jdbc is not loaded.
Please provide the jar on your classpath to parse sqlite files.
See tika-parsers/pom.xml for the correct version.
2018-11-21 09:30:09 INFO TikaServerCli:115 - Starting Apache Tika 1.19.1 server
2018-11-21 09:30:09 INFO ServerImpl:85 - Setting the server&apos;s publish address to be http://localhost:9998/
2018-11-21 09:30:09 INFO log:193 - Logging initialized @1296ms to org.eclipse.jetty.util.log.Slf4jLog
2018-11-21 09:30:09 INFO Server:374 - jetty-9.4.z-SNAPSHOT; built: 2018-06-05T18:24:03.829Z; git: d5fc0523cfa96bfebfbda19606cad384d772f04c; jvm 1.8.0_192-b12
2018-11-21 09:30:10 INFO AbstractConnector:289 - Started ServerConnector@1af2d44a{HTTP/1.1,[http/1.1]}{localhost:9998}
2018-11-21 09:30:10 INFO Server:411 - Started @1811ms
2018-11-21 09:30:10 WARN ContextHandler:1572 - Empty contextPath
2018-11-21 09:30:10 INFO ContextHandler:851 - Started o.e.j.s.h.ContextHandler@342c38f8{/,null,AVAILABLE}
2018-11-21 09:30:10 INFO TikaServerCli:316 - Started Apache Tika server at http://localhost:9998/
2018-11-21 09:30:27 INFO RecursiveMetadataResource:429 - rmeta (autodetecting type)&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I then curled a file a couple of times against the server:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;curl.exe -T somePDF.pdf http://localhost:9998/rmeta
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="16695874" author="bisontim" created="Thu, 22 Nov 2018 12:52:02 +0000"  >&lt;p&gt;Hallo Tim, now I am able to generate the log, finally.&lt;/p&gt;

&lt;p&gt;Today, I started a processing from my client to parse with tika.&lt;/p&gt;

&lt;p&gt;It started to process at 8:30 a.m. and at 13:34 it crashed as you see in the MCF_Client.log&lt;/p&gt;

&lt;p&gt;I see that Tika created log&#160;tikalogchild.log1and wrote on it in at the 12:57, after a new log&#160;tikalogchild.log at 13:34 I suppose, when the child is restarted.&lt;/p&gt;

&lt;p&gt;So, I suppose that the client crashed because this restart?&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;I attatch in the Log.zip the three files.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Could you help me to understand, how to solve this issue?&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;I am using&#160;tika-server-1.20-20181114.215706-48.jar&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Thanks a lot.&lt;/p&gt;

&lt;p&gt;Mario&#160;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12949189/12949189_Log.zip&quot; title=&quot;Log.zip attached to TIKA-2776&quot;&gt;Log.zip&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;&lt;/p&gt;</comment>
                            <comment id="16697134" author="tallison@mitre.org" created="Fri, 23 Nov 2018 13:30:45 +0000"  >&lt;p&gt;Ugh...looks like the &lt;tt&gt;append=false&lt;/tt&gt; overwrote the child logs &amp;#8211; logger did as we asked &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &amp;#8211; which means that we&apos;re missing the critical points: the child log is missing between the end of tikalogchild.log.1 (12:57) and the beginning of tikalogchild.log (13:34).&lt;/p&gt;

&lt;p&gt;Let&apos;s change this line to &quot;true&quot;:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt; &amp;lt;param name=&quot;append&quot; value=&quot;false&quot; /&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;From the MCF_client_log, tika was unavailable at 13:24, 13:26, 13:29, 13:31 and 13:34.  Can you tell from the MCF logs if any files were processed between 13:24 and 13:34?  Were any files processed after 13:34?&lt;/p&gt;
</comment>
                            <comment id="16697209" author="tallison@mitre.org" created="Fri, 23 Nov 2018 14:33:11 +0000"  >&lt;p&gt;It would also be useful to add logging to the parent process. I think the same configuration can be used with the one critical change of writing to a different file... add &lt;tt&gt;-Dlog4j.configuration...&lt;/tt&gt; early in the commandline&lt;/p&gt;</comment>
                            <comment id="16697234" author="bisontim" created="Fri, 23 Nov 2018 14:51:10 +0000"  >&lt;p&gt;&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/12949302/12949302_MCF_JOB.png&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/p&gt;</comment>
                            <comment id="16697249" author="bisontim" created="Fri, 23 Nov 2018 14:59:45 +0000"  >&lt;p&gt;Yes, there were any files processed in the interval 13:24-13:34&lt;/p&gt;

&lt;p&gt;No files processed after because the job crashed as you can see from the MCF_JOB.png&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;I tried to start tika server with the two log specification but it doesn&apos;t work.&lt;/p&gt;

&lt;p&gt;I obtain the error:&lt;/p&gt;

&lt;p&gt;administrator@sengvivv02:/opt/tika$ sudo -u tomcat java -jar /opt/tika/tika-server-1.19.1.jar -Dlog4j.configuration=&lt;a href=&quot;file:/opt/tika/log4j.xml&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;file:/opt/tika/log4j.xml&lt;/a&gt; -JDlog4j.configuration=&lt;a href=&quot;file:/opt/tika/log4j_child.xml&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;file:/opt/tika/log4j_child.xml&lt;/a&gt; --host=sengvivv02 -spawnChild&lt;br/&gt;
Nov 23, 2018 3:55:45 PM org.apache.tika.config.InitializableProblemHandler$3 handleInitializableProblem&lt;br/&gt;
WARNING: J2KImageReader not loaded. JPEG2000 files will not be processed.&lt;br/&gt;
See &lt;a href=&quot;https://pdfbox.apache.org/2.0/dependencies.html#jai-image-io&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://pdfbox.apache.org/2.0/dependencies.html#jai-image-io&lt;/a&gt;&lt;br/&gt;
for optional dependencies.&lt;/p&gt;

&lt;p&gt;Nov 23, 2018 3:55:45 PM org.apache.tika.config.InitializableProblemHandler$3 handleInitializableProblem&lt;br/&gt;
WARNING: org.xerial&apos;s sqlite-jdbc is not loaded.&lt;br/&gt;
Please provide the jar on your classpath to parse sqlite files.&lt;br/&gt;
See tika-parsers/pom.xml for the correct version.&lt;br/&gt;
INFO Starting Apache Tika 1.19.1 server&lt;br/&gt;
org.apache.commons.cli.UnrecognizedOptionException: Unrecognized option: -Dlog4j.configuration=&lt;a href=&quot;file:/opt/tika/log4j.xml&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;file:/opt/tika/log4j.xml&lt;/a&gt;&lt;br/&gt;
 at org.apache.commons.cli.Parser.processOption(Parser.java:363)&lt;br/&gt;
 at org.apache.commons.cli.Parser.parse(Parser.java:199)&lt;br/&gt;
 at org.apache.commons.cli.Parser.parse(Parser.java:85)&lt;br/&gt;
 at org.apache.tika.server.TikaServerCli.execute(TikaServerCli.java:133)&lt;br/&gt;
 at org.apache.tika.server.TikaServerCli.main(TikaServerCli.java:117)&lt;br/&gt;
ERROR Can&apos;t start:&lt;br/&gt;
org.apache.commons.cli.UnrecognizedOptionException: Unrecognized option: -Dlog4j.configuration=&lt;a href=&quot;file:/opt/tika/log4j.xml&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;file:/opt/tika/log4j.xml&lt;/a&gt;&lt;br/&gt;
 at org.apache.commons.cli.Parser.processOption(Parser.java:363)&lt;br/&gt;
 at org.apache.commons.cli.Parser.parse(Parser.java:199)&lt;br/&gt;
 at org.apache.commons.cli.Parser.parse(Parser.java:85)&lt;br/&gt;
 at org.apache.tika.server.TikaServerCli.execute(TikaServerCli.java:133)&lt;br/&gt;
 at org.apache.tika.server.TikaServerCli.main(TikaServerCli.java:117)&lt;/p&gt;</comment>
                            <comment id="16697364" author="tallison@mitre.org" created="Fri, 23 Nov 2018 16:54:46 +0000"  >&lt;p&gt;Try adding that parameter immediately after &lt;tt&gt;java&lt;/tt&gt;.&lt;/p&gt;</comment>
                            <comment id="16698868" author="bisontim" created="Mon, 26 Nov 2018 12:42:01 +0000"  >&lt;p&gt;Hallo Tim.&lt;/p&gt;

&lt;p&gt;now I have both logs for tika server : parent (tikalog.log) and child (tikalogchild.log)&lt;/p&gt;

&lt;p&gt;In manifoldcf.log you can see&#160; in the last line, that job aborted at 13:18&lt;/p&gt;

&lt;p&gt;You can see a restart at that time in the tika log.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;In the man_tika.zip I attached the logs.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12949485/12949485_man_tika.zip&quot; title=&quot;man_tika.zip attached to TIKA-2776&quot;&gt;man_tika.zip&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;&lt;/p&gt;</comment>
                            <comment id="16698892" author="bisontim" created="Mon, 26 Nov 2018 13:00:27 +0000"  >&lt;p&gt;Now I tried to start tika with the command:&lt;br/&gt;
 java -Dlog4j.configuration=&lt;a href=&quot;file:/opt/tika/log4j.xml&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;file:/opt/tika/log4j.xml&lt;/a&gt; -jar /opt/tika/tika-server-1.20-20181114.215706-48.jar -JDlog4j.configuration=&lt;a href=&quot;file:/opt/tika/log4j_child.xml&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;file:/opt/tika/log4j_child.xml&lt;/a&gt; --host=sengvivv01.vimar.net -spawnChild -taskTimeoutMillis 1000000&lt;/p&gt;

&lt;p&gt;Perhaps, could the&#160;-taskTimeoutMillis parameter be useful?&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;i see many error in the tikalogchild.log:&lt;/p&gt;

&lt;p&gt;ERROR ServerStatusWatcher:129 - Timeout task PARSE, millis elapsed 120253&lt;/p&gt;

&lt;p&gt;.&lt;/p&gt;

&lt;p&gt;.&lt;/p&gt;

&lt;p&gt;ERROR ServerStatusWatcher:129 - Timeout task PARSE, millis elapsed 120253&lt;/p&gt;

&lt;p&gt;.&lt;/p&gt;

&lt;p&gt;.&lt;/p&gt;

&lt;p&gt;ERROR ServerStatusWatcher:129 - Timeout task PARSE, millis elapsed 120335&lt;/p&gt;

&lt;p&gt;.&lt;/p&gt;

&lt;p&gt;.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;etc.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="16699108" author="tallison@mitre.org" created="Mon, 26 Nov 2018 15:07:35 +0000"  >&lt;p&gt;Three cheers for logging, and thank you for your patience in configuring those!&lt;/p&gt;

&lt;p&gt;Yes, exactly!  It looks like the child process restarted at 2018-11-26 13:18:26 &lt;tt&gt;2018-11-26 13:18:26 INFO  MetadataResource:431 - meta (application/vnd.openxmlformats&lt;/tt&gt; and then processed more files successfully.  It can take few seconds for the server to restart, and it looks in the &lt;tt&gt;manifoldcf.log&lt;/tt&gt; like the initial connectivity dropped at 13:18:25, and then there are problems logged through the end of 13:18:26 with worker threads not able to reach the server.  This is expected.  Are the clients (worker thread 88, 39, 8, 86, 87, 982, 99, 75, 12) able to sleep and retry after failed connectivity or do they just try once and give up?  &lt;/p&gt;

&lt;p&gt;As a side note, if you add a header telling tika-server what the file name is, that filename will be included in the log message so you can figure out which file caused the timeout.  &lt;/p&gt;

&lt;p&gt;See: &lt;a href=&quot;https://wiki.apache.org/tika/TikaJAXRS&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://wiki.apache.org/tika/TikaJAXRS&lt;/a&gt; ... in short, add the header to your request:&lt;br/&gt;
&lt;tt&gt;&quot;Content-Disposition: attachment; filename=foo.csv&quot;&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;Some reasons for timeouts: the vm is overtaxed and processing is just slow, infinite loop in a parser (these are rare but they &lt;del&gt;can&lt;/del&gt; will happen), OCR can take minutes per document (do you have tesseract installed)?&lt;/p&gt;
</comment>
                            <comment id="16701864" author="bisontim" created="Wed, 28 Nov 2018 13:19:49 +0000"  >&lt;p&gt;Hallo Tim&lt;/p&gt;

&lt;p&gt;tesseract is not installed&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;It seems that with the parameter &quot;-spawnChild -taskTimeoutMillis 1000000&quot; no more shutdown the child&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;I will update about the evolution of my issue with the client that index many documents&lt;/p&gt;</comment>
                            <comment id="16701938" author="tallison@mitre.org" created="Wed, 28 Nov 2018 14:14:25 +0000"  >&lt;p&gt;Thank you for the follow up!&lt;/p&gt;

&lt;p&gt;To confirm/summarize...&lt;br/&gt;
1. I introduced a change in behavior (bug) into legacy server mode in 1.19 (maybe 1.18?) that causes tika-server to return &apos;not available&apos; forever after an OOM.  The legacy behavior was to ignore OOMs and &lt;em&gt;hope&lt;/em&gt; nothing too bad happened to your JVM.  That said, the change of behavior I introduced is bad, very bad.  I&apos;ve fixed this in 1.20, which should be out in a few weeks.&lt;br/&gt;
2. tika-server in -spawnChild mode was restarting the child because you were getting timeouts.  This caused problems with Manifold.  You&apos;ve bumped out the timeout to ~16 minutes, and you currently don&apos;t have any files that take longer than that...so all appears to work for now.&lt;br/&gt;
3. I &lt;em&gt;think&lt;/em&gt; we found that &lt;tt&gt;-spawnChild&lt;/tt&gt; was behaving as it was designed to do.  To confirm, we did not find that the parent process shutdown, and we did find that the child restarted within a few seconds.  Is this correct?&lt;/p&gt;

&lt;p&gt;My opinion/advice:&lt;br/&gt;
Depending on the nature of your documents, if you have large enough batches of crazy enough documents, you will eventually hit an infinite loop, and the child will timeout and restart.  So, for now, you&apos;ve wallpapered over a problem by bumping out the timeout, but the timeouts will eventually happen.  So, what can we do in Tika, what can Manifold do, what can you do to help avoid this eventuality?&lt;/p&gt;

&lt;p&gt;Again, many, many thanks for your patience getting the logging up and running.  I still need to improve our wiki on logging with tika-server (based on our interaction) even more.  &lt;/p&gt;</comment>
                            <comment id="16703173" author="bisontim" created="Thu, 29 Nov 2018 13:21:24 +0000"  >&lt;p&gt;Hi Tim.&lt;/p&gt;

&lt;p&gt;3. Yes, you are right, when the parent process, never shutdown, but only the child restarted.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Your opinion/advice:&lt;/p&gt;

&lt;p&gt;Yes, I workarounded the restart of the child increasing the timeout, in the future I will ask if there is the possibility that ManifoldCF can manage the case of timeout.&lt;/p&gt;

&lt;p&gt;In this moment, I am tring to end the indexing of the 700000 documents that it stops many times due to java exception of the agent that manipulate the indexing for ManifoldCF&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;You&#160; do not have not to thank me, because I thank to you for the big support&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="16704474" author="bisontim" created="Fri, 30 Nov 2018 09:31:23 +0000"  >&lt;p&gt;Hallo Tim.&lt;/p&gt;

&lt;p&gt;I obtained a restart of child:&lt;/p&gt;

&lt;p&gt;2018-11-30 01:21:01 INFO TikaServerWatchDog:104 - About to restart the child process&lt;br/&gt;
2018-11-30 01:21:02 INFO TikaServerWatchDog:106 - Successfully restarted child process &amp;#8211; 11 restarts so far)&lt;br/&gt;
2018-11-30 05:39:09 WARN TikaServerWatchDog:253 - Received status from child: HIT_MAX&lt;br/&gt;
2018-11-30 05:39:10 INFO TikaServerWatchDog:104 - About to restart the child process&lt;br/&gt;
2018-11-30 05:39:12 INFO TikaServerWatchDog:106 - Successfully restarted child process &amp;#8211; 13 restarts so far)&lt;br/&gt;
2018-11-30 08:38:03 WARN TikaServerWatchDog:253 - Received status from child: HIT_MAX&lt;br/&gt;
2018-11-30 08:38:03 INFO TikaServerWatchDog:104 - About to restart the child process&lt;br/&gt;
2018-11-30 08:38:04 INFO TikaServerWatchDog:106 - Successfully restarted child process &amp;#8211; 15 restarts so far)&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Is this related about the parameter :&lt;/p&gt;

&lt;p&gt;&lt;em&gt;&lt;tt&gt;-maxFiles&lt;/tt&gt;: restart the child process after it has processed&#160;&lt;tt&gt;maxFiles&lt;/tt&gt;. If there is a slow building memory leak, this restart of the JVM should help.&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;I didn&apos;t set the parameter.&lt;/p&gt;

&lt;p&gt;Which is default value of maxFiles ?&lt;/p&gt;

&lt;p&gt;Thanks&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Mario&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="16705208" author="tallison@mitre.org" created="Fri, 30 Nov 2018 19:46:18 +0000"  >&lt;p&gt;This caught me by surprise...I thought that I had left the default as -1 (no max), but I clearly set it to 100,000.&lt;/p&gt;

&lt;p&gt;I &lt;em&gt;think&lt;/em&gt; my reasoning was that this is good jvm hygiene given the craziness some of our parsers can do to a jvm.  I readily admit that I don&apos;t have good data to support my decision aside from the reasoning that &quot;we&apos;ve had memory leaks before because of caching; we&apos;ll have them again.&quot;  I&apos;d be willing to bump the default to a higher value, but I wouldn&apos;t want to turn it off.&lt;/p&gt;

&lt;p&gt;You can avoid the restarts caused by HIT_MAX by setting it to -1 on the commandline.  &lt;/p&gt;

&lt;p&gt;I&apos;ll update the documentation on the wiki and in the code.  Thank you!&lt;/p&gt;

</comment>
                            <comment id="16705251" author="hudson" created="Fri, 30 Nov 2018 20:37:47 +0000"  >&lt;p&gt;UNSTABLE: Integrated in Jenkins build tika-2.x-windows #354 (See &lt;a href=&quot;https://builds.apache.org/job/tika-2.x-windows/354/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/tika-2.x-windows/354/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2776&quot; title=&quot;Tika server child restart&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2776&quot;&gt;&lt;del&gt;TIKA-2776&lt;/del&gt;&lt;/a&gt; &amp;#8211; improve documentation for -maxFiles (tallison: rev a477d73ac56c169075b5c9ea66bf57be1f3dc672)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) tika-server/src/main/java/org/apache/tika/server/TikaServerCli.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="16705281" author="hudson" created="Fri, 30 Nov 2018 21:05:08 +0000"  >&lt;p&gt;SUCCESS: Integrated in Jenkins build Tika-trunk #1601 (See &lt;a href=&quot;https://builds.apache.org/job/Tika-trunk/1601/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Tika-trunk/1601/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2776&quot; title=&quot;Tika server child restart&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2776&quot;&gt;&lt;del&gt;TIKA-2776&lt;/del&gt;&lt;/a&gt; &amp;#8211; improve documentation for -maxFiles (tallison: &lt;a href=&quot;https://github.com/apache/tika/commit/a477d73ac56c169075b5c9ea66bf57be1f3dc672&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/a477d73ac56c169075b5c9ea66bf57be1f3dc672&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) tika-server/src/main/java/org/apache/tika/server/TikaServerCli.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="16705283" author="hudson" created="Fri, 30 Nov 2018 21:11:49 +0000"  >&lt;p&gt;SUCCESS: Integrated in Jenkins build tika-branch-1x #133 (See &lt;a href=&quot;https://builds.apache.org/job/tika-branch-1x/133/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/tika-branch-1x/133/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2776&quot; title=&quot;Tika server child restart&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2776&quot;&gt;&lt;del&gt;TIKA-2776&lt;/del&gt;&lt;/a&gt; &amp;#8211; improve documentation for -maxFiles (tallison: &lt;a href=&quot;https://github.com/apache/tika/commit/4141411773a321fe614167584d23e376c4dbcb3c&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/4141411773a321fe614167584d23e376c4dbcb3c&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) tika-server/src/main/java/org/apache/tika/server/TikaServerCli.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13201708">CONNECTORS-1561</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13201707">CONNECTORS-1560</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12949189" name="Log.zip" size="402812" author="bisontim" created="Thu, 22 Nov 2018 12:51:57 +0000"/>
                            <attachment id="12949302" name="MCF_JOB.png" size="76301" author="bisontim" created="Fri, 23 Nov 2018 14:51:08 +0000"/>
                            <attachment id="12948097" name="log4j.xml" size="989" author="bisontim" created="Wed, 14 Nov 2018 08:17:50 +0000"/>
                            <attachment id="12949050" name="log4j_child.xml" size="1029" author="tallison" created="Wed, 21 Nov 2018 14:29:19 +0000"/>
                            <attachment id="12948096" name="log4j_child.xml" size="995" author="bisontim" created="Wed, 14 Nov 2018 08:17:50 +0000"/>
                            <attachment id="12949485" name="man_tika.zip" size="141698" author="bisontim" created="Mon, 26 Nov 2018 12:42:01 +0000"/>
                            <attachment id="12949051" name="tikalogchild.log" size="1423" author="tallison" created="Wed, 21 Nov 2018 14:29:19 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>7.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 50 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|s00bww:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>