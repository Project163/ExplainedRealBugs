<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:01:15 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[TIKA-2265] Problem with footnotes/endnotes in Tika.parseToString with MS Word (.docx) files</title>
                <link>https://issues.apache.org/jira/browse/TIKA-2265</link>
                <project id="12310631" key="TIKA">Tika</project>
                    <description>&lt;p&gt;It seems to be the case that a footnote numbered &quot;1&quot; in the real document will be outputted by Tika.parseToString() as &quot;2&quot; in the footnote reference, and &quot;2&quot; in the corresponding footnote body text.... real footnote &quot;2&quot; becomes &quot;3&quot;, &quot;3&quot; becomes &quot;4&quot;, etc.  Have not yet looked at source code ... I can&apos;t imagine it would be difficult to correct this.&lt;/p&gt;</description>
                <environment>&lt;p&gt;N/A&lt;/p&gt;</environment>
        <key id="13042412">TIKA-2265</key>
            <summary>Problem with footnotes/endnotes in Tika.parseToString with MS Word (.docx) files</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="tallison">Tim Allison</assignee>
                                    <reporter username="mrodent">Mike Rodent</reporter>
                        <labels>
                            <label>newbie</label>
                    </labels>
                <created>Sun, 12 Feb 2017 15:22:41 +0000</created>
                <updated>Wed, 16 Aug 2017 07:31:02 +0000</updated>
                                            <version>1.14</version>
                                                    <component>parser</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="15863681" author="tallison@mitre.org" created="Mon, 13 Feb 2017 13:39:40 +0000"  >&lt;p&gt;Thank you for opening this.  I&apos;ll take a look.&lt;/p&gt;</comment>
                            <comment id="15863722" author="tallison@mitre.org" created="Mon, 13 Feb 2017 14:05:46 +0000"  >&lt;p&gt;Are you able to share a triggering docx? The ones in our unit tests aren&apos;t showing the problem. Thank you, again.&lt;/p&gt;</comment>
                            <comment id="15866220" author="mrodent" created="Tue, 14 Feb 2017 17:44:20 +0000"  >&lt;p&gt;I&apos;m not that surprised to find that...&lt;/p&gt;

&lt;p&gt;So I ran my tests again... same problem. The app code is as simple as can be:&lt;/p&gt;

&lt;p&gt;Tika tika = new Tika();&lt;br/&gt;
tika.setMaxStringLength( Integer.MAX_VALUE );&lt;br/&gt;
contents = tika.parseToString(documentFile);&lt;/p&gt;

&lt;p&gt;and I&apos;m still getting the anomaly. I also tried cutting out the top of my file (test shorter.docx)... same result: I&apos;m getting footnotes &quot;2&quot;, &quot;3&quot; and &quot;4&quot; for the first line: this is the logged output:&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;#  TIKA contents for file test shorter.docx: Tecum optime&lt;span class=&quot;error&quot;&gt;&amp;#91;footnoteRef:2&amp;#93;&lt;/span&gt;, deinde etiam&lt;span class=&quot;error&quot;&gt;&amp;#91;footnoteRef:3&amp;#93;&lt;/span&gt; cum mediocri amico&lt;span class=&quot;error&quot;&gt;&amp;#91;footnoteRef:4&amp;#93;&lt;/span&gt;. &lt;span class=&quot;error&quot;&gt;&amp;#91;2: Sed quoniam et advesperascit et mihi ad villam revertendum est, nunc quidem hactenus; Quod si ita sit, cur opera philosophiae sit danda nescio.&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;3: Si quae forte-possumus. Immo videri fortasse.&amp;#93;&lt;/span&gt; [4: Huius ego nunc auctoritatem &lt;span class=&quot;error&quot;&gt;&amp;#91;sequens idem faciam&amp;#93;&lt;/span&gt;. Confecta res esset. Primum Theophrasti, Strato, physicum se voluit; Ut proverbia non nulla veriora sint quam vestra dogmata.]&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;uploading both files ... PS Tika version is 1.14.&lt;/p&gt;</comment>
                            <comment id="15866268" author="tallison@mitre.org" created="Tue, 14 Feb 2017 18:02:24 +0000"  >&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;&amp;lt;w:footnote w:type=&quot;separator&quot; w:id=&quot;0&quot;&amp;gt;&amp;lt;w:p w:rsidR=&quot;00D2605B&quot; w:rsidRDefault=&quot;00D2605B&quot;&amp;gt;&amp;lt;w:r&amp;gt;&amp;lt;w:separator/&amp;gt;&amp;lt;/w:r&amp;gt;&amp;lt;/w:p&amp;gt;&amp;lt;/w:footnote&amp;gt;

&amp;lt;w:footnote w:type=&quot;continuationSeparator&quot; w:id=&quot;1&quot;&amp;gt;&amp;lt;w:p w:rsidR=&quot;00D2605B&quot; w:rsidRDefault=&quot;00D2605B&quot;&amp;gt;&amp;lt;w:r&amp;gt;&amp;lt;w:continuationSeparator/&amp;gt;&amp;lt;/w:r&amp;gt;&amp;lt;/w:p&amp;gt;&amp;lt;/w:footnote&amp;gt;

&amp;lt;w:footnote w:id=&quot;2&quot;&amp;gt;...actual footnote
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Yep, that&apos;s a problem we should fix.  We can&apos;t rely on the &quot;id&quot; being equal to the footnote number.  Looks like we have to calculate it dynamically by skipping separators&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/help_16.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;...&lt;/p&gt;

&lt;p&gt;Thank you for submitting an example document.&lt;/p&gt;</comment>
                            <comment id="15866561" author="tallison@mitre.org" created="Tue, 14 Feb 2017 20:17:50 +0000"  >&lt;p&gt;Opened bug on POI&apos;s bugzilla: &lt;a href=&quot;https://bz.apache.org/bugzilla/show_bug.cgi?id=60734&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://bz.apache.org/bugzilla/show_bug.cgi?id=60734&lt;/a&gt; for our DOM-based parser.&lt;/p&gt;

&lt;p&gt;I&apos;ll also look into what it will take to fix our SAXParser.&lt;/p&gt;</comment>
                            <comment id="15868023" author="mrodent" created="Wed, 15 Feb 2017 15:25:58 +0000"  >&lt;p&gt;I just had a look at the file in question i.e. content.xml when you unzip the .docx.&lt;/p&gt;

&lt;p&gt;As I understand things it would appear that MS Word may actually be numbering footnotes (if they are &quot;per-page&quot;) sort of on-the-fly... and of course this makes sense: change the pagination, change the footnote numbering.&lt;/p&gt;

&lt;p&gt;But the trouble is, with Tika there is no way you can work out where the soft page breaks occur.&lt;/p&gt;

&lt;p&gt;The .odt file I used when developing my ODF &quot;patch&quot; class (&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2264&quot; title=&quot;Better handling of footnotes/endnotes for ODF files&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2264&quot;&gt;TIKA-2264&lt;/a&gt;) turns out not to have &quot;per page&quot; numbering... but I just changed this and extracted the content.xml.  In this case it appears that the &quot;text:note-citation&quot; value only restarts (i.e. to value &quot;1&quot;) in the case of a hard break.  So it isn&apos;t really &quot;per page&quot; numbering in the true sense in LibreOffice Writer.&lt;/p&gt;

&lt;p&gt;Anyway, I suspect it may not be possible to do anything about the &quot;anomalous&quot; per-page footnote numbering with .docx files...&lt;/p&gt;</comment>
                            <comment id="15868041" author="tallison@mitre.org" created="Wed, 15 Feb 2017 15:37:55 +0000"  >&lt;p&gt;Right, it turns out that footnote/endnote numbers are calculated dynamically. We should at least do a better job of consecutively numbering the footnotes/endnotes starting from 1 and not relying on the &quot;id&quot;. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;We will never&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/help_16.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; be able to figure out where the end of the page is so we won&apos;t be able to implement:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;&amp;lt;w:footnotePr&amp;gt;
   &amp;lt;w:numRestart w:val=&quot;eachPage&quot; /&amp;gt;
&amp;lt;/w:footnotePr&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="16128445" author="hudson" created="Wed, 16 Aug 2017 07:31:02 +0000"  >&lt;p&gt;ABORTED: Integrated in Jenkins build Tika-trunk #1343 (See &lt;a href=&quot;https://builds.apache.org/job/Tika-trunk/1343/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Tika-trunk/1343/&lt;/a&gt;)&lt;br/&gt;
record changes for &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2265&quot; title=&quot;Problem with footnotes/endnotes in Tika.parseToString with MS Word (.docx) files&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2265&quot;&gt;TIKA-2265&lt;/a&gt;. (mattmann: &lt;a href=&quot;https://github.com/apache/tika/commit/c6b6b1733c584a7e0e81434ec377a26b7b3a26a0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/c6b6b1733c584a7e0e81434ec377a26b7b3a26a0&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) CHANGES.txt&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12852613" name="test shorter.docx" size="15206" author="mrodent" created="Tue, 14 Feb 2017 17:44:53 +0000"/>
                            <attachment id="12852614" name="test.docx" size="15466" author="mrodent" created="Tue, 14 Feb 2017 17:44:53 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 13 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i39yvj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>