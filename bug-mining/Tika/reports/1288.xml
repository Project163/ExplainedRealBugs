<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:04:03 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[TIKA-3784] Detector returns &quot;application/x-x509-key&quot; when scanning a .p12 file</title>
                <link>https://issues.apache.org/jira/browse/TIKA-3784</link>
                <project id="12310631" key="TIKA">Tika</project>
                    <description>&lt;p&gt;We are using tika to check if the MIME type of the file extensions matches with the MIME type of the file content.&lt;/p&gt;

&lt;p&gt;After our upgrade from tika-core 1.22 to 1.26 our logic does not work anymore for certificates of type .p12, .pfx, .cer, .der.&lt;/p&gt;

&lt;p&gt;For the .p12 and .pfx extension the MIME type is &quot;application/x-pkcs12&quot; but the tika detector returns &quot;application/x-x509-key&quot; instead.&lt;/p&gt;

&lt;p&gt;After checking the tika-mimetype.xml and comparing it to my .p12 file I found the following MIME magic which explains why I got these types back.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-xml&quot;&gt;
&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;mime-type type=&lt;span class=&quot;code-quote&quot;&gt;&quot;application/x-x509-key;format=der&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;
&#160; &#160; &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;sub-class-of type=&lt;span class=&quot;code-quote&quot;&gt;&quot;application/x-x509-key&quot;&lt;/span&gt;/&amp;gt;&lt;/span&gt;
&#160; &#160; &lt;span class=&quot;code-tag&quot;&gt;&lt;span class=&quot;code-comment&quot;&gt;&amp;lt;!-- These are just a bunch of magic integers as defined by the key format... --&amp;gt;&lt;/span&gt;&lt;/span&gt;
&#160; &#160; &lt;span class=&quot;code-tag&quot;&gt;&lt;span class=&quot;code-comment&quot;&gt;&amp;lt;!-- Always seem to have a version integer as their first entry, --&amp;gt;&lt;/span&gt;&lt;/span&gt;
&#160; &#160; &lt;span class=&quot;code-tag&quot;&gt;&lt;span class=&quot;code-comment&quot;&gt;&amp;lt;!-- &#160;normally 00, 01 or 02, check for that --&amp;gt;&lt;/span&gt;&lt;/span&gt;
&#160; &#160; &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;magic priority=&lt;span class=&quot;code-quote&quot;&gt;&quot;40&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;
&#160; &#160; &#160; &amp;lt;match value=&lt;span class=&quot;code-quote&quot;&gt;&quot;0x3081FF020100&quot;&lt;/span&gt; type=&lt;span class=&quot;code-quote&quot;&gt;&quot;string&quot;&lt;/span&gt;
&#160; &#160; &#160; &#160; &#160; &#160; &#160; mask=&lt;span class=&quot;code-quote&quot;&gt;&quot;0xFFFF00FFFFFC&quot;&lt;/span&gt; offset=&lt;span class=&quot;code-quote&quot;&gt;&quot;0&quot;&lt;/span&gt;/&amp;gt;
&#160; &#160; &#160; &amp;lt;match value=&lt;span class=&quot;code-quote&quot;&gt;&quot;0x3082FFFF020100&quot;&lt;/span&gt; type=&lt;span class=&quot;code-quote&quot;&gt;&quot;string&quot;&lt;/span&gt;
&#160; &#160; &#160; &#160; &#160; &#160; &#160; mask=&lt;span class=&quot;code-quote&quot;&gt;&quot;0xFFFF0000FFFFFC&quot;&lt;/span&gt; offset=&lt;span class=&quot;code-quote&quot;&gt;&quot;0&quot;&lt;/span&gt;/&amp;gt;
&#160; &#160; &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/magic&amp;gt;&lt;/span&gt;
&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/mime-type&amp;gt;&lt;/span&gt; &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13448122">TIKA-3784</key>
            <summary>Detector returns &quot;application/x-x509-key&quot; when scanning a .p12 file</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="mhofbauer">Matthias Hofbauer</reporter>
                        <labels>
                    </labels>
                <created>Thu, 2 Jun 2022 12:30:49 +0000</created>
                <updated>Mon, 14 Jul 2025 19:09:54 +0000</updated>
                                            <version>1.26</version>
                                                    <component>detector</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="17545537" author="tallison@mitre.org" created="Thu, 2 Jun 2022 16:08:40 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=nick&quot; class=&quot;user-hover&quot; rel=&quot;nick&quot;&gt;nick&lt;/a&gt;, any recommendations?&lt;/p&gt;</comment>
                            <comment id="17550223" author="gagravarr" created="Sun, 5 Jun 2022 14:48:29 +0000"  >&lt;p&gt;We don&apos;t currently have any Mime Magic for PKCS12 files&lt;/p&gt;

&lt;p&gt;Based on &lt;a href=&quot;https://stackoverflow.com/questions/33239875/jks-bks-and-pkcs12-file-formats&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://stackoverflow.com/questions/33239875/jks-bks-and-pkcs12-file-formats&lt;/a&gt; it won&apos;t be an easy one to cope with, since we don&apos;t currently have an ASN.1 container detector&lt;/p&gt;

&lt;p&gt;I think we can potentially get away with a slightly hacky approach similar to the PKCS7 signature, where we look for a few variants and hope the right entry comes first... &quot;openssl asn1parse&quot; should help with working out what to look for&lt;/p&gt;

&lt;p&gt;(Assuming no-one has a bit of time to knock up an ASN1 container detector based on the BouncyCastle ASN.1 using an approach similar to &lt;a href=&quot;https://stackoverflow.com/questions/10190795/parsing-asn-1-binary-data-with-java&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://stackoverflow.com/questions/10190795/parsing-asn-1-binary-data-with-java&lt;/a&gt; )&lt;/p&gt;</comment>
                            <comment id="17550231" author="hudson" created="Sun, 5 Jun 2022 16:07:53 +0000"  >&lt;p&gt;SUCCESS: Integrated in Jenkins build Tika &#187; tika-main-jdk8 #629 (See &lt;a href=&quot;https://ci-builds.apache.org/job/Tika/job/tika-main-jdk8/629/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://ci-builds.apache.org/job/Tika/job/tika-main-jdk8/629/&lt;/a&gt;)&lt;br/&gt;
Tests for encrypted RSA keys in PEM and DER, plus a disabled PKCS12 test pending &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-3784&quot; title=&quot;Detector returns &amp;quot;application/x-x509-key&amp;quot; when scanning a .p12 file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-3784&quot;&gt;TIKA-3784&lt;/a&gt; (nick: &lt;a href=&quot;https://github.com/apache/tika/commit/6bf9ee120c2845ccdf61207322dcea2373388e75&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/6bf9ee120c2845ccdf61207322dcea2373388e75&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) tika-parsers/tika-parsers-standard/tika-parsers-standard-package/src/test/java/org/apache/tika/mime/TestMimeTypes.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="17816115" author="tallison@mitre.org" created="Fri, 9 Feb 2024 15:28:38 +0000"  >&lt;p&gt;Based on this: &lt;a href=&quot;https://stackoverflow.com/questions/30483489/how-to-decode-asn-1-data-in-java&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://stackoverflow.com/questions/30483489/how-to-decode-asn-1-data-in-java&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;If we parsed the ASN1, what would be look for? Does BouncyCastle have a detector?&lt;/p&gt;</comment>
                            <comment id="17816191" author="tallison@mitre.org" created="Fri, 9 Feb 2024 19:22:33 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=nick&quot; class=&quot;user-hover&quot; rel=&quot;nick&quot;&gt;nick&lt;/a&gt; (and cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tom_1st&quot; class=&quot;user-hover&quot; rel=&quot;tom_1st&quot;&gt;tom_1st&lt;/a&gt; from &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-4194&quot; title=&quot;tika fails to detect certain pkcs12 keystores types p12 pfx&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-4194&quot;&gt;&lt;del&gt;TIKA-4194&lt;/del&gt;&lt;/a&gt;), I agree that parsing these things would probably be best as a container detector. When I run AS1Dump on one of the p12 files, I get this:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Sequence
    Integer(3)
    Sequence
        ObjectIdentifier(1.2.840.113549.1.7.1)
        Tagged [CONTEXT 0]
            DER Octet String[2603] 
    Sequence
        Sequence
            Sequence
                ObjectIdentifier(2.16.840.1.101.3.4.2.3)
                NULL
            DER Octet String[64] 
        DER Octet String[64] 
        Integer(1000000)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Is there anything in there I can use to detect p12?&lt;/p&gt;</comment>
                            <comment id="17816192" author="tallison@mitre.org" created="Fri, 9 Feb 2024 19:23:15 +0000"  >&lt;p&gt;Or verbose mode:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Sequence
    Integer(3)
    Sequence
        ObjectIdentifier(1.2.840.113549.1.7.1)
        Tagged [CONTEXT 0]
            DER Octet String[2603] 
                30820a273082043d06092a864886f70d010706a082042e3082042a0201003082    0&apos;0=*H.0*0
                042306092a864886f70d01070130819106092a864886f70d01050d3081833062    #*H0*H00b
                06092a864886f70d01050c305504409230fd49789d0b306756c36540fc618f09    *H0U@0Ix0gVe@a
                05fc94d32f934c12312e92b80a737058f3919dc41b024b14c9a3eb45922628b5    /L1.spXKE&amp;amp;(
                14f013842a44af174b26b7f30dd88402030f4240300c06082a864886f70d020b    *DK&amp;amp;B@0*H
                0500301d060960864801650304012a0410121c481cab9a38375a29a8eb4d4703    0`He*H87Z)MG
                f380820380b4abd22fed0e82635ae69b52d94ea261ce899cb7ceaa833706d6e6    /cZRNa7
                6c8a20fccd910e314306f737506a41a83b87db4ada1aec0bf274eccf7743e4b3    l 1C7PjA;JtwC
                f4e939f34d5b61a87521e5ac5fd7a558791d0de123097ccd020cf33e82767403    9M[au!_Xy#|&amp;gt;vt
                7058be6836a97220209c99c18997dd4aaaf6376e8daea39e92baacec67b89a14    pXh6r  J7ng
                2b4ac3693ec47b51d8cc61b991da01f35628fdae4d1009dd3c8dbc01c062e706    +Ji&amp;gt;{QaV(M&amp;lt;b
                6112c7b08cb7450315106e8bf8a3b7f1f3928f7425e721a3dc1cf01dc5eeede9    aEnt%!
                83cb37100b3ca085503f933f68ffd6657babc856f044971212f7010fb06536dc    7&amp;lt;P??he{VDe6
                734004a97666d94ed83cc9df2886476a7b702c31cd99176829593fd1f1f57316    s@vfN&amp;lt;(Gj{p,1h)Y?s
                7be6748aa6d86140b82c5fe2241d6a6e15c4a0652dfe18212aeb87df2ebbaa9f    {ta@,_$jne-!*.
                eb1a165e8e110048e5779395c46934a65bc22989974a858dda6c109646cd72e0    ^Hwi4[)JlFr
                5d0f51557b4e1f195c7f88daca7899386b1cab3de7f7210f237be69990369f44    ]QU{N\x8k=!#{6D
                f7ea5db85d522f00550a88093d7b9d76459ee94880ddd2ea763cc908d4615106    ]]R/U={vEHv&amp;lt;aQ
                60f1be1a86936aa6c6499a270a5938dc9b265f43e4226a63699937f9ad2818db    `jI&apos;Y8&amp;amp;_C&quot;jci7(
                32b0c21f2b8fe249d15de176e31b3bd2d521b7a907491072e1ee871f52c2676a    2+I]v;!IrRgj
                bee50948cac7be13896420747b5ced1ef573581d5d40a52b1f2f1e691a6079c7    Hd t{\sX]@+/i`y
                04f5a5637aea75c426868b83ef22b3b8714628a354342feeb4c320b83eb22fd0    czu&amp;amp;&quot;qF(T4/ &amp;gt;/
                1c6aa5834cf8dc0879f2cb1168be6449b53fbd6dc9e62ca8256e6da3a2d19906    jLyhdI?m,%nm
                5cdbdeaec0999743c9020f154155b717b6b1678bf987794e60608fefd0571ae1    \CAUgyN``W
                6f8123f30c45d02d19b2d9e854343ab37cd5798d94f63898601a37fd019c9bc8    o#E-T4:|y8`7
                881f6c6efebf91df9666a5e1b177e3deb8eb1ce4ed42b6a73ec771540d9dd419    lnfwB&amp;gt;qT
                f46d420c1ef3128a550a5cc5f36ef402f72710e8ac6a7661fb7d3387a5f84de5    mBU\n&apos;jva}3M
                3c1424db71d44382a19b7a70f94e06aff9d2c88b213daaf437f6d524d22524c5    &amp;lt;$qCzpN!=7$%$
                cb7d9d6ba2cea9ebcb99dffeb8fb0d9138075e0ef8f12035dabfe289c2d73448    }k8^ 54H
                e815bfb34eecd8d7d77a6beda1b9db71ff083e92afa92e32937c54c492c8847e    Nzkq&amp;gt;.2|T~
                b1244ee5ee0ccbb2fbe0f7bf277cd3ea6c53123e96feea6866d6d8d9af9c4b94    $N&apos;|lS&amp;gt;hfK
                bc07ee4a285459b6a221bf04f7bef730efb108db1a157e9a4d622122f440bf9f    J(TY!0~Mb!&quot;@
                248109387f9362ed59ed44686828f3ff060888bd34a76350aa680ac8b1b7e0c1    $8bYDhh(4cPh
                d0c05d2a3ee91a346413511b48362e58dffbeae55789ae179307032e9fabc033    ]*&amp;gt;4dQH6.XW.3
                8e2d1a16af308205e206092a864886f70d010701a08205d3048205cf308205cb    -0*H0
                308205c7060b2a864886f70d010c0a0102a082056c3082056830819106092a86    0*Hl0h0*
                4886f70d01050d308183306206092a864886f70d01050c305504407e483ed9a8    H00b*H0U@~H&amp;gt;
                2f508286cc2b702fce42d3f49e1212899c2306da11428d0a2d0c5753842afea9    /P+p/B#B-WS*
                318e126f5a9210a35eef41201ade1621342275bbdc1e1203c5c3ac02030f4240    1oZ^A !4&quot;uB@
                300c06082a864886f70d020b0500301d060960864801650304012a04105e90cb    0*H0`He*^
                77a055e0be074a4e8f80f84aee048204d00e38277e485269d64f955a49ed5247    wUJNJ8&apos;~HRiOZIRG
                e5a24f6717b07a91d15574d46bd2b442d0a13ab34fec55be179bfdf6eae15eee    OgzUtkB:OU^
                01aa261854275d2d93be49898b759880b8f47249b04d735803b6f16102da8909    &amp;amp;T&apos;]-IurIMsXa
                cf74c73172a798a209943e65efec491a3bf09ccf022acdfb1e0bb6fd9a50a1d9    t1r&amp;gt;eI;*P
                bc01c848dbbb7c8e66fa0349ef29445ada763b62427b00fa87bc2846d1b9f690    H|fI)DZv;bB{(F
                0066d4a6d2ead07f7b1b83f8a8f7ca69200a45a5f39ecb0476f9cf09d57b2e63    f{i Ev{.c
                da8a0faf0faf1fb0e924716695d9f207f8fc977ba7793e1aa65efe7652fdf83d    $qf{y&amp;gt;^vR=
                750738ce443365ae96b94f275ce0e13af5f2cb400722053a9f618d56f108314b    u8D3eO&apos;\:@&quot;:aV1K
                b7183342c26f9fde3a075d92597c509fd570bd9917d773921445e03eaf00fe24    3Bo:]Y|PpsE&amp;gt;$
                48227e6d4492dc51e975dfde2fac15e8c9b1ee812958bd00200177228c39a0c1    H&quot;~mDQu/)X w&quot;9
                b8d1b92545153cfd3064dc8d464cfada545d7ed8b96b8cbeb58d4ecb19572633    %E&amp;lt;0dFLT]~kNW&amp;amp;3
                82d86f727c4a5cbebf127c9de46e6566e61ef779922903c3df79d0c84743cf25    or|J\|nefy)yGC%
                e9287c48c8535bf71cf6b0104160a762f403ce7da791e3c38781bcffc1537f16    (|HS[A`b}S
                bd6d9d9a55ac3475d0a82e8aa9d98e10525fc2795ebeef45c9bf50924059b01d    mU4u.R_y^EP@Y
                f715839f37e44969f3ec248f19c030cdd0a693d5749f7686b704d27f1a52ca00    7Ii$0tvR
                98d6e856d4efece298383aecfa82aa19bc98eef9e9f333a656479ffa0dd85c6e    V8:3VG\n
                df0fa6cd82d1c5115a507b9abebfb716d03729cc196d41382890482e0259b9f5    ZP{7)mA8(H.Y
                4016a1b718ac074ba88aa9a06d2dd6134578caeb7513b64a5e93c4970b8f9460    @Km-ExuJ^`
                b25c6a2871c801d8464d64ef4a494b9d33483bb5979ac8aaa404aeaa721e75e2    \j(qFMdJIK3H;ru
                90b35eb26fcd1e004c8c1507ff349d656bd4caf52b7af890cc744c645c0a0274    ^oL4ek+ztLd\t
                8e2a27fc66a6f0f82dfcc3886432ce4ccc875a4893a17b844dbb96e972d79199    *&apos;f-d2LZH{Mr
                755bf826069c42d40d46d9526a2f236be06eb88be7527d8ef5c840aeff3df423    u[&amp;amp;BFRj/#knR}@=#
                744ce3534ed2e07a79be3004ae58b95eef13de3118d9d66f5312f2cdc26fc651    tLSNzy0X^1oSoQ
                b78abf60fb8e23ae882b335c9cbec1bb183f2c16752d18de9eccfdb4e35bb4cb    `#+3\?,u-[
                86f928c1633bb537c246482544437d55aeaf7440c04c9c224461b84506df011b    (c;7FH%DC}Ut@L&quot;DaE
                cd82bcb114413981c019e05c4e21cc96524092b9adca37b981abf2446d892ffb    A9\N!R@7Dm/
                56ae49c633577fbced2fefc43336b25d3853e8b4c7c16ac31371e49f09c840a7    VI3W/36]8Sjq@
                e9b2e9d9a695cccc1d48b8dd338f6cd68c4cdc57710d87c32512d82f2a5b0b23    H3lLWq%/*[#
                20fb30682ced9e2bf9578378f5efe8055fa4a38bef3ee3485e2ae406205c8940     0h,+Wx_&amp;gt;H^* \@
                d0dd1fa1ec74e52763f17483a510fa8e6cbffb684643756379cf235c901f15f6    t&apos;ctlhFCucy#\
                4b965bda9375bf56a945c02c5d1664525a670c66b1bf6b877565e1836cf6280b    K[uVE,]dRZgfkuel(
                f42c4c9f7144641452039dc03ddc59cfa08f53378d4d42d0ff34b3d991821da2    ,LqDdR=YS7MB4
                9324f8615a451866cc2eedce81506b195ddddab1b3645ec781f2abbed656382f    $aZEf.Pk]d^V8/
                1d138436888b39d3d8db4c0aa3fa9e44de0096ad0562528d8fba607b098493f0    69LDbR`{
                4ffe0ce322e81ca815fbc227670f4f94eef87093ee90faf067a0084ac709f8f5    O&quot;&apos;gOpgJ
                ad90ff67872afe0c78a9040fa52eb76dd299534cabb030e4cdcf3893054a646d    g*x.mSL08Jdm
                b5e34e238965f39d1bd8d1fc096518c1c91281dda48d0f5fc4e3e5251c424aa5    N#ee_%BJ
                24d9074f7f8d5eac2df5f35fc17deec4c8be939a050e40514a73cadd62041172    $O^-_}@QJsbr
                6fda2b98eabd3909a3e5b9b79f1852e2e321d43755d295564c0d98247759896f    o+9R!7UVL$wYo
                b73148302106092a864886f70d01091431141e12006c006f00630061006c0068    1H0!*H1localh
                006f00730074302306092a864886f70d01091531160414e376b462052b2fd4b9    ost0#*H1vb+/
                125bb0eae04f10c8c0c5b0                                              [O
    Sequence
        Sequence
            Sequence
                ObjectIdentifier(2.16.840.1.101.3.4.2.3)
                NULL
            DER Octet String[64] 
                bbaf9100d3ab8fb53a7c95b17339e10b8af6a995bb9df52b10d70f5dbb0cf090    :|s9+]
                8f559373c26ac066f06028449ac3ee2967a840503fee7c9681d86acd599fe61f    Usjf`(D)g@P?|jY
        DER Octet String[64] 
            fb5bed4dc04cda9b274130c9a7e772bfa9e6e45bb406464f3b77e4f2ebe0b852    [ML&apos;A0r[FO;wR
            78a02e7734f1ea47936305b0f895b3992b7db216d80bd89539633d9e4c9be3cc    x.w4Gc+}9c=L
        Integer(1000000)

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17816193" author="tallison@mitre.org" created="Fri, 9 Feb 2024 19:26:01 +0000"  >&lt;p&gt;ObjectIdentifiers? 1.2.840.113549.1.7.1 (&lt;a href=&quot;https://oidref.com/1.2.840.113549.1.7.1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://oidref.com/1.2.840.113549.1.7.1&lt;/a&gt;), but that&apos;s just pkcs7 data type, nothing specific to pkcs12?&lt;/p&gt;

&lt;p&gt;Possibly useful? &lt;a href=&quot;https://learn.microsoft.com/en-us/windows/win32/api/wincrypt/ns-wincrypt-crypt_algorithm_identifier&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://learn.microsoft.com/en-us/windows/win32/api/wincrypt/ns-wincrypt-crypt_algorithm_identifier&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17816198" author="tallison@mitre.org" created="Fri, 9 Feb 2024 19:40:59 +0000"  >&lt;p&gt;I&apos;ve just attached a dump of running that on all the *.p12 files in the repo mentioned on &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-4194&quot; title=&quot;tika fails to detect certain pkcs12 keystores types p12 pfx&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-4194&quot;&gt;&lt;del&gt;TIKA-4194&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17816788" author="gagravarr" created="Mon, 12 Feb 2024 20:56:13 +0000"  >&lt;p&gt;From &lt;a href=&quot;https://datatracker.ietf.org/doc/rfc7292/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://datatracker.ietf.org/doc/rfc7292/&lt;/a&gt; it looks like PKCS12 is based on PKCS7, so that&apos;s expected. There&apos;s a few more types defined in &lt;a href=&quot;https://www.rfc-editor.org/rfc/rfc7292.html#appendix-D&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://www.rfc-editor.org/rfc/rfc7292.html#appendix-D&lt;/a&gt; - not sure if we can find any of those to match on?&lt;/p&gt;

&lt;p&gt;Thought &lt;a href=&quot;https://www.cs.auckland.ac.nz/~pgut001/pubs/pfx.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://www.cs.auckland.ac.nz/~pgut001/pubs/pfx.html&lt;/a&gt; does suggest this isn&apos;t an ideal format...&lt;/p&gt;</comment>
                            <comment id="17816811" author="tom_1st" created="Mon, 12 Feb 2024 23:07:27 +0000"  >&lt;p&gt;PKCS12 is not the easiest format :-|&lt;/p&gt;

&lt;p&gt;The oid for pkcs12 starts with &quot;1.2.840.113549.1.12&quot;&lt;/p&gt;

&lt;p&gt;I decoded one pkcs12 example (from redhat) and got the following:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&amp;lt;SEQUENCE&amp;gt;
&#160;&amp;lt;INTEGER&amp;gt;3&amp;lt;/INTEGER&amp;gt;
&#160;&amp;lt;SEQUENCE&amp;gt;
&#160; &amp;lt;OBJECT_IDENTIFIER Comment=&lt;span class=&quot;code-quote&quot;&gt;&quot;PKCS #7&quot;&lt;/span&gt; Description=&lt;span class=&quot;code-quote&quot;&gt;&quot;data&quot;&lt;/span&gt;&amp;gt;1.2.840.113549.1.7.1&amp;lt;/OBJECT_IDENTIFIER&amp;gt;
&#160; &amp;lt;NODE Sign=&lt;span class=&quot;code-quote&quot;&gt;&quot;a0&quot;&lt;/span&gt;&amp;gt;
&#160; &#160;&amp;lt;OCTET_STRING&amp;gt;
&#160; &#160; &amp;lt;OCTET_STRING&amp;gt;
&#160; &#160; &#160;&amp;lt;SEQUENCE&amp;gt;
&#160; &#160; &#160; &amp;lt;SEQUENCE&amp;gt;
&#160; &#160; &#160; &#160;&amp;lt;OBJECT_IDENTIFIER Comment=&lt;span class=&quot;code-quote&quot;&gt;&quot;PKCS #7&quot;&lt;/span&gt; Description=&lt;span class=&quot;code-quote&quot;&gt;&quot;data&quot;&lt;/span&gt;&amp;gt;1.2.840.113549.1.7.1&amp;lt;/OBJECT_IDENTIFIER&amp;gt;
&#160; &#160; &#160; &#160;&amp;lt;NODE Sign=&lt;span class=&quot;code-quote&quot;&gt;&quot;a0&quot;&lt;/span&gt;&amp;gt;
&#160; &#160; &#160; &#160; &amp;lt;OCTET_STRING&amp;gt;
&#160; &#160; &#160; &#160; &#160;&amp;lt;OCTET_STRING&amp;gt;
&#160; &#160; &#160; &#160; &#160; &amp;lt;SEQUENCE&amp;gt;
&#160; &#160; &#160; &#160; &#160; &#160;&amp;lt;SEQUENCE&amp;gt;
&#160; &#160; &#160; &#160; &#160; &#160; &amp;lt;OBJECT_IDENTIFIER Comment=&lt;span class=&quot;code-quote&quot;&gt;&quot;PKCS #12 BagIds&quot;&lt;/span&gt; Description=&lt;span class=&quot;code-quote&quot;&gt;&quot;pkcs-12-pkcs-8ShroudedKeyBag&quot;&lt;/span&gt;&amp;gt;1.2.840.113549.1.12.10.1.2&amp;lt;/OBJECT_IDENTIFIER&amp;gt;
&#160; &#160; &#160; &#160; &#160; &#160; &amp;lt;NODE Sign=&lt;span class=&quot;code-quote&quot;&gt;&quot;a0&quot;&lt;/span&gt;&amp;gt;
&#160; &#160; &#160; &#160; &#160; &#160; &#160;&amp;lt;SEQUENCE&amp;gt;
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &amp;lt;SEQUENCE&amp;gt;
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;&amp;lt;OBJECT_IDENTIFIER Comment=&lt;span class=&quot;code-quote&quot;&gt;&quot;PKCS #12 PbeIds&quot;&lt;/span&gt; Description=&lt;span class=&quot;code-quote&quot;&gt;&quot;pbeWithSHAAnd3-KeyTripleDES-CBC&quot;&lt;/span&gt;&amp;gt;1.2.840.113549.1.12.1.3&amp;lt;/OBJECT_IDENTIFIER&amp;gt;
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;&amp;lt;SEQUENCE&amp;gt;
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &amp;lt;OCTET_STRING&amp;gt;0xC8CCE579B6DE5B393F7C4885714C04BA&amp;lt;/OCTET_STRING&amp;gt;
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &amp;lt;INTEGER&amp;gt;2000&amp;lt;/INTEGER&amp;gt;
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;&amp;lt;/SEQUENCE&amp;gt;
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &amp;lt;/SEQUENCE&amp;gt;
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &amp;lt;OCTET_STRING&amp;gt;0x...(shortened fro readability)&amp;lt;/OCTET_STRING&amp;gt;
&#160; &#160; &#160; &#160; &#160; &#160; &#160;&amp;lt;/SEQUENCE&amp;gt;
&#160; &#160; &#160; &#160; &#160; &#160; &amp;lt;/NODE&amp;gt;
&#160; &#160; &#160; &#160; &#160; &#160; &amp;lt;SET&amp;gt;
&#160; &#160; &#160; &#160; &#160; &#160; &#160;&amp;lt;SEQUENCE&amp;gt;
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &amp;lt;OBJECT_IDENTIFIER Comment=&lt;span class=&quot;code-quote&quot;&gt;&quot;PKCS #9 via PKCS #12&quot;&lt;/span&gt; Description=&lt;span class=&quot;code-quote&quot;&gt;&quot;friendlyName (&lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; PKCS #12)&quot;&lt;/span&gt;&amp;gt;1.2.840.113549.1.9.20&amp;lt;/OBJECT_IDENTIFIER&amp;gt;
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &amp;lt;SET&amp;gt;
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;&amp;lt;BMP_STRING Incomplete=&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt;&amp;gt;0x00630061&amp;lt;/BMP_STRING&amp;gt;
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &amp;lt;/SET&amp;gt;
&#160; &#160; &#160; &#160; &#160; &#160; &#160;&amp;lt;/SEQUENCE&amp;gt;
&#160; &#160; &#160; &#160; &#160; &#160; &#160;&amp;lt;SEQUENCE&amp;gt;
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &amp;lt;OBJECT_IDENTIFIER Comment=&lt;span class=&quot;code-quote&quot;&gt;&quot;PKCS #9 via PKCS #12&quot;&lt;/span&gt; Description=&lt;span class=&quot;code-quote&quot;&gt;&quot;localKeyID (&lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; PKCS #12)&quot;&lt;/span&gt;&amp;gt;1.2.840.113549.1.9.21&amp;lt;/OBJECT_IDENTIFIER&amp;gt;
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &amp;lt;SET&amp;gt;
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;&amp;lt;OCTET_STRING&amp;gt;0x0CDA92EB395D4697A9D178352AF6B2BF06947888&amp;lt;/OCTET_STRING&amp;gt;
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &amp;lt;/SET&amp;gt;
&#160; &#160; &#160; &#160; &#160; &#160; &#160;&amp;lt;/SEQUENCE&amp;gt;
&#160; &#160; &#160; &#160; &#160; &#160; &amp;lt;/SET&amp;gt;
&#160; &#160; &#160; &#160; &#160; &#160;&amp;lt;/SEQUENCE&amp;gt;
&#160; &#160; &#160; &#160; &#160; &amp;lt;/SEQUENCE&amp;gt;
&#160; &#160; &#160; &#160; &#160;&amp;lt;/OCTET_STRING&amp;gt;
&#160; &#160; &#160; &#160; &amp;lt;/OCTET_STRING&amp;gt;
&#160; &#160; &#160; &#160;&amp;lt;/NODE&amp;gt;
&#160; &#160; &#160; &amp;lt;/SEQUENCE&amp;gt;
&#160; &#160; &#160; &amp;lt;SEQUENCE&amp;gt;
&#160; &#160; &#160; &#160;&amp;lt;OBJECT_IDENTIFIER Comment=&lt;span class=&quot;code-quote&quot;&gt;&quot;PKCS #7&quot;&lt;/span&gt; Description=&lt;span class=&quot;code-quote&quot;&gt;&quot;encryptedData&quot;&lt;/span&gt;&amp;gt;1.2.840.113549.1.7.6&amp;lt;/OBJECT_IDENTIFIER&amp;gt;
&#160; &#160; &#160; &#160;&amp;lt;NODE Sign=&lt;span class=&quot;code-quote&quot;&gt;&quot;a0&quot;&lt;/span&gt;&amp;gt;
&#160; &#160; &#160; &#160; &amp;lt;SEQUENCE&amp;gt;
&#160; &#160; &#160; &#160; &#160;&amp;lt;INTEGER/&amp;gt;
&#160; &#160; &#160; &#160; &#160;&amp;lt;SEQUENCE&amp;gt;
&#160; &#160; &#160; &#160; &#160; &amp;lt;OBJECT_IDENTIFIER Comment=&lt;span class=&quot;code-quote&quot;&gt;&quot;PKCS #7&quot;&lt;/span&gt; Description=&lt;span class=&quot;code-quote&quot;&gt;&quot;data&quot;&lt;/span&gt;&amp;gt;1.2.840.113549.1.7.1&amp;lt;/OBJECT_IDENTIFIER&amp;gt;
&#160; &#160; &#160; &#160; &#160; &amp;lt;SEQUENCE&amp;gt;
&#160; &#160; &#160; &#160; &#160; &#160;&amp;lt;OBJECT_IDENTIFIER Comment=&lt;span class=&quot;code-quote&quot;&gt;&quot;PKCS #12 PbeIds&quot;&lt;/span&gt; Description=&lt;span class=&quot;code-quote&quot;&gt;&quot;pbeWithSHAAnd40BitRC2-CBC&quot;&lt;/span&gt;&amp;gt;1.2.840.113549.1.12.1.6&amp;lt;/OBJECT_IDENTIFIER&amp;gt;
&#160; &#160; &#160; &#160; &#160; &#160;&amp;lt;SEQUENCE&amp;gt;
&#160; &#160; &#160; &#160; &#160; &#160; &amp;lt;OCTET_STRING&amp;gt;0x7F432D60BCD2888476E6CB9CD2BC69F1&amp;lt;/OCTET_STRING&amp;gt;
&#160; &#160; &#160; &#160; &#160; &#160; &amp;lt;INTEGER&amp;gt;2000&amp;lt;/INTEGER&amp;gt;
&#160; &#160; &#160; &#160; &#160; &#160;&amp;lt;/SEQUENCE&amp;gt;
&#160; &#160; &#160; &#160; &#160; &amp;lt;/SEQUENCE&amp;gt;
&#160; &#160; &#160; &#160; &#160; &amp;lt;NODE Sign=&lt;span class=&quot;code-quote&quot;&gt;&quot;a0&quot;&lt;/span&gt;&amp;gt;
&#160; &#160; &#160; &#160; &#160; &#160;&amp;lt;OCTET_STRING&amp;gt;0x...(shortened fro readability)&amp;lt;/OCTET_STRING&amp;gt;
&#160; &#160; &#160; &#160; &#160; &#160;&amp;lt;OCTET_STRING&amp;gt;0x0E8E4C15DCB1D87F&amp;lt;/OCTET_STRING&amp;gt;
&#160; &#160; &#160; &#160; &#160; &amp;lt;/NODE&amp;gt;
&#160; &#160; &#160; &#160; &#160;&amp;lt;/SEQUENCE&amp;gt;
&#160; &#160; &#160; &#160; &amp;lt;/SEQUENCE&amp;gt;
&#160; &#160; &#160; &#160;&amp;lt;/NODE&amp;gt;
&#160; &#160; &#160; &amp;lt;/SEQUENCE&amp;gt;
&#160; &#160; &#160;&amp;lt;/SEQUENCE&amp;gt;
&#160; &#160; &amp;lt;/OCTET_STRING&amp;gt;
&#160; &#160;&amp;lt;/OCTET_STRING&amp;gt;
&#160; &amp;lt;/NODE&amp;gt;
&#160;&amp;lt;/SEQUENCE&amp;gt;
&#160;&amp;lt;SEQUENCE&amp;gt;
&#160; &amp;lt;SEQUENCE&amp;gt;
&#160; &#160;&amp;lt;SEQUENCE&amp;gt;
&#160; &#160; &amp;lt;OBJECT_IDENTIFIER Comment=&lt;span class=&quot;code-quote&quot;&gt;&quot;OIW&quot;&lt;/span&gt; Description=&lt;span class=&quot;code-quote&quot;&gt;&quot;sha1&quot;&lt;/span&gt;&amp;gt;1.3.14.3.2.26&amp;lt;/OBJECT_IDENTIFIER&amp;gt;
&#160; &#160; &amp;lt;NULL/&amp;gt;
&#160; &#160;&amp;lt;/SEQUENCE&amp;gt;
&#160; &#160;&amp;lt;OCTET_STRING&amp;gt;0x6DFFA14B5A8A32A87DAD2CFCE1EAEBDAFB89C897&amp;lt;/OCTET_STRING&amp;gt;
&#160; &amp;lt;/SEQUENCE&amp;gt;
&#160; &amp;lt;OCTET_STRING&amp;gt;0x826699C21B9A4C9E3E608D3C8FBD2310&amp;lt;/OCTET_STRING&amp;gt;
&#160; &amp;lt;INTEGER&amp;gt;2000&amp;lt;/INTEGER&amp;gt;
&#160;&amp;lt;/SEQUENCE&amp;gt;
&amp;lt;/SEQUENCE&amp;gt; &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The oid is 3x in there - among others.&#160; The following things point to a pkcs12 format:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;Presence of PKCS#12-specific object identifiers (OIDs):
	&lt;ol&gt;
		&lt;li&gt;PKCS#12 Bag Types: presence of OIDs such as 1.2.840.113549.1.12.10.1.x, which indicate different types of key and certificate bags (KeyBags, CertBags, etc.).&lt;/li&gt;
		&lt;li&gt;PKCS#12 PbeIds: Encryption and hashing OIDs such as 1.2.840.113549.1.12.1.x, which indicate the use of specific encryption mechanisms&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
	&lt;li&gt;Use of encryption schemes:
	&lt;ol&gt;
		&lt;li&gt;Recognize encryption schemes, especially those that are typical for PKCS#12, such as pbeWithSHAAnd3-KeyTripleDES-CBC and pbeWithSHAAnd40BitRC2-CBC. These schemes are crucial for the security of PKCS#12 files and a clear indication of their presence.&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
	&lt;li&gt;&#160;Structure of the file:
	&lt;ol&gt;
		&lt;li&gt;Analyzing the file structure for multi-level nested SEQUENCE and OCTET_STRING elements, which are typically used to store encrypted private keys and certificates. The complexity of this structure is characteristic of PKCS#12 files.&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
	&lt;li&gt;Specific attributes:
	&lt;ol&gt;
		&lt;li&gt;PKCS#9 attributes such as friendlyName (OID 1.2.840.113549.1.9.20) and localKeyID (OID 1.2.840.113549.1.9.21) are commonly used to provide metadata for keys and certificates within the container.&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
	&lt;li&gt;&#160;... and more&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;However since we are already talking about Libraries - Standard Java Crypto and BouncyCastle have all this already inside. They are parsing the structures, analyze and use it. So using one of these two would be the easiest solution imho. I have never written a Detector so please excuse my ignorance:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;PKCS12Detector &lt;span class=&quot;code-keyword&quot;&gt;implements&lt;/span&gt; Detector {&#160; &#160; 
    &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; serialVersionUID = -8414458255467101503L;
&#160; &#160; &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; MediaType PKCS12_MEDIA_TYPE = MediaType.application(&lt;span class=&quot;code-quote&quot;&gt;&quot;x-pkcs12&quot;&lt;/span&gt;);&#160; &#160; 
    
    @Override
&#160; &#160; &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; MediaType detect(InputStream input, Metadata metadata) {
&#160; &#160; &#160; &#160; &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
&#160; &#160; &#160; &#160; &#160; &#160; KeyStore keyStore = KeyStore.getInstance(&lt;span class=&quot;code-quote&quot;&gt;&quot;PKCS12&quot;&lt;/span&gt;);
&#160; &#160; &#160; &#160; &#160; &#160; keyStore.load(input, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;);
&#160; &#160; &#160; &#160; &#160; &#160; &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; PKCS12_MEDIA_TYPE; &lt;span class=&quot;code-comment&quot;&gt;// success
&lt;/span&gt;&#160; &#160; &#160; &#160; }
&#160; &#160; &#160; &#160; &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (Exception e) {
&#160; &#160; &#160; &#160; &#160; &#160; &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; MediaType.OCTET_STREAM; &lt;span class=&quot;code-comment&quot;&gt;// something &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt;
&lt;/span&gt;&#160; &#160; &#160; &#160; }
&#160; &#160; }
} &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;A bouncy castle one would look quite similar - but currently I don&apos;t see any advantage over the standard Java API. The only thing coming to mind is performance: the Keystore loading using Standard Java takes quite some time. Maybe BC has a better performance?&lt;/p&gt;</comment>
                            <comment id="17816827" author="tallison@mitre.org" created="Tue, 13 Feb 2024 00:10:10 +0000"  >&lt;p&gt;Well, sure, if you want to make it easy! Y, let&apos;s go with something like that!&lt;/p&gt;

&lt;p&gt;I&apos;ll see what I can do tomorrow. Thank you!&lt;/p&gt;</comment>
                            <comment id="17816896" author="tom_1st" created="Tue, 13 Feb 2024 08:20:44 +0000"  >&lt;p&gt;One other possibility would be to combine both approaches:&lt;/p&gt;

&lt;p&gt;Usage of the current one which is quite fast to pre-categorize a file type. Then if it is a security related file type then use the keystore method of Java or BC to do the final determination...&lt;/p&gt;</comment>
                            <comment id="18004720" author="tallison@mitre.org" created="Fri, 11 Jul 2025 15:24:43 +0000"  >&lt;p&gt;I&apos;m toying with a simplified ASN1Dump to extract the oids, and I see the following... this is promising...&lt;/p&gt;

&lt;p&gt;OID: 1.2.840.113549.1.12.1.3&lt;br/&gt;
OID: 1.3.14.3.2.26&lt;br/&gt;
OID: 1.2.840.113549.1.12.1.6&lt;br/&gt;
OID: 1.2.840.113549.1.9.21&lt;br/&gt;
OID: 1.2.840.113549.1.7.1&lt;br/&gt;
OID: 1.2.840.113549.1.12.10.1.2&lt;br/&gt;
OID: 1.2.840.113549.1.7.6&lt;/p&gt;



&lt;p&gt;These clearly point to pks12 based on &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tom_1st&quot; class=&quot;user-hover&quot; rel=&quot;tom_1st&quot;&gt;tom_1st&lt;/a&gt; &apos;s analysis above. Can we use oids alone to differentiate the pks7 on &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-4454&quot; title=&quot;Media-type  application/pkcs7-mime&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-4454&quot;&gt;TIKA-4454&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-4194&quot; title=&quot;tika fails to detect certain pkcs12 keystores types p12 pfx&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-4194&quot;&gt;&lt;del&gt;TIKA-4194&lt;/del&gt;&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1997&quot; title=&quot;Problem in Tika().detect for xml file signed in CADES&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1997&quot;&gt;TIKA-1997&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="18005231" author="tallison@mitre.org" created="Mon, 14 Jul 2025 19:09:54 +0000"  >&lt;p&gt;This may fix a number of pkcs detection issues: &lt;a href=&quot;https://github.com/apache/tika/pull/2281&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/pull/2281&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;If anyone has any time to review, please do!&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12976341">TIKA-1997</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13567992">TIKA-4194</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="13066645" name="dump_p12s.txt" size="95632" author="tallison" created="Fri, 9 Feb 2024 19:40:20 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            16 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z12wiw:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>