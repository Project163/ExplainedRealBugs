<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:04:04 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[TIKA-3779] Temp file leftover in PDFParser.parse()</title>
                <link>https://issues.apache.org/jira/browse/TIKA-3779</link>
                <project id="12310631" key="TIKA">Tika</project>
                    <description>&lt;p&gt;I&apos;ve wondered where the many &quot;apache-tika-&quot; files in the temp directory came from. It turns out that they are all (or most) PDF files so I looked at the PDF parser module. After looking at the file sizes and getting a file name I focused on the test &lt;tt&gt;PDFParserTest.testSortByPosition()&lt;/tt&gt; where the first 2 parse tests have a leftover file and the 3rd one doesn&apos;t.&lt;/p&gt;

&lt;p&gt;The difference is that in the third one, &lt;tt&gt;PDFParser.parse()&lt;/tt&gt; gets a &lt;tt&gt;TikaInputStream&lt;/tt&gt; as parameter. &lt;tt&gt;TikaInputStream().get()&lt;/tt&gt; returns its parameter. But in the first two, it creates a new object, which is never closed. So the resource cleanup is never done.&lt;/p&gt;

&lt;p&gt;Adding&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!(stream &lt;span class=&quot;code-keyword&quot;&gt;instanceof&lt;/span&gt; TikaInputStream)) {
                tstream.close();
            }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;fixes this, i.e. no leftover files after running PDFParserTest.&lt;/p&gt;

&lt;p&gt;There&apos;s a null check in that method, but later the object is used without a null check. So either the null check isn&apos;t needed, or there is an NPE risk.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13447338">TIKA-3779</key>
            <summary>Temp file leftover in PDFParser.parse()</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tallison">Tim Allison</assignee>
                                    <reporter username="tilman">Tilman Hausherr</reporter>
                        <labels>
                    </labels>
                <created>Sat, 28 May 2022 16:08:04 +0000</created>
                <updated>Mon, 13 Jun 2022 17:36:18 +0000</updated>
                            <resolved>Mon, 13 Jun 2022 15:45:35 +0000</resolved>
                                    <version>2.4.0</version>
                                    <fixVersion>2.4.1</fixVersion>
                                    <component>parser</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="17543486" author="tilman" created="Sat, 28 May 2022 16:40:42 +0000"  >&lt;p&gt;Same problem in the GribParser.&lt;/p&gt;

&lt;p&gt;Even when fixing this, there are two extra files (.gbx9 and .ncx2) created. I tried the solution of&lt;br/&gt;
&lt;a href=&quot;https://docs.unidata.ucar.edu/netcdf-java/8.0/developer/disk_caching.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://docs.unidata.ucar.edu/netcdf-java/8.0/developer/disk_caching.html&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
DiskCache2 dc2 = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; DiskCache2(gribDir.getAbsolutePath(), &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;, 1, 1);
GribCollection.setDiskCache2(dc2);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;but that didn&apos;t work.&lt;/p&gt;</comment>
                            <comment id="17553636" author="tallison@mitre.org" created="Mon, 13 Jun 2022 15:10:06 +0000"  >&lt;p&gt;Thank you, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt;. I fixed the PDF issue and added the null check you recommended.  I&apos;ll push this update shortly.&lt;/p&gt;

&lt;p&gt;The the stream stuff has become messy because of the refactored rendering code.  &lt;/p&gt;

&lt;p&gt;I&apos;m going to try to fix the grib stuff now.&lt;/p&gt;</comment>
                            <comment id="17553637" author="tallison@mitre.org" created="Mon, 13 Jun 2022 15:10:33 +0000"  >&lt;p&gt;Er, the stream stuff is my fault from when I refactored the rendering code. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/biggrin.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/tongue.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="17553673" author="tallison@mitre.org" created="Mon, 13 Jun 2022 15:45:35 +0000"  >&lt;p&gt;The grib parser now creates a temp directory, copies the stream into that and then deletes the temp directory after the parse.&lt;/p&gt;</comment>
                            <comment id="17553734" author="hudson" created="Mon, 13 Jun 2022 17:36:18 +0000"  >&lt;p&gt;SUCCESS: Integrated in Jenkins build Tika &#187; tika-main-jdk8 #641 (See &lt;a href=&quot;https://ci-builds.apache.org/job/Tika/job/tika-main-jdk8/641/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://ci-builds.apache.org/job/Tika/job/tika-main-jdk8/641/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-3779&quot; title=&quot;Temp file leftover in PDFParser.parse()&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-3779&quot;&gt;&lt;del&gt;TIKA-3779&lt;/del&gt;&lt;/a&gt; &amp;#8211; make sure to close the temp stream in PDFParser and clean up after grib. (tallison: &lt;a href=&quot;https://github.com/apache/tika/commit/47de04f50597faa59d24405559f0cb5845ba7096&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/47de04f50597faa59d24405559f0cb5845ba7096&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) tika-parsers/tika-parsers-extended/tika-parser-scientific-module/src/main/java/org/apache/tika/parser/grib/GribParser.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-pdf-module/src/main/java/org/apache/tika/parser/pdf/PDFParser.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 21 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z12row:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>