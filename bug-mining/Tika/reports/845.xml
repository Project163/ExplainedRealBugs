<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:00:41 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[TIKA-2130] TaggedIOException from ZipException on a valid PowerPoint file</title>
                <link>https://issues.apache.org/jira/browse/TIKA-2130</link>
                <project id="12310631" key="TIKA">Tika</project>
                    <description>&lt;p&gt;On the following PPT file, which PowerPoint opens and displays fine:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://dl.dropboxusercontent.com/u/92341073/ny2004b.ppt&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://dl.dropboxusercontent.com/u/92341073/ny2004b.ppt&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;The Tika parser throws the following exception:&lt;/p&gt;

&lt;p&gt;org.apache.tika.io.TaggedIOException: incorrect data check&lt;br/&gt;
	at org.apache.tika.io.TaggedInputStream.handleIOException(TaggedInputStream.java:133)&lt;br/&gt;
	at org.apache.tika.io.ProxyInputStream.read(ProxyInputStream.java:103)&lt;br/&gt;
	at org.apache.tika.io.ProxyInputStream.read(ProxyInputStream.java:99)&lt;br/&gt;
	at java.io.BufferedInputStream.read1(Unknown Source)&lt;br/&gt;
	at java.io.BufferedInputStream.read(Unknown Source)&lt;br/&gt;
	at java.io.FilterInputStream.read(Unknown Source)&lt;br/&gt;
	at java.nio.file.Files.copy(Unknown Source)&lt;br/&gt;
	at java.nio.file.Files.copy(Unknown Source)&lt;br/&gt;
	at org.apache.tika.io.TikaInputStream.getPath(TikaInputStream.java:587)&lt;br/&gt;
	at org.apache.tika.io.TikaInputStream.getFile(TikaInputStream.java:615)&lt;br/&gt;
	at org.apache.tika.parser.microsoft.POIFSContainerDetector.getTopLevelNames(POIFSContainerDetector.java:377)&lt;br/&gt;
	at org.apache.tika.parser.microsoft.POIFSContainerDetector.detect(POIFSContainerDetector.java:443)&lt;br/&gt;
	at org.apache.tika.detect.CompositeDetector.detect(CompositeDetector.java:77)&lt;br/&gt;
	at org.apache.tika.parser.AutoDetectParser.parse(AutoDetectParser.java:112)&lt;br/&gt;
	at org.apache.tika.parser.DelegatingParser.parse(DelegatingParser.java:72)&lt;br/&gt;
	at org.apache.tika.extractor.ParsingEmbeddedDocumentExtractor.parseEmbedded(ParsingEmbeddedDocumentExtractor.java:102)&lt;br/&gt;
	at org.apache.tika.parser.microsoft.AbstractPOIFSExtractor.handleEmbeddedResource(AbstractPOIFSExtractor.java:140)&lt;br/&gt;
	at org.apache.tika.parser.microsoft.AbstractPOIFSExtractor.handleEmbeddedResource(AbstractPOIFSExtractor.java:116)&lt;br/&gt;
	at org.apache.tika.parser.microsoft.HSLFExtractor.handleSlideEmbeddedResources(HSLFExtractor.java:368)&lt;br/&gt;
	at org.apache.tika.parser.microsoft.HSLFExtractor.parse(HSLFExtractor.java:138)&lt;br/&gt;
	at org.apache.tika.parser.microsoft.OfficeParser.parse(OfficeParser.java:149)&lt;br/&gt;
	at org.apache.tika.parser.microsoft.OfficeParser.parse(OfficeParser.java:117)&lt;br/&gt;
	at gov.nih.niaid.fscanner.Extract.ExtractContents(Extract.java:62)&lt;br/&gt;
	at gov.nih.niaid.temp.Main.main(Main.java:60)&lt;br/&gt;
Caused by: java.util.zip.ZipException: incorrect data check&lt;br/&gt;
	at java.util.zip.InflaterInputStream.read(Unknown Source)&lt;br/&gt;
	at org.apache.poi.util.BoundedInputStream.read(BoundedInputStream.java:121)&lt;br/&gt;
	at java.io.BufferedInputStream.fill(Unknown Source)&lt;br/&gt;
	at java.io.BufferedInputStream.read1(Unknown Source)&lt;br/&gt;
	at java.io.BufferedInputStream.read(Unknown Source)&lt;br/&gt;
	at org.apache.tika.io.ProxyInputStream.read(ProxyInputStream.java:99)&lt;br/&gt;
	... 22 more&lt;/p&gt;</description>
                <environment>&lt;p&gt;Windows 7 x64, JVM 1.8.0_101&lt;/p&gt;</environment>
        <key id="13013894">TIKA-2130</key>
            <summary>TaggedIOException from ZipException on a valid PowerPoint file</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="sevaa">Seva Alekseyev</reporter>
                        <labels>
                    </labels>
                <created>Thu, 20 Oct 2016 14:12:12 +0000</created>
                <updated>Mon, 12 Apr 2021 13:01:08 +0000</updated>
                            <resolved>Fri, 21 Oct 2016 14:38:54 +0000</resolved>
                                    <version>1.13</version>
                                    <fixVersion>1.15</fixVersion>
                    <fixVersion>2.0.0</fixVersion>
                                    <component>parser</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="15595166" author="tallison@mitre.org" created="Fri, 21 Oct 2016 13:57:13 +0000"  >&lt;p&gt;I get this message when I try to open your file and another file in our corpus w the same exception.&lt;/p&gt;

&lt;p&gt;PowerPoint is able to fix both files.&lt;/p&gt;</comment>
                            <comment id="15595200" author="tallison@mitre.org" created="Fri, 21 Oct 2016 14:10:11 +0000"  >&lt;p&gt;On govdocs 258642.ppt, the uncompressed length of the first problematic embedded Excel.Chart.8 is 199168.  I&apos;m able to read 199167 bytes, and then I get the zip header check exception.  &lt;/p&gt;

&lt;p&gt;Unless there are objections, I propose catching this one exception in Tika&apos;s HSLFParser and swallowing it.&lt;/p&gt;</comment>
                            <comment id="15595347" author="sevaa" created="Fri, 21 Oct 2016 15:04:19 +0000"  >&lt;p&gt;Not in my PowerPoint 2013. It just opens and displays, no &quot;repair&quot; message. I even scrolled through all the slides. It mentions that the references to external media are blocked though.&lt;/p&gt;</comment>
                            <comment id="15595388" author="hudson" created="Fri, 21 Oct 2016 15:16:29 +0000"  >&lt;p&gt;FAILURE: Integrated in Jenkins build tika-2.x-windows #67 (See &lt;a href=&quot;https://builds.apache.org/job/tika-2.x-windows/67/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/tika-2.x-windows/67/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2130&quot; title=&quot;TaggedIOException from ZipException on a valid PowerPoint file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2130&quot;&gt;&lt;del&gt;TIKA-2130&lt;/del&gt;&lt;/a&gt; (tallison: rev 936e3ac166b49a679cc8914221291fa03ec43b93)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(add) tika-test-resources/src/test/resources/test-documents/testPPT_skipBadCompressedObject.ppt&lt;/li&gt;
	&lt;li&gt;(edit) tika-parser-modules/tika-parser-office-module/src/main/java/org/apache/tika/parser/microsoft/HSLFExtractor.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parser-modules/tika-parser-office-module/src/test/java/org/apache/tika/parser/microsoft/PowerPointParserTest.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15595478" author="hudson" created="Fri, 21 Oct 2016 15:50:51 +0000"  >&lt;p&gt;SUCCESS: Integrated in Jenkins build tika-2.x #165 (See &lt;a href=&quot;https://builds.apache.org/job/tika-2.x/165/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/tika-2.x/165/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2130&quot; title=&quot;TaggedIOException from ZipException on a valid PowerPoint file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2130&quot;&gt;&lt;del&gt;TIKA-2130&lt;/del&gt;&lt;/a&gt; (tallison: rev 936e3ac166b49a679cc8914221291fa03ec43b93)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(add) tika-test-resources/src/test/resources/test-documents/testPPT_skipBadCompressedObject.ppt&lt;/li&gt;
	&lt;li&gt;(edit) tika-parser-modules/tika-parser-office-module/src/test/java/org/apache/tika/parser/microsoft/PowerPointParserTest.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parser-modules/tika-parser-office-module/src/main/java/org/apache/tika/parser/microsoft/HSLFExtractor.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15595617" author="hudson" created="Fri, 21 Oct 2016 16:38:18 +0000"  >&lt;p&gt;SUCCESS: Integrated in Jenkins build Tika-trunk #1125 (See &lt;a href=&quot;https://builds.apache.org/job/Tika-trunk/1125/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Tika-trunk/1125/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2130&quot; title=&quot;TaggedIOException from ZipException on a valid PowerPoint file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2130&quot;&gt;&lt;del&gt;TIKA-2130&lt;/del&gt;&lt;/a&gt; (tallison: rev 7ca105ef5716a23300da0b8939fcfa249b798532)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(add) tika-parsers/src/test/resources/test-documents/testPPT_skipBadCompressedObject.ppt&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/microsoft/HSLFExtractor.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/test/java/org/apache/tika/parser/microsoft/PowerPointParserTest.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13017810">TIKA-2157</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13018066">TIKA-2159</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12834683" name="errorMsg.png" size="24983" author="tallison" created="Fri, 21 Oct 2016 13:57:13 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 4 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i355p3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>