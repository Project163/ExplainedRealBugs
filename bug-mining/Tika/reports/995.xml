<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:01:42 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[TIKA-2588] Tika detecting/parsing pptx with embedded Excel worksheet(s)...</title>
                <link>https://issues.apache.org/jira/browse/TIKA-2588</link>
                <project id="12310631" key="TIKA">Tika</project>
                    <description>&lt;p&gt;Hello tika-developers,&lt;/p&gt;

&lt;p&gt;First, a big &apos;thank-you&apos; for creating and maintaining Apache-Tika!&#160; A really useful capability/service that can be used in so many different ways.&#160; You folks are the true Debabelizer (h2g2.com).&lt;/p&gt;

&lt;p&gt;On to issue-encountered: using Tika 1.17 to extract an embedded Excel object out of a pptx is causing issues.&#160; Simple example attached to this Jira-issue (&lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12911913/12911913_tikaSample.pptx&quot; title=&quot;tikaSample.pptx attached to TIKA-2588&quot;&gt;tikaSample.pptx&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;) which if run against Tika 1.17 (with verbose/list-parsers/list-detectors) provides the output in (&lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12911912/12911912_foo.out&quot; title=&quot;foo.out attached to TIKA-2588&quot;&gt;foo.out&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;).&#160; The deck contains a title slide, and a single-slide with embedded Excel object on it.&lt;/p&gt;

&lt;p&gt;As noted to &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gagravarr&quot; class=&quot;user-hover&quot; rel=&quot;gagravarr&quot;&gt;gagravarr&lt;/a&gt; on S-Overflow, I grabbed the unit-test data which you use in your parser/office JUnit suite (test_ppt_embedded_two_slides.pptx) and tried opening in Office/PPT 2016.&#160; I selected (with mouse) the embedded sheet (had Alfresco logo in it) and pasted it into an empty Office/Excel 2016 workbook.&#160; When I tried to interact with it, I had to double-click to make it active.&#160; As a result, I ended up with two Excel instances on my Windows 10 desktop (the original object in 1, the Excel worksheet in another).&#160; I have included a picture of the embedded Excel object pasted into the workbook...  &lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/12911911/12911911_pptEmbedExcelInEmptyWorkbook.PNG&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt; ).&lt;/p&gt;

&lt;p&gt;followed by the worksheet opened inside the workbook (required double-click within the black-bordered area in the first pic above):&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/12911910/12911910_pptEmbedExcelDoubleClickFromWorkbook.PNG&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;I managed to extract the embedded object using&#160;apache POI.&#160; The&#160;logic sequence was something&#160;like the following:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;Create an XMLSlideShow object, and pull the list of underlying slide entities.&lt;/li&gt;
	&lt;li&gt;Walk the list of XSLFSlide(s), searching for a matching slide (by name) - e.g. &apos;MFL&apos;.&lt;/li&gt;
	&lt;li&gt;Examine PackagePart&#160;of&#160;XSLFSlide (matching name) and for content-type.&lt;/li&gt;
	&lt;li&gt;If pPart.content-type is &apos;application/vnd.openxmlformats-officedocument.oleObject&apos; then - &apos;candidate FOUND&apos;.&lt;/li&gt;
	&lt;li&gt;Build POIFS around the candidate FOUND, extract root of FileSystem.&lt;/li&gt;
	&lt;li&gt;Verify that root has entries for { &apos;Package&apos;, &apos;\u0001Ole&apos;, and &apos;\u0001CompObj&apos; }.&lt;/li&gt;
	&lt;li&gt;Extract entry &apos;\u0001CompObj&apos;, verify entry is a DocumentEntry and underlying bytes for DocumentNode match an &apos;Excel&apos; signature.&lt;/li&gt;
	&lt;li&gt;If (step 7 is true) -&amp;gt; extract entry &apos;Package&apos;.&lt;/li&gt;
	&lt;li&gt;The resulting entry represents the byte-stream of the embedded Excel entity.&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;I was able to instantiate this into a new workbook (as an example) using POI, and when I opened it, the worksheet was correctly embedded in that &apos;example.xlsx&apos;.&lt;/p&gt;

&lt;p&gt;I am not as familiar with Tika, so was a little less comfortable trying to walk it through.&#160; I thought however, recreating this path would provide further insight for you.&lt;/p&gt;</description>
                <environment>&lt;p&gt;&#160;&lt;/p&gt;</environment>
        <key id="13140726">TIKA-2588</key>
            <summary>Tika detecting/parsing pptx with embedded Excel worksheet(s)...</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tallison">Tim Allison</assignee>
                                    <reporter username="gto406">Brian McColgan</reporter>
                        <labels>
                    </labels>
                <created>Sat, 24 Feb 2018 16:00:07 +0000</created>
                <updated>Tue, 29 Oct 2019 15:52:03 +0000</updated>
                            <resolved>Mon, 26 Feb 2018 20:26:11 +0000</resolved>
                                    <version>1.17</version>
                                    <fixVersion>1.18</fixVersion>
                    <fixVersion>2.0.0</fixVersion>
                                    <component>detector</component>
                    <component>parser</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="16376963" author="tallison@mitre.org" created="Mon, 26 Feb 2018 14:36:41 +0000"  >&lt;p&gt;Whoa, thank you!  I&apos;ll take a look shortly.&lt;/p&gt;</comment>
                            <comment id="16377531" author="tallison@mitre.org" created="Mon, 26 Feb 2018 20:26:11 +0000"  >&lt;p&gt;Thank you, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gto406&quot; class=&quot;user-hover&quot; rel=&quot;gto406&quot;&gt;gto406&lt;/a&gt;, for identifying this problem, opening an issue on our tracker and describing the fix!&lt;/p&gt;

&lt;p&gt;Thank you, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=nick&quot; class=&quot;user-hover&quot; rel=&quot;nick&quot;&gt;nick&lt;/a&gt;, for staffing StackOverflow! &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="16377659" author="hudson" created="Mon, 26 Feb 2018 21:56:49 +0000"  >&lt;p&gt;SUCCESS: Integrated in Jenkins build Tika-trunk #1441 (See &lt;a href=&quot;https://builds.apache.org/job/Tika-trunk/1441/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Tika-trunk/1441/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2588&quot; title=&quot;Tika detecting/parsing pptx with embedded Excel worksheet(s)...&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2588&quot;&gt;&lt;del&gt;TIKA-2588&lt;/del&gt;&lt;/a&gt; &amp;#8211; extract xlsx stored within ole objects in ppt/x via Brian (tallison: &lt;a href=&quot;https://github.com/apache/tika/commit/16a8ff95290027682762932b6b29463790fe5b6d&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/16a8ff95290027682762932b6b29463790fe5b6d&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(add) tika-parsers/src/test/resources/test-documents/testPPT_oleWorkbook.ppt&lt;/li&gt;
	&lt;li&gt;(add) tika-parsers/src/test/resources/test-documents/testPPT_oleWorkbook.pptx&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/test/java/org/apache/tika/parser/microsoft/PowerPointParserTest.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/test/java/org/apache/tika/parser/microsoft/ooxml/OOXMLParserTest.java&lt;/li&gt;
	&lt;li&gt;(edit) CHANGES.txt&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/microsoft/ooxml/AbstractOOXMLExtractor.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/microsoft/HSLFExtractor.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="16384705" author="gto406" created="Sat, 3 Mar 2018 15:42:45 +0000"  >&lt;p&gt;Tested this, and it works great now!  I was able to extract my sample embedded Worksheet (Excel) object in 1 extract.&lt;/p&gt;

&lt;p&gt;Thank you very much sir!!&lt;/p&gt;</comment>
                            <comment id="16384707" author="gto406" created="Sat, 3 Mar 2018 15:43:31 +0000"  >&lt;p&gt;Issue resolved very quickly effectively by the maestro Tika-developer T.A.  Thank you once again, you rock!&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310560">
                    <name>Problem/Incident</name>
                                            <outwardlinks description="causes">
                                        <issuelink>
            <issuekey id="13148624">TIKA-2617</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12911912" name="foo.out" size="6562" author="gto406" created="Sat, 24 Feb 2018 15:48:31 +0000"/>
                            <attachment id="12911910" name="pptEmbedExcelDoubleClickFromWorkbook.PNG" size="136022" author="gto406" created="Sat, 24 Feb 2018 15:59:51 +0000"/>
                            <attachment id="12911911" name="pptEmbedExcelInEmptyWorkbook.PNG" size="66144" author="gto406" created="Sat, 24 Feb 2018 15:58:13 +0000"/>
                            <attachment id="12911913" name="tikaSample.pptx" size="44001" author="gto406" created="Sat, 24 Feb 2018 15:46:52 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 37 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3qk8n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>