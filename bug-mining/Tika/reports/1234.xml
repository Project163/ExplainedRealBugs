<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:03:36 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[TIKA-3518] Tika 1.26 not Working with Tesseract 4.0 and Higher Version</title>
                <link>https://issues.apache.org/jira/browse/TIKA-3518</link>
                <project id="12310631" key="TIKA">Tika</project>
                    <description>&lt;p&gt;ProcessBuilder not creating tmp file for Tesseract 4.1 and Higher Versions With Tika 1.26 and JDK 1.8&lt;/p&gt;

&lt;p&gt;I am working on a project which integrates Tika and Tesseract OCR Tika Version is 1.26, JDK 1.8 Now for any Tesseract Version earlier than 4.0 works fine and extracts the image/pdf data correctly But upgrading the TesseractOCR to 4.1.1 or Higher results in no data extraction. I debugged the issue and found that the ProcessBuilder is not creating the temporary txt output file from which TesseractOCR extracts the result, resulting in the issue. Any idea if this is a version compatibility issue Or How to resolve this?&lt;/p&gt;</description>
                <environment></environment>
        <key id="13394063">TIKA-3518</key>
            <summary>Tika 1.26 not Working with Tesseract 4.0 and Higher Version</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="abha.1012">Abha</reporter>
                        <labels>
                    </labels>
                <created>Sun, 8 Aug 2021 05:51:46 +0000</created>
                <updated>Wed, 18 Aug 2021 17:06:36 +0000</updated>
                            <resolved>Wed, 18 Aug 2021 16:36:54 +0000</resolved>
                                    <version>1.26</version>
                                    <fixVersion>2.1.0</fixVersion>
                                    <component>ocr</component>
                    <component>tika-batch</component>
                    <component>tika-dl</component>
                    <component>tika-server</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="17395964" author="tallison@mitre.org" created="Mon, 9 Aug 2021 10:47:37 +0000"  >&lt;p&gt;I&apos;m not seeing problems with 4.1.1 locally. &lt;/p&gt;

&lt;p&gt;I think we added more debugging/logging in 1.27 and 2.0.0.  Can you upgrade and see if the issue persists and/or what the cause might be?  Does tesseract return an exception, etc...&lt;/p&gt;</comment>
                            <comment id="17396218" author="abha.1012" created="Mon, 9 Aug 2021 18:42:00 +0000"  >&lt;p&gt;On debugging it seems that, the processbuilder (java) is not creating the tmp (txt output) file, hence the Tesseract check for isfileexists fails and doesn&apos;t extract the results.&lt;/p&gt;

&lt;p&gt;I am using JDK 1.8, is there any Java version incompatibility?&lt;/p&gt;</comment>
                            <comment id="17396258" author="abha.1012" created="Mon, 9 Aug 2021 20:17:39 +0000"  >&lt;p&gt;I tested it with JDK 11 and still the same issue.&lt;/p&gt;

&lt;p&gt;The ProcessBuilder class in Java does not creates the file for Tesseract 4.0 and higher versions. This is the sample code i am using -&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;#0747a6&quot;&gt;&lt;sub&gt;Parser parser = new AutoDetectParser();&lt;/sub&gt;&lt;/font&gt;&lt;br/&gt;
 &lt;font color=&quot;#0747a6&quot;&gt;&lt;sub&gt;BodyContentHandler handler = new BodyContentHandler(Integer.MAX_VALUE);&lt;/sub&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;#0747a6&quot;&gt;&lt;sub&gt;TesseractOCRConfig config = new TesseractOCRConfig();&lt;/sub&gt;&lt;/font&gt;&lt;br/&gt;
 &lt;font color=&quot;#0747a6&quot;&gt;&lt;sub&gt;String tPath = &quot;C:&lt;/sub&gt;&lt;br/&gt;
&lt;sub&gt;Program Files (x86)&lt;/sub&gt;&lt;br/&gt;
&lt;sub&gt;Tesseract-OCR&quot;; // tesseract installation directory.&lt;/sub&gt;&lt;/font&gt;&lt;br/&gt;
 &lt;font color=&quot;#0747a6&quot;&gt;&lt;sub&gt;config.setTesseractPath(tPath);&lt;/sub&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;#0747a6&quot;&gt;&lt;sub&gt;config.setPageSegMode(&quot;3&quot;);&lt;/sub&gt;&lt;/font&gt;&lt;br/&gt;
 &lt;font color=&quot;#0747a6&quot;&gt;&lt;sub&gt;ParseContext parseContext = new ParseContext();&lt;/sub&gt;&lt;/font&gt;&lt;br/&gt;
 &lt;font color=&quot;#0747a6&quot;&gt;&lt;sub&gt;parseContext.set(TesseractOCRConfig.class, config);&lt;/sub&gt;&lt;/font&gt;&lt;br/&gt;
 &lt;font color=&quot;#0747a6&quot;&gt;&lt;sub&gt;//need to add this to make sure recursive parsing happens!&lt;/sub&gt;&lt;/font&gt;&lt;br/&gt;
 &lt;font color=&quot;#0747a6&quot;&gt;&lt;sub&gt;parseContext.set(Parser.class, parser);&lt;/sub&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;#0747a6&quot;&gt;&lt;sub&gt;// Parsed file location directory.&lt;/sub&gt;&lt;/font&gt;&lt;br/&gt;
 &lt;font color=&quot;#0747a6&quot;&gt;&lt;sub&gt;FileInputStream stream = new FileInputStream(&quot;E://Env//3.jpg&quot;);&lt;/sub&gt;&lt;/font&gt;&lt;br/&gt;
 &lt;font color=&quot;#0747a6&quot;&gt;&lt;sub&gt;Metadata metadata = new Metadata();&lt;/sub&gt;&lt;/font&gt;&lt;br/&gt;
 &lt;font color=&quot;#0747a6&quot;&gt;&lt;sub&gt;parser.parse(stream, handler, metadata, parseContext);&lt;/sub&gt;&lt;/font&gt;&lt;br/&gt;
 &lt;font color=&quot;#0747a6&quot;&gt;&lt;sub&gt;System.out.println(metadata);&lt;/sub&gt;&lt;/font&gt;&lt;br/&gt;
 &lt;font color=&quot;#0747a6&quot;&gt;&lt;sub&gt;String content = handler.toString();&lt;/sub&gt;&lt;/font&gt;&lt;br/&gt;
 &lt;font color=&quot;#0747a6&quot;&gt;&lt;sub&gt;System.out.println(&quot;===============&quot;);&lt;/sub&gt;&lt;/font&gt;&lt;br/&gt;
 &lt;font color=&quot;#0747a6&quot;&gt;&lt;sub&gt;System.out.println(content);&lt;/sub&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Is there any new config changes that needs to be added ? Can this problem be specific to a machine? Also this is being tested in Windows.&lt;/p&gt;</comment>
                            <comment id="17396277" author="tallison@mitre.org" created="Mon, 9 Aug 2021 20:45:39 +0000"  >&lt;p&gt;There shouldn&apos;t be any new config changes. Hmmm...&lt;/p&gt;

&lt;p&gt;When you say the processbuilder isn&apos;t creating the tmp file, does that mean that tesseract is failing to run at all?  &lt;/p&gt;

&lt;p&gt;In 2.x, we added:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;            throw new TikaException(
                    &quot;TesseractOCRParser bad exit value &quot; + exitValue + &quot; err msg: &quot; +
                            errBuilder.toString());

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;so that you could see what tesseract was not happy with.  It looks like we backported that to 1.27. &lt;/p&gt;

&lt;p&gt;I know that we fixed some windows based issues in 2.x, but this &lt;em&gt;shouldn&apos;t&lt;/em&gt; be a problem.   Thank you for your help in debugging this!&lt;/p&gt;

&lt;p&gt;Apologies if I&apos;ve missed this, but have you tried 1.27?&lt;/p&gt;

&lt;p&gt;If you set logging to debug, what is the commandline used to call tesseract?  Does it work if you copy and paste it into a cmd.exe window?&lt;/p&gt;</comment>
                            <comment id="17396332" author="abha.1012" created="Tue, 10 Aug 2021 00:36:13 +0000"  >&lt;p&gt;Update &#8211;&lt;/p&gt;

&lt;p&gt;So i tried 1.27 and I can see the error as -&lt;/p&gt;

&lt;p&gt;Exception in thread &quot;main&quot; org.apache.tika.exception.TikaException: TesseractOCRParser bad exit value 1 err msg: Error opening data file C:\Program Files\Tesseract-OCR\eng.traineddata&lt;br/&gt;
 Please make sure the TESSDATA_PREFIX environment variable is set to your &quot;tessdata&quot; directory.&lt;br/&gt;
 Failed loading language &apos;eng&apos;&lt;br/&gt;
 Tesseract couldn&apos;t load any languages!&lt;br/&gt;
 Could not initialize tesseract.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;This is for all the Tesseract versions starting from 4.0 and above, I have set the TESSDATA_PREFIX as C:\Program Files\Tesseract-OCR\tessdata and can see it has value during runtime, i tried replacing eng.traineddata from the latest git download, it still gives the same error for all the Tesseract versions, only works for 3.x versions&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17396339" author="abha.1012" created="Tue, 10 Aug 2021 01:09:22 +0000"  >&lt;p&gt;So if i copy the eng.traineddata from the tessdata folder and move it to the parent folder (Tesseract-OCR) it&apos;s working.&lt;/p&gt;

&lt;p&gt;Not sure if it&apos;s they way it&apos;s picking up the TESSDATA_PREFIX environment variable.&lt;/p&gt;</comment>
                            <comment id="17401093" author="tallison@mitre.org" created="Wed, 18 Aug 2021 14:21:38 +0000"  >&lt;p&gt;I think I figured out what is going on...   There is a bug.  At least for tesseract 5.x and at least on Windows, the tesseract data path must include &quot;tessdata&quot;.  In our code if the tessdata path is not specified via the TikaConfig, but the tesseract path is specified, we use the tesseract path as the tessdata path (on the untested theory that tesseract would figure it out), but this is not right.  We need to append &quot;/tessdata&quot; to the tesseract path.&lt;/p&gt;

&lt;p&gt;So, you are setting the tesseract path, and our code is currently using that path to set the tessdata environment variable in the spawned process.  Again, this is a bug that we need to fix.&lt;/p&gt;

&lt;p&gt;If tesseract is on your path and you don&apos;t specify a custom tesseract path via the config.  It should just work.&lt;/p&gt;

&lt;p&gt;Let me confirm this works on Linux, and I&apos;ll fix this before the 2.1.0 release.&lt;/p&gt;</comment>
                            <comment id="17401104" author="tallison@mitre.org" created="Wed, 18 Aug 2021 14:34:07 +0000"  >&lt;p&gt;&lt;del&gt;I&apos;m wondering if in the earlier versions of tesseract, one pointed to the directory above tessdata?&lt;/del&gt;&lt;/p&gt;

&lt;p&gt;I tested the fix on Windows with tesseract 3.05 and 5.x-alpha and on Ubuntu with 4.x.  It all works.&lt;/p&gt;</comment>
                            <comment id="17401163" author="hudson" created="Wed, 18 Aug 2021 15:59:16 +0000"  >&lt;p&gt;SUCCESS: Integrated in Jenkins build Tika &#187; tika-main-jdk8 #315 (See &lt;a href=&quot;https://ci-builds.apache.org/job/Tika/job/tika-main-jdk8/315/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://ci-builds.apache.org/job/Tika/job/tika-main-jdk8/315/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-3518&quot; title=&quot;Tika 1.26 not Working with Tesseract 4.0 and Higher Version&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-3518&quot;&gt;&lt;del&gt;TIKA-3518&lt;/del&gt;&lt;/a&gt; &amp;#8211; add &quot;/tessdata&quot; if a custom tesseractpath is set but a custom tessdata path is not set. (tallison: &lt;a href=&quot;https://github.com/apache/tika/commit/190e98ceafa7700a4d227c254e186613518496d0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/190e98ceafa7700a4d227c254e186613518496d0&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-ocr-module/src/main/java/org/apache/tika/parser/ocr/TesseractOCRParser.java&lt;/li&gt;
	&lt;li&gt;(edit) CHANGES.txt&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/tika-parsers-standard/tika-parsers-standard-package/src/test/java/org/apache/tika/parser/ocr/TesseractOCRParserTest.java&lt;/li&gt;
	&lt;li&gt;(add) tika-parsers/tika-parsers-standard/tika-parsers-standard-package/src/test/resources/org/apache/tika/parser/ocr/tesseract-config.xml&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="17401255" author="hudson" created="Wed, 18 Aug 2021 17:06:36 +0000"  >&lt;p&gt;UNSTABLE: Integrated in Jenkins build Tika &#187; tika-main-jdk8 #316 (See &lt;a href=&quot;https://ci-builds.apache.org/job/Tika/job/tika-main-jdk8/316/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://ci-builds.apache.org/job/Tika/job/tika-main-jdk8/316/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-3518&quot; title=&quot;Tika 1.26 not Working with Tesseract 4.0 and Higher Version&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-3518&quot;&gt;&lt;del&gt;TIKA-3518&lt;/del&gt;&lt;/a&gt; &amp;#8211; don&apos;t need extra path separator (tallison: &lt;a href=&quot;https://github.com/apache/tika/commit/96472c9e5f7713ee80533e8891e8993dde76a03f&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/96472c9e5f7713ee80533e8891e8993dde76a03f&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-ocr-module/src/main/java/org/apache/tika/parser/ocr/TesseractOCRParser.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 12 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0tpd4:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>