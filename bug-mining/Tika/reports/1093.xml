<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:02:27 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[TIKA-2883] Text not extracted from RTF files</title>
                <link>https://issues.apache.org/jira/browse/TIKA-2883</link>
                <project id="12310631" key="TIKA">Tika</project>
                    <description>&lt;p&gt;I have a number of RTF files (extracted from&#160;PST email bodies) which text is not extracted currently. Sample file attached. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tallison%40apache.org&quot; class=&quot;user-hover&quot; rel=&quot;tallison@apache.org&quot;&gt;tallison@apache.org&lt;/a&gt;, do you have any ideia what is going on?&lt;/p&gt;</description>
                <environment></environment>
        <key id="13236028">TIKA-2883</key>
            <summary>Text not extracted from RTF files</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tallison">Tim Allison</assignee>
                                    <reporter username="lfcnassif">Lu&#237;s Filipe Nassif</reporter>
                        <labels>
                    </labels>
                <created>Tue, 28 May 2019 16:01:03 +0000</created>
                <updated>Wed, 29 May 2019 22:03:00 +0000</updated>
                            <resolved>Wed, 29 May 2019 15:24:45 +0000</resolved>
                                    <version>1.20</version>
                    <version>1.19.1</version>
                    <version>1.21</version>
                                    <fixVersion>1.22</fixVersion>
                                    <component>parser</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="16850086" author="tallison@mitre.org" created="Tue, 28 May 2019 19:52:32 +0000"  >&lt;p&gt;Looks like html embedded inside RTF...yikes...&lt;/p&gt;</comment>
                            <comment id="16850119" author="rossj" created="Tue, 28 May 2019 20:29:16 +0000"  >&lt;p&gt;I know a bit about these types of files. Outlook / Exchange will often store messages as RTF-encapsulated HTML. This is a mixed-representation of the text &amp;amp; formatting, such that a conforming RTF reader sees it as just a normal RTF file and ignores the HTML tags, while a special RTF de-encapsulator reader can still read the original HTML tags and ignore the other RTF operators. The actual body text / content is only included a single time and is shared between both representations. A conforming RTF reader should not have to do anything special to get the text or ignore the HTML tags. There is also such a thing as RTF-encapsulated plain text, which is similar to RTF-encapsulated HTML.&lt;/p&gt;

&lt;p&gt;If Tika is not giving any text output for this file, then there is probably a bug in the RTF reader that is being used. Perhaps it is getting hung up on the various HTML control words that is doesn&apos;t know how to handle, when it should instead be ignoring them.&lt;/p&gt;

&lt;p&gt;Source: I wrote a (non-Java) RTF de-encapsulator for text and HTML &lt;a href=&quot;https://github.com/mazira/rtf-stream-parser&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/mazira/rtf-stream-parser&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16850180" author="lfcnassif" created="Tue, 28 May 2019 21:56:04 +0000"  >&lt;p&gt;hum... tried to extract embedded items from rtf, no results. Seems to be what &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rossj&quot; class=&quot;user-hover&quot; rel=&quot;rossj&quot;&gt;rossj&lt;/a&gt; said, thank you for the explanation.&lt;/p&gt;</comment>
                            <comment id="16850186" author="lfcnassif" created="Tue, 28 May 2019 22:06:18 +0000"  >&lt;p&gt;&lt;a href=&quot;https://docs.microsoft.com/en-us/openspecs/exchange_server_protocols/ms-oxrtfex/906fbb0f-2467-490e-8c3e-bdc31c5e9d35&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://docs.microsoft.com/en-us/openspecs/exchange_server_protocols/ms-oxrtfex/906fbb0f-2467-490e-8c3e-bdc31c5e9d35&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16850807" author="tallison@mitre.org" created="Wed, 29 May 2019 12:24:49 +0000"  >&lt;p&gt;The file isn&apos;t triggering: &lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;inHeader = false;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;If we add: &lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;if (...|| equals(&quot;htmlrtf&quot;))
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt; 

&lt;p&gt;text is mostly correctly extracted.  There&apos;s another open issue that I&apos;d like to track down, where our RTFParser doesn&apos;t realize that it is not out of the head section of the RTF...&lt;/p&gt;</comment>
                            <comment id="16850810" author="tallison@mitre.org" created="Wed, 29 May 2019 12:32:24 +0000"  >&lt;p&gt;And, hahahahaha... we already had one of these types of files in our unit test suite: testRTFHyperlink.rtf&lt;/p&gt;

&lt;p&gt;The difference with that file is that there is a trigger that we&apos;re out of the header.&lt;/p&gt;

&lt;p&gt;I&apos;m going to do a bit more investigation before committing the fix, but this looks fairly straightforward.&lt;/p&gt;</comment>
                            <comment id="16850813" author="tallison@mitre.org" created="Wed, 29 May 2019 12:42:21 +0000"  >&lt;blockquote&gt;&lt;p&gt;There&apos;s another open issue that I&apos;d like to track down&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Well, three, it turns out...&lt;/p&gt;</comment>
                            <comment id="16850930" author="lfcnassif" created="Wed, 29 May 2019 14:58:33 +0000"  >&lt;p&gt;Thanks for taking a look, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tallison%40apache.org&quot; class=&quot;user-hover&quot; rel=&quot;tallison@apache.org&quot;&gt;tallison@apache.org&lt;/a&gt;!&lt;/p&gt;

&lt;p&gt;Found this&#160;&lt;a href=&quot;https://github.com/joniles/rtfparserkit&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/joniles/rtfparserkit&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;But it fails with some RTFs with } chars not opened before. I&apos;ve patched it to ignore those chars and it worked with all Outlook RTFs I have.&lt;/p&gt;

&lt;p&gt;Don&apos;t know if that lib supports embedded files...&lt;/p&gt;</comment>
                            <comment id="16850936" author="tallison@mitre.org" created="Wed, 29 May 2019 15:04:45 +0000"  >&lt;p&gt;I have a local fix that works for all four issues.  I&apos;ll push that once I get a clean local build.&lt;/p&gt;

&lt;p&gt;There&apos;s still the remaining item for future improvements that we&apos;re pretty much guessing when we&apos;re at the end of the header by whether we see &lt;tt&gt;par&lt;/tt&gt; or other text-y kinds of things.&lt;/p&gt;

&lt;p&gt;According to one RTF spec, this is what a header can look like, with ? for optional, obviously.&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;&amp;lt;header&amp;gt;	\rtf &amp;lt;charset&amp;gt; &amp;lt;deffont&amp;gt; \deff? &amp;lt;fonttbl&amp;gt; &amp;lt;filetbl&amp;gt;? &amp;lt;colortbl&amp;gt;? &amp;lt;stylesheet&amp;gt;? &amp;lt;listtables&amp;gt;? &amp;lt;revtbl&amp;gt;? &amp;lt;rsidtable&amp;gt;? &amp;lt;generator&amp;gt;?
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The obnoxious part is that there can be stuff in between those items, and I&apos;m hesitant to trust that RTFs follow the spec and actually require that order, etc...&lt;/p&gt;</comment>
                            <comment id="16850952" author="lfcnassif" created="Wed, 29 May 2019 15:16:25 +0000"  >&lt;p&gt;Great! Will test your fix with&#160;my other files when it is pushed&lt;/p&gt;</comment>
                            <comment id="16850957" author="hudson" created="Wed, 29 May 2019 15:19:29 +0000"  >&lt;p&gt;FAILURE: Integrated in Jenkins build tika-2.x-windows #421 (See &lt;a href=&quot;https://builds.apache.org/job/tika-2.x-windows/421/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/tika-2.x-windows/421/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2883&quot; title=&quot;Text not extracted from RTF files&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2883&quot;&gt;&lt;del&gt;TIKA-2883&lt;/del&gt;&lt;/a&gt; &amp;#8211; improve recognition of leaving the RTF header (tallison: rev f6644c577416c20ab8827ac857d75cf6874e093d)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(add) tika-parsers/src/test/resources/test-documents/testRTFTIKA_2883.rtf&lt;/li&gt;
	&lt;li&gt;(add) tika-parsers/src/test/resources/test-documents/testRTFTIKA_2500.rtf&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/rtf/TextExtractor.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/test/java/org/apache/tika/parser/rtf/RTFParserTest.java&lt;/li&gt;
	&lt;li&gt;(add) tika-parsers/src/test/resources/test-documents/testRTFTIKA_1713.rtf&lt;/li&gt;
	&lt;li&gt;(add) tika-parsers/src/test/resources/test-documents/testRTFTIKA_2150.rtf&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="16850960" author="tallison@mitre.org" created="Wed, 29 May 2019 15:24:45 +0000"  >&lt;p&gt;Y, please do let us know what you find!  Thank you, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lfcnassif&quot; class=&quot;user-hover&quot; rel=&quot;lfcnassif&quot;&gt;lfcnassif&lt;/a&gt;!&lt;/p&gt;</comment>
                            <comment id="16851020" author="hudson" created="Wed, 29 May 2019 16:12:28 +0000"  >&lt;p&gt;SUCCESS: Integrated in Jenkins build Tika-trunk #1667 (See &lt;a href=&quot;https://builds.apache.org/job/Tika-trunk/1667/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Tika-trunk/1667/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2883&quot; title=&quot;Text not extracted from RTF files&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2883&quot;&gt;&lt;del&gt;TIKA-2883&lt;/del&gt;&lt;/a&gt; &amp;#8211; improve recognition of leaving the RTF header (tallison: &lt;a href=&quot;https://github.com/apache/tika/commit/f6644c577416c20ab8827ac857d75cf6874e093d&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/f6644c577416c20ab8827ac857d75cf6874e093d&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(add) tika-parsers/src/test/resources/test-documents/testRTFTIKA_1713.rtf&lt;/li&gt;
	&lt;li&gt;(add) tika-parsers/src/test/resources/test-documents/testRTFTIKA_2883.rtf&lt;/li&gt;
	&lt;li&gt;(add) tika-parsers/src/test/resources/test-documents/testRTFTIKA_2150.rtf&lt;/li&gt;
	&lt;li&gt;(add) tika-parsers/src/test/resources/test-documents/testRTFTIKA_2500.rtf&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/rtf/TextExtractor.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/test/java/org/apache/tika/parser/rtf/RTFParserTest.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="16851030" author="lfcnassif" created="Wed, 29 May 2019 16:24:26 +0000"  >&lt;p&gt;Thank you, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tallison%40apache.org&quot; class=&quot;user-hover&quot; rel=&quot;tallison@apache.org&quot;&gt;tallison@apache.org&lt;/a&gt;!&lt;/p&gt;

&lt;p&gt;Worked with all 1121 Outlook RTF files from a specific corpus I have.&lt;/p&gt;</comment>
                            <comment id="16851037" author="hudson" created="Wed, 29 May 2019 16:28:26 +0000"  >&lt;p&gt;SUCCESS: Integrated in Jenkins build tika-branch-1x #199 (See &lt;a href=&quot;https://builds.apache.org/job/tika-branch-1x/199/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/tika-branch-1x/199/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2883&quot; title=&quot;Text not extracted from RTF files&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2883&quot;&gt;&lt;del&gt;TIKA-2883&lt;/del&gt;&lt;/a&gt; &amp;#8211; improve recognition of leaving the RTF header (tallison: &lt;a href=&quot;https://github.com/apache/tika/commit/839695271513c989058ccf17d4b64dda654abcaf&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/839695271513c989058ccf17d4b64dda654abcaf&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) tika-parsers/src/test/java/org/apache/tika/parser/rtf/RTFParserTest.java&lt;/li&gt;
	&lt;li&gt;(add) tika-parsers/src/test/resources/test-documents/testRTFTIKA_2150.rtf&lt;/li&gt;
	&lt;li&gt;(add) tika-parsers/src/test/resources/test-documents/testRTFTIKA_1713.rtf&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/rtf/TextExtractor.java&lt;/li&gt;
	&lt;li&gt;(add) tika-parsers/src/test/resources/test-documents/testRTFTIKA_2883.rtf&lt;/li&gt;
	&lt;li&gt;(add) tika-parsers/src/test/resources/test-documents/testRTFTIKA_2500.rtf&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="16851343" author="tallison@mitre.org" created="Wed, 29 May 2019 22:03:00 +0000"  >&lt;p&gt;W00t! &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/biggrin.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12856617">TIKA-1713</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13016158">TIKA-2150</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13117932">TIKA-2500</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12970045" name="Message (5).rtf" size="1526" author="lfcnassif" created="Tue, 28 May 2019 16:00:26 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 24 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z035hc:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>