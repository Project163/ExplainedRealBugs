<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:00:49 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[TIKA-2211] ePub formatting instructions appear in plain text output</title>
                <link>https://issues.apache.org/jira/browse/TIKA-2211</link>
                <project id="12310631" key="TIKA">Tika</project>
                    <description>&lt;p&gt;For some ePub files, format information appears in the plain text output produced by Apache Tika.  For example the Tika stand-alone application shows the following text for the file &#8220;Don Quijote de la Mancha - Miguel de Cervantes.epub&#8221; (dowloaded &lt;a href=&quot;http://www.literanda.com/don-quijote-de-la-mancha--miguel-de-cervantes--epub&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt;):&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-comment&quot;&gt;/**/&lt;/span&gt;

  p.sgc-2 {font-style: italic; text-align: right}
  p.sgc-1 {text-align: justify;}

  h3.sgc-3 {text-align: center;}
  &lt;span class=&quot;code-comment&quot;&gt;/**/&lt;/span&gt;

Al duque de B&#233;jar

Marqu&#233;s de Gibrale&#243;n, conde de Benalc&#225;zar y Ba&#241;ares, vizconde de La Puebla de Alcocer, se&#241;or de las villas de Capilla, Curiel y Burguillos

En fe del buen acogimiento y honra que hace Vuestra Excelencia a toda suerte de libros, como pr&#237;ncipe tan inclinado a favorecer las buenas artes, mayormente las que por su nobleza no se abaten al servicio y granjer&#237;as del vulgo, he determinado de sacar a luz El ingenioso hidalgo don Quijote de la Mancha, al abrigo del clar&#237;simo nombre de Vuestra Excelencia, a quien, con el acatamiento que debo a tanta grandeza, suplico le reciba agradablemente en su protecci&#243;n, para que a su sombra, aunque desnudo de aquel precioso ornamento de elegancia y erudici&#243;n de que suelen andar vestidas las obras que se componen en las casas de los hombres que saben, ose parecer seguramente en el juicio de algunos que, conteni&#233;ndose en los l&#237;mites de su ignorancia, suelen condenar con m&#225;s rigor y menos justicia los trabajos ajenos; que, poniendo los ojos la prudencia de Vuestra Excelencia en mi buen deseo, f&#237;o que no desde&#241;ar&#225; la cortedad de tan humilde servicio.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;To reproduce this problem run the stand-alone version of Tika and open an affected ePub file such as the one mentioned above.  Then go to View -&amp;gt; Plain Text.  You should see the problem there.&lt;/p&gt;

&lt;p&gt;By the way, thanks for making Apache Tika a really useful library.  Keep up the good work!&lt;/p&gt;</description>
                <environment>&lt;p&gt;I tested this on on Mac OSX 10.11.6 with Oracle JDK 1.8.0_112.  The Tika stand-alone application was launched as follows:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;java -jar tika-app-1.14.jar
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</environment>
        <key id="13028971">TIKA-2211</key>
            <summary>ePub formatting instructions appear in plain text output</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="apacheadam">Adam Carroll</reporter>
                        <labels>
                    </labels>
                <created>Sun, 18 Dec 2016 15:09:44 +0000</created>
                <updated>Mon, 12 Apr 2021 13:00:01 +0000</updated>
                            <resolved>Wed, 21 Dec 2016 14:11:52 +0000</resolved>
                                    <version>1.14</version>
                                    <fixVersion>1.15</fixVersion>
                    <fixVersion>2.0.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="15760978" author="tallison@mitre.org" created="Mon, 19 Dec 2016 11:55:19 +0000"  >&lt;p&gt;The ePub parser is using a straight SAXParser with no modifications.  Looks like we should modify it slightly to ignore &amp;lt;style/&amp;gt; sections?&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;&amp;lt;head&amp;gt;
  &amp;lt;title&amp;gt;&amp;lt;/title&amp;gt;
  &amp;lt;style type=&quot;text/css&quot;&amp;gt;
/*&amp;lt;![CDATA[*/

  p.sgc-2 {font-style: italic; text-align: right}
  p.sgc-1 {text-align: justify;}

  h3.sgc-3 {text-align: center;}
  /*]]&amp;gt;*/
  &amp;lt;/style&amp;gt;
&amp;lt;/head&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="15766504" author="apacheadam" created="Wed, 21 Dec 2016 08:48:44 +0000"  >&lt;p&gt;That certainly sounds like the cause of the problem!  Looking inside the file it appears to be just a container for HTML pages.  I don&apos;t know how Tika works internally but presumably the existing HTML parser already deals with this problem.  Could using that help?&lt;/p&gt;

&lt;p&gt;If that makes no sense, sorry.  Like I say, I don&apos;t know how Tika works internally...&lt;/p&gt;</comment>
                            <comment id="15767125" author="tallison@mitre.org" created="Wed, 21 Dec 2016 14:05:07 +0000"  >&lt;p&gt;That does make sense.  Unless we find that epub xhtml/html is as nasty as real html, I&apos;d prefer to leave that out.&lt;/p&gt;

&lt;p&gt;After some kicking of tires, the solution appears to be simpler.  The EPubContentParser was adding a new XHTMLContentHandler for each chapter.  I &lt;em&gt;think&lt;/em&gt; this prevented the BodyContentHandler from working properly &amp;#8211; this is a filter that only passes on contents from within &amp;lt;body&amp;gt;&amp;lt;/body&amp;gt; elements...which prevents &amp;lt;style&amp;gt; and &amp;lt;script&amp;gt; types of things that show up in &amp;lt;head&amp;gt; from entering the &quot;content&quot; section.&lt;/p&gt;

&lt;p&gt;Once I removed the xhtml content handler from the EPubContentParser, all seems to work, and only body elements are being added to the overall output.&lt;/p&gt;

&lt;p&gt;What I can&apos;t figure out is why no one has complained that the ToXML option didn&apos;t appear to work...at least on our one test file.  That now does work.&lt;/p&gt;

&lt;p&gt;Also, I turned on some tests for the iBooksParser.  There&apos;s a comment in the test code that it didn&apos;t use to work, but it seems to be working now even before I made the change...not sure what was going on there.&lt;/p&gt;</comment>
                            <comment id="15767157" author="hudson" created="Wed, 21 Dec 2016 14:19:43 +0000"  >&lt;p&gt;FAILURE: Integrated in Jenkins build tika-2.x-windows #87 (See &lt;a href=&quot;https://builds.apache.org/job/tika-2.x-windows/87/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/tika-2.x-windows/87/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2211&quot; title=&quot;ePub formatting instructions appear in plain text output&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2211&quot;&gt;&lt;del&gt;TIKA-2211&lt;/del&gt;&lt;/a&gt; modify test file to include style information to test that (tallison: rev c9fcb33159ea7276c630a4de0bbc031f260a4e08)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) tika-test-resources/src/test/resources/test-documents/testEPUB.epub&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2211&quot; title=&quot;ePub formatting instructions appear in plain text output&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2211&quot;&gt;&lt;del&gt;TIKA-2211&lt;/del&gt;&lt;/a&gt; &amp;#8211; make sure that head (&amp;lt;style&amp;gt;) content isn&apos;t showing up in (tallison: rev 337d383044ef805a5797bc2496c15ef3d23135b8)&lt;/li&gt;
	&lt;li&gt;(edit) tika-parser-modules/tika-parser-ebook-module/src/main/java/org/apache/tika/parser/epub/EpubContentParser.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parser-modules/tika-parser-ebook-module/src/test/java/org/apache/tika/parser/epub/EpubParserTest.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parser-modules/tika-parser-ebook-module/src/test/java/org/apache/tika/parser/ibooks/iBooksParserTest.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parser-modules/tika-parser-ebook-module/pom.xml&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15767223" author="hudson" created="Wed, 21 Dec 2016 14:46:16 +0000"  >&lt;p&gt;SUCCESS: Integrated in Jenkins build tika-2.x #186 (See &lt;a href=&quot;https://builds.apache.org/job/tika-2.x/186/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/tika-2.x/186/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2211&quot; title=&quot;ePub formatting instructions appear in plain text output&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2211&quot;&gt;&lt;del&gt;TIKA-2211&lt;/del&gt;&lt;/a&gt; modify test file to include style information to test that (tallison: rev c9fcb33159ea7276c630a4de0bbc031f260a4e08)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) tika-test-resources/src/test/resources/test-documents/testEPUB.epub&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2211&quot; title=&quot;ePub formatting instructions appear in plain text output&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2211&quot;&gt;&lt;del&gt;TIKA-2211&lt;/del&gt;&lt;/a&gt; &amp;#8211; make sure that head (&amp;lt;style&amp;gt;) content isn&apos;t showing up in (tallison: rev 337d383044ef805a5797bc2496c15ef3d23135b8)&lt;/li&gt;
	&lt;li&gt;(edit) tika-parser-modules/tika-parser-ebook-module/pom.xml&lt;/li&gt;
	&lt;li&gt;(edit) tika-parser-modules/tika-parser-ebook-module/src/test/java/org/apache/tika/parser/ibooks/iBooksParserTest.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parser-modules/tika-parser-ebook-module/src/main/java/org/apache/tika/parser/epub/EpubContentParser.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parser-modules/tika-parser-ebook-module/src/test/java/org/apache/tika/parser/epub/EpubParserTest.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15767229" author="hudson" created="Wed, 21 Dec 2016 14:48:55 +0000"  >&lt;p&gt;SUCCESS: Integrated in Jenkins build Tika-trunk #1165 (See &lt;a href=&quot;https://builds.apache.org/job/Tika-trunk/1165/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Tika-trunk/1165/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2211&quot; title=&quot;ePub formatting instructions appear in plain text output&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2211&quot;&gt;&lt;del&gt;TIKA-2211&lt;/del&gt;&lt;/a&gt; &amp;#8211; make sure that &amp;lt;head&amp;gt; content doesn&apos;t appear as content in (tallison: rev 202f137b7bd29f75d95ea815a28df30ab4f144da)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) tika-parsers/src/test/java/org/apache/tika/parser/ibooks/iBooksParserTest.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/test/java/org/apache/tika/parser/epub/EpubParserTest.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/test/resources/test-documents/testEPUB.epub&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/epub/EpubContentParser.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15769454" author="apacheadam" created="Thu, 22 Dec 2016 08:22:39 +0000"  >&lt;p&gt;That&apos;s great!  Big thanks for fixing the problem.  I look forward to integrating the next release of Apache Tika into my project.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 47 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i37qq7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>