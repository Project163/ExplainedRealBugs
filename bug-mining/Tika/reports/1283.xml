<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:04:01 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[TIKA-3776] HttpFetcher overwrites filename passed in</title>
                <link>https://issues.apache.org/jira/browse/TIKA-3776</link>
                <project id="12310631" key="TIKA">Tika</project>
                    <description>&lt;p&gt;The HttpFetcher spools file content to a temporary file with `TikaInputStream.get()` and passes through the existing metadata. TikaInputStream overwrites the filename with that of the temporary file.&lt;/p&gt;

&lt;p&gt;This means that passing the filename to the detect endpoint as a header is ignored and results from detection are incorrect.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13447094">TIKA-3776</key>
            <summary>HttpFetcher overwrites filename passed in</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tallison">Tim Allison</assignee>
                                    <reporter username="tombrisland">Tom Brisland</reporter>
                        <labels>
                    </labels>
                <created>Thu, 26 May 2022 21:07:10 +0000</created>
                <updated>Fri, 27 May 2022 19:01:22 +0000</updated>
                            <resolved>Fri, 27 May 2022 17:57:49 +0000</resolved>
                                                    <fixVersion>2.4.1</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="17542674" author="githubbot" created="Thu, 26 May 2022 21:12:50 +0000"  >&lt;p&gt;tombrisland opened a new pull request, #586:&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/tika/pull/586&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/pull/586&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;   &amp;lt;!--&lt;br/&gt;
     Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
     or more contributor license agreements.  See the NOTICE file&lt;br/&gt;
     distributed with this work for additional information&lt;br/&gt;
     regarding copyright ownership.  The ASF licenses this file&lt;br/&gt;
     to you under the Apache License, Version 2.0 (the&lt;br/&gt;
     &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
     with the License.  You may obtain a copy of the License at&lt;/p&gt;

&lt;p&gt;       &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;     Unless required by applicable law or agreed to in writing,&lt;br/&gt;
     software distributed under the License is distributed on an&lt;br/&gt;
     &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY&lt;br/&gt;
     KIND, either express or implied.  See the License for the&lt;br/&gt;
     specific language governing permissions and limitations&lt;br/&gt;
     under the License.&lt;br/&gt;
   --&amp;gt;&lt;/p&gt;

&lt;p&gt;   Thanks for your contribution to &lt;span class=&quot;error&quot;&gt;&amp;#91;Apache Tika&amp;#93;&lt;/span&gt;(&lt;a href=&quot;https://tika.apache.org/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://tika.apache.org/&lt;/a&gt;)! Your help is appreciated!&lt;/p&gt;

&lt;p&gt;   Before opening the pull request, please verify that&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;there is an open issue on the &lt;span class=&quot;error&quot;&gt;&amp;#91;Tika issue tracker&amp;#93;&lt;/span&gt;(&lt;a href=&quot;https://issues.apache.org/jira/projects/TIKA&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/projects/TIKA&lt;/a&gt;) which describes the problem or the improvement. We cannot accept pull requests without an issue because the change wouldn&apos;t be listed in the release notes.&lt;/li&gt;
	&lt;li&gt;the issue ID (`TIKA-XXXX`)&lt;/li&gt;
&lt;/ul&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;is referenced in the title of the pull request&lt;/li&gt;
	&lt;li&gt;and placed in front of your commit messages surrounded by square brackets (`&lt;span class=&quot;error&quot;&gt;&amp;#91;TIKA-XXXX&amp;#93;&lt;/span&gt; Issue or pull request title`)&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
	&lt;li&gt;commits are squashed into a single one (or few commits for larger changes)&lt;/li&gt;
	&lt;li&gt;Tika is successfully built and unit tests pass by running `mvn clean test`&lt;/li&gt;
	&lt;li&gt;there should be no conflicts when merging the pull request branch into the &lt;b&gt;recent&lt;/b&gt; `main` branch. If there are conflicts, please try to rebase the pull request branch on top of a freshly pulled `main` branch&lt;/li&gt;
	&lt;li&gt;if you add new module that downstream users will depend upon add it to relevant group in `tika-bom/pom.xml`.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   We will be able to faster integrate your pull request if these conditions are met. If you have any questions how to fix your problem or about using Tika in general, please sign up for the &lt;span class=&quot;error&quot;&gt;&amp;#91;Tika mailing list&amp;#93;&lt;/span&gt;(&lt;a href=&quot;http://tika.apache.org/mail-lists.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://tika.apache.org/mail-lists.html&lt;/a&gt;). Thanks!&lt;/p&gt;


</comment>
                            <comment id="17542676" author="tallison@mitre.org" created="Thu, 26 May 2022 21:17:02 +0000"  >&lt;p&gt;Thank you for opening this.  I think this problem is more pervasive than you&apos;ve identified.  We should probably add a call in TikaInputStream.get(Path) that differs from the existing one so that we don&apos;t overwrite the name of the file with the temporary file name.  TikaInputStream.getFromTemp(Path, Metadata) or similar?&lt;/p&gt;</comment>
                            <comment id="17542682" author="tombrisland" created="Thu, 26 May 2022 21:28:17 +0000"  >&lt;p&gt;Yeah sounds good if that&apos;s the way you want to go, it does seem a shame to have a duplicate method though. I think that the ideal solution would be to have TikaInputStream.get not overwrite the filename if it&apos;s already set, but obviously I didn&apos;t want to risk breakage.&lt;/p&gt;

&lt;p&gt;I went with passing empty Metadata because it matches the behaviour in S3Fetcher, so there was precedent at least.&lt;/p&gt;</comment>
                            <comment id="17542683" author="tallison@mitre.org" created="Thu, 26 May 2022 21:30:44 +0000"  >&lt;p&gt;&amp;gt;would be to have TikaInputStream.get not overwrite the filename if it&apos;s already set&lt;/p&gt;

&lt;p&gt;Y, I was thinking about that too. That would be far simpler, and probably more along the lines of what people would expect.&lt;/p&gt;</comment>
                            <comment id="17542684" author="tallison@mitre.org" created="Thu, 26 May 2022 21:32:20 +0000"  >&lt;p&gt;I think we should overwrite the file length if we&apos;re measuring it ourselves.  If the incoming metadata object has a file length, and we run Files.size() and come up with a different length, we should overwrite that.  But, for file name, y, don&apos;t overwrite if there&apos;s a name already there.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=nick&quot; class=&quot;user-hover&quot; rel=&quot;nick&quot;&gt;nick&lt;/a&gt;, what do you think?&lt;/p&gt;</comment>
                            <comment id="17542688" author="tallison@mitre.org" created="Thu, 26 May 2022 21:53:23 +0000"  >&lt;p&gt;Unit tests seem to be passing if we check for existence of RESOURCE_NAME_KEY before setting it.  I&apos;ll commit that shortly.  We can revert if anyone has objections.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tombrisland&quot; class=&quot;user-hover&quot; rel=&quot;tombrisland&quot;&gt;tombrisland&lt;/a&gt;, I really like your mock tests, would you be able to adjust your PR after I make this commit?&lt;/p&gt;</comment>
                            <comment id="17542693" author="tombrisland" created="Thu, 26 May 2022 22:05:41 +0000"  >&lt;p&gt;Thanks! Yeah definitely &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/thumbs_up.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="17542724" author="hudson" created="Fri, 27 May 2022 00:22:48 +0000"  >&lt;p&gt;SUCCESS: Integrated in Jenkins build Tika &#187; tika-main-jdk8 #611 (See &lt;a href=&quot;https://ci-builds.apache.org/job/Tika/job/tika-main-jdk8/611/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://ci-builds.apache.org/job/Tika/job/tika-main-jdk8/611/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-3776&quot; title=&quot;HttpFetcher overwrites filename passed in&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-3776&quot;&gt;&lt;del&gt;TIKA-3776&lt;/del&gt;&lt;/a&gt; &amp;#8211; don&apos;t overwrite file name if it exists in the metadata already.  The goal is not to overwrite the file name with a temp file name. (tallison: &lt;a href=&quot;https://github.com/apache/tika/commit/636adeaadaf3bea4c54847aeebbd0c9ebc9b7065&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/636adeaadaf3bea4c54847aeebbd0c9ebc9b7065&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) tika-core/src/main/java/org/apache/tika/io/TikaInputStream.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="17543010" author="tombrisland" created="Fri, 27 May 2022 16:50:34 +0000"  >&lt;p&gt;Nice one! I&apos;ve amended the commit in my PR to back out my metadata change and added an additional test.&lt;/p&gt;</comment>
                            <comment id="17543035" author="githubbot" created="Fri, 27 May 2022 17:36:05 +0000"  >&lt;p&gt;tballison merged PR #586:&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/tika/pull/586&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/pull/586&lt;/a&gt;&lt;/p&gt;

</comment>
                            <comment id="17543036" author="githubbot" created="Fri, 27 May 2022 17:36:13 +0000"  >&lt;p&gt;tballison commented on PR #586:&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/tika/pull/586#issuecomment-1139862582&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/pull/586#issuecomment-1139862582&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;   W00t!  Thank you @tombrisland!&lt;/p&gt;

</comment>
                            <comment id="17543045" author="tallison@mitre.org" created="Fri, 27 May 2022 17:57:49 +0000"  >&lt;p&gt;Thank you &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tombrisland&quot; class=&quot;user-hover&quot; rel=&quot;tombrisland&quot;&gt;tombrisland&lt;/a&gt;!&lt;/p&gt;</comment>
                            <comment id="17543053" author="tombrisland" created="Fri, 27 May 2022 18:30:43 +0000"  >&lt;p&gt;Likewise!&lt;/p&gt;</comment>
                            <comment id="17543083" author="hudson" created="Fri, 27 May 2022 19:01:22 +0000"  >&lt;p&gt;FAILURE: Integrated in Jenkins build Tika &#187; tika-main-jdk8 #614 (See &lt;a href=&quot;https://ci-builds.apache.org/job/Tika/job/tika-main-jdk8/614/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://ci-builds.apache.org/job/Tika/job/tika-main-jdk8/614/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-3776&quot; title=&quot;HttpFetcher overwrites filename passed in&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-3776&quot;&gt;&lt;del&gt;TIKA-3776&lt;/del&gt;&lt;/a&gt; Add mock tests for HttpFetcher (#586) (github: &lt;a href=&quot;https://github.com/apache/tika/commit/350b430967d4e4f5f930e1f8636834d6d978f851&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/350b430967d4e4f5f930e1f8636834d6d978f851&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) tika-pipes/tika-fetchers/tika-fetcher-http/pom.xml&lt;/li&gt;
	&lt;li&gt;(edit) tika-pipes/tika-fetchers/tika-fetcher-http/src/test/java/org/apache/tika/pipes/fetcher/http/HttpFetcherTest.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-pipes/tika-fetchers/tika-fetcher-http/src/main/java/org/apache/tika/pipes/fetcher/http/HttpFetcher.java&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-3776&quot; title=&quot;HttpFetcher overwrites filename passed in&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-3776&quot;&gt;&lt;del&gt;TIKA-3776&lt;/del&gt;&lt;/a&gt; &amp;#8211; checkstyle fixes (tallison: &lt;a href=&quot;https://github.com/apache/tika/commit/47fa2b92d3c8437866a86bbc0204e463be2f47bc&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/47fa2b92d3c8437866a86bbc0204e463be2f47bc&lt;/a&gt;)&lt;/li&gt;
	&lt;li&gt;(edit) tika-pipes/tika-fetchers/tika-fetcher-http/src/test/java/org/apache/tika/pipes/fetcher/http/HttpFetcherTest.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 24 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z12q8o:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>