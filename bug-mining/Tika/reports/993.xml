<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:01:41 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[TIKA-2582] Tesseract 4.0 includes a FF character by default, breaking parsers</title>
                <link>https://issues.apache.org/jira/browse/TIKA-2582</link>
                <project id="12310631" key="TIKA">Tika</project>
                    <description>&lt;p&gt;Tesseract 4.0 includes a change to use form feed characters to separate pages by default in its text output. Previous versions used no separator unless you specified the include_page_breaks option.&lt;/p&gt;

&lt;p&gt;This confuses any parser that is not expecting the FF. ODFParserTest.testOO2Metadata fails, because it is expecting the output of a blank image to be the empty string, but now the FF is there.&lt;/p&gt;

&lt;p&gt;I haven&apos;t seen any other failures, but I expect that user code will now see either FF or U+FFFD where they are not expecting it (SafeContentHandler replaces the FF with U+FFFD when converting to text to XML).&lt;/p&gt;

&lt;p&gt;We should set the appropriate Tesseract options to disable this behavior unless explicitly requested by user code, to avoid the change in behavior.&lt;/p&gt;

&lt;p&gt;For reference, the Tesseract change is as follows:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;commit 2cc531e6bf0288fc8a9ad1c123a252395f00bf56&lt;br/&gt;
 Merge: 3bb573ae aa6eb6bd&lt;br/&gt;
 Author: zdenop &amp;lt;zdenop@gmail.com&amp;gt;&lt;br/&gt;
 Date: Tue Sep 19 08:41:08 2017 +0200&lt;/p&gt;

&lt;p&gt;Merge pull request #1140 from stweil/pagebreak&lt;/p&gt;

&lt;p&gt;Remove Tesseract parameter &quot;include_page_breaks&quot; and use FF by default&lt;/p&gt;

&lt;p&gt;commit aa6eb6bd466101a3b89880f87580471a7694359d&lt;br/&gt;
 Author: Stefan Weil &amp;lt;sw@weilnetz.de&amp;gt;&lt;br/&gt;
 Date: Mon Jun 12 19:42:45 2017 +0200&lt;/p&gt;

&lt;p&gt;Remove Tesseract parameter &quot;include_page_breaks&quot; and use FF by default&lt;/p&gt;

&lt;p&gt;Now Tesseract adds a page break (normally form feed) by default.&lt;/p&gt;

&lt;p&gt;It is still possible to suppress page breaks by setting an empty&lt;br/&gt;
 page_separator.&lt;/p&gt;

&lt;p&gt;Signed-off-by: Stefan Weil &amp;lt;sw@weilnetz.de&amp;gt;&lt;/p&gt;

&lt;/blockquote&gt;</description>
                <environment></environment>
        <key id="13140021">TIKA-2582</key>
            <summary>Tesseract 4.0 includes a FF character by default, breaking parsers</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="ewanmellor-2">Ewan Mellor</reporter>
                        <labels>
                    </labels>
                <created>Wed, 21 Feb 2018 21:07:30 +0000</created>
                <updated>Fri, 30 Mar 2018 00:21:59 +0000</updated>
                            <resolved>Thu, 29 Mar 2018 19:16:57 +0000</resolved>
                                    <version>1.17</version>
                                    <fixVersion>1.18</fixVersion>
                    <fixVersion>2.0.0</fixVersion>
                                    <component>parser</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="16372029" author="githubbot" created="Wed, 21 Feb 2018 21:23:09 +0000"  >&lt;p&gt;ewanmellor opened a new pull request #222: Fix for &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2582&quot; title=&quot;Tesseract 4.0 includes a FF character by default, breaking parsers&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2582&quot;&gt;&lt;del&gt;TIKA-2582&lt;/del&gt;&lt;/a&gt; contributed by ewanmellor.&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/tika/pull/222&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/pull/222&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   Tesseract 4.0 includes a change to use form feed characters to separate&lt;br/&gt;
   pages by default in its text output. Previous versions used no separator&lt;br/&gt;
   unless you specified the include_page_breaks option.&lt;/p&gt;

&lt;p&gt;   This confuses any parser that is not expecting the FF.&lt;br/&gt;
   ODFParserTest.testOO2Metadata fails, because it is expecting the output of&lt;br/&gt;
   a blank image to be the empty string, but now the FF is there.&lt;/p&gt;

&lt;p&gt;   I haven&apos;t seen any other failures, but I expect that user code will now see&lt;br/&gt;
   either FF or U+FFFD where they are not expecting it (SafeContentHandler&lt;br/&gt;
   replaces the FF with U+FFFD when converting to text to XML).&lt;/p&gt;

&lt;p&gt;   Fix this by setting Tesseract&apos;s page_separator option to the empty string.&lt;br/&gt;
   This will preserve the no-page-breaks behavior with both Tesseract 3.x and&lt;br/&gt;
   4.0.&lt;/p&gt;

&lt;p&gt;   Also, add an option TesseractOCRConfig.pageSeparator so that user code can&lt;br/&gt;
   request the FF or any other separator, if they want it.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16419580" author="githubbot" created="Thu, 29 Mar 2018 18:58:17 +0000"  >&lt;p&gt;tballison closed pull request #222: Fix for &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2582&quot; title=&quot;Tesseract 4.0 includes a FF character by default, breaking parsers&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2582&quot;&gt;&lt;del&gt;TIKA-2582&lt;/del&gt;&lt;/a&gt; contributed by ewanmellor.&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/tika/pull/222&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/pull/222&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;This is a PR merged from a forked repository.&lt;br/&gt;
As GitHub hides the original diff on merge, it is displayed below for&lt;br/&gt;
the sake of provenance:&lt;/p&gt;

&lt;p&gt;As this is a foreign pull request (from a fork), the diff is supplied&lt;br/&gt;
below (as it won&apos;t show otherwise due to GitHub magic):&lt;/p&gt;

&lt;p&gt;diff --git a/tika-parsers/src/main/java/org/apache/tika/parser/ocr/TesseractOCRConfig.java b/tika-parsers/src/main/java/org/apache/tika/parser/ocr/TesseractOCRConfig.java&lt;br/&gt;
index c8c8bc93e..d8723dd34 100644&lt;br/&gt;
&amp;#8212; a/tika-parsers/src/main/java/org/apache/tika/parser/ocr/TesseractOCRConfig.java&lt;br/&gt;
+++ b/tika-parsers/src/main/java/org/apache/tika/parser/ocr/TesseractOCRConfig.java&lt;br/&gt;
@@ -91,6 +91,9 @@&lt;br/&gt;
     // factor by which image is to be scaled.&lt;br/&gt;
     private int resize = 900;&lt;/p&gt;

&lt;p&gt;+    // See setPageSeparator.&lt;br/&gt;
+    private String pageSeparator = &quot;&quot;;&lt;br/&gt;
+&lt;br/&gt;
     // whether or not to preserve interword spacing&lt;br/&gt;
     private boolean preserveInterwordSpacing = false;&lt;/p&gt;

&lt;p&gt;@@ -255,6 +258,25 @@ public void setPageSegMode(String pageSegMode) &lt;/p&gt;
{
         this.pageSegMode = pageSegMode;
     }

&lt;p&gt;+    /**&lt;br/&gt;
+     * @see #setPageSeparator(String pageSeparator)&lt;br/&gt;
+     */&lt;br/&gt;
+    public String getPageSeparator() &lt;/p&gt;
{
+        return pageSeparator;
+    }
&lt;p&gt;+&lt;br/&gt;
+    /**&lt;br/&gt;
+     * The page separator to use in plain text output.  This corresponds to Tesseract&apos;s page_separator config option.&lt;br/&gt;
+     * The default here is the empty string (i.e. no page separators).  Note that this is also the default in&lt;br/&gt;
+     * Tesseract 3.x, but in Tesseract 4.0 the default is to use the form feed control character.  We are overriding&lt;br/&gt;
+     * Tesseract 4.0&apos;s default here.&lt;br/&gt;
+     *&lt;br/&gt;
+     * @param pageSeparator&lt;br/&gt;
+     */&lt;br/&gt;
+    public void setPageSeparator(String pageSeparator) &lt;/p&gt;
{
+        this.pageSeparator = pageSeparator;
+    }
&lt;p&gt;+&lt;br/&gt;
     /**&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Whether or not to maintain interword spacing.  Default is &amp;lt;code&amp;gt;false&amp;lt;/code&amp;gt;.&lt;br/&gt;
      *&lt;br/&gt;
diff --git a/tika-parsers/src/main/java/org/apache/tika/parser/ocr/TesseractOCRParser.java b/tika-parsers/src/main/java/org/apache/tika/parser/ocr/TesseractOCRParser.java&lt;br/&gt;
index 08847fd74..3e15c4495 100644
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;a/tika-parsers/src/main/java/org/apache/tika/parser/ocr/TesseractOCRParser.java&lt;br/&gt;
+++ b/tika-parsers/src/main/java/org/apache/tika/parser/ocr/TesseractOCRParser.java&lt;br/&gt;
@@ -468,6 +468,7 @@ private void doOCR(File input, File output, TesseractOCRConfig config) throws IO&lt;br/&gt;
         String[] cmd = 
{ config.getTesseractPath() + getTesseractProg(), input.getPath(), output.getPath(), &quot;-l&quot;,
                 config.getLanguage(), &quot;-psm&quot;, config.getPageSegMode(),
                 config.getOutputType().name().toLowerCase(Locale.US),
+                &quot;-c&quot;, &quot;page_separator=&quot; + config.getPageSeparator(),
                 &quot;-c&quot;,
                 (config.getPreserveInterwordSpacing())? &quot;preserve_interword_spaces=1&quot; : &quot;preserve_interword_spaces=0&quot;}
&lt;p&gt;;&lt;br/&gt;
         ProcessBuilder pb = new ProcessBuilder(cmd);&lt;/p&gt;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;





&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16419616" author="tallison@mitre.org" created="Thu, 29 Mar 2018 19:16:57 +0000"  >&lt;p&gt;Thank you &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ewanmellor-2&quot; class=&quot;user-hover&quot; rel=&quot;ewanmellor-2&quot;&gt;ewanmellor-2&lt;/a&gt;!&lt;/p&gt;</comment>
                            <comment id="16419668" author="hudson" created="Thu, 29 Mar 2018 20:05:48 +0000"  >&lt;p&gt;UNSTABLE: Integrated in Jenkins build tika-2.x-windows #226 (See &lt;a href=&quot;https://builds.apache.org/job/tika-2.x-windows/226/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/tika-2.x-windows/226/&lt;/a&gt;)&lt;br/&gt;
Fix for &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2582&quot; title=&quot;Tesseract 4.0 includes a FF character by default, breaking parsers&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2582&quot;&gt;&lt;del&gt;TIKA-2582&lt;/del&gt;&lt;/a&gt; contributed by ewanmellor. (commits: rev 65defb20301d40397e94076a4b2011688cb94637)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/ocr/TesseractOCRConfig.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/ocr/TesseractOCRParser.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="16419683" author="hudson" created="Thu, 29 Mar 2018 20:18:28 +0000"  >&lt;p&gt;FAILURE: Integrated in Jenkins build tika-branch-1x #14 (See &lt;a href=&quot;https://builds.apache.org/job/tika-branch-1x/14/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/tika-branch-1x/14/&lt;/a&gt;)&lt;br/&gt;
Fix for &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2582&quot; title=&quot;Tesseract 4.0 includes a FF character by default, breaking parsers&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2582&quot;&gt;&lt;del&gt;TIKA-2582&lt;/del&gt;&lt;/a&gt; contributed by ewanmellor. (tallison: &lt;a href=&quot;https://github.com/apache/tika/commit/d1526d053f91497ac7bcd4509f1555f4347377d6&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/d1526d053f91497ac7bcd4509f1555f4347377d6&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/ocr/TesseractOCRConfig.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/ocr/TesseractOCRParser.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="16419781" author="hudson" created="Thu, 29 Mar 2018 21:24:11 +0000"  >&lt;p&gt;SUCCESS: Integrated in Jenkins build Tika-trunk #1463 (See &lt;a href=&quot;https://builds.apache.org/job/Tika-trunk/1463/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Tika-trunk/1463/&lt;/a&gt;)&lt;br/&gt;
Fix for &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2582&quot; title=&quot;Tesseract 4.0 includes a FF character by default, breaking parsers&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2582&quot;&gt;&lt;del&gt;TIKA-2582&lt;/del&gt;&lt;/a&gt; contributed by ewanmellor. (commits: &lt;a href=&quot;https://github.com/apache/tika/commit/65defb20301d40397e94076a4b2011688cb94637&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/65defb20301d40397e94076a4b2011688cb94637&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/ocr/TesseractOCRParser.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/ocr/TesseractOCRConfig.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="16419798" author="ewanmellor-2" created="Thu, 29 Mar 2018 21:30:29 +0000"  >&lt;p&gt;Build failures were not this change; they were from&#160;&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2621&quot; title=&quot;Brotli support&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2621&quot;&gt;TIKA-2621&lt;/a&gt; which went through at the same time.&lt;/p&gt;</comment>
                            <comment id="16419998" author="tallison@mitre.org" created="Fri, 30 Mar 2018 00:21:41 +0000"  >&lt;p&gt;Y, all my fault.  Fixed already. Sorry, and thank you!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 33 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3qfvz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>