<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:01:54 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[TIKA-2479] Handle empty cells in tables uniformly</title>
                <link>https://issues.apache.org/jira/browse/TIKA-2479</link>
                <project id="12310631" key="TIKA">Tika</project>
                    <description>&lt;p&gt;It looks like we output a &amp;lt;td/&amp;gt; for empty cells in xls, and tables in doc, docx and pptx.  However, we don&apos;t retain empty cells in xlsx or tables in ppt.  We should make this handling uniform.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13110442">TIKA-2479</key>
            <summary>Handle empty cells in tables uniformly</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="tallison">Tim Allison</reporter>
                        <labels>
                    </labels>
                <created>Wed, 18 Oct 2017 18:43:12 +0000</created>
                <updated>Mon, 12 Apr 2021 12:59:24 +0000</updated>
                            <resolved>Fri, 18 May 2018 14:54:52 +0000</resolved>
                                                    <fixVersion>1.19</fixVersion>
                    <fixVersion>2.0.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="16306504" author="geoff_baskwill" created="Fri, 29 Dec 2017 20:13:21 +0000"  >&lt;p&gt;I&apos;ve done a little poking at this; looks like the xslx parser doesn&apos;t emit events for empty cells (by design), but they do have some sample code for how to handle the situation. I&apos;ve attached a proposed patch based on the POI sample code that adapts &lt;tt&gt;XSSFExcelExtractorDecorator&lt;/tt&gt; to handle sparse &lt;tt&gt;cell&lt;/tt&gt; events.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://bz.apache.org/bugzilla/show_bug.cgi?id=57775&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://bz.apache.org/bugzilla/show_bug.cgi?id=57775&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;https://bz.apache.org/bugzilla/show_bug.cgi?id=61937&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://bz.apache.org/bugzilla/show_bug.cgi?id=61937&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16306512" author="githubbot" created="Fri, 29 Dec 2017 20:22:02 +0000"  >&lt;p&gt;glb opened a new pull request #214: &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2479&quot; title=&quot;Handle empty cells in tables uniformly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2479&quot;&gt;&lt;del&gt;TIKA-2479&lt;/del&gt;&lt;/a&gt; - Handle empty cells in XLSX&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/tika/pull/214&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/pull/214&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   The POI parser doesn&apos;t emit `cell` events for empty cells (by design),&lt;br/&gt;
   but they do provide some sample code for how to handle sparse events.&lt;br/&gt;
   This commit updates `XSSFExcelExtractorDecorator` to emit empty `tr`&lt;br/&gt;
   and `td` elements for the missing cells.&lt;/p&gt;

&lt;p&gt;   See also: &lt;a href=&quot;https://bz.apache.org/bugzilla/show_bug.cgi?id=57775&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://bz.apache.org/bugzilla/show_bug.cgi?id=57775&lt;/a&gt;&lt;br/&gt;
   See also: &lt;a href=&quot;https://bz.apache.org/bugzilla/show_bug.cgi?id=61937&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://bz.apache.org/bugzilla/show_bug.cgi?id=61937&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16470703" author="gagravarr" created="Thu, 10 May 2018 16:45:12 +0000"  >&lt;p&gt;Having hit a similar thing with &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2641&quot; title=&quot;Unit test for consistency between tabular/columnar formats&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2641&quot;&gt;TIKA-2641&lt;/a&gt;, I&apos;m tempted to make the XLS and XLSX parser output missing left/mid cells up to a limit, but ignore missing rows, and ignore missing right-cells. That would prevent very sparse spreadsheets from suddenly generating loads more text output than they currently do, whilst giving us the correct table layout for files with just the odd missing cell.&lt;/p&gt;

&lt;p&gt;I don&apos;t want to suddenly make the output from sparse files huge, and I&apos;d rather not add too many config options for people to need to play around with, but equally we want to try to avoid surprises for users.&lt;/p&gt;

&lt;p&gt;Anyone have any thoughts / suggestions / objections to that plan, before I apply a slightly modified form of the attached pull request + matching changes for XLS?&lt;/p&gt;</comment>
                            <comment id="16471358" author="geoff_baskwill" created="Fri, 11 May 2018 01:19:17 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=nick&quot; class=&quot;user-hover&quot; rel=&quot;nick&quot;&gt;nick&lt;/a&gt; ...&#160;what I found with rendering HTML tables when they didn&apos;t have the right number of cells was they looked really bad (and are semantically incorrect) without the missing rows and right-cells. I suppose a post-processing step could go through and fill in the missing columns for people who knew about this behaviour, but we can&apos;t fix the missing rows in post-processing as the knowledge that the rows are missing is lost.&lt;/p&gt;

&lt;p&gt;I would agree that it would be preferable not to add config options, but perhaps there&apos;s no other way to balance between &quot;I&apos;d like to get an HTML table that accurately represents the sheet content so I can properly extract meaning from it&quot; and &quot;I&apos;d like to have something close to the&#160;old behaviour and amount of output when my sheet has&#160;sparse data&quot;?&lt;/p&gt;

&lt;p&gt;The motivation for trying to get an accurate representation comes from an accessibility project I was working on with sheets that had merged cells (another problem that I didn&apos;t manage to fully solve in the time I had available) &#8211; without the correct number of cells the merging gets really wrong really quickly.&lt;/p&gt;

&lt;p&gt;Thoughts?&lt;/p&gt;</comment>
                            <comment id="16471940" author="gagravarr" created="Fri, 11 May 2018 13:46:12 +0000"  >&lt;p&gt;As long as we add in missing left / mid cells, your table should look fine-ish, and certainly semantically meaningful, as you&apos;d just have some rows not extend as far to the right as others. We don&apos;t want to have to do two passes to find the widest row to pad for, plus with just one &quot;accidentally broken&quot; row where someone put something in column ZZ your Tika output would suddenly explode! Specifying different minimum row cell counts on a per-sheet basis (the only way to avoid the double-pass) seems fiddly / brittle to me.&lt;/p&gt;

&lt;p&gt;You&apos;d then end up with something like:&lt;/p&gt;
&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;A&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;B&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;C&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;12&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;22&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;42&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&#160;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;24&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;42&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&#160;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&#160;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;42&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;1&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;2&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;3&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;42&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;1&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;2&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;3&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;


&lt;p&gt;I see the point about missing rows though, I think we&apos;d need an option to turn that on for when someone cares about them.&lt;/p&gt;

&lt;p&gt;What if we hard-coded the XLS and XLSX parsers to always output missing left/mid cells, and put an option on &lt;tt&gt;OfficeParserConfig&lt;/tt&gt; to let you request missing rows?&lt;/p&gt;

&lt;p&gt;(Merged cell handling would probably be best split out as a new issue!)&lt;/p&gt;</comment>
                            <comment id="16477426" author="tallison@mitre.org" created="Wed, 16 May 2018 13:36:23 +0000"  >&lt;p&gt;+1 to &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=nick&quot; class=&quot;user-hover&quot; rel=&quot;nick&quot;&gt;nick&lt;/a&gt;&apos;s proposal.  xls, xlsx and xlsb &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="16480765" author="gagravarr" created="Fri, 18 May 2018 14:54:52 +0000"  >&lt;p&gt;XLS, XLSX and XLSB should now all do basically the same thing. Missing left or mid cells are now output as an empty &lt;tt&gt;td&lt;/tt&gt;, which preserves the table column layout. Missing rows are by default skipped, to minimise empty lines in the output, but can be enabled on &lt;tt&gt;OfficeParserConfig&lt;/tt&gt; if desired&lt;/p&gt;

&lt;p&gt;The only thing you&apos;d need some custom code for is if you want to enforce a minimum number of columns in a row, as there&apos;s no right-padding of missing / never used cells.&lt;/p&gt;</comment>
                            <comment id="16480814" author="hudson" created="Fri, 18 May 2018 15:39:26 +0000"  >&lt;p&gt;UNSTABLE: Integrated in Jenkins build tika-2.x-windows #253 (See &lt;a href=&quot;https://builds.apache.org/job/tika-2.x-windows/253/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/tika-2.x-windows/253/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2479&quot; title=&quot;Handle empty cells in tables uniformly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2479&quot;&gt;&lt;del&gt;TIKA-2479&lt;/del&gt;&lt;/a&gt; Option to request missing rows where possible in Excel-like (nick: rev a1e42a0659ba33e90cb1bba0a0a10eeb97d4fac7)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/microsoft/OfficeParserConfig.java&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2479&quot; title=&quot;Handle empty cells in tables uniformly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2479&quot;&gt;&lt;del&gt;TIKA-2479&lt;/del&gt;&lt;/a&gt; Output missing left/mid cells in XLSX and XLSB, and optionally (nick: rev b1b035e6bbcff0db24e133b682ac79916f92f599)&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/microsoft/ooxml/XSSFBExcelExtractorDecorator.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/microsoft/ooxml/XSSFExcelExtractorDecorator.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/test/java/org/apache/tika/parser/TabularFormatsTest.java&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2479&quot; title=&quot;Handle empty cells in tables uniformly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2479&quot;&gt;&lt;del&gt;TIKA-2479&lt;/del&gt;&lt;/a&gt; Update XLS missing cell/row handling to match XLSX and XLSB, (nick: rev 348b87e7f41b79ff115e17d9c91d2dad63a57c15)&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/test/java/org/apache/tika/parser/microsoft/ExcelParserTest.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/microsoft/ExcelExtractor.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/test/java/org/apache/tika/parser/TabularFormatsTest.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="16480852" author="hudson" created="Fri, 18 May 2018 16:11:37 +0000"  >&lt;p&gt;SUCCESS: Integrated in Jenkins build Tika-trunk #1488 (See &lt;a href=&quot;https://builds.apache.org/job/Tika-trunk/1488/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Tika-trunk/1488/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2479&quot; title=&quot;Handle empty cells in tables uniformly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2479&quot;&gt;&lt;del&gt;TIKA-2479&lt;/del&gt;&lt;/a&gt; Option to request missing rows where possible in Excel-like (nick: &lt;a href=&quot;https://github.com/apache/tika/commit/a1e42a0659ba33e90cb1bba0a0a10eeb97d4fac7&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/a1e42a0659ba33e90cb1bba0a0a10eeb97d4fac7&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/microsoft/OfficeParserConfig.java&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2479&quot; title=&quot;Handle empty cells in tables uniformly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2479&quot;&gt;&lt;del&gt;TIKA-2479&lt;/del&gt;&lt;/a&gt; Output missing left/mid cells in XLSX and XLSB, and optionally (nick: &lt;a href=&quot;https://github.com/apache/tika/commit/b1b035e6bbcff0db24e133b682ac79916f92f599&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/b1b035e6bbcff0db24e133b682ac79916f92f599&lt;/a&gt;)&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/test/java/org/apache/tika/parser/TabularFormatsTest.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/microsoft/ooxml/XSSFExcelExtractorDecorator.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/microsoft/ooxml/XSSFBExcelExtractorDecorator.java&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2479&quot; title=&quot;Handle empty cells in tables uniformly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2479&quot;&gt;&lt;del&gt;TIKA-2479&lt;/del&gt;&lt;/a&gt; Update XLS missing cell/row handling to match XLSX and XLSB, (nick: &lt;a href=&quot;https://github.com/apache/tika/commit/348b87e7f41b79ff115e17d9c91d2dad63a57c15&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/348b87e7f41b79ff115e17d9c91d2dad63a57c15&lt;/a&gt;)&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/microsoft/ExcelExtractor.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/test/java/org/apache/tika/parser/microsoft/ExcelParserTest.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/test/java/org/apache/tika/parser/TabularFormatsTest.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="16559821" author="tallison@mitre.org" created="Fri, 27 Jul 2018 14:18:45 +0000"  >&lt;p&gt;I cherry-picked these into branch_1x so they&apos;ll be included in 1.19.&lt;/p&gt;</comment>
                            <comment id="16559875" author="hudson" created="Fri, 27 Jul 2018 15:07:25 +0000"  >&lt;p&gt;SUCCESS: Integrated in Jenkins build tika-branch-1x #63 (See &lt;a href=&quot;https://builds.apache.org/job/tika-branch-1x/63/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/tika-branch-1x/63/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2479&quot; title=&quot;Handle empty cells in tables uniformly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2479&quot;&gt;&lt;del&gt;TIKA-2479&lt;/del&gt;&lt;/a&gt; Option to request missing rows where possible in Excel-like (tallison: &lt;a href=&quot;https://github.com/apache/tika/commit/68801273967bba2ed5fee90adbd06c9c19f27abc&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/68801273967bba2ed5fee90adbd06c9c19f27abc&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/microsoft/OfficeParserConfig.java&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2479&quot; title=&quot;Handle empty cells in tables uniformly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2479&quot;&gt;&lt;del&gt;TIKA-2479&lt;/del&gt;&lt;/a&gt; Output missing left/mid cells in XLSX and XLSB, and optionally (tallison: &lt;a href=&quot;https://github.com/apache/tika/commit/dcfbe5a2d578696dfba309dec400e977f047cfb2&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/dcfbe5a2d578696dfba309dec400e977f047cfb2&lt;/a&gt;)&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/microsoft/ooxml/XSSFBExcelExtractorDecorator.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/test/java/org/apache/tika/parser/TabularFormatsTest.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/microsoft/ooxml/XSSFExcelExtractorDecorator.java&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2479&quot; title=&quot;Handle empty cells in tables uniformly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2479&quot;&gt;&lt;del&gt;TIKA-2479&lt;/del&gt;&lt;/a&gt; Update XLS missing cell/row handling to match XLSX and XLSB, (tallison: &lt;a href=&quot;https://github.com/apache/tika/commit/8ea6b22f58feb73e3399fc82811cbd738a6f3cd1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/8ea6b22f58feb73e3399fc82811cbd738a6f3cd1&lt;/a&gt;)&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/test/java/org/apache/tika/parser/TabularFormatsTest.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/test/java/org/apache/tika/parser/microsoft/ExcelParserTest.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/microsoft/ExcelExtractor.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="16667835" author="githubbot" created="Mon, 29 Oct 2018 22:21:17 +0000"  >&lt;p&gt;dameikle commented on issue #214: &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2479&quot; title=&quot;Handle empty cells in tables uniformly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2479&quot;&gt;&lt;del&gt;TIKA-2479&lt;/del&gt;&lt;/a&gt; - Handle empty cells in XLSX&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/tika/pull/214#issuecomment-434102665&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/pull/214#issuecomment-434102665&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   It looks like Nick Burch hasn&apos;t seen this and has added a different fix for this in master.  Does this do what you were expecting?&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16667928" author="githubbot" created="Tue, 30 Oct 2018 00:24:31 +0000"  >&lt;p&gt;glb commented on issue #214: &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2479&quot; title=&quot;Handle empty cells in tables uniformly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2479&quot;&gt;&lt;del&gt;TIKA-2479&lt;/del&gt;&lt;/a&gt; - Handle empty cells in XLSX&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/tika/pull/214#issuecomment-434128458&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/pull/214#issuecomment-434128458&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   @dameikle it looks like it would solve the problem in a similar way, yes. Thanks!&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16667929" author="githubbot" created="Tue, 30 Oct 2018 00:24:32 +0000"  >&lt;p&gt;glb closed pull request #214: &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2479&quot; title=&quot;Handle empty cells in tables uniformly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2479&quot;&gt;&lt;del&gt;TIKA-2479&lt;/del&gt;&lt;/a&gt; - Handle empty cells in XLSX&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/tika/pull/214&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/pull/214&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;This is a PR merged from a forked repository.&lt;br/&gt;
As GitHub hides the original diff on merge, it is displayed below for&lt;br/&gt;
the sake of provenance:&lt;/p&gt;

&lt;p&gt;As this is a foreign pull request (from a fork), the diff is supplied&lt;br/&gt;
below (as it won&apos;t show otherwise due to GitHub magic):&lt;/p&gt;

&lt;p&gt;diff --git a/tika-parsers/src/main/java/org/apache/tika/parser/microsoft/ooxml/XSSFExcelExtractorDecorator.java b/tika-parsers/src/main/java/org/apache/tika/parser/microsoft/ooxml/XSSFExcelExtractorDecorator.java&lt;br/&gt;
index c3b7285403..2264457f37 100644&lt;br/&gt;
&amp;#8212; a/tika-parsers/src/main/java/org/apache/tika/parser/microsoft/ooxml/XSSFExcelExtractorDecorator.java&lt;br/&gt;
+++ b/tika-parsers/src/main/java/org/apache/tika/parser/microsoft/ooxml/XSSFExcelExtractorDecorator.java&lt;br/&gt;
@@ -16,7 +16,6 @@&lt;br/&gt;
  */&lt;br/&gt;
 package org.apache.tika.parser.microsoft.ooxml;&lt;/p&gt;

&lt;p&gt;-import javax.xml.parsers.SAXParser;&lt;br/&gt;
 import java.io.IOException;&lt;br/&gt;
 import java.io.InputStream;&lt;br/&gt;
 import java.util.ArrayList;&lt;br/&gt;
@@ -25,7 +24,8 @@&lt;br/&gt;
 import java.util.Locale;&lt;br/&gt;
 import java.util.Map;&lt;/p&gt;

&lt;p&gt;-import org.apache.poi.POIXMLDocument;&lt;br/&gt;
+import javax.xml.parsers.SAXParser;&lt;br/&gt;
+&lt;br/&gt;
 import org.apache.poi.POIXMLTextExtractor;&lt;br/&gt;
 import org.apache.poi.hssf.extractor.ExcelExtractor;&lt;br/&gt;
 import org.apache.poi.openxml4j.exceptions.InvalidFormatException;&lt;br/&gt;
@@ -39,6 +39,8 @@&lt;br/&gt;
 import org.apache.poi.openxml4j.opc.TargetMode;&lt;br/&gt;
 import org.apache.poi.ss.usermodel.DataFormatter;&lt;br/&gt;
 import org.apache.poi.ss.usermodel.HeaderFooter;&lt;br/&gt;
+import org.apache.poi.ss.util.CellAddress;&lt;br/&gt;
+import org.apache.poi.ss.util.CellReference;&lt;br/&gt;
 import org.apache.poi.xssf.eventusermodel.ReadOnlySharedStringsTable;&lt;br/&gt;
 import org.apache.poi.xssf.eventusermodel.XSSFReader;&lt;br/&gt;
 import org.apache.poi.xssf.eventusermodel.XSSFSheetXMLHandler;&lt;br/&gt;
@@ -400,6 +402,8 @@ public void processSheet(&lt;br/&gt;
         private final boolean includeHeadersFooters;&lt;br/&gt;
         protected List&amp;lt;String&amp;gt; headers;&lt;br/&gt;
         protected List&amp;lt;String&amp;gt; footers;&lt;br/&gt;
+        private int currentRow = -1;&lt;br/&gt;
+        private int currentCol = -1;&lt;/p&gt;

&lt;p&gt;         protected SheetTextAsHTML(boolean includeHeaderFooters, XHTMLContentHandler xhtml) &lt;/p&gt;
{
             this.includeHeadersFooters = includeHeaderFooters;
@@ -408,7 +412,24 @@ protected SheetTextAsHTML(boolean includeHeaderFooters, XHTMLContentHandler xhtm
             footers = new ArrayList&amp;lt;String&amp;gt;();
         }

&lt;p&gt;+        private void outputMissingRows(int number) {&lt;br/&gt;
+            for (int i=0; i&amp;lt;number; i++) {&lt;br/&gt;
+                try &lt;/p&gt;
{
+                    xhtml.startElement(&quot;tr&quot;);
+                    xhtml.endElement(&quot;tr&quot;);
+                }
&lt;p&gt; catch (SAXException e) &lt;/p&gt;
{
+                }
&lt;p&gt;+            }&lt;br/&gt;
+        }&lt;br/&gt;
+&lt;br/&gt;
         public void startRow(int rowNum) {&lt;br/&gt;
+            // If there were gaps, output the missing rows&lt;br/&gt;
+            outputMissingRows(rowNum-currentRow-1);&lt;br/&gt;
+&lt;br/&gt;
+            // Prepare for this row&lt;br/&gt;
+            currentRow = rowNum;&lt;br/&gt;
+            currentCol = -1;&lt;br/&gt;
+&lt;br/&gt;
             try &lt;/p&gt;
{
                 xhtml.startElement(&quot;tr&quot;);
             }
&lt;p&gt; catch (SAXException e) {&lt;br/&gt;
@@ -423,7 +444,22 @@ public void endRow(int rowNum) {&lt;br/&gt;
         }&lt;/p&gt;

&lt;p&gt;         public void cell(String cellRef, String formattedValue, XSSFComment comment) {&lt;br/&gt;
+            // gracefully handle missing CellRef here in a similar way as XSSFCell does&lt;br/&gt;
+            if (cellRef == null) &lt;/p&gt;
{
+                cellRef = new CellAddress(currentRow, currentCol).formatAsString();
+            }
&lt;p&gt;+&lt;br/&gt;
             try {&lt;br/&gt;
+                // Did we miss any cells?&lt;br/&gt;
+                int thisCol = (new CellReference(cellRef)).getCol();&lt;br/&gt;
+                int missedCols = thisCol - currentCol - 1;&lt;br/&gt;
+&lt;br/&gt;
+                for (int i=0; i&amp;lt;missedCols; i++) &lt;/p&gt;
{
+                        xhtml.startElement(&quot;td&quot;);
+                        xhtml.endElement(&quot;td&quot;);
+                }
&lt;p&gt;+                currentCol = thisCol;&lt;br/&gt;
+&lt;br/&gt;
                 xhtml.startElement(&quot;td&quot;);&lt;/p&gt;

&lt;p&gt;                 // Main cell contents&lt;/p&gt;




&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12615321">TIKA-1020</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12904042" name="patch.diff" size="3694" author="geoff_baskwill" created="Fri, 29 Dec 2017 20:13:47 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 2 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3lfbz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>