<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:03:15 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[TIKA-3246] IllegalArgumentException when generation of appearances fails</title>
                <link>https://issues.apache.org/jira/browse/TIKA-3246</link>
                <project id="12310631" key="TIKA">Tika</project>
                    <description>&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;java.lang.IllegalArgumentException: No glyph for U+0041 (A) in font BZZZZZ+Aladin-Regular
	at org.apache.pdfbox.pdmodel.font.PDCIDFontType2.encode(PDCIDFontType2.java:372)
	at org.apache.pdfbox.pdmodel.font.PDType0Font.encode(PDType0Font.java:422)
	at org.apache.pdfbox.pdmodel.font.PDFont.encode(PDFont.java:332)
	at org.apache.pdfbox.pdmodel.font.PDFont.getStringWidth(PDFont.java:363)
	at org.apache.pdfbox.pdmodel.interactive.form.AppearanceGeneratorHelper.calculateFontSize(AppearanceGeneratorHelper.java:859)
	at org.apache.pdfbox.pdmodel.interactive.form.AppearanceGeneratorHelper.insertGeneratedAppearance(AppearanceGeneratorHelper.java:494)
	at org.apache.pdfbox.pdmodel.interactive.form.AppearanceGeneratorHelper.setAppearanceContent(AppearanceGeneratorHelper.java:422)
	at org.apache.pdfbox.pdmodel.interactive.form.AppearanceGeneratorHelper.setAppearanceValue(AppearanceGeneratorHelper.java:232)
	at org.apache.pdfbox.pdmodel.interactive.form.PDTextField.constructAppearances(PDTextField.java:264)
	at org.apache.pdfbox.pdmodel.interactive.form.PDAcroForm.refreshAppearances(PDAcroForm.java:327)
	at org.apache.pdfbox.pdmodel.fixup.processor.AcroFormGenerateAppearancesProcessor.process(AcroFormGenerateAppearancesProcessor.java:54)
	at org.apache.pdfbox.pdmodel.fixup.AcroFormDefaultFixup.apply(AcroFormDefaultFixup.java:56)
	at org.apache.pdfbox.pdmodel.PDDocumentCatalog.getAcroForm(PDDocumentCatalog.java:132)
	at org.apache.pdfbox.pdmodel.PDDocumentCatalog.getAcroForm(PDDocumentCatalog.java:113)
	at org.apache.tika.parser.pdf.PDFParser.extractMetadata(PDFParser.java:267)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;This is related to a change in PDFBox in &lt;tt&gt;PDDocumentCatalog.getAcroForm()&lt;/tt&gt;, we try to &quot;fix&quot; fields when they exist as annotations but not as fields. I wonder if this is needed at all.&lt;/p&gt;

&lt;p&gt;It happens with several files, among them the two AML files of &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4086&quot; title=&quot;Cannot merge two PDF forms&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4086&quot;&gt;PDFBOX-4086&lt;/a&gt;.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13345531">TIKA-3246</key>
            <summary>IllegalArgumentException when generation of appearances fails</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tilman">Tilman Hausherr</assignee>
                                    <reporter username="tilman">Tilman Hausherr</reporter>
                        <labels>
                    </labels>
                <created>Fri, 11 Dec 2020 14:13:04 +0000</created>
                <updated>Sun, 20 Dec 2020 06:03:19 +0000</updated>
                            <resolved>Sun, 20 Dec 2020 05:00:57 +0000</resolved>
                                    <version>1.25</version>
                                    <fixVersion>2.0.0</fixVersion>
                    <fixVersion>1.26</fixVersion>
                                    <component>parser</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="17251034" author="tilman" created="Thu, 17 Dec 2020 12:04:29 +0000"  >&lt;p&gt;calling &lt;tt&gt;getAcroform()&lt;/tt&gt; with &lt;tt&gt;new TikaAcroFormFixup(document)&lt;/tt&gt; helps, subsequent calls to &lt;tt&gt;getAcroform()&lt;/tt&gt; must be with null.&lt;br/&gt;
I&apos;ll run regression tests to see whether the problems (which the 3 ghostscript files from &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-3253&quot; title=&quot;improve &amp;quot;attachments&amp;quot; tika-eval report directory&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-3253&quot;&gt;&lt;del&gt;TIKA-3253&lt;/del&gt;&lt;/a&gt;) are gone&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    /**
     * Copied from AcroformDefaultFixup minus generation of appearances, which we don&apos;t need.
     */
    &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;TikaAcroFormFixup &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; AbstractFixup
    {
        TikaAcroFormFixup(PDDocument document) {
            &lt;span class=&quot;code-keyword&quot;&gt;super&lt;/span&gt;(document);
        }

        @Override
        &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void apply() {
            &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; AcroFormDefaultsProcessor(document).process();

            /*
             * Get the AcroForm in it&apos;s current state.
             *
             * Also note: getAcroForm() applies a &lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt; fixup which &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; processor
             * is part of. So keep the &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; parameter otherwise &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; will end
             * in an endless recursive call
             */
            PDAcroForm acroForm = document.getDocumentCatalog().getAcroForm(&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;);

            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (acroForm != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; &amp;amp;&amp;amp; acroForm.getFields().isEmpty()) {
                &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; AcroFormOrphanWidgetsProcessor(document).process();
            }
        }
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17251240" author="tilman" created="Thu, 17 Dec 2020 17:25:30 +0000"  >&lt;p&gt;The missing files mentioned in &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-3253&quot; title=&quot;improve &amp;quot;attachments&amp;quot; tika-eval report directory&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-3253&quot;&gt;&lt;del&gt;TIKA-3253&lt;/del&gt;&lt;/a&gt; are gone, however now there&apos;s 9 new NPEs. More research to be done.&lt;/p&gt;</comment>
                            <comment id="17251244" author="tilman" created="Thu, 17 Dec 2020 17:32:21 +0000"  >&lt;p&gt;The cause of the NPE is a PDFBox bug (&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-5050&quot; title=&quot;NullPointerexception in AcroFormOrphanWidgetsProcessor.resolveNonRootField()&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-5050&quot;&gt;&lt;del&gt;PDFBOX-5050&lt;/del&gt;&lt;/a&gt;), but I realize we don&apos;t need that part anyway.&lt;/p&gt;

&lt;p&gt;next attempt with&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    /**
     * Copied from AcroformDefaultFixup minus generation of appearances and handling of orphan
     * widgets, which we don&apos;t need.
     */
    &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;TikaAcroFormFixup &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; AbstractFixup
    {
        TikaAcroFormFixup(PDDocument document) {
            &lt;span class=&quot;code-keyword&quot;&gt;super&lt;/span&gt;(document);
        }

        @Override
        &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void apply() {
            &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; AcroFormDefaultsProcessor(document).process();
        }
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17251720" author="tilman" created="Fri, 18 Dec 2020 11:48:50 +0000"  >&lt;p&gt;That worked, there&apos;s one left, bug_trackers/PDFBOX/&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4319&quot; title=&quot;Parsing 100000 page pdf is slow&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4319&quot;&gt;&lt;del&gt;PDFBOX-4319&lt;/del&gt;&lt;/a&gt;-0.zip-0.pdf . That is a PDF with 100000 pages that was created to demonstrate slowness. There is no problem when using tika-app from the command line.&lt;/p&gt;</comment>
                            <comment id="17251724" author="tallison@mitre.org" created="Fri, 18 Dec 2020 12:00:08 +0000"  >&lt;p&gt;Is &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4319&quot; title=&quot;Parsing 100000 page pdf is slow&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4319&quot;&gt;&lt;del&gt;PDFBOX-4319&lt;/del&gt;&lt;/a&gt; something we can fix on the Tika side...how does it affect us if not in tika-app commandline?&lt;/p&gt;</comment>
                            <comment id="17251734" author="tilman" created="Fri, 18 Dec 2020 12:21:27 +0000"  >&lt;p&gt;I don&apos;t know... that file is slow for &lt;tt&gt;PDDocument.getPage()&lt;/tt&gt; access. But tika uses &lt;tt&gt;PDDocument.getPages()&lt;/tt&gt; which is fast. I have no idea why that file failed in the &quot;B&quot; run.&lt;/p&gt;</comment>
                            <comment id="17251831" author="tilman" created="Fri, 18 Dec 2020 15:39:54 +0000"  >&lt;p&gt;I ran another test and this time it didn&apos;t happen.&lt;/p&gt;

&lt;p&gt;I&apos;m planning to wait with committing the changes here until &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-3253&quot; title=&quot;improve &amp;quot;attachments&amp;quot; tika-eval report directory&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-3253&quot;&gt;&lt;del&gt;TIKA-3253&lt;/del&gt;&lt;/a&gt; is done, so that I can see the improved report first. Attached patch is against 1.x, this is just so you can see what I have in mind.&lt;/p&gt;</comment>
                            <comment id="17252160" author="tilman" created="Sat, 19 Dec 2020 11:15:28 +0000"  >&lt;p&gt;Now waiting for the release of PDFBox 2.0.22, which is likely this weekend. I&apos;ll also prepare main.&lt;/p&gt;</comment>
                            <comment id="17252165" author="tallison@mitre.org" created="Sat, 19 Dec 2020 11:41:22 +0000"  >&lt;p&gt;Thank you! I&#8217;m afk until Monday ... that was on my list for then.&lt;/p&gt;</comment>
                            <comment id="17252320" author="hudson" created="Sun, 20 Dec 2020 05:32:25 +0000"  >&lt;p&gt;SUCCESS: Integrated in Jenkins build Tika &#187; tika-branch1x-jdk8 #69 (See &lt;a href=&quot;https://ci-builds.apache.org/job/Tika/job/tika-branch1x-jdk8/69/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://ci-builds.apache.org/job/Tika/job/tika-branch1x-jdk8/69/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-3246&quot; title=&quot;IllegalArgumentException when generation of appearances fails&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-3246&quot;&gt;&lt;del&gt;TIKA-3246&lt;/del&gt;&lt;/a&gt;: call tailored fixup when getting AcroForm the first time to avoid the creation of appearances which aren&apos;t needed in tika (newly needed in PDFBox 2.0.22) (tilman: &lt;a href=&quot;https://github.com/apache/tika/commit/4150317e6667576acb8d6f808a5686ff22d2ee7d&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/4150317e6667576acb8d6f808a5686ff22d2ee7d&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/pdf/AbstractPDF2XHTML.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/pdf/PDFParser.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="17252336" author="hudson" created="Sun, 20 Dec 2020 06:03:19 +0000"  >&lt;p&gt;SUCCESS: Integrated in Jenkins build Tika &#187; tika-main-jdk8 #102 (See &lt;a href=&quot;https://ci-builds.apache.org/job/Tika/job/tika-main-jdk8/102/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://ci-builds.apache.org/job/Tika/job/tika-main-jdk8/102/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-3246&quot; title=&quot;IllegalArgumentException when generation of appearances fails&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-3246&quot;&gt;&lt;del&gt;TIKA-3246&lt;/del&gt;&lt;/a&gt;: call tailored fixup when getting AcroForm the first time to avoid the creation of appearances which aren&apos;t needed in tika (newly needed in PDFBox 2.0.22) (tilman: &lt;a href=&quot;https://github.com/apache/tika/commit/3a4c529a201c9c3d9b56cbdf8c2f8b702d74768e&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/3a4c529a201c9c3d9b56cbdf8c2f8b702d74768e&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) tika-parsers/tika-parsers-classic/tika-parsers-classic-modules/tika-parser-pdf-module/src/main/java/org/apache/tika/parser/pdf/PDFParser.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/tika-parsers-classic/tika-parsers-classic-modules/tika-parser-pdf-module/src/main/java/org/apache/tika/parser/pdf/AbstractPDF2XHTML.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13346543">PDFBOX-5049</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13345550">PDFBOX-5042</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="13017378" name="TIKA-3246.patch" size="5212" author="tilman" created="Fri, 18 Dec 2020 15:39:01 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 46 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0lfhc:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>