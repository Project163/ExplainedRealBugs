<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:03:05 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[TIKA-3106] Tika Fails to detect some EML files if extension is not .eml</title>
                <link>https://issues.apache.org/jira/browse/TIKA-3106</link>
                <project id="12310631" key="TIKA">Tika</project>
                    <description>&lt;p&gt;I have an eml file that can be detected as message/rfc822 only if the file extension is .eml, &#160;otherwise it will be detected as text/plain.&#160; Following is the code that I use to detect the file type and extension.&lt;/p&gt;

&lt;p&gt;&#160;&#160;&#160;&#160;&#160;&#160; TikaConfig config = TikaConfigFactory.getTikaConfig();&lt;/p&gt;

&lt;p&gt;&#160;&#160;&#160;&#160;&#160;&#160; Detector detector = config.getDetector();&lt;/p&gt;

&lt;p&gt;&#160;&#160;&#160;&#160;&#160;&#160; Metadata metadata = new Metadata();&lt;/p&gt;

&lt;p&gt;&#160;&#160;&#160;&#160;&#160;&#160; TikaInputStream stream = TikaInputStream.get(fis = new FileInputStream(filePath));&lt;/p&gt;

&lt;p&gt;&#160;&#160;&#160;&#160;&#160;&#160; metadata.add(Metadata.RESOURCE_NAME_KEY, filePath);&lt;/p&gt;

&lt;p&gt;&#160;&#160;&#160;&#160;&#160;&#160; MediaType mediaType = detector.detect(stream, metadata);&lt;/p&gt;

&lt;p&gt;&#160;&#160;&#160;&#160;&#160;&#160; MimeType mimeType = config.getMimeRepository().forName(mediaType.toString());&lt;/p&gt;

&lt;p&gt;&#160;&#160;&#160;&#160;&#160;&#160; String tikaExtension = mimeType.getExtension();&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;When the sample file has .eml extension,&#160; mimeType is message/rfc822 and &#160;tikaExtension is eml. When I change the extension to .txt, mimeType is text/plain and &#160;tikaExtension is .txt.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;The same&#160;mimeType and&#160;tikaExtension should be detected regardless the file extension.&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13309250">TIKA-3106</key>
            <summary>Tika Fails to detect some EML files if extension is not .eml</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="xyang200">Xiaohong Yang</reporter>
                        <labels>
                    </labels>
                <created>Wed, 3 Jun 2020 18:54:20 +0000</created>
                <updated>Tue, 16 Jun 2020 19:15:24 +0000</updated>
                                            <version>1.24</version>
                                                    <component>metadata</component>
                    <component>mime</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="17125545" author="gagravarr" created="Thu, 4 Jun 2020 05:03:24 +0000"  >&lt;p&gt;This email starts with a series of long &lt;tt&gt;ARC-&lt;/tt&gt; headers, which means that the &quot;normal&quot; email headers don&apos;t occur until a lot longer in the file than typical&lt;/p&gt;

&lt;p&gt;I&apos;ve added a match for this in &lt;tt&gt;1e02f0181&lt;/tt&gt;, which allows an ARC signature header firt to be matched like we already did for DKIM header first. With that commit in place, your file is then detected with contents only&lt;/p&gt;

&lt;p&gt;Can you please give a nightly build / override tika mime types file a try with your files, and see if any other email first headers are still being missed for detection?&lt;/p&gt;</comment>
                            <comment id="17125567" author="hudson" created="Thu, 4 Jun 2020 06:03:53 +0000"  >&lt;p&gt;SUCCESS: Integrated in Jenkins build Tika-trunk #1820 (See &lt;a href=&quot;https://builds.apache.org/job/Tika-trunk/1820/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Tika-trunk/1820/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-3106&quot; title=&quot;Tika Fails to detect some EML files if extension is not .eml&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-3106&quot;&gt;TIKA-3106&lt;/a&gt; Magic header detection for emails starting with an ARC- (nick: &lt;a href=&quot;https://github.com/apache/tika/commit/1e02f01819ef44bc99a5fe81e271e67be79b98ad&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/1e02f01819ef44bc99a5fe81e271e67be79b98ad&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) tika-core/src/main/resources/org/apache/tika/mime/tika-mimetypes.xml&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="17126157" author="xyang200" created="Thu, 4 Jun 2020 19:40:23 +0000"  >&lt;p&gt;Thank you very much for the quick response.&#160;&lt;/p&gt;

&lt;p&gt;We use gradle to pull your packages in our project. I downloaded the jar files (tika-core-2.0.0-20200604.053323-687.jar and tika-parsers-2.0.0-20200604.053748-675.jar) from you build and and let gradle use these jar files in the project. It compiles but some other classes are missing at runtime.&#160; So I cannot confirm the fix in our project.&lt;/p&gt;

&lt;p&gt;I will continue to try to run it. If you can help me to run it please let me know. Thank you in advance.&lt;/p&gt;</comment>
                            <comment id="17126443" author="gagravarr" created="Fri, 5 Jun 2020 06:29:15 +0000"  >&lt;p&gt;You ought to be able to point your gradle build at the snapshots repo &amp;lt;&lt;a href=&quot;https://repository.apache.org/content/repositories/snapshots/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://repository.apache.org/content/repositories/snapshots/&lt;/a&gt;&amp;gt; then depend on Tika Parsers + Core as your would a normal release, for 2.0.0-SNAPSHOT. Strongly not recommended for production, but ought to let you test the fix!&lt;/p&gt;</comment>
                            <comment id="17128318" author="xyang200" created="Mon, 8 Jun 2020 13:54:38 +0000"  >&lt;p&gt;Instead of testing in integrated mode with our project, I created a standalone program and compiled it with the jar files of your build #1820. It is confirmed that the problem with the sample file is fixed. It is now detected as message/rfc822 (tika extension .eml) regardless the &#160;actual file extension.&lt;/p&gt;

&lt;p&gt;This is the only sample file that had the problem. I will let you know if we find more sample files.&lt;/p&gt;

&lt;p&gt;I believe the fix will be included in the next 1.24.x release, right?&lt;/p&gt;

&lt;p&gt;Thank you very much!&lt;/p&gt;</comment>
                            <comment id="17137864" author="hudson" created="Tue, 16 Jun 2020 19:15:24 +0000"  >&lt;p&gt;SUCCESS: Integrated in Jenkins build tika-branch-1x #341 (See &lt;a href=&quot;https://builds.apache.org/job/tika-branch-1x/341/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/tika-branch-1x/341/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-3106&quot; title=&quot;Tika Fails to detect some EML files if extension is not .eml&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-3106&quot;&gt;TIKA-3106&lt;/a&gt; Magic header detection for emails starting with an ARC- (tallison: &lt;a href=&quot;https://github.com/apache/tika/commit/9e53cec0601d7db7dbc49969a78922c708cdafdf&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/9e53cec0601d7db7dbc49969a78922c708cdafdf&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) tika-core/src/main/resources/org/apache/tika/mime/tika-mimetypes.xml&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="13004754" name="EmlFile.txt" size="18841" author="xyang200" created="Wed, 3 Jun 2020 18:53:50 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 21 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0fh4w:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>