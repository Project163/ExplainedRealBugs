<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:03:12 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[TIKA-3009] XML Parser reset() detection no working in weblogic 12.2.1.3</title>
                <link>https://issues.apache.org/jira/browse/TIKA-3009</link>
                <project id="12310631" key="TIKA">Tika</project>
                    <description>&lt;p&gt;Starting with tika 1.20 the org.apache.tika.utils.XMLReaderUtils try to detect if a XML parser supports the reset() functionality by calling reset() during the poolParser creation and watching for a UnsupportedOperationException.&lt;/p&gt;

&lt;p&gt;This unfortunately does not work in weblogic server as the attained RegistryParser itself caches underlying SAX parsers. Only after first use the reset() of the underlying SAXParser is called and will produce the UnsupportedOperationException. A first call to reset() will not produce this exception and XMLReaderUtils thinks, the parser supports reset() which in effect is not true.&lt;/p&gt;

&lt;p&gt;This results in exhaustion of the parser pool and intermittent errors and delays in processing as the pool is reset when a parser is not available after 5 minutes.&lt;/p&gt;</description>
                <environment>&lt;p&gt;JDK 1.8.0_231&lt;/p&gt;

&lt;p&gt;Oracle Weblogic Server 12.2.1.3&lt;/p&gt;</environment>
        <key id="13274087">TIKA-3009</key>
            <summary>XML Parser reset() detection no working in weblogic 12.2.1.3</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tallison">Tim Allison</assignee>
                                    <reporter username="dani2305">Daniel</reporter>
                        <labels>
                    </labels>
                <created>Thu, 12 Dec 2019 09:47:47 +0000</created>
                <updated>Tue, 3 Nov 2020 20:41:02 +0000</updated>
                            <resolved>Fri, 30 Oct 2020 20:07:41 +0000</resolved>
                                    <version>1.20</version>
                    <version>1.21</version>
                    <version>1.22</version>
                    <version>1.23</version>
                                    <fixVersion>1.25</fixVersion>
                                    <component>core</component>
                        <due></due>
                            <votes>2</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="16994553" author="gagravarr" created="Thu, 12 Dec 2019 11:29:31 +0000"  >&lt;p&gt;That sounds like a &quot;fun&quot; WebLogic bug... Would calling reset twice in the test block let us correctly test for the functionality, do you think?&lt;/p&gt;</comment>
                            <comment id="16994601" author="dani2305" created="Thu, 12 Dec 2019 12:25:53 +0000"  >&lt;p&gt;Thanks for the quick reply. I don&apos;t think that calling reset twice would solve the problem. The underlying parser is only created when the parser was &quot;used&quot; and only after that a real &quot;reset&quot; is performed.&lt;/p&gt;

&lt;p&gt;Quickest fix would be to catch an eventual UnsupportedOperationException even though it is not really expected as the test revealed support for this feature. Either in the PoolParser&apos;s reset() method or in releaseParser() (as it was done up to tika 1.19).&lt;/p&gt;</comment>
                            <comment id="16994687" author="tallison@mitre.org" created="Thu, 12 Dec 2019 13:47:59 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=nick&quot; class=&quot;user-hover&quot; rel=&quot;nick&quot;&gt;nick&lt;/a&gt;, I was going to go with &quot;exciting&quot;.&#160; To confirm, you can&apos;t control which SAXParser is used by, e.g., -Djavax.xml.parsers.&lt;em&gt;SAXParserFactory&lt;/em&gt;&lt;/p&gt;</comment>
                            <comment id="17222824" author="vigi" created="Thu, 29 Oct 2020 10:40:10 +0000"  >&lt;p&gt;I confirm this behaviour, it happens after detecting the mime type for 10 XML files. The 11th time you will have to wait for 5 minutes and then a new pool of SAX parsers is built and the process starts over.&#160;&lt;/p&gt;

&lt;p&gt;Probably a try / catch in the releaseParser method when doing the reset call would be needed, even though that&apos;s what the canReset boolean is supposed to prevent in the first place.&lt;/p&gt;

&lt;p&gt;The releaseDOMBuilder method makes use of the try / catch block.&lt;/p&gt;

&lt;p&gt;It also affects version 1.24.1.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17223027" author="tallison@mitre.org" created="Thu, 29 Oct 2020 16:47:41 +0000"  >&lt;p&gt;This will actually help?&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;     private static void releaseParser(PoolSAXParser parser) {
-        parser.reset();
+        try {
+            parser.reset();
+        } catch (UnsupportedOperationException e) {
+            //TIKA-3009 -- we really shouldn&apos;t have to do this... :(
+        }
         //if this is a different generation, don&apos;t put it back
         //in the pool
         if (parser.getGeneration() != POOL_GENERATION.get()) {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17223568" author="vigi" created="Fri, 30 Oct 2020 11:03:53 +0000"  >&lt;p&gt;yes, something like that&lt;/p&gt;</comment>
                            <comment id="17223866" author="tallison@mitre.org" created="Fri, 30 Oct 2020 20:07:41 +0000"  >&lt;p&gt;Added the work around in 1.x branch and main.  Let me know if this doesn&apos;t fix the problem in your environment.&lt;/p&gt;</comment>
                            <comment id="17223915" author="hudson" created="Fri, 30 Oct 2020 21:21:16 +0000"  >&lt;p&gt;SUCCESS: Integrated in Jenkins build Tika &#187; tika-main-jdk8 #39 (See &lt;a href=&quot;https://ci-builds.apache.org/job/Tika/job/tika-main-jdk8/39/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://ci-builds.apache.org/job/Tika/job/tika-main-jdk8/39/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-3009&quot; title=&quot;XML Parser reset() detection no working in weblogic 12.2.1.3&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-3009&quot;&gt;&lt;del&gt;TIKA-3009&lt;/del&gt;&lt;/a&gt; &amp;#8211; workaround for weblogic&apos;s xml parser (tallison: &lt;a href=&quot;https://github.com/apache/tika/commit/225d7e572e3bcf980793c60a38e3bfb362f57e31&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/225d7e572e3bcf980793c60a38e3bfb362f57e31&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) tika-core/src/main/java/org/apache/tika/utils/XMLReaderUtils.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="17225668" author="hudson" created="Tue, 3 Nov 2020 20:41:02 +0000"  >&lt;p&gt;UNSTABLE: Integrated in Jenkins build Tika &#187; tika-branch1x-jdk8 #25 (See &lt;a href=&quot;https://ci-builds.apache.org/job/Tika/job/tika-branch1x-jdk8/25/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://ci-builds.apache.org/job/Tika/job/tika-branch1x-jdk8/25/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-3009&quot; title=&quot;XML Parser reset() detection no working in weblogic 12.2.1.3&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-3009&quot;&gt;&lt;del&gt;TIKA-3009&lt;/del&gt;&lt;/a&gt; &amp;#8211; workaround for weblogic&apos;s xml parser (tallison: &lt;a href=&quot;https://github.com/apache/tika/commit/1b81d200e8ffb882276264618c9004ba4bf72ecb&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/1b81d200e8ffb882276264618c9004ba4bf72ecb&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) tika-core/src/main/java/org/apache/tika/utils/XMLReaderUtils.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 1 week, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z09log:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>