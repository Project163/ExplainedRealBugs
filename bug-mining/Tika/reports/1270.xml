<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:03:53 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[TIKA-3644] OfficeParser can not detect embedded zip bomb in the office documents</title>
                <link>https://issues.apache.org/jira/browse/TIKA-3644</link>
                <project id="12310631" key="TIKA">Tika</project>
                    <description>&lt;p&gt;Hi, I am trying to get &quot;zip bomb detection&quot; exception but I can&apos;t. I used attachments as below and I saw this situation like that:&lt;/p&gt;

&lt;p&gt;When I send &quot;zipbomb.xls&quot; and &quot;zipbomb.doc&quot; to Tika, Tika threw exception.&lt;/p&gt;

&lt;p&gt;When I send &quot;zipbomb.xlsx&quot;,&quot;zipbomb.docx&quot;,&quot;zipbomb.ppt&quot; and &quot;zipbomb.pptx&quot; to Tika, Tika didn&apos;t throw exception.&lt;/p&gt;

&lt;p&gt;Thanks.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13422157">TIKA-3644</key>
            <summary>OfficeParser can not detect embedded zip bomb in the office documents</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="sergenbag01">Sergen Ba&#287;</reporter>
                        <labels>
                    </labels>
                <created>Wed, 12 Jan 2022 08:48:24 +0000</created>
                <updated>Mon, 7 Feb 2022 16:21:26 +0000</updated>
                            <resolved>Thu, 13 Jan 2022 19:58:08 +0000</resolved>
                                    <version>2.2.1</version>
                                    <fixVersion>2.3.0</fixVersion>
                                    <component>parser</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="17474453" author="tallison@mitre.org" created="Wed, 12 Jan 2022 11:15:01 +0000"  >&lt;p&gt;How are you calling Tika?&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;I&apos;m not able to get an exception with tika-app (2.2.1) or tika-server-standard (2.2.1) on zipbomb.doc nor on any of the others I&apos;ve tried.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;You shouldn&apos;t get a zipbomb exception for a zip file that only has 5&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/help_16.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; levels.&#160; It should take a bunch more levels to trigger the bomb exception.&lt;/p&gt;</comment>
                            <comment id="17474598" author="JIRAUSER283446" created="Wed, 12 Jan 2022 14:47:40 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tallison&quot; class=&quot;user-hover&quot; rel=&quot;tallison&quot;&gt;tallison&lt;/a&gt;, I set 5 to MaximumPackageEntryDepth. My expectation is Tika throws this exception in all cases. I don&apos;t know what I missed.  &lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/13038676/13038676_tika_exception.PNG&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;I am using this code:&lt;/p&gt;

&lt;p&gt;&lt;ins&gt;&lt;em&gt;TikaExtractor.java&lt;/em&gt;&lt;/ins&gt;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; AutoDetectParser parser = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; AutoDetectParser();
&#160; &#160; &#160;
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; ContentMetadata ExtractContentAndMetadata(InputStream inputStream, ExtractionParameters params) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException, SAXException, TikaException
&#160; &#160; {
&#160; &#160; &#160; &#160; BodyContentHandler handler = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; BodyContentHandler(-1); &#160; &#160;
&#160; &#160; &#160; &#160;&#160;
&#160; &#160; &#160; &#160; Metadata metadata = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Metadata(); &#160; &#160; &#160; &#160;
&#160; &#160; &#160; &#160; ContentMetadata result &#160;= &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ContentMetadata();
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;
&#160; &#160; &#160; &#160; AutoDetectParserConfig autoDetectParserConfig = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; AutoDetectParserConfig(&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, 1000000L, 100L, 100, 5);
&#160; &#160; &#160; &#160; parser.setAutoDetectParserConfig(autoDetectParserConfig);
&#160; &#160; &#160; &#160;&#160;
&#160; &#160; &#160; &#160; ParseContext context = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ParseContext();
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;
&#160; &#160; &#160; &#160; &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; (InputStream stream = inputStream)&#160;
&#160; &#160; &#160; &#160; {
&#160; &#160; &#160; &#160; &#160; &#160; parser.parse(stream, handler, metadata, context);
&#160; &#160; &#160; &#160; &#160; &#160;&#160;
&#160; &#160; &#160; &#160; &#160; &#160; result.setContent(handler.toString()); &#160; &#160; &#160; &#160; &#160; &#160;
&#160; &#160; &#160; &#160; &#160; &#160; result.setMetadata(metadata.toString()); &#160; &#160; &#160; &#160; &#160; &#160;
&#160; &#160; &#160; &#160; }
&#160; &#160; &#160; &#160;&#160;
&#160; &#160; &#160; &#160; &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; result;
&#160; &#160; }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;ins&gt;&lt;em&gt;pom.xml&lt;/em&gt;&lt;/ins&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    &amp;lt;dependency&amp;gt;
&#160; &#160; &#160; &#160; &#160;&amp;lt;groupId&amp;gt;org.apache.tika&amp;lt;/groupId&amp;gt;
&#160; &#160; &#160; &#160; &#160;&amp;lt;artifactId&amp;gt;tika-core&amp;lt;/artifactId&amp;gt;
&#160; &#160; &#160; &#160; &amp;lt;version&amp;gt;2.2.1&amp;lt;/version&amp;gt;
&#160; &#160; &amp;lt;/dependency&amp;gt; &#160; &#160;
&#160; &#160; &amp;lt;dependency&amp;gt;
&#160; &#160; &#160; &#160; &amp;lt;groupId&amp;gt;org.apache.tika&amp;lt;/groupId&amp;gt;
&#160; &#160; &#160; &#160; &amp;lt;artifactId&amp;gt;tika-parsers-standard-&lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt;&amp;lt;/artifactId&amp;gt;
&#160; &#160; &#160; &#160; &amp;lt;version&amp;gt;2.2.1&amp;lt;/version&amp;gt;
&#160; &#160; &amp;lt;/dependency&amp;gt;
&#160; &#160; &amp;lt;dependency&amp;gt;
&#160; &#160; &#160; &#160; &amp;lt;groupId&amp;gt;org.apache.tika&amp;lt;/groupId&amp;gt;
&#160; &#160; &#160; &#160; &amp;lt;artifactId&amp;gt;tika-parser-sqlite3-&lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt;&amp;lt;/artifactId&amp;gt;
&#160; &#160; &#160; &#160; &amp;lt;version&amp;gt;2.2.1&amp;lt;/version&amp;gt;
&#160; &#160; &#160;&amp;lt;/dependency&amp;gt;
&#160; &#160; &#160;&amp;lt;dependency&amp;gt;
&#160; &#160; &#160; &#160; &amp;lt;groupId&amp;gt;org.apache.tika&amp;lt;/groupId&amp;gt;
&#160; &#160; &#160; &#160; &amp;lt;artifactId&amp;gt;tika-parser-scientific-&lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt;&amp;lt;/artifactId&amp;gt;
&#160; &#160; &#160; &#160; &amp;lt;version&amp;gt;2.2.1&amp;lt;/version&amp;gt;
&#160; &#160; &#160;&amp;lt;/dependency&amp;gt; &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17475324" author="tallison@mitre.org" created="Thu, 13 Jan 2022 12:44:27 +0000"  >&lt;p&gt;Thank you.&#160; Looking now.&lt;/p&gt;</comment>
                            <comment id="17475557" author="tallison@mitre.org" created="Thu, 13 Jan 2022 17:24:11 +0000"  >&lt;p&gt;It looks like the package-depth detector (the 5 in your config) is not triggered if the embeddedDocument extractor calls the parse with outputHTML=false.&#160; In the MSOffice parser, outputHTML=true; however in the OOXMLParser, outputHTML=false.&#160; I propose that we change all outputHTML=true throughout the parsers.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;That said, I did get a zip bomb exception when I set the maxDepth to 5 on both MSOffice and ooxml files.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;del&gt;Looking at the SecureContentHandler, I&apos;m frankly not certain what the difference between packageDepth and depth is.&lt;/del&gt; &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/tongue.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;It looks like the difference is that maxPackageDepth should cover embedded items, where as maxDepth covers all html entities.&lt;/p&gt;</comment>
                            <comment id="17475803" author="hudson" created="Thu, 13 Jan 2022 22:21:16 +0000"  >&lt;p&gt;SUCCESS: Integrated in Jenkins build Tika &#187; tika-main-jdk8 #416 (See &lt;a href=&quot;https://ci-builds.apache.org/job/Tika/job/tika-main-jdk8/416/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://ci-builds.apache.org/job/Tika/job/tika-main-jdk8/416/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-3644&quot; title=&quot;OfficeParser can not detect embedded zip bomb in the office documents&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-3644&quot;&gt;&lt;del&gt;TIKA-3644&lt;/del&gt;&lt;/a&gt; &amp;#8211; Improve consistency in reporting package-entry divs across all parsers for embedded files (tallison: &lt;a href=&quot;https://github.com/apache/tika/commit/118734a1317fa13ad66959fdc28969ca50a49643&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/118734a1317fa13ad66959fdc28969ca50a49643&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-miscoffice-module/src/main/java/org/apache/tika/parser/odf/FlatOpenDocumentMacroHandler.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-html-module/src/main/java/org/apache/tika/parser/html/HtmlHandler.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-apple-module/src/main/java/org/apache/tika/parser/apple/PListParser.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-microsoft-module/src/main/java/org/apache/tika/parser/microsoft/ooxml/xwpf/ml2006/BinaryDataHandler.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-microsoft-module/src/main/java/org/apache/tika/parser/microsoft/xml/WordMLParser.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-microsoft-module/src/main/java/org/apache/tika/parser/microsoft/onenote/OneNoteTreeWalker.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-miscoffice-module/src/test/java/org/apache/tika/parser/odf/ODFParserTest.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-pdf-module/src/main/java/org/apache/tika/parser/pdf/ImageGraphicsEngine.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-apple-module/src/main/java/org/apache/tika/parser/apple/AppleSingleFileParser.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-miscoffice-module/src/main/java/org/apache/tika/parser/odf/OpenDocumentParser.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-microsoft-module/src/main/java/org/apache/tika/parser/microsoft/rtf/RTFEmbObjHandler.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/tika-parsers-standard/tika-parsers-standard-package/src/test/java/org/apache/tika/parser/RecursiveParserWrapperTest.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-microsoft-module/src/main/java/org/apache/tika/parser/microsoft/EMFParser.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-microsoft-module/src/main/java/org/apache/tika/parser/microsoft/ooxml/OOXMLExtractorFactory.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-microsoft-module/src/main/java/org/apache/tika/parser/microsoft/TNEFParser.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-miscoffice-module/src/main/java/org/apache/tika/parser/odf/OpenDocumentBodyHandler.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-microsoft-module/src/main/java/org/apache/tika/parser/microsoft/ooxml/AbstractOOXMLExtractor.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-pdf-module/src/main/java/org/apache/tika/parser/pdf/AbstractPDF2XHTML.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/tika-parsers-standard/tika-parsers-standard-package/src/test/java/org/apache/tika/parser/microsoft/XML2003ParserTest.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-miscoffice-module/src/main/java/org/apache/tika/parser/epub/EpubParser.java&lt;/li&gt;
	&lt;li&gt;(edit) CHANGES.txt&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-crypto-module/src/main/java/org/apache/tika/parser/crypto/TSDParser.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="17476158" author="JIRAUSER283446" created="Fri, 14 Jan 2022 14:03:03 +0000"  >&lt;p&gt;Thanks a lot &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="13038665" name="10_2_2_2_2.zip" size="705" author="sergenbag01" created="Wed, 12 Jan 2022 08:30:29 +0000"/>
                            <attachment id="13038676" name="tika_exception.PNG" size="40381" author="sergenbag01" created="Wed, 12 Jan 2022 14:38:33 +0000"/>
                            <attachment id="13038664" name="zipbomb.doc" size="20992" author="sergenbag01" created="Wed, 12 Jan 2022 08:30:55 +0000"/>
                            <attachment id="13038663" name="zipbomb.docx" size="14960" author="sergenbag01" created="Wed, 12 Jan 2022 08:30:55 +0000"/>
                            <attachment id="13038662" name="zipbomb.ppt" size="87552" author="sergenbag01" created="Wed, 12 Jan 2022 08:30:55 +0000"/>
                            <attachment id="13038661" name="zipbomb.pptx" size="36148" author="sergenbag01" created="Wed, 12 Jan 2022 08:30:55 +0000"/>
                            <attachment id="13038660" name="zipbomb.xls" size="24064" author="sergenbag01" created="Wed, 12 Jan 2022 08:30:55 +0000"/>
                            <attachment id="13038659" name="zipbomb.xlsx" size="15524" author="sergenbag01" created="Wed, 12 Jan 2022 08:30:55 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>8.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 43 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0yhyg:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>