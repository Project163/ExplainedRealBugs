<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:02:55 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[TIKA-3002] Possible bug with OCR strategy AUTO</title>
                <link>https://issues.apache.org/jira/browse/TIKA-3002</link>
                <project id="12310631" key="TIKA">Tika</project>
                    <description>&lt;p&gt;For performance reasons, I would like to activate the OCR scanning only when necessary. I therefore tried to set the OCR strategy to &quot;AUTO&quot;.&lt;/p&gt;

&lt;p&gt;However, I see that also for &quot;normal&quot; PDF files (where no OCR should be required), OCR is performed and this not also slows down the application but (more important) results in doubling the resulting text.&lt;/p&gt;

&lt;p&gt;Trying to understand how this works, I think I may have found a possible error in the class&#160;&lt;b&gt;AbstractPDF2XHTML&lt;/b&gt;. There, in case of selected OCR Strategy AUTO, on line 404 the total number of characters found on the page&#160;is checked: if this is lower than 10 OCR is performed.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
} &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (config.getOcrStrategy().equals(PDFParserConfig.OCR_STRATEGY.AUTO)) {
    &lt;span class=&quot;code-comment&quot;&gt;//TODO add more sophistication
&lt;/span&gt;    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (totalCharsPerPage &amp;lt; 10 || unmappedUnicodeCharsPerPage &amp;gt; 10) {
        doOCROnCurrentPage();
    }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The logic is correct, but unfortunately at the beginning of the method (line 361 and 362) the two variables checked on this line are reset to 0, so this conditions is going to be always true.&lt;/p&gt;

&lt;p&gt;I would suggest to move the reset of the two variables inside a finally block at the end of the method.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13271216">TIKA-3002</key>
            <summary>Possible bug with OCR strategy AUTO</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="patrickherber">Patrick Herber</reporter>
                        <labels>
                    </labels>
                <created>Thu, 28 Nov 2019 12:49:04 +0000</created>
                <updated>Mon, 2 Dec 2019 21:22:42 +0000</updated>
                            <resolved>Mon, 2 Dec 2019 19:57:10 +0000</resolved>
                                    <version>1.22</version>
                                                    <component>ocr</component>
                    <component>parser</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="16985251" author="tilman" created="Sat, 30 Nov 2019 04:42:31 +0000"  >&lt;p&gt;From looking at the history, that segment was added in &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2846&quot; title=&quot;Add per page unicode mapping stats to the metadata in the PDFParser&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2846&quot;&gt;&lt;del&gt;TIKA-2846&lt;/del&gt;&lt;/a&gt; at the top of that method for a different purpose, i.e. store and reset these values. The &quot;auto&quot; strategy was added a month later in &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2749&quot; title=&quot;OCR on PDFs should &amp;quot;just work&amp;quot; out of the box&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2749&quot;&gt;TIKA-2749&lt;/a&gt; at the bottom of that method.&lt;br/&gt;
ping &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tallison&quot; class=&quot;user-hover&quot; rel=&quot;tallison&quot;&gt;tallison&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16985330" author="tallison@mitre.org" created="Sat, 30 Nov 2019 11:13:42 +0000"  >&lt;p&gt;Thank you &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt;! Will fix Monday unless anyone beats me to it. If we fellow devs vote for an RC2, I can respin then.&lt;/p&gt;</comment>
                            <comment id="16986313" author="tallison@mitre.org" created="Mon, 2 Dec 2019 19:57:11 +0000"  >&lt;p&gt;Thank you &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=patrickherber&quot; class=&quot;user-hover&quot; rel=&quot;patrickherber&quot;&gt;patrickherber&lt;/a&gt; for tracking this down and reporting it!&lt;/p&gt;</comment>
                            <comment id="16986379" author="hudson" created="Mon, 2 Dec 2019 21:20:28 +0000"  >&lt;p&gt;SUCCESS: Integrated in Jenkins build tika-branch-1x #287 (See &lt;a href=&quot;https://builds.apache.org/job/tika-branch-1x/287/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/tika-branch-1x/287/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-3002&quot; title=&quot;Possible bug with OCR strategy AUTO&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-3002&quot;&gt;&lt;del&gt;TIKA-3002&lt;/del&gt;&lt;/a&gt; &amp;#8211; fix bug in OCR AUTO mode (tallison: &lt;a href=&quot;https://github.com/apache/tika/commit/f67a83444036d4fb5b23e9000f06434bfb58eefc&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/f67a83444036d4fb5b23e9000f06434bfb58eefc&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) tika-parsers/src/test/java/org/apache/tika/parser/pdf/PDFParserTest.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/pdf/AbstractPDF2XHTML.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="16986381" author="hudson" created="Mon, 2 Dec 2019 21:22:42 +0000"  >&lt;p&gt;SUCCESS: Integrated in Jenkins build Tika-trunk #1754 (See &lt;a href=&quot;https://builds.apache.org/job/Tika-trunk/1754/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Tika-trunk/1754/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-3002&quot; title=&quot;Possible bug with OCR strategy AUTO&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-3002&quot;&gt;&lt;del&gt;TIKA-3002&lt;/del&gt;&lt;/a&gt; &amp;#8211; fix bug in OCR AUTO mode (tallison: &lt;a href=&quot;https://github.com/apache/tika/commit/f5edbbd60ef22cce3fc2c8c23e617489d42be29f&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/f5edbbd60ef22cce3fc2c8c23e617489d42be29f&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) tika-parsers/src/test/java/org/apache/tika/parser/pdf/PDFParserTest.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/pdf/AbstractPDF2XHTML.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 49 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z093yo:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>