<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:59:43 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[TIKA-1690] Inconsistent (buggy) behavior when using tika-server </title>
                <link>https://issues.apache.org/jira/browse/TIKA-1690</link>
                <project id="12310631" key="TIKA">Tika</project>
                    <description>&lt;p&gt;I am using Tika trunk (1.10-SNAPSHOT) and posting documents there. An example would be the following:&lt;/p&gt;

&lt;p&gt;curl -T MOD09GA.A2014010.h30v12.005.2014012183944.vegetation_fraction.tif  &lt;a href=&quot;http://localhost:9998/meta&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://localhost:9998/meta&lt;/a&gt; --header &quot;Accept: application/json&#8221;&lt;br/&gt;
&#8230;&lt;br/&gt;
curl -T MOD09GA.A2014010.h30v12.005.2014012183944.vegetation_fraction.tif  &lt;a href=&quot;http://localhost:9998/meta&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://localhost:9998/meta&lt;/a&gt; --header &quot;Accept: application/rdf+xml&#8221;&lt;br/&gt;
&#8230;&lt;br/&gt;
curl -T MOD09GA.A2014010.h30v12.005.2014012183944.vegetation_fraction.tif  &lt;a href=&quot;http://localhost:9998/meta&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://localhost:9998/meta&lt;/a&gt; --header &quot;Accept: text/csv&#8221;&lt;/p&gt;

&lt;p&gt;I am using a python script to iterate through all the files in a folder. It works for about 50% to 80% of the files. For the rest it gives an error 500. When I post a file individually for which it previously failed (using the python script) it sometimes works. When done in an ad hoc manner, it works most of the time but fails sometimes. At times it is successful for application/rdf+xml format but fails for application/json format. The behavior is inconsistent.&lt;/p&gt;

&lt;p&gt;Here is an example trace of when it does not work as expected &lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;&lt;br/&gt;
A sample of the data being used can be found here &lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;&lt;br/&gt;
Any help would be appreciated. &lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://paste.apache.org/lbAm&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://paste.apache.org/lbAm&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://drive.google.com/file/d/0B6wmo4_-H0P2eWJjdTdtYS1HRGs/view?usp=sharing&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://drive.google.com/file/d/0B6wmo4_-H0P2eWJjdTdtYS1HRGs/view?usp=sharing&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="12845756">TIKA-1690</key>
            <summary>Inconsistent (buggy) behavior when using tika-server </summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tallison">Tim Allison</assignee>
                                    <reporter username="namratamalarout">Namrata Malarout</reporter>
                        <labels>
                            <label>memex</label>
                            <label>tika-python</label>
                    </labels>
                <created>Fri, 17 Jul 2015 00:11:42 +0000</created>
                <updated>Fri, 24 Jul 2015 08:14:42 +0000</updated>
                            <resolved>Thu, 23 Jul 2015 13:02:26 +0000</resolved>
                                                    <fixVersion>1.10</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="14631209" author="tallison@mitre.org" created="Fri, 17 Jul 2015 11:22:33 +0000"  >&lt;p&gt;Thank you for raising this.  As I mentioned on the users list, I&apos;m not sure why we aren&apos;t checking for null in TikaUtils.&lt;/p&gt;

&lt;p&gt;It looks like this feature was added in &lt;a href=&quot;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1678515&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;r1678515&lt;/a&gt;:&lt;br/&gt;
&quot;Fix for &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1625&quot; title=&quot;Add support to Tika Server for parsing remote file URLs and for providing language detection&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1625&quot;&gt;&lt;del&gt;TIKA-1625&lt;/del&gt;&lt;/a&gt; Add support to Tika Server for parsing remote file URLs and for providing language detection...&quot; &lt;/p&gt;</comment>
                            <comment id="14631245" author="tallison@mitre.org" created="Fri, 17 Jul 2015 12:10:07 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=chrismattmann&quot; class=&quot;user-hover&quot; rel=&quot;chrismattmann&quot;&gt;chrismattmann&lt;/a&gt;, as I look at this, it looks like we are usting TikaUtils.getInputStream in a few places&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt; @PUT
    @Consumes(&quot;*/*&quot;)
    @Produces(&quot;text/plain&quot;)
    public StreamingOutput getText
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;but not&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt; @POST
    @Consumes(&quot;multipart/form-data&quot;)
    @Produces(&quot;text/html&quot;)
    @Path(&quot;form&quot;)
    public StreamingOutput getHTMLFromMultipart
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;or&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt; @PUT
    @Consumes(&quot;*/*&quot;)
    @Produces(&quot;text/html&quot;)
    public StreamingOutput getHTML
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Is this desired, or do we want to make fileUrl available to all functionality of tika-server?&lt;/p&gt;</comment>
                            <comment id="14631326" author="chrismattmann" created="Fri, 17 Jul 2015 13:20:32 +0000"  >&lt;p&gt;hey &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tallison%40apache.org&quot; class=&quot;user-hover&quot; rel=&quot;tallison@apache.org&quot;&gt;tallison@apache.org&lt;/a&gt; we should probably be more consistent about using TikaUtils.getInputStream in those multipart methods.&lt;/p&gt;</comment>
                            <comment id="14632985" author="chrismattmann" created="Mon, 20 Jul 2015 00:09:03 +0000"  >&lt;p&gt;So I found something pretty annoying with &lt;a href=&quot;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1678515&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;r1678515&lt;/a&gt;. The part of the code that adds in the temp file thing makes Tika Server 1.9 behave &lt;b&gt;extremely&lt;/b&gt; buggy on Windows and renders &lt;a href=&quot;http://github.com/chrismattmann/tika-python&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Tika-Python&lt;/a&gt; pretty much useless without some workarounds and patches discussed in &lt;a href=&quot;https://github.com/chrismattmann/tika-python/issues/54#issuecomment-122710752&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;#54&lt;/a&gt; and in &lt;a href=&quot;https://github.com/chrismattmann/tika-python/issues/44&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;#44&lt;/a&gt;. I am thinking of reverting the part that uses the tmpFile thing. Thoughts, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tallison%40apache.org&quot; class=&quot;user-hover&quot; rel=&quot;tallison@apache.org&quot;&gt;tallison@apache.org&lt;/a&gt;?&lt;/p&gt;</comment>
                            <comment id="14633436" author="tallison@mitre.org" created="Mon, 20 Jul 2015 11:19:29 +0000"  >&lt;p&gt;tmpFile? Do you mean the fileUrl?  Sorry.&lt;/p&gt;
</comment>
                            <comment id="14633606" author="chrismattmann" created="Mon, 20 Jul 2015 13:36:11 +0000"  >&lt;p&gt;no, I mean TikaUtkls.getInputStream which in turn gets a tmp file rather than directly dealing with the stream.&lt;/p&gt;</comment>
                            <comment id="14633610" author="tallison@mitre.org" created="Mon, 20 Jul 2015 13:42:10 +0000"  >&lt;p&gt;Is the problem &lt;tt&gt;is.available()&lt;/tt&gt;?&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;        if(is.available() == 0 &amp;amp;&amp;amp; !&quot;&quot;.equals(fileUrl)){
            Metadata metadata = new Metadata();
            return TikaInputStream.get(new URL(fileUrl), metadata);
        }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;If that&apos;s what&apos;s causing the problem, drop that and do a check for null on fileUrl, and we should be good to go (aside from our offline discussion), no?&lt;/p&gt;

&lt;p&gt;In short, if someone sends in a fileUrl in the header, use that and ignore the inputstream.&lt;/p&gt;

&lt;p&gt;But given that that portion seems to have nothing to do with the main patch, it might be best to revert it and open a separate ticket to add that functionality thoroughly (to all handlers) and add some other necessary items. &lt;/p&gt;</comment>
                            <comment id="14638767" author="tallison@mitre.org" created="Thu, 23 Jul 2015 13:02:26 +0000"  >&lt;p&gt;Reverted r1678515&apos;s fileUrl capability in tika-server.&lt;/p&gt;

&lt;p&gt;1692383&lt;/p&gt;

&lt;p&gt;If we want this capability, let&apos;s add it in 1.11.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=namratamalarout&quot; class=&quot;user-hover&quot; rel=&quot;namratamalarout&quot;&gt;namratamalarout&lt;/a&gt; and/or &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=chrismattmann&quot; class=&quot;user-hover&quot; rel=&quot;chrismattmann&quot;&gt;chrismattmann&lt;/a&gt;, if you could rebuild from trunk and confirm this fixes your problem, that&apos;d be great.&lt;/p&gt;
</comment>
                            <comment id="14640134" author="hudson" created="Fri, 24 Jul 2015 08:14:42 +0000"  >&lt;p&gt;SUCCESS: Integrated in tika-trunk-jdk1.7 #799 (See &lt;a href=&quot;https://builds.apache.org/job/tika-trunk-jdk1.7/799/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/tika-trunk-jdk1.7/799/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1690&quot; title=&quot;Inconsistent (buggy) behavior when using tika-server &quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1690&quot;&gt;&lt;del&gt;TIKA-1690&lt;/del&gt;&lt;/a&gt;: revert changes made in r1678515 that added fileUrl capability in tika-server (tallison: &lt;a href=&quot;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1692383&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1692383&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/tika/trunk/tika-server/src/main/java/org/apache/tika/server/resource/MetadataResource.java&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-server/src/main/java/org/apache/tika/server/resource/RecursiveMetadataResource.java&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-server/src/main/java/org/apache/tika/server/resource/TikaResource.java&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-server/src/main/java/org/apache/tika/server/resource/TikaUtils.java&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-server/src/main/java/org/apache/tika/server/resource/UnpackerResource.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310250" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10431"><![CDATA[Important]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 17 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2hd5b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>