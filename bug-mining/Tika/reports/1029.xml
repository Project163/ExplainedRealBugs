<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:01:58 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[TIKA-2675] OpenDocumentParser should fail on invalid zip files</title>
                <link>https://issues.apache.org/jira/browse/TIKA-2675</link>
                <project id="12310631" key="TIKA">Tika</project>
                    <description>&lt;p&gt;The OpenDocumentParser assumes a zip file as container. However, if it is called on an invalid zip stream from a remote URL (see &lt;a href=&quot;https://issues.apache.org/jira/browse/NUTCH-2603&quot; title=&quot;Bring back legacy pre-Tika parsers and use them as back up parsers&quot; class=&quot;issue-link&quot; data-issue-key=&quot;NUTCH-2603&quot;&gt;&lt;del&gt;NUTCH-2603&lt;/del&gt;&lt;/a&gt;), the parser signals success and returns a document with no/empty content. The behavior is different when called on a local file: while the &lt;a href=&quot;https://docs.oracle.com/javase/8/docs/api/java/util/zip/ZipFile.html#ZipFile-java.io.File-&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;constructor of ZipFile&lt;/a&gt; fails on invalid input, the &lt;a href=&quot;https://docs.oracle.com/javase/8/docs/api/java/util/zip/ZipInputStream.html#ZipInputStream-java.io.InputStream-&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;constructor of ZipInputStream&lt;/a&gt; silently ignores the input.&lt;/p&gt;
</description>
                <environment></environment>
        <key id="13167184">TIKA-2675</key>
            <summary>OpenDocumentParser should fail on invalid zip files</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tallison">Tim Allison</assignee>
                                    <reporter username="snagel">Sebastian Nagel</reporter>
                        <labels>
                    </labels>
                <created>Wed, 20 Jun 2018 15:04:42 +0000</created>
                <updated>Fri, 6 Jul 2018 15:25:25 +0000</updated>
                            <resolved>Fri, 6 Jul 2018 13:23:25 +0000</resolved>
                                    <version>1.18</version>
                                    <fixVersion>1.19</fixVersion>
                    <fixVersion>2.0.0</fixVersion>
                                    <component>parser</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="16518281" author="githubbot" created="Wed, 20 Jun 2018 15:33:11 +0000"  >&lt;p&gt;sebastian-nagel opened a new pull request #240: &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2675&quot; title=&quot;OpenDocumentParser should fail on invalid zip files&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2675&quot;&gt;&lt;del&gt;TIKA-2675&lt;/del&gt;&lt;/a&gt; OpenDocumentParser should fail on invalid zip files&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/tika/pull/240&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/pull/240&lt;/a&gt;&lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;throw IOException if ZipInputStream is invalid or does not contain any entries&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   Note: now the behavior on empty zip files is different, if called on a local file (succeeds, empty document) or not (fails). The OpenDocument format spec (&lt;span class=&quot;error&quot;&gt;&amp;#91;section 17.2&amp;#93;&lt;/span&gt;(&lt;a href=&quot;http://docs.oasis-open.org/office/v1.1/OS/OpenDocument-v1.1.pdf&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://docs.oasis-open.org/office/v1.1/OS/OpenDocument-v1.1.pdf&lt;/a&gt;), cf. &lt;span class=&quot;error&quot;&gt;&amp;#91;wikipedia article&amp;#93;&lt;/span&gt;(&lt;a href=&quot;https://en.wikipedia.org/wiki/OpenDocument_technical_specification#Format_internals&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://en.wikipedia.org/wiki/OpenDocument_technical_specification#Format_internals&lt;/a&gt;)) does not state anything about empty zip files.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16534789" author="githubbot" created="Fri, 6 Jul 2018 12:57:58 +0000"  >&lt;p&gt;tballison closed pull request #240: &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2675&quot; title=&quot;OpenDocumentParser should fail on invalid zip files&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2675&quot;&gt;&lt;del&gt;TIKA-2675&lt;/del&gt;&lt;/a&gt; OpenDocumentParser should fail on invalid zip files&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/tika/pull/240&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/pull/240&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;This is a PR merged from a forked repository.&lt;br/&gt;
As GitHub hides the original diff on merge, it is displayed below for&lt;br/&gt;
the sake of provenance:&lt;/p&gt;

&lt;p&gt;As this is a foreign pull request (from a fork), the diff is supplied&lt;br/&gt;
below (as it won&apos;t show otherwise due to GitHub magic):&lt;/p&gt;

&lt;p&gt;diff --git a/tika-parsers/src/main/java/org/apache/tika/parser/odf/OpenDocumentParser.java b/tika-parsers/src/main/java/org/apache/tika/parser/odf/OpenDocumentParser.java&lt;br/&gt;
index e7eb76ab8..7ed77fbc1 100644&lt;br/&gt;
&amp;#8212; a/tika-parsers/src/main/java/org/apache/tika/parser/odf/OpenDocumentParser.java&lt;br/&gt;
+++ b/tika-parsers/src/main/java/org/apache/tika/parser/odf/OpenDocumentParser.java&lt;br/&gt;
@@ -26,6 +26,7 @@&lt;br/&gt;
 import java.util.HashSet;&lt;br/&gt;
 import java.util.Set;&lt;br/&gt;
 import java.util.zip.ZipEntry;&lt;br/&gt;
+import java.util.zip.ZipException;&lt;br/&gt;
 import java.util.zip.ZipFile;&lt;br/&gt;
 import java.util.zip.ZipInputStream;&lt;/p&gt;

&lt;p&gt;@@ -175,10 +176,13 @@ public void parse(&lt;/p&gt;

&lt;p&gt;     private void handleZipStream(ZipInputStream zipStream, Metadata metadata, ParseContext context, EndDocumentShieldingContentHandler handler) throws IOException, TikaException, SAXException {&lt;br/&gt;
         ZipEntry entry = zipStream.getNextEntry();&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;while (entry != null) 
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {+		if (entry == null) {
+			throw new IOException(&quot;No entries found in ZipInputStream&quot;);
+		}+        do {
             handleZipEntry(entry, zipStream, metadata, context, handler);
             entry = zipStream.getNextEntry();
-        }+        }&lt;/span&gt; &lt;/div&gt;
&lt;p&gt; while (entry != null);&lt;br/&gt;
     }&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     private void handleZipFile(ZipFile zipFile, Metadata metadata,&lt;br/&gt;
diff --git a/tika-parsers/src/test/java/org/apache/tika/parser/odf/ODFParserTest.java b/tika-parsers/src/test/java/org/apache/tika/parser/odf/ODFParserTest.java&lt;br/&gt;
index d1ec46e94..ba6c0ca11 100644&lt;br/&gt;
&amp;#8212; a/tika-parsers/src/test/java/org/apache/tika/parser/odf/ODFParserTest.java&lt;br/&gt;
+++ b/tika-parsers/src/test/java/org/apache/tika/parser/odf/ODFParserTest.java&lt;br/&gt;
@@ -19,6 +19,7 @@&lt;br/&gt;
 import static org.junit.Assert.assertEquals;&lt;br/&gt;
 import static org.junit.Assert.assertTrue;&lt;/p&gt;

&lt;p&gt;+import java.io.IOException;&lt;br/&gt;
 import java.io.InputStream;&lt;br/&gt;
 import java.util.List;&lt;/p&gt;

&lt;p&gt;@@ -406,6 +407,28 @@ public void testEmbedded() throws Exception &lt;/p&gt;
{
         assertEquals(3, metadataList.size());
     }

&lt;p&gt;+    @Test(expected = IOException.class)&lt;br/&gt;
+    public void testInvalidFromStream() throws Exception {&lt;br/&gt;
+        try (InputStream is = this.getClass().getResource(&lt;br/&gt;
+                &quot;/test-documents/testODTnotaZipFile.odt&quot;).openStream()) &lt;/p&gt;
{
+            OpenDocumentParser parser = new OpenDocumentParser();
+            Metadata metadata = new Metadata();
+            ContentHandler handler = new BodyContentHandler();
+            parser.parse(is, handler, metadata, new ParseContext());
+        }
&lt;p&gt;+    }&lt;br/&gt;
+&lt;br/&gt;
+    @Test(expected = IOException.class)&lt;br/&gt;
+    public void testInvalidFromFile() throws Exception {&lt;br/&gt;
+        try (TikaInputStream tis = TikaInputStream.get(this.getClass().getResource(&lt;br/&gt;
+                &quot;/test-documents/testODTnotaZipFile.odt&quot;))) &lt;/p&gt;
{
+            OpenDocumentParser parser = new OpenDocumentParser();
+            Metadata metadata = new Metadata();
+            ContentHandler handler = new BodyContentHandler();
+            parser.parse(tis, handler, metadata, new ParseContext());
+        }
&lt;p&gt;+    }&lt;br/&gt;
+&lt;br/&gt;
     private ParseContext getNonRecursingParseContext() {&lt;br/&gt;
         ParseContext parseContext = new ParseContext();&lt;br/&gt;
         parseContext.set(Parser.class, new EmptyParser());&lt;br/&gt;
diff --git a/tika-parsers/src/test/resources/test-documents/testODTnotaZipFile.odt b/tika-parsers/src/test/resources/test-documents/testODTnotaZipFile.odt&lt;br/&gt;
new file mode 100644&lt;br/&gt;
index 000000000..9c1d376f0&lt;br/&gt;
&amp;#8212; /dev/null&lt;br/&gt;
+++ b/tika-parsers/src/test/resources/test-documents/testODTnotaZipFile.odt&lt;br/&gt;
@@ -0,0 +1 @@&lt;br/&gt;
+This is not a zip file!&lt;/p&gt;




&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16534813" author="tallison@mitre.org" created="Fri, 6 Jul 2018 13:23:25 +0000"  >&lt;p&gt;Thank you &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=wastl-nagel&quot; class=&quot;user-hover&quot; rel=&quot;wastl-nagel&quot;&gt;wastl-nagel&lt;/a&gt;!&lt;/p&gt;</comment>
                            <comment id="16534858" author="hudson" created="Fri, 6 Jul 2018 14:25:22 +0000"  >&lt;p&gt;SUCCESS: Integrated in Jenkins build Tika-trunk #1516 (See &lt;a href=&quot;https://builds.apache.org/job/Tika-trunk/1516/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Tika-trunk/1516/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2675&quot; title=&quot;OpenDocumentParser should fail on invalid zip files&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2675&quot;&gt;&lt;del&gt;TIKA-2675&lt;/del&gt;&lt;/a&gt; &amp;#8211; OpenDocumentParser should fail on invalid zip via Sebastian (tallison: &lt;a href=&quot;https://github.com/apache/tika/commit/c9a81a400ee10e9342bbfe718d62f0b0d6c7944f&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/c9a81a400ee10e9342bbfe718d62f0b0d6c7944f&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/odf/OpenDocumentParser.java&lt;/li&gt;
	&lt;li&gt;(add) tika-parsers/src/test/resources/test-documents/testODTnotaZipFile.odt&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/test/java/org/apache/tika/parser/odf/ODFParserTest.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="16534958" author="hudson" created="Fri, 6 Jul 2018 15:09:32 +0000"  >&lt;p&gt;UNSTABLE: Integrated in Jenkins build tika-2.x-windows #281 (See &lt;a href=&quot;https://builds.apache.org/job/tika-2.x-windows/281/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/tika-2.x-windows/281/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2675&quot; title=&quot;OpenDocumentParser should fail on invalid zip files&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2675&quot;&gt;&lt;del&gt;TIKA-2675&lt;/del&gt;&lt;/a&gt; &amp;#8211; OpenDocumentParser should fail on invalid zip via Sebastian (tallison: rev c9a81a400ee10e9342bbfe718d62f0b0d6c7944f)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(add) tika-parsers/src/test/resources/test-documents/testODTnotaZipFile.odt&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/odf/OpenDocumentParser.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/test/java/org/apache/tika/parser/odf/ODFParserTest.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="16534990" author="hudson" created="Fri, 6 Jul 2018 15:25:25 +0000"  >&lt;p&gt;SUCCESS: Integrated in Jenkins build tika-branch-1x #55 (See &lt;a href=&quot;https://builds.apache.org/job/tika-branch-1x/55/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/tika-branch-1x/55/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2675&quot; title=&quot;OpenDocumentParser should fail on invalid zip files&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2675&quot;&gt;&lt;del&gt;TIKA-2675&lt;/del&gt;&lt;/a&gt; OpenDocumentParser should fail on invalid zip files - throw (snagel: &lt;a href=&quot;https://github.com/apache/tika/commit/def58f6e84de61031212ae40714e02f05d3c19fc&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/def58f6e84de61031212ae40714e02f05d3c19fc&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) tika-parsers/src/test/java/org/apache/tika/parser/odf/ODFParserTest.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/odf/OpenDocumentParser.java&lt;/li&gt;
	&lt;li&gt;(add) tika-parsers/src/test/resources/test-documents/testODTnotaZipFile.odt&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 19 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3v1zj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>