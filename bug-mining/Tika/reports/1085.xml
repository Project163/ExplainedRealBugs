<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:02:24 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[TIKA-2601] Invalid XHTML output (overlapping a and formatting tags) for some WORD documents</title>
                <link>https://issues.apache.org/jira/browse/TIKA-2601</link>
                <project id="12310631" key="TIKA">Tika</project>
                    <description>&lt;p&gt;In some WORD (.doc, .docx) documents the XHTML elements are not closed properly. This usually happens when there are link elements (&amp;lt;a&amp;gt;) as well as italic or bold elements (&amp;lt;b&amp;gt;&amp;lt;i&amp;gt;).&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Fix should be done in &lt;a href=&quot;https://github.com/apache/tika/blob/master/tika-parsers/src/main/java/org/apache/tika/parser/microsoft/WordExtractor.java&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/blob/master/tika-parsers/src/main/java/org/apache/tika/parser/microsoft/WordExtractor.java&lt;/a&gt;&lt;/p&gt;</description>
                <environment>&lt;p&gt;Linked is a sample document with its corresponding output.&lt;/p&gt;</environment>
        <key id="13143288">TIKA-2601</key>
            <summary>Invalid XHTML output (overlapping a and formatting tags) for some WORD documents</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="grossws">Konstantin Gribov</assignee>
                                    <reporter username="Fila">Filip</reporter>
                        <labels>
                    </labels>
                <created>Wed, 7 Mar 2018 18:14:32 +0000</created>
                <updated>Mon, 12 Apr 2021 12:59:07 +0000</updated>
                            <resolved>Tue, 23 Apr 2019 13:45:34 +0000</resolved>
                                    <version>1.17</version>
                                    <fixVersion>2.0.0</fixVersion>
                    <fixVersion>1.21</fixVersion>
                                    <component>parser</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="16434996" author="funbit" created="Thu, 12 Apr 2018 06:18:32 +0000"  >&lt;p&gt;We are experiencing the same issue.&lt;/p&gt;

&lt;p&gt;Just in case, here is another doc file that produces invalid XML output.&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12918683/12918683_Invalid-XML.doc&quot; title=&quot;Invalid-XML.doc attached to TIKA-2601&quot;&gt;Invalid-XML.doc&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;&lt;/p&gt;</comment>
                            <comment id="16810313" author="grossws" created="Thu, 4 Apr 2019 21:38:45 +0000"  >&lt;p&gt;I mark it as duplicate for &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2555&quot; title=&quot;Text with [underline] + [another format] in word document generates overlapping html tags.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2555&quot;&gt;&lt;del&gt;TIKA-2555&lt;/del&gt;&lt;/a&gt; which I&apos;m currently looking into&lt;/p&gt;</comment>
                            <comment id="16810640" author="funbit" created="Fri, 5 Apr 2019 09:20:22 +0000"  >&lt;p&gt;Just in case, want to mention that&#160;this ticket does not seem to be a duplicate for &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2555&quot; title=&quot;Text with [underline] + [another format] in word document generates overlapping html tags.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2555&quot;&gt;&lt;del&gt;TIKA-2555&lt;/del&gt;&lt;/a&gt;, because here we have incorrectly opened/closed A and B HTML tags, rather than a simple B and U overlap. For example, the attached &quot;Invalid-XML.doc&quot; document produces the following XML output:&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;&amp;lt;p class=&quot;tOC_1&quot;&amp;gt;*&lt;b&gt;&lt;font color=&quot;#ff0000&quot;&gt;&amp;lt;b&amp;gt;&lt;/font&gt;&lt;/b&gt;*2&amp;lt;a href=&quot;_Toc531413823&quot;&lt;font color=&quot;#FF0000&quot;&gt;&lt;b&gt;/&amp;gt;&lt;/b&gt;&lt;/font&gt;&amp;lt;b&amp;gt;&amp;lt;u&amp;gt;1. &#12497;&#12483;&#12465;&#12540;&#12472;&#12477;&#12501;&#12488;&#12454;&#12455;&#12450;&#25552;&#26696;&amp;lt;/u&amp;gt;&lt;/tt&gt;&lt;br/&gt;
 &lt;tt&gt;&amp;lt;/b&amp;gt;&lt;b&gt;&lt;font color=&quot;#ff0000&quot;&gt;&amp;lt;/a&amp;gt;&lt;/font&gt;&lt;/b&gt;&amp;lt;b&amp;gt;&amp;lt;u&amp;gt;&lt;/tt&gt;&lt;br/&gt;
 &lt;tt&gt;&amp;lt;/u&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;/p&amp;gt;&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;Hope it will help to narrow down the issue.&lt;/p&gt;</comment>
                            <comment id="16823255" author="hudson" created="Mon, 22 Apr 2019 17:15:03 +0000"  >&lt;p&gt;SUCCESS: Integrated in Jenkins build tika-branch-1x #178 (See &lt;a href=&quot;https://builds.apache.org/job/tika-branch-1x/178/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/tika-branch-1x/178/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2601&quot; title=&quot;Invalid XHTML output (overlapping a and formatting tags) for some WORD documents&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2601&quot;&gt;&lt;del&gt;TIKA-2601&lt;/del&gt;&lt;/a&gt; &amp;#8211; fixed overlapping tags in WordExtractor (doc parser) (grossws: &lt;a href=&quot;https://github.com/apache/tika/commit/55c573b58507e00a554bbd42b9c78274cfb60113&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/55c573b58507e00a554bbd42b9c78274cfb60113&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/microsoft/WordExtractor.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/microsoft/FormattingUtils.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/test/java/org/apache/tika/parser/microsoft/WordParserTest.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="16823279" author="hudson" created="Mon, 22 Apr 2019 17:47:55 +0000"  >&lt;p&gt;SUCCESS: Integrated in Jenkins build Tika-trunk #1645 (See &lt;a href=&quot;https://builds.apache.org/job/Tika-trunk/1645/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Tika-trunk/1645/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2601&quot; title=&quot;Invalid XHTML output (overlapping a and formatting tags) for some WORD documents&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2601&quot;&gt;&lt;del&gt;TIKA-2601&lt;/del&gt;&lt;/a&gt; &amp;#8211; fixed overlapping tags in WordExtractor (doc parser) (grossws: &lt;a href=&quot;https://github.com/apache/tika/commit/90e31600755c5abb67e247ea9112203bc9e9561b&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/90e31600755c5abb67e247ea9112203bc9e9561b&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) tika-parsers/src/test/java/org/apache/tika/parser/microsoft/WordParserTest.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/microsoft/FormattingUtils.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/microsoft/WordExtractor.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="16823285" author="hudson" created="Mon, 22 Apr 2019 17:50:02 +0000"  >&lt;p&gt;UNSTABLE: Integrated in Jenkins build tika-2.x-windows #401 (See &lt;a href=&quot;https://builds.apache.org/job/tika-2.x-windows/401/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/tika-2.x-windows/401/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2601&quot; title=&quot;Invalid XHTML output (overlapping a and formatting tags) for some WORD documents&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2601&quot;&gt;&lt;del&gt;TIKA-2601&lt;/del&gt;&lt;/a&gt; &amp;#8211; fixed overlapping tags in WordExtractor (doc parser) (grossws: rev 90e31600755c5abb67e247ea9112203bc9e9561b)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/microsoft/FormattingUtils.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/test/java/org/apache/tika/parser/microsoft/WordParserTest.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/microsoft/WordExtractor.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="16858341" author="funbit" created="Fri, 7 Jun 2019 06:42:28 +0000"  >&lt;p&gt;Just in case, I can confirm that the issue (reproduced in the&#160;&lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12918683/12918683_Invalid-XML.doc&quot; title=&quot;Invalid-XML.doc attached to TIKA-2601&quot;&gt;Invalid-XML.doc&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;) has been fixed in the Tika App 1.21.&lt;/p&gt;

&lt;p&gt;Thank you!&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13067720">TIKA-2347</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13133752">TIKA-2555</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12918683" name="Invalid-XML.doc" size="37888" author="Funbit" created="Thu, 12 Apr 2018 06:18:01 +0000"/>
                            <attachment id="12913415" name="Test.doc" size="60928" author="Fila" created="Wed, 7 Mar 2018 18:13:38 +0000"/>
                            <attachment id="12913414" name="test.html" size="3166" author="Fila" created="Wed, 7 Mar 2018 18:13:37 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 23 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3qzzz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>