<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:01:15 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[TIKA-2434] Language detection slow, cpu intensive, CLI interrupts work</title>
                <link>https://issues.apache.org/jira/browse/TIKA-2434</link>
                <project id="12310631" key="TIKA">Tika</project>
                    <description>&lt;p&gt;Since version 1.16, when using tika -l FILE, it takes a lot longer than e.g. 1.15.&lt;/p&gt;

&lt;p&gt;Also, when batch processing a bunch of files in the background, the Java runtime icon pops up when processing the next file, stealing the input focus from whatever other application I&apos;m currently working on, thus constantly interrupting my work.&lt;/p&gt;

&lt;p&gt;Also, the Java runtime uses from 100% to 400% CPU when executing Tika.&lt;/p&gt;</description>
                <environment>&lt;p&gt;OS X 10.11.6, JRE 1.8.0_25&lt;/p&gt;</environment>
        <key id="13090552">TIKA-2434</key>
            <summary>Language detection slow, cpu intensive, CLI interrupts work</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="StefanKah">Stefan Karner</reporter>
                        <labels>
                    </labels>
                <created>Thu, 27 Jul 2017 16:14:32 +0000</created>
                <updated>Tue, 29 Oct 2019 15:52:18 +0000</updated>
                                            <version>1.16</version>
                                                    <component>cli</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="16104806" author="tallison@mitre.org" created="Fri, 28 Jul 2017 11:17:25 +0000"  >&lt;blockquote&gt;&lt;p&gt;Also, when batch processing a bunch of files in the background, the Java runtime icon pops up when processing the next file, stealing the input focus from whatever other application I&apos;m currently working on, thus constantly interrupting my work.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Is this with tika-batch: e.g. java -jar tika-app.jar -i &amp;lt;input_dir&amp;gt; -o &amp;lt;output_dir&amp;gt; ?&lt;/p&gt;

&lt;p&gt;I haven&apos;t seen this, but try: -Djava.awt.headless=true and/or -JDjava.awt.headless=true&lt;/p&gt;
</comment>
                            <comment id="16104810" author="tallison@mitre.org" created="Fri, 28 Jul 2017 11:20:00 +0000"  >&lt;blockquote&gt;&lt;p&gt;Also, the Java runtime uses from 100% to 400% CPU when executing Tika.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;If you&apos;re using tika-batch, as in the commandline above, that&apos;s the intended behavior.  By default, tika-batch uses 1-number of cpus available on your machine.  You can set the number of threads Tika app is using with -numConsumers.&lt;/p&gt;</comment>
                            <comment id="16106403" author="stefankah" created="Sun, 30 Jul 2017 09:33:07 +0000"  >&lt;p&gt;Hello Tim,&lt;/p&gt;

&lt;p&gt;thanks for your reply.&lt;/p&gt;

&lt;p&gt;Additional information about my installation:&lt;br/&gt;
Tika is installed via Homebrew packet manager.&lt;br/&gt;
The tika shell script that is included contains&lt;/p&gt;

&lt;p&gt;exec java  -jar /usr/local/Cellar/tika/1.16/libexec/tika-app-1.16.jar &quot;$@&quot;&lt;/p&gt;

&lt;p&gt;1) the additional parameter &quot;-Djava.awt.headless=true&quot; you suggested not only prevents the Java runtime from popping up, but also dramatically reduces processing time of most files, eg. previously &lt;br/&gt;
OpenOffice Text document, german, 1 page -&amp;gt; Language is detected as &quot;de&quot; after one second, but then it takes another 9 minutes 50 seconds until tika finishes. With the added parameter, tika finishes after one second.&lt;/p&gt;

&lt;p&gt;So I would suggest modifying the shell script to include this parameter in the distribution. &lt;/p&gt;

&lt;p&gt;2) For PDF files, the delay is obviously caused by now having automatic OCR image processing enabled. Tika CLI 1.16 outputs a message &quot;INFO  As a convenience, TikaCLI has turned on extraction of&lt;br/&gt;
inline images for the PDFParser (&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2374&quot; title=&quot;Tika App -z should extract PDF inline images by default&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2374&quot;&gt;TIKA-2374&lt;/a&gt;).&quot;&lt;/p&gt;

&lt;p&gt;IMO, changing this default is not a &quot;convenience&quot;, but rather a really bad idea; the only kind of PDF where this default makes sense to me is for those that do not already have a text layer.&lt;/p&gt;

&lt;p&gt;After I figured out how to disable this by passing a config file to the CLI (I would consider myself a &quot;Power User&quot; at best), I tested the time needed to detect the document language:&lt;/p&gt;

&lt;p&gt;PDF book, english, 559 pp., existing text layer&lt;/p&gt;

&lt;p&gt;CLI 1.16 default: 201m56.334s&lt;br/&gt;
CLI 1.16 no OCR: 2s&lt;/p&gt;

&lt;p&gt;I especially don&apos;t understand the reasoning behind this change, as I encountered a Tika documentation page where the previous setting was argumented with the delays and problems it might cause (and, given the issues I encountered, rightly so).&lt;/p&gt;

&lt;p&gt;Thanks,&lt;br/&gt;
Stefan&lt;/p&gt;</comment>
                            <comment id="16109266" author="tallison@mitre.org" created="Tue, 1 Aug 2017 16:44:53 +0000"  >&lt;p&gt;1) Great!  &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=chrismattmann&quot; class=&quot;user-hover&quot; rel=&quot;chrismattmann&quot;&gt;chrismattmann&lt;/a&gt;, recommendations for adding headless to the brew script?  Can anyone see any fall-out from running tika in headless mode?  I should probably run tika headless against our regression corpus to see if there are any diffs.&lt;/p&gt;

&lt;p&gt;2) In &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2374&quot; title=&quot;Tika App -z should extract PDF inline images by default&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2374&quot;&gt;TIKA-2374&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=nick&quot; class=&quot;user-hover&quot; rel=&quot;nick&quot;&gt;nick&lt;/a&gt; requested that this be added for -z option.  However, I thought it would be bizarre for a user to be able to extract all images, but then not get text via OCR on those images.  &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=nick&quot; class=&quot;user-hover&quot; rel=&quot;nick&quot;&gt;nick&lt;/a&gt;, should I back-off and do just this: extract inline images only for -z but not for text extraction?  Or, should we leave this as is?  &lt;/p&gt;

&lt;p&gt;So that I understand, you want to run OCR on regular &quot;attachment&quot; images inside PDFs but not on their inline images?&lt;/p&gt;</comment>
                            <comment id="16109908" author="chrismattmann" created="Tue, 1 Aug 2017 22:32:36 +0000"  >&lt;p&gt;Tim, for #1, once you know how it runs against the regression corpus, we can open a PR in homebrew-core and get it updated.&lt;/p&gt;</comment>
                            <comment id="16120263" author="chrismattmann" created="Wed, 9 Aug 2017 17:07:00 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tallison%40apache.org&quot; class=&quot;user-hover&quot; rel=&quot;tallison@apache.org&quot;&gt;tallison@apache.org&lt;/a&gt; ping&lt;/p&gt;</comment>
                            <comment id="16121527" author="tallison@mitre.org" created="Thu, 10 Aug 2017 12:18:11 +0000"  >&lt;p&gt;Laptop had to be re-imaged...just getting dev environment back up and running...prob next week.&lt;/p&gt;</comment>
                            <comment id="16123028" author="stefankah" created="Fri, 11 Aug 2017 08:26:37 +0000"  >&lt;p&gt;Tim,&lt;/p&gt;

&lt;p&gt;&lt;cite&gt;So that I understand, you want to run OCR on regular &quot;attachment&quot; images inside PDFs but not on their inline images&lt;/cite&gt;?&lt;/p&gt;

&lt;p&gt;In case this question was directed at me, could you explain the difference between &quot;attachment&quot; and &quot;inline&quot; images as I am not aware of this. &lt;/p&gt;
</comment>
                            <comment id="16123186" author="tallison@mitre.org" created="Fri, 11 Aug 2017 11:03:12 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=StefanKah&quot; class=&quot;user-hover&quot; rel=&quot;StefanKah&quot;&gt;StefanKah&lt;/a&gt;, yep, sorry, that question was for you.&lt;/p&gt;

&lt;p&gt;PDFs, like MSOffice files and MSG files, can contain attachments.  These &quot;regular&quot; attachments often are represented by an icon somewhere for MSOffice/MSG; for PDFs, in Acrobat Reader, there&apos;s a pane for regular attachments.  Users can attach a Word file or a zip file or a jpeg or anything else to a PDF.&lt;/p&gt;

&lt;p&gt;Inline attachments are image files that are used to render the page or parts of the page; rather than an icon, the application renders the image.  Inline attachments are far, far more common in PDFs than regular attachments.&lt;/p&gt;</comment>
                            <comment id="16130791" author="stefankah" created="Thu, 17 Aug 2017 16:43:30 +0000"  >&lt;p&gt;Tim, thank you for the explanation.&lt;/p&gt;

&lt;p&gt;This seems to be a misunderstanding. My workflows have processed several thousand PDFs, and as far as I know, they are all files with a text layer and inline images, but no attachments&lt;/p&gt;

&lt;p&gt;I have no need to do any OCR on the files with Tesseract through Tika; when the PDF has no text layer, I OCR it with Abbyy Finereader.&lt;/p&gt;</comment>
                            <comment id="16131250" author="hudson" created="Thu, 17 Aug 2017 20:30:49 +0000"  >&lt;p&gt;ABORTED: Integrated in Jenkins build Tika-trunk #1344 (See &lt;a href=&quot;https://builds.apache.org/job/Tika-trunk/1344/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Tika-trunk/1344/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2374&quot; title=&quot;Tika App -z should extract PDF inline images by default&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2374&quot;&gt;TIKA-2374&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2434&quot; title=&quot;Language detection slow, cpu intensive, CLI interrupts work&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2434&quot;&gt;TIKA-2434&lt;/a&gt; - roll back extracting inline images for pdfs in (tallison: &lt;a href=&quot;https://github.com/apache/tika/commit/10baddcc15501c196dccf956463e607d9973c403&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/10baddcc15501c196dccf956463e607d9973c403&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) tika-app/src/main/java/org/apache/tika/cli/TikaCLI.java&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2434&quot; title=&quot;Language detection slow, cpu intensive, CLI interrupts work&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2434&quot;&gt;TIKA-2434&lt;/a&gt; add headless mode to tika-batch (tallison: &lt;a href=&quot;https://github.com/apache/tika/commit/79c52ed71b0928cabf0cc351167da9dfe954ed0f&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/79c52ed71b0928cabf0cc351167da9dfe954ed0f&lt;/a&gt;)&lt;/li&gt;
	&lt;li&gt;(edit) tika-app/src/main/java/org/apache/tika/cli/BatchCommandLineBuilder.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="16133464" author="tallison@mitre.org" created="Fri, 18 Aug 2017 18:54:22 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=chrismattmann&quot; class=&quot;user-hover&quot; rel=&quot;chrismattmann&quot;&gt;chrismattmann&lt;/a&gt;, I ran regression tests against 500k files headless vs regular. No diffs. I updated tika-app to include headless when calling child process in batch mode.  If you have a chance, brew script can be updated.&lt;/p&gt;</comment>
                            <comment id="16133468" author="chris.a.mattmann@jpl.nasa.gov" created="Fri, 18 Aug 2017 18:56:00 +0000"  >&lt;p&gt;Hi Everyone,&lt;/p&gt;


&lt;p&gt;I will be on paternity leave beginning Friday August 18 returning to work Monday September 18th.&lt;/p&gt;


&lt;p&gt;During this time, email can be used for emergencies.&lt;/p&gt;


&lt;p&gt;Thank you.&lt;/p&gt;


&lt;p&gt;Cheers,&lt;/p&gt;

&lt;p&gt;Chris Mattmann&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 13 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3i3gn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>