<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:02:58 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[TIKA-3030] XLS files with a root node named WORKBOOK don&apos;t get parsed</title>
                <link>https://issues.apache.org/jira/browse/TIKA-3030</link>
                <project id="12310631" key="TIKA">Tika</project>
                    <description>&lt;p&gt;I have an XLS file where the root node contains 2 top-level names - &quot;WORKBOOK&quot; and &quot; SummaryInformation&quot;.&lt;/p&gt;

&lt;p&gt;The type gets properly detected as &quot;application/vnd.ms-excel&quot;, because the POIFSContainerDetector does a check like so:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;if (names.contains(&quot;Workbook&quot;) || names.contains(&quot;WORKBOOK&quot;)) {
    ...
}&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;However, the ExcelExtractor silently rejects the file because the root node doesn&apos;t contain a top level node named &quot;Workbook&quot;.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13282032">TIKA-3030</key>
            <summary>XLS files with a root node named WORKBOOK don&apos;t get parsed</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tallison">Tim Allison</assignee>
                                    <reporter username="clarkperkins">Clark Perkins</reporter>
                        <labels>
                    </labels>
                <created>Tue, 28 Jan 2020 18:37:27 +0000</created>
                <updated>Thu, 30 Jan 2020 14:10:51 +0000</updated>
                            <resolved>Wed, 29 Jan 2020 14:37:59 +0000</resolved>
                                    <version>1.23</version>
                                    <fixVersion>1.24</fixVersion>
                                    <component>parser</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="17025472" author="tallison@mitre.org" created="Tue, 28 Jan 2020 22:27:04 +0000"  >&lt;p&gt;Thank you for raising this issue.&#160; As you point out, the fix is easy.&#160; Are you able to share the triggering file with us?&#160; I&apos;d be curious to see if it was actually created by Microsoft or by another tool...perhaps something in the metadata?&#160; This is pure curiosity and nothing to do with the fix.&lt;/p&gt;</comment>
                            <comment id="17025477" author="clarkperkins" created="Tue, 28 Jan 2020 22:34:24 +0000"  >&lt;p&gt;Thank you for your quick response! &#160;I can&apos;t share whole file unfortunately - it&apos;s confidential data. &#160;But looking in the metadata, the creator is listed as &quot;Crystal Decisions&quot;.&lt;/p&gt;</comment>
                            <comment id="17025586" author="gagravarr" created="Wed, 29 Jan 2020 05:06:15 +0000"  >&lt;p&gt;Pretty sure we&apos;ve got a test file in Apache POI like this - some third party tools generate with the wrong name. I&apos;ve got a feeling that &lt;tt&gt;WORKBOOK_in_capitals.xls&lt;/tt&gt; will be one such file, but I&apos;m on the wrong device to check right now!&lt;/p&gt;

&lt;p&gt;See &lt;a href=&quot;https://github.com/apache/poi/blob/trunk/src/java/org/apache/poi/hssf/model/InternalWorkbook.java#L93&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/poi/blob/trunk/src/java/org/apache/poi/hssf/model/InternalWorkbook.java#L93&lt;/a&gt; for the list of well-ish known variants&lt;/p&gt;</comment>
                            <comment id="17025928" author="tallison@mitre.org" created="Wed, 29 Jan 2020 14:37:09 +0000"  >&lt;p&gt;Thank you &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=nick&quot; class=&quot;user-hover&quot; rel=&quot;nick&quot;&gt;nick&lt;/a&gt;!&#160; And, y, &quot;Crystal Decisions&quot; is also &lt;tt&gt;WORKBOOK_in_capitals.xls&lt;/tt&gt;&lt;/p&gt;</comment>
                            <comment id="17025958" author="hudson" created="Wed, 29 Jan 2020 15:17:24 +0000"  >&lt;p&gt;SUCCESS: Integrated in Jenkins build tika-branch-1x #300 (See &lt;a href=&quot;https://builds.apache.org/job/tika-branch-1x/300/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/tika-branch-1x/300/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-3030&quot; title=&quot;XLS files with a root node named WORKBOOK don&amp;#39;t get parsed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-3030&quot;&gt;&lt;del&gt;TIKA-3030&lt;/del&gt;&lt;/a&gt; &amp;#8211; allow for more flexibility in the naming of the workbook (tallison: &lt;a href=&quot;https://github.com/apache/tika/commit/320d7281f28051e11b6df02e5a97df61bcc8716f&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/320d7281f28051e11b6df02e5a97df61bcc8716f&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) tika-parsers/src/test/java/org/apache/tika/parser/microsoft/ExcelParserTest.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/microsoft/ExcelExtractor.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/microsoft/POIFSContainerDetector.java&lt;/li&gt;
	&lt;li&gt;(add) tika-parsers/src/test/resources/test-documents/testEXCEL_WORKBOOK_in_capitals.xls&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/microsoft/SummaryExtractor.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="17026011" author="hudson" created="Wed, 29 Jan 2020 16:25:06 +0000"  >&lt;p&gt;SUCCESS: Integrated in Jenkins build Tika-trunk #1766 (See &lt;a href=&quot;https://builds.apache.org/job/Tika-trunk/1766/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Tika-trunk/1766/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-3030&quot; title=&quot;XLS files with a root node named WORKBOOK don&amp;#39;t get parsed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-3030&quot;&gt;&lt;del&gt;TIKA-3030&lt;/del&gt;&lt;/a&gt; &amp;#8211; allow for more flexibility in the naming of the workbook (tallison: &lt;a href=&quot;https://github.com/apache/tika/commit/1ebc5f83d74969287616d0200b5a3f6a79785965&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/1ebc5f83d74969287616d0200b5a3f6a79785965&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/microsoft/ExcelExtractor.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/test/java/org/apache/tika/parser/microsoft/ExcelParserTest.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/microsoft/POIFSContainerDetector.java&lt;/li&gt;
	&lt;li&gt;(add) tika-parsers/src/test/resources/test-documents/testEXCEL_WORKBOOK_in_capitals.xls&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/microsoft/SummaryExtractor.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="17026712" author="clarkperkins" created="Thu, 30 Jan 2020 14:10:51 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tallison&quot; class=&quot;user-hover&quot; rel=&quot;tallison&quot;&gt;tallison&lt;/a&gt;, is there a planned release date for 1.24?  Just wondering when we&apos;ll be able to pick up a released version with this fix.  Thanks again for picking this up so quickly!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 41 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0axz4:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>