<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:03:35 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[TIKA-3516] Unexpected charset IBM424_rtl detected for  utf_8  file by CharsetDetector</title>
                <link>https://issues.apache.org/jira/browse/TIKA-3516</link>
                <project id="12310631" key="TIKA">Tika</project>
                    <description>&lt;p&gt;Hi,&lt;br/&gt;
 The CharsetDetector detects the wrong charset for a file as IBM424_rtl.&#160;&lt;br/&gt;
 Resulting in exception&#160;&lt;/p&gt;

&lt;p&gt;&lt;b&gt;&lt;em&gt;java.nio.charset.UnsupportedCharsetException: IBM424_rtl 17 at java.nio.charset.Charset.forName(Charset.java:531)&lt;/em&gt;&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;I see there is also an existing ticket with the same issue thats not been fixed.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2396&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/TIKA-2396&lt;/a&gt;&lt;br/&gt;
 Please suggest the changes to fix this.&#160;&lt;/p&gt;

&lt;p&gt;Versions being used:&lt;/p&gt;

&lt;p&gt;apache-core - 1.20&lt;br/&gt;
apache-parsers-1.20&lt;/p&gt;

&lt;p&gt;Thanks&lt;/p&gt;</description>
                <environment></environment>
        <key id="13393954">TIKA-3516</key>
            <summary>Unexpected charset IBM424_rtl detected for  utf_8  file by CharsetDetector</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tallison">Tim Allison</assignee>
                                    <reporter username="crajappa">Chaitra Rajappa</reporter>
                        <labels>
                    </labels>
                <created>Fri, 6 Aug 2021 17:41:41 +0000</created>
                <updated>Sun, 22 May 2022 13:23:28 +0000</updated>
                            <resolved>Tue, 17 Aug 2021 15:21:58 +0000</resolved>
                                                    <fixVersion>2.1.0</fixVersion>
                                    <component>detector</component>
                    <component>parser</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="17394999" author="tallison@mitre.org" created="Fri, 6 Aug 2021 22:01:07 +0000"  >&lt;p&gt;Thank you for linking this to the earlier issue.  It isn&apos;t clear to me what the correct fix for this is: &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2396?focusedCommentId=16051854&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-16051854&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/TIKA-2396?focusedCommentId=16051854&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-16051854&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Obviously, &quot;get it right&quot; is the desired outcome, but charset detection relying on probabilistic models will be wrong, especially on short files.&lt;/p&gt;

&lt;p&gt;You can change the order of charset detectors if that would help you for your use cases?&lt;/p&gt;</comment>
                            <comment id="17395000" author="tallison@mitre.org" created="Fri, 6 Aug 2021 22:02:59 +0000"  >&lt;p&gt;Do you want us to fallback to utf8 if the detected charset isn&apos;t supported?&lt;/p&gt;

&lt;p&gt;See also: &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1236&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/TIKA-1236&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17395013" author="crajappa" created="Fri, 6 Aug 2021 23:20:57 +0000"  >&lt;p&gt;I have referred the other ticket link since there was not solution to what can be done in the ticket I wanted to know if you have a plan of action for such cases.&#160;&lt;/p&gt;


&lt;p&gt;&lt;em&gt;You can change the order of charset detectors if that would help you for your use cases?&lt;/em&gt;&#160;&lt;/p&gt;

&lt;p&gt;You mentioned the above line, can you tell me how would this help?&lt;/p&gt;

&lt;p&gt;&#160;&lt;br/&gt;
&#160;&lt;/p&gt;</comment>
                            <comment id="17395038" author="tallison@mitre.org" created="Sat, 7 Aug 2021 01:13:43 +0000"  >&lt;p&gt;Right. There was no solution after I asked for feedback and didn&#8217;t receive any.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;How this would help&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;In some use cases; it is better to rely on the icu detector rather than mozilla &lt;/p&gt;</comment>
                            <comment id="17400426" author="tallison@mitre.org" created="Tue, 17 Aug 2021 14:18:19 +0000"  >&lt;p&gt;I took some time to dig into this.  There are two problems.&lt;/p&gt;

&lt;p&gt;1) The Icu4jEncodingDetector&apos;s CharsetMatch actually has code to strip off the *_rtl and *_ltr in its #getString().  In other words, the developers of the Icu4jEncodingDetector knew that you couldn&apos;t plop the CharsetMatch.getName() directly into a charset...the user had to strip off the _rtl or _ltr from some charsets.  I added a &quot;getNormalizedName()&quot; that takes on the burden of stripping those markers.  &lt;/p&gt;

&lt;p&gt;So, that&apos;s all for the good, however...&lt;br/&gt;
2) Now on the test file from &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2396&quot; title=&quot;Unexpected charset detected for a plain text file by CharsetDetector&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2396&quot;&gt;TIKA-2396&lt;/a&gt;, the charset is converted to IBM424, and complete junk is yielded for that test file.  So, I added the ability to ignore specific charsets.  I experimented with a confidence value, but that wasn&apos;t extremely informative.  Unless there&apos;s a better alternative, users for now can turn off detection of IBM424 with:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;&amp;lt;properties&amp;gt;
    &amp;lt;parsers&amp;gt;
        &amp;lt;parser class=&quot;org.apache.tika.parser.DefaultParser&quot;/&amp;gt;
    &amp;lt;/parsers&amp;gt;
    &amp;lt;encodingDetectors&amp;gt;
        &amp;lt;encodingDetector class=&quot;org.apache.tika.parser.html.HTMLEncodingDetector&quot;/&amp;gt;
        &amp;lt;encodingDetector class=&quot;org.apache.tika.parser.txt.Icu4jEncodingDetector&quot;&amp;gt;
            &amp;lt;params&amp;gt;
                &amp;lt;param name=&quot;ignoreCharsets&quot; type=&quot;list&quot;&amp;gt;
                    &amp;lt;string&amp;gt;IBM424&amp;lt;/string&amp;gt;
                &amp;lt;/param&amp;gt;
            &amp;lt;/params&amp;gt;
        &amp;lt;/encodingDetector&amp;gt;
        &amp;lt;encodingDetector class=&quot;org.apache.tika.parser.txt.UniversalEncodingDetector&quot;/&amp;gt;
    &amp;lt;/encodingDetectors&amp;gt;
&amp;lt;/properties&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17400453" author="tallison@mitre.org" created="Tue, 17 Aug 2021 15:21:58 +0000"  >&lt;p&gt;I&apos;ve gotten no feedback on the original issue or on this one for how to solve the problem.  Please re-open if you have a different preferred solution.&lt;/p&gt;</comment>
                            <comment id="17400530" author="hudson" created="Tue, 17 Aug 2021 17:52:33 +0000"  >&lt;p&gt;ABORTED: Integrated in Jenkins build Tika &#187; tika-main-jdk8 #310 (See &lt;a href=&quot;https://ci-builds.apache.org/job/Tika/job/tika-main-jdk8/310/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://ci-builds.apache.org/job/Tika/job/tika-main-jdk8/310/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-3516&quot; title=&quot;Unexpected charset IBM424_rtl detected for  utf_8  file by CharsetDetector&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-3516&quot;&gt;&lt;del&gt;TIKA-3516&lt;/del&gt;&lt;/a&gt; &amp;#8211; strip _rtl _ltr in CharsetMatch and enable turning off specific encodings. (tallison: &lt;a href=&quot;https://github.com/apache/tika/commit/11f807fd61242de9d7f963fde3ae79210b9ad750&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/11f807fd61242de9d7f963fde3ae79210b9ad750&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(add) tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-text-module/src/test/resources/test-documents/testIgnoreCharset.txt&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-text-module/src/main/java/org/apache/tika/parser/txt/Icu4jEncodingDetector.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-text-module/src/test/java/org/apache/tika/parser/txt/CharsetDetectorTest.java&lt;/li&gt;
	&lt;li&gt;(add) tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-text-module/src/test/resources/test-configs/tika-config-ignore-charset.xml&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-text-module/src/main/java/org/apache/tika/parser/txt/CharsetMatch.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="17540594" author="lfcnassif" created="Sun, 22 May 2022 13:23:28 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tallison&quot; class=&quot;user-hover&quot; rel=&quot;tallison&quot;&gt;tallison&lt;/a&gt;,&lt;/p&gt;

&lt;p&gt;I also got some html and eml html bodies being wrongly detected as IBM420 or IBM424 when upgrading to Tika-2.4.0. I tried above configuration to exclude those charsets from detection, but then parsing fails with &quot;TikaException: Failed to detect the character encoding of a document&quot; thrown by AutoDetectReader line 132. If I comment out the &quot;params&quot; section in above configuration, parsing exception goes away, but of course the encoding is wrongly detected. Any idea?&lt;/p&gt;

&lt;p&gt;Another question, what txt charset detector take precedence by default Icu4jEncodingDetector or UniversalEncodingDetector? I would like to configure the same order used by 1.x for now.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12694417">TIKA-1236</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                            <outwardlinks description="depends upon">
                                        <issuelink>
            <issuekey id="13395529">TIKA-3525</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 24 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0toow:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>