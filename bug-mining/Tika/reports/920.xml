<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:01:08 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[TIKA-1945] Powerpoint parser doesn&apos;t extract text from diagrams</title>
                <link>https://issues.apache.org/jira/browse/TIKA-1945</link>
                <project id="12310631" key="TIKA">Tika</project>
                    <description>&lt;p&gt;Attached is an example org chart that Tika doesn&apos;t extract text from&lt;/p&gt;</description>
                <environment></environment>
        <key id="12957492">TIKA-1945</key>
            <summary>Powerpoint parser doesn&apos;t extract text from diagrams</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tallison">Tim Allison</assignee>
                                    <reporter username="nicholasc">Nick C</reporter>
                        <labels>
                    </labels>
                <created>Sun, 10 Apr 2016 00:37:33 +0000</created>
                <updated>Tue, 29 Oct 2019 15:52:21 +0000</updated>
                            <resolved>Fri, 9 Jun 2017 01:48:46 +0000</resolved>
                                    <version>1.12</version>
                                    <fixVersion>1.16</fixVersion>
                                    <component>parser</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="15233797" author="nicholasc" created="Sun, 10 Apr 2016 00:42:30 +0000"  >&lt;p&gt;Also while looking in to the code I noticed AbstractOOXMLExtractor.getXHTML passes the content handler to handleEmbeddedParts and handleThumbnail instead of the XHTMLContentHandler that is passed to buildXHTML If that&apos;s a bug I can create another jira ticket&lt;/p&gt;</comment>
                            <comment id="16042794" author="oytun" created="Thu, 8 Jun 2017 14:44:06 +0000"  >&lt;p&gt;This is a confirmed issue for 1.15 as well. `./ppt/diagrams/*.xml` files are not processed. If there is a quick work around this, we would like to do it. This is currently a production issue for us.&lt;/p&gt;</comment>
                            <comment id="16042834" author="oytun" created="Thu, 8 Jun 2017 15:16:16 +0000"  >&lt;p&gt;I believe this may be due to XSLFRelation from Apache POI not providing a relation for `./ppt/diagram` directory.&lt;/p&gt;

&lt;p&gt;If one of the Tika or POI developers can give us clues on how to solve this the fastest -as we are not familiar with the code base, that would be fantastic! &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;There is a similar issue in POI bug database: &lt;a href=&quot;https://bz.apache.org/bugzilla/show_bug.cgi?id=57596&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://bz.apache.org/bugzilla/show_bug.cgi?id=57596&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16042865" author="gagravarr" created="Thu, 8 Jun 2017 15:35:39 +0000"  >&lt;p&gt;A small sample file we can use for unit testing is needed, one per affected format, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=oytun&quot; class=&quot;user-hover&quot; rel=&quot;oytun&quot;&gt;oytun&lt;/a&gt; if you could create some that&apos;ll help us help you!&lt;/p&gt;</comment>
                            <comment id="16042877" author="oytun" created="Thu, 8 Jun 2017 15:37:18 +0000"  >&lt;p&gt;Doing this right away, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=nick&quot; class=&quot;user-hover&quot; rel=&quot;nick&quot;&gt;nick&lt;/a&gt;, thank you for looking into this.&lt;/p&gt;</comment>
                            <comment id="16042882" author="oytun" created="Thu, 8 Jun 2017 15:42:37 +0000"  >&lt;p&gt;Sample files for unit tests for issue &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1945&quot; title=&quot;Powerpoint parser doesn&amp;#39;t extract text from diagrams&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1945&quot;&gt;&lt;del&gt;TIKA-1945&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="16042887" author="oytun" created="Thu, 8 Jun 2017 15:43:37 +0000"  >&lt;p&gt;Attached 2 sample files for .docx and .pptx. If you need anything else, let me know.&lt;/p&gt;</comment>
                            <comment id="16043325" author="tallison@mitre.org" created="Thu, 8 Jun 2017 19:58:27 +0000"  >&lt;p&gt;Working version of patch handles .docx/pptx/xlsx/xlsb.  It does not handle .doc/ppt/xls.  Will commit tonight or tomorrow.&lt;/p&gt;</comment>
                            <comment id="16043520" author="oytun" created="Thu, 8 Jun 2017 22:02:16 +0000"  >&lt;p&gt;Sounds great, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tallison%40mitre.org&quot; class=&quot;user-hover&quot; rel=&quot;tallison@mitre.org&quot;&gt;tallison@mitre.org&lt;/a&gt;, thank you for taking this so quickly. Looking forward to the commit.&lt;/p&gt;

&lt;p&gt;Are you working on dev or will this patch be available for 1.15 release?&lt;/p&gt;</comment>
                            <comment id="16043571" author="gagravarr" created="Thu, 8 Jun 2017 22:49:49 +0000"  >&lt;p&gt;I don&apos;t know exactly what Tim&apos;ll do, but assuming it&apos;s similar to what I&apos;d try... It&apos;ll almost certainly need some changes to both Apache POI and Apache Tika, and therefore need to wait for a POI release then a Tika 1.16 release. The patches will be open source, so you&apos;d be most welcome to do a custom local build until then, but it wouldn&apos;t be in an official release for a few months&lt;/p&gt;</comment>
                            <comment id="16043724" author="hudson" created="Fri, 9 Jun 2017 00:31:07 +0000"  >&lt;p&gt;FAILURE: Integrated in Jenkins build Tika-trunk #1288 (See &lt;a href=&quot;https://builds.apache.org/job/Tika-trunk/1288/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Tika-trunk/1288/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1945&quot; title=&quot;Powerpoint parser doesn&amp;#39;t extract text from diagrams&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1945&quot;&gt;&lt;del&gt;TIKA-1945&lt;/del&gt;&lt;/a&gt; &amp;#8211; extract text from diagrams in ooxml files. (tallison: &lt;a href=&quot;https://github.com/apache/tika/commit/7842600560e02a4fd213d175301b4397bbe030a3&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/7842600560e02a4fd213d175301b4397bbe030a3&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(add) tika-parsers/src/test/resources/test-documents/testEXCEL_diagramData.xlsb&lt;/li&gt;
	&lt;li&gt;(add) tika-parsers/src/test/resources/test-documents/testPPT_diagramData.pptx&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/microsoft/ooxml/XWPFWordExtractorDecorator.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/test/java/org/apache/tika/parser/microsoft/ooxml/SXSLFExtractorTest.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/microsoft/ooxml/OOXMLExtractorFactory.java&lt;/li&gt;
	&lt;li&gt;(add) tika-parsers/src/test/resources/test-documents/testEXCEL_diagramData.xlsx&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/test/java/org/apache/tika/parser/microsoft/ooxml/OOXMLParserTest.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/microsoft/ooxml/AbstractOOXMLExtractor.java&lt;/li&gt;
	&lt;li&gt;(add) tika-parsers/src/test/resources/test-documents/testWORD_diagramData.docx&lt;/li&gt;
	&lt;li&gt;(edit) CHANGES.txt&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/microsoft/ooxml/SXSLFPowerPointExtractorDecorator.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/microsoft/ooxml/XSSFExcelExtractorDecorator.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/microsoft/ooxml/XSLFPowerPointExtractorDecorator.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/microsoft/ooxml/SXWPFWordExtractorDecorator.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/test/java/org/apache/tika/parser/microsoft/ooxml/SXWPFExtractorTest.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/microsoft/ooxml/XSSFBExcelExtractorDecorator.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="16043795" author="tallison@mitre.org" created="Fri, 9 Jun 2017 01:48:46 +0000"  >&lt;p&gt;I used the SAX handler I wrote for pptx/docx body parts.  &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=nick&quot; class=&quot;user-hover&quot; rel=&quot;nick&quot;&gt;nick&lt;/a&gt;, let me know what you think. &lt;/p&gt;

&lt;p&gt;There are some things we should put in POI, like the relationships...anything else?&lt;/p&gt;</comment>
                            <comment id="16048227" author="oytun" created="Tue, 13 Jun 2017 18:40:53 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tallison%40mitre.org&quot; class=&quot;user-hover&quot; rel=&quot;tallison@mitre.org&quot;&gt;tallison@mitre.org&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=nick&quot; class=&quot;user-hover&quot; rel=&quot;nick&quot;&gt;nick&lt;/a&gt;, I confirm that the commit below has fixed the SmartArt text issue. We will continue using `master` rather than the latest release until v1.6 is released.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/tika/commit/7842600560e02a4fd213d175301b4397bbe030a3&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/7842600560e02a4fd213d175301b4397bbe030a3&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16048233" author="tallison@mitre.org" created="Tue, 13 Jun 2017 18:44:50 +0000"  >&lt;p&gt;Great.  Thank you for the feedback!&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13038460">TIKA-2254</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12797893" name="Diagram.pptx" size="48793" author="nicholasc" created="Sun, 10 Apr 2016 00:38:17 +0000"/>
                            <attachment id="12872087" name="TIKA-1945.docx" size="49860" author="oytun" created="Thu, 8 Jun 2017 15:42:37 +0000"/>
                            <attachment id="12872088" name="TIKA-1945.pptx" size="39966" author="oytun" created="Thu, 8 Jun 2017 15:42:37 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 22 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2vw3z:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>