<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:05:34 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[TIKA-4432] Issue with EMF Parser Merging Header, Page Number, and First Content Word During Extraction</title>
                <link>https://issues.apache.org/jira/browse/TIKA-4432</link>
                <project id="12310631" key="TIKA">Tika</project>
                    <description>&lt;p&gt;It appears that the EMF parser is incorrectly combining multiple elements during text extraction. Specifically, information from the document header, the page number, and the first word of the main content are being merged into a single word.&lt;/p&gt;

&lt;p&gt;Also attaching the extracted content in txt file and original emf file.&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/13076820/13076820_102+emffile.EMF_extracted_with_issue.jpg&quot; height=&quot;190&quot; width=&quot;794&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13620036">TIKA-4432</key>
            <summary>Issue with EMF Parser Merging Header, Page Number, and First Content Word During Extraction</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="aashishtudu11">Aashish Tudu</reporter>
                        <labels>
                    </labels>
                <created>Wed, 4 Jun 2025 10:10:48 +0000</created>
                <updated>Thu, 19 Jun 2025 13:27:32 +0000</updated>
                            <resolved>Tue, 17 Jun 2025 17:25:15 +0000</resolved>
                                                    <fixVersion>4.0.0</fixVersion>
                    <fixVersion>3.2.1</fixVersion>
                                    <component>parser</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="17956084" author="githubbot" created="Wed, 4 Jun 2025 11:35:43 +0000"  >&lt;p&gt;aashishtudu opened a new pull request, #2241:&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/tika/pull/2241&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/pull/2241&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;   It appears that the EMF parser is incorrectly combining multiple elements during text extraction. Specifically, information from the document header, the page number, and the first word of the main content are being merged into a single word.&lt;/p&gt;

&lt;p&gt;   The issue stems from how text fragments (EmfExtTextOutW records) are appended to a buffer. In cases where the EMF text does not include a trailing space, the next fragment gets concatenated directly without separation. The logic in PR ensures that if a text fragment does not end with a space, an explicit space is added between it and the next fragment.&lt;/p&gt;

</comment>
                            <comment id="17956092" author="githubbot" created="Wed, 4 Jun 2025 12:18:23 +0000"  >&lt;p&gt;aashishtudu closed pull request #2241: &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-4432&quot; title=&quot;Issue with EMF Parser Merging Header, Page Number, and First Content Word During Extraction&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-4432&quot;&gt;&lt;del&gt;TIKA-4432&lt;/del&gt;&lt;/a&gt;-Issue with EMF Parser Merging Header, Page Number, and First Content Word During Extraction&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/tika/pull/2241&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/pull/2241&lt;/a&gt;&lt;/p&gt;

</comment>
                            <comment id="17956099" author="tallison@mitre.org" created="Wed, 4 Jun 2025 12:37:09 +0000"  >&lt;p&gt;The challenge with this emf is that the reference for all the text chunks is 0,0, and the bounds are all 0,0,0,0. &lt;/p&gt;

&lt;p&gt;This image is rendered correctly in at least LibreOffices&apos; Draw, and, I&apos;d guess, the microsoft tools as well.&lt;/p&gt;

&lt;p&gt;There are bounds that we could use in the &quot;boundsIgnored&quot; field within the emftext, but the spec says to ignore that info. There&apos;s also location info in the modifyWorldTransform records that come before the exttextoutw records.&lt;/p&gt;

&lt;p&gt;Maybe fall back to the boundsIgnored if the reference and bounds are all zeroes?&lt;/p&gt;</comment>
                            <comment id="17956100" author="tallison@mitre.org" created="Wed, 4 Jun 2025 12:40:43 +0000"  >&lt;p&gt;Don&apos;t know if &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kiwiwings&quot; class=&quot;user-hover&quot; rel=&quot;kiwiwings&quot;&gt;kiwiwings&lt;/a&gt; might have a chance to look at this?&lt;/p&gt;</comment>
                            <comment id="17956153" author="JIRAUSER309894" created="Wed, 4 Jun 2025 16:36:45 +0000"  >&lt;p&gt;Yes, The image is rendered correctly in Microsoft tools and online EMF viewers. We could try falling back to &quot;boundsIgnored&quot; ,when both reference and bounds are zero. It might be a bit of a spec violation, but it can be a workaround for malformed EMFs.&lt;/p&gt;</comment>
                            <comment id="17980461" author="tallison@mitre.org" created="Tue, 17 Jun 2025 17:25:15 +0000"  >&lt;p&gt;I added backoff to use the coordinates that should be ignored. I also added text extraction for ascii text parts.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Overall, our emf parsing is a big hack, but better than nothing?&lt;/p&gt;

&lt;p&gt;Thank you, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=aashishtudu11&quot; class=&quot;user-hover&quot; rel=&quot;aashishtudu11&quot;&gt;aashishtudu11&lt;/a&gt; for opening this issue and sharing a file that we could use to develop and test the fix!&lt;/p&gt;</comment>
                            <comment id="17980480" author="hudson" created="Tue, 17 Jun 2025 18:53:26 +0000"  >&lt;p&gt;SUCCESS: Integrated in Jenkins build Tika &#187; tika-main-jdk17 #771 (See &lt;a href=&quot;https://ci-builds.apache.org/job/Tika/job/tika-main-jdk17/771/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://ci-builds.apache.org/job/Tika/job/tika-main-jdk17/771/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-4432&quot; title=&quot;Issue with EMF Parser Merging Header, Page Number, and First Content Word During Extraction&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-4432&quot;&gt;&lt;del&gt;TIKA-4432&lt;/del&gt;&lt;/a&gt; (#2255) (github: &lt;a href=&quot;https://github.com/apache/tika/commit/5586d2ed0188d406209191828e8a7b217db11a3b&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/5586d2ed0188d406209191828e8a7b217db11a3b&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-microsoft-module/src/main/java/org/apache/tika/parser/microsoft/EMFParser.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-microsoft-module/src/test/java/org/apache/tika/parser/microsoft/EMFParserTest.java&lt;/li&gt;
	&lt;li&gt;(add) tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-microsoft-module/src/test/resources/test-documents/testEMF_zero_coords.emf&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="17980493" author="hudson" created="Tue, 17 Jun 2025 19:45:11 +0000"  >&lt;p&gt;SUCCESS: Integrated in Jenkins build Tika &#187; tika-branch_3x-jdk11 #2079 (See &lt;a href=&quot;https://ci-builds.apache.org/job/Tika/job/tika-branch_3x-jdk11/2079/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://ci-builds.apache.org/job/Tika/job/tika-branch_3x-jdk11/2079/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-4432&quot; title=&quot;Issue with EMF Parser Merging Header, Page Number, and First Content Word During Extraction&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-4432&quot;&gt;&lt;del&gt;TIKA-4432&lt;/del&gt;&lt;/a&gt; (#2255) (tallison: &lt;a href=&quot;https://github.com/apache/tika/commit/c6bf92dce2f250b560634cf95bdb2fa6697f5b13&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/c6bf92dce2f250b560634cf95bdb2fa6697f5b13&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(add) tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-microsoft-module/src/test/resources/test-documents/testEMF_zero_coords.emf&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-microsoft-module/src/test/java/org/apache/tika/parser/microsoft/EMFParserTest.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-microsoft-module/src/main/java/org/apache/tika/parser/microsoft/EMFParser.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13621337">TIKA-4439</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="13076819" name="102 emffile.EMF" size="19264" author="aashishtudu11" created="Wed, 4 Jun 2025 10:09:49 +0000"/>
                            <attachment id="13076821" name="102 emffile.EMF_extracted_with_fix.jpg" size="128779" author="aashishtudu11" created="Wed, 4 Jun 2025 11:44:22 +0000"/>
                            <attachment id="13076822" name="102 emffile.EMF_extracted_with_fix.txt" size="345" author="aashishtudu11" created="Wed, 4 Jun 2025 11:44:20 +0000"/>
                            <attachment id="13076820" name="102 emffile.EMF_extracted_with_issue.jpg" size="149779" author="aashishtudu11" created="Wed, 4 Jun 2025 10:11:19 +0000"/>
                            <attachment id="13076818" name="102 emffile.EMF_extracted_with_issue.txt" size="340" author="aashishtudu11" created="Wed, 4 Jun 2025 10:09:50 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            20 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1w6jc:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>