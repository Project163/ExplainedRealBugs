<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:00:58 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[TIKA-2300] Can&apos;t tell if a zip file is encrypted</title>
                <link>https://issues.apache.org/jira/browse/TIKA-2300</link>
                <project id="12310631" key="TIKA">Tika</project>
                    <description>&lt;p&gt;When Tika processes a zip file that is protected with a password, it will return the list of file names within the zip but no indication (as an exception or in metadata) that the file is encrypted. &lt;/p&gt;

&lt;p&gt;From stepping through the code, I can see that the information needed to determine whether the archive is encrypted is available inside ZipArchiveEntry#getGeneralPurposeBit#usesEncryption, but needs to be relayed back to PackageParser somehow&lt;/p&gt;</description>
                <environment></environment>
        <key id="13056259">TIKA-2300</key>
            <summary>Can&apos;t tell if a zip file is encrypted</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tallison">Tim Allison</assignee>
                                    <reporter username="aeham.abushwashi">Aeham Abushwashi</reporter>
                        <labels>
                    </labels>
                <created>Wed, 15 Mar 2017 11:13:33 +0000</created>
                <updated>Mon, 12 Apr 2021 13:01:51 +0000</updated>
                            <resolved>Tue, 21 Mar 2017 19:23:54 +0000</resolved>
                                    <version>1.14</version>
                                    <fixVersion>1.15</fixVersion>
                    <fixVersion>2.0.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="15925964" author="aeham.abushwashi" created="Wed, 15 Mar 2017 11:46:08 +0000"  >&lt;p&gt;The attached file can be used to repro. It is protected with a password, &quot;password123&quot;, using ZipCrypto&lt;/p&gt;</comment>
                            <comment id="15928069" author="aeham.abushwashi" created="Thu, 16 Mar 2017 13:55:24 +0000"  >&lt;p&gt;Here&apos;s a first stab at a patch for discussion....&lt;br/&gt;
PackageParser can easily figure out if the zip is encrypted (albeit with an ugly cast!). I figured users may not always want the PackageParser to abandon processing encrypted zip files and opted for adding a metadata flag to indicate the file is encrypted. This maintains backwards compatibility with &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1028&quot; title=&quot;Tika-server quits parsing of rfc-822 document prematurely when it encounters encrypted zip file as attachment.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1028&quot;&gt;&lt;del&gt;TIKA-1028&lt;/del&gt;&lt;/a&gt;, but is it consistent with how Tika reports &lt;em&gt;partial&lt;/em&gt; success/failure elsewhere?&lt;br/&gt;
Also... the change made me realise the rich metadata extracted by the PackageParser for the compressed/inner files never finds its way back up to users through the metadata object. Is this by design?&lt;/p&gt;</comment>
                            <comment id="15928108" author="tallison@mitre.org" created="Thu, 16 Mar 2017 14:05:38 +0000"  >&lt;p&gt;Thank you!  I&apos;ll take a look soon.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;the change made me realise the rich metadata extracted by the PackageParser for the compressed/inner files never finds its way back up to users through the metadata object. Is this by design?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Via classic Tika, y, this is what happened.  This is exactly why I integrated &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jukkaz&quot; class=&quot;user-hover&quot; rel=&quot;jukkaz&quot;&gt;jukkaz&lt;/a&gt;&apos;s and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=nick&quot; class=&quot;user-hover&quot; rel=&quot;nick&quot;&gt;nick&lt;/a&gt;&apos;s RecursiveParserWrapper to maintain metadata of embedded files.  Give it a try with &quot;-J -t&quot; from the commandline with tika-app or try &quot;/rmeta&quot; if you&apos;re using tika-server.&lt;/p&gt;</comment>
                            <comment id="15932027" author="aeham.abushwashi" created="Sun, 19 Mar 2017 23:29:29 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tallison%40mitre.org&quot; class=&quot;user-hover&quot; rel=&quot;tallison@mitre.org&quot;&gt;tallison@mitre.org&lt;/a&gt;, RecursiveParserWrapper solves the embedded metadata problem nicely!&lt;br/&gt;
Any thoughts on the draft patch for the encryption issue?&lt;/p&gt;</comment>
                            <comment id="15932587" author="tallison@mitre.org" created="Mon, 20 Mar 2017 12:52:10 +0000"  >&lt;p&gt;Will take a look today.  Too many spinning plates.  Thank you.&lt;/p&gt;</comment>
                            <comment id="15935155" author="tallison@mitre.org" created="Tue, 21 Mar 2017 19:23:54 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=aeham.abushwashi&quot; class=&quot;user-hover&quot; rel=&quot;aeham.abushwashi&quot;&gt;aeham.abushwashi&lt;/a&gt; I added a stacktrace to the parent&apos;s metadata object for encrypted files, or for any stream that can&apos;t be read.&lt;/p&gt;

&lt;p&gt;Going forward, it will be helpful to figure out how to determine a) encryption (for non-zip) files or b) other reasons that a stream might not be readable.&lt;/p&gt;

&lt;p&gt;For now, the embedded exception is an encryption exception for your test stream and a general TikaException for any other reason that a package stream can&apos;t be read.&lt;/p&gt;

&lt;p&gt;Thank you for the issue and the patch!&lt;/p&gt;</comment>
                            <comment id="15935191" author="hudson" created="Tue, 21 Mar 2017 19:49:01 +0000"  >&lt;p&gt;SUCCESS: Integrated in Jenkins build Tika-trunk #1224 (See &lt;a href=&quot;https://builds.apache.org/job/Tika-trunk/1224/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Tika-trunk/1224/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2300&quot; title=&quot;Can&amp;#39;t tell if a zip file is encrypted&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2300&quot;&gt;&lt;del&gt;TIKA-2300&lt;/del&gt;&lt;/a&gt; include exception for streams that can&apos;t be read in pkg parser (tallison: &lt;a href=&quot;https://github.com/apache/tika/commit/f55b87fc5cb91a9e9ee067e3c1c68dff691d48a5&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/f55b87fc5cb91a9e9ee067e3c1c68dff691d48a5&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(add) tika-parsers/src/test/resources/test-documents/testZipEncrypted.zip&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/test/java/org/apache/tika/parser/pkg/ZipParserTest.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/pkg/PackageParser.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15935309" author="hudson" created="Tue, 21 Mar 2017 20:47:30 +0000"  >&lt;p&gt;SUCCESS: Integrated in Jenkins build tika-2.x #229 (See &lt;a href=&quot;https://builds.apache.org/job/tika-2.x/229/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/tika-2.x/229/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2300&quot; title=&quot;Can&amp;#39;t tell if a zip file is encrypted&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2300&quot;&gt;&lt;del&gt;TIKA-2300&lt;/del&gt;&lt;/a&gt; record streams that can&apos;t be read via pkg&apos;s metadata via Aeham (tallison: rev 29d7d7ceb30cc74afcb35a0b9497c7e4a0668eee)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) tika-parser-modules/tika-parser-package-module/src/test/java/org/apache/tika/parser/pkg/ZipParserTest.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parser-modules/tika-parser-package-module/src/main/java/org/apache/tika/parser/pkg/PackageParser.java&lt;/li&gt;
	&lt;li&gt;(add) tika-test-resources/src/test/resources/test-documents/testZipEncrypted.zip&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15935555" author="hudson" created="Tue, 21 Mar 2017 23:46:01 +0000"  >&lt;p&gt;SUCCESS: Integrated in Jenkins build tika-2.x-windows #181 (See &lt;a href=&quot;https://builds.apache.org/job/tika-2.x-windows/181/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/tika-2.x-windows/181/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2300&quot; title=&quot;Can&amp;#39;t tell if a zip file is encrypted&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2300&quot;&gt;&lt;del&gt;TIKA-2300&lt;/del&gt;&lt;/a&gt; record streams that can&apos;t be read via pkg&apos;s metadata via Aeham (tallison: rev 29d7d7ceb30cc74afcb35a0b9497c7e4a0668eee)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) tika-parser-modules/tika-parser-package-module/src/main/java/org/apache/tika/parser/pkg/PackageParser.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parser-modules/tika-parser-package-module/src/test/java/org/apache/tika/parser/pkg/ZipParserTest.java&lt;/li&gt;
	&lt;li&gt;(add) tika-test-resources/src/test/resources/test-documents/testZipEncrypted.zip&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15935610" author="aeham.abushwashi" created="Wed, 22 Mar 2017 01:15:15 +0000"  >&lt;p&gt;Thank you &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tallison%40mitre.org&quot; class=&quot;user-hover&quot; rel=&quot;tallison@mitre.org&quot;&gt;tallison@mitre.org&lt;/a&gt;!&lt;/p&gt;</comment>
                            <comment id="15936153" author="tallison@mitre.org" created="Wed, 22 Mar 2017 11:34:58 +0000"  >&lt;p&gt;Thank you &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=aeham.abushwashi&quot; class=&quot;user-hover&quot; rel=&quot;aeham.abushwashi&quot;&gt;aeham.abushwashi&lt;/a&gt;!  Please let us know what else you find...esp with the other flavors of streams.&lt;/p&gt;

&lt;p&gt;The reporting method I used is what we&apos;re also now using in the case that an embedded stream has some other type of exception before the stream hits the embedded parser (this happened fairly often with images inside ppt, IIRC).&lt;/p&gt;

&lt;p&gt;Also, let us know how the RecursiveParserWrapper is working out.  It breaks one of Tika&apos;s core original goals streaming reads/streaming writes, but I think it is critical for some use cases to maintain metadata from embedded files.&lt;/p&gt;

&lt;p&gt;Cheers!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12859096" name="TIKA-2300.patch" size="4658" author="aeham.abushwashi" created="Thu, 16 Mar 2017 13:55:24 +0000"/>
                            <attachment id="12858867" name="encrypted_file.zip" size="8900" author="aeham.abushwashi" created="Wed, 15 Mar 2017 11:46:08 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 34 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3car3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>