<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:02:03 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[TIKA-2703] Error indexing a xlsx file</title>
                <link>https://issues.apache.org/jira/browse/TIKA-2703</link>
                <project id="12310631" key="TIKA">Tika</project>
                    <description>&lt;p&gt;Hallo.&lt;/p&gt;

&lt;p&gt;Indexing a xlsx file of 38 MB&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;I obtain the error:&lt;br/&gt;
Error from server at &lt;a href=&quot;http://localhost:8983/solr/core_share:&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://localhost:8983/solr/core_share:&lt;/a&gt; Expected mime type application/xml but got text/html. &amp;lt;html&amp;gt; &amp;lt;head&amp;gt; &amp;lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html;charset=utf-8&quot;/&amp;gt; &amp;lt;title&amp;gt;Error 500 Server Error&amp;lt;/title&amp;gt; &amp;lt;/head&amp;gt; &amp;lt;body&amp;gt;&amp;lt;h2&amp;gt;HTTP ERROR 500&amp;lt;/h2&amp;gt; &amp;lt;p&amp;gt;Problem accessing /solr/core_share/update/extract. Reason: &amp;lt;pre&amp;gt; Server Error&amp;lt;/pre&amp;gt;&amp;lt;/p&amp;gt;&amp;lt;h3&amp;gt;Caused by:&amp;lt;/h3&amp;gt;&amp;lt;pre&amp;gt;java.lang.OutOfMemoryError at java.base/java.lang.AbstractStringBuilder.hugeCapacity(AbstractStringBuilder.java:188) at java.base/java.lang.AbstractStringBuilder.newCapacity(AbstractStringBuilder.java:180) at java.base/java.lang.AbstractStringBuilder.ensureCapacityInternal(AbstractStringBuilder.java:147) at java.base/java.lang.AbstractStringBuilder.append(AbstractStringBuilder.java:660) at java.base/java.lang.StringBuilder.append(StringBuilder.java:195) at org.apache.solr.handler.extraction.SolrContentHandler.characters(SolrContentHandler.java:302) at org.apache.tika.sax.ContentHandlerDecorator.characters(ContentHandlerDecorator.java:146) at org.apache.tika.sax.SecureContentHandler.characters(SecureContentHandler.java:270) at org.apache.tika.sax.ContentHandlerDecorator.characters(ContentHandlerDecorator.java:146) at org.apache.tika.sax.ContentHandlerDecorator.characters(ContentHandlerDecorator.java:146) at org.apache.tika.sax.ContentHandlerDecorator.characters(ContentHandlerDecorator.java:146) at org.apache.tika.sax.SafeContentHandler.access$001(SafeContentHandler.java:46) at org.apache.tika.sax.SafeContentHandler$1.write(SafeContentHandler.java:82) at org.apache.tika.sax.SafeContentHandler.filter(SafeContentHandler.java:140) at org.apache.tika.sax.SafeContentHandler.characters(SafeContentHandler.java:287) at org.apache.tika.sax.XHTMLContentHandler.characters(XHTMLContentHandler.java:279) at org.apache.tika.sax.XHTMLContentHandler.characters(XHTMLContentHandler.java:306) at org.apache.tika.parser.microsoft.ooxml.OOXMLTikaBodyPartHandler.run(OOXMLTikaBodyPartHandler.java:147) at org.apache.tika.parser.microsoft.ooxml.OOXMLWordAndPowerPointTextHandler.handleEndOfRun(OOXMLWordAndPowerPointTextHandler.java:468) at org.apache.tika.parser.microsoft.ooxml.OOXMLWordAndPowerPointTextHandler.endElement(OOXMLWordAndPowerPointTextHandler.java:450) at org.apache.tika.sax.ContentHandlerDecorator.endElement(ContentHandlerDecorator.java:136) at org.apache.tika.sax.ContentHandlerDecorator.endElement(ContentHandlerDecorator.java:136) at java.xml/com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.endElement(AbstractSAXParser.java:609) at java.xml/com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanEndElement(XMLDocumentFragmentScannerImpl.java:1714) at java.xml/com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$FragmentContentDriver.next(XMLDocumentFragmentScannerImpl.java:2879) at java.xml/com.sun.org.apache.xerces.internal.impl.XMLDocumentScannerImpl.next(XMLDocumentScannerImpl.java:602) at java.xml/com.sun.org.apache.xerces.internal.impl.XMLNSDocumentScannerImpl.next(XMLNSDocumentScannerImpl.java:112) at java.xml/com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanDocument(XMLDocumentFragmentScannerImpl.java:532) at java.xml/com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:888) at java.xml/com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:824) at java.xml/com.sun.org.apache.xerces.internal.parsers.XMLParser.parse(XMLParser.java:141) at java.xml/com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.parse(AbstractSAXParser.java:1213) at java.xml/com.sun.org.apache.xerces.internal.jaxp.SAXParserImpl$JAXPSAXParser.parse(SAXParserImpl.java:635) at java.xml/com.sun.org.apache.xerces.internal.jaxp.SAXParserImpl.parse(SAXParserImpl.java:324) at java.xml/javax.xml.parsers.SAXParser.parse(SAXParser.java:197) at org.apache.tika.parser.microsoft.ooxml.AbstractOOXMLExtractor.handleGeneralTextContainingPart(AbstractOOXMLExtractor.java:506) at org.apache.tika.parser.microsoft.ooxml.XSSFExcelExtractorDecorator.processShapes(XSSFExcelExtractorDecorator.java:279) at org.apache.tika.parser.microsoft.ooxml.XSSFExcelExtractorDecorator.buildXHTML(XSSFExcelExtractorDecorator.java:185) at org.apache.tika.parser.microsoft.ooxml.AbstractOOXMLExtractor.getXHTML(AbstractOOXMLExtractor.java:135) at org.apache.tika.parser.microsoft.ooxml.XSSFExcelExtractorDecorator.getXHTML(XSSFExcelExtractorDecorator.java:120) at org.apache.tika.parser.microsoft.ooxml.OOXMLExtractorFactory.parse(OOXMLExtractorFactory.java:143) at org.apache.tika.parser.microsoft.ooxml.OOXMLParser.parse(OOXMLParser.java:106) at org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:280) at org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:280) at org.apache.tika.parser.AutoDetectParser.parse(AutoDetectParser.java:143) at org.apache.solr.handler.extraction.ExtractingDocumentLoader.load(ExtractingDocumentLoader.java:228) at org.apache.solr.handler.ContentStreamHandlerBase.handleRequestBody(ContentStreamHandlerBase.java:68) at org.apache.solr.handler.RequestHandlerBase.handleRequest(RequestHandlerBase.java:195) at org.apache.solr.core.SolrCore.execute(SolrCore.java:2503) at org.apache.solr.servlet.HttpSolrCall.execute(HttpSolrCall.java:711) at org.apache.solr.servlet.HttpSolrCall.call(HttpSolrCall.java:517) at org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:384) at org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:330) at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1629) at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:533) at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143) at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:548) at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:132) at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:190) at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1595) at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:188) at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1253) at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:168) at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:473) at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1564) at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:166) at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1155) at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141) at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:219) at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:126) at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:132) at org.eclipse.jetty.rewrite.handler.RewriteHandler.handle(RewriteHandler.java:335) at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:132) at org.eclipse.jetty.server.Server.handle(Server.java:530) at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:347) at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:256) at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:279) at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:102) at org.eclipse.jetty.io.ChannelEndPoint$2.run(ChannelEndPoint.java:124) at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:247) at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.produce(EatWhatYouKill.java:140) at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131) at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:382) at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:708) at org.eclipse.jetty.util.thread.QueuedThreadPool$2.run(QueuedThreadPool.java:626) at java.base/java.lang.Thread.run(Thread.java:844) &amp;lt;/pre&amp;gt; &amp;lt;/body&amp;gt; &amp;lt;/html&amp;gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;How could I solve it?&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Thanks a lot&lt;/p&gt;

&lt;p&gt;Mario&lt;/p&gt;</description>
                <environment>&lt;p&gt;Tika 1.17 on solr 7.3&#160;&lt;/p&gt;</environment>
        <key id="13176136">TIKA-2703</key>
            <summary>Error indexing a xlsx file</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tallison">Tim Allison</assignee>
                                    <reporter username="bisontim">Mario Bisonti</reporter>
                        <labels>
                    </labels>
                <created>Wed, 1 Aug 2018 13:57:24 +0000</created>
                <updated>Thu, 11 Oct 2018 17:49:26 +0000</updated>
                            <resolved>Thu, 11 Oct 2018 17:49:26 +0000</resolved>
                                                    <fixVersion>1.19</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="16565393" author="tallison@mitre.org" created="Wed, 1 Aug 2018 14:18:49 +0000"  >&lt;p&gt;In general:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Using Solr&apos;s integration of Tika is not recommended for production.  It is really intended only to get people up and running quickly.  It is far better to keep Tika in its own JVM and out of Solr&apos;s. See Erick Erickson&apos;s post: &lt;a href=&quot;https://lucidworks.com/2012/02/14/indexing-with-solrj/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://lucidworks.com/2012/02/14/indexing-with-solrj/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Specifically, how much heap have you allocated?  If you run straight tika &lt;tt&gt;java -jar tika-app.jar problem_file.xlsx&lt;/tt&gt;, how much memory do you need to extract text w/out oom?&lt;/p&gt;

&lt;p&gt;IIRC, you could configure Tika to ignore chart data, which is where this oom was triggered, but there&apos;s no guarantee that chart data is the actual culprit.&lt;/p&gt;

&lt;p&gt;If you can share the file privately, I can take a look, but otherwise, there&apos;s not much we can do.&lt;/p&gt;</comment>
                            <comment id="16565432" author="bisontim" created="Wed, 1 Aug 2018 14:53:10 +0000"  >&lt;p&gt;Hallo.&lt;/p&gt;

&lt;p&gt;Yes, I wold like that you could to watch my file privately, how could I send to you?&lt;/p&gt;

&lt;p&gt;Thanks a lot!&lt;/p&gt;</comment>
                            <comment id="16565464" author="tallison@mitre.org" created="Wed, 1 Aug 2018 15:15:28 +0000"  >&lt;p&gt;Can&#8217;t promise I&#8217;ll be able to do anything: tallison &lt;span class=&quot;error&quot;&gt;&amp;#91;at&amp;#93;&lt;/span&gt; apache &lt;span class=&quot;error&quot;&gt;&amp;#91;dot&amp;#93;&lt;/span&gt; org&lt;/p&gt;</comment>
                            <comment id="16565620" author="tallison@mitre.org" created="Wed, 1 Aug 2018 16:52:51 +0000"  >&lt;p&gt;To turn off extraction of charts, you have to construct a tika-config.xml file as described here: &lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2507?focusedCommentId=16267091&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-16267091&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/TIKA-2507?focusedCommentId=16267091&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-16267091&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I can&apos;t remember off the top of my head how to aim Solr at a TikaConfig file, but I know that it exists somehwere in there.&lt;/p&gt;</comment>
                            <comment id="16566520" author="bisontim" created="Thu, 2 Aug 2018 09:13:13 +0000"  >&lt;p&gt;I tried but I obtain the same error http 500 &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="16568090" author="tallison@mitre.org" created="Fri, 3 Aug 2018 10:46:17 +0000"  >&lt;p&gt;Google docs/ Dropbox? GitHub? Anywhere else to share file?&lt;/p&gt;</comment>
                            <comment id="16568239" author="tallison@mitre.org" created="Fri, 3 Aug 2018 14:07:58 +0000"  >&lt;p&gt;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/tongue.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;br/&gt;
Thank you for sharing the file with me.  Bottom line: there&apos;s a bug in Tika.&lt;/p&gt;

&lt;p&gt;Your file has a 216 MB uncompressed chart (chart3.xml).  When I extracted text via streaming, I got a ZipBombException after it wrote 4GB of data.&lt;/p&gt;

&lt;p&gt;Sheet7.xml has 70 shapes. Each shape is a member of the same parent drawing that includes chart3.xml.  When I wrote the code, I thought that the drawing and its chart data belonged to the shape.  This is wrong.  The shape belongs to the drawing.&lt;/p&gt;

&lt;p&gt;So, as we iterated through the 70 shapes and processed the chart data each time, we wound up processing your 216MB xml file 70 times.&lt;/p&gt;

&lt;p&gt;The fix is easy: make sure to process the shape&apos;s parent drawing&apos;s charts only once.&lt;/p&gt;</comment>
                            <comment id="16568251" author="tallison@mitre.org" created="Fri, 3 Aug 2018 14:19:25 +0000"  >&lt;p&gt;That said, 1) you still shouldn&apos;t use Solr&apos;s integration with Tika in production because Tika can behave badly and 2) turning off shape extraction &lt;em&gt;should&lt;/em&gt; have worked.&lt;/p&gt;

&lt;p&gt;Nevertheless, I&apos;m very grateful to you for reporting this and sharing the file with me.  &lt;/p&gt;</comment>
                            <comment id="16568375" author="hudson" created="Fri, 3 Aug 2018 15:42:58 +0000"  >&lt;p&gt;UNSTABLE: Integrated in Jenkins build tika-2.x-windows #291 (See &lt;a href=&quot;https://builds.apache.org/job/tika-2.x-windows/291/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/tika-2.x-windows/291/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2703&quot; title=&quot;Error indexing a xlsx file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2703&quot;&gt;&lt;del&gt;TIKA-2703&lt;/del&gt;&lt;/a&gt; make sure to process shape&apos;s parent drawing only once. (tallison: rev 0486852c46f42130c2f1c26cdd35f38005457a83)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/microsoft/ooxml/XSSFExcelExtractorDecorator.java&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2703&quot; title=&quot;Error indexing a xlsx file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2703&quot;&gt;&lt;del&gt;TIKA-2703&lt;/del&gt;&lt;/a&gt; &amp;#8211; related...simplify XSSFB to use more of XSSF rather (tallison: rev 5cb8d9a9e091ee61c8dc0f334d23c7677f5f519b)&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/microsoft/ooxml/XSSFExcelExtractorDecorator.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/microsoft/ooxml/XSSFBExcelExtractorDecorator.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="16568551" author="hudson" created="Fri, 3 Aug 2018 18:06:09 +0000"  >&lt;p&gt;SUCCESS: Integrated in Jenkins build Tika-trunk #1536 (See &lt;a href=&quot;https://builds.apache.org/job/Tika-trunk/1536/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Tika-trunk/1536/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2703&quot; title=&quot;Error indexing a xlsx file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2703&quot;&gt;&lt;del&gt;TIKA-2703&lt;/del&gt;&lt;/a&gt; make sure to process shape&apos;s parent drawing only once. (tallison: &lt;a href=&quot;https://github.com/apache/tika/commit/0486852c46f42130c2f1c26cdd35f38005457a83&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/0486852c46f42130c2f1c26cdd35f38005457a83&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/microsoft/ooxml/XSSFExcelExtractorDecorator.java&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2703&quot; title=&quot;Error indexing a xlsx file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2703&quot;&gt;&lt;del&gt;TIKA-2703&lt;/del&gt;&lt;/a&gt; &amp;#8211; related...simplify XSSFB to use more of XSSF rather (tallison: &lt;a href=&quot;https://github.com/apache/tika/commit/5cb8d9a9e091ee61c8dc0f334d23c7677f5f519b&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/5cb8d9a9e091ee61c8dc0f334d23c7677f5f519b&lt;/a&gt;)&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/microsoft/ooxml/XSSFExcelExtractorDecorator.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/microsoft/ooxml/XSSFBExcelExtractorDecorator.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="16568565" author="hudson" created="Fri, 3 Aug 2018 18:17:53 +0000"  >&lt;p&gt;SUCCESS: Integrated in Jenkins build tika-branch-1x #67 (See &lt;a href=&quot;https://builds.apache.org/job/tika-branch-1x/67/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/tika-branch-1x/67/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2703&quot; title=&quot;Error indexing a xlsx file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2703&quot;&gt;&lt;del&gt;TIKA-2703&lt;/del&gt;&lt;/a&gt; make sure to process shape&apos;s parent drawing only once. (tallison: &lt;a href=&quot;https://github.com/apache/tika/commit/2cf0a964c3b1eb200864d3cfec881b4a9bad45fe&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/2cf0a964c3b1eb200864d3cfec881b4a9bad45fe&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/microsoft/ooxml/XSSFExcelExtractorDecorator.java&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2703&quot; title=&quot;Error indexing a xlsx file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2703&quot;&gt;&lt;del&gt;TIKA-2703&lt;/del&gt;&lt;/a&gt; &amp;#8211; related...simplify XSSFB to use more of XSSF rather (tallison: &lt;a href=&quot;https://github.com/apache/tika/commit/2745cfde46123fc03ad0e7cd59c50aa6aef1f8df&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/2745cfde46123fc03ad0e7cd59c50aa6aef1f8df&lt;/a&gt;)&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/microsoft/ooxml/XSSFExcelExtractorDecorator.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/microsoft/ooxml/XSSFBExcelExtractorDecorator.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="16572888" author="bisontim" created="Wed, 8 Aug 2018 08:43:39 +0000"  >&lt;p&gt;Hallo.&lt;/p&gt;

&lt;p&gt;So, did you apply a patch so tolve my issue?&lt;/p&gt;

&lt;p&gt;How could I use it on my environment with solr?&lt;/p&gt;

&lt;p&gt;Have I to compile a patched tika version?&lt;/p&gt;

&lt;p&gt;Could you help me?&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Thanks a lot&lt;/p&gt;

&lt;p&gt;Mario&lt;/p&gt;</comment>
                            <comment id="16573071" author="tallison@mitre.org" created="Wed, 8 Aug 2018 11:34:32 +0000"  >&lt;p&gt;Try swapping out a nightly build of the tika-parsers-x.y.jar from &lt;a href=&quot;https://builds.apache.org/job/tika-branch-1x/73/org.apache.tika$tika-parsers/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/tika-branch-1x/73/org.apache.tika$tika-parsers/&lt;/a&gt; for the tika-parsers-1.18.jar in Solr and see if you have any more luck.  I can&apos;t remember off the top of my head if you&apos;ll have any version conflicts.&lt;/p&gt;

&lt;p&gt;We should be running the release of Tika 1.19 fairly soon (next few weeks).&lt;/p&gt;</comment>
                            <comment id="16573119" author="bisontim" created="Wed, 8 Aug 2018 12:11:41 +0000"  >&lt;p&gt;Hallo.&lt;/p&gt;

&lt;p&gt;I downloaded&#160;&lt;a href=&quot;https://builds.apache.org/job/tika-branch-1x/73/org.apache.tika$tika-parsers/artifact/org.apache.tika/tika-parsers/1.19-20180807.184508-61/tika-parsers-1.19-20180807.184508-61.jar&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;tika-parsers-1.19-20180807.184508-61.jar&lt;/a&gt;&#160;and I put it, renamed on tika-parsers-1.19.jar on my lib directory.&lt;/p&gt;

&lt;p&gt;So I have these tika files:&lt;br/&gt;
tika-core-1.17.jar&lt;br/&gt;
tika-java7-1.17.jar&lt;br/&gt;
tika-parsers-1.19.jar&lt;br/&gt;
tika-xmp-1.17.jar&lt;/p&gt;



&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;and now I obtain the error:&lt;br/&gt;
2018-08-08 14:06:37.521 WARN (qtp1521083627-19) [ x:core_share] o.e.j.s.HttpChannel /solr/core_share/update/extract&lt;br/&gt;
java.lang.NoSuchMethodError: org.apache.tika.utils.XMLReaderUtils.parseSAX(Ljava/io/InputStream;Lorg/xml/sax/helpers/DefaultHandler;Lorg/apache/tika/parser/ParseContext;)V&lt;br/&gt;
 at org.apache.tika.parser.microsoft.ooxml.XSSFExcelExtractorDecorator.processSheet(XSSFExcelExtractorDecorator.java:352)&lt;br/&gt;
 at org.apache.tika.parser.microsoft.ooxml.XSSFExcelExtractorDecorator.buildXHTML(XSSFExcelExtractorDecorator.java:168)&lt;br/&gt;
 at org.apache.tika.parser.microsoft.ooxml.AbstractOOXMLExtractor.getXHTML(AbstractOOXMLExtractor.java:141)&lt;br/&gt;
 at org.apache.tika.parser.microsoft.ooxml.XSSFExcelExtractorDecorator.getXHTML(XSSFExcelExtractorDecorator.java:122)&lt;br/&gt;
 at org.apache.tika.parser.microsoft.ooxml.OOXMLExtractorFactory.parse(OOXMLExtractorFactory.java:154)&lt;br/&gt;
 at org.apache.tika.parser.microsoft.ooxml.OOXMLParser.parse(OOXMLParser.java:110)&lt;br/&gt;
 at org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:280)&lt;br/&gt;
 at org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:280)&lt;br/&gt;
 at org.apache.tika.parser.AutoDetectParser.parse(AutoDetectParser.java:143)&lt;br/&gt;
 at org.apache.solr.handler.extraction.ExtractingDocumentLoader.load(ExtractingDocumentLoader.java:228)&lt;br/&gt;
 at org.apache.solr.handler.ContentStreamHandlerBase.handleRequestBody(ContentStreamHandlerBase.java:68)&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;I don&apos;t know if did you mean that tika version of it is a problem of the other tika files..&lt;/p&gt;

&lt;p&gt;What could I do?&lt;/p&gt;

&lt;p&gt;Thanks a lot&lt;/p&gt;

&lt;p&gt;Mario&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="16573125" author="tallison@mitre.org" created="Wed, 8 Aug 2018 12:16:39 +0000"  >&lt;p&gt;Doh. Right. Try adding the nightly build of tika-core. Again, there may be other binary incompatibilities...&lt;/p&gt;</comment>
                            <comment id="16573141" author="bisontim" created="Wed, 8 Aug 2018 12:24:12 +0000"  >&lt;p&gt;Tim, you are a greaaaat !!!&lt;/p&gt;

&lt;p&gt;I substutute all my four .jar tika files 1.17 (parsers, core, java7, xmp)&#160; versions with the 1.19 versions nightly version and it works!&lt;br/&gt;
No more 500 error and the file has been indexed!&lt;br/&gt;
This night I will start other file of that type.&lt;/p&gt;

&lt;p&gt;I use, in my lib directory of solr:&lt;/p&gt;

&lt;p&gt;&lt;del&gt;rw-r&lt;/del&gt;&lt;del&gt;r&lt;/del&gt;- 1 root root 663109 Dec 9 2017 tika-core-1.17.jarOLD&lt;br/&gt;
&lt;del&gt;rw-r&lt;/del&gt;&lt;del&gt;r&lt;/del&gt;- 1 root root 687651 Aug 8 14:16 tika-core-1.19.jar&lt;br/&gt;
&lt;del&gt;rw-r&lt;/del&gt;&lt;del&gt;r&lt;/del&gt;- 1 root root 13268 Dec 9 2017 tika-java7-1.17.jarOLD&lt;br/&gt;
&lt;del&gt;rw-r&lt;/del&gt;&lt;del&gt;r&lt;/del&gt;- 1 root root 14012 Aug 8 14:16 tika-java7-1.19.jar&lt;br/&gt;
&lt;del&gt;rw-r&lt;/del&gt;&lt;del&gt;r&lt;/del&gt;- 1 root root 1078626 Dec 9 2017 tika-parsers-1.17.jarOO&lt;br/&gt;
&lt;del&gt;rw-r&lt;/del&gt;&lt;del&gt;r&lt;/del&gt;- 1 root root 1131862 Aug 8 14:16 tika-parsers-1.19.jar&lt;br/&gt;
&lt;del&gt;rw-r&lt;/del&gt;&lt;del&gt;r&lt;/del&gt;- 1 root root 33705 Dec 9 2017 tika-xmp-1.17.jarOLD&lt;br/&gt;
&lt;del&gt;rw-r&lt;/del&gt;&lt;del&gt;r&lt;/del&gt;- 1 root root 34447 Aug 8 14:16 tika-xmp-1.19.jar&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Thanks a lot!&lt;/p&gt;

&lt;p&gt;Mario&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="16573161" author="tallison@mitre.org" created="Wed, 8 Aug 2018 12:41:33 +0000"  >&lt;p&gt;I&apos;m keeping my fingers crossed that you don&apos;t run into any other incompatibilities!&lt;/p&gt;

&lt;p&gt;Please note my point above:&lt;/p&gt;

&lt;p&gt;Using Solr&apos;s integration of Tika is not recommended for production. It is really intended only to get people up and running quickly. It is far better to keep Tika in its own JVM and out of Solr&apos;s. See Erick Erickson&apos;s post: &lt;a href=&quot;https://lucidworks.com/2012/02/14/indexing-with-solrj/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://lucidworks.com/2012/02/14/indexing-with-solrj/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16646136" author="bisontim" created="Thu, 11 Oct 2018 08:48:19 +0000"  >&lt;p&gt;Hallo Tim.&lt;/p&gt;

&lt;p&gt;I don&apos;t understand&#160; how to set Solr to use TikaServer (localhost:9998) instead the embedded Tika*jar file.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Where could I find any information about it?&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Thanks a lot&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Mario&lt;/p&gt;</comment>
                            <comment id="16646818" author="tallison@mitre.org" created="Thu, 11 Oct 2018 17:48:13 +0000"  >&lt;p&gt;There isn&apos;t yet a way to tell Solr to use tika-server.  I did just open a pull request in Solr to upgrade Tika to 1.19.1 if that will help.&lt;/p&gt;

&lt;p&gt;If you want to use tika-server, you&apos;ll probably have to write your own code with SolrJ...shouldn&apos;t be hard.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 5 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3wknb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>