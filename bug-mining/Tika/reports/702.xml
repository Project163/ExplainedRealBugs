<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:59:37 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[TIKA-1654] Reset cTAKES CAS into CTAKESParser</title>
                <link>https://issues.apache.org/jira/browse/TIKA-1654</link>
                <project id="12310631" key="TIKA">Tika</project>
                    <description>&lt;p&gt;Using &lt;a href=&quot;https://wiki.apache.org/tika/cTAKESParser&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;CTAKESParser from Tika Server&lt;/a&gt;, I noticed that an exception occurs when the CTAKESParser is used multiple times:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.uima.cas.CASRuntimeException: Data for Sofa feature setLocalSofaData() has already been set.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This is due to the CAS (Common Analysis System) used by CTAKESParser. The CAS, as the AE (AnalysisEngine), is a static field into CTAKESParser to make a sort of singleton.&lt;/p&gt;

&lt;p&gt;By the way, An Analysis Engine is a cTAKES/UIMA component responsible for analyzing unstructured information, discovering and representing semantic content. An AnalysisEngine operates on an &quot;analysis structure&quot; (implemented by CAS).&lt;/p&gt;

&lt;p&gt;It is highly recommended to reuse the CAS, but it has to be reset before the next run. The CTAKESUtils class (&lt;tt&gt;org.apache.tika.parser.ctakes&lt;/tt&gt;) provides the reset method to release all resources held by both AnalysisEngine and CAS and then &quot;destroy&quot; them. This method prevents the CASRuntimeException error.&lt;/p&gt;

&lt;p&gt;You can find in attachment the patch including two new methods (resetCAS and resetAE) to reset, but not to destroy, the CAS and the AnalysisEngine respectively.&lt;br/&gt;
By using only resetCAS, CTAKESParser can reuse both CAS and AE instead of building them again for each run.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12836991">TIKA-1654</key>
            <summary>Reset cTAKES CAS into CTAKESParser</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="gostep">Giuseppe Totaro</assignee>
                                    <reporter username="gostep">Giuseppe Totaro</reporter>
                        <labels>
                            <label>patch</label>
                    </labels>
                <created>Wed, 10 Jun 2015 23:26:29 +0000</created>
                <updated>Sun, 21 Jun 2015 23:31:02 +0000</updated>
                            <resolved>Sun, 21 Jun 2015 23:31:02 +0000</resolved>
                                                    <fixVersion>1.10</fixVersion>
                                    <component>parser</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="14581293" author="hudson" created="Thu, 11 Jun 2015 00:47:13 +0000"  >&lt;p&gt;SUCCESS: Integrated in tika-trunk-jdk1.7 #744 (See &lt;a href=&quot;https://builds.apache.org/job/tika-trunk-jdk1.7/744/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/tika-trunk-jdk1.7/744/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1654&quot; title=&quot;Reset cTAKES CAS into CTAKESParser&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1654&quot;&gt;&lt;del&gt;TIKA-1654&lt;/del&gt;&lt;/a&gt; Reset cTAKES CAS into CTAKESParser (Fix for &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1645&quot; title=&quot;Extraction of biomedical information using CTAKESParser&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1645&quot;&gt;&lt;del&gt;TIKA-1645&lt;/del&gt;&lt;/a&gt;) (totaro: &lt;a href=&quot;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1684801&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1684801&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/tika/trunk/tika-parsers/src/main/java/org/apache/tika/parser/ctakes/CTAKESContentHandler.java&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-parsers/src/main/java/org/apache/tika/parser/ctakes/CTAKESParser.java&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-parsers/src/main/java/org/apache/tika/parser/ctakes/CTAKESUtils.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14588590" author="gostep" created="Tue, 16 Jun 2015 19:11:50 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=chrismattmann&quot; class=&quot;user-hover&quot; rel=&quot;chrismattmann&quot;&gt;chrismattmann&lt;/a&gt; has reported to me that sometimes CTAKESParser throws an exception when is used from tika-server. This exception is caused by the following:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;CASAdminException: Can&apos;t flush CAS, flushing is disabled.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Looking at the stack trace of the exception, the problem should be due to&lt;br/&gt;
some synchronization issues while accessing the CAS (Common Analysis System) via CTAKESParser in case of multple &quot;simultaneous&quot; requests to the server.&lt;/p&gt;

&lt;p&gt;I have written a new patch because even the first version of CTAKESParser&lt;br/&gt;
could cause the same problem, if my assumption is correct. You can find&lt;br/&gt;
the new patch in attachment.&lt;br/&gt;
Essentially, the patch makes private both AE and CAS for each instance of&lt;br/&gt;
CTAKESContentHandler. &lt;/p&gt;

&lt;p&gt;I am also writing the new version of CTAKESParser to call cTAKES as an external command. However, if you have any suggestion in order to provide some synchronization mechanism to access both AE and CAS, it is really appreciated.&lt;/p&gt;

&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=chrismattmann&quot; class=&quot;user-hover&quot; rel=&quot;chrismattmann&quot;&gt;chrismattmann&lt;/a&gt; for supporting me on this work.&lt;/p&gt;</comment>
                            <comment id="14592898" author="chrismattmann" created="Fri, 19 Jun 2015 02:31:42 +0000"  >&lt;p&gt;+1 please commit &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gostep&quot; class=&quot;user-hover&quot; rel=&quot;gostep&quot;&gt;gostep&lt;/a&gt; thanks!&lt;/p&gt;</comment>
                            <comment id="14594308" author="hudson" created="Sat, 20 Jun 2015 03:04:50 +0000"  >&lt;p&gt;FAILURE: Integrated in tika-trunk-jdk1.7 #758 (See &lt;a href=&quot;https://builds.apache.org/job/tika-trunk-jdk1.7/758/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/tika-trunk-jdk1.7/758/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1654&quot; title=&quot;Reset cTAKES CAS into CTAKESParser&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1654&quot;&gt;&lt;del&gt;TIKA-1654&lt;/del&gt;&lt;/a&gt;: Reset cTAKES CAS into CTAKESParser (totaro: &lt;a href=&quot;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1686518&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1686518&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/tika/trunk/tika-parsers/src/main/java/org/apache/tika/parser/ctakes/CTAKESContentHandler.java&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-parsers/src/main/java/org/apache/tika/parser/ctakes/CTAKESParser.java&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-parsers/src/main/java/org/apache/tika/parser/ctakes/CTAKESUtils.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14594920" author="chrismattmann" created="Sun, 21 Jun 2015 02:15:20 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gostep&quot; class=&quot;user-hover&quot; rel=&quot;gostep&quot;&gt;gostep&lt;/a&gt; can you resolve this? looks like the build failed though...&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12834959">TIKA-1645</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12738942" name="TIKA-1654.patch" size="3700" author="gostep" created="Wed, 10 Jun 2015 23:27:51 +0000"/>
                            <attachment id="12739937" name="TIKA-1654.v02.patch" size="24320" author="gostep" created="Tue, 16 Jun 2015 19:11:50 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310250" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10430"><![CDATA[Patch]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 21 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2fwmf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>