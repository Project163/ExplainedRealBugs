<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:01:55 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[TIKA-2100] Html Parser does not keep the html tag attributes</title>
                <link>https://issues.apache.org/jira/browse/TIKA-2100</link>
                <project id="12310631" key="TIKA">Tika</project>
                    <description>&lt;p&gt;Parsing a very simple html like &lt;br/&gt;
 &amp;lt;!DOCTYPE html&amp;gt;&lt;br/&gt;
&amp;lt;html lang=&quot;en&quot;&amp;gt;&lt;br/&gt;
&amp;lt;head&amp;gt;&lt;br/&gt;
&amp;lt;title&amp;gt;Page Title&amp;lt;/title&amp;gt;&lt;br/&gt;
&amp;lt;/head&amp;gt;&lt;br/&gt;
&amp;lt;body&amp;gt;&lt;/p&gt;

&lt;p&gt;&amp;lt;h1 align=&quot;left&quot;&amp;gt;My First Heading&amp;lt;/h1&amp;gt;&lt;br/&gt;
&amp;lt;p&amp;gt;My first paragraph.&amp;lt;/p&amp;gt;&lt;/p&gt;

&lt;p&gt;&amp;lt;/body&amp;gt;&lt;br/&gt;
&amp;lt;/html&amp;gt; &lt;/p&gt;

&lt;p&gt;you won&apos;t be able to access the html tag&apos;s attributes (here lang=&quot;en&quot;) in the ContentHandler : &lt;br/&gt;
*in the method startElement(String ns, String localName, String name,&lt;br/&gt;
      Attributes atts), atts is empty.&lt;br/&gt;
*Moreover it seems that the html tag&apos;s attributes are not passed trough the HtmlMapper.mapSafeAttribute method too.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13008228">TIKA-2100</key>
            <summary>Html Parser does not keep the html tag attributes</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="Gerard Bouchar">Gerard Bouchar</reporter>
                        <labels>
                    </labels>
                <created>Wed, 28 Sep 2016 13:21:46 +0000</created>
                <updated>Wed, 30 May 2018 22:04:27 +0000</updated>
                            <resolved>Tue, 29 May 2018 18:28:13 +0000</resolved>
                                    <version>1.13</version>
                                    <fixVersion>1.19</fixVersion>
                    <fixVersion>2.0.0</fixVersion>
                                    <component>parser</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="16489082" author="gbouchar" created="Thu, 24 May 2018 14:14:53 +0000"  >&lt;p&gt;Is there something that could be done to fix this ?&lt;/p&gt;</comment>
                            <comment id="16490642" author="githubbot" created="Fri, 25 May 2018 12:27:53 +0000"  >&lt;p&gt;GerardBouchar opened a new pull request #238: &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2100&quot; title=&quot;Html Parser does not keep the html tag attributes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2100&quot;&gt;&lt;del&gt;TIKA-2100&lt;/del&gt;&lt;/a&gt; extract content language from html lang attribute&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/tika/pull/238&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/pull/238&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   The &lt;span class=&quot;error&quot;&gt;&amp;#91;recommended way&amp;#93;&lt;/span&gt;(&lt;a href=&quot;https://www.w3.org/International/questions/qa-html-language-declarations&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://www.w3.org/International/questions/qa-html-language-declarations&lt;/a&gt;) of declaring the language of an HTML document is to specify it in the `lang` attribute of the `&amp;lt;html&amp;gt;` tag.&lt;/p&gt;

&lt;p&gt;   Tika currently not only ignores this attribute, but also removes it from its SAX output, making it unavailable to client applications.&lt;/p&gt;

&lt;p&gt;   This PR adds the value of the lang attribute to the documents metadata (under the existing key `Metadata.CONTENT_LANGUAGE`) and also makes it available in the SAX output.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16490882" author="githubbot" created="Fri, 25 May 2018 15:40:03 +0000"  >&lt;p&gt;tballison commented on a change in pull request #238: &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2100&quot; title=&quot;Html Parser does not keep the html tag attributes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2100&quot;&gt;&lt;del&gt;TIKA-2100&lt;/del&gt;&lt;/a&gt; extract content language from html lang attribute&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/tika/pull/238#discussion_r190932815&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/pull/238#discussion_r190932815&lt;/a&gt;&lt;/p&gt;



&lt;p&gt; ##########&lt;br/&gt;
 File path: tika-core/src/main/java/org/apache/tika/sax/XHTMLContentHandler.java&lt;br/&gt;
 ##########&lt;br/&gt;
 @@ -138,7 +138,12 @@ private void lazyStartHead() throws SAXException {&lt;/p&gt;

&lt;p&gt;             // Call directly, so we don&apos;t go through our startElement(), which will&lt;br/&gt;
             // ignore these elements.&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;super.startElement(XHTML, &quot;html&quot;, &quot;html&quot;, EMPTY_ATTRIBUTES);&lt;br/&gt;
+            AttributesImpl htmlAttrs = new AttributesImpl();&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt; Review comment:&lt;br/&gt;
   Thank you for the patch.  This feels fiddly to me.  Let&apos;s leave XHTMLContentHandler alone.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16490883" author="githubbot" created="Fri, 25 May 2018 15:40:04 +0000"  >&lt;p&gt;tballison commented on a change in pull request #238: &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2100&quot; title=&quot;Html Parser does not keep the html tag attributes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2100&quot;&gt;&lt;del&gt;TIKA-2100&lt;/del&gt;&lt;/a&gt; extract content language from html lang attribute&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/tika/pull/238#discussion_r190933047&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/pull/238#discussion_r190933047&lt;/a&gt;&lt;/p&gt;



&lt;p&gt; ##########&lt;br/&gt;
 File path: tika-parsers/src/main/java/org/apache/tika/parser/html/HtmlHandler.java&lt;br/&gt;
 ##########&lt;br/&gt;
 @@ -16,20 +16,6 @@&lt;br/&gt;
  */&lt;br/&gt;
 package org.apache.tika.parser.html;&lt;/p&gt;

&lt;p&gt;-import java.io.ByteArrayInputStream;&lt;/p&gt;

&lt;p&gt; Review comment:&lt;br/&gt;
   If you could turn off your auto-correct for imports or align your imports with ours so that we don&apos;t have all these changes, that&apos;d be great!&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16490944" author="githubbot" created="Fri, 25 May 2018 16:13:32 +0000"  >&lt;p&gt;GerardBouchar commented on a change in pull request #238: &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2100&quot; title=&quot;Html Parser does not keep the html tag attributes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2100&quot;&gt;&lt;del&gt;TIKA-2100&lt;/del&gt;&lt;/a&gt; extract content language from html lang attribute&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/tika/pull/238#discussion_r190942412&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/pull/238#discussion_r190942412&lt;/a&gt;&lt;/p&gt;



&lt;p&gt; ##########&lt;br/&gt;
 File path: tika-parsers/src/main/java/org/apache/tika/parser/html/HtmlHandler.java&lt;br/&gt;
 ##########&lt;br/&gt;
 @@ -16,20 +16,6 @@&lt;br/&gt;
  */&lt;br/&gt;
 package org.apache.tika.parser.html;&lt;/p&gt;

&lt;p&gt;-import java.io.ByteArrayInputStream;&lt;/p&gt;

&lt;p&gt; Review comment:&lt;br/&gt;
   Yes, I saw that too late, sorry &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; fixing it now.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16490945" author="githubbot" created="Fri, 25 May 2018 16:15:17 +0000"  >&lt;p&gt;GerardBouchar commented on a change in pull request #238: &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2100&quot; title=&quot;Html Parser does not keep the html tag attributes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2100&quot;&gt;&lt;del&gt;TIKA-2100&lt;/del&gt;&lt;/a&gt; extract content language from html lang attribute&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/tika/pull/238#discussion_r190942834&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/pull/238#discussion_r190942834&lt;/a&gt;&lt;/p&gt;



&lt;p&gt; ##########&lt;br/&gt;
 File path: tika-core/src/main/java/org/apache/tika/sax/XHTMLContentHandler.java&lt;br/&gt;
 ##########&lt;br/&gt;
 @@ -138,7 +138,12 @@ private void lazyStartHead() throws SAXException {&lt;/p&gt;

&lt;p&gt;             // Call directly, so we don&apos;t go through our startElement(), which will&lt;br/&gt;
             // ignore these elements.&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;super.startElement(XHTML, &quot;html&quot;, &quot;html&quot;, EMPTY_ATTRIBUTES);&lt;br/&gt;
+            AttributesImpl htmlAttrs = new AttributesImpl();&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt; Review comment:&lt;br/&gt;
   But how can we fix &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2100&quot; title=&quot;Html Parser does not keep the html tag attributes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2100&quot;&gt;&lt;del&gt;TIKA-2100&lt;/del&gt;&lt;/a&gt;(&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2100&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/TIKA-2100&lt;/a&gt;) without touching XHTMLContentHandler ? &lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16490957" author="githubbot" created="Fri, 25 May 2018 16:23:58 +0000"  >&lt;p&gt;tballison commented on a change in pull request #238: &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2100&quot; title=&quot;Html Parser does not keep the html tag attributes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2100&quot;&gt;&lt;del&gt;TIKA-2100&lt;/del&gt;&lt;/a&gt; extract content language from html lang attribute&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/tika/pull/238#discussion_r190945058&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/pull/238#discussion_r190945058&lt;/a&gt;&lt;/p&gt;



&lt;p&gt; ##########&lt;br/&gt;
 File path: tika-core/src/main/java/org/apache/tika/sax/XHTMLContentHandler.java&lt;br/&gt;
 ##########&lt;br/&gt;
 @@ -138,7 +138,12 @@ private void lazyStartHead() throws SAXException {&lt;/p&gt;

&lt;p&gt;             // Call directly, so we don&apos;t go through our startElement(), which will&lt;br/&gt;
             // ignore these elements.&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;super.startElement(XHTML, &quot;html&quot;, &quot;html&quot;, EMPTY_ATTRIBUTES);&lt;br/&gt;
+            AttributesImpl htmlAttrs = new AttributesImpl();&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt; Review comment:&lt;br/&gt;
   Sorry...I&apos;m so narrowly focused only on my own typical use case - extract text without structure, put the lang in Metadata()...&lt;/p&gt;

&lt;p&gt;   To confirm, you have a need to include the &apos;lang=&apos; in the xhtml output from Tika?  Are there other common attributes of HTML that we should also include?&lt;/p&gt;


&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16490959" author="githubbot" created="Fri, 25 May 2018 16:24:37 +0000"  >&lt;p&gt;GerardBouchar commented on issue #238: &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2100&quot; title=&quot;Html Parser does not keep the html tag attributes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2100&quot;&gt;&lt;del&gt;TIKA-2100&lt;/del&gt;&lt;/a&gt; extract content language from html lang attribute&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/tika/pull/238#issuecomment-392110416&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/pull/238#issuecomment-392110416&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   I reverted the automatic changes to the import statements (there are unused imports, though).&lt;br/&gt;
   But I don&apos;t see how to add the language information to the output HTML without fiddling with XHTMLContentHandler...&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16490965" author="githubbot" created="Fri, 25 May 2018 16:27:31 +0000"  >&lt;p&gt;GerardBouchar commented on a change in pull request #238: &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2100&quot; title=&quot;Html Parser does not keep the html tag attributes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2100&quot;&gt;&lt;del&gt;TIKA-2100&lt;/del&gt;&lt;/a&gt; extract content language from html lang attribute&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/tika/pull/238#discussion_r190945982&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/pull/238#discussion_r190945982&lt;/a&gt;&lt;/p&gt;



&lt;p&gt; ##########&lt;br/&gt;
 File path: tika-core/src/main/java/org/apache/tika/sax/XHTMLContentHandler.java&lt;br/&gt;
 ##########&lt;br/&gt;
 @@ -138,7 +138,12 @@ private void lazyStartHead() throws SAXException {&lt;/p&gt;

&lt;p&gt;             // Call directly, so we don&apos;t go through our startElement(), which will&lt;br/&gt;
             // ignore these elements.&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;super.startElement(XHTML, &quot;html&quot;, &quot;html&quot;, EMPTY_ATTRIBUTES);&lt;br/&gt;
+            AttributesImpl htmlAttrs = new AttributesImpl();&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt; Review comment:&lt;br/&gt;
   Yes, I&apos;ve recently had problems with meta tags. See &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2652&quot; title=&quot;HtmlParser generates incorrect meta tags&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2652&quot;&gt;TIKA-2652&lt;/a&gt;(&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2652&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/TIKA-2652&lt;/a&gt;).&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16490967" author="githubbot" created="Fri, 25 May 2018 16:29:23 +0000"  >&lt;p&gt;GerardBouchar commented on a change in pull request #238: &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2100&quot; title=&quot;Html Parser does not keep the html tag attributes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2100&quot;&gt;&lt;del&gt;TIKA-2100&lt;/del&gt;&lt;/a&gt; extract content language from html lang attribute&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/tika/pull/238#discussion_r190946406&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/pull/238#discussion_r190946406&lt;/a&gt;&lt;/p&gt;



&lt;p&gt; ##########&lt;br/&gt;
 File path: tika-core/src/main/java/org/apache/tika/sax/XHTMLContentHandler.java&lt;br/&gt;
 ##########&lt;br/&gt;
 @@ -138,7 +138,12 @@ private void lazyStartHead() throws SAXException {&lt;/p&gt;

&lt;p&gt;             // Call directly, so we don&apos;t go through our startElement(), which will&lt;br/&gt;
             // ignore these elements.&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;super.startElement(XHTML, &quot;html&quot;, &quot;html&quot;, EMPTY_ATTRIBUTES);&lt;br/&gt;
+            AttributesImpl htmlAttrs = new AttributesImpl();&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt; Review comment:&lt;br/&gt;
   Hmm, did you mean attributes of the `&amp;lt;html&amp;gt;` tag, or html attributes in general ?&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16491109" author="githubbot" created="Fri, 25 May 2018 18:13:42 +0000"  >&lt;p&gt;tballison commented on a change in pull request #238: &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2100&quot; title=&quot;Html Parser does not keep the html tag attributes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2100&quot;&gt;&lt;del&gt;TIKA-2100&lt;/del&gt;&lt;/a&gt; extract content language from html lang attribute&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/tika/pull/238#discussion_r190971912&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/pull/238#discussion_r190971912&lt;/a&gt;&lt;/p&gt;



&lt;p&gt; ##########&lt;br/&gt;
 File path: tika-core/src/main/java/org/apache/tika/sax/XHTMLContentHandler.java&lt;br/&gt;
 ##########&lt;br/&gt;
 @@ -138,7 +138,12 @@ private void lazyStartHead() throws SAXException {&lt;/p&gt;

&lt;p&gt;             // Call directly, so we don&apos;t go through our startElement(), which will&lt;br/&gt;
             // ignore these elements.&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;super.startElement(XHTML, &quot;html&quot;, &quot;html&quot;, EMPTY_ATTRIBUTES);&lt;br/&gt;
+            AttributesImpl htmlAttrs = new AttributesImpl();&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt; Review comment:&lt;br/&gt;
   Sorry, right, attributes of `&amp;lt;html&amp;gt;`.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16491779" author="githubbot" created="Sat, 26 May 2018 18:48:40 +0000"  >&lt;p&gt;chrismattmann commented on a change in pull request #238: &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2100&quot; title=&quot;Html Parser does not keep the html tag attributes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2100&quot;&gt;&lt;del&gt;TIKA-2100&lt;/del&gt;&lt;/a&gt; extract content language from html lang attribute&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/tika/pull/238#discussion_r191056235&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/pull/238#discussion_r191056235&lt;/a&gt;&lt;/p&gt;



&lt;p&gt; ##########&lt;br/&gt;
 File path: tika-core/src/main/java/org/apache/tika/sax/XHTMLContentHandler.java&lt;br/&gt;
 ##########&lt;br/&gt;
 @@ -138,7 +138,12 @@ private void lazyStartHead() throws SAXException {&lt;/p&gt;

&lt;p&gt;             // Call directly, so we don&apos;t go through our startElement(), which will&lt;br/&gt;
             // ignore these elements.&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;super.startElement(XHTML, &quot;html&quot;, &quot;html&quot;, EMPTY_ATTRIBUTES);&lt;br/&gt;
+            AttributesImpl htmlAttrs = new AttributesImpl();&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt; Review comment:&lt;br/&gt;
   let&apos;s include :lang in the HTML attributes as well +1.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16491780" author="githubbot" created="Sat, 26 May 2018 18:49:01 +0000"  >&lt;p&gt;chrismattmann commented on issue #238: &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2100&quot; title=&quot;Html Parser does not keep the html tag attributes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2100&quot;&gt;&lt;del&gt;TIKA-2100&lt;/del&gt;&lt;/a&gt; extract content language from html lang attribute&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/tika/pull/238#issuecomment-392280901&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/pull/238#issuecomment-392280901&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   this LGTM - @tballison are we good to commit this?&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16491794" author="githubbot" created="Sat, 26 May 2018 19:22:18 +0000"  >&lt;p&gt;tballison commented on issue #238: &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2100&quot; title=&quot;Html Parser does not keep the html tag attributes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2100&quot;&gt;&lt;del&gt;TIKA-2100&lt;/del&gt;&lt;/a&gt; extract content language from html lang attribute&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/tika/pull/238#issuecomment-392282862&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/pull/238#issuecomment-392282862&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   It feels weird to me to allow such special handling of lang, but if you and&lt;br/&gt;
   fellow devs don&#8217;t mind, go for it.&lt;/p&gt;

&lt;p&gt;   On Sat, May 26, 2018 at 2:49 PM Chris Mattmann &amp;lt;notifications@github.com&amp;gt;&lt;br/&gt;
   wrote:&lt;/p&gt;

&lt;p&gt;   &amp;gt; this LGTM - @tballison &amp;lt;&lt;a href=&quot;https://github.com/tballison&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/tballison&lt;/a&gt;&amp;gt; are we good to&lt;br/&gt;
   &amp;gt; commit this?&lt;br/&gt;
   &amp;gt;&lt;br/&gt;
   &amp;gt; &#8212;&lt;br/&gt;
   &amp;gt; You are receiving this because you were mentioned.&lt;br/&gt;
   &amp;gt;&lt;br/&gt;
   &amp;gt;&lt;br/&gt;
   &amp;gt; Reply to this email directly, view it on GitHub&lt;br/&gt;
   &amp;gt; &amp;lt;&lt;a href=&quot;https://github.com/apache/tika/pull/238#issuecomment-392280901&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/pull/238#issuecomment-392280901&lt;/a&gt;&amp;gt;, or mute&lt;br/&gt;
   &amp;gt; the thread&lt;br/&gt;
   &amp;gt; &amp;lt;&lt;a href=&quot;https://github.com/notifications/unsubscribe-auth/AGbWvldSbrJarXkAigHsQiL5z7LgSguGks5t2aOqgaJpZM4UN5BA&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/notifications/unsubscribe-auth/AGbWvldSbrJarXkAigHsQiL5z7LgSguGks5t2aOqgaJpZM4UN5BA&lt;/a&gt;&amp;gt;&lt;br/&gt;
   &amp;gt; .&lt;br/&gt;
   &amp;gt;&lt;/p&gt;


&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16491795" author="githubbot" created="Sat, 26 May 2018 19:26:20 +0000"  >&lt;p&gt;chrismattmann commented on issue #238: &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2100&quot; title=&quot;Html Parser does not keep the html tag attributes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2100&quot;&gt;&lt;del&gt;TIKA-2100&lt;/del&gt;&lt;/a&gt; extract content language from html lang attribute&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/tika/pull/238#issuecomment-392283049&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/pull/238#issuecomment-392283049&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   @tballison I hear you and am open to alternatives. What is a better way to do this? I think missing the lang attribute is a pretty bad thing and have seen it in the past. It feels like HTMLParser as a parser should contribute it (and I don&apos;t think you object to that) perhaps via Metadata.set and then what should we do to propagate it?&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16491802" author="githubbot" created="Sat, 26 May 2018 19:41:59 +0000"  >&lt;p&gt;tballison commented on issue #238: &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2100&quot; title=&quot;Html Parser does not keep the html tag attributes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2100&quot;&gt;&lt;del&gt;TIKA-2100&lt;/del&gt;&lt;/a&gt; extract content language from html lang attribute&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/tika/pull/238#issuecomment-392283864&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/pull/238#issuecomment-392283864&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   If :lang is special, we should treat it specially &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;.  If there are other&lt;br/&gt;
   attrs that go on the html entity, we can add them later? Onward!&lt;/p&gt;

&lt;p&gt;   On Sat, May 26, 2018 at 3:26 PM Chris Mattmann &amp;lt;notifications@github.com&amp;gt;&lt;br/&gt;
   wrote:&lt;/p&gt;

&lt;p&gt;   &amp;gt; @tballison &amp;lt;&lt;a href=&quot;https://github.com/tballison&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/tballison&lt;/a&gt;&amp;gt; I hear you and am open to&lt;br/&gt;
   &amp;gt; alternatives. What is a better way to do this? I think missing the lang&lt;br/&gt;
   &amp;gt; attribute is a pretty bad thing and have seen it in the past. It feels like&lt;br/&gt;
   &amp;gt; HTMLParser as a parser should contribute it (and I don&apos;t think you object&lt;br/&gt;
   &amp;gt; to that) perhaps via Metadata.set and then what should we do to propagate&lt;br/&gt;
   &amp;gt; it?&lt;br/&gt;
   &amp;gt;&lt;br/&gt;
   &amp;gt; &#8212;&lt;br/&gt;
   &amp;gt; You are receiving this because you were mentioned.&lt;br/&gt;
   &amp;gt;&lt;br/&gt;
   &amp;gt;&lt;br/&gt;
   &amp;gt; Reply to this email directly, view it on GitHub&lt;br/&gt;
   &amp;gt; &amp;lt;&lt;a href=&quot;https://github.com/apache/tika/pull/238#issuecomment-392283049&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/pull/238#issuecomment-392283049&lt;/a&gt;&amp;gt;, or mute&lt;br/&gt;
   &amp;gt; the thread&lt;br/&gt;
   &amp;gt; &amp;lt;&lt;a href=&quot;https://github.com/notifications/unsubscribe-auth/AGbWvr0PxWiZRcDWrjJq2St5NmMcdldfks5t2axbgaJpZM4UN5BA&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/notifications/unsubscribe-auth/AGbWvr0PxWiZRcDWrjJq2St5NmMcdldfks5t2axbgaJpZM4UN5BA&lt;/a&gt;&amp;gt;&lt;br/&gt;
   &amp;gt; .&lt;br/&gt;
   &amp;gt;&lt;/p&gt;


&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16491804" author="githubbot" created="Sat, 26 May 2018 19:43:29 +0000"  >&lt;p&gt;tballison commented on issue #238: &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2100&quot; title=&quot;Html Parser does not keep the html tag attributes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2100&quot;&gt;&lt;del&gt;TIKA-2100&lt;/del&gt;&lt;/a&gt; extract content language from html lang attribute&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/tika/pull/238#issuecomment-392283950&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/pull/238#issuecomment-392283950&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   So... go forth!&lt;/p&gt;

&lt;p&gt;   Side note: It&#8217;d be fun to see counts for elements w a lang attr in our&lt;br/&gt;
   corpus.&lt;/p&gt;

&lt;p&gt;   On Sat, May 26, 2018 at 3:41 PM Tim Allison &amp;lt;tallison@apache.org&amp;gt; wrote:&lt;/p&gt;

&lt;p&gt;   &amp;gt; If :lang is special, we should treat it specially &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;.  If there are other&lt;br/&gt;
   &amp;gt; attrs that go on the html entity, we can add them later? Onward!&lt;br/&gt;
   &amp;gt;&lt;br/&gt;
   &amp;gt; On Sat, May 26, 2018 at 3:26 PM Chris Mattmann &amp;lt;notifications@github.com&amp;gt;&lt;br/&gt;
   &amp;gt; wrote:&lt;br/&gt;
   &amp;gt;&lt;br/&gt;
   &amp;gt;&amp;gt; @tballison &amp;lt;&lt;a href=&quot;https://github.com/tballison&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/tballison&lt;/a&gt;&amp;gt; I hear you and am open to&lt;br/&gt;
   &amp;gt;&amp;gt; alternatives. What is a better way to do this? I think missing the lang&lt;br/&gt;
   &amp;gt;&amp;gt; attribute is a pretty bad thing and have seen it in the past. It feels like&lt;br/&gt;
   &amp;gt;&amp;gt; HTMLParser as a parser should contribute it (and I don&apos;t think you object&lt;br/&gt;
   &amp;gt;&amp;gt; to that) perhaps via Metadata.set and then what should we do to propagate&lt;br/&gt;
   &amp;gt;&amp;gt; it?&lt;br/&gt;
   &amp;gt;&amp;gt;&lt;br/&gt;
   &amp;gt;&amp;gt; &#8212;&lt;br/&gt;
   &amp;gt;&amp;gt; You are receiving this because you were mentioned.&lt;br/&gt;
   &amp;gt;&amp;gt;&lt;br/&gt;
   &amp;gt;&amp;gt;&lt;br/&gt;
   &amp;gt;&amp;gt; Reply to this email directly, view it on GitHub&lt;br/&gt;
   &amp;gt;&amp;gt; &amp;lt;&lt;a href=&quot;https://github.com/apache/tika/pull/238#issuecomment-392283049&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/pull/238#issuecomment-392283049&lt;/a&gt;&amp;gt;, or mute&lt;br/&gt;
   &amp;gt;&amp;gt; the thread&lt;br/&gt;
   &amp;gt;&amp;gt; &amp;lt;&lt;a href=&quot;https://github.com/notifications/unsubscribe-auth/AGbWvr0PxWiZRcDWrjJq2St5NmMcdldfks5t2axbgaJpZM4UN5BA&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/notifications/unsubscribe-auth/AGbWvr0PxWiZRcDWrjJq2St5NmMcdldfks5t2axbgaJpZM4UN5BA&lt;/a&gt;&amp;gt;&lt;br/&gt;
   &amp;gt;&amp;gt; .&lt;br/&gt;
   &amp;gt;&amp;gt;&lt;br/&gt;
   &amp;gt;&lt;/p&gt;


&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16492361" author="githubbot" created="Mon, 28 May 2018 07:42:29 +0000"  >&lt;p&gt;GerardBouchar commented on a change in pull request #238: &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2100&quot; title=&quot;Html Parser does not keep the html tag attributes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2100&quot;&gt;&lt;del&gt;TIKA-2100&lt;/del&gt;&lt;/a&gt; extract content language from html lang attribute&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/tika/pull/238#discussion_r191133539&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/pull/238#discussion_r191133539&lt;/a&gt;&lt;/p&gt;



&lt;p&gt; ##########&lt;br/&gt;
 File path: tika-core/src/main/java/org/apache/tika/sax/XHTMLContentHandler.java&lt;br/&gt;
 ##########&lt;br/&gt;
 @@ -138,7 +138,12 @@ private void lazyStartHead() throws SAXException {&lt;/p&gt;

&lt;p&gt;             // Call directly, so we don&apos;t go through our startElement(), which will&lt;br/&gt;
             // ignore these elements.&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;super.startElement(XHTML, &quot;html&quot;, &quot;html&quot;, EMPTY_ATTRIBUTES);&lt;br/&gt;
+            AttributesImpl htmlAttrs = new AttributesImpl();&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt; Review comment:&lt;br/&gt;
   So the answer is no, I do not need other attributes of the `&amp;lt;html&amp;gt;` tag.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16492363" author="githubbot" created="Mon, 28 May 2018 07:44:15 +0000"  >&lt;p&gt;GerardBouchar commented on issue #238: &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2100&quot; title=&quot;Html Parser does not keep the html tag attributes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2100&quot;&gt;&lt;del&gt;TIKA-2100&lt;/del&gt;&lt;/a&gt; extract content language from html lang attribute&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/tika/pull/238#issuecomment-392447144&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/pull/238#issuecomment-392447144&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   So, do I still need to change something ?&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16492574" author="githubbot" created="Mon, 28 May 2018 11:35:06 +0000"  >&lt;p&gt;tballison commented on issue #238: &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2100&quot; title=&quot;Html Parser does not keep the html tag attributes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2100&quot;&gt;&lt;del&gt;TIKA-2100&lt;/del&gt;&lt;/a&gt; extract content language from html lang attribute&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/tika/pull/238#issuecomment-392503182&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/pull/238#issuecomment-392503182&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   You&#8217;re good. I&#8217;m away from my keyboard today but will be back tomorrow.&lt;/p&gt;

&lt;p&gt;   On Mon, May 28, 2018 at 3:44 AM GerardBouchar &amp;lt;notifications@github.com&amp;gt;&lt;br/&gt;
   wrote:&lt;/p&gt;

&lt;p&gt;   &amp;gt; So, do I still need to change something ?&lt;br/&gt;
   &amp;gt;&lt;br/&gt;
   &amp;gt; &#8212;&lt;br/&gt;
   &amp;gt; You are receiving this because you were mentioned.&lt;br/&gt;
   &amp;gt;&lt;br/&gt;
   &amp;gt;&lt;br/&gt;
   &amp;gt; Reply to this email directly, view it on GitHub&lt;br/&gt;
   &amp;gt; &amp;lt;&lt;a href=&quot;https://github.com/apache/tika/pull/238#issuecomment-392447144&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/pull/238#issuecomment-392447144&lt;/a&gt;&amp;gt;, or mute&lt;br/&gt;
   &amp;gt; the thread&lt;br/&gt;
   &amp;gt; &amp;lt;&lt;a href=&quot;https://github.com/notifications/unsubscribe-auth/AGbWvlyh0Z_j2wiQW_JBVwMc-C9GgVMMks5t26rfgaJpZM4UN5BA&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/notifications/unsubscribe-auth/AGbWvlyh0Z_j2wiQW_JBVwMc-C9GgVMMks5t26rfgaJpZM4UN5BA&lt;/a&gt;&amp;gt;&lt;br/&gt;
   &amp;gt; .&lt;br/&gt;
   &amp;gt;&lt;/p&gt;


&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16494009" author="githubbot" created="Tue, 29 May 2018 18:24:39 +0000"  >&lt;p&gt;tballison closed pull request #238: &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2100&quot; title=&quot;Html Parser does not keep the html tag attributes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2100&quot;&gt;&lt;del&gt;TIKA-2100&lt;/del&gt;&lt;/a&gt; extract content language from html lang attribute&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/tika/pull/238&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/pull/238&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;This is a PR merged from a forked repository.&lt;br/&gt;
As GitHub hides the original diff on merge, it is displayed below for&lt;br/&gt;
the sake of provenance:&lt;/p&gt;

&lt;p&gt;As this is a foreign pull request (from a fork), the diff is supplied&lt;br/&gt;
below (as it won&apos;t show otherwise due to GitHub magic):&lt;/p&gt;

&lt;p&gt;diff --git a/tika-core/src/main/java/org/apache/tika/sax/XHTMLContentHandler.java b/tika-core/src/main/java/org/apache/tika/sax/XHTMLContentHandler.java&lt;br/&gt;
index 4742339fa..a2008208f 100644&lt;br/&gt;
&amp;#8212; a/tika-core/src/main/java/org/apache/tika/sax/XHTMLContentHandler.java&lt;br/&gt;
+++ b/tika-core/src/main/java/org/apache/tika/sax/XHTMLContentHandler.java&lt;br/&gt;
@@ -138,7 +138,12 @@ private void lazyStartHead() throws SAXException {&lt;/p&gt;

&lt;p&gt;             // Call directly, so we don&apos;t go through our startElement(), which will&lt;br/&gt;
             // ignore these elements.&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;super.startElement(XHTML, &quot;html&quot;, &quot;html&quot;, EMPTY_ATTRIBUTES);&lt;br/&gt;
+            AttributesImpl htmlAttrs = new AttributesImpl();&lt;br/&gt;
+            String lang = metadata.get(Metadata.CONTENT_LANGUAGE);&lt;br/&gt;
+            if (lang != null) 
{
+                htmlAttrs.addAttribute(&quot;&quot;, &quot;lang&quot;, &quot;lang&quot;, &quot;CDATA&quot;, lang);
+            }
&lt;p&gt;+            super.startElement(XHTML, &quot;html&quot;, &quot;html&quot;, htmlAttrs);&lt;br/&gt;
             newline();&lt;br/&gt;
             super.startElement(XHTML, &quot;head&quot;, &quot;head&quot;, EMPTY_ATTRIBUTES);&lt;br/&gt;
             newline();&lt;br/&gt;
diff --git a/tika-parsers/src/main/java/org/apache/tika/parser/html/HtmlHandler.java b/tika-parsers/src/main/java/org/apache/tika/parser/html/HtmlHandler.java&lt;br/&gt;
index a803f7699..18a1025d7 100644&lt;/p&gt;
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;a/tika-parsers/src/main/java/org/apache/tika/parser/html/HtmlHandler.java&lt;br/&gt;
+++ b/tika-parsers/src/main/java/org/apache/tika/parser/html/HtmlHandler.java&lt;br/&gt;
@@ -119,6 +119,9 @@ public void startElement(&lt;br/&gt;
             String uri, String local, String name, Attributes atts)&lt;br/&gt;
             throws SAXException {&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;+        if (&quot;HTML&quot;.equals(name) &amp;amp;&amp;amp; atts.getValue(&quot;lang&quot;) != null) &lt;/p&gt;
{
+            metadata.set(Metadata.CONTENT_LANGUAGE, atts.getValue(&quot;lang&quot;));
+        }
&lt;p&gt;         if (&quot;SCRIPT&quot;.equals(name)) &lt;/p&gt;
{
             scriptLevel++;
         }
&lt;p&gt;diff --git a/tika-parsers/src/test/java/org/apache/tika/parser/html/HtmlParserTest.java b/tika-parsers/src/test/java/org/apache/tika/parser/html/HtmlParserTest.java&lt;br/&gt;
index def25d16b..cf3bd78a5 100644&lt;br/&gt;
&amp;#8212; a/tika-parsers/src/test/java/org/apache/tika/parser/html/HtmlParserTest.java&lt;br/&gt;
+++ b/tika-parsers/src/test/java/org/apache/tika/parser/html/HtmlParserTest.java&lt;br/&gt;
@@ -873,6 +873,25 @@ public void testNewlineAndIndent() throws Exception &lt;/p&gt;
{
         assertTrue(Pattern.matches(&quot;\tone\n\n&quot;, result));
     }

&lt;p&gt;+    /**&lt;br/&gt;
+     * Test case for Tika-2100&lt;br/&gt;
+     * @see &amp;lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2100&quot;&amp;gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2100&quot; title=&quot;Html Parser does not keep the html tag attributes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2100&quot;&gt;&lt;del&gt;TIKA-2100&lt;/del&gt;&lt;/a&gt;&amp;lt;/a&amp;gt;&lt;br/&gt;
+     */&lt;br/&gt;
+    @Test&lt;br/&gt;
+    public void testHtmlLanguage() throws Exception &lt;/p&gt;
{
+        final String html = &quot;&amp;lt;html lang=\&quot;fr\&quot;&amp;gt;&amp;lt;/html&amp;gt;&quot;;
+
+        StringWriter sw = new StringWriter();
+        Metadata metadata = new Metadata();
+        new HtmlParser().parse(
+                new ByteArrayInputStream(html.getBytes(UTF_8)),
+                makeHtmlTransformer(sw), metadata, new ParseContext());
+
+        assertEquals(&quot;fr&quot;, metadata.get(Metadata.CONTENT_LANGUAGE));
+        assertTrue(&quot;Missing HTML lang attribute&quot;,
+                Pattern.matches(&quot;(?s)&amp;lt;html[^&amp;gt;]* lang=\&quot;fr\&quot;.*&quot;, sw.toString()));
+    }
&lt;p&gt;+&lt;br/&gt;
     /**&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Test case for &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-961&quot; title=&quot;No whitespace added if BoilerpipeContentHandler.setIncludeMarkup(true)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-961&quot;&gt;&lt;del&gt;TIKA-961&lt;/del&gt;&lt;/a&gt;&lt;br/&gt;
      *&lt;/li&gt;
&lt;/ul&gt;





&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16494014" author="tallison@mitre.org" created="Tue, 29 May 2018 18:28:13 +0000"  >&lt;p&gt;Thank you &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Gerard+Bouchar&quot; class=&quot;user-hover&quot; rel=&quot;Gerard Bouchar&quot;&gt;Gerard Bouchar&lt;/a&gt;!&lt;/p&gt;</comment>
                            <comment id="16494068" author="hudson" created="Tue, 29 May 2018 19:01:24 +0000"  >&lt;p&gt;UNSTABLE: Integrated in Jenkins build Tika-trunk #1494 (See &lt;a href=&quot;https://builds.apache.org/job/Tika-trunk/1494/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Tika-trunk/1494/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2100&quot; title=&quot;Html Parser does not keep the html tag attributes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2100&quot;&gt;&lt;del&gt;TIKA-2100&lt;/del&gt;&lt;/a&gt; extract content language from html lang attribute (gbouchar: &lt;a href=&quot;https://github.com/apache/tika/commit/7536ed91afd9a3fe744464e34f95f3108c6bd5a2&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/7536ed91afd9a3fe744464e34f95f3108c6bd5a2&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/html/HtmlHandler.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/test/java/org/apache/tika/parser/html/HtmlParserTest.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-core/src/main/java/org/apache/tika/sax/XHTMLContentHandler.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="16494082" author="hudson" created="Tue, 29 May 2018 19:11:59 +0000"  >&lt;p&gt;UNSTABLE: Integrated in Jenkins build tika-branch-1x #33 (See &lt;a href=&quot;https://builds.apache.org/job/tika-branch-1x/33/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/tika-branch-1x/33/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2100&quot; title=&quot;Html Parser does not keep the html tag attributes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2100&quot;&gt;&lt;del&gt;TIKA-2100&lt;/del&gt;&lt;/a&gt; extract content language from html lang attribute (tallison: &lt;a href=&quot;https://github.com/apache/tika/commit/8d26096e9d579bee74ac01df9ae773e66e0bfc74&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/8d26096e9d579bee74ac01df9ae773e66e0bfc74&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) tika-parsers/src/test/java/org/apache/tika/parser/html/HtmlParserTest.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/html/HtmlHandler.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-core/src/main/java/org/apache/tika/sax/XHTMLContentHandler.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="16494098" author="hudson" created="Tue, 29 May 2018 19:16:46 +0000"  >&lt;p&gt;FAILURE: Integrated in Jenkins build tika-2.x-windows #260 (See &lt;a href=&quot;https://builds.apache.org/job/tika-2.x-windows/260/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/tika-2.x-windows/260/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2100&quot; title=&quot;Html Parser does not keep the html tag attributes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2100&quot;&gt;&lt;del&gt;TIKA-2100&lt;/del&gt;&lt;/a&gt; extract content language from html lang attribute (gbouchar: rev 7536ed91afd9a3fe744464e34f95f3108c6bd5a2)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) tika-core/src/main/java/org/apache/tika/sax/XHTMLContentHandler.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/html/HtmlHandler.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/test/java/org/apache/tika/parser/html/HtmlParserTest.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="16495677" author="hudson" created="Wed, 30 May 2018 21:07:13 +0000"  >&lt;p&gt;SUCCESS: Integrated in Jenkins build tika-branch-1x #35 (See &lt;a href=&quot;https://builds.apache.org/job/tika-branch-1x/35/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/tika-branch-1x/35/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2100&quot; title=&quot;Html Parser does not keep the html tag attributes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2100&quot;&gt;&lt;del&gt;TIKA-2100&lt;/del&gt;&lt;/a&gt; &amp;#8211; fix unit test (tallison: &lt;a href=&quot;https://github.com/apache/tika/commit/e9d807de07d0d592878e147b8e103930c46ddc21&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/e9d807de07d0d592878e147b8e103930c46ddc21&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) tika-parsers/src/test/java/org/apache/tika/parser/html/HtmlParserTest.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="16495678" author="hudson" created="Wed, 30 May 2018 21:07:22 +0000"  >&lt;p&gt;SUCCESS: Integrated in Jenkins build Tika-trunk #1496 (See &lt;a href=&quot;https://builds.apache.org/job/Tika-trunk/1496/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Tika-trunk/1496/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2100&quot; title=&quot;Html Parser does not keep the html tag attributes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2100&quot;&gt;&lt;del&gt;TIKA-2100&lt;/del&gt;&lt;/a&gt; &amp;#8211; fix unit test (tallison: &lt;a href=&quot;https://github.com/apache/tika/commit/198d5ef995532f262c970f2ef76e64b852bed7f4&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/198d5ef995532f262c970f2ef76e64b852bed7f4&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) tika-parsers/src/test/java/org/apache/tika/parser/html/HtmlParserTest.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="16495754" author="hudson" created="Wed, 30 May 2018 22:04:27 +0000"  >&lt;p&gt;UNSTABLE: Integrated in Jenkins build tika-2.x-windows #262 (See &lt;a href=&quot;https://builds.apache.org/job/tika-2.x-windows/262/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/tika-2.x-windows/262/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2100&quot; title=&quot;Html Parser does not keep the html tag attributes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2100&quot;&gt;&lt;del&gt;TIKA-2100&lt;/del&gt;&lt;/a&gt; &amp;#8211; fix unit test (tallison: rev 198d5ef995532f262c970f2ef76e64b852bed7f4)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) tika-parsers/src/test/java/org/apache/tika/parser/html/HtmlParserTest.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 24 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i346w7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>