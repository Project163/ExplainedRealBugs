<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:01:10 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[TIKA-2313] Old Word document (Word 6.0, 1997) has a badly encoded(?) output.</title>
                <link>https://issues.apache.org/jira/browse/TIKA-2313</link>
                <project id="12310631" key="TIKA">Tika</project>
                    <description>&lt;p&gt;I&apos;ve a really old Word document (last date of modification is December 1997) which was written with Microsoft Word 6.0.&lt;/p&gt;

&lt;p&gt;When I attempt to use Tika to extract the contents of the document, I receive an incorrect output. The output seems to be in Chinese, but I actually believe that the encoding of the document is not correctly mapped with the output encoding which causes characters to be thrown off. I&apos;m a complete beginner in document encodings so could be wrong here!&lt;/p&gt;

&lt;p&gt;I did see &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-721&quot; title=&quot;UTF16-LE not detected&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-721&quot;&gt;TIKA-721&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2038&quot; title=&quot;A more accurate facility for detecting Charset Encoding of HTML documents&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2038&quot;&gt;TIKA-2038&lt;/a&gt;, but neither seem to be related to older documents. I&apos;ve also read that Tika should support Word 6.0 so not sure.&lt;/p&gt;

&lt;p&gt;My guess for the moment is that the encoding within the document has incorrect character mappings. It&apos;s possible using an incompatible mapping that, when Tika converts into its UTF-16 output, maps to Chinese characters instead of the correct ones.&lt;/p&gt;

&lt;p&gt;What&apos;s interesting is that Tika correctly extracts all the metadata, including the document title, which is presumably in the same encoding as the document body.&lt;/p&gt;

&lt;p&gt;I have 2 questions:&lt;br/&gt;
1. Is there something I can pass to Tika to help out in detecting the encoding?&lt;br/&gt;
2. Is there a way of detecting this kind of bad output? In my application the number of documents like this is very small, but I don&apos;t have a very reliable way of detecting that the output is garbage.&lt;/p&gt;

&lt;p&gt;Like I said, quite a beginner with Tika so if there&apos;s any further commands you would like me to run please say.&lt;/p&gt;

&lt;p&gt;Here is the output of:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;java -jar tika-app-1.14.jar old.DOC&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;&amp;lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&amp;gt;&amp;lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&amp;gt;
&amp;lt;head&amp;gt;
&amp;lt;meta name=&quot;cp:revision&quot; content=&quot;3&quot;/&amp;gt;
&amp;lt;meta name=&quot;date&quot; content=&quot;1997-12-12T12:57:00Z&quot;/&amp;gt;
&amp;lt;meta name=&quot;meta:word-count&quot; content=&quot;38&quot;/&amp;gt;
&amp;lt;meta name=&quot;dc:creator&quot; content=&quot;Preferred Customer&quot;/&amp;gt;
&amp;lt;meta name=&quot;meta:print-date&quot; content=&quot;1997-12-12T11:31:00Z&quot;/&amp;gt;
&amp;lt;meta name=&quot;Word-Count&quot; content=&quot;38&quot;/&amp;gt;
&amp;lt;meta name=&quot;dcterms:created&quot; content=&quot;1997-12-12T11:31:00Z&quot;/&amp;gt;
&amp;lt;meta name=&quot;dcterms:modified&quot; content=&quot;1997-12-12T12:57:00Z&quot;/&amp;gt;
&amp;lt;meta name=&quot;Last-Modified&quot; content=&quot;1997-12-12T12:57:00Z&quot;/&amp;gt;
&amp;lt;meta name=&quot;Last-Save-Date&quot; content=&quot;1997-12-12T12:57:00Z&quot;/&amp;gt;
&amp;lt;meta name=&quot;meta:character-count&quot; content=&quot;227&quot;/&amp;gt;
&amp;lt;meta name=&quot;Template&quot; content=&quot;C:\MSOFFICE\WINWORD\MODELES\FAXLYON.DOT&quot;/&amp;gt;
&amp;lt;meta name=&quot;meta:save-date&quot; content=&quot;1997-12-12T12:57:00Z&quot;/&amp;gt;
&amp;lt;meta name=&quot;dc:title&quot; content=&quot;KATALYSE&quot;/&amp;gt;
&amp;lt;meta name=&quot;Application-Name&quot; content=&quot;Microsoft Word 6.0&quot;/&amp;gt;
&amp;lt;meta name=&quot;modified&quot; content=&quot;1997-12-12T12:57:00Z&quot;/&amp;gt;
&amp;lt;meta name=&quot;Edit-Time&quot; content=&quot;8400000000&quot;/&amp;gt;
&amp;lt;meta name=&quot;Content-Length&quot; content=&quot;20480&quot;/&amp;gt;
&amp;lt;meta name=&quot;Content-Type&quot; content=&quot;application/msword&quot;/&amp;gt;
&amp;lt;meta name=&quot;X-Parsed-By&quot; content=&quot;org.apache.tika.parser.DefaultParser&quot;/&amp;gt;
&amp;lt;meta name=&quot;X-Parsed-By&quot; content=&quot;org.apache.tika.parser.microsoft.OfficeParser&quot;/&amp;gt;
&amp;lt;meta name=&quot;creator&quot; content=&quot;Preferred Customer&quot;/&amp;gt;
&amp;lt;meta name=&quot;meta:author&quot; content=&quot;Preferred Customer&quot;/&amp;gt;
&amp;lt;meta name=&quot;extended-properties:Application&quot; content=&quot;Microsoft Word 6.0&quot;/&amp;gt;
&amp;lt;meta name=&quot;meta:creation-date&quot; content=&quot;1997-12-12T11:31:00Z&quot;/&amp;gt;
&amp;lt;meta name=&quot;Last-Printed&quot; content=&quot;1997-12-12T11:31:00Z&quot;/&amp;gt;
&amp;lt;meta name=&quot;meta:last-author&quot; content=&quot;Preferred Customer&quot;/&amp;gt;
&amp;lt;meta name=&quot;Creation-Date&quot; content=&quot;1997-12-12T11:31:00Z&quot;/&amp;gt;
&amp;lt;meta name=&quot;xmpTPg:NPages&quot; content=&quot;1&quot;/&amp;gt;
&amp;lt;meta name=&quot;resourceName&quot; content=&quot;old.DOC&quot;/&amp;gt;
&amp;lt;meta name=&quot;Last-Author&quot; content=&quot;Preferred Customer&quot;/&amp;gt;
&amp;lt;meta name=&quot;Character Count&quot; content=&quot;227&quot;/&amp;gt;
&amp;lt;meta name=&quot;Page-Count&quot; content=&quot;1&quot;/&amp;gt;
&amp;lt;meta name=&quot;Revision-Number&quot; content=&quot;3&quot;/&amp;gt;
&amp;lt;meta name=&quot;extended-properties:Template&quot; content=&quot;C:\MSOFFICE\WINWORD\MODELES\FAXLYON.DOT&quot;/&amp;gt;
&amp;lt;meta name=&quot;Author&quot; content=&quot;Preferred Customer&quot;/&amp;gt;
&amp;lt;meta name=&quot;meta:page-count&quot; content=&quot;1&quot;/&amp;gt;
&amp;lt;title&amp;gt;KATALYSE&amp;lt;/title&amp;gt;
&amp;lt;/head&amp;gt;
&amp;lt;body&amp;gt;&amp;lt;p&amp;gt;&#16715;&#16724;&#22860;&#17747;&#3341;&#3341;&#16708;&#17748;&#14880;&#17421;&#29793;&#1893;&#17427;&#21569;&#8261;&#16476;&#27168;&#12138;&#19789;&#24879;&#5217;&#12849;&#12591;&#12082;&#14137;&#1813;&#1799;&#1799;&#8257;&#10060;&#21569;&#17748;&#21582;&#20297;&#8270;&#17732;&#14880;&#21517;&#8303;&#29261;&#8307;&#29295;&amp;lt;/p&amp;gt;
&amp;lt;p&amp;gt;&#12849;&#12849;&amp;lt;/p&amp;gt;
&amp;lt;p&amp;gt;&#19759;&amp;lt;/p&amp;gt;
&amp;lt;p&amp;gt;&#12849;&#14137;&amp;lt;/p&amp;gt;
&amp;lt;p&amp;gt;&#24879;&amp;lt;/p&amp;gt;
&amp;lt;p&amp;gt;&#14137;&#6669;&amp;lt;/p&amp;gt;
&amp;lt;p&amp;gt;&#1813;&#1799;&#1799;&#8257;&#10060;&#21569;&#17748;&#21582;&#20297;&#8270;&#17732;&#14880;&#21517;&#8303;&#29261;&#8307;&#29295;&#19744;&#1906;&#11853;&#16928;&#21061;&#18516;&#17487;&#1805;&#1799;&#1799;&#21071;&#16711;&#18766;&#19795;&#8261;&#3386;&#28483;&#28781;&#28257;&#1913;&#28499;&#26979;&#29929;&#8425;&#20545;&#19536;&#17225;&#19535;&#21071;&#1805;&#1799;&#1799;&#45134;&#17440;&#8261;&#17748;&#17740;&#20291;&#18768;&#21829;&#8274;&#3386;&#24902;&#8312;&#28192;&#1968;&#13360;&#14112;&#8249;&#13112;&#12832;&#8240;&#13620;&#1805;&#1799;&#1799;&#16720;&#17735;&#11347;&#22816;&#17184;&#19791;&#21072;&#21321;&#17184;&#19525;&#17740;&#17197;&#8265;&#3386;&#24912;&#25959;&#11379;&#26912;&#25454;&#30060;&#26980;&#26478;&#29728;&#26984;&#8307;&#28271;&#1893;&#1841;&#1799;&#1799;&#17732;&#19488;&#8257;&#16720;&#21586;&#17440;&#8261;&#14880;&#17933;&#28530;&#1901;&#30023;&#8313;&#17740;&#20291;&#17740;&#1799;&#3341;&#3341;&#3341;&#28493;&#29550;&#25961;&#29301;&#3372;&#3341;&#30035;&#29801;&#8293;&#8416;&#28526;&#29300;&#8293;&#59762;&#25955;&#29806;&#25376;&#28271;&#24948;&#29795;&#29728;&#27881;&#28905;&#28520;&#26990;&#30065;&#11365;&#27168;&#24871;&lt;span contenteditable=&quot;false&quot; class=&quot;bidi-unicode&quot; title=&quot;Bidirectional characters change the order that text is rendered. This could be used to obscure malicious code.&quot; data-bidi-character-code=&quot;2069&quot;&gt;&#8297;&lt;!--Bidi char--&gt;&lt;/span&gt;&#25964;&#28704;&#24940;&#29545;&#29289;&#25632;&#8293;&#28515;&#26222;&#29289;&#25965;&#8306;&#28526;&#29300;&#8293;&#25970;&#25710;&#31333;&#30253;&#30063;&#8307;&#30052;&#12576;&#8249;&#59748;&#25955;&#25197;&#25970;&#28704;&#28530;&#26723;&#26977;&#8302;&#8416;&#13617;&#12392;&#8240;&#24932;&#29550;&#30240;&#29551;&#27680;&#25455;&#30049;&#8312;&#25956;&#22048;&#26479;&#24940;&#29550;&#3374;&#18957;&#8293;&#28534;&#29557;&#28704;&#59762;&#25971;&#29806;&#29285;&#26977;&#27680;&#29295;&#8307;&#25956;&#25376;&#29797;&#25972;&#29216;&#30185;&#26990;&#28271;&#27680;&#29541;&#25376;&#28271;&#27747;&#29557;&#28521;&#29550;&#25632;&#8309;&#29296;&#11753;&#26980;&#26465;&#28526;&#29811;&#25449;&#29472;&#29300;&#29793;&#26601;&#29033;&#25973;&#3374;&#3341;&#24900;&#29550;&#25376;&#29797;&#25972;&#24864;&#29812;&#28261;&#25972;&lt;span contenteditable=&quot;false&quot; class=&quot;bidi-unicode&quot; title=&quot;Bidirectional characters change the order that text is rendered. This could be used to obscure malicious code.&quot; data-bidi-character-code=&quot;202C&quot;&gt;&#8236;&lt;!--Bidi char--&gt;&lt;/span&gt;&#25962;&#30240;&#30063;&#8307;&#29296;&#25961;&#25632;&#8293;&#29283;&#26991;&#25970;&lt;span contenteditable=&quot;false&quot; class=&quot;bidi-unicode&quot; title=&quot;Bidirectional characters change the order that text is rendered. This could be used to obscure malicious code.&quot; data-bidi-character-code=&quot;202C&quot;&gt;&#8236;&lt;!--Bidi char--&gt;&lt;/span&gt;&#28493;&#29550;&#25961;&#29301;&lt;span contenteditable=&quot;false&quot; class=&quot;bidi-unicode&quot; title=&quot;Bidirectional characters change the order that text is rendered. This could be used to obscure malicious code.&quot; data-bidi-character-code=&quot;202C&quot;&gt;&#8236;&lt;!--Bidi char--&gt;&lt;/span&gt;&#8416;&#10092;&#29537;&#30067;&#24946;&#25454;&#8293;&#25956;&#27936;&#29541;&#29472;&#28261;&#26996;&#25965;&#29806;&#8307;&#25964;&#8307;&#25965;&#27753;&#25964;&#29301;&#11891;&#3341;&#3341;&#3341;&#3341;&#18185;&#22869;&#19488;&#17221;&#19535;&#3397;&#3341;&#12593;&lt;span contenteditable=&quot;false&quot; class=&quot;bidi-unicode&quot; title=&quot;Bidirectional characters change the order that text is rendered. This could be used to obscure malicious code.&quot; data-bidi-character-code=&quot;202C&quot;&gt;&#8236;&lt;!--Bidi char--&gt;&lt;/span&gt;&#30066;&#8293;&#30023;&#27753;&#28524;&#25717;&#11552;&#13856;&#12345;&#13104;&#19488;&#20313;&#8270;&lt;span contenteditable=&quot;false&quot; class=&quot;bidi-unicode&quot; title=&quot;Bidirectional characters change the order that text is rendered. This could be used to obscure malicious code.&quot; data-bidi-character-code=&quot;202D&quot;&gt;&#8237;&lt;!--Bidi char--&gt;&lt;/span&gt;&#59732;&#11884;&#14880;&#12320;&#11828;&#12855;&#13870;&#11832;&#14384;&#12334;&#8248;&lt;span contenteditable=&quot;false&quot; class=&quot;bidi-unicode&quot; title=&quot;Bidirectional characters change the order that text is rendered. This could be used to obscure malicious code.&quot; data-bidi-character-code=&quot;202D&quot;&gt;&#8237;&lt;!--Bidi char--&gt;&lt;/span&gt;&#24902;&#8312;&#8250;&#13360;&#14126;&#11826;&#14390;&#12334;&#11827;&#13878;&#21261;&#16686;&lt;span contenteditable=&quot;false&quot; class=&quot;bidi-unicode&quot; title=&quot;Bidirectional characters change the order that text is rendered. This could be used to obscure malicious code.&quot; data-bidi-character-code=&quot;202E&quot;&gt;&#8238;&lt;!--Bidi char--&gt;&lt;/span&gt;&#30049;&#25376;&#28769;&#29801;&#27745;&#25632;&#8293;&#13877;&#8246;&#12336;&#8240;&#21062;&#11859;&#21024;&#17198;&#21294;&lt;span contenteditable=&quot;false&quot; class=&quot;bidi-unicode&quot; title=&quot;Bidirectional characters change the order that text is rendered. This could be used to obscure malicious code.&quot; data-bidi-character-code=&quot;202E&quot;&gt;&#8238;&lt;!--Bidi char--&gt;&lt;/span&gt;&#24912;&#26994;&#8307;&#16928;&#13088;&#14647;&#13600;&#13878;&#14112;&#12599;&#3341;&#3341;&#65533;&#2713;&#33700;&#42286;&#16840;&#35494;&#42757;&#1418;&#21416;&#43267;&#1418;&#396;&#36096;&#65533;&#12849;&#12849;&#14137;&#6669;&#39168;&#41994;&#11907;&#51365;&#42561;&#1418;&#35495;&#43013;&#851;&#35497;&#35845;&#65533;&#397;&#256;&#448;&#575;&#259;&#448;&#9791;&#63551;&#1793;&#61441;&#1795;&#32801;&#256;&#25568;&#224;&#61567;&#1793;&#32833;&#32512;&#65379;&#496;&#259;&#384;&#10527;&#61695;&#7969;&#17404;~&#10755;&#57599;&#1793;&#7981;&#8696;&#65287;&#769;&#49153;&#16129;&#63270;&#480;&#9791;&#57599;&#7937;&#49153;&#65313;&#496;&#10511;&#63551;&#257;&#1799;&#63489;&#65331;&#3264;&#767;&#257;&#512;&#771;&#33792;&#16161;&#8688;&#65287;&#57347;&#3841;&#65027;&#7970;&#17400;&#224;&#263;&#256;&#8575;&#1792;&#32769;&#7969;&#504;&#263;&#8576;&#63519;&#32549;&#496;&#17667;&#65039;&#8448;&#61567;&#49155;&#16129;&#3842;&#65533;&#16161;&#9200;&#224;&#65533;&#3873;&#764;&#1276;&#257;&#8640;&#65039;&#64515;&#257;&#49163;&#801;&#3583;&#496;&#515;&#263;&#8576;&#63519;&#65317;&#448;&#1311;&#257;&#448;&#527;&#257;&#8672;&#65031;&#61449;&#65533;&#49153;&#773;&#65025;&#274;&#269;&#65033;&#65533;&#8555;&#57471;&#769;&#32772;&#3876;&#2044;&#8640;&#65039;&#16130;&#65059;&#256;&#8975;&#254;&#3841;&#65318;&#480;&#9473;&#64543;&#16130;&#32772;&#7969;&#760;&#764;&#1055;&#8640;&#65031;&#1797;&#773;&#32769;&#1793;&#63492;&#32771;&#263;&#32769;&#260;&#16138;&#65062;&#256;&#1807;&#640;&#1272;&#259;&#384;&#1031;&#384;&#10499;&#57471;&#265;&#65313;&#4992;&#12161;&#65027;&#1795;&#65027;&#65533;&#637;&#448;&#513;&#287;&#9216;&#63519;&#3842;&#32772;&#64514;&#3877;&#1020;&#8700;&#64527;&#64515;&#49158;&#63496;&#7938;&#65533;&#7972;&#1016;&#1016;&#8576;&#64527;&#1794;&#65286;&#768;&#65533;&#777;&#65533;&amp;lt;/p&amp;gt;
&amp;lt;p&amp;gt;&#6669;&amp;lt;/p&amp;gt;
&amp;lt;p&amp;gt;&#3341;&amp;lt;/p&amp;gt;
&amp;lt;p&amp;gt;&#12557;&amp;lt;/p&amp;gt;
&amp;lt;p&amp;gt;&#12593;&lt;span contenteditable=&quot;false&quot; class=&quot;bidi-unicode&quot; title=&quot;Bidirectional characters change the order that text is rendered. This could be used to obscure malicious code.&quot; data-bidi-character-code=&quot;202C&quot;&gt;&#8236;&lt;!--Bidi char--&gt;&lt;/span&gt;&#30066;&#8293;&#30023;&#27753;&#28524;&#25717;&#11552;&#13856;&#12345;&#13104;&#19488;&#20313;&#8270;&lt;span contenteditable=&quot;false&quot; class=&quot;bidi-unicode&quot; title=&quot;Bidirectional characters change the order that text is rendered. This could be used to obscure malicious code.&quot; data-bidi-character-code=&quot;202D&quot;&gt;&#8237;&lt;!--Bidi char--&gt;&lt;/span&gt;&#59732;&#11884;&#14880;&#12320;&#11828;&#12855;&#13870;&#11832;&#14384;&#12334;&#8248;&lt;span contenteditable=&quot;false&quot; class=&quot;bidi-unicode&quot; title=&quot;Bidirectional characters change the order that text is rendered. This could be used to obscure malicious code.&quot; data-bidi-character-code=&quot;202D&quot;&gt;&#8237;&lt;!--Bidi char--&gt;&lt;/span&gt;&#24902;&#8312;&#8250;&#13360;&#14126;&#11826;&#14390;&#12334;&#11827;&#13878;&#21261;&#16686;&lt;span contenteditable=&quot;false&quot; class=&quot;bidi-unicode&quot; title=&quot;Bidirectional characters change the order that text is rendered. This could be used to obscure malicious code.&quot; data-bidi-character-code=&quot;202E&quot;&gt;&#8238;&lt;!--Bidi char--&gt;&lt;/span&gt;&#30049;&#25376;&#28769;&#29801;&#27745;&#25632;&#8293;&#13877;&#8246;&#12336;&#8240;&#21062;&#11859;&#21024;&#17198;&#21294;&lt;span contenteditable=&quot;false&quot; class=&quot;bidi-unicode&quot; title=&quot;Bidirectional characters change the order that text is rendered. This could be used to obscure malicious code.&quot; data-bidi-character-code=&quot;202E&quot;&gt;&#8238;&lt;!--Bidi char--&gt;&lt;/span&gt;&#24912;&#26994;&#8307;&#16928;&#13088;&#14647;&#13600;&#13878;&#14112;&#12599;&#3341;&#3341;&#65533;&#2713;&#33700;&#42286;&#16840;&#35494;&#42757;&#1418;&#21416;&#43267;&#1418;&#396;&#36096;&#65533;&#12849;&#12849;&#14137;&#6669;&#39168;&#41994;&#11907;&#51365;&#42561;&#1418;&#35495;&#43013;&#851;&#35497;&#35845;&#65533;&#397;&#256;&#448;&#575;&#259;&#448;&#9791;&#63551;&#1793;&#61441;&#1795;&#32801;&#256;&#25568;&#224;&#61567;&#1793;&#32833;&#32512;&#65379;&#496;&#259;&#384;&#10527;&#61695;&#7969;&#17404;~&#10755;&#57599;&#1793;&#7981;&#8696;&#65287;&#769;&#49153;&amp;lt;/p&amp;gt;
&amp;lt;p&amp;gt;&#3341;&amp;lt;/p&amp;gt;
&amp;lt;p&amp;gt;&#3341;&amp;lt;/p&amp;gt;
&amp;lt;p&amp;gt;&#3341;&amp;lt;/p&amp;gt;
&amp;lt;p&amp;gt;&#6669;&amp;lt;/p&amp;gt;
&amp;lt;/body&amp;gt;&amp;lt;/html&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13059657">TIKA-2313</key>
            <summary>Old Word document (Word 6.0, 1997) has a badly encoded(?) output.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="emmerich">Steven Hall</reporter>
                        <labels>
                    </labels>
                <created>Tue, 28 Mar 2017 07:49:11 +0000</created>
                <updated>Tue, 29 Oct 2019 15:52:19 +0000</updated>
                                            <version>1.14</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="15944951" author="tallison@mitre.org" created="Tue, 28 Mar 2017 11:09:05 +0000"  >&lt;p&gt;I can&apos;t make any promises, but I&apos;ll take a look.  Can you attach the file directly to this issue?  More-&amp;gt;Attach Files&lt;/p&gt;

&lt;p&gt;As for a junk detector, see &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1443&quot; title=&quot;Add a junk text detector to Tika&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1443&quot;&gt;TIKA-1443&lt;/a&gt;.  If you have any recommendations for metrics that would robustly identify junk across all languages, file formats and genres, let us know!&lt;/p&gt;

&lt;p&gt;You could run language id against the output, and if you &lt;em&gt;are 100% certain&lt;/em&gt; that your documents shouldn&apos;t be in Chinese, you might get some mileage from that.&lt;/p&gt;</comment>
                            <comment id="15944977" author="emmerich" created="Tue, 28 Mar 2017 11:21:40 +0000"  >&lt;p&gt;Attached breaking file.&lt;/p&gt;

&lt;p&gt;Unfortunately I don&apos;t have any light to shed on detecting junk in an intelligent way. Right now I&apos;m removing all non-printable characters from the output and then verifying the percentage of 1- or 2-letter words is not the majority of the document. Broken documents tend to have a large number of 1-letter words once non-printables have been removed.&lt;/p&gt;

&lt;p&gt;Seems to work fine but it&apos;s definitely not perfect &amp;#8211; I also have the benefit of having all documents in a Latin language so removing non-printables gives me a lot of benefit. I&apos;ll take part in the linked issue if I find anything useful.&lt;/p&gt;

&lt;p&gt;As for detecting language, I had originally thought that, but then I thought that having Chinese characters is completely random - rather it&apos;s mapping some (broken) encoding from the old documents into a modern encoding, and it just so happens that the mapping points to Chinese characters.&lt;/p&gt;</comment>
                            <comment id="15945193" author="gagravarr" created="Tue, 28 Mar 2017 13:44:25 +0000"  >&lt;p&gt;Opening the document in OpenOffice, it looks to be in French, complete with French accents. That could be stored as 8 bit text with an encoding, or as unicode. We&apos;d need someone to dig in and check, then quite possibly fix the TODO in HWPFOldDocument where it currently fakes a PieceDescriptor. I&apos;ll leave that one for Tim if I can...!&lt;/p&gt;</comment>
                            <comment id="15945306" author="tallison@mitre.org" created="Tue, 28 Mar 2017 14:50:54 +0000"  >&lt;p&gt;Unfortunately, this doesn&apos;t hit the TODO section in HWPFOldDocument.&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;_fib.getFibBase().isFComplex()&lt;/tt&gt; is true so it builds a ComplexFileTable which in turn builds a TextPieceTable.&lt;/p&gt;

&lt;p&gt;Unfortunately, the pieces all return &lt;tt&gt;true&lt;/tt&gt; for &lt;tt&gt;isUnicode()&lt;/tt&gt;.  When I keep the &lt;tt&gt;multiple&lt;/tt&gt; == 1 and decode with CP-1252, all is well.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=nick&quot; class=&quot;user-hover&quot; rel=&quot;nick&quot;&gt;nick&lt;/a&gt;, do you have any reason to believe that &lt;tt&gt;if ((fc &amp;amp; 0x40000000) == 0)&lt;/tt&gt; might not be the right way to determine unicode in version 6 word files?  Or any recommendations for where to look? &lt;/p&gt;</comment>
                            <comment id="15945384" author="tallison@mitre.org" created="Tue, 28 Mar 2017 15:26:46 +0000"  >&lt;p&gt;This old open office issue &lt;a href=&quot;https://bz.apache.org/ooo/show_bug.cgi?id=12445&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://bz.apache.org/ooo/show_bug.cgi?id=12445&lt;/a&gt; suggests that there is a way to determine/set codepage in Word 6.0.&lt;/p&gt;</comment>
                            <comment id="15945477" author="gagravarr" created="Tue, 28 Mar 2017 16:27:09 +0000"  >&lt;p&gt;That check may well not be correct for the older formats. I&apos;d start at &lt;a href=&quot;https://msdn.microsoft.com/en-us/library/dd949344(v=office.12).aspx&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://msdn.microsoft.com/en-us/library/dd949344(v=office.12).aspx&lt;/a&gt; and &lt;a href=&quot;https://msdn.microsoft.com/en-us/library/dd923367(v=office.12).aspx&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://msdn.microsoft.com/en-us/library/dd923367(v=office.12).aspx&lt;/a&gt; then work through the right structures from there&lt;/p&gt;</comment>
                            <comment id="16072854" author="hudson" created="Mon, 3 Jul 2017 19:47:24 +0000"  >&lt;p&gt;FAILURE: Integrated in Jenkins build Tika-trunk #1305 (See &lt;a href=&quot;https://builds.apache.org/job/Tika-trunk/1305/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Tika-trunk/1305/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-2313&quot; title=&quot;Old Word document (Word 6.0, 1997) has a badly encoded(?) output.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-2313&quot;&gt;TIKA-2313&lt;/a&gt; upgrade mime4j to 0.8.1 (tallison: &lt;a href=&quot;https://github.com/apache/tika/commit/04cc72cd77c4f0d618f6dea7981779fae9807518&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tika/commit/04cc72cd77c4f0d618f6dea7981779fae9807518&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) tika-parsers/src/test/java/org/apache/tika/parser/mail/RFC822ParserTest.java&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/pom.xml&lt;/li&gt;
	&lt;li&gt;(edit) tika-parsers/src/main/java/org/apache/tika/parser/mail/RFC822Parser.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12860853" name="old.DOC" size="20480" author="emmerich" created="Tue, 28 Mar 2017 11:21:40 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 19 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3cvpz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>