{"url":"https://api.github.com/repos/google/guava/issues/1190","repository_url":"https://api.github.com/repos/google/guava","labels_url":"https://api.github.com/repos/google/guava/issues/1190/labels{/name}","comments_url":"https://api.github.com/repos/google/guava/issues/1190/comments","events_url":"https://api.github.com/repos/google/guava/issues/1190/events","html_url":"https://github.com/google/guava/issues/1190","id":47423002,"node_id":"MDU6SXNzdWU0NzQyMzAwMg==","number":1190,"title":"Splitter.onPattern drops last token when zero width matches are used","user":{"login":"gissuebot","id":8091570,"node_id":"MDQ6VXNlcjgwOTE1NzA=","avatar_url":"https://avatars.githubusercontent.com/u/8091570?v=4","gravatar_id":"","url":"https://api.github.com/users/gissuebot","html_url":"https://github.com/gissuebot","followers_url":"https://api.github.com/users/gissuebot/followers","following_url":"https://api.github.com/users/gissuebot/following{/other_user}","gists_url":"https://api.github.com/users/gissuebot/gists{/gist_id}","starred_url":"https://api.github.com/users/gissuebot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gissuebot/subscriptions","organizations_url":"https://api.github.com/users/gissuebot/orgs","repos_url":"https://api.github.com/users/gissuebot/repos","events_url":"https://api.github.com/users/gissuebot/events{/privacy}","received_events_url":"https://api.github.com/users/gissuebot/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":143499063,"node_id":"MDU6TGFiZWwxNDM0OTkwNjM=","url":"https://api.github.com/repos/google/guava/labels/type=defect","name":"type=defect","color":"e11d21","default":false,"description":"Bug, not working as expected"},{"id":143505359,"node_id":"MDU6TGFiZWwxNDM1MDUzNTk=","url":"https://api.github.com/repos/google/guava/labels/package=base","name":"package=base","color":"62a0e5","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/google/guava/milestones/18","html_url":"https://github.com/google/guava/milestone/18","labels_url":"https://api.github.com/repos/google/guava/milestones/18/labels","id":2100719,"node_id":"MDk6TWlsZXN0b25lMjEwMDcxOQ==","number":18,"title":"21.0","description":"","creator":{"login":"cgdecker","id":101568,"node_id":"MDQ6VXNlcjEwMTU2OA==","avatar_url":"https://avatars.githubusercontent.com/u/101568?v=4","gravatar_id":"","url":"https://api.github.com/users/cgdecker","html_url":"https://github.com/cgdecker","followers_url":"https://api.github.com/users/cgdecker/followers","following_url":"https://api.github.com/users/cgdecker/following{/other_user}","gists_url":"https://api.github.com/users/cgdecker/gists{/gist_id}","starred_url":"https://api.github.com/users/cgdecker/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cgdecker/subscriptions","organizations_url":"https://api.github.com/users/cgdecker/orgs","repos_url":"https://api.github.com/users/cgdecker/repos","events_url":"https://api.github.com/users/cgdecker/events{/privacy}","received_events_url":"https://api.github.com/users/cgdecker/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":6,"state":"closed","created_at":"2016-10-28T21:21:36Z","updated_at":"2017-03-03T19:44:17Z","due_on":null,"closed_at":"2017-03-03T19:44:17Z"},"comments":23,"created_at":"2014-10-31T17:38:14Z","updated_at":"2016-10-31T18:42:24Z","closed_at":"2016-10-31T18:40:50Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"_[Original issue](https://code.google.com/p/guava-libraries/issues/detail?id=1190) created by **travis.downs** on 2012-11-04 at 10:17 AM_\n\n---\n\nIf you split on a zero-width regex, the last element may be dropped.\n\nString input = \"foo\";\nString regex = \"(?=o)|(?<=o)\";\nSplitter splitter = Splitter.onPattern(regex);\nSystem.out.println(Arrays.asList(input.split(regex)));\nSystem.out.println(Arrays.asList(Iterables.toArray(splitter.split(input),String.class)));\n\nThis does zero-width lookaround for 'o', so the string will be split before and after any o, but the o characters will also be returned as individual items.\n\nNote that String.split works correctly here, but Guava splitter drops the last o.\n\nExamining the code, this was probably introduced in this fix (granted, it didn't work at all before that):\n\nhttps://github.com/google/guava/issues/936\n\nIn particular, this bit of logic in Splitter.java:\n\n```\n    if (offset == nextStart) {\n      /*\n       * (ommit comment)\n       */\n      offset++;\n      if (offset >= toSplit.length()) {\n        offset = -1;\n      }\n      continue;\n    }\n```\n\nneglects to the the \"last element\" handling that the general logic above does (setting end to toSplit.lenth() if no more separators are found).\n","closed_by":{"login":"cpovirk","id":1703908,"node_id":"MDQ6VXNlcjE3MDM5MDg=","avatar_url":"https://avatars.githubusercontent.com/u/1703908?v=4","gravatar_id":"","url":"https://api.github.com/users/cpovirk","html_url":"https://github.com/cpovirk","followers_url":"https://api.github.com/users/cpovirk/followers","following_url":"https://api.github.com/users/cpovirk/following{/other_user}","gists_url":"https://api.github.com/users/cpovirk/gists{/gist_id}","starred_url":"https://api.github.com/users/cpovirk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cpovirk/subscriptions","organizations_url":"https://api.github.com/users/cpovirk/orgs","repos_url":"https://api.github.com/users/cpovirk/repos","events_url":"https://api.github.com/users/cpovirk/events{/privacy}","received_events_url":"https://api.github.com/users/cpovirk/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/google/guava/issues/1190/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/google/guava/issues/1190/timeline","performed_via_github_app":null,"state_reason":"completed"}