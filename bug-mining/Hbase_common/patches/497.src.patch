diff --git a/hbase-common/src/main/java/org/apache/hadoop/hbase/util/CommonFSUtils.java b/hbase-common/src/main/java/org/apache/hadoop/hbase/util/CommonFSUtils.java
index 2549c6df50..5859c3ae73 100644
--- a/hbase-common/src/main/java/org/apache/hadoop/hbase/util/CommonFSUtils.java
+++ b/hbase-common/src/main/java/org/apache/hadoop/hbase/util/CommonFSUtils.java
@@ -321,6 +321,10 @@ public final class CommonFSUtils {
     c.set("fs.defaultFS", root.toString());    // for hadoop 0.21+
   }
 
+  public static void setFsDefault(final Configuration c, final String uri) {
+    c.set("fs.defaultFS", uri); // for hadoop 0.21+
+  }
+
   public static FileSystem getRootDirFileSystem(final Configuration c) throws IOException {
     Path p = getRootDir(c);
     return p.getFileSystem(c);
@@ -341,6 +345,20 @@ public final class CommonFSUtils {
     return p.makeQualified(fs.getUri(), fs.getWorkingDirectory());
   }
 
+  /**
+   * Returns the URI in the strig format
+   * @param c configuration
+   * @param p path
+   * @return - the URI's to string format
+   * @throws IOException
+   */
+  public static String getDirUri(final Configuration c, Path p) throws IOException {
+    if (p.toUri().getScheme() != null) {
+      return p.toUri().toString();
+    }
+    return null;
+  }
+
   @VisibleForTesting
   public static void setWALRootDir(final Configuration c, final Path root) {
     c.set(HBASE_WAL_DIR, root.toString());
diff --git a/hbase-common/src/test/java/org/apache/hadoop/hbase/util/TestCommonFSUtils.java b/hbase-common/src/test/java/org/apache/hadoop/hbase/util/TestCommonFSUtils.java
index e6a427edee..7d433c02bc 100644
--- a/hbase-common/src/test/java/org/apache/hadoop/hbase/util/TestCommonFSUtils.java
+++ b/hbase-common/src/test/java/org/apache/hadoop/hbase/util/TestCommonFSUtils.java
@@ -28,6 +28,7 @@ import org.apache.hadoop.fs.FileSystem;
 import org.apache.hadoop.fs.Path;
 import org.apache.hadoop.hbase.HBaseClassTestRule;
 import org.apache.hadoop.hbase.HBaseCommonTestingUtility;
+import org.apache.hadoop.hbase.HConstants;
 import org.apache.hadoop.hbase.testclassification.MiscTests;
 import org.apache.hadoop.hbase.testclassification.SmallTests;
 import org.junit.Before;
@@ -105,6 +106,22 @@ public class TestCommonFSUtils {
     assertEquals(walRoot, CommonFSUtils.getWALRootDir(conf));
   }
 
+  @Test
+  public void testGetWALRootDirUsingUri() throws IOException {
+    Path root = new Path("file:///hbase/root");
+    conf.set(HConstants.HBASE_DIR, root.toString());
+    Path walRoot = new Path("file:///hbase/logroot");
+    conf.set(CommonFSUtils.HBASE_WAL_DIR, walRoot.toString());
+    String walDirUri = CommonFSUtils.getDirUri(conf, walRoot);
+    String rootDirUri = CommonFSUtils.getDirUri(conf, root);
+    CommonFSUtils.setFsDefault(this.conf, rootDirUri);
+    CommonFSUtils.setRootDir(conf, root);
+    assertEquals(root, CommonFSUtils.getRootDir(conf));
+    CommonFSUtils.setFsDefault(this.conf, walDirUri);
+    CommonFSUtils.setWALRootDir(conf, walRoot);
+    assertEquals(walRoot, CommonFSUtils.getWALRootDir(conf));
+  }
+
   @Test(expected=IllegalStateException.class)
   public void testGetWALRootDirIllegalWALDir() throws IOException {
     Path root = new Path("file:///hbase/root");
