diff --git a/hbase-common/src/main/java/org/apache/hadoop/hbase/io/encoding/BufferedDataBlockEncoder.java b/hbase-common/src/main/java/org/apache/hadoop/hbase/io/encoding/BufferedDataBlockEncoder.java
index bed388670a..513e2e22e9 100644
--- a/hbase-common/src/main/java/org/apache/hadoop/hbase/io/encoding/BufferedDataBlockEncoder.java
+++ b/hbase-common/src/main/java/org/apache/hadoop/hbase/io/encoding/BufferedDataBlockEncoder.java
@@ -183,6 +183,9 @@ abstract class BufferedDataBlockEncoder implements DataBlockEncoder {
 
     @Override
     public void setCurrentBuffer(ByteBuffer buffer) {
+      if (this.tagCompressionContext != null) {
+        this.tagCompressionContext.clear();
+      }
       currentBuffer = buffer;
       decodeFirst();
       previous.invalidate();
