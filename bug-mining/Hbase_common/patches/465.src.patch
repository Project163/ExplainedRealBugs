diff --git a/hbase-common/src/main/java/org/apache/hadoop/hbase/io/encoding/RowIndexCodecV1.java b/hbase-common/src/main/java/org/apache/hadoop/hbase/io/encoding/RowIndexCodecV1.java
index 3293389265..07e17d84f7 100644
--- a/hbase-common/src/main/java/org/apache/hadoop/hbase/io/encoding/RowIndexCodecV1.java
+++ b/hbase-common/src/main/java/org/apache/hadoop/hbase/io/encoding/RowIndexCodecV1.java
@@ -118,16 +118,17 @@ public class RowIndexCodecV1 extends AbstractDataBlockEncoder {
       }
       boolean includesMvcc = decodingCtx.getHFileContext().isIncludesMvcc();
       ByteArrayOutputStream baos = new ByteArrayOutputStream();
-      DataOutputStream out = new DataOutputStream(baos);
-      for (Cell cell : kvs) {
-        KeyValue currentCell = KeyValueUtil.copyToNewKeyValue(cell);
-        out.write(currentCell.getBuffer(), currentCell.getOffset(),
-            currentCell.getLength());
-        if (includesMvcc) {
-          WritableUtils.writeVLong(out, cell.getSequenceId());
+      try (DataOutputStream out = new DataOutputStream(baos)) {
+        for (Cell cell : kvs) {
+          KeyValue currentCell = KeyValueUtil.copyToNewKeyValue(cell);
+          out.write(currentCell.getBuffer(), currentCell.getOffset(),
+                  currentCell.getLength());
+          if (includesMvcc) {
+            WritableUtils.writeVLong(out, cell.getSequenceId());
+          }
         }
+        out.flush();
       }
-      out.flush();
       return ByteBuffer.wrap(baos.getBuffer(), 0, baos.size());
     }
   }
