diff --git a/hbase-common/src/test/java/org/apache/hadoop/hbase/ClassFinder.java b/hbase-common/src/test/java/org/apache/hadoop/hbase/ClassFinder.java
index d46537c1dd..01d387c5fb 100644
--- a/hbase-common/src/test/java/org/apache/hadoop/hbase/ClassFinder.java
+++ b/hbase-common/src/test/java/org/apache/hadoop/hbase/ClassFinder.java
@@ -85,9 +85,15 @@ public class ClassFinder {
     }
   }
 
-  public static class And implements ClassFilter {
+  public static class And implements ClassFilter, ResourcePathFilter {
     ClassFilter[] classFilters;
+    ResourcePathFilter[] resourcePathFilters;
+
     public And(ClassFilter...classFilters) { this.classFilters = classFilters; }
+    public And(ResourcePathFilter... resourcePathFilters) {
+      this.resourcePathFilters = resourcePathFilters;
+    }
+
     @Override
     public boolean isCandidateClass(Class<?> c) {
       for (ClassFilter filter : classFilters) {
@@ -97,6 +103,15 @@ public class ClassFinder {
       }
       return true;
     }
+
+    @Override public boolean isCandidatePath(String resourcePath, boolean isJar) {
+      for (ResourcePathFilter filter : resourcePathFilters) {
+        if (!filter.isCandidatePath(resourcePath, isJar)) {
+          return false;
+        }
+      }
+      return true;
+    }
   }
 
   public ClassFinder() {
diff --git a/hbase-common/src/test/java/org/apache/hadoop/hbase/ClassTestFinder.java b/hbase-common/src/test/java/org/apache/hadoop/hbase/ClassTestFinder.java
index 5d4d941771..9d5618b287 100644
--- a/hbase-common/src/test/java/org/apache/hadoop/hbase/ClassTestFinder.java
+++ b/hbase-common/src/test/java/org/apache/hadoop/hbase/ClassTestFinder.java
@@ -48,6 +48,7 @@ public class ClassTestFinder extends ClassFinder {
     return new Class<?>[0];
   }
 
+  /** Filters both test classes and anything in the hadoop-compat modules */
   public static class TestFileNameFilter implements FileNameFilter, ResourcePathFilter {
     private static final Pattern hadoopCompactRe =
         Pattern.compile("hbase-hadoop\\d?-compat");
