<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 18:12:09 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HBASE-19919] Tidying up logging</title>
                <link>https://issues.apache.org/jira/browse/HBASE-19919</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;Reading logs, there is a bunch of stuff we don&apos;t need, thread names are too long, etc. Doing a little tidying.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13135708">HBASE-19919</key>
            <summary>Tidying up logging</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="stack">Michael Stack</assignee>
                                    <reporter username="stack">Michael Stack</reporter>
                        <labels>
                    </labels>
                <created>Fri, 2 Feb 2018 08:22:16 +0000</created>
                <updated>Wed, 1 Aug 2018 06:22:05 +0000</updated>
                            <resolved>Sat, 3 Feb 2018 17:28:12 +0000</resolved>
                                                    <fixVersion>2.0.0-beta-2</fixVersion>
                    <fixVersion>2.0.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                                                                                <comments>
                            <comment id="16349955" author="stack" created="Fri, 2 Feb 2018 08:24:20 +0000"  >&lt;p&gt;.001 is first batch. Need to test it... Posting here so don&apos;t lose what has been done so far.&lt;/p&gt;</comment>
                            <comment id="16351082" author="appy" created="Sat, 3 Feb 2018 00:03:02 +0000"  >&lt;p&gt;toStringWithoutDomain(): Unless all logging of servername changes to this, it&apos;ll be hard to debug tests where one needs to search for RS name and iterates over all occurrences to get high level story of what&apos;s going on...since they&apos;ll miss (part/all?) rpc related stuff (that name is used of rpcserver).&lt;/p&gt;

&lt;p&gt;Some log.debug can be converted to parameterized style (&quot;xyz {}&quot;).&lt;/p&gt;</comment>
                            <comment id="16351132" author="stack" created="Sat, 3 Feb 2018 00:47:54 +0000"  >&lt;p&gt;Thanks for review &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=appy&quot; class=&quot;user-hover&quot; rel=&quot;appy&quot;&gt;appy&lt;/a&gt;... the toStringWithoutDomain is for thread naming. Here are what log lines look like now on a cluster:&lt;/p&gt;

&lt;p&gt;2018-02-01 21:17:29,832 INFO  &lt;span class=&quot;error&quot;&gt;&amp;#91;master/ve0524.halxg.cloudera.com/10.17.240.20:16000&amp;#93;&lt;/span&gt; cleaner.CleanerChore: Cleaner pool size is 24&lt;/p&gt;

&lt;p&gt;Almost 50% of the log is the thread name of which 3/4 is host name.&lt;/p&gt;

&lt;p&gt;With toStringWithoutDomain, thread name becomes master/ve0524:1600&lt;/p&gt;

&lt;p&gt;I&apos;ve been doing some parametrization. Let me do some more.&lt;/p&gt;

&lt;p&gt;Thanks. Reading the logs trying to tell a story from what is in here is a bit tough w/ all the noise.&lt;/p&gt;</comment>
                            <comment id="16351151" author="appy" created="Sat, 3 Feb 2018 01:07:55 +0000"  >&lt;p&gt;That looks pretty. +1&lt;/p&gt;</comment>
                            <comment id="16351285" author="stack" created="Sat, 3 Feb 2018 07:00:45 +0000"  >&lt;p&gt;I went a bit further. Attached is what I pushed to master and branch-2.&lt;/p&gt;

&lt;p&gt;There is a bunch of work to be done still cutting down thread counts, connections.. etc. Our defaults are sloppy and in need of another tidying. The log narrative needs more passes than this one. Lines are a bit more curt now though. Will do for now. There are more failing unit tests to fix!&lt;/p&gt;

&lt;p&gt;Thanks for the review &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=appy&quot; class=&quot;user-hover&quot; rel=&quot;appy&quot;&gt;appy&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16351286" author="stack" created="Sat, 3 Feb 2018 07:01:19 +0000"  >&lt;p&gt;Pushed to branch-2 and master.&lt;/p&gt;</comment>
                            <comment id="16351341" author="hudson" created="Sat, 3 Feb 2018 09:28:27 +0000"  >&lt;p&gt;FAILURE: Integrated in Jenkins build HBase-Trunk_matrix #4518 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-Trunk_matrix/4518/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/HBase-Trunk_matrix/4518/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-19919&quot; title=&quot;Tidying up logging&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-19919&quot;&gt;&lt;del&gt;HBASE-19919&lt;/del&gt;&lt;/a&gt; Tidying up logging (stack: rev 40250f8c5f8efe3016f0c3300d9728b0ee2056c6)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(add) hbase-server/src/main/java/org/apache/hadoop/hbase/replication/master/ReplicationPeerConfigUpgrader.java.rej&lt;/li&gt;
	&lt;li&gt;(add) hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/RSRpcServices.java.rej&lt;/li&gt;
	&lt;li&gt;(add) hbase-common/src/test/java/org/apache/hadoop/hbase/net/TestAddress.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="16351357" author="apache9" created="Sat, 3 Feb 2018 10:14:02 +0000"  >&lt;p&gt;Wrong patch sir? The compilation of master is broken...&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/hbase/commit/40250f8c5f8efe3016f0c3300d9728b0ee2056c6&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/hbase/commit/40250f8c5f8efe3016f0c3300d9728b0ee2056c6&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Only 3 files?&lt;/p&gt;</comment>
                            <comment id="16351358" author="apache9" created="Sat, 3 Feb 2018 10:17:59 +0000"  >&lt;p&gt;Revert the patch for master for now. I think you got a conflict when applying the patch to master &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stack&quot; class=&quot;user-hover&quot; rel=&quot;stack&quot;&gt;stack&lt;/a&gt;, buy you still pushed it... There are two &apos;rej&apos; files in the commit...&lt;/p&gt;</comment>
                            <comment id="16351437" author="hudson" created="Sat, 3 Feb 2018 16:15:17 +0000"  >&lt;p&gt;FAILURE: Integrated in Jenkins build HBase-Trunk_matrix #4519 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-Trunk_matrix/4519/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/HBase-Trunk_matrix/4519/&lt;/a&gt;)&lt;br/&gt;
Revert &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-19919&quot; title=&quot;Tidying up logging&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-19919&quot;&gt;&lt;del&gt;HBASE-19919&lt;/del&gt;&lt;/a&gt; Tidying up logging&quot; (zhangduo: rev 6519b98ac3115c4442a2778f6ed7b39ce5cd3b83)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(delete) hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/RSRpcServices.java.rej&lt;/li&gt;
	&lt;li&gt;(delete) hbase-server/src/main/java/org/apache/hadoop/hbase/replication/master/ReplicationPeerConfigUpgrader.java.rej&lt;/li&gt;
	&lt;li&gt;(delete) hbase-common/src/test/java/org/apache/hadoop/hbase/net/TestAddress.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="16351443" author="stack" created="Sat, 3 Feb 2018 16:30:00 +0000"  >&lt;p&gt;Ugh. Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Apache9&quot; class=&quot;user-hover&quot; rel=&quot;Apache9&quot;&gt;Apache9&lt;/a&gt;. I messed up the cherry-pick. Thanks for the revert. Let me fix.&lt;/p&gt;</comment>
                            <comment id="16351449" author="stack" created="Sat, 3 Feb 2018 16:57:11 +0000"  >&lt;p&gt;Pushed to master again.&lt;/p&gt;</comment>
                            <comment id="16351456" author="stack" created="Sat, 3 Feb 2018 17:27:56 +0000"  >&lt;p&gt;And had to add an addendum subsequent to the master fixup.  So, push to branch-2 followed by an addendum and a push to master that was broke, a revert, a repush, and then an addendum. Pardon my mess!&lt;/p&gt;</comment>
                            <comment id="16351457" author="stack" created="Sat, 3 Feb 2018 17:28:12 +0000"  >&lt;p&gt;Reresolving&lt;/p&gt;</comment>
                            <comment id="16351470" author="hudson" created="Sat, 3 Feb 2018 18:15:32 +0000"  >&lt;p&gt;FAILURE: Integrated in Jenkins build HBase-Trunk_matrix #4520 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-Trunk_matrix/4520/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/HBase-Trunk_matrix/4520/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-19919&quot; title=&quot;Tidying up logging&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-19919&quot;&gt;&lt;del&gt;HBASE-19919&lt;/del&gt;&lt;/a&gt; Tidying up logging (stack: rev 06dec205826a6e96e2286180460e5fe014b46fc8)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) hbase-common/src/main/java/org/apache/hadoop/hbase/ChoreService.java&lt;/li&gt;
	&lt;li&gt;(edit) hbase-server/src/main/java/org/apache/hadoop/hbase/coprocessor/CoprocessorHost.java&lt;/li&gt;
	&lt;li&gt;(edit) hbase-server/src/main/java/org/apache/hadoop/hbase/master/assignment/AssignmentManager.java&lt;/li&gt;
	&lt;li&gt;(edit) hbase-server/src/main/java/org/apache/hadoop/hbase/master/procedure/RSProcedureDispatcher.java&lt;/li&gt;
	&lt;li&gt;(edit) hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/ChunkCreator.java&lt;/li&gt;
	&lt;li&gt;(edit) hbase-server/src/main/java/org/apache/hadoop/hbase/master/cleaner/HFileCleaner.java&lt;/li&gt;
	&lt;li&gt;(edit) hbase-procedure/src/main/java/org/apache/hadoop/hbase/procedure2/StateMachineProcedure.java&lt;/li&gt;
	&lt;li&gt;(edit) hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java&lt;/li&gt;
	&lt;li&gt;(edit) hbase-client/src/main/java/org/apache/hadoop/hbase/ipc/NettyRpcConnection.java&lt;/li&gt;
	&lt;li&gt;(add) hbase-common/src/test/java/org/apache/hadoop/hbase/net/TestAddress.java&lt;/li&gt;
	&lt;li&gt;(edit) hbase-server/src/main/java/org/apache/hadoop/hbase/master/SplitLogManager.java&lt;/li&gt;
	&lt;li&gt;(edit) hbase-zookeeper/src/main/java/org/apache/hadoop/hbase/zookeeper/RecoverableZooKeeper.java&lt;/li&gt;
	&lt;li&gt;(edit) hbase-server/src/main/java/org/apache/hadoop/hbase/ipc/RpcExecutor.java&lt;/li&gt;
	&lt;li&gt;(edit) hbase-server/src/main/java/org/apache/hadoop/hbase/security/access/ZKPermissionWatcher.java&lt;/li&gt;
	&lt;li&gt;(edit) hbase-server/src/main/java/org/apache/hadoop/hbase/util/FSTableDescriptors.java&lt;/li&gt;
	&lt;li&gt;(edit) hbase-server/src/main/java/org/apache/hadoop/hbase/master/TableStateManager.java&lt;/li&gt;
	&lt;li&gt;(edit) hbase-server/src/main/java/org/apache/hadoop/hbase/master/ServerManager.java&lt;/li&gt;
	&lt;li&gt;(edit) hbase-server/src/main/java/org/apache/hadoop/hbase/procedure/ZKProcedureCoordinator.java&lt;/li&gt;
	&lt;li&gt;(edit) hbase-server/src/main/java/org/apache/hadoop/hbase/master/cleaner/LogCleaner.java&lt;/li&gt;
	&lt;li&gt;(edit) hbase-server/src/main/java/org/apache/hadoop/hbase/replication/master/ReplicationPeerConfigUpgrader.java&lt;/li&gt;
	&lt;li&gt;(edit) hbase-server/src/main/java/org/apache/hadoop/hbase/coordination/ZKSplitLogManagerCoordination.java&lt;/li&gt;
	&lt;li&gt;(edit) hbase-server/src/main/java/org/apache/hadoop/hbase/master/ActiveMasterManager.java&lt;/li&gt;
	&lt;li&gt;(edit) hbase-server/src/main/java/org/apache/hadoop/hbase/master/HMaster.java&lt;/li&gt;
	&lt;li&gt;(edit) hbase-procedure/src/main/java/org/apache/hadoop/hbase/procedure2/store/wal/WALProcedureStore.java&lt;/li&gt;
	&lt;li&gt;(edit) hbase-server/src/main/java/org/apache/hadoop/hbase/replication/master/ReplicationLogCleaner.java&lt;/li&gt;
	&lt;li&gt;(edit) hbase-server/src/main/java/org/apache/hadoop/hbase/master/MasterCoprocessorHost.java&lt;/li&gt;
	&lt;li&gt;(edit) hbase-common/src/main/java/org/apache/hadoop/hbase/net/Address.java&lt;/li&gt;
	&lt;li&gt;(edit) hbase-server/src/main/java/org/apache/hadoop/hbase/procedure/ZKProcedureUtil.java&lt;/li&gt;
	&lt;li&gt;(edit) hbase-server/src/main/java/org/apache/hadoop/hbase/security/access/AccessController.java&lt;/li&gt;
	&lt;li&gt;(edit) hbase-procedure/src/main/java/org/apache/hadoop/hbase/procedure2/ProcedureExecutor.java&lt;/li&gt;
	&lt;li&gt;(edit) hbase-server/src/main/java/org/apache/hadoop/hbase/master/cleaner/CleanerChore.java&lt;/li&gt;
	&lt;li&gt;(edit) hbase-client/src/main/java/org/apache/hadoop/hbase/zookeeper/ReadOnlyZKClient.java&lt;/li&gt;
	&lt;li&gt;(edit) hbase-procedure/src/main/java/org/apache/hadoop/hbase/procedure2/RemoteProcedureDispatcher.java&lt;/li&gt;
	&lt;li&gt;(edit) hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/RSRpcServices.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="16351578" author="hudson" created="Sat, 3 Feb 2018 23:42:22 +0000"  >&lt;p&gt;FAILURE: Integrated in Jenkins build HBase-Trunk_matrix #4521 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-Trunk_matrix/4521/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/HBase-Trunk_matrix/4521/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-19919&quot; title=&quot;Tidying up logging&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-19919&quot;&gt;&lt;del&gt;HBASE-19919&lt;/del&gt;&lt;/a&gt; Tidying up logging; ADDENDUM Fix tests w/ mocked Servers (stack: rev 12f3c82a866eee0436c22136909882581fd19905)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) hbase-server/src/main/java/org/apache/hadoop/hbase/master/SplitLogManager.java&lt;/li&gt;
	&lt;li&gt;(edit) hbase-server/src/main/java/org/apache/hadoop/hbase/master/assignment/AssignmentManager.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12909085" name="0001-HBASE-19919-Tidying-up-logging.patch" size="62190" author="stack" created="Sat, 3 Feb 2018 06:57:53 +0000"/>
                            <attachment id="12908941" name="HBASE-19919.branch-2.001.patch" size="31509" author="stack" created="Fri, 2 Feb 2018 08:23:56 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 40 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3ppav:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12310192" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Release Note</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>(I thought this change innocuous but I made work for a co-worker when I upped interval between log cleaner runs -- meant a smoke test failed because we were slow doing an expected cleanup).&lt;br/&gt;
&lt;br/&gt;
Edit of log lines removing redundancy. Shorten thread names shown in log.  Made some log TRACE instead of DEBUG.  Capitalizations.&lt;br/&gt;
&lt;br/&gt;
Upped log cleaner interval from every minute to every ten minutes. hbase.master.cleaner.interval&lt;br/&gt;
&lt;br/&gt;
Lowered default count of threads started by Procedure Executor from count of CPUs to 1/4 of count of CPUs.&lt;br/&gt;
&lt;br/&gt;
</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>