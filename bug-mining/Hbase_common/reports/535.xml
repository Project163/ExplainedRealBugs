<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 18:13:49 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[HBASE-25709] Close region may stuck when region is compacting and skipped most cells read</title>
                <link>https://issues.apache.org/jira/browse/HBASE-25709</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;We found in our cluster about stop region stuck. The region is compacting, and its store files has many TTL expired cells. Close region state marker(HRegion#writestate.writesEnabled) is not checked in compaction, because most cells were skipped.&#160;&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/13023104/13023104_RS-region-state.png&quot; height=&quot;310&quot; width=&quot;698&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/13023103/13023103_Master-UI-RIT.png&quot; height=&quot;157&quot; width=&quot;693&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-23968&quot; title=&quot;Periodically check whether a system stop is requested in compaction by time.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-23968&quot;&gt;&lt;del&gt;HBASE-23968&lt;/del&gt;&lt;/a&gt;&#160;has encountered similar problem, but the solution in it is outer the method&lt;/p&gt;

&lt;p&gt;InternalScanner#next(List&amp;lt;Cell&amp;gt; result, ScannerContext scannerContext), which will not return if there are many skipped cells, for current compaction scanner context. As a result, we need to return in time in the next method, and then check the stop marker.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13368325">HBASE-25709</key>
            <summary>Close region may stuck when region is compacting and skipped most cells read</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="Xiaolin Ha">Xiaolin Ha</assignee>
                                    <reporter username="Xiaolin Ha">Xiaolin Ha</reporter>
                        <labels>
                    </labels>
                <created>Mon, 29 Mar 2021 08:28:27 +0000</created>
                <updated>Mon, 6 Mar 2023 18:58:07 +0000</updated>
                            <resolved>Mon, 6 Mar 2023 06:24:34 +0000</resolved>
                                    <version>1.7.1</version>
                    <version>3.0.0-alpha-2</version>
                    <version>2.4.10</version>
                                    <fixVersion>2.6.0</fixVersion>
                    <fixVersion>3.0.0-alpha-4</fixVersion>
                                    <component>Compaction</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>11</watches>
                                                                                                                <comments>
                            <comment id="17317366" author="stack" created="Thu, 8 Apr 2021 17:25:25 +0000"  >&lt;p&gt;Patch looks good. Defaults to off. Why would we not just have this flag enabled always &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Xiaolin+Ha&quot; class=&quot;user-hover&quot; rel=&quot;Xiaolin Ha&quot;&gt;Xiaolin Ha&lt;/a&gt;? If a Region has been asked close, compactions should be preempted and put aside until we open in new location? Close should preempt everything I&apos;d suggest except an ongoing user read?&lt;/p&gt;</comment>
                            <comment id="17317952" author="xiaolin ha" created="Fri, 9 Apr 2021 12:29:40 +0000"  >&lt;p&gt;Hi, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stack&quot; class=&quot;user-hover&quot; rel=&quot;stack&quot;&gt;stack&lt;/a&gt;, thanks for reviewing this issue.&lt;/p&gt;

&lt;p&gt;The StoreScanner is shared by compaction and user scanners, I set default off to&#160;make it be compatible with the original logic.&#160;&lt;/p&gt;

&lt;p&gt;I thought carefully about your suggestion to set it default on, there may be some correctness issues.&lt;/p&gt;

&lt;p&gt;Because for user scanners, matchers return SKIP will make the heap loop in polling cells until heap is empty or the top cell matches the scanner rules.&#160;&lt;/p&gt;

&lt;p&gt;If we set this default on, the method will return if it has get per heart beat cells, though the top cell of the heap may be invalid. Then outer scanners will peek incorrect data(Maybe not, because there are still filters before return the result).Such as in KeyValueHeap#next(List&amp;lt;Cell&amp;gt; result, ScannerContext scannerContext), it just adds the top cell after the StoreScanner#next returns. But in user scanner context, the scanner will return util&#160;reach the limit it sets. As a result,&#160; returning prematurely for user scanners may be unexpected.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17318085" author="stack" created="Fri, 9 Apr 2021 15:40:20 +0000"  >&lt;p&gt;Thank you &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Xiaolin+Ha&quot; class=&quot;user-hover&quot; rel=&quot;Xiaolin Ha&quot;&gt;Xiaolin Ha&lt;/a&gt;.  Would it help if we could distinguish compacting scanners from user-facing instances? A compacting scanner can be aborted on close but a user-scanner not? Will you turn on this feature even though it has the correctness issues you note above?&lt;/p&gt;</comment>
                            <comment id="17318654" author="xiaolin ha" created="Sun, 11 Apr 2021 05:32:01 +0000"  >&lt;p&gt;Thanks, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stack&quot; class=&quot;user-hover&quot; rel=&quot;stack&quot;&gt;stack&lt;/a&gt;. ^^ It&apos;s a very interesting problem, and I spent some time getting familiar with the scanner codes.&lt;/p&gt;

&lt;p&gt;Codes show that user scanners can break the loop when it has reached the time/batch limit, though SKIP many cells in the process. At the beginning of the loop, it will check the time limit when the count of kvs scanned has up to the heart beat limit. So in this issue, user scanners can return before the timeout?&lt;/p&gt;

&lt;p&gt;But compaction scanners didn&apos;t set the time limit, so it might take a very long time to return from the loop until it has read batch limited size cells.&#160;&lt;/p&gt;

&lt;p&gt;As a result,&#160; we can use the `hbase.hstore.close.check.time.interval` as the time limit for compaction scanners, no need to add this `preventLoopReadEnabled` variable to ScannerContext? But refreshing the time limit after every time next() is not a regular practice.&#160;&#160;&lt;/p&gt;

&lt;p&gt;So the variable `preventLoopReadEnabled` may be just a flag for timed return when there are no time limits for scanners.&lt;/p&gt;

&lt;p&gt;If set&#160;preventLoopReadEnabled default on is better, I can change it. ^^&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17321036" author="xiaolin ha" created="Wed, 14 Apr 2021 14:13:45 +0000"  >&lt;p&gt;Yes, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stack&quot; class=&quot;user-hover&quot; rel=&quot;stack&quot;&gt;stack&lt;/a&gt; , you are right. Setting it default on will make all scanners be aborted as soon as possible. While only compaction scanners be aborted is not enough, because the user-scanner also want to be&#160;preempted instead of a long timeout return. What&apos;s more, it will not bring correctness issues, because the KeyValueHeap only used the result set, the top cell on the store heap is for completing whole raw cells, eagerly close for store scanners and some other checks...&lt;/p&gt;

&lt;p&gt;I have updated the PR, set default on, and add UTs to check both the semantic and the data correctness.&lt;/p&gt;

&lt;p&gt;Would you mind reviewing the patch again?&#160;&lt;/p&gt;</comment>
                            <comment id="17502075" author="xiaolin ha" created="Mon, 7 Mar 2022 04:03:55 +0000"  >&lt;p&gt;Merged to branch-2.4+, thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=apurtell&quot; class=&quot;user-hover&quot; rel=&quot;apurtell&quot;&gt;apurtell&lt;/a&gt; for reviewing.&lt;/p&gt;</comment>
                            <comment id="17502336" author="hudson" created="Mon, 7 Mar 2022 15:11:26 +0000"  >&lt;p&gt;Results for branch master&lt;br/&gt;
	&lt;a href=&quot;https://ci-hbase.apache.org/job/HBase%20Nightly/job/master/528/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;build #528 on builds.a.o&lt;/a&gt;: &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/error.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;b&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;&lt;/b&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;details (if available):&lt;/p&gt;

&lt;p&gt;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/check.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;font color=&quot;green&quot;&gt;+1 general checks&lt;/font&gt;&lt;br/&gt;
&amp;#8211; For more information &lt;a href=&quot;https://ci-hbase.apache.org/job/HBase%20Nightly/job/master/528/General_20Nightly_20Build_20Report/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;see general report&lt;/a&gt;&lt;/p&gt;








&lt;p&gt;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/error.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;font color=&quot;red&quot;&gt;-1 jdk11 hadoop3 checks&lt;/font&gt;&lt;br/&gt;
&amp;#8211; For more information &lt;a href=&quot;https://ci-hbase.apache.org/job/HBase%20Nightly/job/master/528/JDK11_20Nightly_20Build_20Report_20_28Hadoop3_29/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;see jdk11 report&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/check.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;font color=&quot;green&quot;&gt;+1 source release artifact&lt;/font&gt;&lt;br/&gt;
&amp;#8211; See build output for details.&lt;/p&gt;


&lt;p&gt;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/check.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;font color=&quot;green&quot;&gt;+1 client integration test&lt;/font&gt;&lt;/p&gt;</comment>
                            <comment id="17502776" author="hudson" created="Tue, 8 Mar 2022 07:45:52 +0000"  >&lt;p&gt;Results for branch branch-2.4&lt;br/&gt;
	&lt;a href=&quot;https://ci-hbase.apache.org/job/HBase%20Nightly/job/branch-2.4/302/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;build #302 on builds.a.o&lt;/a&gt;: &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/check.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;b&gt;&lt;font color=&quot;green&quot;&gt;+1 overall&lt;/font&gt;&lt;/b&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;details (if available):&lt;/p&gt;

&lt;p&gt;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/check.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;font color=&quot;green&quot;&gt;+1 general checks&lt;/font&gt;&lt;br/&gt;
&amp;#8211; For more information &lt;a href=&quot;https://ci-hbase.apache.org/job/HBase%20Nightly/job/branch-2.4/302/General_20Nightly_20Build_20Report/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;see general report&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/check.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;font color=&quot;green&quot;&gt;+1 jdk8 hadoop2 checks&lt;/font&gt;&lt;br/&gt;
&amp;#8211; For more information &lt;a href=&quot;https://ci-hbase.apache.org/job/HBase%20Nightly/job/branch-2.4/302/JDK8_20Nightly_20Build_20Report_20_28Hadoop2_29/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;see jdk8 (hadoop2) report&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/check.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;font color=&quot;green&quot;&gt;+1 jdk8 hadoop3 checks&lt;/font&gt;&lt;br/&gt;
&amp;#8211; For more information &lt;a href=&quot;https://ci-hbase.apache.org/job/HBase%20Nightly/job/branch-2.4/302/JDK8_20Nightly_20Build_20Report_20_28Hadoop3_29/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;see jdk8 (hadoop3) report&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/check.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;font color=&quot;green&quot;&gt;+1 jdk11 hadoop3 checks&lt;/font&gt;&lt;br/&gt;
&amp;#8211; For more information &lt;a href=&quot;https://ci-hbase.apache.org/job/HBase%20Nightly/job/branch-2.4/302/JDK11_20Nightly_20Build_20Report_20_28Hadoop3_29/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;see jdk11 report&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/check.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;font color=&quot;green&quot;&gt;+1 source release artifact&lt;/font&gt;&lt;br/&gt;
&amp;#8211; See build output for details.&lt;/p&gt;


&lt;p&gt;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/check.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;font color=&quot;green&quot;&gt;+1 client integration test&lt;/font&gt;&lt;/p&gt;</comment>
                            <comment id="17502877" author="hudson" created="Tue, 8 Mar 2022 11:42:15 +0000"  >&lt;p&gt;Results for branch branch-2&lt;br/&gt;
	&lt;a href=&quot;https://ci-hbase.apache.org/job/HBase%20Nightly/job/branch-2/477/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;build #477 on builds.a.o&lt;/a&gt;: &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/error.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;b&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;&lt;/b&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;details (if available):&lt;/p&gt;

&lt;p&gt;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/check.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;font color=&quot;green&quot;&gt;+1 general checks&lt;/font&gt;&lt;br/&gt;
&amp;#8211; For more information &lt;a href=&quot;https://ci-hbase.apache.org/job/HBase%20Nightly/job/branch-2/477/General_20Nightly_20Build_20Report/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;see general report&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/error.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;font color=&quot;red&quot;&gt;-1 jdk8 hadoop2 checks&lt;/font&gt;&lt;br/&gt;
&amp;#8211; For more information &lt;a href=&quot;https://ci-hbase.apache.org/job/HBase%20Nightly/job/branch-2/477/JDK8_20Nightly_20Build_20Report_20_28Hadoop2_29/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;see jdk8 (hadoop2) report&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/error.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;font color=&quot;red&quot;&gt;-1 jdk8 hadoop3 checks&lt;/font&gt;&lt;br/&gt;
&amp;#8211; For more information &lt;a href=&quot;https://ci-hbase.apache.org/job/HBase%20Nightly/job/branch-2/477/JDK8_20Nightly_20Build_20Report_20_28Hadoop3_29/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;see jdk8 (hadoop3) report&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/error.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;font color=&quot;red&quot;&gt;-1 jdk11 hadoop3 checks&lt;/font&gt;&lt;/p&gt;


&lt;p&gt;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/check.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;font color=&quot;green&quot;&gt;+1 source release artifact&lt;/font&gt;&lt;br/&gt;
&amp;#8211; See build output for details.&lt;/p&gt;


&lt;p&gt;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/error.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;font color=&quot;red&quot;&gt;-1 client integration test&lt;/font&gt;&lt;br/&gt;
--Failed when running client tests on top of Hadoop 2. &lt;a href=&quot;https://ci-hbase.apache.org/job/HBase%20Nightly/job/branch-2/477//artifact/output-integration/hadoop-2.log&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;see log for details&lt;/a&gt;. (note that this means we didn&apos;t run on Hadoop 3)&lt;/p&gt;</comment>
                            <comment id="17505344" author="hudson" created="Sat, 12 Mar 2022 19:30:24 +0000"  >&lt;p&gt;Results for branch branch-2.5&lt;br/&gt;
	&lt;a href=&quot;https://ci-hbase.apache.org/job/HBase%20Nightly/job/branch-2.5/61/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;build #61 on builds.a.o&lt;/a&gt;: &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/error.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;b&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;&lt;/b&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;details (if available):&lt;/p&gt;

&lt;p&gt;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/check.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;font color=&quot;green&quot;&gt;+1 general checks&lt;/font&gt;&lt;br/&gt;
&amp;#8211; For more information &lt;a href=&quot;https://ci-hbase.apache.org/job/HBase%20Nightly/job/branch-2.5/61/General_20Nightly_20Build_20Report/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;see general report&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/check.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;font color=&quot;green&quot;&gt;+1 jdk8 hadoop2 checks&lt;/font&gt;&lt;br/&gt;
&amp;#8211; For more information &lt;a href=&quot;https://ci-hbase.apache.org/job/HBase%20Nightly/job/branch-2.5/61/JDK8_20Nightly_20Build_20Report_20_28Hadoop2_29/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;see jdk8 (hadoop2) report&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/error.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;font color=&quot;red&quot;&gt;-1 jdk8 hadoop3 checks&lt;/font&gt;&lt;br/&gt;
&amp;#8211; For more information &lt;a href=&quot;https://ci-hbase.apache.org/job/HBase%20Nightly/job/branch-2.5/61/JDK8_20Nightly_20Build_20Report_20_28Hadoop3_29/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;see jdk8 (hadoop3) report&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/check.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;font color=&quot;green&quot;&gt;+1 jdk11 hadoop3 checks&lt;/font&gt;&lt;br/&gt;
&amp;#8211; For more information &lt;a href=&quot;https://ci-hbase.apache.org/job/HBase%20Nightly/job/branch-2.5/61/JDK11_20Nightly_20Build_20Report_20_28Hadoop3_29/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;see jdk11 report&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/error.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;font color=&quot;red&quot;&gt;-1 source release artifact&lt;/font&gt;&lt;br/&gt;
&amp;#8211; See build output for details.&lt;/p&gt;


&lt;p&gt;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/error.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;font color=&quot;red&quot;&gt;-1 client integration test&lt;/font&gt;&lt;br/&gt;
&amp;#8211; Something went wrong with this stage, &lt;a href=&quot;https://ci-hbase.apache.org/job/HBase%20Nightly/job/branch-2.5/61//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;check relevant console output&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="17552495" author="vjasani" created="Fri, 10 Jun 2022 01:23:07 +0000"  >&lt;p&gt;FYI, it seems that this change has likely caused a regression in Phoenix indexing test &lt;a href=&quot;https://issues.apache.org/jira/browse/PHOENIX-6702&quot; title=&quot;ConcurrentMutationsExtendedIT and PartialIndexRebuilderIT fail on Hbase 2.4.11+&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PHOENIX-6702&quot;&gt;&lt;del&gt;PHOENIX-6702&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="17552539" author="xiaolin ha" created="Fri, 10 Jun 2022 04:39:54 +0000"  >&lt;p&gt;Hi, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=vjasani&quot; class=&quot;user-hover&quot; rel=&quot;vjasani&quot;&gt;vjasani&lt;/a&gt; , I looked at &lt;a href=&quot;https://issues.apache.org/jira/browse/PHOENIX-6702&quot; title=&quot;ConcurrentMutationsExtendedIT and PartialIndexRebuilderIT fail on Hbase 2.4.11+&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PHOENIX-6702&quot;&gt;&lt;del&gt;PHOENIX-6702&lt;/del&gt;&lt;/a&gt; and your patch, do you doubt that this issue breaks large rows results? I added a UT TestHRegion#testTTLsUsingSmallHeartBeatCells to verify the scan can return the whole row when row cells count is larger than StoreScanner.HBASE_CELLS_SCANNED_PER_HEARTBEAT_CHECK in just once next(), please take a look. Thanks.&lt;/p&gt;</comment>
                            <comment id="17552935" author="vjasani" created="Fri, 10 Jun 2022 19:16:52 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Xiaolin+Ha&quot; class=&quot;user-hover&quot; rel=&quot;Xiaolin Ha&quot;&gt;Xiaolin Ha&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;I did some more digging and I do see discrepancies in Scan results w.r.t cells scanned interval per heartbeat check.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;If you apply this patch, the test passes whereas it should have failed. I am deleting the CQ after first Scan and before incrementing time:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
diff --git a/hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestHRegion.java b/hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestHRegion.java
index d41916ae3b..6736e12ad9 100644
--- a/hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestHRegion.java
+++ b/hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestHRegion.java
@@ -6955,6 +6955,7 @@ &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;TestHRegion {
&#160;
&#160;&#160; &#160; &lt;span class=&quot;code-comment&quot;&gt;// A query at time T+0 should &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; all cells
&lt;/span&gt;&#160;&#160; &#160; checkScan(8);
+&#160; &#160; region.delete(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Delete(row).addColumn(fam1, q8));
&#160;
&#160;&#160; &#160; &lt;span class=&quot;code-comment&quot;&gt;// Increment time to T+ttlSecs seconds
&lt;/span&gt;&#160;&#160; &#160; edge.incrementTime(ttlSecs * 1000); &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The expectation with this patch is that it should fail at&#160;&lt;b&gt;&lt;em&gt;checkScan(3)&lt;/em&gt;&lt;/b&gt; because it should have returned only 2 results instead of 3.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;However, if I apply this patch i.e. increment cells scanned per heartbeat check, the test fails as expected:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
diff --git a/hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestHRegion.java b/hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestHRegion.java
index d41916ae3b..a52eaecc48 100644
--- a/hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestHRegion.java
+++ b/hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestHRegion.java
@@ -6928,7 +6928,7 @@ &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;TestHRegion {
&#160;&#160; &#160; Configuration conf = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Configuration(TEST_UTIL.getConfiguration());
&#160;&#160; &#160; conf.setInt(HFile.FORMAT_VERSION_KEY, HFile.MIN_FORMAT_VERSION_WITH_TAGS);
&#160;&#160; &#160; &lt;span class=&quot;code-comment&quot;&gt;// using small heart beat cells
&lt;/span&gt;-&#160; &#160; conf.setLong(StoreScanner.HBASE_CELLS_SCANNED_PER_HEARTBEAT_CHECK, 2);
+&#160; &#160; conf.setLong(StoreScanner.HBASE_CELLS_SCANNED_PER_HEARTBEAT_CHECK, 20000);
&#160;
&#160;&#160; &#160; region = HBaseTestingUtility.createRegionAndWAL(
&#160;&#160; &#160; &#160; RegionInfoBuilder.newBuilder(tableDescriptor.getTableName()).build(),
@@ -6955,6 +6955,7 @@ &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;TestHRegion {
&#160;
&#160;&#160; &#160; &lt;span class=&quot;code-comment&quot;&gt;// A query at time T+0 should &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; all cells
&lt;/span&gt;&#160;&#160; &#160; checkScan(8);
+&#160; &#160; region.delete(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Delete(row).addColumn(fam1, q8));
&#160;
&#160;&#160; &#160; &lt;span class=&quot;code-comment&quot;&gt;// Increment time to T+ttlSecs seconds
&lt;/span&gt;&#160;&#160; &#160; edge.incrementTime(ttlSecs * 1000); &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Test failure logs:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
java.lang.AssertionError:&#160;
Expected :3
Actual &#160; :2
&amp;lt;Click to see difference&amp;gt;
&#160; &#160; at org.junit.Assert.fail(Assert.java:89)
&#160; &#160; at org.junit.Assert.failNotEquals(Assert.java:835)
&#160; &#160; at org.junit.Assert.assertEquals(Assert.java:647)
&#160; &#160; at org.junit.Assert.assertEquals(Assert.java:633)
&#160; &#160; at org.apache.hadoop.hbase.regionserver.TestHRegion.checkScan(TestHRegion.java:6972)
&#160; &#160; at org.apache.hadoop.hbase.regionserver.TestHRegion.testTTLsUsingSmallHeartBeatCells(TestHRegion.java:6962) &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;This is exactly the expected behaviour, which occurs only if we increment cells scanned per heartbeat check to very high number.&lt;/p&gt;

&lt;p&gt;We should fix this.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;FYI &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=apurtell&quot; class=&quot;user-hover&quot; rel=&quot;apurtell&quot;&gt;apurtell&lt;/a&gt; for upcoming 2.5 and 2.4 releases.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;FYI &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kadir&quot; class=&quot;user-hover&quot; rel=&quot;kadir&quot;&gt;kadir&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gjacoby&quot; class=&quot;user-hover&quot; rel=&quot;gjacoby&quot;&gt;gjacoby&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tkhurana&quot; class=&quot;user-hover&quot; rel=&quot;tkhurana&quot;&gt;tkhurana&lt;/a&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17552954" author="apurtell" created="Fri, 10 Jun 2022 20:01:27 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=vjasani&quot; class=&quot;user-hover&quot; rel=&quot;vjasani&quot;&gt;vjasani&lt;/a&gt; If there is a provable break here we can revert this in branch-2.4 and branch-2.5 and leave it in branch-2 and master for further improvement. &lt;/p&gt;</comment>
                            <comment id="17553314" author="bbeaudreault" created="Sun, 12 Jun 2022 18:49:26 +0000"  >&lt;p&gt;Can anyone comment how this bug might manifest in production? it&apos;s not super clear what &quot;breaks large row results&quot; means. We have this bug in prod and trying to determine impact.&lt;/p&gt;</comment>
                            <comment id="17553316" author="apurtell" created="Sun, 12 Jun 2022 18:56:47 +0000"  >&lt;p&gt;Phoenix saw it on &lt;a href=&quot;https://issues.apache.org/jira/browse/PHOENIX-6702&quot; title=&quot;ConcurrentMutationsExtendedIT and PartialIndexRebuilderIT fail on Hbase 2.4.11+&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PHOENIX-6702&quot;&gt;&lt;del&gt;PHOENIX-6702&lt;/del&gt;&lt;/a&gt; . This impacts us as &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=vjasani&quot; class=&quot;user-hover&quot; rel=&quot;vjasani&quot;&gt;vjasani&lt;/a&gt; has qualified it as a real problem blocking our builds that incorporate versions of HBase carrying this commit. It has been reverted by &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-27108&quot; title=&quot;Revert HBASE-25709&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-27108&quot;&gt;&lt;del&gt;HBASE-27108&lt;/del&gt;&lt;/a&gt;. Let me reopen this issue for any potential re-do.&lt;/p&gt;</comment>
                            <comment id="17553317" author="apurtell" created="Sun, 12 Jun 2022 18:57:34 +0000"  >&lt;p&gt;Please don&apos;t remove the 2.4.11 fix version. &lt;/p&gt;</comment>
                            <comment id="17553387" author="hudson" created="Mon, 13 Jun 2022 04:19:41 +0000"  >&lt;p&gt;Results for branch branch-2&lt;br/&gt;
	&lt;a href=&quot;https://ci-hbase.apache.org/job/HBase%20Nightly/job/branch-2/567/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;build #567 on builds.a.o&lt;/a&gt;: &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/error.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;b&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;&lt;/b&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;details (if available):&lt;/p&gt;

&lt;p&gt;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/check.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;font color=&quot;green&quot;&gt;+1 general checks&lt;/font&gt;&lt;br/&gt;
&amp;#8211; For more information &lt;a href=&quot;https://ci-hbase.apache.org/job/HBase%20Nightly/job/branch-2/567/General_20Nightly_20Build_20Report/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;see general report&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/error.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;font color=&quot;red&quot;&gt;-1 jdk8 hadoop2 checks&lt;/font&gt;&lt;br/&gt;
&amp;#8211; For more information &lt;a href=&quot;https://ci-hbase.apache.org/job/HBase%20Nightly/job/branch-2/567/JDK8_20Nightly_20Build_20Report_20_28Hadoop2_29/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;see jdk8 (hadoop2) report&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/error.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;font color=&quot;red&quot;&gt;-1 jdk8 hadoop3 checks&lt;/font&gt;&lt;br/&gt;
&amp;#8211; For more information &lt;a href=&quot;https://ci-hbase.apache.org/job/HBase%20Nightly/job/branch-2/567/JDK8_20Nightly_20Build_20Report_20_28Hadoop3_29/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;see jdk8 (hadoop3) report&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/check.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;font color=&quot;green&quot;&gt;+1 jdk11 hadoop3 checks&lt;/font&gt;&lt;br/&gt;
&amp;#8211; For more information &lt;a href=&quot;https://ci-hbase.apache.org/job/HBase%20Nightly/job/branch-2/567/JDK11_20Nightly_20Build_20Report_20_28Hadoop3_29/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;see jdk11 report&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/check.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;font color=&quot;green&quot;&gt;+1 source release artifact&lt;/font&gt;&lt;br/&gt;
&amp;#8211; See build output for details.&lt;/p&gt;


&lt;p&gt;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/check.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;font color=&quot;green&quot;&gt;+1 client integration test&lt;/font&gt;&lt;/p&gt;</comment>
                            <comment id="17553388" author="hudson" created="Mon, 13 Jun 2022 04:50:58 +0000"  >&lt;p&gt;Results for branch branch-2.4&lt;br/&gt;
	&lt;a href=&quot;https://ci-hbase.apache.org/job/HBase%20Nightly/job/branch-2.4/370/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;build #370 on builds.a.o&lt;/a&gt;: &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/error.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;b&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;&lt;/b&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;details (if available):&lt;/p&gt;

&lt;p&gt;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/error.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;font color=&quot;red&quot;&gt;-1 general checks&lt;/font&gt;&lt;br/&gt;
&amp;#8211; For more information &lt;a href=&quot;https://ci-hbase.apache.org/job/HBase%20Nightly/job/branch-2.4/370/General_20Nightly_20Build_20Report/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;see general report&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/check.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;font color=&quot;green&quot;&gt;+1 jdk8 hadoop2 checks&lt;/font&gt;&lt;br/&gt;
&amp;#8211; For more information &lt;a href=&quot;https://ci-hbase.apache.org/job/HBase%20Nightly/job/branch-2.4/370/JDK8_20Nightly_20Build_20Report_20_28Hadoop2_29/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;see jdk8 (hadoop2) report&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/error.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;font color=&quot;red&quot;&gt;-1 jdk8 hadoop3 checks&lt;/font&gt;&lt;br/&gt;
&amp;#8211; For more information &lt;a href=&quot;https://ci-hbase.apache.org/job/HBase%20Nightly/job/branch-2.4/370/JDK8_20Nightly_20Build_20Report_20_28Hadoop3_29/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;see jdk8 (hadoop3) report&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/check.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;font color=&quot;green&quot;&gt;+1 jdk11 hadoop3 checks&lt;/font&gt;&lt;br/&gt;
&amp;#8211; For more information &lt;a href=&quot;https://ci-hbase.apache.org/job/HBase%20Nightly/job/branch-2.4/370/JDK11_20Nightly_20Build_20Report_20_28Hadoop3_29/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;see jdk11 report&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/check.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;font color=&quot;green&quot;&gt;+1 source release artifact&lt;/font&gt;&lt;br/&gt;
&amp;#8211; See build output for details.&lt;/p&gt;


&lt;p&gt;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/check.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;font color=&quot;green&quot;&gt;+1 client integration test&lt;/font&gt;&lt;/p&gt;</comment>
                            <comment id="17553539" author="xiaolin ha" created="Mon, 13 Jun 2022 11:59:15 +0000"  >&lt;p&gt;Thanks for the excellent digging, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=vjasani&quot; class=&quot;user-hover&quot; rel=&quot;vjasani&quot;&gt;vjasani&lt;/a&gt; .&lt;/p&gt;

&lt;p&gt;The problem here is that, after returned by the heartbeat cells, the matcher was unexpectedly reset,&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-comment&quot;&gt;// If no limits exists in the scope LimitScope.Between_Cells then we are sure we are changing
&lt;/span&gt;&lt;span class=&quot;code-comment&quot;&gt;// rows. Else it is possible we are still traversing the same row so we must perform the row
&lt;/span&gt;&lt;span class=&quot;code-comment&quot;&gt;// comparison.
&lt;/span&gt;&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!scannerContext.hasAnyLimit(LimitScope.BETWEEN_CELLS) || matcher.currentRow() == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
  &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.countPerRow = 0;
  matcher.setToNewRow(cell);
} &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;then all the deletes of the row is cleared, and the next same row cells will be wrongly matched. This means the scanner context before and after the heartbeat return is inconsistent, it should hold the same row contexts until new rows.&lt;/p&gt;

&lt;p&gt;As in the test case you provided, when StoreScanner.HBASE_CELLS_SCANNED_PER_HEARTBEAT_CHECK=2 and mid-results are &lt;span class=&quot;error&quot;&gt;&amp;#91;q4,q5&amp;#93;&lt;/span&gt;, and the heartbeat count reached after &lt;span class=&quot;error&quot;&gt;&amp;#91;q8/delete&amp;#93;&lt;/span&gt;, then the &lt;span class=&quot;error&quot;&gt;&amp;#91;q8/put&amp;#93;&lt;/span&gt; will be wrongly added to results because matcher does not has &lt;span class=&quot;error&quot;&gt;&amp;#91;q8/delete&amp;#93;&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;I think for this issue, we can use the HRegion#checkInterrupt to avoid the stuck when closing region. Just as codes here,&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&#160;&#160; &#160; &#160; &#160; &lt;span class=&quot;code-comment&quot;&gt;// when reaching the heartbeat cells, &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; to &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; from the loop.
&lt;/span&gt;&#160;&#160; &#160; &#160; &#160; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (kvsScanned % cellsPerHeartbeatCheck == 0) {
-&#160; &#160; &#160; &#160; &#160; &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; scannerContext.setScannerState(NextState.MORE_VALUES).hasMoreValues();
+&#160; &#160; &#160; &#160; &#160; &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.store.getHRegion().checkInterrupt();
&#160;&#160; &#160; &#160; &#160; } &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;But we can also fix the matcher issue, because I think the matcher reset should only happens when scanner reaching new rows. And the early return when reached heartbeat cells can make user scanners return as soon as possible when encounters mass deletion. The fix codes are,&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
@@ -276,9 +278,12 @@ &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;abstract&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;ScanQueryMatcher &lt;span class=&quot;code-keyword&quot;&gt;implements&lt;/span&gt; ShipperListener {
&#160; &#160; * @param currentRow
&#160; &#160; */
&#160;&#160; &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void setToNewRow(Cell currentRow) {
-&#160; &#160; &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.currentRow = currentRow;
-&#160; &#160; columns.reset();
-&#160; &#160; reset();
+&#160; &#160; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.currentRow == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
+&#160; &#160; &#160; || &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.rowComparator.compareRows(currentRow, &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.currentRow) != 0) {
+&#160; &#160; &#160; &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.currentRow = currentRow;
+&#160; &#160; &#160; columns.reset();
+&#160; &#160; &#160; reset();
+&#160; &#160; }
&#160;&#160; } &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;I prefer the second solution, what do you think? &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=vjasani&quot; class=&quot;user-hover&quot; rel=&quot;vjasani&quot;&gt;vjasani&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=apurtell&quot; class=&quot;user-hover&quot; rel=&quot;apurtell&quot;&gt;apurtell&lt;/a&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17553776" author="hudson" created="Mon, 13 Jun 2022 20:12:14 +0000"  >&lt;p&gt;Results for branch branch-2.5&lt;br/&gt;
	&lt;a href=&quot;https://ci-hbase.apache.org/job/HBase%20Nightly/job/branch-2.5/142/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;build #142 on builds.a.o&lt;/a&gt;: &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/check.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;b&gt;&lt;font color=&quot;green&quot;&gt;+1 overall&lt;/font&gt;&lt;/b&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;details (if available):&lt;/p&gt;

&lt;p&gt;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/check.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;font color=&quot;green&quot;&gt;+1 general checks&lt;/font&gt;&lt;br/&gt;
&amp;#8211; For more information &lt;a href=&quot;https://ci-hbase.apache.org/job/HBase%20Nightly/job/branch-2.5/142/General_20Nightly_20Build_20Report/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;see general report&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/check.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;font color=&quot;green&quot;&gt;+1 jdk8 hadoop2 checks&lt;/font&gt;&lt;br/&gt;
&amp;#8211; For more information &lt;a href=&quot;https://ci-hbase.apache.org/job/HBase%20Nightly/job/branch-2.5/142/JDK8_20Nightly_20Build_20Report_20_28Hadoop2_29/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;see jdk8 (hadoop2) report&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/check.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;font color=&quot;green&quot;&gt;+1 jdk8 hadoop3 checks&lt;/font&gt;&lt;br/&gt;
&amp;#8211; For more information &lt;a href=&quot;https://ci-hbase.apache.org/job/HBase%20Nightly/job/branch-2.5/142/JDK8_20Nightly_20Build_20Report_20_28Hadoop3_29/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;see jdk8 (hadoop3) report&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/check.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;font color=&quot;green&quot;&gt;+1 jdk11 hadoop3 checks&lt;/font&gt;&lt;br/&gt;
&amp;#8211; For more information &lt;a href=&quot;https://ci-hbase.apache.org/job/HBase%20Nightly/job/branch-2.5/142/JDK11_20Nightly_20Build_20Report_20_28Hadoop3_29/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;see jdk11 report&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/check.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;font color=&quot;green&quot;&gt;+1 source release artifact&lt;/font&gt;&lt;br/&gt;
&amp;#8211; See build output for details.&lt;/p&gt;


&lt;p&gt;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/check.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;font color=&quot;green&quot;&gt;+1 client integration test&lt;/font&gt;&lt;/p&gt;</comment>
                            <comment id="17553837" author="hudson" created="Tue, 14 Jun 2022 00:50:39 +0000"  >&lt;p&gt;Results for branch master&lt;br/&gt;
	&lt;a href=&quot;https://ci-hbase.apache.org/job/HBase%20Nightly/job/master/611/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;build #611 on builds.a.o&lt;/a&gt;: &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/error.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;b&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;&lt;/b&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;details (if available):&lt;/p&gt;

&lt;p&gt;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/check.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;font color=&quot;green&quot;&gt;+1 general checks&lt;/font&gt;&lt;br/&gt;
&amp;#8211; For more information &lt;a href=&quot;https://ci-hbase.apache.org/job/HBase%20Nightly/job/master/611/General_20Nightly_20Build_20Report/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;see general report&lt;/a&gt;&lt;/p&gt;






&lt;p&gt;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/error.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;font color=&quot;red&quot;&gt;-1 jdk8 hadoop3 checks&lt;/font&gt;&lt;br/&gt;
&amp;#8211; For more information &lt;a href=&quot;https://ci-hbase.apache.org/job/HBase%20Nightly/job/master/611/JDK8_20Nightly_20Build_20Report_20_28Hadoop3_29/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;see jdk8 (hadoop3) report&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/check.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;font color=&quot;green&quot;&gt;+1 jdk11 hadoop3 checks&lt;/font&gt;&lt;br/&gt;
&amp;#8211; For more information &lt;a href=&quot;https://ci-hbase.apache.org/job/HBase%20Nightly/job/master/611/JDK11_20Nightly_20Build_20Report_20_28Hadoop3_29/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;see jdk11 report&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/check.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;font color=&quot;green&quot;&gt;+1 source release artifact&lt;/font&gt;&lt;br/&gt;
&amp;#8211; See build output for details.&lt;/p&gt;


&lt;p&gt;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/check.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;font color=&quot;green&quot;&gt;+1 client integration test&lt;/font&gt;&lt;/p&gt;</comment>
                            <comment id="17554336" author="vjasani" created="Wed, 15 Jun 2022 01:33:03 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Xiaolin+Ha&quot; class=&quot;user-hover&quot; rel=&quot;Xiaolin Ha&quot;&gt;Xiaolin Ha&lt;/a&gt; Thanks for providing further resolution. I am quite occupied this week, if still not reviewed, let me take a look next week. Thanks!&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=bbeaudreault&quot; class=&quot;user-hover&quot; rel=&quot;bbeaudreault&quot;&gt;bbeaudreault&lt;/a&gt; At high level, we can say that if the rows are quite large, and if the row also has delete markers as well, they are also returned by the scan. The patch I added in my previous comment would help understand at low level but that patch is applicable on the test that is now reverted with &lt;a href=&quot;https://github.com/apache/hbase/commit/5e34cdf1ef914b7c5d60df0edebd2f32ba543d02&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;this commit&lt;/a&gt;. Basically the repro can be done by reducing HBASE_CELLS_SCANNED_PER_HEARTBEAT_CHECK in the test.&lt;/p&gt;</comment>
                            <comment id="17554354" author="xiaolin ha" created="Wed, 15 Jun 2022 03:54:24 +0000"  >&lt;p&gt;Thank, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=vjasani&quot; class=&quot;user-hover&quot; rel=&quot;vjasani&quot;&gt;vjasani&lt;/a&gt; . It&apos;s not so urgent, and it&apos;s worth taking some time to figure this out. I&apos;ll update the PR, and hope you can review at your convenience.&lt;/p&gt;</comment>
                            <comment id="17696708" author="xiaolin ha" created="Mon, 6 Mar 2023 06:24:34 +0000"  >&lt;p&gt;Merged to branch-2 and master, thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=bbeaudreault&quot; class=&quot;user-hover&quot; rel=&quot;bbeaudreault&quot;&gt;bbeaudreault&lt;/a&gt; for reviewing, and thanks all the feedbacks!&lt;/p&gt;</comment>
                            <comment id="17696783" author="hudson" created="Mon, 6 Mar 2023 08:56:12 +0000"  >&lt;p&gt;Results for branch branch-2.5&lt;br/&gt;
	&lt;a href=&quot;https://ci-hbase.apache.org/job/HBase%20Nightly/job/branch-2.5/312/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;build #312 on builds.a.o&lt;/a&gt;: &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/error.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;b&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;&lt;/b&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;details (if available):&lt;/p&gt;

&lt;p&gt;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/error.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;font color=&quot;red&quot;&gt;-1 general checks&lt;/font&gt;&lt;br/&gt;
&amp;#8211; For more information &lt;a href=&quot;https://ci-hbase.apache.org/job/HBase%20Nightly/job/branch-2.5/312/General_20Nightly_20Build_20Report/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;see general report&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/error.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;font color=&quot;red&quot;&gt;-1 jdk8 hadoop2 checks&lt;/font&gt;&lt;br/&gt;
&amp;#8211; For more information &lt;a href=&quot;https://ci-hbase.apache.org/job/HBase%20Nightly/job/branch-2.5/312/JDK8_20Nightly_20Build_20Report_20_28Hadoop2_29/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;see jdk8 (hadoop2) report&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/error.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;font color=&quot;red&quot;&gt;-1 jdk8 hadoop3 checks&lt;/font&gt;&lt;br/&gt;
&amp;#8211; For more information &lt;a href=&quot;https://ci-hbase.apache.org/job/HBase%20Nightly/job/branch-2.5/312/JDK8_20Nightly_20Build_20Report_20_28Hadoop3_29/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;see jdk8 (hadoop3) report&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/error.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;font color=&quot;red&quot;&gt;-1 jdk11 hadoop3 checks&lt;/font&gt;&lt;br/&gt;
&amp;#8211; For more information &lt;a href=&quot;https://ci-hbase.apache.org/job/HBase%20Nightly/job/branch-2.5/312/JDK11_20Nightly_20Build_20Report_20_28Hadoop3_29/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;see jdk11 report&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/error.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;font color=&quot;red&quot;&gt;-1 source release artifact&lt;/font&gt;&lt;br/&gt;
&amp;#8211; See build output for details.&lt;/p&gt;


&lt;p&gt;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/error.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;font color=&quot;red&quot;&gt;-1 client integration test&lt;/font&gt;&lt;br/&gt;
&amp;#8211; Something went wrong with this stage, &lt;a href=&quot;https://ci-hbase.apache.org/job/HBase%20Nightly/job/branch-2.5/312//console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;check relevant console output&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="17697057" author="hudson" created="Mon, 6 Mar 2023 17:31:43 +0000"  >&lt;p&gt;Results for branch branch-2&lt;br/&gt;
	&lt;a href=&quot;https://ci-hbase.apache.org/job/HBase%20Nightly/job/branch-2/760/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;build #760 on builds.a.o&lt;/a&gt;: &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/error.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;b&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;&lt;/b&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;details (if available):&lt;/p&gt;

&lt;p&gt;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/check.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;font color=&quot;green&quot;&gt;+1 general checks&lt;/font&gt;&lt;br/&gt;
&amp;#8211; For more information &lt;a href=&quot;https://ci-hbase.apache.org/job/HBase%20Nightly/job/branch-2/760/General_20Nightly_20Build_20Report/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;see general report&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/check.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;font color=&quot;green&quot;&gt;+1 jdk8 hadoop2 checks&lt;/font&gt;&lt;br/&gt;
&amp;#8211; For more information &lt;a href=&quot;https://ci-hbase.apache.org/job/HBase%20Nightly/job/branch-2/760/JDK8_20Nightly_20Build_20Report_20_28Hadoop2_29/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;see jdk8 (hadoop2) report&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/check.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;font color=&quot;green&quot;&gt;+1 jdk8 hadoop3 checks&lt;/font&gt;&lt;br/&gt;
&amp;#8211; For more information &lt;a href=&quot;https://ci-hbase.apache.org/job/HBase%20Nightly/job/branch-2/760/JDK8_20Nightly_20Build_20Report_20_28Hadoop3_29/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;see jdk8 (hadoop3) report&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/error.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;font color=&quot;red&quot;&gt;-1 jdk11 hadoop3 checks&lt;/font&gt;&lt;br/&gt;
&amp;#8211; For more information &lt;a href=&quot;https://ci-hbase.apache.org/job/HBase%20Nightly/job/branch-2/760/JDK11_20Nightly_20Build_20Report_20_28Hadoop3_29/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;see jdk11 report&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/check.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;font color=&quot;green&quot;&gt;+1 source release artifact&lt;/font&gt;&lt;br/&gt;
&amp;#8211; See build output for details.&lt;/p&gt;


&lt;p&gt;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/check.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;font color=&quot;green&quot;&gt;+1 client integration test&lt;/font&gt;&lt;/p&gt;</comment>
                            <comment id="17697077" author="hudson" created="Mon, 6 Mar 2023 18:09:01 +0000"  >&lt;p&gt;Results for branch master&lt;br/&gt;
	&lt;a href=&quot;https://ci-hbase.apache.org/job/HBase%20Nightly/job/master/788/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;build #788 on builds.a.o&lt;/a&gt;: &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/error.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;b&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;&lt;/b&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;details (if available):&lt;/p&gt;

&lt;p&gt;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/check.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;font color=&quot;green&quot;&gt;+1 general checks&lt;/font&gt;&lt;br/&gt;
&amp;#8211; For more information &lt;a href=&quot;https://ci-hbase.apache.org/job/HBase%20Nightly/job/master/788/General_20Nightly_20Build_20Report/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;see general report&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/error.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;font color=&quot;red&quot;&gt;-1 jdk8 hadoop3 checks&lt;/font&gt;&lt;br/&gt;
&amp;#8211; For more information &lt;a href=&quot;https://ci-hbase.apache.org/job/HBase%20Nightly/job/master/788/JDK8_20Nightly_20Build_20Report_20_28Hadoop3_29/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;see jdk8 (hadoop3) report&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/check.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;font color=&quot;green&quot;&gt;+1 jdk11 hadoop3 checks&lt;/font&gt;&lt;br/&gt;
&amp;#8211; For more information &lt;a href=&quot;https://ci-hbase.apache.org/job/HBase%20Nightly/job/master/788/JDK11_20Nightly_20Build_20Report_20_28Hadoop3_29/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;see jdk11 report&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/check.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;font color=&quot;green&quot;&gt;+1 source release artifact&lt;/font&gt;&lt;br/&gt;
&amp;#8211; See build output for details.&lt;/p&gt;


&lt;p&gt;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/check.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;font color=&quot;green&quot;&gt;+1 client integration test&lt;/font&gt;&lt;/p&gt;</comment>
                            <comment id="17697104" author="hudson" created="Mon, 6 Mar 2023 18:58:07 +0000"  >&lt;p&gt;Results for branch branch-2.5&lt;br/&gt;
	&lt;a href=&quot;https://ci-hbase.apache.org/job/HBase%20Nightly/job/branch-2.5/313/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;build #313 on builds.a.o&lt;/a&gt;: &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/error.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;b&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;&lt;/b&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;details (if available):&lt;/p&gt;

&lt;p&gt;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/check.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;font color=&quot;green&quot;&gt;+1 general checks&lt;/font&gt;&lt;br/&gt;
&amp;#8211; For more information &lt;a href=&quot;https://ci-hbase.apache.org/job/HBase%20Nightly/job/branch-2.5/313/General_20Nightly_20Build_20Report/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;see general report&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/check.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;font color=&quot;green&quot;&gt;+1 jdk8 hadoop2 checks&lt;/font&gt;&lt;br/&gt;
&amp;#8211; For more information &lt;a href=&quot;https://ci-hbase.apache.org/job/HBase%20Nightly/job/branch-2.5/313/JDK8_20Nightly_20Build_20Report_20_28Hadoop2_29/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;see jdk8 (hadoop2) report&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/error.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;font color=&quot;red&quot;&gt;-1 jdk8 hadoop3 checks&lt;/font&gt;&lt;br/&gt;
&amp;#8211; For more information &lt;a href=&quot;https://ci-hbase.apache.org/job/HBase%20Nightly/job/branch-2.5/313/JDK8_20Nightly_20Build_20Report_20_28Hadoop3_29/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;see jdk8 (hadoop3) report&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/check.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;font color=&quot;green&quot;&gt;+1 jdk11 hadoop3 checks&lt;/font&gt;&lt;br/&gt;
&amp;#8211; For more information &lt;a href=&quot;https://ci-hbase.apache.org/job/HBase%20Nightly/job/branch-2.5/313/JDK11_20Nightly_20Build_20Report_20_28Hadoop3_29/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;see jdk11 report&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/check.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;font color=&quot;green&quot;&gt;+1 source release artifact&lt;/font&gt;&lt;br/&gt;
&amp;#8211; See build output for details.&lt;/p&gt;


&lt;p&gt;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/check.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;font color=&quot;green&quot;&gt;+1 client integration test&lt;/font&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310560">
                    <name>Problem/Incident</name>
                                            <outwardlinks description="causes">
                                        <issuelink>
            <issuekey id="13442533">HBASE-26991</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13450369">PHOENIX-6734</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13449645">HBASE-27108</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="12310050">
                    <name>Regression</name>
                                            <outwardlinks description="breaks">
                                        <issuelink>
            <issuekey id="13442506">PHOENIX-6702</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="13023103" name="Master-UI-RIT.png" size="226769" author="Xiaolin Ha" created="Mon, 29 Mar 2021 08:01:57 +0000"/>
                            <attachment id="13023104" name="RS-region-state.png" size="871194" author="Xiaolin Ha" created="Mon, 29 Mar 2021 08:01:24 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 35 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0pbgo:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>