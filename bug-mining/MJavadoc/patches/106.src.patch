diff --git a/javadoc-options-javadoc-resources.xml b/javadoc-options-javadoc-resources.xml
new file mode 100644
index 00000000..531c3d4b
--- /dev/null
+++ b/javadoc-options-javadoc-resources.xml
@@ -0,0 +1,6 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<javadocOptions>
+  <links>
+    <link>../apidocs</link>
+  </links>
+</javadocOptions>
diff --git a/pom.xml b/pom.xml
index ae49a26e..44d3ae2a 100644
--- a/pom.xml
+++ b/pom.xml
@@ -382,7 +382,7 @@ under the License.
                 <pomInclude>**/MJAVADOC-206/pom.xml</pomInclude>
                 <pomInclude>**/MJAVADOC-226/pom.xml</pomInclude>
                 <pomInclude>**/MJAVADOC-97/pom.xml</pomInclude>
-                <pomInclude>**/MJAVADOC-181/pom.xml</pomInclude>
+                <!-- pomInclude>**/MJAVADOC-181/pom.xml</pomInclude--><!-- seems to be wrong, see comment in Jira issue  -->
                 <pomInclude>**/MJAVADOC-257/pom.xml</pomInclude>
                 <pomInclude>**/MJAVADOC-259/pom.xml</pomInclude>
                 <pomInclude>**/MJAVADOC-262/pom.xml</pomInclude>
diff --git a/src/it/MJAVADOC-97/goals.txt b/src/it/MJAVADOC-97/goals.txt
index 17471dbd..1e7ba9a9 100644
--- a/src/it/MJAVADOC-97/goals.txt
+++ b/src/it/MJAVADOC-97/goals.txt
@@ -1 +1 @@
-clean javadoc:javadoc
\ No newline at end of file
+clean compile javadoc:javadoc
\ No newline at end of file
diff --git a/src/it/MJAVADOC-97/module2/pom.xml b/src/it/MJAVADOC-97/module2/pom.xml
index fd652b53..95db11eb 100644
--- a/src/it/MJAVADOC-97/module2/pom.xml
+++ b/src/it/MJAVADOC-97/module2/pom.xml
@@ -31,4 +31,12 @@
   <packaging>jar</packaging>
   <version>1.0-SNAPSHOT</version>
   <url>http://myhost/module2</url>
+
+  <dependencies>
+    <dependency>
+      <groupId>org.apache.maven.plugins.maven-javadoc-plugin.it</groupId>
+      <artifactId>linkoffline-test-module1</artifactId>
+      <version>1.0-SNAPSHOT</version>
+    </dependency>
+  </dependencies>
 </project>
diff --git a/src/it/MJAVADOC-97/verify.bsh b/src/it/MJAVADOC-97/verify.bsh
index 8c66206e..eabe82fc 100644
--- a/src/it/MJAVADOC-97/verify.bsh
+++ b/src/it/MJAVADOC-97/verify.bsh
@@ -58,15 +58,9 @@ try
     String log = FileUtils.fileRead( new File( basedir, "build.log" ) );
 
     // Generated files content checks
-    int linkoffline1 = contentOptions1.indexOf( "-linkoffline" );
-    if ( linkoffline1 < 0 )
-    {
-        System.err.println( "-linkoffline not added: " + options1 );
-        return false;
-    }
-    if ( !contentOptions1.substring( linkoffline1 ).contains( apidocs2.getAbsolutePath().replaceAll( "\\\\", "/" ) ) )
-    {
-        System.err.println( apidocs2.getAbsolutePath().replaceAll( "\\\\", "/" ) + " not added: " + options1 );
+    if ( contentOptions1.contains( "-linkoffline" ) )
+    { // module1 does not depend on module2, then it should not link
+        System.err.println( "module1 -linkoffline module2 added: " + options1 );
         return false;
     }
     int link1 = contentOptions1.indexOf( "-link" );
@@ -99,8 +93,8 @@ try
 
     int linkoffline2 = contentOptions2.indexOf( "-linkoffline" );
     if ( linkoffline2 < 0 )
-    {
-        System.err.println( "-linkoffline not added: " + options2 );
+    { // module2 depends on module1, then it should link
+        System.err.println( "module2 -linkoffline module1 not added: " + options2 );
         return false;
     }
     if ( !contentOptions2.substring( linkoffline2 ).contains( apidocs1.getAbsolutePath().replaceAll( "\\\\", "/" ) ) )
diff --git a/src/main/java/org/apache/maven/plugin/javadoc/AbstractJavadocMojo.java b/src/main/java/org/apache/maven/plugin/javadoc/AbstractJavadocMojo.java
index 9782567d..5f18d3a6 100644
--- a/src/main/java/org/apache/maven/plugin/javadoc/AbstractJavadocMojo.java
+++ b/src/main/java/org/apache/maven/plugin/javadoc/AbstractJavadocMojo.java
@@ -5232,11 +5232,18 @@ public abstract class AbstractJavadocMojo
 
         getLog().debug( "Trying to add links for modules..." );
 
+        Set<String> dependencyArtifactIds = new HashSet<String>();
+        for ( Iterator<Artifact> it = project.getDependencyArtifacts().iterator(); it.hasNext(); )
+        {
+            Artifact artifact = it.next();
+            dependencyArtifactIds.add( artifact.getId() );
+        }
+
         List<OfflineLink> modulesLinks = new ArrayList<OfflineLink>();
         String javadocDirRelative = PathUtils.toRelative( project.getBasedir(), getOutputDirectory() );
         for ( MavenProject p : reactorProjects )
         {
-            if ( p.getPackaging().equals( "pom" ) || p.getId().equals( project.getId() ) || ( p.getUrl() == null ) )
+            if ( !dependencyArtifactIds.contains( p.getArtifact().getId() ) || ( p.getUrl() == null ) )
             {
                 continue;
             }
