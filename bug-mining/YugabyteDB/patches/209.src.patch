diff --git a/src/yb/integration-tests/upgrade-tests/pg15_upgrade_test_base.cc b/src/yb/integration-tests/upgrade-tests/pg15_upgrade_test_base.cc
index c10f2a67a6..19a60b5732 100644
--- a/src/yb/integration-tests/upgrade-tests/pg15_upgrade_test_base.cc
+++ b/src/yb/integration-tests/upgrade-tests/pg15_upgrade_test_base.cc
@@ -18,6 +18,7 @@
 #include "yb/master/master_admin.pb.h"
 #include "yb/master/master_admin.proxy.h"
 #include "yb/master/master_defaults.h"
+#include "yb/util/backoff_waiter.h"
 #include "yb/yql/pgwrapper/libpq_utils.h"
 #include "yb/util/env_util.h"
 
@@ -262,4 +263,14 @@ Result<std::string> Pg15UpgradeTestBase::DumpYsqlCatalogConfig() {
   return resp.entries(0).pb_debug_string();
 }
 
+Status Pg15UpgradeTestBase::WaitForState(master::YsqlMajorCatalogUpgradeInfoPB::State state) {
+  auto state_str = master::YsqlMajorCatalogUpgradeInfoPB::State_Name(state);
+  return LoggedWaitFor(
+      [&]() -> Result<bool> {
+        return VERIFY_RESULT(DumpYsqlCatalogConfig()).find(Format("state: $0", state_str)) !=
+               std::string::npos;
+      },
+      5min, "Waiting for upgrade to reach state " + state_str);
+}
+
 }  // namespace yb
diff --git a/src/yb/integration-tests/upgrade-tests/pg15_upgrade_test_base.h b/src/yb/integration-tests/upgrade-tests/pg15_upgrade_test_base.h
index 1f16fca64b..c524c86b32 100644
--- a/src/yb/integration-tests/upgrade-tests/pg15_upgrade_test_base.h
+++ b/src/yb/integration-tests/upgrade-tests/pg15_upgrade_test_base.h
@@ -67,6 +67,8 @@ class Pg15UpgradeTestBase : public UpgradeTestBase {
 
   Result<std::string> DumpYsqlCatalogConfig();
 
+  Status WaitForState(master::YsqlMajorCatalogUpgradeInfoPB::State state);
+
   constexpr static auto kSimpleTableName = "simple_tbl";
   uint32 simple_tbl_row_count_ = 0;
 };
diff --git a/src/yb/integration-tests/upgrade-tests/ysql_major_upgrade_rpcs-test.cc b/src/yb/integration-tests/upgrade-tests/ysql_major_upgrade_rpcs-test.cc
index 951543c58b..90c99129d4 100644
--- a/src/yb/integration-tests/upgrade-tests/ysql_major_upgrade_rpcs-test.cc
+++ b/src/yb/integration-tests/upgrade-tests/ysql_major_upgrade_rpcs-test.cc
@@ -206,10 +206,16 @@ TEST_F(YsqlMajorUpgradeRpcsTest, YB_DISABLE_TEST_EXCEPT_RELEASE(MasterCrashDurin
   ASSERT_OK(RestartAllMastersInCurrentVersion(kNoDelayBetweenNodes));
   auto master_leader = cluster_->GetLeaderMaster();
 
+  auto state_to_fail_at = master::YsqlMajorCatalogUpgradeInfoPB::PERFORMING_PG_UPGRADE;
+#ifdef __APPLE__
+  // Mac machines are slow so fail earlier.
+  state_to_fail_at = master::YsqlMajorCatalogUpgradeInfoPB::PERFORMING_INIT_DB;
+#endif
+
   // Block the upgrade from finishing.
   ASSERT_OK(cluster_->SetFlag(
       master_leader, "TEST_fail_ysql_catalog_upgrade_state_transition_from",
-      "PERFORMING_PG_UPGRADE"));
+      master::YsqlMajorCatalogUpgradeInfoPB::State_Name(state_to_fail_at)));
 
   rpc::RpcController rpc;
   CountDownLatch latch(1);
@@ -217,12 +223,7 @@ TEST_F(YsqlMajorUpgradeRpcsTest, YB_DISABLE_TEST_EXCEPT_RELEASE(MasterCrashDurin
   AsyncStartYsqlMajorUpgrade(upgrade_response, rpc, latch);
   latch.Wait();
 
-  ASSERT_OK(LoggedWaitFor(
-      [this]() -> Result<bool> {
-        return VERIFY_RESULT(DumpYsqlCatalogConfig()).find("state: PERFORMING_PG_UPGRADE") !=
-               std::string::npos;
-      },
-      5min, "Waiting for pg_upgrade to start"));
+  ASSERT_OK(WaitForState(state_to_fail_at));
 
   // The pg_upgrade takes longer than 2s in all builds.
   SleepFor(2s);
