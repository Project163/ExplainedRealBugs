diff --git a/src/yb/integration-tests/upgrade-tests/pg15_upgrade-test.cc b/src/yb/integration-tests/upgrade-tests/pg15_upgrade-test.cc
index e75098689d..166835c78f 100644
--- a/src/yb/integration-tests/upgrade-tests/pg15_upgrade-test.cc
+++ b/src/yb/integration-tests/upgrade-tests/pg15_upgrade-test.cc
@@ -102,7 +102,16 @@ TEST_F(Pg15UpgradeTest, CheckVersion) {
 
 TEST_F(Pg15UpgradeTest, SimpleTableUpgrade) { ASSERT_OK(TestUpgradeWithSimpleTable()); }
 
-TEST_F(Pg15UpgradeTest, SimpleTableRollback) { ASSERT_OK(TestRollbackWithSimpleTable()); }
+TEST_F(Pg15UpgradeTest, SimpleTableRollback) {
+  ASSERT_OK(TestRollbackWithSimpleTable());
+
+// Disabled the re-upgrade step on debug builds and MacOS because it times out.
+#if !defined(__APPLE__) && defined(NDEBUG)
+  ASSERT_OK(UpgradeClusterToCurrentVersion(kNoDelayBetweenNodes));
+
+  ASSERT_OK(InsertRowInSimpleTableAndValidate());
+#endif
+}
 
 TEST_F(Pg15UpgradeTest, BackslashD) {
   ASSERT_OK(ExecuteStatement("CREATE TABLE t (a INT)"));
diff --git a/src/yb/integration-tests/upgrade-tests/pg15_upgrade_test_base.cc b/src/yb/integration-tests/upgrade-tests/pg15_upgrade_test_base.cc
index 09400a814c..f684ea2e86 100644
--- a/src/yb/integration-tests/upgrade-tests/pg15_upgrade_test_base.cc
+++ b/src/yb/integration-tests/upgrade-tests/pg15_upgrade_test_base.cc
@@ -64,9 +64,8 @@ Status Pg15UpgradeTestBase::UpgradeClusterToMixedMode() {
 
   LOG(INFO) << "Upgrading cluster to mixed mode";
 
-  static const MonoDelta no_delay_between_nodes = 0s;
   RETURN_NOT_OK_PREPEND(
-      RestartAllMastersInCurrentVersion(no_delay_between_nodes), "Failed to restart masters");
+      RestartAllMastersInCurrentVersion(kNoDelayBetweenNodes), "Failed to restart masters");
 
   RETURN_NOT_OK_PREPEND(
       PerformYsqlMajorCatalogUpgrade(), "Failed to run ysql major catalog upgrade");
@@ -108,9 +107,8 @@ Status Pg15UpgradeTestBase::RollbackUpgradeFromMixedMode() {
   RETURN_NOT_OK_PREPEND(
       RollbackYsqlMajorCatalogVersion(), "Failed to run ysql major catalog rollback");
 
-  static const MonoDelta no_delay_between_nodes = 0s;
   RETURN_NOT_OK_PREPEND(
-      RestartAllMastersInOldVersion(no_delay_between_nodes), "Failed to restart masters");
+      RestartAllMastersInOldVersion(kNoDelayBetweenNodes), "Failed to restart masters");
 
   return Status::OK();
 }
@@ -244,6 +242,13 @@ Status Pg15UpgradeTestBase::TestUpgradeWithSimpleTable() {
 }
 
 Status Pg15UpgradeTestBase::TestRollbackWithSimpleTable() {
+  // Create an extra DB with a table to make sure the rollback with multiple DBs work.
+  {
+    RETURN_NOT_OK(ExecuteStatement("CREATE DATABASE db1"));
+    auto db1_conn = VERIFY_RESULT(cluster_->ConnectToDB("db1"));
+    RETURN_NOT_OK(db1_conn.Execute("CREATE TABLE t (a INT)"));
+  }
+
   RETURN_NOT_OK(CreateSimpleTable());
 
   RETURN_NOT_OK(UpgradeClusterToMixedMode());
diff --git a/src/yb/master/catalog_manager.cc b/src/yb/master/catalog_manager.cc
index d164758a20..bbdef255c7 100644
--- a/src/yb/master/catalog_manager.cc
+++ b/src/yb/master/catalog_manager.cc
@@ -8450,14 +8450,14 @@ Status CatalogManager::CreateNamespace(const CreateNamespaceRequestPB* req,
   TransactionMetadata txn;
   const auto db_type = GetDatabaseType(*req);
   NamespaceInfo::WriteLock ns_l;
+  const bool is_ysql_major_upgrade_in_progress = IsYsqlMajorCatalogUpgradeInProgress();
+
   {
     LockGuard lock(mutex_);
     TRACE("Acquired catalog manager lock");
 
     // Validate the user request.
 
-    const bool is_ysql_major_upgrade_in_progress = IsYsqlMajorCatalogUpgradeInProgress();
-
     auto check_ns_errors = [req, resp, db_type, is_ysql_major_upgrade_in_progress](
                                const scoped_refptr<NamespaceInfo>& ns, bool by_id) -> Status {
       Status return_status;
@@ -8627,7 +8627,7 @@ Status CatalogManager::CreateNamespace(const CreateNamespaceRequestPB* req,
   if (!return_status.ok()) {
     ns_l.Unlock();
     LOG(WARNING) << "Keyspace creation failed:" << return_status.ToString();
-    {
+    if (!is_ysql_major_upgrade_in_progress) {
       LockGuard lock(mutex_);
       namespace_ids_map_.erase(ns->id());
       namespace_names_mapper_[db_type].erase(req->name());
diff --git a/src/yb/master/ysql/ysql_initdb_major_upgrade_handler.cc b/src/yb/master/ysql/ysql_initdb_major_upgrade_handler.cc
index 5d55a8cd52..0c3bfbff73 100644
--- a/src/yb/master/ysql/ysql_initdb_major_upgrade_handler.cc
+++ b/src/yb/master/ysql/ysql_initdb_major_upgrade_handler.cc
@@ -412,7 +412,7 @@ Status YsqlInitDBAndMajorUpgradeHandler::RunRollbackMajorVersionUpgrade(const Le
 }
 
 Status YsqlInitDBAndMajorUpgradeHandler::RollbackMajorVersionCatalogImpl(const LeaderEpoch& epoch) {
-  std::vector<scoped_refptr<NamespaceInfo>> namespaces;
+  std::vector<scoped_refptr<NamespaceInfo>> ysql_namespaces;
   {
     std::vector<scoped_refptr<NamespaceInfo>> all_namespaces;
     catalog_manager_.GetAllNamespaces(&all_namespaces);
@@ -421,14 +421,11 @@ Status YsqlInitDBAndMajorUpgradeHandler::RollbackMajorVersionCatalogImpl(const L
       if (ns_info->database_type() != YQL_DATABASE_PGSQL) {
         continue;
       }
-      uint32_t oid = VERIFY_RESULT(GetPgsqlDatabaseOid(ns_info->id()));
-      if (oid < kPgFirstNormalObjectId) {
-        namespaces.push_back(ns_info);
-      }
+      ysql_namespaces.push_back(ns_info);
     }
   }
 
-  for (const auto& ns_info : namespaces) {
+  for (const auto& ns_info : ysql_namespaces) {
     LOG(INFO) << "Deleting ysql major catalog tables for namespace " << ns_info->name();
     RETURN_NOT_OK(catalog_manager_.DeleteYsqlDBTables(
         ns_info->id(),
@@ -437,7 +434,7 @@ Status YsqlInitDBAndMajorUpgradeHandler::RollbackMajorVersionCatalogImpl(const L
 
   // Reset state machines for all YSQL namespaces.
   {
-    for (const auto& ns_info : namespaces) {
+    for (const auto& ns_info : ysql_namespaces) {
       NamespaceInfo::WriteLock ns_l = ns_info->LockForWrite();
       if (ns_info->database_type() != YQL_DATABASE_PGSQL) {
         continue;
