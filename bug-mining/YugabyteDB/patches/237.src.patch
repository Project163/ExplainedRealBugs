diff --git a/src/yb/master/catalog_manager.cc b/src/yb/master/catalog_manager.cc
index 415458b94f..6538b522c5 100644
--- a/src/yb/master/catalog_manager.cc
+++ b/src/yb/master/catalog_manager.cc
@@ -7027,7 +7027,7 @@ void CatalogManager::CleanUpDeletedTables(const LeaderEpoch& epoch) {
     }
     // TODO: Check if we want to delete the totally deleted table from the sys_catalog here.
     // TODO: SysCatalog::DeleteItem() if we've DELETED all user tables in a DELETING namespace.
-    // TODO: Also properly handle namespace_ids_map_.erase(table->namespace_id())
+    // TODO: Also properly handle RemoveNamespaceFromMaps
   }
 }
 
@@ -8625,9 +8625,7 @@ Status CatalogManager::CreateNamespace(const CreateNamespaceRequestPB* req,
     ns_l.Unlock();
     LOG(WARNING) << "Keyspace creation failed:" << return_status.ToString();
     if (!is_ysql_major_upgrade_in_progress) {
-      LockGuard lock(mutex_);
-      namespace_ids_map_.erase(ns->id());
-      namespace_names_mapper_[db_type].erase(req->name());
+      RemoveNamespaceFromMaps(db_type, ns->id(), req->name());
     }
     return CheckIfNoLongerLeaderAndSetupError(return_status, resp);
   }
@@ -9084,15 +9082,7 @@ Status CatalogManager::DoDeleteNamespace(const DeleteNamespaceRequestPB* req,
   // RUNNING namespace that we've removed from the sys catalog?
 
   // Remove the namespace from all CatalogManager mappings.
-  {
-    LockGuard lock(mutex_);
-    if (namespace_names_mapper_[ns->database_type()].erase(ns->name()) < 1) {
-      LOG(WARNING) << Format("Could not remove namespace from names map, id=$1", ns->id());
-    }
-    if (namespace_ids_map_.erase(ns->id()) < 1) {
-      LOG(WARNING) << Format("Could not remove namespace from ids map, id=$1", ns->id());
-    }
-  }
+  RemoveNamespaceFromMaps(ns->database_type(), ns->id(), ns->name());
 
   // Delete any permissions granted on this keyspace to any role. See comment in DeleteTable() for
   // more details.
@@ -13493,5 +13483,23 @@ bool CatalogManager::SkipCatalogVersionChecks() {
   return false;
 }
 
+void CatalogManager::RemoveNamespaceFromMaps(
+    YQLDatabase db_type, const NamespaceId& ns_id, const NamespaceName& ns_name) {
+  if (db_type == YQL_DATABASE_PGSQL && ysql_manager_->IsMajorUpgradeInProgress()) {
+    LOG(DFATAL)
+        << "Removing YSQL namespace from maps while major upgrade is in progress is not allowed: "
+        << ns_id;
+    return;
+  }
+
+  LockGuard lock(mutex_);
+  if (namespace_names_mapper_[db_type].erase(ns_name) < 1) {
+    LOG(DFATAL) << Format("Could not remove namespace from names map, id=$1", ns_id);
+  }
+  if (namespace_ids_map_.erase(ns_id) < 1) {
+    LOG(DFATAL) << Format("Could not remove namespace from ids map, id=$1", ns_id);
+  }
+}
+
 }  // namespace master
 }  // namespace yb
diff --git a/src/yb/master/catalog_manager.h b/src/yb/master/catalog_manager.h
index c8d7e66c6c..7915b32030 100644
--- a/src/yb/master/catalog_manager.h
+++ b/src/yb/master/catalog_manager.h
@@ -2949,6 +2949,9 @@ class CatalogManager : public CatalogManagerIf, public SnapshotCoordinatorContex
 
   bool SkipCatalogVersionChecks() override;
 
+  void RemoveNamespaceFromMaps(
+      YQLDatabase db_type, const NamespaceId& ns_id, const NamespaceName& ns_name) EXCLUDES(mutex_);
+
   // Should be bumped up when tablet locations are changed.
   std::atomic<uintptr_t> tablet_locations_version_{0};
 
