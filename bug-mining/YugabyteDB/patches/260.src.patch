diff --git a/src/yb/integration-tests/cdcsdk_ysql_test_base.cc b/src/yb/integration-tests/cdcsdk_ysql_test_base.cc
index eecd762f53..b68c50f985 100644
--- a/src/yb/integration-tests/cdcsdk_ysql_test_base.cc
+++ b/src/yb/integration-tests/cdcsdk_ysql_test_base.cc
@@ -25,6 +25,7 @@
 #include "yb/master/catalog_manager.h"
 #include "yb/master/master_client.pb.h"
 #include "yb/master/master_cluster.proxy.h"
+#include "yb/rocksdb/db.h"
 #include "yb/rpc/rpc_controller.h"
 #include "yb/tablet/tablet_peer.h"
 #include "yb/tserver/mini_tablet_server.h"
diff --git a/src/yb/integration-tests/cql_geo_transactions-test.cc b/src/yb/integration-tests/cql_geo_transactions-test.cc
index 0e42e95d06..48b0e50fed 100644
--- a/src/yb/integration-tests/cql_geo_transactions-test.cc
+++ b/src/yb/integration-tests/cql_geo_transactions-test.cc
@@ -18,8 +18,7 @@
 #include "yb/integration-tests/cql_test_base.h"
 #include "yb/integration-tests/mini_cluster_utils.h"
 
-#include "yb/master/catalog_entity_info.pb.h"
-#include "yb/master/catalog_manager.h"
+#include "yb/master/master_defaults.h"
 
 #include "yb/tserver/mini_tablet_server.h"
 #include "yb/tserver/tablet_server.h"
diff --git a/src/yb/integration-tests/object_lock-test.cc b/src/yb/integration-tests/object_lock-test.cc
index fef1e1601f..d1ed85dab9 100644
--- a/src/yb/integration-tests/object_lock-test.cc
+++ b/src/yb/integration-tests/object_lock-test.cc
@@ -20,6 +20,7 @@
 
 #include "yb/common/ysql_operation_lease.h"
 
+#include "yb/docdb/lock_util.h"
 #include "yb/docdb/object_lock_data.h"
 
 #include "yb/integration-tests/external_mini_cluster.h"
diff --git a/src/yb/master/catalog_loaders.cc b/src/yb/master/catalog_loaders.cc
index 3f23e0b295..9a976b0f48 100644
--- a/src/yb/master/catalog_loaders.cc
+++ b/src/yb/master/catalog_loaders.cc
@@ -37,6 +37,7 @@
 
 #include "yb/master/async_rpc_tasks.h"
 #include "yb/master/backfill_index.h"
+#include "yb/master/master_defaults.h"
 #include "yb/master/master_util.h"
 #include "yb/master/xcluster/xcluster_manager_if.h"
 #include "yb/master/ysql/ysql_manager.h"
diff --git a/src/yb/master/catalog_manager.cc b/src/yb/master/catalog_manager.cc
index d605cde797..04fcd23635 100644
--- a/src/yb/master/catalog_manager.cc
+++ b/src/yb/master/catalog_manager.cc
@@ -145,6 +145,7 @@
 #include "yb/master/post_tablet_create_task_base.h"
 #include "yb/master/sys_catalog.h"
 #include "yb/master/sys_catalog_constants.h"
+#include "yb/master/tablet_creation_limits.h"
 #include "yb/master/tablet_split_manager.h"
 #include "yb/master/ts_descriptor.h"
 #include "yb/master/xcluster/xcluster_manager.h"
@@ -195,7 +196,6 @@
 #include "yb/util/net/net_util.h"
 #include "yb/util/oid_generator.h"
 #include "yb/util/random_util.h"
-#include "yb/util/rw_mutex.h"
 #include "yb/util/scope_exit.h"
 #include "yb/util/size_literals.h"
 #include "yb/util/status_format.h"
diff --git a/src/yb/master/catalog_manager.h b/src/yb/master/catalog_manager.h
index 38255630b6..04679cf603 100644
--- a/src/yb/master/catalog_manager.h
+++ b/src/yb/master/catalog_manager.h
@@ -46,61 +46,54 @@
 
 #include "yb/cdc/cdc_service.pb.h"
 #include "yb/cdc/xcluster_types.h"
+
+#include "yb/client/client_fwd.h"
+
 #include "yb/common/constants.h"
-#include "yb/common/entity_ids.h"
-#include "yb/master/catalog_entity_info.h"
-#include "yb/master/catalog_entity_info.pb.h"
-#include "yb/master/leader_epoch.h"
-#include "yb/master/restore_sys_catalog_state.h"
-#include "yb/qlexpr/index.h"
-#include "yb/dockv/partition.h"
 #include "yb/common/transaction.h"
-#include "yb/client/client_fwd.h"
+
+#include "yb/dockv/partition.h"
+
+#include "yb/fs/fs_manager.h"
 #include "yb/gutil/macros.h"
 #include "yb/gutil/ref_counted.h"
-#include "yb/gutil/strings/substitute.h"
 #include "yb/gutil/thread_annotations.h"
 
+#include "yb/master/catalog_entity_info.h"
+#include "yb/master/catalog_entity_info.pb.h"
 #include "yb/master/catalog_manager_if.h"
 #include "yb/master/catalog_manager_util.h"
+#include "yb/master/leader_epoch.h"
 #include "yb/master/master_admin.pb.h"
 #include "yb/master/master_backup.pb.h"
 #include "yb/master/master_dcl.fwd.h"
-#include "yb/master/master_defaults.h"
 #include "yb/master/master_encryption.fwd.h"
 #include "yb/master/master_heartbeat.pb.h"
 #include "yb/master/master_types.h"
 #include "yb/master/object_lock_info_manager.h"
 #include "yb/master/scoped_leader_shared_lock.h"
 #include "yb/master/snapshot_coordinator_context.h"
-#include "yb/master/sys_catalog.h"
 #include "yb/master/sys_catalog_initialization.h"
+#include "yb/master/sys_catalog.h"
 #include "yb/master/system_tablet.h"
 #include "yb/master/table_index.h"
-#include "yb/master/tablet_creation_limits.h"
 #include "yb/master/ts_descriptor.h"
 #include "yb/master/ts_manager.h"
 #include "yb/master/ysql_tablespace_manager.h"
 
-#include "yb/rpc/rpc.h"
 #include "yb/rpc/scheduler.h"
-#include "yb/server/monitored_task.h"
-#include "yb/tserver/tablet_peer_lookup.h"
 
+#include "yb/server/monitored_task.h"
 #include "yb/util/async_task_util.h"
 #include "yb/util/debug/lock_debug.h"
 #include "yb/util/locks.h"
 #include "yb/util/monotime.h"
 #include "yb/util/net/net_util.h"
 #include "yb/util/pb_util.h"
-#include "yb/util/promise.h"
-#include "yb/util/random.h"
 #include "yb/util/rw_mutex.h"
 #include "yb/util/status_callback.h"
 #include "yb/util/status_fwd.h"
-#include "yb/util/test_macros.h"
 #include "yb/util/version_tracker.h"
-#include "yb/yql/pggate/ybc_pg_typedefs.h"
 
 namespace yb {
 
@@ -147,6 +140,7 @@ namespace master {
 struct DeferredAssignmentActions;
 struct SysCatalogLoadingState;
 struct KeyRange;
+class RestoreSysCatalogState;
 class YsqlInitDBAndMajorUpgradeHandler;
 class YsqlManagerIf;
 class YsqlManager;
@@ -157,8 +151,6 @@ typedef std::unordered_map<TabletId, TabletServerId> TabletToTabletServerMap;
 
 typedef std::unordered_map<TableId, std::vector<TabletInfoPtr>> TableToTabletInfos;
 
-constexpr int32_t kInvalidClusterConfigVersion = 0;
-
 YB_DEFINE_ENUM(
     CDCSDKStreamCreationState,
     // Stream has been initialized but no in-memory data structures or sys-catalog have been
diff --git a/src/yb/master/master-path-handlers.cc b/src/yb/master/master-path-handlers.cc
index 05a58127b3..700f8fa2d6 100644
--- a/src/yb/master/master-path-handlers.cc
+++ b/src/yb/master/master-path-handlers.cc
@@ -58,7 +58,6 @@
 #include "yb/gutil/map-util.h"
 #include "yb/gutil/stringprintf.h"
 #include "yb/gutil/strings/human_readable.h"
-#include "yb/gutil/strings/join.h"
 #include "yb/gutil/strings/numbers.h"
 #include "yb/gutil/strings/substitute.h"
 
@@ -75,6 +74,7 @@
 #include "yb/master/master_util.h"
 #include "yb/master/scoped_leader_shared_lock.h"
 #include "yb/master/sys_catalog.h"
+#include "yb/master/tablet_creation_limits.h"
 #include "yb/master/ts_descriptor.h"
 #include "yb/master/ts_manager.h"
 
@@ -91,7 +91,6 @@
 #include "yb/util/flags.h"
 #include "yb/util/jsonwriter.h"
 #include "yb/util/logging.h"
-#include "yb/util/status_log.h"
 #include "yb/util/string_case.h"
 #include "yb/util/timestamp.h"
 #include "yb/util/url-coding.h"
diff --git a/src/yb/master/master_cluster_handler.cc b/src/yb/master/master_cluster_handler.cc
index f348407fcb..6b84a71050 100644
--- a/src/yb/master/master_cluster_handler.cc
+++ b/src/yb/master/master_cluster_handler.cc
@@ -13,9 +13,10 @@
 
 #include "yb/master/master_cluster_handler.h"
 
-#include "yb/master/catalog_manager-internal.h"
+#include "yb/master/catalog_manager.h"
 #include "yb/master/catalog_manager_util.h"
 #include "yb/master/master_cluster.pb.h"
+#include "yb/master/master_defaults.h"
 #include "yb/master/master_util.h"
 
 DEFINE_RUNTIME_int32(blacklist_progress_initial_delay_secs, yb::master::kDelayAfterFailoverSecs,
diff --git a/src/yb/master/master_cluster_handler.h b/src/yb/master/master_cluster_handler.h
index 35633f5e04..9ffaac63b7 100644
--- a/src/yb/master/master_cluster_handler.h
+++ b/src/yb/master/master_cluster_handler.h
@@ -12,7 +12,11 @@
 //
 #pragma once
 
-#include "yb/master/catalog_manager.h"
+#include "yb/master/leader_epoch.h"
+#include "yb/master/master_cluster.pb.h"
+#include "yb/master/master_fwd.h"
+
+#include "yb/rpc/rpc_fwd.h"
 
 #include "yb/util/status.h"
 
diff --git a/src/yb/master/master_defaults.h b/src/yb/master/master_defaults.h
index 02acaa9ced..245d61ad13 100644
--- a/src/yb/master/master_defaults.h
+++ b/src/yb/master/master_defaults.h
@@ -94,5 +94,7 @@ static constexpr int kNumSystemTablesWithTxn = kNumSystemTables + 1;
 constexpr uint16_t kMasterDefaultPort = 7100;
 constexpr uint16_t kMasterDefaultWebPort = 7000;
 
+static constexpr int32_t kInvalidClusterConfigVersion = 0;
+
 } // namespace master
 } // namespace yb
diff --git a/src/yb/master/permissions_manager.cc b/src/yb/master/permissions_manager.cc
index 2bb217d7b8..aca2965abd 100644
--- a/src/yb/master/permissions_manager.cc
+++ b/src/yb/master/permissions_manager.cc
@@ -13,21 +13,21 @@
 
 #include "yb/master/permissions_manager.h"
 
-#include <mutex>
-
 #include "yb/gutil/casts.h"
 #include "yb/gutil/strings/substitute.h"
 
 #include "yb/master/catalog_manager-internal.h"
+#include "yb/master/catalog_manager.h"
 #include "yb/master/master_dcl.pb.h"
 #include "yb/master/master_ddl.pb.h"
+#include "yb/master/master_defaults.h"
 #include "yb/master/master_util.h"
-#include "yb/master/scoped_leader_shared_lock-internal.h"
 #include "yb/master/sys_catalog.h"
 #include "yb/master/sys_catalog_constants.h"
 
+#include "yb/rpc/rpc_context.h"
+
 #include "yb/util/crypt.h"
-#include "yb/util/shared_lock.h"
 #include "yb/util/status_format.h"
 #include "yb/util/status_log.h"
 #include "yb/util/trace.h"
@@ -81,10 +81,10 @@ class ScopedMutation {
 
 }  // anonymous namespace
 
-
 PermissionsManager::PermissionsManager(CatalogManager* catalog_manager)
     : security_config_(nullptr),
-      catalog_manager_(catalog_manager) {
+      catalog_manager_(catalog_manager),
+      cm_mutex_(catalog_manager_->mutex_) {
   CHECK_NOTNULL(catalog_manager);
 }
 
diff --git a/src/yb/master/permissions_manager.h b/src/yb/master/permissions_manager.h
index 5073a54b12..c169005f02 100644
--- a/src/yb/master/permissions_manager.h
+++ b/src/yb/master/permissions_manager.h
@@ -15,29 +15,17 @@
 
 #include <stdint.h>
 
-#include <set>
-#include <type_traits>
-#include <utility>
+#include "yb/master/catalog_entity_info.h"
+#include "yb/master/master_dcl.fwd.h"
+#include "yb/master/master_fwd.h"
 
-#include "yb/util/flags.h"
-#include "yb/util/logging.h"
-
-#include "yb/common/entity_ids.h"
 #include "yb/common/roles_permissions.h"
 
-#include "yb/gutil/callback.h"
-#include "yb/gutil/integral_types.h"
-
-#include "yb/master/catalog_manager.h"
-
-#include "yb/rpc/rpc.h"
+#include "yb/rpc/rpc_fwd.h"
 
 #include "yb/util/debug/lock_debug.h"
-#include "yb/util/math_util.h"
-#include "yb/util/shared_lock.h"
 #include "yb/util/status_callback.h"
 #include "yb/util/status_fwd.h"
-#include "yb/util/unique_lock.h"
 
 namespace yb {
 namespace master {
@@ -186,7 +174,7 @@ class PermissionsManager final {
   // from a client.
   std::shared_ptr<GetPermissionsResponsePB> permissions_cache_ GUARDED_BY(mutex_);
 
-  mutable MutexType mutex_ ACQUIRED_AFTER(catalog_manager_->mutex_);
+  mutable MutexType mutex_ ACQUIRED_AFTER(cm_mutex_);
   using SharedLock = NonRecursiveSharedLock<MutexType>;
   using LockGuard = std::lock_guard<MutexType>;
 
@@ -194,6 +182,7 @@ class PermissionsManager final {
   scoped_refptr<SysConfigInfo> security_config_ GUARDED_BY(mutex_);
 
   CatalogManager* catalog_manager_;
+  MutexType& cm_mutex_;
 
   DISALLOW_COPY_AND_ASSIGN(PermissionsManager);
 };
diff --git a/src/yb/master/restore_sys_catalog_state.cc b/src/yb/master/restore_sys_catalog_state.cc
index 456230a9ea..c4cb35e74a 100644
--- a/src/yb/master/restore_sys_catalog_state.cc
+++ b/src/yb/master/restore_sys_catalog_state.cc
@@ -15,32 +15,27 @@
 
 #include "yb/common/entity_ids.h"
 #include "yb/common/hybrid_time.h"
-#include "yb/qlexpr/index.h"
 #include "yb/common/pg_types.h"
 
-#include "yb/common/pgsql_protocol.pb.h"
-#include "yb/qlexpr/ql_expr.h"
-#include "yb/docdb/consensus_frontier.h"
+#include "yb/qlexpr/index.h"
+
 #include "yb/docdb/cql_operation.h"
-#include "yb/docdb/docdb_rocksdb_util.h"
 #include "yb/docdb/doc_read_context.h"
 #include "yb/docdb/doc_rowwise_iterator.h"
 #include "yb/docdb/doc_write_batch.h"
-#include "yb/docdb/docdb.h"
-#include "yb/docdb/pgsql_operation.h"
-#include "yb/docdb/rocksdb_writer.h"
 
 #include "yb/master/catalog_loaders.h"
 #include "yb/master/master_backup.pb.h"
+#include "yb/master/master_defaults.h"
 #include "yb/master/master_snapshot_coordinator.h"
 #include "yb/master/master_util.h"
-#include "yb/master/sys_catalog.h"
 #include "yb/master/sys_catalog_writer.h"
+#include "yb/master/sys_catalog.h"
 
-#include "yb/rocksdb/write_batch.h"
 #include "yb/tablet/restore_util.h"
-#include "yb/tablet/tablet.h"
 #include "yb/tablet/tablet_metadata.h"
+#include "yb/tablet/tablet.h"
+
 #include "yb/util/format.h"
 #include "yb/util/logging.h"
 #include "yb/util/pb_util.h"
diff --git a/src/yb/master/sys_catalog-test.cc b/src/yb/master/sys_catalog-test.cc
index 3c30159471..f47fed4903 100644
--- a/src/yb/master/sys_catalog-test.cc
+++ b/src/yb/master/sys_catalog-test.cc
@@ -46,6 +46,7 @@
 #include "yb/master/sys_catalog-test_base.h"
 #include "yb/master/sys_catalog.h"
 
+#include "yb/tablet/tablet.h"
 #include "yb/tablet/tablet_peer.h"
 
 #include "yb/util/backoff_waiter.h"
diff --git a/src/yb/master/xcluster/xcluster_safe_time_service.cc b/src/yb/master/xcluster/xcluster_safe_time_service.cc
index 9e9537ba9d..75d4df8a54 100644
--- a/src/yb/master/xcluster/xcluster_safe_time_service.cc
+++ b/src/yb/master/xcluster/xcluster_safe_time_service.cc
@@ -10,13 +10,17 @@
 // or implied.  See the License for the specific language governing permissions and limitations
 // under the License.
 
+#include "yb/master/xcluster/xcluster_safe_time_service.h"
+
 #include <chrono>
 
+
 #include "yb/client/client.h"
 #include "yb/client/schema.h"
 #include "yb/client/session.h"
 #include "yb/client/table_handle.h"
 #include "yb/client/yb_op.h"
+#include "yb/client/yb_table_name.h"
 
 #include "yb/common/schema_pbutil.h"
 #include "yb/common/xcluster_util.h"
@@ -25,14 +29,12 @@
 #include "yb/master/master_ddl.pb.h"
 #include "yb/master/master.h"
 #include "yb/master/xcluster/xcluster_manager_if.h"
-#include "yb/master/xcluster/xcluster_safe_time_service.h"
 
 #include "yb/rpc/messenger.h"
 
 #include "yb/tablet/tablet_peer.h"
 
 #include "yb/util/atomic.h"
-#include "yb/util/callsite_profiling.h"
 #include "yb/util/monotime.h"
 #include "yb/util/status.h"
 #include "yb/util/thread.h"
diff --git a/src/yb/master/xcluster/xcluster_safe_time_service.h b/src/yb/master/xcluster/xcluster_safe_time_service.h
index d48c0ac544..585448e87f 100644
--- a/src/yb/master/xcluster/xcluster_safe_time_service.h
+++ b/src/yb/master/xcluster/xcluster_safe_time_service.h
@@ -36,22 +36,22 @@
 #include <boost/asio/strand.hpp>
 
 #include "yb/client/client_fwd.h"
-#include "yb/client/yb_table_name.h"
 
 #include "yb/common/hybrid_time.h"
 #include "yb/common/xcluster_util.h"
 
 #include "yb/gutil/thread_annotations.h"
 
-#include "yb/master/catalog_manager.h"
+#include "yb/master/master_defaults.h"
 #include "yb/master/xcluster/xcluster_consumer_metrics.h"
 #include "yb/master/xcluster/xcluster_manager_if.h"
 
 #include "yb/rpc/poller.h"
 
-#include "yb/util/threadpool.h"
-
 namespace yb {
+
+class MetricRegistry;
+
 namespace master {
 
 // Periodically compute the xCluster safe time and store it in sys catalog.
diff --git a/src/yb/master/yql_auth_resource_role_permissions_index.cc b/src/yb/master/yql_auth_resource_role_permissions_index.cc
index 303f3fe68f..4b41a5566a 100644
--- a/src/yb/master/yql_auth_resource_role_permissions_index.cc
+++ b/src/yb/master/yql_auth_resource_role_permissions_index.cc
@@ -16,6 +16,7 @@
 #include "yb/common/ql_type.h"
 #include "yb/common/schema.h"
 
+#include "yb/master/catalog_manager_if.h"
 #include "yb/master/permissions_manager.h"
 
 #include "yb/util/status_log.h"
diff --git a/src/yb/master/yql_auth_role_permissions_vtable.cc b/src/yb/master/yql_auth_role_permissions_vtable.cc
index 4beef5cb94..a21bba829c 100644
--- a/src/yb/master/yql_auth_role_permissions_vtable.cc
+++ b/src/yb/master/yql_auth_role_permissions_vtable.cc
@@ -15,13 +15,13 @@
 
 #include <boost/asio/ip/address.hpp>
 
-#include "yb/common/common.pb.h"
 #include "yb/common/ql_type.h"
 #include "yb/common/roles_permissions.h"
 #include "yb/common/schema.h"
 
 #include "yb/gutil/strings/substitute.h"
 
+#include "yb/master/catalog_manager_if.h"
 #include "yb/master/permissions_manager.h"
 
 #include "yb/util/status_log.h"
diff --git a/src/yb/master/yql_auth_roles_vtable.cc b/src/yb/master/yql_auth_roles_vtable.cc
index a9d5d664d9..1e1f7458e0 100644
--- a/src/yb/master/yql_auth_roles_vtable.cc
+++ b/src/yb/master/yql_auth_roles_vtable.cc
@@ -16,6 +16,7 @@
 #include "yb/common/ql_type.h"
 #include "yb/common/schema.h"
 
+#include "yb/master/catalog_manager_if.h"
 #include "yb/master/permissions_manager.h"
 
 #include "yb/util/status_log.h"
diff --git a/src/yb/master/ysql/ysql_manager.cc b/src/yb/master/ysql/ysql_manager.cc
index 61f95ae5a8..0a113017dc 100644
--- a/src/yb/master/ysql/ysql_manager.cc
+++ b/src/yb/master/ysql/ysql_manager.cc
@@ -15,6 +15,7 @@
 
 #include "yb/client/schema.h"
 #include "yb/client/yb_table_name.h"
+#include "yb/master/master_defaults.h"
 #include "yb/tserver/ysql_advisory_lock_table.h"
 
 #include "yb/master/catalog_manager.h"
diff --git a/src/yb/master/ysql_ddl_verification_task.cc b/src/yb/master/ysql_ddl_verification_task.cc
index 76f77fb844..76426993f1 100644
--- a/src/yb/master/ysql_ddl_verification_task.cc
+++ b/src/yb/master/ysql_ddl_verification_task.cc
@@ -22,22 +22,16 @@
 #include "yb/common/schema_pbutil.h"
 #include "yb/common/wire_protocol.h"
 
-#include "yb/gutil/casts.h"
-
 #include "yb/master/catalog_manager.h"
-#include "yb/master/master_util.h"
+#include "yb/master/master_defaults.h"
 #include "yb/master/sys_catalog.h"
 
 #include "yb/tablet/tablet.h"
-#include "yb/tablet/tablet_metadata.h"
-#include "yb/tablet/tablet_peer.h"
-
 #include "yb/tserver/tserver_service.pb.h"
 
 #include "yb/util/flags.h"
 #include "yb/util/logging.h"
 #include "yb/util/monotime.h"
-#include "yb/util/net/net_fwd.h"
 #include "yb/util/status_log.h"
 
 #include "yb/util/flags/flag_tags.h"
