{"url":"https://api.github.com/repos/yugabyte/yugabyte-db/issues/24608","repository_url":"https://api.github.com/repos/yugabyte/yugabyte-db","labels_url":"https://api.github.com/repos/yugabyte/yugabyte-db/issues/24608/labels{/name}","comments_url":"https://api.github.com/repos/yugabyte/yugabyte-db/issues/24608/comments","events_url":"https://api.github.com/repos/yugabyte/yugabyte-db/issues/24608/events","html_url":"https://github.com/yugabyte/yugabyte-db/issues/24608","id":2610923267,"node_id":"I_kwDOBlCVUc6bn4cD","number":24608,"title":"[xCluster][dbScope] Invalid table definition: Colocated parent tables can only be added during the initial xCluster replication setup","user":{"login":"agsh-yb","id":121818428,"node_id":"U_kgDOB0LNPA","avatar_url":"https://avatars.githubusercontent.com/u/121818428?v=4","gravatar_id":"","url":"https://api.github.com/users/agsh-yb","html_url":"https://github.com/agsh-yb","followers_url":"https://api.github.com/users/agsh-yb/followers","following_url":"https://api.github.com/users/agsh-yb/following{/other_user}","gists_url":"https://api.github.com/users/agsh-yb/gists{/gist_id}","starred_url":"https://api.github.com/users/agsh-yb/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/agsh-yb/subscriptions","organizations_url":"https://api.github.com/users/agsh-yb/orgs","repos_url":"https://api.github.com/users/agsh-yb/repos","events_url":"https://api.github.com/users/agsh-yb/events{/privacy}","received_events_url":"https://api.github.com/users/agsh-yb/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":711841622,"node_id":"MDU6TGFiZWw3MTE4NDE2MjI=","url":"https://api.github.com/repos/yugabyte/yugabyte-db/labels/kind/bug","name":"kind/bug","color":"c2e0c6","default":false,"description":"This issue is a bug"},{"id":1290759928,"node_id":"MDU6TGFiZWwxMjkwNzU5OTI4","url":"https://api.github.com/repos/yugabyte/yugabyte-db/labels/area/docdb","name":"area/docdb","color":"0c4fcc","default":false,"description":"YugabyteDB core features"},{"id":1353907004,"node_id":"MDU6TGFiZWwxMzUzOTA3MDA0","url":"https://api.github.com/repos/yugabyte/yugabyte-db/labels/priority/high","name":"priority/high","color":"ffdc5e","default":false,"description":"High Priority"},{"id":3248174344,"node_id":"MDU6TGFiZWwzMjQ4MTc0MzQ0","url":"https://api.github.com/repos/yugabyte/yugabyte-db/labels/QA","name":"QA","color":"A01624","default":false,"description":"QA filed bugs"},{"id":3788247489,"node_id":"LA_kwDOBlCVUc7hzBHB","url":"https://api.github.com/repos/yugabyte/yugabyte-db/labels/xCluster","name":"xCluster","color":"F2BE93","default":false,"description":"Label for xCluster related issues/improvements"},{"id":4528410201,"node_id":"LA_kwDOBlCVUc8AAAABDeoOWQ","url":"https://api.github.com/repos/yugabyte/yugabyte-db/labels/qa_automation","name":"qa_automation","color":"D50043","default":false,"description":"Bugs identified via itest-system, LST, Stress automation or causing automation failures"},{"id":6312492630,"node_id":"LA_kwDOBlCVUc8AAAABeED-Vg","url":"https://api.github.com/repos/yugabyte/yugabyte-db/labels/qa_itest-system","name":"qa_itest-system","color":"13CBE3","default":false,"description":"Bugs identified in itest-system automation"}],"state":"closed","locked":false,"assignee":{"login":"hari90","id":12418230,"node_id":"MDQ6VXNlcjEyNDE4MjMw","avatar_url":"https://avatars.githubusercontent.com/u/12418230?v=4","gravatar_id":"","url":"https://api.github.com/users/hari90","html_url":"https://github.com/hari90","followers_url":"https://api.github.com/users/hari90/followers","following_url":"https://api.github.com/users/hari90/following{/other_user}","gists_url":"https://api.github.com/users/hari90/gists{/gist_id}","starred_url":"https://api.github.com/users/hari90/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hari90/subscriptions","organizations_url":"https://api.github.com/users/hari90/orgs","repos_url":"https://api.github.com/users/hari90/repos","events_url":"https://api.github.com/users/hari90/events{/privacy}","received_events_url":"https://api.github.com/users/hari90/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"hari90","id":12418230,"node_id":"MDQ6VXNlcjEyNDE4MjMw","avatar_url":"https://avatars.githubusercontent.com/u/12418230?v=4","gravatar_id":"","url":"https://api.github.com/users/hari90","html_url":"https://github.com/hari90","followers_url":"https://api.github.com/users/hari90/followers","following_url":"https://api.github.com/users/hari90/following{/other_user}","gists_url":"https://api.github.com/users/hari90/gists{/gist_id}","starred_url":"https://api.github.com/users/hari90/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hari90/subscriptions","organizations_url":"https://api.github.com/users/hari90/orgs","repos_url":"https://api.github.com/users/hari90/repos","events_url":"https://api.github.com/users/hari90/events{/privacy}","received_events_url":"https://api.github.com/users/hari90/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":null,"comments":0,"created_at":"2024-10-24T09:00:38Z","updated_at":"2024-11-08T19:53:30Z","closed_at":"2024-11-08T19:53:30Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"Jira Link: [DB-13647](https://yugabyte.atlassian.net/browse/DB-13647)\r\n### Description\r\n\r\nVersion:  `2.25.0.0-b184` while creating table at colocated database on target\r\nfailure is deterministic\r\n\r\n#### ERROR:\r\n```\r\n\r\npsycopg2.errors.InternalError_: Invalid table definition: Colocated parent tables can only be added during the initial xCluster replication setup: 0000400300003000800000000000401e.colocation.parent.tablename [id=0000400300003000800000000000401e.colocation.parent.uuid]\r\n```\r\n\r\n\r\n#### steps to repro:\r\n\r\n\r\n```\r\ntestdbdrscenarios-aws-rf3: Start\r\n\t(     0.700s) User Login : Success\r\n\t(     0.128s) Refresh YB Version : Success\r\n\t(    95.889s) Setup Provider : Success\r\n\t(     0.072s) Enable RBAC Flag : Success\r\n\t(     0.001s) Copy YBA CLI Package : Success\r\n\t(     0.075s) Updating Health Check Interval to 60000 sec : Success\r\n\t(   556.811s) Create universe sagr-isd15318-ce85d33050-20241105-203458-1 : Success\r\n\t(    17.098s) Updating Health Check Interval to 60000 sec : Success\r\n\t(   556.737s) Create universe sagr-isd15318-ce85d33050-20241105-203458-2 : Success\r\n\t(    38.746s) Create database:db_dr_non_col, db_dr_col : Success\r\n\t(     2.164s) Create Secondary Index. : Success\r\n\t(     0.170s) Create Unique Index. : Success\r\n\t(     0.195s) Create Partial Index. : Success\r\n\t(     0.168s) Create Secondary Index. : Success\r\n\t(     0.181s) Create Unique Index. : Success\r\n\t(     0.193s) Create Partial Index. : Success\r\n\t(     2.329s) Create Secondary Index. : Success\r\n\t(     1.900s) Create Unique Index. : Success\r\n\t(     2.210s) Create Partial Index. : Success\r\n\t(     4.511s) Create tables/indexes/partition : Success\r\n\t(    32.270s) Create database:db_dr_non_col, db_dr_col : Success\r\n\t(     2.192s) Create Secondary Index. : Success\r\n\t(     0.149s) Create Unique Index. : Success\r\n\t(     0.180s) Create Partial Index. : Success\r\n\t(     0.141s) Create Secondary Index. : Success\r\n\t(     0.182s) Create Unique Index. : Success\r\n\t(     0.193s) Create Partial Index. : Success\r\n\t(     2.291s) Create Secondary Index. : Success\r\n\t(     2.165s) Create Unique Index. : Success\r\n\t(     2.806s) Create Partial Index. : Success\r\n\t(     4.889s) Create tables/indexes/partition : Success\r\n\t(     6.841s) Create tables/indexes/partition : Success\r\n\t(   232.414s) Perform DML operations and validate Replication : Success\r\n\t(   193.020s) Insert data into employees_col : Success\r\n\t(     0.017s) Verify inserted data into the universe : Success\r\n\t(     0.080s) Delete data from the employees_col : Success\r\n\t(     0.016s) Verify deleted data in the universe : Success\r\n\t(     0.051s) Update data in the employees_col : Success\r\n\t(     1.672s) Insert data into employees_hash_non_col : Success\r\n\t(     0.026s) Verify inserted data into the universe : Success\r\n\t(     0.086s) Delete data from the employees_hash_non_col : Success\r\n\t(     0.026s) Verify deleted data in the universe : Success\r\n\t(     0.053s) Update data in the employees_hash_non_col : Success\r\n\t(     1.653s) Insert data into employees_range_non_col : Success\r\n\t(     0.025s) Verify inserted data into the universe : Success\r\n\t(     0.060s) Delete data from the employees_range_non_col : Success\r\n\t(     0.023s) Verify deleted data in the universe : Success\r\n\t(     0.049s) Update data in the employees_range_non_col : Success\r\n\t(   195.682s) Insert data into employees_col : Success\r\n\t(     0.018s) Verify inserted data into the universe : Success\r\n\t(     0.065s) Delete data from the employees_col : Success\r\n\t(     0.017s) Verify deleted data in the universe : Success\r\n\t(     0.050s) Update data in the employees_col : Success\r\n\t(     1.793s) Insert data into employees_hash_non_col : Success\r\n\t(     0.028s) Verify inserted data into the universe : Success\r\n\t(     0.068s) Delete data from the employees_hash_non_col : Success\r\n\t(     0.027s) Verify deleted data in the universe : Success\r\n\t(     0.055s) Update data in the employees_hash_non_col : Success\r\n\t(     1.775s) Insert data into employees_range_non_col : Success\r\n\t(     0.026s) Verify inserted data into the universe : Success\r\n\t(     0.060s) Delete data from the employees_range_non_col : Success\r\n\t(     0.026s) Verify deleted data in the universe : Success\r\n\t(     0.053s) Update data in the employees_range_non_col : Success\r\n\t(    41.741s) Validate replication after DMLs' : Success\r\n\t(     6.050s) Insert data into employees_col : Success\r\n\t(     0.018s) Verify inserted data into the universe : Success\r\n\t(     0.065s) Delete data from the employees_col : Success\r\n\t(     0.018s) Verify deleted data in the universe : Success\r\n\t(     0.052s) Update data in the employees_col : Success\r\n\t(     1.806s) Insert data into employees_hash_non_col : Success\r\n\t(     0.028s) Verify inserted data into the universe : Success\r\n\t(     0.073s) Delete data from the employees_hash_non_col : Success\r\n\t(     0.028s) Verify deleted data in the universe : Success\r\n\t(     0.056s) Update data in the employees_hash_non_col : Success\r\n\t(     1.798s) Insert data into employees_range_non_col : Success\r\n\t(     0.025s) Verify inserted data into the universe : Success\r\n\t(     0.060s) Delete data from the employees_range_non_col : Success\r\n\t(     0.025s) Verify deleted data in the universe : Success\r\n\t(     0.053s) Update data in the employees_range_non_col : Success\r\n\t(   192.513s) Validate replication after DMLs' and DDLs' : Success\r\n\t(     0.739s) Drop DR replication : Success\r\n\t(     1.274s) Create tables: new_table using CTAS : Success\r\n\t(     4.578s) Drop database at target: db_dr_non_col, db_dr_col : Success\r\n\t(     0.718s) Create xCluster checkpoint : Success\r\n\t(   122.121s) Create Backups : Success\r\n\t(   150.901s) Restore Backup: BACKUP_001 : Success\r\n\t(    91.045s) Create Backups : Success\r\n\t(    90.594s) Restore Backup: BACKUP_002 : Success\r\n\t(   265.534s) Setup DR replication : Success\r\n\t(   317.347s) Load data to new_table and validate replication : Success\r\n\t(    12.554s) Create databases: db_dr_2, db_dr_col_2 : Success\r\n\t(    11.982s) Create databases: db_dr_2, db_dr_col_2 : Success\r\n\t(     2.229s) Create Secondary Index. : Success\r\n\t(     0.181s) Create Unique Index. : Success\r\n\t(     0.166s) Create Partial Index. : Success\r\n\t(     0.173s) Create Secondary Index. : Success\r\n\t(     0.215s) Create Unique Index. : Success\r\n\t(     0.199s) Create Partial Index. : Success\r\n\t(     2.209s) Create Secondary Index. : Success\r\n\t(     2.434s) Create Unique Index. : Success\r\n\t(     2.124s) Create Partial Index. : Success\r\n\t(     4.782s) Create tables/indexes/partitions : Success\r\n\t(     1.922s) Create tables/indexes/partitions : >>> Integration Test Failed <<< \r\nInvalid table definition: Colocated parent tables can only be added during the initial xCluster replication setup: 0000400300003000800000000000401e.colocation.parent.tablename [id=0000400300003000800000000000401e.colocation.parent.uuid]\r\n```\r\n\r\nquery to create table\r\n``` \r\nCREATE TABLE employees_col(id text, uuid_col uuid DEFAULT uuid_generate_v4 (), name text, c complex, info json, contact JSONB, arr smallint[], cash money, i inet, m macaddr, i2 serial, i3 bigserial, val smallint, details e_details, age int, collated_data text collate \"POSIX\", date DATE, n NUMERIC (3, 2), r real, c1 CHAR(1), created_at timestamptz, uuid0 uuid DEFAULT uuid_nil(), uuid1 uuid DEFAULT uuid_generate_v1(), p1 POINT, t1 TIME, ts1 TIMESTAMP, i4 INTERVAL, p2 path, p3 polygon, b box, c2 circle, l line, l1 lseg, a2 text[][], zip postal_code, PRIMARY KEY(id, name, uuid_col, age)) WITH (colocation = True,COLOCATION_ID=20000)\r\n```\r\n\r\nattached logs in jira\r\n\r\n### Issue Type\r\n\r\nkind/bug\r\n\r\n### Warning: Please confirm that this issue does not contain any sensitive information\r\n\r\n- [X] I confirm this issue does not contain any sensitive information.\r\n\r\n[DB-13647]: https://yugabyte.atlassian.net/browse/DB-13647?atlOrigin=eyJpIjoiNWRkNTljNzYxNjVmNDY3MDlhMDU5Y2ZhYzA5YTRkZjUiLCJwIjoiZ2l0aHViLWNvbS1KU1cifQ","closed_by":{"login":"hari90","id":12418230,"node_id":"MDQ6VXNlcjEyNDE4MjMw","avatar_url":"https://avatars.githubusercontent.com/u/12418230?v=4","gravatar_id":"","url":"https://api.github.com/users/hari90","html_url":"https://github.com/hari90","followers_url":"https://api.github.com/users/hari90/followers","following_url":"https://api.github.com/users/hari90/following{/other_user}","gists_url":"https://api.github.com/users/hari90/gists{/gist_id}","starred_url":"https://api.github.com/users/hari90/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hari90/subscriptions","organizations_url":"https://api.github.com/users/hari90/orgs","repos_url":"https://api.github.com/users/hari90/repos","events_url":"https://api.github.com/users/hari90/events{/privacy}","received_events_url":"https://api.github.com/users/hari90/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/yugabyte/yugabyte-db/issues/24608/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/yugabyte/yugabyte-db/issues/24608/timeline","performed_via_github_app":null,"state_reason":"completed"}