{"url":"https://api.github.com/repos/yugabyte/yugabyte-db/issues/19954","repository_url":"https://api.github.com/repos/yugabyte/yugabyte-db","labels_url":"https://api.github.com/repos/yugabyte/yugabyte-db/issues/19954/labels{/name}","comments_url":"https://api.github.com/repos/yugabyte/yugabyte-db/issues/19954/comments","events_url":"https://api.github.com/repos/yugabyte/yugabyte-db/issues/19954/events","html_url":"https://github.com/yugabyte/yugabyte-db/issues/19954","id":1994986225,"node_id":"I_kwDOBlCVUc526RLx","number":19954,"title":"[DocDB] Flaky test XClusterTabletSplitITest.SplittingOnProducerAndConsumer","user":{"login":"arybochkin","id":79331145,"node_id":"MDQ6VXNlcjc5MzMxMTQ1","avatar_url":"https://avatars.githubusercontent.com/u/79331145?v=4","gravatar_id":"","url":"https://api.github.com/users/arybochkin","html_url":"https://github.com/arybochkin","followers_url":"https://api.github.com/users/arybochkin/followers","following_url":"https://api.github.com/users/arybochkin/following{/other_user}","gists_url":"https://api.github.com/users/arybochkin/gists{/gist_id}","starred_url":"https://api.github.com/users/arybochkin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/arybochkin/subscriptions","organizations_url":"https://api.github.com/users/arybochkin/orgs","repos_url":"https://api.github.com/users/arybochkin/repos","events_url":"https://api.github.com/users/arybochkin/events{/privacy}","received_events_url":"https://api.github.com/users/arybochkin/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":711841624,"node_id":"MDU6TGFiZWw3MTE4NDE2MjQ=","url":"https://api.github.com/repos/yugabyte/yugabyte-db/labels/kind/enhancement","name":"kind/enhancement","color":"c2e0c6","default":false,"description":"This is an enhancement of an existing feature"},{"id":1281039316,"node_id":"MDU6TGFiZWwxMjgxMDM5MzE2","url":"https://api.github.com/repos/yugabyte/yugabyte-db/labels/kind/failing-test","name":"kind/failing-test","color":"c2e0c6","default":false,"description":"Tests and testing infra"},{"id":1290759928,"node_id":"MDU6TGFiZWwxMjkwNzU5OTI4","url":"https://api.github.com/repos/yugabyte/yugabyte-db/labels/area/docdb","name":"area/docdb","color":"0c4fcc","default":false,"description":"YugabyteDB core features"},{"id":1419821900,"node_id":"MDU6TGFiZWwxNDE5ODIxOTAw","url":"https://api.github.com/repos/yugabyte/yugabyte-db/labels/priority/medium","name":"priority/medium","color":"ffdc5e","default":false,"description":"Medium priority issue"}],"state":"closed","locked":false,"assignee":{"login":"hulien22","id":32774836,"node_id":"MDQ6VXNlcjMyNzc0ODM2","avatar_url":"https://avatars.githubusercontent.com/u/32774836?v=4","gravatar_id":"","url":"https://api.github.com/users/hulien22","html_url":"https://github.com/hulien22","followers_url":"https://api.github.com/users/hulien22/followers","following_url":"https://api.github.com/users/hulien22/following{/other_user}","gists_url":"https://api.github.com/users/hulien22/gists{/gist_id}","starred_url":"https://api.github.com/users/hulien22/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hulien22/subscriptions","organizations_url":"https://api.github.com/users/hulien22/orgs","repos_url":"https://api.github.com/users/hulien22/repos","events_url":"https://api.github.com/users/hulien22/events{/privacy}","received_events_url":"https://api.github.com/users/hulien22/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"hulien22","id":32774836,"node_id":"MDQ6VXNlcjMyNzc0ODM2","avatar_url":"https://avatars.githubusercontent.com/u/32774836?v=4","gravatar_id":"","url":"https://api.github.com/users/hulien22","html_url":"https://github.com/hulien22","followers_url":"https://api.github.com/users/hulien22/followers","following_url":"https://api.github.com/users/hulien22/following{/other_user}","gists_url":"https://api.github.com/users/hulien22/gists{/gist_id}","starred_url":"https://api.github.com/users/hulien22/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hulien22/subscriptions","organizations_url":"https://api.github.com/users/hulien22/orgs","repos_url":"https://api.github.com/users/hulien22/repos","events_url":"https://api.github.com/users/hulien22/events{/privacy}","received_events_url":"https://api.github.com/users/hulien22/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":null,"comments":0,"created_at":"2023-11-15T15:18:12Z","updated_at":"2024-07-25T02:59:58Z","closed_at":"2024-07-25T02:59:58Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"Jira Link: [DB-8923](https://yugabyte.atlassian.net/browse/DB-8923)\r\n### Description\n\nmac12-clang-release [failure](https://jenkins.dev.yugabyte.com/job/yugabyte-db-phabricator/214870/artifact/build/release-clang-dynamic-ninja/yb-test-logs/tests-integration-tests__xcluster-tablet-split-itest/XClusterTabletSplitITest_SplittingOnProducerAndConsumer.log):\r\n```\r\nI1115 11:34:04.604979 309831168 tablet-split-itest-base.cc:511] Tablet splitting did not complete. Crashing test with core dump. Received error: Timed out (yb/util/backoff_waiter.cc:78): Operation 'Wait for tablet split to be completed' didn't complete within 40145ms\r\n*** Aborted at 1700048044 (unix time) try \"date -d @1700048044\" if you are using GNU date ***\r\nPC: @                0x0 yb::XClusterAutomaticTabletSplitITest_AutomaticTabletSplitting_Test::TestBody()::$_4::operator()()::LOG_THROTTLER_1079\r\n*** SIGSEGV (@0x1107c9060) received by PID 63181 (TID 0x11277a600) stack trace: ***\r\n    @     0x7ff806e60dfd _sigtramp\r\n    @     0x7ff806d1ebeb notify_check_tz\r\n    @     0x7ff806d592d8 raise\r\n    @        0x10a4aca5d yb::TabletSplitITest::WaitForTabletSplitCompletion()\r\n    @        0x109ff735c yb::XClusterTabletSplitITest::SplitAllTablets()\r\n    @        0x109ff8868 yb::XClusterTabletSplitITest_SplittingOnProducerAndConsumer_Test::TestBody()\r\n    @        0x10b65c948 testing::internal::HandleExceptionsInMethodIfSupported<>()\r\n    @        0x10b65c89f testing::Test::Run()\r\n    @        0x10b65dea0 testing::TestInfo::Run()\r\n    @        0x10b65eb80 testing::TestSuite::Run()\r\n    @        0x10b66e999 testing::internal::UnitTestImpl::RunAllTests()\r\n    @        0x10b66dfe8 testing::internal::HandleExceptionsInMethodIfSupported<>()\r\n    @        0x10b66df6c testing::UnitTest::Run()\r\n    @        0x10a63812f main\r\n    @        0x1126ff52e (unknown)\r\n```\r\n\r\ncentos-clang17-tsan [failure](https://jenkins.dev.yugabyte.com/job/yugabyte-db-phabricator/214875/artifact/build/tsan-clang17-dynamic-ninja/yb-test-logs/tests-integration-tests__xcluster-tablet-split-itest/XClusterTabletSplitITest_SplittingOnProducerAndConsumer.log):\r\n```\r\nI1115 12:22:47.330473  3494 tablet_split_manager.cc:870] Processing split tablet result for table 69c43ff05af845909a6df8a81cfef110, split tablet ids: { source: 7de1416c39724038803a2cd0cd1288c6 children: {14a6829614e740238b5bad3fb043a77d, 3f10dbe3988b4913a1600977fb731177} }\r\nF1115 12:22:47.332132  3493 xcluster_consumer_registry_service.cc:146] Illegal state (yb/master/xcluster_consumer_registry_service.cc:145): Could not find any consumer tablets with overlapping key range for producer tablet d2474a9c175f4e5897605c79c3f154b8, partition_key_start: C9D5 and partition_key_end: \r\nFatal failure details written to ${BUILD_ROOT}/yb-test-logs/tests-integration-tests__xcluster-tablet-split-itest/XClusterTabletSplitITest_SplittingOnProducerAndConsumer.fatal_failure_details.2023-11-15T12_22_47.pid2354.txt\r\nF20231115 12:22:47 ../../src/yb/master/xcluster_consumer_registry_service.cc:146] Illegal state (yb/master/xcluster_consumer_registry_service.cc:145): Could not find any consumer tablets with overlapping key range for producer tablet d2474a9c175f4e5897605c79c3f154b8, partition_key_start: C9D5 and partition_key_end: \r\n```\r\n\r\nalma8-clang16-asan [failure](https://jenkins.dev.yugabyte.com/job/yugabyte-db-phabricator/214873/artifact/build/asan-clang16-dynamic-ninja/yb-test-logs/tests-integration-tests__xcluster-tablet-split-itest/XClusterTabletSplitITest_SplittingOnProducerAndConsumer.log):\r\n```\r\n[C-m-1] I1115 12:42:33.465422  5752 tablet_split_manager.cc:828] vlog2: MaybeDoSplitting: Skipping splitting run because enable_automatic_tablet_splitting is not set\r\nI1115 12:42:33.467732  5404 tablet-split-itest-base.cc:484] vlog0: num_peers_running: 6\r\nI1115 12:42:33.467804  5404 tablet-split-itest-base.cc:485] vlog0: num_peers_split: 0\r\nI1115 12:42:33.467830  5404 tablet-split-itest-base.cc:486] vlog0: num_peers_leader_ready: 2\r\nF1115 12:42:33.468516  6395 xcluster_consumer_registry_service.cc:146] Illegal state (yb/master/xcluster_consumer_registry_service.cc:145): Could not find any consumer tablets with overlapping key range for producer tablet db5d0f940be247d585e14f8235069ffe, partition_key_start: CA8C and partition_key_end: \r\nFatal failure details written to ${BUILD_ROOT}/yb-test-logs/tests-integration-tests__xcluster-tablet-split-itest/XClusterTabletSplitITest_SplittingOnProducerAndConsumer.fatal_failure_details.2023-11-15T12_42_33.pid5404.txt\r\nF20231115 12:42:33 ../../src/yb/master/xcluster_consumer_registry_service.cc:146] Illegal state (yb/master/xcluster_consumer_registry_service.cc:145): Could not find any consumer tablets with overlapping key range for producer tablet db5d0f940be247d585e14f8235069ffe, partition_key_start: CA8C and partition_key_end: \r\n```\r\n\r\nStability report: https://detective-gcp.dev.yugabyte.com/stability/test?branch=master&class=XClusterTabletSplitITest&name=SplittingOnProducerAndConsumer\n\n### Issue Type\n\nkind/failing-test\n\n### Warning: Please confirm that this issue does not contain any sensitive information\n\n- [X] I confirm this issue does not contain any sensitive information.\n\n[DB-8923]: https://yugabyte.atlassian.net/browse/DB-8923?atlOrigin=eyJpIjoiNWRkNTljNzYxNjVmNDY3MDlhMDU5Y2ZhYzA5YTRkZjUiLCJwIjoiZ2l0aHViLWNvbS1KU1cifQ","closed_by":{"login":"SrivastavaAnubhav","id":17299377,"node_id":"MDQ6VXNlcjE3Mjk5Mzc3","avatar_url":"https://avatars.githubusercontent.com/u/17299377?v=4","gravatar_id":"","url":"https://api.github.com/users/SrivastavaAnubhav","html_url":"https://github.com/SrivastavaAnubhav","followers_url":"https://api.github.com/users/SrivastavaAnubhav/followers","following_url":"https://api.github.com/users/SrivastavaAnubhav/following{/other_user}","gists_url":"https://api.github.com/users/SrivastavaAnubhav/gists{/gist_id}","starred_url":"https://api.github.com/users/SrivastavaAnubhav/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SrivastavaAnubhav/subscriptions","organizations_url":"https://api.github.com/users/SrivastavaAnubhav/orgs","repos_url":"https://api.github.com/users/SrivastavaAnubhav/repos","events_url":"https://api.github.com/users/SrivastavaAnubhav/events{/privacy}","received_events_url":"https://api.github.com/users/SrivastavaAnubhav/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/yugabyte/yugabyte-db/issues/19954/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/yugabyte/yugabyte-db/issues/19954/timeline","performed_via_github_app":null,"state_reason":"completed"}