{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/4728","repository_url":"https://api.github.com/repos/mitmproxy/mitmproxy","labels_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/4728/labels{/name}","comments_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/4728/comments","events_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/4728/events","html_url":"https://github.com/mitmproxy/mitmproxy/issues/4728","id":958817603,"node_id":"MDU6SXNzdWU5NTg4MTc2MDM=","number":4728,"title":"Upstream auth for NordVPN does not work","user":{"login":"tsoernes","id":6782404,"node_id":"MDQ6VXNlcjY3ODI0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/6782404?v=4","gravatar_id":"","url":"https://api.github.com/users/tsoernes","html_url":"https://github.com/tsoernes","followers_url":"https://api.github.com/users/tsoernes/followers","following_url":"https://api.github.com/users/tsoernes/following{/other_user}","gists_url":"https://api.github.com/users/tsoernes/gists{/gist_id}","starred_url":"https://api.github.com/users/tsoernes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tsoernes/subscriptions","organizations_url":"https://api.github.com/users/tsoernes/orgs","repos_url":"https://api.github.com/users/tsoernes/repos","events_url":"https://api.github.com/users/tsoernes/events{/privacy}","received_events_url":"https://api.github.com/users/tsoernes/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":466930397,"node_id":"MDU6TGFiZWw0NjY5MzAzOTc=","url":"https://api.github.com/repos/mitmproxy/mitmproxy/labels/kind/triage","name":"kind/triage","color":"006b75","default":false,"description":"Unclassified issues"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2021-08-03T07:29:06Z","updated_at":"2021-08-03T15:15:46Z","closed_at":"2021-08-03T15:15:46Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"#### Problem Description\r\nUsing an upstream authenticated NordVPN proxy does not work. Even though credentials are specified in the command line, the browser still asks for them.\r\n\r\n#### Steps to reproduce the behavior:\r\n1. `mitmdump --ssl-insecure --mode \"upstream:https://de873.nordvpn.com:89\" --upstream-auth \"USER:PASS\" `\r\n2. `google-chrome --proxy-server=\"http://localhost:8080\"`\r\n\r\n```\r\nProxy server listening at http://*:8080\r\n[::1]:40966: client connect\r\n[::1]:40968: client connect\r\n[::1]:40968: server connect de873.nordvpn.com (185.220.70.210:89)\r\n[::1]:40966: server connect de873.nordvpn.com (185.220.70.210:89)\r\n[::1]:40970: client connect\r\n[::1]:40972: client connect\r\n[::1]:40972: server connect de873.nordvpn.com (185.220.70.210:89)\r\n[::1]:40970: server connect de873.nordvpn.com (185.220.70.210:89)\r\n[::1]:40974: client connect\r\n[::1]:40974: server connect de873.nordvpn.com (185.220.70.210:89)\r\n[::1]:40976: client connect\r\n[::1]:40978: client connect\r\n[::1]:40968: POST https://accounts.google.com/ListAccounts?gpsia=1&source=ChromiumBrowser&json=standard HTTP/2.0\r\n << HTTP/2.0 200 OK 43b\r\n[::1]:40980: client connect\r\n[::1]:40982: client connect\r\n[::1]:40966: GET https://clientservices.googleapis.com/chrome-variations/seed?osname=linux&channel=stable&milestone=92 HTTP/2.0\r\n << HTTP/2.0 200 OK 24.31k\r\n[::1]:40976: server connect de873.nordvpn.com (185.220.70.210:89)\r\n[::1]:40978: server connect de873.nordvpn.com (185.220.70.210:89)\r\n[::1]:40984: client connect\r\n[::1]:40982: server connect de873.nordvpn.com (185.220.70.210:89)\r\n[::1]:40980: server connect de873.nordvpn.com (185.220.70.210:89)\r\n[::1]:40986: client connect\r\n[::1]:40988: client connect\r\n[::1]:40984: server connect de873.nordvpn.com (185.220.70.210:89)\r\n[::1]:40986: server connect de873.nordvpn.com (185.220.70.210:89)\r\n[::1]:40988: server connect de873.nordvpn.com (185.220.70.210:89)\r\n[::1]:40974: GET https://ssl.google-analytics.com/ga.js HTTP/2.0\r\n << HTTP/2.0 200 OK 16.77k\r\n[::1]:40990: client connect\r\n[::1]:40992: client connect\r\n[::1]:40994: client connect\r\n[::1]:40976: GET https://api.github.com/repos/keepassxreboot/keepassxc/releases/latest HTTP/2.0\r\n << HTTP/2.0 200 OK 3.32k\r\n[::1]:40978: POST https://www.googleapis.com/oauth2/v4/token HTTP/2.0\r\n << HTTP/2.0 200 OK 1.09k\r\n[::1]:40996: client connect\r\n[::1]:40980: GET https://www.google-analytics.com/analytics.js HTTP/2.0\r\n << HTTP/2.0 200 OK 19.21k\r\n[::1]:40980: GET https://www.google-analytics.com/r/__utm.gif?utmwv=5.7.2&utms=24&utmn=729937857&utmhn=fngmhnnpilhplaeedifhccceomclgfbg&utmcs=UTF-8&utmsr=1920x1080&utmsc=24-bit&utmul… HTTP/2.0\r\n << HTTP/2.0 302 Found 368b\r\n[::1]:40994: server connect de873.nordvpn.com (185.220.70.210:89)\r\n[::1]:40990: server connect de873.nordvpn.com (185.220.70.210:89)\r\n[::1]:40992: server connect de873.nordvpn.com (185.220.70.210:89)\r\n[::1]:40998: client connect\r\n[::1]:40996: server connect de873.nordvpn.com (185.220.70.210:89)\r\n[::1]:40984: GET https://cdn.honey.io/standdown-rules.json HTTP/2.0\r\n << HTTP/2.0 200 OK 16.86k\r\n[::1]:40982: GET https://accounts.google.com/GetCheckConnectionInfo?source=ChromiumBrowser HTTP/2.0\r\n << HTTP/2.0 200 OK 169b\r\n[::1]:41000: client connect\r\n[::1]:41002: client connect\r\n[::1]:40998: server connect de873.nordvpn.com (185.220.70.210:89)\r\n[::1]:40988: GET https://safebrowsing.googleapis.com/v4/fullHashes:find?$req=Ch0KDGdvb2dsZWNocm9tZRINOTIuMC40NTE1LjEzMRIbCg0IBxAGGAEiAzAwMTABEMv-CBoCGAZybqRJEhsKDQgFEAYYASIDMDAxMAEQx… HTTP/2.0\r\n << HTTP/2.0 200 OK 82b\r\n[::1]:41002: server connect de873.nordvpn.com (185.220.70.210:89)\r\n[::1]:41000: server connect de873.nordvpn.com (185.220.70.210:89)\r\n[::1]:40990: Client TLS handshake failed. The client disconnected during the handshake. If this happens consistently for d.joinhoney.com, this may indicate that the client does not trust the proxy's certificate.\r\n[::1]:40990: client disconnect\r\n[::1]:40990: server disconnect de873.nordvpn.com (185.220.70.210:89)\r\n[::1]:40992: GET https://d.joinhoney.com/features/pay_now_enabled?serviceName=honey-extension&serviceVersion=13.0.1 HTTP/2.0\r\n << HTTP/2.0 200 OK 15b\r\n[::1]:40992: GET https://d.joinhoney.com/adb/filter HTTP/2.0\r\n << HTTP/2.0 200 OK 485b\r\n[::1]:40992: GET https://d.joinhoney.com/features/ext_paypal_heartbeat?serviceName=honey-extension&serviceVersion=13.0.1 HTTP/2.0\r\n << HTTP/2.0 200 OK 15b\r\n[::1]:41004: client connect\r\n[::1]:41006: client connect\r\n[::1]:41010: client connect\r\n[::1]:41014: client connect\r\n[::1]:40992: GET https://d.joinhoney.com/v3?operationName=ext_getUserInfo&variables=%7B%7D HTTP/2.0\r\n << HTTP/2.0 401 Unauthorized 26b\r\n[::1]:41004: server connect de873.nordvpn.com (185.220.70.210:89)\r\n[::1]:40998: GET https://stats.g.doubleclick.net/r/collect?v=1&aip=1&t=dc&_r=3&tid=UA-33054271-5&cid=66718305.1595413759&jid=1562794097&_v=5.7.2&z=729937857 HTTP/2.0\r\n << HTTP/2.0 200 OK 35b\r\n[::1]:41018: client connect\r\n[::1]:41006: server connect de873.nordvpn.com (185.220.70.210:89)\r\n[::1]:41014: server connect de873.nordvpn.com (185.220.70.210:89)\r\n[::1]:41010: server connect de873.nordvpn.com (185.220.70.210:89)\r\n[::1]:40992: GET https://d.joinhoney.com/extdata/ckdata HTTP/2.0\r\n << HTTP/2.0 200 OK 2b\r\n[::1]:41018: server connect de873.nordvpn.com (185.220.70.210:89)\r\n[::1]:41020: client connect\r\n[::1]:41024: client connect\r\n[::1]:41026: client connect\r\n[::1]:41028: client connect\r\n[::1]:41020: server connect de873.nordvpn.com (185.220.70.210:89)\r\n[::1]:40992: GET https://d.joinhoney.com/v3?operationName=ext_getExperiments&variables=%7B%22platform%22%3A%22ext%22%2C%22archived%22%3Afalse%7D HTTP/2.0\r\n << HTTP/2.0 200 OK 34.17k\r\n[::1]:40992: GET https://d.joinhoney.com/v3?operationName=checkout_getURLObservationRemoteConfig&variables=%7B%7D HTTP/2.0\r\n << HTTP/2.0 200 OK 130b\r\n[::1]:41024: server connect de873.nordvpn.com (185.220.70.210:89)\r\n[::1]:41028: server connect de873.nordvpn.com (185.220.70.210:89)\r\n[::1]:41026: server connect de873.nordvpn.com (185.220.70.210:89)\r\n[::1]:41030: client connect\r\n[::1]:40972: Unable to establish TLS connection with server (Upstream proxy de873.nordvpn.com:89 refused HTTP CONNECT request: 407 Proxy Authentication Required). Trying to establish TLS with client anyway.\r\n[::1]:40986: Unable to establish TLS connection with server (Upstream proxy de873.nordvpn.com:89 refused HTTP CONNECT request: 407 Proxy Authentication Required). Trying to establish TLS with client anyway.\r\n[::1]:40972: server disconnect de873.nordvpn.com (185.220.70.210:89)\r\n[::1]:40986: server disconnect de873.nordvpn.com (185.220.70.210:89)\r\n[::1]:40970: Unable to establish TLS connection with server (Upstream proxy de873.nordvpn.com:89 refused HTTP CONNECT request: 407 Proxy Authentication Required). Trying to establish TLS with client anyway.\r\n[::1]:40994: Unable to establish TLS connection with server (Upstream proxy de873.nordvpn.com:89 refused HTTP CONNECT request: 407 Proxy Authentication Required). Trying to establish TLS with client anyway.\r\n[::1]:40996: Unable to establish TLS connection with server (Upstream proxy de873.nordvpn.com:89 refused HTTP CONNECT request: 407 Proxy Authentication Required). Trying to establish TLS with client anyway.\r\n[::1]:41006: GET https://clients2.google.com/service/update2/crx?os=linux&arch=x64&os_arch=x86_64&nacl_arch=x86-64&prod=chromecrx&prodchannel=&prodversion=92.0.4515.131&lang=en-US&ac… HTTP/2.0\r\n << HTTP/2.0 200 OK 448b\r\n[::1]:41002: Unable to establish TLS connection with server (Upstream proxy de873.nordvpn.com:89 refused HTTP CONNECT request: 407 Proxy Authentication Required). Trying to establish TLS with client anyway.\r\n[::1]:40986: client disconnect\r\n[::1]:40970: server disconnect de873.nordvpn.com (185.220.70.210:89)\r\n[::1]:40994: server disconnect de873.nordvpn.com (185.220.70.210:89)\r\n[::1]:40996: server disconnect de873.nordvpn.com (185.220.70.210:89)\r\n[::1]:41002: server disconnect de873.nordvpn.com (185.220.70.210:89)\r\n[::1]:40994: client disconnect\r\n[::1]:41010: mitmproxy has crashed!\r\nTraceback (most recent call last):\r\n  File \"/home/torstein/anaconda3/lib/python3.8/site-packages/mitmproxy/proxy/server.py\", line 282, in server_event\r\n    assert command.connection not in self.transports\r\nAssertionError\r\n\r\n[::1]:41030: server connect de873.nordvpn.com (185.220.70.210:89)\r\n[::1]:41014: POST https://android.clients.google.com/c2dm/register3 HTTP/2.0\r\n << HTTP/2.0 200 OK 158b\r\n[::1]:41014: POST https://android.clients.google.com/checkin HTTP/2.0\r\n << HTTP/2.0 200 OK 397b\r\n[::1]:40996: server connect de873.nordvpn.com (185.220.70.210:89)\r\n[::1]:41002: server connect de873.nordvpn.com (185.220.70.210:89)\r\n[::1]:40972: server connect de873.nordvpn.com (185.220.70.210:89)\r\n[::1]:40970: server connect de873.nordvpn.com (185.220.70.210:89)\r\n[::1]:41004: GET https://history.paypal.com/targeting/set-plugin?src=honey\r\n          << 200 OK 59b\r\n[::1]:41028: client disconnect\r\n[::1]:41028: server disconnect de873.nordvpn.com (185.220.70.210:89)\r\n[::1]:41026: client disconnect\r\n[::1]:41026: server disconnect de873.nordvpn.com (185.220.70.210:89)\r\n[::1]:41014: POST https://android.clients.google.com/c2dm/register3 HTTP/2.0\r\n << HTTP/2.0 200 OK 167b\r\n[::1]:41014: POST https://android.clients.google.com/c2dm/register3 HTTP/2.0\r\n << HTTP/2.0 200 OK 168b\r\n[::1]:41020: POST https://s.joinhoney.com/ev/ext000001 HTTP/2.0\r\n << HTTP/2.0 200 OK 2b\r\n[::1]:41020: POST https://s.joinhoney.com/evs HTTP/2.0\r\n << HTTP/2.0 200 OK 2b\r\n[::1]:41030: Unable to establish TLS connection with server (Upstream proxy de873.nordvpn.com:89 refused HTTP CONNECT request: 407 Proxy Authentication Required). Trying to establish TLS with client anyway.\r\n[::1]:41000: Unable to establish TLS connection with server (Upstream proxy de873.nordvpn.com:89 refused HTTP CONNECT request: 407 Proxy Authentication Required). Trying to establish TLS with client anyway.\r\n[::1]:40970: GET https://www.httpbin.org/ip HTTP/2.0\r\n << Upstream proxy de873.nordvpn.com:89 refused HTTP CONNECT request: 407 Proxy Authentication Required\r\n[::1]:40972: POST https://safebrowsing.google.com/safebrowsing/clientreport/realtime HTTP/2.0\r\n << Upstream proxy de873.nordvpn.com:89 refused HTTP CONNECT request: 407 Proxy Authentication Required\r\n[::1]:40996: POST https://oauthaccountmanager.googleapis.com/v1/issuetoken HTTP/2.0\r\n << Upstream proxy de873.nordvpn.com:89 refused HTTP CONNECT request: 407 Proxy Authentication Required\r\n[::1]:41002: GET https://accounts.youtube.com/accounts/CheckConnection?chromeCheckConnection=1&v=284156175 HTTP/2.0\r\n << Upstream proxy de873.nordvpn.com:89 refused HTTP CONNECT request: 407 Proxy Authentication Required\r\n[::1]:41030: server disconnect de873.nordvpn.com (185.220.70.210:89)\r\n[::1]:41000: server disconnect de873.nordvpn.com (185.220.70.210:89)\r\n[::1]:40970: server disconnect de873.nordvpn.com (185.220.70.210:89)\r\n[::1]:40972: server disconnect de873.nordvpn.com (185.220.70.210:89)\r\n[::1]:40996: server disconnect de873.nordvpn.com (185.220.70.210:89)\r\n[::1]:41002: server disconnect de873.nordvpn.com (185.220.70.210:89)\r\n[::1]:41030: client disconnect\r\n[::1]:41018: POST https://update.googleapis.com/service/update2/json?cup2key=11:2131373072&cup2hreq=29bddc46f920bab8cdb45419334543ebc8858a931a2ab51559eb45e9275fee6d HTTP/2.0\r\n << HTTP/2.0 200 OK 3.28k\r\n[::1]:41032: client connect\r\n[::1]:41032: server connect de873.nordvpn.com (185.220.70.210:89)\r\n[::1]:41000: server connect de873.nordvpn.com (185.220.70.210:89)\r\n[::1]:40978: POST https://www.googleapis.com/oauth2/v4/token HTTP/2.0\r\n << HTTP/2.0 200 OK 353b\r\n[::1]:40970: server connect de873.nordvpn.com (185.220.70.210:89)\r\n[::1]:40978: POST https://www.googleapis.com/oauth2/v4/token HTTP/2.0\r\n << HTTP/2.0 200 OK 347b\r\n[::1]:41034: client connect\r\n[::1]:41036: client connect\r\n[::1]:41036: server connect de873.nordvpn.com (185.220.70.210:89)\r\n[::1]:41034: server connect de873.nordvpn.com (185.220.70.210:89)\r\n[::1]:41038: client connect\r\n[::1]:41042: client connect\r\n[::1]:41044: client connect\r\n[::1]:41046: client connect\r\n[::1]:41048: client connect\r\n[::1]:41024: Unable to establish TLS connection with server (Upstream proxy de873.nordvpn.com:89 refused HTTP CONNECT request: 407 Proxy Authentication Required). Trying to establish TLS with client anyway.\r\n[::1]:41024: server disconnect de873.nordvpn.com (185.220.70.210:89)\r\n[::1]:41024: client disconnect\r\n[::1]:41046: server connect de873.nordvpn.com (185.220.70.210:89)\r\n[::1]:41042: server connect de873.nordvpn.com (185.220.70.210:89)\r\n[::1]:41038: server connect de873.nordvpn.com (185.220.70.210:89)\r\n[::1]:41048: server connect de873.nordvpn.com (185.220.70.210:89)\r\n[::1]:41044: server connect de873.nordvpn.com (185.220.70.210:89)\r\n[::1]:41032: GET https://clients2.googleusercontent.com/crx/blobs/Acy1k0aSwbfD1gHSR7DV9HG6UjXpqJ2bHXPyin3BM_eq0vJ9e-NXxb_8MMsXjQi1WL90l1aSTEL5cV_4yM0t8ZMgoVqdMxVLqvQABx44nreL68p0xAUc… HTTP/2.0\r\n << HTTP/2.0 200 OK 46.56k\r\n[::1]:41018: POST https://update.googleapis.com/service/update2/json HTTP/2.0\r\n << HTTP/2.0 200 OK 170b\r\n[::1]:41044: Client TLS handshake failed. The client disconnected during the handshake. If this happens consistently for firebaseperusertopics-pa.googleapis.com, this may indicate that the client does not trust the proxy's certificate.\r\n[::1]:41044: client disconnect\r\n[::1]:41044: server disconnect de873.nordvpn.com (185.220.70.210:89)\r\n[::1]:41042: client disconnect\r\n[::1]:41042: server disconnect de873.nordvpn.com (185.220.70.210:89)\r\n[::1]:40970: GET https://www.httpbin.org/favicon.ico HTTP/2.0\r\n << HTTP/2.0 404 Not Found 233b\r\n[::1]:41046: client disconnect\r\n[::1]:41046: server disconnect de873.nordvpn.com (185.220.70.210:89)\r\n[::1]:41048: POST https://firebaseperusertopics-pa.googleapis.com/v1/perusertopics/8181035976/rel/topics/?subscriber_token=dnsZI3fGpQw:APA91bFhWoT0CyXu5VQdog5Eua5Q03RTEv6ysrCPpUJ54aiJ… HTTP/2.0\r\n << HTTP/2.0 200 OK 97b\r\n[::1]:41038: client disconnect\r\n[::1]:41038: server disconnect de873.nordvpn.com (185.220.70.210:89)\r\n[::1]:41048: POST https://firebaseperusertopics-pa.googleapis.com/v1/perusertopics/8181035976/rel/topics/?subscriber_token=dnsZI3fGpQw:APA91bFhWoT0CyXu5VQdog5Eua5Q03RTEv6ysrCPpUJ54aiJ… HTTP/2.0\r\n << HTTP/2.0 200 OK 91b\r\n[::1]:41048: POST https://firebaseperusertopics-pa.googleapis.com/v1/perusertopics/8181035976/rel/topics/?subscriber_token=dnsZI3fGpQw:APA91bFhWoT0CyXu5VQdog5Eua5Q03RTEv6ysrCPpUJ54aiJ… HTTP/2.0\r\n << HTTP/2.0 200 OK 100b\r\n[::1]:41048: POST https://firebaseperusertopics-pa.googleapis.com/v1/perusertopics/8181035976/rel/topics/?subscriber_token=dnsZI3fGpQw:APA91bFhWoT0CyXu5VQdog5Eua5Q03RTEv6ysrCPpUJ54aiJ… HTTP/2.0\r\n << HTTP/2.0 200 OK 100b\r\n[::1]:41048: POST https://firebaseperusertopics-pa.googleapis.com/v1/perusertopics/8181035976/rel/topics/?subscriber_token=dnsZI3fGpQw:APA91bFhWoT0CyXu5VQdog5Eua5Q03RTEv6ysrCPpUJ54aiJ… HTTP/2.0\r\n << HTTP/2.0 200 OK 97b\r\n[::1]:41048: POST https://firebaseperusertopics-pa.googleapis.com/v1/perusertopics/8181035976/rel/topics/?subscriber_token=dnsZI3fGpQw:APA91bFhWoT0CyXu5VQdog5Eua5Q03RTEv6ysrCPpUJ54aiJ… HTTP/2.0\r\n << HTTP/2.0 200 OK 96b\r\n[::1]:41048: POST https://firebaseperusertopics-pa.googleapis.com/v1/perusertopics/8181035976/rel/topics/?subscriber_token=dnsZI3fGpQw:APA91bFhWoT0CyXu5VQdog5Eua5Q03RTEv6ysrCPpUJ54aiJ… HTTP/2.0\r\n << HTTP/2.0 200 OK 99b\r\n[::1]:41048: POST https://firebaseperusertopics-pa.googleapis.com/v1/perusertopics/8181035976/rel/topics/?subscriber_token=dnsZI3fGpQw:APA91bFhWoT0CyXu5VQdog5Eua5Q03RTEv6ysrCPpUJ54aiJ… HTTP/2.0\r\n << HTTP/2.0 200 OK 104b\r\n[::1]:41048: POST https://firebaseperusertopics-pa.googleapis.com/v1/perusertopics/8181035976/rel/topics/?subscriber_token=dnsZI3fGpQw:APA91bFhWoT0CyXu5VQdog5Eua5Q03RTEv6ysrCPpUJ54aiJ… HTTP/2.0\r\n << HTTP/2.0 200 OK 98b\r\n[::1]:41048: POST https://firebaseperusertopics-pa.googleapis.com/v1/perusertopics/8181035976/rel/topics/?subscriber_token=dnsZI3fGpQw:APA91bFhWoT0CyXu5VQdog5Eua5Q03RTEv6ysrCPpUJ54aiJ… HTTP/2.0\r\n << HTTP/2.0 200 OK 102b\r\n[::1]:41048: POST https://firebaseperusertopics-pa.googleapis.com/v1/perusertopics/8181035976/rel/topics/?subscriber_token=dnsZI3fGpQw:APA91bFhWoT0CyXu5VQdog5Eua5Q03RTEv6ysrCPpUJ54aiJ… HTTP/2.0\r\n << HTTP/2.0 200 OK 94b\r\n[::1]:41048: POST https://firebaseperusertopics-pa.googleapis.com/v1/perusertopics/8181035976/rel/topics/?subscriber_token=dnsZI3fGpQw:APA91bFhWoT0CyXu5VQdog5Eua5Q03RTEv6ysrCPpUJ54aiJ… HTTP/2.0\r\n << HTTP/2.0 200 OK 103b\r\n[::1]:41048: POST https://firebaseperusertopics-pa.googleapis.com/v1/perusertopics/8181035976/rel/topics/?subscriber_token=dnsZI3fGpQw:APA91bFhWoT0CyXu5VQdog5Eua5Q03RTEv6ysrCPpUJ54aiJ… HTTP/2.0\r\n << HTTP/2.0 200 OK 105b\r\n[::1]:41048: POST https://firebaseperusertopics-pa.googleapis.com/v1/perusertopics/8181035976/rel/topics/?subscriber_token=dnsZI3fGpQw:APA91bFhWoT0CyXu5VQdog5Eua5Q03RTEv6ysrCPpUJ54aiJ… HTTP/2.0\r\n << HTTP/2.0 200 OK 96b\r\n[::1]:41048: POST https://firebaseperusertopics-pa.googleapis.com/v1/perusertopics/8181035976/rel/topics/?subscriber_token=dnsZI3fGpQw:APA91bFhWoT0CyXu5VQdog5Eua5Q03RTEv6ysrCPpUJ54aiJ… HTTP/2.0\r\n << HTTP/2.0 200 OK 93b\r\n[::1]:41048: POST https://firebaseperusertopics-pa.googleapis.com/v1/perusertopics/8181035976/rel/topics/?subscriber_token=dnsZI3fGpQw:APA91bFhWoT0CyXu5VQdog5Eua5Q03RTEv6ysrCPpUJ54aiJ… HTTP/2.0\r\n << HTTP/2.0 200 OK 104b\r\n[::1]:41048: POST https://firebaseperusertopics-pa.googleapis.com/v1/perusertopics/8181035976/rel/topics/?subscriber_token=dnsZI3fGpQw:APA91bFhWoT0CyXu5VQdog5Eua5Q03RTEv6ysrCPpUJ54aiJ… HTTP/2.0\r\n << HTTP/2.0 200 OK 108b\r\n[::1]:41048: POST https://firebaseperusertopics-pa.googleapis.com/v1/perusertopics/8181035976/rel/topics/?subscriber_token=dnsZI3fGpQw:APA91bFhWoT0CyXu5VQdog5Eua5Q03RTEv6ysrCPpUJ54aiJ… HTTP/2.0\r\n << HTTP/2.0 200 OK 113b\r\n[::1]:41048: POST https://firebaseperusertopics-pa.googleapis.com/v1/perusertopics/8181035976/rel/topics/?subscriber_token=dnsZI3fGpQw:APA91bFhWoT0CyXu5VQdog5Eua5Q03RTEv6ysrCPpUJ54aiJ… HTTP/2.0\r\n << HTTP/2.0 200 OK 102b\r\n[::1]:41048: POST https://firebaseperusertopics-pa.googleapis.com/v1/perusertopics/8181035976/rel/topics/?subscriber_token=dnsZI3fGpQw:APA91bFhWoT0CyXu5VQdog5Eua5Q03RTEv6ysrCPpUJ54aiJ… HTTP/2.0\r\n << HTTP/2.0 200 OK 98b\r\n[::1]:41048: POST https://firebaseperusertopics-pa.googleapis.com/v1/perusertopics/8181035976/rel/topics/?subscriber_token=dnsZI3fGpQw:APA91bFhWoT0CyXu5VQdog5Eua5Q03RTEv6ysrCPpUJ54aiJ… HTTP/2.0\r\n << HTTP/2.0 200 OK 106b\r\n[::1]:41048: POST https://firebaseperusertopics-pa.googleapis.com/v1/perusertopics/8181035976/rel/topics/?subscriber_token=dnsZI3fGpQw:APA91bFhWoT0CyXu5VQdog5Eua5Q03RTEv6ysrCPpUJ54aiJ… HTTP/2.0\r\n << HTTP/2.0 200 OK 97b\r\n[::1]:41048: POST https://firebaseperusertopics-pa.googleapis.com/v1/perusertopics/8181035976/rel/topics/?subscriber_token=dnsZI3fGpQw:APA91bFhWoT0CyXu5VQdog5Eua5Q03RTEv6ysrCPpUJ54aiJ… HTTP/2.0\r\n << HTTP/2.0 200 OK 99b\r\n[::1]:41000: GET https://accounts.doubleclick.net/CheckConnection?chromeCheckConnection=1&v=1819058658 HTTP/2.0\r\n << Upstream proxy de873.nordvpn.com:89 refused HTTP CONNECT request: 407 Proxy Authentication Required\r\n[::1]:41000: server disconnect de873.nordvpn.com (185.220.70.210:89)\r\n[::1]:40984: GET https://cdn.honey.io/experiments.json HTTP/2.0\r\n << HTTP/2.0 200 OK 111.32k\r\n[::1]:41036: Unable to establish TLS connection with server (Upstream proxy de873.nordvpn.com:89 refused HTTP CONNECT request: 407 Proxy Authentication Required). Trying to establish TLS with client anyway.\r\n[::1]:41036: server disconnect de873.nordvpn.com (185.220.70.210:89)\r\n[::1]:41034: Unable to establish TLS connection with server (Upstream proxy de873.nordvpn.com:89 refused HTTP CONNECT request: 407 Proxy Authentication Required). Trying to establish TLS with client anyway.\r\n[::1]:41036: client disconnect\r\n[::1]:41034: server disconnect de873.nordvpn.com (185.220.70.210:89)\r\n[::1]:41050: client connect\r\n[::1]:41052: client connect\r\n[::1]:41054: client connect\r\n[::1]:41034: server connect de873.nordvpn.com (185.220.70.210:89)\r\n[::1]:41052: server connect de873.nordvpn.com (185.220.70.210:89)\r\n[::1]:41050: server connect de873.nordvpn.com (185.220.70.210:89)\r\n[::1]:41054: server connect de873.nordvpn.com (185.220.70.210:89)\r\n[::1]:41052: HEAD http://smctajrvnogvwb/\r\n          << 407 Proxy Authentication Required 0b\r\n[::1]:41052: server disconnect de873.nordvpn.com (185.220.70.210:89)\r\n[::1]:41052: client disconnect\r\n[::1]:41050: HEAD http://albefeg/\r\n          << 407 Proxy Authentication Required 0b\r\n[::1]:41050: server disconnect de873.nordvpn.com (185.220.70.210:89)\r\n[::1]:41054: HEAD http://kiradqwtwzyikhb/\r\n          << 407 Proxy Authentication Required 0b\r\n[::1]:41054: server disconnect de873.nordvpn.com (185.220.70.210:89)\r\n[::1]:41050: client disconnect\r\n[::1]:41054: client disconnect\r\n[::1]:41034: POST https://clients4.google.com/chrome-sync/command/?client=Google+Chrome&client_id=8Y%2Bn4uCpr7joqrFhFEAVdw%3D%3D HTTP/2.0\r\n << HTTP/2.0 200 OK 21.75k\r\n[::1]:40968: POST https://accounts.google.com/oauth/multilogin?source=ChromiumAccountReconcilorDice&reuseCookies=1&externalCcResult=doubleclick:null,youtube:null HTTP/2.0\r\n << HTTP/2.0 200 OK 1.16k\r\n[::1]:40968: POST https://accounts.google.com/ListAccounts?gpsia=1&source=ChromiumBrowser&json=standard HTTP/2.0\r\n << HTTP/2.0 200 OK 197b\r\n[::1]:41014: POST https://android.clients.google.com/c2dm/register3 HTTP/2.0\r\n << HTTP/2.0 200 OK 166b\r\n[::1]:41014: POST https://android.clients.google.com/c2dm/register3 HTTP/2.0\r\n << HTTP/2.0 200 OK 166b\r\n[::1]:41034: POST https://clients4.google.com/chrome-sync/command/?client=Google+Chrome&client_id=8Y%2Bn4uCpr7joqrFhFEAVdw%3D%3D HTTP/2.0\r\n << HTTP/2.0 200 OK 125.57k\r\n[::1]:41034: POST https://clients4.google.com/chrome-sync/command/?client=Google+Chrome&client_id=8Y%2Bn4uCpr7joqrFhFEAVdw%3D%3D HTTP/2.0\r\n << HTTP/2.0 200 OK 31.34k\r\n[::1]:41006: GET https://clients2.google.com/service/update2/crx?os=linux&arch=x64&os_arch=x86_64&nacl_arch=x86-64&prod=chromecrx&prodchannel=&prodversion=92.0.4515.131&lang=en-US&ac… HTTP/2.0\r\n << HTTP/2.0 200 OK 448b\r\n[::1]:41034: POST https://clients4.google.com/chrome-sync/command/?client=Google+Chrome&client_id=8Y%2Bn4uCpr7joqrFhFEAVdw%3D%3D HTTP/2.0\r\n << HTTP/2.0 200 OK 354b\r\n[::1]:41034: POST https://clients4.google.com/chrome-sync/command/?client=Google+Chrome&client_id=8Y%2Bn4uCpr7joqrFhFEAVdw%3D%3D HTTP/2.0\r\n << HTTP/2.0 200 OK 898b\r\n[::1]:40992: GET https://d.joinhoney.com/v3?operationName=ext_getSupportedDomains&variables=%7B%7D HTTP/2.0\r\n << HTTP/2.0 200 OK 1.81m\r\n[::1]:41056: client connect\r\n[::1]:41056: server connect de873.nordvpn.com (185.220.70.210:89)\r\n[::1]:41056: Unable to establish TLS connection with server (Upstream proxy de873.nordvpn.com:89 refused HTTP CONNECT request: 407 Proxy Authentication Required). Trying to establish TLS with client anyway.\r\n[::1]:41056: server disconnect de873.nordvpn.com (185.220.70.210:89)\r\n[::1]:41056: server connect de873.nordvpn.com (185.220.70.210:89)\r\n[::1]:41058: client connect\r\n[::1]:41058: server connect de873.nordvpn.com (185.220.70.210:89)\r\n[::1]:41058: GET http://www.httpbin.org/ip\r\n          << 407 Proxy Authentication Required 4.96k\r\n[::1]:41058: server disconnect de873.nordvpn.com (185.220.70.210:89)\r\n[::1]:41058: client disconnect\r\n[::1]:41060: client connect\r\n[::1]:41056: GET https://www.google.com/complete/search?client=chrome-omni&gs_ri=chrome-ext-ansg&xssi=t&q=http%3A%2F%2Fwww.httpbin.org%2Fip&oit=3&cp=4&url=https%3A%2F%2Fwww.httpbin.o… HTTP/2.0\r\n << Upstream proxy de873.nordvpn.com:89 refused HTTP CONNECT request: 407 Proxy Authentication Required\r\n[::1]:41056: server disconnect de873.nordvpn.com (185.220.70.210:89)\r\n[::1]:41060: server connect de873.nordvpn.com (185.220.70.210:89)\r\n[::1]:41060: GET http://www.httpbin.org/ip\r\n          << 407 Proxy Authentication Required 4.96k\r\n[::1]:41060: server disconnect de873.nordvpn.com (185.220.70.210:89)\r\n[::1]:41060: client disconnect\r\n[::1]:41062: client connect\r\n[::1]:41062: server connect de873.nordvpn.com (185.220.70.210:89)\r\n[::1]:41062: client disconnect\r\n[::1]:41062: Server TLS handshake failed. connection closed\r\n[::1]:41062: GET http://www.httpbin.org/favicon.ico\r\n << connection closed\r\n[::1]:41062: server disconnect de873.nordvpn.com (185.220.70.210:89)\r\n[::1]:40988: client disconnect\r\n[::1]:40972: client disconnect\r\n[::1]:40988: server disconnect de873.nordvpn.com (185.220.70.210:89)\r\n[::1]:41034: POST https://clients4.google.com/chrome-sync/command/?client=Google+Chrome&client_id=8Y%2Bn4uCpr7joqrFhFEAVdw%3D%3D HTTP/2.0\r\n << stream reset by client (CANCEL)\r\n[::1]:40968: client disconnect\r\n[::1]:40974: client disconnect\r\n[::1]:40978: client disconnect\r\n[::1]:41032: GET https://clients2.googleusercontent.com/crx/blobs/Acy1k0Yj5Kgw06-BW554OtkZlHd2iS5w3YnDgN37ZTR5xhCFn0NBbk9nxgZxGRWMRGPYBdDgjgGeKPafBs-NTzCmAxfbMoV4EhecM8j60dkC4KElemE4… HTTP/2.0\r\n << HTTP/2.0 200 OK (content missing)\r\n << peer closed connection\r\n[::1]:40982: client disconnect\r\n[::1]:40976: client disconnect\r\n[::1]:40980: client disconnect\r\n[::1]:40984: client disconnect\r\n[::1]:40992: client disconnect\r\n[::1]:40998: client disconnect\r\n\r\n```\r\n\r\n#### System Information\r\n```\r\nmitmdump --version                                                                                                                         (base) 3.7m\r\nMitmproxy: 7.0.0\r\nPython:    3.8.8\r\nOpenSSL:   OpenSSL 1.1.1i  8 Dec 2020\r\nPlatform:  Linux-5.12.15-200.fc33.x86_64-x86_64-with-glibc2.10\r\n```","closed_by":{"login":"mhils","id":1019198,"node_id":"MDQ6VXNlcjEwMTkxOTg=","avatar_url":"https://avatars.githubusercontent.com/u/1019198?v=4","gravatar_id":"","url":"https://api.github.com/users/mhils","html_url":"https://github.com/mhils","followers_url":"https://api.github.com/users/mhils/followers","following_url":"https://api.github.com/users/mhils/following{/other_user}","gists_url":"https://api.github.com/users/mhils/gists{/gist_id}","starred_url":"https://api.github.com/users/mhils/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mhils/subscriptions","organizations_url":"https://api.github.com/users/mhils/orgs","repos_url":"https://api.github.com/users/mhils/repos","events_url":"https://api.github.com/users/mhils/events{/privacy}","received_events_url":"https://api.github.com/users/mhils/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/4728/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/4728/timeline","performed_via_github_app":null,"state_reason":"completed"}