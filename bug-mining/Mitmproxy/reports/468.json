{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/6554","repository_url":"https://api.github.com/repos/mitmproxy/mitmproxy","labels_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/6554/labels{/name}","comments_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/6554/comments","events_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/6554/events","html_url":"https://github.com/mitmproxy/mitmproxy/issues/6554","id":2044335582,"node_id":"I_kwDOAAfumM552hXe","number":6554,"title":"ignore_hosts and allow_hosts not working as documented","user":{"login":"micheljung","id":1864183,"node_id":"MDQ6VXNlcjE4NjQxODM=","avatar_url":"https://avatars.githubusercontent.com/u/1864183?v=4","gravatar_id":"","url":"https://api.github.com/users/micheljung","html_url":"https://github.com/micheljung","followers_url":"https://api.github.com/users/micheljung/followers","following_url":"https://api.github.com/users/micheljung/following{/other_user}","gists_url":"https://api.github.com/users/micheljung/gists{/gist_id}","starred_url":"https://api.github.com/users/micheljung/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/micheljung/subscriptions","organizations_url":"https://api.github.com/users/micheljung/orgs","repos_url":"https://api.github.com/users/micheljung/repos","events_url":"https://api.github.com/users/micheljung/events{/privacy}","received_events_url":"https://api.github.com/users/micheljung/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":79336502,"node_id":"MDU6TGFiZWw3OTMzNjUwMg==","url":"https://api.github.com/repos/mitmproxy/mitmproxy/labels/kind/bug","name":"kind/bug","color":"d93f0b","default":false,"description":null},{"id":429899749,"node_id":"MDU6TGFiZWw0Mjk4OTk3NDk=","url":"https://api.github.com/repos/mitmproxy/mitmproxy/labels/area/core","name":"area/core","color":"fef2c0","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2023-12-15T20:33:10Z","updated_at":"2023-12-18T13:55:50Z","closed_at":"2023-12-18T13:55:50Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"#### Problem Description\r\n\r\nThe [documentation of `ignore_hosts`](https://docs.mitmproxy.org/stable/concepts-options/#ignore_hosts) states:\r\n\r\n> Ignore host and forward all traffic without processing it. In transparent mode, it is recommended to use an IP address (range), not the hostname. In regular mode, only SSL traffic is ignored and the hostname should be used.\r\n\r\nBut instead of \"forward all traffic without processing it\", it closes the connection. Similarly, `allow_hosts` only allows traffic for the specified host but closes the connection for all others.\r\n\r\n#### Steps to reproduce the behavior:\r\n\r\n```\r\nmitmproxy --set ignore_hosts=mitmproxy.org\r\n```\r\n\r\n```\r\n$ curl -x localhost:8080 -k https://mitmproxy.org\r\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\r\n                                 Dload  Upload   Total   Spent    Left  Speed\r\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\r\ncurl: (56) Proxy CONNECT aborted\r\n```\r\n\r\n#### System Information\r\n\r\n```\r\nMitmproxy: 10.1.6 binary\r\nPython:    3.12.0\r\nOpenSSL:   OpenSSL 3.1.4 24 Oct 2023\r\nPlatform:  Windows-11-10.0.22621-SP0\r\n```\r\n","closed_by":{"login":"mhils","id":1019198,"node_id":"MDQ6VXNlcjEwMTkxOTg=","avatar_url":"https://avatars.githubusercontent.com/u/1019198?v=4","gravatar_id":"","url":"https://api.github.com/users/mhils","html_url":"https://github.com/mhils","followers_url":"https://api.github.com/users/mhils/followers","following_url":"https://api.github.com/users/mhils/following{/other_user}","gists_url":"https://api.github.com/users/mhils/gists{/gist_id}","starred_url":"https://api.github.com/users/mhils/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mhils/subscriptions","organizations_url":"https://api.github.com/users/mhils/orgs","repos_url":"https://api.github.com/users/mhils/repos","events_url":"https://api.github.com/users/mhils/events{/privacy}","received_events_url":"https://api.github.com/users/mhils/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/6554/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/6554/timeline","performed_via_github_app":null,"state_reason":"completed"}