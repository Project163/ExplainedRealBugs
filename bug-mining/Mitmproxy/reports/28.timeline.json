[{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/comments/37955387","html_url":"https://github.com/mitmproxy/mitmproxy/issues/243#issuecomment-37955387","issue_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/243","id":37955387,"node_id":"MDEyOklzc3VlQ29tbWVudDM3OTU1Mzg3","user":{"login":"mhils","id":1019198,"node_id":"MDQ6VXNlcjEwMTkxOTg=","avatar_url":"https://avatars.githubusercontent.com/u/1019198?v=4","gravatar_id":"","url":"https://api.github.com/users/mhils","html_url":"https://github.com/mhils","followers_url":"https://api.github.com/users/mhils/followers","following_url":"https://api.github.com/users/mhils/following{/other_user}","gists_url":"https://api.github.com/users/mhils/gists{/gist_id}","starred_url":"https://api.github.com/users/mhils/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mhils/subscriptions","organizations_url":"https://api.github.com/users/mhils/orgs","repos_url":"https://api.github.com/users/mhils/repos","events_url":"https://api.github.com/users/mhils/events{/privacy}","received_events_url":"https://api.github.com/users/mhils/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2014-03-18T16:37:35Z","updated_at":"2014-03-18T16:37:35Z","body":"Hi there,\n\nthis is not supported out of the box yet. You could simply add a request header using an inline script:\n\n<pre>\ndef request(context, flow):\n    flow.request.headers[\"Proxy-Authorization\"] = [\"foo\"]\n</pre>\n\nAnd then `mitmproxy -s scriptfile`.\n\nLet me know if you have any further questions!\n\nCheers,\nMax\n","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/comments/37955387/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"mhils","id":1019198,"node_id":"MDQ6VXNlcjEwMTkxOTg=","avatar_url":"https://avatars.githubusercontent.com/u/1019198?v=4","gravatar_id":"","url":"https://api.github.com/users/mhils","html_url":"https://github.com/mhils","followers_url":"https://api.github.com/users/mhils/followers","following_url":"https://api.github.com/users/mhils/following{/other_user}","gists_url":"https://api.github.com/users/mhils/gists{/gist_id}","starred_url":"https://api.github.com/users/mhils/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mhils/subscriptions","organizations_url":"https://api.github.com/users/mhils/orgs","repos_url":"https://api.github.com/users/mhils/repos","events_url":"https://api.github.com/users/mhils/events{/privacy}","received_events_url":"https://api.github.com/users/mhils/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/comments/37958570","html_url":"https://github.com/mitmproxy/mitmproxy/issues/243#issuecomment-37958570","issue_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/243","id":37958570,"node_id":"MDEyOklzc3VlQ29tbWVudDM3OTU4NTcw","user":{"login":"stoarca","id":2142489,"node_id":"MDQ6VXNlcjIxNDI0ODk=","avatar_url":"https://avatars.githubusercontent.com/u/2142489?v=4","gravatar_id":"","url":"https://api.github.com/users/stoarca","html_url":"https://github.com/stoarca","followers_url":"https://api.github.com/users/stoarca/followers","following_url":"https://api.github.com/users/stoarca/following{/other_user}","gists_url":"https://api.github.com/users/stoarca/gists{/gist_id}","starred_url":"https://api.github.com/users/stoarca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stoarca/subscriptions","organizations_url":"https://api.github.com/users/stoarca/orgs","repos_url":"https://api.github.com/users/stoarca/repos","events_url":"https://api.github.com/users/stoarca/events{/privacy}","received_events_url":"https://api.github.com/users/stoarca/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2014-03-18T17:00:31Z","updated_at":"2014-03-18T17:00:31Z","body":"Thanks for the (incredibly quick!) response.\n\nI just tried running mitmproxy with the -F flag and with your script. Unfortunately, the HTTP request gets sent to proxy B containing just the path rather than hostname + path. For example, trying to get http://www.google.com is sent as \"GET /\" to proxy B, rather than \"GET http://www.google.com/\". Based on my (limited) knowledge, I think this happens before any authorization stuff. Is it possible there's a bug in the proxy forwarding? If so, can you point me to the file that would be most appropriate for a fix? I'm new to mitmproxy.\n","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/comments/37958570/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"stoarca","id":2142489,"node_id":"MDQ6VXNlcjIxNDI0ODk=","avatar_url":"https://avatars.githubusercontent.com/u/2142489?v=4","gravatar_id":"","url":"https://api.github.com/users/stoarca","html_url":"https://github.com/stoarca","followers_url":"https://api.github.com/users/stoarca/followers","following_url":"https://api.github.com/users/stoarca/following{/other_user}","gists_url":"https://api.github.com/users/stoarca/gists{/gist_id}","starred_url":"https://api.github.com/users/stoarca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stoarca/subscriptions","organizations_url":"https://api.github.com/users/stoarca/orgs","repos_url":"https://api.github.com/users/stoarca/repos","events_url":"https://api.github.com/users/stoarca/events{/privacy}","received_events_url":"https://api.github.com/users/stoarca/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/comments/37960987","html_url":"https://github.com/mitmproxy/mitmproxy/issues/243#issuecomment-37960987","issue_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/243","id":37960987,"node_id":"MDEyOklzc3VlQ29tbWVudDM3OTYwOTg3","user":{"login":"mhils","id":1019198,"node_id":"MDQ6VXNlcjEwMTkxOTg=","avatar_url":"https://avatars.githubusercontent.com/u/1019198?v=4","gravatar_id":"","url":"https://api.github.com/users/mhils","html_url":"https://github.com/mhils","followers_url":"https://api.github.com/users/mhils/followers","following_url":"https://api.github.com/users/mhils/following{/other_user}","gists_url":"https://api.github.com/users/mhils/gists{/gist_id}","starred_url":"https://api.github.com/users/mhils/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mhils/subscriptions","organizations_url":"https://api.github.com/users/mhils/orgs","repos_url":"https://api.github.com/users/mhils/repos","events_url":"https://api.github.com/users/mhils/events{/privacy}","received_events_url":"https://api.github.com/users/mhils/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2014-03-18T17:18:49Z","updated_at":"2014-03-18T17:18:49Z","body":"Hi @stoarca,\n\nthere have been significant changes to the proxy forwarding recently - could you please install mitmproxy and netlib from git master (-F confused some people and has been renamed to -U) and try again?\n\nInstall Instructions: https://gist.github.com/mhils/9315651\n\nThanks,\nMax\n","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/comments/37960987/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"mhils","id":1019198,"node_id":"MDQ6VXNlcjEwMTkxOTg=","avatar_url":"https://avatars.githubusercontent.com/u/1019198?v=4","gravatar_id":"","url":"https://api.github.com/users/mhils","html_url":"https://github.com/mhils","followers_url":"https://api.github.com/users/mhils/followers","following_url":"https://api.github.com/users/mhils/following{/other_user}","gists_url":"https://api.github.com/users/mhils/gists{/gist_id}","starred_url":"https://api.github.com/users/mhils/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mhils/subscriptions","organizations_url":"https://api.github.com/users/mhils/orgs","repos_url":"https://api.github.com/users/mhils/repos","events_url":"https://api.github.com/users/mhils/events{/privacy}","received_events_url":"https://api.github.com/users/mhils/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":103106061,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MTAzMTA2MDYx","url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/events/103106061","actor":{"login":"stoarca","id":2142489,"node_id":"MDQ6VXNlcjIxNDI0ODk=","avatar_url":"https://avatars.githubusercontent.com/u/2142489?v=4","gravatar_id":"","url":"https://api.github.com/users/stoarca","html_url":"https://github.com/stoarca","followers_url":"https://api.github.com/users/stoarca/followers","following_url":"https://api.github.com/users/stoarca/following{/other_user}","gists_url":"https://api.github.com/users/stoarca/gists{/gist_id}","starred_url":"https://api.github.com/users/stoarca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stoarca/subscriptions","organizations_url":"https://api.github.com/users/stoarca/orgs","repos_url":"https://api.github.com/users/stoarca/repos","events_url":"https://api.github.com/users/stoarca/events{/privacy}","received_events_url":"https://api.github.com/users/stoarca/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2014-03-18T17:18:49Z","performed_via_github_app":null},{"id":103106062,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDEwMzEwNjA2Mg==","url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/events/103106062","actor":{"login":"stoarca","id":2142489,"node_id":"MDQ6VXNlcjIxNDI0ODk=","avatar_url":"https://avatars.githubusercontent.com/u/2142489?v=4","gravatar_id":"","url":"https://api.github.com/users/stoarca","html_url":"https://github.com/stoarca","followers_url":"https://api.github.com/users/stoarca/followers","following_url":"https://api.github.com/users/stoarca/following{/other_user}","gists_url":"https://api.github.com/users/stoarca/gists{/gist_id}","starred_url":"https://api.github.com/users/stoarca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stoarca/subscriptions","organizations_url":"https://api.github.com/users/stoarca/orgs","repos_url":"https://api.github.com/users/stoarca/repos","events_url":"https://api.github.com/users/stoarca/events{/privacy}","received_events_url":"https://api.github.com/users/stoarca/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2014-03-18T17:18:49Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/comments/37969144","html_url":"https://github.com/mitmproxy/mitmproxy/issues/243#issuecomment-37969144","issue_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/243","id":37969144,"node_id":"MDEyOklzc3VlQ29tbWVudDM3OTY5MTQ0","user":{"login":"stoarca","id":2142489,"node_id":"MDQ6VXNlcjIxNDI0ODk=","avatar_url":"https://avatars.githubusercontent.com/u/2142489?v=4","gravatar_id":"","url":"https://api.github.com/users/stoarca","html_url":"https://github.com/stoarca","followers_url":"https://api.github.com/users/stoarca/followers","following_url":"https://api.github.com/users/stoarca/following{/other_user}","gists_url":"https://api.github.com/users/stoarca/gists{/gist_id}","starred_url":"https://api.github.com/users/stoarca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stoarca/subscriptions","organizations_url":"https://api.github.com/users/stoarca/orgs","repos_url":"https://api.github.com/users/stoarca/repos","events_url":"https://api.github.com/users/stoarca/events{/privacy}","received_events_url":"https://api.github.com/users/stoarca/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2014-03-18T18:20:30Z","updated_at":"2014-03-18T18:21:09Z","body":"Thanks, that seems to have done the trick.\n\nImporting the certificate into firefox and using the proxy loads http and https pages correctly. However, I am still observing some weird requests using mitmdump. Specifically, visiting https://httpbin.org, I am getting requests like this:\n\nCONNECT http://httpbin.org:443None\nGET https://< MY_PROXY>/\nCONNECT http://secure.gaug.es:443None\nGET https://< MY_PROXY>/track.gif?h[site_id]=4df5a7d9613f5d577c000001&h[resource]=https%3A%2F%2Fhttpbin.org%2F&h[referrer]=http%3A%2F%2Fhttpbin.org%2F&h[title]=httpbin(1)%3A%20HTTP%20Client%20Testing%20Service&h[user_agent]=Mozilla%2F5.0%20(X11%3B%20Ubuntu%3B%20Linux%20x86_64%3B%20rv%3A30.0)%20Gecko%2F20100101%20Firefox%2F30.0&h[unique]=0&h[unique_hour]=0&h[unique_day]=0&h[unique_month]=0&h[unique_year]=0&h[screenx]=2560&h[browserx]=852&h[browsery]=1533&timestamp=1395166684513\n\nNote the \"None\" at the end of the CONNECT lines, and the host in the GET lines. The page seems to be rendering correctly. Is this just a display bug?\n","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/comments/37969144/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"stoarca","id":2142489,"node_id":"MDQ6VXNlcjIxNDI0ODk=","avatar_url":"https://avatars.githubusercontent.com/u/2142489?v=4","gravatar_id":"","url":"https://api.github.com/users/stoarca","html_url":"https://github.com/stoarca","followers_url":"https://api.github.com/users/stoarca/followers","following_url":"https://api.github.com/users/stoarca/following{/other_user}","gists_url":"https://api.github.com/users/stoarca/gists{/gist_id}","starred_url":"https://api.github.com/users/stoarca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stoarca/subscriptions","organizations_url":"https://api.github.com/users/stoarca/orgs","repos_url":"https://api.github.com/users/stoarca/repos","events_url":"https://api.github.com/users/stoarca/events{/privacy}","received_events_url":"https://api.github.com/users/stoarca/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":103141842,"node_id":"MDExOkNsb3NlZEV2ZW50MTAzMTQxODQy","url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/events/103141842","actor":{"login":"mhils","id":1019198,"node_id":"MDQ6VXNlcjEwMTkxOTg=","avatar_url":"https://avatars.githubusercontent.com/u/1019198?v=4","gravatar_id":"","url":"https://api.github.com/users/mhils","html_url":"https://github.com/mhils","followers_url":"https://api.github.com/users/mhils/followers","following_url":"https://api.github.com/users/mhils/following{/other_user}","gists_url":"https://api.github.com/users/mhils/gists{/gist_id}","starred_url":"https://api.github.com/users/mhils/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mhils/subscriptions","organizations_url":"https://api.github.com/users/mhils/orgs","repos_url":"https://api.github.com/users/mhils/repos","events_url":"https://api.github.com/users/mhils/events{/privacy}","received_events_url":"https://api.github.com/users/mhils/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"closed","commit_id":"28f82d052dc35c9dcb0cdcc393728e5cfca1df34","commit_url":"https://api.github.com/repos/mitmproxy/mitmproxy/commits/28f82d052dc35c9dcb0cdcc393728e5cfca1df34","created_at":"2014-03-18T18:38:16Z","state_reason":null,"performed_via_github_app":null},{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/comments/37971500","html_url":"https://github.com/mitmproxy/mitmproxy/issues/243#issuecomment-37971500","issue_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/243","id":37971500,"node_id":"MDEyOklzc3VlQ29tbWVudDM3OTcxNTAw","user":{"login":"mhils","id":1019198,"node_id":"MDQ6VXNlcjEwMTkxOTg=","avatar_url":"https://avatars.githubusercontent.com/u/1019198?v=4","gravatar_id":"","url":"https://api.github.com/users/mhils","html_url":"https://github.com/mhils","followers_url":"https://api.github.com/users/mhils/followers","following_url":"https://api.github.com/users/mhils/following{/other_user}","gists_url":"https://api.github.com/users/mhils/gists{/gist_id}","starred_url":"https://api.github.com/users/mhils/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mhils/subscriptions","organizations_url":"https://api.github.com/users/mhils/orgs","repos_url":"https://api.github.com/users/mhils/repos","events_url":"https://api.github.com/users/mhils/events{/privacy}","received_events_url":"https://api.github.com/users/mhils/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2014-03-18T18:39:21Z","updated_at":"2014-03-18T18:39:31Z","body":"Hi there,\n\nthis is indeed a display bug - thanks for catching! The host is always included in mitmdump's display output so that you can identify the upstream server while having parallel CONNECTions.\n\nCheers,\nMax\n","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/comments/37971500/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"mhils","id":1019198,"node_id":"MDQ6VXNlcjEwMTkxOTg=","avatar_url":"https://avatars.githubusercontent.com/u/1019198?v=4","gravatar_id":"","url":"https://api.github.com/users/mhils","html_url":"https://github.com/mhils","followers_url":"https://api.github.com/users/mhils/followers","following_url":"https://api.github.com/users/mhils/following{/other_user}","gists_url":"https://api.github.com/users/mhils/gists{/gist_id}","starred_url":"https://api.github.com/users/mhils/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mhils/subscriptions","organizations_url":"https://api.github.com/users/mhils/orgs","repos_url":"https://api.github.com/users/mhils/repos","events_url":"https://api.github.com/users/mhils/events{/privacy}","received_events_url":"https://api.github.com/users/mhils/received_events","type":"User","user_view_type":"public","site_admin":false}}]