{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/2495","repository_url":"https://api.github.com/repos/mitmproxy/mitmproxy","labels_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/2495/labels{/name}","comments_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/2495/comments","events_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/2495/events","html_url":"https://github.com/mitmproxy/mitmproxy/issues/2495","id":247389264,"node_id":"MDU6SXNzdWUyNDczODkyNjQ=","number":2495,"title":"Keyerror in compat 0.17 - peer_address","user":{"login":"rabo-soc","id":6286151,"node_id":"MDQ6VXNlcjYyODYxNTE=","avatar_url":"https://avatars.githubusercontent.com/u/6286151?v=4","gravatar_id":"","url":"https://api.github.com/users/rabo-soc","html_url":"https://github.com/rabo-soc","followers_url":"https://api.github.com/users/rabo-soc/followers","following_url":"https://api.github.com/users/rabo-soc/following{/other_user}","gists_url":"https://api.github.com/users/rabo-soc/gists{/gist_id}","starred_url":"https://api.github.com/users/rabo-soc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rabo-soc/subscriptions","organizations_url":"https://api.github.com/users/rabo-soc/orgs","repos_url":"https://api.github.com/users/rabo-soc/repos","events_url":"https://api.github.com/users/rabo-soc/events{/privacy}","received_events_url":"https://api.github.com/users/rabo-soc/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":429899749,"node_id":"MDU6TGFiZWw0Mjk4OTk3NDk=","url":"https://api.github.com/repos/mitmproxy/mitmproxy/labels/area/core","name":"area/core","color":"fef2c0","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2017-08-02T13:30:08Z","updated_at":"2017-08-09T21:25:11Z","closed_at":"2017-08-09T21:25:11Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"I get this error when loading an old 0.17 dump file:\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"/usr/local/Cellar/mitmproxy/2.0.2/bin/mitmdump\", line 11, in <module>\r\n    load_entry_point('mitmproxy==2.0.2', 'console_scripts', 'mitmdump')()\r\n  File \"/usr/local/Cellar/mitmproxy/2.0.2/libexec/lib/python3.6/site-packages/mitmproxy/tools/main.py\", line 120, in mitmdump\r\n    master = dump.DumpMaster(dump_options, server)\r\n  File \"/usr/local/Cellar/mitmproxy/2.0.2/libexec/lib/python3.6/site-packages/mitmproxy/tools/dump.py\", line 55, in __init__\r\n    self.load_flows_file(options.rfile)\r\n  File \"/usr/local/Cellar/mitmproxy/2.0.2/libexec/lib/python3.6/site-packages/mitmproxy/master.py\", line 182, in load_flows_file\r\n    return self.load_flows(freader)\r\n  File \"/usr/local/Cellar/mitmproxy/2.0.2/libexec/lib/python3.6/site-packages/mitmproxy/master.py\", line 164, in load_flows\r\n    for i in fr.stream():\r\n  File \"/usr/local/Cellar/mitmproxy/2.0.2/libexec/lib/python3.6/site-packages/mitmproxy/io.py\", line 42, in stream\r\n    data = io_compat.migrate_flow(data)\r\n  File \"/usr/local/Cellar/mitmproxy/2.0.2/libexec/lib/python3.6/site-packages/mitmproxy/io_compat.py\", line 152, in migrate_flow\r\n    flow_data = converters[flow_version[:2]](flow_data)\r\n  File \"/usr/local/Cellar/mitmproxy/2.0.2/libexec/lib/python3.6/site-packages/mitmproxy/io_compat.py\", line 61, in convert_017_018\r\n    data[\"server_conn\"][\"ip_address\"] = data[\"server_conn\"].pop(\"peer_address\")\r\nKeyError: 'peer_address'\r\n```\r\n\r\n##### Steps to reproduce the problem:\r\n\r\n1. Create an outfile with mitmproxy 0.17\r\n2. Open with mitmdump 2.0.2\r\n3. Get a keyerror on \"peer_address\"\r\n\r\n\r\n##### Any other comments? What have you tried so far?\r\n\r\nWas told on slack to create an issue, however I can't supply the test files because they contain sensitive data.\r\n\r\n\r\n##### System information\r\n\r\n$ /usr/local/Cellar/mitmproxy/2.0.2/bin/mitmdump --version\r\nMitmproxy version: 2.0.2 (release version)\r\nPython version: 3.6.2\r\nPlatform: Darwin-16.7.0-x86_64-i386-64bit\r\nSSL version: OpenSSL 1.1.0f  25 May 2017\r\nMac version: 10.12.6 ('', '', '') x86_64\r\n","closed_by":{"login":"mhils","id":1019198,"node_id":"MDQ6VXNlcjEwMTkxOTg=","avatar_url":"https://avatars.githubusercontent.com/u/1019198?v=4","gravatar_id":"","url":"https://api.github.com/users/mhils","html_url":"https://github.com/mhils","followers_url":"https://api.github.com/users/mhils/followers","following_url":"https://api.github.com/users/mhils/following{/other_user}","gists_url":"https://api.github.com/users/mhils/gists{/gist_id}","starred_url":"https://api.github.com/users/mhils/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mhils/subscriptions","organizations_url":"https://api.github.com/users/mhils/orgs","repos_url":"https://api.github.com/users/mhils/repos","events_url":"https://api.github.com/users/mhils/events{/privacy}","received_events_url":"https://api.github.com/users/mhils/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/2495/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/2495/timeline","performed_via_github_app":null,"state_reason":"completed"}