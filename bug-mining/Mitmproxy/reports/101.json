{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/622","repository_url":"https://api.github.com/repos/mitmproxy/mitmproxy","labels_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/622/labels{/name}","comments_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/622/comments","events_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/622/events","html_url":"https://github.com/mitmproxy/mitmproxy/issues/622","id":86909948,"node_id":"MDU6SXNzdWU4NjkwOTk0OA==","number":622,"title":"Crashing - idna.py - UnicodeError: label empty or too long","user":{"login":"p4l4din","id":12746704,"node_id":"MDQ6VXNlcjEyNzQ2NzA0","avatar_url":"https://avatars.githubusercontent.com/u/12746704?v=4","gravatar_id":"","url":"https://api.github.com/users/p4l4din","html_url":"https://github.com/p4l4din","followers_url":"https://api.github.com/users/p4l4din/followers","following_url":"https://api.github.com/users/p4l4din/following{/other_user}","gists_url":"https://api.github.com/users/p4l4din/gists{/gist_id}","starred_url":"https://api.github.com/users/p4l4din/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/p4l4din/subscriptions","organizations_url":"https://api.github.com/users/p4l4din/orgs","repos_url":"https://api.github.com/users/p4l4din/repos","events_url":"https://api.github.com/users/p4l4din/events{/privacy}","received_events_url":"https://api.github.com/users/p4l4din/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2015-06-10T09:55:09Z","updated_at":"2015-06-12T04:01:05Z","closed_at":"2015-06-12T04:00:37Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"While scrolling down within the mitmproxy window using the arrow key it crashes. Repeatable multiple times when using mitmproxy to intercept the following site http://www.buddharadio.com.au \n\n``` python\nTraceback (most recent call last):\n  File \"/usr/local/lib/python2.7/dist-packages/libmproxy/console/__init__.py\", line 478, in run\n    self.loop.run()\n  File \"/usr/local/lib/python2.7/dist-packages/urwid/main_loop.py\", line 278, in run\n    self._run()\n  File \"/usr/local/lib/python2.7/dist-packages/urwid/main_loop.py\", line 375, in _run\n    self.event_loop.run()\n  File \"/usr/local/lib/python2.7/dist-packages/urwid/main_loop.py\", line 678, in run\n    self._loop()\n  File \"/usr/local/lib/python2.7/dist-packages/urwid/main_loop.py\", line 715, in _loop\n    self._watch_files[fd]()\n  File \"/usr/local/lib/python2.7/dist-packages/urwid/raw_display.py\", line 392, in <lambda>\n    event_loop, callback, self.get_available_raw_input())\n  File \"/usr/local/lib/python2.7/dist-packages/urwid/raw_display.py\", line 492, in parse_input\n    callback(processed, processed_codes)\n  File \"/usr/local/lib/python2.7/dist-packages/urwid/main_loop.py\", line 399, in _update\n    self.process_input(keys)\n  File \"/usr/local/lib/python2.7/dist-packages/urwid/main_loop.py\", line 496, in process_input\n    event, button, col, row, focus=True ):\n  File \"/usr/local/lib/python2.7/dist-packages/libmproxy/console/window.py\", line 32, in mouse_event\n    self.keypress(args[0], \"down\")\n  File \"/usr/local/lib/python2.7/dist-packages/libmproxy/console/window.py\", line 38, in keypress\n    k = super(self.__class__, self).keypress(size, k)\n  File \"/usr/local/lib/python2.7/dist-packages/urwid/container.py\", line 1128, in keypress\n    return self.body.keypress( (maxcol, remaining), key )\n  File \"/usr/local/lib/python2.7/dist-packages/libmproxy/console/flowlist.py\", line 358, in keypress\n    return urwid.ListBox.keypress(self, size, key)\n  File \"/usr/local/lib/python2.7/dist-packages/urwid/listbox.py\", line 1001, in keypress\n    return actual_key(self._keypress_down((maxcol, maxrow)))\n  File \"/usr/local/lib/python2.7/dist-packages/urwid/listbox.py\", line 1119, in _keypress_down\n    widget, pos = self.body.get_next(pos)\n  File \"/usr/local/lib/python2.7/dist-packages/libmproxy/console/flowlist.py\", line 260, in get_next\n    f = ConnectionItem(self.master, self.state, f, False) if f else None\n  File \"/usr/local/lib/python2.7/dist-packages/libmproxy/console/flowlist.py\", line 104, in __init__\n    w = self.get_text()\n  File \"/usr/local/lib/python2.7/dist-packages/libmproxy/console/flowlist.py\", line 111, in get_text\n    hostheader = self.master.showhost\n  File \"/usr/local/lib/python2.7/dist-packages/libmproxy/console/common.py\", line 375, in format_flow\n    req_url = f.request.pretty_url(hostheader=hostheader),\n  File \"/usr/local/lib/python2.7/dist-packages/libmproxy/protocol/http.py\", line 607, in pretty_url\n    self.pretty_host(hostheader),\n  File \"/usr/local/lib/python2.7/dist-packages/libmproxy/protocol/http.py\", line 599, in pretty_host\n    return host.encode(\"idna\")\n  File \"/usr/lib/python2.7/encodings/idna.py\", line 164, in encode\n    result.append(ToASCII(label))\n  File \"/usr/lib/python2.7/encodings/idna.py\", line 73, in ToASCII\n    raise UnicodeError(\"label empty or too long\")\nUnicodeError: label empty or too long\n\nmitmproxy has crashed!\n```\n","closed_by":{"login":"cortesi","id":22544,"node_id":"MDQ6VXNlcjIyNTQ0","avatar_url":"https://avatars.githubusercontent.com/u/22544?v=4","gravatar_id":"","url":"https://api.github.com/users/cortesi","html_url":"https://github.com/cortesi","followers_url":"https://api.github.com/users/cortesi/followers","following_url":"https://api.github.com/users/cortesi/following{/other_user}","gists_url":"https://api.github.com/users/cortesi/gists{/gist_id}","starred_url":"https://api.github.com/users/cortesi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cortesi/subscriptions","organizations_url":"https://api.github.com/users/cortesi/orgs","repos_url":"https://api.github.com/users/cortesi/repos","events_url":"https://api.github.com/users/cortesi/events{/privacy}","received_events_url":"https://api.github.com/users/cortesi/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/622/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/622/timeline","performed_via_github_app":null,"state_reason":"completed"}