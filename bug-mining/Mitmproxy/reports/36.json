{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/313","repository_url":"https://api.github.com/repos/mitmproxy/mitmproxy","labels_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/313/labels{/name}","comments_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/313/comments","events_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/313/events","html_url":"https://github.com/mitmproxy/mitmproxy/issues/313","id":38825845,"node_id":"MDU6SXNzdWUzODgyNTg0NQ==","number":313,"title":"Is it possible to chain two SSL proxies together ( upstream SSL proxy ) ?","user":{"login":"clarkewd","id":156377,"node_id":"MDQ6VXNlcjE1NjM3Nw==","avatar_url":"https://avatars.githubusercontent.com/u/156377?v=4","gravatar_id":"","url":"https://api.github.com/users/clarkewd","html_url":"https://github.com/clarkewd","followers_url":"https://api.github.com/users/clarkewd/followers","following_url":"https://api.github.com/users/clarkewd/following{/other_user}","gists_url":"https://api.github.com/users/clarkewd/gists{/gist_id}","starred_url":"https://api.github.com/users/clarkewd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clarkewd/subscriptions","organizations_url":"https://api.github.com/users/clarkewd/orgs","repos_url":"https://api.github.com/users/clarkewd/repos","events_url":"https://api.github.com/users/clarkewd/events{/privacy}","received_events_url":"https://api.github.com/users/clarkewd/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":79336502,"node_id":"MDU6TGFiZWw3OTMzNjUwMg==","url":"https://api.github.com/repos/mitmproxy/mitmproxy/labels/kind/bug","name":"kind/bug","color":"d93f0b","default":false,"description":null}],"state":"closed","locked":false,"assignee":{"login":"mhils","id":1019198,"node_id":"MDQ6VXNlcjEwMTkxOTg=","avatar_url":"https://avatars.githubusercontent.com/u/1019198?v=4","gravatar_id":"","url":"https://api.github.com/users/mhils","html_url":"https://github.com/mhils","followers_url":"https://api.github.com/users/mhils/followers","following_url":"https://api.github.com/users/mhils/following{/other_user}","gists_url":"https://api.github.com/users/mhils/gists{/gist_id}","starred_url":"https://api.github.com/users/mhils/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mhils/subscriptions","organizations_url":"https://api.github.com/users/mhils/orgs","repos_url":"https://api.github.com/users/mhils/repos","events_url":"https://api.github.com/users/mhils/events{/privacy}","received_events_url":"https://api.github.com/users/mhils/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"mhils","id":1019198,"node_id":"MDQ6VXNlcjEwMTkxOTg=","avatar_url":"https://avatars.githubusercontent.com/u/1019198?v=4","gravatar_id":"","url":"https://api.github.com/users/mhils","html_url":"https://github.com/mhils","followers_url":"https://api.github.com/users/mhils/followers","following_url":"https://api.github.com/users/mhils/following{/other_user}","gists_url":"https://api.github.com/users/mhils/gists{/gist_id}","starred_url":"https://api.github.com/users/mhils/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mhils/subscriptions","organizations_url":"https://api.github.com/users/mhils/orgs","repos_url":"https://api.github.com/users/mhils/repos","events_url":"https://api.github.com/users/mhils/events{/privacy}","received_events_url":"https://api.github.com/users/mhils/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/milestones/4","html_url":"https://github.com/mitmproxy/mitmproxy/milestone/4","labels_url":"https://api.github.com/repos/mitmproxy/mitmproxy/milestones/4/labels","id":673178,"node_id":"MDk6TWlsZXN0b25lNjczMTc4","number":4,"title":"0.11","description":"","creator":{"login":"mhils","id":1019198,"node_id":"MDQ6VXNlcjEwMTkxOTg=","avatar_url":"https://avatars.githubusercontent.com/u/1019198?v=4","gravatar_id":"","url":"https://api.github.com/users/mhils","html_url":"https://github.com/mhils","followers_url":"https://api.github.com/users/mhils/followers","following_url":"https://api.github.com/users/mhils/following{/other_user}","gists_url":"https://api.github.com/users/mhils/gists{/gist_id}","starred_url":"https://api.github.com/users/mhils/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mhils/subscriptions","organizations_url":"https://api.github.com/users/mhils/orgs","repos_url":"https://api.github.com/users/mhils/repos","events_url":"https://api.github.com/users/mhils/events{/privacy}","received_events_url":"https://api.github.com/users/mhils/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":43,"state":"closed","created_at":"2014-05-28T16:11:10Z","updated_at":"2014-11-11T10:21:37Z","due_on":null,"closed_at":"2014-11-11T10:21:10Z"},"comments":11,"created_at":"2014-07-26T20:37:11Z","updated_at":"2014-08-07T15:14:26Z","closed_at":"2014-07-27T01:28:28Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"Hi,\n\nI'm running the master branch (`mitmproxy 0.11`) on OS X 10.9. I've been attempting to selectively use a forward proxy to send some requests to `Charles Web Debugging Proxy`\n\nThis works well with non-SSL requests, setup is as follows:\n#### Step 1 - Configure Browser\n\nI have configured the browser to use `mitmproxy` via a PACfile that returns `PROXY localhost:8080`. I also trusted the root CA cert in my keychain. After starting `mitmproxy` with no parameters both HTTP and HTTPS requests work fine and yield a green browser bar.\n#### Step 2 - Attempt to use an upstream proxy\n\nCharles will allow both HTTP and SOCKS proxies\n\n<img src=\"http://puu.sh/ascYI/c09a342c6b.png\" />\n\nSo I re-launch mitm with an upstream proxy of `http://localhost:8888` - and HTTP traffic works but HTTPS requests give a SSL handshake error \n\nI have also attempted some of these options ( fyi to others - -F has changed to -U on mitmproxy 0.11 )\n\n```\nmitmproxy -U \"http://localhost:8888\"\nmitmproxy -U \"https://localhost:8888\"\nmitmproxy -U \"http://localhost:8888\" --no-upstream-cert\nmitmproxy -U \"https://localhost:8888\" --no-upstream-cert\nmitmproxy -U \"http://localhost:8888\" --cert-forward\nmitmproxy -U \"https://localhost:8888\" --cert-forward\n```\n\nNone of these options seem to make this work.\n\nI don't think I can try \"socks5://localhost:8888\" (yet) as it looks like socks support [will be added in the future](https://github.com/mitmproxy/mitmproxy/issues/211)\n\nI see that in the `0.11` there is something regarding a [new protocol](https://github.com/mitmproxy/mitmproxy/blob/master/libmproxy/console/__init__.py#L177) - `2https` - is that something that could be used to achieve this?\n\nAlso, i addition to adding the CA certificate to the system's keychain I have also tried using the same CA to sign SSL requests with both CharlesProxy and mitmproxy - but that did not seem to help either.\n\nAn upstream proxy that does not do the SSL \"mitm\" on the fly certificate signing would probably work, but again, I'm hoping to be able to use MITM to look at SSL requests and selectively forward some of the requests to another debugging tool.\n","closed_by":{"login":"mhils","id":1019198,"node_id":"MDQ6VXNlcjEwMTkxOTg=","avatar_url":"https://avatars.githubusercontent.com/u/1019198?v=4","gravatar_id":"","url":"https://api.github.com/users/mhils","html_url":"https://github.com/mhils","followers_url":"https://api.github.com/users/mhils/followers","following_url":"https://api.github.com/users/mhils/following{/other_user}","gists_url":"https://api.github.com/users/mhils/gists{/gist_id}","starred_url":"https://api.github.com/users/mhils/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mhils/subscriptions","organizations_url":"https://api.github.com/users/mhils/orgs","repos_url":"https://api.github.com/users/mhils/repos","events_url":"https://api.github.com/users/mhils/events{/privacy}","received_events_url":"https://api.github.com/users/mhils/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/313/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/313/timeline","performed_via_github_app":null,"state_reason":"completed"}