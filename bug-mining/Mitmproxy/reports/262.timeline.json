[{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/comments/341591746","html_url":"https://github.com/mitmproxy/mitmproxy/issues/2617#issuecomment-341591746","issue_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/2617","id":341591746,"node_id":"MDEyOklzc3VlQ29tbWVudDM0MTU5MTc0Ng==","user":{"login":"mhils","id":1019198,"node_id":"MDQ6VXNlcjEwMTkxOTg=","avatar_url":"https://avatars.githubusercontent.com/u/1019198?v=4","gravatar_id":"","url":"https://api.github.com/users/mhils","html_url":"https://github.com/mhils","followers_url":"https://api.github.com/users/mhils/followers","following_url":"https://api.github.com/users/mhils/following{/other_user}","gists_url":"https://api.github.com/users/mhils/gists{/gist_id}","starred_url":"https://api.github.com/users/mhils/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mhils/subscriptions","organizations_url":"https://api.github.com/users/mhils/orgs","repos_url":"https://api.github.com/users/mhils/repos","events_url":"https://api.github.com/users/mhils/events{/privacy}","received_events_url":"https://api.github.com/users/mhils/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-11-02T23:52:42Z","updated_at":"2017-11-02T23:52:42Z","body":"Thanks for tracking this down and submitting such a detailed report! :smiley: I'm quite busy this week, but will try to take a look as soon as possible.","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/comments/341591746/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"mhils","id":1019198,"node_id":"MDQ6VXNlcjEwMTkxOTg=","avatar_url":"https://avatars.githubusercontent.com/u/1019198?v=4","gravatar_id":"","url":"https://api.github.com/users/mhils","html_url":"https://github.com/mhils","followers_url":"https://api.github.com/users/mhils/followers","following_url":"https://api.github.com/users/mhils/following{/other_user}","gists_url":"https://api.github.com/users/mhils/gists{/gist_id}","starred_url":"https://api.github.com/users/mhils/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mhils/subscriptions","organizations_url":"https://api.github.com/users/mhils/orgs","repos_url":"https://api.github.com/users/mhils/repos","events_url":"https://api.github.com/users/mhils/events{/privacy}","received_events_url":"https://api.github.com/users/mhils/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":1324471170,"node_id":"MDE3OlJlbmFtZWRUaXRsZUV2ZW50MTMyNDQ3MTE3MA==","url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/events/1324471170","actor":{"login":"hpello","id":5550373,"node_id":"MDQ6VXNlcjU1NTAzNzM=","avatar_url":"https://avatars.githubusercontent.com/u/5550373?v=4","gravatar_id":"","url":"https://api.github.com/users/hpello","html_url":"https://github.com/hpello","followers_url":"https://api.github.com/users/hpello/followers","following_url":"https://api.github.com/users/hpello/following{/other_user}","gists_url":"https://api.github.com/users/hpello/gists{/gist_id}","starred_url":"https://api.github.com/users/hpello/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hpello/subscriptions","organizations_url":"https://api.github.com/users/hpello/orgs","repos_url":"https://api.github.com/users/hpello/repos","events_url":"https://api.github.com/users/hpello/events{/privacy}","received_events_url":"https://api.github.com/users/hpello/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"renamed","commit_id":null,"commit_url":null,"created_at":"2017-11-03T08:51:49Z","rename":{"from":"Bad value for flow address on successive requests","to":"Wrong value for flow address on successive requests"},"performed_via_github_app":null},{"id":1325133353,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDEzMjUxMzMzNTM=","url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/events/1325133353","actor":{"login":"mhils","id":1019198,"node_id":"MDQ6VXNlcjEwMTkxOTg=","avatar_url":"https://avatars.githubusercontent.com/u/1019198?v=4","gravatar_id":"","url":"https://api.github.com/users/mhils","html_url":"https://github.com/mhils","followers_url":"https://api.github.com/users/mhils/followers","following_url":"https://api.github.com/users/mhils/following{/other_user}","gists_url":"https://api.github.com/users/mhils/gists{/gist_id}","starred_url":"https://api.github.com/users/mhils/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mhils/subscriptions","organizations_url":"https://api.github.com/users/mhils/orgs","repos_url":"https://api.github.com/users/mhils/repos","events_url":"https://api.github.com/users/mhils/events{/privacy}","received_events_url":"https://api.github.com/users/mhils/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"c7d8b7d6a720246785e632f00b6854e9b30a2778","commit_url":"https://api.github.com/repos/mhils/mitmproxy/commits/c7d8b7d6a720246785e632f00b6854e9b30a2778","created_at":"2017-11-03T15:46:58Z","performed_via_github_app":null},{"actor":{"login":"mhils","id":1019198,"node_id":"MDQ6VXNlcjEwMTkxOTg=","avatar_url":"https://avatars.githubusercontent.com/u/1019198?v=4","gravatar_id":"","url":"https://api.github.com/users/mhils","html_url":"https://github.com/mhils","followers_url":"https://api.github.com/users/mhils/followers","following_url":"https://api.github.com/users/mhils/following{/other_user}","gists_url":"https://api.github.com/users/mhils/gists{/gist_id}","starred_url":"https://api.github.com/users/mhils/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mhils/subscriptions","organizations_url":"https://api.github.com/users/mhils/orgs","repos_url":"https://api.github.com/users/mhils/repos","events_url":"https://api.github.com/users/mhils/events{/privacy}","received_events_url":"https://api.github.com/users/mhils/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-11-03T15:52:16Z","updated_at":"2017-11-03T15:52:16Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/2619","repository_url":"https://api.github.com/repos/mitmproxy/mitmproxy","labels_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/2619/labels{/name}","comments_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/2619/comments","events_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/2619/events","html_url":"https://github.com/mitmproxy/mitmproxy/pull/2619","id":271026525,"node_id":"MDExOlB1bGxSZXF1ZXN0MTUwNTYzMjYy","number":2619,"title":"Fix #2617","user":{"login":"mhils","id":1019198,"node_id":"MDQ6VXNlcjEwMTkxOTg=","avatar_url":"https://avatars.githubusercontent.com/u/1019198?v=4","gravatar_id":"","url":"https://api.github.com/users/mhils","html_url":"https://github.com/mhils","followers_url":"https://api.github.com/users/mhils/followers","following_url":"https://api.github.com/users/mhils/following{/other_user}","gists_url":"https://api.github.com/users/mhils/gists{/gist_id}","starred_url":"https://api.github.com/users/mhils/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mhils/subscriptions","organizations_url":"https://api.github.com/users/mhils/orgs","repos_url":"https://api.github.com/users/mhils/repos","events_url":"https://api.github.com/users/mhils/events{/privacy}","received_events_url":"https://api.github.com/users/mhils/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2017-11-03T15:52:16Z","updated_at":"2017-11-06T10:23:20Z","closed_at":"2017-11-06T10:23:17Z","author_association":"MEMBER","type":null,"active_lock_reason":null,"draft":false,"repository":{"id":519832,"node_id":"MDEwOlJlcG9zaXRvcnk1MTk4MzI=","name":"mitmproxy","full_name":"mitmproxy/mitmproxy","private":false,"owner":{"login":"mitmproxy","id":4652787,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ2NTI3ODc=","avatar_url":"https://avatars.githubusercontent.com/u/4652787?v=4","gravatar_id":"","url":"https://api.github.com/users/mitmproxy","html_url":"https://github.com/mitmproxy","followers_url":"https://api.github.com/users/mitmproxy/followers","following_url":"https://api.github.com/users/mitmproxy/following{/other_user}","gists_url":"https://api.github.com/users/mitmproxy/gists{/gist_id}","starred_url":"https://api.github.com/users/mitmproxy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mitmproxy/subscriptions","organizations_url":"https://api.github.com/users/mitmproxy/orgs","repos_url":"https://api.github.com/users/mitmproxy/repos","events_url":"https://api.github.com/users/mitmproxy/events{/privacy}","received_events_url":"https://api.github.com/users/mitmproxy/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/mitmproxy/mitmproxy","description":"An interactive TLS-capable intercepting HTTP proxy for penetration testers and software developers.","fork":false,"url":"https://api.github.com/repos/mitmproxy/mitmproxy","forks_url":"https://api.github.com/repos/mitmproxy/mitmproxy/forks","keys_url":"https://api.github.com/repos/mitmproxy/mitmproxy/keys{/key_id}","collaborators_url":"https://api.github.com/repos/mitmproxy/mitmproxy/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/mitmproxy/mitmproxy/teams","hooks_url":"https://api.github.com/repos/mitmproxy/mitmproxy/hooks","issue_events_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/events{/number}","events_url":"https://api.github.com/repos/mitmproxy/mitmproxy/events","assignees_url":"https://api.github.com/repos/mitmproxy/mitmproxy/assignees{/user}","branches_url":"https://api.github.com/repos/mitmproxy/mitmproxy/branches{/branch}","tags_url":"https://api.github.com/repos/mitmproxy/mitmproxy/tags","blobs_url":"https://api.github.com/repos/mitmproxy/mitmproxy/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/mitmproxy/mitmproxy/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/mitmproxy/mitmproxy/git/refs{/sha}","trees_url":"https://api.github.com/repos/mitmproxy/mitmproxy/git/trees{/sha}","statuses_url":"https://api.github.com/repos/mitmproxy/mitmproxy/statuses/{sha}","languages_url":"https://api.github.com/repos/mitmproxy/mitmproxy/languages","stargazers_url":"https://api.github.com/repos/mitmproxy/mitmproxy/stargazers","contributors_url":"https://api.github.com/repos/mitmproxy/mitmproxy/contributors","subscribers_url":"https://api.github.com/repos/mitmproxy/mitmproxy/subscribers","subscription_url":"https://api.github.com/repos/mitmproxy/mitmproxy/subscription","commits_url":"https://api.github.com/repos/mitmproxy/mitmproxy/commits{/sha}","git_commits_url":"https://api.github.com/repos/mitmproxy/mitmproxy/git/commits{/sha}","comments_url":"https://api.github.com/repos/mitmproxy/mitmproxy/comments{/number}","issue_comment_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/comments{/number}","contents_url":"https://api.github.com/repos/mitmproxy/mitmproxy/contents/{+path}","compare_url":"https://api.github.com/repos/mitmproxy/mitmproxy/compare/{base}...{head}","merges_url":"https://api.github.com/repos/mitmproxy/mitmproxy/merges","archive_url":"https://api.github.com/repos/mitmproxy/mitmproxy/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/mitmproxy/mitmproxy/downloads","issues_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues{/number}","pulls_url":"https://api.github.com/repos/mitmproxy/mitmproxy/pulls{/number}","milestones_url":"https://api.github.com/repos/mitmproxy/mitmproxy/milestones{/number}","notifications_url":"https://api.github.com/repos/mitmproxy/mitmproxy/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/mitmproxy/mitmproxy/labels{/name}","releases_url":"https://api.github.com/repos/mitmproxy/mitmproxy/releases{/id}","deployments_url":"https://api.github.com/repos/mitmproxy/mitmproxy/deployments","created_at":"2010-02-16T04:10:13Z","updated_at":"2025-11-09T17:55:49Z","pushed_at":"2025-11-09T14:36:54Z","git_url":"git://github.com/mitmproxy/mitmproxy.git","ssh_url":"git@github.com:mitmproxy/mitmproxy.git","clone_url":"https://github.com/mitmproxy/mitmproxy.git","svn_url":"https://github.com/mitmproxy/mitmproxy","homepage":"https://mitmproxy.org","size":67124,"stargazers_count":41160,"watchers_count":41160,"language":"Python","has_issues":true,"has_projects":false,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":true,"forks_count":4359,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":387,"license":{"key":"mit","name":"MIT License","spdx_id":"MIT","url":"https://api.github.com/licenses/mit","node_id":"MDc6TGljZW5zZTEz"},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["debugging","http","http2","man-in-the-middle","mitmproxy","proxy","python","security","ssl","tls","websocket"],"visibility":"public","forks":4359,"open_issues":387,"watchers":41160,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/pulls/2619","html_url":"https://github.com/mitmproxy/mitmproxy/pull/2619","diff_url":"https://github.com/mitmproxy/mitmproxy/pull/2619.diff","patch_url":"https://github.com/mitmproxy/mitmproxy/pull/2619.patch","merged_at":"2017-11-06T10:23:17Z"},"body":"The issue in #2617 was that we assumed `server_conn.address` to be immutable, which does not hold true: If we never established an upstream connection in the first place, only the address is updated, breaking the HTTP layer's caching the initial server address.\r\n\r\nWe already have a test for restoring the old host, which did not catch this because we assumed connection immutability. ","reactions":{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/2619/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/2619/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/comments/341744616","html_url":"https://github.com/mitmproxy/mitmproxy/issues/2617#issuecomment-341744616","issue_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/2617","id":341744616,"node_id":"MDEyOklzc3VlQ29tbWVudDM0MTc0NDYxNg==","user":{"login":"mhils","id":1019198,"node_id":"MDQ6VXNlcjEwMTkxOTg=","avatar_url":"https://avatars.githubusercontent.com/u/1019198?v=4","gravatar_id":"","url":"https://api.github.com/users/mhils","html_url":"https://github.com/mhils","followers_url":"https://api.github.com/users/mhils/followers","following_url":"https://api.github.com/users/mhils/following{/other_user}","gists_url":"https://api.github.com/users/mhils/gists{/gist_id}","starred_url":"https://api.github.com/users/mhils/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mhils/subscriptions","organizations_url":"https://api.github.com/users/mhils/orgs","repos_url":"https://api.github.com/users/mhils/repos","events_url":"https://api.github.com/users/mhils/events{/privacy}","received_events_url":"https://api.github.com/users/mhils/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-11-03T15:53:04Z","updated_at":"2017-11-03T15:53:04Z","body":"Thanks again for the fantastic description. I just opened #2619, which fixes this problem. üç∞ üéâ ","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/comments/341744616/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"mhils","id":1019198,"node_id":"MDQ6VXNlcjEwMTkxOTg=","avatar_url":"https://avatars.githubusercontent.com/u/1019198?v=4","gravatar_id":"","url":"https://api.github.com/users/mhils","html_url":"https://github.com/mhils","followers_url":"https://api.github.com/users/mhils/followers","following_url":"https://api.github.com/users/mhils/following{/other_user}","gists_url":"https://api.github.com/users/mhils/gists{/gist_id}","starred_url":"https://api.github.com/users/mhils/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mhils/subscriptions","organizations_url":"https://api.github.com/users/mhils/orgs","repos_url":"https://api.github.com/users/mhils/repos","events_url":"https://api.github.com/users/mhils/events{/privacy}","received_events_url":"https://api.github.com/users/mhils/received_events","type":"User","user_view_type":"public","site_admin":false}},{"actor":{"login":"mhils","id":1019198,"node_id":"MDQ6VXNlcjEwMTkxOTg=","avatar_url":"https://avatars.githubusercontent.com/u/1019198?v=4","gravatar_id":"","url":"https://api.github.com/users/mhils","html_url":"https://github.com/mhils","followers_url":"https://api.github.com/users/mhils/followers","following_url":"https://api.github.com/users/mhils/following{/other_user}","gists_url":"https://api.github.com/users/mhils/gists{/gist_id}","starred_url":"https://api.github.com/users/mhils/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mhils/subscriptions","organizations_url":"https://api.github.com/users/mhils/orgs","repos_url":"https://api.github.com/users/mhils/repos","events_url":"https://api.github.com/users/mhils/events{/privacy}","received_events_url":"https://api.github.com/users/mhils/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-11-03T15:53:45Z","updated_at":"2017-11-03T15:53:45Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/2567","repository_url":"https://api.github.com/repos/mitmproxy/mitmproxy","labels_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/2567/labels{/name}","comments_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/2567/comments","events_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/2567/events","html_url":"https://github.com/mitmproxy/mitmproxy/issues/2567","id":257251978,"node_id":"MDU6SXNzdWUyNTcyNTE5Nzg=","number":2567,"title":"Receiving wrong request from mitmproxy in 'def request(flow):'","user":{"login":"gkumarpatel","id":11718778,"node_id":"MDQ6VXNlcjExNzE4Nzc4","avatar_url":"https://avatars.githubusercontent.com/u/11718778?v=4","gravatar_id":"","url":"https://api.github.com/users/gkumarpatel","html_url":"https://github.com/gkumarpatel","followers_url":"https://api.github.com/users/gkumarpatel/followers","following_url":"https://api.github.com/users/gkumarpatel/following{/other_user}","gists_url":"https://api.github.com/users/gkumarpatel/gists{/gist_id}","starred_url":"https://api.github.com/users/gkumarpatel/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gkumarpatel/subscriptions","organizations_url":"https://api.github.com/users/gkumarpatel/orgs","repos_url":"https://api.github.com/users/gkumarpatel/repos","events_url":"https://api.github.com/users/gkumarpatel/events{/privacy}","received_events_url":"https://api.github.com/users/gkumarpatel/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":466930397,"node_id":"MDU6TGFiZWw0NjY5MzAzOTc=","url":"https://api.github.com/repos/mitmproxy/mitmproxy/labels/kind/triage","name":"kind/triage","color":"006b75","default":false,"description":"Unclassified issues"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":7,"created_at":"2017-09-13T04:08:55Z","updated_at":"2017-11-06T07:20:51Z","closed_at":"2017-10-25T09:36:11Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"repository":{"id":519832,"node_id":"MDEwOlJlcG9zaXRvcnk1MTk4MzI=","name":"mitmproxy","full_name":"mitmproxy/mitmproxy","private":false,"owner":{"login":"mitmproxy","id":4652787,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ2NTI3ODc=","avatar_url":"https://avatars.githubusercontent.com/u/4652787?v=4","gravatar_id":"","url":"https://api.github.com/users/mitmproxy","html_url":"https://github.com/mitmproxy","followers_url":"https://api.github.com/users/mitmproxy/followers","following_url":"https://api.github.com/users/mitmproxy/following{/other_user}","gists_url":"https://api.github.com/users/mitmproxy/gists{/gist_id}","starred_url":"https://api.github.com/users/mitmproxy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mitmproxy/subscriptions","organizations_url":"https://api.github.com/users/mitmproxy/orgs","repos_url":"https://api.github.com/users/mitmproxy/repos","events_url":"https://api.github.com/users/mitmproxy/events{/privacy}","received_events_url":"https://api.github.com/users/mitmproxy/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/mitmproxy/mitmproxy","description":"An interactive TLS-capable intercepting HTTP proxy for penetration testers and software developers.","fork":false,"url":"https://api.github.com/repos/mitmproxy/mitmproxy","forks_url":"https://api.github.com/repos/mitmproxy/mitmproxy/forks","keys_url":"https://api.github.com/repos/mitmproxy/mitmproxy/keys{/key_id}","collaborators_url":"https://api.github.com/repos/mitmproxy/mitmproxy/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/mitmproxy/mitmproxy/teams","hooks_url":"https://api.github.com/repos/mitmproxy/mitmproxy/hooks","issue_events_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/events{/number}","events_url":"https://api.github.com/repos/mitmproxy/mitmproxy/events","assignees_url":"https://api.github.com/repos/mitmproxy/mitmproxy/assignees{/user}","branches_url":"https://api.github.com/repos/mitmproxy/mitmproxy/branches{/branch}","tags_url":"https://api.github.com/repos/mitmproxy/mitmproxy/tags","blobs_url":"https://api.github.com/repos/mitmproxy/mitmproxy/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/mitmproxy/mitmproxy/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/mitmproxy/mitmproxy/git/refs{/sha}","trees_url":"https://api.github.com/repos/mitmproxy/mitmproxy/git/trees{/sha}","statuses_url":"https://api.github.com/repos/mitmproxy/mitmproxy/statuses/{sha}","languages_url":"https://api.github.com/repos/mitmproxy/mitmproxy/languages","stargazers_url":"https://api.github.com/repos/mitmproxy/mitmproxy/stargazers","contributors_url":"https://api.github.com/repos/mitmproxy/mitmproxy/contributors","subscribers_url":"https://api.github.com/repos/mitmproxy/mitmproxy/subscribers","subscription_url":"https://api.github.com/repos/mitmproxy/mitmproxy/subscription","commits_url":"https://api.github.com/repos/mitmproxy/mitmproxy/commits{/sha}","git_commits_url":"https://api.github.com/repos/mitmproxy/mitmproxy/git/commits{/sha}","comments_url":"https://api.github.com/repos/mitmproxy/mitmproxy/comments{/number}","issue_comment_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/comments{/number}","contents_url":"https://api.github.com/repos/mitmproxy/mitmproxy/contents/{+path}","compare_url":"https://api.github.com/repos/mitmproxy/mitmproxy/compare/{base}...{head}","merges_url":"https://api.github.com/repos/mitmproxy/mitmproxy/merges","archive_url":"https://api.github.com/repos/mitmproxy/mitmproxy/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/mitmproxy/mitmproxy/downloads","issues_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues{/number}","pulls_url":"https://api.github.com/repos/mitmproxy/mitmproxy/pulls{/number}","milestones_url":"https://api.github.com/repos/mitmproxy/mitmproxy/milestones{/number}","notifications_url":"https://api.github.com/repos/mitmproxy/mitmproxy/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/mitmproxy/mitmproxy/labels{/name}","releases_url":"https://api.github.com/repos/mitmproxy/mitmproxy/releases{/id}","deployments_url":"https://api.github.com/repos/mitmproxy/mitmproxy/deployments","created_at":"2010-02-16T04:10:13Z","updated_at":"2025-11-09T17:55:49Z","pushed_at":"2025-11-09T14:36:54Z","git_url":"git://github.com/mitmproxy/mitmproxy.git","ssh_url":"git@github.com:mitmproxy/mitmproxy.git","clone_url":"https://github.com/mitmproxy/mitmproxy.git","svn_url":"https://github.com/mitmproxy/mitmproxy","homepage":"https://mitmproxy.org","size":67124,"stargazers_count":41160,"watchers_count":41160,"language":"Python","has_issues":true,"has_projects":false,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":true,"forks_count":4359,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":387,"license":{"key":"mit","name":"MIT License","spdx_id":"MIT","url":"https://api.github.com/licenses/mit","node_id":"MDc6TGljZW5zZTEz"},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["debugging","http","http2","man-in-the-middle","mitmproxy","proxy","python","security","ssl","tls","websocket"],"visibility":"public","forks":4359,"open_issues":387,"watchers":41160,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"body":"I am using `mitmdump` with python script to intercept https request and manipulate `flow.request.host`, `flow.request.scheme`, `flow.request.port` and `flow.request.path` with in `def request(flow):`. I have been able to achieve the same and get a response for the manipulated request. After first getting response for first request, my application send a second request. In the second request, instead of the host and port set by my application, I get the same previously manipulated host and port, that is `flow.request.host` and `flow.request.port` are from my last manipulated request but `flow.request.scheme` and `flow.request.path` are same as my application sets in second request.\r\nI am getting wrong request in `def request(flow):` for the second request. \r\n\r\nis there any keep-alive or caching thing that is manipulating my second request?\r\n\r\n```\r\nfrom mitmproxy import http\r\nimport sys\r\n    \r\ndef request(flow):\r\n    \tprint(\"\\nOriginal Request : \" + str(flow.request)+\"\\n\")\r\n    \tif flow.request.pretty_host.endswith(\"original.host.com\"):\r\n    \t\tflow.request.host = \"mock.host.com\"\r\n    \t\tflow.request.scheme = \"http\"\r\n    \t\tflow.request.port = 8081\r\n    \t\tflow.request.path = re.sub(r\"billing\",r\"moquer-0.0.2/mockbillingBinding\",flow.request.path)\r\n    \t\tprint(\"Manipulated Request : \" + str(flow.request)+\"\\n\")\r\n    def response(flow):\r\n    \tprint(\"Response : \" +str(flow.response)+\"\\n\")\r\n\r\n```\r\n\r\nEdited : After debugging the python script, found that MITMProxy is not able to **disconnect from client** before the second request arrives. I think I might have to some how disconnect from client. is there any api for disconnecting MITMProxy from client and also from the sever? Thoughts please.\r\n\r\n##### System information\r\nMitmproxy version: 2.0.2 (release version) \r\nPython version: 3.6.2\r\nPlatform: Darwin-16.7.0-x86_64-i386-64bit\r\nSSL version: OpenSSL 1.1.0f  25 May 2017\r\nMac version: 10.12.6 ('', '', '') x86_64","reactions":{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/2567/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/2567/timeline","performed_via_github_app":null,"state_reason":"completed"}},"event":"cross-referenced"},{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/comments/341769766","html_url":"https://github.com/mitmproxy/mitmproxy/issues/2617#issuecomment-341769766","issue_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/2617","id":341769766,"node_id":"MDEyOklzc3VlQ29tbWVudDM0MTc2OTc2Ng==","user":{"login":"hpello","id":5550373,"node_id":"MDQ6VXNlcjU1NTAzNzM=","avatar_url":"https://avatars.githubusercontent.com/u/5550373?v=4","gravatar_id":"","url":"https://api.github.com/users/hpello","html_url":"https://github.com/hpello","followers_url":"https://api.github.com/users/hpello/followers","following_url":"https://api.github.com/users/hpello/following{/other_user}","gists_url":"https://api.github.com/users/hpello/gists{/gist_id}","starred_url":"https://api.github.com/users/hpello/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hpello/subscriptions","organizations_url":"https://api.github.com/users/hpello/orgs","repos_url":"https://api.github.com/users/hpello/repos","events_url":"https://api.github.com/users/hpello/events{/privacy}","received_events_url":"https://api.github.com/users/hpello/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-11-03T17:17:24Z","updated_at":"2017-11-03T17:17:24Z","body":"No worries. Glad I could help :)\r\n\r\nThanks very much for the fix. I just tested it and I can confirm the problem does not appear anymore, with `curl` or with my client! üëç\r\n","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/comments/341769766/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"hpello","id":5550373,"node_id":"MDQ6VXNlcjU1NTAzNzM=","avatar_url":"https://avatars.githubusercontent.com/u/5550373?v=4","gravatar_id":"","url":"https://api.github.com/users/hpello","html_url":"https://github.com/hpello","followers_url":"https://api.github.com/users/hpello/followers","following_url":"https://api.github.com/users/hpello/following{/other_user}","gists_url":"https://api.github.com/users/hpello/gists{/gist_id}","starred_url":"https://api.github.com/users/hpello/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hpello/subscriptions","organizations_url":"https://api.github.com/users/hpello/orgs","repos_url":"https://api.github.com/users/hpello/repos","events_url":"https://api.github.com/users/hpello/events{/privacy}","received_events_url":"https://api.github.com/users/hpello/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/comments/341771101","html_url":"https://github.com/mitmproxy/mitmproxy/issues/2617#issuecomment-341771101","issue_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/2617","id":341771101,"node_id":"MDEyOklzc3VlQ29tbWVudDM0MTc3MTEwMQ==","user":{"login":"hpello","id":5550373,"node_id":"MDQ6VXNlcjU1NTAzNzM=","avatar_url":"https://avatars.githubusercontent.com/u/5550373?v=4","gravatar_id":"","url":"https://api.github.com/users/hpello","html_url":"https://github.com/hpello","followers_url":"https://api.github.com/users/hpello/followers","following_url":"https://api.github.com/users/hpello/following{/other_user}","gists_url":"https://api.github.com/users/hpello/gists{/gist_id}","starred_url":"https://api.github.com/users/hpello/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hpello/subscriptions","organizations_url":"https://api.github.com/users/hpello/orgs","repos_url":"https://api.github.com/users/hpello/repos","events_url":"https://api.github.com/users/hpello/events{/privacy}","received_events_url":"https://api.github.com/users/hpello/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-11-03T17:22:01Z","updated_at":"2017-11-03T17:22:01Z","body":"Oh by the way, when do you think the next release will be available?","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/comments/341771101/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"hpello","id":5550373,"node_id":"MDQ6VXNlcjU1NTAzNzM=","avatar_url":"https://avatars.githubusercontent.com/u/5550373?v=4","gravatar_id":"","url":"https://api.github.com/users/hpello","html_url":"https://github.com/hpello","followers_url":"https://api.github.com/users/hpello/followers","following_url":"https://api.github.com/users/hpello/following{/other_user}","gists_url":"https://api.github.com/users/hpello/gists{/gist_id}","starred_url":"https://api.github.com/users/hpello/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hpello/subscriptions","organizations_url":"https://api.github.com/users/hpello/orgs","repos_url":"https://api.github.com/users/hpello/repos","events_url":"https://api.github.com/users/hpello/events{/privacy}","received_events_url":"https://api.github.com/users/hpello/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":1327280090,"node_id":"MDExOkNsb3NlZEV2ZW50MTMyNzI4MDA5MA==","url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/events/1327280090","actor":{"login":"mhils","id":1019198,"node_id":"MDQ6VXNlcjEwMTkxOTg=","avatar_url":"https://avatars.githubusercontent.com/u/1019198?v=4","gravatar_id":"","url":"https://api.github.com/users/mhils","html_url":"https://github.com/mhils","followers_url":"https://api.github.com/users/mhils/followers","following_url":"https://api.github.com/users/mhils/following{/other_user}","gists_url":"https://api.github.com/users/mhils/gists{/gist_id}","starred_url":"https://api.github.com/users/mhils/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mhils/subscriptions","organizations_url":"https://api.github.com/users/mhils/orgs","repos_url":"https://api.github.com/users/mhils/repos","events_url":"https://api.github.com/users/mhils/events{/privacy}","received_events_url":"https://api.github.com/users/mhils/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"closed","commit_id":"c7d8b7d6a720246785e632f00b6854e9b30a2778","commit_url":"https://api.github.com/repos/mitmproxy/mitmproxy/commits/c7d8b7d6a720246785e632f00b6854e9b30a2778","created_at":"2017-11-06T10:23:20Z","state_reason":null,"performed_via_github_app":null},{"id":1327280093,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDEzMjcyODAwOTM=","url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/events/1327280093","actor":{"login":"mhils","id":1019198,"node_id":"MDQ6VXNlcjEwMTkxOTg=","avatar_url":"https://avatars.githubusercontent.com/u/1019198?v=4","gravatar_id":"","url":"https://api.github.com/users/mhils","html_url":"https://github.com/mhils","followers_url":"https://api.github.com/users/mhils/followers","following_url":"https://api.github.com/users/mhils/following{/other_user}","gists_url":"https://api.github.com/users/mhils/gists{/gist_id}","starred_url":"https://api.github.com/users/mhils/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mhils/subscriptions","organizations_url":"https://api.github.com/users/mhils/orgs","repos_url":"https://api.github.com/users/mhils/repos","events_url":"https://api.github.com/users/mhils/events{/privacy}","received_events_url":"https://api.github.com/users/mhils/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"4cb96dedd0143cf9b6278d3622457e1e485b3090","commit_url":"https://api.github.com/repos/mitmproxy/mitmproxy/commits/4cb96dedd0143cf9b6278d3622457e1e485b3090","created_at":"2017-11-06T10:23:20Z","performed_via_github_app":null}]