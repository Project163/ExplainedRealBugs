{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/267","repository_url":"https://api.github.com/repos/mitmproxy/mitmproxy","labels_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/267/labels{/name}","comments_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/267/comments","events_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/267/events","html_url":"https://github.com/mitmproxy/mitmproxy/issues/267","id":32201133,"node_id":"MDU6SXNzdWUzMjIwMTEzMw==","number":267,"title":"AttributeError: DummyReply instance has no attribute 'q'","user":{"login":"mlandauer","id":2221,"node_id":"MDQ6VXNlcjIyMjE=","avatar_url":"https://avatars.githubusercontent.com/u/2221?v=4","gravatar_id":"","url":"https://api.github.com/users/mlandauer","html_url":"https://github.com/mlandauer","followers_url":"https://api.github.com/users/mlandauer/followers","following_url":"https://api.github.com/users/mlandauer/following{/other_user}","gists_url":"https://api.github.com/users/mlandauer/gists{/gist_id}","starred_url":"https://api.github.com/users/mlandauer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mlandauer/subscriptions","organizations_url":"https://api.github.com/users/mlandauer/orgs","repos_url":"https://api.github.com/users/mlandauer/repos","events_url":"https://api.github.com/users/mlandauer/events{/privacy}","received_events_url":"https://api.github.com/users/mlandauer/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":79336502,"node_id":"MDU6TGFiZWw3OTMzNjUwMg==","url":"https://api.github.com/repos/mitmproxy/mitmproxy/labels/kind/bug","name":"kind/bug","color":"d93f0b","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2014-04-25T02:01:54Z","updated_at":"2014-05-15T12:16:22Z","closed_at":"2014-05-15T12:16:12Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"I'm seeing the following traceback occasionally on running mitmdump:\n\n```\nError in processing of request from 172.17.0.5:49138\nTraceback (most recent call last):\n  File \"/usr/local/lib/python2.7/dist-packages/netlib/tcp.py\", line 376, in request_thread\n    self.handle_connection(request, client_address)\n  File \"/usr/local/lib/python2.7/dist-packages/libmproxy/proxy.py\", line 549, in handle_connection\n    h.handle()\n  File \"/usr/local/lib/python2.7/dist-packages/libmproxy/proxy.py\", line 196, in handle\n    while self.handle_request(cc) and not cc.close:\n  File \"/usr/local/lib/python2.7/dist-packages/libmproxy/proxy.py\", line 268, in handle_request\n    response_reply = self.channel.ask(\"response\", response)\n  File \"/usr/local/lib/python2.7/dist-packages/libmproxy/controller.py\", line 52, in ask\n    g = m.reply.q.get(timeout=0.5)\nAttributeError: DummyReply instance has no attribute 'q'\n```\n\nThis is running on Ubuntu 12.04 with the following options\n\n```\nmitmdump -q -T -a -s mitmproxy/log_to_morph.py --confdir mitmproxy\n```\n\nFor completeness `log_to_morph.py` logs each http/https request to a local rest service and is like this:\n\n```\nimport urllib\nimport os\nfrom libmproxy.script import concurrent\n\n@concurrent\ndef response(context, flow):\n  url = os.environ['MORPH_URL'] + \"/connection_logs\"\n  params = urllib.urlencode({\n    'ip_address': flow.request.client_conn.address[0],\n    'method': flow.request.method,\n    'scheme': flow.request.scheme,\n    'host': flow.request.headers[\"Host\"][0],\n    'path': flow.request.path,\n    'request_size': len(flow.request.content),\n    'response_size': len(flow.response.content),\n    'key': os.environ['MITMPROXY_SECRET']\n  })\n  try:\n    s = urllib.urlopen(url, params)\n    s.close()\n  # If we can't contact the morph server still handle this request.\n  # If we let this exception pass up the chain the request would get dropped\n  except IOError, e:\n    print \"Error contacting Morph server:\", e\n```\n","closed_by":{"login":"mhils","id":1019198,"node_id":"MDQ6VXNlcjEwMTkxOTg=","avatar_url":"https://avatars.githubusercontent.com/u/1019198?v=4","gravatar_id":"","url":"https://api.github.com/users/mhils","html_url":"https://github.com/mhils","followers_url":"https://api.github.com/users/mhils/followers","following_url":"https://api.github.com/users/mhils/following{/other_user}","gists_url":"https://api.github.com/users/mhils/gists{/gist_id}","starred_url":"https://api.github.com/users/mhils/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mhils/subscriptions","organizations_url":"https://api.github.com/users/mhils/orgs","repos_url":"https://api.github.com/users/mhils/repos","events_url":"https://api.github.com/users/mhils/events{/privacy}","received_events_url":"https://api.github.com/users/mhils/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/267/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/267/timeline","performed_via_github_app":null,"state_reason":"completed"}