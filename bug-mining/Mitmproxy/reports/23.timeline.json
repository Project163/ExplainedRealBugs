[{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/comments/34487560","html_url":"https://github.com/mitmproxy/mitmproxy/issues/210#issuecomment-34487560","issue_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/210","id":34487560,"node_id":"MDEyOklzc3VlQ29tbWVudDM0NDg3NTYw","user":{"login":"mhils","id":1019198,"node_id":"MDQ6VXNlcjEwMTkxOTg=","avatar_url":"https://avatars.githubusercontent.com/u/1019198?v=4","gravatar_id":"","url":"https://api.github.com/users/mhils","html_url":"https://github.com/mhils","followers_url":"https://api.github.com/users/mhils/followers","following_url":"https://api.github.com/users/mhils/following{/other_user}","gists_url":"https://api.github.com/users/mhils/gists{/gist_id}","starred_url":"https://api.github.com/users/mhils/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mhils/subscriptions","organizations_url":"https://api.github.com/users/mhils/orgs","repos_url":"https://api.github.com/users/mhils/repos","events_url":"https://api.github.com/users/mhils/events{/privacy}","received_events_url":"https://api.github.com/users/mhils/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2014-02-07T18:53:12Z","updated_at":"2014-02-07T18:53:18Z","body":"Thanks for the extensive report. This is excellent! :thumbsup: \nI'll get to it later today or tomorrow. :-)\n","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/comments/34487560/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"mhils","id":1019198,"node_id":"MDQ6VXNlcjEwMTkxOTg=","avatar_url":"https://avatars.githubusercontent.com/u/1019198?v=4","gravatar_id":"","url":"https://api.github.com/users/mhils","html_url":"https://github.com/mhils","followers_url":"https://api.github.com/users/mhils/followers","following_url":"https://api.github.com/users/mhils/following{/other_user}","gists_url":"https://api.github.com/users/mhils/gists{/gist_id}","starred_url":"https://api.github.com/users/mhils/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mhils/subscriptions","organizations_url":"https://api.github.com/users/mhils/orgs","repos_url":"https://api.github.com/users/mhils/repos","events_url":"https://api.github.com/users/mhils/events{/privacy}","received_events_url":"https://api.github.com/users/mhils/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":91853584,"node_id":"MDEyOkxhYmVsZWRFdmVudDkxODUzNTg0","url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/events/91853584","actor":{"login":"cortesi","id":22544,"node_id":"MDQ6VXNlcjIyNTQ0","avatar_url":"https://avatars.githubusercontent.com/u/22544?v=4","gravatar_id":"","url":"https://api.github.com/users/cortesi","html_url":"https://github.com/cortesi","followers_url":"https://api.github.com/users/cortesi/followers","following_url":"https://api.github.com/users/cortesi/following{/other_user}","gists_url":"https://api.github.com/users/cortesi/gists{/gist_id}","starred_url":"https://api.github.com/users/cortesi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cortesi/subscriptions","organizations_url":"https://api.github.com/users/cortesi/orgs","repos_url":"https://api.github.com/users/cortesi/repos","events_url":"https://api.github.com/users/cortesi/events{/privacy}","received_events_url":"https://api.github.com/users/cortesi/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2014-02-07T23:51:37Z","label":{"name":"bug-confirmed","color":"e11d21"},"performed_via_github_app":null},{"id":91885140,"node_id":"MDExOkNsb3NlZEV2ZW50OTE4ODUxNDA=","url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/events/91885140","actor":{"login":"cortesi","id":22544,"node_id":"MDQ6VXNlcjIyNTQ0","avatar_url":"https://avatars.githubusercontent.com/u/22544?v=4","gravatar_id":"","url":"https://api.github.com/users/cortesi","html_url":"https://github.com/cortesi","followers_url":"https://api.github.com/users/cortesi/followers","following_url":"https://api.github.com/users/cortesi/following{/other_user}","gists_url":"https://api.github.com/users/cortesi/gists{/gist_id}","starred_url":"https://api.github.com/users/cortesi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cortesi/subscriptions","organizations_url":"https://api.github.com/users/cortesi/orgs","repos_url":"https://api.github.com/users/cortesi/repos","events_url":"https://api.github.com/users/cortesi/events{/privacy}","received_events_url":"https://api.github.com/users/cortesi/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"closed","commit_id":"a85974eaa88e1f63fda72e3df7a0ec3a0216a8e4","commit_url":"https://api.github.com/repos/mitmproxy/mitmproxy/commits/a85974eaa88e1f63fda72e3df7a0ec3a0216a8e4","created_at":"2014-02-08T04:22:54Z","state_reason":null,"performed_via_github_app":null},{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/comments/34871530","html_url":"https://github.com/mitmproxy/mitmproxy/issues/210#issuecomment-34871530","issue_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/210","id":34871530,"node_id":"MDEyOklzc3VlQ29tbWVudDM0ODcxNTMw","user":{"login":"lddubeau","id":1963493,"node_id":"MDQ6VXNlcjE5NjM0OTM=","avatar_url":"https://avatars.githubusercontent.com/u/1963493?v=4","gravatar_id":"","url":"https://api.github.com/users/lddubeau","html_url":"https://github.com/lddubeau","followers_url":"https://api.github.com/users/lddubeau/followers","following_url":"https://api.github.com/users/lddubeau/following{/other_user}","gists_url":"https://api.github.com/users/lddubeau/gists{/gist_id}","starred_url":"https://api.github.com/users/lddubeau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lddubeau/subscriptions","organizations_url":"https://api.github.com/users/lddubeau/orgs","repos_url":"https://api.github.com/users/lddubeau/repos","events_url":"https://api.github.com/users/lddubeau/events{/privacy}","received_events_url":"https://api.github.com/users/lddubeau/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2014-02-12T14:09:10Z","updated_at":"2014-02-12T14:09:10Z","body":"Thank you for acting quickly on this. I'm looking forward to the release that will incorporate the fix!\n\nHere's a workaround that might help those who are facing the same problem, need a solution now, and land on this page. The `--no-pop` argument allows working around the problem but only partially because it creates another problem. While replaying server responses, I ran into the (very predictable) problem of running the same request twice but expecting two different responses: with `--no-pop` the first response is replayed twice. I've worked around the problem created by `--no-pop` like this:\n- After recording interactions with the server, open the file in which interactions are saved and add a private field to all requests. It could be named `X-MyApp-Sequence:`. It gets a value which starts at 0 and is incremented for each subsequent request. Here's a partial bit of code that shows what I'm talking about:\n  \n  ```\n  freader = flow.FlowReader(inf)\n  fwriter = flow.FlowWriter(outf)\n  sequence = 0\n  for i in freader.stream():\n      i.request.headers[\"X-MyApp-Sequence\"] = [sequence]\n      sequence += 1\n      fwriter.add(i)\n  ```\n  \n  In the code above `inf` is the file into which the request and responses were recorded.\n- When replaying, use a filter (`-s foo.py`) that rewrites requests to add `X-MyApp-Sequence` and set it in the same fashion as above:\n  \n  ```\n  sequence = 0\n  def request(_context, flow):\n      global sequence  # pylint: disable=global-statement\n      flow.request.headers[\"X-MyApp-Sequence\"] = [sequence]\n      sequence += 1\n  ```\n- When replaying, pass the argument necessary to match the header: `--rheader X-MyApp-Sequence`.\n\nUsed in conjunction with `--no-pop`, this method of numbering requests completely works around the issue for me.\n\nI've also considered these solutions:\n- I've tried using the head of `master` (as of yesterday) to see if I could run that but I ran into issues. I decided that I should not try to diagnose the problems because what is on `master`'s head is not released yet nor does it appear to be a release candidate.\n- I considered trying to apply to 0.10 the fix that closed this issue but there seem to be a gap between `master`'s head and 0.10 that is such that this would not be a trivial matter.\n","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/comments/34871530/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"lddubeau","id":1963493,"node_id":"MDQ6VXNlcjE5NjM0OTM=","avatar_url":"https://avatars.githubusercontent.com/u/1963493?v=4","gravatar_id":"","url":"https://api.github.com/users/lddubeau","html_url":"https://github.com/lddubeau","followers_url":"https://api.github.com/users/lddubeau/followers","following_url":"https://api.github.com/users/lddubeau/following{/other_user}","gists_url":"https://api.github.com/users/lddubeau/gists{/gist_id}","starred_url":"https://api.github.com/users/lddubeau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lddubeau/subscriptions","organizations_url":"https://api.github.com/users/lddubeau/orgs","repos_url":"https://api.github.com/users/lddubeau/repos","events_url":"https://api.github.com/users/lddubeau/events{/privacy}","received_events_url":"https://api.github.com/users/lddubeau/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/comments/34875042","html_url":"https://github.com/mitmproxy/mitmproxy/issues/210#issuecomment-34875042","issue_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/210","id":34875042,"node_id":"MDEyOklzc3VlQ29tbWVudDM0ODc1MDQy","user":{"login":"mhils","id":1019198,"node_id":"MDQ6VXNlcjEwMTkxOTg=","avatar_url":"https://avatars.githubusercontent.com/u/1019198?v=4","gravatar_id":"","url":"https://api.github.com/users/mhils","html_url":"https://github.com/mhils","followers_url":"https://api.github.com/users/mhils/followers","following_url":"https://api.github.com/users/mhils/following{/other_user}","gists_url":"https://api.github.com/users/mhils/gists{/gist_id}","starred_url":"https://api.github.com/users/mhils/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mhils/subscriptions","organizations_url":"https://api.github.com/users/mhils/orgs","repos_url":"https://api.github.com/users/mhils/repos","events_url":"https://api.github.com/users/mhils/events{/privacy}","received_events_url":"https://api.github.com/users/mhils/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2014-02-12T14:46:34Z","updated_at":"2014-02-12T14:46:34Z","body":"Hi there,\n\n> I've tried using the head of master (as of yesterday) to see if I could run that but I ran into issues. I decided that I should not try to diagnose the problems because what is on master's head is not released yet nor does it appear to be a release candidate.\n\nGenerally speaking, the master branch _should_ always work, but is usually not tested beyond the test suite. That being said, if you encounter any issues with both mitmproxy and netlib on master, please help us and report them quickly in an informal issue. Feel free to leave the debugging part to us on these. External testing on master's head is already a great (and hopefully not too painful) contribution.\n\nThanks for your write-up!\n\nMax\n","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/comments/34875042/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"mhils","id":1019198,"node_id":"MDQ6VXNlcjEwMTkxOTg=","avatar_url":"https://avatars.githubusercontent.com/u/1019198?v=4","gravatar_id":"","url":"https://api.github.com/users/mhils","html_url":"https://github.com/mhils","followers_url":"https://api.github.com/users/mhils/followers","following_url":"https://api.github.com/users/mhils/following{/other_user}","gists_url":"https://api.github.com/users/mhils/gists{/gist_id}","starred_url":"https://api.github.com/users/mhils/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mhils/subscriptions","organizations_url":"https://api.github.com/users/mhils/orgs","repos_url":"https://api.github.com/users/mhils/repos","events_url":"https://api.github.com/users/mhils/events{/privacy}","received_events_url":"https://api.github.com/users/mhils/received_events","type":"User","user_view_type":"public","site_admin":false}}]