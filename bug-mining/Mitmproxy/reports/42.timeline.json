[{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/comments/49474586","html_url":"https://github.com/mitmproxy/mitmproxy/issues/308#issuecomment-49474586","issue_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/308","id":49474586,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NDc0NTg2","user":{"login":"mhils","id":1019198,"node_id":"MDQ6VXNlcjEwMTkxOTg=","avatar_url":"https://avatars.githubusercontent.com/u/1019198?v=4","gravatar_id":"","url":"https://api.github.com/users/mhils","html_url":"https://github.com/mhils","followers_url":"https://api.github.com/users/mhils/followers","following_url":"https://api.github.com/users/mhils/following{/other_user}","gists_url":"https://api.github.com/users/mhils/gists{/gist_id}","starred_url":"https://api.github.com/users/mhils/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mhils/subscriptions","organizations_url":"https://api.github.com/users/mhils/orgs","repos_url":"https://api.github.com/users/mhils/repos","events_url":"https://api.github.com/users/mhils/events{/privacy}","received_events_url":"https://api.github.com/users/mhils/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2014-07-18T20:12:52Z","updated_at":"2014-07-18T20:12:52Z","body":"Hi Jamie,\n\nthanks for the report. \n\n**Re 1:** This is indeed a bug. We should probably store the address we connected to on the server connection and use it for display. `hook_reconnect` should use this as well then.\n**Re 2:** Replacements are not a simple matter of the displayed string. We cannot operate on the same connection to the upstream proxy server (which is bound to a given host by the previous CONNECT request) and thereby need to open a new connection, possibly issue an additional CONNECT request (we're still talking to an upstream proxy which requires this for SSL), possibly establish an upstream SSL connection and then send the new request. Additionally, we need to restore the old connection afterwards as further requests from the same client connection should not be redirected as well.\n**Re 3:** Similarly, the replay feature has no support for upstream proxys yet. This one is tricky in terms of UX design, because the nature of the replay (replay to the proxy or speak directly with the target?) must be defined properly.\n\nIn summary, these changes must be applied carefully. For now, Replacements and Replay Mode are simply not supported in upstream/forward proxy mode.\n\nCheers,\nMax\n","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/comments/49474586/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"mhils","id":1019198,"node_id":"MDQ6VXNlcjEwMTkxOTg=","avatar_url":"https://avatars.githubusercontent.com/u/1019198?v=4","gravatar_id":"","url":"https://api.github.com/users/mhils","html_url":"https://github.com/mhils","followers_url":"https://api.github.com/users/mhils/followers","following_url":"https://api.github.com/users/mhils/following{/other_user}","gists_url":"https://api.github.com/users/mhils/gists{/gist_id}","starred_url":"https://api.github.com/users/mhils/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mhils/subscriptions","organizations_url":"https://api.github.com/users/mhils/orgs","repos_url":"https://api.github.com/users/mhils/repos","events_url":"https://api.github.com/users/mhils/events{/privacy}","received_events_url":"https://api.github.com/users/mhils/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":143254330,"node_id":"MDE3OlJlbmFtZWRUaXRsZUV2ZW50MTQzMjU0MzMw","url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/events/143254330","actor":{"login":"mhils","id":1019198,"node_id":"MDQ6VXNlcjEwMTkxOTg=","avatar_url":"https://avatars.githubusercontent.com/u/1019198?v=4","gravatar_id":"","url":"https://api.github.com/users/mhils","html_url":"https://github.com/mhils","followers_url":"https://api.github.com/users/mhils/followers","following_url":"https://api.github.com/users/mhils/following{/other_user}","gists_url":"https://api.github.com/users/mhils/gists{/gist_id}","starred_url":"https://api.github.com/users/mhils/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mhils/subscriptions","organizations_url":"https://api.github.com/users/mhils/orgs","repos_url":"https://api.github.com/users/mhils/repos","events_url":"https://api.github.com/users/mhils/events{/privacy}","received_events_url":"https://api.github.com/users/mhils/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"renamed","commit_id":null,"commit_url":null,"created_at":"2014-07-18T20:14:30Z","rename":{"from":"Confusing URLs and associated problems when using an upstream forwarding proxy","to":"Upstream Mode: Request Replacements and Replay do not work, URL is displayed incorrectly."},"performed_via_github_app":null},{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/comments/51612765","html_url":"https://github.com/mitmproxy/mitmproxy/issues/308#issuecomment-51612765","issue_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/308","id":51612765,"node_id":"MDEyOklzc3VlQ29tbWVudDUxNjEyNzY1","user":{"login":"mhils","id":1019198,"node_id":"MDQ6VXNlcjEwMTkxOTg=","avatar_url":"https://avatars.githubusercontent.com/u/1019198?v=4","gravatar_id":"","url":"https://api.github.com/users/mhils","html_url":"https://github.com/mhils","followers_url":"https://api.github.com/users/mhils/followers","following_url":"https://api.github.com/users/mhils/following{/other_user}","gists_url":"https://api.github.com/users/mhils/gists{/gist_id}","starred_url":"https://api.github.com/users/mhils/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mhils/subscriptions","organizations_url":"https://api.github.com/users/mhils/orgs","repos_url":"https://api.github.com/users/mhils/repos","events_url":"https://api.github.com/users/mhils/events{/privacy}","received_events_url":"https://api.github.com/users/mhils/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2014-08-08T14:56:07Z","updated_at":"2014-08-08T14:56:07Z","body":"Regarding **1**: the connected domain is now stored in server_connection.state. (a9e6121a08c745961992c9fd2b4e4593063192f5)\n","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/comments/51612765/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"mhils","id":1019198,"node_id":"MDQ6VXNlcjEwMTkxOTg=","avatar_url":"https://avatars.githubusercontent.com/u/1019198?v=4","gravatar_id":"","url":"https://api.github.com/users/mhils","html_url":"https://github.com/mhils","followers_url":"https://api.github.com/users/mhils/followers","following_url":"https://api.github.com/users/mhils/following{/other_user}","gists_url":"https://api.github.com/users/mhils/gists{/gist_id}","starred_url":"https://api.github.com/users/mhils/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mhils/subscriptions","organizations_url":"https://api.github.com/users/mhils/orgs","repos_url":"https://api.github.com/users/mhils/repos","events_url":"https://api.github.com/users/mhils/events{/privacy}","received_events_url":"https://api.github.com/users/mhils/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":150803212,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDE1MDgwMzIxMg==","url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/events/150803212","actor":{"login":"mhils","id":1019198,"node_id":"MDQ6VXNlcjEwMTkxOTg=","avatar_url":"https://avatars.githubusercontent.com/u/1019198?v=4","gravatar_id":"","url":"https://api.github.com/users/mhils","html_url":"https://github.com/mhils","followers_url":"https://api.github.com/users/mhils/followers","following_url":"https://api.github.com/users/mhils/following{/other_user}","gists_url":"https://api.github.com/users/mhils/gists{/gist_id}","starred_url":"https://api.github.com/users/mhils/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mhils/subscriptions","organizations_url":"https://api.github.com/users/mhils/orgs","repos_url":"https://api.github.com/users/mhils/repos","events_url":"https://api.github.com/users/mhils/events{/privacy}","received_events_url":"https://api.github.com/users/mhils/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"4d2109ef92d59e48c08279e3b59b7cc8385e02df","commit_url":"https://api.github.com/repos/mitmproxy/mitmproxy/commits/4d2109ef92d59e48c08279e3b59b7cc8385e02df","created_at":"2014-08-08T15:49:17Z","performed_via_github_app":null},{"id":150842427,"node_id":"MDExOkNsb3NlZEV2ZW50MTUwODQyNDI3","url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/events/150842427","actor":{"login":"mhils","id":1019198,"node_id":"MDQ6VXNlcjEwMTkxOTg=","avatar_url":"https://avatars.githubusercontent.com/u/1019198?v=4","gravatar_id":"","url":"https://api.github.com/users/mhils","html_url":"https://github.com/mhils","followers_url":"https://api.github.com/users/mhils/followers","following_url":"https://api.github.com/users/mhils/following{/other_user}","gists_url":"https://api.github.com/users/mhils/gists{/gist_id}","starred_url":"https://api.github.com/users/mhils/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mhils/subscriptions","organizations_url":"https://api.github.com/users/mhils/orgs","repos_url":"https://api.github.com/users/mhils/repos","events_url":"https://api.github.com/users/mhils/events{/privacy}","received_events_url":"https://api.github.com/users/mhils/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"closed","commit_id":"2e6a69828703778e713589ddcb983e39faf5d61e","commit_url":"https://api.github.com/repos/mitmproxy/mitmproxy/commits/2e6a69828703778e713589ddcb983e39faf5d61e","created_at":"2014-08-08T17:05:08Z","state_reason":null,"performed_via_github_app":null},{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/comments/51630124","html_url":"https://github.com/mitmproxy/mitmproxy/issues/308#issuecomment-51630124","issue_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/308","id":51630124,"node_id":"MDEyOklzc3VlQ29tbWVudDUxNjMwMTI0","user":{"login":"mhils","id":1019198,"node_id":"MDQ6VXNlcjEwMTkxOTg=","avatar_url":"https://avatars.githubusercontent.com/u/1019198?v=4","gravatar_id":"","url":"https://api.github.com/users/mhils","html_url":"https://github.com/mhils","followers_url":"https://api.github.com/users/mhils/followers","following_url":"https://api.github.com/users/mhils/following{/other_user}","gists_url":"https://api.github.com/users/mhils/gists{/gist_id}","starred_url":"https://api.github.com/users/mhils/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mhils/subscriptions","organizations_url":"https://api.github.com/users/mhils/orgs","repos_url":"https://api.github.com/users/mhils/repos","events_url":"https://api.github.com/users/mhils/events{/privacy}","received_events_url":"https://api.github.com/users/mhils/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2014-08-08T17:07:05Z","updated_at":"2014-08-08T17:07:05Z","body":"All three issues have been fixed. :smile: \n\nReplays are now context-sensitive, e.g. one can record some flows in mitmproxy's regular mode, then restart mitmproxy in upstream proxy mode and replay said requests to the upstream proxy.\n\nCheers,\nMax\n","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/comments/51630124/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"mhils","id":1019198,"node_id":"MDQ6VXNlcjEwMTkxOTg=","avatar_url":"https://avatars.githubusercontent.com/u/1019198?v=4","gravatar_id":"","url":"https://api.github.com/users/mhils","html_url":"https://github.com/mhils","followers_url":"https://api.github.com/users/mhils/followers","following_url":"https://api.github.com/users/mhils/following{/other_user}","gists_url":"https://api.github.com/users/mhils/gists{/gist_id}","starred_url":"https://api.github.com/users/mhils/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mhils/subscriptions","organizations_url":"https://api.github.com/users/mhils/orgs","repos_url":"https://api.github.com/users/mhils/repos","events_url":"https://api.github.com/users/mhils/events{/privacy}","received_events_url":"https://api.github.com/users/mhils/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":150843235,"node_id":"MDE1Ok1pbGVzdG9uZWRFdmVudDE1MDg0MzIzNQ==","url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/events/150843235","actor":{"login":"mhils","id":1019198,"node_id":"MDQ6VXNlcjEwMTkxOTg=","avatar_url":"https://avatars.githubusercontent.com/u/1019198?v=4","gravatar_id":"","url":"https://api.github.com/users/mhils","html_url":"https://github.com/mhils","followers_url":"https://api.github.com/users/mhils/followers","following_url":"https://api.github.com/users/mhils/following{/other_user}","gists_url":"https://api.github.com/users/mhils/gists{/gist_id}","starred_url":"https://api.github.com/users/mhils/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mhils/subscriptions","organizations_url":"https://api.github.com/users/mhils/orgs","repos_url":"https://api.github.com/users/mhils/repos","events_url":"https://api.github.com/users/mhils/events{/privacy}","received_events_url":"https://api.github.com/users/mhils/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"milestoned","commit_id":null,"commit_url":null,"created_at":"2014-08-08T17:07:09Z","milestone":{"title":"0.11"},"performed_via_github_app":null},{"id":150843277,"node_id":"MDEyOkxhYmVsZWRFdmVudDE1MDg0MzI3Nw==","url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/events/150843277","actor":{"login":"mhils","id":1019198,"node_id":"MDQ6VXNlcjEwMTkxOTg=","avatar_url":"https://avatars.githubusercontent.com/u/1019198?v=4","gravatar_id":"","url":"https://api.github.com/users/mhils","html_url":"https://github.com/mhils","followers_url":"https://api.github.com/users/mhils/followers","following_url":"https://api.github.com/users/mhils/following{/other_user}","gists_url":"https://api.github.com/users/mhils/gists{/gist_id}","starred_url":"https://api.github.com/users/mhils/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mhils/subscriptions","organizations_url":"https://api.github.com/users/mhils/orgs","repos_url":"https://api.github.com/users/mhils/repos","events_url":"https://api.github.com/users/mhils/events{/privacy}","received_events_url":"https://api.github.com/users/mhils/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2014-08-08T17:07:17Z","label":{"name":"enhancement","color":"009800"},"performed_via_github_app":null},{"id":150843293,"node_id":"MDEyOkxhYmVsZWRFdmVudDE1MDg0MzI5Mw==","url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/events/150843293","actor":{"login":"mhils","id":1019198,"node_id":"MDQ6VXNlcjEwMTkxOTg=","avatar_url":"https://avatars.githubusercontent.com/u/1019198?v=4","gravatar_id":"","url":"https://api.github.com/users/mhils","html_url":"https://github.com/mhils","followers_url":"https://api.github.com/users/mhils/followers","following_url":"https://api.github.com/users/mhils/following{/other_user}","gists_url":"https://api.github.com/users/mhils/gists{/gist_id}","starred_url":"https://api.github.com/users/mhils/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mhils/subscriptions","organizations_url":"https://api.github.com/users/mhils/orgs","repos_url":"https://api.github.com/users/mhils/repos","events_url":"https://api.github.com/users/mhils/events{/privacy}","received_events_url":"https://api.github.com/users/mhils/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2014-08-08T17:07:21Z","label":{"name":"feature request","color":"207de5"},"performed_via_github_app":null},{"id":150843302,"node_id":"MDEyOkxhYmVsZWRFdmVudDE1MDg0MzMwMg==","url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/events/150843302","actor":{"login":"mhils","id":1019198,"node_id":"MDQ6VXNlcjEwMTkxOTg=","avatar_url":"https://avatars.githubusercontent.com/u/1019198?v=4","gravatar_id":"","url":"https://api.github.com/users/mhils","html_url":"https://github.com/mhils","followers_url":"https://api.github.com/users/mhils/followers","following_url":"https://api.github.com/users/mhils/following{/other_user}","gists_url":"https://api.github.com/users/mhils/gists{/gist_id}","starred_url":"https://api.github.com/users/mhils/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mhils/subscriptions","organizations_url":"https://api.github.com/users/mhils/orgs","repos_url":"https://api.github.com/users/mhils/repos","events_url":"https://api.github.com/users/mhils/events{/privacy}","received_events_url":"https://api.github.com/users/mhils/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2014-08-08T17:07:22Z","label":{"name":"bug-confirmed","color":"f7c6c7"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/comments/54245618","html_url":"https://github.com/mitmproxy/mitmproxy/issues/308#issuecomment-54245618","issue_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/308","id":54245618,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MjQ1NjE4","user":{"login":"Jamie-Landeg-Jones","id":483894,"node_id":"MDQ6VXNlcjQ4Mzg5NA==","avatar_url":"https://avatars.githubusercontent.com/u/483894?v=4","gravatar_id":"","url":"https://api.github.com/users/Jamie-Landeg-Jones","html_url":"https://github.com/Jamie-Landeg-Jones","followers_url":"https://api.github.com/users/Jamie-Landeg-Jones/followers","following_url":"https://api.github.com/users/Jamie-Landeg-Jones/following{/other_user}","gists_url":"https://api.github.com/users/Jamie-Landeg-Jones/gists{/gist_id}","starred_url":"https://api.github.com/users/Jamie-Landeg-Jones/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Jamie-Landeg-Jones/subscriptions","organizations_url":"https://api.github.com/users/Jamie-Landeg-Jones/orgs","repos_url":"https://api.github.com/users/Jamie-Landeg-Jones/repos","events_url":"https://api.github.com/users/Jamie-Landeg-Jones/events{/privacy}","received_events_url":"https://api.github.com/users/Jamie-Landeg-Jones/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2014-09-03T02:43:47Z","updated_at":"2014-09-03T02:43:47Z","body":"Thanks for the original detailed reply explanations, and thanks for the updates and fixes!\n\nApologies for not responding sooner - for some reason I never got any email notification for any of the replies to this issue.  :( \n\nBut I'm very pleased to see this, I'll be updating my server shortly!\n\nCheers1\n","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/comments/54245618/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Jamie-Landeg-Jones","id":483894,"node_id":"MDQ6VXNlcjQ4Mzg5NA==","avatar_url":"https://avatars.githubusercontent.com/u/483894?v=4","gravatar_id":"","url":"https://api.github.com/users/Jamie-Landeg-Jones","html_url":"https://github.com/Jamie-Landeg-Jones","followers_url":"https://api.github.com/users/Jamie-Landeg-Jones/followers","following_url":"https://api.github.com/users/Jamie-Landeg-Jones/following{/other_user}","gists_url":"https://api.github.com/users/Jamie-Landeg-Jones/gists{/gist_id}","starred_url":"https://api.github.com/users/Jamie-Landeg-Jones/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Jamie-Landeg-Jones/subscriptions","organizations_url":"https://api.github.com/users/Jamie-Landeg-Jones/orgs","repos_url":"https://api.github.com/users/Jamie-Landeg-Jones/repos","events_url":"https://api.github.com/users/Jamie-Landeg-Jones/events{/privacy}","received_events_url":"https://api.github.com/users/Jamie-Landeg-Jones/received_events","type":"User","user_view_type":"public","site_admin":false}}]