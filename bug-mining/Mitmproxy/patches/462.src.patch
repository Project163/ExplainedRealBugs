diff --git a/CHANGELOG.md b/CHANGELOG.md
index 18b65ab3f..865390d8e 100644
--- a/CHANGELOG.md
+++ b/CHANGELOG.md
@@ -2,6 +2,8 @@
 
 ## Unreleased: mitmproxy next
 
+* Fix certificate generation for punycode domains.
+  ([#6382](https://github.com/mitmproxy/mitmproxy/pull/6382), @mhils)
 
 
 ## 24 September 2023: mitmproxy 10.1.0
diff --git a/mitmproxy/certs.py b/mitmproxy/certs.py
index 7477c61f7..a260cb981 100644
--- a/mitmproxy/certs.py
+++ b/mitmproxy/certs.py
@@ -270,6 +270,7 @@ def dummy_cert(
         try:
             ip = ipaddress.ip_address(x)
         except ValueError:
+            x = x.encode("idna").decode()
             ss.append(x509.DNSName(x))
         else:
             ss.append(x509.IPAddress(ip))
diff --git a/test/mitmproxy/test_certs.py b/test/mitmproxy/test_certs.py
index 815a84c61..e46245f1b 100644
--- a/test/mitmproxy/test_certs.py
+++ b/test/mitmproxy/test_certs.py
@@ -141,11 +141,17 @@ class TestDummyCert:
             tstore.default_privatekey,
             tstore.default_ca._cert,
             "foo.com",
-            ["one.com", "two.com", "*.three.com", "127.0.0.1"],
+            ["one.com", "two.com", "*.three.com", "127.0.0.1", "b√ºcher.example"],
             "Foo Ltd.",
         )
         assert r.cn == "foo.com"
-        assert r.altnames == ["one.com", "two.com", "*.three.com", "127.0.0.1"]
+        assert r.altnames == [
+            "one.com",
+            "two.com",
+            "*.three.com",
+            "xn--bcher-kva.example",
+            "127.0.0.1",
+        ]
         assert r.organization == "Foo Ltd."
 
         r = certs.dummy_cert(
