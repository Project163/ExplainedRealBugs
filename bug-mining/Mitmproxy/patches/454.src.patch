diff --git a/mitmproxy/connection.py b/mitmproxy/connection.py
index a6f9be704..20782057a 100644
--- a/mitmproxy/connection.py
+++ b/mitmproxy/connection.py
@@ -53,7 +53,7 @@ class Connection(serializable.SerializableDataclass, metaclass=ABCMeta):
     sockname: Optional[Address]
     """Our local `(ip, port)` tuple for this connection."""
 
-    state: ConnectionState
+    state: ConnectionState = field(default=ConnectionState.CLOSED, metadata={"serialize": False})
     """The current connection state."""
 
     # all connections have a unique id. While
@@ -172,8 +172,6 @@ class Client(Connection):
     sockname: Address
     """The local address we received this connection on."""
 
-    state: ConnectionState = field(default=ConnectionState.OPEN)
-
     mitmcert: Optional[certs.Cert] = None
     """
     The certificate used by mitmproxy to establish TLS with the client.
@@ -265,8 +263,6 @@ class Server(Connection):
     """The server's resolved `(ip, port)` tuple. Will be set during connection establishment."""
     sockname: Optional[Address] = None
 
-    state: ConnectionState = field(default=ConnectionState.CLOSED)
-
     timestamp_start: Optional[float] = None
     """*Timestamp:* TCP SYN sent."""
     timestamp_tcp_setup: Optional[float] = None
diff --git a/mitmproxy/coretypes/serializable.py b/mitmproxy/coretypes/serializable.py
index f3911b6c9..8bfd959d1 100644
--- a/mitmproxy/coretypes/serializable.py
+++ b/mitmproxy/coretypes/serializable.py
@@ -69,6 +69,8 @@ class SerializableDataclass(Serializable):
         fields = []
         # noinspection PyDataclass
         for field in dataclasses.fields(cls):
+            if field.metadata.get("serialize", True) is False:
+                continue
             if isinstance(field.type, str):
                 field.type = hints[field.name]
             fields.append(field)
diff --git a/mitmproxy/io/compat.py b/mitmproxy/io/compat.py
index 7b571ad90..466c14e03 100644
--- a/mitmproxy/io/compat.py
+++ b/mitmproxy/io/compat.py
@@ -414,6 +414,13 @@ def convert_18_19(data):
     return data
 
 
+def convert_19_20(data):
+    data["version"] = 20
+    data["client_conn"].pop("state", None)
+    data["server_conn"].pop("state", None)
+    return data
+
+
 def _convert_dict_keys(o: Any) -> Any:
     if isinstance(o, dict):
         return {strutils.always_str(k): _convert_dict_keys(v) for k, v in o.items()}
@@ -477,6 +484,7 @@ converters = {
     16: convert_16_17,
     17: convert_17_18,
     18: convert_18_19,
+    19: convert_19_20,
 }
 
 
diff --git a/mitmproxy/proxy/layers/quic.py b/mitmproxy/proxy/layers/quic.py
index 402f46a26..1b2c900ec 100644
--- a/mitmproxy/proxy/layers/quic.py
+++ b/mitmproxy/proxy/layers/quic.py
@@ -388,6 +388,7 @@ class QuicStreamLayer(layer.Layer):
             timestamp_start=time.time(),
             transport_protocol="tcp",
             proxy_mode=context.client.proxy_mode,
+            state=connection.ConnectionState.OPEN,
         )
 
         # unidirectional client streams are not fully open, set the appropriate state
@@ -1073,7 +1074,8 @@ class ClientQuicLayer(QuicLayer):
         if tls_clienthello.ignore_connection:
             self.conn = self.tunnel_connection = connection.Client(
                 peername=("ignore-conn", 0), sockname=("ignore-conn", 0),
-                transport_protocol="udp"
+                transport_protocol="udp",
+                state=connection.ConnectionState.OPEN,
             )
 
             # we need to replace the server layer as well, if there is one
diff --git a/mitmproxy/proxy/server.py b/mitmproxy/proxy/server.py
index b5ff406b1..24959848c 100644
--- a/mitmproxy/proxy/server.py
+++ b/mitmproxy/proxy/server.py
@@ -425,6 +425,7 @@ class LiveConnectionHandler(ConnectionHandler, metaclass=abc.ABCMeta):
             sockname=writer.get_extra_info("sockname"),
             timestamp_start=time.time(),
             proxy_mode=mode,
+            state=ConnectionState.OPEN,
         )
         context = Context(client, options)
         super().__init__(context)
diff --git a/mitmproxy/version.py b/mitmproxy/version.py
index b4c46ef15..6022c261d 100644
--- a/mitmproxy/version.py
+++ b/mitmproxy/version.py
@@ -7,7 +7,7 @@ MITMPROXY = "mitmproxy " + VERSION
 
 # Serialization format version. This is displayed nowhere, it just needs to be incremented by one
 # for each change in the file format.
-FLOW_FORMAT_VERSION = 19
+FLOW_FORMAT_VERSION = 20
 
 
 def get_dev_version() -> str:
diff --git a/test/mitmproxy/proxy/conftest.py b/test/mitmproxy/proxy/conftest.py
index 77713aa22..fe8f564b5 100644
--- a/test/mitmproxy/proxy/conftest.py
+++ b/test/mitmproxy/proxy/conftest.py
@@ -13,7 +13,9 @@ def tctx() -> context.Context:
     opts = options.Options()
     Proxyserver().load(opts)
     return context.Context(
-        connection.Client(peername=("client", 1234), sockname=("127.0.0.1", 8080), timestamp_start=1605699329), opts
+        connection.Client(peername=("client", 1234), sockname=("127.0.0.1", 8080),
+                          timestamp_start=1605699329, state=connection.ConnectionState.OPEN),
+        opts
     )
 
 
diff --git a/test/mitmproxy/proxy/layers/test_modes.py b/test/mitmproxy/proxy/layers/test_modes.py
index 43e1ed7e6..96ca863f5 100644
--- a/test/mitmproxy/proxy/layers/test_modes.py
+++ b/test/mitmproxy/proxy/layers/test_modes.py
@@ -4,7 +4,7 @@ import pytest
 from mitmproxy import dns
 
 from mitmproxy.addons.proxyauth import ProxyAuth
-from mitmproxy.connection import Client, Server
+from mitmproxy.connection import Client, ConnectionState, Server
 from mitmproxy.proxy import layers
 from mitmproxy.proxy.commands import (
     CloseConnection,
@@ -45,12 +45,12 @@ def test_upstream_https(tctx):
     curl -x localhost:8080 -k http://example.com
     """
     tctx1 = Context(
-        Client(peername=("client", 1234), sockname=("127.0.0.1", 8080), timestamp_start=1605699329),
+        Client(peername=("client", 1234), sockname=("127.0.0.1", 8080), timestamp_start=1605699329, state=ConnectionState.OPEN),
         copy.deepcopy(tctx.options),
     )
     tctx1.client.proxy_mode = ProxyMode.parse("upstream:https://example.mitmproxy.org:8081")
     tctx2 = Context(
-        Client(peername=("client", 4321), sockname=("127.0.0.1", 8080), timestamp_start=1605699329),
+        Client(peername=("client", 4321), sockname=("127.0.0.1", 8080), timestamp_start=1605699329, state=ConnectionState.OPEN),
         copy.deepcopy(tctx.options),
     )
     assert tctx2.client.proxy_mode == ProxyMode.parse("regular")
diff --git a/test/mitmproxy/test_connection.py b/test/mitmproxy/test_connection.py
index 5bc0aeeb9..300015c76 100644
--- a/test/mitmproxy/test_connection.py
+++ b/test/mitmproxy/test_connection.py
@@ -6,7 +6,9 @@ from mitmproxy.test.tflow import tclient_conn, tserver_conn
 
 class TestConnection:
     def test_basic(self):
-        c = Client(peername=("127.0.0.1", 52314), sockname=("127.0.0.1", 8080), timestamp_start=1607780791)
+        c = Client(peername=("127.0.0.1", 52314), sockname=("127.0.0.1", 8080),
+                   timestamp_start=1607780791,
+                   state=ConnectionState.OPEN)
         assert not c.tls_established
         c.timestamp_tls_setup = 1607780792
         assert c.tls_established
@@ -39,7 +41,7 @@ class TestClient:
         c.timestamp_tls_setup = 1607780791
         assert str(c)
         c.alpn = b"foo"
-        assert str(c) == "Client(127.0.0.1:52314, state=open, alpn=foo)"
+        assert str(c) == "Client(127.0.0.1:52314, state=closed, alpn=foo)"
 
     def test_state(self):
         c = tclient_conn()
