diff --git a/mitmproxy/connection.py b/mitmproxy/connection.py
index cbb732f54..190649ba2 100644
--- a/mitmproxy/connection.py
+++ b/mitmproxy/connection.py
@@ -91,6 +91,7 @@ class Connection(serializable.Serializable, metaclass=ABCMeta):
     For server connections, this value may also be set to `True`, which means "use `Server.address`".
     """
 
+    timestamp_start: Optional[float]
     timestamp_end: Optional[float] = None
     """*Timestamp:* Connection has been closed."""
     timestamp_tls_setup: Optional[float] = None
diff --git a/mitmproxy/proxy/layers/tcp.py b/mitmproxy/proxy/layers/tcp.py
index c6c75c583..4332d8415 100644
--- a/mitmproxy/proxy/layers/tcp.py
+++ b/mitmproxy/proxy/layers/tcp.py
@@ -70,7 +70,7 @@ class TCPLayer(layer.Layer):
         if self.flow:
             yield TcpStartHook(self.flow)
 
-        if not self.context.server.connected:
+        if self.context.server.timestamp_start is None:
             err = yield commands.OpenConnection(self.context.server)
             if err:
                 if self.flow:
diff --git a/test/mitmproxy/proxy/layers/test_tcp.py b/test/mitmproxy/proxy/layers/test_tcp.py
index 0c46e65b2..299aa9993 100644
--- a/test/mitmproxy/proxy/layers/test_tcp.py
+++ b/test/mitmproxy/proxy/layers/test_tcp.py
@@ -1,7 +1,6 @@
 import pytest
 
 from mitmproxy.proxy.commands import CloseConnection, OpenConnection, SendData
-from mitmproxy.connection import ConnectionState
 from mitmproxy.proxy.events import ConnectionClosed, DataReceived
 from mitmproxy.proxy.layers import tcp
 from mitmproxy.proxy.layers.tcp import TcpMessageInjected
@@ -19,7 +18,7 @@ def test_open_connection(tctx):
             << OpenConnection(tctx.server)
     )
 
-    tctx.server.state = ConnectionState.OPEN
+    tctx.server.timestamp_start = 1624544785
     assert (
             Playbook(tcp.TCPLayer(tctx, True))
             << None
diff --git a/test/mitmproxy/proxy/test_layer.py b/test/mitmproxy/proxy/test_layer.py
index 206daff77..98b959ef8 100644
--- a/test/mitmproxy/proxy/test_layer.py
+++ b/test/mitmproxy/proxy/test_layer.py
@@ -52,7 +52,8 @@ class TestLayer:
                 << commands.Log(" >! DataReceived(client, b'foo')", "debug")
                 >> tutils.reply(None, to=-3)
                 << commands.Log(" >> Reply(OpenConnection({'connection': Server("
-                                "{'id': '…rverid', 'address': None, 'state': <ConnectionState.OPEN: 3>})}),None)", "debug")
+                                "{'id': '…rverid', 'address': None, 'state': <ConnectionState.OPEN: 3>, "
+                                "'timestamp_start': 1624544785})}),None)", "debug")
                 << commands.Log(" !> DataReceived(client, b'foo')", "debug")
 
                 << commands.Log("baz", "info")
diff --git a/test/mitmproxy/proxy/tutils.py b/test/mitmproxy/proxy/tutils.py
index aad63d8ca..6e3efbe55 100644
--- a/test/mitmproxy/proxy/tutils.py
+++ b/test/mitmproxy/proxy/tutils.py
@@ -193,8 +193,10 @@ class Playbook:
                         setattr(x, name, value())
                 if isinstance(x, events.OpenConnectionCompleted) and not x.reply:
                     x.command.connection.state = ConnectionState.OPEN
+                    x.command.connection.timestamp_start = 1624544785
                 elif isinstance(x, events.ConnectionClosed):
                     x.connection.state &= ~ConnectionState.CAN_READ
+                    x.connection.timestamp_end = 1624544787
 
                 self.actual.append(x)
                 try:
