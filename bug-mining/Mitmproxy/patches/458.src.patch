diff --git a/CHANGELOG.md b/CHANGELOG.md
index 5c8f838e6..20f6a3ae9 100644
--- a/CHANGELOG.md
+++ b/CHANGELOG.md
@@ -34,6 +34,8 @@
   ([#6087](https://github.com/mitmproxy/mitmproxy/pull/6087), @sujaldev)
 * focus-follow shortcut will now work in flow view context too.
   ([#6088](https://github.com/mitmproxy/mitmproxy/pull/6088), @sujaldev)
+* Fix a bug where a server connection timeout would cause requests to be issued with a wrong SNI in reverse proxy mode.
+  ([#6148](https://github.com/mitmproxy/mitmproxy/pull/6148), @mhils)
 
 ### Breaking Changes
 
diff --git a/mitmproxy/proxy/layers/http/__init__.py b/mitmproxy/proxy/layers/http/__init__.py
index f5696f25a..dc3127385 100644
--- a/mitmproxy/proxy/layers/http/__init__.py
+++ b/mitmproxy/proxy/layers/http/__init__.py
@@ -1043,7 +1043,12 @@ class HttpLayer(layer.Layer):
                     self.mode == HTTPMode.transparent
                     and event.address == self.context.server.address
                 ):
-                    context.server.sni = self.context.client.sni or event.address[0]
+                    # reverse proxy mode may set self.context.server.sni, which takes precedence.
+                    context.server.sni = (
+                        self.context.server.sni
+                        or self.context.client.sni
+                        or event.address[0]
+                    )
                 else:
                     context.server.sni = event.address[0]
                 if context.server.transport_protocol == "tcp":
diff --git a/test/mitmproxy/proxy/layers/http/test_http.py b/test/mitmproxy/proxy/layers/http/test_http.py
index 0d8e638df..f579a065f 100644
--- a/test/mitmproxy/proxy/layers/http/test_http.py
+++ b/test/mitmproxy/proxy/layers/http/test_http.py
@@ -1432,6 +1432,29 @@ def test_transparent_sni(tctx):
     assert server().sni == "example.com"
 
 
+def test_reverse_sni(tctx):
+    """Test that we use the destination address as SNI in reverse mode."""
+    tctx.client.sni = "localhost"
+    tctx.server.address = ("192.0.2.42", 443)
+    tctx.server.tls = True
+    tctx.server.sni = "example.local"
+
+    flow = Placeholder(HTTPFlow)
+
+    server = Placeholder(Server)
+    assert (
+        Playbook(http.HttpLayer(tctx, HTTPMode.transparent))
+        >> DataReceived(tctx.client, b"GET / HTTP/1.1\r\n\r\n")
+        << http.HttpRequestHeadersHook(flow)
+        >> reply()
+        << http.HttpRequestHook(flow)
+        >> reply()
+        << OpenConnection(server)
+    )
+    assert server().address == ("192.0.2.42", 443)
+    assert server().sni == "example.local"
+
+
 def test_original_server_disconnects(tctx):
     """Test that we correctly handle the case where the initial server conn is just closed."""
     tctx.server.state = ConnectionState.OPEN
