diff --git a/mitmproxy/addons/tlsconfig.py b/mitmproxy/addons/tlsconfig.py
index 2cbe5d78d..a9cc1cb92 100644
--- a/mitmproxy/addons/tlsconfig.py
+++ b/mitmproxy/addons/tlsconfig.py
@@ -290,11 +290,18 @@ class TlsConfig:
         # Use upstream certificate if available.
         if conn_context.server.certificate_list:
             upstream_cert = conn_context.server.certificate_list[0]
-            if upstream_cert.cn:
-                altnames.append(upstream_cert.cn)
+            try:
+                # a bit clunky: access to .cn can fail, see https://github.com/mitmproxy/mitmproxy/issues/4713
+                if upstream_cert.cn:
+                    altnames.append(upstream_cert.cn)
+            except ValueError:
+                pass
             altnames.extend(upstream_cert.altnames)
-            if upstream_cert.organization:
-                organization = upstream_cert.organization
+            try:
+                if upstream_cert.organization:
+                    organization = upstream_cert.organization
+            except ValueError:
+                pass
 
         # Add SNI. If not available, try the server address as well.
         if conn_context.client.sni:
diff --git a/test/mitmproxy/addons/test_tlsconfig.py b/test/mitmproxy/addons/test_tlsconfig.py
index ea7fd375f..79e58ef59 100644
--- a/test/mitmproxy/addons/test_tlsconfig.py
+++ b/test/mitmproxy/addons/test_tlsconfig.py
@@ -84,6 +84,10 @@ class TestTlsConfig:
             entry = ta.get_cert(ctx)
             assert entry.cert.altnames == ["example.mitmproxy.org", "sni.example"]
 
+            with open(tdata.path("mitmproxy/data/invalid-subject.pem"), "rb") as f:
+                ctx.server.certificate_list = [certs.Cert.from_pem(f.read())]
+            assert ta.get_cert(ctx)  # does not raise
+
     def test_tls_clienthello(self):
         # only really testing for coverage here, there's no point in mirroring the individual conditions
         ta = tlsconfig.TlsConfig()
diff --git a/test/mitmproxy/data/invalid-subject.pem b/test/mitmproxy/data/invalid-subject.pem
new file mode 100644
index 000000000..591c369bf
--- /dev/null
+++ b/test/mitmproxy/data/invalid-subject.pem
@@ -0,0 +1,17 @@
+-----BEGIN CERTIFICATE-----
+MIICzDCCAomgAwIBAgIEZu2lSDALBgcqhkjOOAQDBQAwNjEQMA4GA1UEBhMHc2lh
+dmFzaDEQMA4GA1UEChMHc2lhdmFzaDEQMA4GA1UEAxMHc2lhdmFzaDAgFw0xNjAx
+MjUwNzI1MzBaGA8yMDU0MDUyNTA3MjUzMFowNjEQMA4GA1UEBhMHc2lhdmFzaDEQ
+MA4GA1UEChMHc2lhdmFzaDEQMA4GA1UEAxMHc2lhdmFzaDCCAbgwggEsBgcqhkjO
+OAQBMIIBHwKBgQD9f1OBHXUSKVLfSpwu7OTn9hG3UjzvRADDHj+AtlEmaUVdQCJR
++1k9jVj6v8X1ujD2y5tVbNeBO4AdNG/yZmC3a5lQpaSfn+gEexAiwk+7qdf+t8Yb
++DtX58aophUPBPuD9tPFHsMCNVQTWhaRMvZ1864rYdcq7/IiAxmd0UgBxwIVAJdg
+UI8VIwvMspK5gqLrhAvwWBz1AoGBAPfhoIXWmz3ey7yrXDa4V7l5lK+7+jrqgvlX
+TAs9B4JnUVlXjrrUWU/mcQcQgYC0SRZxI+hMKBYTt88JMozIpuE8FnqLVHyNKOCj
+rh4rs6Z1kW6jfwv6ITVi8ftiegEkO8yk8b6oUZCJqIPf4VrlnwaSi2ZegHtVJWQB
+TDv+z0kqA4GFAAKBgQDptGpQCqvLt7Quk0d9ufisfIGerdOS9Pot18EJc8OZ0A1F
+eWBSv7N2VnpRjP4UMqD4ReS+dap2RiM1v3+EtsY0u2yIS2ri57bxzHjDvm+YtlmA
+gyxA2do9KwR8upiyTId7Ks55CLCvVv1iNn3zVeARoEgsm4dRw3Oo0TEHbNAUIaMh
+MB8wHQYDVR0OBBYEFO6sMuXwh4G7by85KBSVGzKIaK5MMAsGByqGSM44BAMFAAMw
+ADAtAhUAkgnrEulmqvrigWIOfal0N3TXhGMCFEvzapY0lnykdjm7wQcSVxsDbhPV
+-----END CERTIFICATE-----
