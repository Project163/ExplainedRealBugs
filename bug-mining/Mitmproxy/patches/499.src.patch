diff --git a/CHANGELOG.md b/CHANGELOG.md
index 374e6f4bc..f804ca562 100644
--- a/CHANGELOG.md
+++ b/CHANGELOG.md
@@ -19,6 +19,8 @@
   ([#7576](https://github.com/mitmproxy/mitmproxy/pull/7576), @mhils, @cataggar)
 - Create content view for Socket.IO over WebSocket transport
   ([#7570](https://github.com/mitmproxy/mitmproxy/pull/7570), @DenizenB)
+- Fix a bug where mitmweb would crash when viewing flows with undefined headers.
+  ([#7595](https://github.com/mitmproxy/mitmproxy/pull/7595), @emanuele-em)
 
 ## 17 February 2025: mitmproxy 11.1.3
 
diff --git a/web/src/js/flow/utils.ts b/web/src/js/flow/utils.ts
index 5921137dc..4e5f34644 100644
--- a/web/src/js/flow/utils.ts
+++ b/web/src/js/flow/utils.ts
@@ -32,10 +32,12 @@ export class MessageUtils {
         const regexStr = regex.toString();
         if (!(regexStr in msg._headerLookups)) {
             let header: HTTPHeader | undefined = undefined;
-            for (let i = 0; i < msg.headers.length; i++) {
-                if (msg.headers[i][0].match(regex)) {
-                    header = msg.headers[i];
-                    break;
+            if (msg.headers) {
+                for (let i = 0; i < msg.headers.length; i++) {
+                    if (msg.headers[i][0].match(regex)) {
+                        header = msg.headers[i];
+                        break;
+                    }
                 }
             }
             msg._headerLookups[regexStr] = header ? header[1] : undefined;
