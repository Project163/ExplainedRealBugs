diff --git a/CHANGELOG.md b/CHANGELOG.md
index 895e0bf40..6de242ee6 100644
--- a/CHANGELOG.md
+++ b/CHANGELOG.md
@@ -25,8 +25,8 @@
   ([#6999](https://github.com/mitmproxy/mitmproxy/pull/6999), @lups2000)
 * Allow `typing.Sequence[str]` to be an editable option
   ([#7001](https://github.com/mitmproxy/mitmproxy/pull/7001), @errorxyz)
-* Add single reverse mode to new Capture Tab in mitmweb
-  ([#7012](https://github.com/mitmproxy/mitmproxy/pull/7012), @lups2000)
+* Add Host header to CONNECT requests.
+  ([#7021](https://github.com/mitmproxy/mitmproxy/pull/7021), @petsneakers)
 
 ## 12 June 2024: mitmproxy 10.3.1
 
diff --git a/mitmproxy/options.py b/mitmproxy/options.py
index 6ef97db44..e2624a426 100644
--- a/mitmproxy/options.py
+++ b/mitmproxy/options.py
@@ -149,6 +149,12 @@ class Options(optmanager.OptManager):
             True,
             "Enable/disable support for QUIC and HTTP/3. Enabled by default.",
         )
+        self.add_option(
+            "http_connect_send_host_header",
+            bool,
+            True,
+            "Include host header with CONNECT requests. Enabled by default.",
+        )
         self.add_option(
             "websocket",
             bool,
diff --git a/mitmproxy/proxy/layers/http/_upstream_proxy.py b/mitmproxy/proxy/layers/http/_upstream_proxy.py
index 3220cf930..f40b26ce6 100644
--- a/mitmproxy/proxy/layers/http/_upstream_proxy.py
+++ b/mitmproxy/proxy/layers/http/_upstream_proxy.py
@@ -53,6 +53,9 @@ class HttpUpstreamProxy(tunnel.TunnelLayer):
         authority = (
             self.conn.address[0].encode("idna") + f":{self.conn.address[1]}".encode()
         )
+        headers = http.Headers()
+        if self.context.options.http_connect_send_host_header:
+            headers.insert(0, b"Host", authority)
         flow.request = http.Request(
             host=self.conn.address[0],
             port=self.conn.address[1],
@@ -61,7 +64,7 @@ class HttpUpstreamProxy(tunnel.TunnelLayer):
             authority=authority,
             path=b"",
             http_version=b"HTTP/1.1",
-            headers=http.Headers(),
+            headers=headers,
             content=b"",
             trailers=None,
             timestamp_start=time.time(),
diff --git a/test/mitmproxy/addons/test_clientplayback.py b/test/mitmproxy/addons/test_clientplayback.py
index f9fc32ae9..b2f210606 100644
--- a/test/mitmproxy/addons/test_clientplayback.py
+++ b/test/mitmproxy/addons/test_clientplayback.py
@@ -126,7 +126,7 @@ async def test_playback(tdata, mode, concurrency):
 async def test_playback_https_upstream():
     async def handler(reader: asyncio.StreamReader, writer: asyncio.StreamWriter):
         conn_req = await reader.readuntil(b"\r\n\r\n")
-        assert conn_req == b"CONNECT address:22 HTTP/1.1\r\n\r\n"
+        assert conn_req == b"CONNECT address:22 HTTP/1.1\r\nHost: address:22\r\n\r\n"
         writer.write(b"HTTP/1.1 502 Bad Gateway\r\n\r\n")
         await writer.drain()
         assert not await reader.read()
diff --git a/test/mitmproxy/proxy/layers/http/test_http.py b/test/mitmproxy/proxy/layers/http/test_http.py
index 8759981dd..f55162ea1 100644
--- a/test/mitmproxy/proxy/layers/http/test_http.py
+++ b/test/mitmproxy/proxy/layers/http/test_http.py
@@ -64,16 +64,23 @@ def test_http_proxy(tctx):
 
 
 @pytest.mark.parametrize("strategy", ["lazy", "eager"])
-def test_https_proxy(strategy, tctx):
+@pytest.mark.parametrize("http_connect_send_host_header", [True, False])
+def test_https_proxy(strategy, http_connect_send_host_header, tctx):
     """Test a CONNECT request, followed by a HTTP GET /"""
     server = Placeholder(Server)
     flow = Placeholder(HTTPFlow)
     playbook = Playbook(http.HttpLayer(tctx, HTTPMode.regular))
     tctx.options.connection_strategy = strategy
+    tctx.options.http_connect_send_host_header = http_connect_send_host_header
 
     (
         playbook
-        >> DataReceived(tctx.client, b"CONNECT example.proxy:80 HTTP/1.1\r\n\r\n")
+        >> DataReceived(
+            tctx.client,
+            b"CONNECT example.proxy:80 HTTP/1.1"
+            + (b"\r\nHost: example.com:80" if http_connect_send_host_header else b"")
+            + b"\r\n\r\n",
+        )
         << http.HttpConnectHook(Placeholder())
         >> reply()
     )
@@ -135,7 +142,10 @@ def test_redirect(strategy, https_server, https_client, tctx, monkeypatch):
             flow.request.url = "http://redirected.site/"
 
     if https_client:
-        p >> DataReceived(tctx.client, b"CONNECT example.com:80 HTTP/1.1\r\n\r\n")
+        p >> DataReceived(
+            tctx.client,
+            b"CONNECT example.com:80 HTTP/1.1\r\nHost: example.com:80\r\n\r\n",
+        )
         if strategy == "eager":
             p << OpenConnection(Placeholder())
             p >> reply(None)
@@ -297,7 +307,10 @@ def test_disconnect_while_intercept(tctx):
 
     assert (
         Playbook(http.HttpLayer(tctx, HTTPMode.regular), hooks=False)
-        >> DataReceived(tctx.client, b"CONNECT example.com:80 HTTP/1.1\r\n\r\n")
+        >> DataReceived(
+            tctx.client,
+            b"CONNECT example.com:80 HTTP/1.1\r\nHost: example.com:80\r\n\r\n",
+        )
         << http.HttpConnectHook(Placeholder(HTTPFlow))
         >> reply()
         << OpenConnection(server1)
@@ -669,7 +682,8 @@ def test_server_unreachable(tctx, connect):
     playbook = Playbook(http.HttpLayer(tctx, HTTPMode.regular), hooks=False)
     if connect:
         playbook >> DataReceived(
-            tctx.client, b"CONNECT example.com:443 HTTP/1.1\r\n\r\n"
+            tctx.client,
+            b"CONNECT example.com:443 HTTP/1.1\r\nHost: example.com:443\r\n\r\n",
         )
     else:
         playbook >> DataReceived(
@@ -762,14 +776,20 @@ def test_upstream_proxy(tctx, redirect, domain, scheme):
     else:
         assert (
             playbook
-            >> DataReceived(tctx.client, b"CONNECT %s:443 HTTP/1.1\r\n\r\n" % domain)
+            >> DataReceived(
+                tctx.client,
+                b"CONNECT %s:443 HTTP/1.1\r\nHost: %s:443\r\n\r\n" % (domain, domain),
+            )
             << SendData(tctx.client, b"HTTP/1.1 200 Connection established\r\n\r\n")
             >> DataReceived(tctx.client, b"GET / HTTP/1.1\r\nHost: %s\r\n\r\n" % domain)
             << layer.NextLayerHook(Placeholder())
             >> reply_next_layer(lambda ctx: http.HttpLayer(ctx, HTTPMode.transparent))
             << OpenConnection(server)
             >> reply(None)
-            << SendData(server, b"CONNECT %s:443 HTTP/1.1\r\n\r\n" % domain)
+            << SendData(
+                server,
+                b"CONNECT %s:443 HTTP/1.1\r\nHost: %s:443\r\n\r\n" % (domain, domain),
+            )
             >> DataReceived(server, b"HTTP/1.1 200 Connection established\r\n\r\n")
             << SendData(server, b"GET / HTTP/1.1\r\nHost: %s\r\n\r\n" % domain)
         )
@@ -821,13 +841,18 @@ def test_upstream_proxy(tctx, redirect, domain, scheme):
     else:
         if redirect == "change-destination":
             playbook << SendData(
-                server2, b"CONNECT %s.test:443 HTTP/1.1\r\n\r\n" % domain
+                server2,
+                b"CONNECT %s.test:443 HTTP/1.1\r\nHost: %s.test:443\r\n\r\n"
+                % (domain, domain),
             )
             playbook >> DataReceived(
                 server2, b"HTTP/1.1 200 Connection established\r\n\r\n"
             )
         elif redirect == "change-proxy":
-            playbook << SendData(server2, b"CONNECT %s:443 HTTP/1.1\r\n\r\n" % domain)
+            playbook << SendData(
+                server2,
+                b"CONNECT %s:443 HTTP/1.1\r\nHost: %s:443\r\n\r\n" % (domain, domain),
+            )
             playbook >> DataReceived(
                 server2, b"HTTP/1.1 200 Connection established\r\n\r\n"
             )
@@ -871,7 +896,9 @@ def test_http_proxy_tcp(tctx, mode, close_first):
     playbook = Playbook(toplayer, hooks=False)
     assert (
         playbook
-        >> DataReceived(tctx.client, b"CONNECT example:443 HTTP/1.1\r\n\r\n")
+        >> DataReceived(
+            tctx.client, b"CONNECT example:443 HTTP/1.1\r\nHost: example:443\r\n\r\n"
+        )
         << SendData(tctx.client, b"HTTP/1.1 200 Connection established\r\n\r\n")
         >> DataReceived(tctx.client, b"this is not http")
         << layer.NextLayerHook(Placeholder())
@@ -883,7 +910,9 @@ def test_http_proxy_tcp(tctx, mode, close_first):
 
     playbook >> reply(None)
     if mode == "upstream":
-        playbook << SendData(server, b"CONNECT example:443 HTTP/1.1\r\n\r\n")
+        playbook << SendData(
+            server, b"CONNECT example:443 HTTP/1.1\r\nHost: example:443\r\n\r\n"
+        )
         playbook >> DataReceived(server, b"HTTP/1.1 200 Connection established\r\n\r\n")
 
     assert (
@@ -925,13 +954,17 @@ def test_proxy_chain(tctx, strategy):
     tctx.options.connection_strategy = strategy
     playbook = Playbook(http.HttpLayer(tctx, HTTPMode.regular), hooks=False)
 
-    playbook >> DataReceived(tctx.client, b"CONNECT proxy:8080 HTTP/1.1\r\n\r\n")
+    playbook >> DataReceived(
+        tctx.client, b"CONNECT proxy:8080 HTTP/1.1\r\nHost: proxy:8080\r\n\r\n"
+    )
     if strategy == "eager":
         playbook << OpenConnection(server)
         playbook >> reply(None)
     playbook << SendData(tctx.client, b"HTTP/1.1 200 Connection established\r\n\r\n")
 
-    playbook >> DataReceived(tctx.client, b"CONNECT second-proxy:8080 HTTP/1.1\r\n\r\n")
+    playbook >> DataReceived(
+        tctx.client, b"CONNECT second-proxy:8080 HTTP/1.1\r\nHost: proxy:8080\r\n\r\n"
+    )
     playbook << layer.NextLayerHook(Placeholder())
     playbook >> reply_next_layer(lambda ctx: http.HttpLayer(ctx, HTTPMode.transparent))
     playbook << SendData(
@@ -1190,7 +1223,9 @@ def test_kill_flow(tctx, when):
     playbook = Playbook(http.HttpLayer(tctx, HTTPMode.regular))
     assert (
         playbook
-        >> DataReceived(tctx.client, b"CONNECT example.com:80 HTTP/1.1\r\n\r\n")
+        >> DataReceived(
+            tctx.client, b"CONNECT example.com:80 HTTP/1.1\r\nHost: example:80\r\n\r\n"
+        )
         << http.HttpConnectHook(connect_flow)
     )
     if when == "http_connect":
@@ -1625,7 +1660,10 @@ def test_connect_more_newlines(tctx):
 
     assert (
         playbook
-        >> DataReceived(tctx.client, b"CONNECT example.com:80 HTTP/1.1\r\n\r\n\r\n")
+        >> DataReceived(
+            tctx.client,
+            b"CONNECT example.com:80 HTTP/1.1\r\nHost: example.com:80\r\n\r\n\r\n",
+        )
         << http.HttpConnectHook(Placeholder())
         >> reply()
         << OpenConnection(server)
@@ -1651,7 +1689,10 @@ def test_connect_unauthorized(tctx):
 
     assert (
         playbook
-        >> DataReceived(tctx.client, b"CONNECT example.com:80 HTTP/1.1\r\n\r\n")
+        >> DataReceived(
+            tctx.client,
+            b"CONNECT example.com:80 HTTP/1.1\r\nHost: example.com:80\r\n\r\n",
+        )
         << http.HttpConnectHook(flow)
         >> reply(side_effect=require_auth)
         << http.HttpConnectErrorHook(flow)
@@ -1665,6 +1706,7 @@ def test_connect_unauthorized(tctx):
         >> DataReceived(
             tctx.client,
             b"CONNECT example.com:80 HTTP/1.1\r\n"
+            b"Host: example.com:80\r\n"
             b"Proxy-Authorization: Basic dGVzdDp0ZXN0\r\n\r\n",
         )
         << http.HttpConnectHook(Placeholder(HTTPFlow))
diff --git a/web/src/js/ducks/_options_gen.ts b/web/src/js/ducks/_options_gen.ts
index cb1281064..10e39c957 100644
--- a/web/src/js/ducks/_options_gen.ts
+++ b/web/src/js/ducks/_options_gen.ts
@@ -26,6 +26,7 @@ export interface OptionsState {
     http2: boolean;
     http2_ping_keepalive: number;
     http3: boolean;
+    http_connect_send_host_header: boolean;
     ignore_hosts: string[];
     intercept: string | undefined;
     intercept_active: boolean;
@@ -123,6 +124,7 @@ export const defaultState: OptionsState = {
     http2: true,
     http2_ping_keepalive: 58,
     http3: true,
+    http_connect_send_host_header: true,
     ignore_hosts: [],
     intercept: undefined,
     intercept_active: false,
