diff --git a/src/main/java/com/helger/jcodemodel/JFieldVar.java b/src/main/java/com/helger/jcodemodel/JFieldVar.java
index c8e42a70..bf953a72 100644
--- a/src/main/java/com/helger/jcodemodel/JFieldVar.java
+++ b/src/main/java/com/helger/jcodemodel/JFieldVar.java
@@ -43,21 +43,27 @@ package com.helger.jcodemodel;
 import javax.annotation.Nonnull;
 import javax.annotation.Nullable;
 
+import com.helger.jcodemodel.util.JCValueEnforcer;
+
 /**
  * A field that can have a {@link JDocComment} associated with it
  */
 public class JFieldVar extends JVar implements IJDocCommentable
 {
-  private final JDefinedClass _owner;
+  private final JDefinedClass m_aOwnerClass;
 
   /**
    * javadoc comments for this JFieldVar
    */
-  private JDocComment _jdoc;
+  private JDocComment m_aJavaDoc;
 
   /**
    * JFieldVar constructor
    *
+   * @param aOwnerClass
+   *        The owning class.
+   * @param mods
+   *        modifiers to use
    * @param type
    *        Datatype of this variable
    * @param name
@@ -65,32 +71,35 @@ public class JFieldVar extends JVar implements IJDocCommentable
    * @param init
    *        Value to initialize this variable to
    */
-  protected JFieldVar (@Nonnull final JDefinedClass owner,
+  protected JFieldVar (@Nonnull final JDefinedClass aOwnerClass,
                        @Nonnull final JMods mods,
                        @Nonnull final AbstractJType type,
                        @Nonnull final String name,
                        @Nullable final IJExpression init)
   {
     super (mods, type, name, init);
-    this._owner = owner;
+    m_aOwnerClass = JCValueEnforcer.notNull (aOwnerClass, "OwnerClass");
   }
 
+  /**
+   * @return The owning class. Never <code>null</code>.
+   */
   @Nonnull
   public JDefinedClass owner ()
   {
-    return _owner;
+    return m_aOwnerClass;
   }
 
   @Override
   public void name (final String name)
   {
     // make sure that the new name is available
-    if (_owner.m_aFields.containsKey (name))
+    if (m_aOwnerClass.m_aFields.containsKey (name))
       throw new IllegalArgumentException ("name " + name + " is already in use");
-    final String oldName = name ();
+    final String sOldName = name ();
     super.name (name);
-    _owner.m_aFields.remove (oldName);
-    _owner.m_aFields.put (name, this);
+    m_aOwnerClass.m_aFields.remove (sOldName);
+    m_aOwnerClass.m_aFields.put (name, this);
   }
 
   /**
@@ -101,24 +110,27 @@ public class JFieldVar extends JVar implements IJDocCommentable
   @Nonnull
   public JDocComment javadoc ()
   {
-    if (_jdoc == null)
-      _jdoc = new JDocComment (_owner.owner ());
-    return _jdoc;
+    if (m_aJavaDoc == null)
+      m_aJavaDoc = new JDocComment (m_aOwnerClass.owner ());
+    return m_aJavaDoc;
   }
 
   @Override
   public void declare (@Nonnull final JFormatter f)
   {
-    if (_jdoc != null)
-      f.generable (_jdoc);
+    if (m_aJavaDoc != null)
+      f.generable (m_aJavaDoc);
     super.declare (f);
   }
 
   @Override
   public void generate (@Nonnull final JFormatter f)
   {
-    // Ensure the type is collected - see issue #30
-    f.type (_owner).print ('.');
+    if (false)
+    {
+      // Ensure the type is collected - see issue #30
+      f.type (m_aOwnerClass).print ('.');
+    }
     super.generate (f);
   }
 }
diff --git a/src/main/java/com/helger/jcodemodel/JFormatter.java b/src/main/java/com/helger/jcodemodel/JFormatter.java
index f283c52c..73489a91 100644
--- a/src/main/java/com/helger/jcodemodel/JFormatter.java
+++ b/src/main/java/com/helger/jcodemodel/JFormatter.java
@@ -298,7 +298,7 @@ public class JFormatter implements Closeable
       m_bAtBeginningOfLine = false;
     }
     else
-      if ((m_cLastChar != 0) && _needSpace (m_cLastChar, c))
+      if (m_cLastChar != 0 && _needSpace (m_cLastChar, c))
         m_aPW.print (' ');
   }
 
@@ -391,14 +391,18 @@ public class JFormatter implements Closeable
         }
         break;
       case COLLECTING:
-        final String shortName = aType.name ();
-        Usages usage = m_aCollectedReferences.get (shortName);
-        if (usage == null)
+        // Never import direct classes
+        if (!(aType instanceof JDirectClass))
         {
-          usage = new Usages ();
-          m_aCollectedReferences.put (shortName, usage);
+          final String sShortName = aType.name ();
+          Usages aUsage = m_aCollectedReferences.get (sShortName);
+          if (aUsage == null)
+          {
+            aUsage = new Usages ();
+            m_aCollectedReferences.put (sShortName, aUsage);
+          }
+          aUsage.addReferencedType (aType);
         }
-        usage.addReferencedType (aType);
         break;
     }
     return this;
diff --git a/src/main/java/com/helger/jcodemodel/JOpUnary.java b/src/main/java/com/helger/jcodemodel/JOpUnary.java
index a5bd8578..f3e42139 100644
--- a/src/main/java/com/helger/jcodemodel/JOpUnary.java
+++ b/src/main/java/com/helger/jcodemodel/JOpUnary.java
@@ -79,6 +79,10 @@ public class JOpUnary extends AbstractJExpressionImpl
     return m_aExpr;
   }
 
+  /**
+   * @return <code>true</code> if the operator comes first, <code>false</code>
+   *         if the operator comes last
+   */
   public boolean opFirst ()
   {
     return m_bOperatorComesFirst;
diff --git a/src/test/java/com/helger/jcodemodel/AbstractJTypeTest.java b/src/test/java/com/helger/jcodemodel/AbstractJTypeTest.java
index 2530a0a7..a1bd8d66 100644
--- a/src/test/java/com/helger/jcodemodel/AbstractJTypeTest.java
+++ b/src/test/java/com/helger/jcodemodel/AbstractJTypeTest.java
@@ -60,13 +60,13 @@ public final class AbstractJTypeTest
 {
   private static final class AssignmentTypes
   {
-    private final AbstractJClass _variable;
-    private final AbstractJClass _value;
+    private final AbstractJClass m_aVariable;
+    private final AbstractJClass m_aValue;
 
     public AssignmentTypes (final AbstractJClass aVariable, final AbstractJClass aValue)
     {
-      _variable = aVariable;
-      _value = aValue;
+      m_aVariable = aVariable;
+      m_aValue = aValue;
     }
   }
 
@@ -194,16 +194,16 @@ public final class AbstractJTypeTest
       }
       for (final AssignmentTypes assignment : _refreshAssignableTypes ())
       {
-        if (!assignment._value.equals (assignment._variable))
+        if (!assignment.m_aValue.equals (assignment.m_aVariable))
         {
-          _assertIsNotAssignable (_List.narrow (assignment._variable), _List.narrow (assignment._value));
+          _assertIsNotAssignable (_List.narrow (assignment.m_aVariable), _List.narrow (assignment.m_aValue));
         }
-        _assertIsAssignable (_List.narrow (assignment._variable.wildcard ()), _List.narrow (assignment._value));
-        _assertIsAssignable (_List.narrow (assignment._variable.wildcard ()),
-                             _List.narrow (assignment._value.wildcard ()));
-        _assertIsAssignable (_List.narrow (assignment._value.wildcardSuper ()), _List.narrow (assignment._variable));
-        _assertIsAssignable (_List.narrow (assignment._value.wildcardSuper ()),
-                             _List.narrow (assignment._variable.wildcardSuper ()));
+        _assertIsAssignable (_List.narrow (assignment.m_aVariable.wildcard ()), _List.narrow (assignment.m_aValue));
+        _assertIsAssignable (_List.narrow (assignment.m_aVariable.wildcard ()),
+                             _List.narrow (assignment.m_aValue.wildcard ()));
+        _assertIsAssignable (_List.narrow (assignment.m_aValue.wildcardSuper ()), _List.narrow (assignment.m_aVariable));
+        _assertIsAssignable (_List.narrow (assignment.m_aValue.wildcardSuper ()),
+                             _List.narrow (assignment.m_aVariable.wildcardSuper ()));
       }
     }
   }
diff --git a/src/test/java/com/helger/jcodemodel/AnnotationUseFuncTest.java b/src/test/java/com/helger/jcodemodel/AnnotationUseFuncTest.java
index 158a6997..0622c26c 100644
--- a/src/test/java/com/helger/jcodemodel/AnnotationUseFuncTest.java
+++ b/src/test/java/com/helger/jcodemodel/AnnotationUseFuncTest.java
@@ -40,21 +40,15 @@
  */
 package com.helger.jcodemodel;
 
+import static org.junit.Assert.assertEquals;
+
 import java.lang.annotation.Retention;
 import java.lang.annotation.RetentionPolicy;
 import java.lang.annotation.Target;
 
 import org.junit.Test;
 
-import com.helger.jcodemodel.IJAnnotationWriter;
-import com.helger.jcodemodel.JAnnotationArrayMember;
-import com.helger.jcodemodel.JAnnotationUse;
-import com.helger.jcodemodel.JCodeModel;
-import com.helger.jcodemodel.JDefinedClass;
-import com.helger.jcodemodel.JEnumConstant;
-import com.helger.jcodemodel.JFieldVar;
-import com.helger.jcodemodel.JMod;
-import com.helger.jcodemodel.writer.SingleStreamCodeWriter;
+import com.helger.jcodemodel.util.CodeModelTestsHelper;
 
 /**
  * A test program for the annotation use features Note: Not all the generated
@@ -89,7 +83,7 @@ public final class AnnotationUseFuncTest
    * import java.lang.annotation.RetentionPolicy;
    * import java.lang.annotation.Target;
    * import com.helger.jcodemodel.tests.AnnotationUseTest;
-   * 
+   *
    * &#064;Retention (value = Test.Iamenum.GOOD, value1 = RetentionPolicy.RUNTIME)
    * &#064;AnnotationUseTest.XmlElement (ns = &quot;##default&quot;, value = &quot;foobar&quot;)
    * public class Test
@@ -99,21 +93,18 @@ public final class AnnotationUseFuncTest
    *               names = { &quot;Bob&quot;, &quot;Rob&quot;, &quot;Ted&quot; },
    *               namesno = { 4, 5, 6 },
    *               values = { @Target (type = java.lang.Integer.class), @Target (type = java.lang.Float.class) },
-   *               foo = @Target (junk = 7))
+   *               foo = @Target (junk = 7) )
    *   private double y;
-   * 
+   *
    *   public void foo ()
    *   {}
-   * 
+   *
    *   public enum Iamenum
    *   {
-   *     GOOD,
-   *     BAD;
+   *    GOOD,
+   *    BAD;
    *   }
    * }
-   * 
-   *
-   *
    * </pre>
    */
   @Test
@@ -133,7 +124,7 @@ public final class AnnotationUseFuncTest
     final JEnumConstant ec = enumcls.enumConstant ("GOOD");
     final JEnumConstant ec1 = enumcls.enumConstant ("BAD");
     final JEnumConstant ec2 = enumcls.enumConstant ("BAD");
-    ec1.equals (ec2);
+    assertEquals (ec1, ec2);
 
     use.param ("value", ec);
     // adding another param as an enum
@@ -172,6 +163,6 @@ public final class AnnotationUseFuncTest
     final JAnnotationUse myuse = aUse.annotationParam ("foo", Target.class);
     myuse.param ("junk", 7);
 
-    cm.build (new SingleStreamCodeWriter (System.out));
+    CodeModelTestsHelper.parseCodeModel (cm);
   }
 }
diff --git a/src/test/java/com/helger/jcodemodel/AnonymousClassFuncTest.java b/src/test/java/com/helger/jcodemodel/AnonymousClassFuncTest.java
index 1b824ceb..e5e86803 100644
--- a/src/test/java/com/helger/jcodemodel/AnonymousClassFuncTest.java
+++ b/src/test/java/com/helger/jcodemodel/AnonymousClassFuncTest.java
@@ -46,7 +46,7 @@ import java.util.Iterator;
 
 import org.junit.Test;
 
-import com.helger.jcodemodel.writer.SingleStreamCodeWriter;
+import com.helger.jcodemodel.util.CodeModelTestsHelper;
 
 /**
  * @author Kohsuke Kawaguchi (kohsuke.kawaguchi@sun.com)
@@ -66,10 +66,10 @@ public final class AnonymousClassFuncTest
     c.field (JMod.PRIVATE, cm.DOUBLE, "y");
     m.body ().decl (cm.ref (Object.class), "x", JExpr._new (c));
 
-    cm.build (new SingleStreamCodeWriter (System.out));
-
     assertEquals ("java.util.Iterator<java.lang.Double>", c.fullName ());
     // Incorrect! Should be Test$1!
     assertEquals ("java.util.Iterator<java.lang.Double>", c.binaryName ());
+
+    CodeModelTestsHelper.parseCodeModel (cm);
   }
 }
diff --git a/src/test/java/com/helger/jcodemodel/ForEachFuncTest.java b/src/test/java/com/helger/jcodemodel/ForEachFuncTest.java
index 3ff25cba..8970bdce 100644
--- a/src/test/java/com/helger/jcodemodel/ForEachFuncTest.java
+++ b/src/test/java/com/helger/jcodemodel/ForEachFuncTest.java
@@ -44,7 +44,7 @@ import java.util.ArrayList;
 
 import org.junit.Test;
 
-import com.helger.jcodemodel.writer.SingleStreamCodeWriter;
+import com.helger.jcodemodel.util.CodeModelTestsHelper;
 
 /**
  * Simple program to test the generation of the enhanced for loop in jdk 1.5
@@ -56,7 +56,6 @@ public final class ForEachFuncTest
   @Test
   public void testBasic () throws Exception
   {
-
     final JCodeModel cm = new JCodeModel ();
     final JDefinedClass cls = cm._class ("Test");
 
@@ -78,6 +77,6 @@ public final class ForEachFuncTest
     // JInvocation invocation =
     foreach.body ().invoke (out1, "println").arg ($count1);
 
-    cm.build (new SingleStreamCodeWriter (System.out));
+    CodeModelTestsHelper.parseCodeModel (cm);
   }
 }
diff --git a/src/test/java/com/helger/jcodemodel/InnerClassFuncTest.java b/src/test/java/com/helger/jcodemodel/InnerClassFuncTest.java
index 2618f3ea..6bc2a509 100644
--- a/src/test/java/com/helger/jcodemodel/InnerClassFuncTest.java
+++ b/src/test/java/com/helger/jcodemodel/InnerClassFuncTest.java
@@ -44,15 +44,15 @@ import static org.junit.Assert.assertEquals;
 
 import org.junit.Test;
 
-import com.helger.jcodemodel.writer.SingleStreamCodeWriter;
+import com.helger.jcodemodel.util.CodeModelTestsHelper;
 
 public final class InnerClassFuncTest
 {
   @Test
   public void innerClassesAreImported () throws Exception
   {
-    final JCodeModel codeModel = new JCodeModel ();
-    final JDefinedClass aClass = codeModel._class ("org.test.DaTestClass");
+    final JCodeModel cm = new JCodeModel ();
+    final JDefinedClass aClass = cm._class ("org.test.DaTestClass");
     final JDefinedClass daInner1 = aClass._class ("Inner");
     final JDefinedClass daInnerInner = daInner1._class ("InnerInner");
     final JDefinedClass daInner2 = aClass._class ("DaTestClassInner");
@@ -71,12 +71,12 @@ public final class InnerClassFuncTest
     aClass.method (JMod.PUBLIC, daInner2, "getInner2");
     aClass.method (JMod.PUBLIC, daInner2Inner, "getInner2Inner");
 
-    final JDefinedClass otherClass = codeModel._class ("org.test.OtherClass");
+    final JDefinedClass otherClass = cm._class ("org.test.OtherClass");
     otherClass.method (JMod.PUBLIC, daInner1, "getInner");
     otherClass.method (JMod.PUBLIC, daInnerInner, "getInnerInner");
     otherClass.method (JMod.PUBLIC, daInner2Inner, "getInner2Inner");
     otherClass.method (JMod.PUBLIC, aClass, "getOuter");
 
-    codeModel.build (new SingleStreamCodeWriter (System.out));
+    CodeModelTestsHelper.printCodeModel (cm);
   }
 }
diff --git a/src/test/java/com/helger/jcodemodel/JAnnotationUseTest.java b/src/test/java/com/helger/jcodemodel/JAnnotationUseTest.java
index 41335463..8d8f4322 100644
--- a/src/test/java/com/helger/jcodemodel/JAnnotationUseTest.java
+++ b/src/test/java/com/helger/jcodemodel/JAnnotationUseTest.java
@@ -40,14 +40,12 @@
  */
 package com.helger.jcodemodel;
 
-import java.io.IOException;
 import java.lang.annotation.Inherited;
 
 import org.junit.Assert;
 import org.junit.Test;
 
 import com.helger.jcodemodel.util.CodeModelTestsHelper;
-import com.helger.jcodemodel.writer.SingleStreamCodeWriter;
 
 /**
  * Unit test for class {@link JAnnotationUse}.
@@ -66,7 +64,6 @@ public final class JAnnotationUseTest
 
     Assert.assertEquals ("@java.lang.SuppressWarnings(\"unused\")",
                          CodeModelTestsHelper.generate (suppressWarningAnnotation));
-
   }
 
   @Test
@@ -99,14 +96,14 @@ public final class JAnnotationUseTest
     final JFieldVar field = cls.field (JMod.PRIVATE, cm.DOUBLE, "y");
     field.annotate (Deprecated.class);
 
-    cm.build (new SingleStreamCodeWriter (System.out));
+    CodeModelTestsHelper.parseCodeModel (cm);
   }
 
   @Test
-  public void testPackageAnnotation () throws IOException
+  public void testPackageAnnotation () throws Exception
   {
     final JCodeModel cm = new JCodeModel ();
     cm._package ("foo").annotate (Inherited.class);
-    cm.build (new SingleStreamCodeWriter (System.out));
+    CodeModelTestsHelper.parseCodeModel (cm);
   }
 }
diff --git a/src/test/java/com/helger/jcodemodel/JCodeModelTest.java b/src/test/java/com/helger/jcodemodel/JCodeModelTest.java
index 3e7c6eff..d39dca37 100644
--- a/src/test/java/com/helger/jcodemodel/JCodeModelTest.java
+++ b/src/test/java/com/helger/jcodemodel/JCodeModelTest.java
@@ -42,11 +42,9 @@ package com.helger.jcodemodel;
 
 import static org.junit.Assert.assertNotNull;
 
-import java.io.IOException;
-
 import org.junit.Test;
 
-import com.helger.jcodemodel.writer.SingleStreamCodeWriter;
+import com.helger.jcodemodel.util.CodeModelTestsHelper;
 
 /**
  * @author Kohsuke Kawaguchi
@@ -63,7 +61,7 @@ public final class JCodeModelTest
   }
 
   @Test
-  public void testIssue28 () throws JClassAlreadyExistsException, IOException
+  public void testIssue28 () throws Exception
   {
     final JCodeModel cm = new JCodeModel ();
     final JDefinedClass aEnumClass = cm._package ("com.helger.issue28")._enum ("DummyEnum");
@@ -72,6 +70,6 @@ public final class JCodeModelTest
       .constructor (JMod.PUBLIC)
       .body ()
       .add (JExpr.enumConstantRef (aEnumClass, "CONSTANT").invoke ("toString"));
-    cm.build (new SingleStreamCodeWriter (System.out));
+    CodeModelTestsHelper.printCodeModel (cm);
   }
 }
diff --git a/src/test/java/com/helger/jcodemodel/JDefinedClassTest.java b/src/test/java/com/helger/jcodemodel/JDefinedClassTest.java
index 30570541..c773aefc 100644
--- a/src/test/java/com/helger/jcodemodel/JDefinedClassTest.java
+++ b/src/test/java/com/helger/jcodemodel/JDefinedClassTest.java
@@ -42,15 +42,10 @@ package com.helger.jcodemodel;
 
 import static org.junit.Assert.assertNotNull;
 
-import java.io.ByteArrayInputStream;
-import java.io.ByteArrayOutputStream;
-import java.nio.charset.Charset;
-
 import org.junit.Test;
 
-import com.helger.jcodemodel.writer.OutputStreamCodeWriter;
+import com.helger.jcodemodel.util.CodeModelTestsHelper;
 
-import japa.parser.JavaParser;
 import japa.parser.ast.CompilationUnit;
 import japa.parser.ast.body.ClassOrInterfaceDeclaration;
 import japa.parser.ast.body.InitializerDeclaration;
@@ -58,7 +53,7 @@ import japa.parser.ast.body.TypeDeclaration;
 
 /**
  * Test class for class {@link JDefinedClass}.
- * 
+ *
  * @author Philip Helger
  */
 public final class JDefinedClassTest
@@ -66,26 +61,31 @@ public final class JDefinedClassTest
   @Test
   public void generatesInstanceInit () throws Exception
   {
+    /**
+     * <pre>
+     * package myPackage;
+     *
+     * class MyClass
+     * {
+     *   private String myField;
+     *
+     *   {
+     *     this.myField = "myValue";
+     *   }
+     * }
+     * </pre>
+     */
+
     final JCodeModel cm = new JCodeModel ();
     final JDefinedClass c = cm._package ("myPackage")._class (0, "MyClass");
     final JFieldVar myField = c.field (JMod.PRIVATE, String.class, "myField");
     c.instanceInit ().assign (JExpr._this ().ref (myField), JExpr.lit ("myValue"));
-    final ByteArrayOutputStream bos = new ByteArrayOutputStream ();
-    final Charset encoding = Charset.forName ("UTF-8");
-    // cm.build(new OutputStreamCodeWriter(System.out, encoding));
-    cm.build (new OutputStreamCodeWriter (bos, encoding));
-    bos.close ();
-
-    final ByteArrayInputStream bis = new ByteArrayInputStream (bos.toByteArray ());
-
-    final CompilationUnit compilationUnit = JavaParser.parse (bis, encoding.name ());
 
+    final CompilationUnit compilationUnit = CodeModelTestsHelper.parseCodeModel (cm);
     final TypeDeclaration typeDeclaration = compilationUnit.getTypes ().get (0);
     final ClassOrInterfaceDeclaration classDeclaration = (ClassOrInterfaceDeclaration) typeDeclaration;
-
     final InitializerDeclaration initializerDeclaration = (InitializerDeclaration) classDeclaration.getMembers ()
                                                                                                    .get (1);
-
     assertNotNull (initializerDeclaration);
   }
 }
diff --git a/src/test/java/com/helger/jcodemodel/JDirectClassTest.java b/src/test/java/com/helger/jcodemodel/JDirectClassTest.java
index 5573f8c2..71bbf971 100644
--- a/src/test/java/com/helger/jcodemodel/JDirectClassTest.java
+++ b/src/test/java/com/helger/jcodemodel/JDirectClassTest.java
@@ -2,11 +2,9 @@ package com.helger.jcodemodel;
 
 import static org.junit.Assert.assertEquals;
 
-import java.io.IOException;
-
 import org.junit.Test;
 
-import com.helger.jcodemodel.writer.SingleStreamCodeWriter;
+import com.helger.jcodemodel.util.CodeModelTestsHelper;
 
 /**
  * Test class for class {@link JDirectClass}.
@@ -16,7 +14,7 @@ import com.helger.jcodemodel.writer.SingleStreamCodeWriter;
 public final class JDirectClassTest
 {
   @Test
-  public void testBasic () throws JClassAlreadyExistsException, IOException
+  public void testBasic () throws Exception
   {
     final JCodeModel cm = new JCodeModel ();
 
@@ -39,11 +37,11 @@ public final class JDirectClassTest
     final JMethod aMethodSelected = aClassAct.method (JMod.PUBLIC, cm.BOOLEAN, "onOptionsItemSelected");
     aMethodSelected.body ()._if (JExpr.ref ("itemId_").eq (myItem));
 
-    cm.build (new SingleStreamCodeWriter (System.out));
+    CodeModelTestsHelper.parseCodeModel (cm);
   }
 
   @Test
-  public void testGenerics ()
+  public void testGenerics () throws Exception
   {
     final JCodeModel cm = new JCodeModel ();
 
@@ -51,5 +49,9 @@ public final class JDirectClassTest
     assertEquals ("com.test", aDirectClass._package ().name ());
     assertEquals ("com.test.GenericFragmentArguments<S,P>", aDirectClass.name ());
     assertEquals ("com.test.GenericFragmentArguments<S,P>", aDirectClass.fullName ());
+
+    cm._class ("UsingClass").method (JMod.PUBLIC, cm.VOID, "test").body ().add (JExpr._new (aDirectClass));
+
+    CodeModelTestsHelper.parseCodeModel (cm);
   }
 }
diff --git a/src/test/java/com/helger/jcodemodel/JFieldRefTest.java b/src/test/java/com/helger/jcodemodel/JFieldRefTest.java
index 7f307ce2..aaf0a56c 100644
--- a/src/test/java/com/helger/jcodemodel/JFieldRefTest.java
+++ b/src/test/java/com/helger/jcodemodel/JFieldRefTest.java
@@ -42,11 +42,11 @@ package com.helger.jcodemodel;
 
 import org.junit.Test;
 
-import com.helger.jcodemodel.writer.SingleStreamCodeWriter;
+import com.helger.jcodemodel.util.CodeModelTestsHelper;
 
 /**
  * Test class for class {@link JFieldRef}
- * 
+ *
  * @author Philip Helger
  */
 public final class JFieldRefTest
@@ -65,6 +65,6 @@ public final class JFieldRefTest
     m.body ().add (JExpr.refthis (f1).assign (6));
     m.body ().add (JExpr.refthis (f2).assign ("Call"));
 
-    cm.build (new SingleStreamCodeWriter (System.out));
+    CodeModelTestsHelper.parseCodeModel (cm);
   }
 }
diff --git a/src/test/java/com/helger/jcodemodel/JInvocationTest.java b/src/test/java/com/helger/jcodemodel/JInvocationTest.java
index 699bbbc8..1a973c1e 100644
--- a/src/test/java/com/helger/jcodemodel/JInvocationTest.java
+++ b/src/test/java/com/helger/jcodemodel/JInvocationTest.java
@@ -40,7 +40,6 @@
  */
 package com.helger.jcodemodel;
 
-import java.io.IOException;
 import java.math.BigInteger;
 import java.util.ArrayList;
 import java.util.Comparator;
@@ -48,7 +47,7 @@ import java.util.List;
 
 import org.junit.Test;
 
-import com.helger.jcodemodel.writer.SingleStreamCodeWriter;
+import com.helger.jcodemodel.util.CodeModelTestsHelper;
 
 /**
  * Test class for class {@link JInvocation}
@@ -58,7 +57,7 @@ import com.helger.jcodemodel.writer.SingleStreamCodeWriter;
 public final class JInvocationTest
 {
   @Test
-  public void testWithGenerics () throws JClassAlreadyExistsException, IOException
+  public void testWithGenerics () throws Exception
   {
     final JCodeModel cm = new JCodeModel ();
     final JDefinedClass cls = cm._class ("TestInvocation");
@@ -108,6 +107,6 @@ public final class JInvocationTest
            .arg (JExpr._this ())
            .arg (JExpr._new (cm.ref (ArrayList.class).narrow (Long.class)));
 
-    cm.build (new SingleStreamCodeWriter (System.out));
+    CodeModelTestsHelper.parseCodeModel (cm);
   }
 }
diff --git a/src/test/java/com/helger/jcodemodel/JMethodTest.java b/src/test/java/com/helger/jcodemodel/JMethodTest.java
index d0788e80..8fcfc76e 100644
--- a/src/test/java/com/helger/jcodemodel/JMethodTest.java
+++ b/src/test/java/com/helger/jcodemodel/JMethodTest.java
@@ -43,6 +43,8 @@ package com.helger.jcodemodel;
 import org.junit.Assert;
 import org.junit.Test;
 
+import com.helger.jcodemodel.util.CodeModelTestsHelper;
+
 /**
  * Test class for class {@link JMethod}.
  *
@@ -51,15 +53,17 @@ import org.junit.Test;
 public final class JMethodTest
 {
   @Test
-  public void testBasic () throws JClassAlreadyExistsException
+  public void testBasic () throws Exception
   {
     final JCodeModel cm = new JCodeModel ();
     final JDefinedClass cls = cm._class ("Test");
     final JMethod m = cls.method (JMod.PUBLIC, cm.VOID, "foo");
-
     final JVar foo = m.param (String.class, "foo");
+    m.body ().assign (foo, JExpr.lit ("bar"));
 
     Assert.assertEquals (1, m.params ().size ());
     Assert.assertSame (foo, m.params ().get (0));
+
+    CodeModelTestsHelper.parseCodeModel (cm);
   }
 }
diff --git a/src/test/java/com/helger/jcodemodel/JavadocFuncTest.java b/src/test/java/com/helger/jcodemodel/JavadocFuncTest.java
index e80a0b7d..53f2e549 100644
--- a/src/test/java/com/helger/jcodemodel/JavadocFuncTest.java
+++ b/src/test/java/com/helger/jcodemodel/JavadocFuncTest.java
@@ -40,11 +40,9 @@
  */
 package com.helger.jcodemodel;
 
-import java.io.IOException;
-
 import org.junit.Test;
 
-import com.helger.jcodemodel.writer.SingleStreamCodeWriter;
+import com.helger.jcodemodel.util.CodeModelTestsHelper;
 
 /**
  * @author Kohsuke Kawaguchi
@@ -52,10 +50,10 @@ import com.helger.jcodemodel.writer.SingleStreamCodeWriter;
 public final class JavadocFuncTest
 {
   @Test
-  public void testOnPackage () throws IOException
+  public void testOnPackage () throws Exception
   {
     final JCodeModel cm = new JCodeModel ();
     cm._package ("foo").javadoc ().add ("String");
-    cm.build (new SingleStreamCodeWriter (System.out));
+    CodeModelTestsHelper.parseCodeModel (cm);
   }
 }
diff --git a/src/test/java/com/helger/jcodemodel/NestedClassFuncTest.java b/src/test/java/com/helger/jcodemodel/NestedClassFuncTest.java
index 0efa25ec..78ce1515 100644
--- a/src/test/java/com/helger/jcodemodel/NestedClassFuncTest.java
+++ b/src/test/java/com/helger/jcodemodel/NestedClassFuncTest.java
@@ -42,7 +42,7 @@ package com.helger.jcodemodel;
 
 import org.junit.Test;
 
-import com.helger.jcodemodel.writer.SingleStreamCodeWriter;
+import com.helger.jcodemodel.util.CodeModelTestsHelper;
 
 /**
  * @author Kohsuke Kawaguchi
@@ -55,7 +55,7 @@ public final class NestedClassFuncTest
     final JCodeModel cm = new JCodeModel ();
     final JDefinedClass c = cm._package ("foo")._class (0, "Foo");
     c._extends (cm.ref (MockInnerClass.class));
-    cm.build (new SingleStreamCodeWriter (System.out));
+    CodeModelTestsHelper.parseCodeModel (cm);
   }
 
   public static class MockInnerClass
diff --git a/src/test/java/com/helger/jcodemodel/VarArgsFuncTest.java b/src/test/java/com/helger/jcodemodel/VarArgsFuncTest.java
index d1a25012..e73f672b 100644
--- a/src/test/java/com/helger/jcodemodel/VarArgsFuncTest.java
+++ b/src/test/java/com/helger/jcodemodel/VarArgsFuncTest.java
@@ -44,7 +44,7 @@ import static org.junit.Assert.assertNotNull;
 
 import org.junit.Test;
 
-import com.helger.jcodemodel.writer.SingleStreamCodeWriter;
+import com.helger.jcodemodel.util.CodeModelTestsHelper;
 
 /**
  * Simple program to test the generation of the varargs feature in jdk 1.5
@@ -75,7 +75,9 @@ public final class VarArgsFuncTest
     m.param (String.class, "param1");
     m.param (Integer.class, "param2");
     final JVar var = m.varParam (Object.class, "param3");
-    System.out.println ("First varParam " + var);
+
+    if (false)
+      System.out.println ("First varParam " + var);
 
     // checking for param after varParam it behaves ok
     // JVar[] var1 = m.varParam(Float.class, "param4");
@@ -86,10 +88,10 @@ public final class VarArgsFuncTest
 
     final JForLoop forloop = m.body ()._for ();
 
-    final JVar $count = forloop.init (cm.INT, "count", JExpr.lit (0));
+    final JVar jcount = forloop.init (cm.INT, "count", JExpr.lit (0));
 
-    forloop.test ($count.lt (JExpr.direct ("param3.length")));
-    forloop.update ($count.incr ());
+    forloop.test (jcount.lt (JExpr.direct ("param3.length")));
+    forloop.update (jcount.incr ());
 
     final JFieldRef out = cm.ref (System.class).staticRef ("out");
 
@@ -104,6 +106,6 @@ public final class VarArgsFuncTest
     main.body ()
         .directStatement ("new Test().foo(new String(\"Param1\"),new Integer(5),null,new String(\"Param3\"),new String(\"Param4\"));");
 
-    cm.build (new SingleStreamCodeWriter (System.out));
+    CodeModelTestsHelper.parseCodeModel (cm);
   }
 }
diff --git a/src/test/java/com/helger/jcodemodel/util/CodeModelTestsHelper.java b/src/test/java/com/helger/jcodemodel/util/CodeModelTestsHelper.java
index e9bb45f6..9a9291f3 100644
--- a/src/test/java/com/helger/jcodemodel/util/CodeModelTestsHelper.java
+++ b/src/test/java/com/helger/jcodemodel/util/CodeModelTestsHelper.java
@@ -40,7 +40,11 @@
  */
 package com.helger.jcodemodel.util;
 
+import java.io.ByteArrayInputStream;
+import java.io.ByteArrayOutputStream;
+import java.io.IOException;
 import java.io.StringWriter;
+import java.nio.charset.Charset;
 
 import javax.annotation.Nonnull;
 
@@ -48,15 +52,25 @@ import com.helger.jcodemodel.IJDeclaration;
 import com.helger.jcodemodel.IJExpression;
 import com.helger.jcodemodel.IJGenerable;
 import com.helger.jcodemodel.IJStatement;
+import com.helger.jcodemodel.JCodeModel;
 import com.helger.jcodemodel.JFormatter;
+import com.helger.jcodemodel.writer.OutputStreamCodeWriter;
+import com.helger.jcodemodel.writer.SingleStreamCodeWriter;
+
+import japa.parser.JavaParser;
+import japa.parser.ParseException;
+import japa.parser.ast.CompilationUnit;
 
 /**
  * Various utilities for codemodel tests.
  *
  * @author Aleksei Valikov
+ * @author Philip Helger
  */
 public final class CodeModelTestsHelper
 {
+  public static final Charset DEFAULT_ENCODING = Charset.forName ("UTF-8");
+
   /** Hidden constructor. */
   private CodeModelTestsHelper ()
   {}
@@ -141,4 +155,40 @@ public final class CodeModelTestsHelper
     generable.generate (formatter);
     return aSW.toString ();
   }
+
+  /**
+   * Get the content of the code model as a byte array in
+   * {@link #DEFAULT_ENCODING}
+   *
+   * @param cm
+   *        Source code model
+   * @return The byte array
+   * @throws IOException
+   *         Theoretically only
+   */
+  @Nonnull
+  public static byte [] getAllBytes (@Nonnull final JCodeModel cm) throws IOException
+  {
+    final ByteArrayOutputStream bos = new ByteArrayOutputStream ();
+    cm.build (new OutputStreamCodeWriter (bos, DEFAULT_ENCODING));
+    bos.close ();
+    return bos.toByteArray ();
+  }
+
+  @Nonnull
+  public static CompilationUnit parseCodeModel (@Nonnull final JCodeModel cm) throws IOException, ParseException
+  {
+    final byte [] aBytes = getAllBytes (cm);
+    if (true)
+      System.out.println (new String (aBytes, DEFAULT_ENCODING.name ()));
+
+    final ByteArrayInputStream bis = new ByteArrayInputStream (aBytes);
+
+    return JavaParser.parse (bis, DEFAULT_ENCODING.name ());
+  }
+
+  public static void printCodeModel (@Nonnull final JCodeModel cm) throws IOException
+  {
+    cm.build (new SingleStreamCodeWriter (System.out));
+  }
 }
