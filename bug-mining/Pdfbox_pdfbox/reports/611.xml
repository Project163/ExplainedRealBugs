<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 20:56:36 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PDFBOX-1533] When merging certain PDF&apos;s several odd looking empty pages occur in the result</title>
                <link>https://issues.apache.org/jira/browse/PDFBOX-1533</link>
                <project id="12310760" key="PDFBOX">PDFBox</project>
                    <description>&lt;p&gt;Unfortunately I cannot attach a input file for this case as it contains confidential customer data, but I&apos;ll try to explain the problem in depth so you hopefully are able to track it down.&lt;/p&gt;

&lt;p&gt;When we merge certain PDF&apos;s with the PDFMergerUtility the result contains several empty pages at the end of the document. It seems like that only certain pdf versions are effected (i.p.: 1.5 (Acrobat 6.x)). &lt;/p&gt;

&lt;p&gt;I tracked the problem down to the the following part in the appendDocument method of the PDFMergerUtility:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt; &lt;span class=&quot;code-comment&quot;&gt;//&lt;span class=&quot;code-keyword&quot;&gt;finally&lt;/span&gt; append the pages
&lt;/span&gt;        List&amp;lt;PDPage&amp;gt; pages = srcCatalog.getAllPages();
        Iterator&amp;lt;PDPage&amp;gt; pageIter = pages.iterator();
        &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt;( pageIter.hasNext() )
        {
            PDPage page = pageIter.next();
            PDPage newPage =
                &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; PDPage( (COSDictionary)cloner.cloneForNewDocument( page.getCOSDictionary() ) );
            newPage.setCropBox( page.findCropBox() );
            newPage.setMediaBox( page.findMediaBox() );
            newPage.setRotation( page.findRotation() );
            destination.addPage( newPage );
        }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The problem is that call to srcCatalog.getAllPages(); returns for example 6 PDPage objects, but for the same input document, the call to source.getNumberOfPages() returns only 2. Thus we add 4 odd empty pages to the result document.&lt;/p&gt;

&lt;p&gt;I hope this description is good enough to figure out the problem. Don&apos;t hesitate to ask for further details.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12635747">PDFBOX-1533</key>
            <summary>When merging certain PDF&apos;s several odd looking empty pages occur in the result</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jahewson">John Hewson</assignee>
                                    <reporter username="chri">Christian Connert</reporter>
                        <labels>
                    </labels>
                <created>Thu, 7 Mar 2013 08:28:51 +0000</created>
                <updated>Fri, 19 Sep 2014 14:40:45 +0000</updated>
                            <resolved>Tue, 8 Jul 2014 18:30:36 +0000</resolved>
                                    <version>1.7.1</version>
                    <version>1.8.4</version>
                    <version>2.0.0</version>
                                    <fixVersion>1.8.7</fixVersion>
                    <fixVersion>2.0.0</fixVersion>
                                    <component>Utilities</component>
                        <due></due>
                            <votes>2</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="13618354" author="lehmi" created="Sun, 31 Mar 2013 15:39:41 +0000"  >&lt;p&gt;Without having a hand on a sample pdf this is only a guess, but there are 2 things you might try:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;update to PDFBox 1.8.0&lt;/li&gt;
	&lt;li&gt;use the non-sequential parser (use PDDocument#loadNonSeq() instead of PDDocument#load())&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13627542" author="chri" created="Wed, 10 Apr 2013 06:49:01 +0000"  >&lt;p&gt;Thanks for the update. I tried both approches without any success. When I update to PDFBox 1.8.0 the merged pdf is invalid and cannot be opened by acrobat anymore (also in combination with the second tip). The second approach doesn&apos;t help either. Still got the same behaviour. I have to check if our customer might be able to supply an test pdf without any private data to attache to this issue.&lt;/p&gt;</comment>
                            <comment id="13627553" author="msahyoun" created="Wed, 10 Apr 2013 07:01:00 +0000"  >&lt;p&gt;Hi Christian,&lt;/p&gt;

&lt;p&gt;unfortunately 1.8.0 had a bug so in certain conditions the newly written PDF was incomplete. This will be addressed in 1.8.1. The fix is already available in trunk. What you could do is either use 1.7.1 with the PDDocument#loadNonSeq() or build 1.8.1 for yourself. 1.8.1 should be out soon though.&lt;/p&gt;

&lt;p&gt;BR Maruan&lt;/p&gt;</comment>
                            <comment id="13627565" author="chri" created="Wed, 10 Apr 2013 07:20:01 +0000"  >&lt;p&gt;Thanks, I did use 1.7.1 with PDDocument#loadNonSeq() and ended up with the same issue&lt;/p&gt;</comment>
                            <comment id="13627568" author="msahyoun" created="Wed, 10 Apr 2013 07:23:53 +0000"  >&lt;p&gt;OK - can you try building pdfbox from trunk or wait for 1.8.1? If not we would need a set of pdfs to reproduce the issue. If trunk or 1.8.1 don&apos;t fix it we will also need sample pdfs.&lt;/p&gt;</comment>
                            <comment id="13900168" author="chri" created="Thu, 13 Feb 2014 09:40:22 +0000"  >&lt;p&gt;Finally we managed to get the OK from our customers to attache some sample pdf. The zip file containts the two pdfs we tried to merge (part1 and part2) + the result with our issue. The merged pdf was produced with PDFBox 1.8.4.&lt;/p&gt;</comment>
                            <comment id="14054671" author="msahyoun" created="Tue, 8 Jul 2014 08:56:18 +0000"  >&lt;p&gt;The issue is because part1.pdf references the same 2 pages 3 times within the document catalog (/Kids &lt;span class=&quot;error&quot;&gt;&amp;#91;3 0 R, 3 0 R, 3 0 R&amp;#93;&lt;/span&gt;).&lt;/p&gt;</comment>
                            <comment id="14054799" author="msahyoun" created="Tue, 8 Jul 2014 10:17:43 +0000"  >&lt;p&gt;a potential workaround is to put&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;        @SuppressWarnings(&lt;span class=&quot;code-quote&quot;&gt;&quot;unchecked&quot;&lt;/span&gt;)
        Set&amp;lt;COSBase&amp;gt; set = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; LinkedHashSet&amp;lt;COSBase&amp;gt;((Collection&amp;lt;COSBase&amp;gt;) kids.toList());

        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (kids.size() != set.size()) {
            kids = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; COSArray();
            kids.addAll(Collections.unmodifiableSet(set));
        }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;into PDPageNode.getAllKids(). I&#8217;d need to test that for potential side effects.&lt;/p&gt;</comment>
                            <comment id="14055264" author="jahewson" created="Tue, 8 Jul 2014 18:30:36 +0000"  >&lt;p&gt;Yep, that&apos;s the gist of it. The code can be made a little simpler by modifying the control flow of getAllKids() rather than modifying the collection after the fact. I&apos;ve done this is &lt;a href=&quot;http://svn.apache.org/r1608875&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;r1608875&lt;/a&gt; for the trunk and &lt;a href=&quot;http://svn.apache.org/r1608876&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;r1608876&lt;/a&gt; for 1.8.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12628709" name="sample_pdf.zip" size="571100" author="chri" created="Thu, 13 Feb 2014 09:40:22 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>316239</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 19 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1iki7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>316582</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>