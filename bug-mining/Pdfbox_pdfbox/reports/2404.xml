<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:10:32 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PDFBOX-4934] Could not find referenced cmap stream Adobe-Japan1-XXXX</title>
                <link>https://issues.apache.org/jira/browse/PDFBOX-4934</link>
                <project id="12310760" key="PDFBOX">PDFBox</project>
                    <description>&lt;p&gt;The IOException exception occurs when attached pdf feeded into PDFBox.&lt;/p&gt;

&lt;p&gt;The attached pdf (JP.pdf) file include Adobe-Japan1-65534 cmap.&lt;br/&gt;
source code is as below.&lt;br/&gt;
&amp;#8212;&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; javax.imageio.ImageIO;

&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.commons.io.FileUtils;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.pdfbox.pdmodel.PDDocument;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.pdfbox.pdmodel.PDPage;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.pdfbox.rendering.ImageType;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.pdfbox.rendering.PDFRenderer;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.pdfbox.text.PDFTextStripper;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.pdfbox.text.TextPosition;

&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;pdfBoxTest {
	&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void main(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] args) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {
		pdfBoxTest sample = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; pdfBoxTest();

		&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; pdfname = &lt;span class=&quot;code-quote&quot;&gt;&quot;D:/tmp/jp.pdf&quot;&lt;/span&gt;;
		File pdf = FileUtils.getFile(pdfname);

		sample.extractTextFromPDF(pdf);
		sample.load(pdf);
	}

	&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void load(File pdf) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {

		PDDocument document = PDDocument.load(pdf);
		PDFRenderer renderer = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; PDFRenderer(document);
		BufferedImage bufImage = renderer.renderImageWithDPI(0, 300, ImageType.RGB);

		ImageIO.write(bufImage, &lt;span class=&quot;code-quote&quot;&gt;&quot;jpg&quot;&lt;/span&gt;, &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; File(&lt;span class=&quot;code-quote&quot;&gt;&quot;D:/tmp/jp.jpg&quot;&lt;/span&gt;));
	}
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;getExternalCMap mehod in CMapParse.class tries to find external CMap, but&lt;br/&gt;
it couldn&apos;t find Japan1-65534 and throws exception.&lt;/p&gt;

&lt;p&gt;I know that there is no such a CMap, but it is no problem to open this PDF file,&lt;br/&gt;
so I think it is better not to throw exception and use another CMap.&lt;br/&gt;
I modified source code as below temporarily. it works well.&lt;/p&gt;


&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;protected&lt;/span&gt; InputStream getExternalCMap(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; name) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException {
      InputStream is = &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.getClass().getResourceAsStream(name);
       &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt;(is == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
          &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt;(name.startsWith(&lt;span class=&quot;code-quote&quot;&gt;&quot;Adobe-Japan1&quot;&lt;/span&gt;)) {
             name = &lt;span class=&quot;code-quote&quot;&gt;&quot;Adobe-Japan1-1&quot;&lt;/span&gt;;
          } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt;(name.startsWith(&lt;span class=&quot;code-quote&quot;&gt;&quot;Adobe-Korea1&quot;&lt;/span&gt;)) {
             name = &lt;span class=&quot;code-quote&quot;&gt;&quot;Adobe-Korea1-1&quot;&lt;/span&gt;;
          }
          is = &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.getClass().getResourceAsStream(name);
          &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt;(is == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
             &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; IOException(&lt;span class=&quot;code-quote&quot;&gt;&quot;Error: Could not find referenced cmap stream &quot;&lt;/span&gt; + name);
          }  
      }

       &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; is;
 }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;But it is not essential one.&lt;br/&gt;
If possible&#12289;I would like to ask you to modify source code not to throw exception if&lt;br/&gt;
it cannot find Cmap.&lt;/p&gt;

&lt;p&gt;I found another Korean pdf file, it includes Adode-Korea1-3 Cmap.&lt;/p&gt;

&lt;p&gt;Please refer to attached file.&lt;/p&gt;

&lt;p&gt;Thanks!&lt;/p&gt;

&lt;p&gt;//Okada&lt;/p&gt;
</description>
                <environment>Windows10, 64bit</environment>
        <key id="13322187">PDFBOX-4934</key>
            <summary>Could not find referenced cmap stream Adobe-Japan1-XXXX</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tilman">Tilman Hausherr</assignee>
                                    <reporter username="Shigeru_Okada">Shigeru Okada</reporter>
                        <labels>
                    </labels>
                <created>Wed, 12 Aug 2020 05:08:57 +0000</created>
                <updated>Sun, 20 Dec 2020 18:48:00 +0000</updated>
                            <resolved>Tue, 18 Aug 2020 18:36:55 +0000</resolved>
                                    <version>2.0.20</version>
                                    <fixVersion>2.0.22</fixVersion>
                    <fixVersion>3.0.0 PDFBox</fixVersion>
                                    <component>FontBox</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="17176223" author="mkl" created="Wed, 12 Aug 2020 10:05:44 +0000"  >&lt;p&gt;As far as I know the currently newest (highest) Adobe-Japan1 supplement number is 7, so defaulting to Adobe-Japan1-1 seems a bit restricting, &lt;/p&gt;</comment>
                            <comment id="17176496" author="tilman" created="Wed, 12 Aug 2020 17:15:54 +0000"  >&lt;p&gt;My proposal would be to change this&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
CMap prdCMap = CMapManager.getPredefinedCMap(strName);
&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; ucs2Name = prdCMap.getRegistry() + &lt;span class=&quot;code-quote&quot;&gt;&quot;-&quot;&lt;/span&gt; + prdCMap.getOrdering() + &lt;span class=&quot;code-quote&quot;&gt;&quot;-UCS2&quot;&lt;/span&gt;;
cMapUCS2 = CMapManager.getPredefinedCMap(ucs2Name);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;to this&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt;
{
    CMap prdCMap = CMapManager.getPredefinedCMap(strName);
    &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; ucs2Name = prdCMap.getRegistry() + &lt;span class=&quot;code-quote&quot;&gt;&quot;-&quot;&lt;/span&gt; + prdCMap.getOrdering() + &lt;span class=&quot;code-quote&quot;&gt;&quot;-UCS2&quot;&lt;/span&gt;;
    cMapUCS2 = CMapManager.getPredefinedCMap(ucs2Name);
}
&lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (IOException ex)
{
    LOG.warn(&lt;span class=&quot;code-quote&quot;&gt;&quot;Could not get &quot;&lt;/span&gt; + strName + &lt;span class=&quot;code-quote&quot;&gt;&quot; UC2 map &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; font &quot;&lt;/span&gt; + getName(), ex);
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;in PDType0Font.java . The files both render and some text is extracted.&lt;/p&gt;

&lt;p&gt;But I&apos;m reluctant to do it immediately because we&apos;re close to a release and Tim wanted to start the regression tests, or already has.&lt;/p&gt;</comment>
                            <comment id="17176684" author="shigeru_okada" created="Thu, 13 Aug 2020 01:04:56 +0000"  >&lt;p&gt;Thank you for comment and sample of modified source code.&lt;/p&gt;

&lt;p&gt;&amp;gt;But I&apos;m reluctant to do it immediately because we&apos;re close to a release and Tim wanted to start the regression tests, or already has.&lt;/p&gt;

&lt;p&gt;It is regret but I hope this modification reflects to the next release.&lt;/p&gt;</comment>
                            <comment id="17179306" author="shigeru_okada" created="Tue, 18 Aug 2020 02:17:22 +0000"  >&lt;p&gt;Hi, Thank you for your corporation.&lt;/p&gt;

&lt;p&gt;Is it possible to ask you to release temporary bug fix version for this case?&lt;/p&gt;
</comment>
                            <comment id="17179322" author="jira-bot" created="Tue, 18 Aug 2020 03:05:35 +0000"  >&lt;p&gt;Commit 1880949 from Tilman Hausherr in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1880949&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1880949&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4934&quot; title=&quot;Could not find referenced cmap stream Adobe-Japan1-XXXX&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4934&quot;&gt;&lt;del&gt;PDFBOX-4934&lt;/del&gt;&lt;/a&gt;: recover from bad UC2&lt;/p&gt;</comment>
                            <comment id="17179323" author="jira-bot" created="Tue, 18 Aug 2020 03:05:39 +0000"  >&lt;p&gt;Commit 1880950 from Tilman Hausherr in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1880950&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1880950&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4934&quot; title=&quot;Could not find referenced cmap stream Adobe-Japan1-XXXX&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4934&quot;&gt;&lt;del&gt;PDFBOX-4934&lt;/del&gt;&lt;/a&gt;: recover from bad UC2&lt;/p&gt;</comment>
                            <comment id="17179324" author="jira-bot" created="Tue, 18 Aug 2020 03:05:43 +0000"  >&lt;p&gt;Commit 1880951 from Tilman Hausherr in branch &apos;pdfbox/branches/issue45&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1880951&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1880951&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4934&quot; title=&quot;Could not find referenced cmap stream Adobe-Japan1-XXXX&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4934&quot;&gt;&lt;del&gt;PDFBOX-4934&lt;/del&gt;&lt;/a&gt;: recover from bad UC2&lt;/p&gt;</comment>
                            <comment id="17179341" author="tilman" created="Tue, 18 Aug 2020 03:33:57 +0000"  >&lt;p&gt;Yes, now that the release is in the pipeline, here&apos;s a snapshot build with the bugfix:&lt;br/&gt;
&lt;a href=&quot;https://repository.apache.org/content/groups/snapshots/org/apache/pdfbox/pdfbox-app/2.0.22-SNAPSHOT/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://repository.apache.org/content/groups/snapshots/org/apache/pdfbox/pdfbox-app/2.0.22-SNAPSHOT/&lt;/a&gt;&lt;br/&gt;
(get the file at the bottom)&lt;/p&gt;</comment>
                            <comment id="17179365" author="shigeru_okada" created="Tue, 18 Aug 2020 05:33:57 +0000"  >&lt;p&gt;Thank you very much.&lt;br/&gt;
I appreciate for your quick response!&lt;/p&gt;</comment>
                            <comment id="17180009" author="tilman" created="Tue, 18 Aug 2020 18:36:55 +0000"  >&lt;p&gt;Always glad to help; thanks for the report!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="13009520" name="JP.pdf" size="515859" author="Shigeru_Okada" created="Wed, 12 Aug 2020 05:02:53 +0000"/>
                            <attachment id="13009519" name="Korea.pdf" size="574639" author="Shigeru_Okada" created="Wed, 12 Aug 2020 05:08:17 +0000"/>
                            <attachment id="13009590" name="PDFBOX-4934-JP.pdf-1.png" size="187234" author="tilman" created="Wed, 12 Aug 2020 18:39:25 +0000"/>
                            <attachment id="13009588" name="PDFBOX-4934-JP.pdf.txt" size="2232" author="tilman" created="Wed, 12 Aug 2020 18:34:11 +0000"/>
                            <attachment id="13009591" name="PDFBOX-4934-Korea.pdf-1.png" size="118509" author="tilman" created="Wed, 12 Aug 2020 18:39:25 +0000"/>
                            <attachment id="13009589" name="PDFBOX-4934-Korea.pdf.txt" size="3799" author="tilman" created="Wed, 12 Aug 2020 18:34:11 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>6.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 12 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0hokw:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>