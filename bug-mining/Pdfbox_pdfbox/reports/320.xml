<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 20:54:20 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PDFBOX-1639] Infinite loop with PDFParser used by tika.</title>
                <link>https://issues.apache.org/jira/browse/PDFBOX-1639</link>
                <project id="12310760" key="PDFBOX">PDFBox</project>
                    <description>&lt;p&gt;Hi,&lt;/p&gt;

&lt;p&gt;I encountered an issue in a production environment that cause a disk full error. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;br/&gt;
Tika uses the PDFParser with the &quot;forceParsing&quot; boolean set to true in order to continue the parsing even if an error occurs.&lt;/p&gt;

&lt;p&gt;Two PDFs have an object number greater than the max int value so the readInt() method fails.&lt;br/&gt;
Due to the &quot;forceParsing&quot; boolean, the parser try to go to the next object but it can&apos;t because on error the readInt method backtrack the read bytes and so &lt;br/&gt;
the &quot;skipToNextObj&quot; method does nothing and we try to parse the same object indefinitely...&lt;/p&gt;

&lt;p&gt;The COSObjectKey object already uses a long as object numder, so we should read a long instead of an integer during the parsing process using a &quot;readLong&quot; method to manage too large objects numbers.&lt;/p&gt;

&lt;p&gt;Are you agreed with that ?&lt;/p&gt;

&lt;p&gt;BR,&lt;br/&gt;
Eric&lt;/p&gt;</description>
                <environment></environment>
        <key id="12652507">PDFBOX-1639</key>
            <summary>Infinite loop with PDFParser used by tika.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="leleueri">Eric Leleu</assignee>
                                    <reporter username="leleueri">Eric Leleu</reporter>
                        <labels>
                    </labels>
                <created>Wed, 12 Jun 2013 22:01:44 +0000</created>
                <updated>Sat, 30 Nov 2013 17:02:14 +0000</updated>
                            <resolved>Sun, 16 Jun 2013 12:28:37 +0000</resolved>
                                    <version>1.7.1</version>
                    <version>1.8.2</version>
                    <version>2.0.0</version>
                                    <fixVersion>1.8.3</fixVersion>
                    <fixVersion>2.0.0</fixVersion>
                                    <component>Parsing</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="13681948" author="msahyoun" created="Thu, 13 Jun 2013 06:24:22 +0000"  >&lt;p&gt;Hi Eric,&lt;/p&gt;

&lt;p&gt;could you share a sample snippet from the decoded PDF source so it&apos;s clear which number you are talking about?&lt;/p&gt;

&lt;p&gt;BR&lt;br/&gt;
Maruan&lt;/p&gt;</comment>
                            <comment id="13681983" author="leleueri" created="Thu, 13 Jun 2013 07:20:00 +0000"  >&lt;p&gt;Hi, &lt;/p&gt;

&lt;p&gt;I&apos;m talking about the &quot;object number&quot; the first element in an Object Ref before the &quot;generation number&quot;.&lt;/p&gt;

&lt;p&gt;Here is the snippet  :&lt;/p&gt;

&lt;p&gt;  3793681698 0 obj&lt;br/&gt;
  &amp;lt;&amp;lt;&lt;br/&gt;
        /Type /DPart&lt;br/&gt;
        /Parent 805 0 R&lt;br/&gt;
        /DParts ...&lt;br/&gt;
  &amp;gt;&amp;gt;&lt;br/&gt;
  endobj&lt;/p&gt;


&lt;p&gt;The &quot;object number&quot; 3793681698 is a long not an integer.&lt;br/&gt;
I have fixed this issue using a  &quot;readLong&quot; method to read the &quot;object number&quot; and the &quot;generation number&quot; in each parser.&lt;/p&gt;

&lt;p&gt;It works fine and because the COSObjectKey already uses a long for these 2 attributes this shouldn&apos;t introduce regression.&lt;/p&gt;

&lt;p&gt;If you are agreed with me I can commit this fix today.&lt;/p&gt;

&lt;p&gt;BR,&lt;br/&gt;
Eric&lt;/p&gt;</comment>
                            <comment id="13681991" author="tboehme" created="Thu, 13 Jun 2013 07:30:26 +0000"  >&lt;p&gt;Hi,&lt;/p&gt;

&lt;p&gt;object numbers can have up to 10 digits so we should use a long for it in all places.&lt;/p&gt;

&lt;p&gt;Nevertheless we should be prepared that an even longer number might be in a malicious PDF so the error recovery procedure should be adjusted here as well.&lt;/p&gt;

&lt;p&gt;BR&lt;br/&gt;
Timo&lt;/p&gt;</comment>
                            <comment id="13681999" author="msahyoun" created="Thu, 13 Jun 2013 07:43:44 +0000"  >&lt;p&gt;Hi,&lt;/p&gt;

&lt;p&gt;as Timo wrote according to the spec 10 digits are permitted so I think the patch should be applied. If you could introduce some recovery for even longer values that would be great.&lt;/p&gt;

&lt;p&gt;BR&lt;br/&gt;
Maruan&lt;/p&gt;</comment>
                            <comment id="13682769" author="leleueri" created="Thu, 13 Jun 2013 21:27:37 +0000"  >&lt;p&gt;Hi,&lt;/p&gt;

&lt;p&gt;Here is my patch proposal. &lt;br/&gt;
If the objectNumber is too long (more than 10 digits) I&apos;m throwing an IllegalArgumentException because it might be in a malicious PDF (as Timo wrote).&lt;/p&gt;

&lt;p&gt;If there are no objection, I will commit this fix this week-end.&lt;/p&gt;

&lt;p&gt;BR,&lt;br/&gt;
Eric&lt;/p&gt;</comment>
                            <comment id="13683181" author="tboehme" created="Fri, 14 Jun 2013 08:02:22 +0000"  >&lt;p&gt;Hi,&lt;/p&gt;

&lt;p&gt;thanks for the patch. A view comments:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;object number must be positive (negative numbers should be counted as error; PDF Spec 1.7 chap. 3.2.9)&lt;/li&gt;
	&lt;li&gt;I would prefer throwing an IOException instead of IllegalArgumentException for following reasons:&lt;/li&gt;
	&lt;li&gt;IAE is a RuntimeException thus typically it won&apos;t be catched by PDFBox thus parsing breaks here without possibility of recover and even user code might not be prepared for it&lt;/li&gt;
	&lt;li&gt;if throwing IAE was to prevent the looping than maybe the recovery procedure has to be changed?&lt;/li&gt;
	&lt;li&gt;readInt/readLong used in the methods will already throw IOE if it is a malformed number and having a too large/small number is also a malformed number&lt;/li&gt;
	&lt;li&gt;we should use StringBuilder instead of StringBuffer in all cases (as long as only a single thread accesses the object)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;BR&lt;br/&gt;
Timo&lt;/p&gt;</comment>
                            <comment id="13684639" author="leleueri" created="Sun, 16 Jun 2013 12:27:23 +0000"  >&lt;p&gt;Hi,&lt;/p&gt;

&lt;p&gt;Here is a new version of the patch following Timo&apos;s recommendations. &lt;br/&gt;
This patch can be applied on the branch 1.8.x&lt;br/&gt;
It has been committed in the Trunk under the revision 1493503.&lt;/p&gt;


&lt;p&gt;BR,&lt;br/&gt;
Eric&lt;/p&gt;</comment>
                            <comment id="13824857" author="lehmi" created="Sun, 17 Nov 2013 14:33:24 +0000"  >&lt;p&gt;Merged into 1.8-branch in revision 1542735&lt;/p&gt;</comment>
                            <comment id="13835816" author="lehmi" created="Sat, 30 Nov 2013 17:02:14 +0000"  >&lt;p&gt;Closed after releasing 1.8.3&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12588019" name="PDFBox-1639-v2.patch" size="15501" author="leleueri" created="Sun, 16 Jun 2013 12:27:23 +0000"/>
                            <attachment id="12587710" name="PDFBox-1639.patch" size="13563" author="leleueri" created="Thu, 13 Jun 2013 21:27:37 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>332831</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 51 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1lezz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>333160</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>