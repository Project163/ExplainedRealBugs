<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:04:28 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PDFBOX-3519] COSName is not ascii</title>
                <link>https://issues.apache.org/jira/browse/PDFBOX-3519</link>
                <project id="12310760" key="PDFBOX">PDFBox</project>
                    <description>&lt;p&gt;Trunk seems ok&lt;br/&gt;
PDF is from &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-783&quot; title=&quot;pdf to image conversion&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-783&quot;&gt;&lt;del&gt;PDFBOX-783&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void main( &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] args ) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException {
    PDDocument doc = PDDocument.load(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; File(&lt;span class=&quot;code-quote&quot;&gt;&quot;A02Gj780LZ.pdf&quot;&lt;/span&gt;));
    COSDictionary x = doc.getPage(0).getResources().getCOSObject();
        read(x);
    doc.close();
}

&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void read(COSBase b) {
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (b &lt;span class=&quot;code-keyword&quot;&gt;instanceof&lt;/span&gt; COSObject) {
        read(((COSObject) b).getObject());
    } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (b &lt;span class=&quot;code-keyword&quot;&gt;instanceof&lt;/span&gt; COSDictionary) {
        &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (COSBase x : ((COSDictionary) b).getValues()) {
            read(x);
        }
    } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (b &lt;span class=&quot;code-keyword&quot;&gt;instanceof&lt;/span&gt; COSName) {
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt;(((COSName) b).getName().charAt(0) &amp;gt; 256)
            &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; RuntimeException(((COSName) b).getName());
    }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13008872">PDFBOX-3519</key>
            <summary>COSName is not ascii</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="lehmi">Andreas Lehmk&#252;hler</assignee>
                                    <reporter username="ssteiner">Simon Steiner</reporter>
                        <labels>
                    </labels>
                <created>Fri, 30 Sep 2016 13:20:19 +0000</created>
                <updated>Mon, 15 May 2017 20:28:13 +0000</updated>
                            <resolved>Fri, 5 May 2017 16:07:04 +0000</resolved>
                                    <version>2.0.3</version>
                                    <fixVersion>2.0.6</fixVersion>
                    <fixVersion>3.0.0 PDFBox</fixVersion>
                                    <component>Parsing</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="15537064" author="jahewson" created="Fri, 30 Sep 2016 21:04:00 +0000"  >&lt;p&gt;A COSName can contain any Unicode character, it&apos;s not restricted to ASCII. In the PDF file these are stored as UTF-8 hex escaped with a #.&lt;/p&gt;</comment>
                            <comment id="15538056" author="msahyoun" created="Sat, 1 Oct 2016 07:04:46 +0000"  >&lt;p&gt;The entry is question is&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;13 0 obj&amp;lt;&amp;lt;/Subtype/Type0/DescendantFonts[23 0 R]/BaseFont/#82l#82r#96#BE#92#A9/Encoding/90ms-RKSJ-H/Type/Font&amp;gt;&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;where trunk brings this (on console)&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;COSName{&#130;l&#130;r&#150;&#190;&amp;rsquo;&#169;}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;and 2.0.3 bring this (on console)&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;COSName{&#65533;l&#65533;r&#65533;&#65533;&#65533;&#65533;}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Maybe both are not correct?&lt;/p&gt;</comment>
                            <comment id="15538916" author="jahewson" created="Sat, 1 Oct 2016 17:54:29 +0000"  >&lt;p&gt;Ok, so:&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;#82l#82r#96#BE#92#A9&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;Consists of the following tokens:&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;#82&lt;/tt&gt; &lt;tt&gt;l&lt;/tt&gt; &lt;tt&gt;#82&lt;/tt&gt; &lt;tt&gt;r&lt;/tt&gt; &lt;tt&gt;#96&lt;/tt&gt; &lt;tt&gt;#BE&lt;/tt&gt; &lt;tt&gt;#92&lt;/tt&gt; &lt;tt&gt;#A9&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;The #xx are UTF-8 escapes, however, none of the byte sequences are valid UTF-8 byte sequences. So this name is invalid.&lt;/p&gt;

&lt;p&gt;I&apos;ve noticed that CJK PDFs, such as the one here, sometimes contain invalid escape codes which are not UTF-8. I assume in this case the codes actually correspond to &quot;90ms-RKSJ-H&quot;, which uses the &quot;Adobe-Japan1&quot; encoding (aka &quot;Shift-JIS&quot;).&lt;/p&gt;

&lt;p&gt;Are you seeing different behaviour on the trunk?&lt;/p&gt;</comment>
                            <comment id="15541886" author="ssteiner1" created="Mon, 3 Oct 2016 08:38:30 +0000"  >&lt;p&gt;I guess not a big deal, just why is 2.0 different from trunk&lt;/p&gt;</comment>
                            <comment id="15541904" author="msahyoun" created="Mon, 3 Oct 2016 08:53:15 +0000"  >&lt;p&gt;It could also be read as &lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&#8218;l&#8218;r&#8211;&#190;&#8217;&#169;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;which is inline with what Adobe Acrobat is showing &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12831284/12831284_COSNameAcrobat.png&quot; title=&quot;COSNameAcrobat.png attached to PDFBOX-3519&quot;&gt;COSNameAcrobat.png&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;&lt;/p&gt;</comment>
                            <comment id="15543016" author="jahewson" created="Mon, 3 Oct 2016 18:06:29 +0000"  >&lt;p&gt;You haven&apos;t said what result the trunk produces...&lt;/p&gt;</comment>
                            <comment id="15543041" author="jahewson" created="Mon, 3 Oct 2016 18:16:18 +0000"  >&lt;p&gt;Strange, that&apos;s almost equivalent to an ASCII intepretation:&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;#82&lt;/tt&gt; &lt;tt&gt;l&lt;/tt&gt; &lt;tt&gt;#82&lt;/tt&gt; &lt;tt&gt;r&lt;/tt&gt; &lt;tt&gt;#96&lt;/tt&gt; &lt;tt&gt;#BE&lt;/tt&gt; &lt;tt&gt;#92&lt;/tt&gt; &lt;tt&gt;#A9&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;As ASCII gives:&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;#82&lt;/tt&gt; &lt;tt&gt;l&lt;/tt&gt; &lt;tt&gt;#82&lt;/tt&gt; &lt;tt&gt;r&lt;/tt&gt; &lt;tt&gt;#96&lt;/tt&gt; &lt;tt&gt;&#190;&lt;/tt&gt; &lt;tt&gt;#92&lt;/tt&gt; &lt;tt&gt;&#169;&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;As you can see, it doesn&apos;t account for the control characters - which became &lt;tt&gt;,&lt;/tt&gt; 0x2C and &lt;tt&gt;-&lt;/tt&gt; 0x2D. I&apos;ve left them as hex. But &lt;tt&gt;&#8217;&lt;/tt&gt; 0x0219 isn&apos;t ASCII, it&apos;s Unicode.&lt;/p&gt;</comment>
                            <comment id="15543055" author="jahewson" created="Mon, 3 Oct 2016 18:21:36 +0000"  >&lt;p&gt;It&apos;s worth noting that interpreting the two pairs of hex escapes as Unicode code points (not in the PDF spec) would give us plausible CJK:&lt;/p&gt;

&lt;p&gt;0x96BE = &#38590;&lt;br/&gt;
0x92A9 = &#37545;&lt;/p&gt;

&lt;p&gt;But still not account for those control characters.&lt;/p&gt;</comment>
                            <comment id="15543098" author="msahyoun" created="Mon, 3 Oct 2016 18:42:16 +0000"  >&lt;p&gt;Yes, it&apos;s equivalent to an ASCII interpretation.&lt;/p&gt;

&lt;p&gt;Worth noting is that&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;using hex does not automatically mean that we are dealing with unicode. E.g. #20 shall be used for encoding a space within a name where prior to PDF 1.2 # alone was used as a placeholder&lt;/li&gt;
	&lt;li&gt;after decoding the hex code a name might be in UTF-8&lt;/li&gt;
	&lt;li&gt;the bytes making up the name shall be used as the names value and not the string representation.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;There is also an error in above string - which I&apos;ll correct (I was using a comma instead of the quotation mark)&lt;/p&gt;

&lt;p&gt;According to Extented ASCII Table ISO-8859-1:&lt;br/&gt;
#82 is &lt;tt&gt;&#8218;&lt;/tt&gt; &lt;tt&gt;Single low-9 quotation mark&lt;/tt&gt;&lt;br/&gt;
#96 is &lt;tt&gt;&#8211;&lt;/tt&gt; &lt;tt&gt;En dash&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;Details in the PDF spec. &lt;/p&gt;</comment>
                            <comment id="15584524" author="msahyoun" created="Tue, 18 Oct 2016 05:34:22 +0000"  >&lt;p&gt;Acrobat seems to interpret the encoding instead of ISO 8859-1 as Wndows-1252. Doing so would give us the same string as Acrobat presents as it&apos;s including the missing #80 to #9F characters.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jahewson&quot; class=&quot;user-hover&quot; rel=&quot;jahewson&quot;&gt;jahewson&lt;/a&gt; WDYT about changing the behavior implemented in &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3347&quot; title=&quot;COSName parsing doesn&amp;#39;t handle ISO-8859-1 encoded bytes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3347&quot;&gt;&lt;del&gt;PDFBOX-3347&lt;/del&gt;&lt;/a&gt; to use &lt;tt&gt;Windows-1252&lt;/tt&gt; instead of &lt;tt&gt;ISO 8859-1&lt;/tt&gt; as it&apos;s currently implemented.&lt;/p&gt;</comment>
                            <comment id="15584667" author="jahewson" created="Tue, 18 Oct 2016 06:56:17 +0000"  >&lt;p&gt;Yep, I think that would be fine.&lt;/p&gt;</comment>
                            <comment id="15626766" author="jira-bot" created="Tue, 1 Nov 2016 21:45:40 +0000"  >&lt;p&gt;Commit 1767585 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=msahyoun&quot; class=&quot;user-hover&quot; rel=&quot;msahyoun&quot;&gt;msahyoun&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1767585&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1767585&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3519&quot; title=&quot;COSName is not ascii&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3519&quot;&gt;&lt;del&gt;PDFBOX-3519&lt;/del&gt;&lt;/a&gt;: use Windows-1252 encoding when parsing COSName values if not UTF-8&lt;/p&gt;</comment>
                            <comment id="15626782" author="msahyoun" created="Tue, 1 Nov 2016 21:50:44 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jahewson&quot; class=&quot;user-hover&quot; rel=&quot;jahewson&quot;&gt;jahewson&lt;/a&gt; the fix you made in &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3347&quot; title=&quot;COSName parsing doesn&amp;#39;t handle ISO-8859-1 encoded bytes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3347&quot;&gt;&lt;del&gt;PDFBOX-3347&lt;/del&gt;&lt;/a&gt; was available in truck only not in 2.0.x - should that be incorporated there too.&lt;/p&gt;</comment>
                            <comment id="15998508" author="lehmi" created="Fri, 5 May 2017 16:05:02 +0000"  >&lt;p&gt;I&apos;ve reopened &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3347&quot; title=&quot;COSName parsing doesn&amp;#39;t handle ISO-8859-1 encoded bytes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3347&quot;&gt;&lt;del&gt;PDFBOX-3347&lt;/del&gt;&lt;/a&gt; and applied the changes to the 2.0 branch as well&lt;/p&gt;</comment>
                            <comment id="15998510" author="jira-bot" created="Fri, 5 May 2017 16:05:56 +0000"  >&lt;p&gt;Commit 1794070 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lehmi&quot; class=&quot;user-hover&quot; rel=&quot;lehmi&quot;&gt;lehmi&lt;/a&gt; in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1794070&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1794070&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3519&quot; title=&quot;COSName is not ascii&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3519&quot;&gt;&lt;del&gt;PDFBOX-3519&lt;/del&gt;&lt;/a&gt;: use Windows-1252 encoding when parsing COSName values if not UTF-8&lt;/p&gt;</comment>
                            <comment id="15998511" author="lehmi" created="Fri, 5 May 2017 16:07:04 +0000"  >&lt;p&gt;I&apos;ve merged Maruans changes to the 2.0 branch as well. Set to resolved&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12831284" name="COSNameAcrobat.png" size="2194" author="msahyoun" created="Mon, 3 Oct 2016 08:53:15 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 28 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i34avb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>