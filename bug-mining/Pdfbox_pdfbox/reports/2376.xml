<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:10:20 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PDFBOX-4883] COSFloat is extremely slow</title>
                <link>https://issues.apache.org/jira/browse/PDFBOX-4883</link>
                <project id="12310760" key="PDFBOX">PDFBox</project>
                    <description>&lt;p&gt;I am testing text extraction from PDF and profiling the execution.&lt;/p&gt;

&lt;p&gt;I found that biggest time consumer is the COSFloat class.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;All other improvements I suggested so far are small compared to this.&lt;/p&gt;

&lt;p&gt;But this is the also the most complex one.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;I have attached te profiler output for the same text extraction, with and without the COSFloat changes.&lt;/p&gt;

&lt;p&gt;The time to extract the same text was 4 times long with the original COSFlow, because of its use of BigDecimal.&lt;/p&gt;

&lt;p&gt;I will try to write extra tests for all cases I see in the original COSFLoat code, if they are not already tested.&lt;/p&gt;

&lt;p&gt;Then I will submit for review a new COSFloat version.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;I think this affects parsing and displaying PDFs too, not just text extraction.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13311325">PDFBOX-4883</key>
            <summary>COSFloat is extremely slow</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="lehmi">Andreas Lehmk&#252;hler</assignee>
                                    <reporter username="Faltiska">Alfred</reporter>
                        <labels>
                            <label>display</label>
                            <label>optimization</label>
                            <label>parsing</label>
                            <label>textextraction</label>
                    </labels>
                <created>Sun, 14 Jun 2020 10:18:48 +0000</created>
                <updated>Fri, 18 Aug 2023 05:46:10 +0000</updated>
                            <resolved>Wed, 1 Jul 2020 14:30:02 +0000</resolved>
                                    <version>2.0.20</version>
                    <version>3.0.0 PDFBox</version>
                                    <fixVersion>3.0.0 PDFBox</fixVersion>
                                    <component>PDModel</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="17135105" author="tilman" created="Sun, 14 Jun 2020 10:25:17 +0000"  >&lt;p&gt;I can&apos;t find it now, but there was a reason why we haven&apos;t changed it despite that it is so inefficient.&lt;/p&gt;</comment>
                            <comment id="17135108" author="faltiska" created="Sun, 14 Jun 2020 10:34:11 +0000"  >&lt;p&gt;I would like to try &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;If we had tests for all current features in COSFloat, it could safe enough.&lt;/p&gt;

&lt;p&gt;Plus code review and real life PDF rendering tests...&lt;/p&gt;</comment>
                            <comment id="17135119" author="lehmi" created="Sun, 14 Jun 2020 11:08:13 +0000"  >&lt;blockquote&gt;&lt;p&gt;I can&apos;t find it now, but there was a reason why we haven&apos;t changed it despite that it is so inefficient.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;See &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-1778&quot; title=&quot;Rounding issue in generated PDF file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-1778&quot;&gt;&lt;del&gt;PDFBOX-1778&lt;/del&gt;&lt;/a&gt; for further information&lt;/p&gt;</comment>
                            <comment id="17135173" author="tilman" created="Sun, 14 Jun 2020 14:02:06 +0000"  >&lt;p&gt;Wow this is so long ago. I have a faint memory that it was also something about objects being unique / final / immutable or not.&lt;/p&gt;</comment>
                            <comment id="17135191" author="faltiska" created="Sun, 14 Jun 2020 15:12:05 +0000"  >&lt;p&gt;I ran the COSFloat tests with coverage and noted the lines not touched.&lt;/p&gt;

&lt;p&gt;Then I added extra test for the missed cases.&lt;br/&gt;
While doing that I noticed a very small bug for negative infinity so I fixed that.&lt;/p&gt;

&lt;p&gt;This is a patch just for the test, and this small bugfix.&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/13006132/13006132_PDFBOX-4883.patch&quot; title=&quot;PDFBOX-4883.patch attached to PDFBOX-4883&quot;&gt;PDFBOX-4883.patch&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;And this is the review:&#160;&lt;a href=&quot;https://diffy.org/diff/ay8csf3nq4lpmmyqmronr8uxr&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://diffy.org/diff/ay8csf3nq4lpmmyqmronr8uxr&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17135198" author="jira-bot" created="Sun, 14 Jun 2020 15:44:00 +0000"  >&lt;p&gt;Commit 1878834 from lehmi@apache.org in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1878834&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1878834&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4883&quot; title=&quot;COSFloat is extremely slow&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4883&quot;&gt;&lt;del&gt;PDFBOX-4883&lt;/del&gt;&lt;/a&gt;: add test cases by Alfred Faltiska&lt;/p&gt;</comment>
                            <comment id="17135199" author="jira-bot" created="Sun, 14 Jun 2020 15:45:11 +0000"  >&lt;p&gt;Commit 1878835 from lehmi@apache.org in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1878835&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1878835&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4883&quot; title=&quot;COSFloat is extremely slow&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4883&quot;&gt;&lt;del&gt;PDFBOX-4883&lt;/del&gt;&lt;/a&gt;: optimize checkMinMaxValues and removeNullDigits&lt;/p&gt;</comment>
                            <comment id="17135200" author="lehmi" created="Sun, 14 Jun 2020 15:47:20 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Faltiska&quot; class=&quot;user-hover&quot; rel=&quot;Faltiska&quot;&gt;Faltiska&lt;/a&gt; I&apos;ve added the new test cases and an optimized version of COSFloat. I&apos;ve simplified checkMinMaxValues and removeNullDigits so that your fix shouldn&apos;t be necessary any more&lt;/p&gt;</comment>
                            <comment id="17135219" author="faltiska" created="Sun, 14 Jun 2020 16:29:40 +0000"  >&lt;p&gt;I had a look at the new checkMinMaxValues()&lt;/p&gt;

&lt;p&gt;That is very nice!!&lt;/p&gt;</comment>
                            <comment id="17135228" author="faltiska" created="Sun, 14 Jun 2020 16:44:18 +0000"  >&lt;p&gt;I am not sure I understood the code correctly.&lt;br/&gt;
 I think we are trying to keep COSFloat between +/-MIN_NORMAL and +/-MAX_VALUE all the time.&lt;/p&gt;

&lt;p&gt;At the same time, we have a COSFloat.doubleValue()&lt;/p&gt;

&lt;p&gt;In PDFBox, .doubleValue() is used only in tests.&lt;/p&gt;

&lt;p&gt;The Preflight project uses .doubleValue(), but only to compare it with +/-32767f&#160;&lt;br/&gt;
 A float is enough for that comparison, no need for a double.&lt;/p&gt;

&lt;p&gt;Apart form that, doubleValue is not used anywhere.&lt;/p&gt;

&lt;p&gt;Does PDF processing require more precision that we can get from a float?&lt;/p&gt;</comment>
                            <comment id="17136058" author="faltiska" created="Mon, 15 Jun 2020 17:36:41 +0000"  >&lt;p&gt;I think doubleValue is not used anywhere except tests.&lt;br/&gt;
If we don&apos;t need it, I think I have a solution.&lt;/p&gt;

&lt;p&gt;The only change is that I use Float instead of BigDecimal.&lt;/p&gt;

&lt;p&gt;It passes all tests and it is about 3-4 times faster.&lt;/p&gt;

&lt;p&gt;review: &lt;a href=&quot;https://diffy.org/diff/do3x37sa04x5abhju76d5nrk9&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://diffy.org/diff/do3x37sa04x5abhju76d5nrk9&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;patch:&#160;&lt;span class=&quot;error&quot;&gt;&amp;#91;^Faster_COSFloat_PDFBOX-4883.patch&amp;#93;&lt;/span&gt;&lt;/p&gt;</comment>
                            <comment id="17136120" author="lehmi" created="Mon, 15 Jun 2020 19:45:43 +0000"  >&lt;p&gt;We don&apos;t need double precision for PDF processing but need it for the internal representation, see &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-1778&quot; title=&quot;Rounding issue in generated PDF file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-1778&quot;&gt;&lt;del&gt;PDFBOX-1778&lt;/del&gt;&lt;/a&gt;. I&apos;m afraid we can&apos;t simply replace the BigDecimal with a Float.&lt;/p&gt;

&lt;p&gt;But I looks like we don&apos;t need the doubleValue method. I&apos;m going to check that and remove it.&lt;/p&gt;</comment>
                            <comment id="17136332" author="jira-bot" created="Tue, 16 Jun 2020 05:59:16 +0000"  >&lt;p&gt;Commit 1878876 from lehmi@apache.org in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1878876&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1878876&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4883&quot; title=&quot;COSFloat is extremely slow&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4883&quot;&gt;&lt;del&gt;PDFBOX-4883&lt;/del&gt;&lt;/a&gt;: replace doubleValue with floatValue&lt;/p&gt;</comment>
                            <comment id="17136681" author="faltiska" created="Tue, 16 Jun 2020 14:08:11 +0000"  >&lt;p&gt;Regarding see&#160;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-1778&quot; title=&quot;Rounding issue in generated PDF file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-1778&quot;&gt;&lt;del&gt;PDFBOX-1778&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;I have preserved that functionality.&#160;&lt;br/&gt;
 I still use BigDecimal for converting COSFloat to string, with exact number of decimals as before.&lt;/p&gt;

&lt;p&gt;The new solution does not introduce any rounding as far as I can tell.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;One more thing worth mentioning.&lt;br/&gt;
The new solution is 4 times faster when viewing PDF or extracting text.&lt;br/&gt;
I am avoiding the conversion to until actually needed.&lt;br/&gt;
I think that part is required only when writing PDF files.&lt;/p&gt;</comment>
                            <comment id="17141377" author="faltiska" created="Sun, 21 Jun 2020 10:08:44 +0000"  >&lt;p&gt;Hi Andreas,&lt;/p&gt;

&lt;p&gt;I have tested the new code with the document that was exhibiting the problem in&#160;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-1778&quot; title=&quot;Rounding issue in generated PDF file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-1778&quot;&gt;&lt;del&gt;PDFBOX-1778&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
 The result is as expected, you can see the concentric black circles.&lt;/p&gt;

&lt;p&gt;This is the result:&#160;&lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/13006131/13006131_extreme-values-out.pdf&quot; title=&quot;extreme-values-out.pdf attached to PDFBOX-4883&quot;&gt;extreme-values-out.pdf&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;&lt;br/&gt;
 I used the WriteDecodedDoc command to test. Is that a relevant test?&lt;/p&gt;

&lt;p&gt;thanks,&lt;br/&gt;
 Alfred&lt;/p&gt;




&lt;p&gt;I&apos;ve updated from trunk.&#160;&lt;br/&gt;
 new review: &lt;a href=&quot;https://diffy.org/diff/3awbkmf5z8ntbaocigmgarwwmi&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://diffy.org/diff/3awbkmf5z8ntbaocigmgarwwmi&lt;/a&gt;&lt;br/&gt;
 new patch:&#160;&lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/13006132/13006132_PDFBOX-4883.patch&quot; title=&quot;PDFBOX-4883.patch attached to PDFBOX-4883&quot;&gt;PDFBOX-4883.patch&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;&lt;/p&gt;</comment>
                            <comment id="17146958" author="jira-bot" created="Sat, 27 Jun 2020 13:39:54 +0000"  >&lt;p&gt;Commit 1879271 from lehmi@apache.org in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1879271&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1879271&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4883&quot; title=&quot;COSFloat is extremely slow&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4883&quot;&gt;&lt;del&gt;PDFBOX-4883&lt;/del&gt;&lt;/a&gt;: optimize internal representation of float values based on a proposal by Alfred Faltiska, remove method doubleValue&lt;/p&gt;</comment>
                            <comment id="17146962" author="jira-bot" created="Sat, 27 Jun 2020 13:44:45 +0000"  >&lt;p&gt;Commit 1879273 from lehmi@apache.org in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1879273&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1879273&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4883&quot; title=&quot;COSFloat is extremely slow&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4883&quot;&gt;&lt;del&gt;PDFBOX-4883&lt;/del&gt;&lt;/a&gt;: deprecate doubleFloat()&lt;/p&gt;</comment>
                            <comment id="17146963" author="jira-bot" created="Sat, 27 Jun 2020 13:45:06 +0000"  >&lt;p&gt;Commit 1879274 from lehmi@apache.org in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1879274&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1879274&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4883&quot; title=&quot;COSFloat is extremely slow&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4883&quot;&gt;&lt;del&gt;PDFBOX-4883&lt;/del&gt;&lt;/a&gt;: replace doubleFloat() with floatValue()&lt;/p&gt;</comment>
                            <comment id="17146964" author="lehmi" created="Sat, 27 Jun 2020 13:49:55 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Faltiska&quot; class=&quot;user-hover&quot; rel=&quot;Faltiska&quot;&gt;Faltiska&lt;/a&gt; your last patch looks good and I&apos;ve committed the changes with some slight changes. The key aspect is to save the string representation within the constuctor with the string as parameter so that the origin representation is preserved. Thanks for your input and your persistence &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="17147225" author="faltiska" created="Sun, 28 Jun 2020 06:20:43 +0000"  >&lt;p&gt;No problem! I am happy to be able to contribute.&lt;/p&gt;</comment>
                            <comment id="17147229" author="faltiska" created="Sun, 28 Jun 2020 06:49:48 +0000"  >&lt;p&gt;One aspect got lost.&lt;/p&gt;

&lt;p&gt;I was keeping the original string representation &lt;em&gt;only&lt;/em&gt; if it was a valid float.&lt;br/&gt;
 It is possible that it is not valid, and it could be replaced with a valid one:&lt;br/&gt;
 1. The constructor could replace the value trying to work around some known bugs&lt;br/&gt;
 2. The method&#160;checkMinMaxValues could also replace the float if it was too small or too large.&lt;br/&gt;
 In both cases, the new value does not correspond to the original string rep.&lt;/p&gt;

&lt;p&gt;I suggest we only keep the original string if it was valid, otherwise leave it null.&lt;br/&gt;
 The method formatString will lazily build a new correct string rep later, if needed.&lt;/p&gt;

&lt;p&gt;I have also removed the escaping of the &apos;-&apos; char in the regex. It does not have to be escaped.&lt;/p&gt;

&lt;p&gt;New patch:&#160;&lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/13006607/13006607_PDFBOX-4883-b.patch&quot; title=&quot;PDFBOX-4883-b.patch attached to PDFBOX-4883&quot;&gt;PDFBOX-4883-b.patch&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;Review:&#160;&lt;a href=&quot;https://diffy.org/diff/dxgjvkugt4k5hhgdytz060f6r&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://diffy.org/diff/dxgjvkugt4k5hhgdytz060f6r&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17147341" author="jira-bot" created="Sun, 28 Jun 2020 13:32:15 +0000"  >&lt;p&gt;Commit 1879308 from lehmi@apache.org in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1879308&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1879308&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4883&quot; title=&quot;COSFloat is extremely slow&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4883&quot;&gt;&lt;del&gt;PDFBOX-4883&lt;/del&gt;&lt;/a&gt;: don&apos;t save string representation if the float value is replaced based on a proposal by Alfred Faltiska&lt;/p&gt;</comment>
                            <comment id="17147342" author="lehmi" created="Sun, 28 Jun 2020 13:36:31 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Faltiska&quot; class=&quot;user-hover&quot; rel=&quot;Faltiska&quot;&gt;Faltiska&lt;/a&gt; You are correct that aspect got lost. But your patch isn&apos;t that strict too. It would set the string even if the value was changed within the constructor. Now it is set only if the parsing went well and the check doesn&apos;t replace the value. I&apos;ve included the other changes as well&lt;/p&gt;</comment>
                            <comment id="17147401" author="faltiska" created="Sun, 28 Jun 2020 17:40:18 +0000"  >&lt;p&gt;Hey, you&apos;re right &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;Good catch!&lt;/p&gt;</comment>
                            <comment id="17148853" author="faltiska" created="Tue, 30 Jun 2020 17:33:25 +0000"  >&lt;p&gt;I&apos;ve profiled the new code and it looks good.&lt;/p&gt;

&lt;p&gt;Before the change, BigDecimal.floatValue(String) was taking 8 times more than all the matrix multiplications performed to parse a PDF.&lt;/p&gt;

&lt;p&gt;Now I only see Float.valueOf(String), which takes half the time needed by the matrix multiplications.&lt;/p&gt;

&lt;p&gt;&#160;&#160;&lt;/p&gt;

&lt;p&gt;Who knew BigDecimal was so slow ...&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17149475" author="lehmi" created="Wed, 1 Jul 2020 14:30:02 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Faltiska&quot; class=&quot;user-hover&quot; rel=&quot;Faltiska&quot;&gt;Faltiska&lt;/a&gt; Thanks for the feedback. I guess we are done here, set to resolved&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="13005667" name="After.png" size="40791" author="Faltiska" created="Sun, 14 Jun 2020 17:10:23 +0000"/>
                            <attachment id="13005649" name="Before.png" size="53975" author="Faltiska" created="Sun, 14 Jun 2020 10:31:25 +0000"/>
                            <attachment id="13006607" name="PDFBOX-4883-b.patch" size="3943" author="Faltiska" created="Sun, 28 Jun 2020 06:55:10 +0000"/>
                            <attachment id="13006132" name="PDFBOX-4883.patch" size="11534" author="Faltiska" created="Sun, 21 Jun 2020 10:15:22 +0000"/>
                            <attachment id="13006131" name="extreme-values-out.pdf" size="26450" author="Faltiska" created="Sun, 21 Jun 2020 10:08:18 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 19 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0ftxc:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>