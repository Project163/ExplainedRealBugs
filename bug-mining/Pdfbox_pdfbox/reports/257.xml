<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 20:53:50 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PDFBOX-1424] Wrong glyph (Persian)  is used in extacted text instead of the original glyph (Persian) in PDF file</title>
                <link>https://issues.apache.org/jira/browse/PDFBOX-1424</link>
                <project id="12310760" key="PDFBOX">PDFBox</project>
                    <description>&lt;p&gt;Hi&lt;br/&gt;
I am very new to PDFBox and I am dealing with Persian PDF files. When I convert Persian PDF files using PDFBox-app, some Persian glyphs like &#1605; are displayed wrongly in the extracted text. For example, the word &quot;&#1607;&#1587;&#1578;&#1605;&quot; in Persian is extracted as &quot;&#1607;&#1587;&#1578;&#1606;&quot; and &quot;&#1605;&#1606;&quot; in Persian is extracted as &quot;&#1607;&#1606;&quot;. Also, the word &quot;&#1587;&#1604;&#1575;&#1605;&quot; is extracted as &quot;&#1587;&#1575;&#1604;&#1605;&quot;. By the way, I have tested extracting text from a complete Persian PDF file with multiple pages; the result is disappointing. Actually, it is totally wrong. Please let me know if I should upload an example Persian PDF file.&lt;/p&gt;</description>
                <environment>Windows XP, Java 1.6.0</environment>
        <key id="12611084">PDFBOX-1424</key>
            <summary>Wrong glyph (Persian)  is used in extacted text instead of the original glyph (Persian) in PDF file</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="lehmi">Andreas Lehmk&#252;hler</assignee>
                                    <reporter username="majdzadeh">Ali Majdzadeh Kohbanani</reporter>
                        <labels>
                    </labels>
                <created>Tue, 9 Oct 2012 22:48:23 +0000</created>
                <updated>Sat, 23 Mar 2013 12:56:09 +0000</updated>
                            <resolved>Thu, 1 Nov 2012 17:50:56 +0000</resolved>
                                    <version>1.7.1</version>
                                    <fixVersion>1.8.0</fixVersion>
                                    <component>Text extraction</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="13475831" author="lehmi" created="Sun, 14 Oct 2012 12:42:40 +0000"  >&lt;p&gt;Please attach a sample pdf&lt;/p&gt;</comment>
                            <comment id="13475897" author="majdzadeh" created="Sun, 14 Oct 2012 20:39:38 +0000"  >&lt;p&gt;Hi Andreas,&lt;br/&gt;
Thanks for your attention. I have uploaded a sample PDF file and the HTML output generated by pdfbox-app.&lt;/p&gt;</comment>
                            <comment id="13477249" author="lehmi" created="Tue, 16 Oct 2012 18:33:10 +0000"  >&lt;p&gt;Sorry, no offense, but as an european I have to admit that everything is looking the same for me &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;/p&gt;

&lt;p&gt;Can you please help me to understand the problem in detail, so that I might find out where to look.&lt;/p&gt;

&lt;p&gt;For example:&lt;/p&gt;

&lt;p&gt;the word &quot;&#1587;&#1604;&#1575;&#1605;&quot; is extracted as &quot;&#1587;&#1575;&#1604;&#1605;&quot; &lt;/p&gt;

&lt;p&gt;What is wrong here? Is the correct word a ligature? Are the characters simply the wrong ones? If so, why are they wrong (wrong character, wrong language)? What about the other issues, are they similar?&lt;/p&gt;</comment>
                            <comment id="13477307" author="majdzadeh" created="Tue, 16 Oct 2012 20:10:15 +0000"  >&lt;p&gt;Andreas,&lt;br/&gt;
Thanks for your comment. You are right, these problems are somehow difficult to explain since we don&apos;t speak the same language &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;br/&gt;
I will try to explain the issues with more details. The word &quot;&#1607;&#1587;&#1578;&#1605;&quot; in Persian means &quot;I am&quot;. For example, &quot;I am Ali&quot; in Persian is &quot;&#1605;&#1606; &#1593;&#1604;&#1740; &#1607;&#1587;&#1578;&#1605;&quot;, while the extracted text by PDFBox for this word is &quot;&#1607;&#1587;&#1578;&#1606;&quot; which in everyday Persian is not used, but actually it means &quot;being&quot;. The issue is that the character &quot;&#1605;&quot; is extracted as the character &quot;&#1606;&quot;. Concerning the word &quot;&#1587;&#1604;&#1575;&#1605;&quot; the problem is the ligature &quot;&#1604;&#1575;&quot; which consists of characters &quot;&#1604;&quot; and &quot;&#1575;&quot;. This ligature is extracted as &quot;&#1575;&#1604;&quot; so that the word &quot;&#1587;&#1604;&#1575;&#1605;&quot; which in Persian means &quot;Hello&quot; is extracted as &quot;&#1587;&#1575;&#1604;&#1605;&quot; which in Persian means &quot;Healthy&quot;!&lt;br/&gt;
Andreas, I have also noticed that these problems do not occur in certain PDF files. For example, the file Complex.pdf uploaded as an example in &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-713&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/TIKA-713&lt;/a&gt; has non of these problems. Maybe these issues are because of the way the PDF is generated. Are there exist special requirements to meet in order to create PDFBox-compatible PDF files? Should I use specific tools in order to create PDF files?&lt;br/&gt;
As another example, when I use PDFCreator in order to create PDF files and try to extract text from them using PDFBox, the result is some junk characters! However, when I use the &quot;Save as PDF&quot; plugin for Microsoft Word provided by Microsoft, the extracted text is valid but contains the errors I described above. I don&apos;t know how Complex.pdf is created, but it contains minimum errors, at least, it doesn&apos;t contain the errors I described. Concerning Complex.pdf, I just noticed some words being displaced in extracted text, but the extracted text didn&apos;t contain these errors.&lt;br/&gt;
I searched a lot and tested various tools in order to create PDF files so that PDFBox will be able to extract text from them, but I had no success. Sorry, but another question that sounds to me related to this issue is the subject of fonts. Does the font used in order to type the document and is embedded in the PDF file created from the document affect the quality of text extraction performed by PDFBox?&lt;br/&gt;
I think this comment became too long, sorry for that and lots of thanks for your consideration and attention.&lt;/p&gt;</comment>
                            <comment id="13477715" author="lehmi" created="Wed, 17 Oct 2012 08:19:31 +0000"  >&lt;p&gt;Thanks for the explanation. I guess there is an issue with the ToUnicode-mapping, probable the CMap-parser. I have to dig deeper into it to be sure.&lt;/p&gt;

&lt;p&gt;And yes, it depends on the used fonts if PDFBox is able to extract the text correctly. But you don&apos;t have to search for a way to create PDFBox-compatible pdfs. We have to fix/improve PDFBox so that every pdf can be extracted except those which doesn&apos;t provide any mapping information.&lt;/p&gt;</comment>
                            <comment id="13478344" author="majdzadeh" created="Wed, 17 Oct 2012 20:36:35 +0000"  >&lt;p&gt;Thanks for your attention. Hope these reports help improving PDFBox, please let me know if I should perform any further testing. A question that raised for me regarding your comment was that how is it possible to know whether a PDF file provides mapping information? Well, since I think the error that I face by using PDFCreator in order to create PDF files and using PDFBox to extract text from them is related to missing mapping information.&lt;br/&gt;
Thanks again for your consideration.&lt;/p&gt;</comment>
                            <comment id="13478711" author="lehmi" created="Thu, 18 Oct 2012 06:09:28 +0000"  >&lt;p&gt;Nothing easier than that, just do the &quot;adobe test&quot;. Open the pdf in question using the adobe reader and copy&amp;amp;paste the text. If the file doesn&apos;t provide any (or limited) mapping information it&apos;ll be (partly) unreadable &lt;/p&gt;</comment>
                            <comment id="13478801" author="majdzadeh" created="Thu, 18 Oct 2012 08:43:20 +0000"  >&lt;p&gt;Thanks Andreas, please let me know if I should perform any further testing.&lt;/p&gt;</comment>
                            <comment id="13488881" author="lehmi" created="Thu, 1 Nov 2012 17:50:56 +0000"  >&lt;p&gt;I fixed the issue in revision 1404690.&lt;/p&gt;

&lt;p&gt;The method TextNormalizer.makeLineLogicalOrder reordered all characters including ligatures byte by byte which broke all ligatures.I eliminated the usage of that method and replaced it with a simple descending loop.&lt;/p&gt;

&lt;p&gt;I attached the fixed result.&lt;/p&gt;</comment>
                            <comment id="13489295" author="majdzadeh" created="Fri, 2 Nov 2012 07:26:55 +0000"  >&lt;p&gt;Andreas, thanks a lot for your consideration. I checked the file, the issue related to the ligature is fixed, but there exist misused glyphs in the output file. I have searched a lot about this issue and found that PDF files created with dompdf library (code.google.com/p/dompdf/) are very well extracted by PDFBox. These files even do not face the ligature problem and also the misused glyphs. Please let me know if I should provide more detail information on this.&lt;/p&gt;</comment>
                            <comment id="13489474" author="lehmi" created="Fri, 2 Nov 2012 15:12:24 +0000"  >&lt;p&gt;Hmm, can you be more specific? I compared the PDFBox result with the adobe result and it was quite the same. &lt;/p&gt;

&lt;p&gt;Can you do me a favour and perform the &quot;adobe-test&quot; (open the pdf using the adobe reader, mark the whole text, copy and paste it to an UTF-8 capable editor). Please have a look at the resulting text.&lt;/p&gt;</comment>
                            <comment id="13489802" author="majdzadeh" created="Fri, 2 Nov 2012 22:35:31 +0000"  >&lt;p&gt;I performed the test. Here are the results:&lt;br/&gt;
And yes, the results were the same. Well, there exist errors in both PDFBox extracted text and adobe-test extracted text which I don&apos;t know whether it is possible to resolve them in PDFBox or not, but I will list them here:&lt;br/&gt;
1) Only the first line is extracted correctly.&lt;br/&gt;
2) The second line has two errors. The word &quot;&#1605;&#1606;&quot; which means &quot;I&quot; in English is extracted as &quot;&#1607;&#1610;&quot; which has no meaning in Persian. Also, the word &quot;&#1607;&#1587;&#1578;&#1605;&quot; which means &quot;am&quot; in English is extracted as &quot;&#1607;&#1587;&#1578;&#1606;&quot; which means &quot;being&quot; in English.&lt;br/&gt;
3) The third line has one error. The word &quot;&#1588;&#1605;&#1575;&quot; which means &quot;you&quot; in English is extracted as &quot;&#1588;&#1608;&#1575;&quot; which has no meaning in Persian.&lt;br/&gt;
4) The fourth line has two errors. First of all, the word &quot;&#1575;&#1740;&#1585;&#1575;&#1606;&quot; which means &quot;Iran&quot; in English is extracted as &quot;&#1575;&#1740;&#1585;&#1575;&#1740;&quot; which has no meaning in Persian. Also, the word &quot;&#1587;&#1585;&#1586;&#1605;&#1740;&#1606;&#1740;&quot; which means &quot;land&quot; in English&quot; is extracted as &quot;&#1587;&#1585;&#1586;&#1607;&#1610; &#1740;&#1612;&quot; which has no meaning in Persian, actually it is not a Persian word.&lt;br/&gt;
5) The last line has multiple errors. The sentence &quot;&#1605;&#1575; &#1583;&#1585; &#1575;&#1740;&#1585;&#1575;&#1606; &#1586;&#1606;&#1583;&#1711;&#1740; &#1605;&#1740;&#8204;&#1705;&#1606;&#1740;&#1605;&quot; which means &quot;We are living in Iran&quot; in English is extracted as &quot;&#1607;&#1575; &#1583;&#1585; &#1575;&#1610;&#1585;&#1575;&#1609; &#1586; &#1583;&#1611;&#1711;&#1740; &#1607;&#1740; &#1603; &#1610;&#1612;&#1606;&quot; in which non of the words are valid Persian words, except &quot;&#1583;&#1585;&quot; (in). Below, I list the errors.&lt;br/&gt;
Extracted                            Original&lt;br/&gt;
&#1605;&#1575;                                       &#1607;&#1575;&lt;br/&gt;
&#1575;&#1740;&#1585;&#1575;&#1606;                                    &#1575;&#1740;&#1585;&#1575;&#1740;&lt;br/&gt;
&#1586;&#1606;&#1583;&#1711;&#1740;                                    &#1586;&#1583;&#1611;&#1711;&#1740;&lt;br/&gt;
&#1605;&#1740;&#8204;&#1705;&#1606;&#1740;&#1605;                                   &#1607;&#1740; &#1603; &#1610;&#1612;&#1606;&lt;/p&gt;</comment>
                            <comment id="13490003" author="lehmi" created="Sat, 3 Nov 2012 12:38:16 +0000"  >&lt;p&gt;Thanks for the test and the in-depth analysis. I double checked the unicode mapping provided in the pdf and the result and came to the conclusion that from the pdf point of view everything works fine. I can&apos;t see any issue with pdfbox and the fact that adobe provides the same result confirms my assumption. The unicode mapping within the pdf is simply wrong. I&apos;m afraid you have to blame the tool which you were using to create the pdf or probably the creator of the font.&lt;/p&gt;</comment>
                            <comment id="13490077" author="majdzadeh" created="Sat, 3 Nov 2012 19:04:24 +0000"  >&lt;p&gt;Thanks Andreas, I do appreciate your consideration. I learned a lot from your comments, thanks again.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12551734" name="PDFBOX1424-persian_test.html" size="2056" author="lehmi" created="Thu, 1 Nov 2012 17:45:45 +0000"/>
                            <attachment id="12549092" name="persian_test.html" size="1039" author="majdzadeh" created="Sun, 14 Oct 2012 20:39:38 +0000"/>
                            <attachment id="12549091" name="persian_test.pdf" size="28539" author="majdzadeh" created="Sun, 14 Oct 2012 20:39:38 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>246545</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 3 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i07r4v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>43162</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>