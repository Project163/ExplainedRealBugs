<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:06:53 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PDFBOX-3243] Lost font after merge</title>
                <link>https://issues.apache.org/jira/browse/PDFBOX-3243</link>
                <project id="12310760" key="PDFBOX">PDFBox</project>
                    <description>&lt;p&gt;Hi and thanks a lot for your great library!&lt;/p&gt;

&lt;p&gt;I&apos;ve noticed that after I merge two or more PDFs that the font of the merged PDF differs from that of the input PDFs.&lt;/p&gt;

&lt;p&gt;I&apos;ve created a minimal project that lets you reproduce the bug:&lt;br/&gt;
&lt;a href=&quot;https://github.com/mb720/PdfMerging&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/mb720/PdfMerging&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;When you start the program using &quot;./gradlew run&quot;, it will create three PDFs in &quot;~/Desktop/&quot;: Two simple PDFs with one page of text and a third one that is created by merging the first two PDFs.&lt;/p&gt;

&lt;p&gt;In the project the font I use is DroidSans.ttf. The version of PDFBox is 2.0.0-RC3.&lt;/p&gt;

&lt;p&gt;For reasons I don&apos;t know the problem does not occur on my Linux Mint Debian Edition 64 bit.&lt;/p&gt;

&lt;p&gt;Thanks a lot in advance,&lt;br/&gt;
Matthias&lt;/p&gt;</description>
                <environment>Windows 7 Professional, 32 bit</environment>
        <key id="12941007">PDFBOX-3243</key>
            <summary>Lost font after merge</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="Matthias Braun">Matthias Braun</reporter>
                        <labels>
                    </labels>
                <created>Mon, 22 Feb 2016 10:50:47 +0000</created>
                <updated>Thu, 14 Dec 2017 19:27:17 +0000</updated>
                                            <version>2.0.0</version>
                    <version>2.0.1</version>
                    <version>2.0.8</version>
                    <version>3.0.0 PDFBox</version>
                                                    <component>Utilities</component>
                        <due></due>
                            <votes>2</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="15157579" author="tilman" created="Mon, 22 Feb 2016 19:53:36 +0000"  >&lt;p&gt;I can reproduce the problem on windows with JDK7 (I had to change the code slightly). However it happens only when doing the merge programmatically, not when calling the command line utility. I suspect that the memory-created PDDocument is not identical to the saved and reloaded PDDocument. You are using font subsets. The problem is that the actual subset is created only when saving (because at that time, it is known which glyphs are used). I don&apos;t know if this can be fixed. If it can&apos;t, all we can do is to &lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;improve the javadoc&lt;/li&gt;
	&lt;li&gt;maybe find programmatically if there are &quot;unsaved subsets&quot;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Anyway, the workaround for you is to save and then to reload your PDF files.&lt;/p&gt;</comment>
                            <comment id="15342366" author="tilman" created="Tue, 21 Jun 2016 18:16:13 +0000"  >&lt;p&gt;I first tried this:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; p = 0; p &amp;lt; doc.getNumberOfPages(); ++p)
{
    PDPage page = doc.getPage(p);
    PDResources resources = page.getResources();
    &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (COSName fontName : resources.getFontNames())
    {
        PDFont font = resources.getFont(fontName);
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (font.willBeSubset())
        {
            &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; IllegalStateException(&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; document has fonts that must be subsetted, please save and reload&quot;&lt;/span&gt;);
        }
    }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;it doesn&apos;t work... the reason is that the PDFont object returned isn&apos;t the one used by the content stream, although the COSObject is the same. The PDFont object isn&apos;t taken from the cache, it is recreated from the COSObject in &lt;tt&gt;PDFontFactory.createFont(dict)&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;2nd method:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!doc.getFontsToSubset().isEmpty())
{
    &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; IllegalStateException(&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; document has fonts that must be subsetted, please save and reload&quot;&lt;/span&gt;);
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;This is even simpler, but doesn&apos;t compile because &lt;tt&gt;getFontsToSubset()&lt;/tt&gt; is not public. We could make it public, or create a new public method &lt;tt&gt;hasFontsToSubset()&lt;/tt&gt;, or create some method that subsets all the fonts and has this as body&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-comment&quot;&gt;// subset designated fonts
&lt;/span&gt;&lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (PDFont font : fontsToSubset)
{
    font.subset();
}
fontsToSubset.clear();
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="16291406" author="jira-bot" created="Thu, 14 Dec 2017 19:27:10 +0000"  >&lt;p&gt;Commit 1818194 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1818194&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1818194&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3243&quot; title=&quot;Lost font after merge&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3243&quot;&gt;PDFBOX-3243&lt;/a&gt;: improve javadoc&lt;/p&gt;</comment>
                            <comment id="16291407" author="jira-bot" created="Thu, 14 Dec 2017 19:27:17 +0000"  >&lt;p&gt;Commit 1818195 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1818195&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1818195&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3243&quot; title=&quot;Lost font after merge&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3243&quot;&gt;PDFBOX-3243&lt;/a&gt;: improve javadoc&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                            <outwardlinks description="duplicates">
                                        <issuelink>
            <issuekey id="13102564">PDFBOX-3931</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 48 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2t5dr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>