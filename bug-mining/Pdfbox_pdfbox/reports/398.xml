<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 20:54:58 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PDFBOX-1812] Illegal characters in XML output</title>
                <link>https://issues.apache.org/jira/browse/PDFBOX-1812</link>
                <project id="12310760" key="PDFBOX">PDFBox</project>
                    <description>&lt;p&gt;When running Preflight in XML mode, the latest Preflight version (I used the JAR from build #747) sometimes produces output that contains characters that are illegal in XML. This can cause unexpected behavior if such files are further processed with tools that expect well-formed XML.  See attached PDFs, which all result in illegal characters in the description of a 1.0 Syntax error, Error: Expected a long type. Output of older versions of Preflight didn&apos;t contain these illegal characters; instead they would give something like &lt;b&gt;actual=&apos;/O&apos;&lt;/b&gt;, &lt;b&gt;actual=&apos;Pages&apos;&lt;/b&gt;. etc. So I suppose this must have been caused by a fairly recent change.&lt;/p&gt;

&lt;p&gt;See attachments below.&lt;/p&gt;</description>
                <environment>Bug reproduced under Win 7, Ubuntu</environment>
        <key id="12685162">PDFBOX-1812</key>
            <summary>Illegal characters in XML output</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="lehmi">Andreas Lehmk&#252;hler</assignee>
                                    <reporter username="johanvanderknijff">Johan van der Knijff</reporter>
                        <labels>
                            <label>characters</label>
                            <label>utf-8</label>
                            <label>xml</label>
                    </labels>
                <created>Tue, 17 Dec 2013 12:20:48 +0000</created>
                <updated>Sun, 9 Feb 2014 18:33:18 +0000</updated>
                            <resolved>Wed, 15 Jan 2014 06:47:49 +0000</resolved>
                                    <version>2.0.0</version>
                                    <fixVersion>1.8.4</fixVersion>
                    <fixVersion>2.0.0</fixVersion>
                                    <component>Preflight</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="13850397" author="johanvanderknijff" created="Tue, 17 Dec 2013 12:24:11 +0000"  >&lt;p&gt;Attached PDFs all result in illegal chars in Preflight&apos;s XML output.  Output files are included as well. The &quot;_old.xml&quot; files were created with an older build (can&apos;t figure out which one exactly, probably one of the November ones), and these don&apos;t cxontain the illegal characters.&lt;/p&gt;</comment>
                            <comment id="13851294" author="gbm.bailleul" created="Wed, 18 Dec 2013 02:44:07 +0000"  >&lt;p&gt;I guess there is something to do on xml generation to escape specific characters.&lt;/p&gt;

&lt;p&gt;However, something has been changed in the parser that makes the message different, and should not. Is it possible for you to determine which was the last version it was working correctly ?&lt;/p&gt;</comment>
                            <comment id="13851742" author="johanvanderknijff" created="Wed, 18 Dec 2013 13:51:50 +0000"  >&lt;p&gt;Hi Guillaume,&lt;/p&gt;

&lt;p&gt;I can&apos;t figure out the exact version as I renamed the original jar, and the jar doesn&apos;t report any version info. In case this is any help I attached the most recent JAR I could find with the correct behavior. I&apos;m pretty sure this is one of the October or early November builds, but you may be able to extract this info from the JAR. &lt;/p&gt;

&lt;p&gt;On a related note, perhaps it would make sense to add a -v / --version switch that gives you the version info.&lt;/p&gt;

&lt;p&gt;Let me know if this helps!&lt;/p&gt;

&lt;p&gt;Cheers,&lt;/p&gt;

&lt;p&gt;Johan &lt;/p&gt;</comment>
                            <comment id="13852660" author="gbm.bailleul" created="Thu, 19 Dec 2013 06:28:49 +0000"  >&lt;p&gt;After a few test, it seems that the change of behaviour arrived with the commit r1549022 (linked with &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-1769&quot; title=&quot;Fix crash on invalid xref&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-1769&quot;&gt;&lt;del&gt;PDFBOX-1769&lt;/del&gt;&lt;/a&gt;)&lt;/p&gt;</comment>
                            <comment id="13852687" author="lehmi" created="Thu, 19 Dec 2013 07:07:52 +0000"  >&lt;p&gt;A little bit offtopic .... the following command provides the PDFBox version:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;java -cp pdfbox-app.jar org.apache.pdfbox.Version
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Unfortunately it doesn&apos;t come up with the specific SNAPSHOT version.&lt;/p&gt;</comment>
                            <comment id="13852704" author="lehmi" created="Thu, 19 Dec 2013 07:36:12 +0000"  >&lt;p&gt;I had a look and there seems to be an issue with the PushBackInputStream. The parser tries to read a bunch of bytes but doesn&apos;t get them all, so that the following comparison has to fail (see NonSequentialPDFParser#checkBytesAtOffset). I&apos;ll investigate further.&lt;/p&gt;</comment>
                            <comment id="13853778" author="lehmi" created="Fri, 20 Dec 2013 08:12:55 +0000"  >&lt;p&gt;I fixed the parser issue in revisions 1552521 (trunk) and 1552522 (1.8 branch).  &lt;/p&gt;

&lt;p&gt;The question is: is it a problem that the parser now has some sort of a self-healing mechanism? Is a PDF/A1b document with a broken XRef table still a valid pdf?&lt;/p&gt;</comment>
                            <comment id="13855227" author="gbm.bailleul" created="Sun, 22 Dec 2013 18:00:03 +0000"  >&lt;p&gt;To anwser to Andreas, a PDF/A is not valid if xref table is broken.&lt;/p&gt;

&lt;p&gt;In an other hand, having &quot;self healing&quot; mechanism is also useful.&lt;/p&gt;

&lt;p&gt;A solution to that is an flag in the parser to put parser in &quot;self-healing&quot; or &quot;uncompromising&quot; mode. This flag should be set in constructor. The default should be self-healing as the validation usage is not prevalant.&lt;/p&gt;

&lt;p&gt;What do you think ?&lt;/p&gt;</comment>
                            <comment id="13855239" author="lehmi" created="Sun, 22 Dec 2013 19:06:39 +0000"  >&lt;p&gt;I had the same idea in my mind. Do you want to add that flag or should I do it?&lt;/p&gt;</comment>
                            <comment id="13855409" author="gbm.bailleul" created="Mon, 23 Dec 2013 05:37:44 +0000"  >&lt;p&gt;I will have a look&lt;/p&gt;</comment>
                            <comment id="13866630" author="johanvanderknijff" created="Thu, 9 Jan 2014 13:18:02 +0000"  >&lt;p&gt;I just ran another test with the latest build (#762 / preflight-app-2.0.0-20140105.170147-103.jar) on the same set of files. Five out of these still result in XML with illegal characters. I added them in attached ZIP file.&lt;/p&gt;</comment>
                            <comment id="13868789" author="lehmi" created="Sat, 11 Jan 2014 13:56:22 +0000"  >&lt;p&gt;I added another fix to make PDFBox more lenient which should be optional for preflight, see &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-161&quot; title=&quot;java.util.EmptyStackException from PDFTextStripper.writeText&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-161&quot;&gt;&lt;del&gt;PDFBOX-161&lt;/del&gt;&lt;/a&gt; for details.&lt;/p&gt;</comment>
                            <comment id="13868850" author="lehmi" created="Sat, 11 Jan 2014 18:54:23 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=johanvanderknijff&quot; class=&quot;user-hover&quot; rel=&quot;johanvanderknijff&quot;&gt;johanvanderknijff&lt;/a&gt;&lt;br/&gt;
You are right, those files are producing illegal characters, but not because of a recent change. The files are all more or less broken and older preflight versions are providing the same &quot;illegal&quot; output.&lt;/p&gt;</comment>
                            <comment id="13869064" author="lehmi" created="Sun, 12 Jan 2014 15:18:36 +0000"  >&lt;p&gt;I simply changed the message of the IOException of BaseParser#readInt and BaseParser#readLong in revision 1557546 to avoid the illegal characters.&lt;/p&gt;</comment>
                            <comment id="13871224" author="gbm.bailleul" created="Tue, 14 Jan 2014 21:34:36 +0000"  >&lt;p&gt;I commited with r1558205 the possibility to choose if parser is lenient or not.&lt;/p&gt;

&lt;p&gt;A set method can be called before parsing is done. With the default value, the parser remains lenient. This default value is changed in Preflight parser.&lt;/p&gt;

&lt;p&gt;I put that flag in NonSequentialParser, there is maybe some interest in moving it to PDFParser.&lt;/p&gt;</comment>
                            <comment id="13871239" author="lehmi" created="Tue, 14 Jan 2014 21:40:00 +0000"  >&lt;p&gt;Thanks Guillaume!! I&apos;ll add the changes to the 1.8 branch. Did you see my changes coming with &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-161&quot; title=&quot;java.util.EmptyStackException from PDFTextStripper.writeText&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-161&quot;&gt;&lt;del&gt;PDFBOX-161&lt;/del&gt;&lt;/a&gt;? Is this a candidate for the not lenient modus too?&lt;/p&gt;</comment>
                            <comment id="13871253" author="gbm.bailleul" created="Tue, 14 Jan 2014 21:52:50 +0000"  >&lt;p&gt;Yes I had a look to the changes of &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-161&quot; title=&quot;java.util.EmptyStackException from PDFTextStripper.writeText&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-161&quot;&gt;&lt;del&gt;PDFBOX-161&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;In my opinion, there is no impact for PDF/A validation. Furthermore, there is no isartor test &quot;not working&quot; since that commit... I guess it is OK but I am not expert enough &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;Nethertheless, it could be considered as candidate as it accept some bad formatted PDF. I am pretty sure there are some other cases of auto healing in PDFBox, we could put them in lenient modus when we (re)discover them.&lt;/p&gt;</comment>
                            <comment id="13871735" author="lehmi" created="Wed, 15 Jan 2014 06:47:49 +0000"  >&lt;p&gt;I merged the missing trunk revisions to the 1.8 branch on revision 1558309.&lt;/p&gt;

&lt;p&gt;Thanks to all for the help/input !!&lt;/p&gt;</comment>
                            <comment id="13872279" author="johanvanderknijff" created="Wed, 15 Jan 2014 17:08:17 +0000"  >&lt;p&gt;Thanks again Andreas and Guillaume, I just did a quick test with the latest build and it all seems to work for me as well! &lt;/p&gt;</comment>
                            <comment id="13873431" author="johanvanderknijff" created="Thu, 16 Jan 2014 14:27:52 +0000"  >&lt;blockquote&gt;
&lt;p&gt;Andreas Lehmk&#252;hler  - 20/Dec/13 08:12&lt;/p&gt;

&lt;p&gt;The question is: is it a problem that the parser now has some sort of a self-healing mechanism? Is a PDF/A1b document with a broken XRef table still a valid pdf?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I overlooked this comment earlier on.  As I see it, ideally, PDF/A validation should be a 2-stage process:&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;Validate if the PDF conforms to the general PDF spec (for PDF/A-1b this would be PDF 1.4, although ISO 32000 would probably be more practical).&lt;/li&gt;
	&lt;li&gt;Check if the PDF conforms to the additional constraints imposed by PDF/A-1b.&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;This would mean that a PDF can &lt;em&gt;only&lt;/em&gt; be valid PDF/A-1b if it passes both tests. A broken XRef table would break 1, so it wouldn&apos;t be valid PDF/A-1b either.&lt;/p&gt;

&lt;p&gt;Needless to say 1 is a &lt;em&gt;huge&lt;/em&gt; task, and I&apos;m not aware of any software that is currently capable of this (although some people are lobbying for initiating something like this, see e.g:&lt;br/&gt;
&lt;a href=&quot;http://www.pdfa.org/video/duff-johnson-why-validation/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.pdfa.org/video/duff-johnson-why-validation/&lt;/a&gt;)&lt;/p&gt;

&lt;p&gt;From what I understand &lt;em&gt;Preflight&lt;/em&gt; mostly focuses on 2 (although I think it includes quite a few elements from 1 as well).&lt;/p&gt;

&lt;p&gt;Just my 2 cents ...&lt;/p&gt;</comment>
                            <comment id="13895853" author="napadaan" created="Sun, 9 Feb 2014 07:59:48 +0000"  >&lt;p&gt;hi.. already downloaded the preflight-app.jar  files I just wondering if someone can help me how to use this?&lt;/p&gt;</comment>
                            <comment id="13895969" author="lehmi" created="Sun, 9 Feb 2014 18:33:18 +0000"  >&lt;p&gt;Please join our mailing list &lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; to ask any questions like this. JIRA is limited to issues and improvements.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://pdfbox.apache.org/mailinglists.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://pdfbox.apache.org/mailinglists.html&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12391195">PDFBOX-161</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                            <outwardlinks description="depends upon">
                                        <issuelink>
            <issuekey id="12677341">PDFBOX-1769</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12619088" name="013814.pdf" size="2388096" author="johanvanderknijff" created="Tue, 17 Dec 2013 12:24:11 +0000"/>
                            <attachment id="12619089" name="013814.xml" size="806" author="johanvanderknijff" created="Tue, 17 Dec 2013 12:24:11 +0000"/>
                            <attachment id="12619090" name="013814_old.xml" size="656" author="johanvanderknijff" created="Tue, 17 Dec 2013 12:24:11 +0000"/>
                            <attachment id="12622180" name="1812-additionalPDFs09012014.zip" size="6468837" author="johanvanderknijff" created="Thu, 9 Jan 2014 13:18:02 +0000"/>
                            <attachment id="12619091" name="598659.pdf" size="281472" author="johanvanderknijff" created="Tue, 17 Dec 2013 12:24:11 +0000"/>
                            <attachment id="12619092" name="598659.xml" size="1002" author="johanvanderknijff" created="Tue, 17 Dec 2013 12:24:11 +0000"/>
                            <attachment id="12619093" name="598659_old.xml" size="824" author="johanvanderknijff" created="Tue, 17 Dec 2013 12:24:11 +0000"/>
                            <attachment id="12619094" name="600111.pdf" size="178688" author="johanvanderknijff" created="Tue, 17 Dec 2013 12:24:11 +0000"/>
                            <attachment id="12619095" name="600111.xml" size="883" author="johanvanderknijff" created="Tue, 17 Dec 2013 12:24:11 +0000"/>
                            <attachment id="12619096" name="600111_old.xml" size="656" author="johanvanderknijff" created="Tue, 17 Dec 2013 12:24:11 +0000"/>
                            <attachment id="12619315" name="preflight-app.jar" size="7999095" author="johanvanderknijff" created="Wed, 18 Dec 2013 13:51:50 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>11.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>364239</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 40 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1qs73:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>364539</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>