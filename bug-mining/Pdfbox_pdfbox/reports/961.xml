<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 20:59:19 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PDFBOX-988] pdmodel.font.PDSimpleFont hanging on TrueType font (ubuntu)</title>
                <link>https://issues.apache.org/jira/browse/PDFBOX-988</link>
                <project id="12310760" key="PDFBOX">PDFBox</project>
                    <description>&lt;p&gt;When calling PDPage.convertToImage(imagetype,resolution) , I have found a case where the application hangs.  No error messages, no exceptions, no CPU spike, no I/O.  The error had to do with some strange corruption of the awtFont, by the time it reached the method PDSimpleFont.drawString.  Some pretty deep digging turned up that if a font with too few glyphs is sent into PDSimpleFont.writeFont, it will enter Graphics2D.drawString ... ne&apos;er to return.&lt;/p&gt;

&lt;p&gt;If a check is done to count the glyphs and if they fall below a certain threshold, then just re-instantiate the Font, then all goes well.  Typical numbers range from 70 to 1000+, so I&apos;ve gone with an arbitrary value of 40.  All goes well, and I can&apos;t measure any difference in performance (except that my app will actually return from attempting this doc!).&lt;/p&gt;

&lt;p&gt;Attached is a sample PDF which can re-create the problem, and a patch which seems to solve it sensibly.&lt;/p&gt;</description>
                <environment>Ubuntu 8.04 - Headless</environment>
        <key id="12502346">PDFBOX-988</key>
            <summary>pdmodel.font.PDSimpleFont hanging on TrueType font (ubuntu)</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="lehmi">Andreas Lehmk&#252;hler</assignee>
                                    <reporter username="craig_s">Craig Stires</reporter>
                        <labels>
                    </labels>
                <created>Fri, 25 Mar 2011 03:40:40 +0000</created>
                <updated>Thu, 17 Mar 2016 19:06:58 +0000</updated>
                            <resolved>Fri, 9 Aug 2013 18:02:10 +0000</resolved>
                                    <version>1.5.0</version>
                                    <fixVersion>2.0.0</fixVersion>
                                    <component>PDModel</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="13011087" author="craig_s" created="Fri, 25 Mar 2011 03:55:10 +0000"  >&lt;p&gt;This PDF is a copy which is stripped down to only the offending item.  If this is relevant to dev efforts, here is the original metadata.&lt;br/&gt;
Original filetype : .xlsm&lt;br/&gt;
Pdf producer : pdfFactory Pro 2.50 (Win XP Pro Thai)&lt;br/&gt;
Pdf version : 1.4 (Acrobat 5.x)&lt;br/&gt;
Protection : locked for copy/change&lt;/p&gt;</comment>
                            <comment id="13056864" author="adamnichols" created="Tue, 28 Jun 2011 22:45:31 +0000"  >&lt;p&gt;Since permission to include this PDF was granted, I created a JUnit test to determine if this PDF will cause the JVM to hang/crash.  It runs without crashing nor hanging for me.  I am using the Oracle JVM.  I&apos;d also like to mention that the were one SEVERE and several WARNING log messages, which I am including below.  Bottom line: the file seems to have some technical issues, but it doesn&apos;t seem to be anything that PDFBox and the Oracle JVM can not handle.&lt;/p&gt;

&lt;p&gt;Since the JUnit test (PDSimpleFontTest::testPDFBox988()) is now in place, and the PDF is included in the &quot;resources&quot; section, it should be easy to either duplicate the error, or duplicate my test results.  If you test this, please include your JVM info (`java -version`) so we can see where it works and where it doesn&apos;t.  At this point it looks like a JVM bug, but it&apos;d be good to have more data to confirm this.&lt;/p&gt;

&lt;p&gt;$ /usr/local/jdk1.6.0_23/bin/java -version&lt;br/&gt;
java version &quot;1.6.0_23&quot;&lt;br/&gt;
Java(TM) SE Runtime Environment (build 1.6.0_23-b05)&lt;br/&gt;
Java HotSpot(TM) Server VM (build 19.0-b09, mixed mode)&lt;/p&gt;

&lt;p&gt;Jun 28, 2011 3:25:05 PM org.apache.pdfbox.filter.FlateFilter decode&lt;br/&gt;
SEVERE: Stop reading corrupt stream&lt;br/&gt;
Jun 28, 2011 3:25:05 PM org.apache.pdfbox.pdmodel.font.PDSimpleFont drawString&lt;br/&gt;
WARNING: Changing font on &amp;lt;&#3614;&amp;gt; from &amp;lt;Tahoma&amp;gt; to the default font&lt;br/&gt;
Jun 28, 2011 3:25:06 PM org.apache.pdfbox.pdmodel.font.PDSimpleFont drawString&lt;br/&gt;
WARNING: Changing font on &amp;lt;&#3621;&amp;gt; from &amp;lt;Tahoma&amp;gt; to the default font&lt;br/&gt;
Jun 28, 2011 3:25:06 PM org.apache.pdfbox.pdmodel.font.PDSimpleFont drawString&lt;br/&gt;
WARNING: Changing font on &amp;lt;&#3633;&amp;gt; from &amp;lt;Tahoma&amp;gt; to the default font&lt;br/&gt;
Jun 28, 2011 3:25:06 PM org.apache.pdfbox.pdmodel.font.PDSimpleFont drawString&lt;br/&gt;
WARNING: Changing font on &amp;lt;&#3591;&amp;gt; from &amp;lt;Tahoma&amp;gt; to the default font&lt;br/&gt;
Jun 28, 2011 3:25:06 PM org.apache.pdfbox.pdmodel.font.PDSimpleFont drawString&lt;br/&gt;
WARNING: Changing font on &amp;lt;&#3619;&amp;gt; from &amp;lt;Tahoma&amp;gt; to the default font&lt;br/&gt;
Jun 28, 2011 3:25:06 PM org.apache.pdfbox.pdmodel.font.PDSimpleFont drawString&lt;br/&gt;
WARNING: Changing font on &amp;lt;&#3633;&amp;gt; from &amp;lt;Tahoma&amp;gt; to the default font&lt;br/&gt;
Jun 28, 2011 3:25:06 PM org.apache.pdfbox.pdmodel.font.PDSimpleFont drawString&lt;br/&gt;
WARNING: Changing font on &amp;lt;&#3585;&amp;gt; from &amp;lt;Tahoma&amp;gt; to the default font&lt;/p&gt;

&lt;p&gt;Edit: Updated to correct myself.  I am using the Oracle JVM, not OpenJDK as I originally thought.&lt;/p&gt;</comment>
                            <comment id="13056994" author="craig_s" created="Wed, 29 Jun 2011 04:05:52 +0000"  >&lt;p&gt;Thanks for looking into this.&lt;/p&gt;

&lt;p&gt;I will re-run my tests, and see if I have any error output different from yours&lt;/p&gt;

&lt;p&gt;Configuration:  Ubuntu 8.04 LTS&lt;br/&gt;
Linux mach01 2.6.24-28-virtual #1 SMP Fri Feb 11 17:51:21 UTC 2011 i686&lt;br/&gt;
root@mach01:~# java -version&lt;br/&gt;
java version &quot;1.6.0_06&quot;&lt;br/&gt;
Java(TM) SE Runtime Environment (build 1.6.0_06-b02)&lt;br/&gt;
Java HotSpot(TM) Client VM (build 10.0-b22, mixed mode, sharing)&lt;/p&gt;

&lt;p&gt;Also, apologies for the change, but realized that my patch and my recommendation were slightly out of sync.  The value for minimum glyph in the patch should be 40 (the patch has the value at 20).  Testing a fairly large set of pdfs didn&apos;t show any valid fonts with fewer than 40 glyphs, so want to be more conservative to prevent hanging the system again.&lt;/p&gt;

&lt;p&gt;Attaching the slightly changed patch.&lt;/p&gt;
</comment>
                            <comment id="13651111" author="lehmi" created="Tue, 7 May 2013 17:55:54 +0000"  >&lt;p&gt;I ran some tests on my fedora box. I can confirm that convertToImage hangs everytime I use a java 1.5 JVM regardless of which version of PDFBox I use. Any other combination starting with PDFBox 1.3.1 works fine.&lt;/p&gt;
</comment>
                            <comment id="13735078" author="lehmi" created="Fri, 9 Aug 2013 18:02:10 +0000"  >&lt;p&gt;The pdf looks quite good after solving &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-490&quot; title=&quot;Pdf Printing of text from embedded fonts&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-490&quot;&gt;&lt;del&gt;PDFBOX-490&lt;/del&gt;&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-412&quot; title=&quot;Failure to render PDFs with embedded fonts&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-412&quot;&gt;&lt;del&gt;PDFBOX-412&lt;/del&gt;&lt;/a&gt;. As we don&apos;t rely on the JDK for rendering PDFBox shouldn&apos;t crash/hang anymore.&lt;/p&gt;</comment>
                            <comment id="14305226" author="jira-bot" created="Wed, 4 Feb 2015 15:10:37 +0000"  >&lt;p&gt;Commit 1657272 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1657272&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1657272&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-988&quot; title=&quot;pdmodel.font.PDSimpleFont hanging on TrueType font (ubuntu)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-988&quot;&gt;&lt;del&gt;PDFBOX-988&lt;/del&gt;&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-1019&quot; title=&quot;PDF conversion to image crashes the JVM&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-1019&quot;&gt;&lt;del&gt;PDFBOX-1019&lt;/del&gt;&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2383&quot; title=&quot;PDFBox tests include copyright files&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2383&quot;&gt;&lt;del&gt;PDFBOX-2383&lt;/del&gt;&lt;/a&gt;: remove test with copyrighted document, fix typo in other test&lt;/p&gt;</comment>
                            <comment id="14305272" author="jira-bot" created="Wed, 4 Feb 2015 15:28:57 +0000"  >&lt;p&gt;Commit 1657283 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/branches/1.8&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1657283&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1657283&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-988&quot; title=&quot;pdmodel.font.PDSimpleFont hanging on TrueType font (ubuntu)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-988&quot;&gt;&lt;del&gt;PDFBOX-988&lt;/del&gt;&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-1019&quot; title=&quot;PDF conversion to image crashes the JVM&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-1019&quot;&gt;&lt;del&gt;PDFBOX-1019&lt;/del&gt;&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2383&quot; title=&quot;PDFBox tests include copyright files&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2383&quot;&gt;&lt;del&gt;PDFBOX-2383&lt;/del&gt;&lt;/a&gt;: remove test with copyrighted document, fix typo in other test&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                            <outwardlinks description="blocks">
                                        <issuelink>
            <issuekey id="12508454">PDFBOX-1019</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12463893">PDFBOX-723</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12474589" name="F001u_3_7j.pdf" size="44088" author="craig_s" created="Fri, 25 Mar 2011 03:55:10 +0000"/>
                            <attachment id="12474588" name="pdsimplefont_rebuildfont_fewglyphs.patch" size="691" author="craig_s" created="Fri, 25 Mar 2011 03:55:10 +0000"/>
                            <attachment id="12484591" name="pdsimplefont_rebuildfont_fewglyphs_40.patch" size="593" author="craig_s" created="Wed, 29 Jun 2011 04:07:02 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>69808</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 41 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i14udr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>236387</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>