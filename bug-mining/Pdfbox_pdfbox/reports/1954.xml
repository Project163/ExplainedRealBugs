<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:07:23 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PDFBOX-4172] Flatten fails on first form element only</title>
                <link>https://issues.apache.org/jira/browse/PDFBOX-4172</link>
                <project id="12310760" key="PDFBOX">PDFBox</project>
                    <description>&lt;p&gt;I&apos;ve create an PDF form using LibreOffice 5. For this document, the first form element refuses to turn up filled when filling + flattening using PDFBox 2.0.9 als well as trunk (512d016ad08a70dfb512f99d54092f8b586e8345).&lt;/p&gt;

&lt;p&gt;It turns out that resolveNeedsTranslation does not encounter any PDFormXObject for the first element of this pdf form element but still returns false, although translation is still needed.&lt;/p&gt;

&lt;p&gt;I&apos;ve created a patch in &lt;a href=&quot;https://github.com/michael-dev/pdfbox/tree/bugfix/flattenCorrectly&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/michael-dev/pdfbox/tree/bugfix/flattenCorrectly&lt;/a&gt; .&lt;/p&gt;

&lt;p&gt;I used evince 3.18.2 on ubuntu xenial as pdf viewer. Please see attached example pdf form and the different results using pdfbox 2.0.9 and with the above patch applied. The code used here is in example.java.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13148795">PDFBOX-4172</key>
            <summary>Flatten fails on first form element only</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="msahyoun">Maruan Sahyoun</assignee>
                                    <reporter username="mbr">Mathias Br&#246;kelmann</reporter>
                        <labels>
                            <label>flatten</label>
                    </labels>
                <created>Thu, 29 Mar 2018 06:39:07 +0000</created>
                <updated>Fri, 2 Aug 2019 17:09:46 +0000</updated>
                            <resolved>Fri, 2 Aug 2019 17:09:46 +0000</resolved>
                                    <version>2.0.9</version>
                                    <fixVersion>2.0.10</fixVersion>
                    <fixVersion>3.0.0 PDFBox</fixVersion>
                                    <component>AcroForm</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="16418509" author="githubbot" created="Thu, 29 Mar 2018 06:46:37 +0000"  >&lt;p&gt;GitHub user michael-dev opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/pdfbox/pull/45&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/pdfbox/pull/45&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4172&quot; title=&quot;Flatten fails on first form element only&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4172&quot;&gt;&lt;del&gt;PDFBOX-4172&lt;/del&gt;&lt;/a&gt;: do translation when no PDFormXObject is encountered&lt;/p&gt;

&lt;p&gt;    I&apos;ve created PDF forms using LibreOffice 5 and for one file, the first&lt;br/&gt;
    form element will not show up filled when flattening the PDF.&lt;/p&gt;

&lt;p&gt;    It turns out that resolveNeedsTranslation does not hit a PDFormXObject&lt;br/&gt;
    and thus returns false, although translation is actually needed.&lt;/p&gt;

&lt;p&gt;    This patch fixes this by tracking whether any PDFormXObject has been&lt;br/&gt;
    encountered and returning true when none is seen.&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4172&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/PDFBOX-4172&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/michael-dev/pdfbox&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/michael-dev/pdfbox&lt;/a&gt; bugfix/flattenCorrectly&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/pdfbox/pull/45.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/pdfbox/pull/45.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #45&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit fed3b1fc607d085f081a5a94bc2deb2dfd73acd4&lt;br/&gt;
Author: Michael Braun &amp;lt;michael-dev@...&amp;gt;&lt;br/&gt;
Date:   2018-03-29T06:32:14Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4172&quot; title=&quot;Flatten fails on first form element only&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4172&quot;&gt;&lt;del&gt;PDFBOX-4172&lt;/del&gt;&lt;/a&gt;: do translation when no PDFormXObject is encountered&lt;/p&gt;

&lt;p&gt;    I&apos;ve created PDF forms using LibreOffice 5 and for one file, the first&lt;br/&gt;
    form element will not show up filled when flattening the PDF.&lt;/p&gt;

&lt;p&gt;    It turns out that resolveNeedsTranslation does not hit a PDFormXObject&lt;br/&gt;
    and thus returns false, although translation is actually needed.&lt;/p&gt;

&lt;p&gt;    This patch fixes this by tracking whether any PDFormXObject has been&lt;br/&gt;
    encountered and returning true when none is seen.&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4172&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/PDFBOX-4172&lt;/a&gt;&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="16418719" author="jira-bot" created="Thu, 29 Mar 2018 10:35:45 +0000"  >&lt;p&gt;Commit 1827970 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=msahyoun&quot; class=&quot;user-hover&quot; rel=&quot;msahyoun&quot;&gt;msahyoun&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1827970&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1827970&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4157&quot; title=&quot;Flatten ne positonne pas bien le 1er champs si Image avant&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4157&quot;&gt;&lt;del&gt;PDFBOX-4157&lt;/del&gt;&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4172&quot; title=&quot;Flatten fails on first form element only&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4172&quot;&gt;&lt;del&gt;PDFBOX-4172&lt;/del&gt;&lt;/a&gt;: adjust resolveNeedsTranslation to only resolve to false if PDFormXObject already has translation&lt;/p&gt;</comment>
                            <comment id="16418722" author="jira-bot" created="Thu, 29 Mar 2018 10:36:16 +0000"  >&lt;p&gt;Commit 1827971 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=msahyoun&quot; class=&quot;user-hover&quot; rel=&quot;msahyoun&quot;&gt;msahyoun&lt;/a&gt; in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1827971&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1827971&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4157&quot; title=&quot;Flatten ne positonne pas bien le 1er champs si Image avant&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4157&quot;&gt;&lt;del&gt;PDFBOX-4157&lt;/del&gt;&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4172&quot; title=&quot;Flatten fails on first form element only&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4172&quot;&gt;&lt;del&gt;PDFBOX-4172&lt;/del&gt;&lt;/a&gt;: adjust resolveNeedsTranslation to only resolve to false if PDFormXObject already has translation&lt;/p&gt;</comment>
                            <comment id="16418737" author="msahyoun" created="Thu, 29 Mar 2018 10:43:21 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mbr&quot; class=&quot;user-hover&quot; rel=&quot;mbr&quot;&gt;mbr&lt;/a&gt; thanks for the patch. I used the idea but implemented it differently. Could you verify if it works for you?&lt;/p&gt;</comment>
                            <comment id="16421352" author="tilman" created="Sat, 31 Mar 2018 15:02:03 +0000"  >&lt;p&gt;I wonder what the difference between the first (with &quot;K21&quot;) and the second (with &quot;K20&quot;) is. Both have images, but only one of them has the problem that the translation is at 0 0.&lt;/p&gt;

&lt;p&gt;Or could it be that something changes due to the flattening itself?&lt;/p&gt;</comment>
                            <comment id="16421740" author="msahyoun" created="Sun, 1 Apr 2018 17:10:46 +0000"  >&lt;p&gt;The image(s) don&apos;t play a role here but about the question if the XForm for the widget is already translated or not. Before the change it was missing to translate the first XForm if necessary.&lt;/p&gt;

&lt;p&gt;I also checked the flattening for the files in &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3396&quot; title=&quot;flattening AcroForm with visible sign field ETSI.CAdES.detached&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3396&quot;&gt;&lt;del&gt;PDFBOX-3396&lt;/del&gt;&lt;/a&gt; - they are still ok.&lt;/p&gt;</comment>
                            <comment id="16427992" author="jira-bot" created="Fri, 6 Apr 2018 05:51:54 +0000"  >&lt;p&gt;Commit 1828491 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=msahyoun&quot; class=&quot;user-hover&quot; rel=&quot;msahyoun&quot;&gt;msahyoun&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1828491&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1828491&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4172&quot; title=&quot;Flatten fails on first form element only&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4172&quot;&gt;&lt;del&gt;PDFBOX-4172&lt;/del&gt;&lt;/a&gt;: add source code comment for default setting; closes #45&lt;/p&gt;</comment>
                            <comment id="16427993" author="githubbot" created="Fri, 6 Apr 2018 05:52:08 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/pdfbox/pull/45&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/pdfbox/pull/45&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16429435" author="msahyoun" created="Sat, 7 Apr 2018 16:04:05 +0000"  >&lt;p&gt;I&apos;m closing this given the tests and the feedback in &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4157&quot; title=&quot;Flatten ne positonne pas bien le 1er champs si Image avant&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4157&quot;&gt;&lt;del&gt;PDFBOX-4157&lt;/del&gt;&lt;/a&gt;. &lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mbr&quot; class=&quot;user-hover&quot; rel=&quot;mbr&quot;&gt;mbr&lt;/a&gt; You can reopen if the issue persists.&lt;/p&gt;</comment>
                            <comment id="16899044" author="tilman" created="Fri, 2 Aug 2019 17:08:38 +0000"  >&lt;p&gt;reopen to attach test file&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12976552" name="PDFBOX-4172-filled.pdf" size="408383" author="tilman" created="Fri, 2 Aug 2019 17:09:38 +0000"/>
                            <attachment id="12916752" name="example-filled-2.0.9.pdf" size="404735" author="mbr" created="Thu, 29 Mar 2018 06:45:09 +0000"/>
                            <attachment id="12916751" name="example-filled-fixed.pdf" size="404751" author="mbr" created="Thu, 29 Mar 2018 06:45:09 +0000"/>
                            <attachment id="12916750" name="example.java" size="1048" author="mbr" created="Thu, 29 Mar 2018 06:45:08 +0000"/>
                            <attachment id="12916753" name="example.pdf" size="406163" author="mbr" created="Thu, 29 Mar 2018 06:45:09 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 15 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3rxgv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>