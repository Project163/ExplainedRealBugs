<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:04:03 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PDFBOX-3501] java.lang.ArrayIndexOutOfBoundsException when rendering to bitonal image type</title>
                <link>https://issues.apache.org/jira/browse/PDFBOX-3501</link>
                <project id="12310760" key="PDFBOX">PDFBox</project>
                    <description>&lt;p&gt;while using the PdfToTiffConverter i got an ArrayIndexOutOfBoundsException for the attached error.pdf file&lt;/p&gt;

&lt;p&gt;Tested with Version 2.0.0 and 2.0.2&lt;/p&gt;

&lt;p&gt;Stacktrace:&lt;br/&gt;
	java.lang.ArrayIndexOutOfBoundsException: 1&lt;br/&gt;
	At: java.awt.image.ColorModel.getNormalizedComponents(ColorModel.java:1197)&lt;br/&gt;
	At: java.awt.image.ColorModel.getNormalizedComponents(ColorModel.java:1439)&lt;br/&gt;
	At: org.apache.pdfbox.pdmodel.graphics.blend.BlendComposite$BlendCompositeContext.compose(BlendComposite.java:160)&lt;br/&gt;
	At: sun.java2d.loops.Blit$AnyBlit.Blit(Blit.java:179)&lt;br/&gt;
	At: sun.java2d.pipe.DrawImage.renderImageXform(DrawImage.java:546)&lt;br/&gt;
	At: sun.java2d.pipe.DrawImage.transformImage(DrawImage.java:264)&lt;br/&gt;
	At: sun.java2d.pipe.DrawImage.copyImage(DrawImage.java:76)&lt;br/&gt;
	At: sun.java2d.pipe.DrawImage.copyImage(DrawImage.java:1014)&lt;br/&gt;
	At: sun.java2d.pipe.ValidatePipe.copyImage(ValidatePipe.java:186)&lt;br/&gt;
	At: sun.java2d.SunGraphics2D.drawImage(SunGraphics2D.java:3318)&lt;br/&gt;
	At: sun.java2d.SunGraphics2D.drawImage(SunGraphics2D.java:3445)&lt;br/&gt;
	At: org.apache.pdfbox.rendering.PageDrawer.showTransparencyGroup(PageDrawer.java:1154)&lt;br/&gt;
	At: org.apache.pdfbox.contentstream.operator.graphics.DrawObject.process(DrawObject.java:66)&lt;br/&gt;
	At: org.apache.pdfbox.contentstream.PDFStreamEngine.processOperator(PDFStreamEngine.java:815)&lt;br/&gt;
	At: org.apache.pdfbox.contentstream.PDFStreamEngine.processStreamOperators(PDFStreamEngine.java:472)&lt;br/&gt;
	At: org.apache.pdfbox.contentstream.PDFStreamEngine.processStream(PDFStreamEngine.java:446)&lt;br/&gt;
	At: org.apache.pdfbox.contentstream.PDFStreamEngine.processPage(PDFStreamEngine.java:149)&lt;br/&gt;
	At: org.apache.pdfbox.rendering.PageDrawer.drawPage(PageDrawer.java:189)&lt;br/&gt;
	At: org.apache.pdfbox.rendering.PDFRenderer.renderPage(PDFRenderer.java:208)&lt;br/&gt;
	At: org.apache.pdfbox.rendering.PDFRenderer.renderImage(PDFRenderer.java:139)&lt;br/&gt;
	At: org.apache.pdfbox.rendering.PDFRenderer.renderImageWithDPI(PDFRenderer.java:94)&lt;br/&gt;
	At: org.monitoring.system.util.PdfToTiffConverter.convertPdfToTiff(PdfToTiffConverter.java:71)&lt;br/&gt;
	At: org.monitoring.system.util.PdfToTiffConverter.convertPdfToTiff(PdfToTiffConverter.java:44)&lt;/p&gt;</description>
                <environment></environment>
        <key id="13005358">PDFBOX-3501</key>
            <summary>java.lang.ArrayIndexOutOfBoundsException when rendering to bitonal image type</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="lehmi">Andreas Lehmk&#252;hler</assignee>
                                    <reporter username="SirMad">mark</reporter>
                        <labels>
                    </labels>
                <created>Fri, 16 Sep 2016 07:54:55 +0000</created>
                <updated>Sun, 9 Jul 2023 11:13:48 +0000</updated>
                            <resolved>Sun, 9 Jul 2023 11:13:48 +0000</resolved>
                                    <version>2.0.2</version>
                    <version>2.0.3</version>
                    <version>3.0.0 PDFBox</version>
                                    <fixVersion>2.0.5</fixVersion>
                    <fixVersion>3.0.0 PDFBox</fixVersion>
                                    <component>Rendering</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="15495732" author="lehmi" created="Fri, 16 Sep 2016 08:24:00 +0000"  >&lt;p&gt;PdfToTiffConverter isn&apos;t part of PDFBox. Please provide us with the some information about the parameters which are used to call PDFRenderer#renderImageWithDPI&lt;/p&gt;

&lt;p&gt;The rendering works fine using PDFDebugger (2.0.2 and trunk).&lt;/p&gt;</comment>
                            <comment id="15495793" author="sirmad" created="Fri, 16 Sep 2016 08:55:06 +0000"  >&lt;p&gt;thanks for the fast reaction.&lt;/p&gt;

&lt;p&gt;i added the PdfToTiffConverter as attachment&lt;/p&gt;</comment>
                            <comment id="15496751" author="jira-bot" created="Fri, 16 Sep 2016 16:32:33 +0000"  >&lt;p&gt;Commit 1761059 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1761059&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1761059&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3501&quot; title=&quot;java.lang.ArrayIndexOutOfBoundsException when rendering to bitonal image type&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3501&quot;&gt;&lt;del&gt;PDFBOX-3501&lt;/del&gt;&lt;/a&gt;: avoid ArrayIndexOutOfBoundsException for bitonal images&lt;/p&gt;</comment>
                            <comment id="15496752" author="jira-bot" created="Fri, 16 Sep 2016 16:32:37 +0000"  >&lt;p&gt;Commit 1761060 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1761060&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1761060&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3501&quot; title=&quot;java.lang.ArrayIndexOutOfBoundsException when rendering to bitonal image type&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3501&quot;&gt;&lt;del&gt;PDFBOX-3501&lt;/del&gt;&lt;/a&gt;: avoid ArrayIndexOutOfBoundsException for bitonal images&lt;/p&gt;</comment>
                            <comment id="15496757" author="tilman" created="Fri, 16 Sep 2016 16:34:25 +0000"  >&lt;p&gt;The javadoc of getNormalizedComponents warns about this: &lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;An ArrayIndexOutOfBoundsException is thrown if pixel is not large enough to hold a pixel value for this ColorModel.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;So I let java do the allocation.&lt;/p&gt;

&lt;p&gt;In BlendComposite:&lt;/p&gt;

&lt;p&gt;numSrcComponents: 4&lt;br/&gt;
numDstComponents: 1&lt;/p&gt;

&lt;p&gt;the dstColorModel has numComponents = 3, but dstPixel and dstComponents are both byte arrays with len 1.&lt;/p&gt;

&lt;p&gt;dstColorModel: IndexColorModel: #pixelBits = 1 numComponents = 3 color space = java.awt.color.ICC_ColorSpace@3d8c7aca transparency = 1 transIndex   = -1 has alpha = false isAlphaPre = false&lt;/p&gt;

&lt;p&gt;srcColorModel: DirectColorModel: rmask=ff0000 gmask=ff00 bmask=ff amask=ff000000&lt;/p&gt;


&lt;p&gt;The solution I did is temporary, but we no longer get an unchecked exception. The result b/w image is not good.&lt;/p&gt;</comment>
                            <comment id="15496762" author="tilman" created="Fri, 16 Sep 2016 16:36:33 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3501&quot; title=&quot;java.lang.ArrayIndexOutOfBoundsException when rendering to bitonal image type&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3501&quot;&gt;&lt;del&gt;PDFBOX-3501&lt;/del&gt;&lt;/a&gt;.pdf is page 5 only.&lt;/p&gt;</comment>
                            <comment id="15500774" author="lehmi" created="Sun, 18 Sep 2016 10:52:17 +0000"  >&lt;p&gt;We are facing 2 more or less related issues here&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;the rendering of page 5 doesn&apos;t work correct (the colored background is missing), a blending issue?&lt;/li&gt;
	&lt;li&gt;transforming a full colored image to b/w may look &quot;suboptimal&quot; especially if it contains color gradients&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Using grayscale instead of b/w delivers much better results.&lt;/p&gt;
</comment>
                            <comment id="15500803" author="tilman" created="Sun, 18 Sep 2016 11:14:00 +0000"  >&lt;p&gt;I assume that Mark needs his output into b/w images for some reason. I had the same request and decided against using the &lt;tt&gt;ImageType.BINARY&lt;/tt&gt; parameter when rendering because of poor quality. I&apos;m rendering into color images and then process the result with &lt;a href=&quot;http://www.jhlabs.com/ip/filters/index.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;jlabs&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="15502517" author="sirmad" created="Mon, 19 Sep 2016 06:56:22 +0000"  >&lt;p&gt;You are correct. i need the result as b/w image.&lt;/p&gt;</comment>
                            <comment id="15844155" author="tilman" created="Sat, 28 Jan 2017 18:38:18 +0000"  >&lt;p&gt;The missing colored background is there since [ &lt;a href=&quot;https://svn.apache.org/r1772377&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1772377&lt;/a&gt; ] from &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3000&quot; title=&quot;Transparency Group issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3000&quot;&gt;&lt;del&gt;PDFBOX-3000&lt;/del&gt;&lt;/a&gt;. The &quot;suboptimal&quot; rendering to b/w is still there.&lt;/p&gt;</comment>
                            <comment id="17741370" author="lehmi" created="Sun, 9 Jul 2023 11:13:48 +0000"  >&lt;p&gt;This was fixed with 2.0.5. I didn&apos;t dig deeper into it to detemine the exact ticket/commit responsible for this.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12828850" name="PDFBOX-3501.pdf" size="177339" author="tilman" created="Fri, 16 Sep 2016 16:36:33 +0000"/>
                            <attachment id="12828810" name="PdfToTiffConverter.java" size="2168" author="SirMad" created="Fri, 16 Sep 2016 08:54:18 +0000"/>
                            <attachment id="12828803" name="error.pdf" size="8354687" author="SirMad" created="Fri, 16 Sep 2016 07:56:59 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 17 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i33p87:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>