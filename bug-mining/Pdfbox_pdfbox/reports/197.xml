<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 20:53:27 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PDFBOX-569] Text-Extraction of PDF fails</title>
                <link>https://issues.apache.org/jira/browse/PDFBOX-569</link>
                <project id="12310760" key="PDFBOX">PDFBox</project>
                    <description>&lt;p&gt;Using trunk this Exception occurs when extracting text of attached PDF.&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;WARN&amp;#93;&lt;/span&gt; PDFParser - invalid xref line: 0&lt;br/&gt;
java.io.IOException: Cannot create font if /Type is not /Font.  Actual=COSName&lt;/p&gt;
{FontDescriptor}
&lt;p&gt;	at org.apache.pdfbox.pdmodel.font.PDFontFactory.createFont(PDFontFactory.java:95)&lt;br/&gt;
	at org.apache.pdfbox.pdmodel.font.PDFontFactory.createFont(PDFontFactory.java:68)&lt;br/&gt;
	at org.apache.pdfbox.pdmodel.PDResources.getFonts(PDResources.java:117)&lt;br/&gt;
	at org.apache.pdfbox.util.PDFStreamEngine.processSubStream(PDFStreamEngine.java:206)&lt;br/&gt;
	at org.apache.pdfbox.util.PDFStreamEngine.processStream(PDFStreamEngine.java:188)&lt;br/&gt;
	at org.apache.pdfbox.util.PDFTextStripper.processPage(PDFTextStripper.java:367)&lt;br/&gt;
	at org.apache.pdfbox.util.PDFTextStripper.processPages(PDFTextStripper.java:291)&lt;br/&gt;
	at org.apache.pdfbox.util.PDFTextStripper.writeText(PDFTextStripper.java:247)&lt;/p&gt;</description>
                <environment>1.6.0_11</environment>
        <key id="12441686">PDFBOX-569</key>
            <summary>Text-Extraction of PDF fails</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="lehmi">Andreas Lehmk&#252;hler</assignee>
                                    <reporter username="keepalive">Stephan G&#246;tter</reporter>
                        <labels>
                    </labels>
                <created>Wed, 25 Nov 2009 16:34:04 +0000</created>
                <updated>Tue, 29 May 2012 16:21:56 +0000</updated>
                            <resolved>Sun, 18 Dec 2011 16:33:05 +0000</resolved>
                                    <version>0.8.0-incubator</version>
                                    <fixVersion>1.7.0</fixVersion>
                                    <component>Text extraction</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="12883545" author="neilm" created="Tue, 29 Jun 2010 13:33:13 +0000"  >&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;Issue still appears on 1.2.0-SNAPSHOT by the way&amp;#93;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;I think this pdf is non-compliant with the standard. Correct me if I&apos;m wrong.&lt;/p&gt;

&lt;p&gt;I looked at object &quot;151 0&quot;:&lt;br/&gt;
151 0 obj&lt;br/&gt;
&amp;lt;&amp;lt; &lt;br/&gt;
/Type /Page &lt;br/&gt;
/Parent 318 0 R &lt;br/&gt;
/Contents 152 0 R &lt;br/&gt;
/MediaBox [ 0 0 420 596 ] &lt;br/&gt;
/TrimBox [ 0 0 420 596 ] &lt;br/&gt;
/CropBox [ 0 0 420 596 ] &lt;br/&gt;
/Resources &amp;lt;&amp;lt; /ProcSet [ /PDF /Text ] /XObject &amp;lt;&amp;lt; /Fm418 190 0 R /Fm419 191 0 R /Fm420 192 0 R &amp;gt;&amp;gt; &lt;br/&gt;
/Font &amp;lt;&amp;lt; /F354 196 0 R /F421 200 0 R /F579 204 0 R &amp;gt;&amp;gt; &amp;gt;&amp;gt; &lt;br/&gt;
/Rotate 0 &lt;br/&gt;
&amp;gt;&amp;gt; &lt;br/&gt;
endobj&lt;/p&gt;

&lt;p&gt;Ignoring the potential extra &quot;&amp;gt;&amp;gt;&quot;, there are three Font object references in there. If you follow the links you&apos;ll find that &quot;202 0&quot; and &quot;204 0&quot; are each defined &lt;b&gt;twice&lt;/b&gt; in the document: once of type Font and once of type FontDescriptor. This violates the standard which (in section 7.3.10) says these identifiers should be unique.&lt;/p&gt;

&lt;p&gt;So when PDFTextStripper iterates through PDResources.getFonts() it happens to find the FontDescriptor object for &quot;204 0&quot; before the Font object, passes it to PDFontFactory.createFont and that throws the exception.&lt;/p&gt;

&lt;p&gt;So I see two fixes:&lt;br/&gt;
1. Add some kind of type-check and ignore font objects that aren&apos;t of type &quot;Font&quot;.&lt;br/&gt;
2. Throw some sort of exception if we discover a pdf document with non-unique object ids.&lt;/p&gt;

&lt;p&gt;I&apos;d favour &lt;span class=&quot;error&quot;&gt;&amp;#91;2&amp;#93;&lt;/span&gt; but I wonder how many pdf documents are compliant.&lt;/p&gt;</comment>
                            <comment id="12883611" author="adamnichols" created="Tue, 29 Jun 2010 16:53:45 +0000"  >&lt;p&gt;I am not in favor of #2.  While this isn&apos;t compliant, I&apos;ve seen many production documents which have this issue.  When some programs merge two documents together, they&apos;ll just basically concatenate the PDFs.  The PDFs I&apos;ve looked into which have this issue have all said mentioned Acrobat Distiller, but I can&apos;t confirm that is what created the original PDFs, or what merged them together since I don&apos;t have that software.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-720&quot; title=&quot;Inconsistency in parsing PDFs between Windows and Linux&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-720&quot;&gt;&lt;del&gt;PDFBOX-720&lt;/del&gt;&lt;/a&gt; has some notes which are related to the issue of non-unique object IDs.  David recommended a proper fix (the whole parsing module needs to be rewritten in accordance with the PDF spec) as well as a quick fix (use a LinkedHashMap and update parseXrefStreams).  Fixing this may eliminate this issue as it&apos;ll be looking at the &quot;correct&quot; object.  I don&apos;t have time to work on &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-720&quot; title=&quot;Inconsistency in parsing PDFs between Windows and Linux&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-720&quot;&gt;&lt;del&gt;PDFBOX-720&lt;/del&gt;&lt;/a&gt; right now, but if someone has time to make a patch I can help test and confirm whether or not it&apos;s working.&lt;/p&gt;

&lt;p&gt;If your PDF opens fine in Adobe Reader, then I don&apos;t think it should throw an exception when meeting an invalid font.  While I&apos;d much rather go by the PDF spec instead of what Adobe Reader does, my users are going to say my software is inferior is it can&apos;t handle PDFs which work fine (in Adobe Reader).  Since software is made for the users, it&apos;d probably be a good idea to take their perspective into account, even if it means parsing out of spec docs.  It might be nice if we had some kind of flag we could check in addition to logging these errors.  So if the library detects that a PDF is non-compliant, it can log a detailed error message, and set a boolean to true.  That way the calling program can handle this is a special way, such as printing a warning message to the user.&lt;/p&gt;</comment>
                            <comment id="13106654" author="devlynx" created="Fri, 16 Sep 2011 18:18:52 +0000"  >&lt;p&gt;Hello,&lt;/p&gt;

&lt;p&gt;This issue is opened for a long time, and I still was able to recreate it with latest sources from the SVN.&lt;br/&gt;
Yes in this PDF file we have two 204 0 objects:&lt;/p&gt;

&lt;p&gt;....&lt;br/&gt;
....&lt;br/&gt;
...&lt;br/&gt;
----------- Offset 698060 ----------- &lt;br/&gt;
204 0 obj&lt;br/&gt;
&amp;lt;&amp;lt;&lt;br/&gt;
/Type /FontDescriptor&lt;br/&gt;
/FontName /Tele-GroteskNor,Italic&lt;br/&gt;
/Ascent 820&lt;br/&gt;
/CapHeight 500&lt;br/&gt;
/Descent -180&lt;br/&gt;
/Flags 32&lt;br/&gt;
/FontBBox &lt;span class=&quot;error&quot;&gt;&amp;#91;-68 -250 1175 880&amp;#93;&lt;/span&gt;&lt;br/&gt;
/ItalicAngle 0&lt;br/&gt;
/StemV 0&lt;br/&gt;
/AvgWidth 357&lt;br/&gt;
/Leading 0&lt;br/&gt;
/MaxWidth 1243&lt;br/&gt;
/XHeight 250&lt;br/&gt;
&amp;gt;&amp;gt;&lt;br/&gt;
endobj&lt;br/&gt;
....&lt;br/&gt;
....&lt;br/&gt;
....&lt;br/&gt;
endstream&lt;br/&gt;
endobj&lt;br/&gt;
----------- Offset 705884 ----------- &lt;br/&gt;
204 0 obj&lt;br/&gt;
&amp;lt;&amp;lt; &lt;br/&gt;
/Type /Font &lt;br/&gt;
/Subtype /Type1 &lt;br/&gt;
/Name /F579 &lt;br/&gt;
/BaseFont /Tele-GroteskNor,Italic &lt;br/&gt;
/FirstChar 30 &lt;br/&gt;
/LastChar 255 &lt;br/&gt;
/Widths 205 0 R &lt;br/&gt;
/Encoding /WinAnsiEncoding &lt;br/&gt;
/FontDescriptor 206 0 R &lt;br/&gt;
&amp;gt;&amp;gt; &lt;br/&gt;
endobj&lt;br/&gt;
...&lt;br/&gt;
...&lt;br/&gt;
...&lt;/p&gt;

&lt;p&gt;Only second object present in the xref table so it should be used instead of the first one. &lt;/p&gt;

&lt;p&gt;Current PDFParser code is able to handle such situations. When it founds two objects with similar names, it saves the offset to the second one in conflictList. When whole document is parsed it calls:&lt;/p&gt;

&lt;p&gt;ConflictObj.resolveConflicts(document, conflictList);&lt;/p&gt;

&lt;p&gt;Which stores only those object which offset is found in xrefTable. So it should save the second one and it is right.&lt;br/&gt;
But it fails to do this because offset to the second object calculated incorrectly.&lt;/p&gt;

&lt;p&gt;Fix for this problem provided in the patch.&lt;/p&gt;

&lt;p&gt;Regards,&lt;br/&gt;
LX&lt;/p&gt;
</comment>
                            <comment id="13171896" author="lehmi" created="Sun, 18 Dec 2011 16:33:05 +0000"  >&lt;p&gt;I added the patch in revision 1220449 as proposed by LynX&lt;/p&gt;

&lt;p&gt;Thanks for the contribution!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12494837" name="TextExtractionFix-569.patch" size="583" author="devlynx" created="Fri, 16 Sep 2011 18:18:52 +0000"/>
                            <attachment id="12426120" name="b820GL0204.pdf" size="724529" author="keepalive" created="Wed, 25 Nov 2009 16:36:04 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>60361</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 48 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0zfdr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>204794</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>