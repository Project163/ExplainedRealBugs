<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:01:12 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PDFBOX-2846] setValue failing with font issues.</title>
                <link>https://issues.apache.org/jira/browse/PDFBOX-2846</link>
                <project id="12310760" key="PDFBOX">PDFBox</project>
                    <description>&lt;p&gt;attempting to upgrade from 1.8.9 to 2.0.0 and Working with the snapshot builds I am bumping into what might be a bug regarding fonts.&lt;/p&gt;

&lt;p&gt;trying to setValue on a PDTextField object. If the value contains a space char I get an error.&lt;/p&gt;

&lt;p&gt;on Ubuntu my stacktrace is: &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;No glyph &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; U+0020 in font Arial-BoldMT. Stacktrace follows:
java.lang.IllegalArgumentException: No glyph &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; U+0020 in font Arial-BoldMT
	at org.apache.pdfbox.pdmodel.font.PDTrueTypeFont.encode(PDTrueTypeFont.java:297)
	at org.apache.pdfbox.pdmodel.font.PDFont.encode(PDFont.java:282)
	at org.apache.pdfbox.pdmodel.font.PDFont.getStringWidth(PDFont.java:311)
	at org.apache.pdfbox.pdmodel.interactive.form.PlainText$Paragraph.getLines(PlainText.java:169)
	at org.apache.pdfbox.pdmodel.interactive.form.PlainTextFormatter.format(PlainTextFormatter.java:177)
	at org.apache.pdfbox.pdmodel.interactive.form.AppearanceGeneratorHelper.insertGeneratedAppearance(AppearanceGeneratorHelper.java:246)
	at org.apache.pdfbox.pdmodel.interactive.form.AppearanceGeneratorHelper.setAppearanceContent(AppearanceGeneratorHelper.java:152)
	at org.apache.pdfbox.pdmodel.interactive.form.AppearanceGeneratorHelper.setAppearanceValue(AppearanceGeneratorHelper.java:106)
	at org.apache.pdfbox.pdmodel.interactive.form.PDTextField.constructAppearances(PDTextField.java:262)
	at org.apache.pdfbox.pdmodel.interactive.form.PDTerminalField.applyChange(PDTerminalField.java:220)
	at org.apache.pdfbox.pdmodel.interactive.form.PDTextField.setValue(PDTextField.java:217)
...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;On OS X the stacktrace is : &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Caused by: java.lang.NoClassDefFoundError: Could not initialize &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;org.apache.pdfbox.pdmodel.font.FontMapper$DefaultFontProvider
	at org.apache.pdfbox.pdmodel.font.FontMapper.getProvider(FontMapper.java:99)
	at org.apache.pdfbox.pdmodel.font.FontMapper.findFont(FontMapper.java:428)
	at org.apache.pdfbox.pdmodel.font.FontMapper.getTrueTypeFont(FontMapper.java:326)
	at org.apache.pdfbox.pdmodel.font.PDTrueTypeFont.&amp;lt;init&amp;gt;(PDTrueTypeFont.java:155)
	at org.apache.pdfbox.pdmodel.font.PDFontFactory.createFont(PDFontFactory.java:75)
	at org.apache.pdfbox.pdmodel.PDResources.getFont(PDResources.java:96)
	at org.apache.pdfbox.pdmodel.interactive.form.PDAppearanceString.copyNeededResourcesTo(PDAppearanceString.java:173)
	at org.apache.pdfbox.
pdmodel.interactive.form.AppearanceGeneratorHelper.setAppearanceContent(AppearanceGeneratorHelper.java:130)
	at org.apache.pdfbox.pdmodel.interactive.form.AppearanceGeneratorHelper.setAppearanceValue(AppearanceGeneratorHelper.java:106)
	at org.apache.pdfbox.pdmodel.interactive.form.PDTextField.constructAppearances(PDTextField.java:262)
	at org.apache.pdfbox.pdmodel.interactive.form.PDTerminalField.applyChange(PDTerminalField.java:220)
	at org.apache.pdfbox.pdmodel.interactive.form.PDTextField.setValue(PDTextField.java:217)
...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;not sure what the difference is on the two systems that causes this, but this and the fact that setField worked pretty well in 1.8.9 with the same pdf file makes me think it isn&apos;t related entirely to something broken about the embedded font in the pdf.&lt;/p&gt;

&lt;p&gt;example (groovy) code for setting a value&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;		...
		PDDocumentCatalog catalog = document.getDocumentCatalog()
		PDAcroForm acroForm = catalog.getAcroForm()
		def fieldtest = acroForm.getField(&lt;span class=&quot;code-quote&quot;&gt;&apos;certNo&apos;&lt;/span&gt;)
		fieldtest.setValue(&lt;span class=&quot;code-quote&quot;&gt;&apos;test Something&apos;&lt;/span&gt;) &lt;span class=&quot;code-comment&quot;&gt;// &amp;lt;- change to &lt;span class=&quot;code-quote&quot;&gt;&apos;testSomething&apos;&lt;/span&gt; and it will work &lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment>Ubuntu, Java 7 &amp;amp; OS X Java 7</environment>
        <key id="12841468">PDFBOX-2846</key>
            <summary>setValue failing with font issues.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="aeischeid">Aaron Eischeid</reporter>
                        <labels>
                    </labels>
                <created>Mon, 29 Jun 2015 22:43:18 +0000</created>
                <updated>Thu, 17 Mar 2016 19:07:47 +0000</updated>
                            <resolved>Wed, 12 Aug 2015 02:40:33 +0000</resolved>
                                    <version>2.0.0</version>
                                    <fixVersion>2.0.0</fixVersion>
                                    <component>AcroForm</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="14606616" author="tilman" created="Mon, 29 Jun 2015 23:03:21 +0000"  >&lt;p&gt;Could you add some code that shows what field you&apos;re trying to set / update?&lt;/p&gt;</comment>
                            <comment id="14606628" author="aeischeid" created="Mon, 29 Jun 2015 23:12:03 +0000"  >&lt;p&gt;added in main issue.&lt;/p&gt;</comment>
                            <comment id="14608417" author="tilman" created="Tue, 30 Jun 2015 14:56:23 +0000"  >&lt;p&gt;It works fine for me on Windows 7 with this code:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;        PDDocumentCatalog catalog = doc.getDocumentCatalog();
        PDAcroForm acroForm = catalog.getAcroForm();
        PDTextField fieldtest = (PDTextField) acroForm.getField(&lt;span class=&quot;code-quote&quot;&gt;&quot;certNo&quot;&lt;/span&gt;);
        fieldtest.setValue(&lt;span class=&quot;code-quote&quot;&gt;&quot;test Something&quot;&lt;/span&gt;);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;One difference to your code: a cast to PDTextField. But if the wikipedia article on groovy is correct, you used dynamic typing, so it doesn&apos;t matter. Make sure you have the latest version, there were some changes in fontbox recently.&lt;/p&gt;

&lt;p&gt;If it still doesn&apos;t work, maybe it happens only on Ubuntu &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; To verify this, could you temporarly replace your font with one from a W7 system? The file is in \Windows\Fonts\arialbd.ttf . Re the OSX problem, is there more in the stack trace, e.g. a &quot;caused by&quot; part?&lt;/p&gt;</comment>
                            <comment id="14647633" author="sim0n" created="Thu, 30 Jul 2015 13:49:53 +0000"  >&lt;p&gt;Hi,&lt;/p&gt;

&lt;p&gt;I am facing the exact same problem.&lt;br/&gt;
With the latest stable version it works as expected. Using the latest git revision it fails with the following error:&lt;/p&gt;

&lt;p&gt;Exception in thread &quot;main&quot; java.lang.IllegalArgumentException: No glyph for U+0074 in font Calibri&lt;br/&gt;
	at org.apache.pdfbox.pdmodel.font.PDTrueTypeFont.encode(PDTrueTypeFont.java:357)&lt;br/&gt;
	at org.apache.pdfbox.pdmodel.font.PDFont.encode(PDFont.java:282)&lt;br/&gt;
	at org.apache.pdfbox.pdmodel.font.PDFont.getStringWidth(PDFont.java:311)&lt;br/&gt;
	at org.apache.pdfbox.pdmodel.interactive.form.PlainTextFormatter.format(PlainTextFormatter.java:188)&lt;br/&gt;
	at org.apache.pdfbox.pdmodel.interactive.form.AppearanceGeneratorHelper.insertGeneratedAppearance(AppearanceGeneratorHelper.java:307)&lt;br/&gt;
	at org.apache.pdfbox.pdmodel.interactive.form.AppearanceGeneratorHelper.setAppearanceContent(AppearanceGeneratorHelper.java:171)&lt;br/&gt;
	at org.apache.pdfbox.pdmodel.interactive.form.AppearanceGeneratorHelper.setAppearanceValue(AppearanceGeneratorHelper.java:126)&lt;br/&gt;
	at org.apache.pdfbox.pdmodel.interactive.form.PDTextField.constructAppearances(PDTextField.java:262)&lt;br/&gt;
	at org.apache.pdfbox.pdmodel.interactive.form.PDTerminalField.applyChange(PDTerminalField.java:220)&lt;br/&gt;
	at org.apache.pdfbox.pdmodel.interactive.form.PDTextField.setValue(PDTextField.java:217)&lt;/p&gt;


&lt;p&gt;As the document which was uploaded by Aaron actually works for me, I looked a bit closer at what the difference between his and my document is and I did spot something.&lt;br/&gt;
In his document the Arial font is used, whereas in mine it is Calibri.&lt;/p&gt;

&lt;p&gt;I tracked down the issue to be exactly that. The postscript table is empty, and thus the glyph cannot be found and it throws an exception.&lt;br/&gt;
Now why that happens, I have no idea.&lt;/p&gt;

&lt;p&gt;When I change the font of all my fields to Arial (just for testing), it works fine.&lt;br/&gt;
It also doesn&apos;t make a difference whether the font is embedded or not.&lt;/p&gt;

&lt;p&gt;For illustrating purposes I have attached another sample to this report with one field using Arial and another one using Calibri font.&lt;/p&gt;


&lt;p&gt;Code for testing:&lt;br/&gt;
        PDTextField fieldtest = (PDTextField) acroForm.getField(&quot;form1&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;.#subform&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;.Header&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;.Name&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;&quot;);&lt;br/&gt;
        fieldtest.setValue(&quot;test Something&quot;);&lt;/p&gt;

&lt;p&gt;        PDTextField fieldtest2 = (PDTextField) acroForm.getField(&quot;form1&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;.#subform&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;.Header&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;.Title&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;&quot;);&lt;br/&gt;
        fieldtest2.setValue(&quot;test Something&quot;);&lt;/p&gt;</comment>
                            <comment id="14647637" author="sim0n" created="Thu, 30 Jul 2015 13:51:19 +0000"  >&lt;p&gt;Sample form with two fields using different fonts (Arial, Calibri)&lt;/p&gt;</comment>
                            <comment id="14661750" author="msahyoun" created="Fri, 7 Aug 2015 12:23:09 +0000"  >&lt;p&gt;As the font Calibri doesn&apos;t have a postscript name table the statement &lt;tt&gt;if (!ttf.hasGlyph(name))&lt;/tt&gt; in &lt;tt&gt;PDTrueTypeFont.encode()&lt;/tt&gt; will be &lt;tt&gt;false&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jahewson&quot; class=&quot;user-hover&quot; rel=&quot;jahewson&quot;&gt;jahewson&lt;/a&gt; Is that check needed as this could also be done on the result of &lt;tt&gt;getInvertedEncoding()&lt;/tt&gt;? Or maybe create the info from the cmap table together with the glyphlist.txt in such cases?&lt;/p&gt;</comment>
                            <comment id="14663286" author="jahewson" created="Sun, 9 Aug 2015 06:59:33 +0000"  >&lt;p&gt;No, this check can&apos;t be done on the encoding. Encodings and fonts are separate, so while an encoding may contain a given glyph name, the font in question may not actually provide that glyph.&lt;/p&gt;

&lt;p&gt;What I can do is fall back to using the Unicode glyph name in the form &quot;uniXXXX&quot;, which TrueTypeFont&apos;s hasGlyph method is able to interpret using the cmap table.&lt;/p&gt;</comment>
                            <comment id="14663287" author="jira-bot" created="Sun, 9 Aug 2015 07:00:15 +0000"  >&lt;p&gt;Commit 1694856 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jahewson&quot; class=&quot;user-hover&quot; rel=&quot;jahewson&quot;&gt;jahewson&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1694856&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1694856&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2846&quot; title=&quot;setValue failing with font issues.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2846&quot;&gt;&lt;del&gt;PDFBOX-2846&lt;/del&gt;&lt;/a&gt;: Try to find glyphs by unicode name if standard name doesn&apos;t work&lt;/p&gt;</comment>
                            <comment id="14663288" author="jahewson" created="Sun, 9 Aug 2015 07:00:58 +0000"  >&lt;p&gt;Give this a try, it&apos;s a sensible fallback anyway. I haven&apos;t had time to test if it works on the files in question.&lt;/p&gt;</comment>
                            <comment id="14663292" author="msahyoun" created="Sun, 9 Aug 2015 07:07:15 +0000"  >&lt;p&gt;thanks - that fixes the issue for me.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sim0n&quot; class=&quot;user-hover&quot; rel=&quot;sim0n&quot;&gt;sim0n&lt;/a&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=aeischeid&quot; class=&quot;user-hover&quot; rel=&quot;aeischeid&quot;&gt;aeischeid&lt;/a&gt; could you verify the fix and report back?&lt;/p&gt;</comment>
                            <comment id="14681527" author="sim0n" created="Tue, 11 Aug 2015 09:35:28 +0000"  >&lt;p&gt;Thanks a lot! That also fixes it for me.&lt;/p&gt;</comment>
                            <comment id="14692816" author="jahewson" created="Wed, 12 Aug 2015 02:40:29 +0000"  >&lt;p&gt;Good work team!&lt;/p&gt;</comment>
                            <comment id="15045644" author="aeischeid" created="Mon, 7 Dec 2015 20:21:36 +0000"  >&lt;p&gt;Just confirming this seems to be fixed for me.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12742622" name="Pulmotil_VFD_Swine_Template.pdf" size="160957" author="aeischeid" created="Mon, 29 Jun 2015 22:44:40 +0000"/>
                            <attachment id="12747987" name="testform.pdf" size="1064345" author="sim0n" created="Thu, 30 Jul 2015 13:51:19 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 49 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2gncv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>