<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:02:42 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PDFBOX-3173] Signature dictionary is not decrypted in encrypted files</title>
                <link>https://issues.apache.org/jira/browse/PDFBOX-3173</link>
                <project id="12310760" key="PDFBOX">PDFBox</project>
                    <description>&lt;p&gt;Changes in &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2801&quot; title=&quot;SecurityHandler does not tolerate plain-text COSString&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2801&quot;&gt;&lt;del&gt;PDFBOX-2801&lt;/del&gt;&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2469&quot; title=&quot;javax.crypto.BadPaddingException in PDFBox 1.8.8-SNAPSHOT&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2469&quot;&gt;&lt;del&gt;PDFBOX-2469&lt;/del&gt;&lt;/a&gt; result in the signature dictionary not being decrypted in encrypted files. Because these aren&apos;t visible signatures, this is noticed only when looking at the signature dictionary in PDFDebugger.&lt;/p&gt;

&lt;p&gt;See also this thread in the dev mailing list:&lt;br/&gt;
&lt;a href=&quot;https://mail-archives.apache.org/mod_mbox/pdfbox-dev/201512.mbox/browser&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://mail-archives.apache.org/mod_mbox/pdfbox-dev/201512.mbox/browser&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Example files:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2711&quot; title=&quot;Japanese text not extracted&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2711&quot;&gt;&lt;del&gt;PDFBOX-2711&lt;/del&gt;&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;045697.pdf&lt;/li&gt;
	&lt;li&gt;050289.pdf&lt;/li&gt;
	&lt;li&gt;070413.pdf&lt;/li&gt;
	&lt;li&gt;346444.pdf&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;I hit that problem while wondering what to do about &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2729&quot; title=&quot;Can&amp;#39;t sign encrypted PDF files&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2729&quot;&gt;&lt;del&gt;PDFBOX-2729&lt;/del&gt;&lt;/a&gt;, and wondered why the &quot;too good to be true&quot; solution of &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=GGlad&quot; class=&quot;user-hover&quot; rel=&quot;GGlad&quot;&gt;GGlad&lt;/a&gt; worked at all, because his solution did encrypt the signature parts.&lt;/p&gt;

&lt;p&gt;I did not find anything in the &quot;32000&quot; spec that the signature dictionary is not to be encrypted.&lt;/p&gt;

&lt;p&gt;From &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=msahyoun&quot; class=&quot;user-hover&quot; rel=&quot;msahyoun&quot;&gt;msahyoun&lt;/a&gt;:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;From ISO32000-2:&lt;/p&gt;

&lt;p&gt;Encryption applies to all strings and streams in the document&apos;s PDF file, with the following exceptions:&lt;/p&gt;

&lt;p&gt;The values for the  ID entry in the trailer&lt;/p&gt;

&lt;p&gt;Any strings in an Encrypt dictionary&lt;/p&gt;

&lt;p&gt;Any strings that are inside streams such as content streams and compressed object streams, which themselves are encrypted&lt;/p&gt;

&lt;p&gt;Any hexadecimal strings representing the value of the Contents  key in a Signature dictionary &lt;/p&gt;&lt;/blockquote&gt;</description>
                <environment></environment>
        <key id="12923720">PDFBOX-3173</key>
            <summary>Signature dictionary is not decrypted in encrypted files</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tilman">Tilman Hausherr</assignee>
                                    <reporter username="tilman">Tilman Hausherr</reporter>
                        <labels>
                    </labels>
                <created>Tue, 22 Dec 2015 11:18:57 +0000</created>
                <updated>Mon, 18 Jan 2016 12:01:52 +0000</updated>
                            <resolved>Mon, 4 Jan 2016 18:08:32 +0000</resolved>
                                    <version>1.8.10</version>
                    <version>1.8.11</version>
                    <version>2.0.0</version>
                                    <fixVersion>1.8.11</fixVersion>
                    <fixVersion>2.0.0</fixVersion>
                                    <component>Crypto</component>
                    <component>Signing</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="15068414" author="jira-bot" created="Tue, 22 Dec 2015 17:14:37 +0000"  >&lt;p&gt;Commit 1721434 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1721434&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1721434&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3173&quot; title=&quot;Signature dictionary is not decrypted in encrypted files&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3173&quot;&gt;&lt;del&gt;PDFBOX-3173&lt;/del&gt;&lt;/a&gt;: decrypt signature dictionary except /Contents string; don&apos;t fail on COSString decryption failure as suggested by Michele Balistreri&lt;/p&gt;</comment>
                            <comment id="15068418" author="tilman" created="Tue, 22 Dec 2015 17:20:23 +0000"  >&lt;p&gt;The last commit has two parts. The first part is that only the /Contents string is not decrypted, but the rest is. This works fine with my test files, except the file from &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2801&quot; title=&quot;SecurityHandler does not tolerate plain-text COSString&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2801&quot;&gt;&lt;del&gt;PDFBOX-2801&lt;/del&gt;&lt;/a&gt; that was provided by &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=briksoftware&quot; class=&quot;user-hover&quot; rel=&quot;briksoftware&quot;&gt;briksoftware&lt;/a&gt;. That one failed in object 9, /Author entry, because that string is 47 bytes long, but must be a mutiple of 16 for AES decryption (Adobe Reader is able to decrypt it - maybe the initial backslash + open parenthesis is the problem but that is not our bug). That is what the second part of the commit is for, it is what &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=briksoftware&quot; class=&quot;user-hover&quot; rel=&quot;briksoftware&quot;&gt;briksoftware&lt;/a&gt; suggested at first, which would also solve the problem with the file he didn&apos;t attach.&lt;/p&gt;

&lt;p&gt;Next: test with 1.8.&lt;/p&gt;</comment>
                            <comment id="15068625" author="briksoftware" created="Tue, 22 Dec 2015 19:40:16 +0000"  >&lt;p&gt;I will test this tomorrow. Thanks for letting me know about this change.&lt;/p&gt;</comment>
                            <comment id="15069724" author="jira-bot" created="Wed, 23 Dec 2015 15:14:08 +0000"  >&lt;p&gt;Commit 1721552 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/branches/1.8&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1721552&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1721552&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3173&quot; title=&quot;Signature dictionary is not decrypted in encrypted files&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3173&quot;&gt;&lt;del&gt;PDFBOX-3173&lt;/del&gt;&lt;/a&gt;: decrypt signature dictionary except /Contents string; don&apos;t fail on COSString decryption failure as suggested by Michele Balistreri&lt;/p&gt;</comment>
                            <comment id="15069771" author="tchojecki" created="Wed, 23 Dec 2015 15:56:41 +0000"  >&lt;p&gt;We should also handle document timestamps. &lt;br/&gt;
They use the signature dictionary as well, but has &quot;DocTimeStamp&quot; as value for the Type.&lt;/p&gt;

&lt;p&gt;See  &lt;a href=&quot;http://www.etsi.org/deliver/etsi_ts/102700_102799/10277804/01.01.01_60/ts_10277804v010101p.pdf&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.etsi.org/deliver/etsi_ts/102700_102799/10277804/01.01.01_60/ts_10277804v010101p.pdf&lt;/a&gt;&lt;br/&gt;
Page 15, Chapter A.2, First table entry&lt;/p&gt;</comment>
                            <comment id="15069803" author="tilman" created="Wed, 23 Dec 2015 16:12:02 +0000"  >&lt;p&gt;I assume you mean that &quot;DocTimeStamp&quot; should be treated like &quot;Sig&quot;, i.e. that its &quot;Contents&quot; string shall be left untouched. Do you have a sample file?&lt;/p&gt;</comment>
                            <comment id="15069829" author="tilman" created="Wed, 23 Dec 2015 16:26:55 +0000"  >&lt;p&gt;Thanks, but can you also sign a file that is already encrypted? There are two in &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2469&quot; title=&quot;javax.crypto.BadPaddingException in PDFBox 1.8.8-SNAPSHOT&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2469&quot;&gt;&lt;del&gt;PDFBOX-2469&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="15069909" author="jira-bot" created="Wed, 23 Dec 2015 17:23:19 +0000"  >&lt;p&gt;Commit 1721560 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1721560&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1721560&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3173&quot; title=&quot;Signature dictionary is not decrypted in encrypted files&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3173&quot;&gt;&lt;del&gt;PDFBOX-3173&lt;/del&gt;&lt;/a&gt;: /Type /DocTimeStamp is also a signature dictionary, as suggested by Thomas Chojecki&lt;/p&gt;</comment>
                            <comment id="15070920" author="jira-bot" created="Thu, 24 Dec 2015 11:44:14 +0000"  >&lt;p&gt;Commit 1721612 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/branches/1.8&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1721612&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1721612&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3173&quot; title=&quot;Signature dictionary is not decrypted in encrypted files&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3173&quot;&gt;&lt;del&gt;PDFBOX-3173&lt;/del&gt;&lt;/a&gt;: /Type /DocTimeStamp is also a signature dictionary, as suggested by Thomas Chojecki&lt;/p&gt;</comment>
                            <comment id="15072782" author="tchojecki" created="Mon, 28 Dec 2015 14:58:18 +0000"  >&lt;p&gt;I&apos;ve tried it but without success. At the moment we use the pdfbox 1.8.8 and that version isn&apos;t capable to create a non broken document. Porting to 2.0.0 isn&apos;t possible without bigger refactoring. Maybe at the moment impossible, because some features like PDPage to Image is missing and need to be reimplemented. &lt;/p&gt;

&lt;p&gt;So at the moment I can only offer verification with pdfbox 2.0.0.&lt;/p&gt;

&lt;p&gt;PS: &lt;br/&gt;
I used this file for testing: FormI-9-English.pdf and the result is &lt;a href=&quot;http://people.apache.org/~tchojecki/Signed7189737479851398678.pdf&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://people.apache.org/~tchojecki/Signed7189737479851398678.pdf&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;My code look something like this:&lt;br/&gt;
...&lt;br/&gt;
if (document.isEncrypted())&lt;br/&gt;
{&lt;br/&gt;
  document.decrypt(&quot;&quot;);&lt;br/&gt;
  document.encrypt(&quot;&quot;, &quot;&quot;);&lt;br/&gt;
}&lt;br/&gt;
...&lt;/p&gt;

&lt;p&gt;And this combination is the only one that produce a document at all and not throwing exceptions.&lt;/p&gt;</comment>
                            <comment id="15081448" author="tilman" created="Mon, 4 Jan 2016 17:45:46 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=briksoftware&quot; class=&quot;user-hover&quot; rel=&quot;briksoftware&quot;&gt;briksoftware&lt;/a&gt; does it work? I&apos;d like to set this issue to resolved.&lt;/p&gt;</comment>
                            <comment id="15081498" author="briksoftware" created="Mon, 4 Jan 2016 18:07:31 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; I apologize, with the New Year holidays I had forgot to do this. I have tested right now all my documents, including the one showing that issue and it works flawlessly.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12779044" name="045697.pdf" size="148616" author="tilman" created="Tue, 22 Dec 2015 13:24:23 +0000"/>
                            <attachment id="12779045" name="050289.pdf" size="2397428" author="tilman" created="Tue, 22 Dec 2015 13:24:23 +0000"/>
                            <attachment id="12779046" name="070413.pdf" size="1380567" author="tilman" created="Tue, 22 Dec 2015 13:24:23 +0000"/>
                            <attachment id="12779550" name="346444.pdf" size="48222" author="tilman" created="Sat, 26 Dec 2015 15:24:35 +0000"/>
                            <attachment id="12779258" name="Sample_DocTimestamp.pdf" size="65575" author="tchojecki" created="Wed, 23 Dec 2015 16:20:06 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 45 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2q7jr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>