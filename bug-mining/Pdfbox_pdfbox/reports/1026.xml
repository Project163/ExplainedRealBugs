<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 20:59:48 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PDFBOX-2723] PDFBox*.tmp files not deleted by COSParser </title>
                <link>https://issues.apache.org/jira/browse/PDFBOX-2723</link>
                <project id="12310760" key="PDFBOX">PDFBox</project>
                    <description>&lt;p&gt;When parsing PDFs, temporary files get created under the system temp directory (e.g. PDFBox6525369863339991063.tmp).  All files created for each documents are always deleted except for one.   So each document parsed adds a new tmp file that never gets deleted.  That&apos;s likely due to a stream never closed.  When processing many PDFs on Linux in the same JVM instance, we get the crashing error: &quot;Too many files open&quot;.  Changing the max file handle on the OS is not always an option.&lt;/p&gt;

&lt;p&gt;I was able to fix this by modifying the &lt;tt&gt;COSParser&lt;/tt&gt; class to close a &lt;tt&gt;COSStream&lt;/tt&gt; instance:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-style: solid;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;border-bottom-style: solid;&quot;&gt;&lt;b&gt;COSParser.java, starting on line 312&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; parseXrefObjStream(&lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; objByteOffset, &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; isStandalone) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException
    {
        &lt;span class=&quot;code-comment&quot;&gt;// ---- parse indirect object head
&lt;/span&gt;        readObjectNumber();
        readGenerationNumber();
        readExpectedString(OBJ_MARKER, &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;);

        COSDictionary dict = parseCOSDictionary();
        COSStream xrefStream = parseCOSStream(dict);
        parseXrefStream(xrefStream, (&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;) objByteOffset, isStandalone);
        xrefStream.close();  &lt;span class=&quot;code-comment&quot;&gt;// &amp;lt;--- *** NEW LINE ***
&lt;/span&gt;        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; dict.getLong(COSName.PREV);
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment>Windows and Linux, with issue being critical on Linux</environment>
        <key id="12784630">PDFBOX-2723</key>
            <summary>PDFBox*.tmp files not deleted by COSParser </summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tilman">Tilman Hausherr</assignee>
                                    <reporter username="pascal.essiembre">Pascal Essiembre</reporter>
                        <labels>
                            <label>patch</label>
                    </labels>
                <created>Sun, 22 Mar 2015 04:45:40 +0000</created>
                <updated>Thu, 17 Mar 2016 19:08:38 +0000</updated>
                            <resolved>Mon, 23 Mar 2015 05:55:30 +0000</resolved>
                                    <version>2.0.0</version>
                                    <fixVersion>2.0.0</fixVersion>
                                    <component>Parsing</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>4</watches>
                                    <workratio workratioPercent="0"/>
                                    <progress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                    <timeoriginalestimate seconds="300">5m</timeoriginalestimate>
                            <timeestimate seconds="300">5m</timeestimate>
                                        <comments>
                            <comment id="14374791" author="pascal.essiembre" created="Sun, 22 Mar 2015 04:49:07 +0000"  >&lt;p&gt;The fix for this issue.  I tested it a few different ways and I got no issues from closing the stream.&lt;/p&gt;</comment>
                            <comment id="14374862" author="jira-bot" created="Sun, 22 Mar 2015 10:13:22 +0000"  >&lt;p&gt;Commit 1668349 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1668349&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1668349&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2723&quot; title=&quot;PDFBox*.tmp files not deleted by COSParser &quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2723&quot;&gt;&lt;del&gt;PDFBOX-2723&lt;/del&gt;&lt;/a&gt;: close open stream, as suggested by Pascal Essiembre&lt;/p&gt;</comment>
                            <comment id="14374863" author="tilman" created="Sun, 22 Mar 2015 10:13:57 +0000"  >&lt;p&gt;Indeed. It happens when using a scratch file, and it no longer happens with the fix.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lehmi&quot; class=&quot;user-hover&quot; rel=&quot;lehmi&quot;&gt;lehmi&lt;/a&gt; should we do this for 1.8 as well?&lt;/p&gt;</comment>
                            <comment id="14374918" author="lehmi" created="Sun, 22 Mar 2015 13:03:26 +0000"  >&lt;p&gt;1.8 isn&apos;t affected in the same way as 2.0.0 as it uses one scratch file for all purposes. &lt;br/&gt;
But it&apos;s always a good idea to close all streams if not used anymore.&lt;/p&gt;</comment>
                            <comment id="14375139" author="jira-bot" created="Sun, 22 Mar 2015 19:59:32 +0000"  >&lt;p&gt;Commit 1668469 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/branches/1.8&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1668469&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1668469&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2723&quot; title=&quot;PDFBox*.tmp files not deleted by COSParser &quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2723&quot;&gt;&lt;del&gt;PDFBOX-2723&lt;/del&gt;&lt;/a&gt;: close open stream, as suggested by Pascal Essiembre&lt;/p&gt;</comment>
                            <comment id="14375143" author="tilman" created="Sun, 22 Mar 2015 20:02:35 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=pascal.essiembre&quot; class=&quot;user-hover&quot; rel=&quot;pascal.essiembre&quot;&gt;pascal.essiembre&lt;/a&gt; thanks for your work on finding the cause of this bug. Setting to resolved.&lt;/p&gt;</comment>
                            <comment id="14375303" author="pascal.essiembre" created="Mon, 23 Mar 2015 02:34:26 +0000"  >&lt;p&gt;Thank for putting this in!&lt;/p&gt;</comment>
                            <comment id="14375305" author="pascal.essiembre" created="Mon, 23 Mar 2015 02:34:48 +0000"  >&lt;p&gt;Verified the fix.&lt;/p&gt;</comment>
                            <comment id="14375434" author="tilman" created="Mon, 23 Mar 2015 05:55:22 +0000"  >&lt;p&gt;Please don&apos;t close issues; in this project we close resolved issues only after a release.&lt;/p&gt;</comment>
                            <comment id="14376727" author="tilman" created="Mon, 23 Mar 2015 21:57:03 +0000"  >&lt;p&gt;I&apos;m reverting the 1.8 change, a test with my files shows about 30 with this exception:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;SCHWERWIEGEND: Error converting file annots.pdf
java.io.IOException: Missing root object specification in trailer.
	at org.apache.pdfbox.pdfparser.NonSequentialPDFParser.initialParse(NonSequentialPDFParser.java:391)
	at org.apache.pdfbox.pdfparser.NonSequentialPDFParser.parse(NonSequentialPDFParser.java:887)
	at org.apache.pdfbox.pdmodel.PDDocument.loadNonSeq(PDDocument.java:1273)
	at org.apache.pdfbox.pdmodel.PDDocument.loadNonSeq(PDDocument.java:1256)
	at org.apache.pdfbox.util.TestPDFToImage.doTestFile(TestPDFToImage.java:198)
	at org.apache.pdfbox.util.TestPDFToImage.testRenderImage(TestPDFToImage.java:349)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at junit.framework.TestCase.runTest(TestCase.java:168)
	at junit.framework.TestCase.runBare(TestCase.java:134)
	at junit.framework.TestResult$1.protect(TestResult.java:110)
	at junit.framework.TestResult.runProtected(TestResult.java:128)
	at junit.framework.TestResult.run(TestResult.java:113)
	at junit.framework.TestCase.run(TestCase.java:124)
	at junit.framework.TestSuite.runTest(TestSuite.java:232)
	at junit.framework.TestSuite.run(TestSuite.java:227)
	at junit.textui.TestRunner.doRun(TestRunner.java:116)
	at junit.textui.TestRunner.start(TestRunner.java:180)
	at junit.textui.TestRunner.main(TestRunner.java:138)
	at org.apache.pdfbox.util.TestPDFToImage.main(TestPDFToImage.java:399)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14376730" author="jira-bot" created="Mon, 23 Mar 2015 21:58:26 +0000"  >&lt;p&gt;Commit 1668749 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/branches/1.8&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1668749&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1668749&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2723&quot; title=&quot;PDFBox*.tmp files not deleted by COSParser &quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2723&quot;&gt;&lt;del&gt;PDFBOX-2723&lt;/del&gt;&lt;/a&gt;: revert last change due to regressions&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12706368" name="pdfbox.patch" size="599" author="pascal.essiembre" created="Sun, 22 Mar 2015 04:49:07 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 34 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i276zb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>