<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 20:56:50 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PDFBOX-538] CryptographyException on Adobe Distiller generated file</title>
                <link>https://issues.apache.org/jira/browse/PDFBOX-538</link>
                <project id="12310760" key="PDFBOX">PDFBox</project>
                    <description>&lt;p&gt;Well... this is actually &lt;b&gt;not&lt;/b&gt; a PDFBox bug, but an Adobe Distiller (7.0.x) one...&lt;/p&gt;

&lt;p&gt;The following exception is thrown in StandardSecurityHandler.computeEncryptedKey:&lt;/p&gt;

&lt;p&gt;org.apache.pdfbox.exceptions.CryptographyException: Error: length should be 5 when revision is two actual=16&lt;/p&gt;

&lt;p&gt;The PDF file is accepted by various readers and contains the following object:&lt;/p&gt;

&lt;p&gt;2106 0 obj&lt;br/&gt;
&amp;lt;&amp;lt; &lt;br/&gt;
/Filter /Standard&lt;br/&gt;
/V 1&lt;br/&gt;
/R 2&lt;br/&gt;
/Length 128&lt;br/&gt;
/P -12&lt;br/&gt;
/O (f&#165;&#8212;&#232;&#224;&#227;&#216;&#8225;&#65533;&#230;a&#167;&#65533;&#187;e&#252;cm&#253;/&#198;6&#239;&#224;Y&#247;[*&#8482;6)&lt;br/&gt;
/U (&#229;&#163;&#225;t&#194;&amp;gt;c&#247;s&#201;c&#251;^K&#222;&#8226;&#192;&#8250;&#182;YjC&#242;~)&lt;br/&gt;
&amp;gt;&amp;gt;&lt;br/&gt;
endobj&lt;/p&gt;

&lt;p&gt;Referenced by an encrypt tag:&lt;br/&gt;
/Encrypt 2106 0 R&lt;/p&gt;

&lt;p&gt;PDFBox rejects (rightly) such an object with version 1, revision 2 and a length != 5*8&lt;/p&gt;

&lt;p&gt;That said, we are parsing many of those files to feed a Lucene index. Could the validation be relaxed ?&lt;/p&gt;</description>
                <environment></environment>
        <key id="12437720">PDFBOX-538</key>
            <summary>CryptographyException on Adobe Distiller generated file</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="lucclaes">Luc Claes</reporter>
                        <labels>
                    </labels>
                <created>Fri, 9 Oct 2009 15:07:03 +0000</created>
                <updated>Thu, 17 Mar 2016 19:06:42 +0000</updated>
                            <resolved>Mon, 4 Aug 2014 19:24:18 +0000</resolved>
                                    <version>0.8.0-incubator</version>
                                    <fixVersion>2.0.0</fixVersion>
                                    <component>Parsing</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="12764332" author="lehmi" created="Sat, 10 Oct 2009 11:21:24 +0000"  >&lt;p&gt;IMO it is possible to replace the exception with a log entry. Is it possible to provide us with a sample file?&lt;/p&gt;</comment>
                            <comment id="12765512" author="lucclaes" created="Wed, 14 Oct 2009 11:04:44 +0000"  >&lt;p&gt;There seems to be a confusion between the &apos;version&apos; and &apos;revison&apos; encryption dictionnary entries.&lt;/p&gt;

&lt;p&gt;The PDF spec says:&lt;br/&gt;
(7.6.1) For version 1: Encryption of data using the RC4 or AES algorithms&quot; in 7.6.2, &quot;General Encryption Algorithm,&quot; with an encryption key length of 40 bits; see below.&lt;br/&gt;
...&lt;br/&gt;
Length integer (Optional; PDF 1.4; only if V is 2 or 3) The length of the encryption key, in bits. The value shall be a multiple of 8, in the range 40 to 128. Default value: 40.&lt;br/&gt;
...&lt;/p&gt;

&lt;p&gt;Note that length is optional and meaningful only if v &amp;gt; 1. If v is 1, the length is always of 40 bits.&lt;/p&gt;

&lt;p&gt;A working patch of StandardSecurityHandler.java consists of&lt;br/&gt;
1) replacing in decryptDocument()&lt;br/&gt;
        int dicLength = dictionary.getLength()/8;&lt;br/&gt;
by&lt;br/&gt;
        int dicLength = (dictionary.getVersion() == 1) ? 5 : (dictionary.getLength()/8);&lt;/p&gt;

&lt;p&gt;2) deleting the two erroneous tests in getUserPassword() and computeEncryptedKey():&lt;br/&gt;
            if( (encRevision == 2) &amp;amp;&amp;amp; (length != 5) )&lt;/p&gt;
            {
              throw new CryptographyException(
                  &quot;Error: Expected length=5 actual=&quot; + length );
            }
&lt;p&gt;(the revision was evaluated instead of the version, and the test is now useless)&lt;/p&gt;

&lt;p&gt;Unfortunately, I&apos;m unable to provide you &apos;publicly&apos; with such a document.&lt;/p&gt;</comment>
                            <comment id="12765917" author="lehmi" created="Thu, 15 Oct 2009 05:49:13 +0000"  >&lt;p&gt;Thanks for the detailed explanation. Obviously there is another possible value of V=4  since pdf 1.5 in the pdf-reference v1.7. IMO we have to take that value also into amount to be 1.5 compliant. If we really support that value or just throw an exception or log an error/warning that&apos;s another story.&lt;/p&gt;</comment>
                            <comment id="14085151" author="jahewson" created="Mon, 4 Aug 2014 19:24:18 +0000"  >&lt;p&gt;I applied Luc&apos;s patch to the trunk.&lt;/p&gt;</comment>
                            <comment id="14085153" author="jira-bot" created="Mon, 4 Aug 2014 19:24:59 +0000"  >&lt;p&gt;Commit 1615733 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jahewson&quot; class=&quot;user-hover&quot; rel=&quot;jahewson&quot;&gt;jahewson&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1615733&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1615733&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-538&quot; title=&quot;CryptographyException on Adobe Distiller generated file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-538&quot;&gt;&lt;del&gt;PDFBOX-538&lt;/del&gt;&lt;/a&gt;: Patch for CryptographyException on Adobe Distiller generated file, thanks to Luc Claes&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>85025</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 15 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i14v3b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>236502</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>