<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:08:05 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PDFBOX-4355] PDFTextStripperByArea dies on Chinese/Japanese files</title>
                <link>https://issues.apache.org/jira/browse/PDFBOX-4355</link>
                <project id="12310760" key="PDFBOX">PDFBox</project>
                    <description>&lt;p&gt;&lt;tt&gt;I&apos;m using PDFTextStripperByArea, this code makes it die:&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;stripper.extractRegions(page);&lt;/p&gt;

&lt;p&gt;Assuming, the language is Chinese or Japanese, that&apos;s the error:&lt;/p&gt;

&lt;p&gt;===========&lt;/p&gt;

&lt;p&gt;Oct 19, 2018 1:24:50 AM org.apache.pdfbox.pdmodel.font.PDFont getSpaceWidth&lt;br/&gt;
 SEVERE: Can&apos;t determine the width of the space character, assuming 250&lt;br/&gt;
 java.io.IOException: Unexpected end of stream&lt;br/&gt;
 at org.apache.pdfbox.pdmodel.font.PDType3CharProc.getWidth(PDType3CharProc.java:170)&lt;br/&gt;
 at org.apache.pdfbox.pdmodel.font.PDType3Font.getWidthFromFont(PDType3Font.java:165)&lt;br/&gt;
 at org.apache.pdfbox.pdmodel.font.PDFont.getSpaceWidth(PDFont.java:547)&lt;br/&gt;
 at org.apache.pdfbox.text.LegacyPDFStreamEngine.showGlyph(LegacyPDFStreamEngine.java:265)&lt;br/&gt;
 at org.apache.pdfbox.contentstream.PDFStreamEngine.showText(PDFStreamEngine.java:734)&lt;br/&gt;
 at org.apache.pdfbox.contentstream.PDFStreamEngine.showTextString(PDFStreamEngine.java:595)&lt;/p&gt;

&lt;p&gt;=========&lt;/p&gt;

&lt;p&gt;Should I use something else instead of&#160;PDFTextStripperByArea?&lt;/p&gt;

&lt;p&gt;Let me know if more information needed. I attached the PDF file.&lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12944634/12944634_output.pdf&quot; title=&quot;output.pdf attached to PDFBOX-4355&quot;&gt;output.pdf&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;sup&gt;====&lt;/sup&gt;&lt;/p&gt;

&lt;p&gt;&lt;b&gt;To reproduce use the attached&#160; above output.pdf and the standard PDFBox app:&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;&#160;java -jar pdfbox-app-2.0.12.jar ExtractText output.pdf&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13192710">PDFBOX-4355</key>
            <summary>PDFTextStripperByArea dies on Chinese/Japanese files</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tilman">Tilman Hausherr</assignee>
                                    <reporter username="iliakan">Ilya Kantor</reporter>
                        <labels>
                            <label>type3</label>
                    </labels>
                <created>Thu, 18 Oct 2018 22:34:19 +0000</created>
                <updated>Sun, 2 Dec 2018 17:06:04 +0000</updated>
                            <resolved>Fri, 19 Oct 2018 17:49:26 +0000</resolved>
                                    <version>2.0.12</version>
                                    <fixVersion>2.0.13</fixVersion>
                    <fixVersion>3.0.0 PDFBox</fixVersion>
                                    <component>PDModel</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="16656250" author="tilman" created="Fri, 19 Oct 2018 04:05:02 +0000"  >&lt;p&gt;Are you sure it &quot;died&quot;? I just attached the text extraction of page 1. There is an error in some type 3 fonts, a char proc is empty. An exception is thrown but caught internally and logged as error (&quot;Can&apos;t determine the width of the space character, assuming 250&quot;).&lt;/p&gt;</comment>
                            <comment id="16656306" author="iliakan" created="Fri, 19 Oct 2018 05:43:21 +0000"  >&lt;p&gt;The error is internal, right.&lt;/p&gt;

&lt;p&gt;Like this:&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;========&lt;/p&gt;

&lt;p&gt;Oct 19, 2018 8:41:09 AM org.apache.pdfbox.pdmodel.font.PDFont getSpaceWidth&lt;br/&gt;
SEVERE: Can&apos;t determine the width of the space character, assuming 250&lt;br/&gt;
java.io.IOException: Unexpected end of stream&lt;br/&gt;
 at org.apache.pdfbox.pdmodel.font.PDType3CharProc.getWidth(PDType3CharProc.java:170)&lt;br/&gt;
 at org.apache.pdfbox.pdmodel.font.PDType3Font.getWidthFromFont(PDType3Font.java:165)&lt;br/&gt;
 at org.apache.pdfbox.pdmodel.font.PDFont.getSpaceWidth(PDFont.java:547)&lt;br/&gt;
 at org.apache.pdfbox.text.LegacyPDFStreamEngine.showGlyph(LegacyPDFStreamEngine.java:265)&lt;br/&gt;
 at org.apache.pdfbox.contentstream.PDFStreamEngine.showText(PDFStreamEngine.java:734)&lt;br/&gt;
 at org.apache.pdfbox.contentstream.PDFStreamEngine.showTextString(PDFStreamEngine.java:595)&lt;br/&gt;
 at org.apache.pdfbox.contentstream.operator.text.ShowText.process(ShowText.java:55)&lt;br/&gt;
 at org.apache.pdfbox.contentstream.PDFStreamEngine.processOperator(PDFStreamEngine.java:848)&lt;br/&gt;
 at org.apache.pdfbox.contentstream.PDFStreamEngine.processStreamOperators(PDFStreamEngine.java:503)&lt;br/&gt;
 at org.apache.pdfbox.contentstream.PDFStreamEngine.processStream(PDFStreamEngine.java:477)&lt;br/&gt;
 at org.apache.pdfbox.contentstream.PDFStreamEngine.processPage(PDFStreamEngine.java:150)&lt;br/&gt;
 at org.apache.pdfbox.text.LegacyPDFStreamEngine.processPage(LegacyPDFStreamEngine.java:139)&lt;br/&gt;
 at org.apache.pdfbox.text.PDFTextStripper.processPage(PDFTextStripper.java:391)&lt;br/&gt;
 at org.apache.pdfbox.text.PDFTextStripperByArea.extractRegions(PDFTextStripperByArea.java:129)&lt;br/&gt;
 at LinkInfoExtractor.extractPage(LinkInfoExtractor.java:72)&lt;br/&gt;
 at PdfBookPolisher.run(PdfBookPolisher.java:102)&lt;br/&gt;
 at PdfBookPolisher.main(PdfBookPolisher.java:67)&lt;/p&gt;

&lt;p&gt;========&lt;/p&gt;

&lt;p&gt;So that&apos;s a font issue? What exactly is wrong with the font?&#160;&lt;/p&gt;</comment>
                            <comment id="16656311" author="iliakan" created="Fri, 19 Oct 2018 05:53:24 +0000"  >&lt;p&gt;Oh, that started to appear right after I upgraded an old project to 2.0.12 from 2.0.0-RC1 =)&lt;/p&gt;</comment>
                            <comment id="16656316" author="jira-bot" created="Fri, 19 Oct 2018 06:13:34 +0000"  >&lt;p&gt;Commit 1844303 from tilman@apache.org in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1844303&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1844303&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4355&quot; title=&quot;PDFTextStripperByArea dies on Chinese/Japanese files&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4355&quot;&gt;&lt;del&gt;PDFBOX-4355&lt;/del&gt;&lt;/a&gt;: treat empty type3 content streams as non existent&lt;/p&gt;</comment>
                            <comment id="16656317" author="jira-bot" created="Fri, 19 Oct 2018 06:13:38 +0000"  >&lt;p&gt;Commit 1844304 from tilman@apache.org in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1844304&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1844304&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4355&quot; title=&quot;PDFTextStripperByArea dies on Chinese/Japanese files&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4355&quot;&gt;&lt;del&gt;PDFBOX-4355&lt;/del&gt;&lt;/a&gt;: treat empty type3 content streams as non existent&lt;/p&gt;</comment>
                            <comment id="16656318" author="tilman" created="Fri, 19 Oct 2018 06:14:04 +0000"  >&lt;p&gt;Type 3 fonts are PDF content streams, one per glyph. Some glyphs have a completely empty content stream which is unexpected. It happens when the width of a space is gathered, which is needed for text extraction (to decide whether two glyphs are in different words if no space is used). The width is 0 from the width table so it tried to get it from the font content stream itself (where the first operator usually tells the width), which was empty.&lt;/p&gt;

&lt;p&gt;It is possible that the sequence in gathering the width was changed between versions.&lt;/p&gt;

&lt;p&gt;The real question is - does your code do what you expected it do do, or not? If it did, then don&apos;t panic. I just changed the code so that the exception + error no longer appear.&lt;/p&gt;
</comment>
                            <comment id="16656321" author="iliakan" created="Fri, 19 Oct 2018 06:15:31 +0000"  >&lt;p&gt;I have a custom font, the iconic font. Maybe it lacks character 32 (space). And that&apos;s perfectly normal from the technical standpoint.&lt;/p&gt;

&lt;p&gt;But I can add that character if required.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="16656322" author="iliakan" created="Fri, 19 Oct 2018 06:17:09 +0000"  >&lt;p&gt;Just not sure how PDFBox should behave in that particular case &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&#160;The icons (characters) from that font are used in the text.&lt;/p&gt;</comment>
                            <comment id="16656330" author="tilman" created="Fri, 19 Oct 2018 06:20:45 +0000"  >&lt;p&gt;The problem was that the charproc existed, but was empty. It would be more logical that it didn&apos;t exist at all. Or to have it with a specific width.&lt;/p&gt;</comment>
                            <comment id="16657193" author="tilman" created="Fri, 19 Oct 2018 17:48:13 +0000"  >&lt;p&gt;Snapshot available here:&lt;br/&gt;
&lt;a href=&quot;https://repository.apache.org/content/groups/snapshots/org/apache/pdfbox/pdfbox-app/2.0.13-SNAPSHOT/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://repository.apache.org/content/groups/snapshots/org/apache/pdfbox/pdfbox-app/2.0.13-SNAPSHOT/&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12944634" name="output.pdf" size="2916448" author="iliakan" created="Thu, 18 Oct 2018 22:34:18 +0000"/>
                            <attachment id="12944658" name="output.txt" size="1190" author="tilman" created="Fri, 19 Oct 2018 04:02:30 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 4 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3ze1j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>