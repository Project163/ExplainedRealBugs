<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 20:53:16 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PDFBOX-1001] TextPosition.getHeight() returns erroneous value for some PDFs</title>
                <link>https://issues.apache.org/jira/browse/PDFBOX-1001</link>
                <project id="12310760" key="PDFBOX">PDFBox</project>
                    <description>&lt;p&gt;For a PDF that worked fine under 1.2.1 the height value returned is negative and the wrong value (i.e. using Math.abs()  won&apos;t fix it).  Other PDFs work fine.&lt;br/&gt;
PDF Debug shows &quot;Creator:Crystal Reports&quot;  and &quot;Producer:PDF-XChange (XCPRO30.DLL v3.30.0064) (Windows 2k)&quot;&lt;br/&gt;
And when examining the &apos;Stream&apos; items, the text is not what displays.&lt;/p&gt;

&lt;p&gt;Any suggestions on what to look for so that I can do differential analysis against other PDFs to see what they do/not have in common with this one?&lt;br/&gt;
(It&apos;s client data so I can&apos;t post the PDF. )&lt;/p&gt;

&lt;p&gt;It&apos;s stopping us from moving off 1.2.1  (and later versions fix another issue we have of seeing question marks instead of the actual characters).&lt;/p&gt;</description>
                <environment>Solaris, WinXP</environment>
        <key id="12505068">PDFBOX-1001</key>
            <summary>TextPosition.getHeight() returns erroneous value for some PDFs</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="lehmi">Andreas Lehmk&#252;hler</assignee>
                                    <reporter username="algorithmics">Emil Wacker</reporter>
                        <labels>
                    </labels>
                <created>Sun, 24 Apr 2011 04:42:35 +0000</created>
                <updated>Tue, 29 May 2012 16:21:50 +0000</updated>
                            <resolved>Tue, 30 Aug 2011 17:29:35 +0000</resolved>
                                    <version>1.4.0</version>
                    <version>1.5.0</version>
                                    <fixVersion>1.7.0</fixVersion>
                                    <component>Text extraction</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="13025040" author="algorithmics" created="Tue, 26 Apr 2011 03:24:30 +0000"  >&lt;p&gt;I did some analysis on a set of PDFs and ruled out the following as the cause: creator/producer, Font subtype (e.g. Type1 vs TrueType), Font firstChar != 32.&lt;br/&gt;
Also not a factor is whether or not Debug shows readable text on the &quot;Tj&quot; lines in the stream items.&lt;/p&gt;</comment>
                            <comment id="13037256" author="algorithmics" created="Sat, 21 May 2011 03:22:36 +0000"  >&lt;p&gt;made this fix and now get the same reasonable values seen with 1.2.1 &lt;/p&gt;

&lt;p&gt;org.apache.pdfbox.util.PDFStreamEngine (from version 1.5.0)&lt;br/&gt;
line 492  (just prior to call to processTextPosition)&lt;/p&gt;

&lt;p&gt;old:&lt;br/&gt;
            float totalVerticalDisplacementDisp = maxVerticalDisplacementText * fontSizeText * textMatrix.getYScale();&lt;/p&gt;

&lt;p&gt;new:&lt;br/&gt;
            float totalVerticalDisplacementDisp = maxVerticalDisplacementText * fontSizeText * textXctm.getYScale(); &lt;/p&gt;
</comment>
                            <comment id="13055684" author="lehmi" created="Mon, 27 Jun 2011 17:52:52 +0000"  >&lt;p&gt;I can&apos;t reproduce the issue. Can you provide us with a sample pdf?&lt;/p&gt;</comment>
                            <comment id="13056196" author="algorithmics" created="Mon, 27 Jun 2011 23:26:48 +0000"  >&lt;p&gt;As mentioned in the initial description, it&apos;s client proprietary data, so can&apos;t be posted. If you need any other information about the file I&apos;ll try to oblige. &lt;br/&gt;
I was unable to isolate a specific thing that made that PDF have the issue when others did not. &lt;/p&gt;

&lt;p&gt;I would like to hear your opinion/analysis of my fix.&lt;/p&gt;</comment>
                            <comment id="13059335" author="lehmi" created="Mon, 4 Jul 2011 06:47:37 +0000"  >&lt;p&gt;Sorry, I missed the comment about the privacy of the pdf in question.&lt;/p&gt;

&lt;p&gt;I guess the main problem is, that in most cases the vertical displacement is not the same as the font height. These values are just mixed up. We have to add a separate value for the height, which should take the font height (from the font itself) and the different scaling factors into account.&lt;/p&gt;</comment>
                            <comment id="13085623" author="bpreindl" created="Tue, 16 Aug 2011 10:18:29 +0000"  >&lt;p&gt;Andreas Lehmk&#252;hler asked me to upload an example PDF for the bug described. You find it attached.&lt;/p&gt;</comment>
                            <comment id="13093923" author="lehmi" created="Tue, 30 Aug 2011 17:29:35 +0000"  >&lt;p&gt;I fixed the calculation in revision 1163297 as proposed by Emil.&lt;/p&gt;

&lt;p&gt;Thanks for the patch and the example!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12490517" name="dreher.pdf" size="399011" author="bpreindl" created="Tue, 16 Aug 2011 10:18:29 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>63098</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 12 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0zhqn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>205176</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>