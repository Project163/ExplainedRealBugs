<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 20:53:31 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PDFBOX-611] PDSimpleFont.  Font height reported as zero.</title>
                <link>https://issues.apache.org/jira/browse/PDFBOX-611</link>
                <project id="12310760" key="PDFBOX">PDFBox</project>
                    <description>&lt;p&gt;The logic for PDSimpleFont.getFontHeight() can return a value of zero.   &lt;br/&gt;
This will corrupt or compromise text extraction and layout.&lt;br/&gt;
In particular, test with &apos;http://www.encana.com/investor/financial/shareholder/pdfs/info-circular-french.pdf&apos;, pg 12 &lt;/p&gt;

&lt;p&gt;When a PDFontDescriptor is used, the current logic uses:&lt;br/&gt;
   1) an average of xHeight and capHeight.   &lt;br/&gt;
             xHeight is the height from the baseline to the top of a lower case letter like &apos;x&apos;.&lt;br/&gt;
             CapHeight is the height from the baseline to the top of an upper case latin char.&lt;br/&gt;
   2) xHeight&lt;br/&gt;
   3) capHeight&lt;br/&gt;
   4) ascent&lt;br/&gt;
   5) zero&lt;/p&gt;

&lt;p&gt;This is really bizarre.  &apos;xHeight&apos; is an optional parameter, and &apos;capHeight&apos; is often missing.&lt;/p&gt;

&lt;p&gt;The font bounding box is a required parameter and is the height that is used by Acrobat Reader when you select a line of text.&lt;br/&gt;
The bounding box is not perfect, because it often overlaps the line above, but it is a consistent value.  The problem with the&lt;br/&gt;
current logic is that the reported height varies way too much, and a zero value can be reported.&lt;/p&gt;

&lt;p&gt;I have modified the logic as follows. The goal was to make the nominal values the same as the current logic,&lt;br/&gt;
but return a very similar number when parameters go missing.&lt;/p&gt;

&lt;p&gt;         PDFontDescriptor desc = getFontDescriptor();&lt;br/&gt;
          if( desc != null )  {&lt;br/&gt;
           	float height = desc.getCapHeight();				// Top of Cap to baseline (eg 715)&lt;br/&gt;
            	if (height==0) {&lt;br/&gt;
            		height=desc.getAscent();					// Max height from baseline (eg 715);&lt;br/&gt;
            	   	if (height==0) {&lt;br/&gt;
            	   		PDRectangle bbox = desc.getFontBoundingBox();&lt;br/&gt;
            	   		height = bbox.getHeight()/2;			// Max height less max depth (eg (1006-(-325))=1331/2=665)&lt;br/&gt;
            	   		if (height==0) &lt;/p&gt;
{
            	   			height=desc.getXHeight();			// Top of lower-case to baseline (eg 518)
            	   			height-=desc.getDescent();		// Depth below baseline (eg 209, to get total of 727)
            	   		}
&lt;p&gt;            	   	}&lt;br/&gt;
            	}&lt;br/&gt;
                retval=height;&lt;br/&gt;
          }&lt;/p&gt;</description>
                <environment>Win and Linux</environment>
        <key id="12455565">PDFBOX-611</key>
            <summary>PDSimpleFont.  Font height reported as zero.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="lehmi">Andreas Lehmk&#252;hler</assignee>
                                    <reporter username="petercostello">Peter Costello</reporter>
                        <labels>
                            <label>PDSimpleFont</label>
                            <label>textExtraction</label>
                    </labels>
                <created>Sun, 7 Feb 2010 06:23:46 +0000</created>
                <updated>Tue, 29 May 2012 16:21:49 +0000</updated>
                            <resolved>Wed, 8 Feb 2012 19:00:13 +0000</resolved>
                                    <version>0.8.0-incubator</version>
                                    <fixVersion>1.7.0</fixVersion>
                                    <component>PDModel</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                    <workratio workratioPercent="0"/>
                                    <progress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                    <timeoriginalestimate seconds="3600">1h</timeoriginalestimate>
                            <timeestimate seconds="3600">1h</timeestimate>
                                        <comments>
                            <comment id="13203848" author="lehmi" created="Wed, 8 Feb 2012 19:00:13 +0000"  >&lt;p&gt;I improved the height calculation in revisiomn 1242038 based on Peters proposal.&lt;/p&gt;

&lt;p&gt;Thanks for the contribution!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>84945</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 41 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0zix3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>205367</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>