<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 20:54:13 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PDFBOX-833] Wrong encoding with Type1C font when specific encoding is defined</title>
                <link>https://issues.apache.org/jira/browse/PDFBOX-833</link>
                <project id="12310760" key="PDFBOX">PDFBox</project>
                    <description>&lt;p&gt;The Type1C font implementation overwrites the encoding() method of PDFont base class. This results in a lookup of codes to characters as defined in the font.&lt;br/&gt;
However if an encoding is explicitly given (like WinAnsiEncoding) this leads to wrong results if encoding codes do not match glyph codes.&lt;br/&gt;
In a test document (which unfortunately I cannot make public - an article from Elsevier) a Type1C font is embedded which defines a copyright sign at glyph position 259. The encoding is defines as WinAnsiEncoding. Text characters are defined corresponding to the WinAnsiEncoding. In case of the copyright sign it is 0xa9 (169) where the font has glyph &apos;quotesingle&apos; defined.&lt;br/&gt;
Since currently I have no other test cases I implemented following workaround for WinAnsiEncoding (which might be relaxed to other PDF encodings as well:&lt;br/&gt;
in PDType1CFont.encode() I start with:&lt;/p&gt;

&lt;p&gt;if ( getEncoding() instanceof WinAnsiEncoding )&lt;br/&gt;
  // use PDFont encoding&lt;br/&gt;
  return super.encode( bytes, offset, length );&lt;/p&gt;

&lt;p&gt;This resolves the encoding problems for text extraction.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12474591">PDFBOX-833</key>
            <summary>Wrong encoding with Type1C font when specific encoding is defined</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="lehmi">Andreas Lehmk&#252;hler</assignee>
                                    <reporter username="tboehme">Timo Boehme</reporter>
                        <labels>
                    </labels>
                <created>Mon, 20 Sep 2010 13:39:26 +0000</created>
                <updated>Thu, 17 Mar 2016 19:08:25 +0000</updated>
                            <resolved>Sun, 11 Aug 2013 15:24:10 +0000</resolved>
                                    <version>1.3.1</version>
                                    <fixVersion>2.0.0</fixVersion>
                                    <component>Parsing</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="13631408" author="lmpmbernardo" created="Sun, 14 Apr 2013 22:20:02 +0000"  >&lt;p&gt;I think I may have bumped into this bug and other related ones (wrong mapping of character codes to glyphs with Type1C fonts). I investigated and came up with a fix which I am attaching. The issue was complicated by apparently some bug in Sun JDK&apos;s native code (used by StandardGlyphVector) that resulted in character codes being mapped to the missing glyph. To get around this apparent bug the patch includes a workaround to do the mapping directly (this requires the use of reflection). In OpenJDK, which uses Freetype for the native code, this particular bug does not happen, but there is other issue that this patch also addresses (Freetype expects uppercase hexadecimal names).&lt;/p&gt;

&lt;p&gt;I am attaching also part of the sample document that I used to investigate this, together with image outputs before and after the patch is applied that show what the issue is. &lt;/p&gt;</comment>
                            <comment id="13634358" author="lehmi" created="Wed, 17 Apr 2013 19:49:02 +0000"  >&lt;p&gt;I added the patch in revision 1469046 as proposed with some slight modifications (removed unused code, reformatting).&lt;/p&gt;

&lt;p&gt;Thanks for the contribution!&lt;/p&gt;</comment>
                            <comment id="13659603" author="ssteiner1" created="Thu, 16 May 2013 14:51:48 +0000"  >&lt;p&gt;After this change the ExtractText class doesnt work for type1c fonts.&lt;/p&gt;</comment>
                            <comment id="13659673" author="lehmi" created="Thu, 16 May 2013 16:21:29 +0000"  >&lt;p&gt;Can you provide us with a sample pdf?&lt;/p&gt;</comment>
                            <comment id="13660458" author="ssteiner1" created="Fri, 17 May 2013 08:03:26 +0000"  >&lt;p&gt;java -jar app/target/pdfbox-app-2.0.0-SNAPSHOT.jar ExtractText simpleh2.pdf&lt;/p&gt;

&lt;p&gt;mapchar doesnt return actual char&lt;/p&gt;</comment>
                            <comment id="13661336" author="lehmi" created="Sat, 18 May 2013 11:07:30 +0000"  >&lt;p&gt;I can confirm that the fix introduced a regression with the text extraction as described by simon -&amp;gt; reopened&lt;/p&gt;</comment>
                            <comment id="13736308" author="lehmi" created="Sun, 11 Aug 2013 15:24:10 +0000"  >&lt;p&gt;Works fine after solving &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-1608&quot; title=&quot;Rendering problem with Java 7 update 21&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-1608&quot;&gt;&lt;del&gt;PDFBOX-1608&lt;/del&gt;&lt;/a&gt;. The attached workaround is no longer needed.&lt;/p&gt;

&lt;p&gt;Nevertheless thanks for the contribution!&lt;/p&gt;</comment>
                            <comment id="13736377" author="lmpmbernardo" created="Sun, 11 Aug 2013 18:48:58 +0000"  >&lt;p&gt;Great work! The workaround was to bypass a bug in the Sun JDK, which got even worse when the FontScaler was changed to T2KFontScaler (which happened between 1.6_30 and 1.6_45). Things got even worse in Sun JDK 1.7. In OpenJDK, which uses FreetypeFontScaler, things were better, but not perfect either (the font size comes out wrong, probably due to wrong scaling). So, not relying on JDK to render Type1/CFF fonts is a very welcomed change!&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12630571">PDFBOX-1506</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12578650" name="pdfbox-833.patch" size="11046" author="lmpmbernardo" created="Sun, 14 Apr 2013 22:21:26 +0000"/>
                            <attachment id="12578651" name="sample.pdf" size="320628" author="lmpmbernardo" created="Sun, 14 Apr 2013 22:21:26 +0000"/>
                            <attachment id="12578653" name="sample1-fixed.png" size="166087" author="lmpmbernardo" created="Sun, 14 Apr 2013 22:21:26 +0000"/>
                            <attachment id="12578652" name="sample1-original.png" size="160840" author="lmpmbernardo" created="Sun, 14 Apr 2013 22:21:26 +0000"/>
                            <attachment id="12583625" name="simpleh2.pdf" size="12433" author="ssteiner" created="Fri, 17 May 2013 08:03:26 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>85051</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 14 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i14uo7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>236434</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>