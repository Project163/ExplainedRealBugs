<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:05:14 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PDFBOX-3663] NullPointerException when signing a PDF with AcroForm and no fields</title>
                <link>https://issues.apache.org/jira/browse/PDFBOX-3663</link>
                <project id="12310760" key="PDFBOX">PDFBox</project>
                    <description>&lt;p&gt;This is related to &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-1719&quot; title=&quot;NPE while signing PDF - acroform without fields&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-1719&quot;&gt;&lt;del&gt;PDFBOX-1719&lt;/del&gt;&lt;/a&gt;. The workaround made there calls PDAcroForm.setFields with an empty list when the acro form has no fields:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-style: solid;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;border-bottom-style: solid;&quot;&gt;&lt;b&gt;PDDocument.java (Line 286)&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;List&amp;lt;PDField&amp;gt; fields = acroForm.getFields();
&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (fields == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;)
{
    fields = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ArrayList&amp;lt;PDField&amp;gt;();
    acroForm.setFields(fields);
}
&lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt;
{
    COSArray fieldArray = (COSArray) acroForm.getCOSObject().getDictionaryObject(COSName.FIELDS);
    fieldArray.setNeedToBeUpdated(&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;);
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;This doesn&apos;t work anymore because PDAcroFrom.getFields never returns null in the current version, instead it returns an empty list and a NPE raises in line 295.&lt;/p&gt;

&lt;p&gt;The source of the problem seems to be that the PDAcroForm&apos;s dictionary&apos;s COSName.FIELDS field contains null instead of an empty array. An empty array is implicitly created when calling PDAcroForm.setFields with an empty list. The PDAcroForm(PDDocument) constructor also sets an empty COSArray for the field. You could also do this in the second constrcutor, that would fix the error:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-style: solid;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;border-bottom-style: solid;&quot;&gt;&lt;b&gt;PDAcroForm.java&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; PDAcroForm(PDDocument doc, COSDictionary form)
{
    document = doc;
    dictionary = form;
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (dictionary.getItem(COSName.FIELDS) == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;)
    {
      dictionary.setItem(COSName.FIELDS, &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; COSArray());
    }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13038127">PDFBOX-3663</key>
            <summary>NullPointerException when signing a PDF with AcroForm and no fields</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tilman">Tilman Hausherr</assignee>
                                    <reporter username="morgov">Moritz Orth</reporter>
                        <labels>
                    </labels>
                <created>Thu, 26 Jan 2017 13:58:24 +0000</created>
                <updated>Sat, 25 Mar 2017 18:12:44 +0000</updated>
                            <resolved>Mon, 30 Jan 2017 08:36:10 +0000</resolved>
                                    <version>2.0.4</version>
                    <version>3.0.0 PDFBox</version>
                                    <fixVersion>2.0.5</fixVersion>
                    <fixVersion>3.0.0 PDFBox</fixVersion>
                                    <component>AcroForm</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="15839901" author="jira-bot" created="Thu, 26 Jan 2017 15:54:21 +0000"  >&lt;p&gt;Commit 1780412 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1780412&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1780412&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3663&quot; title=&quot;NullPointerException when signing a PDF with AcroForm and no fields&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3663&quot;&gt;&lt;del&gt;PDFBOX-3663&lt;/del&gt;&lt;/a&gt;: avoid NPE if /AcroForm exists without /Fields&lt;/p&gt;</comment>
                            <comment id="15839902" author="jira-bot" created="Thu, 26 Jan 2017 15:54:26 +0000"  >&lt;p&gt;Commit 1780413 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1780413&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1780413&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3663&quot; title=&quot;NullPointerException when signing a PDF with AcroForm and no fields&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3663&quot;&gt;&lt;del&gt;PDFBOX-3663&lt;/del&gt;&lt;/a&gt;: avoid NPE if /AcroForm exists without /Fields&lt;/p&gt;</comment>
                            <comment id="15839913" author="jira-bot" created="Thu, 26 Jan 2017 16:01:32 +0000"  >&lt;p&gt;Commit 1780415 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1780415&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1780415&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3663&quot; title=&quot;NullPointerException when signing a PDF with AcroForm and no fields&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3663&quot;&gt;&lt;del&gt;PDFBOX-3663&lt;/del&gt;&lt;/a&gt;: clarify javadoc&lt;/p&gt;</comment>
                            <comment id="15839914" author="jira-bot" created="Thu, 26 Jan 2017 16:01:38 +0000"  >&lt;p&gt;Commit 1780416 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1780416&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1780416&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3663&quot; title=&quot;NullPointerException when signing a PDF with AcroForm and no fields&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3663&quot;&gt;&lt;del&gt;PDFBOX-3663&lt;/del&gt;&lt;/a&gt;: clarify javadoc&lt;/p&gt;</comment>
                            <comment id="15839916" author="tilman" created="Thu, 26 Jan 2017 16:04:52 +0000"  >&lt;p&gt;Please test the change and give feedback. I didn&apos;t use your solution (that would have worked too) because we try to avoid that the structure gets changed just by looking at things.&lt;/p&gt;</comment>
                            <comment id="15844928" author="morgov" created="Mon, 30 Jan 2017 08:24:55 +0000"  >&lt;p&gt;Works fine now, thanks!&lt;/p&gt;</comment>
                            <comment id="15844935" author="tilman" created="Mon, 30 Jan 2017 08:36:10 +0000"  >&lt;p&gt;Thanks!&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12668748">PDFBOX-1719</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 41 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i398uf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>