<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:10:19 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PDFBOX-4850] Image rendering issue</title>
                <link>https://issues.apache.org/jira/browse/PDFBOX-4850</link>
                <project id="12310760" key="PDFBOX">PDFBox</project>
                    <description>&lt;p&gt;Rendering file using PDFToImage creates a strange result where embedded images aren&apos;t rotated or scaled correctly.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Rendering the same PDF using poppler will create a correct looking output.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13308266">PDFBOX-4850</key>
            <summary>Image rendering issue</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tilman">Tilman Hausherr</assignee>
                                    <reporter username="kalaspuffar">Daniel Persson</reporter>
                        <labels>
                    </labels>
                <created>Fri, 29 May 2020 08:09:08 +0000</created>
                <updated>Fri, 21 Aug 2020 04:54:17 +0000</updated>
                            <resolved>Tue, 9 Jun 2020 18:21:55 +0000</resolved>
                                    <version>2.0.19</version>
                                    <fixVersion>2.0.21</fixVersion>
                    <fixVersion>3.0.0 PDFBox</fixVersion>
                                    <component>Rendering</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="17119840" author="tilman" created="Fri, 29 May 2020 18:29:12 +0000"  >&lt;p&gt;I wonder if this is somehow related to &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-1958&quot; title=&quot;image mask outline with shading pattern is invisible&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-1958&quot;&gt;&lt;del&gt;PDFBOX-1958&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="17129658" author="janipe" created="Tue, 9 Jun 2020 17:33:50 +0000"  >&lt;p&gt;Replace method drawBufferedImage() in class org.apache.pdfbox.rendering.PageDrawer with this:&lt;/p&gt;


&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; void drawBufferedImage(BufferedImage image, AffineTransform at) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException
    {
        graphics.setComposite(getGraphicsState().getNonStrokingJavaComposite());
        setClip();
        AffineTransform imageTransform = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; AffineTransform(at);
        &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; width = image.getWidth();
        &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; height = image.getHeight();
        imageTransform.scale(1.0 / width, -1.0 / height);
        imageTransform.translate(0, -height);

        PDSoftMask softMask = getGraphicsState().getSoftMask();
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt;( softMask != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; )
        {
            Rectangle2D rectangle = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Rectangle2D.&lt;span class=&quot;code-object&quot;&gt;Float&lt;/span&gt;(0, 0, width, height);
            Paint awtPaint = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; TexturePaint(image, rectangle);
            awtPaint = applySoftMaskToPaint(awtPaint, softMask);
            graphics.setPaint(awtPaint);

            AffineTransform originalTransform = graphics.getTransform();
            graphics.transform(imageTransform);
            graphics.fill(rectangle);
            graphics.setTransform(originalTransform);
        }
        &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt;
        {
            COSBase transfer = getGraphicsState().getTransfer();
            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (transfer &lt;span class=&quot;code-keyword&quot;&gt;instanceof&lt;/span&gt; COSArray || transfer &lt;span class=&quot;code-keyword&quot;&gt;instanceof&lt;/span&gt; COSDictionary)
            {
                image = applyTransferFunction(image, transfer);
            }

            &lt;span class=&quot;code-comment&quot;&gt;// PDFBOX-4516, PDFBOX-4527, PDFBOX-4815:
&lt;/span&gt;            &lt;span class=&quot;code-comment&quot;&gt;// graphics.drawImage() has terrible quality when scaling down, even when
&lt;/span&gt;            &lt;span class=&quot;code-comment&quot;&gt;// RenderingHints.VALUE_INTERPOLATION_BICUBIC, VALUE_ALPHA_INTERPOLATION_QUALITY,
&lt;/span&gt;            &lt;span class=&quot;code-comment&quot;&gt;// VALUE_COLOR_RENDER_QUALITY and VALUE_RENDER_QUALITY are all set.
&lt;/span&gt;            &lt;span class=&quot;code-comment&quot;&gt;// A workaround is to get a pre-scaled image with Image.getScaledInstance()
&lt;/span&gt;            &lt;span class=&quot;code-comment&quot;&gt;// and then draw that one. To reduce differences in testing
&lt;/span&gt;            &lt;span class=&quot;code-comment&quot;&gt;// (partly because the method needs integer parameters), only smaller scalings
&lt;/span&gt;            &lt;span class=&quot;code-comment&quot;&gt;// will trigger the workaround. Because of the slowness we only &lt;span class=&quot;code-keyword&quot;&gt;do&lt;/span&gt; it &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; the user
&lt;/span&gt;            &lt;span class=&quot;code-comment&quot;&gt;// expects quality rendering and interpolation.
&lt;/span&gt;            Matrix m = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Matrix(imageTransform);
            &lt;span class=&quot;code-object&quot;&gt;float&lt;/span&gt; scaleX = &lt;span class=&quot;code-object&quot;&gt;Math&lt;/span&gt;.abs(m.getScalingFactorX());
            &lt;span class=&quot;code-object&quot;&gt;float&lt;/span&gt; scaleY = &lt;span class=&quot;code-object&quot;&gt;Math&lt;/span&gt;.abs(m.getScalingFactorY());
            Image imageToDraw = image;

            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; ((scaleX &amp;lt; 0.25f || scaleY &amp;lt; 0.25f) &amp;amp;&amp;amp;
                RenderingHints.VALUE_RENDER_QUALITY.equals(graphics.getRenderingHint(RenderingHints.KEY_RENDERING)) &amp;amp;&amp;amp;
                RenderingHints.VALUE_INTERPOLATION_BICUBIC.equals(graphics.getRenderingHint(RenderingHints.KEY_INTERPOLATION)))
            {
                &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; w = &lt;span class=&quot;code-object&quot;&gt;Math&lt;/span&gt;.round(image.getWidth() * scaleX);
                &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; h = &lt;span class=&quot;code-object&quot;&gt;Math&lt;/span&gt;.round(image.getHeight() * scaleY);
                &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (w &amp;lt; 1)
                {
                    w = 1;
                }
                &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (h &amp;lt; 1)
                {
                    h = 1;
                }
                imageToDraw = image.getScaledInstance(
                        w,
                        h,
                        Image.SCALE_SMOOTH);
                imageTransform.scale(1 / scaleX, 1 / scaleY); &lt;span class=&quot;code-comment&quot;&gt;// remove the scale
&lt;/span&gt;            }
            graphics.drawImage(imageToDraw, imageTransform, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;);
        }
    }

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I have applied imageTransform to the Graphics2D object. This way imageTransform rotates and scales the image and the anchor rectangle of the TexturePaint. Now also the dimensions of the anchor rectangle are simply width and height.&lt;br/&gt;
This fixes also issue &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4798&quot; title=&quot;Wrong position of rendered image&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4798&quot;&gt;&lt;del&gt;PDFBOX-4798&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="17129670" author="tilman" created="Tue, 9 Jun 2020 18:04:14 +0000"  >&lt;p&gt;Wow thanks!!&lt;/p&gt;

&lt;p&gt;Improved:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;eci_altona-test-suite-v2_technical2_one-patch-per-page_x4.pdf&lt;/li&gt;
	&lt;li&gt;gs-bugzilla696026.pdf&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4492&quot; title=&quot;JVM crashes on PDFRenderer.renderImage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4492&quot;&gt;&lt;del&gt;PDFBOX-4492&lt;/del&gt;&lt;/a&gt;-jvm-crash-14dpi.pdf&lt;/li&gt;
	&lt;li&gt;PDFJS-6924.pdf&lt;/li&gt;
	&lt;li&gt;PDFJS-6967.pdf&lt;/li&gt;
	&lt;li&gt;PDFJS-8136-p1.pdf&lt;/li&gt;
	&lt;li&gt;PDFJS-8179.pdf&lt;/li&gt;
	&lt;li&gt;gs-bugzilla691157.pdf&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="17129678" author="jira-bot" created="Tue, 9 Jun 2020 18:16:34 +0000"  >&lt;p&gt;Commit 1878670 from Tilman Hausherr in branch &apos;pdfbox/branches/issue45&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1878670&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1878670&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4850&quot; title=&quot;Image rendering issue&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4850&quot;&gt;&lt;del&gt;PDFBOX-4850&lt;/del&gt;&lt;/a&gt;: apply imageTransform to the Graphics2D object, by Jani Pehkonen&lt;/p&gt;</comment>
                            <comment id="17129679" author="jira-bot" created="Tue, 9 Jun 2020 18:16:38 +0000"  >&lt;p&gt;Commit 1878671 from Tilman Hausherr in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1878671&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1878671&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4850&quot; title=&quot;Image rendering issue&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4850&quot;&gt;&lt;del&gt;PDFBOX-4850&lt;/del&gt;&lt;/a&gt;: apply imageTransform to the Graphics2D object, by Jani Pehkonen&lt;/p&gt;</comment>
                            <comment id="17129681" author="jira-bot" created="Tue, 9 Jun 2020 18:16:43 +0000"  >&lt;p&gt;Commit 1878672 from Tilman Hausherr in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1878672&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1878672&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4850&quot; title=&quot;Image rendering issue&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4850&quot;&gt;&lt;del&gt;PDFBOX-4850&lt;/del&gt;&lt;/a&gt;: apply imageTransform to the Graphics2D object, by Jani Pehkonen&lt;/p&gt;</comment>
                            <comment id="17129683" author="tilman" created="Tue, 9 Jun 2020 18:21:55 +0000"  >&lt;p&gt;Thanks again!&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="13292132">PDFBOX-4798</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="13004315" name="issue-pdfbox.jpg" size="540952" author="kalaspuffar" created="Fri, 29 May 2020 08:09:20 +0000"/>
                            <attachment id="13004314" name="issue-poppler.jpg" size="411977" author="kalaspuffar" created="Fri, 29 May 2020 08:09:20 +0000"/>
                            <attachment id="13004316" name="issue.pdf" size="1493036" author="kalaspuffar" created="Fri, 29 May 2020 08:09:20 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 22 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0fb2w:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>