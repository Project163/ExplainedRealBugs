<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 20:52:32 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PDFBOX-874] OutOfMemoryError in text extraction tests</title>
                <link>https://issues.apache.org/jira/browse/PDFBOX-874</link>
                <project id="12310760" key="PDFBOX">PDFBox</project>
                    <description>&lt;p&gt;As reported on dev@:&lt;/p&gt;

&lt;p&gt;TestTextStripper failed:&lt;br/&gt;
testExtract(org.apache.pdfbox.util.TestTextStripper)  Time elapsed:&lt;br/&gt;
7.32 sec  &amp;lt;&amp;lt;&amp;lt; ERROR!&lt;br/&gt;
java.lang.OutOfMemoryError: Java heap space&lt;br/&gt;
       at com.ibm.icu.impl.UCharacterNameReader.read(UCharacterNameReader.java:90)&lt;/p&gt;

&lt;p&gt;I can reproduce it by adding a &amp;lt;argLine&amp;gt;-Xmx128m&amp;lt;/argLine&amp;gt; option to the surefire plugin configuration in pdfbox/pom.xml. The same problem doesn&apos;t occur with 1.2.1.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12477837">PDFBOX-874</key>
            <summary>OutOfMemoryError in text extraction tests</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jukkaz">Jukka Zitting</assignee>
                                    <reporter username="jukkaz">Jukka Zitting</reporter>
                        <labels>
                    </labels>
                <created>Wed, 20 Oct 2010 09:13:36 +0000</created>
                <updated>Tue, 26 Oct 2010 09:34:41 +0000</updated>
                            <resolved>Wed, 20 Oct 2010 13:48:39 +0000</resolved>
                                    <version>1.3.1</version>
                                    <fixVersion>1.3.1</fixVersion>
                                    <component>FontBox</component>
                    <component>Text extraction</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12922897" author="jukkaz" created="Wed, 20 Oct 2010 09:52:11 +0000"  >&lt;p&gt;A good way to debug this is to set &amp;lt;argLine&amp;gt;-Xmx128m -XX:+HeapDumpOnOutOfMemoryError&amp;lt;/argLine&amp;gt;.&lt;/p&gt;

&lt;p&gt;I ran the tests with such a setting, and the resulting heap dump shows font and cmap objects taking up lots of memory.&lt;/p&gt;</comment>
                            <comment id="12922899" author="jukkaz" created="Wed, 20 Oct 2010 10:05:06 +0000"  >&lt;p&gt;It looks like the problem originates in &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-11&quot; title=&quot;CID to Unicode mapping&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-11&quot;&gt;&lt;del&gt;PDFBOX-11&lt;/del&gt;&lt;/a&gt;. Many CID mappings are expressed as ranges, which the code explodes into individual Integer-&amp;gt;String pairs. This causes pretty big data structures as many of our CMaps cover 65k possible mappings! We should use a more efficient in-memory representation for such range mappings.&lt;/p&gt;</comment>
                            <comment id="12922963" author="jukkaz" created="Wed, 20 Oct 2010 13:48:39 +0000"  >&lt;p&gt;Fixed in revision 1025568 by introducing a more more-efficient way of storing CID ranges in CMaps. The implementation could still be improved, but already this change drops the memory use of the PDFBox test suite from &amp;gt;128MB to &amp;lt;24MB.&lt;/p&gt;

&lt;p&gt;I also explicitly set the memory limit of the test suite to -Xmx64m to better catch similar problems in the future, while still giving plenty of extra space to avoid unnecessary test failures due to differences between JVMs.&lt;/p&gt;</comment>
                            <comment id="12922965" author="jukkaz" created="Wed, 20 Oct 2010 13:58:09 +0000"  >&lt;p&gt;Merged to the 1.3 branch in revision 1025584.&lt;/p&gt;</comment>
                            <comment id="12922975" author="jeremias@apache.org" created="Wed, 20 Oct 2010 14:16:46 +0000"  >&lt;p&gt;Hmm, I&apos;m still seeing the problem in trunk. When I increase to -Xmx96M, the OutOfMemoryError goes away. I think it could the allah2.pdf that contains 10 or 11 subset fonts. The heap dump seems to indicate that each of those fonts takes up about 3MB of memory. All in all that could be filling to the 64MB.&lt;/p&gt;

&lt;p&gt;TotalSize (TotalSize/HeapSize%) &lt;span class=&quot;error&quot;&gt;&amp;#91;ObjectSize&amp;#93;&lt;/span&gt; NumberOfChildObject(6&apos;105) ObjectName Address&lt;br/&gt;
 30&apos;210&apos;128 (83%) &lt;span class=&quot;error&quot;&gt;&amp;#91;16&amp;#93;&lt;/span&gt; 1 java/util/AbstractList$Itr 0x2e74848&lt;br/&gt;
  30&apos;210&apos;112 (83%) &lt;span class=&quot;error&quot;&gt;&amp;#91;12&amp;#93;&lt;/span&gt; 1 java/util/ArrayList 0x2f830b8&lt;br/&gt;
   30&apos;210&apos;100 (83%) &lt;span class=&quot;error&quot;&gt;&amp;#91;152&amp;#93;&lt;/span&gt; 32 [Ljava/lang/Object; 0x6884698&lt;br/&gt;
    3&apos;019&apos;039 (8%) &lt;span class=&quot;error&quot;&gt;&amp;#91;64&amp;#93;&lt;/span&gt; 4 org/apache/pdfbox/util/TextPosition 0x2e745f8&lt;br/&gt;
     3&apos;018&apos;913 (8%) &lt;span class=&quot;error&quot;&gt;&amp;#91;47&amp;#93;&lt;/span&gt; 6 org/apache/pdfbox/pdmodel/font/PDType0Font 0x370e5d0&lt;br/&gt;
     40 (0%) &lt;span class=&quot;error&quot;&gt;&amp;#91;4&amp;#93;&lt;/span&gt; 1 org/apache/pdfbox/util/Matrix 0x2e745b8&lt;br/&gt;
     18 (0%) &lt;span class=&quot;error&quot;&gt;&amp;#91;16&amp;#93;&lt;/span&gt; 1 java/lang/String 0x370d400&lt;br/&gt;
     4 (0%) &lt;span class=&quot;error&quot;&gt;&amp;#91;4&amp;#93;&lt;/span&gt; 0 float[] 0x2e74640&lt;br/&gt;
    3&apos;018&apos;791 (8%) &lt;span class=&quot;error&quot;&gt;&amp;#91;64&amp;#93;&lt;/span&gt; 4 org/apache/pdfbox/util/TextPosition 0x5ccf430&lt;br/&gt;
     3&apos;018&apos;665 (8%) &lt;span class=&quot;error&quot;&gt;&amp;#91;47&amp;#93;&lt;/span&gt; 6 org/apache/pdfbox/pdmodel/font/PDType0Font 0x370e598&lt;br/&gt;
     40 (0%) &lt;span class=&quot;error&quot;&gt;&amp;#91;4&amp;#93;&lt;/span&gt; 1 org/apache/pdfbox/util/Matrix 0x5d1a9f8&lt;br/&gt;
     18 (0%) &lt;span class=&quot;error&quot;&gt;&amp;#91;16&amp;#93;&lt;/span&gt; 1 java/lang/String 0x370d388&lt;br/&gt;
     4 (0%) &lt;span class=&quot;error&quot;&gt;&amp;#91;4&amp;#93;&lt;/span&gt; 0 float[] 0x5d1aa08&lt;br/&gt;
    3&apos;018&apos;541 (8%) &lt;span class=&quot;error&quot;&gt;&amp;#91;64&amp;#93;&lt;/span&gt; 4 org/apache/pdfbox/util/TextPosition 0x6884970&lt;br/&gt;
    3&apos;018&apos;527 (8%) &lt;span class=&quot;error&quot;&gt;&amp;#91;64&amp;#93;&lt;/span&gt; 4 org/apache/pdfbox/util/TextPosition 0x58405c8&lt;br/&gt;
    3&apos;018&apos;519 (8%) &lt;span class=&quot;error&quot;&gt;&amp;#91;64&amp;#93;&lt;/span&gt; 4 org/apache/pdfbox/util/TextPosition 0x52b8190&lt;br/&gt;
    3&apos;018&apos;511 (8%) &lt;span class=&quot;error&quot;&gt;&amp;#91;64&amp;#93;&lt;/span&gt; 4 org/apache/pdfbox/util/TextPosition 0x642e250&lt;br/&gt;
    3&apos;018&apos;497 (8%) &lt;span class=&quot;error&quot;&gt;&amp;#91;64&amp;#93;&lt;/span&gt; 4 org/apache/pdfbox/util/TextPosition 0x4d35188&lt;br/&gt;
    3&apos;018&apos;471 (8%) &lt;span class=&quot;error&quot;&gt;&amp;#91;64&amp;#93;&lt;/span&gt; 4 org/apache/pdfbox/util/TextPosition 0x6884780&lt;br/&gt;
    3&apos;018&apos;455 (8%) &lt;span class=&quot;error&quot;&gt;&amp;#91;64&amp;#93;&lt;/span&gt; 4 org/apache/pdfbox/util/TextPosition 0x3cd0668&lt;br/&gt;
    3&apos;018&apos;391 (8%) &lt;span class=&quot;error&quot;&gt;&amp;#91;64&amp;#93;&lt;/span&gt; 4 org/apache/pdfbox/util/TextPosition 0x47c4e20&lt;br/&gt;
    21&apos;938 (0%) &lt;span class=&quot;error&quot;&gt;&amp;#91;64&amp;#93;&lt;/span&gt; 4 org/apache/pdfbox/util/TextPosition 0x2e746f8&lt;br/&gt;
    108 (0%) &lt;span class=&quot;error&quot;&gt;&amp;#91;64&amp;#93;&lt;/span&gt; 4 org/apache/pdfbox/util/TextPosition 0x5840580&lt;br/&gt;
    108 (0%) &lt;span class=&quot;error&quot;&gt;&amp;#91;64&amp;#93;&lt;/span&gt; 4 org/apache/pdfbox/util/TextPosition 0x52b81d8&lt;br/&gt;
    108 (0%) &lt;span class=&quot;error&quot;&gt;&amp;#91;64&amp;#93;&lt;/span&gt; 4 org/apache/pdfbox/util/TextPosition 0x52b8148&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;..&amp;#93;&lt;/span&gt;&lt;/p&gt;</comment>
                            <comment id="12922984" author="jukkaz" created="Wed, 20 Oct 2010 14:43:06 +0000"  >&lt;p&gt;What JVM are you using? I only get an OOM with -Xmx20m (I&apos;m on a Sun 64-bit server VM, version 1.6.0_16), which seems quite reasonable.&lt;/p&gt;

&lt;p&gt;I see quite a bit of memory being used by the FontMetrics (around 700k per instance) associated with fonts, but apart from that the fonts are fairly memory-efficient now.&lt;/p&gt;

&lt;p&gt;Note that the fix to this issue was in FontBox. Did you recompile it before running the test?&lt;/p&gt;</comment>
                            <comment id="12923003" author="jeremias@apache.org" created="Wed, 20 Oct 2010 15:20:03 +0000"  >&lt;p&gt;Sorry, Jukka, my bad. I did indeed not recompile FontBox. All fine now. Thanks a lot!&lt;/p&gt;</comment>
                            <comment id="12923005" author="jukkaz" created="Wed, 20 Oct 2010 15:23:43 +0000"  >&lt;p&gt;No problem, thanks for the review! I&apos;ll proceed with the 1.3.1 release now.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12391045">PDFBOX-11</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>163547</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 years, 5 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0zkl3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>205637</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>