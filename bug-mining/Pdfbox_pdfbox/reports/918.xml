<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 20:59:00 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PDFBOX-2605] Multiple text operations on page cause NPE in TTFSubsetter</title>
                <link>https://issues.apache.org/jira/browse/PDFBOX-2605</link>
                <project id="12310760" key="PDFBOX">PDFBox</project>
                    <description>&lt;p&gt;When multiple beginText/endText pairs are called within one page, the contentStream.close() fails with:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;java.lang.NullPointerException
	at org.apache.fontbox.ttf.TTFSubsetter.getUnicodeCmap(TTFSubsetter.java:96)
	at org.apache.fontbox.ttf.TTFSubsetter.&amp;lt;init&amp;gt;(TTFSubsetter.java:85)
	at org.apache.pdfbox.pdmodel.font.TrueTypeEmbedder.subset(TrueTypeEmbedder.java:296)
	at org.apache.pdfbox.pdmodel.font.PDType0Font.subset(PDType0Font.java:112)
	at org.apache.pdfbox.pdmodel.edit.PDPageContentStream.close(PDPageContentStream.java:2049)
	at org.marsik.elshelves.backend.services.StickerServiceTest.testFailingUnicodePDF(StickerServiceTest.java:60)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:160)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:74)
	at com.intellij.rt.execution.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:211)
	at com.intellij.rt.execution.junit.JUnitStarter.main(JUnitStarter.java:67)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at com.intellij.rt.execution.application.AppMain.main(AppMain.java:134)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This can be reproduced using the following test case.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt; org.marsik.elshelves.backend.services;

&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.pdfbox.pdmodel.PDDocument;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.pdfbox.pdmodel.PDPage;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.pdfbox.pdmodel.common.PDRectangle;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.pdfbox.pdmodel.edit.PDPageContentStream;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.pdfbox.pdmodel.font.PDFont;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.pdfbox.pdmodel.font.PDType0Font;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.junit.Test;

&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;StickerServiceTest {
    @Test
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void testWorkingUnicodePDF() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {
        PDDocument document = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; PDDocument();

        PDFont titleFont = PDType0Font.load(document, &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.getClass().getResourceAsStream(&lt;span class=&quot;code-quote&quot;&gt;&quot;/DejaVuSans-Bold.ttf&quot;&lt;/span&gt;));

        PDPage page = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; PDPage(PDRectangle.A4);
        document.addPage(page);
        PDPageContentStream contentStream = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; PDPageContentStream(document, page);

        contentStream.beginText();
        contentStream.setFont(titleFont, 12);
        contentStream.newLineAtOffset(0, 100);
        contentStream.showText(&lt;span class=&quot;code-quote&quot;&gt;&quot;P&#283;kn&#253; &#382;lu&#357;ou&#269;k&#253; k&#367;&#328; &#250;p&#283;l &#271;&#225;belsk&#233; &#243;dy&quot;&lt;/span&gt;);
        contentStream.endText();

        contentStream.close();

        document.close();
    }

    @Test
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void testFailingUnicodePDF() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {
        PDDocument document = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; PDDocument();

        PDFont titleFont = PDType0Font.load(document, &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.getClass().getResourceAsStream(&lt;span class=&quot;code-quote&quot;&gt;&quot;/DejaVuSans-Bold.ttf&quot;&lt;/span&gt;));

        PDPage page = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; PDPage(PDRectangle.A4);
        document.addPage(page);
        PDPageContentStream contentStream = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; PDPageContentStream(document, page);

        contentStream.beginText();
        contentStream.setFont(titleFont, 12);
        contentStream.newLineAtOffset(0, 100);
        contentStream.showText(&lt;span class=&quot;code-quote&quot;&gt;&quot;P&#283;kn&#253; &#382;lu&#357;ou&#269;k&#253; k&#367;&#328; &#250;p&#283;l &#271;&#225;belsk&#233; &#243;dy&quot;&lt;/span&gt;);
        contentStream.endText();

        contentStream.beginText();
        contentStream.setFont(titleFont, 12);
        contentStream.newLineAtOffset(0, 200);
        contentStream.showText(&lt;span class=&quot;code-quote&quot;&gt;&quot;P&#283;kn&#253; &#382;lu&#357;ou&#269;k&#253; k&#367;&#328; &#250;p&#283;l &#271;&#225;belsk&#233; &#243;dy&quot;&lt;/span&gt;);
        contentStream.endText();

        contentStream.close();

        document.close();
    }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment>Java 1.7, Mac OS X 10.8 64 bit, Deja Vu fonts ver 2.34 from &lt;a href=&quot;http://dejavu-fonts.org&quot;&gt;http://dejavu-fonts.org&lt;/a&gt;</environment>
        <key id="12768340">PDFBOX-2605</key>
            <summary>Multiple text operations on page cause NPE in TTFSubsetter</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jahewson">John Hewson</assignee>
                                    <reporter username="MarSik">Martin Siv&#225;k</reporter>
                        <labels>
                    </labels>
                <created>Sun, 18 Jan 2015 23:23:29 +0000</created>
                <updated>Thu, 17 Mar 2016 19:07:53 +0000</updated>
                            <resolved>Mon, 19 Jan 2015 06:42:35 +0000</resolved>
                                    <version>2.0.0</version>
                                    <fixVersion>2.0.0</fixVersion>
                                    <component>FontBox</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="14282194" author="jira-bot" created="Mon, 19 Jan 2015 06:42:08 +0000"  >&lt;p&gt;Commit 1652922 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jahewson&quot; class=&quot;user-hover&quot; rel=&quot;jahewson&quot;&gt;jahewson&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1652922&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1652922&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2605&quot; title=&quot;Multiple text operations on page cause NPE in TTFSubsetter&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2605&quot;&gt;&lt;del&gt;PDFBOX-2605&lt;/del&gt;&lt;/a&gt;: Subset each font only once&lt;/p&gt;</comment>
                            <comment id="14282195" author="jahewson" created="Mon, 19 Jan 2015 06:42:35 +0000"  >&lt;p&gt;Thanks for the bug report - I&apos;ve fixed this now. By the way, you can write the code above more simply:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;contentStream.beginText();
contentStream.setFont(titleFont, 12);
contentStream.newLineAtOffset(0, 100);
contentStream.showText(&lt;span class=&quot;code-quote&quot;&gt;&quot;P&#283;kn&#253; &#382;lu&#357;ou&#269;k&#253; k&#367;&#328; &#250;p&#283;l &#271;&#225;belsk&#233; &#243;dy&quot;&lt;/span&gt;);
contentStream.newLineAtOffset(0, 200);
contentStream.showText(&lt;span class=&quot;code-quote&quot;&gt;&quot;P&#283;kn&#253; &#382;lu&#357;ou&#269;k&#253; k&#367;&#328; &#250;p&#283;l &#271;&#225;belsk&#233; &#243;dy&quot;&lt;/span&gt;);
contentStream.endText();
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14282429" author="MarSik" created="Mon, 19 Jan 2015 11:46:25 +0000"  >&lt;p&gt;Wow that was fast. Thanks.&lt;/p&gt;

&lt;p&gt;The real code iterates over a list of objects and throws some images into the mix. But thanks for the hint anyway.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12770517">PDFBOX-2634</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 43 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i24i9b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>