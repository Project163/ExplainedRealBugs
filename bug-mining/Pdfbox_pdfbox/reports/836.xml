<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 20:58:30 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PDFBOX-2471] AES encryption failing to write Acroform field names and values</title>
                <link>https://issues.apache.org/jira/browse/PDFBOX-2471</link>
                <project id="12310760" key="PDFBOX">PDFBox</project>
                    <description>&lt;p&gt;When writing a PDF using AES 256 bit encryption, the field names / values from the Acroform are not being persisted correctly. If I encrypt using RC4 128 bit, they are persisted correctly. I am using snapshot pdfbox:2.0.0-20141023.180319-636.&lt;/p&gt;

&lt;p&gt;I dug into this, and it looks to me the problem is with COSWriter.visitFromString, which invokes  SecurityHandler.decryptString (there is no SecurityHandler.encryptString).&lt;/p&gt;</description>
                <environment></environment>
        <key id="12752055">PDFBOX-2471</key>
            <summary>AES encryption failing to write Acroform field names and values</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="shendrix1980">Stephen Hendrix</reporter>
                        <labels>
                            <label>AES256</label>
                            <label>AcroForm</label>
                    </labels>
                <created>Fri, 31 Oct 2014 19:58:54 +0000</created>
                <updated>Sat, 13 Dec 2014 14:15:23 +0000</updated>
                            <resolved>Mon, 17 Nov 2014 07:50:07 +0000</resolved>
                                    <version>1.8.7</version>
                    <version>1.8.8</version>
                    <version>2.0.0</version>
                                    <fixVersion>1.8.8</fixVersion>
                    <fixVersion>2.0.0</fixVersion>
                                    <component>AcroForm</component>
                    <component>Writing</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="14192363" author="shendrix1980" created="Fri, 31 Oct 2014 20:02:55 +0000"  >&lt;p&gt;Using pdf.save as follows:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;AccessPermission ap = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; AccessPermission();
StandardProtectionPolicy policy = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; StandardProtectionPolicy(password, password, ap);

policy.setEncryptionKeyLength(256)
pdf.protect(policy);
pdf.save(outputStream)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14192511" author="shendrix1980" created="Fri, 31 Oct 2014 21:23:47 +0000"  >&lt;p&gt;The changes in the attached patch to SecurityHandler, COSWriter fixed the issue for me.&lt;/p&gt;</comment>
                            <comment id="14192987" author="jira-bot" created="Sat, 1 Nov 2014 06:30:15 +0000"  >&lt;p&gt;Commit 1635895 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1635895&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1635895&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2456&quot; title=&quot;create TestSymmetricKeyEncryption.java&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2456&quot;&gt;&lt;del&gt;PDFBOX-2456&lt;/del&gt;&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2471&quot; title=&quot;AES encryption failing to write Acroform field names and values&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2471&quot;&gt;&lt;del&gt;PDFBOX-2471&lt;/del&gt;&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2333&quot; title=&quot;Overhaul the appearance generation for PDF forms&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2333&quot;&gt;&lt;del&gt;PDFBOX-2333&lt;/del&gt;&lt;/a&gt;: add acroform test file from Maruan Sahyoun to test Acroform encryption / decryption&lt;/p&gt;</comment>
                            <comment id="14192989" author="tilman" created="Sat, 1 Nov 2014 06:35:31 +0000"  >&lt;p&gt;Yes we have a problem with AES256, which is apparently JDK related. This was discovered while working on &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2456&quot; title=&quot;create TestSymmetricKeyEncryption.java&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2456&quot;&gt;&lt;del&gt;PDFBOX-2456&lt;/del&gt;&lt;/a&gt;. So you help is most welcome, if successful. Your patch doesn&apos;t help on my local system, sadly. Please do this whether it works for you:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;update to the current trunk (use a copy because there are rendering problems since last friday)&lt;/li&gt;
	&lt;li&gt;open the file org.apache.pdfbox.encryption.TestSymmetricKeyEncryption.java in the tests&lt;/li&gt;
	&lt;li&gt;in the source code replace &quot;test.pdf&quot; with &quot;Acroform-&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2333&quot; title=&quot;Overhaul the appearance generation for PDF forms&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2333&quot;&gt;&lt;del&gt;PDFBOX-2333&lt;/del&gt;&lt;/a&gt;.pdf&quot;&lt;/li&gt;
	&lt;li&gt;in the source code, look for testProtection() and activate this segment that is commented out
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;        document = PDDocument.load(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ByteArrayInputStream(inputFileAsByteArray));
        testSymmEncrForKeySize(256, sizePriorToEncryption, document, PASSWORD, permission1);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;&lt;/li&gt;
	&lt;li&gt;run the test with your patch (and if this is my lucky day, improve your patch &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; so that it passes the test)&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14192992" author="tilman" created="Sat, 1 Nov 2014 06:44:58 +0000"  >&lt;p&gt;See also &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2469&quot; title=&quot;javax.crypto.BadPaddingException in PDFBox 1.8.8-SNAPSHOT&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2469&quot;&gt;&lt;del&gt;PDFBOX-2469&lt;/del&gt;&lt;/a&gt; which is for decrypting.&lt;/p&gt;</comment>
                            <comment id="14193184" author="shendrix1980" created="Sat, 1 Nov 2014 14:18:01 +0000"  >&lt;p&gt;What failures are you getting? I&apos;m not getting any test failures. Which JDK version?&lt;/p&gt;</comment>
                            <comment id="14193210" author="tilman" created="Sat, 1 Nov 2014 14:44:17 +0000"  >&lt;p&gt;Bad padding exception, details in &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2456&quot; title=&quot;create TestSymmetricKeyEncryption.java&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2456&quot;&gt;&lt;del&gt;PDFBOX-2456&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;java version &quot;1.7.0_71&quot;&lt;br/&gt;
Java(TM) SE Runtime Environment (build 1.7.0_71-b14)&lt;br/&gt;
Java HotSpot(TM) 64-Bit Server VM (build 24.71-b01, mixed mode)&lt;/p&gt;</comment>
                            <comment id="14193664" author="shendrix1980" created="Sun, 2 Nov 2014 03:13:26 +0000"  >&lt;p&gt;I see what you mean. I downloaded the latest 1.7 JDK and got the same failure as you.  It passed with an older 1.7 JDK that I had been using.&lt;/p&gt;</comment>
                            <comment id="14195126" author="shendrix1980" created="Mon, 3 Nov 2014 21:23:36 +0000"  >&lt;p&gt;I posted a patch which fixes this issue and the BadPaddingException to &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2456&quot; title=&quot;create TestSymmetricKeyEncryption.java&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2456&quot;&gt;&lt;del&gt;PDFBOX-2456&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14195324" author="jira-bot" created="Mon, 3 Nov 2014 23:08:54 +0000"  >&lt;p&gt;Commit 1636470 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1636470&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1636470&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2456&quot; title=&quot;create TestSymmetricKeyEncryption.java&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2456&quot;&gt;&lt;del&gt;PDFBOX-2456&lt;/del&gt;&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2471&quot; title=&quot;AES encryption failing to write Acroform field names and values&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2471&quot;&gt;&lt;del&gt;PDFBOX-2471&lt;/del&gt;&lt;/a&gt;: correct decryption for strings and ignore encryption dictionary when decrypting thanks to Stephen Hendrix; activate AES256 tests&lt;/p&gt;</comment>
                            <comment id="14195350" author="tilman" created="Mon, 3 Nov 2014 23:22:43 +0000"  >&lt;p&gt;I committed your change slightly modified for speed (encryptionDict variable). Thanks a lot!&lt;/p&gt;

&lt;p&gt;I&apos;m not yet setting to resolved, I want to make the same for the 1.8 version, which will require a test too.&lt;/p&gt;</comment>
                            <comment id="14195444" author="shendrix1980" created="Tue, 4 Nov 2014 00:27:16 +0000"  >&lt;p&gt;FYI  I forgot to update the comments in SecurityHandler.encryptString which says (incorrectly) &apos;decrypt&apos;&lt;/p&gt;</comment>
                            <comment id="14196715" author="jira-bot" created="Tue, 4 Nov 2014 19:58:35 +0000"  >&lt;p&gt;Commit 1636712 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1636712&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1636712&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2471&quot; title=&quot;AES encryption failing to write Acroform field names and values&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2471&quot;&gt;&lt;del&gt;PDFBOX-2471&lt;/del&gt;&lt;/a&gt;: add javadoc&lt;/p&gt;</comment>
                            <comment id="14197706" author="jira-bot" created="Wed, 5 Nov 2014 07:04:38 +0000"  >&lt;p&gt;Commit 1636804 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/branches/1.8&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1636804&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1636804&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2456&quot; title=&quot;create TestSymmetricKeyEncryption.java&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2456&quot;&gt;&lt;del&gt;PDFBOX-2456&lt;/del&gt;&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2471&quot; title=&quot;AES encryption failing to write Acroform field names and values&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2471&quot;&gt;&lt;del&gt;PDFBOX-2471&lt;/del&gt;&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2333&quot; title=&quot;Overhaul the appearance generation for PDF forms&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2333&quot;&gt;&lt;del&gt;PDFBOX-2333&lt;/del&gt;&lt;/a&gt;: add acroform test file from Maruan Sahyoun to test Acroform encryption / decryption&lt;/p&gt;</comment>
                            <comment id="14197725" author="jira-bot" created="Wed, 5 Nov 2014 07:12:16 +0000"  >&lt;p&gt;Commit 1636806 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/branches/1.8&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1636806&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1636806&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2456&quot; title=&quot;create TestSymmetricKeyEncryption.java&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2456&quot;&gt;&lt;del&gt;PDFBOX-2456&lt;/del&gt;&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2471&quot; title=&quot;AES encryption failing to write Acroform field names and values&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2471&quot;&gt;&lt;del&gt;PDFBOX-2471&lt;/del&gt;&lt;/a&gt;: correct decryption for strings and ignore encryption dictionary when decrypting thanks to Stephen Hendrix&lt;/p&gt;</comment>
                            <comment id="14214392" author="tilman" created="Mon, 17 Nov 2014 07:50:07 +0000"  >&lt;p&gt;I see I forgot to set this one to resolved. Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=shendrix1980&quot; class=&quot;user-hover&quot; rel=&quot;shendrix1980&quot;&gt;shendrix1980&lt;/a&gt;!&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12751946">PDFBOX-2469</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12678566" name="PDFBOX-2471_Fix__AES_256_bit_encryption_of_COSString.diff" size="2055" author="shendrix1980" created="Fri, 31 Oct 2014 21:23:47 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i21tyf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>