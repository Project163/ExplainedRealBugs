<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:09:13 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PDFBOX-4470] Red areas around text when converting a pdf to png with pdfbox</title>
                <link>https://issues.apache.org/jira/browse/PDFBOX-4470</link>
                <project id="12310760" key="PDFBOX">PDFBox</project>
                    <description>&lt;p&gt;I&apos;m trying to convert a pdf to png file using pdfbox. Unfortunately in the result I get weird red areas in some places of the output. I&apos;m not sure what&apos;s the problem. It&apos;s a problem with only some of the pdf files.&lt;/p&gt;

&lt;p&gt;Here&apos;s some of the code that I&apos;m using:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&#160;&#160;&#160; &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; BufferedImage generateFromPdf(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; ref, InputStream stream, &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; pageIndex, PreviewMode mode) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException {
 &#160;&#160;&#160;&#160;&#160;&#160;&#160; PDDocument doc = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;
 &#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; (InputStream buffered = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; BufferedInputStream(stream)) {
 &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; doc = PDDocument.load(buffered, PDF_LOADING_MEMORY_SETTING);
 &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (pageIndex &amp;gt; doc.getNumberOfPages())
{ &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;; &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; PDFRenderer renderer = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; PDFRenderer(doc);
 &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; rasterizePdfBox(ref, pageIndex, renderer, mode);
 &#160;&#160;&#160;&#160;&#160;&#160;&#160; } &lt;span class=&quot;code-keyword&quot;&gt;finally&lt;/span&gt; {
 &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (doc != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;)
{ &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; doc.close(); &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }
&#160;&#160;&#160;&#160;&#160;&#160;&#160; }
 &#160;&#160;&#160; }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt; and then:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&#160;&#160;&#160; &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; BufferedImage rasterizePdfBox(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; ref, &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; pageIndex, PDFRenderer renderer, PreviewMode mode) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException {
 &#160;&#160;&#160;&#160;&#160;&#160;&#160; Future&amp;lt;BufferedImage&amp;gt; result = executorService.submit(() -&amp;gt;
{ &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; LOGGER.info(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;.format(&lt;span class=&quot;code-quote&quot;&gt;&quot;Generate preview &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; ref: %s, page: %s, mode: %s &quot;&lt;/span&gt;, ref, pageIndex, mode.name())); &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; renderer.renderImageWithDPI(pageIndex - 1, mode.getDpi(), ImageType.RGB); &#160;&#160;&#160;&#160;&#160;&#160;&#160; }
);
&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt;
{ &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; result.get(); &#160;&#160;&#160;&#160;&#160;&#160;&#160; }
&lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (InterruptedException | ExecutionException e)
{ &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; LOGGER.error(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;.format(&lt;span class=&quot;code-quote&quot;&gt;&quot;Error when generating preview: %s&quot;&lt;/span&gt;, e.getMessage())); &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.currentThread().interrupt(); &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; IOException(e.getMessage()); &#160;&#160;&#160;&#160;&#160;&#160;&#160; }
&#160;&#160;&#160; }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt; ```&lt;/p&gt;

&lt;p&gt;So far I&apos;ve only figured out that the places which are red in the output are blank when I open them in `Master PDF editor` on linux. They seem normal though when I open them with `Document Viewer`.&lt;/p&gt;

&lt;p&gt;Some hints:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;the pdfs with problems have been scanned. I can select text around the working parts but not at the places that have red overlay over them. Maybe it&apos;s something to do with OCR issues?&lt;/li&gt;
	&lt;li&gt;if I use the linux tool `convert not-working-pdf.pdf converted.pdf` and then try to convert this file to png, then the issue is not there anymore.&lt;/li&gt;
&lt;/ul&gt;
</description>
                <environment></environment>
        <key id="13216946">PDFBOX-4470</key>
            <summary>Red areas around text when converting a pdf to png with pdfbox</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tilman">Tilman Hausherr</assignee>
                                    <reporter username="linoor">Micha&#322; Pomara&#324;ski</reporter>
                        <labels>
                    </labels>
                <created>Wed, 20 Feb 2019 14:47:34 +0000</created>
                <updated>Thu, 28 Feb 2019 17:45:06 +0000</updated>
                            <resolved>Wed, 20 Feb 2019 20:02:42 +0000</resolved>
                                    <version>2.0.13</version>
                                    <fixVersion>2.0.14</fixVersion>
                    <fixVersion>3.0.0 PDFBox</fixVersion>
                                    <component>Rendering</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="16773197" author="tilman" created="Wed, 20 Feb 2019 17:00:58 +0000"  >&lt;p&gt;The cause is in&#160;&lt;tt&gt;PDImageXObject.applyMask()&lt;/tt&gt;. This is a bitonal image with a mask, which is unusual. There is only one color element in the raster (R instead of RGB) so only &quot;R&quot; is applied instead of all 3 of the destination.&lt;/p&gt;

&lt;p&gt;Was this also you?&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://stackoverflow.com/questions/54294852/red-areas-around-text-when-converting-a-pdf-to-png-with-pdfbox&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://stackoverflow.com/questions/54294852/red-areas-around-text-when-converting-a-pdf-to-png-with-pdfbox&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;The simpliest solution (which I am testing right now) will be to just copy this into an RGB image. I could also create a separate applyMask() method but considering that this case is so unusual, I don&apos;t think it is needed.&lt;/p&gt;</comment>
                            <comment id="16773338" author="jira-bot" created="Wed, 20 Feb 2019 19:48:21 +0000"  >&lt;p&gt;Commit 1853985 from Tilman Hausherr in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1853985&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1853985&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4470&quot; title=&quot;Red areas around text when converting a pdf to png with pdfbox&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4470&quot;&gt;&lt;del&gt;PDFBOX-4470&lt;/del&gt;&lt;/a&gt;: convert images to RGB when there are less than 3 colors&lt;/p&gt;</comment>
                            <comment id="16773339" author="jira-bot" created="Wed, 20 Feb 2019 19:48:26 +0000"  >&lt;p&gt;Commit 1853986 from Tilman Hausherr in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1853986&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1853986&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4470&quot; title=&quot;Red areas around text when converting a pdf to png with pdfbox&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4470&quot;&gt;&lt;del&gt;PDFBOX-4470&lt;/del&gt;&lt;/a&gt;: convert images to RGB when there are less than 3 colors&lt;/p&gt;</comment>
                            <comment id="16773350" author="tilman" created="Wed, 20 Feb 2019 20:02:42 +0000"  >&lt;p&gt;Fixed. Snapshot will be available in a few hours at&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://repository.apache.org/content/groups/snapshots/org/apache/pdfbox/pdfbox-app/2.0.14-SNAPSHOT/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://repository.apache.org/content/groups/snapshots/org/apache/pdfbox/pdfbox-app/2.0.14-SNAPSHOT/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16773784" author="linoor" created="Thu, 21 Feb 2019 07:59:47 +0000"  >&lt;p&gt;Yes that was also me with the stackoverflow question. Thanks a lot, that was really quick!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12959449" name="1206264-michael-sims-onboarding-documents-248 (1).pdf" size="76926" author="linoor" created="Wed, 20 Feb 2019 14:46:06 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 38 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|yi16rs:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>