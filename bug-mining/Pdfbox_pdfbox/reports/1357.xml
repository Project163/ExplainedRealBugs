<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:02:34 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PDFBOX-3164] XFDF annotations partially incorrectly applied to existing PDF or exceptions when parsing</title>
                <link>https://issues.apache.org/jira/browse/PDFBOX-3164</link>
                <project id="12310760" key="PDFBOX">PDFBox</project>
                    <description>&lt;p&gt;I am currently investigating in using PDFBox (my tests used PFDBox 2.0RC2) for a small use case &#8222;stamping&#8220; annotations from a given XFDF format (created by Qoppa&#8217;s jPDFEditor/jPDFNotes, www.qoppa.com) into a given PDF/A-1b file.&lt;/p&gt;

&lt;p&gt;This works with a surprisingly minimal set of Java code line &#61514; But: obviously not all XFDF elements are supported and/or there are bugs in reading XFDF up to now. &lt;/p&gt;

&lt;p&gt;I just wanted to let you know about my experiences.&lt;/p&gt;

&lt;p&gt;a)	Drawing lines painted by a pencil (element: &#8220;&amp;lt;gesture&amp;gt;&#8221;) do not show up at all after stamping them. Why?&lt;/p&gt;

&lt;p&gt;Sample data to test with:&lt;br/&gt;
&amp;lt;ink name=&quot;C2B070EBB736993EA25F4545350AD2C3&quot; style=&quot;solid&quot; width=&quot;4.0&quot; flags=&quot;print&quot; date=&quot;D:20151207122033+01&amp;apos;00&amp;apos;&quot; color=&quot;#00ff00&quot; opacity=&quot;1.0&quot; page=&quot;0&quot; subject=&quot;Bleistift&quot; rect=&quot;62.4562,1378.1637,167.5599,1402.8388&quot; title=&quot;matstoll&quot;&amp;gt;&amp;lt;inklist&amp;gt;&amp;lt;gesture&amp;gt;68.4562,1385.1637;69.7534,1385.1637;73.6451,1385.1637;77.5368,1385.1637;82.7258,1387.7582;89.212,1389.0554;93.1037,1390.3525;96.9954,1390.3525;100.8871,1391.6498;104.7788,1392.947;111.2649,1394.2443;116.4539,1394.2443;121.6428,1395.5415;125.5345,1395.5415;130.7235,1395.5415;134.6152,1395.5415;139.8041,1395.5415;143.6958,1395.5415;148.8848,1395.5415;151.4792,1395.5415;155.3709,1396.8387;156.6682,1396.8387;157.9654,1396.8387;160.5599,1396.8387&amp;lt;/gesture&amp;gt;&amp;lt;/inklist&amp;gt;&amp;lt;contents&amp;gt;Pencil line&amp;lt;/contents&amp;gt;&amp;lt;/ink&amp;gt;&lt;br/&gt;
b)	Polygons (at least when created with jPDFNotes) throw an exception when reading:&lt;br/&gt;
Exception in thread &quot;main&quot; java.lang.NumberFormatException: For input string: &quot;1318.7075;1054.6517&quot;&lt;br/&gt;
             at sun.misc.FloatingDecimal.readJavaFormatString(Unknown Source)&lt;br/&gt;
             at sun.misc.FloatingDecimal.parseFloat(Unknown Source)&lt;br/&gt;
             at java.lang.Float.parseFloat(Unknown Source)&lt;br/&gt;
             at org.apache.pdfbox.pdmodel.fdf.FDFAnnotationPolygon.initVertices(FDFAnnotationPolygon.java:101)&lt;br/&gt;
             at org.apache.pdfbox.pdmodel.fdf.FDFAnnotationPolygon.&amp;lt;init&amp;gt;(FDFAnnotationPolygon.java:78)&lt;br/&gt;
             at org.apache.pdfbox.pdmodel.fdf.FDFDictionary.&amp;lt;init&amp;gt;(FDFDictionary.java:196) &lt;/p&gt;

&lt;p&gt;Sample data to test with:&lt;br/&gt;
&amp;lt;polygon name=&quot;534DC02A197B56578FFA6AE5F178100F&quot; style=&quot;solid&quot; width=&quot;9.0&quot; flags=&quot;print&quot; date=&quot;D:20151207121013+01&amp;apos;00&amp;apos;&quot; color=&quot;#0000ff&quot; opacity=&quot;1.0&quot; page=&quot;0&quot; subject=&quot;Polygon&quot; rect=&quot;857.5527,1117.7167,1063.6517,1334.1936&quot; title=&quot;matstoll&quot;&amp;gt;&lt;br/&gt;
&amp;lt;vertices&amp;gt;866.5527,1318.7075;1054.6517,1325.1936;1032.5987,1126.7167;876.9306,1179.9034;866.5527,1318.7075;&amp;lt;/vertices&amp;gt;&lt;br/&gt;
&amp;lt;/polygon&amp;gt;&lt;/p&gt;

&lt;p&gt;c)	A cloudy polygon cannot be read either &#8211; I assume a general issue reading polygons.&lt;/p&gt;

&lt;p&gt;Sample data to test with:&lt;br/&gt;
&amp;lt;polygon name=&quot;0276B0ECDCA680FDB0C0AE8377AE0FAA&quot; style=&quot;cloudy&quot; width=&quot;4.0&quot; flags=&quot;print&quot; date=&quot;D:20151207122247+01&amp;apos;00&amp;apos;&quot; intensity=&quot;2&quot; color=&quot;#ff5500&quot; opacity=&quot;1.0&quot; page=&quot;0&quot; subject=&quot;Cloud/Wolke&quot; rect=&quot;278.8037,1105.6361,563.5944,1216.9184&quot; title=&quot;matstoll&quot; IT=&quot;PolygonCloud&quot;&amp;gt;&amp;lt;vertices&amp;gt;310.0391,1147.4725;420.304,1205.8481;555.2164,1117.6361;342.4699,1117.6361;286.6888,1134.5002;310.0391,1147.4725;&amp;lt;/vertices&amp;gt;&amp;lt;/polygon&amp;gt;&lt;br/&gt;
d)	A freetext (&#8220;&amp;lt;freetext&amp;gt;&#8221;) element will not show up correctly:&lt;br/&gt;
b1) Though &#8220;width=0.0&#8221; for the box, it PDFBox will render a box around the text&lt;br/&gt;
b2) Though font is set to &#8220;font: Courier 12pt; color:#000000&#8221; a wrong font will be rendered&lt;br/&gt;
b3) The color setting will be ignored: my tests setting a color of font and border to red showed up a textbox with black border and black text.&lt;br/&gt;
e)	A freetext element with legend options does not show up correctly:&lt;br/&gt;
e1) Colors are wrong/ignored&lt;br/&gt;
e2) Font size not correct&lt;br/&gt;
e3) Legend arrow not drawn&lt;/p&gt;

&lt;p&gt;Sample data to test with:&lt;br/&gt;
&amp;lt;freetext name=&quot;95DB90502D987FDE0DD5446ED48C098A&quot; style=&quot;solid&quot; width=&quot;3.0&quot; justification=&quot;left&quot; flags=&quot;print&quot; date=&quot;D:20151207122813+01&amp;apos;00&amp;apos;&quot; color=&quot;#4055ff&quot; callout=&quot;356.7395,1471.7811,479.2464,1372.3664,494.2464,1327.1395&quot; page=&quot;0&quot; subject=&quot;Legend textfield&quot; fringe=&quot;137.5069,-0.0,0.0,86.9147&quot; rect=&quot;356.7395,1269.4126,704.3984,1471.7811&quot; head=&quot;OpenArrow&quot; title=&quot;matstoll&quot; IT=&quot;FreeTextCallout&quot;&amp;gt;&amp;lt;contents&amp;gt;This is a legend with arrow&amp;lt;/contents&amp;gt;&amp;lt;defaultstyle&amp;gt;font: Courier 24pt; color:#BFAAFF&amp;lt;/defaultstyle&amp;gt;&amp;lt;defaultappearance&amp;gt;1.0 0.7490196078431373 0.0 rg /Helv 12 Tf&amp;lt;/defaultappearance&amp;gt;&amp;lt;/freetext&amp;gt;&lt;br/&gt;
There might be more of such issues &#8211; but I think this should be sufficient info for now to check how to proceed.&lt;/p&gt;

&lt;p&gt;Adobe Acrobat renders all these test cases correctly by the way, so I assume the XFDF elements are all correct.&lt;/p&gt;

&lt;p&gt;I can provide the sample code if needed &#8211; where shall I upload it &#8211; if needed?&lt;/p&gt;

&lt;p&gt;As I do not find that much info about the support of XFDF in various PDF libraries &#8211; what about the official support in PDFBox? Should all of the samples work? What are the plans to do so?&lt;/p&gt;

&lt;p&gt;Thanks a lot in advance.&lt;/p&gt;</description>
                <environment>Windows 7 SP1 Enterprise, 64 Bit, Java 8u66 64 Bit</environment>
        <key id="12921785">PDFBOX-3164</key>
            <summary>XFDF annotations partially incorrectly applied to existing PDF or exceptions when parsing</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tilman">Tilman Hausherr</assignee>
                                    <reporter username="mamboman">Matthias Stoll</reporter>
                        <labels>
                            <label>annotations</label>
                            <label>xfdf</label>
                    </labels>
                <created>Mon, 14 Dec 2015 21:50:43 +0000</created>
                <updated>Thu, 17 Mar 2016 19:06:44 +0000</updated>
                            <resolved>Fri, 18 Dec 2015 20:07:22 +0000</resolved>
                                    <version>1.8.10</version>
                    <version>2.0.0</version>
                                    <fixVersion>2.0.0</fixVersion>
                                    <component>PDModel</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="15056781" author="mamboman" created="Mon, 14 Dec 2015 21:54:56 +0000"  >&lt;p&gt;Simply compilie XFDFStamper.java and run with the options&lt;br/&gt;
1: name of the PDF/A File to stamp files into&lt;br/&gt;
2: name of an XFDF file to read annotations from&lt;br/&gt;
3: target filename in which 1 and 2 are being merged as new PDF.&lt;/p&gt;

&lt;p&gt;Sample with one of the attachments:&lt;br/&gt;
java com.hpe.samples.pdfbox.XFDFStamper Multipage_Sample_PDFA.pdf &lt;br/&gt;
Multipage_Sample_annots_legend.xfdf&lt;br/&gt;
Multipage_Sample_annots_legend_nok_PDFBOX.pdf&lt;/p&gt;</comment>
                            <comment id="15056797" author="mamboman" created="Mon, 14 Dec 2015 22:00:27 +0000"  >&lt;p&gt;Sample files to test the Java program with.&lt;br/&gt;
The files &quot;&lt;b&gt;Acrobat&lt;/b&gt;&quot; are for comparison what Adobe Acrobat does - this is seen as a reference in class.&lt;br/&gt;
I have added &quot;&lt;b&gt;PDFBOX&lt;/b&gt;&quot; results from my XFDFStamper class showing the difference to the respective Acrobat result.&lt;/p&gt;

&lt;p&gt;The polygon XFDF cannot even be read by PDFBOX.&lt;/p&gt;</comment>
                            <comment id="15056821" author="msahyoun" created="Mon, 14 Dec 2015 22:16:05 +0000"  >&lt;p&gt;Apart from issues with individual annotation types the main one is that PDFBox does not generate the appearance stream for the annotations which is why you don&apos;t see anything although the annotation has been generated.&lt;/p&gt;</comment>
                            <comment id="15056841" author="tilman" created="Mon, 14 Dec 2015 22:29:25 +0000"  >&lt;p&gt;I&apos;m confused. You wrote&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Adobe Acrobat renders all these test cases correctly by the way, so I assume the XFDF elements are all correct.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;But the file Multipage_Sample_annots_ink_nok_PDFBOX.pdf does not have an annotation that can be seen with Adobe Reader. I looked at the file with PDFDebugger, it does have an ink annotation, but that one is empty. It has neither an appearance stream nor an /Inklist entry.&lt;/p&gt;</comment>
                            <comment id="15056847" author="msahyoun" created="Mon, 14 Dec 2015 22:34:43 +0000"  >&lt;p&gt;If I understand correctly the xxx_nok_PDFOX.pdf are generated by PDFBox and the xxx_ok_Acrobat.pdf are generated using Adobe Acrobat. So looking at what PDFBox generated and comparing that with the Acrobat generated ones should allow us to understand the gap in functionality.&lt;/p&gt;</comment>
                            <comment id="15056864" author="tilman" created="Mon, 14 Dec 2015 22:40:28 +0000"  >&lt;p&gt;Maybe lets start with the &quot;ink&quot; files because this type of annotations is still fresh in my memory (&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3146&quot; title=&quot;Ink annotation borders not rendered&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3146&quot;&gt;&lt;del&gt;PDFBOX-3146&lt;/del&gt;&lt;/a&gt;), and these can be rendered by PDFBox.&lt;/p&gt;</comment>
                            <comment id="15056888" author="tilman" created="Mon, 14 Dec 2015 22:54:53 +0000"  >&lt;p&gt;OK I got it. It is mostly about generating annotations. Here&apos;s what the ink example passes:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;COSDictionary{(COSName{Type}:COSName{Annot}) (COSName{Page}:COSInt{0}) (COSName{C}:COSArray{[COSFloat{0.0}, COSFloat{1.0}, COSFloat{0.0}]}) (COSName{M}:COSString{D:20151214222844+01&lt;span class=&quot;code-quote&quot;&gt;&apos;00&apos;&lt;/span&gt;}) (COSName{F}:COSInt{4}) (COSName{NM}:COSString{40049B9E02656F8FFF6EEABDAC836D6A}) (COSName{Rect}:COSArray{[COSFloat{56.9006}, COSFloat{591.3178}, COSFloat{459.9906}, COSFloat{665.9555}]}) (COSName{T}:COSString{matstoll}) (COSName{CA}:COSFloat{1.0}) (COSName{Subj}:COSString{Bleistift}) (COSName{IT}:COSString{}) (COSName{Contents}:COSString{}) (COSName{BS}:COSDictionary{(COSName{W}:COSFloat{3.0}) (COSName{S}:COSName{S}) }) (COSName{Subtype}:COSName{Ink}) }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Obviously, the inklist is missing.&lt;/p&gt;</comment>
                            <comment id="15056891" author="msahyoun" created="Mon, 14 Dec 2015 22:55:18 +0000"  >&lt;p&gt;Fine. We have to generate the appearance stream when creating the annotations which we could derive from your code. Can we set that do be done for 2.1?&lt;/p&gt;

&lt;p&gt;I already have some ideas as I need that for AcroForm fields where I wanted to generate a default look when one is generating fields from scratch but wanted to wait until PDFBox 2.0 was released.&lt;/p&gt;</comment>
                            <comment id="15056911" author="jira-bot" created="Mon, 14 Dec 2015 23:05:01 +0000"  >&lt;p&gt;Commit 1720041 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1720041&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1720041&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3164&quot; title=&quot;XFDF annotations partially incorrectly applied to existing PDF or exceptions when parsing&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3164&quot;&gt;&lt;del&gt;PDFBOX-3164&lt;/del&gt;&lt;/a&gt;: set inklist&lt;/p&gt;</comment>
                            <comment id="15056925" author="tilman" created="Mon, 14 Dec 2015 23:08:52 +0000"  >&lt;p&gt;Yes and no... for some, the appearance stream isn&apos;t even needed, e.g. an ink list. I just fixed that one. The data was missing in the dictionary. I&apos;ll look at the other cases if the solutions are as simple. (I won&apos;t do anything about appearance streams).&lt;/p&gt;</comment>
                            <comment id="15056933" author="jira-bot" created="Mon, 14 Dec 2015 23:10:34 +0000"  >&lt;p&gt;Commit 1720042 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1720042&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1720042&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3164&quot; title=&quot;XFDF annotations partially incorrectly applied to existing PDF or exceptions when parsing&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3164&quot;&gt;&lt;del&gt;PDFBOX-3164&lt;/del&gt;&lt;/a&gt;: make method called in constructor final&lt;/p&gt;</comment>
                            <comment id="15056941" author="msahyoun" created="Mon, 14 Dec 2015 23:13:18 +0000"  >&lt;p&gt;I started looking up some - but it&apos;s getting late now &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;E.g. we don&apos;t read the default appearance element in XFDF for FreeText annotations.&lt;/p&gt;

&lt;p&gt;About the appearance stream - PDF 2.0 requires the appearance stream to be generated. So we should prepare for that (in the future).&lt;/p&gt;</comment>
                            <comment id="15056942" author="jira-bot" created="Mon, 14 Dec 2015 23:15:09 +0000"  >&lt;p&gt;Commit 1720043 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1720043&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1720043&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3164&quot; title=&quot;XFDF annotations partially incorrectly applied to existing PDF or exceptions when parsing&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3164&quot;&gt;&lt;del&gt;PDFBOX-3164&lt;/del&gt;&lt;/a&gt;: avoid ClassCastException if /BS is indirect&lt;/p&gt;</comment>
                            <comment id="15056951" author="jira-bot" created="Mon, 14 Dec 2015 23:17:46 +0000"  >&lt;p&gt;Commit 1720044 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1720044&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1720044&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3164&quot; title=&quot;XFDF annotations partially incorrectly applied to existing PDF or exceptions when parsing&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3164&quot;&gt;&lt;del&gt;PDFBOX-3164&lt;/del&gt;&lt;/a&gt;: avoid ClassCastException if /BS is indirect&lt;/p&gt;</comment>
                            <comment id="15056977" author="jira-bot" created="Mon, 14 Dec 2015 23:36:02 +0000"  >&lt;p&gt;Commit 1720048 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1720048&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1720048&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3164&quot; title=&quot;XFDF annotations partially incorrectly applied to existing PDF or exceptions when parsing&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3164&quot;&gt;&lt;del&gt;PDFBOX-3164&lt;/del&gt;&lt;/a&gt;: correct splitting of the vertices; make method called in constructor final&lt;/p&gt;</comment>
                            <comment id="15056986" author="tilman" created="Mon, 14 Dec 2015 23:40:08 +0000"  >&lt;p&gt;This solves problem b), with the polygon file. However the resulting file is shown properly only in Adobe Reader (after clicking on the yellow bar), because we don&apos;t support proper rendering of that annotation type when there is no appearance stream. (Neither does PDF.js) Time to go to bed.&lt;/p&gt;</comment>
                            <comment id="15057481" author="tilman" created="Tue, 15 Dec 2015 07:13:48 +0000"  >&lt;p&gt;This solves problem a).&lt;/p&gt;</comment>
                            <comment id="15057573" author="jira-bot" created="Tue, 15 Dec 2015 08:12:19 +0000"  >&lt;p&gt;Commit 1720084 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1720084&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1720084&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3164&quot; title=&quot;XFDF annotations partially incorrectly applied to existing PDF or exceptions when parsing&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3164&quot;&gt;&lt;del&gt;PDFBOX-3164&lt;/del&gt;&lt;/a&gt;: add /DA and /DS&lt;/p&gt;</comment>
                            <comment id="15057579" author="tilman" created="Tue, 15 Dec 2015 08:15:35 +0000"  >&lt;p&gt;This solves e1). However the resulting file is shown properly only in Adobe Reader (after clicking on the yellow bar), because we don&apos;t support proper rendering of that annotation type when there is no appearance stream.&lt;/p&gt;</comment>
                            <comment id="15057583" author="tilman" created="Tue, 15 Dec 2015 08:16:24 +0000"  >&lt;p&gt;I don&apos;t see an example for the &quot;cloud&quot; problem - did you forgot it?&lt;/p&gt;</comment>
                            <comment id="15057797" author="mamboman" created="Tue, 15 Dec 2015 10:22:07 +0000"  >&lt;p&gt;I have added a cloud XFDF sample &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;br/&gt;
Red border, yellow background. Just to see what happens.&lt;/p&gt;</comment>
                            <comment id="15057805" author="mamboman" created="Tue, 15 Dec 2015 10:27:04 +0000"  >&lt;p&gt;Yes, my naming is &quot;nok&quot; in the filename if the pdf has not been generated proberly and does not show the same result as with Acrobat. Maruan Sayhyoun interpreted it correctly - sorry not being clear on that.&lt;br/&gt;
But folks - you are fast - really fast in solving issues. Thanks for that!&lt;/p&gt;</comment>
                            <comment id="15057819" author="mamboman" created="Tue, 15 Dec 2015 10:34:14 +0000"  >&lt;p&gt;@Tilman: If you need a free and simple client to build those annotation types on your own: www.qoppa.com has the jPDFNotes.&lt;br/&gt;
&lt;a href=&quot;https://www.qoppa.com/pdfnotes/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://www.qoppa.com/pdfnotes/&lt;/a&gt;&lt;br/&gt;
There is a free trial available. It&apos;s a Java program, easy to install.&lt;br/&gt;
When you open my sample PDF, just make the comments toolbar visible with &quot;View -&amp;gt; Comments&quot;. In the panel at the button there is a small &quot;arrown down&quot; button allowing you to save the annotations created as XFDF independently.&lt;br/&gt;
Very helpful for testing all the individual types.&lt;/p&gt;

&lt;p&gt;Or: modify the XFDF files directly.&lt;/p&gt;

&lt;p&gt;Of course I will be there to help with any further diagnosis anyway.&lt;br/&gt;
Is there a chance to download a version with the fixes in it? &lt;br/&gt;
Great job by the way - you are incredibly fast. Thanks!&lt;/p&gt;</comment>
                            <comment id="15057849" author="tilman" created="Tue, 15 Dec 2015 10:57:09 +0000"  >&lt;p&gt;Get a -SNAPSHOT on maven or download it here&lt;br/&gt;
&lt;a href=&quot;https://repository.apache.org/content/groups/snapshots/org/apache/pdfbox/pdfbox-app/2.0.0-SNAPSHOT/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://repository.apache.org/content/groups/snapshots/org/apache/pdfbox/pdfbox-app/2.0.0-SNAPSHOT/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15058166" author="mamboman" created="Tue, 15 Dec 2015 15:00:55 +0000"  >&lt;p&gt;Just tested the build from this morning - great. All my use cases work. Thumbs up for these quick fixes!&lt;br/&gt;
The only usecase showing slightly different results is &quot;Multipage_Sample_annots_legend.xfdf&quot;.&lt;br/&gt;
Here Acrobat and PDFBOX differ - and even the Qoppa Editor itself shows a slightly different look to those 2 products - hm, which product shall we trust in? &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="15058344" author="jira-bot" created="Tue, 15 Dec 2015 17:08:53 +0000"  >&lt;p&gt;Commit 1720197 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1720197&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1720197&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3164&quot; title=&quot;XFDF annotations partially incorrectly applied to existing PDF or exceptions when parsing&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3164&quot;&gt;&lt;del&gt;PDFBOX-3164&lt;/del&gt;&lt;/a&gt;: Intents are names, not strings; fix fringe calculations; add extra attributes; make methods called in constructor final&lt;/p&gt;</comment>
                            <comment id="15058349" author="tilman" created="Tue, 15 Dec 2015 17:11:29 +0000"  >&lt;p&gt;This should solve the remaining problems. Please test all your files again.&lt;/p&gt;

&lt;p&gt;There&apos;s one problem with your XFDF files: IT=&quot;PolygonCloud&quot;, this should be intent=&quot;PolygonCloud&quot;. &quot;IT&quot; is the corresponding key in the PDF file. See &lt;a href=&quot;https://partners.adobe.com/public/developer/en/xml/XFDF_Spec_3.0.pdf#92&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://partners.adobe.com/public/developer/en/xml/XFDF_Spec_3.0.pdf#92&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Are you a client of qoppa, or just testing their product to get some xfdf examples? If you&apos;re a client, please ask them why they are using &quot;IT&quot; instead of &quot;intent&quot; for intents. To test your files, replace &quot;IT&quot; with &quot;intent&quot; in your xfdf files.&lt;/p&gt;

&lt;p&gt;I could change the software so that both &quot;IT&quot; and &quot;intent&quot; is possible, if needed.&lt;/p&gt;

&lt;p&gt;OTOH, at least one element is used by Adobe and not mentioned in the xfdf spec: &quot;callout&quot;, which is transferred to CL in the PDF, so that makes me wonder if the spec can be trusted fully.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=johanneke&quot; class=&quot;user-hover&quot; rel=&quot;johanneke&quot;&gt;johanneke&lt;/a&gt; please test whether your application works as before (or better).&lt;/p&gt;</comment>
                            <comment id="15058483" author="jira-bot" created="Tue, 15 Dec 2015 18:23:59 +0000"  >&lt;p&gt;Commit 1720215 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1720215&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1720215&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3164&quot; title=&quot;XFDF annotations partially incorrectly applied to existing PDF or exceptions when parsing&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3164&quot;&gt;&lt;del&gt;PDFBOX-3164&lt;/del&gt;&lt;/a&gt;: don&apos;t bother with empty callout&lt;/p&gt;</comment>
                            <comment id="15058813" author="mamboman" created="Tue, 15 Dec 2015 21:07:21 +0000"  >&lt;p&gt;@Tilman: No, I am not a client of Qoppa directly. One of our customers intends to use this software stack for one of his business applications. His first idea was to directly use PDFs created by the Qoppa software, but consulting them I suggested that only the XFDF files should be used to be able to flexibly process XFDFs independently from the PDFs.&lt;br/&gt;
Therefore I use Qoppa software - just to check whether the approach is meaningful at all.&lt;br/&gt;
Now after the lastest fixes in PDFBox I&apos;m even more convinced.&lt;/p&gt;</comment>
                            <comment id="15062750" author="mamboman" created="Thu, 17 Dec 2015 20:33:35 +0000"  >&lt;p&gt;Most of my samples work now - thanks a lot.&lt;br/&gt;
I just found that the &quot;legend&quot; XFDF file still is not complete - the arrow is missing completely wheres Adobe renders it correctly.&lt;br/&gt;
The rest is fine for me.&lt;br/&gt;
Is the &quot;legend&quot; case still open?&lt;/p&gt;</comment>
                            <comment id="15062751" author="tilman" created="Thu, 17 Dec 2015 20:34:46 +0000"  >&lt;p&gt;You need to change the XFDF file, replace &quot;IT&quot; with &quot;intent&quot;.&lt;/p&gt;</comment>
                            <comment id="15064537" author="mamboman" created="Fri, 18 Dec 2015 19:18:09 +0000"  >&lt;p&gt;As the XFDF was written by a standard product - you mean it writes out wrong data?&lt;br/&gt;
I see that the fix works correctly when using &quot;intent&quot;.&lt;br/&gt;
But as Acrobat works also with this style - shouldn&apos;t PDFBox work a bit flexible at that point as well?&lt;/p&gt;</comment>
                            <comment id="15064590" author="mamboman" created="Fri, 18 Dec 2015 19:34:59 +0000"  >&lt;p&gt;Looking into the XFDF spec, V3.0 Page 72_&lt;/p&gt;

&lt;p&gt;&quot;intent: Corresponds to the IT key in the markup annotation dictionary.&lt;br/&gt;
Intents allow viewer applications to distinguish between different uses and behaviors of a single markup annotation type. If this entry is not present or its value is the same as the annotation type, the annotation has no explicit intent and should behave in a generic manner in a viewer application.&lt;br/&gt;
In XFDF 2.0, free text, line, and polygon and polyline annotations have defined intents, whose values are enumerated in the corresponding tables.&lt;br/&gt;
Elements: freetext, line, polygon,and polyline.&quot;&lt;/p&gt;

&lt;p&gt;Page 92 in the reference section also states that &quot;intent&quot; is the XFDF equivalent to the PDF element &quot;IT&quot;.&lt;/p&gt;

&lt;p&gt;Therefore you are right - and Qoppa is wrong. I will file an issue there.&lt;/p&gt;</comment>
                            <comment id="15064668" author="jira-bot" created="Fri, 18 Dec 2015 20:05:55 +0000"  >&lt;p&gt;Commit 1720842 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1720842&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1720842&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3164&quot; title=&quot;XFDF annotations partially incorrectly applied to existing PDF or exceptions when parsing&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3164&quot;&gt;&lt;del&gt;PDFBOX-3164&lt;/del&gt;&lt;/a&gt;: allow &quot;IT&quot; as alternatve to &quot;intent&quot; in xpdf for /IT&lt;/p&gt;</comment>
                            <comment id="15064670" author="tilman" created="Fri, 18 Dec 2015 20:06:11 +0000"  >&lt;p&gt;done.&lt;/p&gt;</comment>
                            <comment id="15064671" author="tilman" created="Fri, 18 Dec 2015 20:06:56 +0000"  >&lt;p&gt;Very good... if they ever answer, please tell us here &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="15066725" author="mamboman" created="Mon, 21 Dec 2015 17:17:38 +0000"  >&lt;p&gt;Qoppa really answered. They check whether to support both forms (&quot;IT&quot; and &quot;intent&quot;) inside the XFDF.&lt;br/&gt;
Why? Acrobat 9, 11 and even DC not only write &quot;IT&quot; instead of &quot;intent&quot; when producing XFDF - and they want to be compatible with Acrobat (I can understand that point). Even more: when reading XFDF Acrobat ignores &quot;intent&quot;.&lt;br/&gt;
Happy to see that the owner of a spec does not comply to it &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;So thanks for implementing handling of both attributes to be flexible at this point.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12777717" name="Multipage_Sample_annots_cloud.xfdf" size="734" author="mamboman" created="Tue, 15 Dec 2015 10:22:07 +0000"/>
                            <attachment id="12777696" name="Multipage_Sample_annots_freetext_OK_PDFBox.pdf" size="37049" author="tilman" created="Tue, 15 Dec 2015 08:24:58 +0000"/>
                            <attachment id="12777608" name="Multipage_Sample_annots_ink_ok_PDFBOX.pdf" size="41542" author="tilman" created="Mon, 14 Dec 2015 23:12:27 +0000"/>
                            <attachment id="12778334" name="Multipage_Sample_annots_legend_OK_PDFBox.pdf" size="37244" author="tilman" created="Thu, 17 Dec 2015 20:40:06 +0000"/>
                            <attachment id="12777614" name="Multipage_Sample_annots_polygon_OK_pdfbox.pdf" size="37023" author="tilman" created="Mon, 14 Dec 2015 23:36:20 +0000"/>
                            <attachment id="12777592" name="XFDFStamper.java" size="3432" author="mamboman" created="Mon, 14 Dec 2015 21:54:56 +0000"/>
                            <attachment id="12777596" name="samples.zip" size="296344" author="mamboman" created="Mon, 14 Dec 2015 22:00:27 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>7.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 47 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2pvmf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>