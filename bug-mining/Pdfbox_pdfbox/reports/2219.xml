<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:09:23 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PDFBOX-4492] JVM crashes on PDFRenderer.renderImage</title>
                <link>https://issues.apache.org/jira/browse/PDFBOX-4492</link>
                <project id="12310760" key="PDFBOX">PDFBox</project>
                    <description>&lt;p&gt;When running the following&#160;java program on&#160;the attached PDF:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&#160;File file = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; File(&lt;span class=&quot;code-quote&quot;&gt;&quot;/Users/yujiang/Downloads&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;crash.uploaded.pdf&quot;&lt;/span&gt;);
PDDocument document = PDDocument.load(file);
PDFRenderer renderer = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; PDFRenderer(document);
BufferedImage bufferedImage = renderer.renderImage(0, 0.20F);&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;JVM will crash without any log&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment>Oracle Java 8 update125, on both Mac OS X and centos.&lt;br/&gt;
Also Oracle jdk 1.8.0_202 on W10.</environment>
        <key id="13223256">PDFBOX-4492</key>
            <summary>JVM crashes on PDFRenderer.renderImage</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tilman">Tilman Hausherr</assignee>
                                    <reporter username="jiangyurong609">Jack</reporter>
                        <labels>
                            <label>crash</label>
                    </labels>
                <created>Fri, 22 Mar 2019 05:51:17 +0000</created>
                <updated>Fri, 12 Apr 2019 14:39:49 +0000</updated>
                            <resolved>Wed, 27 Mar 2019 18:25:46 +0000</resolved>
                                    <version>2.0.11</version>
                    <version>2.0.14</version>
                                    <fixVersion>2.0.15</fixVersion>
                    <fixVersion>3.0.0 PDFBox</fixVersion>
                                    <component>Rendering</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="16798788" author="tilman" created="Fri, 22 Mar 2019 07:19:53 +0000"  >&lt;p&gt;Happens also with the command line utility when using PDFToImage with dpi between 11 and 17 (included). Could be related to &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2373&quot; title=&quot;Rendering at 72 dpi crashes java&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2373&quot;&gt;&lt;del&gt;PDFBOX-2373&lt;/del&gt;&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2929&quot; title=&quot;&amp;quot;Illegal instruction: 4&amp;quot; with PDFToImage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2929&quot;&gt;&lt;del&gt;PDFBOX-2929&lt;/del&gt;&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3204&quot; title=&quot;JVM crashes on PDFRenderer.renderImageWithDPI&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3204&quot;&gt;&lt;del&gt;PDFBOX-3204&lt;/del&gt;&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3813&quot; title=&quot;PDF Box crash when using PDFToImage or PDFDebug&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3813&quot;&gt;&lt;del&gt;PDFBOX-3813&lt;/del&gt;&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3724&quot; title=&quot;Wrong size in rendering of some artifacts&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3724&quot;&gt;&lt;del&gt;PDFBOX-3724&lt;/del&gt;&lt;/a&gt; but I haven&apos;t tested that yet.&lt;/p&gt;</comment>
                            <comment id="16799046" author="jiangyurong609" created="Fri, 22 Mar 2019 14:09:45 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; thanks for taking a look. It maybe different. I debugged through. It crashed inside processStreamOperators (PDFStreamEngine) with while loop round&#160;17004&#160;during parsing object&#160;COSInt{0}. Sometimes it crashes immediately after if condition, sometimes it crashes in&#160;parseNextToken.&#160;&#160;&lt;/p&gt;

&lt;p&gt;Thanks&lt;/p&gt;</comment>
                            <comment id="16799221" author="tilman" created="Fri, 22 Mar 2019 17:56:12 +0000"  >&lt;p&gt;From my observation it crashed in &lt;tt&gt;graphics.draw()&lt;/tt&gt;. However I trired with different java versions:&lt;/p&gt;

&lt;p&gt;jdk12: works&lt;br/&gt;
jdk11: works&lt;br/&gt;
corretto (1.8.0_202): RasterFormatException&lt;br/&gt;
jdk10: works&lt;br/&gt;
jdk9: works&lt;/p&gt;

&lt;p&gt;So you could just update and it would work fine.&lt;/p&gt;</comment>
                            <comment id="16799224" author="tilman" created="Fri, 22 Mar 2019 17:59:09 +0000"  >&lt;p&gt;Your PDF has a dash array that has a 0 item. This is poorly handled in jdk8 which is why PDFBox replaces it with a small number, currently &lt;tt&gt;0.062f&lt;/tt&gt;. So I tried reverting the change from &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3724&quot; title=&quot;Wrong size in rendering of some artifacts&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3724&quot;&gt;&lt;del&gt;PDFBOX-3724&lt;/del&gt;&lt;/a&gt; - the bug is there with jdk7 and 8; with jdk9 the line is invisible (also wrong), and from jdk10 on it is displayed properly.&lt;/p&gt;</comment>
                            <comment id="16799227" author="jiangyurong609" created="Fri, 22 Mar 2019 18:02:56 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; thanks for the information. anyway we can play around jdk 8?&lt;/p&gt;</comment>
                            <comment id="16799266" author="tilman" created="Fri, 22 Mar 2019 18:55:27 +0000"  >&lt;p&gt;I assume this means you want to keep jdk8. I need to think a bit about this... I got your file to work at 11dpi by using a minimum dash value of &lt;tt&gt;0.2f&lt;/tt&gt; instead of &lt;tt&gt;0.062f&lt;/tt&gt;. However this also changes valid files when rendered at normal resolution where details are more important (I assume you&apos;re doing thumbnails, so small difference are not important). I think that this value should be depending on the current dpi, i.e. be that large only for these and not on normal resolutions. And then retry with all the previous jvm crash inducing files.&lt;/p&gt;</comment>
                            <comment id="16799313" author="jiangyurong609" created="Fri, 22 Mar 2019 19:59:40 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; I see, so your suggestion is to customize minimum dash value depends on requirement?&lt;/p&gt;</comment>
                            <comment id="16799319" author="tilman" created="Fri, 22 Mar 2019 20:11:37 +0000"  >&lt;p&gt;You don&apos;t have to change anything. This will be done in PDFBox, i.e. that the dash value will be changed on the fly so that it doesn&apos;t get too small.&lt;/p&gt;

&lt;p&gt;My current idea is to use&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Matrix m = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Matrix(xform);
&#8230;.

     dashArray[i] = &lt;span class=&quot;code-object&quot;&gt;Math&lt;/span&gt;.max(w, 0.03f / m.getScalingFactorX());
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;But I need to run all the tests first.&lt;/p&gt;</comment>
                            <comment id="16799366" author="jiangyurong609" created="Fri, 22 Mar 2019 21:22:07 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; thanks for the update. Would love to hear back the update.&#160;Are you going to test all the legacy problematic files?&#160;&lt;/p&gt;</comment>
                            <comment id="16799528" author="tilman" created="Sat, 23 Mar 2019 04:44:48 +0000"  >&lt;p&gt;Yes I did, and it crashed. It even crashed at 72dpi. I thought that I could make this relative to the xform to avoid troubles at &quot;normal&quot; dpi but seems it ain&apos;t so.&lt;/p&gt;

&lt;p&gt;Why did you delete your file? It doesn&apos;t seem to be confidential, it&apos;s just some text about a congress about saving the environment and such.&lt;/p&gt;</comment>
                            <comment id="16799532" author="jiangyurong609" created="Sat, 23 Mar 2019 05:01:52 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt;&#160;Thanks so much for the help and effort. That&apos;s sounds&#160;pessimistic.&#160;&lt;/p&gt;

&lt;p&gt;sorry, I uploaded again, but we&apos;ll have to delete the file since we&#160;don&apos;t own it.&#160;&lt;/p&gt;</comment>
                            <comment id="16799534" author="jira-bot" created="Sat, 23 Mar 2019 05:10:04 +0000"  >&lt;p&gt;Commit 1856104 from Tilman Hausherr in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1856104&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1856104&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4492&quot; title=&quot;JVM crashes on PDFRenderer.renderImage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4492&quot;&gt;&lt;del&gt;PDFBOX-4492&lt;/del&gt;&lt;/a&gt;: use higher max value for dash segment length on low resolution to prevent jvm crash on jdk8; rearrange comments to proper place&lt;/p&gt;</comment>
                            <comment id="16799535" author="jira-bot" created="Sat, 23 Mar 2019 05:10:10 +0000"  >&lt;p&gt;Commit 1856105 from Tilman Hausherr in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1856105&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1856105&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4492&quot; title=&quot;JVM crashes on PDFRenderer.renderImage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4492&quot;&gt;&lt;del&gt;PDFBOX-4492&lt;/del&gt;&lt;/a&gt;: use higher max value for dash segment length on low resolution to prevent jvm crash on jdk8; rearrange comments to proper place&lt;/p&gt;</comment>
                            <comment id="16799544" author="tilman" created="Sat, 23 Mar 2019 05:44:03 +0000"  >&lt;p&gt;Snapshot here:&lt;br/&gt;
&lt;a href=&quot;https://repository.apache.org/content/groups/snapshots/org/apache/pdfbox/pdfbox-app/2.0.15-SNAPSHOT/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://repository.apache.org/content/groups/snapshots/org/apache/pdfbox/pdfbox-app/2.0.15-SNAPSHOT/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I still need to do more tests.&lt;/p&gt;</comment>
                            <comment id="16799554" author="jiangyurong609" created="Sat, 23 Mar 2019 06:18:40 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; thanks so much for the help&lt;/p&gt;</comment>
                            <comment id="16803086" author="jira-bot" created="Wed, 27 Mar 2019 17:14:30 +0000"  >&lt;p&gt;Commit 1856424 from Tilman Hausherr in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1856424&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1856424&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4492&quot; title=&quot;JVM crashes on PDFRenderer.renderImage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4492&quot;&gt;&lt;del&gt;PDFBOX-4492&lt;/del&gt;&lt;/a&gt;: refactor&lt;/p&gt;</comment>
                            <comment id="16803087" author="jira-bot" created="Wed, 27 Mar 2019 17:14:35 +0000"  >&lt;p&gt;Commit 1856425 from Tilman Hausherr in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1856425&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1856425&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4492&quot; title=&quot;JVM crashes on PDFRenderer.renderImage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4492&quot;&gt;&lt;del&gt;PDFBOX-4492&lt;/del&gt;&lt;/a&gt;: refactor&lt;/p&gt;</comment>
                            <comment id="16803092" author="jira-bot" created="Wed, 27 Mar 2019 17:17:59 +0000"  >&lt;p&gt;Commit 1856426 from Tilman Hausherr in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1856426&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1856426&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4492&quot; title=&quot;JVM crashes on PDFRenderer.renderImage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4492&quot;&gt;&lt;del&gt;PDFBOX-4492&lt;/del&gt;&lt;/a&gt;: get jdk version&lt;/p&gt;</comment>
                            <comment id="16803093" author="jira-bot" created="Wed, 27 Mar 2019 17:18:04 +0000"  >&lt;p&gt;Commit 1856427 from Tilman Hausherr in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1856427&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1856427&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4492&quot; title=&quot;JVM crashes on PDFRenderer.renderImage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4492&quot;&gt;&lt;del&gt;PDFBOX-4492&lt;/del&gt;&lt;/a&gt;: get jdk version&lt;/p&gt;</comment>
                            <comment id="16803139" author="jira-bot" created="Wed, 27 Mar 2019 17:52:50 +0000"  >&lt;p&gt;Commit 1856428 from Tilman Hausherr in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1856428&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1856428&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4492&quot; title=&quot;JVM crashes on PDFRenderer.renderImage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4492&quot;&gt;&lt;del&gt;PDFBOX-4492&lt;/del&gt;&lt;/a&gt;: dash workarounds no longer needed on java 10&lt;/p&gt;</comment>
                            <comment id="16803140" author="jira-bot" created="Wed, 27 Mar 2019 17:52:55 +0000"  >&lt;p&gt;Commit 1856429 from Tilman Hausherr in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1856429&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1856429&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4492&quot; title=&quot;JVM crashes on PDFRenderer.renderImage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4492&quot;&gt;&lt;del&gt;PDFBOX-4492&lt;/del&gt;&lt;/a&gt;: dash workarounds no longer needed on java 10&lt;/p&gt;</comment>
                            <comment id="16803175" author="tilman" created="Wed, 27 Mar 2019 18:18:13 +0000"  >&lt;p&gt;Base on my tests 5 days ago, I have disabled the dash workarounds starting with jdk10.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310250" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10431"><![CDATA[Important]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 33 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z00z8o:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>