<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 20:57:27 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PDFBOX-2184] CMMException: Invalid profile data</title>
                <link>https://issues.apache.org/jira/browse/PDFBOX-2184</link>
                <project id="12310760" key="PDFBOX">PDFBox</project>
                    <description>&lt;p&gt;Jenkins builds are intermittently failing with the error:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;java.awt.color.CMMException: Invalid profile data
	at sun.awt.color.CMM.checkStatus(CMM.java:131)
	at sun.awt.color.ICC_Transform.&amp;lt;init&amp;gt;(ICC_Transform.java:88)
	at java.awt.color.ICC_ColorSpace.toRGB(ICC_ColorSpace.java:144)
	at org.apache.pdfbox.pdmodel.graphics.color.PDDeviceRGB.toRGB(PDDeviceRGB.java:79)
	at org.apache.pdfbox.pdmodel.graphics.color.PDColorSpace.toPaint(PDColorSpace.java:255)
	at org.apache.pdfbox.rendering.PageDrawer.getNonStrokingPaint(PageDrawer.java:666)
	at org.apache.pdfbox.rendering.PageDrawer.fillPath(PageDrawer.java:739)
	at org.apache.pdfbox.util.&lt;span class=&quot;code-keyword&quot;&gt;operator&lt;/span&gt;.pagedrawer.FillNonZeroRule.process(FillNonZeroRule.java:37)
	at org.apache.pdfbox.util.PDFStreamEngine.processOperator(PDFStreamEngine.java:488)
	at org.apache.pdfbox.util.PDFStreamEngine.processSubStream(PDFStreamEngine.java:254)
	at org.apache.pdfbox.util.PDFStreamEngine.processSubStream(PDFStreamEngine.java:221)
	at org.apache.pdfbox.util.&lt;span class=&quot;code-keyword&quot;&gt;operator&lt;/span&gt;.pagedrawer.Invoke.process(Invoke.java:130)
	at org.apache.pdfbox.util.PDFStreamEngine.processOperator(PDFStreamEngine.java:488)
	at org.apache.pdfbox.util.PDFStreamEngine.processSubStream(PDFStreamEngine.java:254)
	at org.apache.pdfbox.util.PDFStreamEngine.processSubStream(PDFStreamEngine.java:221)
	at org.apache.pdfbox.util.PDFStreamEngine.processStream(PDFStreamEngine.java:197)
	at org.apache.pdfbox.rendering.PageDrawer.drawPage(PageDrawer.java:183)
	at org.apache.pdfbox.rendering.PDFRenderer.renderPage(PDFRenderer.java:228)
	at org.apache.pdfbox.rendering.PDFRenderer.renderImage(PDFRenderer.java:160)
	at org.apache.pdfbox.rendering.PDFRenderer.renderImage(PDFRenderer.java:83)
	at org.apache.pdfbox.rendering.PDFRenderer.renderImage(PDFRenderer.java:70)
	at org.apache.pdfbox.util.TestRendering.render(TestRendering.java:78)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12725415">PDFBOX-2184</key>
            <summary>CMMException: Invalid profile data</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jahewson">John Hewson</assignee>
                                    <reporter username="jahewson">John Hewson</reporter>
                        <labels>
                    </labels>
                <created>Fri, 4 Jul 2014 03:41:00 +0000</created>
                <updated>Thu, 17 Mar 2016 19:08:16 +0000</updated>
                            <resolved>Tue, 11 Aug 2015 00:20:56 +0000</resolved>
                                    <version>2.0.0</version>
                                    <fixVersion>2.0.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="14052137" author="jahewson" created="Fri, 4 Jul 2014 03:44:00 +0000"  >&lt;p&gt;I have a theory that this is an OpenJDK 6 bug which is affecting this test because it is multithreaded. I&apos;ve altered the test runner in &lt;a href=&quot;http://svn.apache.org/r1607783&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;r1607783&lt;/a&gt; to see if the issue goes away.&lt;/p&gt;</comment>
                            <comment id="14055800" author="jahewson" created="Wed, 9 Jul 2014 03:06:40 +0000"  >&lt;p&gt;Actually it looks like Jenkins is running the Sun JDK:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;JDK: Java(TM) SE &lt;span class=&quot;code-object&quot;&gt;Runtime&lt;/span&gt; Environment
Version: 1.6
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14055803" author="jahewson" created="Wed, 9 Jul 2014 03:11:16 +0000"  >&lt;p&gt;Still seeing this problem: &lt;a href=&quot;https://builds.apache.org/job/PDFBox-trunk/1124/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PDFBox-trunk/1124/&lt;/a&gt;&lt;br/&gt;
and &lt;a href=&quot;https://builds.apache.org/job/PDFBox-trunk/1127/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PDFBox-trunk/1127/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14085241" author="jahewson" created="Mon, 4 Aug 2014 20:28:40 +0000"  >&lt;p&gt;Still problems in the trunk, even with the Travis build:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Running org.apache.pdfbox.util.TestRendering
JDK: Java(TM) SE &lt;span class=&quot;code-object&quot;&gt;Runtime&lt;/span&gt; Environment
Version: 1.7
Tests run: 9, Failures: 0, Errors: 1, Skipped: 0, Time elapsed: 3.076 sec &amp;lt;&amp;lt;&amp;lt; FAILURE! - in org.apache.pdfbox.util.TestRendering
render[4PP-Highlighting.pdf](org.apache.pdfbox.util.TestRendering)  Time elapsed: 0.68 sec  &amp;lt;&amp;lt;&amp;lt; ERROR!
java.awt.color.CMMException: Invalid profile data
	at sun.java2d.cmm.kcms.CMM.checkStatus(CMM.java:180)
	at sun.java2d.cmm.kcms.CMM.createTransform(CMM.java:134)
	at java.awt.color.ICC_ColorSpace.toRGB(ICC_ColorSpace.java:166)
	at org.apache.pdfbox.pdmodel.graphics.color.PDDeviceRGB.toRGB(PDDeviceRGB.java:79)
	at org.apache.pdfbox.pdmodel.graphics.color.PDColorSpace.toPaint(PDColorSpace.java:260)
	at org.apache.pdfbox.rendering.PageDrawer.getNonStrokingPaint(PageDrawer.java:663)
	at org.apache.pdfbox.rendering.PageDrawer.fillPath(PageDrawer.java:726)
	at org.apache.pdfbox.util.&lt;span class=&quot;code-keyword&quot;&gt;operator&lt;/span&gt;.graphics.FillNonZeroRule.process(FillNonZeroRule.java:36)
	at org.apache.pdfbox.util.PDFStreamEngine.processOperator(PDFStreamEngine.java:564)
	at org.apache.pdfbox.util.PDFStreamEngine.processSubStream(PDFStreamEngine.java:268)
	at org.apache.pdfbox.util.PDFStreamEngine.processSubStream(PDFStreamEngine.java:235)
	at org.apache.pdfbox.util.PDFStreamEngine.showForm(PDFStreamEngine.java:200)
	at org.apache.pdfbox.util.&lt;span class=&quot;code-keyword&quot;&gt;operator&lt;/span&gt;.graphics.DrawObject.process(DrawObject.java:104)
	at org.apache.pdfbox.util.PDFStreamEngine.processOperator(PDFStreamEngine.java:564)
	at org.apache.pdfbox.util.PDFStreamEngine.processSubStream(PDFStreamEngine.java:268)
	at org.apache.pdfbox.util.PDFStreamEngine.processSubStream(PDFStreamEngine.java:235)
	at org.apache.pdfbox.util.PDFStreamEngine.processStream(PDFStreamEngine.java:189)
	at org.apache.pdfbox.rendering.PageDrawer.drawPage(PageDrawer.java:170)
	at org.apache.pdfbox.rendering.PDFRenderer.renderPage(PDFRenderer.java:228)
	at org.apache.pdfbox.rendering.PDFRenderer.renderImage(PDFRenderer.java:160)
	at org.apache.pdfbox.rendering.PDFRenderer.renderImage(PDFRenderer.java:83)
	at org.apache.pdfbox.rendering.PDFRenderer.renderImage(PDFRenderer.java:70)
	at org.apache.pdfbox.util.TestRendering.render(TestRendering.java:78)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;See &lt;a href=&quot;https://travis-ci.org/apache/pdfbox/jobs/31650266&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://travis-ci.org/apache/pdfbox/jobs/31650266&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14116589" author="jira-bot" created="Sun, 31 Aug 2014 01:10:58 +0000"  >&lt;p&gt;Commit 1621550 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jahewson&quot; class=&quot;user-hover&quot; rel=&quot;jahewson&quot;&gt;jahewson&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1621550&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1621550&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2184&quot; title=&quot;CMMException: Invalid profile data&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2184&quot;&gt;&lt;del&gt;PDFBOX-2184&lt;/del&gt;&lt;/a&gt;: Attempt to workaround JVM bug&lt;/p&gt;</comment>
                            <comment id="14116590" author="jahewson" created="Sun, 31 Aug 2014 01:11:04 +0000"  >&lt;p&gt;I have a new theory, this could be a race condition in Java&apos;s CMM code caused by lazy initialisation, which would explain why we don&apos;t get an error until toRGB is called. The Open JDK code for &lt;a href=&quot;http://www.docjar.com/html/api/java/awt/color/ICC_ColorSpace.java.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;ICC_ColorSpace.java&lt;/a&gt; clearly uses lazy initialisation of the color transform object:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt; 159       &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;float&lt;/span&gt;[]    toRGB (&lt;span class=&quot;code-object&quot;&gt;float&lt;/span&gt;[] colorvalue) {
  160   
  161           &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (this2srgb == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
  162               ColorTransform[] transformList = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ColorTransform [2];
  163               ICC_ColorSpace srgbCS =
  164                   (ICC_ColorSpace) ColorSpace.getInstance (CS_sRGB);
  165               PCMM mdl = CMSManager.getModule();
  166               transformList[0] = mdl.createTransform(
  167                   thisProfile, ColorTransform.Any, ColorTransform.In);
  168               transformList[1] = mdl.createTransform(
  169                   srgbCS.getProfile(), ColorTransform.Any, ColorTransform.Out);
  170               this2srgb = mdl.createTransform(transformList);
  171               &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (needScaleInit) {
  172                   setComponentScaling();
  173               }
  174           }
  175           ...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I&apos;ve added a call to toRGB in the constructor of PDDeviceCMYK() which is called statically and so will be thread safe. Hopefully this will prevent the race condition because it will cause &quot;this2srgb&quot; to be initialised.&lt;/p&gt;</comment>
                            <comment id="14116607" author="jira-bot" created="Sun, 31 Aug 2014 02:34:42 +0000"  >&lt;p&gt;Commit 1621556 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jahewson&quot; class=&quot;user-hover&quot; rel=&quot;jahewson&quot;&gt;jahewson&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1621556&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1621556&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2184&quot; title=&quot;CMMException: Invalid profile data&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2184&quot;&gt;&lt;del&gt;PDFBOX-2184&lt;/del&gt;&lt;/a&gt;: Attempt to workaround JVM bug (RGB)&lt;/p&gt;</comment>
                            <comment id="14116608" author="jahewson" created="Sun, 31 Aug 2014 02:35:13 +0000"  >&lt;p&gt;I added this for PDDeviceRGB too.&lt;/p&gt;</comment>
                            <comment id="14116617" author="jira-bot" created="Sun, 31 Aug 2014 03:35:38 +0000"  >&lt;p&gt;Commit 1621558 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jahewson&quot; class=&quot;user-hover&quot; rel=&quot;jahewson&quot;&gt;jahewson&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1621558&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1621558&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2184&quot; title=&quot;CMMException: Invalid profile data&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2184&quot;&gt;&lt;del&gt;PDFBOX-2184&lt;/del&gt;&lt;/a&gt;: Initialize ColorSpace before using it&lt;/p&gt;</comment>
                            <comment id="14121603" author="jahewson" created="Thu, 4 Sep 2014 17:27:49 +0000"  >&lt;p&gt;We&apos;ve had 12 successful Jenkins and Travis builds in a row since I made the last fix, which is almost unheard of recently. I&apos;m going to declare victory and resolve this issue as fixed.&lt;/p&gt;</comment>
                            <comment id="14124609" author="jira-bot" created="Sat, 6 Sep 2014 19:26:43 +0000"  >&lt;p&gt;Commit 1622916 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jahewson&quot; class=&quot;user-hover&quot; rel=&quot;jahewson&quot;&gt;jahewson&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1622916&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1622916&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2184&quot; title=&quot;CMMException: Invalid profile data&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2184&quot;&gt;&lt;del&gt;PDFBOX-2184&lt;/del&gt;&lt;/a&gt;: Allow PDDeviceCMYK singleton to be overridden&lt;/p&gt;</comment>
                            <comment id="14139453" author="jira-bot" created="Thu, 18 Sep 2014 20:31:45 +0000"  >&lt;p&gt;Commit 1626081 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jahewson&quot; class=&quot;user-hover&quot; rel=&quot;jahewson&quot;&gt;jahewson&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1626081&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1626081&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2184&quot; title=&quot;CMMException: Invalid profile data&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2184&quot;&gt;&lt;del&gt;PDFBOX-2184&lt;/del&gt;&lt;/a&gt;: Allow PDDeviceCMYK to be subclassed&lt;/p&gt;</comment>
                            <comment id="14500664" author="jira-bot" created="Fri, 17 Apr 2015 21:04:05 +0000"  >&lt;p&gt;Commit 1674402 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1674402&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1674402&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2184&quot; title=&quot;CMMException: Invalid profile data&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2184&quot;&gt;&lt;del&gt;PDFBOX-2184&lt;/del&gt;&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2576&quot; title=&quot;Improve code quality&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2576&quot;&gt;&lt;del&gt;PDFBOX-2576&lt;/del&gt;&lt;/a&gt;: sort imports&lt;/p&gt;</comment>
                            <comment id="14516760" author="lehmi" created="Tue, 28 Apr 2015 10:14:25 +0000"  >&lt;p&gt;I&apos;m afraid the issue still persists. It doesn&apos;t occur every build, but from time to time ...&lt;/p&gt;

&lt;p&gt;Jenkins&lt;br/&gt;
&lt;a href=&quot;https://builds.apache.org/view/All/job/PDFBox-trunk/2031/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;2031&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;https://builds.apache.org/view/All/job/PDFBox-trunk/2023/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;2023&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;https://builds.apache.org/view/All/job/PDFBox-trunk/2019/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;2019&lt;/a&gt;&lt;br/&gt;
....&lt;/p&gt;

&lt;p&gt;Travis&lt;br/&gt;
&lt;a href=&quot;https://travis-ci.org/apache/pdfbox/jobs/60275265&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;2157.1&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;https://travis-ci.org/apache/pdfbox/jobs/60267592&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;2156.1&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;https://travis-ci.org/apache/pdfbox/jobs/60267593&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;2156.2&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;https://travis-ci.org/apache/pdfbox/jobs/60254280&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;2154.1&lt;/a&gt;&lt;br/&gt;
....&lt;/p&gt;</comment>
                            <comment id="14516792" author="tilman" created="Tue, 28 Apr 2015 10:44:34 +0000"  >&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    &lt;span class=&quot;code-comment&quot;&gt;/**  This is the single instance of &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; class. */&lt;/span&gt;
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; PDDeviceRGB INSTANCE = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; PDDeviceRGB();

    &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; ColorSpace colorSpaceRGB = ColorSpace.getInstance(ColorSpace.CS_sRGB);
    &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; PDColor initialColor = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; PDColor(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;float&lt;/span&gt;[] { 0, 0, 0 }, &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;);

    &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; PDDeviceRGB()
    {
        &lt;span class=&quot;code-comment&quot;&gt;// there is a JVM bug which results in a CMMException which appears to be a race
&lt;/span&gt;        &lt;span class=&quot;code-comment&quot;&gt;// condition caused by lazy initialization of the color transform, so we perform
&lt;/span&gt;        &lt;span class=&quot;code-comment&quot;&gt;// an initial color conversion &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; we&apos;re still in a &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; context, see PDFBOX-2184
&lt;/span&gt;        colorSpaceRGB.toRGB(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;float&lt;/span&gt;[]{0, 0, 0});
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;I wonder why colorSpaceRGB isn&apos;t static?&lt;/p&gt;</comment>
                            <comment id="14518404" author="jahewson" created="Wed, 29 Apr 2015 00:09:55 +0000"  >&lt;p&gt;Yep, this issue disappeared for a while but is now back with a vengeance.&lt;/p&gt;</comment>
                            <comment id="14518421" author="jahewson" created="Wed, 29 Apr 2015 00:19:03 +0000"  >&lt;p&gt;Dunno, I see no reason not to have it as static. It might help?&lt;/p&gt;</comment>
                            <comment id="14518794" author="jira-bot" created="Wed, 29 Apr 2015 06:06:33 +0000"  >&lt;p&gt;Commit 1676673 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1676673&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1676673&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2184&quot; title=&quot;CMMException: Invalid profile data&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2184&quot;&gt;&lt;del&gt;PDFBOX-2184&lt;/del&gt;&lt;/a&gt;: make colorSpaceRGB static&lt;/p&gt;</comment>
                            <comment id="14518802" author="tilman" created="Wed, 29 Apr 2015 06:13:52 +0000"  >&lt;p&gt;Ok, lets try... btw there is a weird comment in the java source code of ColorSpace.getInstance:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    /**
     * Returns a ColorSpace representing one of the specific
     * predefined color spaces.
     * @param colorspace a specific color space identified by one of
     *        the predefined &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;constants (e.g. CS_sRGB, CS_LINEAR_RGB,
     *        CS_CIEXYZ, CS_GRAY, or CS_PYCC)
     * @&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; the requested &amp;lt;CODE&amp;gt;ColorSpace&amp;lt;/CODE&amp;gt; object
     */
    &lt;span class=&quot;code-comment&quot;&gt;// NOTE: This method may be called by privileged threads.
&lt;/span&gt;    &lt;span class=&quot;code-comment&quot;&gt;//       DO NOT INVOKE CLIENT CODE ON THIS THREAD!
&lt;/span&gt;    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; ColorSpace getInstance (&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; colorspace)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14520021" author="jira-bot" created="Wed, 29 Apr 2015 19:29:17 +0000"  >&lt;p&gt;Commit 1676835 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1676835&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1676835&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2184&quot; title=&quot;CMMException: Invalid profile data&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2184&quot;&gt;&lt;del&gt;PDFBOX-2184&lt;/del&gt;&lt;/a&gt;: revert last change, as it hasn&apos;t helped.&lt;/p&gt;</comment>
                            <comment id="14520100" author="lehmi" created="Wed, 29 Apr 2015 20:02:03 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; Why did you revert the change, The recent build issue seems to be unrelated? Do you have some local issues?&lt;/p&gt;</comment>
                            <comment id="14520109" author="tilman" created="Wed, 29 Apr 2015 20:06:47 +0000"  >&lt;p&gt;Oops, you are right, this is a different problem (that hopefully won&apos;t stay), but I already saw on travis this morning that the change didn&apos;t help, so I thought I&apos;d just revert.&lt;br/&gt;
&lt;a href=&quot;https://travis-ci.org/apache/pdfbox/builds&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://travis-ci.org/apache/pdfbox/builds&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14520679" author="jahewson" created="Thu, 30 Apr 2015 01:34:06 +0000"  >&lt;p&gt;I think that&apos;s a note to other JVM authors that getInstance must not call back into any client code.&lt;/p&gt;</comment>
                            <comment id="14521007" author="lehmi" created="Thu, 30 Apr 2015 06:57:57 +0000"  >&lt;p&gt;I didn&apos;t check travis. Unfortunately you&apos;re right &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="14592895" author="jira-bot" created="Fri, 19 Jun 2015 02:27:52 +0000"  >&lt;p&gt;Commit 1686346 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jahewson&quot; class=&quot;user-hover&quot; rel=&quot;jahewson&quot;&gt;jahewson&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1686346&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1686346&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2184&quot; title=&quot;CMMException: Invalid profile data&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2184&quot;&gt;&lt;del&gt;PDFBOX-2184&lt;/del&gt;&lt;/a&gt;: Lazy load the CMYK ICC profile&lt;/p&gt;</comment>
                            <comment id="14592897" author="jahewson" created="Fri, 19 Jun 2015 02:29:24 +0000"  >&lt;p&gt;This may or may not help - if this commit proves to be stable we should be able to try the same strategy with PDDeviceRGB. Either way by lazily loading the CMYK profile we shave 1400ms off PDFBox&apos;s loading time.&lt;/p&gt;</comment>
                            <comment id="14614847" author="lehmi" created="Mon, 6 Jul 2015 10:38:53 +0000"  >&lt;p&gt;Having a look at the current build logs I came to the following conclusions:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;only jdk 6 seems to be affected as the 1.7 jenkins job doesn&apos;t show those exceptions&lt;/li&gt;
	&lt;li&gt;Johns last approach seems to work, as PDDeviceCMYK doesn&apos;t seem to fail anymore&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14616197" author="jahewson" created="Tue, 7 Jul 2015 05:21:58 +0000"  >&lt;p&gt;Finally! &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="14616297" author="lehmi" created="Tue, 7 Jul 2015 07:07:22 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jahewson&quot; class=&quot;user-hover&quot; rel=&quot;jahewson&quot;&gt;jahewson&lt;/a&gt; Do you port those changes to PDDeviceRGB as well?&lt;/p&gt;</comment>
                            <comment id="14681000" author="jira-bot" created="Tue, 11 Aug 2015 00:20:38 +0000"  >&lt;p&gt;Commit 1695184 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jahewson&quot; class=&quot;user-hover&quot; rel=&quot;jahewson&quot;&gt;jahewson&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1695184&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1695184&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2184&quot; title=&quot;CMMException: Invalid profile data&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2184&quot;&gt;&lt;del&gt;PDFBOX-2184&lt;/del&gt;&lt;/a&gt;: Lazy setting of the AWT color space for RGB&lt;/p&gt;</comment>
                            <comment id="14681001" author="jahewson" created="Tue, 11 Aug 2015 00:20:50 +0000"  >&lt;p&gt;I have now!&lt;/p&gt;</comment>
                            <comment id="14681002" author="jahewson" created="Tue, 11 Aug 2015 00:21:16 +0000"  >&lt;p&gt;Ported above mentioned PDDeviceCMYK change.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>403575</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 14 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1xgjb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>403619</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>