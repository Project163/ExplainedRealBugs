<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 20:55:04 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PDFBOX-1876] Incorrect color for DeviceN type 4 shading object</title>
                <link>https://issues.apache.org/jira/browse/PDFBOX-1876</link>
                <project id="12310760" key="PDFBOX">PDFBox</project>
                    <description>&lt;p&gt;Thanks to the fix in pdfbox-1442, I was able to get the ch14.pdf file rendered. However the colors are incorrect. On page 13, the colors black and red in the triangle are switched. (The same error is on page 1, 15 and 20 but these take forever to render). I suspect a bug in the shadingTinttransform.eval() function.&lt;/p&gt;

&lt;p&gt;I don&apos;t think its a bug in the shading interpolation code, because then there would have been lots of visible triangles in the spheres and donuts on the other pages where its not just a single triangle.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12692736">PDFBOX-1876</key>
            <summary>Incorrect color for DeviceN type 4 shading object</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tilman">Tilman Hausherr</assignee>
                                    <reporter username="tilman">Tilman Hausherr</reporter>
                        <labels>
                    </labels>
                <created>Sun, 2 Feb 2014 19:45:23 +0000</created>
                <updated>Fri, 2 May 2014 06:12:05 +0000</updated>
                            <resolved>Wed, 5 Mar 2014 20:42:04 +0000</resolved>
                                    <version>1.8.4</version>
                    <version>2.0.0</version>
                                    <fixVersion>1.8.5</fixVersion>
                    <fixVersion>2.0.0</fixVersion>
                                    <component>Rendering</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="13889320" author="jahewson" created="Mon, 3 Feb 2014 08:47:59 +0000"  >&lt;p&gt;DeviceN color spaces are currently mostly broken. I have a big fix on the way for them very soon.&lt;/p&gt;</comment>
                            <comment id="13907244" author="jahewson" created="Thu, 20 Feb 2014 17:55:01 +0000"  >&lt;p&gt;The changes in &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-1893&quot; title=&quot;Refactor color spaces&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-1893&quot;&gt;&lt;del&gt;PDFBOX-1893&lt;/del&gt;&lt;/a&gt; haven&apos;t fixed this, so I think it&apos;s a shading issue rather than a color space issue.&lt;/p&gt;</comment>
                            <comment id="13907360" author="tilman" created="Thu, 20 Feb 2014 19:22:51 +0000"  >&lt;p&gt;If this is a shading issue, why are all the other type 3 and 4 test cases ok? You know more about DeviceN than me - if you have the time, please look at the colors for page 13, use the debug output to see the corner colors, convert them to RGB. (in GouraudShadingContext.readVertex().&lt;/p&gt;</comment>
                            <comment id="13908056" author="jahewson" created="Fri, 21 Feb 2014 07:14:24 +0000"  >&lt;p&gt;&lt;del&gt;The colors are fine, the shading is the problem here&lt;/del&gt;, look at p13 for example, it&apos;s clear that the vertices of the triangle are being shaded with the correct colors but in the wrong order.&lt;/p&gt;</comment>
                            <comment id="13908508" author="tilman" created="Fri, 21 Feb 2014 16:46:55 +0000"  >&lt;p&gt;Here&apos;s a PDF file with DeviceN that doesn&apos;t use shading, but the colors are not rendered correctly. I have also attached the postscript file because it is easily readable. I hope that this proves my argument &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13908629" author="jahewson" created="Fri, 21 Feb 2014 18:33:59 +0000"  >&lt;p&gt;I couldn&apos;t figure out a mechanism by which the DeviceN could be the cause but I&apos;ve just thought of one now, I&apos;ll take a closer look.&lt;/p&gt;</comment>
                            <comment id="13909266" author="jahewson" created="Sat, 22 Feb 2014 06:35:10 +0000"  >&lt;p&gt;I have what I think is a viable fix for this issue, I&apos;ve added it to trunk in revision 1570794. The color values in DeviceN were incorrect before the refactoring and remain incorrect after, which led me to suspect some other code was the issues. Your new example PDF file rules out shadings, so I was able to trace the issue to this line in PDDeviceN:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-object&quot;&gt;float&lt;/span&gt;[] altValue = tintTransform.eval(value);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The call to the tint transform function causes the order of the color values to be flipped. This is because in PDType4Function the order of the arguments is reversed before they are pushed to the PostScript stack, which is incorrect! In PostScript the order is the other way around, the arguments should be pushed to the stack in order, it is the act of popping them from the stack later which causes their order to be reversed.&lt;/p&gt;

&lt;p&gt;I&apos;ve modified PDType4Function to push the arguments in order.&lt;/p&gt;</comment>
                            <comment id="13909309" author="tilman" created="Sat, 22 Feb 2014 09:06:34 +0000"  >&lt;p&gt;Thanks, it works on the sample file and on the ch14.pdf file. You can make the update to the 1.8 version too.&lt;/p&gt;

&lt;p&gt;Very few of my test PDF files have FunctionType 4, and these had also radial shading related problems so it wasn&apos;t noticed.&lt;/p&gt;</comment>
                            <comment id="13921365" author="tilman" created="Wed, 5 Mar 2014 20:35:16 +0000"  >&lt;p&gt;Will add the fix for 1.8.&lt;/p&gt;</comment>
                            <comment id="13921369" author="tilman" created="Wed, 5 Mar 2014 20:42:04 +0000"  >&lt;p&gt;Just for the record, John&apos;s fix for the test in 2.0 was done in rev. 1570804.&lt;/p&gt;

&lt;p&gt;I included John&apos;s fix for the function and the test in rev 1574653 for the 1.8 branch. That doesn&apos;t just fix the duotone file, but the file of &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-1931&quot; title=&quot;Radial shading is missing&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-1931&quot;&gt;&lt;del&gt;PDFBOX-1931&lt;/del&gt;&lt;/a&gt; as well.&lt;/p&gt;</comment>
                            <comment id="13921371" author="jahewson" created="Wed, 5 Mar 2014 20:43:41 +0000"  >&lt;p&gt;Please don&apos;t mark fixed issues as unresolved. To indicate that a fix has been made to 1.8 just add it to &quot;Fix Version/s&quot;.&lt;/p&gt;</comment>
                            <comment id="13987392" author="lehmi" created="Fri, 2 May 2014 06:12:05 +0000"  >&lt;p&gt;Closed after releasing PDFBox 1.8.5&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12693744">PDFBOX-1893</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12630333" name="PDFBOX-1876-duotone.pdf" size="2779" author="tilman" created="Fri, 21 Feb 2014 16:46:55 +0000"/>
                            <attachment id="12630335" name="PDFBOX-1876-duotone.ps" size="1292" author="tilman" created="Fri, 21 Feb 2014 16:46:55 +0000"/>
                            <attachment id="12626550" name="ch14-01.png" size="374892" author="tilman" created="Sun, 2 Feb 2014 19:46:18 +0000"/>
                            <attachment id="12626551" name="ch14-13.png" size="569676" author="tilman" created="Sun, 2 Feb 2014 19:46:18 +0000"/>
                            <attachment id="12626604" name="ch14-15.png" size="340659" author="tilman" created="Mon, 3 Feb 2014 05:54:24 +0000"/>
                            <attachment id="12626605" name="ch14-20.png" size="345770" author="tilman" created="Mon, 3 Feb 2014 05:54:24 +0000"/>
                            <attachment id="12626549" name="ch14.pdf" size="792373" author="tilman" created="Sun, 2 Feb 2014 19:46:18 +0000"/>
                            <attachment id="12630334" name="pdfbox-1876-duotone.pdf-1.png" size="47628" author="tilman" created="Fri, 21 Feb 2014 16:46:55 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>8.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>371331</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 29 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1rzvr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>371634</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>