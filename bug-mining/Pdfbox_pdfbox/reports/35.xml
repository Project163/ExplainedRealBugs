<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 20:52:15 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PDFBOX-323] Images with transparency are not rendered correctly</title>
                <link>https://issues.apache.org/jira/browse/PDFBOX-323</link>
                <project id="12310760" key="PDFBOX">PDFBox</project>
                    <description>&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;imported from SourceForge&amp;#93;&lt;/span&gt;&lt;br/&gt;
&lt;a href=&quot;http://sourceforge.net/tracker/index.php?group_id=78314&amp;amp;atid=552832&amp;amp;aid=1833244&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://sourceforge.net/tracker/index.php?group_id=78314&amp;amp;atid=552832&amp;amp;aid=1833244&lt;/a&gt;&lt;br/&gt;
Originally submitted by phenderson on 2007-11-16 08:23.&lt;/p&gt;

&lt;p&gt;PDF documents that contain images with transparent regions are not rendered correctly. The transparent areas are painted black.&lt;/p&gt;

&lt;p&gt;Attached is an example pdf with text behind an image, generated via OpenOffice.&lt;/p&gt;

&lt;p&gt;Cheers&lt;/p&gt;

&lt;p&gt;Peter Henderson&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;attachment on SourceForge&amp;#93;&lt;/span&gt;&lt;br/&gt;
&lt;a href=&quot;http://sourceforge.net/tracker/download.php?group_id=78314&amp;amp;atid=552832&amp;amp;aid=1833244&amp;amp;file_id=254618&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://sourceforge.net/tracker/download.php?group_id=78314&amp;amp;atid=552832&amp;amp;aid=1833244&amp;amp;file_id=254618&lt;/a&gt;&lt;br/&gt;
test.pdf (application/pdf), 196955 bytes&lt;br/&gt;
example pdf&lt;/p&gt;</description>
                <environment></environment>
        <key id="12391357">PDFBOX-323</key>
            <summary>Images with transparency are not rendered correctly</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="-1">None</reporter>
                        <labels>
                    </labels>
                <created>Fri, 16 Nov 2007 16:23:00 +0000</created>
                <updated>Thu, 1 Jul 2010 07:26:36 +0000</updated>
                            <resolved>Sat, 19 Jun 2010 15:43:39 +0000</resolved>
                                                    <fixVersion>1.2.0</fixVersion>
                                    <component>PDModel</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="12877156" author="lehmi" created="Wed, 9 Jun 2010 18:12:42 +0000"  >&lt;p&gt;An other sample copied from PDFBPOX-513&lt;/p&gt;</comment>
                            <comment id="12877763" author="neilm" created="Fri, 11 Jun 2010 10:02:49 +0000"  >&lt;p&gt;Patch attached which partially fixes this issue.&lt;/p&gt;

&lt;p&gt;This patch addresses the use of &quot;soft masks&quot; as transparency masks for Jpegs within PDF files. See section 11.5 of the PDF spec.&lt;br/&gt;
The patch does not fix the transparency problem seen in test.pdf, but it fixes 4 out of the 5 images in About Stacks.pdf. I&apos;ll hopefully fix the other image soon.&lt;/p&gt;

&lt;p&gt;The patch adds a method getSMaskImage() which reads from the COS model and publishes the SMask transparency image in the PDModel. This is a greyscale image whose RGB values represent transparency. Note that this image itself has no transparency.&lt;/p&gt;

&lt;p&gt;Then I&apos;ve changed getRGBImage so that if there is an smask image, it is used to apply the transparency to the main image.&lt;/p&gt;


&lt;p&gt;Please note that although this is marked as minor, this is important functionality for us as we would like to use pdfbox to produce thumbnails of pdf files and the black squares instead of transparency are critical/major for us.&lt;/p&gt;</comment>
                            <comment id="12878414" author="lehmi" created="Sun, 13 Jun 2010 18:11:01 +0000"  >&lt;p&gt;Looks good to me. test.pdf uses a PDPixelMap and not a PDJpeg. So, you &quot;just&quot; have to adapt your solution for PDJpeg. Try to reuse your code if possible.&lt;/p&gt;</comment>
                            <comment id="12880445" author="neilm" created="Sat, 19 Jun 2010 07:41:07 +0000"  >&lt;p&gt;OK, here&apos;s another patch that fixes this issue in all images in both sample pdfs attached to the issue: test.pdf and About Stacks.pdf.&lt;br/&gt;
Note that this patch overwrites the changes in the previous one and therefore should be used instead of it.&lt;/p&gt;

&lt;p&gt;The image in test.pdf and one of the 5 images in About Stacks.pdf were indeed PDPixelMaps. Thanks Andreas. But there was a bit more work than just reusing the previous patch. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; Turns out SMask images can be transparency masks OR opacity masks.&lt;/p&gt;

&lt;p&gt;Here&apos;s what this patch does:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;PDXObjectImage now has methods to get the SMaskImage and the Decode array for image XObjects.&lt;br/&gt;
  Note that the decode array is only used in this patch for smask images although it can have meaning in &quot;base images&quot;.&lt;/li&gt;
	&lt;li&gt;PDPixelMap &amp;amp; PDJpeg now get the SMask image (if there is one) and its decode array and asks CompositeImage to create an image that combines the base image with the transparency mask.&lt;/li&gt;
	&lt;li&gt;CompositeImage a new class which does the work of combining base images with transparency/opacity masks.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12880499" author="lehmi" created="Sat, 19 Jun 2010 15:43:39 +0000"  >&lt;p&gt;Cool stuff, works like a charm!! I&apos;ve added the patch with version 956239. I&apos;ve made some slight changes (e.g.: there was already a getter for the decode array)&lt;/p&gt;

&lt;p&gt;Thanks for the contribution.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12434928">PDFBOX-513</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12446715" name="About Stacks.pdf" size="638283" author="lehmi" created="Wed, 9 Jun 2010 18:12:42 +0000"/>
                            <attachment id="12447526" name="pdfbox323.patch" size="10781" author="neilm" created="Sat, 19 Jun 2010 07:41:07 +0000"/>
                            <attachment id="12413677" name="test.pdf" size="196963" author="lehmi" created="Thu, 16 Jul 2009 11:46:09 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>163158</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 years, 23 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0zmvj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>206008</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>