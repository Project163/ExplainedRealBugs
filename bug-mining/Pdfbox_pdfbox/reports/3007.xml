<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:15:11 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PDFBOX-5797] Kid Widget /DA is ignored in setDefaultAppearance() call</title>
                <link>https://issues.apache.org/jira/browse/PDFBOX-5797</link>
                <project id="12310760" key="PDFBOX">PDFBox</project>
                    <description>&lt;p&gt;See attached SO question, the field has one widget as kid with its own /DA entry. PDFBox only sets the field /DA entry but AppearanceGeneratorHelper will consider widget /DA entries too, which can result in the problem described in the SO question when only the field /DA entry gets changed.&lt;/p&gt;

&lt;p&gt;Test code:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
PDDocument doc = Loader.loadPDF(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; File(&lt;span class=&quot;code-quote&quot;&gt;&quot;seija.pdf&quot;&lt;/span&gt;));
PDAcroForm acroForm = doc.getDocumentCatalog().getAcroForm();

PDFont font = PDType0Font.load(doc, &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; FileInputStream(&lt;span class=&quot;code-quote&quot;&gt;&quot;c:/windows/fonts/arial.ttf&quot;&lt;/span&gt;), &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;);
PDResources resources = acroForm.getDefaultResources();
&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; fontName = resources.add(font).getName();

PDVariableText field = (PDVariableText) acroForm.getField(&lt;span class=&quot;code-quote&quot;&gt;&quot;main_text&quot;&lt;/span&gt;);
field.setDefaultAppearance(field.getDefaultAppearance()
                                    .replaceAll(&lt;span class=&quot;code-quote&quot;&gt;&quot;/\\w+&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;/&quot;&lt;/span&gt;
                                                         + fontName));
field.setValue(&lt;span class=&quot;code-quote&quot;&gt;&quot;Ahoj sv&#283;te&quot;&lt;/span&gt;);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Proposed solution in PDVariableText:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void setDefaultAppearance(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; daValue)
{
    getCOSObject().setString(COSName.DA, daValue);
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (getCOSObject().containsKey(COSName.KIDS))
    {
        &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (PDAnnotationWidget widget : getWidgets())
        {
            COSDictionary widgetDict = widget.getCOSObject();
            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (widgetDict.containsKey(COSName.DA))
            {
                widgetDict.setString(COSName.DA, daValue);
            }
        }
    }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13574440">PDFBOX-5797</key>
            <summary>Kid Widget /DA is ignored in setDefaultAppearance() call</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tilman">Tilman Hausherr</assignee>
                                    <reporter username="tilman">Tilman Hausherr</reporter>
                        <labels>
                    </labels>
                <created>Wed, 3 Apr 2024 11:59:02 +0000</created>
                <updated>Thu, 16 Jan 2025 16:44:24 +0000</updated>
                            <resolved>Tue, 17 Dec 2024 13:51:59 +0000</resolved>
                                    <version>2.0.31</version>
                    <version>3.0.2 PDFBox</version>
                                    <fixVersion>2.0.33</fixVersion>
                    <fixVersion>3.0.4 PDFBox</fixVersion>
                    <fixVersion>4.0.0</fixVersion>
                                    <component>AcroForm</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="17833559" author="msahyoun" created="Wed, 3 Apr 2024 13:09:02 +0000"  >&lt;p&gt;If I&apos;m not mistaken a /DA entry is specific to a field dictionary and not a widget dictionary (with both dictionaries optionally being merged into a single dictionary). This means that the kid is not only a widget but also a field. The proposed change would overwrite that maybe as intended in that case but maybe not in others.&lt;/p&gt;</comment>
                            <comment id="17833567" author="tilman" created="Wed, 3 Apr 2024 13:19:54 +0000"  >&lt;p&gt;I agree with the first sentence, but not with the second: PDVariableText is a PDTerminalField, so any /KIDS can only be widgets, or why not?&lt;/p&gt;</comment>
                            <comment id="17833569" author="msahyoun" created="Wed, 3 Apr 2024 13:23:01 +0000"  >&lt;p&gt;I&apos;d need to look into that i.e. if it&apos;s correct that we treat that field as a PDTerminalField where it should be a PDNonTerminalField. But a kid can be a widget and field&lt;/p&gt;</comment>
                            <comment id="17905011" author="tilman" created="Thu, 12 Dec 2024 04:08:37 +0000"  >&lt;p&gt;We need to fix this, there&apos;s now a second case, again from Sejda. The user couldn&apos;t share his file so I created it myself, this is really easy to use  &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/13073404/13073404_SO79271803.pdf&quot; title=&quot;SO79271803.pdf attached to PDFBOX-5797&quot;&gt;SO79271803.pdf&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt; &lt;br/&gt;
&lt;a href=&quot;https://stackoverflow.com/questions/79271803/pdfbox-3-encoding-exception&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://stackoverflow.com/questions/79271803/pdfbox-3-encoding-exception&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17905049" author="tilman" created="Thu, 12 Dec 2024 07:58:04 +0000"  >&lt;blockquote&gt;&lt;p&gt;if it&apos;s correct that we treat that field as a PDTerminalField where it should be a PDNonTerminalField.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;The source code has this comment:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
        &lt;span class=&quot;code-comment&quot;&gt;// A non terminal fields has Kids entries which &lt;span class=&quot;code-keyword&quot;&gt;do&lt;/span&gt; have
&lt;/span&gt;        &lt;span class=&quot;code-comment&quot;&gt;// a field name (other than annotations)&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;And indeed, the kid has no field name ( /T entry).&lt;/p&gt;</comment>
                            <comment id="17906370" author="jira-bot" created="Tue, 17 Dec 2024 10:47:53 +0000"  >&lt;p&gt;Commit 1922554 from Tilman Hausherr in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1922554&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1922554&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-5797&quot; title=&quot;Kid Widget /DA is ignored in setDefaultAppearance() call&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-5797&quot;&gt;&lt;del&gt;PDFBOX-5797&lt;/del&gt;&lt;/a&gt;: also modify /DA entries in kid widgets if they exist&lt;/p&gt;</comment>
                            <comment id="17906371" author="jira-bot" created="Tue, 17 Dec 2024 10:47:57 +0000"  >&lt;p&gt;Commit 1922555 from Tilman Hausherr in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1922555&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1922555&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-5797&quot; title=&quot;Kid Widget /DA is ignored in setDefaultAppearance() call&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-5797&quot;&gt;&lt;del&gt;PDFBOX-5797&lt;/del&gt;&lt;/a&gt;: also modify /DA entries in kid widgets if they exist&lt;/p&gt;</comment>
                            <comment id="17906372" author="jira-bot" created="Tue, 17 Dec 2024 10:48:01 +0000"  >&lt;p&gt;Commit 1922556 from Tilman Hausherr in branch &apos;pdfbox/branches/3.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1922556&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1922556&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-5797&quot; title=&quot;Kid Widget /DA is ignored in setDefaultAppearance() call&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-5797&quot;&gt;&lt;del&gt;PDFBOX-5797&lt;/del&gt;&lt;/a&gt;: also modify /DA entries in kid widgets if they exist&lt;/p&gt;</comment>
                            <comment id="17906391" author="jira-bot" created="Tue, 17 Dec 2024 11:21:15 +0000"  >&lt;p&gt;Commit 1922557 from Tilman Hausherr in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1922557&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1922557&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-5797&quot; title=&quot;Kid Widget /DA is ignored in setDefaultAppearance() call&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-5797&quot;&gt;&lt;del&gt;PDFBOX-5797&lt;/del&gt;&lt;/a&gt;: add test&lt;/p&gt;</comment>
                            <comment id="17906392" author="jira-bot" created="Tue, 17 Dec 2024 11:21:20 +0000"  >&lt;p&gt;Commit 1922558 from Tilman Hausherr in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1922558&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1922558&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-5797&quot; title=&quot;Kid Widget /DA is ignored in setDefaultAppearance() call&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-5797&quot;&gt;&lt;del&gt;PDFBOX-5797&lt;/del&gt;&lt;/a&gt;: add test&lt;/p&gt;</comment>
                            <comment id="17906393" author="jira-bot" created="Tue, 17 Dec 2024 11:21:31 +0000"  >&lt;p&gt;Commit 1922559 from Tilman Hausherr in branch &apos;pdfbox/branches/3.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1922559&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1922559&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-5797&quot; title=&quot;Kid Widget /DA is ignored in setDefaultAppearance() call&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-5797&quot;&gt;&lt;del&gt;PDFBOX-5797&lt;/del&gt;&lt;/a&gt;: add test&lt;/p&gt;</comment>
                            <comment id="17906399" author="jira-bot" created="Tue, 17 Dec 2024 11:28:08 +0000"  >&lt;p&gt;Commit 1922563 from Tilman Hausherr in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1922563&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1922563&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-5797&quot; title=&quot;Kid Widget /DA is ignored in setDefaultAppearance() call&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-5797&quot;&gt;&lt;del&gt;PDFBOX-5797&lt;/del&gt;&lt;/a&gt;: revert accidentally committed parts&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="13073404" name="SO79271803.pdf" size="2067" author="tilman" created="Thu, 12 Dec 2024 04:08:33 +0000"/>
                            <attachment id="13067826" name="seija.pdf" size="37265" author="tilman" created="Wed, 3 Apr 2024 11:55:38 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12311020" key="com.atlassian.jira.plugin.system.customfieldtypes:url">
                        <customfieldname>External issue URL</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[https://stackoverflow.com/questions/78258051/how-to-change-font-of-the-existing-pdtextfield-in-pdfbox-java]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            46 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1oeog:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>