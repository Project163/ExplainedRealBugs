<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:13:03 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PDFBOX-5453] ClassCastException (PDColor.java:66)</title>
                <link>https://issues.apache.org/jira/browse/PDFBOX-5453</link>
                <project id="12310760" key="PDFBOX">PDFBox</project>
                    <description>&lt;p&gt;We are currently running PDFBox 2.0.24 &amp;amp; 2.0.26, but I see the code is identical in the trunk.&lt;/p&gt;

&lt;p&gt;Certain PDFs are throwing the exception shown below in our production system.&#160; In these cases,&#160; rather than the array containing a list of COSNumbers, it actually contains a single item - another COSArray.&lt;/p&gt;

&lt;p&gt;That COSArray then has an array of COSNumbers.&#160; If I insert the following lines of code at line 62 to use the inner COSArray, the PDF renders properly.&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;&#160; &#160; &#160; &#160; &#160; &#160; &lt;b&gt;if ((array.size() == 1) &amp;amp;&amp;amp; (array.get(0) instanceof COSArray))&lt;/b&gt;&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &lt;b&gt;array = (COSArray) array.get(0);&lt;/b&gt;&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Unfortunately, we do not generate the PDFs ourselves and our documents contain sensitive information so I am unable to provide an example.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;b&gt;Exception:&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;java.lang.ClassCastException: class org.apache.pdfbox.cos.COSArray cannot be cast to class org.apache.pdfbox.cos.COSNumber (org.apache.pdfbox.cos.COSArray and org.apache.pdfbox.cos.COSNumber are in unnamed module of loader &apos;app&apos;)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;at org.apache.pdfbox.pdmodel.graphics.color.PDColor.(PDColor.java:66)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;at org.apache.pdfbox.pdmodel.interactive.annotation.handlers.PDFreeTextAppearanceHandler.extractNonStrokingColor(PDFreeTextAppearanceHandler.java:424)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;at org.apache.pdfbox.pdmodel.interactive.annotation.handlers.PDFreeTextAppearanceHandler.generateNormalAppearance(PDFreeTextAppearanceHandler.java:111)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;at org.apache.pdfbox.pdmodel.interactive.annotation.handlers.PDFreeTextAppearanceHandler.generateAppearanceStreams(PDFreeTextAppearanceHandler.java:75)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;at org.apache.pdfbox.pdmodel.interactive.annotation.PDAnnotationMarkup.constructAppearances(PDAnnotationMarkup.java:897)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;at org.apache.pdfbox.rendering.PageDrawer.showAnnotation(PageDrawer.java:1521)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;at org.apache.pdfbox.rendering.PageDrawer.drawPage(PageDrawer.java:281)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;at org.apache.pdfbox.rendering.PDFRenderer.renderImage(PDFRenderer.java:347)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;at org.apache.pdfbox.rendering.PDFRenderer.renderImage(PDFRenderer.java:268)&lt;/tt&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13448801">PDFBOX-5453</key>
            <summary>ClassCastException (PDColor.java:66)</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tilman">Tilman Hausherr</assignee>
                                    <reporter username="John Petersam">John Petersam</reporter>
                        <labels>
                    </labels>
                <created>Tue, 7 Jun 2022 13:35:55 +0000</created>
                <updated>Thu, 29 Sep 2022 17:57:15 +0000</updated>
                            <resolved>Tue, 7 Jun 2022 19:06:20 +0000</resolved>
                                    <version>2.0.24</version>
                    <version>2.0.26</version>
                                    <fixVersion>2.0.27</fixVersion>
                    <fixVersion>3.0.0 PDFBox</fixVersion>
                                    <component>PDModel</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="17551164" author="jira-bot" created="Tue, 7 Jun 2022 15:51:32 +0000"  >&lt;p&gt;Commit 1901730 from Tilman Hausherr in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1901730&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1901730&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-5453&quot; title=&quot;ClassCastException (PDColor.java:66)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-5453&quot;&gt;&lt;del&gt;PDFBOX-5453&lt;/del&gt;&lt;/a&gt;: avoid ClassCastException&lt;/p&gt;</comment>
                            <comment id="17551166" author="jira-bot" created="Tue, 7 Jun 2022 15:51:36 +0000"  >&lt;p&gt;Commit 1901731 from Tilman Hausherr in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1901731&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1901731&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-5453&quot; title=&quot;ClassCastException (PDColor.java:66)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-5453&quot;&gt;&lt;del&gt;PDFBOX-5453&lt;/del&gt;&lt;/a&gt;: avoid ClassCastException&lt;/p&gt;</comment>
                            <comment id="17551171" author="tilman" created="Tue, 7 Jun 2022 16:01:52 +0000"  >&lt;p&gt;I don&apos;t want to support something that is clearly wrong, but a ClassCastException is also a no-no. I&apos;ve fixed that, please try rendering your PDF again. The result is likely that some color will be black.&lt;/p&gt;

&lt;p&gt;Snapshot build here:&lt;br/&gt;
&lt;a href=&quot;https://repository.apache.org/content/groups/snapshots/org/apache/pdfbox/pdfbox-app/2.0.27-SNAPSHOT/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://repository.apache.org/content/groups/snapshots/org/apache/pdfbox/pdfbox-app/2.0.27-SNAPSHOT/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17551185" author="JIRAUSER290615" created="Tue, 7 Jun 2022 16:34:30 +0000"  >&lt;p&gt;Hi Tilman,&lt;br/&gt;
Thanks for making quick work of this.&#160; I can confirm that it is resolved.&lt;/p&gt;

&lt;p&gt;Thanks again!&lt;/p&gt;</comment>
                            <comment id="17551239" author="tilman" created="Tue, 7 Jun 2022 19:06:20 +0000"  >&lt;p&gt;Thanks for the feedback!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 22 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z130ps:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>