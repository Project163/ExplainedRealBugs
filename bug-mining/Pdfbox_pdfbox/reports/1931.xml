<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:07:12 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PDFBOX-4084] Can&apos;t draw PDFs while ANNOTS is COSStream instead of COSArray</title>
                <link>https://issues.apache.org/jira/browse/PDFBOX-4084</link>
                <project id="12310760" key="PDFBOX">PDFBox</project>
                    <description>&lt;p&gt;PDFBox would failed to draw the attached document , error logs are below:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
java.lang.ClassCastException: org.apache.pdfbox.cos.COSStream cannot be &lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt; to org.apache.pdfbox.cos.COSArray
at org.apache.pdfbox.pdmodel.PDPage.getAnnotations(PDPage.java:661) ~[classes/:?]
at org.apache.pdfbox.rendering.PageDrawer.drawPage(PageDrawer.java:202) ~[classes/:?]&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;This PDF put COSStream as the page&apos;s ANNOTS object, and caused the failure.&lt;/p&gt;

&lt;p&gt;Simply do type checks in&#160;PDPage.getAnnotations might avoid this issue, but the annotations would lost.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;This PDF show correctly (I mean annotation works) in:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Chrome&#160;63.0.3239.132&lt;/li&gt;
	&lt;li&gt;Adobe Reader 11.0.23&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;This PDF doesn&apos;t work perfectly in:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Microsoft Edge&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13134185">PDFBOX-4084</key>
            <summary>Can&apos;t draw PDFs while ANNOTS is COSStream instead of COSArray</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="lehmi">Andreas Lehmk&#252;hler</assignee>
                                    <reporter username="hust.zcheng">Cheng Zhong</reporter>
                        <labels>
                    </labels>
                <created>Sat, 27 Jan 2018 04:24:36 +0000</created>
                <updated>Sat, 24 Mar 2018 09:41:42 +0000</updated>
                            <resolved>Sun, 11 Mar 2018 08:57:06 +0000</resolved>
                                    <version>2.0.8</version>
                                    <fixVersion>2.0.9</fixVersion>
                    <fixVersion>3.0.0 PDFBox</fixVersion>
                                    <component>PDModel</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="16342054" author="hust.zcheng" created="Sat, 27 Jan 2018 09:26:14 +0000"  >&lt;p&gt;This also happens in getPages or something else (See the second attachment).&#160;&lt;/p&gt;

&lt;p&gt;I wonder if there is a new specification for PDF or a extended specification, to store ANNOTS, PAGES or every thing at root as a (compressed?) stream to save space.&lt;/p&gt;

&lt;p&gt;I hope PDFBOX could handle these issue correctly.&lt;/p&gt;</comment>
                            <comment id="16342103" author="jira-bot" created="Sat, 27 Jan 2018 12:03:17 +0000"  >&lt;p&gt;Commit 1822397 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1822397&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1822397&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4084&quot; title=&quot;Can&amp;#39;t draw PDFs while ANNOTS is COSStream instead of COSArray&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4084&quot;&gt;&lt;del&gt;PDFBOX-4084&lt;/del&gt;&lt;/a&gt;: avoid ClassCastException&lt;/p&gt;</comment>
                            <comment id="16342104" author="jira-bot" created="Sat, 27 Jan 2018 12:07:59 +0000"  >&lt;p&gt;Commit 1822398 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1822398&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1822398&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4084&quot; title=&quot;Can&amp;#39;t draw PDFs while ANNOTS is COSStream instead of COSArray&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4084&quot;&gt;&lt;del&gt;PDFBOX-4084&lt;/del&gt;&lt;/a&gt;: avoid ClassCastException&lt;/p&gt;</comment>
                            <comment id="16342107" author="tilman" created="Sat, 27 Jan 2018 12:12:42 +0000"  >&lt;p&gt;I&apos;ll fix the classcastexception, but the first file is broken. Here&apos;s object 38:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
38 0 obj
&amp;lt;&amp;lt;/Annots 64 0 R/Contents 88 0 R/CropBox [0 0 595.22 842]/MediaBox [0 0 595.22 842]/Parent 33 0 R/Resources &amp;lt;&amp;lt;/ExtGState &amp;lt;&amp;lt;/GS2 93 0 R/GS3 94 0 R&amp;gt;&amp;gt;/Font &amp;lt;&amp;lt;/F1 87 0 R/TT10 51 0 R/TT2 40 0 R/TT4 41 0 R/TT6 42 0 R/TT8 49 0 R&amp;gt;&amp;gt;/ProcSet [/PDF /Text /ImageC /ImageB /ImageI]/XObject &amp;lt;&amp;lt;/Im245 59 0 R/Im247 61 0 R/X1 89 0 R/X2 90 0 R&amp;gt;&amp;gt;&amp;gt;&amp;gt;/Rotate 0/Thumb 103 0 R/Type /Page&amp;gt;&amp;gt;
endobj
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The object 64 exists twice in the PDF. Once as annotation array, once as font.&lt;/p&gt;

&lt;p&gt;Yes there is a specification (compressed object streams) to store things as a stream, but this is not new and we support it.&lt;/p&gt;

&lt;p&gt;What is with the second file? &quot;This also happens in getPages or something else (See the second attachment).&quot; Is this the same issue?&lt;/p&gt;</comment>
                            <comment id="16353473" author="hust.zcheng" created="Tue, 6 Feb 2018 06:52:58 +0000"  >&lt;p&gt;Thanks for the reply and sorry for the incomplete information.&lt;/p&gt;

&lt;p&gt;The second PDF would crash &lt;em&gt;ClassCastException&lt;/em&gt; at Page 2 (1-based page number) when you try to get its resources. Here is the stacktrace:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
java.lang.ClassCastException: org.apache.pdfbox.cos.COSArray cannot be &lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt; to org.apache.pdfbox.cos.COSDictionary
at org.apache.pdfbox.pdmodel.PDPage.getResources(PDPage.java:198) ~[classes/:?]&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;It doesn&apos;t happened in &lt;b&gt;PDDocument.getPages&lt;/b&gt; but in &lt;b&gt;PDPage.getResoruces&lt;/b&gt;. The /Resources was an &lt;b&gt;COSArray&lt;/b&gt; instead of &lt;b&gt;COSDictonary&lt;/b&gt;.&lt;/p&gt;

&lt;p&gt;I could also find some&#160;&lt;em&gt;ClassCastException&lt;/em&gt; in other PDFs (sorry, I can find them out now)&#160;in &lt;b&gt;PDDocument.getDocumentInformation&lt;/b&gt; and &lt;b&gt;/Info&lt;/b&gt;&#160;reference to a &lt;b&gt;COSStream&lt;/b&gt; instead of a &lt;b&gt;COSDictonary&lt;/b&gt;. I&apos;m afraid that there might be other&#160;&lt;em&gt;ClassCastException&lt;/em&gt;&#160; I didn&apos;t discover.&lt;/p&gt;</comment>
                            <comment id="16353485" author="tilman" created="Tue, 6 Feb 2018 07:04:20 +0000"  >&lt;p&gt;Thanks... yes, the &lt;em&gt;ClassCastException&lt;/em&gt; problem is at many places in the software.&lt;/p&gt;</comment>
                            <comment id="16354226" author="jira-bot" created="Tue, 6 Feb 2018 17:53:54 +0000"  >&lt;p&gt;Commit 1823369 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1823369&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1823369&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4084&quot; title=&quot;Can&amp;#39;t draw PDFs while ANNOTS is COSStream instead of COSArray&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4084&quot;&gt;&lt;del&gt;PDFBOX-4084&lt;/del&gt;&lt;/a&gt;: avoid ClassCastException&lt;/p&gt;</comment>
                            <comment id="16354227" author="jira-bot" created="Tue, 6 Feb 2018 17:53:58 +0000"  >&lt;p&gt;Commit 1823370 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1823370&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1823370&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4084&quot; title=&quot;Can&amp;#39;t draw PDFs while ANNOTS is COSStream instead of COSArray&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4084&quot;&gt;&lt;del&gt;PDFBOX-4084&lt;/del&gt;&lt;/a&gt;: avoid ClassCastException&lt;/p&gt;</comment>
                            <comment id="16354277" author="lehmi" created="Tue, 6 Feb 2018 18:14:04 +0000"  >&lt;p&gt;I&apos;ve a solution for &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12907982/12907982_Benelux+Equity+Daily-20110321.pdf&quot; title=&quot;Benelux Equity Daily-20110321.pdf attached to PDFBOX-4084&quot;&gt;Benelux Equity Daily-20110321.pdf&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;, but I still have to double check it. I&apos;m afraid the second file may have another issue&lt;/p&gt;</comment>
                            <comment id="16394168" author="jira-bot" created="Sat, 10 Mar 2018 13:42:05 +0000"  >&lt;p&gt;Commit 1826402 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lehmi&quot; class=&quot;user-hover&quot; rel=&quot;lehmi&quot;&gt;lehmi&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1826402&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1826402&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4084&quot; title=&quot;Can&amp;#39;t draw PDFs while ANNOTS is COSStream instead of COSArray&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4084&quot;&gt;&lt;del&gt;PDFBOX-4084&lt;/del&gt;&lt;/a&gt;: be lenient if the read generation number is bigger than the expected one&lt;/p&gt;</comment>
                            <comment id="16394169" author="jira-bot" created="Sat, 10 Mar 2018 13:42:17 +0000"  >&lt;p&gt;Commit 1826403 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lehmi&quot; class=&quot;user-hover&quot; rel=&quot;lehmi&quot;&gt;lehmi&lt;/a&gt; in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1826403&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1826403&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4084&quot; title=&quot;Can&amp;#39;t draw PDFs while ANNOTS is COSStream instead of COSArray&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4084&quot;&gt;&lt;del&gt;PDFBOX-4084&lt;/del&gt;&lt;/a&gt;: be lenient if the read generation number is bigger than the expected one&lt;/p&gt;</comment>
                            <comment id="16394177" author="lehmi" created="Sat, 10 Mar 2018 14:01:42 +0000"  >&lt;p&gt;The file contains a compressed xref stream which doesn&apos;t define any generation numbers so that pdfbox assumes all are 0. But there is one object (101 1) with a higher generation number which triggers the brute force search. I&apos;ve made the parser more lenient so that it doesn&apos;t stumbles upon such cases anymore.&lt;/p&gt;

&lt;p&gt;We can&apos;t do anything for  &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12907995/12907995_TELECOM+EQUIPMENT+DAILY+-+12+AUG+2009.pdf&quot; title=&quot;TELECOM EQUIPMENT DAILY - 12 AUG 2009.pdf attached to PDFBOX-4084&quot;&gt;TELECOM EQUIPMENT DAILY - 12 AUG 2009.pdf&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;. The file is simply malformed and even acrobat isn&apos;t able to do better than us.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12907982" name="Benelux Equity Daily-20110321.pdf" size="1157598" author="hust.zcheng" created="Sat, 27 Jan 2018 04:14:57 +0000"/>
                            <attachment id="12907995" name="TELECOM EQUIPMENT DAILY - 12 AUG 2009.pdf" size="153833" author="hust.zcheng" created="Sat, 27 Jan 2018 09:23:41 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 36 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3pfxb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>