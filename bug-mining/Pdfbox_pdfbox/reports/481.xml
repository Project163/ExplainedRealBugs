<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 20:55:30 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PDFBOX-1983] Unable to add TIF images, CCITTFactory not working</title>
                <link>https://issues.apache.org/jira/browse/PDFBOX-1983</link>
                <project id="12310760" key="PDFBOX">PDFBox</project>
                    <description>&lt;p&gt;As used in the AddImageToPDF example, the following line generates an error with tif image:&lt;/p&gt;

&lt;p&gt;PDImageXObject ximage =  CCITTFactory.createFromRandomAccess(document, new RandomAccessFile(new File(imagePath), &quot;r&quot;));&lt;/p&gt;

&lt;p&gt;java.io.IOException: Stream was not read&lt;br/&gt;
        at org.apache.pdfbox.cos.COSStream.getDecodeResult(COSStream.java:235)&lt;br/&gt;
        at org.apache.pdfbox.pdmodel.graphics.image.PDImageXObject.&amp;lt;init&amp;gt;(PDImageXObject.java:80)&lt;br/&gt;
        at org.apache.pdfbox.pdmodel.graphics.image.PDImageXObject.&amp;lt;init&amp;gt;(PDImageXObject.java:70)&lt;br/&gt;
        at org.apache.pdfbox.pdmodel.graphics.image.CCITTFactory.createFromRandomAccess(CCITTFactory.java:50)&lt;/p&gt;</description>
                <environment></environment>
        <key id="12701179">PDFBOX-1983</key>
            <summary>Unable to add TIF images, CCITTFactory not working</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tilman">Tilman Hausherr</assignee>
                                    <reporter username="joekaapa">Joel K&#228;&#228;p&#228;</reporter>
                        <labels>
                    </labels>
                <created>Thu, 13 Mar 2014 07:51:05 +0000</created>
                <updated>Thu, 17 Mar 2016 19:07:19 +0000</updated>
                            <resolved>Thu, 13 Mar 2014 16:45:01 +0000</resolved>
                                    <version>2.0.0</version>
                                    <fixVersion>2.0.0</fixVersion>
                                    <component>PDModel</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="13932969" author="tilman" created="Thu, 13 Mar 2014 07:59:59 +0000"  >&lt;p&gt;Does this happen with all TIFF files, or just with one of them? Sample TIFF file attached.&lt;/p&gt;</comment>
                            <comment id="13932972" author="jahewson" created="Thu, 13 Mar 2014 08:02:18 +0000"  >&lt;p&gt;I&apos;ve seen this &quot;Stream was not read&quot; error happen before due to a stream being read twice...&lt;/p&gt;</comment>
                            <comment id="13933013" author="joekaapa" created="Thu, 13 Mar 2014 08:51:14 +0000"  >&lt;p&gt;Tested the attachment to produce the same error.&lt;/p&gt;</comment>
                            <comment id="13933014" author="joekaapa" created="Thu, 13 Mar 2014 08:51:56 +0000"  >&lt;p&gt;Propably of no help, but JPEG is working without problems.&lt;/p&gt;</comment>
                            <comment id="13933508" author="tilman" created="Thu, 13 Mar 2014 16:40:44 +0000"  >&lt;p&gt;The last comment was the one who helped me fix the bug (done in rev 1577233), because all I had to do was to look at JPEGFactory. I have attached a file created with the sample code.&lt;/p&gt;

&lt;p&gt;This bug shows that we need to have a test.&lt;/p&gt;</comment>
                            <comment id="13935295" author="tilman" created="Fri, 14 Mar 2014 17:32:25 +0000"  >&lt;p&gt;I added a test in rev 1577618 and 1577619. Note the part at the end of the code, it&apos;s unclear to me if ximage.getImage() should return an image. (Currently it doesn&apos;t)&lt;/p&gt;</comment>
                            <comment id="13936348" author="jahewson" created="Sat, 15 Mar 2014 23:53:20 +0000"  >&lt;p&gt;Yes, ximage.getImage() should be returning an image. I took a look at this and it was a caused by a combination of the way that JPEGFactory and CCITTFactory use PDStream, the fact that PDStream performs caching when it probably shouldn&apos;t, and the fact that COSStream#getLength() returns the dictionay value and not the current stream length.&lt;/p&gt;

&lt;p&gt;There&apos;s a fundamental problem here which is that COSStream allows its stream to be written to but does not return the length in getLength. I think that the fact that the underlying stream can be manipulated by classes outside of COSStream is the issue. COSStream has no way to know when its stream has been modified! I think we need to rethink the design of this at some point, it looks like COSStream should subclass InputStream and/or OutputStream so that it knows when the stream is being manipulated, rather than just returning e.g. an InputStream which anyone can mess with via e.g. getFilteredStream().&lt;/p&gt;

&lt;p&gt;Anyway, I&apos;ve basically just added a workaround in 1577959 to sidestep the problem for now and enabled the portions of the tests which were commented out.&lt;/p&gt;</comment>
                            <comment id="13937050" author="tilman" created="Sun, 16 Mar 2014 09:23:01 +0000"  >&lt;p&gt;Thanks but now I get this with several PDFs:&lt;/p&gt;

&lt;p&gt;java.lang.UnsupportedOperationException: not supported for memory stream&lt;br/&gt;
	at org.apache.pdfbox.pdmodel.common.PDMemoryStream.getStream(PDMemoryStream.java:119)&lt;br/&gt;
	at org.apache.pdfbox.pdmodel.graphics.image.SampledImageReader.getRGBImage(SampledImageReader.java:110)&lt;br/&gt;
	at org.apache.pdfbox.pdmodel.graphics.image.SampledImageReader.getStencilImage(SampledImageReader.java:55)&lt;br/&gt;
	at org.apache.pdfbox.pdmodel.graphics.image.PDInlineImage.getStencilImage(PDInlineImage.java:236)&lt;br/&gt;
	at org.apache.pdfbox.util.operator.pagedrawer.BeginInlineImage.process(BeginInlineImage.java:53)&lt;br/&gt;
...&lt;/p&gt;

</comment>
                            <comment id="13937091" author="tilman" created="Sun, 16 Mar 2014 11:08:00 +0000"  >&lt;p&gt;I did an ad-hoc fix in SampledImageReader and added a simple test for PDInlineImage to prevent this from breaking in the future in rev. 1578034 and 1578041.&lt;/p&gt;</comment>
                            <comment id="13938547" author="jahewson" created="Mon, 17 Mar 2014 23:31:23 +0000"  >&lt;p&gt;Cool, it looks like PDMemoryStream is the weak link, it&apos;s not really doing what it says it is.&lt;/p&gt;</comment>
                            <comment id="13965614" author="tilman" created="Thu, 10 Apr 2014 17:56:37 +0000"  >&lt;p&gt;I improved PDInlineImageTest in rev 1586388. One can never have too many tests &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12634386" name="G4.tif" size="4040" author="tilman" created="Thu, 13 Mar 2014 07:59:59 +0000"/>
                            <attachment id="12634468" name="huhu.pdf" size="4894" author="tilman" created="Thu, 13 Mar 2014 16:40:44 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>379525</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 32 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1te7r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>379816</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>