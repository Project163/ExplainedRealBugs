<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 20:55:12 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PDFBOX-1977] LZWFilter fails</title>
                <link>https://issues.apache.org/jira/browse/PDFBOX-1977</link>
                <project id="12310760" key="PDFBOX">PDFBox</project>
                    <description>&lt;p&gt;TestFilters uses Random().nextLong() to generate a seed for random data, which means that it is non-determinate. Depending on the seed value, the test may fail or succeed.&lt;/p&gt;

&lt;p&gt;Using the following seed results in the LZW filter failing:&lt;/p&gt;

&lt;p&gt;final long seed = -6257105096642706464L;&lt;/p&gt;</description>
                <environment></environment>
        <key id="12700896">PDFBOX-1977</key>
            <summary>LZWFilter fails</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tilman">Tilman Hausherr</assignee>
                                    <reporter username="jahewson">John Hewson</reporter>
                        <labels>
                            <label>LZW</label>
                    </labels>
                <created>Wed, 12 Mar 2014 05:30:21 +0000</created>
                <updated>Tue, 11 Aug 2020 17:13:08 +0000</updated>
                            <resolved>Fri, 18 Apr 2014 14:15:56 +0000</resolved>
                                    <version>1.8.5</version>
                    <version>2.0.0</version>
                                    <fixVersion>1.8.5</fixVersion>
                    <fixVersion>2.0.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="13931990" author="mikemccand" created="Wed, 12 Mar 2014 16:55:56 +0000"  >&lt;p&gt;It&apos;s intentional that the test picks a random seed, and it then prints the seed if there is an error, so we get better test coverage without losing reproducibility.&lt;/p&gt;</comment>
                            <comment id="13932011" author="tilman" created="Wed, 12 Mar 2014 17:06:42 +0000"  >&lt;p&gt;My mistake (in the encoder) was not to check the bit chunk size after writing the last output code and before writing the EOD code. Since the decoder doesn&apos;t know that an EOD is coming, it had adjusted its own bit chunk size. I fixed this and also modified some code per DRY and optimized a bit. Done in rev 1576820 for the trunk and rev 1576821 for the 1.8 branch.&lt;/p&gt;

&lt;p&gt;Any suggestions for the &lt;del&gt;random&lt;/del&gt; seed? &lt;del&gt;I&apos;d take System.getCurrentMillis().&lt;/del&gt;&lt;/p&gt;

&lt;p&gt;Btw, how long did you run your own test with real random until you got this fail?&lt;/p&gt;</comment>
                            <comment id="13932017" author="tilman" created="Wed, 12 Mar 2014 17:09:55 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mikemccand&quot; class=&quot;user-hover&quot; rel=&quot;mikemccand&quot;&gt;mikemccand&lt;/a&gt; The problem was that the test didn&apos;t pick a random seed to start &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13932018" author="mikemccand" created="Wed, 12 Mar 2014 17:10:05 +0000"  >&lt;p&gt;I think just leave the random seed as it&apos;s now done?&lt;/p&gt;</comment>
                            <comment id="13932020" author="jahewson" created="Wed, 12 Mar 2014 17:10:54 +0000"  >&lt;p&gt;The test does use a random seed, but &lt;a href=&quot;http://martinfowler.com/articles/nonDeterminism.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;unit tests should not be non-deterministic&lt;/a&gt;. The data can be generated using Random() but the seed needs to be constant. Better still, the test should be run on a set of representative data. Perhaps there is another open source LZW library which has a set of high-quality test data?&lt;/p&gt;</comment>
                            <comment id="13932046" author="mikemccand" created="Wed, 12 Mar 2014 17:31:21 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; I&apos;m confused: the test seems to do 10 iterations, picking a random seed every time, and then if there is a failure, it reports which seed leads to the failure?&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jahewson&quot; class=&quot;user-hover&quot; rel=&quot;jahewson&quot;&gt;jahewson&lt;/a&gt; I agree tests must be deterministic, and, with the specified seed, this test is.  The randomization allows us to test a wide range of data without sacrificing reproducibility.  In Lucene we make heavy use of this, picking random codecs, random documents, etc. ... Lucene&apos;s testing framework has since been factored out as a separate project: &lt;a href=&quot;https://github.com/carrotsearch/randomizedtesting&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/carrotsearch/randomizedtesting&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I wrote this brief blog post about Lucene&apos;s randomized tests a while back: &lt;a href=&quot;http://blog.mikemccandless.com/2011/03/your-test-cases-should-sometimes-fail.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://blog.mikemccandless.com/2011/03/your-test-cases-should-sometimes-fail.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Had the seed in this test been constant, this issue would not have been found.  It&apos;s because the seed is randomly selected that the test finally produced a sequence of data that provokes the bug.&lt;/p&gt;</comment>
                            <comment id="13932107" author="jahewson" created="Wed, 12 Mar 2014 18:14:31 +0000"  >&lt;blockquote&gt;
&lt;p&gt;I wrote this brief blog post about Lucene&apos;s randomized tests a while back&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Thanks for the link, it&apos;s interesting; more what I&apos;d call a fuzz test rather than a &lt;del&gt;unit test&lt;/del&gt; &lt;em&gt;regression test&lt;/em&gt;, because it can&apos;t be used to identify regressions at the point they are committed, as the test data is different each time. Perhaps we need both kinds of test? Deterministic &lt;del&gt;unit tests&lt;/del&gt; &lt;em&gt;regression tests&lt;/em&gt; for catching regressions and known corner-cases, and randomized fuzz tests for increased coverage. What do you think?&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Had the seed in this test been constant, this issue would not have been found. It&apos;s because the seed is randomly selected that the test finally produced a sequence of data that provokes the bug.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;This is true, but it&apos;s also possible that a representative set of input data could have caught this regression at the time it was introduced.&lt;/p&gt;</comment>
                            <comment id="13932163" author="tilman" created="Wed, 12 Mar 2014 18:42:40 +0000"  >&lt;p&gt;This is getting into a philosophical discussion. But I think that both have their advantage, i.e. fixed tests, but also totally random tests that tell a seed so that they can be repeated later.&lt;/p&gt;

&lt;p&gt;John, you didn&apos;t answer how you found this fail. I suspect that the test was run for a longer time, although a &quot;lucky&quot; hit might also be the reason. Anyway, it is great that you found it, because it showed a real problem.&lt;/p&gt;</comment>
                            <comment id="13932221" author="jahewson" created="Wed, 12 Mar 2014 19:16:41 +0000"  >&lt;p&gt;It was a &quot;lucky&quot; hit which occurred while I was working on something unrelated.&lt;/p&gt;</comment>
                            <comment id="13932238" author="mikemccand" created="Wed, 12 Mar 2014 19:26:58 +0000"  >&lt;blockquote&gt;&lt;p&gt;Thanks for the link, it&apos;s interesting; more what I&apos;d call a fuzz test rather than a unit test, because it can&apos;t be used to identify regressions at the point they are committed, as the test data is different each time.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I like the name &quot;fuzz test&quot;!&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Perhaps we need both kinds of test? Deterministic unit tests for catching regressions and known corner-cases, and randomized fuzz tests for increased coverage. &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;+1, we definitely need both.  Whenever a bug is hit it&apos;s best to make a very specific non-randomized test case showing the bug, fix the bug, and then see that the test passes.  This test is like a &quot;rifle&quot; and the randomized test is like a &quot;shotgun&quot;.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;This is true, but it&apos;s also possible that a representative set of input data could have caught this regression at the time it was introduced.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Right!  If we knew which data to make, back then &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;I suspect that the test was run for a longer time, although a &quot;lucky&quot; hit might also be the reason.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;In that blog post I compare this to the search for extraterrestrial life!  Finding a seed that produces a failure is not easy, and we all use our machines / Jenkins jobs / etc. to hunt for them. &lt;/p&gt;</comment>
                            <comment id="13932248" author="jahewson" created="Wed, 12 Mar 2014 19:36:21 +0000"  >&lt;blockquote&gt;
&lt;p&gt;I like the name &quot;fuzz test&quot;!&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Yes it&apos;s fun, &lt;a href=&quot;http://en.wikipedia.org/wiki/Fuzz_testing&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Wikipedia&lt;/a&gt; has an article explaining the origin of the name.&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;+1, we definitely need both. Whenever a bug is hit it&apos;s best to make a very specific non-randomized test case showing the bug, fix the bug, and then see that the test passes.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Lets do that.&lt;/p&gt;</comment>
                            <comment id="13974106" author="tilman" created="Fri, 18 Apr 2014 14:15:56 +0000"  >&lt;p&gt;Changed the title and set to resolve because we&apos;re wrapping up. The LZW bug has been fixed. I will open a new issue re: better tests. (Update: see &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2034&quot; title=&quot;TestFilters is non-deterministic&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2034&quot;&gt;&lt;del&gt;PDFBOX-2034&lt;/del&gt;&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2036&quot; title=&quot;Add test with LZW fail sequence&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2036&quot;&gt;&lt;del&gt;PDFBOX-2036&lt;/del&gt;&lt;/a&gt;)&lt;/p&gt;</comment>
                            <comment id="13987374" author="lehmi" created="Fri, 2 May 2014 06:12:01 +0000"  >&lt;p&gt;Closed after releasing PDFBox 1.8.5&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13322086">PDFBOX-4933</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>379239</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 29 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1tcgn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>379531</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>