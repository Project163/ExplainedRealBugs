<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:14:57 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PDFBOX-5882] The pattern created with PDFBox shows inconsistent colors between Safari and Adobe.</title>
                <link>https://issues.apache.org/jira/browse/PDFBOX-5882</link>
                <project id="12310760" key="PDFBOX">PDFBox</project>
                    <description>&lt;p&gt;The pattern created with PDFBox shows inconsistent colors between Safari and Adobe.&lt;/p&gt;

&lt;p&gt;It appears red in Adobe and Chrome, which is correct.&lt;/p&gt;

&lt;p&gt;It appears blue in Safari, which is incorrect.&lt;/p&gt;

&lt;p&gt;Here is the example code:&lt;/p&gt;


&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; (PDDocument document = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; PDDocument()) {
            PDPage page = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; PDPage();
            document.addPage(page);
            
            &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; (PDPageContentStream contentStream = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; PDPageContentStream(document, page)) {
                PDTilingPattern pattern = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; PDTilingPattern();
                pattern.setBBox(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; PDRectangle(3, 3));
                pattern.setPaintType(PDTilingPattern.PAINT_UNCOLORED);
                pattern.setTilingType(PDTilingPattern.TILING_CONSTANT_SPACING);
                pattern.setXStep(3);
                pattern.setYStep(3);
                pattern.setMatrix(Matrix.getScaleInstance(1, 1).createAffineTransform());
                &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; (PDPatternContentStream patternContentStream = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; PDPatternContentStream(pattern)) {
                    patternContentStream.setLineWidth(0.4f);
                    patternContentStream.moveTo(0, 2);
                    patternContentStream.lineTo(0, 3);
                    patternContentStream.lineTo(2, 3);
                    patternContentStream.lineTo(2, 2);
                    patternContentStream.lineTo(3, 2);
                    patternContentStream.lineTo(3, 0);
                    patternContentStream.lineTo(2, 0);
                    patternContentStream.lineTo(2, 1);
                    patternContentStream.lineTo(1, 1);
                    patternContentStream.lineTo(1, 2);
                    patternContentStream.closePath();
                    patternContentStream.fill();
                } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (IOException e) {
                    &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; RuntimeException(e);
                };
                COSName patternName = page.getResources().add(pattern);
                PDPattern pdPattern = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; PDPattern(page.getResources(), PDDeviceRGB.INSTANCE);
                PDColor pdColor = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; PDColor(Color.RED.getComponents(&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;), patternName, pdPattern);
                contentStream.setNonStrokingColor(pdColor);
                contentStream.addRect(100, 500, 400, 200);
                contentStream.fill();
            }

            document.save(&lt;span class=&quot;code-quote&quot;&gt;&quot;excel_pattern_fill.pdf&quot;&lt;/span&gt;);
        }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;


&lt;p&gt;*&lt;b&gt;Safari:&lt;/b&gt;*&lt;br/&gt;
 &lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/13072017/13072017_image-2024-10-08-16-04-32-344.png&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt; &lt;/p&gt;

&lt;p&gt;Adobe:&lt;br/&gt;
 &lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/13072016/13072016_image-2024-10-08-16-04-49-033.png&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt; &lt;/p&gt;

&lt;p&gt;The exported pdf file : excel_pattern_fill.pdf&lt;/p&gt;</description>
                <environment></environment>
        <key id="13594598">PDFBOX-5882</key>
            <summary>The pattern created with PDFBox shows inconsistent colors between Safari and Adobe.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tilman">Tilman Hausherr</assignee>
                                    <reporter username="berylbai">bai yuan</reporter>
                        <labels>
                    </labels>
                <created>Tue, 8 Oct 2024 08:06:10 +0000</created>
                <updated>Thu, 16 Jan 2025 16:44:23 +0000</updated>
                            <resolved>Tue, 8 Oct 2024 09:42:13 +0000</resolved>
                                    <version>2.0.24</version>
                    <version>2.0.32</version>
                    <version>3.0.3 PDFBox</version>
                                    <fixVersion>2.0.33</fixVersion>
                    <fixVersion>3.0.4 PDFBox</fixVersion>
                    <fixVersion>4.0.0</fixVersion>
                                    <component>PDModel</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="17887515" author="tilman" created="Tue, 8 Oct 2024 08:27:51 +0000"  >&lt;p&gt;That&apos;s because &lt;tt&gt;Color.RED.getComponents(null)&lt;/tt&gt; returns a 4 component array, which includes the alpha, so this appears as &lt;tt&gt;1 0 0 1 /p1 scn&lt;/tt&gt; in the PDF (4 components instead of 3). I suspect Safari uses the last 3 components, while the others including PDFBox use the first 3. Use &lt;tt&gt;new float[] {1,0,0&lt;/tt&gt;} instead.&lt;/p&gt;</comment>
                            <comment id="17887517" author="tilman" created="Tue, 8 Oct 2024 08:29:59 +0000"  >&lt;p&gt;Here&apos;s a file generated with the correct code:  &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/13072018/13072018_excel_pattern_fill-fixed.pdf&quot; title=&quot;excel_pattern_fill-fixed.pdf attached to PDFBOX-5882&quot;&gt;excel_pattern_fill-fixed.pdf&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt; &lt;/p&gt;</comment>
                            <comment id="17887521" author="tilman" created="Tue, 8 Oct 2024 08:50:12 +0000"  >&lt;p&gt;I&apos;m testing adding a check in PDColor constructor.&lt;/p&gt;</comment>
                            <comment id="17887530" author="jira-bot" created="Tue, 8 Oct 2024 09:40:30 +0000"  >&lt;p&gt;Commit 1921185 from Tilman Hausherr in branch &apos;pdfbox/branches/3.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1921185&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1921185&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-5882&quot; title=&quot;The pattern created with PDFBox shows inconsistent colors between Safari and Adobe.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-5882&quot;&gt;&lt;del&gt;PDFBOX-5882&lt;/del&gt;&lt;/a&gt;: add warning if component count doesn&apos;t match colorspace&lt;/p&gt;</comment>
                            <comment id="17887531" author="jira-bot" created="Tue, 8 Oct 2024 09:40:35 +0000"  >&lt;p&gt;Commit 1921186 from Tilman Hausherr in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1921186&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1921186&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-5882&quot; title=&quot;The pattern created with PDFBox shows inconsistent colors between Safari and Adobe.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-5882&quot;&gt;&lt;del&gt;PDFBOX-5882&lt;/del&gt;&lt;/a&gt;: add warning if component count doesn&apos;t match colorspace&lt;/p&gt;</comment>
                            <comment id="17887532" author="jira-bot" created="Tue, 8 Oct 2024 09:40:40 +0000"  >&lt;p&gt;Commit 1921187 from Tilman Hausherr in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1921187&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1921187&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-5882&quot; title=&quot;The pattern created with PDFBox shows inconsistent colors between Safari and Adobe.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-5882&quot;&gt;&lt;del&gt;PDFBOX-5882&lt;/del&gt;&lt;/a&gt;: add warning if component count doesn&apos;t match colorspace&lt;/p&gt;</comment>
                            <comment id="17887535" author="tilman" created="Tue, 8 Oct 2024 09:42:13 +0000"  >&lt;p&gt;I&apos;ve added a warning. My original idea was to throw an exception, but these might happen in rendering in some cases so the warning is a compromise.&lt;/p&gt;

&lt;p&gt;Update: it does happen, e.g. with file &lt;tt&gt;pop-bugzilla62905.pdf&lt;/tt&gt; from &lt;a href=&quot;https://bugs.freedesktop.org/show_bug.cgi?id=62905&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://bugs.freedesktop.org/show_bug.cgi?id=62905&lt;/a&gt; .&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="13072018" name="excel_pattern_fill-fixed.pdf" size="1025" author="tilman" created="Tue, 8 Oct 2024 08:29:38 +0000"/>
                            <attachment id="13072015" name="excel_pattern_fill.pdf" size="1095" author="berylbai" created="Tue, 8 Oct 2024 08:05:21 +0000"/>
                            <attachment id="13072017" name="image-2024-10-08-16-04-32-344.png" size="262284" author="berylbai" created="Tue, 8 Oct 2024 08:04:34 +0000"/>
                            <attachment id="13072016" name="image-2024-10-08-16-04-49-033.png" size="200019" author="berylbai" created="Tue, 8 Oct 2024 08:04:51 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 4 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1rug0:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>