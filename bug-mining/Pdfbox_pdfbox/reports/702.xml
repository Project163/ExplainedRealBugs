<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 20:57:14 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PDFBOX-2324] Failure to render DeviceN image</title>
                <link>https://issues.apache.org/jira/browse/PDFBOX-2324</link>
                <project id="12310760" key="PDFBOX">PDFBox</project>
                    <description>&lt;p&gt;For the attached test PDF, the left image is rendered incorrect.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12739564">PDFBOX-2324</key>
            <summary>Failure to render DeviceN image</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tilman">Tilman Hausherr</assignee>
                                    <reporter username="tilman">Tilman Hausherr</reporter>
                        <labels>
                            <label>CIELAB</label>
                            <label>DeviceN</label>
                    </labels>
                <created>Fri, 5 Sep 2014 18:56:08 +0000</created>
                <updated>Thu, 17 Mar 2016 19:07:05 +0000</updated>
                            <resolved>Fri, 12 Dec 2014 11:20:37 +0000</resolved>
                                    <version>2.0.0</version>
                                    <fixVersion>2.0.0</fixVersion>
                                    <component>Rendering</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="14125394" author="tilman" created="Mon, 8 Sep 2014 10:43:32 +0000"  >&lt;p&gt;The problem image on the left is an index colorspace, which references a DeviceN colorspace. &lt;br/&gt;
To create the index PDFBox uses a height 1 BufferedImage that has all the colors in a row. &lt;br/&gt;
It doesn&apos;t have to, but typically that image is a gradient.&lt;br/&gt;
For this file, two such images are created, one is a gradient, the other one has the same &quot;crazy&quot; colors as seen in the rendering.&lt;/p&gt;

&lt;p&gt;The alternate colorspace of the DeviceN colorspace is a Lab colorspace. PDFBox converts the DeviceN values to Lab values, for which a type 4 function is used. Type4 functions are made of a subset of postscript commands. (I traced through the type 4 function, it works as described) &lt;/p&gt;

&lt;p&gt;PDDeviceN divides the values by 255 before calling the function. After the function, it multiplies them with 255. Which is not correct, because the function returns values that are in the /Range &lt;span class=&quot;error&quot;&gt;&amp;#91;0.0 100.0 -128.0 127.0 -128.0 127.0&amp;#93;&lt;/span&gt;. &lt;br/&gt;
These incorrect values are then assigned to the raster, which probably makes a modulo 255, so &quot;crazy&quot; colors appear.&lt;/p&gt;

&lt;p&gt;A first solution was to assign the values &quot;as is&quot; to the raster. For the first time the turtle on the left appeared, although in green.&lt;/p&gt;

&lt;p&gt;That indicates that there must be some adjustment before assigning to the raster. However this would mean putting colorspace-specific code.&lt;/p&gt;

&lt;p&gt;Instead I switched to using the pixel converter. (See also &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-1997&quot; title=&quot;CIE LAB item missing in rendering&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-1997&quot;&gt;&lt;del&gt;PDFBOX-1997&lt;/del&gt;&lt;/a&gt; which had a similar problem).&lt;/p&gt;</comment>
                            <comment id="14125397" author="jira-bot" created="Mon, 8 Sep 2014 10:47:53 +0000"  >&lt;p&gt;Commit 1623353 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1623353&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1623353&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2324&quot; title=&quot;Failure to render DeviceN image&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2324&quot;&gt;&lt;del&gt;PDFBOX-2324&lt;/del&gt;&lt;/a&gt;: use the pixel converter instead of the raster converter to avoid scale problems with /Lab colorspace; set method called in constructor final to avoid override&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12666863" name="GWG080_DeviceN-Support_6c_x3.pdf" size="1747523" author="tilman" created="Fri, 5 Sep 2014 18:58:07 +0000"/>
                            <attachment id="12666861" name="GWG080_DeviceN-Support_6c_x31.jpg" size="97516" author="tilman" created="Fri, 5 Sep 2014 18:57:07 +0000"/>
                            <attachment id="12667155" name="gwg080_devicen-support_6c_x3.pdf-1.png" size="308964" author="tilman" created="Mon, 8 Sep 2014 10:43:32 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 10 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1zqm7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>