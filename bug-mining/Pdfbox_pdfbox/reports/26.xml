<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 20:52:12 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PDFBOX-659] Newlines added in the middle of words</title>
                <link>https://issues.apache.org/jira/browse/PDFBOX-659</link>
                <project id="12310760" key="PDFBOX">PDFBox</project>
                    <description>&lt;p&gt;I am experiencing issues getting the text from a PDF document. The document I want to get the text is a scientific paper.&lt;br/&gt;
The tool works fine, but in the title there are some problems: in the middle of some words I get a newline.&lt;br/&gt;
An example of what I am getting is the following text:&lt;/p&gt;

&lt;p&gt;An&lt;br/&gt;
Asp&lt;br/&gt;
e&lt;br/&gt;
ct-Orien&lt;br/&gt;
ted&lt;br/&gt;
F&lt;br/&gt;
ramew&lt;br/&gt;
o&lt;br/&gt;
rk&lt;br/&gt;
for&lt;br/&gt;
S&lt;br/&gt;
ervice&lt;br/&gt;
A&lt;br/&gt;
d&lt;br/&gt;
aptation&lt;/p&gt;

&lt;p&gt;rather than the expected &quot;An Aspect-Oriented Framework for Service Adaptation&quot;.&lt;/p&gt;

&lt;p&gt;Please let me know if I may help finding the bug&lt;/p&gt;</description>
                <environment></environment>
        <key id="12458873">PDFBOX-659</key>
            <summary>Newlines added in the middle of words</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="mariosangiorgio">Mario Sangiorgio</reporter>
                        <labels>
                    </labels>
                <created>Fri, 12 Mar 2010 00:13:20 +0000</created>
                <updated>Thu, 1 Jul 2010 07:26:44 +0000</updated>
                            <resolved>Sun, 16 May 2010 17:54:29 +0000</resolved>
                                    <version>0.8.0-incubator</version>
                                    <fixVersion>1.2.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12844298" author="mariosangiorgio" created="Fri, 12 Mar 2010 00:35:10 +0000"  >&lt;p&gt;I also tried the 1.0 version of PDFBox, but unfortunately the results I am getting are even worse.&lt;br/&gt;
The title is screwed up and also most of the words of the body that were properly converted now have some defects.&lt;/p&gt;</comment>
                            <comment id="12844388" author="lehmi" created="Fri, 12 Mar 2010 06:49:07 +0000"  >&lt;p&gt;Is it possible to provide us with a sample pdf showing that behaviour?&lt;/p&gt;</comment>
                            <comment id="12844510" author="m.martinez" created="Fri, 12 Mar 2010 14:24:07 +0000"  >&lt;p&gt;Thanks for uploading the example file.&lt;/p&gt;

&lt;p&gt;I&apos;ve reproduced the behavior with it.&lt;/p&gt;

&lt;p&gt;I should be able to spend some time today looking at this one.&lt;/p&gt;</comment>
                            <comment id="12844512" author="m.martinez" created="Fri, 12 Mar 2010 14:27:17 +0000"  >&lt;p&gt;It&apos;s worse than just the insertion of newlines.  Characters are getting dropped and/or replaced with wrong characters.&lt;/p&gt;

&lt;p&gt;I haven&apos;t seen this before with any other PDFs.  How was this one created?&lt;/p&gt;</comment>
                            <comment id="12844518" author="m.martinez" created="Fri, 12 Mar 2010 14:34:48 +0000"  >&lt;p&gt;Answering my own question:&lt;/p&gt;

&lt;p&gt;creator: LaTeX with hyperref package&lt;br/&gt;
creation-date: 2006-10-23T04:28:18-0400&lt;br/&gt;
modification-date: 2006-11-22T22:29:18-0500&lt;br/&gt;
producer: Acrobat Distiller 7.0 (Windows)&lt;/p&gt;

&lt;p&gt;Nothing unusual there.  &lt;/p&gt;
</comment>
                            <comment id="12844548" author="vfed" created="Fri, 12 Mar 2010 15:46:27 +0000"  >&lt;p&gt;I ran this document through my PDF debugging utility and I noticed that the page contents is shifted up and right. The text that falls &quot;off the page&quot; becomes misplaced.&lt;/p&gt;</comment>
                            <comment id="12844680" author="mariosangiorgio" created="Fri, 12 Mar 2010 21:06:09 +0000"  >&lt;p&gt;Does it mean that it is actually an issue of the document rather than an issue of the library?&lt;br/&gt;
Do you have any suggestion on how could I fix the document?&lt;/p&gt;</comment>
                            <comment id="12844725" author="m.martinez" created="Fri, 12 Mar 2010 22:32:13 +0000"  >&lt;p&gt;Okay - Villu&apos;s comment plus some things I&apos;m seeing suggest its a combo effect.&lt;/p&gt;

&lt;p&gt;First off the document renders perfectly in Acrobat Reader so that suggests that whatever is going on in the document is probably &apos;legal&apos; or at least something we should be able to handle.&lt;/p&gt;

&lt;p&gt;Villu&apos;s comment indicates that coordinates are shifted.&lt;/p&gt;

&lt;p&gt;When I step through the &apos;rendering&apos; of the individual TextPosition objects I note that for the messed up text, the Y coordinates are shifted into negative space.&lt;/p&gt;

&lt;p&gt;This shouldn&apos;t be a problem - we should be rendering them against an offset origin - all that matters is their relative positions.  That&apos;s why Acrobat Reader renders them correctly.&lt;/p&gt;

&lt;p&gt;However, when we do our text extraction, our &apos;text rendering&apos; process includes a step to determine if a TextPosition object is still on the same line as the prior TextPosition object.  To do this, it compares the current Y position and Y height to the prior Y position and height.   This is fine, except for the first time you go through it, it needs some sort of default that it can compare to.  The code uses -1.0 as the default &apos;last&apos; Y position.  From that point, as it iterates through, if the current position is above the last Y position, it resets the last Y position variable to the current position.&lt;/p&gt;

&lt;p&gt;Do you see the problem?  If all the text is being renderded in negative Y space, then ALL the Y values are never &apos;above&apos; the -1.0 value used as the default to start the iteration.  So it never properly resets the &apos;last Y position&apos;.  This causes it to incorrectly think it is on a new line when it really isn&apos;t.  Hence it inserts the newline characters.&lt;/p&gt;

&lt;p&gt;I&apos;ll have to think this through a bit to make sure the solution is a bit more robust.  But I should be able to post a patch early next week.&lt;/p&gt;

&lt;p&gt;This also affects my PDFTextStripper2 class ( &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-521&quot; title=&quot;Improved PDF Text Extraction that notes paragraph boundaries&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-521&quot;&gt;&lt;del&gt;PDFBOX-521&lt;/del&gt;&lt;/a&gt; ) so I will patch that at the same time.&lt;/p&gt;</comment>
                            <comment id="12844750" author="tdunning" created="Fri, 12 Mar 2010 23:15:53 +0000"  >
&lt;p&gt;Sounds like (- Double.MAX_VALUE) is a reasonable candidate in place of -1.&lt;/p&gt;

&lt;p&gt;And remember, I have a patent on thinking that Double.MIN_VALUE is the most negative double precision number available.  You guys aren&apos;t allowed to make that mistake.&lt;/p&gt;
</comment>
                            <comment id="12845553" author="m.martinez" created="Mon, 15 Mar 2010 22:00:32 +0000"  >&lt;p&gt;The attached patch fixes the problem of incorrectly inserted newlines.&lt;/p&gt;

&lt;p&gt;The problem was (as described above) due to TextPosition coords using negative space and the code incorrectly using a reset comparision value of &apos;-1.0&apos;.&lt;/p&gt;

&lt;p&gt;This patch does not fix some additional problems that surface with the example .pdf file that include the following:&lt;/p&gt;

&lt;p&gt;Missing space characters (words are arbitrarily catenated together) and missing characters.&lt;/p&gt;

&lt;p&gt;The missing space characters can be recovered by setting the value of:&lt;/p&gt;

&lt;p&gt;PDFTextStripper.setSpacingTolerance(float tolerance)&lt;/p&gt;

&lt;p&gt;To a value smaller than the default (0.5).  I had to drop it quite a bit with this document and still did not recover all the spaces.&lt;/p&gt;

&lt;p&gt;The missing characters are caused by the default mode of suppressing what the code believes to be duplicate, overlapping characters.  This can occur with MS Word-generated PDFs.  You can stop that behavior by setting the attribute:&lt;/p&gt;

&lt;p&gt;PDFTextStripper.setSuppressDuplicateOverlappingText(boolean suppress);&lt;/p&gt;

&lt;p&gt;to a false.&lt;/p&gt;

&lt;p&gt;That said, the logic used when this is set to &apos;true&apos; looks flawed.  I will open a separate bug for that.&lt;/p&gt;</comment>
                            <comment id="12868016" author="lehmi" created="Sun, 16 May 2010 17:54:29 +0000"  >&lt;p&gt;I&apos;ve applied the patch with version 944887.&lt;/p&gt;

&lt;p&gt;Thanks to Mel fpr the contribution&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310010">
                    <name>Incorporates</name>
                                                                <inwardlinks description="is part of">
                                        <issuelink>
            <issuekey id="12435139">PDFBOX-521</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12459201">PDFBOX-662</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12438593" name="fulltext.pdf" size="896594" author="mariosangiorgio" created="Fri, 12 Mar 2010 08:48:50 +0000"/>
                            <attachment id="12438618" name="page.png" size="193824" author="vfed" created="Fri, 12 Mar 2010 15:46:27 +0000"/>
                            <attachment id="12438863" name="patch_pdfbox_659.txt" size="3536" author="m.martinez" created="Mon, 15 Mar 2010 22:00:32 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>163405</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 years, 27 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0zgg7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>204967</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>