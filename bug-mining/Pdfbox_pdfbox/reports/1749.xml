<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:06:00 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PDFBOX-3791] Long rendering time</title>
                <link>https://issues.apache.org/jira/browse/PDFBOX-3791</link>
                <project id="12310760" key="PDFBOX">PDFBox</project>
                    <description>&lt;p&gt;Attached pdf file takes too long (more then 9 secs) to render in PDFDebugger (this is a simplified version of a real life pdf that I can not publish for privacy reasons, it takes 57 seconds to render and it contains 56 images and some text).&lt;/p&gt;

&lt;p&gt;I have tried with the options provided in &lt;a href=&quot;https://pdfbox.apache.org/2.0/getting-started.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://pdfbox.apache.org/2.0/getting-started.html&lt;/a&gt; but performance is the same&lt;/p&gt;</description>
                <environment>windows</environment>
        <key id="13071318">PDFBOX-3791</key>
            <summary>Long rendering time</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tilman">Tilman Hausherr</assignee>
                                    <reporter username="eruiz0">Esteban Nicolas Ruiz</reporter>
                        <labels>
                            <label>optimization</label>
                    </labels>
                <created>Thu, 11 May 2017 20:22:06 +0000</created>
                <updated>Mon, 15 May 2017 20:28:14 +0000</updated>
                            <resolved>Fri, 12 May 2017 11:38:37 +0000</resolved>
                                    <version>2.0.5</version>
                                    <fixVersion>2.0.6</fixVersion>
                    <fixVersion>3.0.0 PDFBox</fixVersion>
                                    <component>Rendering</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="16007239" author="tilman" created="Thu, 11 May 2017 21:34:45 +0000"  >&lt;p&gt;The page contains 11 300dpi JPEG images, it is similar to the files in &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-1350&quot; title=&quot;OutOfMemory on reading FlateFilter images in PDF&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-1350&quot;&gt;&lt;del&gt;PDFBOX-1350&lt;/del&gt;&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2035&quot; title=&quot;Ignore badly formatted toUnicode CMaps&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2035&quot;&gt;&lt;del&gt;PDFBOX-2035&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="16007769" author="tilman" created="Fri, 12 May 2017 07:58:52 +0000"  >&lt;p&gt;Some thoughts after profiling... Most time is spent in&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;graphics.drawImage - this we can&apos;t change, or the quality would go down&lt;/li&gt;
	&lt;li&gt;ImageReader.read - can&apos;t change&lt;/li&gt;
	&lt;li&gt;DCTFilter.fromBGRtoRGB - maybe write on the source raster instead of making a copy? Won&apos;t make it faster but will lessen the memory footprint.&lt;/li&gt;
	&lt;li&gt;ScratchFileBuffer.read - it is called with small chunks in SampledImageReader.from8bit, the bytes for 1 pixel, thus usually only 3 bytes at a time. This was done in &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2301&quot; title=&quot;RandomAccessBuffer consumes too much memory.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2301&quot;&gt;&lt;del&gt;PDFBOX-2301&lt;/del&gt;&lt;/a&gt; [ &lt;a href=&quot;https://svn.apache.org/r1684745&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1684745&lt;/a&gt; ] to lessen the memory footprint. Reverting that change makes it about 20% faster but increases the memory footprint, obviously. Maybe make a compromise by reading one row at a time.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="16007903" author="jira-bot" created="Fri, 12 May 2017 10:01:26 +0000"  >&lt;p&gt;Commit 1794950 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1794950&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1794950&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3791&quot; title=&quot;Long rendering time&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3791&quot;&gt;&lt;del&gt;PDFBOX-3791&lt;/del&gt;&lt;/a&gt;: read image one row at a time, not one pixel at a time due to overhead in our buffer infrastructure&lt;/p&gt;</comment>
                            <comment id="16007904" author="jira-bot" created="Fri, 12 May 2017 10:01:32 +0000"  >&lt;p&gt;Commit 1794951 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1794951&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1794951&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3791&quot; title=&quot;Long rendering time&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3791&quot;&gt;&lt;del&gt;PDFBOX-3791&lt;/del&gt;&lt;/a&gt;: read image one row at a time, not one pixel at a time due to overhead in our buffer infrastructure&lt;/p&gt;</comment>
                            <comment id="16007990" author="tilman" created="Fri, 12 May 2017 11:37:47 +0000"  >&lt;p&gt;I tried optimizing the index in &lt;tt&gt;tempBytes[x * numComponents + c]&lt;/tt&gt; by using an extra variable j that would be incremented. This would save 1/2 sec in profiling but in real life it was similar or even slower so I&apos;ll just leave it as it is.&lt;/p&gt;

&lt;p&gt;That&apos;s all I can do for now. I&apos;ll do the memory optimization in DCTFilter.java after the release because I want to have more time for feedback. You can also try using the twelvemonkeys jpeg library, I don&apos;t know if it is faster but it is certainly better (less bugs).&lt;/p&gt;

&lt;p&gt;You can also build from source and have a look at &lt;tt&gt;PageDrawer.setRenderingHints()&lt;/tt&gt; and play with the parameters. This should make it faster but it may not look good.&lt;/p&gt;

&lt;p&gt;Your test file took about 16 secs before and now about 12 secs on my (old) PC.&lt;/p&gt;</comment>
                            <comment id="16008119" author="eruiz0" created="Fri, 12 May 2017 13:25:10 +0000"  >&lt;p&gt;I tried with the snapshot. It takes 7,97 secs now in my computer.&lt;/p&gt;

&lt;p&gt;Rendering time for the real life pdf decreased from 57 secs to 48 secs.&lt;/p&gt;</comment>
                            <comment id="16009303" author="tilman" created="Sat, 13 May 2017 12:22:58 +0000"  >&lt;blockquote&gt;
&lt;p&gt;I&apos;ll do the memory optimization in DCTFilter.java after the release because I want to have more time for feedback.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I tested different -Xmx options. Without the change (keep using &lt;tt&gt;raster.createCompatibleWritableRaster()&lt;/tt&gt;) it works with -Xmx140m but not 130. With the change (cast existing raster) it needs -Xmx160m to render the file. Very weird... so I&apos;ll leave that one untouched.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12867644" name="slowrender.pdf" size="1163166" author="eruiz0" created="Thu, 11 May 2017 20:22:06 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 27 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3ev0v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>