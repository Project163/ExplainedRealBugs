<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 20:58:27 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PDFBOX-2419] XFDF export is not XML compliant</title>
                <link>https://issues.apache.org/jira/browse/PDFBOX-2419</link>
                <project id="12310760" key="PDFBOX">PDFBox</project>
                    <description>&lt;p&gt;The XFDF content is written as a simple string instead of XML nodes.&lt;br/&gt;
As a result, field values containing special characters (&amp;amp;, &amp;lt;, &amp;gt;, ...) are not escaped and the resulting XML is invalid.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12746988">PDFBOX-2419</key>
            <summary>XFDF export is not XML compliant</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="lehmi">Andreas Lehmk&#252;hler</assignee>
                                    <reporter username="lrichard">Laurent Richard</reporter>
                        <labels>
                            <label>FDF</label>
                    </labels>
                <created>Thu, 9 Oct 2014 10:42:40 +0000</created>
                <updated>Sat, 13 Dec 2014 14:15:01 +0000</updated>
                            <resolved>Sun, 2 Nov 2014 14:50:46 +0000</resolved>
                                    <version>1.8.7</version>
                                    <fixVersion>1.8.8</fixVersion>
                    <fixVersion>2.0.0</fixVersion>
                                    <component>AcroForm</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="14184072" author="lehmi" created="Sat, 25 Oct 2014 12:18:52 +0000"  >&lt;p&gt;Please add a sample fdf file.&lt;/p&gt;</comment>
                            <comment id="14185117" author="lrichard" created="Mon, 27 Oct 2014 13:14:52 +0000"  >&lt;p&gt;The problem is specific to XML format XFDF where special characters should be escaped. There&apos;s no issue with FDF.&lt;br/&gt;
I join a sample PDF file with simple AcroForm containing such characters.&lt;br/&gt;
With code like&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;PDDocument pdf = PDDocument.load(&lt;span class=&quot;code-quote&quot;&gt;&quot;SampleForm.pdf&quot;&lt;/span&gt;);
PDAcroForm form = pdf.getDocumentCatalog().getAcroForm();
FDFDocument fdf = form.exportFDF();
List&amp;lt;FDFField&amp;gt; fields = fdf.getCatalog().getFDF().getFields();
StringWriter writer = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; StringWriter();
fdf.saveXFDF(writer);
&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; writer.toString();
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;We get the following content&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&amp;lt;?xml version=&lt;span class=&quot;code-quote&quot;&gt;&quot;1.0&quot;&lt;/span&gt; encoding=&lt;span class=&quot;code-quote&quot;&gt;&quot;UTF-8&quot;&lt;/span&gt;?&amp;gt;
&amp;lt;xfdf xmlns=&lt;span class=&quot;code-quote&quot;&gt;&quot;http:&lt;span class=&quot;code-comment&quot;&gt;//ns.adobe.com/xfdf/&quot;&lt;/span&gt; xml:space=&lt;span class=&quot;code-quote&quot;&gt;&quot;preserve&quot;&lt;/span&gt;&amp;gt;
&lt;/span&gt;&amp;lt;ids original=&lt;span class=&quot;code-quote&quot;&gt;&quot;40DE256FBEC20B428C72BCF68015AB9E&quot;&lt;/span&gt; modified=&lt;span class=&quot;code-quote&quot;&gt;&quot;3E3C2606FFB360C3FA74D3921A630318&quot;&lt;/span&gt; /&amp;gt;
&amp;lt;fields&amp;gt;
&amp;lt;field name=&lt;span class=&quot;code-quote&quot;&gt;&quot;choix_1_J-64ncBSov7NcPeTY8oJ3A&quot;&lt;/span&gt;&amp;gt;
&amp;lt;value&amp;gt;Oui&amp;lt;/value&amp;gt;
&amp;lt;/field&amp;gt;
&amp;lt;field name=&lt;span class=&quot;code-quote&quot;&gt;&quot;prenom_By11Gk3puTlnwwnv4WA0-g&quot;&lt;/span&gt;&amp;gt;
&amp;lt;value&amp;gt;special XML characters &amp;amp;lt; &amp;amp;gt; &amp;amp;amp;&amp;lt;/value&amp;gt;
&amp;lt;/field&amp;gt;
&amp;lt;field name=&lt;span class=&quot;code-quote&quot;&gt;&quot;nom_yQacEuz649N*BJguviO5Ow&quot;&lt;/span&gt;&amp;gt;
&amp;lt;value&amp;gt;special XML characters &amp;lt; &amp;gt; &amp;amp;&amp;lt;/value&amp;gt;
&amp;lt;/field&amp;gt;
&amp;lt;/fields&amp;gt;
&amp;lt;/xfdf&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;which is not valid XML since &apos;&amp;lt;&apos;, &apos;&amp;gt;&apos; and &apos;&amp;amp;&apos; should be escaped. The right result would be :&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&amp;lt;?xml version=&lt;span class=&quot;code-quote&quot;&gt;&quot;1.0&quot;&lt;/span&gt; encoding=&lt;span class=&quot;code-quote&quot;&gt;&quot;UTF-8&quot;&lt;/span&gt;?&amp;gt;
&amp;lt;xfdf xmlns=&lt;span class=&quot;code-quote&quot;&gt;&quot;http:&lt;span class=&quot;code-comment&quot;&gt;//ns.adobe.com/xfdf/&quot;&lt;/span&gt; xml:space=&lt;span class=&quot;code-quote&quot;&gt;&quot;preserve&quot;&lt;/span&gt;&amp;gt;
&lt;/span&gt;&amp;lt;ids original=&lt;span class=&quot;code-quote&quot;&gt;&quot;40DE256FBEC20B428C72BCF68015AB9E&quot;&lt;/span&gt; modified=&lt;span class=&quot;code-quote&quot;&gt;&quot;3E3C2606FFB360C3FA74D3921A630318&quot;&lt;/span&gt; /&amp;gt;
&amp;lt;fields&amp;gt;
&amp;lt;field name=&lt;span class=&quot;code-quote&quot;&gt;&quot;choix_1_J-64ncBSov7NcPeTY8oJ3A&quot;&lt;/span&gt;&amp;gt;
&amp;lt;value&amp;gt;Oui&amp;lt;/value&amp;gt;
&amp;lt;/field&amp;gt;
&amp;lt;field name=&lt;span class=&quot;code-quote&quot;&gt;&quot;prenom_By11Gk3puTlnwwnv4WA0-g&quot;&lt;/span&gt;&amp;gt;
&amp;lt;value&amp;gt;special XML characters &amp;amp;amp;lt; &amp;amp;amp;gt; &amp;amp;amp;amp;&amp;lt;/value&amp;gt;
&amp;lt;/field&amp;gt;
&amp;lt;field name=&lt;span class=&quot;code-quote&quot;&gt;&quot;nom_yQacEuz649N*BJguviO5Ow&quot;&lt;/span&gt;&amp;gt;
&amp;lt;value&amp;gt;special XML characters &amp;amp;lt; &amp;amp;gt; &amp;amp;amp;&amp;lt;/value&amp;gt;
&amp;lt;/field&amp;gt;
&amp;lt;/fields&amp;gt;
&amp;lt;/xfdf&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Ideally, relying on JAXP (Java API for XML Processing) instead of manipulating directly a String content would handle such things.&lt;/p&gt;</comment>
                            <comment id="14185135" author="lrichard" created="Mon, 27 Oct 2014 13:51:47 +0000"  >&lt;p&gt;By the way, here is our workaround code until the problem has been fixed in PdfBox&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; extractXFDF() {
        &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
            @Cleanup
            PDDocument pdf = PDDocument.load(pdfFileName);
            pdf.setAllSecurityToBeRemoved(&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;);
            PDAcroForm form = pdf.getDocumentCatalog().getAcroForm();
            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (form == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
                &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Pdf2OpxException(&lt;span class=&quot;code-quote&quot;&gt;&quot;PDF file contains no Acroform&quot;&lt;/span&gt;);
            }
            @Cleanup
            FDFDocument fdf = form.exportFDF();
            @SuppressWarnings(&lt;span class=&quot;code-quote&quot;&gt;&quot;unchecked&quot;&lt;/span&gt;)
            List&amp;lt;FDFField&amp;gt; fields = fdf.getCatalog().getFDF().getFields();
            sanitize(fields); &lt;span class=&quot;code-comment&quot;&gt;// cf https://issues.apache.org/jira/browse/PDFBOX-2419
&lt;/span&gt;            @Cleanup
            StringWriter writer = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; StringWriter();
            fdf.saveXFDF(writer);
            &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; writer.toString();
        } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (COSVisitorException e) {
            &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Pdf2OpxException(&lt;span class=&quot;code-quote&quot;&gt;&quot;exception &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; extracting XFDF&quot;&lt;/span&gt;, e);
        } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (IOException e) {
            &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Pdf2OpxException(&lt;span class=&quot;code-quote&quot;&gt;&quot;exception &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; reading PDF&quot;&lt;/span&gt;, e);
        }
    }

    &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; void sanitize(List&amp;lt;FDFField&amp;gt; fields) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException {
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (fields != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
            &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (FDFField field : fields) {
                field.setValue(XmlEscapers.xmlContentEscaper().escape(field.getValue().toString()));
                sanitize(field.getKids());
            }
        }

    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The interesting part is in the sanitize method. We use Guava Escapers but it is simply a matter of replacing the three mentioned characters (&apos;&amp;lt;&apos;, &apos;&amp;gt;&apos; and &apos;&amp;amp;&apos;) by their XML escaped equivalents. It would be better to write correctly each field value directly rather than modifying them recursively afterwards.&lt;br/&gt;
It means that org.apache.pdfbox.pdmodel.fdf.FDFField.writeXML(Writer output) could be adjusted (even if a better approach would be to avoid using Strings directly in order to write XML).&lt;br/&gt;
I would have liked to submit a patch but I was unable to compile PdfBox (maven couldn&apos;t resolve dependencies such as com.levigo.jbig2:levigo-jbig2-imageio:jar:1.6.3)&lt;/p&gt;</comment>
                            <comment id="14193857" author="jira-bot" created="Sun, 2 Nov 2014 14:45:10 +0000"  >&lt;p&gt;Commit 1636140 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lehmi&quot; class=&quot;user-hover&quot; rel=&quot;lehmi&quot;&gt;lehmi&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1636140&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1636140&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2419&quot; title=&quot;XFDF export is not XML compliant&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2419&quot;&gt;&lt;del&gt;PDFBOX-2419&lt;/del&gt;&lt;/a&gt;: escape special characters&lt;/p&gt;</comment>
                            <comment id="14193859" author="jira-bot" created="Sun, 2 Nov 2014 14:46:38 +0000"  >&lt;p&gt;Commit 1636142 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lehmi&quot; class=&quot;user-hover&quot; rel=&quot;lehmi&quot;&gt;lehmi&lt;/a&gt; in branch &apos;pdfbox/branches/1.8&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1636142&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1636142&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2419&quot; title=&quot;XFDF export is not XML compliant&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2419&quot;&gt;&lt;del&gt;PDFBOX-2419&lt;/del&gt;&lt;/a&gt;: escape special characters&lt;/p&gt;</comment>
                            <comment id="14193860" author="lehmi" created="Sun, 2 Nov 2014 14:50:46 +0000"  >&lt;p&gt;I&apos;ve added an escapeXML method to replace special characters. This is just a workaround. We should replace the current implementation with one using JAXP. I&apos;ve created &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2472&quot; title=&quot;Switch XFDF export to an XML aware API&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2472&quot;&gt;PDFBOX-2472&lt;/a&gt; as a follow up.&lt;/p&gt;

&lt;p&gt;Thanks for the report and the analysis!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12677292" name="SampleForm.pdf" size="49164" author="lrichard" created="Mon, 27 Oct 2014 13:15:19 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 2 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i20zcf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>