<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 20:55:50 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PDFBOX-1922] NonSequentialParser not reading version in header and trailer</title>
                <link>https://issues.apache.org/jira/browse/PDFBOX-1922</link>
                <project id="12310760" key="PDFBOX">PDFBox</project>
                    <description>&lt;p&gt;On older pdf files, the NonSequentialParser returns a different PDFVersion than the traditional parser via the call: document.getDocument().getVersion().  &lt;/p&gt;

&lt;p&gt;I think this is because NonSequentialParser is not reading the header but relying on the default 1.4 if no version is found in the trailer.&lt;/p&gt;

&lt;p&gt;Many apologies if this is a duplicate.  I feel like I&apos;ve seen this issue elsewhere, but I can&apos;t track it down.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12695346">PDFBOX-1922</key>
            <summary>NonSequentialParser not reading version in header and trailer</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tilman">Tilman Hausherr</assignee>
                                    <reporter username="tallison">Tim Allison</reporter>
                        <labels>
                    </labels>
                <created>Sat, 15 Feb 2014 04:37:12 +0000</created>
                <updated>Sun, 22 Jun 2014 14:34:48 +0000</updated>
                            <resolved>Tue, 27 May 2014 13:55:11 +0000</resolved>
                                    <version>1.8.4</version>
                    <version>1.8.5</version>
                    <version>1.8.6</version>
                    <version>2.0.0</version>
                                    <fixVersion>1.8.6</fixVersion>
                    <fixVersion>2.0.0</fixVersion>
                                    <component>Parsing</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="13902325" author="tallison@mitre.org" created="Sat, 15 Feb 2014 04:41:59 +0000"  >&lt;p&gt;Test document to show issue...comes from Tika.  If this issue is being taken care of as part of &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-1792&quot; title=&quot;Different metadata with NonSequentialPDFParser&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-1792&quot;&gt;&lt;del&gt;PDFBOX-1792&lt;/del&gt;&lt;/a&gt;, please disregard.  Thank you!&lt;/p&gt;</comment>
                            <comment id="14000831" author="tilman" created="Sat, 17 May 2014 17:36:40 +0000"  >&lt;p&gt;The non sequential parser didn&apos;t have anything to read the header. I simply copied that part from the &quot;old&quot; parser and then did a seek(0) to restart as if I hadn&apos;t done anything. Now I&apos;m getting the same version numbers for load() and loadNonSeq() for all my test files. I committed this in rev 1595520 for the trunk and 1595527 for the 1.8 branch.&lt;/p&gt;

&lt;p&gt;Because this is &quot;too good to be true&quot;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tboehme&quot; class=&quot;user-hover&quot; rel=&quot;tboehme&quot;&gt;tboehme&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=msahyoun&quot; class=&quot;user-hover&quot; rel=&quot;msahyoun&quot;&gt;msahyoun&lt;/a&gt; please have a look &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tallison%40apache.org&quot; class=&quot;user-hover&quot; rel=&quot;tallison@apache.org&quot;&gt;tallison@apache.org&lt;/a&gt; Where is the version in the trailer?&lt;/p&gt;</comment>
                            <comment id="14001209" author="tilman" created="Sun, 18 May 2014 21:18:58 +0000"  >&lt;p&gt;DRY refactoring done in rev 1595687 for the trunk and rev 1595691 for the 1.8 branch. I hadn&apos;t noticed yesterday that parseHeader was already part of the parent class.&lt;/p&gt;</comment>
                            <comment id="14001624" author="tallison@mitre.org" created="Mon, 19 May 2014 12:08:00 +0000"  >&lt;p&gt; I was referring to section 7.5.2 (p. 39-40) (thanks to &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=johanvanderknijff&quot; class=&quot;user-hover&quot; rel=&quot;johanvanderknijff&quot;&gt;johanvanderknijff&lt;/a&gt; for making this point  on &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1232&quot; title=&quot;Add PDF version to PDFParser output&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1232&quot;&gt;&lt;del&gt;TIKA-1232&lt;/del&gt;&lt;/a&gt;):&lt;br/&gt;
&lt;a href=&quot;http://www.adobe.com/content/dam/Adobe/en/devnet/acrobat/pdfs/PDF32000_2008.pdf&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.adobe.com/content/dam/Adobe/en/devnet/acrobat/pdfs/PDF32000_2008.pdf&lt;/a&gt;.  &lt;/p&gt;

&lt;p&gt;The doc I attached only has the header.  Let me know if I should try to find or manufacture an Apache License friendly test doc with conflicting versions in the header and trailer.  &lt;/p&gt;</comment>
                            <comment id="14001923" author="tilman" created="Mon, 19 May 2014 15:53:47 +0000"  >&lt;p&gt;Yes a test doc would be nice, but it isn&apos;t urgent, I edit one myself to find the problem, but a license friendy test doc would be great to use it as a build test later. The header should be 1.3, the trailer should be 1.5. Currently loadNonSeq() doesn&apos;t recognize the trailer version. More work to do &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="14001959" author="msahyoun" created="Mon, 19 May 2014 16:31:24 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; I&#8217;d think that instead of setting the version the current way (which is replacing the version information in the header) during the parsing the parsing should keep both version informations and getVersion within COSDocument is amended to return the correct information. WDYT?&lt;/p&gt;

&lt;p&gt;BR Maruan&lt;/p&gt;</comment>
                            <comment id="14002149" author="tilman" created="Mon, 19 May 2014 18:42:06 +0000"  >&lt;p&gt;Sorry I don&apos;t understand you or misunderstood you. I don&apos;t alter anything in the PDF. What I was doing was reading the version from the header, which wasn&apos;t done with the NonSeq parser. Next thing would be to read the version from the trailer in the NonSeq parser (which apparently isn&apos;t done, but I&apos;m not finished with investigating this). Both would be put in the version variable of COSDocument. Or do you mean that internally, COSDocument should keep both versions separately, and then rewrite both in case a PDF is saved?&lt;/p&gt;</comment>
                            <comment id="14002245" author="msahyoun" created="Mon, 19 May 2014 19:50:52 +0000"  >&lt;p&gt;Sorry that I haven&#8217;t been precise enough. Yes, what I&#8217;m suggesting is keeping both versions as this is inline with the spec and ensures that we do not override the current settings in a pdf when opening and saving out.&lt;/p&gt;</comment>
                            <comment id="14002844" author="tilman" created="Tue, 20 May 2014 06:15:20 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=msahyoun&quot; class=&quot;user-hover&quot; rel=&quot;msahyoun&quot;&gt;msahyoun&lt;/a&gt; Thanks now I understand. I&apos;ll check this tonight.&lt;/p&gt;

&lt;p&gt;I had a problem while trying to read the trailer version with the nonsequential parser. When parsing the trailer it gets &quot;COSObject (1,0)&quot;, however the baseObject is &quot;null&quot;, i.e. Object 1 is unknown at that time. However reading the trailer again later (when the objects are resolved) brings the correct version. I fixed this in rev 1596116 for the trunk and rev 1596117 for the 1.8 branch.&lt;/p&gt;</comment>
                            <comment id="14003627" author="tilman" created="Tue, 20 May 2014 16:56:51 +0000"  >&lt;p&gt;COSDocument.java has this:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void setVersion( &lt;span class=&quot;code-object&quot;&gt;float&lt;/span&gt; versionValue )
    {
        &lt;span class=&quot;code-comment&quot;&gt;// update header string
&lt;/span&gt;        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (versionValue != version) 
        {
            headerString = headerString.replaceFirst(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;.valueOf(version), &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;.valueOf(versionValue));
        }
        version = versionValue;
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;So it does two things, set the version and set the headerString. My first Idea would be to remove the setting of the headerString, because this is 1. a side effect and 2. already done elsewhere. But this was inserted in 2011 by &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lehmi&quot; class=&quot;user-hover&quot; rel=&quot;lehmi&quot;&gt;lehmi&lt;/a&gt; as part of &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-879&quot; title=&quot;PDFMergerUtility&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-879&quot;&gt;&lt;del&gt;PDFBOX-879&lt;/del&gt;&lt;/a&gt; so I wonder if I will break something by removing this.&lt;/p&gt;</comment>
                            <comment id="14005815" author="lehmi" created="Thu, 22 May 2014 10:27:27 +0000"  >&lt;p&gt;As far as I can remember it, I wasn&apos;t aware of the fact that a pdf may have to versions (header + trailer). In the hindsight the change wasn&apos;t that good. I agree with &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=msahyoun&quot; class=&quot;user-hover&quot; rel=&quot;msahyoun&quot;&gt;msahyoun&lt;/a&gt;, we have to overhaul the get/setVersion methods. Both must take both possible values into account following the pdf spec.&lt;/p&gt;</comment>
                            <comment id="14009682" author="tilman" created="Tue, 27 May 2014 13:55:11 +0000"  >&lt;p&gt;IMHO the actual issue is solved, i.e. the two parsers now return the same version. I have opened follow-up issue &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2099&quot; title=&quot;Improve handling and writing of header and trailer versions&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2099&quot;&gt;&lt;del&gt;PDFBOX-2099&lt;/del&gt;&lt;/a&gt; that will deal with Maruans comment and its reactions.&lt;/p&gt;</comment>
                            <comment id="14017868" author="tpalsulich" created="Wed, 4 Jun 2014 17:07:16 +0000"  >&lt;p&gt;I&apos;m still having some more trouble with NonSeq and default returning different versions. For testComment.pdf (attached), the default parser detects 1.5, but the sequential one detects 1.4. Ideas?&lt;/p&gt;</comment>
                            <comment id="14018279" author="tilman" created="Wed, 4 Jun 2014 22:21:56 +0000"  >&lt;p&gt;Don&apos;t use the sequential parser. Only use loadNonSeq(). You&apos;ll get better results. The fix that I did was for loadNonSeq(), which is &quot;the future&quot;.&lt;/p&gt;</comment>
                            <comment id="14025185" author="tpalsulich" created="Mon, 9 Jun 2014 13:33:22 +0000"  >&lt;p&gt;Hi, thanks! You&apos;re right. I didn&apos;t realize this fix wasn&apos;t in the latest release.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                            <outwardlinks description="duplicates">
                                        <issuelink>
            <issuekey id="12604099">PDFBOX-1393</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12716814">PDFBOX-2099</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12629203" name="testAnnotations.pdf" size="18580" author="tallison" created="Sat, 15 Feb 2014 04:41:59 +0000"/>
                            <attachment id="12648356" name="testComment.pdf" size="68398" author="tpalsulich" created="Wed, 4 Jun 2014 17:07:16 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>373854</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 23 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1sfc7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>374154</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>