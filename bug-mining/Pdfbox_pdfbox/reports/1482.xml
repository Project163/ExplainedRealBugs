<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:03:31 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PDFBOX-3337] Regression: NullPointerException in subsetting</title>
                <link>https://issues.apache.org/jira/browse/PDFBOX-3337</link>
                <project id="12310760" key="PDFBOX">PDFBox</project>
                    <description>&lt;p&gt;The attached test files runs without problems with 2.0.0 but fails with 2.0.1.&lt;br/&gt;
Something must have changed concerning the subsetting of TTF files.&lt;br/&gt;
Basically I&apos;m trying to reuse a TrueTypeFont for several PDFs to avoid parsing it over and over again.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12964738">PDFBOX-3337</key>
            <summary>Regression: NullPointerException in subsetting</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jahewson">John Hewson</assignee>
                                    <reporter username="phax">Philip Helger</reporter>
                        <labels>
                    </labels>
                <created>Tue, 3 May 2016 18:06:11 +0000</created>
                <updated>Sun, 11 Jun 2017 13:38:38 +0000</updated>
                            <resolved>Sun, 19 Jun 2016 07:32:18 +0000</resolved>
                                    <version>2.0.1</version>
                    <version>2.0.3</version>
                    <version>3.0.0 PDFBox</version>
                                    <fixVersion>2.0.3</fixVersion>
                    <fixVersion>3.0.0 PDFBox</fixVersion>
                                    <component>FontBox</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="15269237" author="phax" created="Tue, 3 May 2016 18:08:30 +0000"  >&lt;p&gt;Just replaced the InputStream for the TTF file&lt;/p&gt;</comment>
                            <comment id="15269268" author="lehmi" created="Tue, 3 May 2016 18:16:45 +0000"  >&lt;p&gt;The given ttf file is closed after being replaced with the subsetted one, see &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3272&quot; title=&quot;Loaded fonts file descriptors open after closing document&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3272&quot;&gt;&lt;del&gt;PDFBOX-3272&lt;/del&gt;&lt;/a&gt; for further explanation&lt;/p&gt;</comment>
                            <comment id="15269382" author="phax" created="Tue, 3 May 2016 19:10:12 +0000"  >&lt;p&gt;I personally think that the behaviour of 2.0.0 is better since it allows me to not parse the TTF over and over again.&lt;/p&gt;

&lt;p&gt;The basic problem is that &lt;tt&gt;MemoryTTFDataStream.close&lt;/tt&gt; calls &lt;tt&gt;data = null;&lt;/tt&gt; for GC reason only.&lt;/p&gt;</comment>
                            <comment id="15273847" author="phax" created="Fri, 6 May 2016 09:36:17 +0000"  >&lt;p&gt;This simple patch fixes the issue.&lt;br/&gt;
Is there the possibility you will integrate this in 2.1.0?&lt;/p&gt;</comment>
                            <comment id="15287434" author="phax" created="Tue, 17 May 2016 19:58:14 +0000"  >&lt;p&gt;Do you have any news for me?&lt;/p&gt;</comment>
                            <comment id="15305945" author="lehmi" created="Sun, 29 May 2016 15:11:26 +0000"  >&lt;p&gt;The idea is to release all resources to avoid a leak. The user might pass a file, an inputstream or a truetypefont to PDType0Font#load and the resulting ttf is closed.&lt;/p&gt;

&lt;p&gt;The question if all passed resources should be handled the same way might be some kind of philosophical question. One might say that only the ttf created from the given file or inputstream should be closed.&lt;/p&gt;

&lt;p&gt;I just realized that the ttf is closed if the font is used as a subset but isn&apos;t closed if the font is used as is.&lt;/p&gt;</comment>
                            <comment id="15305954" author="phax" created="Sun, 29 May 2016 15:44:54 +0000"  >&lt;p&gt;I understand your reasoning that in many cases the close/resource cleanup makes sense.&lt;br/&gt;
What about making the closing configurable? As far as I understand the code the source InputStream is closed anyway. It just the internal object that remains....&lt;/p&gt;</comment>
                            <comment id="15319003" author="phax" created="Tue, 7 Jun 2016 17:52:22 +0000"  >&lt;p&gt;Alternatively if you allow me to derive from &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;MemoryTTFDataStream&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt; and/or make &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;TTFParser.parse(TTFDataStream raf)&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt; usable from the outside I could handle this myself.&lt;/p&gt;</comment>
                            <comment id="15329445" author="phax" created="Tue, 14 Jun 2016 12:56:25 +0000"  >&lt;p&gt;Hi!&lt;br/&gt;
This one is important to me, and I would really appreciate some feedback.&lt;br/&gt;
Thx&lt;/p&gt;</comment>
                            <comment id="15329829" author="tilman" created="Tue, 14 Jun 2016 16:37:53 +0000"  >&lt;p&gt;+1 from me on doing the &lt;tt&gt;data = null&lt;/tt&gt; change only.&lt;/p&gt;</comment>
                            <comment id="15336447" author="lubos.husivarga@gmail.com" created="Fri, 17 Jun 2016 16:51:11 +0000"  >&lt;p&gt;What is the purpose of FSFontInfo cache, if TrueTypeFont obtained from it is closed in TrueTypeEmbedder?&lt;/p&gt;

&lt;p&gt;I think TrueTypeFont should not be closed once embedded. It makes no sense to create new TTF instance for every document I want to create. PDType0Font#load for File and InputStream resource should be deprecated and new static TrueTypeFont#load method created instead to supply PDFType0Font#load with closeable TTF instance.&lt;/p&gt;

&lt;p&gt;TrueTypeFont is closed here:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;&quot;&gt;&lt;b&gt;org.apache.pdfbox.pdmodel.font.TrueTypeEmbedder.buildFontFile2(InputStream)&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (ttf != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;)
            {
                &lt;span class=&quot;code-comment&quot;&gt;// close the replaced &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt; type font
&lt;/span&gt;                ttf.close();
            }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="15338412" author="jahewson" created="Sun, 19 Jun 2016 07:21:51 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=phax&quot; class=&quot;user-hover&quot; rel=&quot;phax&quot;&gt;phax&lt;/a&gt; Yep, lets do this.&lt;/p&gt;</comment>
                            <comment id="15338414" author="jira-bot" created="Sun, 19 Jun 2016 07:27:13 +0000"  >&lt;p&gt;Commit 1749135 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jahewson&quot; class=&quot;user-hover&quot; rel=&quot;jahewson&quot;&gt;jahewson&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1749135&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1749135&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3337&quot; title=&quot;Regression: NullPointerException in subsetting&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3337&quot;&gt;&lt;del&gt;PDFBOX-3337&lt;/del&gt;&lt;/a&gt;: Don&apos;t clear data when closing an in-memory TTF stream&lt;/p&gt;</comment>
                            <comment id="15338415" author="jahewson" created="Sun, 19 Jun 2016 07:27:31 +0000"  >&lt;p&gt;That&apos;s not related to this issue.&lt;/p&gt;</comment>
                            <comment id="15338418" author="jira-bot" created="Sun, 19 Jun 2016 07:31:58 +0000"  >&lt;p&gt;Commit 1749136 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jahewson&quot; class=&quot;user-hover&quot; rel=&quot;jahewson&quot;&gt;jahewson&lt;/a&gt; in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1749136&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1749136&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3337&quot; title=&quot;Regression: NullPointerException in subsetting&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3337&quot;&gt;&lt;del&gt;PDFBOX-3337&lt;/del&gt;&lt;/a&gt;: Don&apos;t clear data when closing an in-memory TTF stream&lt;/p&gt;</comment>
                            <comment id="15338464" author="jira-bot" created="Sun, 19 Jun 2016 10:20:43 +0000"  >&lt;p&gt;Commit 1749145 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1749145&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1749145&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3337&quot; title=&quot;Regression: NullPointerException in subsetting&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3337&quot;&gt;&lt;del&gt;PDFBOX-3337&lt;/del&gt;&lt;/a&gt;: added test code from Philip Helger&lt;/p&gt;</comment>
                            <comment id="15338466" author="jira-bot" created="Sun, 19 Jun 2016 10:21:08 +0000"  >&lt;p&gt;Commit 1749146 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1749146&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1749146&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3337&quot; title=&quot;Regression: NullPointerException in subsetting&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3337&quot;&gt;&lt;del&gt;PDFBOX-3337&lt;/del&gt;&lt;/a&gt;: added test code from Philip Helger&lt;/p&gt;</comment>
                            <comment id="15338480" author="phax" created="Sun, 19 Jun 2016 11:09:21 +0000"  >&lt;p&gt;Thanks guys - highly appreciated!!!!&lt;/p&gt;</comment>
                            <comment id="15338488" author="jira-bot" created="Sun, 19 Jun 2016 11:27:40 +0000"  >&lt;p&gt;Commit 1749152 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1749152&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1749152&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3337&quot; title=&quot;Regression: NullPointerException in subsetting&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3337&quot;&gt;&lt;del&gt;PDFBOX-3337&lt;/del&gt;&lt;/a&gt;: added test code from Philip Helger&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13078947">PDFBOX-3826</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12802002" name="MainIssue3337.java" size="2098" author="phax" created="Tue, 3 May 2016 18:08:30 +0000"/>
                            <attachment id="12802645" name="pdfbox3337.patch" size="570" author="phax" created="Fri, 6 May 2016 09:36:17 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 21 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2x47r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>