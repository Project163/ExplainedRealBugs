<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 20:53:17 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PDFBOX-954] Embedded font: value for /Widths faulty (worked in PDFBox 1.3.0!)</title>
                <link>https://issues.apache.org/jira/browse/PDFBOX-954</link>
                <project id="12310760" key="PDFBOX">PDFBox</project>
                    <description>&lt;p&gt;We have a problem with the font &apos;LucidiaSansUnicode (l_10646.ttf). It is embedded in a PDF and when viewing this PDF (with Acrobat Reader 9), an error&lt;/p&gt;

&lt;p&gt;   In der Schrift &quot;LucidaSansUnicode&quot; ist der Wert f&#252;r /Widths fehlerhaft.&lt;/p&gt;

&lt;p&gt;occurs (roughly translated: &quot;In font &quot;LucidaSansUNicode&quot; the value for /Widths is faulty.&quot;). I noticed that this error only occurs when the first page is displayed that has text added by PDFBox! The same font is also used for all other text (used by Apache FOP to generate). When I look at the dialog window of Acrobat 3. tab &quot;Fonts&quot;, I notice lots of entries&lt;/p&gt;

&lt;p&gt;    LucidaSansUnicode (Eingebettete Untergruppe)&lt;br/&gt;
        Typ: TrueType (CID)&lt;br/&gt;
        Kodierung: Identity-H&lt;/p&gt;

&lt;p&gt;but only 1 entry at the very top that looks different:&lt;/p&gt;

&lt;p&gt;    LucidaSansUnicode (Eingebettet)&lt;br/&gt;
         Typ: TrueType&lt;br/&gt;
        Kodierung: Ansi&lt;/p&gt;

&lt;p&gt;I guess one is from Apache FOP (generation of PDF) and one is from PDFBox (adding additional text to the PDF). However, both use the same source file &quot;l_10646.ttf&quot;!&lt;/p&gt;

&lt;p&gt;Using PDFBox 1.3.0-snapshot (or iText 2.1.7), this problem does NOT occur!&lt;/p&gt;

&lt;p&gt;This only occurs with this &quot;LucidaSansUnicode&quot; font - all our other custom fonts don&apos;t cause this problem.&lt;/p&gt;

&lt;p&gt;The difference I notice in Acrobat Reader Fonts tab is the first font entry:&lt;/p&gt;

&lt;p&gt;PDFBox 1.4.0:&lt;/p&gt;

&lt;p&gt;    LucidaSansUnicode (Eingebettet)&lt;br/&gt;
        Typ: TrueType&lt;br/&gt;
        Kodierung: Ansi&lt;/p&gt;

&lt;p&gt;PDFBox 1.3.0 or iText 2.1.7:&lt;/p&gt;

&lt;p&gt;    LucidaSansUnicode (Eingebettete Untergruppe)&lt;br/&gt;
        Typ: TrueType&lt;br/&gt;
        Kodierung: Ansi&lt;/p&gt;


&lt;p&gt;So, PDFBox 1.4.0 only shows &quot;embedded&quot; (&quot;Eingebettet&quot;) but PDFBox 1.3.0/iText version shows &quot;embedded subgroup&quot; (&quot;Eingebettete Untergruppe&quot;)! Perhaps this is the problem?&lt;/p&gt;</description>
                <environment>JDK1.6.0_23, Windows XP</environment>
        <key id="12497325">PDFBOX-954</key>
            <summary>Embedded font: value for /Widths faulty (worked in PDFBox 1.3.0!)</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="lehmi">Andreas Lehmk&#252;hler</assignee>
                                    <reporter username="mhilpert">MH</reporter>
                        <labels>
                    </labels>
                <created>Tue, 1 Feb 2011 12:38:30 +0000</created>
                <updated>Wed, 17 Apr 2013 18:42:36 +0000</updated>
                            <resolved>Wed, 4 Jul 2012 05:02:33 +0000</resolved>
                                    <version>1.4.0</version>
                                    <fixVersion>1.7.1</fixVersion>
                                    <component>FontBox</component>
                        <due></due>
                            <votes>4</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="13006040" author="wwi" created="Sat, 12 Mar 2011 12:21:28 +0000"  >&lt;p&gt;I have also pointed out this issue. I can reproduce the problem with versions of PDFBox after 1.1.0. I am using Arial.TTF from the Mac. I have tried to view the files on my wife&apos;s Windows 7 machine, and get the same warning errors in Adobe Reader, so at least the Adobe Reader does not depend on being on a Mac. Other postings indicate that the TTF files from Windows cause the same message to appear.&lt;/p&gt;

&lt;p&gt;I have two PDF files I created using the canned version of  &quot;org.apache.pdfbox.examples.pdmodel.HelloWorldTTF&quot; that comes with the distribution. This process eliminated any possibility that my own PDF-creation software was causing the problem. I ran the same command line, using the 1.1.0 and 1.4.0 JAR files (and some versions in between).&lt;/p&gt;

&lt;p&gt;The file from 1.1.0 reads just fine, but those created by any JAR after 1.1.0 all cause the same warning error. (I have not been able to download 1.5.0 yet, but others&apos; experiences seem to point to the same issue).&lt;/p&gt;
</comment>
                            <comment id="13006042" author="wwi" created="Sat, 12 Mar 2011 12:25:01 +0000"  >&lt;p&gt;&quot;hello 1.1.0&quot; reads just fine with Adobe Reader, the &quot;hello 1.4.0&quot; gets the warning error. Font is Arial.TTF from Mac. Adobe Reader warning occurs on Mac or Windows 7.&lt;/p&gt;</comment>
                            <comment id="13019562" author="stevehb" created="Wed, 13 Apr 2011 21:22:21 +0000"  >&lt;p&gt;I&apos;ve been getting the same problem with all TTF fonts on all versions &amp;gt;= 1.2.0, including the 1.6.0 snapshots.&lt;/p&gt;

&lt;p&gt;The change between version 1.1.0 and 1.2.0 that started the issue is in the following line in loadDescriptorDictionary() in org.apache.pdfbox.pdmodel.font.PDTrueTypeFont.java:&lt;/p&gt;

&lt;p&gt;// version 1.1.0&lt;br/&gt;
int maxWidths = 256;&lt;/p&gt;

&lt;p&gt;// version 1.2.0 and later&lt;br/&gt;
int maxWidths = glyphToCCode.length;&lt;/p&gt;

&lt;p&gt;I&apos;ve tried setting maxWidths to difference values manually, but 256 seems to be the max allowable. Setting it to 257 will reproduce the error.&lt;/p&gt;

&lt;p&gt;Is Adobe Reader really limited to 256 character widths on embedded fonts?&lt;/p&gt;</comment>
                            <comment id="13098862" author="hesham" created="Wed, 7 Sep 2011 11:37:34 +0000"  >&lt;p&gt;Will this issue be fixed in the next program version ? I see this is a critical issue !&lt;/p&gt;</comment>
                            <comment id="13100494" author="lehmi" created="Thu, 8 Sep 2011 17:49:46 +0000"  >&lt;p&gt;I&apos;m working on this issue.&lt;/p&gt;

&lt;p&gt;At first I fixed the calculation of the family class in revision 1166824.&lt;/p&gt;</comment>
                            <comment id="13101008" author="lehmi" created="Fri, 9 Sep 2011 06:04:34 +0000"  >&lt;p&gt;I (hopefully) fixed the calculation of the /Widths value in revision 1167012.&lt;/p&gt;

&lt;p&gt;Please run some additional tests as I only tested a couple of ttf fonts with different configurations.&lt;/p&gt;

&lt;p&gt;The next thing I&apos;d like to fix is the used encoding for those ttf fonts, see &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-922&quot; title=&quot;True type PDFont subclass only supports WinAnsiEncoding (hardcoded!)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-922&quot;&gt;&lt;del&gt;PDFBOX-922&lt;/del&gt;&lt;/a&gt; for further details.&lt;/p&gt;
</comment>
                            <comment id="13136945" author="mhilpert" created="Thu, 27 Oct 2011 10:28:02 +0000"  >&lt;p&gt;STill happens with PDFBox 1.6.0.&lt;/p&gt;</comment>
                            <comment id="13137434" author="lehmi" created="Thu, 27 Oct 2011 19:38:53 +0000"  >&lt;p&gt;The fix is available in the current trunk only.&lt;/p&gt;</comment>
                            <comment id="13167210" author="vilherda" created="Sun, 11 Dec 2011 21:16:38 +0000"  >&lt;p&gt;Hello, my name is David.&lt;br/&gt;
I try to apply the changes suggested on classes &quot;OS2WindowsMetricsTable&quot; and &quot;PDTrueTypeFont&quot; and the problem continues. The widths doesn&apos;t match.&lt;br/&gt;
I&apos;m new in the PDF world but... The contents of the array of widths must be , effectively, an array of widths between the first character and the last character.&lt;br/&gt;
I suspect the problem resides into the fact that the contents of the array must be the widths of the characters (glyphs) implied into the text represented, not all specified characters (glyphs) between the first character and the last character into specification file of  true type font (file &quot;.ttf&quot;).&lt;/p&gt;</comment>
                            <comment id="13169783" author="vilherda" created="Wed, 14 Dec 2011 23:04:58 +0000"  >&lt;p&gt;Hello.&lt;/p&gt;

&lt;p&gt;I try to create a simple PDF with trunk branch code (1.7.0) and the problem remains. The PDF has not any thing special. It&apos;s the tipical example of the PDFBox project website.&lt;/p&gt;

&lt;p&gt;When I open the document with Adobe Reader the message about wrong widths appears.&lt;/p&gt;

&lt;p&gt;Good night everybody.&lt;/p&gt;</comment>
                            <comment id="13169993" author="lehmi" created="Thu, 15 Dec 2011 06:50:51 +0000"  >&lt;p&gt;@David&lt;br/&gt;
Can you be a little bit more specific, please? What font did you use? Please attach the resulting pdf to this issue.&lt;/p&gt;</comment>
                            <comment id="13170471" author="vilherda" created="Thu, 15 Dec 2011 20:25:01 +0000"  >&lt;p&gt;Hello!&lt;/p&gt;

&lt;p&gt;I attach some files about the &quot;test&quot;:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Imagen1.png : The error message on spanish (I&apos;m from Catalonia &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/li&gt;
	&lt;li&gt;Imagen 2.png: The Adobe Reader version&lt;/li&gt;
	&lt;li&gt;Imagen 3.png: About my Mac&lt;/li&gt;
	&lt;li&gt;out.pdf            : The generated PDF file&lt;/li&gt;
	&lt;li&gt;Main.java       : The program&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;And the PDFBox version is 1.7.0 (trunk)&lt;/p&gt;

&lt;p&gt;Good night from Barcelona&lt;/p&gt;</comment>
                            <comment id="13171623" author="vilherda" created="Sat, 17 Dec 2011 18:01:06 +0000"  >&lt;p&gt;Hello.&lt;/p&gt;

&lt;p&gt;I think I found a temporal workaround.&lt;/p&gt;

&lt;p&gt;Finally I see on PDF specification the meaning of &quot;widths&quot; array. As I said on my first post, the problem with the contents of the array seems to be that the contents is the widths of all characters defined on the selected font. In my opinion, the correct contents must be the widths of the all characters between the first character and the last character detected at them moment you want, by example, write a string.&lt;/p&gt;

&lt;p&gt;I attach a variant of the program that I attach on my previous post. The result is a PDF file with 3 strings, each one with it&apos;s own font and font descriptor but all three share the value of the attribute &quot;FontFile2&quot;. The result is a PDF file without the message about error and it has embedded Arial font only one time. Previous tests had created a PDF file with the font embedded three times... a really big file.&lt;/p&gt;

&lt;p&gt;The files I attach are:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;MainVer2.java (2nd version, the first it&apos;s a wrong version of the test)&lt;/li&gt;
	&lt;li&gt;outVer2.pdf&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;I see the previous attached files (Main.java) has not treated the character &quot;&#241;&quot;, I erase it and the spanish pseudo-character &quot;ll&quot; too.&lt;/p&gt;

&lt;p&gt;Oh! This workaround woks fine on PDFBox 1.6.0  and 1.7.0 (trunk)&lt;/p&gt;

&lt;p&gt;Good afternoon&lt;/p&gt;</comment>
                            <comment id="13402302" author="hesham" created="Wed, 27 Jun 2012 15:44:13 +0000"  >&lt;p&gt;I have tested this with PDFBox v1.7 using PDTrueTypeFont.loadTTF(...) and this issue still occurs for any ttf file i use.&lt;/p&gt;</comment>
                            <comment id="13403738" author="wolfgang.glas@ev-i.at" created="Fri, 29 Jun 2012 07:01:40 +0000"  >&lt;p&gt;The attached patch fixes the problem for fonts with a valid &apos;post&apos; table. Further work might be needed in order to use a (3,1)-cmap as described in PDFReference1.6.pdf, p. 401&lt;/p&gt;</comment>
                            <comment id="13405975" author="wolfgang.glas@ev-i.at" created="Tue, 3 Jul 2012 18:31:44 +0000"  >&lt;p&gt;Improved version of my patch, which now precisely follows the specs in PDFReference16.pdf, p.401&lt;/p&gt;</comment>
                            <comment id="13405982" author="lehmi" created="Tue, 3 Jul 2012 19:40:25 +0000"  >&lt;p&gt;I experienced some problems with the first patch, but the improved one now works fine. Added in revision 1356866.&lt;/p&gt;</comment>
                            <comment id="13406277" author="lehmi" created="Wed, 4 Jul 2012 05:02:33 +0000"  >&lt;p&gt;I ran some additional tests and everything works fine for me, set to resolved.&lt;/p&gt;

&lt;p&gt;Thanks for the contribution!&lt;/p&gt;</comment>
                            <comment id="13425684" author="hesham" created="Tue, 31 Jul 2012 11:32:37 +0000"  >&lt;p&gt;I have tested this on Windows &amp;amp; Mac OS X, and it works fine.&lt;br/&gt;
Thanks Wolfgang ... Thanks Andreas &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13426328" author="wwi" created="Wed, 1 Aug 2012 04:56:59 +0000"  >&lt;p&gt;Tried with MAC OSX and was able to remove the work-around. Seems to be working fine! Many Thanks. Danke.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12642537">PDFBOX-1567</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12507578" name="Imagen 1.png" size="16693" author="vilherda" created="Thu, 15 Dec 2011 20:14:11 +0000"/>
                            <attachment id="12507577" name="Imagen 2.png" size="54102" author="vilherda" created="Thu, 15 Dec 2011 20:14:11 +0000"/>
                            <attachment id="12507576" name="Imagen 3.png" size="42715" author="vilherda" created="Thu, 15 Dec 2011 20:14:11 +0000"/>
                            <attachment id="12507583" name="Main.java" size="1790" author="vilherda" created="Thu, 15 Dec 2011 20:24:15 +0000"/>
                            <attachment id="12507800" name="MainVer2.java" size="3642" author="vilherda" created="Sat, 17 Dec 2011 20:39:01 +0000"/>
                            <attachment id="12507786" name="MainVer2.java" size="3710" author="vilherda" created="Sat, 17 Dec 2011 17:59:11 +0000"/>
                            <attachment id="12473472" name="hello_ttf_1.1.0.pdf" size="426375" author="wwi" created="Sat, 12 Mar 2011 12:25:01 +0000"/>
                            <attachment id="12473473" name="hello_ttf_1.4.0.pdf" size="438482" author="wwi" created="Sat, 12 Mar 2011 12:25:01 +0000"/>
                            <attachment id="12507579" name="out.pdf" size="448576" author="vilherda" created="Thu, 15 Dec 2011 20:14:11 +0000"/>
                            <attachment id="12507787" name="outVer2.pdf" size="425970" author="vilherda" created="Sat, 17 Dec 2011 18:00:04 +0000"/>
                            <attachment id="12534881" name="pdfbox-1.7.0-ttf-widths-encoding-fix.patch" size="9121" author="wolfgang.glas@ev-i.at" created="Tue, 3 Jul 2012 18:31:44 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>11.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>61866</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 16 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0zimf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>205319</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>