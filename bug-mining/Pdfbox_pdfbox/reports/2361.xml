<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:10:14 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PDFBOX-4822] Off-by-one error in PDSignature.getConvertedContents()</title>
                <link>https://issues.apache.org/jira/browse/PDFBOX-4822</link>
                <project id="12310760" key="PDFBOX">PDFBox</project>
                    <description>&lt;p&gt;In PDSignature.java, we have the following function:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt;[] getConvertedContents(InputStream is) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException
    {
        ByteArrayOutputStream byteOS = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ByteArrayOutputStream(1024);
        &lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt;[] buffer = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt;[1024];
        &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; c;
        &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; ((c = is.read(buffer)) != -1)
        {
            &lt;span class=&quot;code-comment&quot;&gt;// Filter &amp;lt; and (
&lt;/span&gt;            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt;(buffer[0]==0x3C || buffer[0]==0x28)
            {
                byteOS.write(buffer, 1, c); &lt;span class=&quot;code-comment&quot;&gt;// ERROR: may read buffer[1024], which doesn&apos;t exist!
&lt;/span&gt;            }
            &lt;span class=&quot;code-comment&quot;&gt;// Filter &amp;gt; and )
&lt;/span&gt;            &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt;(buffer[c-1]==0x3E || buffer[c-1]==0x29)
            {
                byteOS.write(buffer, 0, c-1);
            }
            &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt;
            {
                byteOS.write(buffer, 0, c);
            }
        }
        is.close();        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; COSString.parseHex(byteOS.toString(&lt;span class=&quot;code-quote&quot;&gt;&quot;ISO-8859-1&quot;&lt;/span&gt;)).getBytes();
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;If c = 1024 (i.e. is.read() fills the buffer completely), and the first byte is 0x3C or 0x28, we try to read the 1025th byte of the buffer, and hit an IndexOutOfBoundsException:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;java.lang.IndexOutOfBoundsException: Range [1, 1 + 1024) out of bounds for length 1024
    at jdk.internal.util.Preconditions.outOfBounds(Preconditions.java:64) ~[?:?]
    at jdk.internal.util.Preconditions.outOfBoundsCheckFromIndexSize(Preconditions.java:82) ~[?:?]
    at jdk.internal.util.Preconditions.checkFromIndexSize(Preconditions.java:343) ~[?:?]
    at java.util.Objects.checkFromIndexSize(Objects.java:424) ~[?:?]
    at java.io.ByteArrayOutputStream.write(ByteArrayOutputStream.java:155) ~[?:?]
    at org.apache.pdfbox.pdmodel.interactive.digitalsignature.PDSignature.getConvertedContents(PDSignature.java:348) ~[pdfbox-2.0.19.jar:2.0.19]
    at org.apache.pdfbox.pdmodel.interactive.digitalsignature.PDSignature.getContents(PDSignature.java:335) ~[pdfbox-2.0.19.jar:2.0.19]&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;By changing the first byteOS.write call to this:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
                byteOS.write(buffer, 1, c-1);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;the problem is fixed.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13302170">PDFBOX-4822</key>
            <summary>Off-by-one error in PDSignature.getConvertedContents()</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tilman">Tilman Hausherr</assignee>
                                    <reporter username="Googulator">G&#225;bor Stefanik</reporter>
                        <labels>
                    </labels>
                <created>Thu, 30 Apr 2020 17:50:17 +0000</created>
                <updated>Mon, 15 Jun 2020 04:54:18 +0000</updated>
                            <resolved>Thu, 28 May 2020 18:03:07 +0000</resolved>
                                    <version>2.0.19</version>
                                    <fixVersion>1.8.17</fixVersion>
                    <fixVersion>2.0.20</fixVersion>
                    <fixVersion>3.0.0 PDFBox</fixVersion>
                                    <component>PDModel</component>
                    <component>Signing</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="17096924" author="tilman" created="Thu, 30 Apr 2020 19:40:19 +0000"  >&lt;p&gt;Thank you... This is weird code... I ran our tests and it never hits the error part. Because it would only do that if called with &quot;&amp;lt;xxxxxxxx&amp;gt;&quot; or &quot;(......)&quot;. And the code will only work properly if the passed argument is large than 1024. My guess is that at the time this was used, it would expected to have &quot;&amp;lt;&quot; but then it never happened, until now.&lt;/p&gt;</comment>
                            <comment id="17096941" author="tilman" created="Thu, 30 Apr 2020 19:58:45 +0000"  >&lt;p&gt;I&apos;ll commit this tomorrow:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt;[] getConvertedContents(InputStream is) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException
    {
        ByteArrayOutputStream baos = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ByteArrayOutputStream(1024);
        &lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt;[] buffer = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt;[1024];
        &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; readLen;
        &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; ((readLen = is.read(buffer)) != -1)
        {
            &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; writeLen = readLen;
            &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; start = 0;
            &lt;span class=&quot;code-comment&quot;&gt;// Filter &amp;lt; and (
&lt;/span&gt;            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt;(buffer[0]==0x3C || buffer[0]==0x28)
            {
                start = 1;
                --writeLen;
            }
            &lt;span class=&quot;code-comment&quot;&gt;// Filter &amp;gt; and )
&lt;/span&gt;            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt;(buffer[readLen-1]==0x3E || buffer[readLen-1]==0x29)
            {
                --writeLen;
            }
            baos.write(buffer, start, writeLen);
        }
        is.close();

        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; COSString.parseHex(baos.toString(&lt;span class=&quot;code-quote&quot;&gt;&quot;ISO-8859-1&quot;&lt;/span&gt;)).getBytes();
    }
 &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17097216" author="jira-bot" created="Fri, 1 May 2020 07:29:17 +0000"  >&lt;p&gt;Commit 1877242 from Tilman Hausherr in branch &apos;pdfbox/branches/1.8&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1877242&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1877242&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4822&quot; title=&quot;Off-by-one error in PDSignature.getConvertedContents()&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4822&quot;&gt;&lt;del&gt;PDFBOX-4822&lt;/del&gt;&lt;/a&gt;: corrected off-by-one error as suggested by G&#225;bor Stefanik; support having extra character at beginning AND end of read bytes&lt;/p&gt;</comment>
                            <comment id="17097217" author="jira-bot" created="Fri, 1 May 2020 07:29:21 +0000"  >&lt;p&gt;Commit 1877243 from Tilman Hausherr in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1877243&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1877243&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4822&quot; title=&quot;Off-by-one error in PDSignature.getConvertedContents()&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4822&quot;&gt;&lt;del&gt;PDFBOX-4822&lt;/del&gt;&lt;/a&gt;: corrected off-by-one error as suggested by G&#225;bor Stefanik; support having extra character at beginning AND end of read bytes&lt;/p&gt;</comment>
                            <comment id="17097218" author="jira-bot" created="Fri, 1 May 2020 07:29:25 +0000"  >&lt;p&gt;Commit 1877244 from Tilman Hausherr in branch &apos;pdfbox/branches/issue45&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1877244&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1877244&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4822&quot; title=&quot;Off-by-one error in PDSignature.getConvertedContents()&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4822&quot;&gt;&lt;del&gt;PDFBOX-4822&lt;/del&gt;&lt;/a&gt;: corrected off-by-one error as suggested by G&#225;bor Stefanik; support having extra character at beginning AND end of read bytes&lt;/p&gt;</comment>
                            <comment id="17097219" author="jira-bot" created="Fri, 1 May 2020 07:29:30 +0000"  >&lt;p&gt;Commit 1877245 from Tilman Hausherr in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1877245&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1877245&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4822&quot; title=&quot;Off-by-one error in PDSignature.getConvertedContents()&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4822&quot;&gt;&lt;del&gt;PDFBOX-4822&lt;/del&gt;&lt;/a&gt;: corrected off-by-one error as suggested by G&#225;bor Stefanik; support having extra character at beginning AND end of read bytes&lt;/p&gt;</comment>
                            <comment id="17097229" author="jira-bot" created="Fri, 1 May 2020 07:55:49 +0000"  >&lt;p&gt;Commit 1877246 from Tilman Hausherr in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1877246&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1877246&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4822&quot; title=&quot;Off-by-one error in PDSignature.getConvertedContents()&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4822&quot;&gt;&lt;del&gt;PDFBOX-4822&lt;/del&gt;&lt;/a&gt;: add test&lt;/p&gt;</comment>
                            <comment id="17097230" author="jira-bot" created="Fri, 1 May 2020 07:55:53 +0000"  >&lt;p&gt;Commit 1877247 from Tilman Hausherr in branch &apos;pdfbox/branches/issue45&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1877247&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1877247&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4822&quot; title=&quot;Off-by-one error in PDSignature.getConvertedContents()&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4822&quot;&gt;&lt;del&gt;PDFBOX-4822&lt;/del&gt;&lt;/a&gt;: add test&lt;/p&gt;</comment>
                            <comment id="17097232" author="jira-bot" created="Fri, 1 May 2020 07:55:58 +0000"  >&lt;p&gt;Commit 1877248 from Tilman Hausherr in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1877248&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1877248&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4822&quot; title=&quot;Off-by-one error in PDSignature.getConvertedContents()&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4822&quot;&gt;&lt;del&gt;PDFBOX-4822&lt;/del&gt;&lt;/a&gt;: add test&lt;/p&gt;</comment>
                            <comment id="17097233" author="jira-bot" created="Fri, 1 May 2020 07:56:34 +0000"  >&lt;p&gt;Commit 1877249 from Tilman Hausherr in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1877249&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1877249&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4822&quot; title=&quot;Off-by-one error in PDSignature.getConvertedContents()&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4822&quot;&gt;&lt;del&gt;PDFBOX-4822&lt;/del&gt;&lt;/a&gt;: remove trailing &amp;gt;&lt;/p&gt;</comment>
                            <comment id="17097236" author="tilman" created="Fri, 1 May 2020 08:00:02 +0000"  >&lt;p&gt;I have removed the trailing &quot;&amp;gt;&quot; in the trunk only, to avoid any possible trouble with existing installations, although no problem should occur if the values in /ByteRange are correct.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Googulator&quot; class=&quot;user-hover&quot; rel=&quot;Googulator&quot;&gt;Googulator&lt;/a&gt; could you share your file, or explain how it happened (are you using a modified version, or did you create the PDF file yourself)? In the existing code, the &quot;&amp;lt;&quot; wasn&apos;t in the broken method so the bug was not detected.&lt;/p&gt;</comment>
                            <comment id="17109146" author="tilman" created="Sat, 16 May 2020 17:35:31 +0000"  >&lt;p&gt;ping &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Googulator&quot; class=&quot;user-hover&quot; rel=&quot;Googulator&quot;&gt;Googulator&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 26 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0e9u8:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>