<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:04:57 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PDFBOX-3000] Transparency Group issues</title>
                <link>https://issues.apache.org/jira/browse/PDFBOX-3000</link>
                <project id="12310760" key="PDFBOX">PDFBox</project>
                    <description>&lt;p&gt;This is a follow-up issue for transparency group issues from &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2423&quot; title=&quot;Page tree handling needs rewriting&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2423&quot;&gt;&lt;del&gt;PDFBOX-2423&lt;/del&gt;&lt;/a&gt;. More details to come.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12901176">PDFBOX-3000</key>
            <summary>Transparency Group issues</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="jahewson">John Hewson</reporter>
                        <labels>
                            <label>Transparency</label>
                    </labels>
                <created>Mon, 28 Sep 2015 22:59:41 +0000</created>
                <updated>Tue, 19 Oct 2021 17:44:45 +0000</updated>
                            <resolved>Fri, 1 Jan 2021 13:54:21 +0000</resolved>
                                    <version>2.0.0</version>
                                    <fixVersion>2.0.23</fixVersion>
                    <fixVersion>3.0.0 PDFBox</fixVersion>
                                    <component>Rendering</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>13</watches>
                                                                                                                                                            <comments>
                            <comment id="14940285" author="chengas123" created="Thu, 1 Oct 2015 19:35:15 +0000"  >&lt;p&gt;This is &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jahewson&quot; class=&quot;user-hover&quot; rel=&quot;jahewson&quot;&gt;jahewson&lt;/a&gt;&apos;s patch to rewrite softmask handling from &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2423&quot; title=&quot;Page tree handling needs rewriting&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2423&quot;&gt;&lt;del&gt;https://issues.apache.org/jira/browse/PDFBOX-2423&lt;/del&gt;&lt;/a&gt;. It takes the approach of rewriting softmask which was originally contributed by external contributor and not well understood by all pdfbox contributors. This patch makes some things better and some worse as discussed on &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2423&quot; title=&quot;Page tree handling needs rewriting&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2423&quot;&gt;&lt;del&gt;https://issues.apache.org/jira/browse/PDFBOX-2423&lt;/del&gt;&lt;/a&gt;, so it&apos;s a wash in terms of making things better overall, but there&apos;s a possibility that some people may find this approach to be a better high level approach to start from in fixing the remaining issues.&lt;/p&gt;</comment>
                            <comment id="14940964" author="pslabycz" created="Fri, 2 Oct 2015 09:35:57 +0000"  >&lt;p&gt;Being the original author of the transparency groups contribution in &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2104&quot; title=&quot;Implement transparency groups&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2104&quot;&gt;&lt;del&gt;PDFBOX-2104&lt;/del&gt;&lt;/a&gt;, I have tried to look into this again. The good news is that the file attached to &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2104&quot; title=&quot;Implement transparency groups&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2104&quot;&gt;&lt;del&gt;PDFBOX-2104&lt;/del&gt;&lt;/a&gt; renders fine with the patch from John. It might be correct for the first time ever, the image shadow on the first page is missing in all the 2.0 reference renderings I have in my repository since December 2014. Unfortunately, I have no older renderings, so I cannot tell whether we got it wrong already at the beginning or whether it got broken later. We have this working correctly in our source code based on PDFBox 1.7, but it seems to be too hard for me to figure out what exactly needs to be done to successfully port our implementation to PDFBox 2.0.&lt;/p&gt;

&lt;p&gt;The only thing I do not like about John&apos;s patch is that it creates a full page bitmap to render the transparency group. I have tried to bring back the original idea of creating a bitmap according to the intersection of the bleeding box of the group and of the current clip path. After some trials, I get the same results as John on my test documents using the attached patch. Maybe someone with more insight into all the transforms can use it as a starting point to get this right.&lt;/p&gt;</comment>
                            <comment id="14941519" author="tilman" created="Fri, 2 Oct 2015 18:17:42 +0000"  >&lt;p&gt;It got broken later: yours did work with that file until rev 1633472. But other files were not rendered correctly by your initial change, and are rendered correctly now, so this is really tricky.&lt;/p&gt;

&lt;p&gt;The list of problem files can be found in &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2423&quot; title=&quot;Page tree handling needs rewriting&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2423&quot;&gt;&lt;del&gt;PDFBOX-2423&lt;/del&gt;&lt;/a&gt;, search for &quot;Here&apos;s the result of the tests&quot;.&lt;/p&gt;

&lt;p&gt;update: also &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3182&quot; title=&quot;Image not rendered  &quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3182&quot;&gt;&lt;del&gt;PDFBOX-3182&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="14955555" author="jahewson" created="Tue, 13 Oct 2015 20:14:52 +0000"  >&lt;blockquote&gt;
&lt;p&gt;The only thing I do not like about John&apos;s patch is that it creates a full page bitmap to render the transparency group.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I agree. It was a last-ditch attempt to simplify the transforms used for rendering.&lt;/p&gt;</comment>
                            <comment id="15458815" author="jira-bot" created="Fri, 2 Sep 2016 15:24:26 +0000"  >&lt;p&gt;Commit 1758974 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1758974&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1758974&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3000&quot; title=&quot;Transparency Group issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3000&quot;&gt;&lt;del&gt;PDFBOX-3000&lt;/del&gt;&lt;/a&gt;: add no parameter constructor&lt;/p&gt;</comment>
                            <comment id="15458816" author="jira-bot" created="Fri, 2 Sep 2016 15:24:30 +0000"  >&lt;p&gt;Commit 1758975 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1758975&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1758975&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3000&quot; title=&quot;Transparency Group issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3000&quot;&gt;&lt;del&gt;PDFBOX-3000&lt;/del&gt;&lt;/a&gt;: add no parameter constructor&lt;/p&gt;</comment>
                            <comment id="15526772" author="jira-bot" created="Tue, 27 Sep 2016 17:08:40 +0000"  >&lt;p&gt;Commit 1762519 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1762519&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1762519&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3000&quot; title=&quot;Transparency Group issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3000&quot;&gt;&lt;del&gt;PDFBOX-3000&lt;/del&gt;&lt;/a&gt;: consider page rotation, cropbox, initial translation; use Matrix class to get correct scales even for rotated affine transforms&lt;/p&gt;</comment>
                            <comment id="15526791" author="tilman" created="Tue, 27 Sep 2016 17:14:21 +0000"  >&lt;p&gt;A difficulty with this issue is that there are many problems, and the files very complex (several levels)... I found one file, &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-1697&quot; title=&quot;the text show Incorrect&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-1697&quot;&gt;&lt;del&gt;PDFBOX-1697&lt;/del&gt;&lt;/a&gt;, which has a transparency group but no softmask.&lt;/p&gt;

&lt;p&gt;There were several problems:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;page rotation ignored&lt;/li&gt;
	&lt;li&gt;cropbox ignored&lt;/li&gt;
	&lt;li&gt;getScaleX() and getScaleY() used on rotated AffineTransform&lt;/li&gt;
	&lt;li&gt;translation used when only scale was needed&lt;/li&gt;
	&lt;li&gt;initial translation ignored, brings weird effects when JPanel is resized (could also be seen when resizing old PDFReader application)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;The form was drawn badly, and the result was put at the wrong position.&lt;/p&gt;

&lt;p&gt;What helped find the bug:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;creating a huge image in TransparencyGroup and saving it&lt;/li&gt;
	&lt;li&gt;drawing a red rectangle at the bbox bounds of the TransparencyGroup, to see where the content is drawn, when it is drawn outside&lt;/li&gt;
	&lt;li&gt;an improved version of the code in &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3359&quot; title=&quot;Drawing to Graphics2D / ScratchFileBuffer not closed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3359&quot;&gt;&lt;del&gt;PDFBOX-3359&lt;/del&gt;&lt;/a&gt; from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ivanrf&quot; class=&quot;user-hover&quot; rel=&quot;ivanrf&quot;&gt;ivanrf&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;reduced versions of the file from &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-1697&quot; title=&quot;the text show Incorrect&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-1697&quot;&gt;&lt;del&gt;PDFBOX-1697&lt;/del&gt;&lt;/a&gt;, with / without cropbox/rotation and only the bare minimum, plus a rectangle to show where the transparency group should land.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Improved files:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;bugzilla-852992.pdf (but not perfect)&lt;/li&gt;
	&lt;li&gt;gs-bugzilla689518.pdf (but not perfect)&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-1058&quot; title=&quot;Converting PDF to Image gives error and the image generated is of poor quality&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-1058&quot;&gt;&lt;del&gt;PDFBOX-1058&lt;/del&gt;&lt;/a&gt;.pdf page 4 now OK, red ball visible, shadow gone. Page 1 still bad.&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-1697&quot; title=&quot;the text show Incorrect&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-1697&quot;&gt;&lt;del&gt;PDFBOX-1697&lt;/del&gt;&lt;/a&gt;.pdf now OK, &quot;COPY&quot; at the correct position&lt;/li&gt;
	&lt;li&gt;PDFJS-7378.pdf (but not perfect)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;So it&apos;s not much. I suspect that the changes help only at the first level, not at the next one, maybe because it is wrong to use the page size in &quot;inner&quot; levels.&lt;/p&gt;</comment>
                            <comment id="15533344" author="jira-bot" created="Thu, 29 Sep 2016 17:08:43 +0000"  >&lt;p&gt;Commit 1762814 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1762814&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1762814&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3000&quot; title=&quot;Transparency Group issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3000&quot;&gt;&lt;del&gt;PDFBOX-3000&lt;/del&gt;&lt;/a&gt;: save and restore page size, xform and rotation&lt;/p&gt;</comment>
                            <comment id="15533361" author="tilman" created="Thu, 29 Sep 2016 17:12:13 +0000"  >&lt;p&gt;The attached file PDFJS-5811-2-p4_reduced-rotations.pdf is a simple case of transparency groups in 2 levels. The rendering was bad until now because page size etc wasn&apos;t adjusted (as I suspected in my previous comment)&lt;/p&gt;

&lt;p&gt;Improved files:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;PDFJS-5811-2-p4_reduced-rotations.pdf now OK&lt;/li&gt;
	&lt;li&gt;gs-bugzilla689918-veryslow.pdf now OK (big star now good)&lt;/li&gt;
	&lt;li&gt;PDFJS-1324-2012_visitorsguide_web.pdf page 5 now OK (weird line below &quot;park headquarters&quot; is gone). p4, 7 and 11 still bad&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Changed files: (now differently bad):&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-1416&quot; title=&quot;Transparency Group: missing image in reader/image output&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-1416&quot;&gt;&lt;del&gt;PDFBOX-1416&lt;/del&gt;&lt;/a&gt;.pdf&lt;/li&gt;
	&lt;li&gt;PDFJS-5526-p11-13.pdf&lt;/li&gt;
	&lt;li&gt;gs-bugzilla692217.pdf&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15533587" author="jira-bot" created="Thu, 29 Sep 2016 18:20:06 +0000"  >&lt;p&gt;Commit 1762820 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1762820&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1762820&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3000&quot; title=&quot;Transparency Group issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3000&quot;&gt;&lt;del&gt;PDFBOX-3000&lt;/del&gt;&lt;/a&gt;: forgot one line&lt;/p&gt;</comment>
                            <comment id="15533593" author="jira-bot" created="Thu, 29 Sep 2016 18:22:36 +0000"  >&lt;p&gt;Commit 1762821 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1762821&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1762821&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3000&quot; title=&quot;Transparency Group issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3000&quot;&gt;&lt;del&gt;PDFBOX-3000&lt;/del&gt;&lt;/a&gt;: forgot one line&lt;/p&gt;</comment>
                            <comment id="15538139" author="jira-bot" created="Sat, 1 Oct 2016 08:06:08 +0000"  >&lt;p&gt;Commit 1762984 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1762984&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1762984&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3000&quot; title=&quot;Transparency Group issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3000&quot;&gt;&lt;del&gt;PDFBOX-3000&lt;/del&gt;&lt;/a&gt;: refactor&lt;/p&gt;</comment>
                            <comment id="15545859" author="jira-bot" created="Tue, 4 Oct 2016 16:16:56 +0000"  >&lt;p&gt;Commit 1763295 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1763295&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1763295&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3000&quot; title=&quot;Transparency Group issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3000&quot;&gt;&lt;del&gt;PDFBOX-3000&lt;/del&gt;&lt;/a&gt;: new softmask handling with bounds, by John Hewson and Petr Slaby&lt;/p&gt;</comment>
                            <comment id="15545875" author="tilman" created="Tue, 4 Oct 2016 16:23:42 +0000"  >&lt;p&gt;The last change is based on some of the &quot;alt1&quot; patch. BTW the Andreas &quot;dirty hack&quot; was pretty good too (when using the translation changes only) but the &quot;alt1&quot; change was even better.&lt;/p&gt;

&lt;p&gt;Improved:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;007087-payment-due-p1.pdf: better: shadow now visible&lt;/li&gt;
	&lt;li&gt;gs-bugzilla691218.pdf: better: prices now visible&lt;/li&gt;
	&lt;li&gt;gs-bugzilla692160.pdf: probably OK, shadows at correct position&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-1451&quot; title=&quot;Error in converting a pdf to image using convertToImage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-1451&quot;&gt;&lt;del&gt;PDFBOX-1451&lt;/del&gt;&lt;/a&gt;.pdf: shadows now visible&lt;/li&gt;
	&lt;li&gt;***755: OK, shadows at correct position now&lt;/li&gt;
	&lt;li&gt;***417: different color&lt;/li&gt;
	&lt;li&gt;K_UPMEYER_SPRING10.pdf: OK, shadow visible&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-1691&quot; title=&quot;&amp;quot;Foreign&amp;quot; characters are not rendered&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-1691&quot;&gt;&lt;del&gt;PDFBOX-1691&lt;/del&gt;&lt;/a&gt;-FORIS-HV.pdf: OK, shadow visible&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-994&quot; title=&quot;Rendering issues with colors and transparency&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-994&quot;&gt;&lt;del&gt;PDFBOX-994&lt;/del&gt;&lt;/a&gt;.pdf: green is back&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2103&quot; title=&quot;JPXFilter fails to decode some Jpeg2000 images&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2103&quot;&gt;&lt;del&gt;PDFBOX-2103&lt;/del&gt;&lt;/a&gt;.pdf: OK&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2495&quot; title=&quot;Black shapes in the background of some rendered pages of some PDFs&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2495&quot;&gt;&lt;del&gt;PDFBOX-2495&lt;/del&gt;&lt;/a&gt;.pdf: OK, shadows visible&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2658&quot; title=&quot;PdfBox cannot render image with transparency&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2658&quot;&gt;&lt;del&gt;PDFBOX-2658&lt;/del&gt;&lt;/a&gt;.pdf: improved, top right now good&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2950&quot; title=&quot;Chinese font substitution issue&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2950&quot;&gt;&lt;del&gt;PDFBOX-2950&lt;/del&gt;&lt;/a&gt;.pdf: OK, shadows visible&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3118&quot; title=&quot;Drop shadow missing&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3118&quot;&gt;&lt;del&gt;PDFBOX-3118&lt;/del&gt;&lt;/a&gt;.pdf: OK, shadows visible&lt;/li&gt;
	&lt;li&gt;PDFJS-3370-p19.pdf: OK, shadows visible&lt;/li&gt;
	&lt;li&gt;PDFJS-5853.pdf: people slightly visible&lt;/li&gt;
	&lt;li&gt;PDFJS-5811-2.pdf: better&lt;/li&gt;
	&lt;li&gt;PDFJS-4735.pdf: better in half the space&lt;/li&gt;
	&lt;li&gt;PDFJS-3370-p19.pdf: shadows back&lt;/li&gt;
	&lt;li&gt;PDFJS-5811-2.pdf: much improved, p5 still a problem&lt;/li&gt;
	&lt;li&gt;PDFJS-5853.pdf: faces somewhat visible again, as in rev 1633496&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Differently bad:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;bugzilla-852992.pdf&lt;/li&gt;
	&lt;li&gt;evince-bug431088.pdf&lt;/li&gt;
	&lt;li&gt;gs-bugzilla688601.pdf&lt;/li&gt;
	&lt;li&gt;gs-bugzilla692217.pdf&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-1416&quot; title=&quot;Transparency Group: missing image in reader/image output&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-1416&quot;&gt;&lt;del&gt;PDFBOX-1416&lt;/del&gt;&lt;/a&gt;.pdf&lt;/li&gt;
	&lt;li&gt;PDFJS-3096.pdf&lt;/li&gt;
	&lt;li&gt;PDFJS-4735.pdf&lt;/li&gt;
	&lt;li&gt;PDFJS-5526-p11-13.pdf&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-1870&quot; title=&quot;PDFunctionType0 incorrect&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-1870&quot;&gt;&lt;del&gt;PDFBOX-1870&lt;/del&gt;&lt;/a&gt;-technical_v2_p9.pdf&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;I&apos;ve also included the &quot;why no soft mask&quot; comments. I tried changing the code in getNonStrokingPaint() like in getStrokingPaint() but the result was terrible, except for PDFJS-5853.pdf (the class photo in Israel) which was perfect for the first time.&lt;/p&gt;

&lt;p&gt;There are some changes that I didn&apos;t use yet but will test later, against the &quot;good results&quot; that I have now.&lt;/p&gt;</comment>
                            <comment id="15545970" author="tilman" created="Tue, 4 Oct 2016 17:02:35 +0000"  >&lt;p&gt;007087-payment-due-p58_reduced2.pdf, samsung_galaxy_s_4_um-p1_reduced.pdf, &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3400&quot; title=&quot;Gradient/Shading color alpha stepping do not work correctly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3400&quot;&gt;&lt;del&gt;PDFBOX-3400&lt;/del&gt;&lt;/a&gt;-RGB.pdf are all simplified files (that don&apos;t render properly) for further debugging.&lt;/p&gt;</comment>
                            <comment id="15546189" author="tilman" created="Tue, 4 Oct 2016 18:12:45 +0000"  >&lt;p&gt;This one&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;-            &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; maxX = (&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;) &lt;span class=&quot;code-object&quot;&gt;Math&lt;/span&gt;.floor(bounds.getMaxX()) + 1;
-            &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; maxY = (&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;) &lt;span class=&quot;code-object&quot;&gt;Math&lt;/span&gt;.floor(bounds.getMaxY()) + 1;
+            &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; maxX = (&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;) &lt;span class=&quot;code-object&quot;&gt;Math&lt;/span&gt;.floor(bounds.getMaxX()) - 1; &lt;span class=&quot;code-comment&quot;&gt;// FIXME: The -1 here does not feel right, 
&lt;/span&gt;+            &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; maxY = (&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;) &lt;span class=&quot;code-object&quot;&gt;Math&lt;/span&gt;.floor(bounds.getMaxY()) - 1; &lt;span class=&quot;code-comment&quot;&gt;// but I get white lines in the PDF attached to PDFBOX-2104 without &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;
&lt;/span&gt; 
-            width = maxX - minX;
-            height = maxY - minY;
+            width = &lt;span class=&quot;code-object&quot;&gt;Math&lt;/span&gt;.max(1, maxX - minX);
+            height = &lt;span class=&quot;code-object&quot;&gt;Math&lt;/span&gt;.max(1, maxY - minY);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;is not helpful at this time, because it makes every rendering different, even files where that didn&apos;t know had transparency groups.&lt;/p&gt;</comment>
                            <comment id="15546391" author="tilman" created="Tue, 4 Oct 2016 19:27:21 +0000"  >&lt;p&gt;The change related to the comment &quot;blit directly onto the graphics device using the identity transform&quot; didn&apos;t work. So that&apos;s it for now for the &quot;alt1&quot; patch. I have no new ideas, but I&apos;ll keep looking at the test files for clues.&lt;/p&gt;</comment>
                            <comment id="15546700" author="tilman" created="Tue, 4 Oct 2016 21:20:25 +0000"  >&lt;p&gt;PDFJS-2845-p1.pdf  - &quot;MIAMI&quot; and &quot;TALENTS&quot; have the wrong color.&lt;/p&gt;</comment>
                            <comment id="15549171" author="jira-bot" created="Wed, 5 Oct 2016 16:09:27 +0000"  >&lt;p&gt;Commit 1763463 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1763463&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1763463&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3000&quot; title=&quot;Transparency Group issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3000&quot;&gt;&lt;del&gt;PDFBOX-3000&lt;/del&gt;&lt;/a&gt;: avoid ArrayIndexOutOfBoundsException, simplify output raster creation, assign rgba&lt;span class=&quot;error&quot;&gt;&amp;#91;3&amp;#93;&lt;/span&gt; only if within bounds&lt;/p&gt;</comment>
                            <comment id="15549179" author="tilman" created="Wed, 5 Oct 2016 16:11:54 +0000"  >&lt;p&gt;Improvements:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;007087-payment-due-p1.pdf &quot;payment due&quot; now visible (but some weird lines)&lt;/li&gt;
	&lt;li&gt;007087-payment-due-p58.pdf: &quot;payment due&quot; now visible (but some weird lines)&lt;/li&gt;
	&lt;li&gt;bugzilla869140.pdf: shadow of &quot;KITCHEN&quot; now visible&lt;/li&gt;
	&lt;li&gt;gs-bugzilla691218.pdf: group of people now visible&lt;/li&gt;
	&lt;li&gt;***417.pdf: shadows on p3 and 4 visible&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-1577&quot; title=&quot;Transparency and Shadow Effects&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-1577&quot;&gt;&lt;del&gt;PDFBOX-1577&lt;/del&gt;&lt;/a&gt;.pdf: now good!!!!&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2103&quot; title=&quot;JPXFilter fails to decode some Jpeg2000 images&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2103&quot;&gt;&lt;del&gt;PDFBOX-2103&lt;/del&gt;&lt;/a&gt;.pdf: p1 more shadows&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2658&quot; title=&quot;PdfBox cannot render image with transparency&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2658&quot;&gt;&lt;del&gt;PDFBOX-2658&lt;/del&gt;&lt;/a&gt;.pdf: &quot;JE SUIS CHARLIE&quot; foto now visible&lt;/li&gt;
	&lt;li&gt;PDFJS-6924: small images now visible (but some with incorrect color)&lt;/li&gt;
	&lt;li&gt;PDFJS-6967.pdf: big image now visible (but one image still missing)&lt;/li&gt;
	&lt;li&gt;PDFJS-7378.pdf: circle now visible&lt;/li&gt;
	&lt;li&gt;samsung_galaxy_s_4_um-p1.pdf: V and Z now visible&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Changed: &lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;bugzilla-852992.pdf&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2950&quot; title=&quot;Chinese font substitution issue&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2950&quot;&gt;&lt;del&gt;PDFBOX-2950&lt;/del&gt;&lt;/a&gt;.pdf: one line that doesn&apos;t belong (top left)&lt;/li&gt;
	&lt;li&gt;PDFJS-3096.pdf&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15551033" author="tilman" created="Thu, 6 Oct 2016 06:28:14 +0000"  >&lt;blockquote&gt;
&lt;p&gt;The calculation of the alpha value was wrong. It must not be premultiplied but simply be copied to the alpha channel.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;As a test, I modified softmask.java like this (and passed the softmask):&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (COSName.ALPHA.equals(softMask.getSubType()))
{
    rgba[3] = gray[0];
}
&lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt;
{
    rgba[3] = &lt;span class=&quot;code-object&quot;&gt;Math&lt;/span&gt;.round(rgba[3] * (gray[0] / 255f)); &lt;span class=&quot;code-comment&quot;&gt;// multiply alpha
&lt;/span&gt;}                                      
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;However this resulted in bad rendering (much black) of&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;evince-bug431088.pdf&lt;/li&gt;
	&lt;li&gt;gs-bugilla691763.pdf&lt;/li&gt;
	&lt;li&gt;gs-bugzilla689439-alphamask.pdf&lt;/li&gt;
	&lt;li&gt;gs-bugzilla693322.pdf&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15552362" author="lehmi" created="Thu, 6 Oct 2016 16:14:15 +0000"  >&lt;p&gt;I didn&apos;t dig that deep into this stuff, so that this is just a vague guess. What about the AIS value of the ExtGState? It seems to be important when interpreting the smask values and it looks like we aren&apos;t using it yet.&lt;/p&gt;</comment>
                            <comment id="15552434" author="tilman" created="Thu, 6 Oct 2016 16:39:42 +0000"  >&lt;p&gt;These are the remaining files from the changes made in &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2423&quot; title=&quot;Page tree handling needs rewriting&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2423&quot;&gt;&lt;del&gt;PDFBOX-2423&lt;/del&gt;&lt;/a&gt; after rev 1465217:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;eci_altona-test-suite-v2_technical_H.pdf (one thin line only)&lt;/li&gt;
	&lt;li&gt;gs-bugilla691763.pdf (flipped)&lt;/li&gt;
	&lt;li&gt;gs-bugzilla688601.pdf&lt;/li&gt;
	&lt;li&gt;gs-bugzilla689439-alphamask.pdf (flipped)&lt;/li&gt;
	&lt;li&gt;gs-bugzilla689931.pdf (but rev 1633472 wasn&apos;t correct either)&lt;/li&gt;
	&lt;li&gt;gs-bugzilla691504.pdf (not very important, one pattern is different)&lt;/li&gt;
	&lt;li&gt;gs-bugzilla693322.pdf (flipped)&lt;/li&gt;
	&lt;li&gt;gs-bugzilla694585.pdf (some missing)&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-1058&quot; title=&quot;Converting PDF to Image gives error and the image generated is of poor quality&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-1058&quot;&gt;&lt;del&gt;PDFBOX-1058&lt;/del&gt;&lt;/a&gt;.pdf p1 (curves missing)&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2182&quot; title=&quot;Regression Watermark image missing&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2182&quot;&gt;&lt;del&gt;PDFBOX-2182&lt;/del&gt;&lt;/a&gt;.pdf (shading missing)&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3182&quot; title=&quot;Image not rendered  &quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3182&quot;&gt;&lt;del&gt;PDFBOX-3182&lt;/del&gt;&lt;/a&gt;.pdf (image missing)&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3494&quot; title=&quot;PDFRenderer - Text shadow has wrong position&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3494&quot;&gt;&lt;del&gt;PDFBOX-3494&lt;/del&gt;&lt;/a&gt;.pdf (shadow at wrong position)&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3494&quot; title=&quot;PDFRenderer - Text shadow has wrong position&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3494&quot;&gt;&lt;del&gt;PDFBOX-3494&lt;/del&gt;&lt;/a&gt;-reduced.pdf (shadow at wrong position)&lt;/li&gt;
	&lt;li&gt;PDFJS-1324-2012_visitorsguide_web.pdf p4 (&quot;construction&quot; background logo on the left missing)&lt;/li&gt;
	&lt;li&gt;PDFJS-2825-veryslow.pdf (parts flipped, parts missing)&lt;/li&gt;
	&lt;li&gt;PDFJS-4735.pdf (dancing people at wrong position)&lt;/li&gt;
	&lt;li&gt;PDFJS-5811-2.pdf p3 (all at wrong X position. The memory problem in p2 was in JDK7 only.)&lt;/li&gt;
	&lt;li&gt;PDFJS-6496-XStep99999.pdf (flipped; I changed 99999 to 32767 to render in rev 1465217)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;We&apos;re only slightly further than a year ago; the main difference is that at that time, I had believed that there would be &quot;the one patch that solves everything&quot; and now I have &quot;Lowered Expectations&quot; and I&apos;ve accepted that it can only be done step by step so I did the recent commits.&lt;/p&gt;

&lt;p&gt;Files that can&apos;t be rendered with rev 1465217 or were bad at that time, and are not yet perfect:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;007087-payment-due-p1.pdf&lt;/li&gt;
	&lt;li&gt;007087-payment-due-p58.pdf&lt;/li&gt;
	&lt;li&gt;evince-bug431088.pdf&lt;/li&gt;
	&lt;li&gt;gs-bugzilla691218.pdf&lt;/li&gt;
	&lt;li&gt;gs-bugzilla692217.pdf&lt;/li&gt;
	&lt;li&gt;gs-bugzilla693520.pdf&lt;/li&gt;
	&lt;li&gt;***371&lt;/li&gt;
	&lt;li&gt;***22579&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-1416&quot; title=&quot;Transparency Group: missing image in reader/image output&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-1416&quot;&gt;&lt;del&gt;PDFBOX-1416&lt;/del&gt;&lt;/a&gt;.pdf&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3400&quot; title=&quot;Gradient/Shading color alpha stepping do not work correctly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3400&quot;&gt;&lt;del&gt;PDFBOX-3400&lt;/del&gt;&lt;/a&gt;.pdf&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3400&quot; title=&quot;Gradient/Shading color alpha stepping do not work correctly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3400&quot;&gt;&lt;del&gt;PDFBOX-3400&lt;/del&gt;&lt;/a&gt;-RGB.pdf&lt;/li&gt;
	&lt;li&gt;PDFJS-775-badshadow.pdf&lt;/li&gt;
	&lt;li&gt;PDFJS-3096.pdf&lt;/li&gt;
	&lt;li&gt;PDFJS-2845-p1.pdf&lt;/li&gt;
	&lt;li&gt;PDFJS-5526-p11-13.pdf (red balls missing)&lt;/li&gt;
	&lt;li&gt;PDFJS-6924.pdf&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-994&quot; title=&quot;Rendering issues with colors and transparency&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-994&quot;&gt;&lt;del&gt;PDFBOX-994&lt;/del&gt;&lt;/a&gt;.pdf (wrong colors, shadows missing)&lt;/li&gt;
	&lt;li&gt;samsung_galaxy_s_4_um-p1_reduced.pdf (the non-reduced file is ok)&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15552455" author="tilman" created="Thu, 6 Oct 2016 16:48:03 +0000"  >&lt;p&gt;gs-bugzilla693322_reduced.pdf is a file to show the &quot;flip&quot; problem. My current suspicion is that it may be related to having a pattern.&lt;/p&gt;</comment>
                            <comment id="15552699" author="tilman" created="Thu, 6 Oct 2016 18:12:01 +0000"  >&lt;p&gt;I found only AIS being false. True would be &quot;alpha is shape&quot;. The specification tells:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Shape values of 0.0 and 1.0 identify points that lie outside and inside a conventional sharp-edged object; intermediate values are useful in defining soft-edged objects.&lt;br/&gt;
Shape and opacity are conceptually very similar. In fact, they can usually be combined into a single value, called alpha, which controls both the colour compositing computation and the fading between an object and its backdrop. However, there are a few situations in which they shall be treated separately; see 11.4.6, &quot;Knockout Groups.&quot;&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I doubt that we have the skills to properly handle knockout groups after having seen the Dr. B&#228;rfuss video &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="15555703" author="jira-bot" created="Fri, 7 Oct 2016 17:30:25 +0000"  >&lt;p&gt;Commit 1763806 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1763806&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1763806&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3000&quot; title=&quot;Transparency Group issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3000&quot;&gt;&lt;del&gt;PDFBOX-3000&lt;/del&gt;&lt;/a&gt;: flip transparency group image when rendering it in the first level of a tiling pattern&lt;/p&gt;</comment>
                            <comment id="15555710" author="tilman" created="Fri, 7 Oct 2016 17:34:40 +0000"  >&lt;p&gt;The following files are now rendering correctly:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;evince-bug431088.pdf&lt;/li&gt;
	&lt;li&gt;gs-bugzilla689439-alphamask.pdf&lt;/li&gt;
	&lt;li&gt;gs-bugilla691763.pdf&lt;/li&gt;
	&lt;li&gt;gs-bugzilla692217.pdf&lt;/li&gt;
	&lt;li&gt;gs-bugzilla693322.pdf&lt;/li&gt;
	&lt;li&gt;PDFJS-2825-veryslow.pdf&lt;/li&gt;
	&lt;li&gt;PDFJS-6496-XStep99999.pdf&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15557660" author="lehmi" created="Sat, 8 Oct 2016 09:54:29 +0000"  >&lt;p&gt;OK, I see. It was just a thought from an outsider &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="15557703" author="tilman" created="Sat, 8 Oct 2016 10:21:50 +0000"  >&lt;p&gt;(Updated) These are the remaining files from the changes made in &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2423&quot; title=&quot;Page tree handling needs rewriting&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2423&quot;&gt;&lt;del&gt;PDFBOX-2423&lt;/del&gt;&lt;/a&gt; after rev 1465217:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;eci_altona-test-suite-v2_technical_H.pdf (one thin line only)&lt;/li&gt;
	&lt;li&gt;gs-bugzilla688601.pdf&lt;/li&gt;
	&lt;li&gt;gs-bugzilla689931.pdf (but rev 1633472 wasn&apos;t correct either)&lt;/li&gt;
	&lt;li&gt;gs-bugzilla691504.pdf (not very important, one pattern is different)&lt;/li&gt;
	&lt;li&gt;gs-bugzilla694585.pdf (some missing)&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-1058&quot; title=&quot;Converting PDF to Image gives error and the image generated is of poor quality&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-1058&quot;&gt;&lt;del&gt;PDFBOX-1058&lt;/del&gt;&lt;/a&gt;.pdf p1 (curves missing)&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2182&quot; title=&quot;Regression Watermark image missing&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2182&quot;&gt;&lt;del&gt;PDFBOX-2182&lt;/del&gt;&lt;/a&gt;.pdf (shading missing)&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3182&quot; title=&quot;Image not rendered  &quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3182&quot;&gt;&lt;del&gt;PDFBOX-3182&lt;/del&gt;&lt;/a&gt;.pdf (image missing)&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3494&quot; title=&quot;PDFRenderer - Text shadow has wrong position&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3494&quot;&gt;&lt;del&gt;PDFBOX-3494&lt;/del&gt;&lt;/a&gt;.pdf (shadow at wrong position)&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3494&quot; title=&quot;PDFRenderer - Text shadow has wrong position&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3494&quot;&gt;&lt;del&gt;PDFBOX-3494&lt;/del&gt;&lt;/a&gt;-reduced.pdf (shadow at wrong position)&lt;/li&gt;
	&lt;li&gt;gs-bugzilla694556-3.pdf (shadows at wrong position)&lt;/li&gt;
	&lt;li&gt;gs-bugzilla695354.pdf (shadows at wrong position)&lt;/li&gt;
	&lt;li&gt;PDFJS-1324-2012_visitorsguide_web.pdf p4 (&quot;construction&quot; background logo on the left missing)&lt;/li&gt;
	&lt;li&gt;PDFJS-4735.pdf (dancing people at wrong position)&lt;/li&gt;
	&lt;li&gt;PDFJS-5811-2.pdf p3 (all at wrong X position. The memory problem in p2 was in JDK7 only.)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Files that can&apos;t be rendered with rev 1465217 or were bad at that time, and are not yet perfect:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;007087-payment-due-p1.pdf&lt;/li&gt;
	&lt;li&gt;007087-payment-due-p58.pdf&lt;/li&gt;
	&lt;li&gt;gs-bugzilla691218.pdf&lt;/li&gt;
	&lt;li&gt;gs-bugzilla693520.pdf&lt;/li&gt;
	&lt;li&gt;***371&lt;/li&gt;
	&lt;li&gt;***22579&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-1416&quot; title=&quot;Transparency Group: missing image in reader/image output&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-1416&quot;&gt;&lt;del&gt;PDFBOX-1416&lt;/del&gt;&lt;/a&gt;.pdf&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3400&quot; title=&quot;Gradient/Shading color alpha stepping do not work correctly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3400&quot;&gt;&lt;del&gt;PDFBOX-3400&lt;/del&gt;&lt;/a&gt;.pdf&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3400&quot; title=&quot;Gradient/Shading color alpha stepping do not work correctly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3400&quot;&gt;&lt;del&gt;PDFBOX-3400&lt;/del&gt;&lt;/a&gt;-RGB.pdf&lt;/li&gt;
	&lt;li&gt;PDFJS-775-badshadow.pdf&lt;/li&gt;
	&lt;li&gt;PDFJS-3096.pdf&lt;/li&gt;
	&lt;li&gt;PDFJS-2845-p1.pdf&lt;/li&gt;
	&lt;li&gt;PDFJS-5526-p11-13.pdf (red balls missing)&lt;/li&gt;
	&lt;li&gt;PDFJS-6924.pdf&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-994&quot; title=&quot;Rendering issues with colors and transparency&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-994&quot;&gt;&lt;del&gt;PDFBOX-994&lt;/del&gt;&lt;/a&gt;.pdf (wrong colors, shadows missing)&lt;/li&gt;
	&lt;li&gt;samsung_galaxy_s_4_um-p1_reduced.pdf (the non-reduced file is ok)&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15562843" author="jira-bot" created="Mon, 10 Oct 2016 17:12:14 +0000"  >&lt;p&gt;Commit 1764153 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1764153&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1764153&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3000&quot; title=&quot;Transparency Group issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3000&quot;&gt;&lt;del&gt;PDFBOX-3000&lt;/del&gt;&lt;/a&gt;: avoid NPE if softmask /G entry missing&lt;/p&gt;</comment>
                            <comment id="15562844" author="jira-bot" created="Mon, 10 Oct 2016 17:12:19 +0000"  >&lt;p&gt;Commit 1764154 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1764154&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1764154&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3000&quot; title=&quot;Transparency Group issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3000&quot;&gt;&lt;del&gt;PDFBOX-3000&lt;/del&gt;&lt;/a&gt;: avoid NPE if softmask /G entry missing&lt;/p&gt;</comment>
                            <comment id="15565976" author="tilman" created="Tue, 11 Oct 2016 16:59:39 +0000"  >&lt;p&gt;I&apos;m afraid that gs-bugzilla695582-transparency-fill-stroke.pdf is a tough one: the stroke and fill areas overlap. So when stroke and fill is done, one of the two will be wrong because the previous composite operation has already been done, thus giving a different result. I suspect that Adobe does both operations on an original copy of the image, and puts the result after that so that fill and stroke won&apos;t interfere with each other. Or it is able to transform the area of a &quot;thick stroke&quot; into a clipping area.&lt;/p&gt;</comment>
                            <comment id="15565984" author="tilman" created="Tue, 11 Oct 2016 17:03:39 +0000"  >&lt;p&gt;These files are rendered properly if the cropbox is removed:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;gs-bugzilla694556-3.pdf&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3494&quot; title=&quot;PDFRenderer - Text shadow has wrong position&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3494&quot;&gt;&lt;del&gt;PDFBOX-3494&lt;/del&gt;&lt;/a&gt;.pdf&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;These files have elements at the wrong place and the translation seems to be identical to the bbox origin of the first transparency group:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;PDFJS-5811-2.pdf page 3&lt;/li&gt;
	&lt;li&gt;gs-bugzilla695354.pdf&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15589169" author="jira-bot" created="Wed, 19 Oct 2016 16:27:46 +0000"  >&lt;p&gt;Commit 1765674 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1765674&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1765674&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3000&quot; title=&quot;Transparency Group issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3000&quot;&gt;&lt;del&gt;PDFBOX-3000&lt;/del&gt;&lt;/a&gt;: avoid ClassCastException if transparency group in softmask isn&apos;t one (ghostscript bug 691854), remove super(), improve javadoc&lt;/p&gt;</comment>
                            <comment id="15589170" author="jira-bot" created="Wed, 19 Oct 2016 16:27:49 +0000"  >&lt;p&gt;Commit 1765675 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1765675&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1765675&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3000&quot; title=&quot;Transparency Group issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3000&quot;&gt;&lt;del&gt;PDFBOX-3000&lt;/del&gt;&lt;/a&gt;: avoid ClassCastException if transparency group in softmask isn&apos;t one (ghostscript bug 691854), remove super(), improve javadoc&lt;/p&gt;</comment>
                            <comment id="15657712" author="jira-bot" created="Fri, 11 Nov 2016 18:20:10 +0000"  >&lt;p&gt;Commit 1769322 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1769322&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1769322&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3000&quot; title=&quot;Transparency Group issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3000&quot;&gt;&lt;del&gt;PDFBOX-3000&lt;/del&gt;&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3564&quot; title=&quot;SoftMask needs consider colormodel of input Image&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3564&quot;&gt;&lt;del&gt;PDFBOX-3564&lt;/del&gt;&lt;/a&gt;: use the colormodel corresponding to the source raster to convert into the components, as suggested by &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3564&quot; title=&quot;SoftMask needs consider colormodel of input Image&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3564&quot;&gt;&lt;del&gt;PDFBOX-3564&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15660371" author="tilman" created="Sat, 12 Nov 2016 22:16:33 +0000"  >&lt;p&gt;gs-bugzilla691157_mod_unc.pdf is a simplified version of the file from &lt;a href=&quot;http://bugs.ghostscript.com/show_bug.cgi?id=691157&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://bugs.ghostscript.com/show_bug.cgi?id=691157&lt;/a&gt; . That issue has an interesting comment by Michael Vrhel. The point he is making is that the ctm (and more) is to be stored for the softmask at the time of &lt;tt&gt;/GS0 gs&lt;/tt&gt;, because at the time &lt;tt&gt;/Im28 Do&lt;/tt&gt; is run it has already been changed.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    /GS0 gs
    180 0 0 135 258.411 235.714 cm
    /Im0 Do
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;As a test only, I hard coded that the ctm is not to be used for the rendering of the soft mask at two places (this works only for this file, because the ctm is identity at the time of the &quot;gs&quot; command), and now the cutout appears correctly (although there&apos;s wrong stuff outside of the mask).&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/12838668/12838668_gs-bugzilla691157_mod_unc.png&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;So we&apos;ll need to store the ctm and possibly the complete graphic state for a softmask at the time we encounter it, not at the time we apply it.&lt;/p&gt;</comment>
                            <comment id="15664471" author="jira-bot" created="Mon, 14 Nov 2016 17:29:10 +0000"  >&lt;p&gt;Commit 1769667 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1769667&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1769667&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3000&quot; title=&quot;Transparency Group issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3000&quot;&gt;&lt;del&gt;PDFBOX-3000&lt;/del&gt;&lt;/a&gt;: reset softmask for transparency groups too&lt;/p&gt;</comment>
                            <comment id="15664477" author="jira-bot" created="Mon, 14 Nov 2016 17:30:23 +0000"  >&lt;p&gt;Commit 1769668 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1769668&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1769668&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3000&quot; title=&quot;Transparency Group issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3000&quot;&gt;&lt;del&gt;PDFBOX-3000&lt;/del&gt;&lt;/a&gt;: reset softmask for transparency groups too&lt;/p&gt;</comment>
                            <comment id="15664489" author="tilman" created="Mon, 14 Nov 2016 17:35:11 +0000"  >&lt;p&gt;Improved files:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;evince-bug431088.pdf: pink donut now looks like a CD&lt;/li&gt;
	&lt;li&gt;gs-bugzilla688261.pdf: globe can be seen now&lt;/li&gt;
	&lt;li&gt;gs-bugzilla686747.ai: lower &quot;happy birthday&quot; now in correct colors&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15670967" author="jira-bot" created="Wed, 16 Nov 2016 16:54:26 +0000"  >&lt;p&gt;Commit 1770016 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1770016&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1770016&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3000&quot; title=&quot;Transparency Group issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3000&quot;&gt;&lt;del&gt;PDFBOX-3000&lt;/del&gt;&lt;/a&gt;: set initialMatrix for annotations&lt;/p&gt;</comment>
                            <comment id="15670968" author="jira-bot" created="Wed, 16 Nov 2016 16:54:31 +0000"  >&lt;p&gt;Commit 1770017 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1770017&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1770017&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3000&quot; title=&quot;Transparency Group issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3000&quot;&gt;&lt;del&gt;PDFBOX-3000&lt;/del&gt;&lt;/a&gt;: set initialMatrix for annotations&lt;/p&gt;</comment>
                            <comment id="15670975" author="tilman" created="Wed, 16 Nov 2016 16:57:50 +0000"  >&lt;p&gt;The last commit solves the regression for the file from &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2182&quot; title=&quot;Regression Watermark image missing&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2182&quot;&gt;&lt;del&gt;PDFBOX-2182&lt;/del&gt;&lt;/a&gt;. The file I just added (&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2182&quot; title=&quot;Regression Watermark image missing&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2182&quot;&gt;&lt;del&gt;PDFBOX-2182&lt;/del&gt;&lt;/a&gt;_mod.pdf) shows the problem more clearly: the shading pattern is more visible, once as an annotation and once in the page. Both must look identical.&lt;/p&gt;</comment>
                            <comment id="15693751" author="jira-bot" created="Thu, 24 Nov 2016 16:53:16 +0000"  >&lt;p&gt;Commit 1771189 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1771189&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1771189&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3000&quot; title=&quot;Transparency Group issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3000&quot;&gt;&lt;del&gt;PDFBOX-3000&lt;/del&gt;&lt;/a&gt;: avoid calling PDColorSpace.create() with null&lt;/p&gt;</comment>
                            <comment id="15693752" author="jira-bot" created="Thu, 24 Nov 2016 16:53:20 +0000"  >&lt;p&gt;Commit 1771190 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1771190&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1771190&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3000&quot; title=&quot;Transparency Group issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3000&quot;&gt;&lt;del&gt;PDFBOX-3000&lt;/del&gt;&lt;/a&gt;: avoid calling PDColorSpace.create() with null&lt;/p&gt;</comment>
                            <comment id="15696222" author="jira-bot" created="Fri, 25 Nov 2016 16:22:27 +0000"  >&lt;p&gt;Commit 1771336 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1771336&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1771336&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3000&quot; title=&quot;Transparency Group issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3000&quot;&gt;&lt;del&gt;PDFBOX-3000&lt;/del&gt;&lt;/a&gt;: initialize transparency group processing as requested by the PDF specification&lt;/p&gt;</comment>
                            <comment id="15696223" author="jira-bot" created="Fri, 25 Nov 2016 16:22:31 +0000"  >&lt;p&gt;Commit 1771337 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1771337&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1771337&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3000&quot; title=&quot;Transparency Group issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3000&quot;&gt;&lt;del&gt;PDFBOX-3000&lt;/del&gt;&lt;/a&gt;: initialize transparency group processing as requested by the PDF specification&lt;/p&gt;</comment>
                            <comment id="15696227" author="tilman" created="Fri, 25 Nov 2016 16:24:37 +0000"  >&lt;p&gt;Once in a while, it helps to read the PDF specification &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;  &lt;/p&gt;

&lt;p&gt;Improved files by the last commit (not regression-related):&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;gs-bugzilla689518.pdf now perfect, upper wall now only vertical lines&lt;/li&gt;
	&lt;li&gt;gs-bugzilla688870.pdf: bubbles near 1, 2, 3 etc more visible&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2019&quot; title=&quot;Annotations produced by Annotation.java example are not rendered correctly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2019&quot;&gt;&lt;del&gt;PDFBOX-2019&lt;/del&gt;&lt;/a&gt;-Annotations.pdf (with AP): purple now visible&lt;/li&gt;
	&lt;li&gt;PDFJS-5811-2.pdf: p2: shadow around the R&#233;gion Nantaise map better visibility; p7 and 8: &quot;@&quot; better visibility&lt;/li&gt;
	&lt;li&gt;gs-bugzilla693220.pdf: &quot;unky&quot; better visibility&lt;/li&gt;
	&lt;li&gt;gs-bugzilla686747.ai: bubbles better visibility&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15715667" author="jira-bot" created="Fri, 2 Dec 2016 17:07:39 +0000"  >&lt;p&gt;Commit 1772377 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1772377&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1772377&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3000&quot; title=&quot;Transparency Group issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3000&quot;&gt;&lt;del&gt;PDFBOX-3000&lt;/del&gt;&lt;/a&gt;: adjust pagesize and bounds for non (0,0) origin&lt;/p&gt;</comment>
                            <comment id="15715714" author="tilman" created="Fri, 2 Dec 2016 17:19:02 +0000"  >&lt;p&gt;The last commit was developed by debugging the rendering of PDFJS-5811-2-p3_reduced4.pdf which has two nested transparency groups, none of which start at (0,0). After doing the upper change (&lt;tt&gt;new PDRectangle(...&lt;/tt&gt;), many files were improved but some black rectangles started to appear in some files, and a mysterious vertical line appeared in the middle of a less reduced version, PDFJS-5811-2-p3_reduced.pdf, which has a softmask. Zooming in on that one showed some grey that was at about 1/2 of the square, at 38 units, which is the offset of the outer transparency group. That one gave it away that the softmask was also wrong by an offset, and this resulted in the second change, in getBounds(). This fixed quite a lot of files.&lt;/p&gt;

&lt;p&gt;And I&apos;m also learned something: colors at wrong position =&amp;gt; transparency problem. Black squares, shadows at wrong position =&amp;gt; softmask problem.&lt;/p&gt;

&lt;p&gt;Improved files (&quot;probably perfect&quot; means that the file is too complex to tell):&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;bugzilla-852992.pdf: color change is back, but not perfect&lt;/li&gt;
	&lt;li&gt;ds-firewall-enterprise-p1.pdf: perfect, cables visible&lt;/li&gt;
	&lt;li&gt;gs-bugzilla686747.ai: probably perfect, gradient masking of lower happy birthday now there&lt;/li&gt;
	&lt;li&gt;gs-bugzilla688601.pdf: perfect&lt;/li&gt;
	&lt;li&gt;gs-bugzilla689095.pdf: mostly perfect, inside of &quot;verso&quot; visible&lt;/li&gt;
	&lt;li&gt;gs-bugzilla689918-veryslow.pdf: probably perfect, star is shining&lt;/li&gt;
	&lt;li&gt;gs-bugzilla690351-p10.pdf: probably perfect, shadows correct&lt;/li&gt;
	&lt;li&gt;gs-bugzilla690535.pdf: euro visible, although not in gold&lt;/li&gt;
	&lt;li&gt;gs-bugzilla691182.pdf: perfect, car and shadow correct&lt;/li&gt;
	&lt;li&gt;gs-bugzilla691218.pdf: improved, shadow below SONATA&lt;/li&gt;
	&lt;li&gt;gs-bugzilla694556-3.pdf: perfect, shadows correct&lt;/li&gt;
	&lt;li&gt;gs-bugzilla694585.pdf: probably perfect, blue ball is back&lt;/li&gt;
	&lt;li&gt;gs-bugzilla695354.pdf: perfect, shadows correct&lt;/li&gt;
	&lt;li&gt;gs-bugzilla697350.pdf: perfect&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-1058&quot; title=&quot;Converting PDF to Image gives error and the image generated is of poor quality&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-1058&quot;&gt;&lt;del&gt;PDFBOX-1058&lt;/del&gt;&lt;/a&gt;.pdf: probably perfect, fine lines are back&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3494&quot; title=&quot;PDFRenderer - Text shadow has wrong position&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3494&quot;&gt;&lt;del&gt;PDFBOX-3494&lt;/del&gt;&lt;/a&gt;.pdf: perfect, shadow correct&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3501&quot; title=&quot;java.lang.ArrayIndexOutOfBoundsException when rendering to bitonal image type&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3501&quot;&gt;&lt;del&gt;PDFBOX-3501&lt;/del&gt;&lt;/a&gt;.pdf: perfect, background colors now visible&lt;/li&gt;
	&lt;li&gt;PDFJS-1324-2012_visitorsguide_web.pdf p4: perfect, &quot;under construction&quot; watermark visible; p3: footprints visible&lt;/li&gt;
	&lt;li&gt;PDFJS-4735.pdf: probably perfect, dancers are back&lt;/li&gt;
	&lt;li&gt;PDFJS-5811-2.pdf: p2: perfect, shadows on boxes; p3: perfect, squares at correct position&lt;/li&gt;
	&lt;li&gt;PDFJS-6113.pdf: probably perfect, &quot;Fukayuki-rinkan&quot; now visible&lt;/li&gt;
	&lt;li&gt;PDFJS-6967.pdf: perfect, lower right image visible&lt;/li&gt;
	&lt;li&gt;gs-bugzilla692286.pdf: now perfect, colors are back&lt;/li&gt;
	&lt;li&gt;gs-bugzilla693033.pdf: now perfect, stuff near &quot;jourJ&quot; is back&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Changed files:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;gs-bugzilla688870.pdf&lt;/li&gt;
	&lt;li&gt;PDFJS-3096.pdf: shadows below smartphones visible, rest still bad&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Worsened files:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;bugzilla869140.pdf: girls room no longer pink&lt;/li&gt;
	&lt;li&gt;gs-bugzilla692217.pdf: shadows at wrong position&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Of those about which I complained in &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2423&quot; title=&quot;Page tree handling needs rewriting&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2423&quot;&gt;&lt;del&gt;PDFBOX-2423&lt;/del&gt;&lt;/a&gt;, there are only two left that don&apos;t render like in 1633472. However there are others I found later so there&apos;s still work to do. I&apos;ll keep creating reduced files and debug from there.&lt;/p&gt;

&lt;p&gt;I&apos;m not yet ready to transfer the changes to the 2.0 branch, I prefer to solve the obvious problems first. Examples:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;gs-bugzilla689309-1.pdf&lt;/li&gt;
	&lt;li&gt;gs-bugzilla691537.pdf&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15715940" author="tilman" created="Fri, 2 Dec 2016 18:55:59 +0000"  >&lt;p&gt;I&apos;ll wait a bit for that one... because there were some weird effects, maybe these are due to other errors. Memo for me:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;in PDExtendedGraphicsState.copyIntoGraphicsState initialize softmask with current CTM&lt;/li&gt;
	&lt;li&gt;have CTM field + getter + setter in PFSoftMask&lt;/li&gt;
	&lt;li&gt;initialize TransparencyGroup with new CTM parameter when TransparencyGroup is created&lt;/li&gt;
	&lt;li&gt;in PDFStreamEngine.processSoftMask initialize CTM with&lt;br/&gt;
  getGraphicsState().setCurrentTransformationMatrix(getGraphicsState().getSoftMask().getInitialCTM());&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15719983" author="lehmi" created="Sun, 4 Dec 2016 13:54:17 +0000"  >&lt;p&gt;It looks like your last commit (1772377) has a small typo w.r.t. the second scaling factor:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;-            &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Rectangle2D.&lt;span class=&quot;code-object&quot;&gt;Double&lt;/span&gt;(minX, size.getY() - minY - height, width, height);
+            &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Rectangle2D.&lt;span class=&quot;code-object&quot;&gt;Double&lt;/span&gt;(minX - pageSize.getLowerLeftX() * m.getScalingFactorX(),
+                    size.getY() - minY - height + pageSize.getLowerLeftY() * m.getScalingFactorX(),
+                    width, height);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;It should be&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;-            &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Rectangle2D.&lt;span class=&quot;code-object&quot;&gt;Double&lt;/span&gt;(minX, size.getY() - minY - height, width, height);
+            &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Rectangle2D.&lt;span class=&quot;code-object&quot;&gt;Double&lt;/span&gt;(minX - pageSize.getLowerLeftX() * m.getScalingFactorX(),
+                    size.getY() - minY - height + pageSize.getLowerLeftY() * m.getScalingFactorY(),
+                    width, height);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Or did I miss something?&lt;/p&gt;</comment>
                            <comment id="15720064" author="jira-bot" created="Sun, 4 Dec 2016 14:52:50 +0000"  >&lt;p&gt;Commit 1772540 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1772540&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1772540&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3000&quot; title=&quot;Transparency Group issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3000&quot;&gt;&lt;del&gt;PDFBOX-3000&lt;/del&gt;&lt;/a&gt;: fix typo in last commit&lt;/p&gt;</comment>
                            <comment id="15720065" author="tilman" created="Sun, 4 Dec 2016 14:52:58 +0000"  >&lt;p&gt;Yes, thanks.&lt;/p&gt;</comment>
                            <comment id="15730236" author="jon_wu" created="Wed, 7 Dec 2016 23:08:31 +0000"  >&lt;p&gt;I&apos;ve attached a snowmen PDF with many opacity clipping masks from Illustrator seems related to transparency group issues.&lt;/p&gt;

&lt;p&gt;2.0.3 vs the latest snapshot look a bit different, but both are pretty far from what it should look like. Chrome and Preview.app have a slight issue displaying the PDF too (oddly only after I extracted the snowmen), but they get most of it right. I&apos;ve also attached a PNG from Illustrator with the expected output.&lt;/p&gt;</comment>
                            <comment id="15731155" author="tilman" created="Thu, 8 Dec 2016 05:26:23 +0000"  >&lt;p&gt;Thanks I&apos;ll add that one to my test set... I&apos;m still working on transparencies, one problem at a time... My strategy since I started to work on it was to create simple test files from existing ones and find out what&apos;s wrong with the code. If you have the time, please try to create a simpler file, e.g. only the bottom shadow.&lt;/p&gt;</comment>
                            <comment id="15733282" author="jon_wu" created="Thu, 8 Dec 2016 20:09:15 +0000"  >&lt;p&gt;Makes sense. The full snowman file is definitely very complex. I&apos;ve attached a circle-simple.pdf test case. It renders mostly blank right now.&lt;/p&gt;

&lt;p&gt;If that works and the big file still has issues later, I&apos;d be happy to try to build other test cases. Thank you!&lt;/p&gt;</comment>
                            <comment id="15737847" author="tilman" created="Sat, 10 Dec 2016 13:08:15 +0000"  >&lt;p&gt;Thanks... however I see now that our current rendering with the trunk (see file I just attached) is better than the one you created, so I think you were not using the latest version. I also believe that the trunk rendering of the circle file (not attached) is correct.&lt;/p&gt;</comment>
                            <comment id="15737873" author="tilman" created="Sat, 10 Dec 2016 13:26:22 +0000"  >&lt;p&gt;Some new reduced files, not solved yet:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;gs-bugzilla692217_reduced.pdf : problem probably related to clipping rectangle, xobject rendered at wrong place. Outside line shows where the clipping is.&lt;/li&gt;
	&lt;li&gt;gs-bugzilla689309-reduced.pdf : softmask bounds smaller than transparent xobject&lt;/li&gt;
	&lt;li&gt;gs-bugzilla689309-reduced-bc1.pdf : same, but added a red border&lt;/li&gt;
	&lt;li&gt;gs-bugzilla689309-reduced-bc0.pdf : same, but /bc (which we don&apos;t consider) is CMYK 0 (white) instead of 1 (black)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;The /bc value (default: black) is somehow related to what to do with softmask painting outside of bounds. Changing the code accordingly solves the rendering of all gs-bugzilla689309 files, but worsens the rendering of many other files. So I&apos;ll postpone that for later.&lt;/p&gt;

&lt;p&gt;Update 13.12.2016: the changed /bc code also improves gs-bugzilla690535.pdf (gold color visible for the first time), and the *371 file (missing part visible). gs-bugzilla693548-STACKOVERFLOW.pdf might be used for investigation, gets completely white. PDFJS-6967.pdf gets white except for two black bars.&lt;/p&gt;</comment>
                            <comment id="15738694" author="jon_wu" created="Sat, 10 Dec 2016 23:53:50 +0000"  >&lt;p&gt;Sorry about the confusion. I missed the snapshot section on the download page, then ended up building from Git which was behind SVN.&lt;/p&gt;

&lt;p&gt;I should have seen the section either way, but it would help if &amp;lt;a name=&quot;#snapshot&quot;&amp;gt;&amp;lt;/a&amp;gt; on &lt;a href=&quot;https://pdfbox.apache.org/download.cgi#snapshot&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://pdfbox.apache.org/download.cgi#snapshot&lt;/a&gt; was switched to name=&quot;snapshot&quot; to fix the link.&lt;/p&gt;

&lt;p&gt;I agree the circle-simple looks great except for the aliasing on the edges, but maybe that&apos;s just a rendering hint issue?&lt;/p&gt;

&lt;p&gt;I was trying to isolate other pieces of the snowman that still render weird. It looks like the gradient on the nose gets cut off a little bit early. I&apos;ve attached snowman-nose-gradient.pdf which should have approx even margins on all sides, but stops a little soon on the right. I wonder if this or some of the other rendering differences in the full snowman are related to &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2681&quot; title=&quot;Colors inaccurate rastered CMYK source w/ gradient + photo&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2681&quot;&gt;PDFBOX-2681&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="15739406" author="tilman" created="Sun, 11 Dec 2016 09:10:06 +0000"  >&lt;p&gt;I don&apos;t understand re &quot;should have approx even margins on all sides, but stops a little soon on the right&quot;, maybe this is a language problem on my side. The difference I see is that the Adobe rendering has more white on the left.&lt;/p&gt;</comment>
                            <comment id="15740630" author="jon_wu" created="Mon, 12 Dec 2016 00:48:13 +0000"  >&lt;p&gt;I see now that my example was confusing. snowman-nose-gradient.pdf was saved in CMYK mode and I was accidentally looking at a non-Adobe rendering when writing my last comment. Preview.app, Chrome, Firefox / pdf.js all render the correct shape and the right side of the gradient always ends in the correct place. I think that the last CMYK gradient issue in &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2681&quot; title=&quot;Colors inaccurate rastered CMYK source w/ gradient + photo&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2681&quot;&gt;PDFBOX-2681&lt;/a&gt; is why the Adobe rendering shows more white on the left of CMYK snowman-nose-gradient.pdf.&lt;/p&gt;

&lt;p&gt;I&apos;ve uploaded the same file saved as RGB snowman-nose-gradient-rgb.pdf with 2 red lines to demonstrate the issue I was trying to show. The rendered version&apos;s gradient should almost touch both red lines and should appear centered in the document. You&apos;ll also notice that the left side isn&apos;t white in the Adobe rendering in the RGB version.&lt;/p&gt;

&lt;p&gt;I hope this is a little clearer but let me know if I can provide better details or examples.&lt;/p&gt;</comment>
                            <comment id="15743103" author="tilman" created="Mon, 12 Dec 2016 20:48:20 +0000"  >&lt;p&gt;Thanks, now I understand. (it was indeed a language problem, and in retrospect what you said was clear) &lt;del&gt;The problem with your file may be the clipping rect origin, similar to gs-bugzilla692217_reduced.pdf&lt;/del&gt; .&lt;/p&gt;

&lt;p&gt;Coincidentally, while looking around I found another flaw in our code, we&apos;re not applying the softmask to shading fills. Changing this resulted in improved rendering of several files that have never rendered correctly, however some elements vanish in other files, so I&apos;ll wait.&lt;/p&gt;</comment>
                            <comment id="15743159" author="tilman" created="Mon, 12 Dec 2016 21:13:37 +0000"  >&lt;p&gt;memo for myself&lt;/p&gt;

&lt;p&gt;uncommitted changes:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;&#10003; softmask for shading fills&lt;/li&gt;
	&lt;li&gt;&#10003;  softmask for fills&lt;/li&gt;
	&lt;li&gt;&#10003; save linepath and winding rule when drawing transparency&lt;/li&gt;
	&lt;li&gt;&#10003; save &lt;del&gt;linepath and&lt;/del&gt; winding rule when drawing tiling pattern&lt;/li&gt;
	&lt;li&gt;&#10003; softmask initial ctm&lt;/li&gt;
	&lt;li&gt;&#10003; /bc for softmask&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;investigate:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;&lt;del&gt;softmask for stencil (see todo in code)&lt;/del&gt; obsolete, it is using the softmask&lt;/li&gt;
	&lt;li&gt;clip rectangle origin effects&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15743287" author="jira-bot" created="Mon, 12 Dec 2016 22:02:26 +0000"  >&lt;p&gt;Commit 1773889 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1773889&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1773889&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3000&quot; title=&quot;Transparency Group issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3000&quot;&gt;&lt;del&gt;PDFBOX-3000&lt;/del&gt;&lt;/a&gt;: save and restore linepath and windingrule when drawing transparency group&lt;/p&gt;</comment>
                            <comment id="15743289" author="jira-bot" created="Mon, 12 Dec 2016 22:02:30 +0000"  >&lt;p&gt;Commit 1773890 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1773890&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1773890&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3000&quot; title=&quot;Transparency Group issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3000&quot;&gt;&lt;del&gt;PDFBOX-3000&lt;/del&gt;&lt;/a&gt;: save and restore linepath and windingrule when drawing transparency group&lt;/p&gt;</comment>
                            <comment id="15743315" author="tilman" created="Mon, 12 Dec 2016 22:12:31 +0000"  >&lt;p&gt;The last commit is to prevent regressions with some upcoming ones (softmask for fills). I was wondering about empty softmasks with no effect - the reason was that existing path was gone.&lt;/p&gt;

&lt;p&gt;improved: &lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;gs-bugzilla697135.pdf: ring visible&lt;/li&gt;
	&lt;li&gt;gs-bugzilla691650-1.pdf: dito&lt;/li&gt;
	&lt;li&gt;gs-bugzilla693520.pdf: fine lines visible&lt;/li&gt;
	&lt;li&gt;gs-bugzilla690816.pdf: orange-brown rectangle border visible&lt;/li&gt;
	&lt;li&gt;gs-bugzilla693548-STACKOVERFLOW.pdf: border now visible (but not correct size)&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;different:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;gs-bugzilla689996.pdf&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15743406" author="jira-bot" created="Mon, 12 Dec 2016 22:46:05 +0000"  >&lt;p&gt;Commit 1773896 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1773896&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1773896&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3000&quot; title=&quot;Transparency Group issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3000&quot;&gt;&lt;del&gt;PDFBOX-3000&lt;/del&gt;&lt;/a&gt;: save and restore windingrule when drawing tile pattern&lt;/p&gt;</comment>
                            <comment id="15743407" author="jira-bot" created="Mon, 12 Dec 2016 22:46:09 +0000"  >&lt;p&gt;Commit 1773897 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1773897&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1773897&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3000&quot; title=&quot;Transparency Group issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3000&quot;&gt;&lt;del&gt;PDFBOX-3000&lt;/del&gt;&lt;/a&gt;: save and restore windingrule when drawing tile pattern&lt;/p&gt;</comment>
                            <comment id="15743412" author="tilman" created="Mon, 12 Dec 2016 22:48:14 +0000"  >&lt;p&gt;No rendering changes on last commit.&lt;/p&gt;</comment>
                            <comment id="15745436" author="jira-bot" created="Tue, 13 Dec 2016 15:38:49 +0000"  >&lt;p&gt;Commit 1774037 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1774037&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1774037&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3000&quot; title=&quot;Transparency Group issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3000&quot;&gt;&lt;del&gt;PDFBOX-3000&lt;/del&gt;&lt;/a&gt;: use softMask for non stroking paint, as suggested by Petr Slaby; use softMask for shading fill&lt;/p&gt;</comment>
                            <comment id="15745438" author="jira-bot" created="Tue, 13 Dec 2016 15:38:55 +0000"  >&lt;p&gt;Commit 1774038 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1774038&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1774038&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3000&quot; title=&quot;Transparency Group issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3000&quot;&gt;&lt;del&gt;PDFBOX-3000&lt;/del&gt;&lt;/a&gt;: use softMask for non stroking paint, as suggested by Petr Slaby; use softMask for shading fill&lt;/p&gt;</comment>
                            <comment id="15745450" author="tilman" created="Tue, 13 Dec 2016 15:44:13 +0000"  >&lt;p&gt;improved:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;bugzilla-852992.pdf: probably perfect&lt;/li&gt;
	&lt;li&gt;bugzilla869140.pdf: probably perfect, girls room and dining room color now good&lt;/li&gt;
	&lt;li&gt;gs-bugzilla689996.pdf: gradient visible now, but weird line&lt;/li&gt;
	&lt;li&gt;gs-bugzilla691218.pdf: probably perfect, prices now in correct color&lt;/li&gt;
	&lt;li&gt;gs-bugzilla691650-1.pdf: sides better&lt;/li&gt;
	&lt;li&gt;gs-bugzilla692265-p1.pdf: probably perfect&lt;/li&gt;
	&lt;li&gt;gs-bugzilla692546.pdf: probably perfect&lt;/li&gt;
	&lt;li&gt;gs-bugzilla693115.pdf: probably perfect, blue rectangle gone&lt;/li&gt;
	&lt;li&gt;gs-bugzilla695290.pdf: probably perfect, shading visible now&lt;/li&gt;
	&lt;li&gt;*417 p2: weird shapes gone&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-994&quot; title=&quot;Rendering issues with colors and transparency&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-994&quot;&gt;&lt;del&gt;PDFBOX-994&lt;/del&gt;&lt;/a&gt;.pdf: probably perfect, colors now good&lt;/li&gt;
	&lt;li&gt;PDFJS-2845-p1.pdf: probably perfect, &quot;Talents&quot; and &quot;Miami&quot; in correct color&lt;/li&gt;
	&lt;li&gt;PDFJS-3096.pdf: giant triangle gone, but incorrekt diagonal line on pad left&lt;/li&gt;
	&lt;li&gt;PDFJS-5811-2.pdf: probably perfect, 3d effect on color rectangles, circle on p5 no longer grey&lt;/li&gt;
	&lt;li&gt;PDFJS-5853.pdf: probably perfect, children all visible now&lt;/li&gt;
	&lt;li&gt;texample-rgb-triangle.pdf: shading visible for first time, although on incorrect position&lt;/li&gt;
	&lt;li&gt;gs-bugzilla692721.pdf: one additional shape&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;different:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;gs-bugzilla693033.pdf: UN logo different&lt;/li&gt;
	&lt;li&gt;gs-bugzilla696682.pdf: half arrow&lt;/li&gt;
	&lt;li&gt;gs-bugzilla696864.pdf: dito&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;regressions:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;gs-bugzilla692689.pdf: % numbers&lt;/li&gt;
	&lt;li&gt;gs-bugzilla693520.pdf: bottom of box&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15746013" author="jira-bot" created="Tue, 13 Dec 2016 19:25:19 +0000"  >&lt;p&gt;Commit 1774080 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1774080&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1774080&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3000&quot; title=&quot;Transparency Group issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3000&quot;&gt;&lt;del&gt;PDFBOX-3000&lt;/del&gt;&lt;/a&gt;: save initial CTM in softmask so that CTM at the moment of ExtGState activation is remembered&lt;/p&gt;</comment>
                            <comment id="15746015" author="jira-bot" created="Tue, 13 Dec 2016 19:25:25 +0000"  >&lt;p&gt;Commit 1774081 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1774081&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1774081&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3000&quot; title=&quot;Transparency Group issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3000&quot;&gt;&lt;del&gt;PDFBOX-3000&lt;/del&gt;&lt;/a&gt;: save initial CTM in softmask so that CTM at the moment of ExtGState activation is remembered&lt;/p&gt;</comment>
                            <comment id="15746049" author="jira-bot" created="Tue, 13 Dec 2016 19:38:25 +0000"  >&lt;p&gt;Commit 1774086 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1774086&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1774086&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3000&quot; title=&quot;Transparency Group issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3000&quot;&gt;&lt;del&gt;PDFBOX-3000&lt;/del&gt;&lt;/a&gt;: pass initial CTM of softmask to transparency group&lt;/p&gt;</comment>
                            <comment id="15746050" author="jira-bot" created="Tue, 13 Dec 2016 19:38:28 +0000"  >&lt;p&gt;Commit 1774087 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1774087&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1774087&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3000&quot; title=&quot;Transparency Group issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3000&quot;&gt;&lt;del&gt;PDFBOX-3000&lt;/del&gt;&lt;/a&gt;: pass initial CTM of softmask to transparency group&lt;/p&gt;</comment>
                            <comment id="15746137" author="tilman" created="Tue, 13 Dec 2016 20:12:05 +0000"  >&lt;p&gt;The last commits deal with what I mentioned a month ago re ghostscript bug 691157. The commit never improved much, until now, and the results are amazing.&lt;/p&gt;

&lt;p&gt;Improvements:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;bugzilla869140.pdf: I thought it was perfect, but there&apos;s more, e.g. an axial shading softmask in the girls room and a radial shading softmask in the dining room&lt;/li&gt;
	&lt;li&gt;gs-bugzilla690351-p7.pdf: perfect, background structure&lt;/li&gt;
	&lt;li&gt;gs-bugzilla690535.pdf: perfect, euro now in gold&lt;/li&gt;
	&lt;li&gt;gs-bugzilla690839.pdf: perfect, shading&lt;/li&gt;
	&lt;li&gt;gs-bugzilla691157.pdf: cutout (but some weirdness)&lt;/li&gt;
	&lt;li&gt;gs-bugzilla691218.pdf: &quot;sales event&quot; in correct color&lt;/li&gt;
	&lt;li&gt;gs-bugzilla691348.pdf: cutout&lt;/li&gt;
	&lt;li&gt;gs-bugzilla692689-reduced.pdf: perfect&lt;/li&gt;
	&lt;li&gt;gs-bugzilla692933.pdf: perfect, structure vanishes at right&lt;/li&gt;
	&lt;li&gt;gs-bugzilla693520.pdf: perfect, including weird &quot;box in water&quot; effect&lt;/li&gt;
	&lt;li&gt;gs-bugzilla693548-STACKOVERFLOW.pdf: perfect shading&lt;/li&gt;
	&lt;li&gt;gs-bugzilla696682.pdf: perfect, arrows&lt;/li&gt;
	&lt;li&gt;gs-bugzilla696864.pdf: dito&lt;/li&gt;
	&lt;li&gt;*371: perfect, missing thing now there&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3400&quot; title=&quot;Gradient/Shading color alpha stepping do not work correctly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3400&quot;&gt;&lt;del&gt;PDFBOX-3400&lt;/del&gt;&lt;/a&gt;.pdf: now correct shading&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3400&quot; title=&quot;Gradient/Shading color alpha stepping do not work correctly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3400&quot;&gt;&lt;del&gt;PDFBOX-3400&lt;/del&gt;&lt;/a&gt;-RGB.pdf: now correct shading&lt;/li&gt;
	&lt;li&gt;PDFJS-3096.pdf: probably perfect&lt;/li&gt;
	&lt;li&gt;PDFJS-6113.pdf: color near websitetop left&lt;/li&gt;
	&lt;li&gt;texample-rgb-triangle.pdf: shading fully visible and correct&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Changes:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;gs-bugzilla696026.pdf&lt;/li&gt;
	&lt;li&gt;PDFJS-5811-2.pdf p2: hard to tell, shadows around region nantaise are a bit less&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Regressions:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;*417_ weird triangle, some shadows gone?&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2103&quot; title=&quot;JPXFilter fails to decode some Jpeg2000 images&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2103&quot;&gt;&lt;del&gt;PDFBOX-2103&lt;/del&gt;&lt;/a&gt;.pdf: slight color difference at bottom of screen&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15746266" author="mblaesing" created="Tue, 13 Dec 2016 21:03:57 +0000"  >&lt;p&gt;I want to say: Thank you!&lt;/p&gt;

&lt;p&gt;I updated my pdfbox checkout to HEAD and rendered the poster that triggered my initial interest again. After the latest changes the whole scene is rendered correctly. There are multiple layered images with masked, that in the past were rendered with wrongly shaped masked or not at all. No the whole poster comes out as I&apos;d expect.&lt;/p&gt;

&lt;p&gt;Great work!&lt;/p&gt;</comment>
                            <comment id="15747725" author="jira-bot" created="Wed, 14 Dec 2016 08:56:15 +0000"  >&lt;p&gt;Commit 1774146 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1774146&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1774146&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3000&quot; title=&quot;Transparency Group issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3000&quot;&gt;&lt;del&gt;PDFBOX-3000&lt;/del&gt;&lt;/a&gt;: use gray image if group colorspace is gray; remove obsolete comment&lt;/p&gt;</comment>
                            <comment id="15747726" author="jira-bot" created="Wed, 14 Dec 2016 08:56:20 +0000"  >&lt;p&gt;Commit 1774147 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1774147&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1774147&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3000&quot; title=&quot;Transparency Group issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3000&quot;&gt;&lt;del&gt;PDFBOX-3000&lt;/del&gt;&lt;/a&gt;: use gray image if group colorspace is gray; remove obsolete comment&lt;/p&gt;</comment>
                            <comment id="15761835" author="tilman" created="Mon, 19 Dec 2016 17:57:25 +0000"  >&lt;p&gt;Updated gs-bugzilla692217_reduced.pdf . Both the dotted lines and the two diagonal lines are part of the same softmask. The dotted lines are drawn directly, one diagonal line is a pattern, the other diagonal line is a transparency group in that pattern. The last one is at the wrong position.&lt;/p&gt;</comment>
                            <comment id="15783294" author="tilman" created="Wed, 28 Dec 2016 17:12:54 +0000"  >&lt;p&gt;Two reduced versions of &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jon_wu&quot; class=&quot;user-hover&quot; rel=&quot;jon_wu&quot;&gt;jon_wu&lt;/a&gt;&apos;s snowman nose. There&apos;s only one difference between the two: the initial transform which I&apos;ve added at the beginning of the content stream. With -0.7 translation on the x axis it renders correctly, with -0.6 it doesn&apos;t.&lt;/p&gt;</comment>
                            <comment id="15783298" author="tilman" created="Wed, 28 Dec 2016 17:14:41 +0000"  >&lt;p&gt;I did some work on that one yesterday (do &quot;adjust (x,y) at the initial scale + cropbox&quot; only if flipTG is not set) but this solves only this series and a small improvement in PDFJS-6496-XStep99999.pdf (there was a small error I hadn&apos;t noticed before) so I&apos;ll rather wait.&lt;/p&gt;</comment>
                            <comment id="15783302" author="tilman" created="Wed, 28 Dec 2016 17:17:53 +0000"  >&lt;p&gt;From the &quot;anomaly in the matrix&quot; dept:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;dpi transform: AffineTransform[[20.0, 0.0, 0.0], [0.0, 20.0, 0.0]]
clip bounds:
Rectangle2D$&lt;span class=&quot;code-object&quot;&gt;Double&lt;/span&gt;[x=0.04933191703891904,y=1.0259536993917004,w=17.48637770927704,h=6.06104727548927]

call Shape deviceClip = dpiTransform.createTransformedShape(clip);

deviceClip bounds:
Rectangle2D$&lt;span class=&quot;code-object&quot;&gt;Double&lt;/span&gt;[x=-33.96000146865845,y=20.51907398783401,w=393.78590219076204,h=121.22094550978541]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The x origin coordinate is now negative!&lt;/p&gt;</comment>
                            <comment id="15783402" author="jira-bot" created="Wed, 28 Dec 2016 18:07:26 +0000"  >&lt;p&gt;Commit 1776313 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1776313&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1776313&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3000&quot; title=&quot;Transparency Group issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3000&quot;&gt;&lt;del&gt;PDFBOX-3000&lt;/del&gt;&lt;/a&gt;: apply transform to bounds2D of clip due to probably java bug&lt;/p&gt;</comment>
                            <comment id="15783403" author="jira-bot" created="Wed, 28 Dec 2016 18:07:31 +0000"  >&lt;p&gt;Commit 1776314 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1776314&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1776314&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3000&quot; title=&quot;Transparency Group issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3000&quot;&gt;&lt;del&gt;PDFBOX-3000&lt;/del&gt;&lt;/a&gt;: apply transform to bounds2D of clip due to probably java bug&lt;/p&gt;</comment>
                            <comment id="15783487" author="tilman" created="Wed, 28 Dec 2016 18:54:16 +0000"  >&lt;p&gt;The last commit improves the snowman file at several places (not just the nose) and has a slight difference at gs-bugzilla692689-reduced.pdf. The change should also bring a very slight speed increase because the transform is applied to a simpler shape.&lt;/p&gt;</comment>
                            <comment id="15798662" author="jira-bot" created="Wed, 4 Jan 2017 16:30:11 +0000"  >&lt;p&gt;Commit 1777333 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1777333&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1777333&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3000&quot; title=&quot;Transparency Group issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3000&quot;&gt;&lt;del&gt;PDFBOX-3000&lt;/del&gt;&lt;/a&gt;: use /bc color in softmask outside bounds, but ignore empty softmask&lt;/p&gt;</comment>
                            <comment id="15798694" author="tilman" created="Wed, 4 Jan 2017 16:41:55 +0000"  >&lt;p&gt;Re the last commit: I&apos;ve mentioned before that the softmask handling of pixels outside of the box is wrong, but when I corrected it lots of files were rendered poorly (see comment on Dec 10, 2016). The file PDFJS-6967_reduced_outside_softmask.pdf shows why: that one has a softmask that is empty because it is outside of everything, see &lt;tt&gt;Root/Pages/Kids/[0]/Resources/XObject/Fm0/Resources/ExtGState/GS0/SMask/G/BBox&lt;/tt&gt;. Instead of using the /bc value, Adobe just ignores it. So we&apos;ll ignore empty softmasks (which is also the old behaviour in softmask.java for pixels outside). But non empty softmasks that cover only a part of a group now won&apos;t be ignored, from now on the /bc value will be used. The gs-bugzilla689309-reduced--bc files show this.&lt;/p&gt;

&lt;p&gt;Improved:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;007087-payment-due-p1.pdf: probably perfect&lt;/li&gt;
	&lt;li&gt;gs-bugzilla690816.pdf: some black rectangles gone, but one remains&lt;/li&gt;
	&lt;li&gt;gs-bugzilla689309-1.pdf: perfect&lt;/li&gt;
	&lt;li&gt;gs-bugzilla691537.pdf: perfect, black areas gone, fields greyed&lt;/li&gt;
	&lt;li&gt;gs-bugzilla692199-p26.pdf: perfect, black areas gone&lt;/li&gt;
	&lt;li&gt;gs-bugzilla692546.pdf: perfect, white area gone&lt;/li&gt;
	&lt;li&gt;gs-bugzilla693548-STACKOVERFLOW.pdf: perfect, left border now correct size&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15799219" author="jira-bot" created="Wed, 4 Jan 2017 20:19:00 +0000"  >&lt;p&gt;Commit 1777368 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1777368&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1777368&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3000&quot; title=&quot;Transparency Group issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3000&quot;&gt;&lt;del&gt;PDFBOX-3000&lt;/del&gt;&lt;/a&gt;: consider page rotation, cropbox, initial translation; use Matrix class to get correct scales even for rotated affine transforms&lt;/p&gt;</comment>
                            <comment id="15799232" author="jira-bot" created="Wed, 4 Jan 2017 20:26:06 +0000"  >&lt;p&gt;Commit 1777369 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1777369&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1777369&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3000&quot; title=&quot;Transparency Group issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3000&quot;&gt;&lt;del&gt;PDFBOX-3000&lt;/del&gt;&lt;/a&gt;: save and restore page size, xform and rotation&lt;/p&gt;</comment>
                            <comment id="15799237" author="jira-bot" created="Wed, 4 Jan 2017 20:27:50 +0000"  >&lt;p&gt;Commit 1777370 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1777370&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1777370&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3000&quot; title=&quot;Transparency Group issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3000&quot;&gt;&lt;del&gt;PDFBOX-3000&lt;/del&gt;&lt;/a&gt;: forgot two lines&lt;/p&gt;</comment>
                            <comment id="15799269" author="jira-bot" created="Wed, 4 Jan 2017 20:40:19 +0000"  >&lt;p&gt;Commit 1777372 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1777372&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1777372&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3000&quot; title=&quot;Transparency Group issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3000&quot;&gt;&lt;del&gt;PDFBOX-3000&lt;/del&gt;&lt;/a&gt;: refactor&lt;/p&gt;</comment>
                            <comment id="15799354" author="jira-bot" created="Wed, 4 Jan 2017 21:10:57 +0000"  >&lt;p&gt;Commit 1777374 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1777374&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1777374&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3000&quot; title=&quot;Transparency Group issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3000&quot;&gt;&lt;del&gt;PDFBOX-3000&lt;/del&gt;&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3564&quot; title=&quot;SoftMask needs consider colormodel of input Image&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3564&quot;&gt;&lt;del&gt;PDFBOX-3564&lt;/del&gt;&lt;/a&gt;: new softmask handling with bounds, by John Hewson and Petr Slaby;&lt;br/&gt;
use the colormodel corresponding to the source raster to convert into the components, as suggested by Matthias Blaesing; &lt;br/&gt;
avoid ArrayIndexOutOfBoundsException, simplify output raster creation, assign rgba&lt;span class=&quot;error&quot;&gt;&amp;#91;3&amp;#93;&lt;/span&gt; only if within bounds;use /bc color in softmask outside bounds&lt;/p&gt;</comment>
                            <comment id="15799407" author="jira-bot" created="Wed, 4 Jan 2017 21:31:40 +0000"  >&lt;p&gt;Commit 1777377 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1777377&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1777377&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3000&quot; title=&quot;Transparency Group issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3000&quot;&gt;&lt;del&gt;PDFBOX-3000&lt;/del&gt;&lt;/a&gt;: flip transparency group image when rendering it in the first level of a tiling pattern&lt;/p&gt;</comment>
                            <comment id="15799438" author="jira-bot" created="Wed, 4 Jan 2017 21:42:22 +0000"  >&lt;p&gt;Commit 1777380 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1777380&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1777380&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3000&quot; title=&quot;Transparency Group issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3000&quot;&gt;&lt;del&gt;PDFBOX-3000&lt;/del&gt;&lt;/a&gt;: adjust pagesize and bounds for non (0,0) origin&lt;/p&gt;</comment>
                            <comment id="15799542" author="jira-bot" created="Wed, 4 Jan 2017 22:26:34 +0000"  >&lt;p&gt;Commit 1777382 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1777382&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1777382&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3000&quot; title=&quot;Transparency Group issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3000&quot;&gt;&lt;del&gt;PDFBOX-3000&lt;/del&gt;&lt;/a&gt;: apply transform to bounds2D of clip due to probable java bug; ignore empty softmask; pass /bc to softmask; delete 1 line forgotten in a previous commit&lt;/p&gt;</comment>
                            <comment id="15799598" author="tilman" created="Wed, 4 Jan 2017 22:48:59 +0000"  >&lt;p&gt;Unless I missed something, trunk and 2.0 should be identical now re: transparency group issues. I&apos;ll run rendering tests at a later time (update: done). This is not the end of this issue, I have at least 8 files left with rendering problems.&lt;/p&gt;</comment>
                            <comment id="15805055" author="jira-bot" created="Fri, 6 Jan 2017 17:26:12 +0000"  >&lt;p&gt;Commit 1777662 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1777662&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1777662&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3000&quot; title=&quot;Transparency Group issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3000&quot;&gt;&lt;del&gt;PDFBOX-3000&lt;/del&gt;&lt;/a&gt;: skip non-softmask empty transparency groups&lt;/p&gt;</comment>
                            <comment id="15805056" author="jira-bot" created="Fri, 6 Jan 2017 17:26:17 +0000"  >&lt;p&gt;Commit 1777663 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1777663&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1777663&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3000&quot; title=&quot;Transparency Group issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3000&quot;&gt;&lt;del&gt;PDFBOX-3000&lt;/del&gt;&lt;/a&gt;: skip non-softmask empty transparency groups&lt;/p&gt;</comment>
                            <comment id="15805124" author="tilman" created="Fri, 6 Jan 2017 17:53:07 +0000"  >&lt;p&gt;Two files (SoftMask.pdf and SoftMask-Clipped.pdf) created by &lt;a href=&quot;http://www.pdfvt.com/PDFVT_TransparencyGuide.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Boris Aronshtam&lt;/a&gt;. The two files show a problem in rendering that I have been working on - a square/parallelogram background is missing because this part of the PDF specification is ignored:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;If the subtype is Luminosity, the transparency group XObject G shall be composited with a fully opaque backdrop whose colour is everywhere defined by the soft-mask dictionary&#8217;s BC entry.&lt;/p&gt;&lt;/blockquote&gt;</comment>
                            <comment id="15805222" author="jira-bot" created="Fri, 6 Jan 2017 18:27:17 +0000"  >&lt;p&gt;Commit 1777684 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1777684&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1777684&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3000&quot; title=&quot;Transparency Group issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3000&quot;&gt;&lt;del&gt;PDFBOX-3000&lt;/del&gt;&lt;/a&gt;: fill with /bc color for Luminosity soft masks&lt;/p&gt;</comment>
                            <comment id="15805223" author="jira-bot" created="Fri, 6 Jan 2017 18:27:23 +0000"  >&lt;p&gt;Commit 1777685 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1777685&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1777685&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3000&quot; title=&quot;Transparency Group issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3000&quot;&gt;&lt;del&gt;PDFBOX-3000&lt;/del&gt;&lt;/a&gt;: fill with /bc color for Luminosity soft masks&lt;/p&gt;</comment>
                            <comment id="15805268" author="tilman" created="Fri, 6 Jan 2017 18:43:51 +0000"  >&lt;p&gt;The last commit fixes the problem with the two softmask files by Boris Aronshtam.&lt;/p&gt;

&lt;p&gt;Only one other file has a change, gs-bugzilla691650-2.pdf: the lower part (the egg) is now correct, the upper part (the rectangle) is now bad. However the upper part uses an unusual blending mode. Almost none of the blending modes work. I&apos;ll attach a series of files:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;blendmodes.pdf: from tcpdf, most modes work&lt;/li&gt;
	&lt;li&gt;BlendModes-rgb.pdf: from Boris Aronshtam, most modes don&apos;t work&lt;/li&gt;
	&lt;li&gt;gs-bugzilla689931_reduced-Multiply.pdf: works with PDFBox&lt;/li&gt;
	&lt;li&gt;gs-bugzilla689931_reduced-Screen.pdf: doesn&apos;t work with PDFBox (blank)&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15807569" author="tilman" created="Sat, 7 Jan 2017 14:22:29 +0000"  >&lt;p&gt;I found out from Boris Aronshtam and Dr. Paul Jones why the blending files don&apos;t render properly:&lt;br/&gt;
&lt;a href=&quot;http://www.pdfvt.com/PDFVT_TransparencyGuide.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.pdfvt.com/PDFVT_TransparencyGuide.html&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;It is wrong to treat the page background as a separate color. Page background is not a color, but the unmarked space.&lt;br/&gt;
...&lt;br/&gt;
blending with the background ignores the blend mode, and is equivalent to blending with BM=Normal against the opaque white color.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;We use a white page background, and we don&apos;t know about &quot;unmarked space&quot;. Java does not have such a concept AFAIK. Doing a &quot;Screen&quot; blend against white background brings a white result.&lt;/p&gt;

&lt;p&gt;The attached file gs-bugzilla689931_reduced-ScreenBlendPageBackground.pdf shows a small white rectangle in a blue rectangle with Adobe Reader. The white area is because I filled a white rectangle there; in the rest I did nothing thus the difference. PDFBox treats all as white background so it displays the whole PDF as white. Adobe treats the outside as &quot;unmarked space&quot; so it just copies and the inside as &quot;white&quot; so the screen blend result is white.&lt;/p&gt;

&lt;p&gt;Mitigation:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;most files have &quot;Multiply&quot; blend mode which doesn&apos;t bring this effect&lt;/li&gt;
	&lt;li&gt;most files wouldn&apos;t use any &quot;interesting&quot; blend modes against the paper background because it wouldn&apos;t make any difference&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Update 15.1.2017:&lt;br/&gt;
It is even weirder. In the blend demo file by Boris Aronshtam one can see that blue on orange in blend mode &quot;ColorDodge&quot; produces an orange result with Adobe and a pink result with PDFBox. I did the calculations (source: 0 0 1, dest: 1 0.7 0, result: 1 0.7 1) and pink is correct. The only explanation why Adobe shows it as orange would be that the 0 in the 1 0.7 0 orange destination is also considered to be &quot;undefined&quot; and is to stay as it is. To test this, I tried rendering on a slightly modified orange background, i.e. 1 0.7 0.01. Now the Adobe result is also pink.&lt;/p&gt;</comment>
                            <comment id="15812334" author="tilman" created="Mon, 9 Jan 2017 17:34:37 +0000"  >&lt;p&gt;PDFJS-5526-p13_reduced2.pdf has a translation, then a transparency group which has a tiling pattern. Somehow the translation is lost and the pattern isn&apos;t translated. The pattern itself is correct, i.e. TilingPattern.getImage() has the correct image.&lt;/p&gt;

&lt;p&gt;PDFJS-5526-p13_reduced1.pdf is the same but the pattern itself has a transparency group. Here the pattern image itself is bad too. That part can be solved the same way as gs-bugzilla692217 (see &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3000?focusedCommentId=15783298&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15783298&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;a few days ago&lt;/a&gt;).&lt;/p&gt;

&lt;p&gt;PDFJS-5526-p13_reduced3-nogroup.pdf is the same but no transparency group dictionary, i.e. ordinary xobject forms. That one renders fine.&lt;/p&gt;</comment>
                            <comment id="15812380" author="jira-bot" created="Mon, 9 Jan 2017 17:51:07 +0000"  >&lt;p&gt;Commit 1778017 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1778017&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1778017&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3000&quot; title=&quot;Transparency Group issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3000&quot;&gt;&lt;del&gt;PDFBOX-3000&lt;/del&gt;&lt;/a&gt;: set initialMatrix for transparency groups&lt;/p&gt;</comment>
                            <comment id="15812381" author="jira-bot" created="Mon, 9 Jan 2017 17:51:12 +0000"  >&lt;p&gt;Commit 1778018 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1778018&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1778018&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3000&quot; title=&quot;Transparency Group issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3000&quot;&gt;&lt;del&gt;PDFBOX-3000&lt;/del&gt;&lt;/a&gt;: set initialMatrix for transparency groups&lt;/p&gt;</comment>
                            <comment id="15812423" author="tilman" created="Mon, 9 Jan 2017 18:09:19 +0000"  >&lt;p&gt;Improvements by the last commit:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;PDFJS-5526-p13_reduced2.pdf&lt;/li&gt;
	&lt;li&gt;gs-bugzilla688870.pdf: perfect, lower blue now gone&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;With the not committed change PDFJS-5526-p13_reduced1.pdf, PDFJS-5526-p11-13. and gs-bugzilla692217.pdf are fully correct.&lt;/p&gt;</comment>
                            <comment id="15819024" author="tilman" created="Wed, 11 Jan 2017 20:11:40 +0000"  >&lt;p&gt;gs-bugzilla690022_reduced.pdf has a softmask that doesn&apos;t display. The problem is that the PDF has a 90&#176; rotation. The two files I used to solve rotation problems in transparency groups (&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-1697&quot; title=&quot;the text show Incorrect&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-1697&quot;&gt;&lt;del&gt;PDFBOX-1697&lt;/del&gt;&lt;/a&gt;-reduced-rotations.pdf and PDFJS-5811-2-p4_reduced-rotations.pdf) did not have soft masks.&lt;/p&gt;</comment>
                            <comment id="15821998" author="tilman" created="Fri, 13 Jan 2017 17:04:55 +0000"  >&lt;p&gt;Commit 1778457 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1778457&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1778457&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3000&quot; title=&quot;Transparency Group issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3000&quot;&gt;&lt;del&gt;PDFBOX-3000&lt;/del&gt;&lt;/a&gt;: use calculated scale values, not matrix items which can be 0 in rotations&lt;/p&gt;


&lt;p&gt;Commit 1778458 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1778458&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1778458&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3000&quot; title=&quot;Transparency Group issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3000&quot;&gt;&lt;del&gt;PDFBOX-3000&lt;/del&gt;&lt;/a&gt;: use calculated scale values, not matrix items which can be 0 in rotations&lt;/p&gt;</comment>
                            <comment id="15822222" author="jira-bot" created="Fri, 13 Jan 2017 19:31:22 +0000"  >&lt;p&gt;Commit 1778658 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1778658&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1778658&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3000&quot; title=&quot;Transparency Group issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3000&quot;&gt;&lt;del&gt;PDFBOX-3000&lt;/del&gt;&lt;/a&gt;: rotate mask + adjust softmask origin when page is rotated&lt;/p&gt;</comment>
                            <comment id="15822223" author="jira-bot" created="Fri, 13 Jan 2017 19:31:27 +0000"  >&lt;p&gt;Commit 1778659 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1778659&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1778659&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3000&quot; title=&quot;Transparency Group issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3000&quot;&gt;&lt;del&gt;PDFBOX-3000&lt;/del&gt;&lt;/a&gt;: rotate mask + adjust softmask origin when page is rotated&lt;/p&gt;</comment>
                            <comment id="15822286" author="tilman" created="Fri, 13 Jan 2017 20:10:56 +0000"  >&lt;p&gt;gs-bugzilla690022-reduced-rotations.pdf is for tests, it has all 4 rotations.&lt;/p&gt;</comment>
                            <comment id="15822852" author="jira-bot" created="Sat, 14 Jan 2017 16:33:55 +0000"  >&lt;p&gt;Commit 1778788 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1778788&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1778788&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3000&quot; title=&quot;Transparency Group issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3000&quot;&gt;&lt;del&gt;PDFBOX-3000&lt;/del&gt;&lt;/a&gt;: apply transfer function in softmask; add author names&lt;/p&gt;</comment>
                            <comment id="15822853" author="jira-bot" created="Sat, 14 Jan 2017 16:34:00 +0000"  >&lt;p&gt;Commit 1778789 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1778789&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1778789&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3000&quot; title=&quot;Transparency Group issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3000&quot;&gt;&lt;del&gt;PDFBOX-3000&lt;/del&gt;&lt;/a&gt;: apply transfer function in softmask; add author names&lt;/p&gt;</comment>
                            <comment id="15822858" author="tilman" created="Sat, 14 Jan 2017 16:40:56 +0000"  >&lt;p&gt;The transfer function is described in &quot;Table 144 &#8211; Entries in a soft-mask dictionary&quot; of the PDF specification. Improved files:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;gs-bugzilla689991-1.pdf: perfect, chocolate visible&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-1416&quot; title=&quot;Transparency Group: missing image in reader/image output&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-1416&quot;&gt;&lt;del&gt;PDFBOX-1416&lt;/del&gt;&lt;/a&gt;.pdf: perfect, girl visible (at last!)&lt;/li&gt;
	&lt;li&gt;PDFJS-3096.pdf: bottom shade of left smartphone less different&lt;/li&gt;
	&lt;li&gt;gs-bugzilla693681-transfer.pdf: perfect, now all visible&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15823145" author="jira-bot" created="Sun, 15 Jan 2017 14:22:12 +0000"  >&lt;p&gt;Commit 1778924 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1778924&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1778924&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3000&quot; title=&quot;Transparency Group issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3000&quot;&gt;&lt;del&gt;PDFBOX-3000&lt;/del&gt;&lt;/a&gt;: Move the array designator from the variable to the type&lt;/p&gt;</comment>
                            <comment id="15823146" author="jira-bot" created="Sun, 15 Jan 2017 14:22:18 +0000"  >&lt;p&gt;Commit 1778925 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1778925&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1778925&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3000&quot; title=&quot;Transparency Group issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3000&quot;&gt;&lt;del&gt;PDFBOX-3000&lt;/del&gt;&lt;/a&gt;: Move the array designator from the variable to the type&lt;/p&gt;</comment>
                            <comment id="15836032" author="lehmi" created="Tue, 24 Jan 2017 11:13:52 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; Should we add 2.0.x to &quot;Fix Version/s&quot;, AFAIU you already merged all changes into the 2.0-branch, didn&apos;t you?&lt;/p&gt;</comment>
                            <comment id="15836311" author="tilman" created="Tue, 24 Jan 2017 16:54:24 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lehmi&quot; class=&quot;user-hover&quot; rel=&quot;lehmi&quot;&gt;lehmi&lt;/a&gt; It is true that all changes are also in 2.0, but I didn&apos;t set a target because not all transparency problems are solved, i.e. I wasn&apos;t expecting to resolve the issue for 2.0.5. I&apos;d like to keep this issue for a while because it helps me to track the improvements in one single place.&lt;/p&gt;</comment>
                            <comment id="15837967" author="jira-bot" created="Wed, 25 Jan 2017 15:59:39 +0000"  >&lt;p&gt;Commit 1780224 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1780224&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1780224&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3000&quot; title=&quot;Transparency Group issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3000&quot;&gt;&lt;del&gt;PDFBOX-3000&lt;/del&gt;&lt;/a&gt;: correct calculations for 180&#176; and 270&#176;&lt;/p&gt;</comment>
                            <comment id="15837968" author="jira-bot" created="Wed, 25 Jan 2017 15:59:44 +0000"  >&lt;p&gt;Commit 1780225 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1780225&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1780225&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3000&quot; title=&quot;Transparency Group issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3000&quot;&gt;&lt;del&gt;PDFBOX-3000&lt;/del&gt;&lt;/a&gt;: correct calculations for 180&#176; and 270&#176;&lt;/p&gt;</comment>
                            <comment id="15837970" author="tilman" created="Wed, 25 Jan 2017 16:01:17 +0000"  >&lt;p&gt;It turned out that the calculations were not correct for two rotations, but this was only really visible when setting a cropbox.&lt;/p&gt;</comment>
                            <comment id="15839929" author="jira-bot" created="Thu, 26 Jan 2017 16:16:08 +0000"  >&lt;p&gt;Commit 1780419 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1780419&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1780419&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3000&quot; title=&quot;Transparency Group issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3000&quot;&gt;&lt;del&gt;PDFBOX-3000&lt;/del&gt;&lt;/a&gt;: Add code from Harald Kuhr to create gray transparency group image with alpha channel to avoid NPE with alpha softmasks&lt;/p&gt;</comment>
                            <comment id="15839930" author="jira-bot" created="Thu, 26 Jan 2017 16:16:14 +0000"  >&lt;p&gt;Commit 1780420 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1780420&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1780420&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3000&quot; title=&quot;Transparency Group issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3000&quot;&gt;&lt;del&gt;PDFBOX-3000&lt;/del&gt;&lt;/a&gt;: Add code from Harald Kuhr to create gray transparency group image with alpha channel to avoid NPE with alpha softmasks&lt;/p&gt;</comment>
                            <comment id="15839963" author="tilman" created="Thu, 26 Jan 2017 16:31:40 +0000"  >&lt;p&gt;Improvements:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;PDFJS-5044.pdf: NPE in &lt;tt&gt;gray.setData(image.getAlphaRaster());&lt;/tt&gt; gone&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;http://www.japsolson.com/wp-content/uploads/2013/11/A-Designers-Guide-to-Transparency.pdf&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;A-Designers-Guide-to-Transparency.pdf&lt;/a&gt;, p5: the opacity mask and the 2 normal mask examples are now correct (however I suspect that the error was introduced by myself when I introduced the gray image in rev 1774146).&lt;/li&gt;
	&lt;li&gt;gs-bugzilla697354.pdf: two incorrect black bars on the side are gone&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15840295" author="jira-bot" created="Thu, 26 Jan 2017 19:40:22 +0000"  >&lt;p&gt;Commit 1780443 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1780443&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1780443&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3000&quot; title=&quot;Transparency Group issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3000&quot;&gt;&lt;del&gt;PDFBOX-3000&lt;/del&gt;&lt;/a&gt;: detect gray ICC colorspaces&lt;/p&gt;</comment>
                            <comment id="15840296" author="jira-bot" created="Thu, 26 Jan 2017 19:40:28 +0000"  >&lt;p&gt;Commit 1780444 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1780444&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1780444&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3000&quot; title=&quot;Transparency Group issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3000&quot;&gt;&lt;del&gt;PDFBOX-3000&lt;/del&gt;&lt;/a&gt;: detect gray ICC colorspaces&lt;/p&gt;</comment>
                            <comment id="15840307" author="tilman" created="Thu, 26 Jan 2017 19:49:16 +0000"  >&lt;p&gt;The last commit improves page 17 of eci_altona-test-suite-v2_technical2_one-patch-per-page_x4.pdf a little bit (mostly on the right).&lt;/p&gt;</comment>
                            <comment id="15840314" author="jira-bot" created="Thu, 26 Jan 2017 19:52:53 +0000"  >&lt;p&gt;Commit 1780448 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1780448&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1780448&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3000&quot; title=&quot;Transparency Group issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3000&quot;&gt;&lt;del&gt;PDFBOX-3000&lt;/del&gt;&lt;/a&gt;: Sonar fix&lt;/p&gt;</comment>
                            <comment id="15840315" author="jira-bot" created="Thu, 26 Jan 2017 19:52:58 +0000"  >&lt;p&gt;Commit 1780449 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1780449&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1780449&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3000&quot; title=&quot;Transparency Group issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3000&quot;&gt;&lt;del&gt;PDFBOX-3000&lt;/del&gt;&lt;/a&gt;: Sonar fix&lt;/p&gt;</comment>
                            <comment id="15840329" author="jira-bot" created="Thu, 26 Jan 2017 19:59:38 +0000"  >&lt;p&gt;Commit 1780459 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1780459&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1780459&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3000&quot; title=&quot;Transparency Group issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3000&quot;&gt;&lt;del&gt;PDFBOX-3000&lt;/del&gt;&lt;/a&gt;: revert last commit&lt;/p&gt;</comment>
                            <comment id="15840330" author="jira-bot" created="Thu, 26 Jan 2017 19:59:44 +0000"  >&lt;p&gt;Commit 1780460 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1780460&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1780460&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3000&quot; title=&quot;Transparency Group issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3000&quot;&gt;&lt;del&gt;PDFBOX-3000&lt;/del&gt;&lt;/a&gt;: revert last commit&lt;/p&gt;</comment>
                            <comment id="15843099" author="jira-bot" created="Fri, 27 Jan 2017 16:44:39 +0000"  >&lt;p&gt;Commit 1780583 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1780583&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1780583&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3000&quot; title=&quot;Transparency Group issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3000&quot;&gt;&lt;del&gt;PDFBOX-3000&lt;/del&gt;&lt;/a&gt;: simplify calculations&lt;/p&gt;</comment>
                            <comment id="15843100" author="jira-bot" created="Fri, 27 Jan 2017 16:44:44 +0000"  >&lt;p&gt;Commit 1780584 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1780584&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1780584&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3000&quot; title=&quot;Transparency Group issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3000&quot;&gt;&lt;del&gt;PDFBOX-3000&lt;/del&gt;&lt;/a&gt;: simplify calculations&lt;/p&gt;</comment>
                            <comment id="15872082" author="tilman" created="Fri, 17 Feb 2017 16:39:45 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=alarregoity&quot; class=&quot;user-hover&quot; rel=&quot;alarregoity&quot;&gt;alarregoity&lt;/a&gt; bad news re your file from &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3182&quot; title=&quot;Image not rendered  &quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3182&quot;&gt;&lt;del&gt;PDFBOX-3182&lt;/del&gt;&lt;/a&gt;. I looked whether your file&apos;s troubles are related to the problem with blending modes that I mentioned on January 7. Sadly, it is. If I change the blend mode of /GS5 from &quot;Overlay&quot; to &quot;Normal&quot; (which is what Adobe does on a page background) then your file is rendered correctly.&lt;/p&gt;

&lt;p&gt;This won&apos;t be fixed soon... the cause is the java graphics engine.&lt;/p&gt;</comment>
                            <comment id="16288060" author="tilman" created="Tue, 12 Dec 2017 18:48:19 +0000"  >&lt;p&gt;Some new files with bad renderings suspected to be transparency:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;pop-bugzilla40164.pdf&lt;/li&gt;
	&lt;li&gt;PDFJS-8136.pdf and PDFJS-8136-p1_reduced1.pdf&lt;/li&gt;
	&lt;li&gt;gs-bugzilla693134-giant-pattern-reduced.pdf&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="16316597" author="tilman" created="Mon, 8 Jan 2018 17:08:38 +0000"  >&lt;p&gt;In the attached file PDFJS-6967-p8.pdf, the image above &quot;Cultural Zone ( Section A)&quot; is missing.&lt;/p&gt;</comment>
                            <comment id="16316603" author="tilman" created="Mon, 8 Jan 2018 17:11:20 +0000"  >&lt;p&gt;Oops, I see I had submitted something from that file before. That&apos;s why it looked so familiar.&lt;/p&gt;</comment>
                            <comment id="16354374" author="janipe" created="Tue, 6 Feb 2018 19:07:53 +0000"  >&lt;blockquote&gt;&lt;p&gt;It is even weirder. In the blend demo file by Boris Aronshtam one can see that blue on orange in blend mode &quot;ColorDodge&quot; produces an orange result with Adobe and a pink result with PDFBox.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;The new PDF 2.0 standard provides revised equations for the blend modes ColorDodge and ColorBurn. These should produce correct colors:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; SeparableBlendMode COLOR_DODGE = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; SeparableBlendMode()
    {
        @Override
        &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;float&lt;/span&gt; blendChannel(&lt;span class=&quot;code-object&quot;&gt;float&lt;/span&gt; srcValue, &lt;span class=&quot;code-object&quot;&gt;float&lt;/span&gt; dstValue)
        {
            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (dstValue == 0)
            {
                &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; 0;
            }
            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (dstValue &amp;gt;= 1 - srcValue)
            {
                &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; 1;
            }
            &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; dstValue / (1 - srcValue);
        }
    };
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; SeparableBlendMode COLOR_BURN = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; SeparableBlendMode()
    {
        @Override
        &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;float&lt;/span&gt; blendChannel(&lt;span class=&quot;code-object&quot;&gt;float&lt;/span&gt; srcValue, &lt;span class=&quot;code-object&quot;&gt;float&lt;/span&gt; dstValue)
        {
            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (dstValue == 1)
            {
                &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; 1;
            }
            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (1 - dstValue &amp;gt;= srcValue)
            {
                &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; 0;
            }
            &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; 1 - (1 - dstValue) / srcValue;
        }
    };
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="16357412" author="jira-bot" created="Thu, 8 Feb 2018 18:58:29 +0000"  >&lt;p&gt;Commit 1823593 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1823593&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1823593&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3000&quot; title=&quot;Transparency Group issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3000&quot;&gt;&lt;del&gt;PDFBOX-3000&lt;/del&gt;&lt;/a&gt;: use the revised PDF 2.0 equations for the blend modes ColorDodge and ColorBurn as suggested by Jani Pehkonen&lt;/p&gt;</comment>
                            <comment id="16357413" author="jira-bot" created="Thu, 8 Feb 2018 18:58:35 +0000"  >&lt;p&gt;Commit 1823594 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1823594&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1823594&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3000&quot; title=&quot;Transparency Group issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3000&quot;&gt;&lt;del&gt;PDFBOX-3000&lt;/del&gt;&lt;/a&gt;: use the revised PDF 2.0 equations for the blend modes ColorDodge and ColorBurn as suggested by Jani Pehkonen&lt;/p&gt;</comment>
                            <comment id="16357416" author="tilman" created="Thu, 8 Feb 2018 19:01:12 +0000"  >&lt;p&gt;Thanks. To be sure that this isn&apos;t a &quot;new for 2.0&quot; formula but the formula that has been used before, I modified the BlendModes-rgb.pdf file to put 2.0 in the header and yes, it&apos;s the same rendering on Adobe Reader. Sadly there isn&apos;t any &quot;wow!&quot; effect with PDFBox rendering. A few files changed, but none of them is suddenly perfect:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;BlendModes-rgb.pdf&lt;/li&gt;
	&lt;li&gt;eci_altona-test-suite-v2_technical2_one-patch-per-page_x4.pdf p17&lt;/li&gt;
	&lt;li&gt;gs-bugzilla697433-1.pdf&lt;/li&gt;
	&lt;li&gt;personal file 22579&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="16364377" author="jira-bot" created="Wed, 14 Feb 2018 16:37:06 +0000"  >&lt;p&gt;Commit 1824258 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1824258&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1824258&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4095&quot; title=&quot;Non Separable Blend Modes implementation(HUE, SATURATION, COLOR, LUMINOSITY)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4095&quot;&gt;&lt;del&gt;PDFBOX-4095&lt;/del&gt;&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3000&quot; title=&quot;Transparency Group issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3000&quot;&gt;&lt;del&gt;PDFBOX-3000&lt;/del&gt;&lt;/a&gt;: to solve the problem that some blend modes don&apos;t work on the page background, render pages that have blending on a temporary transparent ARGB image and draw that one on the target image initialized with a white background, as suggested by Jani Pehkonen&lt;/p&gt;</comment>
                            <comment id="16364379" author="jira-bot" created="Wed, 14 Feb 2018 16:37:10 +0000"  >&lt;p&gt;Commit 1824259 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1824259&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1824259&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4095&quot; title=&quot;Non Separable Blend Modes implementation(HUE, SATURATION, COLOR, LUMINOSITY)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4095&quot;&gt;&lt;del&gt;PDFBOX-4095&lt;/del&gt;&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3000&quot; title=&quot;Transparency Group issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3000&quot;&gt;&lt;del&gt;PDFBOX-3000&lt;/del&gt;&lt;/a&gt;: to solve the problem that some blend modes don&apos;t work on the page background, render pages that have blending on a temporary transparent ARGB image and draw that one on the target image initialized with a white background, as suggested by Jani Pehkonen&lt;/p&gt;</comment>
                            <comment id="16509705" author="janipe" created="Tue, 12 Jun 2018 14:45:07 +0000"  >&lt;p&gt;&lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12927472/12927472_nonisolated_groups_patch.zip&quot; title=&quot;nonisolated_groups_patch.zip attached to PDFBOX-3000&quot;&gt;nonisolated_groups_patch.zip&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;I have created a patch that improves the rendering of blend modes in transparency groups. Previously PDFBox has implemented only isolated (/I true) transparency groups because groups have been rendered to an image that is initially fully transparent. To implement non-isolated groups (/I false), we must follow the PDF spec. Use the group backdrop (copied from parent group or page) as the initial content of the group image. This allows the group contents to be blended with the graphics under the group. Finally when the group rendering is done, we must compute backdrop removal. It ensures the backdrop is not rendered twice on the parent but it leaves the effects produced by blend modes.&lt;/p&gt;

&lt;p&gt;My patch works if PDFRenderer is rendering to a BufferedImage. If it&apos;s rendering to a Graphics2D object, the page can&apos;t provide its pixel data to be used as a backdrop in groups, so blend modes will produce incorrect colors like they have done before my patch.&lt;/p&gt;

&lt;p&gt;Here is a PDF that shows the difference between isolated and non-isolated groups when blend modes are used &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12927475/12927475_isolation.pdf&quot; title=&quot;isolation.pdf attached to PDFBOX-3000&quot;&gt;isolation.pdf&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;&lt;/p&gt;</comment>
                            <comment id="16511442" author="tilman" created="Wed, 13 Jun 2018 17:14:33 +0000"  >&lt;p&gt;Thank you... &lt;/p&gt;

&lt;p&gt;PDFJS-6961.pdf never finishes (or takes extremently long), this is from here:&lt;br/&gt;
&lt;a href=&quot;https://github.com/mozilla/pdf.js/issues/6961&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/mozilla/pdf.js/issues/6961&lt;/a&gt;&lt;br/&gt;
I suspect that the discussion there also applies to the problem here...&lt;/p&gt;

&lt;p&gt;I&apos;m surprised that the rendering of gs-bugzilla697425.pdf is better. I wonder whether the change from february wasn&apos;t enough, that one just checked whether the immediate resources has a blendmode. I see that in PageDrawer, you check recursively. Btw I wonder if we should check tiling patterns as well, i.e. whether they have transparency groups inside their resources...&lt;/p&gt;

&lt;p&gt;Could you please add some comment on top of the GroupGraphics class (maybe similar to your text here) and a few comments in removeBackdrop() that summarize what&apos;s being done? I&apos;m aware that the current consensus is that the code should speak for itself, and I usually agree with that, but here we&apos;re dealing with very complex matters (at least for me, because I&apos;m not a graphics developer).&lt;/p&gt;

&lt;p&gt;I haven&apos;t had the time to review all the rendering changes, this will take some time. The code change won&apos;t be part of 2.0.10 (due next week), but in 2.0.11 (if it is good, and I assume it is).&lt;/p&gt;</comment>
                            <comment id="16512830" author="tilman" created="Thu, 14 Jun 2018 17:58:16 +0000"  >&lt;p&gt;If you give me your mail address (my mail is tilman at snafu dot de) I can give you an URL where you can download our test files.&lt;/p&gt;</comment>
                            <comment id="16516976" author="janipe" created="Tue, 19 Jun 2018 11:46:45 +0000"  >&lt;p&gt;Updated patch: &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12928336/12928336_nonisolated_groups_patch_2.zip&quot; title=&quot;nonisolated_groups_patch_2.zip attached to PDFBOX-3000&quot;&gt;nonisolated_groups_patch_2.zip&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;PDFJS-6961.pdf contains recursive resources. I have updated my hasBlendMode() to avoid endless recursion. Now this PDF finishes in a few seconds. (However, before my patch it took only &amp;lt; 100 ms. The resources in this PDF are ridiculously complex, so hasBlendMode() keeps recursing for a while.)&lt;/p&gt;

&lt;p&gt;gs-bugzilla697425.pdf has /BM /Multiply in the page resource named /R16 but it is never used in the content stream of the page. Instead, the yellow annotation is drawn as a non-isolated transparency group that uses /BM /Multiply.&lt;/p&gt;

&lt;p&gt;I found out that my patch doesn&apos;t improve these files:&lt;br/&gt;
 &lt;a href=&quot;http://www.pdfvt.com/pdf/Isolation-rgb.pdf&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.pdfvt.com/pdf/Isolation-rgb.pdf&lt;/a&gt;&lt;br/&gt;
 &lt;a href=&quot;http://www.pdfvt.com/pdf/IsolationSimple-rgb.pdf&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.pdfvt.com/pdf/IsolationSimple-rgb.pdf&lt;/a&gt;&lt;br/&gt;
 The problem here is that transparency groups have no ExtGState resources of their own. Instead the groups inherit ExtGStates (with blend modes) from the page, so my hasBlendMode() can&apos;t find any blend modes in the resources of the groups.&lt;/p&gt;</comment>
                            <comment id="16517408" author="tilman" created="Tue, 19 Jun 2018 18:33:52 +0000"  >&lt;p&gt;Thanks for the improved patch. I&apos;ll commit it after the release of 2.0.10 (probably in 2 days assuming that voting is successful)&lt;/p&gt;

&lt;p&gt;eci_altona-test-suite-v2_technical2_one-patch-per-page_x4.pdf, p3, 7: probably better; p14: probably perfect; p17: don&apos;t know&lt;/p&gt;

&lt;p&gt;Ghent_PDF-Output-Test-V50_ALL_X4.pdf, p2: slightly better in patch 16.1&lt;/p&gt;

&lt;p&gt;GWG_PDF-Output-Test-V40-CMYK_X4.pdf, p2: dito&lt;/p&gt;

&lt;p&gt;gs-bugzilla697425.pdf: now perfect&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3000&quot; title=&quot;Transparency Group issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3000&quot;&gt;&lt;del&gt;PDFBOX-3000&lt;/del&gt;&lt;/a&gt;-isolation.pdf: now perfect&lt;/p&gt;

&lt;p&gt;gs-bugzilla692766.pdf: better&lt;/p&gt;

&lt;p&gt;***PDF-828.pdf: hard to tell&lt;/p&gt;

&lt;p&gt;A-Designers-Guide-to-Transparency-2007.pdf, p6, 7, 9, 12, 20: better&lt;/p&gt;
</comment>
                            <comment id="16521069" author="tilman" created="Sat, 23 Jun 2018 12:23:49 +0000"  >&lt;p&gt;I&apos;ll commit the change later, after the release of 2.0.11 (yes, 2.0.11) which is planned for next week.&lt;/p&gt;</comment>
                            <comment id="16528815" author="jira-bot" created="Sat, 30 Jun 2018 16:50:16 +0000"  >&lt;p&gt;Commit 1834751 from tilman@apache.org in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1834751&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1834751&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3000&quot; title=&quot;Transparency Group issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3000&quot;&gt;&lt;del&gt;PDFBOX-3000&lt;/del&gt;&lt;/a&gt;: support rendering of blend modes in non-isolated transparency groups, by Jani Pehkonen&lt;/p&gt;</comment>
                            <comment id="16528816" author="jira-bot" created="Sat, 30 Jun 2018 16:50:26 +0000"  >&lt;p&gt;Commit 1834752 from tilman@apache.org in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1834752&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1834752&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3000&quot; title=&quot;Transparency Group issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3000&quot;&gt;&lt;del&gt;PDFBOX-3000&lt;/del&gt;&lt;/a&gt;: support rendering of blend modes in non-isolated transparency groups, by Jani Pehkonen&lt;/p&gt;</comment>
                            <comment id="16528848" author="jira-bot" created="Sat, 30 Jun 2018 18:43:56 +0000"  >&lt;p&gt;Commit 1834757 from tilman@apache.org in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1834757&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1834757&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3000&quot; title=&quot;Transparency Group issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3000&quot;&gt;&lt;del&gt;PDFBOX-3000&lt;/del&gt;&lt;/a&gt;: sonar fix: don&apos;t have a class member with the same name as its enclosing class; rename other member as well&lt;/p&gt;</comment>
                            <comment id="16528849" author="jira-bot" created="Sat, 30 Jun 2018 18:44:01 +0000"  >&lt;p&gt;Commit 1834758 from tilman@apache.org in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1834758&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1834758&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3000&quot; title=&quot;Transparency Group issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3000&quot;&gt;&lt;del&gt;PDFBOX-3000&lt;/del&gt;&lt;/a&gt;: sonar fix: don&apos;t have a class member with the same name as its enclosing class; rename other member as well&lt;/p&gt;</comment>
                            <comment id="17257194" author="lehmi" created="Fri, 1 Jan 2021 13:33:47 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; Is there any chance to name the remaining issues/TODOs from this ticket and create a new one? I&apos;d like to close this one.&lt;/p&gt;</comment>
                            <comment id="17257196" author="tilman" created="Fri, 1 Jan 2021 13:40:23 +0000"  >&lt;p&gt;Sure!&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;eci_altona-test-suite-v2_technical2_one-patch-per-page_x4.pdf, pages 7 and 8&lt;/li&gt;
	&lt;li&gt;gs-bugzilla690816.pdf, rectangle top left&lt;/li&gt;
	&lt;li&gt;gs-bugzilla691650-2.pdf, fade in the mid rectangle is in wrong direction&lt;/li&gt;
	&lt;li&gt;gs-bugzilla693033.pdf, UN logo&lt;/li&gt;
	&lt;li&gt;gs-bugzilla697433-2.pdf, inner rectangle missing&lt;/li&gt;
	&lt;li&gt;samsung_galaxy_s_4_um-p1_reduced.pdf, background rectangle shouldn&apos;t be there&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="17257199" author="tilman" created="Fri, 1 Jan 2021 13:56:00 +0000"  >&lt;p&gt;There&apos;s a TODO &quot;investigate: clip rectangle origin effects&quot; but I have no idea what I meant 4 years ago &#128514;&lt;/p&gt;</comment>
                            <comment id="17257200" author="lehmi" created="Fri, 1 Jan 2021 13:58:06 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                            <outwardlinks description="duplicates">
                                        <issuelink>
            <issuekey id="12503287">PDFBOX-994</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12608894">PDFBOX-1416</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12699504">PDFBOX-1968</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12760712">PDFBOX-2554</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12771933">PDFBOX-2658</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12914484">PDFBOX-3118</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12982769">PDFBOX-3400</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13004270">PDFBOX-3494</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13039240">PDFBOX-3670</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12927236">PDFBOX-3182</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13348668">PDFBOX-5065</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13407353">PDFBOX-5296</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12725243">PDFBOX-2182</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13019957">PDFBOX-3564</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="12310051">
                    <name>Supercedes</name>
                                            <outwardlinks description="supercedes">
                                        <issuelink>
            <issuekey id="12747367">PDFBOX-2423</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12831568" name="007087-payment-due-p58_reduced2.pdf" size="208330" author="tilman" created="Tue, 4 Oct 2016 17:02:35 +0000"/>
                            <attachment id="12846055" name="BlendModes-rgb.pdf" size="7688" author="tilman" created="Fri, 6 Jan 2017 18:46:18 +0000"/>
                            <attachment id="12830533" name="PDFBOX-1697-reduced-rotations.pdf" size="46790" author="tilman" created="Tue, 27 Sep 2016 17:35:55 +0000"/>
                            <attachment id="12839196" name="PDFBOX-2182_mod.pdf" size="5670" author="tilman" created="Wed, 16 Nov 2016 16:56:30 +0000"/>
                            <attachment id="12831570" name="PDFBOX-3400-RGB.pdf" size="182499" author="tilman" created="Tue, 4 Oct 2016 17:02:35 +0000"/>
                            <attachment id="12828061" name="PDFBOX-3494_reduced.pdf" size="518584" author="tilman" created="Mon, 12 Sep 2016 15:55:19 +0000"/>
                            <attachment id="12841526" name="PDFBOX-3494_reduced_cropX.pdf" size="113739" author="tilman" created="Fri, 2 Dec 2016 16:59:21 +0000"/>
                            <attachment id="12838592" name="PDFBOX-3564-Mask.pdf" size="15083" author="tilman" created="Fri, 11 Nov 2016 18:13:55 +0000"/>
                            <attachment id="12830568" name="PDFBox3359PanelTestEnhanced.java" size="3262" author="tilman" created="Tue, 27 Sep 2016 20:26:07 +0000"/>
                            <attachment id="12831621" name="PDFJS-2845-p1.pdf" size="666253" author="tilman" created="Tue, 4 Oct 2016 21:20:25 +0000"/>
                            <attachment id="12846374" name="PDFJS-5526-p13_reduced1.pdf" size="6108" author="tilman" created="Mon, 9 Jan 2017 17:34:37 +0000"/>
                            <attachment id="12846375" name="PDFJS-5526-p13_reduced2.pdf" size="6021" author="tilman" created="Mon, 9 Jan 2017 17:34:37 +0000"/>
                            <attachment id="12846376" name="PDFJS-5526-p13_reduced3-nogroup.pdf" size="5892" author="tilman" created="Mon, 9 Jan 2017 17:34:37 +0000"/>
                            <attachment id="12841530" name="PDFJS-5811-2-p3_reduced.pdf" size="135067" author="tilman" created="Fri, 2 Dec 2016 17:13:46 +0000"/>
                            <attachment id="12841524" name="PDFJS-5811-2-p3_reduced4.pdf" size="5502" author="tilman" created="Fri, 2 Dec 2016 16:59:21 +0000"/>
                            <attachment id="12830928" name="PDFJS-5811-2-p4_reduced-rotations.pdf" size="14930" author="tilman" created="Thu, 29 Sep 2016 17:10:37 +0000"/>
                            <attachment id="12832699" name="PDFJS-5811-2.pdf" size="2473654" author="tilman" created="Tue, 11 Oct 2016 17:03:39 +0000"/>
                            <attachment id="12832346" name="PDFJS-5853_reduced.pdf" size="52767" author="tilman" created="Sun, 9 Oct 2016 11:45:59 +0000"/>
                            <attachment id="12927683" name="PDFJS-6961.pdf" size="2156587" author="tilman" created="Wed, 13 Jun 2018 17:17:43 +0000"/>
                            <attachment id="12905125" name="PDFJS-6967-p8.pdf" size="406970" author="tilman" created="Mon, 8 Jan 2018 17:08:36 +0000"/>
                            <attachment id="12845569" name="PDFJS-6967_reduced_outside_softmask.pdf" size="1600872" author="tilman" created="Wed, 4 Jan 2017 16:41:55 +0000"/>
                            <attachment id="12901739" name="PDFJS-8136-p1.pdf" size="2501057" author="tilman" created="Tue, 12 Dec 2017 18:48:11 +0000"/>
                            <attachment id="12901738" name="PDFJS-8136-p1_reduced.pdf" size="567266" author="tilman" created="Tue, 12 Dec 2017 18:47:45 +0000"/>
                            <attachment id="12846046" name="SoftMask-Clipped.pdf" size="6216" author="tilman" created="Fri, 6 Jan 2017 17:53:07 +0000"/>
                            <attachment id="12846045" name="SoftMask.pdf" size="5630" author="tilman" created="Fri, 6 Jan 2017 17:53:07 +0000"/>
                            <attachment id="12846054" name="blendmodes.pdf" size="50567" author="tilman" created="Fri, 6 Jan 2017 18:46:18 +0000"/>
                            <attachment id="12842405" name="circle-simple.pdf" size="19814" author="jon_wu" created="Thu, 8 Dec 2016 20:09:39 +0000"/>
                            <attachment id="12841525" name="ds-firewall-enterprise-p1_reduced.pdf" size="148272" author="tilman" created="Fri, 2 Dec 2016 16:59:21 +0000"/>
                            <attachment id="12842666" name="gs-bugzilla689309-reduced-bc0.pdf" size="59833" author="tilman" created="Sat, 10 Dec 2016 13:26:22 +0000"/>
                            <attachment id="12842665" name="gs-bugzilla689309-reduced-bc1.pdf" size="59834" author="tilman" created="Sat, 10 Dec 2016 13:26:22 +0000"/>
                            <attachment id="12842664" name="gs-bugzilla689309-reduced.pdf" size="59697" author="tilman" created="Sat, 10 Dec 2016 13:26:22 +0000"/>
                            <attachment id="12846056" name="gs-bugzilla689931_reduced-Multiply.pdf" size="5628" author="tilman" created="Fri, 6 Jan 2017 18:46:18 +0000"/>
                            <attachment id="12846057" name="gs-bugzilla689931_reduced-Screen.pdf" size="5626" author="tilman" created="Fri, 6 Jan 2017 18:46:18 +0000"/>
                            <attachment id="12846184" name="gs-bugzilla689931_reduced-ScreenBlendPageBackground.pdf" size="5309" author="tilman" created="Sat, 7 Jan 2017 14:22:29 +0000"/>
                            <attachment id="12849309" name="gs-bugzilla690022-reduced-rotations-cropbox.pdf" size="5957" author="tilman" created="Wed, 25 Jan 2017 16:01:17 +0000"/>
                            <attachment id="12847414" name="gs-bugzilla690022-reduced-rotations.pdf" size="5957" author="tilman" created="Fri, 13 Jan 2017 20:10:56 +0000"/>
                            <attachment id="12847064" name="gs-bugzilla690022_reduced.pdf" size="5390" author="tilman" created="Wed, 11 Jan 2017 20:11:40 +0000"/>
                            <attachment id="12838589" name="gs-bugzilla691157.pdf" size="327135" author="tilman" created="Fri, 11 Nov 2016 18:13:55 +0000"/>
                            <attachment id="12838666" name="gs-bugzilla691157_mod_unc.pdf" size="327054" author="tilman" created="Sat, 12 Nov 2016 21:54:09 +0000"/>
                            <attachment id="12838668" name="gs-bugzilla691157_mod_unc.png" size="25450" author="tilman" created="Sat, 12 Nov 2016 22:20:32 +0000"/>
                            <attachment id="12838591" name="gs-bugzilla691348.pdf" size="93278" author="tilman" created="Fri, 11 Nov 2016 18:13:55 +0000"/>
                            <attachment id="12846058" name="gs-bugzilla691650-2.pdf" size="8353" author="tilman" created="Fri, 6 Jan 2017 18:46:18 +0000"/>
                            <attachment id="12844788" name="gs-bugzilla692217_reduced.pdf" size="5979" author="tilman" created="Tue, 27 Dec 2016 14:05:34 +0000"/>
                            <attachment id="12901736" name="gs-bugzilla693134-giant-pattern-reduced.pdf" size="1221604" author="tilman" created="Tue, 12 Dec 2017 18:48:03 +0000"/>
                            <attachment id="12831988" name="gs-bugzilla693322_reduced.pdf" size="5934" author="tilman" created="Thu, 6 Oct 2016 16:48:03 +0000"/>
                            <attachment id="12832698" name="gs-bugzilla694556-3.pdf" size="897029" author="tilman" created="Tue, 11 Oct 2016 17:03:39 +0000"/>
                            <attachment id="12832700" name="gs-bugzilla695354.pdf" size="371886" author="tilman" created="Tue, 11 Oct 2016 17:03:39 +0000"/>
                            <attachment id="12832695" name="gs-bugzilla695582-transparency-fill-stroke.pdf" size="6019" author="tilman" created="Tue, 11 Oct 2016 16:59:39 +0000"/>
                            <attachment id="12832696" name="gs-bugzilla695582-transparency-fill-stroke.pdf-1.png" size="125749" author="tilman" created="Tue, 11 Oct 2016 16:59:39 +0000"/>
                            <attachment id="12927682" name="gs-bugzilla697425.pdf" size="25930" author="tilman" created="Wed, 13 Jun 2018 17:16:58 +0000"/>
                            <attachment id="12927475" name="isolation.pdf" size="4973" author="janipe" created="Tue, 12 Jun 2018 14:43:30 +0000"/>
                            <attachment id="12927472" name="nonisolated_groups_patch.zip" size="5802" author="janipe" created="Tue, 12 Jun 2018 14:38:04 +0000"/>
                            <attachment id="12928336" name="nonisolated_groups_patch_2.zip" size="6938" author="janipe" created="Tue, 19 Jun 2018 11:40:59 +0000"/>
                            <attachment id="12901737" name="pop-bugzilla40164.pdf" size="12295" author="tilman" created="Tue, 12 Dec 2017 18:47:36 +0000"/>
                            <attachment id="12831569" name="samsung_galaxy_s_4_um-p1_reduced.pdf" size="6793" author="tilman" created="Tue, 4 Oct 2016 17:02:35 +0000"/>
                            <attachment id="12842740" name="snowman-nose-gradient-rgb.pdf" size="18745" author="jon_wu" created="Mon, 12 Dec 2016 00:37:04 +0000"/>
                            <attachment id="12844952" name="snowman-nose-gradient-rgb_reduced-0.6-bad2.pdf" size="14155" author="tilman" created="Wed, 28 Dec 2016 17:12:54 +0000"/>
                            <attachment id="12844951" name="snowman-nose-gradient-rgb_reduced-0.7-good2.pdf" size="14155" author="tilman" created="Wed, 28 Dec 2016 17:12:54 +0000"/>
                            <attachment id="12842702" name="snowman-nose-gradient-screenshot-comparison-11.12.2016.jpg" size="70379" author="tilman" created="Sun, 11 Dec 2016 09:09:03 +0000"/>
                            <attachment id="12842685" name="snowman-nose-gradient.pdf" size="45810" author="jon_wu" created="Sat, 10 Dec 2016 23:54:19 +0000"/>
                            <attachment id="12842235" name="snowmen-opacity-clipping-masks-2.0.3.png" size="21263" author="jon_wu" created="Wed, 7 Dec 2016 23:08:31 +0000"/>
                            <attachment id="12842662" name="snowmen-opacity-clipping-masks-2.1-SNAPSHOT-10.12.2016.png" size="61448" author="tilman" created="Sat, 10 Dec 2016 13:04:30 +0000"/>
                            <attachment id="12842234" name="snowmen-opacity-clipping-masks-2.1.0-SNAPSHOT-2016-12-07.png" size="26430" author="jon_wu" created="Wed, 7 Dec 2016 23:08:31 +0000"/>
                            <attachment id="12842233" name="snowmen-opacity-clipping-masks-adobe-illustrator.png" size="97684" author="jon_wu" created="Wed, 7 Dec 2016 23:08:31 +0000"/>
                            <attachment id="12842236" name="snowmen-opacity-clipping-masks.pdf" size="80734" author="jon_wu" created="Wed, 7 Dec 2016 23:08:31 +0000"/>
                            <attachment id="12764751" name="softmask-rewrite-alt1.patch" size="22233" author="pslabycz" created="Fri, 2 Oct 2015 09:37:01 +0000"/>
                            <attachment id="12764671" name="softmask-rewrite.patch" size="25066" author="chengas123" created="Thu, 1 Oct 2015 19:35:15 +0000"/>
                    </attachments>
                <subtasks>
                            <subtask id="12855922">PDFBOX-2934</subtask>
                            <subtask id="13123219">PDFBOX-4029</subtask>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>67.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 45 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2mdt3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>