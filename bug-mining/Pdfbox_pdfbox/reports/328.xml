<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 20:54:23 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PDFBOX-1622] TextNormalize init not thread-safe, may lead to infinite loop</title>
                <link>https://issues.apache.org/jira/browse/PDFBOX-1622</link>
                <project id="12310760" key="PDFBOX">PDFBox</project>
                    <description>&lt;p&gt;TextNormalize fills a static HashMap (DIACHASH) from a method (populateDiacHash) called by the TextNormalize constructor.&lt;/p&gt;

&lt;p&gt;If the constructor is called from two different threads at the same time, then the HashMap may be written by two concurrent threads which may and will cause infinite loops.&lt;/p&gt;

&lt;p&gt;We see the CPU at 100% and jstack shows 4 threads all stuck at:&lt;/p&gt;

&lt;p&gt;&quot;Thread-2&quot; prio=10 tid=0x00007f6e94499000 nid=0x347 runnable &lt;span class=&quot;error&quot;&gt;&amp;#91;0x00007f6e925d6000&amp;#93;&lt;/span&gt;&lt;br/&gt;
   java.lang.Thread.State: RUNNABLE&lt;br/&gt;
	at java.util.HashMap.put(HashMap.java:391)&lt;br/&gt;
	at org.apache.pdfbox.util.TextNormalize.populateDiacHash(TextNormalize.java:82)&lt;br/&gt;
	at org.apache.pdfbox.util.TextNormalize.&amp;lt;init&amp;gt;(TextNormalize.java:41)&lt;br/&gt;
	at org.apache.pdfbox.util.PDFTextStripper.&amp;lt;init&amp;gt;(PDFTextStripper.java:193)&lt;/p&gt;

&lt;p&gt;A patch to fix this is attached, it just moves the initialization to a static block.&lt;/p&gt;

&lt;p&gt;Please apply to the 1.8.3 and 2.0.0 branches.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12650936">PDFBOX-1622</key>
            <summary>TextNormalize init not thread-safe, may lead to infinite loop</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="lehmi">Andreas Lehmk&#252;hler</assignee>
                                    <reporter username="fguillaume">Florent Guillaume</reporter>
                        <labels>
                    </labels>
                <created>Tue, 4 Jun 2013 17:12:26 +0000</created>
                <updated>Sat, 30 Nov 2013 17:02:12 +0000</updated>
                            <resolved>Fri, 9 Aug 2013 18:27:16 +0000</resolved>
                                    <version>1.0.0</version>
                                    <fixVersion>1.8.3</fixVersion>
                    <fixVersion>2.0.0</fixVersion>
                                    <component>Utilities</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="13674574" author="fguillaume" created="Tue, 4 Jun 2013 17:15:35 +0000"  >&lt;p&gt;Bug introduced in &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-449&quot; title=&quot;Decomposed extended Latin Characters not normalized&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-449&quot;&gt;&lt;del&gt;PDFBOX-449&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="13684168" author="lehmi" created="Sat, 15 Jun 2013 12:47:57 +0000"  >&lt;p&gt;PDFBox isn&apos;t supposed to be thread-safe, but I agree with Florent that it&apos;s a good idea to initialize a static HashMap only once in a static block instead of doing it again and again within the constructor.&lt;/p&gt;</comment>
                            <comment id="13686554" author="fguillaume" created="Tue, 18 Jun 2013 10:27:26 +0000"  >&lt;p&gt;Even with a non-thread-safe library (which I have no problem with) I wouldn&apos;t expect a constructor called by two threads to cause issues.&lt;/p&gt;</comment>
                            <comment id="13713771" author="fguillaume" created="Fri, 19 Jul 2013 15:32:45 +0000"  >&lt;p&gt;Could this please be committed by a committer? The fix is trivial and provided.&lt;/p&gt;</comment>
                            <comment id="13735111" author="lehmi" created="Fri, 9 Aug 2013 18:27:16 +0000"  >&lt;p&gt;I&apos;ve applied the patch in revision 1512433 as proposed including some slight changes.&lt;/p&gt;

&lt;p&gt;Thanks for the contribution! &lt;/p&gt;

&lt;p&gt;Please be more patient for the future as we all try to do our best.&lt;/p&gt;</comment>
                            <comment id="13735909" author="fguillaume" created="Sat, 10 Aug 2013 13:12:05 +0000"  >&lt;p&gt;Thanks Andreas.&lt;/p&gt;</comment>
                            <comment id="13824849" author="lehmi" created="Sun, 17 Nov 2013 14:33:23 +0000"  >&lt;p&gt;Merged into 1.8-branch in revision 1542735&lt;/p&gt;</comment>
                            <comment id="13835810" author="lehmi" created="Sat, 30 Nov 2013 17:02:12 +0000"  >&lt;p&gt;Closed after releasing 1.8.3&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12421810">PDFBOX-449</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12586128" name="PDFBOX-1622.patch.txt" size="1174" author="fguillaume" created="Tue, 4 Jun 2013 17:13:20 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>331263</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 51 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1l5dj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>331596</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>