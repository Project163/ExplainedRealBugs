<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:05:24 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PDFBOX-3661] Problem With Malformed xref</title>
                <link>https://issues.apache.org/jira/browse/PDFBOX-3661</link>
                <project id="12310760" key="PDFBOX">PDFBox</project>
                    <description>&lt;p&gt;Some files generated with unknown software. Generated malformed xref table, this instead of being well-formed with the correct EOL is in one line.&lt;/p&gt;

&lt;p&gt;Other readers correctly read the file, and sign it.&lt;/p&gt;

&lt;p&gt;PDFBox instead give Exception for malformed xref.&lt;/p&gt;

&lt;p&gt;I tried created a patch that allows you to read the above mentioned file. Because the original file is private I proceeded to recreate one the patch works with both.&lt;/p&gt;</description>
                <environment>Windows 10 JVM 8</environment>
        <key id="13036976">PDFBOX-3661</key>
            <summary>Problem With Malformed xref</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="lehmi">Andreas Lehmk&#252;hler</assignee>
                                    <reporter username="marcom1981@gmail.com">Marco Monacelli</reporter>
                        <labels>
                    </labels>
                <created>Mon, 23 Jan 2017 08:51:45 +0000</created>
                <updated>Sat, 25 Mar 2017 18:13:12 +0000</updated>
                            <resolved>Tue, 7 Feb 2017 10:44:23 +0000</resolved>
                                    <version>2.0.4</version>
                                    <fixVersion>2.0.5</fixVersion>
                    <fixVersion>3.0.0 PDFBox</fixVersion>
                                    <component>Parsing</component>
                        <due></due>
                            <votes>5</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="15844378" author="jira-bot" created="Sun, 29 Jan 2017 12:21:50 +0000"  >&lt;p&gt;Commit 1780783 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lehmi&quot; class=&quot;user-hover&quot; rel=&quot;lehmi&quot;&gt;lehmi&lt;/a&gt; in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1780783&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1780783&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3661&quot; title=&quot;Problem With Malformed xref&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3661&quot;&gt;&lt;del&gt;PDFBOX-3661&lt;/del&gt;&lt;/a&gt;: optimize the xref parser, rebuild the trailer if something went wrong while parsing the xref information&lt;/p&gt;</comment>
                            <comment id="15844379" author="jira-bot" created="Sun, 29 Jan 2017 12:23:01 +0000"  >&lt;p&gt;Commit 1780784 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lehmi&quot; class=&quot;user-hover&quot; rel=&quot;lehmi&quot;&gt;lehmi&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1780784&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1780784&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3661&quot; title=&quot;Problem With Malformed xref&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3661&quot;&gt;&lt;del&gt;PDFBOX-3661&lt;/del&gt;&lt;/a&gt;: optimize the xref parser, rebuild the trailer if something went wrong while parsing the xref information&lt;/p&gt;</comment>
                            <comment id="15844383" author="lehmi" created="Sun, 29 Jan 2017 12:31:53 +0000"  >&lt;p&gt;Instead of adding more and more special cases to the parser PDFBox now rebuilds the trailer if something went wrong when parsing the xref. That solves this issue.&lt;/p&gt;

&lt;p&gt;Furthermore I&apos;ve optimized some details:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;skip unneccesary xref lines only if valid&lt;/li&gt;
	&lt;li&gt;better log message when skipping an unneccesary xref line&lt;/li&gt;
	&lt;li&gt;object streams are processed only if present when checking all xref values&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15844386" author="tilman" created="Sun, 29 Jan 2017 12:40:10 +0000"  >&lt;p&gt;NPE for Isartor testsuite\PDFA-1b\6.1 File structure\6.1.2 File header\isartor-6-1-2-t01-fail-a.pdf &lt;/p&gt;</comment>
                            <comment id="15844393" author="jira-bot" created="Sun, 29 Jan 2017 12:58:49 +0000"  >&lt;p&gt;Commit 1780789 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lehmi&quot; class=&quot;user-hover&quot; rel=&quot;lehmi&quot;&gt;lehmi&lt;/a&gt; in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1780789&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1780789&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3661&quot; title=&quot;Problem With Malformed xref&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3661&quot;&gt;&lt;del&gt;PDFBOX-3661&lt;/del&gt;&lt;/a&gt;: rethrow exception if not in lenient mode&lt;/p&gt;</comment>
                            <comment id="15844402" author="lehmi" created="Sun, 29 Jan 2017 13:20:47 +0000"  >&lt;p&gt;The NPE should be gone after my last change&lt;/p&gt;</comment>
                            <comment id="15844403" author="jira-bot" created="Sun, 29 Jan 2017 13:21:05 +0000"  >&lt;p&gt;Commit 1780793 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lehmi&quot; class=&quot;user-hover&quot; rel=&quot;lehmi&quot;&gt;lehmi&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1780793&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1780793&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3661&quot; title=&quot;Problem With Malformed xref&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3661&quot;&gt;&lt;del&gt;PDFBOX-3661&lt;/del&gt;&lt;/a&gt;: rethrow exception if not in lenient mode&lt;/p&gt;</comment>
                            <comment id="15844421" author="tilman" created="Sun, 29 Jan 2017 13:35:45 +0000"  >&lt;p&gt;Thanks, build is OK now.&lt;/p&gt;</comment>
                            <comment id="15844970" author="marcom1981@gmail.com" created="Mon, 30 Jan 2017 09:25:20 +0000"  >&lt;p&gt;Thanks, Now the parser works with the unsigned version of the file.&lt;br/&gt;
However my problem starts from a signed version. The orignal file returns the following warning during parsing:&lt;/p&gt;

&lt;p&gt;7 10:17:39 AM org.apache.pdfbox.pdfparser.COSParser parseXrefTable&lt;br/&gt;
AVVERTENZA: Unexpected XRefTable Entry: 0 42 0000000000 65535 f  0000008145 00000 n  0000075795 00000 n  0000008086 00000 n  0000007922 00000 n  0000000018 00000 n  0000007902 00000 n  0000008193 00000 n  0000012005 00000 n  0000048413 00000 n  0000012460 00000 n  0000060559 00000 n  0000011652 00000 n  0000039989 00000 n  0000075704 00000 n  0000008247 00000 n  0000011062 00000 n  0000021228 00000 n  0000008416 00000 n  0000008582 00000 n  0000010459 00000 n  0000011228 00000 n  0000026351 00000 n  0000008756 00000 n  0000008921 00000 n  0000009091 00000 n  0000010776 00000 n  0000012897 00000 n  0000009268 00000 n  0000009443 00000 n  0000009626 00000 n  0000009803 00000 n  0000009990 00000 n  0000010168 00000 n  0000010333 00000 n  0000010363 00000 n  0000013083 00000 n  0000021458 00000 n  0000026560 00000 n  0000040201 00000 n  0000048617 00000 n  0000060768 00000 n  trailer &amp;lt;&amp;lt; /Size 42 /Info 2 0 R /Root 1 0 R /ID &lt;span class=&quot;error&quot;&gt;&amp;#91;&amp;lt;12DC173E470EEA8F2C4433684D7656F1&amp;gt;&amp;lt;12DC173E470EEA8F2C4433684D7656F1&amp;gt;&amp;#93;&lt;/span&gt; &amp;gt;&amp;gt; startxref 75914 %%EOF &lt;br/&gt;
gen 30, 2017 10:17:39 AM org.apache.pdfbox.pdfparser.COSParser parseXref&lt;br/&gt;
AVVERTENZA: Expected trailer object at position 76909, keep trying&lt;br/&gt;
gen 30, 2017 10:17:39 AM esecurity.testpdfbox.TestLoadDoc main&lt;/p&gt;

&lt;p&gt;With the new version i&apos;m not able to add revisione:&lt;br/&gt;
java.io.IOException: Can&apos;t write new ByteRange, not enough space&lt;br/&gt;
	at org.apache.pdfbox.pdfwriter.COSWriter.doWriteSignature(COSWriter.java:706)&lt;br/&gt;
	at org.apache.pdfbox.pdfwriter.COSWriter.visitFromDocument(COSWriter.java:1131)&lt;br/&gt;
	at org.apache.pdfbox.cos.COSDocument.accept(COSDocument.java:419)&lt;br/&gt;
	at org.apache.pdfbox.pdfwriter.COSWriter.write(COSWriter.java:1367)&lt;br/&gt;
	at org.apache.pdfbox.pdmodel.PDDocument.saveIncremental(PDDocument.java:1265)&lt;br/&gt;
	at esecurity.testpdfbox.TestLoadDoc.main(TestLoadDoc.java:48)&lt;/p&gt;

&lt;p&gt;Attach file but is not perfectly equals of original.&lt;/p&gt;</comment>
                            <comment id="15845846" author="jira-bot" created="Mon, 30 Jan 2017 20:29:18 +0000"  >&lt;p&gt;Commit 1780981 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1780981&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1780981&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3661&quot; title=&quot;Problem With Malformed xref&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3661&quot;&gt;&lt;del&gt;PDFBOX-3661&lt;/del&gt;&lt;/a&gt;: improve exception message&lt;/p&gt;</comment>
                            <comment id="15845847" author="jira-bot" created="Mon, 30 Jan 2017 20:29:23 +0000"  >&lt;p&gt;Commit 1780982 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1780982&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1780982&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3661&quot; title=&quot;Problem With Malformed xref&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3661&quot;&gt;&lt;del&gt;PDFBOX-3661&lt;/del&gt;&lt;/a&gt;: improve exception message&lt;/p&gt;</comment>
                            <comment id="15845851" author="tilman" created="Mon, 30 Jan 2017 20:30:27 +0000"  >&lt;p&gt;I was able to sign the file without any trouble. Could you please try the updated version, it brings a better exception message.&lt;/p&gt;</comment>
                            <comment id="15846857" author="marcom1981@gmail.com" created="Tue, 31 Jan 2017 13:57:27 +0000"  >&lt;p&gt;Now return.&lt;br/&gt;
java.io.IOException: Can&apos;t write new byteRange &apos;0 176327 195273 141592]&apos; not enough space: byteRange.length(): 23, byteRangeLength: 20&lt;br/&gt;
	at org.apache.pdfbox.pdfwriter.COSWriter.doWriteSignature(COSWriter.java:707)&lt;br/&gt;
	at org.apache.pdfbox.pdfwriter.COSWriter.visitFromDocument(COSWriter.java:1133)&lt;br/&gt;
	at org.apache.pdfbox.cos.COSDocument.accept(COSDocument.java:419)&lt;br/&gt;
	at org.apache.pdfbox.pdfwriter.COSWriter.write(COSWriter.java:1369)&lt;br/&gt;
	at org.apache.pdfbox.pdmodel.PDDocument.saveIncremental(PDDocument.java:1265)&lt;br/&gt;
	at esecurity.testpdfbox.TestLoadDoc.main(TestLoadDoc.java:49)&lt;/p&gt;</comment>
                            <comment id="15846860" author="marcom1981@gmail.com" created="Tue, 31 Jan 2017 14:00:55 +0000"  >&lt;p&gt;I try to create a empty revision. Other file welformed is corect update.&lt;/p&gt;

&lt;p&gt;This is my test case:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
            ScratchFile SCRATCH_FILE_TEMP = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ScratchFile(MemoryUsageSetting.setupMixed(10000000));
            RandomAccess randomAccess = SCRATCH_FILE_TEMP.createBuffer(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; FileInputStream(&lt;span class=&quot;code-quote&quot;&gt;&quot;C:\\Users\\marco.monacelli.ARUBA\\Desktop\\test\\test_xref_mal_formato\\simple_malformed_doc_signed.pdf&quot;&lt;/span&gt;));
            PDFParser parser = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; PDFParser(randomAccess, SCRATCH_FILE_TEMP);
            parser.parse();
            PDDocument document = parser.getPDDocument();
			document.saveIncremental(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; FileOutputStream(&lt;span class=&quot;code-quote&quot;&gt;&quot;C:\\Users\\marco.monacelli.ARUBA\\Desktop\\test\\test_xref_mal_formato\\simple_malformed_doc_signed_resaved.pdf&quot;&lt;/span&gt;));
        } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (Exception ex) {
            logger.log(Level.SEVERE, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, ex);
        }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="15848723" author="tilman" created="Wed, 1 Feb 2017 18:08:52 +0000"  >&lt;p&gt;This is a different bug than the original one, you&apos;re not signing, you just want to do an incremental save. See my comment in &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-45&quot; title=&quot;Support incremental save&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-45&quot;&gt;&lt;del&gt;PDFBOX-45&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="15855547" author="marcom1981@gmail.com" created="Tue, 7 Feb 2017 08:15:06 +0000"  >&lt;p&gt;Thanks in advance. I&apos;m waiting for news about the PDFBox-45 ticket.&lt;/p&gt;</comment>
                            <comment id="15855725" author="lehmi" created="Tue, 7 Feb 2017 10:44:24 +0000"  >&lt;p&gt;Thanks for all the feedback!&lt;/p&gt;

&lt;p&gt;Set to resolved as the issue is solved.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13014393">PDFBOX-3538</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12848856" name="from_trunk.patch" size="1470" author="marcom1981@gmail.com" created="Mon, 23 Jan 2017 08:51:45 +0000"/>
                            <attachment id="12848855" name="simple_malformed_doc.pdf" size="148703" author="marcom1981@gmail.com" created="Mon, 23 Jan 2017 08:51:45 +0000"/>
                            <attachment id="12849928" name="simple_malformed_doc_signed.pdf" size="168626" author="marcom1981@gmail.com" created="Mon, 30 Jan 2017 09:25:20 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 40 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i392av:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>