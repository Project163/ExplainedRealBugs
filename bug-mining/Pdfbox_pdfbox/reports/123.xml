<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 20:52:51 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PDFBOX-979] errors in %%EOF handling (fix included)</title>
                <link>https://issues.apache.org/jira/browse/PDFBOX-979</link>
                <project id="12310760" key="PDFBOX">PDFBox</project>
                    <description>&lt;p&gt;The &apos;%%EOF&apos; handling in PDFParser has several errors. The current implementation (start from line 467):&lt;/p&gt;

&lt;p&gt;                String eof = &quot;&quot;;&lt;br/&gt;
                if(!pdfSource.isEOF())&lt;br/&gt;
                    readLine(); // if there&apos;s more data to read, get the EOF flag&lt;/p&gt;

&lt;p&gt;                // verify that EOF exists&lt;br/&gt;
                if(&quot;%%EOF&quot;.equals(eof)) &lt;/p&gt;
{
                    // PDF does not conform to spec, we should warn someone
                    log.warn(&quot;expected=&apos;%%EOF&apos; actual=&apos;&quot; + eof + &quot;&apos;&quot;);
                    // if we&apos;re not at the end of a file, just put it back and move on
                    if(!pdfSource.isEOF())
                        pdfSource.unread(eof.getBytes(&quot;ISO-8859-1&quot;));
                }

&lt;p&gt;The problems:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;eof variable gets no value&lt;/li&gt;
	&lt;li&gt;comparison if(&quot;%%EOF&quot;.equals(eof)) must be negated&lt;/li&gt;
	&lt;li&gt;unreading must first add a newline or space byte because we read with readline() (like in bug &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-978&quot; title=&quot;unreading of trailing content after &amp;#39;endobj&amp;#39; is missing new line byte (fix included)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-978&quot;&gt;&lt;del&gt;PDFBOX-978&lt;/del&gt;&lt;/a&gt;)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Corrected version:&lt;br/&gt;
                String eof = &quot;&quot;;&lt;br/&gt;
                if(!pdfSource.isEOF())&lt;br/&gt;
                    eof = readLine(); // if there&apos;s more data to read, get the EOF flag&lt;/p&gt;

&lt;p&gt;                // verify that EOF exists&lt;br/&gt;
                if(!&quot;%%EOF&quot;.equals(eof)) {&lt;br/&gt;
                    // PDF does not conform to spec, we should warn someone&lt;br/&gt;
                    log.warn(&quot;expected=&apos;%%EOF&apos; actual=&apos;&quot; + eof + &quot;&apos;&quot;);&lt;br/&gt;
                    // if we&apos;re not at the end of a file, just put it back and move on&lt;br/&gt;
                    if(!pdfSource.isEOF()) &lt;/p&gt;
{
                      	pdfSource.unread( SPACE_BYTE );	// we read a whole line; add space as newline replacement
                        pdfSource.unread(eof.getBytes(&quot;ISO-8859-1&quot;));
                    }
&lt;p&gt;                }&lt;/p&gt;</description>
                <environment></environment>
        <key id="12501440">PDFBOX-979</key>
            <summary>errors in %%EOF handling (fix included)</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="adamnichols">Adam Nichols</assignee>
                                    <reporter username="tboehme">Timo Boehme</reporter>
                        <labels>
                    </labels>
                <created>Tue, 15 Mar 2011 09:23:17 +0000</created>
                <updated>Sat, 2 Jul 2011 16:28:55 +0000</updated>
                            <resolved>Wed, 16 Mar 2011 16:40:03 +0000</resolved>
                                    <version>1.6.0</version>
                                    <fixVersion>1.6.0</fixVersion>
                                    <component>Parsing</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="13006855" author="tboehme" created="Tue, 15 Mar 2011 09:36:01 +0000"  >&lt;p&gt;I have some bogus PDF files where content starts immediately after &apos;%%EOF&apos;:&lt;/p&gt;

&lt;p&gt;startxref&lt;br/&gt;
302041&lt;br/&gt;
%%EOF333 0 obj&amp;lt;&amp;lt;/Length 15/Root&lt;/p&gt;

&lt;p&gt;In order to handle it like in the &apos;endobj&apos; case I test if we start with &apos;%%EOF&apos; and unread all following content.&lt;br/&gt;
New fixed version:&lt;/p&gt;

&lt;p&gt;                String eof = &quot;&quot;;&lt;br/&gt;
                if(!pdfSource.isEOF())&lt;br/&gt;
                    eof = readLine(); // if there&apos;s more data to read, get the EOF flag&lt;/p&gt;

&lt;p&gt;                // verify that EOF exists&lt;br/&gt;
                if(!&quot;%%EOF&quot;.equals(eof)) {&lt;br/&gt;
                	  if( eof.startsWith( &quot;%%EOF&quot; ) ) &lt;/p&gt;
{
                	  	// content after marker -&amp;gt; unread with first space byte for read newline
                    		pdfSource.unread( SPACE_BYTE );	// we read a whole line; add space as newline replacement
                    		pdfSource.unread( eof.substring( 5 ).getBytes(&quot;ISO-8859-1&quot;) );
                	  }
&lt;p&gt; else {&lt;br/&gt;
	                    // PDF does not conform to spec, we should warn someone&lt;br/&gt;
	                    log.warn(&quot;expected=&apos;%%EOF&apos; actual=&apos;&quot; + eof + &quot;&apos;&quot;);&lt;br/&gt;
	                    // if we&apos;re not at the end of a file, just put it back and move on&lt;br/&gt;
	                    if(!pdfSource.isEOF()) &lt;/p&gt;
{
	                      	pdfSource.unread( SPACE_BYTE );	// we read a whole line; add space as newline replacement
	                        pdfSource.unread(eof.getBytes(&quot;ISO-8859-1&quot;));
	                    }
&lt;p&gt;                	  }&lt;br/&gt;
                }&lt;/p&gt;</comment>
                            <comment id="13007540" author="adamnichols" created="Wed, 16 Mar 2011 16:39:39 +0000"  >&lt;p&gt;Patch committed in revision 1082193.  Thanks for the contribution &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13009057" author="tboehme" created="Mon, 21 Mar 2011 08:53:04 +0000"  >&lt;p&gt;Thanks for committing however the commit is not correct. First the SPACE_BYTE must be unread before the other bytes get unread (the patched version has the SPACE_BYTE unread after). Second it would be better if the patch from my comment would be applied which handles the problem described in the comment too.&lt;/p&gt;</comment>
                            <comment id="13009196" author="adamnichols" created="Mon, 21 Mar 2011 16:24:04 +0000"  >&lt;p&gt;Committed correct patch in revision 1083857.  Thanks for the heads up.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>69412</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 35 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0zhtb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>205188</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>