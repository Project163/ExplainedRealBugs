<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 20:55:51 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PDFBOX-2091] Some characters are not rendered (font with symbol encoding)</title>
                <link>https://issues.apache.org/jira/browse/PDFBOX-2091</link>
                <project id="12310760" key="PDFBOX">PDFBox</project>
                    <description>&lt;p&gt;Some characters are not rendered (see attached PDF).&lt;br/&gt;
In this case it is &quot;yaccute&quot;.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12716093">PDFBOX-2091</key>
            <summary>Some characters are not rendered (font with symbol encoding)</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="lehmi">Andreas Lehmk&#252;hler</assignee>
                                    <reporter username="chupacabras">Juraj Lonc</reporter>
                        <labels>
                    </labels>
                <created>Thu, 22 May 2014 14:58:17 +0000</created>
                <updated>Thu, 17 Mar 2016 19:07:46 +0000</updated>
                            <resolved>Sat, 24 May 2014 12:55:42 +0000</resolved>
                                    <version>2.0.0</version>
                                    <fixVersion>2.0.0</fixVersion>
                                    <component>Rendering</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="14005983" author="chupacabras" created="Thu, 22 May 2014 15:01:53 +0000"  >&lt;p&gt;Font uses &quot;symbol encoding&quot;. In TTFGlyph2D is CMAP parsed correctly, but then it is not used in getGlyphcode(int code).&lt;/p&gt;

&lt;p&gt;I made fix for this.&lt;/p&gt;</comment>
                            <comment id="14006362" author="tilman" created="Thu, 22 May 2014 19:28:24 +0000"  >&lt;p&gt;The good news is: it passes my diff tests (graphic diff of currently 121 pdf files that made trouble in the past). Can you point me to some section of the specification? Or tell how you got the idea for this fix?&lt;/p&gt;</comment>
                            <comment id="14006364" author="chupacabras" created="Thu, 22 May 2014 19:28:34 +0000"  >&lt;p&gt;ignore that changed line &quot;if (glyphId==3) return null;&quot;&lt;br/&gt;
it is not related to this issue.&lt;/p&gt;</comment>
                            <comment id="14006378" author="chupacabras" created="Thu, 22 May 2014 19:38:43 +0000"  >&lt;p&gt;Unfortunately I cannot point you to specification.&lt;br/&gt;
I had problem with some PDF, where some characters were not drawn.&lt;br/&gt;
So I just debugged that and found out that font uses &quot;WinAnsiEncoding&quot;, but pdfbox used MacRomanEncoding which does not contain some characters that WinAnsiEncoding has.&lt;/p&gt;

&lt;p&gt;I saw that TTFGlyph2D.extractCmaps() actually extracts Win Symbol cmap, and it was pretty logical, that it should be used in TTFGlyph2D.getGlyphcode(int code)&lt;/p&gt;</comment>
                            <comment id="14006839" author="chupacabras" created="Fri, 23 May 2014 05:52:52 +0000"  >&lt;p&gt;In addition to that, I think TTFGlyph2D should take encoding value that is set in PDFont/COSObject and then use particular CMAP according to this encoding.&lt;br/&gt;
TTFGlyph2D currently doesn&apos;t care about encoding that is set in PDF.&lt;/p&gt;</comment>
                            <comment id="14006919" author="tilman" created="Fri, 23 May 2014 06:46:22 +0000"  >&lt;p&gt;I looked in the spec, it is described on page 430 in the 1.7 spec. The text is inconclusive to me. The thing that irritates me is that the branch of your change is for not-symbol fonts, yet it opens a symbol table. Per that spec, we should look in the Mac table. However the spec tells that &quot;Some popular TrueType font programs contain incorrect encoding information. Implementations of TrueType font interpreters have evolved heuristics for dealing with such problems&quot;.&lt;/p&gt;

&lt;p&gt;I have made your change in my version and let it run on more files to see what happens (and will try different flavours of the fix), and to see how often that part is used.&lt;/p&gt;</comment>
                            <comment id="14006940" author="lehmi" created="Fri, 23 May 2014 07:10:47 +0000"  >&lt;p&gt;Looks like this is another case for the &quot;who cares about the spec gallery&quot; &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;I&apos;m going to have a deeper look at the weekend. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=chupacabras&quot; class=&quot;user-hover&quot; rel=&quot;chupacabras&quot;&gt;chupacabras&lt;/a&gt; solution seems to be reasonable but I&apos;d like to double check all possible side effects first.&lt;/p&gt;</comment>
                            <comment id="14006953" author="msahyoun" created="Fri, 23 May 2014 07:43:02 +0000"  >&lt;p&gt;I quickly scanned the spec following the above comments. IMHO and as &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=chupacabras&quot; class=&quot;user-hover&quot; rel=&quot;chupacabras&quot;&gt;chupacabras&lt;/a&gt; already pointed out&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;TTFGlyph2D should first get the encoding information from PDFont and based on that information look up the correct cmap information as described in 9.6.6.4 of the ISO spec. I&#8217;d think it gives a clear outline of how to find the correct characters. If there are new issues coming up because of the &#8222;Note 1&#8220; in the spec mentioned by &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; &#8222;Some popular &#8230;&#8220; we should deal with it afterwards.&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=chupacabras&quot; class=&quot;user-hover&quot; rel=&quot;chupacabras&quot;&gt;chupacabras&lt;/a&gt; solution could be applied but after checking the encoding we need to read as described above.&lt;/li&gt;
&lt;/ol&gt;
</comment>
                            <comment id="14006969" author="lehmi" created="Fri, 23 May 2014 08:31:21 +0000"  >&lt;p&gt;Just to avoid a misunderstanding. TTFGlyph2D already uses the encoding information from PDFont&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; charactername = fontEncoding.getName(code);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The issue is the font itself. It doesn&apos;t provide the expected mapping. We have to be careful where to put the work around in such cases so that we don&apos;t introduce some not wanted side effects.&lt;/p&gt;</comment>
                            <comment id="14006989" author="msahyoun" created="Fri, 23 May 2014 09:01:32 +0000"  >&lt;p&gt;Yes, the information is read but then it&#8217;s not fully handled as described in the spec. That&#8217;s in addition to the font issue.&lt;/p&gt;</comment>
                            <comment id="14007028" author="lehmi" created="Fri, 23 May 2014 10:37:54 +0000"  >&lt;p&gt;I don&apos;t want to splits hairs, but the whole implemented in line with the spec. The issue is the font itself.&lt;/p&gt;

&lt;p&gt;Let me explain why Jurajs patch just works by accident:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;the code is mapped to the charactername by using the font encoding&lt;/li&gt;
	&lt;li&gt;the charactername is mapped to a code using the WinAnsiEncoding, in this case it&apos;s the very same as used encoding for PDFont, which leads to the effect that the first mapping is reverted&lt;/li&gt;
	&lt;li&gt;the cmapWinSymbol is used to map the code to the glyphid&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;This is the very same which is done in the branch for symbol fonts.&lt;/p&gt;

&lt;p&gt;IMHO we should detect such case and not just accidentily (the given case only works because of the coincidence that the pdf and Jurajs patch are using the same encoding) work around them. &lt;/p&gt;
</comment>
                            <comment id="14008079" author="lehmi" created="Sat, 24 May 2014 09:18:59 +0000"  >&lt;p&gt;I&apos;ve added a fallback scenario in revision 1597271. It&apos;s based on Jurajs proposal, but it works too if the PDFont encoding isn&apos;t WinAnsiEncoding. &lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; Please double check if there are any side effects.&lt;/p&gt;</comment>
                            <comment id="14008102" author="tilman" created="Sat, 24 May 2014 11:09:33 +0000"  >&lt;p&gt;No side effects! (However, the diff tests were done with the not committed null checks and more I &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-1689?focusedCommentId=14003490&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14003490&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;mentioned&lt;/a&gt; in &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-1689&quot; title=&quot;Partial failure to render PDF&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-1689&quot;&gt;&lt;del&gt;PDFBOX-1689&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="14008112" author="lehmi" created="Sat, 24 May 2014 12:55:42 +0000"  >&lt;p&gt;Thanks Tilman, that&apos;s good enough for me. &lt;/p&gt;

&lt;p&gt;Thanks for the input! Set to resolved&lt;/p&gt;</comment>
                            <comment id="14114184" author="jira-bot" created="Thu, 28 Aug 2014 19:09:02 +0000"  >&lt;p&gt;Commit 1621184 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jahewson&quot; class=&quot;user-hover&quot; rel=&quot;jahewson&quot;&gt;jahewson&lt;/a&gt; in branch &apos;pdfbox/branches/no-awt&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1621184&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1621184&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2262&quot; title=&quot;Remove usage of AWT fonts&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2262&quot;&gt;&lt;del&gt;PDFBOX-2262&lt;/del&gt;&lt;/a&gt;/&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2091&quot; title=&quot;Some characters are not rendered (font with symbol encoding)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2091&quot;&gt;&lt;del&gt;PDFBOX-2091&lt;/del&gt;&lt;/a&gt;: Fallback to &apos;post&apos; table for nonsymbolic TTFs&lt;/p&gt;</comment>
                            <comment id="14114186" author="jahewson" created="Thu, 28 Aug 2014 19:09:11 +0000"  >&lt;p&gt;I&apos;ve just fixed this issue again as part of &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2262&quot; title=&quot;Remove usage of AWT fonts&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2262&quot;&gt;&lt;del&gt;PDFBOX-2262&lt;/del&gt;&lt;/a&gt;. The conversation above is mostly incorrect, this file is a valid PDF and rendering it follows the spec exactly. The font &lt;em&gt;does&lt;/em&gt; contain the character mappings, but not in its (3,1) or (1,0) &quot;cmap&quot; tables, instead the PostScript names for glyphs are contained in the &quot;post&quot; table. The PDF spec describes exactly what to do in the fallback situation for nonsymbolic fonts:&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;PDF 32000, p266:&lt;br/&gt;
In any of these cases, if the glyph name cannot be mapped as specified, the glyph name shall be looked up in the font program&#8217;s &#8220;post&#8221; table (if one is present) and the associated glyph description shall be used. &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I&apos;ve removed the existing workaround of using the (3, 0) table and replaced it with the mechanism described in the spec.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12646307" name="PDFBOX-2091_TTFGlyph2D.diff" size="1233" author="chupacabras" created="Thu, 22 May 2014 15:01:53 +0000"/>
                            <attachment id="12646305" name="missing_yaccute.pdf" size="208270" author="chupacabras" created="Thu, 22 May 2014 14:59:01 +0000"/>
                            <attachment id="12646306" name="output.png" size="11829" author="chupacabras" created="Thu, 22 May 2014 14:59:01 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>394302</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 12 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1vw3r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>394440</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>