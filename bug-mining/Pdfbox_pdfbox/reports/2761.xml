<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:13:21 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PDFBOX-5540] export:text creates jibberish / malformed output</title>
                <link>https://issues.apache.org/jira/browse/PDFBOX-5540</link>
                <project id="12310760" key="PDFBOX">PDFBox</project>
                    <description>&lt;p&gt;Using PDFBox as part of Tika and having issues with some PDFs outputting unreadable content. Copying text from Adobe / macOS Preview / Browsers works as expected.&lt;/p&gt;

&lt;p&gt;I have also tried &quot;re-encoding&quot; the PDF by editing and saving it with Acrobat, thinking it could be an issue with their original PDF creator and using pdfbox with different encodings, but output mostly remained unchanged.&lt;/p&gt;

&lt;p&gt;I attached the PDF and text it produces. Running it PDFBox via CLI as follows:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
root % java -jar pdfbox-app-3.0.0-alpha3.jar export:text -i test.pdf&#160; &#160; &#160; &#160; &#160; 
Nov 06, 2022 9:12:47 PM org.apache.pdfbox.pdmodel.font.PDFont loadUnicodeCmap
WARNUNG: Invalid ToUnicode CMap in font&#160;
Nov 06, 2022 9:12:47 PM org.apache.pdfbox.pdmodel.font.PDFont loadUnicodeCmap
WARNUNG: Using predefined identity CMap instead
Nov 06, 2022 9:12:47 PM org.apache.pdfbox.pdmodel.font.PDFont loadUnicodeCmap
WARNUNG: Invalid ToUnicode CMap in font&#160;
Nov 06, 2022 9:12:47 PM org.apache.pdfbox.pdmodel.font.PDFont loadUnicodeCmap
WARNUNG: Using predefined identity CMap instead
Nov 06, 2022 9:12:47 PM org.apache.pdfbox.pdmodel.font.PDFont loadUnicodeCmap
WARNUNG: Invalid ToUnicode CMap in font&#160;
Nov 06, 2022 9:12:47 PM org.apache.pdfbox.pdmodel.font.PDFont loadUnicodeCmap
WARNUNG: Using predefined identity CMap instead
Nov 06, 2022 9:12:47 PM org.apache.pdfbox.pdmodel.font.PDFont loadUnicodeCmap
WARNUNG: Invalid ToUnicode CMap in font&#160;
Nov 06, 2022 9:12:47 PM org.apache.pdfbox.pdmodel.font.PDFont loadUnicodeCmap
WARNUNG: Using predefined identity CMap instead &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment>Same on Windows, Linux and macOS</environment>
        <key id="13497678">PDFBOX-5540</key>
            <summary>export:text creates jibberish / malformed output</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tilman">Tilman Hausherr</assignee>
                                    <reporter username="alfons">Alfons</reporter>
                        <labels>
                            <label>regression</label>
                    </labels>
                <created>Sun, 6 Nov 2022 20:19:56 +0000</created>
                <updated>Thu, 13 Apr 2023 14:54:27 +0000</updated>
                            <resolved>Sat, 12 Nov 2022 03:53:29 +0000</resolved>
                                    <version>2.0.16</version>
                    <version>2.0.27</version>
                    <version>3.0.0 PDFBox</version>
                                    <fixVersion>2.0.28</fixVersion>
                    <fixVersion>3.0.0 PDFBox</fixVersion>
                                    <component>Text extraction</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="17631240" author="tilman" created="Wed, 9 Nov 2022 19:25:59 +0000"  >&lt;p&gt;It worked with 2.0.15 and stopped working with 2.0.16. It&apos;s likely connected to workarounds related to broken /ToUnicode streams.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Release notes of 2.0.16:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ReleaseNote.jspa?projectId=12310760&amp;amp;version=12345355&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/ReleaseNote.jspa?projectId=12310760&amp;amp;version=12345355&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Probable issue is &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4550&quot; title=&quot;Poor performance with corrupt ToUnicode stream&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4550&quot;&gt;&lt;del&gt;PDFBOX-4550&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;I tried to disable the (now very complex) workaround in &lt;tt&gt;PDFont.loadUnicodeCmap()&lt;/tt&gt; and then it works, so I guess that one has to be fine-tuned once again.&lt;/p&gt;</comment>
                            <comment id="17631841" author="tilman" created="Thu, 10 Nov 2022 18:20:08 +0000"  >&lt;p&gt;proposed change, speculates that if there is an encoding with differences then the workaround shouldn&apos;t be used&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (cmapName.contains(&lt;span class=&quot;code-quote&quot;&gt;&quot;Identity&quot;&lt;/span&gt;) &lt;span class=&quot;code-comment&quot;&gt;//
&lt;/span&gt;&#160; &#160; &#160; &#160; || ordering.contains(&lt;span class=&quot;code-quote&quot;&gt;&quot;Identity&quot;&lt;/span&gt;) &lt;span class=&quot;code-comment&quot;&gt;//
&lt;/span&gt;&#160; &#160; &#160; &#160; || COSName.IDENTITY_H.equals(encoding) &lt;span class=&quot;code-comment&quot;&gt;//
&lt;/span&gt;&#160; &#160; &#160; &#160; || COSName.IDENTITY_V.equals(encoding))
{
&#160; &#160; COSDictionary encodingDict = dict.getCOSDictionary(COSName.ENCODING);
&#160; &#160; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (encodingDict == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; || !encodingDict.containsKey(COSName.DIFFERENCES))
&#160; &#160; {
&#160; &#160; &#160; &#160; &lt;span class=&quot;code-comment&quot;&gt;// assume that &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; encoding is identity, then the reverse is also &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
&lt;/span&gt;&#160; &#160; &#160; &#160; cmap = CMapManager.getPredefinedCMap(COSName.IDENTITY_H.getName());
&#160; &#160; &#160; &#160; LOG.warn(&lt;span class=&quot;code-quote&quot;&gt;&quot;Using predefined identity CMap instead&quot;&lt;/span&gt;);
&#160; &#160; }
} &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17632114" author="lehmi" created="Fri, 11 Nov 2022 07:08:34 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; Sounds good to me. Give it a try and let us see if there are any side effects.&lt;/p&gt;</comment>
                            <comment id="17632529" author="jira-bot" created="Fri, 11 Nov 2022 19:07:31 +0000"  >&lt;p&gt;Commit 1905244 from Tilman Hausherr in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1905244&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1905244&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-5540&quot; title=&quot;export:text creates jibberish / malformed output&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-5540&quot;&gt;&lt;del&gt;PDFBOX-5540&lt;/del&gt;&lt;/a&gt;: if there is an encoding with differences then the workaround shouldn&apos;t be used&lt;/p&gt;</comment>
                            <comment id="17632530" author="jira-bot" created="Fri, 11 Nov 2022 19:07:35 +0000"  >&lt;p&gt;Commit 1905245 from Tilman Hausherr in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1905245&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1905245&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-5540&quot; title=&quot;export:text creates jibberish / malformed output&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-5540&quot;&gt;&lt;del&gt;PDFBOX-5540&lt;/del&gt;&lt;/a&gt;: if there is an encoding with differences then the workaround shouldn&apos;t be used&lt;/p&gt;</comment>
                            <comment id="17632531" author="tilman" created="Fri, 11 Nov 2022 19:10:48 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lehmi&quot; class=&quot;user-hover&quot; rel=&quot;lehmi&quot;&gt;lehmi&lt;/a&gt;. We&apos;ll see in the big regression test if this brings any surprises.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=alfons&quot; class=&quot;user-hover&quot; rel=&quot;alfons&quot;&gt;alfons&lt;/a&gt; here&apos;s a new extract: &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/13052124/13052124_PDFBOX-5540.pdf.txt&quot; title=&quot;PDFBOX-5540.pdf.txt attached to PDFBOX-5540&quot;&gt;PDFBOX-5540.pdf.txt&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt; &lt;/p&gt;</comment>
                            <comment id="17635337" author="tallison@mitre.org" created="Thu, 17 Nov 2022 12:37:48 +0000"  >&lt;p&gt;Should I kick that off now?&lt;/p&gt;</comment>
                            <comment id="17635509" author="tilman" created="Thu, 17 Nov 2022 19:15:40 +0000"  >&lt;p&gt;No unless you have free time, because we&apos;d still need another test before release.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="13052124" name="PDFBOX-5540.pdf.txt" size="1400" author="tilman" created="Fri, 11 Nov 2022 19:10:42 +0000"/>
                            <attachment id="13051843" name="test.pdf" size="161135" author="alfons" created="Sun, 6 Nov 2022 20:13:01 +0000"/>
                            <attachment id="13051844" name="test.txt" size="1379" author="alfons" created="Sun, 6 Nov 2022 20:13:01 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 51 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1bbcg:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>