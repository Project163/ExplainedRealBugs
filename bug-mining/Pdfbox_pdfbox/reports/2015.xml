<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:07:50 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PDFBOX-4308] PDDocument protect changes color palette</title>
                <link>https://issues.apache.org/jira/browse/PDFBOX-4308</link>
                <project id="12310760" key="PDFBOX">PDFBox</project>
                    <description>&lt;p&gt;When applying protection to a PDF the resulting PDF shows weird background colors.&lt;/p&gt;

&lt;p&gt;The following minimal sample program produces the observed behaviour in attached PDF &quot;Zieldatei-mit-Schutz.pdf&quot;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt; protecttest;

&lt;span class=&quot;code-comment&quot;&gt;// $ java -version
&lt;/span&gt;&lt;span class=&quot;code-comment&quot;&gt;// openjdk version &lt;span class=&quot;code-quote&quot;&gt;&quot;1.8.0_181&quot;&lt;/span&gt;
&lt;/span&gt;&lt;span class=&quot;code-comment&quot;&gt;// OpenJDK &lt;span class=&quot;code-object&quot;&gt;Runtime&lt;/span&gt; Environment (build 1.8.0_181-8u181-b13-0ubuntu0.18.04.1-b13)
&lt;/span&gt;&lt;span class=&quot;code-comment&quot;&gt;// OpenJDK 64-Bit Server VM (build 25.181-b13, mixed mode)
&lt;/span&gt;
&lt;span class=&quot;code-comment&quot;&gt;// compile with
&lt;/span&gt;&lt;span class=&quot;code-comment&quot;&gt;// javac -cp pdfbox-2.0.11.jar protecttest/PdfProtector.java
&lt;/span&gt;
&lt;span class=&quot;code-comment&quot;&gt;// execute with
&lt;/span&gt;&lt;span class=&quot;code-comment&quot;&gt;// java -cp pdfbox-2.0.11.jar:commons-logging-1.1.3.jar:. protecttest.PdfProtector
&lt;/span&gt;

&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; java.io.File;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.pdfbox.pdmodel.PDDocument;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.pdfbox.pdmodel.encryption.AccessPermission;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.pdfbox.pdmodel.encryption.StandardProtectionPolicy;

&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;PdfProtector {
&#160;&#160;&#160; &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void main(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] args) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {
&#160;&#160; &#160;&lt;span class=&quot;code-comment&quot;&gt;// load and save with no protection
&lt;/span&gt;&#160;&#160; &#160;PDDocument d1 = PDDocument.load(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; File(&lt;span class=&quot;code-quote&quot;&gt;&quot;Quelldatei.pdf&quot;&lt;/span&gt;));
&#160;&#160; &#160;d1.save(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; File(&lt;span class=&quot;code-quote&quot;&gt;&quot;Zieldatei-ohne-Schutz.pdf&quot;&lt;/span&gt;));
&#160;&#160; &#160;d1.close();
&#160;&#160; &#160;&lt;span class=&quot;code-comment&quot;&gt;// everything seems fine with the resulting PDF
&lt;/span&gt;
&#160;&#160; &#160;&lt;span class=&quot;code-comment&quot;&gt;// load and save with protection
&lt;/span&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160; PDDocument d2 = PDDocument.load(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; File(&lt;span class=&quot;code-quote&quot;&gt;&quot;Quelldatei.pdf&quot;&lt;/span&gt;));
&#160;&#160; &#160;AccessPermission ap = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; AccessPermission();
&#160;&#160; &#160;ap.setCanAssembleDocument(&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;);
&#160;&#160; &#160;ap.setCanModify(&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;);
&#160;&#160; &#160;d2.protect(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; StandardProtectionPolicy(&lt;span class=&quot;code-quote&quot;&gt;&quot;foobar&quot;&lt;/span&gt;,&quot;&quot;,ap));
&#160;&#160; &#160;d2.save(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; File(&lt;span class=&quot;code-quote&quot;&gt;&quot;Zieldatei-mit-Schutz.pdf&quot;&lt;/span&gt;));
&#160;&#160; &#160;d2.close();
&#160;&#160; &#160;&lt;span class=&quot;code-comment&quot;&gt;// resulting file is rendered with odd colors
&lt;/span&gt;&#160;&#160;&#160; }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13182569">PDFBOX-4308</key>
            <summary>PDDocument protect changes color palette</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tilman">Tilman Hausherr</assignee>
                                    <reporter username="friemen">Falko Riemenschneider</reporter>
                        <labels>
                    </labels>
                <created>Mon, 3 Sep 2018 06:40:29 +0000</created>
                <updated>Fri, 5 Oct 2018 04:53:34 +0000</updated>
                            <resolved>Mon, 3 Sep 2018 19:17:40 +0000</resolved>
                                    <version>2.0.11</version>
                                    <fixVersion>2.0.12</fixVersion>
                    <fixVersion>3.0.0 PDFBox</fixVersion>
                                    <component>Writing</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="16602292" author="jira-bot" created="Mon, 3 Sep 2018 15:54:05 +0000"  >&lt;p&gt;Commit 1839972 from tilman@apache.org in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1839972&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1839972&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4308&quot; title=&quot;PDDocument protect changes color palette&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4308&quot;&gt;&lt;del&gt;PDFBOX-4308&lt;/del&gt;&lt;/a&gt;: prevent object that is referenced several times from being written direct and indirect, thus getting encrypted with wrong object number or getting encrypted twice&lt;/p&gt;</comment>
                            <comment id="16602293" author="jira-bot" created="Mon, 3 Sep 2018 15:54:14 +0000"  >&lt;p&gt;Commit 1839973 from tilman@apache.org in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1839973&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1839973&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4308&quot; title=&quot;PDDocument protect changes color palette&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4308&quot;&gt;&lt;del&gt;PDFBOX-4308&lt;/del&gt;&lt;/a&gt;: prevent object that is referenced several times from being written direct and indirect, thus getting encrypted with wrong object number or getting encrypted twice&lt;/p&gt;</comment>
                            <comment id="16602300" author="tilman" created="Mon, 3 Sep 2018 15:59:00 +0000"  >&lt;p&gt;That was a nasty one&#8230; until I noticed that the object number in the PDF wasn&apos;t the same than the one in &lt;tt&gt;COSWriter.visitFromString&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;Todo next: I&apos;ll create a test based on your file.&lt;/p&gt;

&lt;p&gt;There will be a snapshot available within the next few hours at&lt;br/&gt;
&lt;a href=&quot;https://repository.apache.org/content/groups/snapshots/org/apache/pdfbox/pdfbox-app/2.0.12-SNAPSHOT/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://repository.apache.org/content/groups/snapshots/org/apache/pdfbox/pdfbox-app/2.0.12-SNAPSHOT/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16602391" author="jira-bot" created="Mon, 3 Sep 2018 18:38:13 +0000"  >&lt;p&gt;Commit 1839978 from tilman@apache.org in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1839978&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1839978&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4308&quot; title=&quot;PDDocument protect changes color palette&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4308&quot;&gt;&lt;del&gt;PDFBOX-4308&lt;/del&gt;&lt;/a&gt;: load test file&lt;/p&gt;</comment>
                            <comment id="16602392" author="jira-bot" created="Mon, 3 Sep 2018 18:38:18 +0000"  >&lt;p&gt;Commit 1839979 from tilman@apache.org in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1839979&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1839979&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4308&quot; title=&quot;PDDocument protect changes color palette&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4308&quot;&gt;&lt;del&gt;PDFBOX-4308&lt;/del&gt;&lt;/a&gt;: load test file&lt;/p&gt;</comment>
                            <comment id="16602394" author="jira-bot" created="Mon, 3 Sep 2018 18:40:03 +0000"  >&lt;p&gt;Commit 1839980 from tilman@apache.org in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1839980&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1839980&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4308&quot; title=&quot;PDDocument protect changes color palette&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4308&quot;&gt;&lt;del&gt;PDFBOX-4308&lt;/del&gt;&lt;/a&gt;: add test&lt;/p&gt;</comment>
                            <comment id="16602395" author="jira-bot" created="Mon, 3 Sep 2018 18:40:09 +0000"  >&lt;p&gt;Commit 1839981 from tilman@apache.org in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1839981&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1839981&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4308&quot; title=&quot;PDDocument protect changes color palette&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4308&quot;&gt;&lt;del&gt;PDFBOX-4308&lt;/del&gt;&lt;/a&gt;: add test&lt;/p&gt;</comment>
                            <comment id="16602411" author="tilman" created="Mon, 3 Sep 2018 19:17:40 +0000"  >&lt;p&gt;Setting to resolved. Thanks for reporting this nasty bug!&lt;/p&gt;</comment>
                            <comment id="16602939" author="friemen" created="Tue, 4 Sep 2018 11:40:19 +0000"  >&lt;p&gt;I tried the 2.0.12-SNAPSHOT and it works just fine.&lt;/p&gt;

&lt;p&gt;Thanks for fixing this so fast!&lt;/p&gt;</comment>
                            <comment id="16603524" author="jira-bot" created="Tue, 4 Sep 2018 20:05:57 +0000"  >&lt;p&gt;Commit 1840060 from tilman@apache.org in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1840060&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1840060&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4308&quot; title=&quot;PDDocument protect changes color palette&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4308&quot;&gt;&lt;del&gt;PDFBOX-4308&lt;/del&gt;&lt;/a&gt;: improve comment that describes the file and what happened&lt;/p&gt;</comment>
                            <comment id="16603525" author="jira-bot" created="Tue, 4 Sep 2018 20:06:03 +0000"  >&lt;p&gt;Commit 1840061 from tilman@apache.org in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1840061&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1840061&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4308&quot; title=&quot;PDDocument protect changes color palette&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4308&quot;&gt;&lt;del&gt;PDFBOX-4308&lt;/del&gt;&lt;/a&gt;: improve comment that describes the file and what happened&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12938094" name="Quelldatei.pdf" size="655849" author="friemen" created="Mon, 3 Sep 2018 06:40:48 +0000"/>
                            <attachment id="12938095" name="Zieldatei-mit-Schutz.pdf" size="658161" author="friemen" created="Mon, 3 Sep 2018 06:40:48 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 10 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3xnz3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>