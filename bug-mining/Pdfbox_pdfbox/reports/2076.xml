<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:08:16 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PDFBOX-4391] Page to image rendering in pdfbox 2.0: Poor quality compared to 1.8</title>
                <link>https://issues.apache.org/jira/browse/PDFBOX-4391</link>
                <project id="12310760" key="PDFBOX">PDFBox</project>
                    <description>&lt;p&gt;I have a process that needs to convert pages of pdf files to images to be able to detect barcodes.&lt;/p&gt;

&lt;p&gt;Since I&apos;ve upgrade to pdfbox 2.0 my barcodes are not correctly detected anymore.&lt;/p&gt;

&lt;p&gt;I noticed the cause was the result of the page to image rendering implemented in pdfbox 2.0.&lt;/p&gt;

&lt;p&gt;The quality of the image is really poor compared to pdfbox 1.8.&lt;/p&gt;

&lt;p&gt;See the attached image (comparison.png):&lt;br/&gt;
On the left you have the image generated with pdfbox 2.0.13&lt;br/&gt;
On the right you have the image generated with pdfbox 1.8.16&lt;br/&gt;
We can clearly see the difference.&lt;/p&gt;

&lt;p&gt;Both images were generated using the same resolution (200 dpi here):&lt;/p&gt;

&lt;p&gt;For 2.0.13:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
BufferedImage image = pdfRenderer.renderImageWithDPI(0, 200, ImageType.BINARY);&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;For 1.8.16:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
PDPage page = (PDPage) pdfDocument.getDocumentCatalog().getAllPages().get(0);
BufferedImage image = page.convertToImage(BufferedImage.TYPE_BYTE_BINARY, 200);&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Buffered images were both written to files using:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
ImageIO.write(image, &lt;span class=&quot;code-quote&quot;&gt;&quot;png&quot;&lt;/span&gt;, file);&#160;&#160; &#160;&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I&apos;ve attached the pdf file (barcode-128.pdf) and the generated images (barcode-image-2.0.13.png and barcode-image.1.8.16.png)&lt;/p&gt;





&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment>Windows 10&lt;br/&gt;
JDK 1.8.0_181&lt;br/&gt;
JDK 1.8.0_192</environment>
        <key id="13201957">PDFBOX-4391</key>
            <summary>Page to image rendering in pdfbox 2.0: Poor quality compared to 1.8</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tilman">Tilman Hausherr</assignee>
                                    <reporter username="maol">Olivier Masseau</reporter>
                        <labels>
                            <label>antialias</label>
                            <label>barcode</label>
                            <label>image</label>
                            <label>quality</label>
                    </labels>
                <created>Mon, 3 Dec 2018 10:46:00 +0000</created>
                <updated>Thu, 28 Feb 2019 17:45:00 +0000</updated>
                            <resolved>Mon, 3 Dec 2018 17:48:30 +0000</resolved>
                                    <version>2.0.13</version>
                                    <fixVersion>2.0.14</fixVersion>
                                    <component>Rendering</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="16707124" author="tilman" created="Mon, 3 Dec 2018 12:34:01 +0000"  >&lt;p&gt;It is the antialiasing. I&apos;m wondering whether we should switch it off for bitonal images. It makes no sense there.&lt;/p&gt;</comment>
                            <comment id="16707175" author="tilman" created="Mon, 3 Dec 2018 13:04:55 +0000"  >&lt;p&gt;Could you please test your barcode reader with the file I just uploaded? That one is with antialiasing off.&lt;/p&gt;</comment>
                            <comment id="16707188" author="maol" created="Mon, 3 Dec 2018 13:20:04 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; , thanks for looking at the problem.&lt;/p&gt;

&lt;p&gt;The barcode can be read perfectly with the &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12950402/12950402_barcode-128-BW-antialiasing-off.png&quot; title=&quot;barcode-128-BW-antialiasing-off.png attached to PDFBOX-4391&quot;&gt;barcode-128-BW-antialiasing-off.png&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt; file you uploaded.&lt;/p&gt;</comment>
                            <comment id="16707265" author="jira-bot" created="Mon, 3 Dec 2018 14:22:51 +0000"  >&lt;p&gt;Commit 1848043 from tilman@apache.org in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1848043&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1848043&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4391&quot; title=&quot;Page to image rendering in pdfbox 2.0: Poor quality compared to 1.8&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4391&quot;&gt;&lt;del&gt;PDFBOX-4391&lt;/del&gt;&lt;/a&gt;: switch off antialiasing when rendering on single color device because wrong rendering of barcodes&lt;/p&gt;</comment>
                            <comment id="16707266" author="jira-bot" created="Mon, 3 Dec 2018 14:22:55 +0000"  >&lt;p&gt;Commit 1848044 from tilman@apache.org in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1848044&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1848044&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4391&quot; title=&quot;Page to image rendering in pdfbox 2.0: Poor quality compared to 1.8&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4391&quot;&gt;&lt;del&gt;PDFBOX-4391&lt;/del&gt;&lt;/a&gt;: switch off antialiasing when rendering on single color device because wrong rendering of barcodes&lt;/p&gt;</comment>
                            <comment id="16707484" author="tilman" created="Mon, 3 Dec 2018 16:29:15 +0000"  >&lt;p&gt;Thank you for the feedback. A snapshot is available here:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://repository.apache.org/content/groups/snapshots/org/apache/pdfbox/pdfbox-app/2.0.14-SNAPSHOT/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://repository.apache.org/content/groups/snapshots/org/apache/pdfbox/pdfbox-app/2.0.14-SNAPSHOT/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Because we just released 2.0.13, it will take a few months before the change will be released.&lt;/p&gt;</comment>
                            <comment id="16707498" author="tilman" created="Mon, 3 Dec 2018 16:39:19 +0000"  >&lt;p&gt;I was also thinking about disabling antialiasing for horizontal/vertical lines (because we already disable antialiasing for rectangles) when rendering in color. But I decided against it because&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;when using this logic for all widths, then it looks weird when a line is not antialiased but the glyphs are (test file 1822-AGB.pdf, page 4)&lt;/li&gt;
	&lt;li&gt;when using this logic for widths &amp;gt; 1, the lines in your barcode end up having different lengths&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;I am including the now deleted code here just for documentation&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void strokePath() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException
    {
        graphics.setComposite(getGraphicsState().getStrokingJavaComposite());
        graphics.setPaint(getStrokingPaint());
        BasicStroke stroke = getStroke();
        graphics.setStroke(stroke);

        &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; noAntiAlias = stroke.getEndCap() != BasicStroke.CAP_ROUND &amp;amp;&amp;amp;
                              stroke.getLineWidth() &amp;gt; 1 &amp;amp;&amp;amp;
                              isHorizontalOrVerticalLine(linePath);
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (noAntiAlias)
        {
            graphics.setRenderingHint(RenderingHints.KEY_ANTIALIASING,
                                      RenderingHints.VALUE_ANTIALIAS_OFF);
        }

        setClip();
        &lt;span class=&quot;code-comment&quot;&gt;//TODO bbox of shading pattern should be used here? (see fillPath)
&lt;/span&gt;        graphics.draw(linePath);
        linePath.reset();

        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (noAntiAlias)
        {
            &lt;span class=&quot;code-comment&quot;&gt;// JDK 1.7 has a bug where rendering hints are reset by the above call to
&lt;/span&gt;            &lt;span class=&quot;code-comment&quot;&gt;// the setRenderingHint method, so we re-set all hints, see PDFBOX-2302
&lt;/span&gt;            setRenderingHints();
        }
    }


    &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; isHorizontalOrVerticalLine(GeneralPath path)
    {
        PathIterator iter = path.getPathIterator(&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;);
        &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;[] coords = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;[6];
        &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; count = 0;
        &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;[] xs = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;[2];
        &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;[] ys = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;[2];
        &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; (!iter.isDone())
        {
            &lt;span class=&quot;code-keyword&quot;&gt;switch&lt;/span&gt;(iter.currentSegment(coords))
            {
                &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt; PathIterator.SEG_MOVETO:
                    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (count == 0)
                    {
                        xs[count] = coords[0];
                        ys[count] = coords[1];
                    }
                    &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt;
                    {
                        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;;
                    }
                    count++;
                    &lt;span class=&quot;code-keyword&quot;&gt;break&lt;/span&gt;;

                &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt; PathIterator.SEG_LINETO:
                    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (count == 1)
                    {
                        xs[count] = coords[0];
                        ys[count] = coords[1];
                    }
                    &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt;
                    {
                        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;;
                    }
                    count++;
                    &lt;span class=&quot;code-keyword&quot;&gt;break&lt;/span&gt;;

                &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt; PathIterator.SEG_CUBICTO:
                    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;;

                &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt; PathIterator.SEG_CLOSE:
                    &lt;span class=&quot;code-keyword&quot;&gt;break&lt;/span&gt;;
            }
            iter.next();
        }

        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (count == 2)
        {
            &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; xs[0] == xs[1] || ys[0] == ys[1];
        }
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;;
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="16707590" author="tilman" created="Mon, 3 Dec 2018 17:48:30 +0000"  >&lt;p&gt;Setting to resolved. Thanks for the report!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12950402" name="barcode-128-BW-antialiasing-off.png" size="10412" author="tilman" created="Mon, 3 Dec 2018 13:04:06 +0000"/>
                            <attachment id="12950368" name="barcode-128.pdf" size="15103" author="maol" created="Mon, 3 Dec 2018 10:44:42 +0000"/>
                            <attachment id="12950367" name="barcode-image-1.8.16.png" size="10053" author="maol" created="Mon, 3 Dec 2018 10:44:42 +0000"/>
                            <attachment id="12950366" name="barcode-image-2.0.13.png" size="9844" author="maol" created="Mon, 3 Dec 2018 10:44:42 +0000"/>
                            <attachment id="12950365" name="comparison.png" size="23108" author="maol" created="Mon, 3 Dec 2018 10:44:42 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 49 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|s013lk:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>