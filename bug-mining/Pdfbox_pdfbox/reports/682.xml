<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 20:57:08 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PDFBOX-2225] ClassCastException in PDFMergerUtility.appendDocument</title>
                <link>https://issues.apache.org/jira/browse/PDFBOX-2225</link>
                <project id="12310760" key="PDFBOX">PDFBox</project>
                    <description>&lt;p&gt;Edit: Problem confirmed to exist in 1.8.1 and 1.8.6&lt;/p&gt;

&lt;p&gt;The following exception will occur if any type of Exception other than IOException is thrown within a particular try-catch in PDFMergerUtility.appendDocument:&lt;/p&gt;

&lt;p&gt;java.lang.ClassCastException: java.lang.IndexOutOfBoundsException cannot be cast to java.io.IOException&lt;/p&gt;

&lt;p&gt;For the version I am using (1.8.1), the problem occurs on line 294&lt;/p&gt;

&lt;p&gt;The problem is that the author mistakenly assumed that the only exception which could be caught was IOException. I recommend that the cast be removed, and that either the additional checked exceptions be thrown by appendDocument or wrapped with an unchecked exception&lt;/p&gt;

&lt;p&gt;Also, anyone seeing this may want to investigate why an IndexOutOfBoundsException is occurring here, though this is obviously a separate issue&lt;/p&gt;</description>
                <environment>Windows 7 64-bit, JDK8</environment>
        <key id="12728230">PDFBOX-2225</key>
            <summary>ClassCastException in PDFMergerUtility.appendDocument</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="Etherous">Brandon Lyon</reporter>
                        <labels>
                    </labels>
                <created>Fri, 18 Jul 2014 16:16:05 +0000</created>
                <updated>Fri, 19 Sep 2014 14:40:43 +0000</updated>
                            <resolved>Mon, 1 Sep 2014 17:02:56 +0000</resolved>
                                    <version>1.8.1</version>
                    <version>1.8.6</version>
                    <version>1.8.7</version>
                    <version>2.0.0</version>
                                    <fixVersion>1.8.7</fixVersion>
                    <fixVersion>2.0.0</fixVersion>
                                    <component>Utilities</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="14066525" author="tilman" created="Fri, 18 Jul 2014 17:00:20 +0000"  >&lt;p&gt;You should try whatever you&apos;re doing with the current version (1.8.6). If there&apos;s still an exception, please include the full stack trace and the PDFs.&lt;/p&gt;</comment>
                            <comment id="14066627" author="etherous" created="Fri, 18 Jul 2014 17:53:27 +0000"  >&lt;p&gt;Replaced jars with latest version. Problem persists. I would include the PDFs, but they&apos;re being generated dynamically, and I&apos;m probably not at liberty to do so anyways. Suffice it to say, they are each two-pages, have several form elements (all text), and are identical except for the values of the fields. Here&apos;s part of the stack-trace (irrelevant data removed):&lt;/p&gt;

&lt;p&gt;2014-07-18 11:18:39,159 ERROR &lt;span class=&quot;error&quot;&gt;&amp;#91;io.undertow.servlet&amp;#93;&lt;/span&gt; (default task-12) ares.web.DocumentServlet: Ares Servlet: Uncaught exception: : java.lang.ClassCastException: java.lang.IndexOutOfBoundsException cannot be cast to java.io.IOException&lt;br/&gt;
	at org.apache.pdfbox.util.PDFMergerUtility.appendDocument(PDFMergerUtility.java:347) &lt;span class=&quot;error&quot;&gt;&amp;#91;pdfbox-1.8.6.jar:&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.apache.pdfbox.util.PDFMergerUtility.mergeDocuments(PDFMergerUtility.java:240) &lt;span class=&quot;error&quot;&gt;&amp;#91;pdfbox-1.8.6.jar:&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.apache.pdfbox.util.PDFMergerUtility.mergeDocuments(PDFMergerUtility.java:185) &lt;span class=&quot;error&quot;&gt;&amp;#91;pdfbox-1.8.6.jar:&amp;#93;&lt;/span&gt;&lt;br/&gt;
        ... (additional trace data is irrelevant)&lt;/p&gt;</comment>
                            <comment id="14066636" author="etherous" created="Fri, 18 Jul 2014 17:59:16 +0000"  >&lt;p&gt;I forgot to mention. It only occurs when I try to merge a decent number of documents (at least 10). Also, another IndexOutOfBoundsException occurs elsewhere, though it may be unrelated:&lt;/p&gt;

&lt;p&gt;Caused by: java.lang.IndexOutOfBoundsException: Index: 145, Size: 145&lt;br/&gt;
	at java.util.ArrayList.rangeCheck(ArrayList.java:638) &lt;span class=&quot;error&quot;&gt;&amp;#91;rt.jar:1.8.0_05&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at java.util.ArrayList.get(ArrayList.java:414) &lt;span class=&quot;error&quot;&gt;&amp;#91;rt.jar:1.8.0_05&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.apache.pdfbox.io.RandomAccessBuffer.seek(RandomAccessBuffer.java:110) &lt;span class=&quot;error&quot;&gt;&amp;#91;pdfbox-1.8.6.jar:&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.apache.pdfbox.io.RandomAccessFileOutputStream.write(RandomAccessFileOutputStream.java:106) &lt;span class=&quot;error&quot;&gt;&amp;#91;pdfbox-1.8.6.jar:&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at java.io.BufferedOutputStream.flushBuffer(BufferedOutputStream.java:82) &lt;span class=&quot;error&quot;&gt;&amp;#91;rt.jar:1.8.0_05&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at java.io.BufferedOutputStream.flush(BufferedOutputStream.java:140) &lt;span class=&quot;error&quot;&gt;&amp;#91;rt.jar:1.8.0_05&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at java.io.FilterOutputStream.close(FilterOutputStream.java:158) &lt;span class=&quot;error&quot;&gt;&amp;#91;rt.jar:1.8.0_05&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.apache.pdfbox.pdfparser.BaseParser.parseCOSStream(BaseParser.java:634) &lt;span class=&quot;error&quot;&gt;&amp;#91;pdfbox-1.8.6.jar:&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.apache.pdfbox.pdfparser.PDFParser.parseObject(PDFParser.java:609) &lt;span class=&quot;error&quot;&gt;&amp;#91;pdfbox-1.8.6.jar:&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.apache.pdfbox.pdfparser.PDFParser.parse(PDFParser.java:194) &lt;span class=&quot;error&quot;&gt;&amp;#91;pdfbox-1.8.6.jar:&amp;#93;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;This is occuring at: at ares.document.MergedPdfDocument.mergeDocuments(MergedPdfDocument.java:191) &lt;span class=&quot;error&quot;&gt;&amp;#91;classes:&amp;#93;&lt;/span&gt;&lt;/p&gt;</comment>
                            <comment id="14066657" author="etherous" created="Fri, 18 Jul 2014 18:10:56 +0000"  >&lt;p&gt;Since this is apparently 2 separate issues, I created a separate issue for the other: &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2226&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/PDFBOX-2226&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14066661" author="etherous" created="Fri, 18 Jul 2014 18:13:14 +0000"  >&lt;p&gt;Possibly caused by. Mentioned in this issue&apos;s comments&lt;/p&gt;</comment>
                            <comment id="14066787" author="tilman" created="Fri, 18 Jul 2014 19:45:57 +0000"  >&lt;p&gt;This is indeed a weird piece of code. Would this make more sense?&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;        &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (Exception e)
        {
            &lt;span class=&quot;code-comment&quot;&gt;// &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; we are not ignoring exceptions, we&apos;ll re-&lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;
&lt;/span&gt;            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!ignoreAcroFormErrors &amp;amp;&amp;amp; e &lt;span class=&quot;code-keyword&quot;&gt;instanceof&lt;/span&gt; IOException)
            {
                &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; IOException(e);
            }
        }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;This is what the author intended, although it isn&apos;t helpful either, as it would swallow all language related exceptions, e.g. the mentioned IndexOutOfBoundsException.&lt;/p&gt;</comment>
                            <comment id="14066796" author="etherous" created="Fri, 18 Jul 2014 19:55:27 +0000"  >&lt;p&gt;The problem with that solution is that all exceptions would be caught, but only IOExceptions would be re-thrown. It would cause the merge process to fail silently, which would be even worse than what is currently happening. Personally, I would wrap the exception in a RuntimeException and throw that if it is not an instance of IOException&lt;/p&gt;</comment>
                            <comment id="14066850" author="tilman" created="Fri, 18 Jul 2014 20:39:59 +0000"  >&lt;p&gt;How about this?&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;        &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (IOException e)
        {
            &lt;span class=&quot;code-comment&quot;&gt;// &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; we are not ignoring exceptions, we&apos;ll re-&lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;
&lt;/span&gt;            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!ignoreAcroFormErrors)
            {
                &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; IOException(e);
            }
        }
        &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (Exception e)
        {
            &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; RuntimeException(e);
        }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14067217" author="etherous" created="Fri, 18 Jul 2014 23:47:27 +0000"  >&lt;p&gt;Yeah, that&apos;s how I would do it&lt;/p&gt;</comment>
                            <comment id="14067374" author="tilman" created="Sat, 19 Jul 2014 04:14:09 +0000"  >&lt;p&gt;Thanks, done in rev 1611844 for the trunk and in rev 1611845 for the 1.8 branch. If you&apos;re not building from source, you can usually get snapshot versions from &lt;a href=&quot;https://repository.apache.org/content/groups/snapshots/org/apache/pdfbox/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://repository.apache.org/content/groups/snapshots/org/apache/pdfbox/&lt;/a&gt; within a few hours.&lt;/p&gt;</comment>
                            <comment id="14067406" author="tilman" created="Sat, 19 Jul 2014 06:23:51 +0000"  >&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; IOException(Exception)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;isn&apos;t supported in JDK 1.5. I&apos;ve changed it to &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;LOG.error (e, e);
&lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; IOException(e.getMessage());
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;in rev 1611849 and 1611864 for the 1.8 branch.&lt;/p&gt;</comment>
                            <comment id="14074963" author="jahewson" created="Fri, 25 Jul 2014 21:33:33 +0000"  >&lt;p&gt;We can&apos;t be doing this kind of thing, at least not in 2.0:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (Exception e)
{
    &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; RuntimeException(e);
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14074981" author="tilman" created="Fri, 25 Jul 2014 21:42:03 +0000"  >&lt;p&gt;Why not, and what else do you suggest?&lt;/p&gt;</comment>
                            <comment id="14117298" author="lehmi" created="Mon, 1 Sep 2014 10:48:19 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; IMO we don&apos;t need to rethrow the exception, just the remove the second catch clause. As you already said, the authors original intention was to handle IOExceptions based on the state of ignoreAcroFormErrors&lt;/p&gt;</comment>
                            <comment id="14117559" author="jira-bot" created="Mon, 1 Sep 2014 16:59:52 +0000"  >&lt;p&gt;Commit 1621843 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1621843&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1621843&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2225&quot; title=&quot;ClassCastException in PDFMergerUtility.appendDocument&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2225&quot;&gt;&lt;del&gt;PDFBOX-2225&lt;/del&gt;&lt;/a&gt;: don&apos;t throw / rethrow RuntimeException&lt;/p&gt;</comment>
                            <comment id="14117562" author="tilman" created="Mon, 1 Sep 2014 17:02:56 +0000"  >&lt;p&gt;I&apos;ve removed two other &quot;throw RuntimeException&quot; as well. This results in a minor API change, i.e. that the correct exception is now thrown.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310010">
                    <name>Incorporates</name>
                                            <outwardlinks description="incorporates">
                                        <issuelink>
            <issuekey id="12728253">PDFBOX-2226</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>406335</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 11 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1xx9z:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>406356</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>