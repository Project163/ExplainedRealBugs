<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:00:31 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PDFBOX-2301] RandomAccessBuffer consumes too much memory.</title>
                <link>https://issues.apache.org/jira/browse/PDFBOX-2301</link>
                <project id="12310760" key="PDFBOX">PDFBox</project>
                    <description>&lt;p&gt;RandomAccessBuffer holds uncompressed image during operation because it is what exactly pdfbox ExtractImages do.&lt;br/&gt;
but holding uncompressed image instead of compressed one in memory consumes too much memory, not excluding many PDF XObjects that can use filter to compress itself. It would be good if pdfbox provides option that reverts to COSObject state just before the RandomAccess object created(the state that pdf XObject stream parsed and COSDictionary objects haven&apos;t created because user doesn&apos;t requested it using get____() method.) It is crucial feature so that pdfbox can analyze huge pdf file(&amp;gt;100MB).&lt;br/&gt;
In current source, one must close COSStream unless required(and I know closed stream cannot reopened again.)&lt;/p&gt;

&lt;p&gt;Class Name                                                                                                                                                                                                                                                                                                         | Shallow Heap | Retained Heap&lt;br/&gt;
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------&lt;br/&gt;
org.apache.pdfbox.cos.COSObject @ 0x5ad4940                                                                                                                                                                                                                                                                        |           24 |     8,187,264&lt;/p&gt;
&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;&amp;lt;class&amp;gt; class org.apache.pdfbox.cos.COSObject @ 0x58c4020&lt;/li&gt;
&lt;/ul&gt;
&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;            0 &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;             0&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;generationNumber org.apache.pdfbox.cos.COSInteger @ 0x5ad0080&lt;/li&gt;
&lt;/ul&gt;
&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;           24 &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;            24&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;baseObject org.apache.pdfbox.cos.COSStream @ 0x5b25ea0&lt;/li&gt;
&lt;/ul&gt;
&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;           32 &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;     8,187,216&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;&amp;lt;class&amp;gt; class org.apache.pdfbox.cos.COSStream @ 0x58c3e00&lt;/li&gt;
&lt;/ul&gt;
&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;            8 &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;             8&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;items java.util.LinkedHashMap @ 0x5b2a0f0&lt;/li&gt;
&lt;/ul&gt;
&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;           56 &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;           552&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;file org.apache.pdfbox.io.RandomAccessBuffer @ 0x5b2a128&lt;/li&gt;
&lt;/ul&gt;
&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;           48 &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;     8,186,528&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;&amp;lt;class&amp;gt; class org.apache.pdfbox.io.RandomAccessBuffer @ 0x5ad2b00&lt;/li&gt;
&lt;/ul&gt;
&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;            8 &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;             8&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;currentBuffer byte&lt;span class=&quot;error&quot;&gt;&amp;#91;16384&amp;#93;&lt;/span&gt; @ 0x590f360      16,400&lt;/li&gt;
&lt;/ul&gt;
&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;        16,400&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;bufferList java.util.ArrayList @ 0x5b2e200&lt;/li&gt;
&lt;/ul&gt;
&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;           24 &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;     8,170,080&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;  &apos;- Total: 3 entries                                                                                                                                                                                                                                                                                          &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;filteredStream org.apache.pdfbox.io.RandomAccessFileOutputStream @ 0x5b2a158&lt;/li&gt;
&lt;/ul&gt;
&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;           32 &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;            32&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;decodeResult org.apache.pdfbox.filter.DecodeResult @ 0xa65f618&lt;/li&gt;
&lt;/ul&gt;
&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;           16 &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;            16&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;unFilteredStream org.apache.pdfbox.io.RandomAccessFileOutputStream @ 0xa71ab18&lt;/li&gt;
&lt;/ul&gt;
&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;           32 &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;            32&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;  &apos;- Total: 6 entries                                                                                                                                                                                                                                                                                             &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;objectNumber org.apache.pdfbox.cos.COSInteger @ 0x5b25ec0&lt;/li&gt;
&lt;/ul&gt;
&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;           24 &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;            24&lt;br/&gt;
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;
</description>
                <environment></environment>
        <key id="12738016">PDFBOX-2301</key>
            <summary>RandomAccessBuffer consumes too much memory.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="lehmi">Andreas Lehmk&#252;hler</assignee>
                                    <reporter username="jojelino">gee</reporter>
                        <labels>
                    </labels>
                <created>Sat, 30 Aug 2014 14:56:55 +0000</created>
                <updated>Thu, 17 Mar 2016 19:07:44 +0000</updated>
                            <resolved>Mon, 20 Jul 2015 10:23:21 +0000</resolved>
                                    <version>1.8.6</version>
                    <version>2.0.0</version>
                                    <fixVersion>2.0.0</fixVersion>
                                    <component>PDModel</component>
                        <due></due>
                            <votes>3</votes>
                                    <watches>10</watches>
                                                                                                                <comments>
                            <comment id="14117176" author="tboehme" created="Mon, 1 Sep 2014 08:26:13 +0000"  >&lt;p&gt;Have you tried loading your document with PDDocument.loadNonSeq( File file, RandomAccess scratchFile ) and provide a RandomAccessFile object as 2nd argument? In this case all temporary data will go to disk. It is up to you if PDFBOX uses main memory or disk for its temporary objects.&lt;/p&gt;</comment>
                            <comment id="14127821" author="jojelino" created="Tue, 9 Sep 2014 23:56:57 +0000"  >&lt;p&gt;Unfortunately, r1558570 caused this bug.&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-1625&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/PDFBOX-1625&lt;/a&gt;&lt;br/&gt;
And not surprisingly, there exists trivial solution to &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-1625&quot; title=&quot;java.lang.IndexOutOfBoundsException at writing PDF file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-1625&quot;&gt;&lt;del&gt;PDFBOX-1625&lt;/del&gt;&lt;/a&gt;&lt;br/&gt;
Just comment out bufferList.clear(); or implement clone method so that oldbufferList!=newbufferList is true by new.bufferList=bufferList.clone(); deep-cloning bufferList is overkill.&lt;br/&gt;
Is there any chance that things can be wrong? No, GC would cover reference counting on their hand. Why you are so bothered from writing duplicated code that GC is doing already?&lt;/p&gt;</comment>
                            <comment id="14127880" author="jojelino" created="Wed, 10 Sep 2014 01:06:40 +0000"  >&lt;p&gt;Stripped Deep-cloning code.&lt;/p&gt;</comment>
                            <comment id="14128299" author="lehmi" created="Wed, 10 Sep 2014 10:01:09 +0000"  >&lt;blockquote&gt;
&lt;p&gt;And not surprisingly, there exists trivial solution to &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-1625&quot; title=&quot;java.lang.IndexOutOfBoundsException at writing PDF file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-1625&quot;&gt;&lt;del&gt;PDFBOX-1625&lt;/del&gt;&lt;/a&gt;&lt;br/&gt;
Just comment out bufferList.clear(); &lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Nope, we have to separate both buffers by cloning the data, otherwise concurrent access may be an issue in some cases. This is just a workaround. We have to overhaul the whole stream handling in the first place, but that will be huge change and will take some time.&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt; or implement clone method so that oldbufferList!=oldbufferList is true by new.bufferList=bufferList.clone(); deep-cloning bufferList is overkill.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;bufferList.clone() does the same than the existing code, so that I can&apos;t see any advantage here. Besides you patch removes some of the copy code, so that the rsulting copy isn&apos;t an exact clone of the origin buffer.&lt;/p&gt;</comment>
                            <comment id="14128851" author="jahewson" created="Wed, 10 Sep 2014 18:15:56 +0000"  >&lt;blockquote&gt;
&lt;p&gt;otherwise concurrent access may be an issue in some cases&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Andreas, can you shed some more light on this?&lt;/p&gt;</comment>
                            <comment id="14129848" author="lehmi" created="Thu, 11 Sep 2014 10:18:43 +0000"  >&lt;p&gt;The origin issue (&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-1625&quot; title=&quot;java.lang.IndexOutOfBoundsException at writing PDF file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-1625&quot;&gt;&lt;del&gt;PDFBOX-1625&lt;/del&gt;&lt;/a&gt;) was about merging pdfs and the underlying issue about the usage of the scratch file when merging pdfs (see &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-1586&quot; title=&quot;IndexOutOfBoundsException when saving a document (at random)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-1586&quot;&gt;&lt;del&gt;PDFBOX-1586&lt;/del&gt;&lt;/a&gt;). &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-1586&quot; title=&quot;IndexOutOfBoundsException when saving a document (at random)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-1586&quot;&gt;&lt;del&gt;PDFBOX-1586&lt;/del&gt;&lt;/a&gt; reduces the usage of the scratch file and &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-1625&quot; title=&quot;java.lang.IndexOutOfBoundsException at writing PDF file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-1625&quot;&gt;&lt;del&gt;PDFBOX-1625&lt;/del&gt;&lt;/a&gt; tries to detach the source and the destination pdf by cloning. Both are just workarounds and in the case of &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-1625&quot; title=&quot;java.lang.IndexOutOfBoundsException at writing PDF file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-1625&quot;&gt;&lt;del&gt;PDFBOX-1625&lt;/del&gt;&lt;/a&gt; it has some side effects.&lt;br/&gt;
IMHO, we have to overhaul the stream handling within the COS layer and we shouldn&apos;t expose the scratch file anymore. The whole stuff should be handled under the hood. The only thing the user may decide is wether to use the file system or the memory as temp area.&lt;/p&gt;</comment>
                            <comment id="14129954" author="tboehme" created="Thu, 11 Sep 2014 12:30:15 +0000"  >&lt;p&gt;I&apos;m also interested in fixing the RandomAccess buffer issue since the cloning work-around seems a bit problematic to me too. I did try to understand the issue for this workaround an came to following conclusions:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;problem is closing the buffer stream when closing a document but COS objects should be used somewhere else, needing access to the buffered data&lt;/li&gt;
	&lt;li&gt;the work-around is implemented for COSStream objects only and clones buffer in case it is RandomAccessBuffer; in case of RandomAccessFile this is not done thus here the problem from point 1 still persists &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/help_16.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/li&gt;
	&lt;li&gt;since only COSStream will access the data it writes into buffer, why not simply create a new buffer object instead of cloning? At least this will not duplicate data already in buffer but not used by the stream. The buffer will be garbage collected when there is no reference to the COSStream or to any input stream created on the buffer&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;WDYT?&lt;/p&gt;</comment>
                            <comment id="14132825" author="jira-bot" created="Sat, 13 Sep 2014 16:49:50 +0000"  >&lt;p&gt;Commit 1624765 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lehmi&quot; class=&quot;user-hover&quot; rel=&quot;lehmi&quot;&gt;lehmi&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1624765&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1624765&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2301&quot; title=&quot;RandomAccessBuffer consumes too much memory.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2301&quot;&gt;&lt;del&gt;PDFBOX-2301&lt;/del&gt;&lt;/a&gt;: remove the usage of a scratch file&lt;/p&gt;</comment>
                            <comment id="14132829" author="lehmi" created="Sat, 13 Sep 2014 16:52:40 +0000"  >&lt;p&gt;As a first step I&apos;ve removed the usage of a scratch file provided by the user. I&apos;m going implement an optional usage of temp files which is done inside the COS-layer without expsoing the scratchfile(s).&lt;/p&gt;</comment>
                            <comment id="14132862" author="jira-bot" created="Sat, 13 Sep 2014 17:51:51 +0000"  >&lt;p&gt;Commit 1624771 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lehmi&quot; class=&quot;user-hover&quot; rel=&quot;lehmi&quot;&gt;lehmi&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1624771&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1624771&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2301&quot; title=&quot;RandomAccessBuffer consumes too much memory.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2301&quot;&gt;&lt;del&gt;PDFBOX-2301&lt;/del&gt;&lt;/a&gt;: added the optional usage of scratch files to the nonsequential parser&lt;/p&gt;</comment>
                            <comment id="14132863" author="lehmi" created="Sat, 13 Sep 2014 17:53:38 +0000"  >&lt;p&gt;I&apos;ve added optional support for scratch files to the nonsequential parser. I&apos;m going to add it to the &quot;old&quot; parser as well and I&apos;ve to clean up some comments/add some documentation too.&lt;/p&gt;</comment>
                            <comment id="14133132" author="jira-bot" created="Sun, 14 Sep 2014 08:41:29 +0000"  >&lt;p&gt;Commit 1624810 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lehmi&quot; class=&quot;user-hover&quot; rel=&quot;lehmi&quot;&gt;lehmi&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1624810&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1624810&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2301&quot; title=&quot;RandomAccessBuffer consumes too much memory.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2301&quot;&gt;&lt;del&gt;PDFBOX-2301&lt;/del&gt;&lt;/a&gt;: move the handling of scratch files to COSStream&lt;/p&gt;</comment>
                            <comment id="14133147" author="jira-bot" created="Sun, 14 Sep 2014 10:11:28 +0000"  >&lt;p&gt;Commit 1624824 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lehmi&quot; class=&quot;user-hover&quot; rel=&quot;lehmi&quot;&gt;lehmi&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1624824&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1624824&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2301&quot; title=&quot;RandomAccessBuffer consumes too much memory.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2301&quot;&gt;&lt;del&gt;PDFBOX-2301&lt;/del&gt;&lt;/a&gt;: updated documentation, removed unused methods&lt;/p&gt;</comment>
                            <comment id="14133151" author="jira-bot" created="Sun, 14 Sep 2014 10:20:23 +0000"  >&lt;p&gt;Commit 1624828 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lehmi&quot; class=&quot;user-hover&quot; rel=&quot;lehmi&quot;&gt;lehmi&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1624828&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1624828&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2301&quot; title=&quot;RandomAccessBuffer consumes too much memory.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2301&quot;&gt;&lt;del&gt;PDFBOX-2301&lt;/del&gt;&lt;/a&gt;: updated documentation&lt;/p&gt;</comment>
                            <comment id="14133156" author="jira-bot" created="Sun, 14 Sep 2014 10:58:25 +0000"  >&lt;p&gt;Commit 1624832 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lehmi&quot; class=&quot;user-hover&quot; rel=&quot;lehmi&quot;&gt;lehmi&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1624832&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1624832&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2301&quot; title=&quot;RandomAccessBuffer consumes too much memory.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2301&quot;&gt;&lt;del&gt;PDFBOX-2301&lt;/del&gt;&lt;/a&gt;: enable the usage of scratch files within the old parser&lt;/p&gt;</comment>
                            <comment id="14133180" author="lehmi" created="Sun, 14 Sep 2014 12:02:26 +0000"  >&lt;p&gt;I&apos;ve overhauled the whole stream stuff as follows:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;there isn&apos;t any scratch file to be provided by the user anymore, so that the close-issue should be gone&lt;/li&gt;
	&lt;li&gt;It isn&apos;t no longer necessary to clone the data, so that the memory footprint should be smaller&lt;/li&gt;
	&lt;li&gt;the user can decide wether to handle all data using memory only (default) or to create scratch files for each COSStream&lt;/li&gt;
	&lt;li&gt;the whole scratch file handling is encapsulated within COSStream
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;each stream has it&apos;s own scratch file&lt;/li&gt;
		&lt;li&gt;scratch files are closed and deleted when closing the stream&lt;/li&gt;
		&lt;li&gt;scratch files aren&apos;t exposed to the user&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;the scratch file usage is available for the nonsequential and the old parser&lt;/li&gt;
&lt;/ul&gt;

</comment>
                            <comment id="14133186" author="jira-bot" created="Sun, 14 Sep 2014 12:09:40 +0000"  >&lt;p&gt;Commit 1624844 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lehmi&quot; class=&quot;user-hover&quot; rel=&quot;lehmi&quot;&gt;lehmi&lt;/a&gt; in branch &apos;pdfbox/branches/1.8&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1624844&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1624844&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2301&quot; title=&quot;RandomAccessBuffer consumes too much memory.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2301&quot;&gt;&lt;del&gt;PDFBOX-2301&lt;/del&gt;&lt;/a&gt;: deprecated some methods which will be removed with 2.0.0&lt;/p&gt;</comment>
                            <comment id="14133270" author="lehmi" created="Sun, 14 Sep 2014 16:39:25 +0000"  >&lt;p&gt;I&apos;ve undertestimated the possible number of COSStreams in a big pdf. When I try to open a big pdf using scratch files I run into an exception (too many open files). This is an unix-only problem and could be worked around by increasing the maximum number of open files, but that isn&apos;t optimal. Either I&apos;ve to change my procedure or we have to adjust the parser so that objects are parsed only if needed.&lt;/p&gt;</comment>
                            <comment id="14133668" author="tboehme" created="Mon, 15 Sep 2014 07:49:49 +0000"  >&lt;p&gt;I would propose for a mixed solution where we have a maximum value for holding streams in memory and if this is reached, using files.&lt;br/&gt;
For the temporary scratch file handling:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;share a file across multiple streams (as before), but maybe only to a certain size; create new one if size exceeds; this requires a central scratch file handling; the advantage would be that only the temporary files with &apos;active&apos; stream objects remain&lt;/li&gt;
	&lt;li&gt;don&apos;t use File.deleteOnExit as this is stored in the VM until it closes; if you have a long running process with a large number of processed files you ran out of memory (see &lt;a href=&quot;http://puneeth.wordpress.com/2006/01/23/filedeleteonexit-is-evil/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://puneeth.wordpress.com/2006/01/23/filedeleteonexit-is-evil/&lt;/a&gt;); better way is to register a shutdown hook which will remove the file&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;I may try to create such a solution. WDYT?&lt;/p&gt;</comment>
                            <comment id="14133681" author="lehmi" created="Mon, 15 Sep 2014 08:16:18 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tboehme&quot; class=&quot;user-hover&quot; rel=&quot;tboehme&quot;&gt;tboehme&lt;/a&gt; Thanks for your thoughts and your offer. I&apos;m going to work an that topic soon and I want to follow some ideas I&apos;ve in mind first (some of them are similar to your idea). I didn&apos;t know about the deleteOnExit issue, so thanks for the hint. I should be easy to eliminate that one.&lt;/p&gt;</comment>
                            <comment id="14133722" author="tboehme" created="Mon, 15 Sep 2014 09:05:11 +0000"  >&lt;p&gt;One more idea: if there will be a central temporary files handling it could use WeakReferences to the streams to check if they still exist and if not, cleanup the resources (in case close wasn&apos;t called...)&lt;/p&gt;</comment>
                            <comment id="14136518" author="jojelino" created="Tue, 16 Sep 2014 23:44:46 +0000"  >&lt;p&gt;Although this patch need java 1.7, would fix issues formerly addressed by you. Now adding/removing element to shallow-cloned list changes internal data.&lt;/p&gt;</comment>
                            <comment id="14136686" author="jojelino" created="Wed, 17 Sep 2014 02:39:54 +0000"  >&lt;p&gt;clone2.diff is now invalid.&lt;br/&gt;
This patch fills remaining hole in previous patch. now every write operation ensures that changes is not seen to any other cloned object.&lt;/p&gt;</comment>
                            <comment id="14137026" author="lehmi" created="Wed, 17 Sep 2014 10:16:26 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jojelino&quot; class=&quot;user-hover&quot; rel=&quot;jojelino&quot;&gt;jojelino&lt;/a&gt; PDFBox 1.8.x has java 1.5 and 2.0.x has java 1.6 as minimum requirement, so that your patch isn&apos;t valid. However, we already started a refactoring in 2.0 and we don&apos;t need cloning anymore. I guess we won&apos;t fix this in the 1.8 branch&lt;/p&gt;</comment>
                            <comment id="14137038" author="lehmi" created="Wed, 17 Sep 2014 10:33:45 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tboehme&quot; class=&quot;user-hover&quot; rel=&quot;tboehme&quot;&gt;tboehme&lt;/a&gt;I&apos;m still thinking about the options concerning the scratch file issue. It&apos;s quite easy to switch back to use one scratch file and I&apos;m going to do that soon at least as a workaround. But the root issue is, that the parser creates all streams at the beginning and thus is allocating a lot of memory/creating a lot of scratch files. IMO we have to refactor the whole parser to change that behaviour. And now we come to the point to implement on-demand parsing.&lt;/p&gt;</comment>
                            <comment id="14137140" author="tboehme" created="Wed, 17 Sep 2014 12:27:28 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lehmi&quot; class=&quot;user-hover&quot; rel=&quot;lehmi&quot;&gt;lehmi&lt;/a&gt; The NonSeqParser by design is an on-demand parser. Only because other parts of PDFBOX require data already parsed it initializes/parses all objects in the init procedure (see parseMinimalCatalog variable) as a work around. So COSObject and its subclasses should only be a stub in the beginning and if used (any method call) should trigger parsing the object by the parser (NonSequentialPDFParser.parseObjectDynamically). Thus COSDocument needs to have a reference to the parser.&lt;br/&gt;
For the scratch file workaround I&apos;m still in favor for a split in-memory/file usage so that only large PDF need to write to file.&lt;/p&gt;</comment>
                            <comment id="14138167" author="jahewson" created="Wed, 17 Sep 2014 23:04:11 +0000"  >&lt;p&gt;Why use scratch files at all for parsing? Couldn&apos;t we use a java.io.RandomAccessFile to read the PDF (or perhaps one per COS stream) which would avoid the extra round-trip to disk:&lt;/p&gt;

&lt;p&gt;With Java&apos;s RandomAccessFile:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;COSStream uses RandomAccessFile to read the data from disk when it is needed&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;With scratch files:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Read the entire COS stream from the PDF&lt;/li&gt;
	&lt;li&gt;Write it to disk&lt;/li&gt;
	&lt;li&gt;Re-read the stream from disk when COSStream is read&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14138545" author="tilman" created="Thu, 18 Sep 2014 05:39:28 +0000"  >&lt;p&gt;I thought about it too, but there are some bizarre situations where the objects are itself compressed in a stream, or when streams are encrypted. So in these case we would have to have temp files in memory or on disk.&lt;/p&gt;</comment>
                            <comment id="14138673" author="tboehme" created="Thu, 18 Sep 2014 08:11:53 +0000"  >&lt;p&gt;IMHO we should use a random access object for filteredStream in COSStream which is directly set. This would allow to wrap the input file and provide it to the stream without copying the raw data. Additionally we need a RandomAccessBuffer solution for writing the decoded data. For this a combined memory/file solution would be good.&lt;/p&gt;</comment>
                            <comment id="14138730" author="msahyoun" created="Thu, 18 Sep 2014 09:46:34 +0000"  >&lt;p&gt;As the NonSeqParser can work on demand maybe the initial focus could be to get that to work internally as this will already decrease the memory requirements as well as increase the processing speed where only partial information is needed (e.g. import a single page form a source document). The results of Andreas initial change showed that we currently have too many open streams.&lt;/p&gt;

&lt;p&gt;Apache Camel has a Stream Cache with configurable size where the stream is kept in memory or written to a temp file if it&#8217;s above the size. &lt;a href=&quot;http://camel.apache.org/stream-caching.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://camel.apache.org/stream-caching.html&lt;/a&gt;. Maybe worth looking into.&lt;/p&gt;</comment>
                            <comment id="14138740" author="lehmi" created="Thu, 18 Sep 2014 09:58:56 +0000"  >&lt;blockquote&gt;
&lt;p&gt;Andreas Lehmk&#252;hler The NonSeqParser by design is an on-demand parser. Only because other parts of PDFBOX require data already parsed it initializes/parses all objects in the init procedure (see parseMinimalCatalog variable) as a work around. So COSObject and its subclasses should only be a stub in the beginning and if used (any method call) should trigger parsing the object by the parser (NonSequentialPDFParser.parseObjectDynamically). Thus COSDocument needs to have a reference to the parser.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Maybe that was the origin intention, but the NonSequentialPDFParser doesn&apos;t follow that idea (anymore). At the end of &quot;parse&quot; it iterates over all pages and loads all needed data. More important seems to be the fact that the pdf is closed at the end of &quot;parse&quot;, so that &quot;parseObjectDynamically&quot; doesn&apos;t work after the &quot;parse&quot; is finished. Even if it would work, the current idea is just half the battle. We need to find a way to free resourcen after a page isn&apos;t needed anymore.&lt;/p&gt;

&lt;p&gt;IMO there is more than one issue to be solved&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;the internal handling of compressed/uncompressed stream within COSStream (there is already a FIXME for a long time)&lt;/li&gt;
	&lt;li&gt;scratch file usage&lt;/li&gt;
	&lt;li&gt;find a way to release resourcen during processing a pdf, e.g. after each page&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14138741" author="lehmi" created="Thu, 18 Sep 2014 10:05:31 +0000"  >&lt;blockquote&gt;
&lt;p&gt;As the NonSeqParser can work on demand maybe the initial focus could be to get that to work internally as this will already decrease the memory requirements as well as increase the processing speed where only partial information is needed (e.g. import a single page form a source document). The results of Andreas initial change showed that we currently have too many open streams.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;That should be a big issue, but it eases the problem only if someone needs partial processing of a pdf. Once one wants to process the whole pdf it doesn&apos;t make an difference if we use the &quot;load all&quot; or the current &quot;on demand&quot; feature. The result is more or less the same.&lt;/p&gt;</comment>
                            <comment id="14138743" author="msahyoun" created="Thu, 18 Sep 2014 10:06:53 +0000"  >&lt;p&gt;That has been put in place as the rest of PDFBox didn&#8217;t support on demand parsing but expected the objects to be available. IMHO the focus should be to support on demand parsing instead of optimizing how we store too many open stream effectively.&lt;/p&gt;</comment>
                            <comment id="14138744" author="lehmi" created="Thu, 18 Sep 2014 10:07:31 +0000"  >&lt;p&gt;IMHO we should start at the innermost point: the handling of compressed/uncompressed stream within COSStream&lt;/p&gt;</comment>
                            <comment id="14138753" author="msahyoun" created="Thu, 18 Sep 2014 10:14:53 +0000"  >&lt;p&gt;Many applications, although processing the whole PDF at the end, do this page by page e.g. rendering all pages of a PDF to image, text extraction. Parsing the page and the needed resources only and freeing up after the page will have an impact on such applications. &lt;/p&gt;</comment>
                            <comment id="14139369" author="jahewson" created="Thu, 18 Sep 2014 19:26:43 +0000"  >&lt;p&gt;In response to Andreas&apos; third problem:&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;find a way to release resources during processing a pdf, e.g. after each page&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;&lt;b&gt;EDIT...&lt;/b&gt; the rest of this comment is now in &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2370&quot; title=&quot;Move caching outside of PDResources&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2370&quot;&gt;&lt;del&gt;PDFBOX-2370&lt;/del&gt;&lt;/a&gt; as it did not refer to the same &quot;resources&quot; which Andreas was talking about, it&apos;s an entirely separate issue.&lt;/p&gt;</comment>
                            <comment id="14140291" author="lehmi" created="Fri, 19 Sep 2014 10:30:34 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jahewson&quot; class=&quot;user-hover&quot; rel=&quot;jahewson&quot;&gt;jahewson&lt;/a&gt; I guess there is a missunderstanding. When I talked about &quot;resources&quot; I didn&apos;t mean &quot;PDResources&quot; it was about resources in general. However, your point is nevertheless correct. But as I already said, I&apos;m going to start on the lowest level in COSStream.&lt;/p&gt;</comment>
                            <comment id="14140650" author="jojelino" created="Fri, 19 Sep 2014 14:34:38 +0000"  >&lt;p&gt;COSDocument class was origin of the problem.&lt;br/&gt;
and the class didn&apos;t tell underlying scratchfile buffer that it doesn&apos;t need to deep-clone bufferlist. so during parsing pdf, memory buffer keeps cloning. The result is large waste of buffers. and the waste increases whenever object count increases, finally VM would lose their chance to GC and throws exception.&lt;/p&gt;

&lt;p&gt;I added POC code for handling additional case where buffer is sequentially written while sharing buffers.&lt;/p&gt;

&lt;p&gt;I hope you can fix the problem&lt;/p&gt;</comment>
                            <comment id="14141677" author="jahewson" created="Sat, 20 Sep 2014 02:07:44 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lehmi&quot; class=&quot;user-hover&quot; rel=&quot;lehmi&quot;&gt;lehmi&lt;/a&gt;, yes there was a misunderstanding, I&apos;ve created a new issue &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2370&quot; title=&quot;Move caching outside of PDResources&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2370&quot;&gt;&lt;del&gt;PDFBOX-2370&lt;/del&gt;&lt;/a&gt; where we can follow up on that later, as we seem to agree.&lt;/p&gt;

&lt;p&gt;What did you actually mean by &quot;find a way to release resources during processing a pdf, e.g. after each page&quot;? Are you talking about data cached inside COSStream objects? If so, then I think that there is no need for COSStream to do any caching, as we already have caching further downstream in PDResources (or elsewhere if we implement &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2370&quot; title=&quot;Move caching outside of PDResources&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2370&quot;&gt;&lt;del&gt;PDFBOX-2370&lt;/del&gt;&lt;/a&gt;).&lt;/p&gt;</comment>
                            <comment id="14322139" author="jira-bot" created="Sun, 15 Feb 2015 18:50:30 +0000"  >&lt;p&gt;Commit 1659979 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lehmi&quot; class=&quot;user-hover&quot; rel=&quot;lehmi&quot;&gt;lehmi&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1659979&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1659979&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2301&quot; title=&quot;RandomAccessBuffer consumes too much memory.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2301&quot;&gt;&lt;del&gt;PDFBOX-2301&lt;/del&gt;&lt;/a&gt;: don&apos;t use deleteOnExit feature as proposed by Timo Boehme&lt;/p&gt;</comment>
                            <comment id="14322310" author="jojelino" created="Mon, 16 Feb 2015 02:31:34 +0000"  >&lt;p&gt;The analysis was not correct. RandomAccessBuffer allocated 16KB without condition when it needed to use just some hundred bytes for small content stream object.&lt;/p&gt;</comment>
                            <comment id="14322964" author="jira-bot" created="Mon, 16 Feb 2015 16:37:10 +0000"  >&lt;p&gt;Commit 1660159 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lehmi&quot; class=&quot;user-hover&quot; rel=&quot;lehmi&quot;&gt;lehmi&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1660159&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1660159&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2301&quot; title=&quot;RandomAccessBuffer consumes too much memory.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2301&quot;&gt;&lt;del&gt;PDFBOX-2301&lt;/del&gt;&lt;/a&gt;: remove unused getStreamTokens&lt;/p&gt;</comment>
                            <comment id="14323061" author="tilman" created="Mon, 16 Feb 2015 17:44:39 +0000"  >&lt;p&gt;SonarQube has flagged this code:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;scratchFile.delete();&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Was it your intention to ignore a fail? I only ask because the rest of the code in that method does throw exceptions. Alternative:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Files.delete(scratchFile.toPath());&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14323098" author="lehmi" created="Mon, 16 Feb 2015 18:13:37 +0000"  >&lt;p&gt;The code now throws an IOException if something went wrong. &quot;Files&quot; isn&apos;t available in java6. Thanks for the pointer&lt;/p&gt;</comment>
                            <comment id="14323102" author="jira-bot" created="Mon, 16 Feb 2015 18:14:58 +0000"  >&lt;p&gt;Commit 1660178 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lehmi&quot; class=&quot;user-hover&quot; rel=&quot;lehmi&quot;&gt;lehmi&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1660178&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1660178&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2301&quot; title=&quot;RandomAccessBuffer consumes too much memory.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2301&quot;&gt;&lt;del&gt;PDFBOX-2301&lt;/del&gt;&lt;/a&gt;: throw IOException if scratch file can&apos;t be deleted&lt;/p&gt;</comment>
                            <comment id="14343502" author="jira-bot" created="Mon, 2 Mar 2015 18:05:52 +0000"  >&lt;p&gt;Commit 1663378 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lehmi&quot; class=&quot;user-hover&quot; rel=&quot;lehmi&quot;&gt;lehmi&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1663378&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1663378&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2301&quot; title=&quot;RandomAccessBuffer consumes too much memory.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2301&quot;&gt;&lt;del&gt;PDFBOX-2301&lt;/del&gt;&lt;/a&gt;: use 1024 instead of 16384 bytes as chunk size&lt;/p&gt;</comment>
                            <comment id="14343505" author="lehmi" created="Mon, 2 Mar 2015 18:07:15 +0000"  >&lt;blockquote&gt;
&lt;p&gt;The analysis was not correct. RandomAccessBuffer allocated 16KB without condition when it needed to use just some hundred bytes for small content stream object.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I&apos;ve decreased the chunk size to 1024&lt;/p&gt;</comment>
                            <comment id="14503132" author="jira-bot" created="Mon, 20 Apr 2015 16:26:43 +0000"  >&lt;p&gt;Commit 1674940 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lehmi&quot; class=&quot;user-hover&quot; rel=&quot;lehmi&quot;&gt;lehmi&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1674940&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1674940&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2301&quot; title=&quot;RandomAccessBuffer consumes too much memory.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2301&quot;&gt;&lt;del&gt;PDFBOX-2301&lt;/del&gt;&lt;/a&gt;: copy filtered stream data as createFilteredStream resets all data&lt;/p&gt;</comment>
                            <comment id="14503143" author="jira-bot" created="Mon, 20 Apr 2015 16:31:22 +0000"  >&lt;p&gt;Commit 1674942 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lehmi&quot; class=&quot;user-hover&quot; rel=&quot;lehmi&quot;&gt;lehmi&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1674942&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1674942&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2301&quot; title=&quot;RandomAccessBuffer consumes too much memory.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2301&quot;&gt;&lt;del&gt;PDFBOX-2301&lt;/del&gt;&lt;/a&gt;: introduced clear() to reset a buffer before reusing it without creating a new one&lt;/p&gt;</comment>
                            <comment id="14514529" author="jira-bot" created="Mon, 27 Apr 2015 17:51:43 +0000"  >&lt;p&gt;Commit 1676346 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lehmi&quot; class=&quot;user-hover&quot; rel=&quot;lehmi&quot;&gt;lehmi&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1676346&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1676346&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2301&quot; title=&quot;RandomAccessBuffer consumes too much memory.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2301&quot;&gt;&lt;del&gt;PDFBOX-2301&lt;/del&gt;&lt;/a&gt;: implemented clear() for RandomAccessFile&lt;/p&gt;</comment>
                            <comment id="14514532" author="jira-bot" created="Mon, 27 Apr 2015 17:53:04 +0000"  >&lt;p&gt;Commit 1676348 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lehmi&quot; class=&quot;user-hover&quot; rel=&quot;lehmi&quot;&gt;lehmi&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1676348&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1676348&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2301&quot; title=&quot;RandomAccessBuffer consumes too much memory.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2301&quot;&gt;&lt;del&gt;PDFBOX-2301&lt;/del&gt;&lt;/a&gt;: add junit test for COSStream decoding/encoding&lt;/p&gt;</comment>
                            <comment id="14521820" author="jira-bot" created="Thu, 30 Apr 2015 16:54:20 +0000"  >&lt;p&gt;Commit 1677027 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lehmi&quot; class=&quot;user-hover&quot; rel=&quot;lehmi&quot;&gt;lehmi&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1677027&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1677027&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2301&quot; title=&quot;RandomAccessBuffer consumes too much memory.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2301&quot;&gt;&lt;del&gt;PDFBOX-2301&lt;/del&gt;&lt;/a&gt;: overhauled buffer handling&lt;/p&gt;</comment>
                            <comment id="14521843" author="lehmi" created="Thu, 30 Apr 2015 17:00:08 +0000"  >&lt;p&gt;I&apos;ve overhauled the buffer handling, but I&apos;m not yet ready. &lt;br/&gt;
Next steps are&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;use the origin buffer to read the stream content&lt;/li&gt;
	&lt;li&gt;read the stream data on demand and not when parsing the pdf&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14525781" author="tilman" created="Sun, 3 May 2015 11:27:18 +0000"  >&lt;p&gt;The &quot;if&quot; condition is always true below (from COSStream.java):&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;            &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt;( &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; i=filterArray.size()-1; i&amp;gt;=0; i-- )
            {
                COSName filterName = (COSName)filterArray.get( i );
                doEncode( filterName, i, getFilteredBuffer(&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;) );
                &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; ( i &amp;gt;= 0 )
                {
                    copyBuffer(getFilteredBuffer(&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;), 0);
                }
            }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;and&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt; 
            &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt;( &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; i=0; i&amp;lt;filterArray.size(); i++ )
            {
                COSName filterName = (COSName)filterArray.get( i );
                doDecode( filterName, i, getFilteredBuffer().length(), getUnfilteredBuffer(&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;) );
                &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (i &amp;lt; filterArray.size())
                {
                    copyBuffer(getUnfilteredBuffer(&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;), 0);
                }
            }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14548376" author="jira-bot" created="Mon, 18 May 2015 17:39:35 +0000"  >&lt;p&gt;Commit 1680061 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lehmi&quot; class=&quot;user-hover&quot; rel=&quot;lehmi&quot;&gt;lehmi&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1680061&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1680061&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2301&quot; title=&quot;RandomAccessBuffer consumes too much memory.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2301&quot;&gt;&lt;del&gt;PDFBOX-2301&lt;/del&gt;&lt;/a&gt;: avoid unneeded copyBuffer call&lt;/p&gt;</comment>
                            <comment id="14548381" author="lehmi" created="Mon, 18 May 2015 17:40:24 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; Thanks for the hint, I&apos;ve fixed the conditions&lt;/p&gt;</comment>
                            <comment id="14566022" author="jira-bot" created="Sat, 30 May 2015 14:49:06 +0000"  >&lt;p&gt;Commit 1682610 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lehmi&quot; class=&quot;user-hover&quot; rel=&quot;lehmi&quot;&gt;lehmi&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1682610&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1682610&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2301&quot; title=&quot;RandomAccessBuffer consumes too much memory.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2301&quot;&gt;&lt;del&gt;PDFBOX-2301&lt;/del&gt;&lt;/a&gt;: extend SequentialRead and RandomAccessRead to be used within the parser&lt;/p&gt;</comment>
                            <comment id="14566487" author="jira-bot" created="Sun, 31 May 2015 09:55:30 +0000"  >&lt;p&gt;Commit 1682705 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lehmi&quot; class=&quot;user-hover&quot; rel=&quot;lehmi&quot;&gt;lehmi&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1682705&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1682705&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2301&quot; title=&quot;RandomAccessBuffer consumes too much memory.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2301&quot;&gt;&lt;del&gt;PDFBOX-2301&lt;/del&gt;&lt;/a&gt;: SequentialRead extends Closeable&lt;/p&gt;</comment>
                            <comment id="14566489" author="jira-bot" created="Sun, 31 May 2015 09:59:19 +0000"  >&lt;p&gt;Commit 1682706 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lehmi&quot; class=&quot;user-hover&quot; rel=&quot;lehmi&quot;&gt;lehmi&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1682706&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1682706&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2301&quot; title=&quot;RandomAccessBuffer consumes too much memory.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2301&quot;&gt;&lt;del&gt;PDFBOX-2301&lt;/del&gt;&lt;/a&gt;: use RandomAccessRead instead of PushBackInputStream as pdfSource&lt;/p&gt;</comment>
                            <comment id="14566524" author="tilman" created="Sun, 31 May 2015 11:38:34 +0000"  >&lt;p&gt;If I&apos;ve understood this change correctly, the load() calls with InputStream parameter now will always buffer the whole file in memory, unless a scratch file is passed, i.e. there will be a biggger memory footprint (previously it would buffer 16K for the pushback buffer). Thus I suggest that the javadoc of load(InputStream...) mention this somehow, i.e. advise to use methods that have a File parameter if possible.&lt;/p&gt;</comment>
                            <comment id="14566528" author="tilman" created="Sun, 31 May 2015 11:54:43 +0000"  >&lt;p&gt;Something went wrong...&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;render[bugzilla869140.pdf](org.apache.pdfbox.rendering.TestRendering)  Time elapsed: 0.032 sec  &amp;lt;&amp;lt;&amp;lt; ERROR!
java.io.IOException: expected &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt; actual=&lt;span class=&quot;code-quote&quot;&gt;&apos;fals &apos;&lt;/span&gt;  org.apache.pdfbox.io.RandomAccessBufferedFileInputStream@37c3a1bc
	at org.apache.pdfbox.pdfparser.BaseParser.parseDirObject(BaseParser.java:1058)
	at org.apache.pdfbox.pdfparser.BaseParser.parseCOSDictionaryValue(BaseParser.java:196)
	at org.apache.pdfbox.pdfparser.BaseParser.parseCOSDictionaryNameValuePair(BaseParser.java:320)
	at org.apache.pdfbox.pdfparser.BaseParser.parseCOSDictionary(BaseParser.java:253)
	at org.apache.pdfbox.pdfparser.BaseParser.parseDirObject(BaseParser.java:1007)
	at org.apache.pdfbox.pdfparser.COSParser.parseFileObject(COSParser.java:732)
	at org.apache.pdfbox.pdfparser.COSParser.parseObjectDynamically(COSParser.java:701)
	at org.apache.pdfbox.pdfparser.COSParser.parseObjectDynamically(COSParser.java:654)
	at org.apache.pdfbox.pdfparser.COSParser.parseDictObjects(COSParser.java:615)
	at org.apache.pdfbox.pdfparser.PDFParser.initialParse(PDFParser.java:329)
	at org.apache.pdfbox.pdfparser.PDFParser.parse(PDFParser.java:356)
	at org.apache.pdfbox.pdmodel.PDDocument.load(PDDocument.java:834)
	at org.apache.pdfbox.pdmodel.PDDocument.load(PDDocument.java:796)
	at org.apache.pdfbox.pdmodel.PDDocument.load(PDDocument.java:750)
	at org.apache.pdfbox.rendering.TestRendering.render(TestRendering.java:78)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The file can be found in &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2423&quot; title=&quot;Page tree handling needs rewriting&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2423&quot;&gt;&lt;del&gt;PDFBOX-2423&lt;/del&gt;&lt;/a&gt;. I&apos;ll test if there&apos;s more...&lt;/p&gt;</comment>
                            <comment id="14566529" author="tilman" created="Sun, 31 May 2015 12:03:53 +0000"  >&lt;p&gt;Same with gs-bugzilla693653.pdf, gs-bugzilla694585.pdf, &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2521&quot; title=&quot;Don&amp;#39;t throw IOException if stream length is missing in lenient mode&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2521&quot;&gt;&lt;del&gt;PDFBOX-2521&lt;/del&gt;&lt;/a&gt;.pdf&lt;/p&gt;

&lt;p&gt;Same error, but when reloading the saved file:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-1058&quot; title=&quot;Converting PDF to Image gives error and the image generated is of poor quality&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-1058&quot;&gt;&lt;del&gt;PDFBOX-1058&lt;/del&gt;&lt;/a&gt;.pdf, K_UPMEYER_SPRING10.pdf, &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2158&quot; title=&quot;ExtractText missing most of text in this PDF file, due to font bounding box with minus infinity&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2158&quot;&gt;&lt;del&gt;PDFBOX-2158&lt;/del&gt;&lt;/a&gt;-077702.pdf, &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2385&quot; title=&quot;inline image with EI at the end incorrectly parsed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2385&quot;&gt;&lt;del&gt;PDFBOX-2385&lt;/del&gt;&lt;/a&gt;-937619.pdf, &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2658&quot; title=&quot;PdfBox cannot render image with transparency&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2658&quot;&gt;&lt;del&gt;PDFBOX-2658&lt;/del&gt;&lt;/a&gt;.pdf&lt;/p&gt;</comment>
                            <comment id="14566546" author="jira-bot" created="Sun, 31 May 2015 13:19:50 +0000"  >&lt;p&gt;Commit 1682734 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1682734&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1682734&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2301&quot; title=&quot;RandomAccessBuffer consumes too much memory.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2301&quot;&gt;&lt;del&gt;PDFBOX-2301&lt;/del&gt;&lt;/a&gt;: show offset in exception&lt;/p&gt;</comment>
                            <comment id="14566548" author="tilman" created="Sun, 31 May 2015 13:24:14 +0000"  >&lt;p&gt;The last commit shows the offset in the exception because I wanted to show this: All of them can be divided by 1024! (and maybe more)&lt;/p&gt;</comment>
                            <comment id="14566554" author="lehmi" created="Sun, 31 May 2015 13:54:48 +0000"  >&lt;p&gt;Yes, that&apos;s correct for now, but I&apos;m not yet done. &lt;br/&gt;
BTW, the PushBackInputStream uses a RandomAccressBufferedFileInputStream which is file-based, so that the user didn&apos;t had a choice to choose if to use a memory- or file-based copy of the given InputStream. Now, it&apos;s possible&lt;/p&gt;</comment>
                            <comment id="14566559" author="jira-bot" created="Sun, 31 May 2015 14:18:19 +0000"  >&lt;p&gt;Commit 1682738 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lehmi&quot; class=&quot;user-hover&quot; rel=&quot;lehmi&quot;&gt;lehmi&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1682738&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1682738&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2301&quot; title=&quot;RandomAccessBuffer consumes too much memory.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2301&quot;&gt;&lt;del&gt;PDFBOX-2301&lt;/del&gt;&lt;/a&gt;: override read(byte[]) to use buffer, added a loop to readFully so that always all needed bytes are read&lt;/p&gt;</comment>
                            <comment id="14566560" author="lehmi" created="Sun, 31 May 2015 14:22:27 +0000"  >&lt;p&gt;My last commit should have fixed that. Thanks for the pointer&lt;/p&gt;</comment>
                            <comment id="14566598" author="tilman" created="Sun, 31 May 2015 15:52:23 +0000"  >&lt;p&gt;all good now!&lt;/p&gt;</comment>
                            <comment id="14574217" author="lehmi" created="Fri, 5 Jun 2015 09:44:37 +0000"  >&lt;p&gt;Attached a patch to add paged scratch file support as proposed by Jesse Long on users@pdfbox&lt;/p&gt;</comment>
                            <comment id="14574559" author="jira-bot" created="Fri, 5 Jun 2015 14:34:07 +0000"  >&lt;p&gt;Commit 1683767 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lehmi&quot; class=&quot;user-hover&quot; rel=&quot;lehmi&quot;&gt;lehmi&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1683767&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1683767&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2301&quot; title=&quot;RandomAccessBuffer consumes too much memory.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2301&quot;&gt;&lt;del&gt;PDFBOX-2301&lt;/del&gt;&lt;/a&gt;: moved the temp file handling from PDFParser to RandomAccessBufferedFileInputStream&lt;/p&gt;</comment>
                            <comment id="14574734" author="jira-bot" created="Fri, 5 Jun 2015 16:01:33 +0000"  >&lt;p&gt;Commit 1683788 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lehmi&quot; class=&quot;user-hover&quot; rel=&quot;lehmi&quot;&gt;lehmi&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1683788&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1683788&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2301&quot; title=&quot;RandomAccessBuffer consumes too much memory.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2301&quot;&gt;&lt;del&gt;PDFBOX-2301&lt;/del&gt;&lt;/a&gt;: added input stream handling&lt;/p&gt;</comment>
                            <comment id="14574740" author="jira-bot" created="Fri, 5 Jun 2015 16:03:08 +0000"  >&lt;p&gt;Commit 1683789 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lehmi&quot; class=&quot;user-hover&quot; rel=&quot;lehmi&quot;&gt;lehmi&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1683789&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1683789&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2301&quot; title=&quot;RandomAccessBuffer consumes too much memory.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2301&quot;&gt;&lt;del&gt;PDFBOX-2301&lt;/del&gt;&lt;/a&gt;: added a new constructor to handle filenames as input&lt;/p&gt;</comment>
                            <comment id="14574783" author="jira-bot" created="Fri, 5 Jun 2015 16:28:49 +0000"  >&lt;p&gt;Commit 1683800 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lehmi&quot; class=&quot;user-hover&quot; rel=&quot;lehmi&quot;&gt;lehmi&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1683800&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1683800&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2301&quot; title=&quot;RandomAccessBuffer consumes too much memory.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2301&quot;&gt;&lt;del&gt;PDFBOX-2301&lt;/del&gt;&lt;/a&gt;: handle the creation of pdf source outside of the parser&lt;/p&gt;</comment>
                            <comment id="14575817" author="jira-bot" created="Sat, 6 Jun 2015 16:39:49 +0000"  >&lt;p&gt;Commit 1683929 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lehmi&quot; class=&quot;user-hover&quot; rel=&quot;lehmi&quot;&gt;lehmi&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1683929&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1683929&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2301&quot; title=&quot;RandomAccessBuffer consumes too much memory.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2301&quot;&gt;&lt;del&gt;PDFBOX-2301&lt;/del&gt;&lt;/a&gt;: use one scratch file instead of many as proposed by Jesse Long&lt;/p&gt;</comment>
                            <comment id="14575819" author="lehmi" created="Sat, 6 Jun 2015 16:41:51 +0000"  >&lt;p&gt;I&apos;ve added Jesses proposed patch with some slight modifications and reformatting. I&apos;ve added a license header to both new files too.&lt;/p&gt;

&lt;p&gt;Thanks for the contribution!&lt;/p&gt;</comment>
                            <comment id="14575826" author="jira-bot" created="Sat, 6 Jun 2015 16:53:25 +0000"  >&lt;p&gt;Commit 1683932 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lehmi&quot; class=&quot;user-hover&quot; rel=&quot;lehmi&quot;&gt;lehmi&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1683932&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1683932&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2301&quot; title=&quot;RandomAccessBuffer consumes too much memory.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2301&quot;&gt;&lt;del&gt;PDFBOX-2301&lt;/del&gt;&lt;/a&gt;: don&apos;t hold a reference of the parser within PDDocument but a reference of the pdfSource, BaseParser no longer implements Closeable&lt;/p&gt;</comment>
                            <comment id="14576229" author="jira-bot" created="Sun, 7 Jun 2015 13:09:39 +0000"  >&lt;p&gt;Commit 1684032 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lehmi&quot; class=&quot;user-hover&quot; rel=&quot;lehmi&quot;&gt;lehmi&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1684032&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1684032&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2301&quot; title=&quot;RandomAccessBuffer consumes too much memory.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2301&quot;&gt;&lt;del&gt;PDFBOX-2301&lt;/del&gt;&lt;/a&gt;: call seek to initialize all member values&lt;/p&gt;</comment>
                            <comment id="14576656" author="tilman" created="Mon, 8 Jun 2015 06:31:31 +0000"  >&lt;p&gt;Can we delete PushBackInputStream? It is no longer used.&lt;/p&gt;</comment>
                            <comment id="14577447" author="jira-bot" created="Mon, 8 Jun 2015 16:41:07 +0000"  >&lt;p&gt;Commit 1684219 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lehmi&quot; class=&quot;user-hover&quot; rel=&quot;lehmi&quot;&gt;lehmi&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1684219&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1684219&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2301&quot; title=&quot;RandomAccessBuffer consumes too much memory.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2301&quot;&gt;&lt;del&gt;PDFBOX-2301&lt;/del&gt;&lt;/a&gt;: removed no longer needed class&lt;/p&gt;</comment>
                            <comment id="14577450" author="lehmi" created="Mon, 8 Jun 2015 16:41:33 +0000"  >&lt;p&gt;Done&lt;/p&gt;</comment>
                            <comment id="14577711" author="jira-bot" created="Mon, 8 Jun 2015 19:39:53 +0000"  >&lt;p&gt;Commit 1684253 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lehmi&quot; class=&quot;user-hover&quot; rel=&quot;lehmi&quot;&gt;lehmi&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1684253&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1684253&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2301&quot; title=&quot;RandomAccessBuffer consumes too much memory.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2301&quot;&gt;&lt;del&gt;PDFBOX-2301&lt;/del&gt;&lt;/a&gt;: removed no longer needed code&lt;/p&gt;</comment>
                            <comment id="14579217" author="jira-bot" created="Tue, 9 Jun 2015 16:58:56 +0000"  >&lt;p&gt;Commit 1684477 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lehmi&quot; class=&quot;user-hover&quot; rel=&quot;lehmi&quot;&gt;lehmi&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1684477&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1684477&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2301&quot; title=&quot;RandomAccessBuffer consumes too much memory.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2301&quot;&gt;&lt;del&gt;PDFBOX-2301&lt;/del&gt;&lt;/a&gt;: fixed an AIOOB when reading more bytes than available&lt;/p&gt;</comment>
                            <comment id="14580696" author="jira-bot" created="Wed, 10 Jun 2015 15:58:33 +0000"  >&lt;p&gt;Commit 1684698 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lehmi&quot; class=&quot;user-hover&quot; rel=&quot;lehmi&quot;&gt;lehmi&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1684698&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1684698&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2301&quot; title=&quot;RandomAccessBuffer consumes too much memory.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2301&quot;&gt;&lt;del&gt;PDFBOX-2301&lt;/del&gt;&lt;/a&gt;: use a RandomAccessWrapper to get read only random access to the filtered/unfiltered stream of a COSStream&lt;/p&gt;</comment>
                            <comment id="14580768" author="jira-bot" created="Wed, 10 Jun 2015 16:41:06 +0000"  >&lt;p&gt;Commit 1684710 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lehmi&quot; class=&quot;user-hover&quot; rel=&quot;lehmi&quot;&gt;lehmi&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1684710&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1684710&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2301&quot; title=&quot;RandomAccessBuffer consumes too much memory.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2301&quot;&gt;&lt;del&gt;PDFBOX-2301&lt;/del&gt;&lt;/a&gt;: use direct access when reading a COSSTream instead of copying the input stream to a byte array&lt;/p&gt;</comment>
                            <comment id="14580963" author="jira-bot" created="Wed, 10 Jun 2015 19:13:21 +0000"  >&lt;p&gt;Commit 1684745 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lehmi&quot; class=&quot;user-hover&quot; rel=&quot;lehmi&quot;&gt;lehmi&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1684745&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1684745&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2301&quot; title=&quot;RandomAccessBuffer consumes too much memory.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2301&quot;&gt;&lt;del&gt;PDFBOX-2301&lt;/del&gt;&lt;/a&gt;: use direct access instead of copying the input stream to a byte array&lt;/p&gt;</comment>
                            <comment id="14585058" author="jira-bot" created="Sun, 14 Jun 2015 12:54:52 +0000"  >&lt;p&gt;Commit 1685399 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lehmi&quot; class=&quot;user-hover&quot; rel=&quot;lehmi&quot;&gt;lehmi&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1685399&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1685399&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2301&quot; title=&quot;RandomAccessBuffer consumes too much memory.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2301&quot;&gt;&lt;del&gt;PDFBOX-2301&lt;/del&gt;&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2829&quot; title=&quot;PDBox 2.0 Throws IndexOutOfBoundsException (severe offset errors as well)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2829&quot;&gt;&lt;del&gt;PDFBOX-2829&lt;/del&gt;&lt;/a&gt;: handle positions beyond EOF within seek&lt;/p&gt;</comment>
                            <comment id="14585239" author="jira-bot" created="Sun, 14 Jun 2015 20:12:21 +0000"  >&lt;p&gt;Commit 1685453 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lehmi&quot; class=&quot;user-hover&quot; rel=&quot;lehmi&quot;&gt;lehmi&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1685453&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1685453&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2301&quot; title=&quot;RandomAccessBuffer consumes too much memory.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2301&quot;&gt;&lt;del&gt;PDFBOX-2301&lt;/del&gt;&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2829&quot; title=&quot;PDBox 2.0 Throws IndexOutOfBoundsException (severe offset errors as well)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2829&quot;&gt;&lt;del&gt;PDFBOX-2829&lt;/del&gt;&lt;/a&gt;: take the given offset into account&lt;/p&gt;</comment>
                            <comment id="14586315" author="jira-bot" created="Mon, 15 Jun 2015 17:02:36 +0000"  >&lt;p&gt;Commit 1685630 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lehmi&quot; class=&quot;user-hover&quot; rel=&quot;lehmi&quot;&gt;lehmi&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1685630&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1685630&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2301&quot; title=&quot;RandomAccessBuffer consumes too much memory.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2301&quot;&gt;&lt;del&gt;PDFBOX-2301&lt;/del&gt;&lt;/a&gt;: added a seekBeyondEOF test&lt;/p&gt;</comment>
                            <comment id="14595041" author="jira-bot" created="Sun, 21 Jun 2015 12:58:34 +0000"  >&lt;p&gt;Commit 1686711 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lehmi&quot; class=&quot;user-hover&quot; rel=&quot;lehmi&quot;&gt;lehmi&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1686711&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1686711&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2301&quot; title=&quot;RandomAccessBuffer consumes too much memory.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2301&quot;&gt;&lt;del&gt;PDFBOX-2301&lt;/del&gt;&lt;/a&gt;: added write(byte[]) method for convenience, optimized isEOF&lt;/p&gt;</comment>
                            <comment id="14595058" author="jira-bot" created="Sun, 21 Jun 2015 14:14:18 +0000"  >&lt;p&gt;Commit 1686725 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lehmi&quot; class=&quot;user-hover&quot; rel=&quot;lehmi&quot;&gt;lehmi&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1686725&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1686725&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2301&quot; title=&quot;RandomAccessBuffer consumes too much memory.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2301&quot;&gt;&lt;del&gt;PDFBOX-2301&lt;/del&gt;&lt;/a&gt;: added new class SequenceRandomAccessRead including some test cases&lt;/p&gt;</comment>
                            <comment id="14595072" author="jira-bot" created="Sun, 21 Jun 2015 15:09:46 +0000"  >&lt;p&gt;Commit 1686737 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lehmi&quot; class=&quot;user-hover&quot; rel=&quot;lehmi&quot;&gt;lehmi&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1686737&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1686737&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2301&quot; title=&quot;RandomAccessBuffer consumes too much memory.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2301&quot;&gt;&lt;del&gt;PDFBOX-2301&lt;/del&gt;&lt;/a&gt;: seek bugfix&lt;/p&gt;</comment>
                            <comment id="14601979" author="jira-bot" created="Thu, 25 Jun 2015 21:29:44 +0000"  >&lt;p&gt;Commit 1687651 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lehmi&quot; class=&quot;user-hover&quot; rel=&quot;lehmi&quot;&gt;lehmi&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1687651&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1687651&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2301&quot; title=&quot;RandomAccessBuffer consumes too much memory.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2301&quot;&gt;&lt;del&gt;PDFBOX-2301&lt;/del&gt;&lt;/a&gt;: bugfix, optimized testcase&lt;/p&gt;</comment>
                            <comment id="14601989" author="jira-bot" created="Thu, 25 Jun 2015 21:33:31 +0000"  >&lt;p&gt;Commit 1687652 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lehmi&quot; class=&quot;user-hover&quot; rel=&quot;lehmi&quot;&gt;lehmi&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1687652&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1687652&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2301&quot; title=&quot;RandomAccessBuffer consumes too much memory.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2301&quot;&gt;&lt;del&gt;PDFBOX-2301&lt;/del&gt;&lt;/a&gt;: added support for getUnfilteredRandomAccess&lt;/p&gt;</comment>
                            <comment id="14601993" author="jira-bot" created="Thu, 25 Jun 2015 21:34:26 +0000"  >&lt;p&gt;Commit 1687653 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lehmi&quot; class=&quot;user-hover&quot; rel=&quot;lehmi&quot;&gt;lehmi&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1687653&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1687653&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2301&quot; title=&quot;RandomAccessBuffer consumes too much memory.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2301&quot;&gt;&lt;del&gt;PDFBOX-2301&lt;/del&gt;&lt;/a&gt;: don&apos;t copy the input stream of a COSStreamArray&lt;/p&gt;</comment>
                            <comment id="14602105" author="tilman" created="Thu, 25 Jun 2015 23:06:40 +0000"  >&lt;p&gt;Something went wrong with the last commits, I get errors or bad &lt;br/&gt;
renderings with several files. Try e.g. HoulihansVeggieMenu.pdf of&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-1608&quot; title=&quot;Rendering problem with Java 7 update 21&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-1608&quot;&gt;&lt;del&gt;PDFBOX-1608&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="14602394" author="tilman" created="Fri, 26 Jun 2015 04:53:40 +0000"  >&lt;p&gt;Some files that are rendered differently:&lt;/p&gt;

&lt;p&gt;166292-fi-ligature.pdf&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-142&quot; title=&quot;PDF to image bugs&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-142&quot;&gt;&lt;del&gt;PDFBOX-142&lt;/del&gt;&lt;/a&gt;-acroform.pdf&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-1094&quot; title=&quot;Pattern colorspace support&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-1094&quot;&gt;&lt;del&gt;PDFBOX-1094&lt;/del&gt;&lt;/a&gt;-118358-Step-32767.pdf  p5&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2163&quot; title=&quot;inline image with EI in the middle incorrectly parsed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2163&quot;&gt;&lt;del&gt;PDFBOX-2163&lt;/del&gt;&lt;/a&gt;-662062.pdf&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2307&quot; title=&quot;NPE in TrueTypeFont.getWidth&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2307&quot;&gt;&lt;del&gt;PDFBOX-2307&lt;/del&gt;&lt;/a&gt;-161334.pdf  p1,3,4&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2376&quot; title=&quot;Small regression in text extraction with PDFBox 1.8.7 vs. 1.8.6&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2376&quot;&gt;&lt;del&gt;PDFBOX-2376&lt;/del&gt;&lt;/a&gt;-894770.pdf&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2385&quot; title=&quot;inline image with EI at the end incorrectly parsed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2385&quot;&gt;&lt;del&gt;PDFBOX-2385&lt;/del&gt;&lt;/a&gt;-862497.pdf&lt;br/&gt;
swftools-gradients.pdf&lt;/p&gt;


&lt;p&gt;not rendered:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-205&quot; title=&quot;Miscellaneous errors on valid files&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-205&quot;&gt;&lt;del&gt;PDFBOX-205&lt;/del&gt;&lt;/a&gt;-hexnumberproblem.pdf&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-825&quot; title=&quot;Wrong opacity for images with indexed color space &quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-825&quot;&gt;&lt;del&gt;PDFBOX-825&lt;/del&gt;&lt;/a&gt;.pdf&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-1772&quot; title=&quot;Drawings missing in rendered images&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-1772&quot;&gt;&lt;del&gt;PDFBOX-1772&lt;/del&gt;&lt;/a&gt;.pdf&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-1809&quot; title=&quot;Embedded Fonts not drawn on Pages BufferedImage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-1809&quot;&gt;&lt;del&gt;PDFBOX-1809&lt;/del&gt;&lt;/a&gt;.pdf&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2103&quot; title=&quot;JPXFilter fails to decode some Jpeg2000 images&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2103&quot;&gt;&lt;del&gt;PDFBOX-2103&lt;/del&gt;&lt;/a&gt;.pdf&lt;/p&gt;



&lt;p&gt;My bet is on /Contents with an array of streams.&lt;/p&gt;</comment>
                            <comment id="14602509" author="lehmi" created="Fri, 26 Jun 2015 07:22:18 +0000"  >&lt;p&gt;I won&apos;t bet against it, because that&apos;s exactly what my last changes were about. I&apos;ll have a look later.&lt;/p&gt;

&lt;p&gt;Thanks again for constantly running the trunk against your huge pool of pdfs!&lt;/p&gt;</comment>
                            <comment id="14603135" author="jira-bot" created="Fri, 26 Jun 2015 16:22:14 +0000"  >&lt;p&gt;Commit 1687802 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lehmi&quot; class=&quot;user-hover&quot; rel=&quot;lehmi&quot;&gt;lehmi&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1687802&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1687802&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2301&quot; title=&quot;RandomAccessBuffer consumes too much memory.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2301&quot;&gt;&lt;del&gt;PDFBOX-2301&lt;/del&gt;&lt;/a&gt;: bugfix buffer switch, improve test cases&lt;/p&gt;</comment>
                            <comment id="14603137" author="lehmi" created="Fri, 26 Jun 2015 16:25:00 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; There were some issues when switching the underlying buffers. Should be fixed now.&lt;/p&gt;</comment>
                            <comment id="14603344" author="tilman" created="Fri, 26 Jun 2015 18:13:24 +0000"  >&lt;p&gt;All are fixed except one: the attached file swftools-gradients.pdf , which renders blank. The content stream is an array of 11 elements. Some of them are empty.&lt;/p&gt;</comment>
                            <comment id="14603431" author="jira-bot" created="Fri, 26 Jun 2015 19:02:31 +0000"  >&lt;p&gt;Commit 1687838 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lehmi&quot; class=&quot;user-hover&quot; rel=&quot;lehmi&quot;&gt;lehmi&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1687838&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1687838&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2301&quot; title=&quot;RandomAccessBuffer consumes too much memory.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2301&quot;&gt;&lt;del&gt;PDFBOX-2301&lt;/del&gt;&lt;/a&gt;: omit empty streams&lt;/p&gt;</comment>
                            <comment id="14603436" author="lehmi" created="Fri, 26 Jun 2015 19:06:27 +0000"  >&lt;p&gt;Now the &quot;special&quot; pdf swttool-gradients.pdf works as well. PDFBox now simply omits empty streams.&lt;/p&gt;</comment>
                            <comment id="14603583" author="tilman" created="Fri, 26 Jun 2015 21:09:15 +0000"  >&lt;p&gt;Thanks, all OK now.&lt;/p&gt;</comment>
                            <comment id="14604101" author="jira-bot" created="Sat, 27 Jun 2015 10:33:53 +0000"  >&lt;p&gt;Commit 1687905 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lehmi&quot; class=&quot;user-hover&quot; rel=&quot;lehmi&quot;&gt;lehmi&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1687905&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1687905&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2301&quot; title=&quot;RandomAccessBuffer consumes too much memory.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2301&quot;&gt;&lt;del&gt;PDFBOX-2301&lt;/del&gt;&lt;/a&gt;: handle empty buffers within SequenceRandomAccessRead&lt;/p&gt;</comment>
                            <comment id="14632046" author="jira-bot" created="Fri, 17 Jul 2015 22:35:26 +0000"  >&lt;p&gt;Commit 1691656 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jahewson&quot; class=&quot;user-hover&quot; rel=&quot;jahewson&quot;&gt;jahewson&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1691656&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1691656&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2301&quot; title=&quot;RandomAccessBuffer consumes too much memory.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2301&quot;&gt;&lt;del&gt;PDFBOX-2301&lt;/del&gt;&lt;/a&gt;: Split RandomAccessWrite into its own interface&lt;/p&gt;</comment>
                            <comment id="14632051" author="jahewson" created="Fri, 17 Jul 2015 22:36:49 +0000"  >&lt;p&gt;This is a minor code-quality refactoring, with no functional or API changes. We already had RandomAccessRead, but not RandomAccessWrite, so I split these into two for clarity. RandomAccess implements both.&lt;/p&gt;</comment>
                            <comment id="14633383" author="lehmi" created="Mon, 20 Jul 2015 10:23:21 +0000"  >&lt;p&gt;I&apos;m done here, see &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2893&quot; title=&quot;Simplify COSStream encoding and decoding&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2893&quot;&gt;&lt;del&gt;PDFBOX-2893&lt;/del&gt;&lt;/a&gt; may provide some more improvements&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12836478">PDFBOX-2825</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                                                <inwardlinks description="is depended upon by">
                                        <issuelink>
            <issuekey id="12645393">PDFBOX-1586</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12667563" name="clone.diff" size="1793" author="jojelino" created="Wed, 10 Sep 2014 01:06:40 +0000"/>
                            <attachment id="12669263" name="clone2.diff" size="2922" author="jojelino" created="Tue, 16 Sep 2014 23:44:46 +0000"/>
                            <attachment id="12669310" name="clone3.diff" size="4967" author="jojelino" created="Wed, 17 Sep 2014 02:39:54 +0000"/>
                            <attachment id="12670004" name="clone4.diff" size="12279" author="jojelino" created="Fri, 19 Sep 2014 14:34:38 +0000"/>
                            <attachment id="12737890" name="pdfbox-scratchfile.patch" size="27673" author="lehmi" created="Fri, 5 Jun 2015 09:44:37 +0000"/>
                            <attachment id="12742180" name="swftools-gradients.pdf" size="4441" author="tilman" created="Fri, 26 Jun 2015 18:10:20 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>6.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 17 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1zitr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>