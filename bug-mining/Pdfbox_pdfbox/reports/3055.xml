<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:15:33 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PDFBOX-5975] Class cast exception in building PDDestinationNameTreeNode</title>
                <link>https://issues.apache.org/jira/browse/PDFBOX-5975</link>
                <project id="12310760" key="PDFBOX">PDFBox</project>
                    <description>&lt;p&gt;In PDDestinationNameTreeNode.java on line 63 a PDDestination is created.&lt;/p&gt;

&lt;p&gt;This function returns a PDDestination which is then casted to a PDPageDestination.&lt;/p&gt;

&lt;p&gt;There is however also a PDDestination of type PDNamedDestination.&lt;/p&gt;

&lt;p&gt;When a page is opened of a document with a named destination and the destination tree node is created, such as on rendering or using the splitter, then just opening the page will fail with a class cast exception and the page can therefore not be rendered, and is not included in a split document.&lt;/p&gt;

&lt;p&gt;A test with a check of the instance type and return null does at least fix the exception.&lt;/p&gt;

&lt;p&gt;It is not clear whether named destinations should be handled here or ignored.&lt;/p&gt;</description>
                <environment>Windows</environment>
        <key id="13612413">PDFBOX-5975</key>
            <summary>Class cast exception in building PDDestinationNameTreeNode</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tilman">Tilman Hausherr</assignee>
                                    <reporter username="fransb">Frans Bouwmans</reporter>
                        <labels>
                    </labels>
                <created>Wed, 19 Mar 2025 17:04:39 +0000</created>
                <updated>Thu, 24 Apr 2025 18:37:53 +0000</updated>
                            <resolved>Thu, 20 Mar 2025 09:24:38 +0000</resolved>
                                    <version>2.0.33</version>
                    <version>3.0.4 PDFBox</version>
                                    <fixVersion>2.0.34</fixVersion>
                    <fixVersion>3.0.5 PDFBox</fixVersion>
                    <fixVersion>4.0.0</fixVersion>
                                    <component>PDModel</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="17936894" author="tilman" created="Wed, 19 Mar 2025 17:22:34 +0000"  >&lt;p&gt;Do you have a file that shows the problem?&lt;br/&gt;
I suspect it&apos;s an incorrect PDF, PDDestinationNameTreeNode should hold &quot;Name -&amp;gt; PageDestination&quot; relations. But if I&apos;m right about that, then we should catch incorrect entries.&lt;/p&gt;</comment>
                            <comment id="17936898" author="JIRAUSER301807" created="Wed, 19 Mar 2025 17:52:39 +0000"  >&lt;p&gt;It is in a very large file (over 3000 pages and &amp;gt; 270MB).&lt;/p&gt;

&lt;p&gt;There are 4 occurances of this problem. I cannot share the file and I tried to extract the page using nitro, after which the problem is gone (i.e. the named destination is likely not copied to the target file).&lt;/p&gt;

&lt;p&gt;The file opens fine in edge, adobe, and nitro.&lt;/p&gt;

&lt;p&gt;Is there a way that I can inspect the pdf with the PDFDebugger? I&apos;m not sure where these PDDestinations are hidden.&lt;/p&gt;

&lt;p&gt;I do note that when I add a check before the cast and in case if incorrect class return a null, that the debugger renders the page fine.&lt;/p&gt;</comment>
                            <comment id="17936917" author="tilman" created="Wed, 19 Mar 2025 19:02:27 +0000"  >&lt;p&gt;In PDFDebugger switch to the &quot;internal structure&quot; view, the name tree should be below root, it&apos;s called &quot;Names&quot;.&lt;br/&gt;
 &lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/13075532/13075532_image-2025-03-19-20-03-09-702.png&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt; &lt;/p&gt;

&lt;p&gt;If you can find where the &quot;bad&quot; element is, I&apos;d love to see a screenshot.&lt;/p&gt;</comment>
                            <comment id="17936918" author="tilman" created="Wed, 19 Mar 2025 19:11:30 +0000"  >&lt;p&gt;Here&apos;s an actual name tree:&lt;br/&gt;
 &lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/13075533/13075533_screenshot-1.png&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt; &lt;br/&gt;
File:  &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/13075534/13075534_000334.pdf&quot; title=&quot;000334.pdf attached to PDFBOX-5975&quot;&gt;000334.pdf&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt; &lt;/p&gt;</comment>
                            <comment id="17936924" author="JIRAUSER301807" created="Wed, 19 Mar 2025 19:49:37 +0000"  >&lt;p&gt;With a break point on the failure I was able to see the call stack and the intermediate nodes. That led me to the entry that has the issue and in the debugger it indeed looks different from the one above and below:&lt;/p&gt;

&lt;p&gt;I.e. the element highlighted in Blue is the one being retrieved:&#160;&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/13075535/13075535_image-2025-03-19-15-43-48-035.png&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;The stack trace as were that happens is the following:&lt;/p&gt;

&lt;p&gt;&#160; &lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/13075536/13075536_image-2025-03-19-15-49-23-060.png&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/p&gt;</comment>
                            <comment id="17936936" author="tilman" created="Wed, 19 Mar 2025 20:20:07 +0000"  >&lt;p&gt;That entry looks ok to me... the value would be entry 49 in the array (the next one) looks different to entry 47 but both are valid destination values. What I suspect is several string (key) entries. I was able to alter my file and reproduce the error. Only one line is needed if one knows the key:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
doc.getDocumentCatalog().findNamedDestinationPage(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; PDNamedDestination(&lt;span class=&quot;code-quote&quot;&gt;&quot;add83&quot;&lt;/span&gt;));
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17936937" author="tilman" created="Wed, 19 Mar 2025 20:24:19 +0000"  >&lt;p&gt;I&apos;ll sleep over this and fix it tomorrow. Most likely your initial suggestion is the correct thing to do. I was just wondering if there would be more to do, but I don&apos;t think so.&lt;/p&gt;</comment>
                            <comment id="17936939" author="JIRAUSER301807" created="Wed, 19 Mar 2025 20:28:25 +0000"  >&lt;p&gt;Ok great.&lt;/p&gt;</comment>
                            <comment id="17936940" author="JIRAUSER301807" created="Wed, 19 Mar 2025 20:30:00 +0000"  >&lt;p&gt;I tested on the 3.0 source tree (as I&apos;m using 3.0.4), I can test a fix against the problematic file if needed.&lt;/p&gt;</comment>
                            <comment id="17937054" author="jira-bot" created="Thu, 20 Mar 2025 08:54:31 +0000"  >&lt;p&gt;Commit 1924491 from Tilman Hausherr in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1924491&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1924491&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-5975&quot; title=&quot;Class cast exception in building PDDestinationNameTreeNode&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-5975&quot;&gt;&lt;del&gt;PDFBOX-5975&lt;/del&gt;&lt;/a&gt;: avoid ClassCastException, as suggested by Frans Bouwmans; remove super()&lt;/p&gt;</comment>
                            <comment id="17937055" author="jira-bot" created="Thu, 20 Mar 2025 08:54:35 +0000"  >&lt;p&gt;Commit 1924492 from Tilman Hausherr in branch &apos;pdfbox/branches/3.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1924492&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1924492&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-5975&quot; title=&quot;Class cast exception in building PDDestinationNameTreeNode&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-5975&quot;&gt;&lt;del&gt;PDFBOX-5975&lt;/del&gt;&lt;/a&gt;: avoid ClassCastException, as suggested by Frans Bouwmans; remove super()&lt;/p&gt;</comment>
                            <comment id="17937056" author="jira-bot" created="Thu, 20 Mar 2025 08:54:40 +0000"  >&lt;p&gt;Commit 1924493 from Tilman Hausherr in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1924493&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1924493&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-5975&quot; title=&quot;Class cast exception in building PDDestinationNameTreeNode&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-5975&quot;&gt;&lt;del&gt;PDFBOX-5975&lt;/del&gt;&lt;/a&gt;: avoid ClassCastException, as suggested by Frans Bouwmans; remove super()&lt;/p&gt;</comment>
                            <comment id="17937057" author="tilman" created="Thu, 20 Mar 2025 08:56:02 +0000"  >&lt;p&gt;Here&apos;s a file that shows the problem, and it no longer occurs after the fix:  &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/13075545/13075545_000671.pdf&quot; title=&quot;000671.pdf attached to PDFBOX-5975&quot;&gt;000671.pdf&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt; &lt;/p&gt;</comment>
                            <comment id="17937064" author="tilman" created="Thu, 20 Mar 2025 09:24:38 +0000"  >&lt;p&gt;A snapshot build is available here:&lt;br/&gt;
&lt;a href=&quot;https://repository.apache.org/content/groups/snapshots/org/apache/pdfbox/pdfbox-app/3.0.5-SNAPSHOT/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://repository.apache.org/content/groups/snapshots/org/apache/pdfbox/pdfbox-app/3.0.5-SNAPSHOT/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Thanks for reporting this and the solution!&lt;/p&gt;</comment>
                            <comment id="17937078" author="JIRAUSER301807" created="Thu, 20 Mar 2025 10:21:19 +0000"  >&lt;p&gt;Tested update on 3.0.5-SNAPSHOT against the problematic file and can confirm that the problem is resolved.&lt;/p&gt;

&lt;p&gt;Thanks for the quick response. Of course now is the question when there will be a release.&lt;/p&gt;</comment>
                            <comment id="17937083" author="tilman" created="Thu, 20 Mar 2025 10:34:59 +0000"  >&lt;p&gt;About every 3-6 months.&lt;br/&gt;
However the classic rendering isn&apos;t affected by the bug, only the one in PDFDebugger because it&apos;s collecting the link annotations to display something appropriate in the status bar. The splitter is affected, but this is only relevant if you want link annotations to be kept. If you don&apos;t, then remove them before splitting. If you need them, add a check for this specific bug (link annotation with named destination that throws a classcastexception) before splitting.&lt;/p&gt;</comment>
                            <comment id="17937086" author="JIRAUSER301807" created="Thu, 20 Mar 2025 10:44:24 +0000"  >&lt;p&gt;Ok, good to know. My viewer also gets the link annotations, so that is where I also get an error, but the page does display after a delay.&lt;/p&gt;

&lt;p&gt;Many thanks for a great library, I use it a lot to do stuff with pdf&apos;s (mostly viewing and analysing).&lt;/p&gt;

&lt;p&gt;Currently tinkering with OCR.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="13075534" name="000334.pdf" size="206182" author="tilman" created="Wed, 19 Mar 2025 19:11:28 +0000"/>
                            <attachment id="13075545" name="000671.pdf" size="867979" author="tilman" created="Thu, 20 Mar 2025 08:55:32 +0000"/>
                            <attachment id="13075535" name="image-2025-03-19-15-43-48-035.png" size="31984" author="fransb" created="Wed, 19 Mar 2025 19:43:49 +0000"/>
                            <attachment id="13075536" name="image-2025-03-19-15-49-23-060.png" size="50826" author="fransb" created="Wed, 19 Mar 2025 19:49:24 +0000"/>
                            <attachment id="13075532" name="image-2025-03-19-20-03-09-702.png" size="87325" author="tilman" created="Wed, 19 Mar 2025 19:03:10 +0000"/>
                            <attachment id="13075533" name="screenshot-1.png" size="73460" author="tilman" created="Wed, 19 Mar 2025 19:10:56 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>6.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            33 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1uvio:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>