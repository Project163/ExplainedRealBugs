<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:03:03 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PDFBOX-3276] Double encryption dictionary for files with XRef stream</title>
                <link>https://issues.apache.org/jira/browse/PDFBOX-3276</link>
                <project id="12310760" key="PDFBOX">PDFBox</project>
                    <description>&lt;p&gt;This was first mentioned by Patrick S. in the mailing list:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;This is not a general problem and only occurs with original PDF generated with 3D content using Anark. The file when loaded seems to have encrypted and loads just find in Adobe Reader, but when we try to do a &quot;Save As&quot; we get the following error:&lt;br/&gt;
&quot;The document could not be saved. There was a problem reading this document 21.&quot;&lt;/p&gt;

&lt;p&gt;If I do a control click on the &quot;ok&quot; button. I get the following message:&lt;br/&gt;
&quot;This direct object already has a container.&quot;&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I can reproduce the effect with the attached file by using the Encrypt command line tool. A look at the file shows a double dictionary:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;593 0 obj
&amp;lt;&amp;lt;
/Filter /Standard
/V 1
/R 3
/Length 40
/P -4
/O &amp;lt;10780080A0085854C58A57FCAFBD94A3CA3F7DF6FFE9DBC4834B7AAF144602C9&amp;gt;
/U &amp;lt;7CF00AD61911DB6A737867655ED3520C28BF4E5E4E758A4164004E56FFFA0108&amp;gt;
&amp;gt;&amp;gt;
endobj
594 0 obj
&amp;lt;&amp;lt;
/ID [&amp;lt;1D7A1969B33886DCF0DD4B0176F149AF&amp;gt; &amp;lt;C9898F3E11EAAD418E771B3045F38DDC&amp;gt;]
/Info 7 0 R
/Root 1 0 R
/Encrypt &amp;lt;&amp;lt;
/Filter /Standard
/V 1
/R 3
/Length 40
/P -4
/O &amp;lt;10780080A0085854C58A57FCAFBD94A3CA3F7DF6FFE9DBC4834B7AAF144602C9&amp;gt;
/U &amp;lt;7CF00AD61911DB6A737867655ED3520C28BF4E5E4E758A4164004E56FFFA0108&amp;gt;
&amp;gt;&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;I don&apos;t know if this is the cause, but it doesn&apos;t belong there.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12951307">PDFBOX-3276</key>
            <summary>Double encryption dictionary for files with XRef stream</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tilman">Tilman Hausherr</assignee>
                                    <reporter username="tilman">Tilman Hausherr</reporter>
                        <labels>
                    </labels>
                <created>Thu, 17 Mar 2016 19:29:43 +0000</created>
                <updated>Sat, 25 Mar 2017 18:13:29 +0000</updated>
                            <resolved>Fri, 18 Mar 2016 16:56:44 +0000</resolved>
                                    <version>2.0.0</version>
                    <version>2.0.1</version>
                    <version>3.0.0 PDFBox</version>
                                    <fixVersion>2.0.1</fixVersion>
                    <fixVersion>3.0.0 PDFBox</fixVersion>
                                    <component>Crypto</component>
                    <component>Writing</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="15201094" author="tilman" created="Fri, 18 Mar 2016 07:11:59 +0000"  >&lt;p&gt;The problem happens with any document that has an XRef stream. It can be reproduced with this code:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; (PDDocument document = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; PDDocument())
{
    PDPage page = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; PDPage(PDRectangle.A4);
    document.addPage(page);

    &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; (PDPageContentStream stream = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; PDPageContentStream(document, page))
    {
        stream.beginText();
        stream.setFont(PDType1Font.HELVETICA, 12);
        stream.newLineAtOffset(50, 600);
        stream.showText(&lt;span class=&quot;code-quote&quot;&gt;&quot;PDFBox&quot;&lt;/span&gt;);
        stream.endText();
    }

    document.protect(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; StandardProtectionPolicy(&lt;span class=&quot;code-quote&quot;&gt;&quot;owner&quot;&lt;/span&gt;, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; AccessPermission()));
    document.getDocumentCatalog().setVersion(&lt;span class=&quot;code-quote&quot;&gt;&quot;1.5&quot;&lt;/span&gt;);
    document.getDocument().setIsXRefStream(&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;);
    document.save(&lt;span class=&quot;code-quote&quot;&gt;&quot;encrypted.pdf&quot;&lt;/span&gt;);
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="15201097" author="tilman" created="Fri, 18 Mar 2016 07:15:12 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=prstahle&quot; class=&quot;user-hover&quot; rel=&quot;prstahle&quot;&gt;prstahle&lt;/a&gt; here&apos;s a workaround for you until we&apos;ve fixed the problem:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;COSDictionary trailer = document.getDocument().getTrailer();
trailer.removeItem(COSName.XREF_STM);
trailer.removeItem(COSName.TYPE);
trailer.removeItem(COSName.INDEX);
trailer.removeItem(COSName.W);
trailer.removeItem(COSName.FILTER);
trailer.removeItem(COSName.DECODE_PARMS);
trailer.removeItem(COSName.LENGTH);
document.getDocument().setIsXRefStream(&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;It will increase the length of the files a little bit. Please test whether the effect you described goes away.&lt;/p&gt;</comment>
                            <comment id="15201780" author="jira-bot" created="Fri, 18 Mar 2016 16:53:24 +0000"  >&lt;p&gt;Commit 1735640 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1735640&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1735640&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3276&quot; title=&quot;Double encryption dictionary for files with XRef stream&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3276&quot;&gt;&lt;del&gt;PDFBOX-3276&lt;/del&gt;&lt;/a&gt;: /Encrypt dictionary has already been written, so don&apos;t make it direct and write it a second time&lt;/p&gt;</comment>
                            <comment id="15201781" author="jira-bot" created="Fri, 18 Mar 2016 16:54:07 +0000"  >&lt;p&gt;Commit 1735641 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1735641&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1735641&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3276&quot; title=&quot;Double encryption dictionary for files with XRef stream&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3276&quot;&gt;&lt;del&gt;PDFBOX-3276&lt;/del&gt;&lt;/a&gt;: /Encrypt dictionary has already been written, so don&apos;t make it direct and write it a second time&lt;/p&gt;</comment>
                            <comment id="15201784" author="tilman" created="Fri, 18 Mar 2016 16:56:44 +0000"  >&lt;p&gt;This should solve your problem, a SNAPSHOT should be available soon. Don&apos;t forget to remove your workaround.&lt;/p&gt;</comment>
                            <comment id="15201931" author="prstahle" created="Fri, 18 Mar 2016 18:28:35 +0000"  >&lt;p&gt;Hi Tillman,&lt;/p&gt;

&lt;p&gt;The workaround works.&lt;/p&gt;

&lt;p&gt;Thanks.&lt;/p&gt;</comment>
                            <comment id="15201935" author="tilman" created="Fri, 18 Mar 2016 18:32:33 +0000"  >&lt;p&gt;But make sure that the fix also works, and if not, please reopen the issue &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; It should be available in maven, or here within a few hours&lt;br/&gt;
&lt;a href=&quot;https://repository.apache.org/content/groups/snapshots/org/apache/pdfbox/pdfbox-app/2.0.1-SNAPSHOT/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://repository.apache.org/content/groups/snapshots/org/apache/pdfbox/pdfbox-app/2.0.1-SNAPSHOT/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15201945" author="jira-bot" created="Fri, 18 Mar 2016 18:42:18 +0000"  >&lt;p&gt;Commit 1735656 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1735656&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1735656&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3276&quot; title=&quot;Double encryption dictionary for files with XRef stream&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3276&quot;&gt;&lt;del&gt;PDFBOX-3276&lt;/del&gt;&lt;/a&gt;: refactor double code&lt;/p&gt;</comment>
                            <comment id="15201949" author="jira-bot" created="Fri, 18 Mar 2016 18:43:45 +0000"  >&lt;p&gt;Commit 1735657 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1735657&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1735657&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3276&quot; title=&quot;Double encryption dictionary for files with XRef stream&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3276&quot;&gt;&lt;del&gt;PDFBOX-3276&lt;/del&gt;&lt;/a&gt;: refactor double code&lt;/p&gt;</comment>
                            <comment id="15204108" author="prstahle" created="Mon, 21 Mar 2016 12:38:19 +0000"  >&lt;p&gt;Tested the real fix without the workaround on the 2.0.1 branch, and it worked. Thanks....&lt;/p&gt;</comment>
                            <comment id="15207088" author="prstahle" created="Tue, 22 Mar 2016 19:23:40 +0000"  >&lt;p&gt;Hi Tilman,&lt;/p&gt;

&lt;p&gt;Was wondering if there is a rough idea of how quick there will be a release version of 2.0.1. I need to plan for our internal release of our code if I should plan on using PDFBox 2.0.0 with the workaround or if I can use a release of 2.0.1.... Right now I am using the 2.0.1-snapshot, but soon I want to switch to a stable release to make sure I don&apos;t accidentally pick up a new snapshot...&lt;/p&gt;

&lt;p&gt;Thanks,&lt;br/&gt;
Patrick&lt;/p&gt;

</comment>
                            <comment id="15207124" author="tilman" created="Tue, 22 Mar 2016 19:43:56 +0000"  >&lt;p&gt;I don&apos;t know, but the 1.8 versions were released about every 3 months. We don&apos;t have fixed released schedules.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12905575">PDFBOX-3034</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12794040" name="annots-encrypted.pdf" size="457161" author="tilman" created="Thu, 17 Mar 2016 19:32:01 +0000"/>
                            <attachment id="12794041" name="annots.pdf" size="393314" author="tilman" created="Thu, 17 Mar 2016 19:32:01 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 34 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2uufr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>