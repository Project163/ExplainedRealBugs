<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 20:54:15 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PDFBOX-1580] Oracle JVM crashes because of embedded fonts.</title>
                <link>https://issues.apache.org/jira/browse/PDFBOX-1580</link>
                <project id="12310760" key="PDFBOX">PDFBox</project>
                    <description>&lt;p&gt;Oracle&apos;s closed-source font rendering chokes on some fonts embedded in PDFs because their cmap data is either missing or invalid.&lt;br/&gt;
Using OpenJDK, no crashes were observed.&lt;/p&gt;

&lt;p&gt;The JVM crashes right after attempting to draw a glyph vector using codepoints, which is called from within PDSimpleFont#drawString.&lt;br/&gt;
Versions of pdfbox prior to 1.7.0 did not crash.&lt;/p&gt;

&lt;p&gt;The crashes look like this:&lt;/p&gt;

&lt;p&gt;JRE 6:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;JRE version: 6.0_45-b06&lt;/li&gt;
	&lt;li&gt;Java VM: Java HotSpot(TM) 64-Bit Server VM (20.45-b01 mixed mode linux-amd64 compressed oops)&lt;/li&gt;
	&lt;li&gt;Problematic frame:&lt;/li&gt;
	&lt;li&gt;C  &lt;span class=&quot;error&quot;&gt;&amp;#91;libfontmanager.so+0x242c8&amp;#93;&lt;/span&gt;  imaginary long double+0xd8&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;JRE 7:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;JRE version: 7.0_21-b11&lt;/li&gt;
	&lt;li&gt;Java VM: Java HotSpot(TM) 64-Bit Server VM (23.21-b01 mixed mode linux-amd64 compressed oops)&lt;/li&gt;
	&lt;li&gt;Problematic frame:&lt;/li&gt;
	&lt;li&gt;C  &lt;span class=&quot;error&quot;&gt;&amp;#91;libt2k.so+0x2e6b1&amp;#93;&lt;/span&gt;  Compute_cmapClass_GlyphIndex+0x1&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;Since older versions of pdfbox did not crash, I tracked the problem down to a call to java.awt.Font#canDisplayUpTo(String) that has been moved in 1.7.0 from the top of PDSimpleFont#drawString down to a branch. Moving the call back up prevented the crash.&lt;/p&gt;

&lt;p&gt;It looks like a call to java.awt.Font#canDisplay(int) initializes some internal data structures of Oracle&apos;s fontmanager, preventing the JVM crash.&lt;br/&gt;
As I have observed this crash only for fonts that have been processed through PDType0Font, I have added a fix there, which should save us some cycles and, more importantly, should not create new problems.&lt;/p&gt;

&lt;p&gt;Oracle bug reports have been filed for both JRE 6 and 7, including a &quot;minimal&quot; test case:&lt;br/&gt;
Oracle JRE 6: &lt;a href=&quot;http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=9002077&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=9002077&lt;/a&gt;&lt;br/&gt;
Oracle JRE 7: &lt;a href=&quot;http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=9002078&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=9002078&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;There have been a few other bug reports mentioning a similar crash on other platforms, older JRE versions, e.g.: &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-1426&quot; title=&quot;JVM crashes when trying to process the attached pdf&amp;#39;s&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-1426&quot;&gt;&lt;del&gt;PDFBOX-1426&lt;/del&gt;&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-1336&quot; title=&quot;JVM Crashes on Linux OS + Sun JVM + PDFBox&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-1336&quot;&gt;&lt;del&gt;PDFBOX-1336&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
The patch provided here might fix these bugs, too.&lt;/p&gt;</description>
                <environment>Linux 64-bit&lt;br/&gt;
Oracle JRE 6.0_45-b06 or 7.0_21-b11&lt;br/&gt;
</environment>
        <key id="12644845">PDFBOX-1580</key>
            <summary>Oracle JVM crashes because of embedded fonts.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tchojecki">Thomas Chojecki</assignee>
                                    <reporter username="ck@newsclub.de">Christian Kohlsch&#252;tter</reporter>
                        <labels>
                            <label>PatchAvailable</label>
                            <label>Regression</label>
                    </labels>
                <created>Fri, 26 Apr 2013 15:00:11 +0000</created>
                <updated>Sun, 2 Jun 2013 13:35:28 +0000</updated>
                            <resolved>Tue, 30 Apr 2013 20:15:19 +0000</resolved>
                                    <version>1.7.0</version>
                    <version>1.7.1</version>
                    <version>1.8.0</version>
                    <version>1.8.1</version>
                                    <fixVersion>1.8.2</fixVersion>
                                    <component>PDModel</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="13642931" author="ck@newsclub.de" created="Fri, 26 Apr 2013 15:01:19 +0000"  >&lt;p&gt;The patch.&lt;/p&gt;</comment>
                            <comment id="13645853" author="tchojecki" created="Tue, 30 Apr 2013 19:09:54 +0000"  >&lt;p&gt;thanks for contributing this patch.&lt;/p&gt;

&lt;p&gt;I&apos;ve tried to look at this bug reports but there seem to be gone/removed. Did you have a test for this issue? So I could fix it asap.&lt;/p&gt;</comment>
                            <comment id="13645856" author="ck@newsclub.de" created="Tue, 30 Apr 2013 19:16:51 +0000"  >&lt;p&gt;I&apos;ve uploaded the code that crashes Oracle JREs to: &lt;a href=&quot;http://pastebin.com/vhQ958kc&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://pastebin.com/vhQ958kc&lt;/a&gt;&lt;br/&gt;
It has no dependencies (that is, not even to pdfbox).&lt;/p&gt;</comment>
                            <comment id="13645927" author="tchojecki" created="Tue, 30 Apr 2013 20:15:19 +0000"  >&lt;p&gt;Fixed in rev. 1477806&lt;/p&gt;</comment>
                            <comment id="13647778" author="lehmi" created="Thu, 2 May 2013 18:22:27 +0000"  >&lt;p&gt;I rearranged the code to avoid unneeded calls in revision 1478472&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12580710" name="PDFBOX-1580.patch" size="460" author="ck@newsclub.de" created="Fri, 26 Apr 2013 15:01:19 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>325207</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 29 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1k3tz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>325552</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>