<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 20:57:26 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PDFBOX-2356] Error Validating PDF Archive Document with half hour timezone</title>
                <link>https://issues.apache.org/jira/browse/PDFBOX-2356</link>
                <project id="12310760" key="PDFBOX">PDFBox</project>
                    <description>&lt;p&gt;When trying to validate a PDF archive file (attached to this ticket) we get the following error:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;7.2   - Error on MetaData, ModificationDate present in the document catalog dictionary doesn&apos;t match with XMP information
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This is because the the Modification Date in the Dictionary is parsed differently from the XMP Metadata.  The XMP Metadata is correct, but the Date from the Dictionary appends an extra 30 minutes.&lt;/p&gt;

&lt;p&gt;The following is the raw COSObject from the PDF File&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;COSString{D:20140917122850+09&lt;span class=&quot;code-quote&quot;&gt;&apos;30&apos;&lt;/span&gt;}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The Long value should be &lt;b&gt;1410922730000&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;The &lt;b&gt;org.apache.pdfbox.util.DateConverter&lt;/b&gt; &lt;b&gt;parseDate&lt;/b&gt; method returns the Date with Long &lt;b&gt;1410924530000&lt;/b&gt; which is 30 minutes ahead.&lt;/p&gt;

&lt;p&gt;XMP Modification Date is parsed differently and returns the correct date.&lt;/p&gt;

&lt;p&gt;This means that validation will fail for PDF Archives.&lt;/p&gt;

&lt;p&gt;My suggestion would be to refactor the parseDate function to use the Standard Java library.&lt;/p&gt;

&lt;p&gt;Here&apos;s an example class which will be compatible with the PDF Specification:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;DateParser {

 &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; Map&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;, SimpleDateFormat&amp;gt; formats =
   &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; HashMap&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;, SimpleDateFormat&amp;gt;();
 
 &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; DateParser() {
   &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; expr = &quot;&quot;;
 
  &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt;(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; part: Arrays.asList(&lt;span class=&quot;code-quote&quot;&gt;&quot;yyyy&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;MM&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;dd&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;HH&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;mm&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;ss&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;Z&quot;&lt;/span&gt;)) {
     expr = expr + part;
     formats.put(expr.length(), &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; SimpleDateFormat(expr));
   }
 }
 
 &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; Calendar parseDate(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; expr) {
   &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
     expr = expr.replace(&lt;span class=&quot;code-quote&quot;&gt;&quot;D:&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;&quot;).replace(&quot;&lt;/span&gt;&apos;&lt;span class=&quot;code-quote&quot;&gt;&quot;, &quot;&lt;/span&gt;&lt;span class=&quot;code-quote&quot;&gt;&quot;).replace(&quot;&lt;/span&gt;Z&lt;span class=&quot;code-quote&quot;&gt;&quot;, &quot;&lt;/span&gt;+0000&quot;);
     Date date = formats.get(&lt;span class=&quot;code-object&quot;&gt;Math&lt;/span&gt;.min(expr.length(), 15)).parse(expr);
 
 
     Calendar calendar =  Calendar.getInstance();
     calendar.setTime(date);
 
     &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; calendar;
   } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (ParseException e) {
     &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;
   }
 }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12742043">PDFBOX-2356</key>
            <summary>Error Validating PDF Archive Document with half hour timezone</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tilman">Tilman Hausherr</assignee>
                                    <reporter username="cetra3">Cetra Free</reporter>
                        <labels>
                    </labels>
                <created>Wed, 17 Sep 2014 04:46:23 +0000</created>
                <updated>Sat, 13 Dec 2014 14:15:10 +0000</updated>
                            <resolved>Thu, 18 Sep 2014 16:18:12 +0000</resolved>
                                    <version>1.8.4</version>
                    <version>1.8.5</version>
                    <version>1.8.6</version>
                    <version>1.8.7</version>
                    <version>1.8.8</version>
                    <version>2.0.0</version>
                                    <fixVersion>1.8.8</fixVersion>
                    <fixVersion>2.0.0</fixVersion>
                                    <component>Preflight</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="14137490" author="tilman" created="Wed, 17 Sep 2014 16:27:27 +0000"  >&lt;p&gt;Are you building from source? If yes, please try this:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void adjustTimeZoneNicely(GregorianCalendar cal, TimeZone tz)
    {
        cal.setTimeZone(tz);
        &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; offset = (cal.get(Calendar.ZONE_OFFSET) + cal.get(Calendar.DST_OFFSET)) / 
                MILLIS_PER_MINUTE;
        cal.add(Calendar.MINUTE, -offset);
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;If no, please post a minimal code or command line that you used to check your file (I never use preflight) and I&apos;ll test it.&lt;/p&gt;</comment>
                            <comment id="14138197" author="cetra3" created="Wed, 17 Sep 2014 23:26:29 +0000"  >&lt;p&gt;I&apos;m just using the code from here:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://pdfbox.apache.org/cookbook/pdfavalidation.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://pdfbox.apache.org/cookbook/pdfavalidation.html&lt;/a&gt;&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;ValidationResult result = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;

FileDataSource fd = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; FileDataSource(args[0]);
PreflightParser parser = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; PreflightParser(fd);
&lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {

  /* Parse the PDF file with PreflightParser that inherits from the NonSequentialParser.
   * Some additional controls are present to check a set of PDF/A requirements. 
   * (Stream length consistency, EOL after some Keyword...)
   */
  parser.parse();

  /* Once the syntax validation is done, 
   * the parser can provide a PreflightDocument 
   * (that inherits from PDDocument) 
   * This document process the end of PDF/A validation.
   */
  PreflightDocument document = parser.getPreflightDocument();
  document.validate();

  &lt;span class=&quot;code-comment&quot;&gt;// Get validation result
&lt;/span&gt;  result = document.getResult();
  document.close();

} &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (SyntaxValidationException e) {
  /* the parse method can &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; a SyntaxValidationException 
   *&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; the PDF file can&apos;t be parsed.
   */ In &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt;, the exception contains an instance of ValidationResult  
  result = e.getResult();
}

&lt;span class=&quot;code-comment&quot;&gt;// display validation result
&lt;/span&gt;&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (result.isValid()) {
  &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(&lt;span class=&quot;code-quote&quot;&gt;&quot;The file &quot;&lt;/span&gt; + args[0] + &lt;span class=&quot;code-quote&quot;&gt;&quot; is a valid PDF/A-1b file&quot;&lt;/span&gt;);
} &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
  &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(&lt;span class=&quot;code-quote&quot;&gt;&quot;The file&quot;&lt;/span&gt; + args[0] + &lt;span class=&quot;code-quote&quot;&gt;&quot; is not valid, error(s) :&quot;&lt;/span&gt;);
  &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (ValidationError error : result.getErrorsList()) {
    &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(error.getErrorCode() + &lt;span class=&quot;code-quote&quot;&gt;&quot; : &quot;&lt;/span&gt; + error.getDetails());
  }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14138580" author="tilman" created="Thu, 18 Sep 2014 06:30:12 +0000"  >&lt;p&gt;1) My change does work with your file, but I will expand the tests tonight and then commit the changes and they&apos;ll be available in the snapshot and in the next release in a few months&lt;br/&gt;
2) Your issue indicates that PDFBox preflight has never been used in India.&lt;br/&gt;
&lt;a href=&quot;http://geography.about.com/od/culturalgeography/a/offsettimezones.htm&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://geography.about.com/od/culturalgeography/a/offsettimezones.htm&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14138591" author="cetra3" created="Thu, 18 Sep 2014 06:43:13 +0000"  >&lt;p&gt;Well, it&apos;s actually Adelaide/Australia!&lt;/p&gt;

&lt;p&gt;Which is +9:30 or +10:30 depending on the time of the year (&lt;a href=&quot;http://en.wikipedia.org/wiki/Australian_Time&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://en.wikipedia.org/wiki/Australian_Time&lt;/a&gt;)&lt;/p&gt;

&lt;p&gt;There is also a +8:45 time zone just to make things confusing.&lt;/p&gt;</comment>
                            <comment id="14139105" author="tilman" created="Thu, 18 Sep 2014 16:04:08 +0000"  >&lt;p&gt;I will also add tests for the timezone &quot;Australia/Adelaide&quot; in your honour &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="14139109" author="jira-bot" created="Thu, 18 Sep 2014 16:08:17 +0000"  >&lt;p&gt;Commit 1626014 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/branches/1.8&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1626014&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1626014&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2356&quot; title=&quot;Error Validating PDF Archive Document with half hour timezone&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2356&quot;&gt;&lt;del&gt;PDFBOX-2356&lt;/del&gt;&lt;/a&gt;: correct handling of part hour timezones&lt;/p&gt;</comment>
                            <comment id="14139110" author="jira-bot" created="Thu, 18 Sep 2014 16:08:45 +0000"  >&lt;p&gt;Commit 1626015 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1626015&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1626015&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2356&quot; title=&quot;Error Validating PDF Archive Document with half hour timezone&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2356&quot;&gt;&lt;del&gt;PDFBOX-2356&lt;/del&gt;&lt;/a&gt;: correct handling of part hour timezones&lt;/p&gt;</comment>
                            <comment id="14139113" author="jira-bot" created="Thu, 18 Sep 2014 16:09:53 +0000"  >&lt;p&gt;Commit 1626016 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1626016&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1626016&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2356&quot; title=&quot;Error Validating PDF Archive Document with half hour timezone&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2356&quot;&gt;&lt;del&gt;PDFBOX-2356&lt;/del&gt;&lt;/a&gt;: add tests for part hour timezones&lt;/p&gt;</comment>
                            <comment id="14139114" author="jira-bot" created="Thu, 18 Sep 2014 16:10:06 +0000"  >&lt;p&gt;Commit 1626017 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/branches/1.8&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1626017&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1626017&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2356&quot; title=&quot;Error Validating PDF Archive Document with half hour timezone&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2356&quot;&gt;&lt;del&gt;PDFBOX-2356&lt;/del&gt;&lt;/a&gt;: add tests for part hour timezones&lt;/p&gt;</comment>
                            <comment id="14139126" author="tilman" created="Thu, 18 Sep 2014 16:16:24 +0000"  >&lt;p&gt;You can get the snapshot version here in a few hours:&lt;br/&gt;
&lt;a href=&quot;https://repository.apache.org/content/groups/snapshots/org/apache/pdfbox/preflight/1.8.8-SNAPSHOT/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://repository.apache.org/content/groups/snapshots/org/apache/pdfbox/preflight/1.8.8-SNAPSHOT/&lt;/a&gt;&lt;br/&gt;
(look at the date)&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12669335" name="pdfafile.pdf" size="24268" author="cetra3" created="Wed, 17 Sep 2014 04:47:02 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 9 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2053r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>