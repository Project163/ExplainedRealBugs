<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:00:14 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PDFBOX-2792] Text extraction ignores bookmarks</title>
                <link>https://issues.apache.org/jira/browse/PDFBOX-2792</link>
                <project id="12310760" key="PDFBOX">PDFBox</project>
                    <description>&lt;p&gt;As reported by Noam S. on the user mailing list:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;My problem is that when trying to getText(doc) form a certain section of the pdf using setStartBookmark(item) and setEndBookmark(item) I get all the text rather than just the text from the specified section.&lt;/p&gt;

&lt;p&gt;WhiIe trying to resolve this I realized that the writeText(doc, outputStream) method always calls resetEngine() method. That will reset all the parameters and delete the bookmarks I set.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;The two lines that reset the bookmarks were added to resetEngine in &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-1808&quot; title=&quot;PDFTextStripper.getText - hight memory usage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-1808&quot;&gt;&lt;del&gt;PDFBOX-1808&lt;/del&gt;&lt;/a&gt; in [ &lt;a href=&quot;https://svn.apache.org/r1553175&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1553175&lt;/a&gt; ] in an attempt to save some memory.&lt;/p&gt;

&lt;p&gt;Another weird segment can be found in the trunk:&lt;/p&gt;

&lt;p&gt;I also found another weird piece of code in the trunk, which would mean that text extraction would fail if start and end bookmarks are identical:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (startPage != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; &amp;amp;&amp;amp; endPage != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; &amp;amp;&amp;amp;
            startBookmark.getCOSObject() == endBookmark.getCOSObject())
        {
            &lt;span class=&quot;code-comment&quot;&gt;// &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; is a special &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt; where both the start and end bookmark
&lt;/span&gt;            &lt;span class=&quot;code-comment&quot;&gt;// are the same but point to nothing.  In &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt;
&lt;/span&gt;            &lt;span class=&quot;code-comment&quot;&gt;// we will not extract any text.
&lt;/span&gt;            startBookmarkPageNumber = 0;
            endBookmarkPageNumber = 0;
        }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt; earlier, that segment was:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;       &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt;( startBookmarkPageNumber == -1 &amp;amp;&amp;amp; startBookmark != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; &amp;amp;&amp;amp;
                endBookmarkPageNumber == -1 &amp;amp;&amp;amp; endBookmark != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; &amp;amp;&amp;amp;
                startBookmark.getCOSObject() == endBookmark.getCOSObject() )
        {
            &lt;span class=&quot;code-comment&quot;&gt;//&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; is a special &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt; where both the start and end bookmark
&lt;/span&gt;            &lt;span class=&quot;code-comment&quot;&gt;//are the same but point to nothing.  In &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt;
&lt;/span&gt;            &lt;span class=&quot;code-comment&quot;&gt;//we will not extract any text.
&lt;/span&gt;            startBookmarkPageNumber = 0;
            endBookmarkPageNumber = 0;
        }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;which makes more sense. The change was made last year in rev [ &lt;a href=&quot;https://svn.apache.org/r1634252&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1634252&lt;/a&gt; ] as part of the pagetree refactoring.&lt;/p&gt;

&lt;p&gt;I am writing a test to prevent this from breaking in the future.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12828641">PDFBOX-2792</key>
            <summary>Text extraction ignores bookmarks</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tilman">Tilman Hausherr</assignee>
                                    <reporter username="tilman">Tilman Hausherr</reporter>
                        <labels>
                            <label>regression</label>
                    </labels>
                <created>Sun, 10 May 2015 05:42:18 +0000</created>
                <updated>Thu, 23 Jul 2015 06:35:44 +0000</updated>
                            <resolved>Sun, 10 May 2015 14:27:59 +0000</resolved>
                                    <version>1.8.9</version>
                    <version>2.0.0</version>
                                    <fixVersion>1.8.10</fixVersion>
                    <fixVersion>2.0.0</fixVersion>
                                    <component>Text extraction</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="14537182" author="jira-bot" created="Sun, 10 May 2015 14:04:54 +0000"  >&lt;p&gt;Commit 1678560 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1678560&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1678560&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2792&quot; title=&quot;Text extraction ignores bookmarks&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2792&quot;&gt;&lt;del&gt;PDFBOX-2792&lt;/del&gt;&lt;/a&gt;: fix regressions in text stripping where page intervals are controlled by bookmarks&lt;/p&gt;</comment>
                            <comment id="14537190" author="jira-bot" created="Sun, 10 May 2015 14:25:39 +0000"  >&lt;p&gt;Commit 1678561 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/branches/1.8&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1678561&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1678561&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2792&quot; title=&quot;Text extraction ignores bookmarks&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2792&quot;&gt;&lt;del&gt;PDFBOX-2792&lt;/del&gt;&lt;/a&gt;: fix regressions in text stripping where page intervals are controlled by bookmarks&lt;/p&gt;</comment>
                            <comment id="14537196" author="tilman" created="Sun, 10 May 2015 14:27:59 +0000"  >&lt;p&gt;Done; only 2 lines needed to be restored in 1.8, but in the trunk there was more to do.&lt;/p&gt;</comment>
                            <comment id="14537197" author="jira-bot" created="Sun, 10 May 2015 14:29:40 +0000"  >&lt;p&gt;Commit 1678562 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/branches/1.8&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1678562&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1678562&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2792&quot; title=&quot;Text extraction ignores bookmarks&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2792&quot;&gt;&lt;del&gt;PDFBOX-2792&lt;/del&gt;&lt;/a&gt;: clarify javadoc&lt;/p&gt;</comment>
                            <comment id="14537240" author="jira-bot" created="Sun, 10 May 2015 15:58:15 +0000"  >&lt;p&gt;Commit 1678573 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1678573&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1678573&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2792&quot; title=&quot;Text extraction ignores bookmarks&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2792&quot;&gt;&lt;del&gt;PDFBOX-2792&lt;/del&gt;&lt;/a&gt;: add test with orphan bookmark&lt;/p&gt;</comment>
                            <comment id="14537241" author="jira-bot" created="Sun, 10 May 2015 15:58:25 +0000"  >&lt;p&gt;Commit 1678574 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/branches/1.8&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1678574&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1678574&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2792&quot; title=&quot;Text extraction ignores bookmarks&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2792&quot;&gt;&lt;del&gt;PDFBOX-2792&lt;/del&gt;&lt;/a&gt;: add test with orphan bookmark&lt;/p&gt;</comment>
                            <comment id="14540221" author="jira-bot" created="Tue, 12 May 2015 17:03:15 +0000"  >&lt;p&gt;Commit 1679004 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1679004&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1679004&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2792&quot; title=&quot;Text extraction ignores bookmarks&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2792&quot;&gt;&lt;del&gt;PDFBOX-2792&lt;/del&gt;&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2793&quot; title=&quot;/Dests dictionary isn&amp;#39;t supported&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2793&quot;&gt;&lt;del&gt;PDFBOX-2793&lt;/del&gt;&lt;/a&gt;: fix regression from rev 1634252 - PDPageDestination.getPageNumber() returns zero-based result, so don&apos;t substract 1 when passing result to PDDocument.getPage()&lt;/p&gt;</comment>
                            <comment id="14544281" author="jira-bot" created="Thu, 14 May 2015 20:13:37 +0000"  >&lt;p&gt;Commit 1679449 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1679449&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1679449&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2792&quot; title=&quot;Text extraction ignores bookmarks&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2792&quot;&gt;&lt;del&gt;PDFBOX-2792&lt;/del&gt;&lt;/a&gt;: add exact test&lt;/p&gt;</comment>
                            <comment id="14544291" author="jira-bot" created="Thu, 14 May 2015 20:16:03 +0000"  >&lt;p&gt;Commit 1679450 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/branches/1.8&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1679450&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1679450&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2792&quot; title=&quot;Text extraction ignores bookmarks&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2792&quot;&gt;&lt;del&gt;PDFBOX-2792&lt;/del&gt;&lt;/a&gt;: add exact test&lt;/p&gt;</comment>
                            <comment id="14544426" author="jira-bot" created="Thu, 14 May 2015 21:53:21 +0000"  >&lt;p&gt;Commit 1679464 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/branches/1.8&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1679464&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1679464&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2792&quot; title=&quot;Text extraction ignores bookmarks&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2792&quot;&gt;&lt;del&gt;PDFBOX-2792&lt;/del&gt;&lt;/a&gt;: remove CRs for equality test&lt;/p&gt;</comment>
                            <comment id="14544430" author="jira-bot" created="Thu, 14 May 2015 21:55:54 +0000"  >&lt;p&gt;Commit 1679466 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1679466&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1679466&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2792&quot; title=&quot;Text extraction ignores bookmarks&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2792&quot;&gt;&lt;del&gt;PDFBOX-2792&lt;/del&gt;&lt;/a&gt;: remove CRs for equality test&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310050">
                    <name>Regression</name>
                                                                <inwardlinks description="is broken by">
                                        <issuelink>
            <issuekey id="12684034">PDFBOX-1808</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12747367">PDFBOX-2423</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 27 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2ej07:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>