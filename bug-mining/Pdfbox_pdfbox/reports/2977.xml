<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:14:57 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PDFBOX-5880] PDF render blank page: The end of the stream doesn&apos;t point to the correct offset, using workaround to read the stream, stream start position: 196, length: 0, expected end position: 196</title>
                <link>https://issues.apache.org/jira/browse/PDFBOX-5880</link>
                <project id="12310760" key="PDFBOX">PDFBox</project>
                    <description>&lt;p&gt;When rendering page one of the attached PDF the image does not render.&lt;/p&gt;

&lt;p&gt;In the logs, I see the following:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;2024-09-24 13:25:56:924 [main] WARN COSParser - The end of the stream doesn&apos;t point to the correct offset, using workaround to read the stream, stream start position: 196, length: 0, expected end position: 196
2024-09-24 13:25:56:930 [main] WARN PDFStreamEngine - Image stream is empty
java.io.IOException: Image stream is empty
	at org.apache.pdfbox.pdmodel.graphics.image.SampledImageReader.getRGBImage(SampledImageReader.java:182)
	at org.apache.pdfbox.pdmodel.graphics.image.PDImageXObject.getImage(PDImageXObject.java:477)
	at org.apache.pdfbox.pdmodel.graphics.image.PDImageXObject.getImage(PDImageXObject.java:438)
	at org.apache.pdfbox.rendering.PageDrawer.drawImage(PageDrawer.java:1107)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I assume this is a bad PDF, but Acrobat, Chrome, etc., display it without an issue.&lt;/p&gt;

&lt;p&gt;Here&apos;s the render code used:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
File out = File.createTempFile(&lt;span class=&quot;code-quote&quot;&gt;&quot;test-&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;.png&quot;&lt;/span&gt;);
PDDocument pdDocument = Loader.loadPDF(pdf);
&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; PDFRenderer pdfRenderer = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; PDFRenderer(pdDocument);
ImageIO.write(pdfRenderer.renderImageWithDPI(0, 300), &lt;span class=&quot;code-quote&quot;&gt;&quot;png&quot;&lt;/span&gt;, out);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13593137">PDFBOX-5880</key>
            <summary>PDF render blank page: The end of the stream doesn&apos;t point to the correct offset, using workaround to read the stream, stream start position: 196, length: 0, expected end position: 196</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="lehmi">Andreas Lehmk&#252;hler</assignee>
                                    <reporter username="jezerinac">Joseph Jezerinac</reporter>
                        <labels>
                            <label>regression</label>
                    </labels>
                <created>Tue, 24 Sep 2024 20:49:02 +0000</created>
                <updated>Wed, 12 Feb 2025 13:37:56 +0000</updated>
                            <resolved>Sun, 29 Sep 2024 09:39:08 +0000</resolved>
                                    <version>2.0.32</version>
                    <version>3.0.3 PDFBox</version>
                                    <fixVersion>2.0.33</fixVersion>
                    <fixVersion>3.0.4 PDFBox</fixVersion>
                    <fixVersion>4.0.0</fixVersion>
                                    <component>Parsing</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="17884492" author="tilman" created="Wed, 25 Sep 2024 03:54:50 +0000"  >&lt;p&gt;The PDF image stream has an (incorrect) length of 0. The workaround fails for some reason. Amusingly, this worked in 1.8.16, which displays the message &quot;WARNUNG: /Length of COSObject{1, 0} corrected from 0 to 695645&quot;.&lt;/p&gt;</comment>
                            <comment id="17884531" author="tilman" created="Wed, 25 Sep 2024 08:14:20 +0000"  >&lt;p&gt;The problem is here:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&#160; &#160; &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; COSStream createCOSStream(COSDictionary dictionary, &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; startPosition,
&#160; &#160; &#160; &#160; &#160; &#160; &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; streamLength) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException
&#160; &#160; {
&#160; &#160; &#160; &#160; COSStream stream = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; COSStream(streamCache,
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; parser.createRandomAccessReadView(startPosition, streamLength));
&#160; &#160; &#160; &#160; dictionary.forEach(stream::setItem);
&#160; &#160; &#160; &#160; stream.setKey(dictionary.getKey());
&#160; &#160; &#160; &#160; &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; stream;
&#160; &#160; }
 &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The foreach loop overwrites the length. For some reason this didn&apos;t make troubles in the past with wrong lengths, only this time with a zero length that is an indirect object.&lt;/p&gt;</comment>
                            <comment id="17884548" author="tilman" created="Wed, 25 Sep 2024 09:24:39 +0000"  >&lt;p&gt;proposed change is to add &lt;tt&gt;stream.setLong(COSName.LENGTH, streamLength);&lt;/tt&gt; or change the foreach loop that it doesn&apos;t overwrite the length entry.&lt;/p&gt;</comment>
                            <comment id="17885226" author="lehmi" created="Fri, 27 Sep 2024 06:22:51 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; that&apos;s a good idea. but I&apos;d prefer to do so in the COSParser so that the context don&apos;t get lost.&lt;/p&gt;</comment>
                            <comment id="17885227" author="jira-bot" created="Fri, 27 Sep 2024 06:26:14 +0000"  >&lt;p&gt;Commit 1920970 from lehmi@apache.org in branch &apos;pdfbox/branches/3.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1920970&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1920970&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-5880&quot; title=&quot;PDF render blank page: The end of the stream doesn&amp;#39;t point to the correct offset, using workaround to read the stream, stream start position: 196, length: 0, expected end position: 196&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-5880&quot;&gt;&lt;del&gt;PDFBOX-5880&lt;/del&gt;&lt;/a&gt;: set missing/replace invalid stream length&lt;/p&gt;</comment>
                            <comment id="17885251" author="tilman" created="Fri, 27 Sep 2024 07:24:34 +0000"  >&lt;p&gt;Several differences, e.g.  &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/13071830/13071830_PDFBOX-1094-PDFBOX-269.pdf&quot; title=&quot;PDFBOX-1094-PDFBOX-269.pdf attached to PDFBOX-5880&quot;&gt;PDFBOX-1094-PDFBOX-269.pdf&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt; page 2ff, the light background is different. Also the file of &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-1738&quot; title=&quot;PDF with parsing IOException&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-1738&quot;&gt;&lt;del&gt;PDFBOX-1738&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="17885428" author="lehmi" created="Fri, 27 Sep 2024 17:08:50 +0000"  >&lt;p&gt;Thanks for the pointer, I&apos;m going to look into it&lt;/p&gt;</comment>
                            <comment id="17885620" author="jira-bot" created="Sat, 28 Sep 2024 21:39:32 +0000"  >&lt;p&gt;Commit 1921011 from lehmi@apache.org in branch &apos;pdfbox/branches/3.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1921011&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1921011&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-5880&quot; title=&quot;PDF render blank page: The end of the stream doesn&amp;#39;t point to the correct offset, using workaround to read the stream, stream start position: 196, length: 0, expected end position: 196&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-5880&quot;&gt;&lt;del&gt;PDFBOX-5880&lt;/del&gt;&lt;/a&gt;: always seek to the origin offset, set/replace length value only if needed&lt;/p&gt;</comment>
                            <comment id="17885621" author="lehmi" created="Sat, 28 Sep 2024 21:42:04 +0000"  >&lt;p&gt;It should  work again. I&apos;ve mixed up the logic in validateStreamLength so that the pointer into the source wasn&apos;t reset to the origin offset in one case&lt;/p&gt;</comment>
                            <comment id="17885635" author="tilman" created="Sat, 28 Sep 2024 23:42:03 +0000"  >&lt;p&gt;Now it works!&lt;/p&gt;</comment>
                            <comment id="17885687" author="jira-bot" created="Sun, 29 Sep 2024 09:33:56 +0000"  >&lt;p&gt;Commit 1921019 from lehmi@apache.org in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1921019&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1921019&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-5880&quot; title=&quot;PDF render blank page: The end of the stream doesn&amp;#39;t point to the correct offset, using workaround to read the stream, stream start position: 196, length: 0, expected end position: 196&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-5880&quot;&gt;&lt;del&gt;PDFBOX-5880&lt;/del&gt;&lt;/a&gt;: don&apos;t restore invalid stream length values &amp;lt;= 0, mark stream length values &amp;lt;= as invalid&lt;/p&gt;</comment>
                            <comment id="17885689" author="jira-bot" created="Sun, 29 Sep 2024 09:36:44 +0000"  >&lt;p&gt;Commit 1921020 from lehmi@apache.org in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1921020&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1921020&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-5880&quot; title=&quot;PDF render blank page: The end of the stream doesn&amp;#39;t point to the correct offset, using workaround to read the stream, stream start position: 196, length: 0, expected end position: 196&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-5880&quot;&gt;&lt;del&gt;PDFBOX-5880&lt;/del&gt;&lt;/a&gt;: set missing/replace invalid stream length&lt;/p&gt;</comment>
                            <comment id="17885690" author="lehmi" created="Sun, 29 Sep 2024 09:39:08 +0000"  >&lt;p&gt;The given pdf is a corner case and it works now.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; thanks again for your help&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jezerinac&quot; class=&quot;user-hover&quot; rel=&quot;jezerinac&quot;&gt;jezerinac&lt;/a&gt; thanks for the report&lt;/p&gt;</comment>
                            <comment id="17912619" author="jezerinac" created="Mon, 13 Jan 2025 17:26:26 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lehmi&quot; class=&quot;user-hover&quot; rel=&quot;lehmi&quot;&gt;lehmi&lt;/a&gt; Is there a date for the release of 3.0.4?&lt;/p&gt;

&lt;p&gt;Thanks again.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13608259">PDFBOX-5954</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="13071830" name="PDFBOX-1094-PDFBOX-269.pdf" size="225238" author="tilman" created="Fri, 27 Sep 2024 07:23:08 +0000"/>
                            <attachment id="13071757" name="test.pdf" size="1375228" author="jezerinac" created="Tue, 24 Sep 2024 20:48:30 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            42 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1rlfs:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>