<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 20:53:36 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PDFBOX-1306] Transparent PNG file display with black border </title>
                <link>https://issues.apache.org/jira/browse/PDFBOX-1306</link>
                <project id="12310760" key="PDFBOX">PDFBox</project>
                    <description>&lt;p&gt;Hi,&lt;/p&gt;

&lt;p&gt;I have added Transparent PNG file in PDF with PDFBox and it&apos;s display black border around image. I have added same PNG file with IText and it&apos;s display good in PDF.&lt;/p&gt;

&lt;p&gt;I have used below function to add PNG file. I am using latest PDFBox SVN code to add PNG file.&lt;/p&gt;


&lt;p&gt;public void createPDFFromImage( String inputFile, String image, String outputFile ) &lt;br/&gt;
        throws IOException, COSVisitorException&lt;br/&gt;
    {&lt;br/&gt;
        // the document&lt;br/&gt;
        PDDocument doc = null;&lt;br/&gt;
        try&lt;br/&gt;
        {&lt;br/&gt;
            doc = PDDocument.load( inputFile );&lt;br/&gt;
            //we will add the image to the first page.&lt;br/&gt;
            PDPage page = (PDPage)doc.getDocumentCatalog().getAllPages().get( 0 );&lt;/p&gt;

&lt;p&gt;            PDXObjectImage ximage = null;        &lt;/p&gt;


&lt;p&gt;            /*if( image.toLowerCase().endsWith( &quot;.jpg&quot; ) )&lt;/p&gt;
            {
                ximage = new PDJpeg(doc, new FileInputStream( image ) );
            }
&lt;p&gt;            else if (image.toLowerCase().endsWith(&quot;.tif&quot;) || image.toLowerCase().endsWith(&quot;.tiff&quot;))&lt;/p&gt;
            {
                ximage = new PDCcitt(doc, new RandomAccessFile(new File(image),&quot;r&quot;));
            }
&lt;p&gt;            else&lt;br/&gt;
            &lt;/p&gt;
{
                BufferedImage awtImage = ImageIO.read( new File( image ) );
                FileInputStream inputStream = new FileInputStream(image);
                PDStream stream = new PDStream(doc, inputStream);
                ximage = new PDPixelMap(stream);
                //throw new IOException( &quot;Image type not supported:&quot; + image );
            }
&lt;p&gt;*/&lt;/p&gt;

&lt;p&gt;            System.out.println(&quot;Testing&quot;);&lt;br/&gt;
            BufferedImage stampImage = null;&lt;br/&gt;
            try&lt;/p&gt;
{
            	stampImage = ImageIO.read(new File(image));
            	
            }
&lt;p&gt;catch(Exception e)&lt;/p&gt;
{
            	e.printStackTrace();
            }

&lt;p&gt;            ximage = new PDJpeg(doc, stampImage );&lt;br/&gt;
            //ximage = new PDPixelMap(doc, stampImage);&lt;br/&gt;
            COSStream stream = ximage.getCOSStream();&lt;br/&gt;
            PDStream pdStream = new PDStream(stream);&lt;br/&gt;
            ximage = new PDPixelMap(pdStream);&lt;br/&gt;
            //BoxImage imageData = BoxImage.getInstance(image);&lt;/p&gt;

&lt;p&gt;            //System.out.println(&quot;&quot;+imageData.getImageType());&lt;br/&gt;
            PDPageContentStream contentStream = new PDPageContentStream(doc, page, true, true, true);&lt;br/&gt;
            AffineTransform transform = new AffineTransform(stampImage.getWidth(), 0, 0, stampImage.getHeight(), 20, 200);&lt;br/&gt;
            //contentStream.drawImage( ximage, 20, 20 );&lt;br/&gt;
            contentStream.drawXObject(ximage, transform);&lt;br/&gt;
            contentStream.close();&lt;br/&gt;
            doc.save( outputFile );&lt;br/&gt;
        }&lt;br/&gt;
        finally&lt;br/&gt;
        {&lt;br/&gt;
            if( doc != null )&lt;/p&gt;
            {
                doc.close();
            }
&lt;p&gt;        }&lt;br/&gt;
    }&lt;/p&gt;



</description>
                <environment></environment>
        <key id="12555003">PDFBOX-1306</key>
            <summary>Transparent PNG file display with black border </summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="lehmi">Andreas Lehmk&#252;hler</assignee>
                                    <reporter username="patelmanoj">Manoj Patel</reporter>
                        <labels>
                    </labels>
                <created>Sat, 12 May 2012 05:31:55 +0000</created>
                <updated>Tue, 29 May 2012 16:21:56 +0000</updated>
                            <resolved>Mon, 14 May 2012 15:24:53 +0000</resolved>
                                                    <fixVersion>1.7.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="13273843" author="patelmanoj" created="Sat, 12 May 2012 05:34:42 +0000"  >&lt;p&gt;Attached are the PNG and generated PDF files with PDFBox and IText&lt;/p&gt;</comment>
                            <comment id="13274224" author="lehmi" created="Sun, 13 May 2012 07:26:39 +0000"  >&lt;p&gt;I fixed the smask creation in revision 1337790.&lt;/p&gt;

&lt;p&gt;BTW: You don&apos;t need to create an PDXObjectImage using the stream of a PDJpeg object. Just use the PDJpeg.&lt;/p&gt;</comment>
                            <comment id="13274462" author="patelmanoj" created="Mon, 14 May 2012 05:49:11 +0000"  >&lt;p&gt;I have tried the same and it&apos;s working fine for African_Elephant_Transparent.png. &lt;/p&gt;

&lt;p&gt;Now have tried with NEW.png and it&apos;s gives gray border around fonts.I am using below mentioned code to scale png image in PDFBox.&lt;/p&gt;

&lt;p&gt;int width= (int)(stampImage.getWidth()*100/300);&lt;br/&gt;
int height= (int)(stampImage.getHeight()*100/300);&lt;br/&gt;
AffineTransform transform = new AffineTransform(width, 0, 0, height, 20, 200);    &lt;/p&gt;

&lt;p&gt;I have attached NEW.png, iText_NEW.pdf and PDFBox_NEW.pdf files. You can compare result of generated PDF files.&lt;/p&gt;</comment>
                            <comment id="13274676" author="lehmi" created="Mon, 14 May 2012 15:24:53 +0000"  >&lt;p&gt;My first patch improved the SMask creation but it wasn&apos;t perfect. I optimized it once again in revision 1338247. But I&apos;m afraid that&apos;s the maximum of quality we can get here. &lt;br/&gt;
In the end it is not a good idea to use a lossy DCTFilter to compress the data. Instead one should use the lossless FlateDecode filter. I extended the PDPixelMap class similar to the PDJpeg class in revision 1338248.&lt;br/&gt;
Just use a PDPixelMap instead of a PDJpeg to add an image with transparency.&lt;/p&gt;

&lt;p&gt;Thanks for coming back and your input.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12526609" name="African_Elephant_Transparent.png" size="97689" author="patelmanoj" created="Sat, 12 May 2012 05:34:39 +0000"/>
                            <attachment id="12526610" name="GeneratedFileIText.pdf" size="127808" author="patelmanoj" created="Sat, 12 May 2012 05:34:40 +0000"/>
                            <attachment id="12526611" name="GeneratedFilePDFBox.pdf" size="18707" author="patelmanoj" created="Sat, 12 May 2012 05:34:40 +0000"/>
                            <attachment id="12526731" name="NEW.png" size="3014" author="patelmanoj" created="Mon, 14 May 2012 09:05:14 +0000"/>
                            <attachment id="12526729" name="PDFBox_NEW.pdf" size="102955" author="patelmanoj" created="Mon, 14 May 2012 09:05:14 +0000"/>
                            <attachment id="12526730" name="iText_NEW.pdf" size="82157" author="patelmanoj" created="Mon, 14 May 2012 09:05:14 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>6.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>239257</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 27 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0zinb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>205323</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>