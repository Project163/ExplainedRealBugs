<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:15:20 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PDFBOX-5747] Surrogate pairs with combining diacritics are incorrectly ordered on text extraction</title>
                <link>https://issues.apache.org/jira/browse/PDFBOX-5747</link>
                <project id="12310760" key="PDFBOX">PDFBox</project>
                    <description>&lt;p&gt;When extending &lt;b&gt;&lt;tt&gt;PDFTextStripper&lt;/tt&gt;&lt;/b&gt;, the &lt;b&gt;&lt;tt&gt;writeString&lt;/tt&gt;&lt;/b&gt; override receives a &lt;b&gt;&lt;tt&gt;List&amp;lt;TextPosition&amp;gt;&lt;/tt&gt;&lt;/b&gt;. When iterating over them, the &lt;tt&gt;&lt;b&gt;getUnicode()&lt;/b&gt;&lt;/tt&gt; call should return the Unicode representation of the extracted text.&lt;/p&gt;

&lt;p&gt;However, for glyphs that require a surrogate pair (such as some mathematical symbols, e.g. &#119883;) that are modified with a combining diacritic (such as ^), the extracted Unicode characters are out of order.&lt;/p&gt;

&lt;p&gt;The attached PDF contains &#119883;&#770;. This is composed of &#119883;, which is represented as the surrogate pair &lt;font color=&quot;#cc7832&quot;&gt;\uD835\uDC4B &lt;/font&gt;and the combining diacritic &lt;font color=&quot;#cc7832&quot;&gt;\u0302&lt;/font&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;#172b4d&quot;&gt;However, when extracted, we get &lt;/font&gt;\uD835\u0302\uDC4B&lt;font color=&quot;#172b4d&quot;&gt; (the combining diacritic is placed in between the two characters of the surrogate pair). This is an invalid representation, and when encoded as a Json will break most parsers. The expected output would be &lt;/font&gt;\uD835\uDC4B\u0302&lt;/p&gt;</description>
                <environment></environment>
        <key id="13562927">PDFBOX-5747</key>
            <summary>Surrogate pairs with combining diacritics are incorrectly ordered on text extraction</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tilman">Tilman Hausherr</assignee>
                                    <reporter username="pcrossa">P Crossa</reporter>
                        <labels>
                    </labels>
                <created>Tue, 26 Dec 2023 12:58:34 +0000</created>
                <updated>Thu, 24 Apr 2025 18:37:52 +0000</updated>
                            <resolved>Sun, 26 Jan 2025 13:49:13 +0000</resolved>
                                    <version>2.0.30</version>
                    <version>2.0.33</version>
                    <version>3.0.4 PDFBox</version>
                                    <fixVersion>2.0.34</fixVersion>
                    <fixVersion>3.0.5 PDFBox</fixVersion>
                    <fixVersion>4.0.0</fixVersion>
                                    <component>Text extraction</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="17921129" author="rec" created="Sun, 26 Jan 2025 09:33:42 +0000"  >&lt;p&gt;Seems like the issue still exists in pdfbox 3.0.3&lt;/p&gt;</comment>
                            <comment id="17921136" author="rec" created="Sun, 26 Jan 2025 10:38:31 +0000"  >&lt;p&gt;Here is a PR for the issue: &lt;a href=&quot;https://github.com/apache/pdfbox/pull/200&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/pdfbox/pull/200&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17921139" author="rec" created="Sun, 26 Jan 2025 10:44:37 +0000"  >&lt;p&gt;I have also attached the PR as a patch since it appears that the GitHub is not actively used for development. The PR/patch goes against the current trunk which identifies itself as 4.0.0-SNAPSHOT.&lt;/p&gt;

&lt;p&gt;However, it would be great if we could have this fix as part of a 3.0.5 release.&lt;/p&gt;</comment>
                            <comment id="17921155" author="tilman" created="Sun, 26 Jan 2025 13:15:18 +0000"  >&lt;p&gt;Reduced test file: &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/13074261/13074261_PDFBOX-5747-unicode-surrogate-with-diacritic-reduced.pdf&quot; title=&quot;PDFBOX-5747-unicode-surrogate-with-diacritic-reduced.pdf attached to PDFBOX-5747&quot;&gt;PDFBOX-5747-unicode-surrogate-with-diacritic-reduced.pdf&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;Your patch works fine, no differences with existing tests. After the change it is like &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=pcrossa&quot; class=&quot;user-hover&quot; rel=&quot;pcrossa&quot;&gt;pcrossa&lt;/a&gt; described, but one has to use UTF-16 encoding. This looks &quot;X^&quot; in PDFDebugger or when opening the .txt file in firefox.&lt;/p&gt;</comment>
                            <comment id="17921159" author="jira-bot" created="Sun, 26 Jan 2025 13:43:38 +0000"  >&lt;p&gt;Commit 1923373 from Tilman Hausherr in branch &apos;pdfbox/branches/3.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1923373&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1923373&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-5747&quot; title=&quot;Surrogate pairs with combining diacritics are incorrectly ordered on text extraction&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-5747&quot;&gt;&lt;del&gt;PDFBOX-5747&lt;/del&gt;&lt;/a&gt;: fix combining diacritics, by Richard Eckart de Castilho&lt;/p&gt;</comment>
                            <comment id="17921160" author="jira-bot" created="Sun, 26 Jan 2025 13:43:44 +0000"  >&lt;p&gt;Commit 1923374 from Tilman Hausherr in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1923374&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1923374&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-5747&quot; title=&quot;Surrogate pairs with combining diacritics are incorrectly ordered on text extraction&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-5747&quot;&gt;&lt;del&gt;PDFBOX-5747&lt;/del&gt;&lt;/a&gt;: fix combining diacritics, by Richard Eckart de Castilho&lt;/p&gt;</comment>
                            <comment id="17921161" author="jira-bot" created="Sun, 26 Jan 2025 13:43:49 +0000"  >&lt;p&gt;Commit 1923375 from Tilman Hausherr in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1923375&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1923375&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-5747&quot; title=&quot;Surrogate pairs with combining diacritics are incorrectly ordered on text extraction&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-5747&quot;&gt;&lt;del&gt;PDFBOX-5747&lt;/del&gt;&lt;/a&gt;: fix combining diacritics, by Richard Eckart de Castilho&lt;/p&gt;</comment>
                            <comment id="17921166" author="tilman" created="Sun, 26 Jan 2025 13:49:13 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rec&quot; class=&quot;user-hover&quot; rel=&quot;rec&quot;&gt;rec&lt;/a&gt;!&lt;/p&gt;</comment>
                            <comment id="17921205" author="rec" created="Sun, 26 Jan 2025 18:44:37 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; Thanks for jumping on it right away &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; I&apos;m quite sure this fix will make pdfbox quite a bit more useful for processing scientific papers.&lt;/p&gt;</comment>
                            <comment id="17921207" author="rec" created="Sun, 26 Jan 2025 18:48:39 +0000"  >&lt;p&gt;&amp;gt; This looks &quot;X^&quot; in PDFDebugger or when opening the .txt file in firefox.&lt;/p&gt;

&lt;p&gt;I didn&apos;t manage to get the PDFDebugger to open on my system... neither the 2.x version nor the 3.x version. Simply no window opened. No idea.&lt;/p&gt;

&lt;p&gt;In the Eclipse console, the &#119883;&#770; printed correctly.&lt;/p&gt;

&lt;p&gt;Most importantly, though, the XML libs that I pipe the whole stuff through didn&apos;t choke anymore because of the broken surrogates.&lt;/p&gt;

&lt;p&gt;If you have any better idea with respect to representing the compound... &#129335; &lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12613907">PDFBOX-1433</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12417301">PDFBOX-444</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="13074261" name="PDFBOX-5747-unicode-surrogate-with-diacritic-reduced.pdf" size="2019" author="tilman" created="Sun, 26 Jan 2025 13:15:10 +0000"/>
                            <attachment id="13074260" name="PDFBOX-5747.patch" size="10826" author="rec" created="Sun, 26 Jan 2025 10:40:39 +0000"/>
                            <attachment id="13065606" name="invchar.pdf" size="6729" author="pcrossa" created="Tue, 26 Dec 2023 12:51:24 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            40 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1mg54:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>