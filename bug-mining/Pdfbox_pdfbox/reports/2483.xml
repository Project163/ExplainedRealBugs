<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:11:10 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PDFBOX-5091] Performance issue when converting PDF to image after upgrading from PDFBox 2.0.20 to 2.0.21</title>
                <link>https://issues.apache.org/jira/browse/PDFBOX-5091</link>
                <project id="12310760" key="PDFBOX">PDFBox</project>
                    <description>&lt;p&gt;We use PDFBox to save the first page of a PDF as an image to provide a preview of the document. These PDFs can be relatively complex as they may contain ten thousands of objects, especially map data. The results are still fine, but when we upgraded from 2.0.20 to 2.0.21 we had a notable performance decrease. Saving the first page of the attached sample document now takes nearly 20 sec on my developer machine, compared to 4 sec with 2.0.20.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment>JDK 8 on Windows10&lt;br/&gt;
</environment>
        <key id="13354924">PDFBOX-5091</key>
            <summary>Performance issue when converting PDF to image after upgrading from PDFBox 2.0.20 to 2.0.21</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tilman">Tilman Hausherr</assignee>
                                    <reporter username="vul">Volker Ullmann</reporter>
                        <labels>
                            <label>regression</label>
                    </labels>
                <created>Wed, 27 Jan 2021 12:22:45 +0000</created>
                <updated>Fri, 19 Mar 2021 15:42:05 +0000</updated>
                            <resolved>Wed, 3 Feb 2021 18:06:34 +0000</resolved>
                                    <version>2.0.21</version>
                    <version>2.0.22</version>
                                    <fixVersion>2.0.23</fixVersion>
                    <fixVersion>3.0.0 PDFBox</fixVersion>
                                    <component>Rendering</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="17273071" author="tilman" created="Wed, 27 Jan 2021 18:20:04 +0000"  >&lt;p&gt;The current version is 2.0.22. Please try that one. If it is still slow, maybe it is because of rendering quality improvements we did. Try playing with &lt;tt&gt;PDFRenderer.setImageDownscalingOptimizationThreshold()&lt;/tt&gt;, this can disable them. Or play with the rendering hints.&lt;/p&gt;</comment>
                            <comment id="17273457" author="vul" created="Thu, 28 Jan 2021 09:35:52 +0000"  >&lt;p&gt;Thanks for the quick response. I already tried 2.0.22 and it&apos;s the same as with 2.0.21.&lt;/p&gt;

&lt;p&gt;For now we don&apos;t pass any rendering hints, so I will do some testing with that and the &lt;tt&gt;PDFRenderer.imageDownscalingOptimizationThreshold&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;Thanks again, you&apos;re doing a great job.&lt;/p&gt;</comment>
                            <comment id="17277172" author="vul" created="Tue, 2 Feb 2021 14:52:56 +0000"  >&lt;p&gt;The docs say, the &lt;em&gt;image downscaling optimization threshold&lt;/em&gt; will only be taken into account if the rendering hints &lt;em&gt;bicubic&lt;/em&gt; and &lt;em&gt;quality&lt;/em&gt; are set.&lt;br/&gt;
As mentioned above we don&apos;t set any rendering hints, so I suppose defaults will be used and the threshold value is ignored.&lt;br/&gt;
Furthermore I did some test runs playing with rendering settings (speed versus quality) and the only remarkable difference is the quality of the resulting image. In fact the average processing time is nearly the same for &lt;em&gt;quality&lt;/em&gt; (bicubic interpolation, antialiased rendering, highest render quality) as for &lt;em&gt;speed&lt;/em&gt; (Nearest Neighbor interpolation, nonantialiased rendering, fastest rendering methods).&lt;br/&gt;
Seems that the rendering hints and image downscaling optimization threshold won&apos;t help me.&lt;br/&gt;
Do you have any other ideas?&lt;/p&gt;</comment>
                            <comment id="17277311" author="tilman" created="Tue, 2 Feb 2021 17:13:26 +0000"  >&lt;p&gt;This is the default renderinghints, so the default is high quality&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; RenderingHints createDefaultRenderingHints(Graphics2D graphics)
{
    RenderingHints r = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; RenderingHints(&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;);
    r.put(RenderingHints.KEY_INTERPOLATION, isBitonal(graphics) ?
            RenderingHints.VALUE_INTERPOLATION_NEAREST_NEIGHBOR :
            RenderingHints.VALUE_INTERPOLATION_BICUBIC);
    r.put(RenderingHints.KEY_RENDERING, RenderingHints.VALUE_RENDER_QUALITY);
    r.put(RenderingHints.KEY_ANTIALIASING, isBitonal(graphics) ?
                                    RenderingHints.VALUE_ANTIALIAS_OFF :
                                    RenderingHints.VALUE_ANTIALIAS_ON);
    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; r;
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;I was unable to reproduce that it is fast. What exact jdk8 are you using and on what OS, and what code are you using?&lt;/p&gt;</comment>
                            <comment id="17277796" author="vul" created="Wed, 3 Feb 2021 08:14:29 +0000"  >&lt;p&gt;Here is our code, a little bit simplified, it has not changed from 2.0.20 to 2.0.22:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; maxImageWidth = 1280;
&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; MemoryUsageSetting memoryUsageSetting = 
    MemoryUsageSetting.setupMainMemoryOnly(); 
&lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt;[] pdfContent = loadPdfContent(); &lt;span class=&quot;code-comment&quot;&gt;// get the bytes of the PDF file 
&lt;/span&gt;&lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; (PDDocument document = PDDocument.load(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ByteArrayInputStream(pdfContent), 
                                           memoryUsageSetting)) {
    PDPage firstPage = document.getPage(0); 
    PDFRenderer pdfRenderer = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; PDFRenderer(document);
    pdfRenderer.setSubsamplingAllowed(&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;); 
    PDRectangle cropBox = firstPage.getCropBox();
    &lt;span class=&quot;code-object&quot;&gt;float&lt;/span&gt; scale = maxImageWidth / cropBox.getWidth();
    BufferedImage image = pdfRenderer.renderImage(0, scale);
    &lt;span class=&quot;code-comment&quot;&gt;// ...
&lt;/span&gt;} &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (Exception ex) { 
    &lt;span class=&quot;code-comment&quot;&gt;// ...
&lt;/span&gt;}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;OS is Windows 10 and the JDK is&lt;br/&gt;
 java.runtime.version = 1.8.0_261-b12&lt;br/&gt;
 java.vm.name = Java HotSpot(TM) 64-Bit Server VM&lt;br/&gt;
 java.vm.vendor = Oracle Corporation&lt;/p&gt;</comment>
                            <comment id="17278229" author="jira-bot" created="Wed, 3 Feb 2021 17:20:19 +0000"  >&lt;p&gt;Commit 1886173 from Tilman Hausherr in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1886173&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1886173&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-5091&quot; title=&quot;Performance issue when converting PDF to image after upgrading from PDFBox 2.0.20 to 2.0.21&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-5091&quot;&gt;&lt;del&gt;PDFBOX-5091&lt;/del&gt;&lt;/a&gt;: also consider subsampling when getting actual image to know its size&lt;/p&gt;</comment>
                            <comment id="17278230" author="jira-bot" created="Wed, 3 Feb 2021 17:20:22 +0000"  >&lt;p&gt;Commit 1886174 from Tilman Hausherr in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1886174&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1886174&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-5091&quot; title=&quot;Performance issue when converting PDF to image after upgrading from PDFBox 2.0.20 to 2.0.21&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-5091&quot;&gt;&lt;del&gt;PDFBOX-5091&lt;/del&gt;&lt;/a&gt;: also consider subsampling when getting actual image to know its size&lt;/p&gt;</comment>
                            <comment id="17278231" author="tilman" created="Wed, 3 Feb 2021 17:22:41 +0000"  >&lt;p&gt;It&apos;s the subsampling. I was able to reproduce that you had a speed advantage in 2.0.20 but no longer after that.&lt;/p&gt;

&lt;p&gt;This advantage was &quot;lost&quot; in &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4930&quot; title=&quot;Font thickness issue when we use PDFBox for generating images from PDF&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4930&quot;&gt;&lt;del&gt;PDFBOX-4930&lt;/del&gt;&lt;/a&gt; by not considering the size of a subsampled image when making a decision whether or not to reduce interpolation when scaling up.&lt;/p&gt;</comment>
                            <comment id="17278265" author="tilman" created="Wed, 3 Feb 2021 18:06:34 +0000"  >&lt;p&gt;Snapshot available here:&lt;br/&gt;
&lt;a href=&quot;https://repository.apache.org/content/groups/snapshots/org/apache/pdfbox/pdfbox-app/2.0.23-SNAPSHOT/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://repository.apache.org/content/groups/snapshots/org/apache/pdfbox/pdfbox-app/2.0.23-SNAPSHOT/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Thanks for reporting the problem!&lt;/p&gt;</comment>
                            <comment id="17280822" author="vul" created="Mon, 8 Feb 2021 07:47:23 +0000"  >&lt;p&gt;It&apos;s as fast as with 2.0.20.&lt;/p&gt;

&lt;p&gt;Thanks for fixing.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310050">
                    <name>Regression</name>
                                                                <inwardlinks description="is broken by">
                                        <issuelink>
            <issuekey id="13320742">PDFBOX-4930</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="13019517" name="single_page.pdf" size="16637638" author="vul" created="Wed, 27 Jan 2021 12:20:37 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 39 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0n1m0:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>