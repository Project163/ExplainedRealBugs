<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:01:09 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PDFBOX-2720] Can&apos;t sign PDF document with forms or annotations</title>
                <link>https://issues.apache.org/jira/browse/PDFBOX-2720</link>
                <project id="12310760" key="PDFBOX">PDFBox</project>
                    <description>&lt;p&gt;It is not possible to sign a PDF document which contains a form.&lt;br/&gt;
There is no exception traces.&lt;/p&gt;

&lt;p&gt;Please find attached 8 documents :&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;A document with a visual signature form (does not work) (Doc1)&lt;/li&gt;
	&lt;li&gt;A probably latex generated document (does not work) (Doc2)&lt;/li&gt;
	&lt;li&gt;A document with an annotation (does not work) (Doc3WithAnnot)&lt;/li&gt;
	&lt;li&gt;And the same document without annotation ( which works well ) (Doc3WithoutAnnot)&lt;/li&gt;
	&lt;li&gt;And their signed release.&lt;/li&gt;
&lt;/ul&gt;
</description>
                <environment></environment>
        <key id="12783610">PDFBOX-2720</key>
            <summary>Can&apos;t sign PDF document with forms or annotations</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="lehmi">Andreas Lehmk&#252;hler</assignee>
                                    <reporter username="cbremaud">Cyril Bremaud</reporter>
                        <labels>
                    </labels>
                <created>Fri, 20 Mar 2015 14:03:54 +0000</created>
                <updated>Tue, 24 May 2016 14:44:31 +0000</updated>
                            <resolved>Tue, 24 May 2016 13:50:05 +0000</resolved>
                                    <version>2.0.0</version>
                                    <fixVersion>2.0.0</fixVersion>
                                    <component>Signing</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="14371570" author="msahyoun" created="Fri, 20 Mar 2015 16:26:56 +0000"  >&lt;p&gt;Could you provide us with a unit test to reproduce the issue you are getting?&lt;/p&gt;</comment>
                            <comment id="14375644" author="cbremaud" created="Mon, 23 Mar 2015 09:58:19 +0000"  >&lt;p&gt;I tried to sign the document with the example class &quot;CreateSignature.java&quot; available here : &lt;a href=&quot;https://svn.apache.org/repos/asf/pdfbox/trunk/examples/src/main/java/org/apache/pdfbox/examples/signature/CreateSignature.java&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/repos/asf/pdfbox/trunk/examples/src/main/java/org/apache/pdfbox/examples/signature/CreateSignature.java&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14375672" author="msahyoun" created="Mon, 23 Mar 2015 10:25:00 +0000"  >&lt;p&gt;thanks - I&apos;ll take a look later today.&lt;/p&gt;</comment>
                            <comment id="14377612" author="msahyoun" created="Tue, 24 Mar 2015 10:19:43 +0000"  >&lt;p&gt;I tried with a very small form created using the CreateFormField sample from the examples package and the issue doesn&apos;t occur. So it&apos;s not (only) because of the form - investigating further.&lt;/p&gt;

&lt;p&gt;With the examples you have e.g. the Pages entry is null after applying the signature.&lt;/p&gt;</comment>
                            <comment id="14377666" author="msahyoun" created="Tue, 24 Mar 2015 10:50:33 +0000"  >&lt;p&gt;Looks like Xref streams are not handled correctly when doing an incremental update. After saving Doc1WithSignForms.pdf as a 1.4 document the signature is fine.&lt;/p&gt;</comment>
                            <comment id="14377687" author="msahyoun" created="Tue, 24 Mar 2015 11:06:07 +0000"  >&lt;p&gt;I assigned it to Andreas based on a quick discussion I had with him.&lt;/p&gt;</comment>
                            <comment id="14618525" author="abyss" created="Wed, 8 Jul 2015 12:46:41 +0000"  >&lt;p&gt;It appears that incremental update of PDF with cross-reference stream does not include &lt;b&gt;Prev&lt;/b&gt; entry into the cross-reference stream dictionary. See the method COSWriter#doWriteXRefInc#622 which removes it:&lt;br/&gt;
&lt;tt&gt;trailer.removeItem(COSName.PREV);&lt;/tt&gt;&lt;br/&gt;
but do not updates it with the value of &lt;b&gt;startxref&lt;/b&gt; keyword from the previous document revision.&lt;br/&gt;
It start to work if I replace it with:&lt;br/&gt;
&lt;tt&gt;trailer.setLong(COSName.PREV, doc.getStartXref());&lt;/tt&gt;&lt;/p&gt;</comment>
                            <comment id="14642018" author="jira-bot" created="Sun, 26 Jul 2015 16:36:41 +0000"  >&lt;p&gt;Commit 1692730 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lehmi&quot; class=&quot;user-hover&quot; rel=&quot;lehmi&quot;&gt;lehmi&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1692730&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1692730&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2720&quot; title=&quot;Can&amp;#39;t sign PDF document with forms or annotations&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2720&quot;&gt;&lt;del&gt;PDFBOX-2720&lt;/del&gt;&lt;/a&gt;: use former startXRef value as new PREV value as proposed by Petras&lt;/p&gt;</comment>
                            <comment id="14642019" author="lehmi" created="Sun, 26 Jul 2015 16:37:51 +0000"  >&lt;p&gt;The proposed fix works like a charm.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=abyss&quot; class=&quot;user-hover&quot; rel=&quot;abyss&quot;&gt;abyss&lt;/a&gt; Thanks for the contribution&lt;/p&gt;</comment>
                            <comment id="14642561" author="lehmi" created="Mon, 27 Jul 2015 10:36:54 +0000"  >&lt;p&gt;Reopened due to a regression reported on users@&lt;/p&gt;</comment>
                            <comment id="14642707" author="jira-bot" created="Mon, 27 Jul 2015 13:17:22 +0000"  >&lt;p&gt;Commit 1692878 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lehmi&quot; class=&quot;user-hover&quot; rel=&quot;lehmi&quot;&gt;lehmi&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1692878&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1692878&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2720&quot; title=&quot;Can&amp;#39;t sign PDF document with forms or annotations&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2720&quot;&gt;&lt;del&gt;PDFBOX-2720&lt;/del&gt;&lt;/a&gt;: use former startXRef value as new PREV value for incremental updates only&lt;/p&gt;</comment>
                            <comment id="14648061" author="lehmi" created="Thu, 30 Jul 2015 18:20:16 +0000"  >&lt;p&gt;I ran some additional tests and everything works fine. &lt;/p&gt;

&lt;p&gt;Thanks to all for their help!&lt;/p&gt;</comment>
                            <comment id="15298179" author="cbremaud" created="Tue, 24 May 2016 13:40:36 +0000"  >&lt;p&gt;I&apos;m sorry to reopen this issue but this is occured again on 2.0.0 and 2.0.1.&lt;/p&gt;</comment>
                            <comment id="15298190" author="lehmi" created="Tue, 24 May 2016 13:50:06 +0000"  >&lt;p&gt;Please, don&apos;t reopen already closed issue, create a new one instead. Thanks&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10020">
                    <name>Cloners</name>
                                                                <inwardlinks description="is cloned by">
                                        <issuelink>
            <issuekey id="12972405">PDFBOX-3361</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12705919" name="Doc1WithSignForms.pdf" size="55953" author="cbremaud" created="Fri, 20 Mar 2015 14:05:13 +0000"/>
                            <attachment id="12705920" name="Doc1WithSignForms.pdf_signed.pdf" size="76413" author="cbremaud" created="Fri, 20 Mar 2015 14:05:13 +0000"/>
                            <attachment id="12705921" name="Doc2.pdf" size="37087" author="cbremaud" created="Fri, 20 Mar 2015 14:05:13 +0000"/>
                            <attachment id="12705922" name="Doc2.pdf_signed.pdf" size="57255" author="cbremaud" created="Fri, 20 Mar 2015 14:05:13 +0000"/>
                            <attachment id="12705923" name="Doc3WithAnnot.pdf" size="232487" author="cbremaud" created="Fri, 20 Mar 2015 14:05:13 +0000"/>
                            <attachment id="12705924" name="Doc3WithAnnot.pdf_signed.pdf" size="252687" author="cbremaud" created="Fri, 20 Mar 2015 14:05:13 +0000"/>
                            <attachment id="12705925" name="Doc3WithoutAnnot.pdf" size="256518" author="cbremaud" created="Fri, 20 Mar 2015 14:05:13 +0000"/>
                            <attachment id="12705926" name="Doc3WithoutAnnot.pdf_signed.pdf" size="276755" author="cbremaud" created="Fri, 20 Mar 2015 14:05:13 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>8.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 25 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i271iv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>