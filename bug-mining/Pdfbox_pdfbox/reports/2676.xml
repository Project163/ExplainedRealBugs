<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:12:50 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PDFBOX-5395] Hangup in COSFilterInputStream.nextRange</title>
                <link>https://issues.apache.org/jira/browse/PDFBOX-5395</link>
                <project id="12310760" key="PDFBOX">PDFBox</project>
                    <description>&lt;p&gt;On some broken PDFs call &lt;em&gt;PDSignature.getSignedContent&lt;/em&gt; never returns.&lt;br/&gt;
After exploring stacktrace I&apos;ve found cycle&#160;in &lt;em&gt;COSFilterInputStream.nextRange&lt;/em&gt;.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
            &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; (&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.position &amp;lt; &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.ranges[&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.range][0])
            {
                &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; skipped = &lt;span class=&quot;code-keyword&quot;&gt;super&lt;/span&gt;.skip(&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.ranges[&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.range][0] - &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.position);
                &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.position += skipped;
            }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Javadoc for &lt;em&gt;skip&lt;/em&gt; says &lt;em&gt;&quot;The skip method may, for a variety ofreasons, end up skipping over some smaller number of bytes, possibly 0.&quot;&lt;/em&gt;&lt;br/&gt;
So, when &lt;em&gt;skip&lt;/em&gt; returns 0 this cycle became infinite.&lt;br/&gt;
Tried in versions 2.0.25 and 3.0.0-RC1.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13434856">PDFBOX-5395</key>
            <summary>Hangup in COSFilterInputStream.nextRange</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tilman">Tilman Hausherr</assignee>
                                    <reporter username="ovoled">Aleksej Kozlov</reporter>
                        <labels>
                    </labels>
                <created>Mon, 21 Mar 2022 09:23:06 +0000</created>
                <updated>Thu, 21 Apr 2022 15:38:40 +0000</updated>
                            <resolved>Wed, 30 Mar 2022 02:58:40 +0000</resolved>
                                    <version>2.0.25</version>
                                    <fixVersion>2.0.26</fixVersion>
                    <fixVersion>3.0.0 PDFBox</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="17510015" author="tilman" created="Mon, 21 Mar 2022 17:06:18 +0000"  >&lt;p&gt;Can you share such a file? My guess is that the range contains some bad values, and I&apos;d just throw an IOException with details.&lt;/p&gt;</comment>
                            <comment id="17510060" author="JIRAUSER286862" created="Mon, 21 Mar 2022 18:21:20 +0000"  >&lt;p&gt;Sorry, my file is with personal data. But yes, it seems that the range contains bad values. Maybe (not sure) return value of &lt;em&gt;skip&lt;/em&gt; should be checked and if it is 0 &lt;em&gt;IOException&lt;/em&gt; should be thrown.&lt;/p&gt;</comment>
                            <comment id="17510070" author="jira-bot" created="Mon, 21 Mar 2022 18:54:07 +0000"  >&lt;p&gt;Commit 1899113 from Tilman Hausherr in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1899113&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1899113&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-5395&quot; title=&quot;Hangup in COSFilterInputStream.nextRange&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-5395&quot;&gt;&lt;del&gt;PDFBOX-5395&lt;/del&gt;&lt;/a&gt;: avoid endless loop, as suggested by Aleksej Kozlov&lt;/p&gt;</comment>
                            <comment id="17510071" author="jira-bot" created="Mon, 21 Mar 2022 18:54:10 +0000"  >&lt;p&gt;Commit 1899114 from Tilman Hausherr in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1899114&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1899114&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-5395&quot; title=&quot;Hangup in COSFilterInputStream.nextRange&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-5395&quot;&gt;&lt;del&gt;PDFBOX-5395&lt;/del&gt;&lt;/a&gt;: avoid endless loop, as suggested by Aleksej Kozlov&lt;/p&gt;</comment>
                            <comment id="17510072" author="tilman" created="Mon, 21 Mar 2022 18:55:14 +0000"  >&lt;p&gt;Can you open such a file with an editor like NOTEPAD++ ? Search for &quot;/ByteRange&quot;. Then comes 4 values.&lt;/p&gt;</comment>
                            <comment id="17514197" author="JIRAUSER286862" created="Tue, 29 Mar 2022 17:00:24 +0000"  >&lt;p&gt;/ByteRange&lt;span class=&quot;error&quot;&gt;&amp;#91;0 17131 30609 5130 &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;&amp;#93;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;File size is 35739.&lt;/p&gt;

&lt;p&gt;Now exception is throwed with COSFilterInputStream.java from your commit.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Exception in thread &lt;span class=&quot;code-quote&quot;&gt;&quot;main&quot;&lt;/span&gt; java.io.IOException: FilterInputStream.skip() returns 0, range: [37696, 38191]
&#160; &#160; at org.apache.pdfbox.pdmodel.interactive.digitalsignature.COSFilterInputStream.nextRange(COSFilterInputStream.java:110)
&#160; &#160; at org.apache.pdfbox.pdmodel.interactive.digitalsignature.COSFilterInputStream.read(COSFilterInputStream.java:71)
&#160; &#160; at org.apache.pdfbox.pdmodel.interactive.digitalsignature.COSFilterInputStream.read(COSFilterInputStream.java:65)
&#160; &#160; at org.apache.pdfbox.io.IOUtils.copy(IOUtils.java:68)
&#160; &#160; at org.apache.pdfbox.io.IOUtils.toByteArray(IOUtils.java:52)
&#160; &#160; at org.apache.pdfbox.pdmodel.interactive.digitalsignature.COSFilterInputStream.toByteArray(COSFilterInputStream.java:82)
&#160; &#160; at org.apache.pdfbox.pdmodel.interactive.digitalsignature.PDSignature.getSignedContent(PDSignature.java:447)
&#160; &#160; at Main.main(Main.java:45)&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17514268" author="tilman" created="Tue, 29 Mar 2022 18:22:09 +0000"  >&lt;p&gt;I wonder if there are two /ByteRange arrays in that file. Because the one you posted is fine. The one from the exception text has a beginning offset that is after the file size?! Maybe the cause is more complex, and the skip returning 0 is a result of something unknown.&lt;/p&gt;</comment>
                            <comment id="17514414" author="tilman" created="Wed, 30 Mar 2022 02:59:49 +0000"  >&lt;p&gt;I&apos;ve set this to resolved; if you think there&apos;s more, please try some debugging where this past-EOF number comes from and create a new issue.&lt;/p&gt;</comment>
                            <comment id="17515223" author="JIRAUSER286862" created="Thu, 31 Mar 2022 10:20:45 +0000"  >&lt;p&gt;Seems that file contains two signatures. Acrobat Reader says that file cannot be opened (it&apos;s ok, I consider the file is broken). Method document.getSignatureDictionaries() returns two elements. Both has filter Adobe.PPKLite / adbe.pkcs7.detached. But when I search in text editor for &quot;ByteRange&quot; there is only one place found. And even for &quot;PPKLite&quot; there is only one place found. Maybe second signature is in compressed stream?&lt;/p&gt;

&lt;p&gt;At least the problem with hangup is gone.&lt;/p&gt;

&lt;p&gt;Thank you!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 32 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z10nxk:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>