<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:07:12 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PDFBOX-4149] PDF consisting on one page with 5 MB renders until the end of time using renderImageWithDPI</title>
                <link>https://issues.apache.org/jira/browse/PDFBOX-4149</link>
                <project id="12310760" key="PDFBOX">PDFBox</project>
                    <description>&lt;p&gt;I am using PDFBOX 2.0.8 on a Java VM 1.8.0_151&lt;/p&gt;

&lt;p&gt;The attached and valid pdf should be rendered by calling&lt;/p&gt;

&lt;p&gt;BufferedImage bim = pdfRenderer.renderImageWithDPI(i, 50);&lt;/p&gt;

&lt;p&gt;But the rendering never ends - the only thing I see is this line repeating very often in the console:&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;Finalizer&amp;#93;&lt;/span&gt; DEBUG org.apache.pdfbox.io.ScratchFileBuffer - ScratchFileBuffer not closed!&lt;/p&gt;

&lt;p&gt;Here is the code that is used to open the document and then start the rendering:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
PDDocument document = PDDocument.load(file, MemoryUsageSetting.setupTempFileOnly());
&lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt;  {
   PDFRenderer pdfRenderer = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; PDFRenderer(document);
   &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; numberOfPages = document.getPages().getCount();
   &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; i = 0; i &amp;lt; numberOfPages; i++) {
      BufferedImage bim = pdfRenderer.renderImageWithDPI(i, 50);
[...]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The line &lt;/p&gt;

&lt;p&gt;BufferedImage bim = pdfRenderer.renderImageWithDPI(i, 50); &lt;/p&gt;

&lt;p&gt;is never passed. I ran a test and have wait for 30 minutes to let it pass, but nothing happens. &lt;/p&gt;

&lt;p&gt;Please advise what to do and how to solve the issue.&lt;/p&gt;
</description>
                <environment></environment>
        <key id="13144127">PDFBOX-4149</key>
            <summary>PDF consisting on one page with 5 MB renders until the end of time using renderImageWithDPI</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tilman">Tilman Hausherr</assignee>
                                    <reporter username="Pinny3">Christian</reporter>
                        <labels>
                    </labels>
                <created>Sun, 11 Mar 2018 08:00:15 +0000</created>
                <updated>Thu, 13 Feb 2025 11:29:21 +0000</updated>
                            <resolved>Wed, 6 Feb 2019 16:44:50 +0000</resolved>
                                    <version>2.0.8</version>
                                    <fixVersion>2.0.14</fixVersion>
                    <fixVersion>3.0.0 PDFBox</fixVersion>
                                    <component>Rendering</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="16394478" author="tilman" created="Sun, 11 Mar 2018 11:11:27 +0000"  >&lt;p&gt;165 seconds with the KCMS option on&#160;&lt;a href=&quot;https://pdfbox.apache.org/2.0/getting-started.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://pdfbox.apache.org/2.0/getting-started.html&lt;/a&gt; . 136 seconds when using the CMYK option. The file has 5223 Images and 3233 colorspaces.&lt;/p&gt;</comment>
                            <comment id="16394573" author="tilman" created="Sun, 11 Mar 2018 17:05:19 +0000"  >&lt;p&gt;There is some hope to get the total time down a bit... tests with the profiler show that the time is lost in several areas. One thing I noticed is that the colorspaces are all based on the same ICC colorspace, yet this colorspace is created again and again.&lt;/p&gt;</comment>
                            <comment id="16394867" author="jira-bot" created="Mon, 12 Mar 2018 06:44:18 +0000"  >&lt;p&gt;Commit 1826504 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1826504&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1826504&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4149&quot; title=&quot;PDF consisting on one page with 5 MB renders until the end of time using renderImageWithDPI&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4149&quot;&gt;&lt;del&gt;PDFBOX-4149&lt;/del&gt;&lt;/a&gt;: use cache when creating base colorspace in indexed colorspace&lt;/p&gt;</comment>
                            <comment id="16394868" author="jira-bot" created="Mon, 12 Mar 2018 06:44:25 +0000"  >&lt;p&gt;Commit 1826505 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1826505&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1826505&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4149&quot; title=&quot;PDF consisting on one page with 5 MB renders until the end of time using renderImageWithDPI&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4149&quot;&gt;&lt;del&gt;PDFBOX-4149&lt;/del&gt;&lt;/a&gt;: use cache when creating base colorspace in indexed colorspace&lt;/p&gt;</comment>
                            <comment id="16395494" author="jira-bot" created="Mon, 12 Mar 2018 16:47:25 +0000"  >&lt;p&gt;Commit 1826574 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1826574&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1826574&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4149&quot; title=&quot;PDF consisting on one page with 5 MB renders until the end of time using renderImageWithDPI&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4149&quot;&gt;&lt;del&gt;PDFBOX-4149&lt;/del&gt;&lt;/a&gt;: forgot to use new constructor&lt;/p&gt;</comment>
                            <comment id="16395873" author="jira-bot" created="Mon, 12 Mar 2018 20:51:27 +0000"  >&lt;p&gt;Commit 1826590 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1826590&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1826590&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4149&quot; title=&quot;PDF consisting on one page with 5 MB renders until the end of time using renderImageWithDPI&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4149&quot;&gt;&lt;del&gt;PDFBOX-4149&lt;/del&gt;&lt;/a&gt;: fix typo&lt;/p&gt;</comment>
                            <comment id="16395874" author="jira-bot" created="Mon, 12 Mar 2018 20:51:31 +0000"  >&lt;p&gt;Commit 1826591 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1826591&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1826591&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4149&quot; title=&quot;PDF consisting on one page with 5 MB renders until the end of time using renderImageWithDPI&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4149&quot;&gt;&lt;del&gt;PDFBOX-4149&lt;/del&gt;&lt;/a&gt;: fix typo&lt;/p&gt;</comment>
                            <comment id="16401101" author="tilman" created="Thu, 15 Mar 2018 20:48:33 +0000"  >&lt;p&gt;You could get times down by making a change in PDColorSpace.toRGBImageAWT():&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Graphics g = dest.getGraphics();
g.drawImage(src, 0, 0, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;);
g.dispose();
&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; dest;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The problem is that some images look slightly different. A compromise is to enclose the block with this:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (raster.getWidth() * raster.getHeight() &amp;lt; 100)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="16761919" author="tilman" created="Wed, 6 Feb 2019 16:44:50 +0000"  >&lt;p&gt;I&apos;m setting this one as resolved. Time has gone down to 23 seconds to render at 100% on an old PC, even with 2.0.9. There were several improvements in the past, both in java and in PDFBox. Make sure to use the jdk 8 191 or higher or jdk 11.0.2 or higher. The KCMS option is no longer needed.&lt;br/&gt;
&#160;&lt;br/&gt;
23 seconds is slow, but it&apos;s better than what was mentioned before: &quot;until the end of time&quot;, &quot;30 minutes&quot;, &quot;165 seconds&quot; or &quot;136 seconds&quot;.&lt;br/&gt;
&#160;&lt;br/&gt;
There&apos;s also the workaround introduced in &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4309&quot; title=&quot;Performance regression in PDColorSpace#toRGBImageAWT Part 2&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4309&quot;&gt;PDFBOX-4309&lt;/a&gt; ( -Dorg.apache.pdfbox.rendering.UseAlternateInsteadOfICCColorSpace=true ), that one makes it even faster but the colors won&apos;t be very good. If you want, set yourself as a watcher on that issue, other improvements were also discussed there but not made, it&apos;s a bit confusing there.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13608150">PDFBOX-5952</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12913925" name="SB_Flyer_SpargelPromo_03-062018.pdf" size="5735239" author="Pinny3" created="Sun, 11 Mar 2018 07:59:08 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 40 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3r567:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>