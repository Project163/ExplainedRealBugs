<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:09:01 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PDFBOX-4437] Import XFDF stamp annotation loses appearance</title>
                <link>https://issues.apache.org/jira/browse/PDFBOX-4437</link>
                <project id="12310760" key="PDFBOX">PDFBox</project>
                    <description>&lt;p&gt;When loading an XFDF which has a stamp annotation&#160;which contains an&#160;appearance element after added to the PDF in place of the annotation is an box with an X.&lt;/p&gt;

&lt;p&gt;Reviewing the FDFAnnotationStamp class, it skips all internal elements.&#160; Is there any development being done to enhance this?&lt;/p&gt;

&lt;p&gt;I&apos;ve attached &quot;xfdf stamp annotation to PDF.zip&quot; which has an example, if you open the stamp_annot.xfdf it will show on the PDF.&#160; While using PDFBox API the only piece missing is the appearance of the stamp.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13210450">PDFBOX-4437</key>
            <summary>Import XFDF stamp annotation loses appearance</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tilman">Tilman Hausherr</assignee>
                                    <reporter username="andrew.hung">Andrew Hung</reporter>
                        <labels>
                            <label>Annotations</label>
                            <label>xfdf</label>
                            <label>xml</label>
                    </labels>
                <created>Fri, 18 Jan 2019 18:08:39 +0000</created>
                <updated>Fri, 1 Mar 2019 10:00:48 +0000</updated>
                            <resolved>Sun, 27 Jan 2019 09:42:52 +0000</resolved>
                                    <version>2.0.9</version>
                    <version>2.0.10</version>
                    <version>2.0.11</version>
                    <version>2.0.12</version>
                    <version>2.0.13</version>
                                    <fixVersion>2.0.14</fixVersion>
                    <fixVersion>3.0.0 PDFBox</fixVersion>
                                    <component>PDModel</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="16746542" author="tilman" created="Fri, 18 Jan 2019 18:10:17 +0000"  >&lt;p&gt;Please retry with the current version.&lt;/p&gt;</comment>
                            <comment id="16746545" author="andrew.hung" created="Fri, 18 Jan 2019 18:17:01 +0000"  >&lt;p&gt;Hi Tilman it is the same within the latest 2.0.13 version.&#160; Sorry I missed to note that in affected versions&lt;/p&gt;</comment>
                            <comment id="16747010" author="tilman" created="Sat, 19 Jan 2019 10:27:34 +0000"  >&lt;p&gt;Thanks, I didn&apos;t even look at it, because I had hoped this was related to a specific problem that had been solved not long ago (by a helpful user), but it isn&apos;t. Now I looked at the XML, the appearance part is base64 encoded and has XML again:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;&amp;lt;DICT KEY=&quot;AP&quot;&amp;gt;&amp;lt;STREAM KEY=&quot;N&quot;&amp;gt;&amp;lt;ARRAY KEY=&quot;BBox&quot;&amp;gt;&amp;lt;FIXED VAL=&quot;0.000000&quot;/&amp;gt;
&amp;lt;FIXED VAL=&quot;0.000000&quot;/&amp;gt;
&amp;lt;FIXED VAL=&quot;512.000000&quot;/&amp;gt;
&amp;lt;FIXED VAL=&quot;512.000000&quot;/&amp;gt;
&amp;lt;/ARRAY&amp;gt;
&amp;lt;INT KEY=&quot;FormType&quot; VAL=&quot;1&quot;/&amp;gt;
&amp;lt;INT KEY=&quot;Length&quot; VAL=&quot;68&quot;/&amp;gt;
&amp;lt;ARRAY KEY=&quot;Matrix&quot;&amp;gt;&amp;lt;FIXED VAL=&quot;-0.000000&quot;/&amp;gt;
&amp;lt;FIXED VAL=&quot;1.000000&quot;/&amp;gt;
&amp;lt;FIXED VAL=&quot;-1.000000&quot;/&amp;gt;
&amp;lt;FIXED VAL=&quot;-0.000000&quot;/&amp;gt;
&amp;lt;FIXED VAL=&quot;-0.000000&quot;/&amp;gt;
&amp;lt;FIXED VAL=&quot;-0.000000&quot;/&amp;gt;
&amp;lt;/ARRAY&amp;gt;
&amp;lt;NAME KEY=&quot;Name&quot; VAL=&quot;FRM&quot;/&amp;gt;
&amp;lt;DICT KEY=&quot;Resources&quot;&amp;gt;&amp;lt;DICT KEY=&quot;XObject&quot;&amp;gt;&amp;lt;STREAM KEY=&quot;xobj1&quot;&amp;gt;&amp;lt;INT KEY=&quot;BitsPerComponent&quot; VAL=&quot;8&quot;/&amp;gt;
&amp;lt;NAME KEY=&quot;ColorSpace&quot; VAL=&quot;DeviceRGB&quot;/&amp;gt;
&amp;lt;NAME KEY=&quot;Filter&quot; VAL=&quot;DCTDecode&quot;/&amp;gt;
&amp;lt;INT KEY=&quot;Height&quot; VAL=&quot;2033&quot;/&amp;gt;
&amp;lt;BOOL KEY=&quot;Interpolate&quot; VAL=&quot;true&quot;/&amp;gt;
&amp;lt;INT KEY=&quot;Length&quot; VAL=&quot;98993&quot;/&amp;gt;
&amp;lt;STREAM KEY=&quot;SMask&quot;&amp;gt;&amp;lt;INT KEY=&quot;BitsPerComponent&quot; VAL=&quot;8&quot;/&amp;gt;
&amp;lt;NAME KEY=&quot;ColorSpace&quot; VAL=&quot;DeviceGray&quot;/&amp;gt;
&amp;lt;NAME KEY=&quot;Filter&quot; VAL=&quot;FlateDecode&quot;/&amp;gt;
&amp;lt;INT KEY=&quot;Height&quot; VAL=&quot;2033&quot;/&amp;gt;
&amp;lt;BOOL KEY=&quot;Interpolate&quot; VAL=&quot;true&quot;/&amp;gt;
&amp;lt;INT KEY=&quot;Length&quot; VAL=&quot;18812&quot;/&amp;gt;
&amp;lt;NAME KEY=&quot;Subtype&quot; VAL=&quot;Image&quot;/&amp;gt;
&amp;lt;NAME KEY=&quot;Type&quot; VAL=&quot;XObject&quot;/&amp;gt;
&amp;lt;INT KEY=&quot;Width&quot; VAL=&quot;1089&quot;/&amp;gt;
&amp;lt;DATA ENCODING=&quot;HEX&quot; MODE=&quot;RAW&quot;&amp;gt;789CEDDD89BF6EE5D807F07D4E6992E29044197AD52B4332678A121129A450990B494288572153282443322543BD85E455864C1199338628438644A8A438757A2BC919F6F03C6B3F6BFDEE7BADEFF72FB8EFEBBEAEDFE77CCEDA7B5F5353D559B4EDF3DFFD851F9D7B05F4C5EF7FF8F9773
&#8230;.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;There is no development being done there currently.&lt;/p&gt;

&lt;p&gt;An alternative would be to recreate the appearance stream, but this hasn&apos;t been implemented for stamp annotations. (It is implemented for many annotations in &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3353&quot; title=&quot;Create appearance streams for annotations&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3353&quot;&gt;PDFBOX-3353&lt;/a&gt; for the trunk only)&lt;/p&gt;</comment>
                            <comment id="16747154" author="andrew.hung" created="Sat, 19 Jan 2019 15:42:32 +0000"  >&lt;p&gt;Hi Tilman, you are correct as this is my investigation too including the stamp image is hex encoded.&lt;/p&gt;

&lt;p&gt;I&apos;ll check about the reference issue pdfbox-3353.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Do you have any direction in converting this to an appearance stream or dictionary, I&apos;m not sure where to start this properly?&#160; Since I&apos;m not an expert with yet.&#160; I&apos;m going to attempt and build a proof of concept just trying to wrap my head which direction to go.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;This would bring PDFBox a long way to have this resolving this as stamps are heavily used in pdf markups.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Appreciate the assistance.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Andrew&lt;/p&gt;</comment>
                            <comment id="16747157" author="andrew.hung" created="Sat, 19 Jan 2019 15:47:34 +0000"  >&lt;p&gt;I&apos;ll add that when the hex value is decoded looks to be pdf coded, unless decoding it is not needed, I&apos;ll add it in text later.&lt;/p&gt;</comment>
                            <comment id="16747158" author="tilman" created="Sat, 19 Jan 2019 15:49:29 +0000"  >&lt;p&gt;What you could so is this: get the source code and find FDFAnnotation.java (FDFAnnotationStamp.java might also work). Here&apos;s the &quot;dumb&quot; code I added to the constructor with Element parameter:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(&lt;span class=&quot;code-quote&quot;&gt;&quot;children: &quot;&lt;/span&gt; + element.getChildNodes().getLength());
NodeList childNodes = element.getChildNodes();
&lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; i = 0; i &amp;lt; element.getChildNodes().getLength(); ++i)
{
    Node item = childNodes.item(i);
    &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(i + &lt;span class=&quot;code-quote&quot;&gt;&quot;: &quot;&lt;/span&gt; + childNodes.item(i).getClass() + &lt;span class=&quot;code-quote&quot;&gt;&quot; &quot;&lt;/span&gt; + item);
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (item &lt;span class=&quot;code-keyword&quot;&gt;instanceof&lt;/span&gt; Element)
    {
        Element el = (Element) item;
        &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(&lt;span class=&quot;code-quote&quot;&gt;&quot;el: &quot;&lt;/span&gt; + el + &lt;span class=&quot;code-quote&quot;&gt;&quot;, len: &quot;&lt;/span&gt; + el.getAttributes().getLength() + &lt;span class=&quot;code-quote&quot;&gt;&quot;, children: &quot;&lt;/span&gt; + el.getChildNodes().getLength());
        &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; j = 0; j &amp;lt; el.getChildNodes().getLength(); ++j)
        {
            Node item2 = el.getChildNodes().item(j);
            &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(&lt;span class=&quot;code-quote&quot;&gt;&quot;\tel2: &quot;&lt;/span&gt; + item2);
        }
    }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;This was just to look what&apos;s coming in. At some point you&apos;ll get the base64 output in item2.&lt;/p&gt;</comment>
                            <comment id="16749095" author="andrew.hung" created="Tue, 22 Jan 2019 20:16:12 +0000"  >&lt;p&gt;I&apos;ve made some progress and got some stamps to work see &quot;FDFAnnotationStamp.java&quot;, image stamps are not working and that is the format is different.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;I also make reference to &quot;https://svn.apache.org/repos/asf/pdfbox/trunk/examples/src/main/java/org/apache/pdfbox/examples/pdmodel/RubberStampWithImage.java&quot; which got me started on the idea.&lt;/p&gt;</comment>
                            <comment id="16750067" author="andrew.hung" created="Wed, 23 Jan 2019 14:48:15 +0000"  >&lt;p&gt;Running into some issues and looks for assistance.&lt;/p&gt;

&lt;p&gt;I&apos;ve attached the&#160;&lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12955983/12955983_Stamp_appearance_decoded.txt&quot; title=&quot;Stamp_appearance_decoded.txt attached to PDFBOX-4437&quot;&gt;Stamp_appearance_decoded.txt&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt; of a image stamp, and the original xfdf&#160;&lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12955984/12955984_stamp_annotation.xfdf&quot; title=&quot;stamp_annotation.xfdf attached to PDFBOX-4437&quot;&gt;stamp_annotation.xfdf&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;&#160;which is linked to the PDF&#160;&lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12955985/12955985_A1.01+-+MYLES+-+2ND-4TH++FLOOR+PLAN.pdf&quot; title=&quot;A1.01 - MYLES - 2ND-4TH  FLOOR PLAN.pdf attached to PDFBOX-4437&quot;&gt;A1.01 - MYLES - 2ND-4TH  FLOOR PLAN.pdf&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;Below is the content of the appearance decoded but replaced the data value since it was too large, xfdf itself was 378KB.&lt;/p&gt;

&lt;p&gt;What I&apos;m trying to do is the following:&lt;/p&gt;

&lt;p&gt;1) Use PDAppearanceDictionary (apDict) - this covers the first 2 elements key AP and N)&lt;/p&gt;

&lt;p&gt;2) Create PDFormXObject (form)&lt;/p&gt;

&lt;p&gt;3) Set BBox to the form&lt;/p&gt;

&lt;p&gt;4) Set Matrix to the form&lt;/p&gt;

&lt;p&gt;5) Create PDResources (resources)&lt;/p&gt;

&lt;p&gt;6) Create a PDImageXObject (image) using the following:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
PDImageXObject imageX = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; PDImageXObject(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; PDStream(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; COSStream()), &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; PDResources());
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;7)&#160;Decode to data value and outputstream (os.write) it to the image like so&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
os.write( datavalue.getBytes(&lt;span class=&quot;code-quote&quot;&gt;&quot;ISO-8859-1&quot;&lt;/span&gt;));
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;8) Add PDImageXObject to resources&lt;/p&gt;

&lt;p&gt;9) Set resources to form&lt;/p&gt;

&lt;p&gt;10) Set normalAppearance to apDict&lt;/p&gt;

&lt;p&gt;Part of the issue I face is the root data has reference to xobj1, which needed to be updated since step 8 creates a new id.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;But based on those steps do you see anything wrong in how I&apos;m using the API, or do I need to go down and build FDF objects for these items and/or working with a COSDictionary directly?&lt;/p&gt;

&lt;p&gt;Attached current updated version of&#160;&lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12955986/12955986_FDFAnnotationStamp2.java&quot; title=&quot;FDFAnnotationStamp2.java attached to PDFBOX-4437&quot;&gt;FDFAnnotationStamp2.java&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt; (I&apos;ll be added more detailed comments to help in read it better).&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&amp;lt;DICT KEY=&lt;span class=&quot;code-quote&quot;&gt;&quot;AP&quot;&lt;/span&gt;&amp;gt;
&amp;lt;STREAM KEY=&lt;span class=&quot;code-quote&quot;&gt;&quot;N&quot;&lt;/span&gt;&amp;gt;
&amp;lt;ARRAY KEY=&lt;span class=&quot;code-quote&quot;&gt;&quot;BBox&quot;&lt;/span&gt;&amp;gt;
&amp;lt;FIXED VAL=&lt;span class=&quot;code-quote&quot;&gt;&quot;0.000000&quot;&lt;/span&gt;/&amp;gt;
&amp;lt;FIXED VAL=&lt;span class=&quot;code-quote&quot;&gt;&quot;0.000000&quot;&lt;/span&gt;/&amp;gt;
&amp;lt;FIXED VAL=&lt;span class=&quot;code-quote&quot;&gt;&quot;512.000000&quot;&lt;/span&gt;/&amp;gt;
&amp;lt;FIXED VAL=&lt;span class=&quot;code-quote&quot;&gt;&quot;512.000000&quot;&lt;/span&gt;/&amp;gt;
&amp;lt;/ARRAY&amp;gt;
&amp;lt;INT KEY=&lt;span class=&quot;code-quote&quot;&gt;&quot;FormType&quot;&lt;/span&gt; VAL=&lt;span class=&quot;code-quote&quot;&gt;&quot;1&quot;&lt;/span&gt;/&amp;gt;
&amp;lt;INT KEY=&lt;span class=&quot;code-quote&quot;&gt;&quot;Length&quot;&lt;/span&gt; VAL=&lt;span class=&quot;code-quote&quot;&gt;&quot;68&quot;&lt;/span&gt;/&amp;gt;
&amp;lt;ARRAY KEY=&lt;span class=&quot;code-quote&quot;&gt;&quot;Matrix&quot;&lt;/span&gt;&amp;gt;
&amp;lt;FIXED VAL=&lt;span class=&quot;code-quote&quot;&gt;&quot;-0.000000&quot;&lt;/span&gt;/&amp;gt;
&amp;lt;FIXED VAL=&lt;span class=&quot;code-quote&quot;&gt;&quot;1.000000&quot;&lt;/span&gt;/&amp;gt;
&amp;lt;FIXED VAL=&lt;span class=&quot;code-quote&quot;&gt;&quot;-1.000000&quot;&lt;/span&gt;/&amp;gt;
&amp;lt;FIXED VAL=&lt;span class=&quot;code-quote&quot;&gt;&quot;-0.000000&quot;&lt;/span&gt;/&amp;gt;
&amp;lt;FIXED VAL=&lt;span class=&quot;code-quote&quot;&gt;&quot;-0.000000&quot;&lt;/span&gt;/&amp;gt;
&amp;lt;FIXED VAL=&lt;span class=&quot;code-quote&quot;&gt;&quot;-0.000000&quot;&lt;/span&gt;/&amp;gt;
&amp;lt;/ARRAY&amp;gt;
&amp;lt;NAME KEY=&lt;span class=&quot;code-quote&quot;&gt;&quot;Name&quot;&lt;/span&gt; VAL=&lt;span class=&quot;code-quote&quot;&gt;&quot;FRM&quot;&lt;/span&gt;/&amp;gt;
&amp;lt;DICT KEY=&lt;span class=&quot;code-quote&quot;&gt;&quot;Resources&quot;&lt;/span&gt;&amp;gt;
&amp;lt;DICT KEY=&lt;span class=&quot;code-quote&quot;&gt;&quot;XObject&quot;&lt;/span&gt;&amp;gt;
&amp;lt;STREAM KEY=&lt;span class=&quot;code-quote&quot;&gt;&quot;xobj1&quot;&lt;/span&gt;&amp;gt;
&amp;lt;INT KEY=&lt;span class=&quot;code-quote&quot;&gt;&quot;BitsPerComponent&quot;&lt;/span&gt; VAL=&lt;span class=&quot;code-quote&quot;&gt;&quot;8&quot;&lt;/span&gt;/&amp;gt;
&amp;lt;NAME KEY=&lt;span class=&quot;code-quote&quot;&gt;&quot;ColorSpace&quot;&lt;/span&gt; VAL=&lt;span class=&quot;code-quote&quot;&gt;&quot;DeviceRGB&quot;&lt;/span&gt;/&amp;gt;
&amp;lt;NAME KEY=&lt;span class=&quot;code-quote&quot;&gt;&quot;Filter&quot;&lt;/span&gt; VAL=&lt;span class=&quot;code-quote&quot;&gt;&quot;DCTDecode&quot;&lt;/span&gt;/&amp;gt;
&amp;lt;INT KEY=&lt;span class=&quot;code-quote&quot;&gt;&quot;Height&quot;&lt;/span&gt; VAL=&lt;span class=&quot;code-quote&quot;&gt;&quot;2033&quot;&lt;/span&gt;/&amp;gt;
&amp;lt;BOOL KEY=&lt;span class=&quot;code-quote&quot;&gt;&quot;Interpolate&quot;&lt;/span&gt; VAL=&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt;/&amp;gt;
&amp;lt;INT KEY=&lt;span class=&quot;code-quote&quot;&gt;&quot;Length&quot;&lt;/span&gt; VAL=&lt;span class=&quot;code-quote&quot;&gt;&quot;98993&quot;&lt;/span&gt;/&amp;gt;
&amp;lt;STREAM KEY=&lt;span class=&quot;code-quote&quot;&gt;&quot;SMask&quot;&lt;/span&gt;&amp;gt;
&amp;lt;INT KEY=&lt;span class=&quot;code-quote&quot;&gt;&quot;BitsPerComponent&quot;&lt;/span&gt; VAL=&lt;span class=&quot;code-quote&quot;&gt;&quot;8&quot;&lt;/span&gt;/&amp;gt;
&amp;lt;NAME KEY=&lt;span class=&quot;code-quote&quot;&gt;&quot;ColorSpace&quot;&lt;/span&gt; VAL=&lt;span class=&quot;code-quote&quot;&gt;&quot;DeviceGray&quot;&lt;/span&gt;/&amp;gt;
&amp;lt;NAME KEY=&lt;span class=&quot;code-quote&quot;&gt;&quot;Filter&quot;&lt;/span&gt; VAL=&lt;span class=&quot;code-quote&quot;&gt;&quot;FlateDecode&quot;&lt;/span&gt;/&amp;gt;
&amp;lt;INT KEY=&lt;span class=&quot;code-quote&quot;&gt;&quot;Height&quot;&lt;/span&gt; VAL=&lt;span class=&quot;code-quote&quot;&gt;&quot;2033&quot;&lt;/span&gt;/&amp;gt;
&amp;lt;BOOL KEY=&lt;span class=&quot;code-quote&quot;&gt;&quot;Interpolate&quot;&lt;/span&gt; VAL=&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt;/&amp;gt;
&amp;lt;INT KEY=&lt;span class=&quot;code-quote&quot;&gt;&quot;Length&quot;&lt;/span&gt; VAL=&lt;span class=&quot;code-quote&quot;&gt;&quot;18812&quot;&lt;/span&gt;/&amp;gt;
&amp;lt;NAME KEY=&lt;span class=&quot;code-quote&quot;&gt;&quot;Subtype&quot;&lt;/span&gt; VAL=&lt;span class=&quot;code-quote&quot;&gt;&quot;Image&quot;&lt;/span&gt;/&amp;gt;
&amp;lt;NAME KEY=&lt;span class=&quot;code-quote&quot;&gt;&quot;Type&quot;&lt;/span&gt; VAL=&lt;span class=&quot;code-quote&quot;&gt;&quot;XObject&quot;&lt;/span&gt;/&amp;gt;
&amp;lt;INT KEY=&lt;span class=&quot;code-quote&quot;&gt;&quot;Width&quot;&lt;/span&gt; VAL=&lt;span class=&quot;code-quote&quot;&gt;&quot;1089&quot;&lt;/span&gt;/&amp;gt;
&amp;lt;DATA ENCODING=&lt;span class=&quot;code-quote&quot;&gt;&quot;HEX&quot;&lt;/span&gt; MODE=&lt;span class=&quot;code-quote&quot;&gt;&quot;RAW&quot;&lt;/span&gt;&amp;gt;bytes&amp;lt;/DATA&amp;gt;
&amp;lt;/STREAM&amp;gt;
&amp;lt;NAME KEY=&lt;span class=&quot;code-quote&quot;&gt;&quot;Subtype&quot;&lt;/span&gt; VAL=&lt;span class=&quot;code-quote&quot;&gt;&quot;Image&quot;&lt;/span&gt;/&amp;gt;
&amp;lt;NAME KEY=&lt;span class=&quot;code-quote&quot;&gt;&quot;Type&quot;&lt;/span&gt; VAL=&lt;span class=&quot;code-quote&quot;&gt;&quot;XObject&quot;&lt;/span&gt;/&amp;gt;
&amp;lt;INT KEY=&lt;span class=&quot;code-quote&quot;&gt;&quot;Width&quot;&lt;/span&gt; VAL=&lt;span class=&quot;code-quote&quot;&gt;&quot;1089&quot;&lt;/span&gt;/&amp;gt;
&amp;lt;DATA ENCODING=&lt;span class=&quot;code-quote&quot;&gt;&quot;HEX&quot;&lt;/span&gt; MODE=&lt;span class=&quot;code-quote&quot;&gt;&quot;RAW&quot;&lt;/span&gt;&amp;gt;bytes&amp;lt;/DATA&amp;gt;
&amp;lt;/STREAM&amp;gt;
&amp;lt;STREAM KEY=&lt;span class=&quot;code-quote&quot;&gt;&quot;xobj2&quot;&lt;/span&gt;&amp;gt;
&amp;lt;INT KEY=&lt;span class=&quot;code-quote&quot;&gt;&quot;BitsPerComponent&quot;&lt;/span&gt; VAL=&lt;span class=&quot;code-quote&quot;&gt;&quot;8&quot;&lt;/span&gt;/&amp;gt;
&amp;lt;NAME KEY=&lt;span class=&quot;code-quote&quot;&gt;&quot;ColorSpace&quot;&lt;/span&gt; VAL=&lt;span class=&quot;code-quote&quot;&gt;&quot;DeviceGray&quot;&lt;/span&gt;/&amp;gt;
&amp;lt;NAME KEY=&lt;span class=&quot;code-quote&quot;&gt;&quot;Filter&quot;&lt;/span&gt; VAL=&lt;span class=&quot;code-quote&quot;&gt;&quot;FlateDecode&quot;&lt;/span&gt;/&amp;gt;
&amp;lt;INT KEY=&lt;span class=&quot;code-quote&quot;&gt;&quot;Height&quot;&lt;/span&gt; VAL=&lt;span class=&quot;code-quote&quot;&gt;&quot;2033&quot;&lt;/span&gt;/&amp;gt;
&amp;lt;BOOL KEY=&lt;span class=&quot;code-quote&quot;&gt;&quot;Interpolate&quot;&lt;/span&gt; VAL=&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt;/&amp;gt;
&amp;lt;INT KEY=&lt;span class=&quot;code-quote&quot;&gt;&quot;Length&quot;&lt;/span&gt; VAL=&lt;span class=&quot;code-quote&quot;&gt;&quot;18812&quot;&lt;/span&gt;/&amp;gt;
&amp;lt;NAME KEY=&lt;span class=&quot;code-quote&quot;&gt;&quot;Subtype&quot;&lt;/span&gt; VAL=&lt;span class=&quot;code-quote&quot;&gt;&quot;Image&quot;&lt;/span&gt;/&amp;gt;
&amp;lt;NAME KEY=&lt;span class=&quot;code-quote&quot;&gt;&quot;Type&quot;&lt;/span&gt; VAL=&lt;span class=&quot;code-quote&quot;&gt;&quot;XObject&quot;&lt;/span&gt;/&amp;gt;
&amp;lt;INT KEY=&lt;span class=&quot;code-quote&quot;&gt;&quot;Width&quot;&lt;/span&gt; VAL=&lt;span class=&quot;code-quote&quot;&gt;&quot;1089&quot;&lt;/span&gt;/&amp;gt;
&amp;lt;DATA ENCODING=&lt;span class=&quot;code-quote&quot;&gt;&quot;HEX&quot;&lt;/span&gt; MODE=&lt;span class=&quot;code-quote&quot;&gt;&quot;RAW&quot;&lt;/span&gt;&amp;gt;bytes&amp;lt;/DATA&amp;gt;
&amp;lt;/STREAM&amp;gt;
&amp;lt;/DICT&amp;gt;
&amp;lt;/DICT&amp;gt;
&amp;lt;NAME KEY=&lt;span class=&quot;code-quote&quot;&gt;&quot;Subtype&quot;&lt;/span&gt; VAL=&lt;span class=&quot;code-quote&quot;&gt;&quot;Form&quot;&lt;/span&gt;/&amp;gt;
&amp;lt;NAME KEY=&lt;span class=&quot;code-quote&quot;&gt;&quot;Type&quot;&lt;/span&gt; VAL=&lt;span class=&quot;code-quote&quot;&gt;&quot;XObject&quot;&lt;/span&gt;/&amp;gt;
&amp;lt;DATA ENCODING=&lt;span class=&quot;code-quote&quot;&gt;&quot;HEX&quot;&lt;/span&gt; MODE=&lt;span class=&quot;code-quote&quot;&gt;&quot;RAW&quot;&lt;/span&gt;&amp;gt;bytes&amp;lt;/DATA&amp;gt;
&amp;lt;/STREAM&amp;gt;
&amp;lt;/DICT&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="16750182" author="tilman" created="Wed, 23 Jan 2019 16:29:21 +0000"  >&lt;blockquote&gt;&lt;p&gt;&#160;do I need to go down and build FDF objects for these items and/or working with a COSDictionary directly&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Yes, there is a whole structure (possibly nested) that has to be decoded flexibly - you can&apos;t be sure how many levels there are. With patterns, shadings, etc. I didn&apos;t notice that before that this was nested.&lt;br/&gt;
 &#160;&lt;br/&gt;
 You can flexible create elements with COSDictionary.setItem().&#160;&lt;font color=&quot;#333333&quot;&gt;You should probably ignore the &quot;Length&quot; entries, because these are automatically set when saving a COSStream.&lt;/font&gt;&lt;/p&gt;

&lt;p&gt;When saving raw data to a COSStream, use createRawOutputStream.&lt;/p&gt;

&lt;p&gt;&#160;&lt;br/&gt;
 After looking at the XML again I see that the types can be identified, so you could check them and then create a COSReal, COSBoolean, COSInteger, COSArray, COSDictionary depending on the type.&lt;br/&gt;
 &#160;&lt;br/&gt;
 Re &quot;Hex&quot;: there is a utility &quot;Hex&quot; class in PDFBox, what you need is &lt;tt&gt;Hex.getBytes(child.getTextContent().getBytes())&lt;/tt&gt;.&lt;br/&gt;
 Re base64: to test, please use java.util.Base64 for your development, assuming that you use jdk8 or higher (you have to change &quot;java17&quot; to &quot;java18&quot; in the animal sniffer segment of the parent pom so that your build works). At a later time we&apos;ll have to use reflection, because the first is for jdk8 and higher, the second works up to jdk7.&lt;br/&gt;
 I have some (unfinished) reflection code for this, so don&apos;t spend time with it.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="16750216" author="andrew.hung" created="Wed, 23 Jan 2019 16:56:53 +0000"  >&lt;p&gt;Thank you for clarifying and actually answer additional questions I had, not clear what you mean by saving and using createRawOutputStream (I&apos;ll need to look into this).&lt;/p&gt;

&lt;p&gt;I&apos;m also limited to Java6 still, though everything used so far hasn&apos;t given me compatibility issues yet.&lt;/p&gt;

&lt;p&gt;So my understanding based to properly do this would be something of this structure&lt;/p&gt;

&lt;p&gt;COSDictionary for DICT(AP)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;COSDictionary for STREAM(N) -&amp;gt; or is this a COSStream&#160; (PDAppearanceDictionary initial creates this as a COSDictionary)
	&lt;ul&gt;
		&lt;li&gt;COSArray for ARRAY(BBox)&lt;/li&gt;
		&lt;li&gt;COSInteger for INT(FormType)&lt;/li&gt;
		&lt;li&gt;COSArray for ARRAY(Matrix)&lt;/li&gt;
		&lt;li&gt;COSString for NAME(Name)&lt;/li&gt;
		&lt;li&gt;COSDictionary for DICT(Resources)
		&lt;ul&gt;
			&lt;li&gt;COSDictionary for DICT(XObject)
			&lt;ul&gt;
				&lt;li&gt;COSStream for STREAM(xobj1)
				&lt;ul&gt;
					&lt;li&gt;.. more basic COS Object&lt;/li&gt;
					&lt;li&gt;COSStream for STREAM(SMask)
					&lt;ul&gt;
						&lt;li&gt;Stream the data value into parent cosstream&lt;/li&gt;
					&lt;/ul&gt;
					&lt;/li&gt;
				&lt;/ul&gt;
				&lt;/li&gt;
				&lt;li&gt;COSStream for STREAM(xobj2)
				&lt;ul&gt;
					&lt;li&gt;...&lt;/li&gt;
				&lt;/ul&gt;
				&lt;/li&gt;
			&lt;/ul&gt;
			&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
		&lt;li&gt;Stream the data value into parent dictionary&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Is this what you are suggesting?&#160; I&apos;ll need to really tweak my modification, though does sound right but not 100% clear especially for the STREAM elements&lt;/p&gt;</comment>
                            <comment id="16750239" author="tilman" created="Wed, 23 Jan 2019 17:11:17 +0000"  >&lt;p&gt;Yes!&lt;/p&gt;

&lt;p&gt;COSStream is also a COSDictionary. So in this appearance, N and&#160;xobj1 and xobj2 and&#160;SMask are streams.&lt;/p&gt;

&lt;p&gt;NAME is a COSName.&lt;/p&gt;

&lt;p&gt;I haen&apos;t found a COSString&#8230; maybe you have other files. Or maybe it is explained in the XFDF specification. (will look later)&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;#333333&quot;&gt;createRawOutputStream&#160;&lt;/font&gt; is to write the data of a COSStream low level, i.e. no encoding. (It is already encoded). Don&apos;t use&#160;createOutputStream() because that one encodes. To copy bytes, use IOUtils.copy().&lt;/p&gt;

&lt;p&gt;If you&apos;re using jdk6, then use &lt;tt&gt;DatatypeConverter.parseBase64Binary()&lt;/tt&gt;.&lt;/p&gt;</comment>
                            <comment id="16750244" author="andrew.hung" created="Wed, 23 Jan 2019 17:20:01 +0000"  >&lt;p&gt;Thank you again, greatly appreciated and for the corrections, was viewing the XML and trying to link to the API, overlooked COSName.&lt;/p&gt;

&lt;p&gt;I&apos;ll re-write what I&apos;ve done based on this new approach and will create a new class FDFAnnotationStampAppearance which will do all this processing.&lt;/p&gt;

&lt;p&gt;I was using apache for the base64, doesn&apos;t matter to me just wanted to get something in return that could be processed&#160;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;.&lt;/p&gt;

&lt;p&gt;Okay, I&apos;ll probably need to revisit the createRawOutputStream again.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="16750246" author="tilman" created="Wed, 23 Jan 2019 17:22:14 +0000"  >&lt;p&gt;I found the xfdf specification here&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://www.immagic.com/eLibrary/ARCHIVES/TECH/ADOBE/A070914X.pdf&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://www.immagic.com/eLibrary/ARCHIVES/TECH/ADOBE/A070914X.pdf&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;but they don&apos;t explain the xml.&lt;/p&gt;</comment>
                            <comment id="16750250" author="tilman" created="Wed, 23 Jan 2019 17:25:39 +0000"  >&lt;p&gt;I suspect that the final code can do the AP for any annotation.&lt;/p&gt;

&lt;p&gt;Re base64, I avoided using the apache code because of newbies who forget to include the jar in their project. This happens with a lot already with commons log.&lt;/p&gt;</comment>
                            <comment id="16750258" author="andrew.hung" created="Wed, 23 Jan 2019 17:35:57 +0000"  >&lt;p&gt;Thanks for all your input, i&apos;ll work in get approach and attach the working copy in hopes I dont run into any snags.  Seems very promising on what needs to be done and robust.&lt;/p&gt;

&lt;p&gt;Ah makes sense missing libraries is a pain.&lt;/p&gt;</comment>
                            <comment id="16750260" author="andrew.hung" created="Wed, 23 Jan 2019 17:37:09 +0000"  >&lt;p&gt;By the way, the XML xfdf I&apos;m working with came from another product called PSPDF, i suspect they are using proper specs since the xfdf does load in adobe reader properly.&lt;/p&gt;</comment>
                            <comment id="16750419" author="andrew.hung" created="Wed, 23 Jan 2019 20:50:06 +0000"  >&lt;p&gt;1) Any ideas how I should be handling the key attribute of the STREAM, as I&apos;m not sure how to add this using&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
setItem(COSName key, COSBase value)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;since unable to create new COSName with the actual key attribute, which I know is wrong but not clear what proper way to handle it right now.&lt;/p&gt;

&lt;p&gt;2) Should be calling close() after I&apos;ve completed adding items to the COSStream and COSDictionary, or does not need to be handled?&lt;/p&gt;</comment>
                            <comment id="16750435" author="tilman" created="Wed, 23 Jan 2019 21:17:35 +0000"  >&lt;p&gt;1)&#160;COSName.getPDFName()&lt;/p&gt;

&lt;p&gt;2) No, please don&apos;t, IIRC this is only done when closing the file. Only close the outputstream you got for writing.&lt;/p&gt;</comment>
                            <comment id="16750628" author="andrew.hung" created="Thu, 24 Jan 2019 02:18:29 +0000"  >&lt;p&gt;Tilman, I can&apos;t thank you enough for your input on this issue.&#160; I have successfully got a solution.&lt;/p&gt;

&lt;p&gt;Using&#160;&lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12956073/12956073_example.zip&quot; title=&quot;example.zip attached to PDFBOX-4437&quot;&gt;example.zip&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;&#160;which is a PDF and a folder of annotation the loading of the XFDF worked like a charm.&lt;/p&gt;

&lt;p&gt;Classes modified:&#160;&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12956075/12956075_FDFAnnotationStamp_final.java&quot; title=&quot;FDFAnnotationStamp_final.java attached to PDFBOX-4437&quot;&gt;FDFAnnotationStamp_final.java&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;&#160; &#160;&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12956143/12956143_FDFAnnotationStampAppearance_final.java&quot; title=&quot;FDFAnnotationStampAppearance_final.java attached to PDFBOX-4437&quot;&gt;FDFAnnotationStampAppearance_final.java&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;I was not able to use&#160;org.apache.pdfbox.util.Hex as I needed to decode the data value so stuck with apache-codec for now.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Take a look and any feedback would be great.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Thanks again.&lt;/p&gt;</comment>
                            <comment id="16750726" author="tilman" created="Thu, 24 Jan 2019 05:00:35 +0000"  >&lt;p&gt;Thanks I&apos;ll test that later today and will find out whether our Hex works or not for you, and also bring up the base64 thing.&lt;/p&gt;

&lt;p&gt;However you didn&apos;t understand me when I wrote &quot;&lt;font color=&quot;#333333&quot;&gt;has to be decoded flexibly&lt;/font&gt;&quot;, sorry about that. I mean that you should not look much for specific items, you should look for their types. So instead of&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;

&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;code-quote&quot;&gt;&quot;Interpolate&quot;&lt;/span&gt;.equals(childAttrKey)) 
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; LOG.debug(parentAttrKey + &lt;span class=&quot;code-quote&quot;&gt;&quot; =&amp;gt; Set Interpolate: &quot;&lt;/span&gt; + childAttrVal);
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; stream.setBoolean(COSName.INTERPOLATE, &lt;span class=&quot;code-object&quot;&gt;Boolean&lt;/span&gt;.parseBoolean(childAttrVal));
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; 
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; LOG.warn(parentAttrKey + &lt;span class=&quot;code-quote&quot;&gt;&quot; =&amp;gt; Not handling element BOOL key: &quot;&lt;/span&gt; + childAttrKey);
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;just do this:&lt;/p&gt;


&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; stream.setItem(childAttrKey, &lt;span class=&quot;code-object&quot;&gt;Boolean&lt;/span&gt;.parseBoolean(childAttrVal));
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This is just for a boolean. The same should be done for the other types.&lt;/p&gt;

&lt;p&gt;So for array:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&#160; &#160;&#160; stream.setItem(parentAttrKey, parseArrayElement(child));
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;So your new code is likely to be about 1/2 the size as the current one.&#160;&lt;/p&gt;

&lt;p&gt;Names that require specific handling should be handled separately, for example &quot;Length&quot; should be ignored.&lt;/p&gt;

&lt;p&gt;Your current code likely ignores the SMask component. That&apos;s why I warned &quot;...&lt;font color=&quot;#333333&quot;&gt;With patterns, shadings, etc.&lt;/font&gt;...&quot; These are all new keywords.&lt;/p&gt;</comment>
                            <comment id="16751096" author="andrew.hung" created="Thu, 24 Jan 2019 13:01:15 +0000"  >&lt;p&gt;I&apos;ve tweaked the logic to be robust using COSName.getPDFName(childAttrKey) and using conditions where it was required.&#160; Uploaded&#160;&lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12956143/12956143_FDFAnnotationStampAppearance_final.java&quot; title=&quot;FDFAnnotationStampAppearance_final.java attached to PDFBOX-4437&quot;&gt;FDFAnnotationStampAppearance_final.java&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
stream.setBoolean(COSName.getPDFName(childAttrKey), &lt;span class=&quot;code-object&quot;&gt;Boolean&lt;/span&gt;.parseBoolean(childAttrVal));

stream.setItem(COSName.getPDFName(childAttrKey), parseArrayElement(child));

stream.setItem(COSName.getPDFName(childAttrKey), parseDictElement(child));
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Process still worked as expected and all the elements are being read, only length is being ignored outright.&#160; I will note that the SMask is being read.&lt;/p&gt;

&lt;p&gt;I&apos;ll see if I can clean it up more.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="16751295" author="tilman" created="Thu, 24 Jan 2019 16:40:14 +0000"  >&lt;p&gt;Yeah, I was wrong when I wrote &quot;Your current code likely ignores the SMask component&quot; because when running it with the previous code the smask appeared, sorry. Your new code is much better!&lt;/p&gt;

&lt;p&gt;I also wrote code to parse the hex stuff, sorry for pointing you to the Hex class. I&apos;ll commit it, until then here it is:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
        /**
         * Decodes a hex &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; into a &lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt; array.
         *
         * @param s A &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; with ASCII hex.
         * @&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; decoded &lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt; array.
         * @&lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException
         */
        &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt;[] decodeHex(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; s) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException
        {
            ByteArrayOutputStream baos = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ByteArrayOutputStream();
            &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; i = 0; i &amp;lt; s.length() - 1; i += 2)
            {
                &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; hexByte = s.substring(i, i + 2);
                &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt;
                {
                    baos.write(&lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;.parseInt(hexByte, 16)); &lt;span class=&quot;code-comment&quot;&gt;// &lt;span class=&quot;code-object&quot;&gt;Byte&lt;/span&gt;.parseByte won&apos;t work
&lt;/span&gt;                }
                &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (NumberFormatException ex)
                {
                    LOG.error(&lt;span class=&quot;code-quote&quot;&gt;&quot;Can&apos;t parse &quot;&lt;/span&gt; + hexByte + &lt;span class=&quot;code-quote&quot;&gt;&quot;, aborting decode&quot;&lt;/span&gt;, ex);
                    &lt;span class=&quot;code-keyword&quot;&gt;break&lt;/span&gt;;
                }
            }
            &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; baos.toByteArray();
        }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;And for base64 use this (call new String(result) or ByteArrayInputStream(result) in your work); I need it a return a byte array for another part of PDFBox. In theory, this should work for you on jdk6.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    /**
     * Decode a base64 &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;.
     * 
     * @param base64Value a base64 encoded &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;.
     * 
     * @&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; the decoded &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; as a &lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt; array.
     * 
     * @&lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IllegalArgumentException &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; isn&apos;t a base64 encoded string.
     */
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt;[] decodeBase64(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; base64Value) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IllegalArgumentException
    {
        &lt;span class=&quot;code-comment&quot;&gt;// https://stackoverflow.com/questions/469695/decode-base64-data-in-java
&lt;/span&gt;        &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt;
        {
            &lt;span class=&quot;code-comment&quot;&gt;// jdk8 and higher? java.util.Base64.getDecoder().decode()
&lt;/span&gt;            &lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;&amp;lt;?&amp;gt; b64Class = &lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;.forName(&lt;span class=&quot;code-quote&quot;&gt;&quot;java.util.Base64&quot;&lt;/span&gt;);
            Method getDecoderMethod = b64Class.getMethod(&lt;span class=&quot;code-quote&quot;&gt;&quot;getDecoder&quot;&lt;/span&gt;);
            &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; base64Decoder = getDecoderMethod.invoke(b64Class);
            Method decodeMethod = base64Decoder.getClass().getMethod(&lt;span class=&quot;code-quote&quot;&gt;&quot;decode&quot;&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;.class);
            &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; (&lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt;[]) decodeMethod.invoke(base64Decoder, base64Value.replaceAll(&lt;span class=&quot;code-quote&quot;&gt;&quot;\\s&quot;&lt;/span&gt;, &quot;&quot;));
        }
        &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (ReflectiveOperationException ex)
        {
            LOG.debug(ex);
        }
        &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (SecurityException ex)
        {
            LOG.debug(ex);
        }
        &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt;
        {
            &lt;span class=&quot;code-comment&quot;&gt;// up to java7? javax.xml.bind.DatatypeConverter.parseBase64Binary()
&lt;/span&gt;            &lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;&amp;lt;?&amp;gt; datatypeConverterClass = &lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;.forName(&lt;span class=&quot;code-quote&quot;&gt;&quot;javax.xml.bind.DatatypeConverter&quot;&lt;/span&gt;);
            Method parseBase64BinaryMethod = datatypeConverterClass.getMethod(&lt;span class=&quot;code-quote&quot;&gt;&quot;parseBase64Binary&quot;&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;.class);
            &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; (&lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt;[]) parseBase64BinaryMethod.invoke(&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, base64Value);
        }
        &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (ReflectiveOperationException ex)
        {
            LOG.debug(ex);
        }
        &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (SecurityException ex)
        {
            LOG.debug(ex);
        }
        LOG.error(&lt;span class=&quot;code-quote&quot;&gt;&quot;Can&apos;t decode base64 value, &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; adding javax.xml.bind:jaxb-api to your build&quot;&lt;/span&gt;);
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt;[0];
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="16751299" author="jira-bot" created="Thu, 24 Jan 2019 16:43:47 +0000"  >&lt;p&gt;Commit 1852044 from Tilman Hausherr in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1852044&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1852044&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4437&quot; title=&quot;Import XFDF stamp annotation loses appearance&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4437&quot;&gt;&lt;del&gt;PDFBOX-4437&lt;/del&gt;&lt;/a&gt;: decode ASCII Hex and base64&lt;/p&gt;</comment>
                            <comment id="16751301" author="jira-bot" created="Thu, 24 Jan 2019 16:43:52 +0000"  >&lt;p&gt;Commit 1852045 from Tilman Hausherr in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1852045&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1852045&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4437&quot; title=&quot;Import XFDF stamp annotation loses appearance&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4437&quot;&gt;&lt;del&gt;PDFBOX-4437&lt;/del&gt;&lt;/a&gt;: decode ASCII Hex and base64&lt;/p&gt;</comment>
                            <comment id="16751305" author="jira-bot" created="Thu, 24 Jan 2019 16:55:08 +0000"  >&lt;p&gt;Commit 1852048 from Tilman Hausherr in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1852048&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1852048&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4437&quot; title=&quot;Import XFDF stamp annotation loses appearance&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4437&quot;&gt;&lt;del&gt;PDFBOX-4437&lt;/del&gt;&lt;/a&gt;: use base64 decoding method&lt;/p&gt;</comment>
                            <comment id="16751306" author="jira-bot" created="Thu, 24 Jan 2019 16:55:13 +0000"  >&lt;p&gt;Commit 1852049 from Tilman Hausherr in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1852049&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1852049&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4437&quot; title=&quot;Import XFDF stamp annotation loses appearance&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4437&quot;&gt;&lt;del&gt;PDFBOX-4437&lt;/del&gt;&lt;/a&gt;: use base64 decoding method&lt;/p&gt;</comment>
                            <comment id="16751325" author="jira-bot" created="Thu, 24 Jan 2019 17:09:15 +0000"  >&lt;p&gt;Commit 1852050 from Tilman Hausherr in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1852050&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1852050&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4437&quot; title=&quot;Import XFDF stamp annotation loses appearance&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4437&quot;&gt;&lt;del&gt;PDFBOX-4437&lt;/del&gt;&lt;/a&gt;: SonarQube fix&lt;/p&gt;</comment>
                            <comment id="16751326" author="jira-bot" created="Thu, 24 Jan 2019 17:09:20 +0000"  >&lt;p&gt;Commit 1852051 from Tilman Hausherr in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1852051&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1852051&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4437&quot; title=&quot;Import XFDF stamp annotation loses appearance&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4437&quot;&gt;&lt;del&gt;PDFBOX-4437&lt;/del&gt;&lt;/a&gt;: SonarQube fix&lt;/p&gt;</comment>
                            <comment id="16751365" author="jira-bot" created="Thu, 24 Jan 2019 17:44:51 +0000"  >&lt;p&gt;Commit 1852055 from Tilman Hausherr in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1852055&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1852055&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4437&quot; title=&quot;Import XFDF stamp annotation loses appearance&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4437&quot;&gt;&lt;del&gt;PDFBOX-4437&lt;/del&gt;&lt;/a&gt;: remove jaxb-api from preflight build (no longer needed directly, xmpbox will still include it optionally)&lt;/p&gt;</comment>
                            <comment id="16751366" author="jira-bot" created="Thu, 24 Jan 2019 17:44:56 +0000"  >&lt;p&gt;Commit 1852056 from Tilman Hausherr in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1852056&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1852056&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4437&quot; title=&quot;Import XFDF stamp annotation loses appearance&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4437&quot;&gt;&lt;del&gt;PDFBOX-4437&lt;/del&gt;&lt;/a&gt;: remove jaxb-api from preflight build (no longer needed directly, xmpbox will still include it optionally)&lt;/p&gt;</comment>
                            <comment id="16751376" author="andrew.hung" created="Thu, 24 Jan 2019 17:56:00 +0000"  >&lt;p&gt;Perfect, since the process is working for me as it I made not change my version.&#160; Though since you have done the additional work to merge into PDFBox when I upgrade I wont need to change anything and there will be no dependency on apache codec which is good.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Thanks again for your input and glad to assist in enhancing the FDFAnnotationStamp processing.&#160; &#160;If I see any more enhancements needs will report it.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="16751394" author="jira-bot" created="Thu, 24 Jan 2019 18:12:25 +0000"  >&lt;p&gt;Commit 1852059 from Tilman Hausherr in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1852059&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1852059&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4437&quot; title=&quot;Import XFDF stamp annotation loses appearance&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4437&quot;&gt;&lt;del&gt;PDFBOX-4437&lt;/del&gt;&lt;/a&gt;: revert last commit, due to check whether javax.xml.bind is available (and we still need it for xmpbox, so we need the early check too)&lt;/p&gt;</comment>
                            <comment id="16751395" author="jira-bot" created="Thu, 24 Jan 2019 18:12:29 +0000"  >&lt;p&gt;Commit 1852060 from Tilman Hausherr in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1852060&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1852060&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4437&quot; title=&quot;Import XFDF stamp annotation loses appearance&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4437&quot;&gt;&lt;del&gt;PDFBOX-4437&lt;/del&gt;&lt;/a&gt;: revert last commit, due to check whether javax.xml.bind is available (and we still need it for xmpbox, so we need the early check too)&lt;/p&gt;</comment>
                            <comment id="16751418" author="tilman" created="Thu, 24 Jan 2019 18:39:31 +0000"  >&lt;p&gt;Great! I&apos;ll most likely commit your change tomorrow &lt;font color=&quot;#333333&quot;&gt; evening&lt;/font&gt; or on the weekend with some minor style changes. I&apos;ll also add your name as author of the new class unless you prefer not to.&lt;/p&gt;</comment>
                            <comment id="16751449" author="andrew.hung" created="Thu, 24 Jan 2019 19:15:58 +0000"  >&lt;p&gt;Thanks, I also verified it is working on 2.0.9 when I rebuilt the library.&lt;/p&gt;

&lt;p&gt;That&apos;s perfect fine to put me as an author, you should be on it too &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&#160;I hope.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="16752580" author="jira-bot" created="Fri, 25 Jan 2019 19:01:44 +0000"  >&lt;p&gt;Commit 1852164 from Tilman Hausherr in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1852164&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1852164&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4437&quot; title=&quot;Import XFDF stamp annotation loses appearance&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4437&quot;&gt;&lt;del&gt;PDFBOX-4437&lt;/del&gt;&lt;/a&gt;: parse XML from xfdf for stamp annotation /AP, by Andrew Hung (refactoring in next commit(s))&lt;/p&gt;</comment>
                            <comment id="16752587" author="tilman" created="Fri, 25 Jan 2019 19:06:24 +0000"  >&lt;p&gt;I&apos;ll do next:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;clean exceptions (no &quot;throw Exception&quot;, rather catch specific exception and rethrow as IOException, or ignore)&lt;/li&gt;
	&lt;li&gt;less logging&lt;/li&gt;
	&lt;li&gt;not just /N (there could be a /D and /R appearance too)&lt;br/&gt;
When done I&apos;ll also commit to the 2.0 branch.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="16752597" author="jira-bot" created="Fri, 25 Jan 2019 19:19:11 +0000"  >&lt;p&gt;Commit 1852169 from Tilman Hausherr in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1852169&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1852169&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4437&quot; title=&quot;Import XFDF stamp annotation loses appearance&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4437&quot;&gt;&lt;del&gt;PDFBOX-4437&lt;/del&gt;&lt;/a&gt;: fine tune exception handling; remove super()&lt;/p&gt;</comment>
                            <comment id="16752605" author="jira-bot" created="Fri, 25 Jan 2019 19:37:19 +0000"  >&lt;p&gt;Commit 1852171 from Tilman Hausherr in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1852171&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1852171&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4437&quot; title=&quot;Import XFDF stamp annotation loses appearance&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4437&quot;&gt;&lt;del&gt;PDFBOX-4437&lt;/del&gt;&lt;/a&gt;: fine tune exception handling and logging; reformat&lt;/p&gt;</comment>
                            <comment id="16752626" author="jira-bot" created="Fri, 25 Jan 2019 20:05:26 +0000"  >&lt;p&gt;Commit 1852173 from Tilman Hausherr in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1852173&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1852173&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4437&quot; title=&quot;Import XFDF stamp annotation loses appearance&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4437&quot;&gt;&lt;del&gt;PDFBOX-4437&lt;/del&gt;&lt;/a&gt;: revert some logging deletions; allow other children than /N&lt;/p&gt;</comment>
                            <comment id="16752636" author="jira-bot" created="Fri, 25 Jan 2019 20:20:47 +0000"  >&lt;p&gt;Commit 1852175 from Tilman Hausherr in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1852175&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1852175&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4437&quot; title=&quot;Import XFDF stamp annotation loses appearance&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4437&quot;&gt;&lt;del&gt;PDFBOX-4437&lt;/del&gt;&lt;/a&gt;: SonarQube fix&lt;/p&gt;</comment>
                            <comment id="16752644" author="jira-bot" created="Fri, 25 Jan 2019 20:30:41 +0000"  >&lt;p&gt;Commit 1852176 from Tilman Hausherr in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1852176&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1852176&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4437&quot; title=&quot;Import XFDF stamp annotation loses appearance&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4437&quot;&gt;&lt;del&gt;PDFBOX-4437&lt;/del&gt;&lt;/a&gt;: parse XML from xfdf for stamp annotation /AP, by Andrew Hung&lt;/p&gt;</comment>
                            <comment id="16752647" author="jira-bot" created="Fri, 25 Jan 2019 20:37:27 +0000"  >&lt;p&gt;Commit 1852178 from Tilman Hausherr in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1852178&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1852178&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4437&quot; title=&quot;Import XFDF stamp annotation loses appearance&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4437&quot;&gt;&lt;del&gt;PDFBOX-4437&lt;/del&gt;&lt;/a&gt;: simplify code&lt;/p&gt;</comment>
                            <comment id="16752649" author="jira-bot" created="Fri, 25 Jan 2019 20:38:12 +0000"  >&lt;p&gt;Commit 1852179 from Tilman Hausherr in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1852179&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1852179&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4437&quot; title=&quot;Import XFDF stamp annotation loses appearance&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4437&quot;&gt;&lt;del&gt;PDFBOX-4437&lt;/del&gt;&lt;/a&gt;: simplify code + use jdk7 syntax&lt;/p&gt;</comment>
                            <comment id="16752660" author="tilman" created="Fri, 25 Jan 2019 20:57:14 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=andrew.hung&quot; class=&quot;user-hover&quot; rel=&quot;andrew.hung&quot;&gt;andrew.hung&lt;/a&gt; 2.0 snapshot build will be at &lt;a href=&quot;https://repository.apache.org/content/groups/snapshots/org/apache/pdfbox/pdfbox-app/2.0.14-SNAPSHOT/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://repository.apache.org/content/groups/snapshots/org/apache/pdfbox/pdfbox-app/2.0.14-SNAPSHOT/&lt;/a&gt; within an hour.&lt;/p&gt;</comment>
                            <comment id="16753132" author="andrew.hung" created="Sat, 26 Jan 2019 17:23:41 +0000"  >&lt;p&gt;Thanks Tilman.&#160; I took one from today&#160;&lt;a href=&quot;https://repository.apache.org/content/groups/snapshots/org/apache/pdfbox/pdfbox-app/2.0.14-SNAPSHOT/pdfbox-app-2.0.14-20190126.145126-204.jar&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;pdfbox-app-2.0.14-20190126.145126-204.jar&lt;/a&gt;&#160;and it works well.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Andrew H&lt;/p&gt;</comment>
                            <comment id="16753331" author="jira-bot" created="Sun, 27 Jan 2019 09:36:00 +0000"  >&lt;p&gt;Commit 1852274 from Tilman Hausherr in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1852274&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1852274&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4437&quot; title=&quot;Import XFDF stamp annotation loses appearance&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4437&quot;&gt;&lt;del&gt;PDFBOX-4437&lt;/del&gt;&lt;/a&gt;: refactor xml into main class&lt;/p&gt;</comment>
                            <comment id="16753332" author="jira-bot" created="Sun, 27 Jan 2019 09:36:07 +0000"  >&lt;p&gt;Commit 1852275 from Tilman Hausherr in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1852275&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1852275&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4437&quot; title=&quot;Import XFDF stamp annotation loses appearance&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4437&quot;&gt;&lt;del&gt;PDFBOX-4437&lt;/del&gt;&lt;/a&gt;: refactor xml into main class&lt;/p&gt;</comment>
                            <comment id="16753334" author="tilman" created="Sun, 27 Jan 2019 09:42:52 +0000"  >&lt;p&gt;I refactored the extra class into the main class because it&apos;s not used outside and to drop unused parts. Your name is also in the main class.&lt;/p&gt;

&lt;p&gt;I&apos;ll likely remove the debug logging code too in a few months, I think it alreaady works very nicely but lets wait anyway.&lt;/p&gt;

&lt;p&gt;Thank you for helping us with this work! Setting to resolved.&lt;/p&gt;</comment>
                            <comment id="16781530" author="tilman" created="Fri, 1 Mar 2019 10:00:48 +0000"  >&lt;p&gt;Follow-up work in&#160;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4437&quot; title=&quot;Import XFDF stamp annotation loses appearance&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4437&quot;&gt;&lt;del&gt;PDFBOX-4437&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13218853">PDFBOX-4478</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12955985" name="A1.01 - MYLES - 2ND-4TH  FLOOR PLAN.pdf" size="1050091" author="andrew.hung" created="Wed, 23 Jan 2019 14:32:17 +0000"/>
                            <attachment id="12956383" name="A1.01 - MYLES - 2ND-4TH  FLOOR PLAN_stamp_markup.pdf" size="1491560" author="tilman" created="Fri, 25 Jan 2019 18:31:28 +0000"/>
                            <attachment id="12955855" name="FDFAnnotationStamp.java" size="10482" author="andrew.hung" created="Tue, 22 Jan 2019 20:20:16 +0000"/>
                            <attachment id="12955986" name="FDFAnnotationStamp2.java" size="19551" author="andrew.hung" created="Wed, 23 Jan 2019 14:47:58 +0000"/>
                            <attachment id="12956143" name="FDFAnnotationStampAppearance_final.java" size="9668" author="andrew.hung" created="Thu, 24 Jan 2019 12:44:26 +0000"/>
                            <attachment id="12956075" name="FDFAnnotationStamp_final.java" size="4860" author="andrew.hung" created="Thu, 24 Jan 2019 02:17:13 +0000"/>
                            <attachment id="12955983" name="Stamp_appearance_decoded.txt" size="18812" author="andrew.hung" created="Wed, 23 Jan 2019 14:29:24 +0000"/>
                            <attachment id="12956013" name="ap.xml" size="275186" author="tilman" created="Wed, 23 Jan 2019 17:16:39 +0000"/>
                            <attachment id="12956073" name="example.zip" size="1386839" author="andrew.hung" created="Thu, 24 Jan 2019 02:09:07 +0000"/>
                            <attachment id="12955984" name="stamp_annotation.xfdf" size="386322" author="andrew.hung" created="Wed, 23 Jan 2019 14:32:12 +0000"/>
                            <attachment id="12955445" name="xfdf stamp annotation to PDF.zip" size="2198199" author="andrew.hung" created="Fri, 18 Jan 2019 18:00:28 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>11.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 37 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|yi02ug:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>