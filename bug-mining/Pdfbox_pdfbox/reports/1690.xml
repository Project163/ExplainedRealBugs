<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:05:37 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PDFBOX-3673] Filled form fields appear gray instead of black after flatten</title>
                <link>https://issues.apache.org/jira/browse/PDFBOX-3673</link>
                <project id="12310760" key="PDFBOX">PDFBox</project>
                    <description>&lt;p&gt;Hi,&lt;/p&gt;

&lt;p&gt;I&apos;m facing the following issue: When filling out an acrobat form and flattening it, the text color in the resulting pdf is gray instead of black.&lt;/p&gt;

&lt;p&gt;I attached the &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12850402/12850402_input.pdf&quot; title=&quot;input.pdf attached to PDFBOX-3673&quot;&gt;input.pdf&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt; and several output files for different pdfbox versions. Using pdfbox 2.0.2, I get the expected result with black text, as from version &amp;gt;=2.0.3 the text is gray.&lt;/p&gt;

&lt;p&gt;Code:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void main(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] args) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException {
    PDDocument doc = PDDocument.load(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; File(&lt;span class=&quot;code-quote&quot;&gt;&quot;input.pdf&quot;&lt;/span&gt;));
    PDAcroForm form = doc.getDocumentCatalog().getAcroForm();
    form.getField(&lt;span class=&quot;code-quote&quot;&gt;&quot;Text1&quot;&lt;/span&gt;).setValue(&lt;span class=&quot;code-quote&quot;&gt;&quot;value&quot;&lt;/span&gt;);
    form.getField(&lt;span class=&quot;code-quote&quot;&gt;&quot;Text2&quot;&lt;/span&gt;).setValue(&lt;span class=&quot;code-quote&quot;&gt;&quot;value&quot;&lt;/span&gt;);
    form.getField(&lt;span class=&quot;code-quote&quot;&gt;&quot;Text3&quot;&lt;/span&gt;).setValue(&lt;span class=&quot;code-quote&quot;&gt;&quot;value&quot;&lt;/span&gt;);
    form.flatten();
    doc.save(&lt;span class=&quot;code-quote&quot;&gt;&quot;output.pdf&quot;&lt;/span&gt;);
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The default appearance for every text field is set to something like &lt;tt&gt;/Helv 0 Tf 0 g&lt;/tt&gt;. Our current workaround is to replace &lt;tt&gt;0 g&lt;/tt&gt; with &lt;tt&gt;0 0 0 rg&lt;/tt&gt;. But in my understanding, they both should yield the same result.&lt;/p&gt;

&lt;p&gt;Thanks in advance.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13039442">PDFBOX-3673</key>
            <summary>Filled form fields appear gray instead of black after flatten</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="msahyoun">Maruan Sahyoun</assignee>
                                    <reporter username="tilmanginzel">Tilman Ginzel</reporter>
                        <labels>
                    </labels>
                <created>Wed, 1 Feb 2017 11:59:14 +0000</created>
                <updated>Sat, 25 Mar 2017 18:13:17 +0000</updated>
                            <resolved>Mon, 6 Mar 2017 16:51:48 +0000</resolved>
                                    <version>2.0.3</version>
                    <version>2.0.4</version>
                    <version>2.0.5</version>
                    <version>3.0.0 PDFBox</version>
                                    <fixVersion>2.0.5</fixVersion>
                    <fixVersion>3.0.0 PDFBox</fixVersion>
                                    <component>AcroForm</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="15848942" author="tilman" created="Wed, 1 Feb 2017 21:18:33 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=msahyoun&quot; class=&quot;user-hover&quot; rel=&quot;msahyoun&quot;&gt;msahyoun&lt;/a&gt; in 2.0.2 there&apos;s q...Q around the old content stream, in 2.0.3 it isn&apos;t. Because of that the &quot;0.898 g&quot; is still active.&lt;/p&gt;</comment>
                            <comment id="15848961" author="tilman" created="Wed, 1 Feb 2017 21:29:36 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=msahyoun&quot; class=&quot;user-hover&quot; rel=&quot;msahyoun&quot;&gt;msahyoun&lt;/a&gt; Change was done in [ &lt;a href=&quot;https://svn.apache.org/r1751213&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1751213&lt;/a&gt; ] in &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3396&quot; title=&quot;flattening AcroForm with visible sign field ETSI.CAdES.detached&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3396&quot;&gt;&lt;del&gt;PDFBOX-3396&lt;/del&gt;&lt;/a&gt;, &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;contentStream = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; PDPageContentStream(document, page, AppendMode.APPEND, &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;, &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;was changed to&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;contentStream = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; PDPageContentStream(document, page, AppendMode.APPEND, &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;so the q...Q is no longer done - why?&lt;/p&gt;</comment>
                            <comment id="15888739" author="msahyoun" created="Tue, 28 Feb 2017 19:38:56 +0000"  >&lt;blockquote&gt;
&lt;p&gt;so the q...Q is no longer done - why?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;it wasn&apos;t handled correctly as this worked only for single page documents. So what needs to be done is to not go through the fields but through the annotations per page. Will look into that over the coming weekend.&lt;/p&gt;</comment>
                            <comment id="15896833" author="jira-bot" created="Mon, 6 Mar 2017 07:34:13 +0000"  >&lt;p&gt;Commit 1785594 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=msahyoun&quot; class=&quot;user-hover&quot; rel=&quot;msahyoun&quot;&gt;msahyoun&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1785594&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1785594&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3673&quot; title=&quot;Filled form fields appear gray instead of black after flatten&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3673&quot;&gt;&lt;del&gt;PDFBOX-3673&lt;/del&gt;&lt;/a&gt;: ensure that existing content streams pages are wrapped in a store/restore pair per page&lt;/p&gt;</comment>
                            <comment id="15896840" author="jira-bot" created="Mon, 6 Mar 2017 07:38:11 +0000"  >&lt;p&gt;Commit 1785596 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=msahyoun&quot; class=&quot;user-hover&quot; rel=&quot;msahyoun&quot;&gt;msahyoun&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1785596&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1785596&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3673&quot; title=&quot;Filled form fields appear gray instead of black after flatten&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3673&quot;&gt;&lt;del&gt;PDFBOX-3673&lt;/del&gt;&lt;/a&gt;: remove orphaned method which is no longer needed&lt;/p&gt;</comment>
                            <comment id="15897375" author="jira-bot" created="Mon, 6 Mar 2017 14:14:24 +0000"  >&lt;p&gt;Commit 1785653 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=msahyoun&quot; class=&quot;user-hover&quot; rel=&quot;msahyoun&quot;&gt;msahyoun&lt;/a&gt; in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1785653&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1785653&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3673&quot; title=&quot;Filled form fields appear gray instead of black after flatten&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3673&quot;&gt;&lt;del&gt;PDFBOX-3673&lt;/del&gt;&lt;/a&gt;: ensure that existing content streams pages are wrapped in a store/restore pair per page&lt;/p&gt;</comment>
                            <comment id="15897378" author="msahyoun" created="Mon, 6 Mar 2017 14:16:34 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilmanginzel&quot; class=&quot;user-hover&quot; rel=&quot;tilmanginzel&quot;&gt;tilmanginzel&lt;/a&gt; could you verify the changes and let me know if the issue is fixed?&lt;/p&gt;</comment>
                            <comment id="15897563" author="tilmanginzel" created="Mon, 6 Mar 2017 16:14:03 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=msahyoun&quot; class=&quot;user-hover&quot; rel=&quot;msahyoun&quot;&gt;msahyoun&lt;/a&gt; I can verify that it works as expected now, tested with the latest snapshots &lt;tt&gt;pdfbox-app-2.0.5-20170130.213812-128.jar&lt;/tt&gt; and &lt;tt&gt;pdfbox-app-2.1.0-20170306.080841-741.jar&lt;/tt&gt;. Thank you for the fix! &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="15897637" author="msahyoun" created="Mon, 6 Mar 2017 16:51:48 +0000"  >&lt;p&gt;resolving as per users feedback.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilmanginzel&quot; class=&quot;user-hover&quot; rel=&quot;tilmanginzel&quot;&gt;tilmanginzel&lt;/a&gt; thank you for the report and the test for the fix.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12850402" name="input.pdf" size="412937" author="tilmanginzel" created="Wed, 1 Feb 2017 11:59:14 +0000"/>
                            <attachment id="12850403" name="output-2.0.2.pdf" size="414056" author="tilmanginzel" created="Wed, 1 Feb 2017 11:59:14 +0000"/>
                            <attachment id="12850404" name="output-2.0.3.pdf" size="413914" author="tilmanginzel" created="Wed, 1 Feb 2017 11:59:14 +0000"/>
                            <attachment id="12850405" name="output-2.0.4.pdf" size="413914" author="tilmanginzel" created="Wed, 1 Feb 2017 11:59:14 +0000"/>
                            <attachment id="12850406" name="output-2.0.5.pdf" size="413914" author="tilmanginzel" created="Wed, 1 Feb 2017 11:59:14 +0000"/>
                            <attachment id="12850407" name="output-2.1.0.pdf" size="413914" author="tilmanginzel" created="Wed, 1 Feb 2017 11:59:14 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>6.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 36 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i39gmf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>