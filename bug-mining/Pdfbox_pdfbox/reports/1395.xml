<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:02:52 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PDFBOX-3201] Skip zlib-header and checksum to avoid DataFormatException</title>
                <link>https://issues.apache.org/jira/browse/PDFBOX-3201</link>
                <project id="12310760" key="PDFBOX">PDFBox</project>
                    <description>&lt;p&gt;This is a follow up to &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2976&quot; title=&quot;java.util.zip.DataFormatException: incorrect data check&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2976&quot;&gt;&lt;del&gt;PDFBOX-2976&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="12932783">PDFBOX-3201</key>
            <summary>Skip zlib-header and checksum to avoid DataFormatException</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="lehmi">Andreas Lehmk&#252;hler</assignee>
                                    <reporter username="lehmi">Andreas Lehmk&#252;hler</reporter>
                        <labels>
                    </labels>
                <created>Wed, 20 Jan 2016 17:25:46 +0000</created>
                <updated>Thu, 17 Mar 2016 19:07:58 +0000</updated>
                            <resolved>Thu, 21 Jan 2016 10:41:22 +0000</resolved>
                                    <version>1.8.11</version>
                    <version>2.0.0</version>
                                    <fixVersion>1.8.12</fixVersion>
                    <fixVersion>2.0.0</fixVersion>
                                    <component>Parsing</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="15109001" author="lehmi" created="Wed, 20 Jan 2016 17:29:22 +0000"  >&lt;p&gt;I&apos;ve copied &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Sumit+Saha&quot; class=&quot;user-hover&quot; rel=&quot;Sumit Saha&quot;&gt;Sumit Saha&lt;/a&gt;s comment from &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2976&quot; title=&quot;java.util.zip.DataFormatException: incorrect data check&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2976&quot;&gt;&lt;del&gt;PDFBOX-2976&lt;/del&gt;&lt;/a&gt;:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Hi Everyone,&lt;br/&gt;
I have been following PDFBox releated discussion for long and i have a better fix in my mind in which there would be no data loss.&lt;/p&gt;

&lt;p&gt;The exception &quot;incorrect data check&quot; arises due to adler-32 checksum computation failure or corrupted stream.&lt;br/&gt;
Adler-32 Checksum can fail due to change in byteorder of last 4 bytes in the stream from Big Endian to Little Endian.&lt;br/&gt;
So what can be done is to bypass adler-32 check whcih would allow to extract all the data in the stream using inflaterinputstream.&lt;/p&gt;

&lt;p&gt;To do so from code point of view , before making InflaterInputStream object, do this&lt;/p&gt;

&lt;p&gt;Option 1:- Either change the byteorder for last 4 bytes in the raw stream i.e from Little Endian to Big Endian before feeding the stream to InflaterInputstream&lt;/p&gt;

&lt;p&gt;Option 2:- If Option 1 fails then do as mentioned below&lt;/p&gt;

&lt;p&gt;inStm.skip(2); // here inStm is the object corresponding to the raw stream&lt;br/&gt;
Inflater inf = new Inflater(true); // the argument true corresponds to the option NoWrap turning it true would disable checksum computation.&lt;/p&gt;

&lt;p&gt;Then create the object for InflaterInputStream ifis = new InflaterInputStream(inStm, inf);&lt;/p&gt;

&lt;p&gt;Moreover the skipping first two bytes is required and those two bytes corresponds to Zlib header which are not required when adler-32 check needs to be bypassed.&lt;/p&gt;

&lt;p&gt;Using this logic, even small data loss could be avoided.&lt;/p&gt;

&lt;p&gt;For more info:- I had raised a similar question on stackoverflow, please go through it&lt;br/&gt;
&lt;a href=&quot;http://stackoverflow.com/questions/33348192/attached-code-throws-java-util-zip-zipexception-incorrect-data-check-for-given&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://stackoverflow.com/questions/33348192/attached-code-throws-java-util-zip-zipexception-incorrect-data-check-for-given&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;</comment>
                            <comment id="15109027" author="jira-bot" created="Wed, 20 Jan 2016 17:49:21 +0000"  >&lt;p&gt;Commit 1725764 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lehmi&quot; class=&quot;user-hover&quot; rel=&quot;lehmi&quot;&gt;lehmi&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1725764&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1725764&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3201&quot; title=&quot;Skip zlib-header and checksum to avoid DataFormatException&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3201&quot;&gt;&lt;del&gt;PDFBOX-3201&lt;/del&gt;&lt;/a&gt;: use nowrap mode to bypass zlib-header and checksum to avoid a DataFormatException as proposed by Sumit Saha&lt;/p&gt;</comment>
                            <comment id="15109029" author="jira-bot" created="Wed, 20 Jan 2016 17:49:59 +0000"  >&lt;p&gt;Commit 1725765 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lehmi&quot; class=&quot;user-hover&quot; rel=&quot;lehmi&quot;&gt;lehmi&lt;/a&gt; in branch &apos;pdfbox/branches/1.8&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1725765&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1725765&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3201&quot; title=&quot;Skip zlib-header and checksum to avoid DataFormatException&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3201&quot;&gt;&lt;del&gt;PDFBOX-3201&lt;/del&gt;&lt;/a&gt;: use nowrap mode to bypass zlib-header and checksum to avoid a DataFormatException as proposed by Sumit Saha&lt;/p&gt;</comment>
                            <comment id="15109033" author="lehmi" created="Wed, 20 Jan 2016 17:54:50 +0000"  >&lt;p&gt;I&apos;ve followed the proposal: the first 2 bytes are skipped (zlib header) and the nowrap mode is used. The files from &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2976&quot; title=&quot;java.util.zip.DataFormatException: incorrect data check&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2976&quot;&gt;&lt;del&gt;PDFBOX-2976&lt;/del&gt;&lt;/a&gt; are working fine even if the buffer size is increased. Furthermore I&apos;ve a pdf I can&apos;t share (yet) which didn&apos;t work with the fix from &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2976&quot; title=&quot;java.util.zip.DataFormatException: incorrect data check&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2976&quot;&gt;&lt;del&gt;PDFBOX-2976&lt;/del&gt;&lt;/a&gt;, but with this one.&lt;br/&gt;
I&apos;ve increased the buffersize as well, although it doesn&apos;t have a significant impact on the performance&lt;/p&gt;</comment>
                            <comment id="15109147" author="tilman" created="Wed, 20 Jan 2016 18:55:03 +0000"  >&lt;p&gt;Now the file from &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2583&quot; title=&quot;Error when rendering a PDF with annotations&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2583&quot;&gt;&lt;del&gt;PDFBOX-2583&lt;/del&gt;&lt;/a&gt; fails with an EOFExeption.&lt;/p&gt;</comment>
                            <comment id="15109369" author="jira-bot" created="Wed, 20 Jan 2016 20:50:30 +0000"  >&lt;p&gt;Commit 1725810 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lehmi&quot; class=&quot;user-hover&quot; rel=&quot;lehmi&quot;&gt;lehmi&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1725810&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1725810&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3201&quot; title=&quot;Skip zlib-header and checksum to avoid DataFormatException&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3201&quot;&gt;&lt;del&gt;PDFBOX-3201&lt;/del&gt;&lt;/a&gt;: use read instead of skip to avoid EOFException&lt;/p&gt;</comment>
                            <comment id="15109370" author="jira-bot" created="Wed, 20 Jan 2016 20:50:39 +0000"  >&lt;p&gt;Commit 1725811 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lehmi&quot; class=&quot;user-hover&quot; rel=&quot;lehmi&quot;&gt;lehmi&lt;/a&gt; in branch &apos;pdfbox/branches/1.8&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1725811&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1725811&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3201&quot; title=&quot;Skip zlib-header and checksum to avoid DataFormatException&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3201&quot;&gt;&lt;del&gt;PDFBOX-3201&lt;/del&gt;&lt;/a&gt;: use read instead of skip to avoid EOFException&lt;/p&gt;</comment>
                            <comment id="15109372" author="lehmi" created="Wed, 20 Jan 2016 20:52:19 +0000"  >&lt;p&gt;The pdf from &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2583&quot; title=&quot;Error when rendering a PDF with annotations&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2583&quot;&gt;&lt;del&gt;PDFBOX-2583&lt;/del&gt;&lt;/a&gt; now works again&lt;/p&gt;</comment>
                            <comment id="15109566" author="tilman" created="Wed, 20 Jan 2016 22:00:44 +0000"  >&lt;p&gt;Thanks, the rest works too.&lt;/p&gt;</comment>
                            <comment id="15110407" author="lehmi" created="Thu, 21 Jan 2016 10:41:22 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt;: Thanks again for the fast feedback!&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Sumit+Saha&quot; class=&quot;user-hover&quot; rel=&quot;Sumit Saha&quot;&gt;Sumit Saha&lt;/a&gt;: Thanks for the prosposal!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 43 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2rqz3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>