<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:13:42 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PDFBOX-5627] Fonts are not subsetted when saving incrementally</title>
                <link>https://issues.apache.org/jira/browse/PDFBOX-5627</link>
                <project id="12310760" key="PDFBOX">PDFBox</project>
                    <description>&lt;p&gt;I&apos;ve noticed saving documents incrementally does not trigger fonts to be subsetted.&lt;/p&gt;

&lt;p&gt;The function &lt;tt&gt;PDDocument.save()&lt;/tt&gt; contains the following code:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-comment&quot;&gt;// subset designated fonts
&lt;/span&gt;&lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (PDFont font : fontsToSubset)
{
    font.subset();
}
fontsToSubset.clear();
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;


&lt;p&gt;However, this code to subset fonts does not seem te be included in the &lt;tt&gt;PDDocument.saveIncremental(...)&lt;/tt&gt; and &lt;tt&gt;PDDocument.saveIncrementalForExternalSigning(...)&lt;/tt&gt; functions. When loading a font and indicating it should be subset, the font will be used in the appearance stream as if subsetted, but it won&apos;t be in the end, resulting in a corrupt file.&lt;/p&gt;

&lt;h3&gt;&lt;a name=&quot;Solution&quot;&gt;&lt;/a&gt;Solution&lt;/h3&gt;
&lt;p&gt;I propose to also call subset when signing incrementally.&lt;/p&gt;

&lt;p&gt;I use this for files to which I add multiple signatures. In between signatures, text fields are filled in using PDFBox. Since the fields are not user-editable, fonts can be subsetted since the value cannot be changed afterwards.&lt;/p&gt;

&lt;h3&gt;&lt;a name=&quot;Reproduce&quot;&gt;&lt;/a&gt;Reproduce&lt;/h3&gt;
&lt;p&gt;I have attached 2 files to reproduce this issue. In both files you can change &lt;tt&gt;saveIncremental()&lt;/tt&gt; by &lt;tt&gt;save()&lt;/tt&gt; or manually call &lt;tt&gt;font.subset()&lt;/tt&gt; and the output will be valid.&lt;/p&gt;

&lt;p&gt;Note: both files are minimal reproducible files just designed to trigger this issue, that&apos;s why the implementations don&apos;t make sense (especially the first file).&lt;/p&gt;</description>
                <environment></environment>
        <key id="13541677">PDFBOX-5627</key>
            <summary>Fonts are not subsetted when saving incrementally</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tilman">Tilman Hausherr</assignee>
                                    <reporter username="dvdm">DvdM</reporter>
                        <labels>
                    </labels>
                <created>Wed, 28 Jun 2023 07:04:48 +0000</created>
                <updated>Fri, 18 Aug 2023 05:46:09 +0000</updated>
                            <resolved>Sun, 2 Jul 2023 15:48:30 +0000</resolved>
                                    <version>2.0.28</version>
                    <version>3.0.0 PDFBox</version>
                                    <fixVersion>2.0.30</fixVersion>
                    <fixVersion>3.0.0 PDFBox</fixVersion>
                                    <component>PDModel</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="17738360" author="tilman" created="Thu, 29 Jun 2023 04:27:39 +0000"  >&lt;p&gt;Good find. I&apos;m surprised that nobody else has found this all these years. I&apos;ll use the first example for a test but will change it slightly (detect whether font is embedded) because text extraction and rendering both work flawlessly (but not Adobe).&lt;/p&gt;</comment>
                            <comment id="17739382" author="jira-bot" created="Sun, 2 Jul 2023 15:01:20 +0000"  >&lt;p&gt;Commit 1910741 from Tilman Hausherr in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1910741&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1910741&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-5627&quot; title=&quot;Fonts are not subsetted when saving incrementally&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-5627&quot;&gt;&lt;del&gt;PDFBOX-5627&lt;/del&gt;&lt;/a&gt;: subset when doing incremental test + test, as suggested by DvdM&lt;/p&gt;</comment>
                            <comment id="17739383" author="jira-bot" created="Sun, 2 Jul 2023 15:01:25 +0000"  >&lt;p&gt;Commit 1910742 from Tilman Hausherr in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1910742&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1910742&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-5627&quot; title=&quot;Fonts are not subsetted when saving incrementally&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-5627&quot;&gt;&lt;del&gt;PDFBOX-5627&lt;/del&gt;&lt;/a&gt;: subset when doing incremental test + test, as suggested by DvdM&lt;/p&gt;</comment>
                            <comment id="17739384" author="jira-bot" created="Sun, 2 Jul 2023 15:06:27 +0000"  >&lt;p&gt;Commit 1910743 from Tilman Hausherr in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1910743&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1910743&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-5627&quot; title=&quot;Fonts are not subsetted when saving incrementally&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-5627&quot;&gt;&lt;del&gt;PDFBOX-5627&lt;/del&gt;&lt;/a&gt;: bugfix&lt;/p&gt;</comment>
                            <comment id="17739386" author="tilman" created="Sun, 2 Jul 2023 15:48:30 +0000"  >&lt;p&gt;Thanks for finding this!&lt;/p&gt;</comment>
                            <comment id="17739462" author="dvdm" created="Mon, 3 Jul 2023 06:52:19 +0000"  >&lt;p&gt;Wow that was quick! I&apos;m glad you could use some of my example code &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; Thanks for fixing it, I really appreciate it!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="13060913" name="IncrementalSubsetFontBug1.java" size="1803" author="dvdm" created="Wed, 28 Jun 2023 07:04:44 +0000"/>
                            <attachment id="13060912" name="IncrementalSubsetFontBug2.java" size="5114" author="dvdm" created="Wed, 28 Jun 2023 07:04:44 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 18 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1itug:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>