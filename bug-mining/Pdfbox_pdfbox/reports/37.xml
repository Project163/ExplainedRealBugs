<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 20:52:16 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PDFBOX-743] PDAppereanceDictionary#getNormalAppearance might throw NPE</title>
                <link>https://issues.apache.org/jira/browse/PDFBOX-743</link>
                <project id="12310760" key="PDFBOX">PDFBox</project>
                    <description>&lt;p&gt;following code patch will ensure that no NPE is thrown. the question is if the check for NULL is done at the correct place (functionally yes) respectively is it correct to apply the default configuration setting for that case?&lt;/p&gt;

&lt;p&gt;@@ -85,7 +85,7 @@&lt;br/&gt;
     public Map getNormalAppearance()&lt;br/&gt;
     {&lt;br/&gt;
         COSBase ap = dictionary.getDictionaryObject( COSName.getPDFName( &quot;N&quot; ) );&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;if( ap instanceof COSStream )&lt;br/&gt;
+        if( ap instanceof COSStream || ap == null)&lt;br/&gt;
         {&lt;br/&gt;
             COSStream aux = (COSStream) ap;&lt;br/&gt;
             ap = new COSDictionary();&lt;/li&gt;
&lt;/ul&gt;
</description>
                <environment></environment>
        <key id="12466344">PDFBOX-743</key>
            <summary>PDAppereanceDictionary#getNormalAppearance might throw NPE</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="pkoch">Philipp Koch</reporter>
                        <labels>
                    </labels>
                <created>Mon, 7 Jun 2010 12:50:55 +0000</created>
                <updated>Thu, 1 Jul 2010 07:27:39 +0000</updated>
                            <resolved>Mon, 21 Jun 2010 13:12:16 +0000</resolved>
                                    <version>1.1.0</version>
                                    <fixVersion>1.2.0</fixVersion>
                                    <component>PDModel</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12876227" author="pkoch" created="Mon, 7 Jun 2010 12:51:36 +0000"  >&lt;p&gt;would be great if this bug would be resolved before the 1.2.0 release...&lt;/p&gt;</comment>
                            <comment id="12876232" author="waldbaer" created="Mon, 7 Jun 2010 13:17:29 +0000"  >&lt;p&gt;According to PDF 32000-1:2008 (PDF 1.7), table 168, page 389, the N entry is required in an appearance dictionary. So an appearance dictionary without an N entry is erroneous. Should getNormalAppearance() return null in this case?&lt;/p&gt;</comment>
                            <comment id="12876234" author="pkoch" created="Mon, 7 Jun 2010 13:24:29 +0000"  >&lt;p&gt;&amp;gt; . Should getNormalAppearance() return null in this case? &lt;br/&gt;
i would say yes, BUT one has to make sure that all callers can handle the NULL value (see PageDrawer line 127)&lt;/p&gt;</comment>
                            <comment id="12876237" author="pkoch" created="Mon, 7 Jun 2010 13:30:07 +0000"  >&lt;p&gt;i changes the lines in question and ran my test. it still worked.&lt;/p&gt;

&lt;p&gt;my changes:&lt;br/&gt;
&amp;#8212; pdfbox/src/main/java/org/apache/pdfbox/pdfviewer/PageDrawer.java	(revision 952200)&lt;br/&gt;
+++ pdfbox/src/main/java/org/apache/pdfbox/pdfviewer/PageDrawer.java	(working copy)&lt;br/&gt;
@@ -124,13 +124,15 @@&lt;br/&gt;
                     appearanceName = &quot;default&quot;;&lt;br/&gt;
                 }&lt;br/&gt;
                 Map appearanceMap = appearDictionary.getNormalAppearance();&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;PDAppearanceStream appearance =&lt;/li&gt;
	&lt;li&gt;(PDAppearanceStream)appearanceMap.get( appearanceName );&lt;/li&gt;
	&lt;li&gt;if( appearance != null )&lt;/li&gt;
	&lt;li&gt;{&lt;/li&gt;
	&lt;li&gt;g.translate( (int)rect.getLowerLeftX(), (int)-rect.getLowerLeftY()  );&lt;/li&gt;
	&lt;li&gt;processSubStream( page, appearance.getResources(), appearance.getStream() );&lt;/li&gt;
	&lt;li&gt;g.translate( (int)-rect.getLowerLeftX(), (int)+rect.getLowerLeftY()  );&lt;br/&gt;
+                if (appearanceMap != null)
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {+                    PDAppearanceStream appearance =+                        (PDAppearanceStream)appearanceMap.get( appearanceName );+                    if( appearance != null )+                    {
+                        g.translate( (int)rect.getLowerLeftX(), (int)-rect.getLowerLeftY()  );
+                        processSubStream( page, appearance.getResources(), appearance.getStream() );
+                        g.translate( (int)-rect.getLowerLeftX(), (int)+rect.getLowerLeftY()  );
+                    }                 }&lt;/span&gt; &lt;/div&gt;
&lt;p&gt;             }&lt;br/&gt;
         }&lt;br/&gt;
Index: pdfbox/src/main/java/org/apache/pdfbox/pdmodel/interactive/annotation/PDAppearanceDictionary.java&lt;br/&gt;
===================================================================&lt;/p&gt;
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;pdfbox/src/main/java/org/apache/pdfbox/pdmodel/interactive/annotation/PDAppearanceDictionary.java	(revision 952200)&lt;br/&gt;
+++ pdfbox/src/main/java/org/apache/pdfbox/pdmodel/interactive/annotation/PDAppearanceDictionary.java	(working copy)&lt;br/&gt;
@@ -85,7 +85,10 @@&lt;br/&gt;
     public Map getNormalAppearance()&lt;br/&gt;
     {&lt;br/&gt;
         COSBase ap = dictionary.getDictionaryObject( COSName.getPDFName( &quot;N&quot; ) );&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;if( ap instanceof COSStream )&lt;br/&gt;
+        if (ap == null) 
{
+            return null;
+        }
&lt;p&gt;+        if( ap instanceof COSStream)&lt;br/&gt;
         {&lt;br/&gt;
             COSStream aux = (COSStream) ap;&lt;br/&gt;
             ap = new COSDictionary();&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12879528" author="lehmi" created="Wed, 16 Jun 2010 21:53:55 +0000"  >&lt;p&gt;As we have a lazy consensus about making PDFBox more lenient if it comes to read malformed pdfs, I suggest to include phillips proposed changes.&lt;/p&gt;</comment>
                            <comment id="12880814" author="jukkaz" created="Mon, 21 Jun 2010 13:12:16 +0000"  >&lt;p&gt;Agreed about being more lenient in what we accept. I committed Philipp&apos;s changes in revision 956566. Resolving as fixed.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>163467</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 years, 22 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0zlgf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>205778</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>