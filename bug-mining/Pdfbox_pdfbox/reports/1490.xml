<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:03:35 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PDFBOX-3408] Correct validation of Widget Annotations for PDF/A-1</title>
                <link>https://issues.apache.org/jira/browse/PDFBOX-3408</link>
                <project id="12310760" key="PDFBOX">PDFBox</project>
                    <description>&lt;p&gt;The TECHNICAL CORRIGENDUM 2 for ISO 19005-1:2005 (PDF/A-1) added a clause for Widget Annotations:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;For all annotation dictionaries containing an AP key, the appearance dictionary that it defines as its value shall contain only the N key. If an annotation dictionary&#8217;s Subtype key has a value of Widget and its FT key has a value of Btn, the value of the N key shall be an appearance subdictionary; otherwise the value of the N key shall be an appearance stream.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;We currently (only) validate with the original clause of ISO 19005-1:2005 (PDF/A-1) which has&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;If an annotation dictionary contains the AP key, the appearance dictionary that it defines as its value shall contain only the N key, whose value shall be a stream defining the appearance of the annotation.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Previous versions of PDFBox report an error for such a widget &lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;5.3.1 : Invalid field value in an annotation definition, The N Appearance must be a Stream
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12986216">PDFBOX-3408</key>
            <summary>Correct validation of Widget Annotations for PDF/A-1</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tilman">Tilman Hausherr</assignee>
                                    <reporter username="msahyoun">Maruan Sahyoun</reporter>
                        <labels>
                    </labels>
                <created>Fri, 1 Jul 2016 15:28:09 +0000</created>
                <updated>Wed, 13 Nov 2024 15:03:27 +0000</updated>
                            <resolved>Mon, 4 Jul 2016 21:22:13 +0000</resolved>
                                    <version>1.8.12</version>
                    <version>2.0.2</version>
                    <version>2.0.3</version>
                    <version>3.0.0 PDFBox</version>
                                    <fixVersion>2.0.3</fixVersion>
                    <fixVersion>3.0.0 PDFBox</fixVersion>
                                    <component>Preflight</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="15360508" author="jira-bot" created="Sun, 3 Jul 2016 12:17:07 +0000"  >&lt;p&gt;Commit 1751150 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1751150&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1751150&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3408&quot; title=&quot;Correct validation of Widget Annotations for PDF/A-1&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3408&quot;&gt;&lt;del&gt;PDFBOX-3408&lt;/del&gt;&lt;/a&gt;: Correct validation of Btn widget annotations for PDF/A-1&lt;/p&gt;</comment>
                            <comment id="15360509" author="jira-bot" created="Sun, 3 Jul 2016 12:17:32 +0000"  >&lt;p&gt;Commit 1751151 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1751151&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1751151&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3408&quot; title=&quot;Correct validation of Widget Annotations for PDF/A-1&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3408&quot;&gt;&lt;del&gt;PDFBOX-3408&lt;/del&gt;&lt;/a&gt;: Correct validation of Btn widget annotations for PDF/A-1&lt;/p&gt;</comment>
                            <comment id="15360511" author="jira-bot" created="Sun, 3 Jul 2016 12:23:20 +0000"  >&lt;p&gt;Commit 1751152 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1751152&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1751152&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3408&quot; title=&quot;Correct validation of Widget Annotations for PDF/A-1&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3408&quot;&gt;&lt;del&gt;PDFBOX-3408&lt;/del&gt;&lt;/a&gt;: Correct validation of Btn widget annotations for PDF/A-1&lt;/p&gt;</comment>
                            <comment id="15360513" author="tilman" created="Sun, 3 Jul 2016 12:24:28 +0000"  >&lt;p&gt;Re modification in txt file, this is what I get from PDF-Tools:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;isartor-6-3-4-t01-fail-f.pdf does not conform to PDF/A.&lt;/p&gt;

&lt;p&gt;Validating file &quot;isartor-6-3-4-t01-fail-f.pdf&quot; for conformance level pdfa-1b&lt;br/&gt;
The appearance must have state dictionaries (subdictionaries to &apos;N&apos;).&lt;br/&gt;
The font ZapfDingbats must be embedded.&lt;br/&gt;
The document does not conform to the requested standard.&lt;br/&gt;
The document contains fonts without embedded font programs or encoding information (CMAPs).&lt;br/&gt;
The document contains annotations or form fields with ambigous or without appropriate appearances.&lt;br/&gt;
Done.&lt;/p&gt;&lt;/blockquote&gt;</comment>
                            <comment id="15360515" author="jira-bot" created="Sun, 3 Jul 2016 12:27:52 +0000"  >&lt;p&gt;Commit 1751153 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1751153&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1751153&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3408&quot; title=&quot;Correct validation of Widget Annotations for PDF/A-1&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3408&quot;&gt;&lt;del&gt;PDFBOX-3408&lt;/del&gt;&lt;/a&gt;: Correct validation of Btn widget annotations for PDF/A-1&lt;/p&gt;</comment>
                            <comment id="15360540" author="tilman" created="Sun, 3 Jul 2016 13:08:27 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=msahyoun&quot; class=&quot;user-hover&quot; rel=&quot;msahyoun&quot;&gt;msahyoun&lt;/a&gt; do you have a file that incorrectly failed the test in the past?&lt;/p&gt;</comment>
                            <comment id="15360914" author="msahyoun" created="Mon, 4 Jul 2016 06:41:58 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; unfortunately not - this is part of a current discussion about validating annotation appearances. &lt;/p&gt;</comment>
                            <comment id="15361498" author="tilman" created="Mon, 4 Jul 2016 15:49:27 +0000"  >&lt;p&gt;I created a test myself by modifying an existing file (the ghostscript annots.pdf file, page 6 has several &quot;Btn&quot; fields) and it shows a bug in my code - I have to go up the hierarchy when needed. The file is not a perfect PDF/A-1b, but almost (fonts are not embedded).&lt;/p&gt;</comment>
                            <comment id="15361513" author="msahyoun" created="Mon, 4 Jul 2016 16:00:28 +0000"  >&lt;p&gt;Looking at your code and the sample where do you think you need to go up the hierarchy?&lt;/p&gt;</comment>
                            <comment id="15361522" author="jira-bot" created="Mon, 4 Jul 2016 16:04:10 +0000"  >&lt;p&gt;Commit 1751327 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1751327&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1751327&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3408&quot; title=&quot;Correct validation of Widget Annotations for PDF/A-1&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3408&quot;&gt;&lt;del&gt;PDFBOX-3408&lt;/del&gt;&lt;/a&gt;: Go up the hierarchy to get the type&lt;/p&gt;</comment>
                            <comment id="15361523" author="jira-bot" created="Mon, 4 Jul 2016 16:04:22 +0000"  >&lt;p&gt;Commit 1751328 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1751328&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1751328&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3408&quot; title=&quot;Correct validation of Widget Annotations for PDF/A-1&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3408&quot;&gt;&lt;del&gt;PDFBOX-3408&lt;/del&gt;&lt;/a&gt;: Go up the hierarchy to get the type&lt;/p&gt;</comment>
                            <comment id="15361524" author="tilman" created="Mon, 4 Jul 2016 16:06:08 +0000"  >&lt;p&gt;The latest change should answer this... in the test file, I noticed that the type sometimes (radio buttons) wasn&apos;t in the leaf, it was higher up. And PDF-Tools accepts this file (except for the font problem).&lt;/p&gt;</comment>
                            <comment id="15361538" author="msahyoun" created="Mon, 4 Jul 2016 16:20:56 +0000"  >&lt;p&gt;I&apos;m not sure that looking up the hierarchy is permitted as annotations don&apos;t have inheritance which form fields do have. Let me try to verify that.&lt;/p&gt;
</comment>
                            <comment id="15361544" author="tilman" created="Mon, 4 Jul 2016 16:24:32 +0000"  >&lt;p&gt;But real annotations wouldn&apos;t have the subtype &quot;Widget&quot;.&lt;/p&gt;</comment>
                            <comment id="15361552" author="msahyoun" created="Mon, 4 Jul 2016 16:31:00 +0000"  >&lt;p&gt;Yes, I know - let&apos;s keep it in the state you implemented it as there seems to be support for doing it this way - or even validating Widget annotations coming from the AcroForms side. There is a current discussion towards that direction although Leonard has pointed out that the spec talks about annotations, which would technically mean that we shouldn&apos;t go up. OTOH the implemented behavior reflects the need a fillable PDF/A form would have. &lt;/p&gt;</comment>
                            <comment id="15371378" author="msahyoun" created="Mon, 11 Jul 2016 18:38:47 +0000"  >&lt;p&gt;I&apos;ve verified with a sample file I can unfortunately not share that the error &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;5.3.1 : Invalid field value in an annotation definition, The N Appearance must be a Stream
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;has gone.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310050">
                    <name>Regression</name>
                                            <outwardlinks description="breaks">
                                        <issuelink>
            <issuekey id="13598623">PDFBOX-5900</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12816065" name="PDFBOX-3408.pdf" size="333947" author="tilman" created="Mon, 4 Jul 2016 15:49:27 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 18 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i30fon:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>