<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:02:25 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PDFBOX-3149] Failure to decrypt empty strings (AES 128)</title>
                <link>https://issues.apache.org/jira/browse/PDFBOX-3149</link>
                <project id="12310760" key="PDFBOX">PDFBox</project>
                    <description>&lt;p&gt;SecurityHandler fails to decrypt empty strings in a AES 128 encrypted PDF. &lt;/p&gt;

&lt;p&gt;Strings like: &amp;lt;&amp;lt;/Name ()&amp;gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;This is because it tries to read the first 16 bytes as the AES IV, failing which it throws IOException. Solution: if you cannot read any bytes from the stream, it is empty and so there is nothing to decrypt.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12917556">PDFBOX-3149</key>
            <summary>Failure to decrypt empty strings (AES 128)</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tilman">Tilman Hausherr</assignee>
                                    <reporter username="jesselong">Jesse Long</reporter>
                        <labels>
                    </labels>
                <created>Wed, 2 Dec 2015 12:24:53 +0000</created>
                <updated>Thu, 17 Mar 2016 19:07:12 +0000</updated>
                            <resolved>Thu, 3 Dec 2015 19:55:44 +0000</resolved>
                                    <version>2.0.0</version>
                                    <fixVersion>2.0.0</fixVersion>
                                    <component>Crypto</component>
                    <component>Parsing</component>
                    <component>PDModel</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="15035720" author="jesselong" created="Wed, 2 Dec 2015 12:27:28 +0000"  >&lt;p&gt;Patch to support decrypting empty streams.&lt;/p&gt;</comment>
                            <comment id="15036445" author="tilman" created="Wed, 2 Dec 2015 19:37:36 +0000"  >&lt;p&gt;Could you attach a file that fails? I tried to reproduce the problem in TestSymmetricKeyEncryption.java, because I wanted a test that fails without the patch, but the test never fails &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;The reason is that we don&apos;t support AES128 encryption, only decryption.&lt;/p&gt;</comment>
                            <comment id="15037429" author="jesselong" created="Thu, 3 Dec 2015 07:30:30 +0000"  >&lt;p&gt;Tilman, sorry, but the one example I have is NDA protected, but please check my example above:&lt;/p&gt;

&lt;p&gt;&amp;lt;&amp;lt;/Name ()&amp;gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;(Be warned, I might use the wrong names for things here, long time since I read the PDF spec)&lt;/p&gt;

&lt;p&gt;This is a dictionary. It has one key/value pair. The key is /Name, the value is what is between the (). In my example PDF, there are actually many key/value pairs, like:&lt;/p&gt;

&lt;p&gt;&amp;lt;&amp;lt;/Producer (encrypted bytes)/CreationDate (encrypted bytes)/ModDate (encrypted bytes)/Keywords ()&amp;gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;Now, when there is content, the first 16 bytes of the encrypted bytes is the IV for the AES cipher. PDFBox fails to decrypt the value if it cannot fully read the first 16 bytes as the IV. As you can see with the /Keywords entry above, there is an empty encrypted value. We fail to decrypt this because we cannot read the first 16 bytes of the empty value as IV.&lt;/p&gt;

&lt;p&gt;What I am doing with this patch is saying, if the encrypted data is completely empty, then the decrypted data is also empty, it doesn&apos;t matter if we cannot read the IV, because there is no data after the IV which we need to decrypt.&lt;/p&gt;

&lt;p&gt;If this explanation does not suffice, I will try create an example file for you.&lt;/p&gt;

&lt;p&gt;Also, do you know why encrypt with AES 128 is not supported? I would like to add a patch for that...&lt;/p&gt;</comment>
                            <comment id="15037440" author="tilman" created="Thu, 3 Dec 2015 07:37:31 +0000"  >&lt;p&gt;Your patch makes sense, and it works fine with all my files (including some I9 forms that are AES128 encrypted). Sadly I can&apos;t just modify a PDF file, because each of these has compressed streams, i.e. the streams are encoded as well, so I can&apos;t access the /Info part.&lt;/p&gt;

&lt;p&gt;I don&apos;t know why AES128 encryption isn&apos;t supported. We support AES256, and 128bit key with RC4. It isn&apos;t really a flaw that the 128bit encryption is a poor one, people can and should use AES256 instead.&lt;/p&gt;</comment>
                            <comment id="15038469" author="jira-bot" created="Thu, 3 Dec 2015 19:49:20 +0000"  >&lt;p&gt;Commit 1717842 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1717842&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1717842&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3149&quot; title=&quot;Failure to decrypt empty strings (AES 128)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3149&quot;&gt;&lt;del&gt;PDFBOX-3149&lt;/del&gt;&lt;/a&gt;: skip empty imput when decrypting, as suggested by Jesse Long&lt;/p&gt;</comment>
                            <comment id="15038478" author="tilman" created="Thu, 3 Dec 2015 19:53:49 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jesselong&quot; class=&quot;user-hover&quot; rel=&quot;jesselong&quot;&gt;jesselong&lt;/a&gt; I committed your patch with one small modification that I thought about at the last minute - you skip the empty imput when encrypting, but we shouldn&apos;t do that, to avoid errors with other PDF readers that have the same problem as the one you fixed.&lt;/p&gt;</comment>
                            <comment id="15038485" author="tilman" created="Thu, 3 Dec 2015 19:55:44 +0000"  >&lt;p&gt;Thanks for the patch; I&apos;m setting this to resolved, you can still attach a file if you get one.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12775270" name="PDFBOX-3149.patch" size="1354" author="jesselong" created="Wed, 2 Dec 2015 12:27:28 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 50 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2p62v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>