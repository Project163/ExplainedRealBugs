<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:06:20 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PDFBOX-3826] NPE if RAFDataStream.getCurrentPosition() when TrueTypeFont created from file is reused</title>
                <link>https://issues.apache.org/jira/browse/PDFBOX-3826</link>
                <project id="12310760" key="PDFBOX">PDFBox</project>
                    <description>&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;java.lang.NullPointerException: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
	at org.apache.fontbox.ttf.RAFDataStream.getCurrentPosition(RAFDataStream.java:88)
	at org.apache.fontbox.ttf.TrueTypeFont.getTableBytes(TrueTypeFont.java:121)
	at org.apache.fontbox.ttf.TTFSubsetter.writeToStream(TTFSubsetter.java:1012)
	at org.apache.pdfbox.pdmodel.font.TrueTypeEmbedder.subset(TrueTypeEmbedder.java:329)
	at org.apache.pdfbox.pdmodel.font.PDType0Font.subset(PDType0Font.java:162)
	at org.apache.pdfbox.pdmodel.PDDocument.save(PDDocument.java:1275)
	at org.apache.pdfbox.pdmodel.font.PDFontTest.testMultipleFontFileReuse(PDFontTest.java:160)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    @Test
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void testMultipleFontFileReuse() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException, URISyntaxException
    {
        URL url = PDFontTest.&lt;span class=&quot;code-keyword&quot;&gt;class.&lt;/span&gt;getClassLoader().getResource(
                &lt;span class=&quot;code-quote&quot;&gt;&quot;org/apache/pdfbox/ttf/LiberationSans-Regular.ttf&quot;&lt;/span&gt;);
        File file = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; File(url.toURI());

        TrueTypeFont ttf = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; TTFParser().parse(file);

        &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; i = 0; i &amp;lt; 32; ++i)
        {
            &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; (PDDocument doc = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; PDDocument())
            {
                PDPage page = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; PDPage();
                doc.addPage(page);
                PDFont font = PDType0Font.load(doc, ttf, &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;);
                &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; (PDPageContentStream cs = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; PDPageContentStream(doc, page))
                {
                    cs.beginText();
                    cs.setFont(font, 10);
                    cs.showText(&lt;span class=&quot;code-quote&quot;&gt;&quot;testMultipleFontFileReuse&quot;&lt;/span&gt;);
                    cs.endText();
                }
                doc.save(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ByteArrayOutputStream());
            }
        }
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;This happens only if the TrueTypeFont is created from a file, not when it is created from a stream (&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3337&quot; title=&quot;Regression: NullPointerException in subsetting&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3337&quot;&gt;&lt;del&gt;PDFBOX-3337&lt;/del&gt;&lt;/a&gt;). It worked in 2.0.0 but no longer since 2.0.1.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13078947">PDFBOX-3826</key>
            <summary>NPE if RAFDataStream.getCurrentPosition() when TrueTypeFont created from file is reused</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="lehmi">Andreas Lehmk&#252;hler</assignee>
                                    <reporter username="tilman">Tilman Hausherr</reporter>
                        <labels>
                            <label>regression</label>
                    </labels>
                <created>Sun, 11 Jun 2017 13:38:22 +0000</created>
                <updated>Fri, 21 Jul 2017 04:40:15 +0000</updated>
                            <resolved>Mon, 17 Jul 2017 10:02:01 +0000</resolved>
                                    <version>2.0.6</version>
                                    <fixVersion>2.0.7</fixVersion>
                    <fixVersion>3.0.0 PDFBox</fixVersion>
                                    <component>FontBox</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="16045975" author="tilman" created="Sun, 11 Jun 2017 13:41:40 +0000"  >&lt;p&gt;The problem is related to &lt;tt&gt;TrueTypeEmbedder.buildFontFile2()&lt;/tt&gt;. That one closes the ttf member because it is replaced by the subset. When that one is created from a stream, a &lt;tt&gt;MemoryTTFDataStream&lt;/tt&gt; is closed which does nothing; when it is created from a file, a &lt;tt&gt;RAFDataStream&lt;/tt&gt; is closed.&lt;/p&gt;</comment>
                            <comment id="16052076" author="tilman" created="Fri, 16 Jun 2017 16:07:07 +0000"  >&lt;p&gt;Proposed change: modify RAFDataStream so that the file is reopened when accessed again.&lt;/p&gt;

&lt;p&gt;An alternative, not closing ttf in &lt;tt&gt;TrueTypeEmbedder.buildFontFile2()&lt;/tt&gt; would mean that existing applications will have memory leaks.&lt;/p&gt;

&lt;p&gt;A second alternative, deprecate using files and use streams only, would increase the memory footprint because large fonts would have to be loaded in memory.&lt;/p&gt;</comment>
                            <comment id="16053258" author="lehmi" created="Sun, 18 Jun 2017 17:07:45 +0000"  >&lt;p&gt;I&apos;m thinking about a third solution. Don&apos;t close the ttf if it was passed to the load method as the user might want to reuse it. And, yes the user has to take care of the ttf himself.&lt;/p&gt;</comment>
                            <comment id="16053259" author="tilman" created="Sun, 18 Jun 2017 17:17:46 +0000"  >&lt;p&gt;That is the &quot;not closing ttf&quot; solution - the problem is that it would create leaks in existing software, where somebody has opened a file TrueTypeFont and used it only once.&lt;/p&gt;</comment>
                            <comment id="16061322" author="lehmi" created="Fri, 23 Jun 2017 18:04:20 +0000"  >&lt;p&gt;IMHO,&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;modifying RAFDataStream is a dirty hack&lt;/li&gt;
	&lt;li&gt;deprecating the usage of files wouldn&apos;t solve any problems until we&apos;d remove the method in 3.0.0&lt;/li&gt;
	&lt;li&gt;not to close the ttf in any case will lead to memory leaks&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;We should support a solution where everybody has to care about their resources&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;PDFBox should close those ttfs which are created by PDFBox&lt;/li&gt;
	&lt;li&gt;ttfs provide by the user should be closed by the user&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;This would give the user a chance to cache the ttfs when creating multipage/multiple pdfs using the same fonts.&lt;/p&gt;

&lt;p&gt;BTW: PDFBox closes provided ttfs only if they are subsetted, so that we already have a memory leak if people rely on PDFBox to close their resources&lt;/p&gt;</comment>
                            <comment id="16087472" author="tilman" created="Fri, 14 Jul 2017 15:24:52 +0000"  >&lt;p&gt;I looked at the issue again. We don&apos;t know in buildFontFile2 how the font was created.&lt;/p&gt;

&lt;p&gt;What we could do is to pass some boolean (e.g. &quot;closeOriginal&quot; or &quot;closeOnSubset&quot;) to TrueTypeEmbedder telling whether the font is to be closed or not. &lt;/p&gt;

&lt;p&gt;It isn&apos;t needed for the first TrueTypeEmbedder constructor (which calls buildFontFile2) because ttf is null. So it&apos;s only the second constructor.&lt;/p&gt;

&lt;p&gt;The good thing is that it&apos;s not public so we can do whatever we want.&lt;/p&gt;</comment>
                            <comment id="16088541" author="lehmi" created="Sat, 15 Jul 2017 10:10:24 +0000"  >&lt;p&gt;How about moving the close call to PDType0Font instead of passing the information about the ttf to the embedder?&lt;/p&gt;</comment>
                            <comment id="16088544" author="tilman" created="Sat, 15 Jul 2017 10:20:53 +0000"  >&lt;p&gt;Yes, of course, that is much better and cleaner. It would be after the &lt;tt&gt;embedder.subset();&lt;/tt&gt; call.&lt;/p&gt;</comment>
                            <comment id="16088573" author="jira-bot" created="Sat, 15 Jul 2017 12:46:26 +0000"  >&lt;p&gt;Commit 1802021 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lehmi&quot; class=&quot;user-hover&quot; rel=&quot;lehmi&quot;&gt;lehmi&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1802021&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1802021&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3826&quot; title=&quot;NPE if RAFDataStream.getCurrentPosition() when TrueTypeFont created from file is reused&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3826&quot;&gt;&lt;del&gt;PDFBOX-3826&lt;/del&gt;&lt;/a&gt;: don&apos;t close the given ttf but the self generated one, move the relevant code to PDType0Font&lt;/p&gt;</comment>
                            <comment id="16088577" author="lehmi" created="Sat, 15 Jul 2017 12:56:17 +0000"  >&lt;p&gt;I&apos;ve started as discussed and will do some more minor refactoring&lt;/p&gt;</comment>
                            <comment id="16088578" author="tilman" created="Sat, 15 Jul 2017 12:57:20 +0000"  >&lt;p&gt;The test I mentioned in the beginning fails. The new param is true here:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; PDType0Font load(PDDocument doc, TrueTypeFont ttf, &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; embedSubset)
            &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException
    {
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; PDType0Font(doc, ttf, embedSubset, &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;);
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;shouldn&apos;t this be false?&lt;/p&gt;</comment>
                            <comment id="16088591" author="jira-bot" created="Sat, 15 Jul 2017 13:25:30 +0000"  >&lt;p&gt;Commit 1802023 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lehmi&quot; class=&quot;user-hover&quot; rel=&quot;lehmi&quot;&gt;lehmi&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1802023&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1802023&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3826&quot; title=&quot;NPE if RAFDataStream.getCurrentPosition() when TrueTypeFont created from file is reused&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3826&quot;&gt;&lt;del&gt;PDFBOX-3826&lt;/del&gt;&lt;/a&gt;: fixed copy&amp;amp;paste issue&lt;/p&gt;</comment>
                            <comment id="16088592" author="lehmi" created="Sat, 15 Jul 2017 13:26:20 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt;, it was a simple c&amp;amp;p issue &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="16088619" author="jira-bot" created="Sat, 15 Jul 2017 14:33:49 +0000"  >&lt;p&gt;Commit 1802024 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lehmi&quot; class=&quot;user-hover&quot; rel=&quot;lehmi&quot;&gt;lehmi&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1802024&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1802024&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3826&quot; title=&quot;NPE if RAFDataStream.getCurrentPosition() when TrueTypeFont created from file is reused&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3826&quot;&gt;&lt;del&gt;PDFBOX-3826&lt;/del&gt;&lt;/a&gt;: always pass a TrueTypeFont to the font embedder class&lt;/p&gt;</comment>
                            <comment id="16088621" author="lehmi" created="Sat, 15 Jul 2017 14:37:29 +0000"  >&lt;p&gt;I did a similar refactoring for the PDTrueTypeFont class so that always a TrueTypeFont is passed to the embedder.&lt;/p&gt;</comment>
                            <comment id="16088628" author="lehmi" created="Sat, 15 Jul 2017 14:56:07 +0000"  >&lt;p&gt;I&apos;m thinking about closing the TrueTypeFont after embedding it if the ttf was created by PDFBox and if the font isn&apos;t subsetted. It should be safe as all data is loaded to the ttf and is available without parsing the underlying data again. I&apos;ve attached a patch with my proposed changes. WDYT, am I missing something?&lt;/p&gt;</comment>
                            <comment id="16088652" author="tilman" created="Sat, 15 Jul 2017 16:25:07 +0000"  >&lt;p&gt;Nice refactoring. Yes closing the ttf should be safe.&lt;/p&gt;

&lt;p&gt;Surprisingly, it is still possible to access the font data stream: calling&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;font.getTrueTypeFont().getOriginalData()
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;for a file input works because RAFDataStream reopens the file, and works for an input stream because close on a MemoryTTFDataStream does nothing.&lt;/p&gt;</comment>
                            <comment id="16088889" author="jira-bot" created="Sun, 16 Jul 2017 11:19:51 +0000"  >&lt;p&gt;Commit 1802044 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lehmi&quot; class=&quot;user-hover&quot; rel=&quot;lehmi&quot;&gt;lehmi&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1802044&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1802044&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3826&quot; title=&quot;NPE if RAFDataStream.getCurrentPosition() when TrueTypeFont created from file is reused&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3826&quot;&gt;&lt;del&gt;PDFBOX-3826&lt;/del&gt;&lt;/a&gt;: close the ttf if the underlying resource is no longer needed, added another load method using a TrueTypeFont as input&lt;/p&gt;</comment>
                            <comment id="16088908" author="lehmi" created="Sun, 16 Jul 2017 12:19:53 +0000"  >&lt;p&gt;Thanks @Tilman for the review. I&apos;ve added another load method to PDTrueTypeFont which accepts a TrueTypeFont instead of a file or string. I&apos;m going to commit the changes to the 2.0 branch as well&lt;/p&gt;

&lt;p&gt;Regarding &lt;tt&gt;font.getTrueTypeFont().getOriginalData()&lt;/tt&gt;: you are right, I&apos;ve never realized that the file is just reopened instead of using the underlying resource.&lt;/p&gt;
</comment>
                            <comment id="16088915" author="jira-bot" created="Sun, 16 Jul 2017 12:44:58 +0000"  >&lt;p&gt;Commit 1802051 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lehmi&quot; class=&quot;user-hover&quot; rel=&quot;lehmi&quot;&gt;lehmi&lt;/a&gt; in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1802051&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1802051&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3826&quot; title=&quot;NPE if RAFDataStream.getCurrentPosition() when TrueTypeFont created from file is reused&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3826&quot;&gt;&lt;del&gt;PDFBOX-3826&lt;/del&gt;&lt;/a&gt;: don&apos;t close the given ttf but the self generated one, move the relevant code to PDType0Font&lt;/p&gt;</comment>
                            <comment id="16088918" author="jira-bot" created="Sun, 16 Jul 2017 12:55:37 +0000"  >&lt;p&gt;Commit 1802054 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lehmi&quot; class=&quot;user-hover&quot; rel=&quot;lehmi&quot;&gt;lehmi&lt;/a&gt; in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1802054&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1802054&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3826&quot; title=&quot;NPE if RAFDataStream.getCurrentPosition() when TrueTypeFont created from file is reused&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3826&quot;&gt;&lt;del&gt;PDFBOX-3826&lt;/del&gt;&lt;/a&gt;: always pass a TrueTypeFont to the font embedder class&lt;/p&gt;</comment>
                            <comment id="16088922" author="jira-bot" created="Sun, 16 Jul 2017 13:01:51 +0000"  >&lt;p&gt;Commit 1802055 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lehmi&quot; class=&quot;user-hover&quot; rel=&quot;lehmi&quot;&gt;lehmi&lt;/a&gt; in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1802055&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1802055&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3826&quot; title=&quot;NPE if RAFDataStream.getCurrentPosition() when TrueTypeFont created from file is reused&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3826&quot;&gt;&lt;del&gt;PDFBOX-3826&lt;/del&gt;&lt;/a&gt;: close the ttf if the underlying resource is no longer needed, added another load method using a TrueTypeFont as input&lt;/p&gt;</comment>
                            <comment id="16089583" author="lehmi" created="Mon, 17 Jul 2017 10:02:01 +0000"  >&lt;p&gt;The behaviour was adjusted as follows:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;PDFBox closes all resources which are created by PDFBox itself&lt;/li&gt;
	&lt;li&gt;All instances of TrueTypeFont which are passed by the user won&apos;t be closed anymore&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Set to resolved&lt;/p&gt;</comment>
                            <comment id="16089973" author="jira-bot" created="Mon, 17 Jul 2017 15:39:01 +0000"  >&lt;p&gt;Commit 1802155 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1802155&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1802155&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3826&quot; title=&quot;NPE if RAFDataStream.getCurrentPosition() when TrueTypeFont created from file is reused&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3826&quot;&gt;&lt;del&gt;PDFBOX-3826&lt;/del&gt;&lt;/a&gt;: add test that failed before fixing of this issue, remove test that is contained in this one&lt;/p&gt;</comment>
                            <comment id="16089974" author="jira-bot" created="Mon, 17 Jul 2017 15:39:05 +0000"  >&lt;p&gt;Commit 1802156 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1802156&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1802156&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3826&quot; title=&quot;NPE if RAFDataStream.getCurrentPosition() when TrueTypeFont created from file is reused&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3826&quot;&gt;&lt;del&gt;PDFBOX-3826&lt;/del&gt;&lt;/a&gt;: add test that failed before fixing of this issue, remove test that is contained in this one&lt;/p&gt;</comment>
                            <comment id="16090008" author="jira-bot" created="Mon, 17 Jul 2017 16:15:39 +0000"  >&lt;p&gt;Commit 1802169 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1802169&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1802169&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3826&quot; title=&quot;NPE if RAFDataStream.getCurrentPosition() when TrueTypeFont created from file is reused&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3826&quot;&gt;&lt;del&gt;PDFBOX-3826&lt;/del&gt;&lt;/a&gt;: deactivate part of test, worked locally only&lt;/p&gt;</comment>
                            <comment id="16090009" author="jira-bot" created="Mon, 17 Jul 2017 16:15:41 +0000"  >&lt;p&gt;Commit 1802170 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1802170&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1802170&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3826&quot; title=&quot;NPE if RAFDataStream.getCurrentPosition() when TrueTypeFont created from file is reused&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3826&quot;&gt;&lt;del&gt;PDFBOX-3826&lt;/del&gt;&lt;/a&gt;: deactivate part of test, worked locally only&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12964738">PDFBOX-3337</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13087631">PDFBOX-3873</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12877452" name="PDFBOX-3628_closeTTF.patch" size="1499" author="lehmi" created="Sat, 15 Jul 2017 14:54:48 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 17 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3g5a7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>