<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 20:54:59 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PDFBOX-1822] Signature byte range is Invalid</title>
                <link>https://issues.apache.org/jira/browse/PDFBOX-1822</link>
                <project id="12310760" key="PDFBOX">PDFBox</project>
                    <description>&lt;p&gt;On person send me a unsigned PDF document. He wanted to sign it. When I try to sign it (using pad box), I have some problem.&lt;/p&gt;

&lt;p&gt;After signing adobe reader tells me &quot;The signature byre range is invalid&quot;.  &lt;/p&gt;

&lt;p&gt;I will attach original and signed document.&lt;/p&gt;

&lt;p&gt;I think, it is PDF box parser error. another signature libraries sign document very well. I&apos;m searching the problem at the moment, in order to fix it.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12686278">PDFBOX-1822</key>
            <summary>Signature byte range is Invalid</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="lehmi">Andreas Lehmk&#252;hler</assignee>
                                    <reporter username="v.koroghlishvili">vakhtang koroghlishvili</reporter>
                        <labels>
                    </labels>
                <created>Tue, 24 Dec 2013 12:30:06 +0000</created>
                <updated>Wed, 7 Sep 2016 17:39:29 +0000</updated>
                            <resolved>Mon, 2 Mar 2015 11:58:36 +0000</resolved>
                                    <version>1.8.3</version>
                    <version>1.8.4</version>
                    <version>2.0.0</version>
                                    <fixVersion>2.0.0</fixVersion>
                                    <component>Signing</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>10</watches>
                                                                                                                <comments>
                            <comment id="13859205" author="tchojecki" created="Tue, 31 Dec 2013 00:24:08 +0000"  >&lt;p&gt;I can confirm this error. The created byte range looks good. Maybe it is something else that confuse the parser or writer. The pdfbox itself can read and verify his created signature. &lt;/p&gt;

&lt;p&gt;I checked it also with the older pdfbox 1.8.2 with the same result.&lt;/p&gt;

&lt;p&gt;At the moment I have no idea whats wrong with this document. I found only a hybrid xref. Maybe there are different informations inside the xref table and the stream. I would need to analyse this case next year. &lt;/p&gt;

&lt;p&gt;// EDIT&lt;br/&gt;
It&apos;s late, the document only contains a normal xref table and not hybrid references, but the pdfbox add a xref stream instead. The detection seems to not work properly. Maybe you can attach a working signed document, so I can take a look at the result.&lt;/p&gt;</comment>
                            <comment id="13865496" author="vvolkgang" created="Wed, 8 Jan 2014 14:44:59 +0000"  >&lt;p&gt;I get this with files there were saved with PDDocument.save(..) or merged with the MergeUtility (which uses the PDDocument.save(...)), even if I don&apos;t add nothing to the document.&lt;/p&gt;</comment>
                            <comment id="13865563" author="tchojecki" created="Wed, 8 Jan 2014 15:42:00 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=vvolkgang&quot; class=&quot;user-hover&quot; rel=&quot;vvolkgang&quot;&gt;vvolkgang&lt;/a&gt;&lt;br/&gt;
thx for your effort to improve the pdfbox &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;As I mentioned in &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-1837&quot; title=&quot;PDDocument.save(String) doesn&amp;#39;t correctly save digital signatures&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-1837&quot;&gt;&lt;del&gt;PDFBOX-1837&lt;/del&gt;&lt;/a&gt; your problem is the use of PDDocument.save(...) method. After signing a document, it isn&apos;t possible to manipulate (merge or resave) the document without breaking the signature. If you trigger the save method, the whole document will be wrote up from the scratch. This mean pdfbox parse the document and hold this document in his kind of structure. If you trigger save the created structure will be wrote to a new file. &lt;/p&gt;

&lt;p&gt;PDF documents are complex files. After reading and saving it, there is no guarantee that the saved document is still the same. Each library works different so each library would create a complete different output document after just reading and saving it again. You did not need to add additional informations to get a different result.&lt;/p&gt;

&lt;p&gt;If you have a document that was incrementally updated, pdfbox will remove and merge this revisions to one. The result are weird errors when you verify a signature. If you work with signatures you shall not rewrite the document. Only incremental updates are allowed. Some libs can detect such cases and use automatically incremental updates. &lt;/p&gt;

&lt;p&gt;I would appreciate it, if we can discuss your signature problems at the mailing list &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;br/&gt;
&lt;a href=&quot;https://pdfbox.apache.org/mailinglists.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://pdfbox.apache.org/mailinglists.html&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13865747" author="vvolkgang" created="Wed, 8 Jan 2014 18:56:23 +0000"  >&lt;p&gt;To clarify, I consider this to be different problems &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tchojecki&quot; class=&quot;user-hover&quot; rel=&quot;tchojecki&quot;&gt;tchojecki&lt;/a&gt;. I&apos;m not trying to digitally sign a previously manipulated PDF, I&apos;m doing a 3 step process: Manipulate, save, sign the saved file. &lt;/p&gt;

&lt;p&gt;What triggers me to blame &lt;b&gt;PDDocument.save(...)&lt;/b&gt; was doing the following steps, provided a &lt;b&gt;original.pdf&lt;/b&gt;:&lt;br/&gt;
&lt;b&gt;Case 1:&lt;/b&gt;&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Sign &lt;b&gt;original.pdf&lt;/b&gt;&lt;/li&gt;
	&lt;li&gt;Adobe Reader validates the signature&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;&lt;b&gt;Case 2:&lt;/b&gt;&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Load &lt;b&gt;original.pdf&lt;/b&gt; to a PDDocument&lt;/li&gt;
	&lt;li&gt;Save &lt;b&gt;original.pdf&lt;/b&gt; to a temporary file&lt;/li&gt;
	&lt;li&gt;Sign the temporary file&lt;/li&gt;
	&lt;li&gt;Adobe Reader reports that the byte range is invalid&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;If you need further info, we can discuss it in the mailing list as you&apos;ve stated.&lt;/p&gt;</comment>
                            <comment id="13877838" author="v.koroghlishvili" created="Tue, 21 Jan 2014 20:44:04 +0000"  >&lt;p&gt;Discussion at stackoverflow: &lt;a href=&quot;http://stackoverflow.com/questions/21257507/attachment-damages-singature/21260292?noredirect=1#21260292&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://stackoverflow.com/questions/21257507/attachment-damages-singature/21260292?noredirect=1#21260292&lt;/a&gt;&lt;br/&gt;
The same issue was opened here: &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-1857&quot; title=&quot;Attachment damages singature&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-1857&quot;&gt;&lt;del&gt;PDFBOX-1857&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13878556" author="lehmi" created="Wed, 22 Jan 2014 11:39:13 +0000"  >&lt;p&gt;I had a quick look at the attached pdf (unsigned.pdf) and IMO it&apos;s broken:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;xref
0 20
0000000000 65535 f
0000000015 00000 n
0000000497 00000 n
0000004753 00000 n
0000004810 00000 n
0000004917 00000 n
0000000200 00000 n
0000004960 00000 n
0000005185 00000 n
0000005234 00000 n
0000005275 00000 n
0000005515 00000 n
0000005537 00000 n
0000005741 00000 n
0000005776 00000 n
0000006109 00000 n
0000006161 00000 n
0000006457 00000 n
0000006724 00000 n
0000007034 00000 n
trailer
&amp;lt;&amp;lt;
/DecodeParms &amp;lt;&amp;lt;
/Columns 4
/Predictor 12
&amp;gt;&amp;gt;
/Filter /FlateDecode
/ID [&amp;lt;AB596626871BC84DB58B26BE18E76D38&amp;gt; &amp;lt;D82E074D4A5E8D459F3DF40B2A002015&amp;gt;]
/Info 6 0 R
/Length 58
/Root 1 0 R
/Size 20
/Type /XRef
/W [1 2 1]
/Index [14 13]
&amp;gt;&amp;gt;
startxref
24851
%%EOF
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The pdf obviously uses a xref table. The trailer contains values which are only expected if the pdf uses a xref stream, such as the /Type /Size /W, but the stream itself is missing. In the following the COSWriter tries to determine if a xref table or a xref stream should be written by calling COSDocument#isXRefStream. That method delivers &quot;true&quot; as the broken trailer dictionary contains a &quot;/Type /XRef&quot; entry. Maybe we should introduce a new internal boolean value within the trailer which is set when reading a xref stream, so that we can be sure that the pdf really uses a xref stream not not just has broken trailer dictionary which leads to false information.&lt;/p&gt;

&lt;p&gt;I hope this makes sense ... &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13878594" author="tchojecki" created="Wed, 22 Jan 2014 12:28:46 +0000"  >&lt;p&gt;You are right.It looks also like a merged document. See the ID. So maybe the application merged a document that contains a classic xref table with a document that contains a xref stream.&lt;/p&gt;</comment>
                            <comment id="13879023" author="lehmi" created="Wed, 22 Jan 2014 19:04:11 +0000"  >&lt;p&gt;I changed the implementation of COSDocument#isXRefStream in revision 1560474. I tno more relies on the trailer dictionary to determine if the pdf uses a xref table or a xref stream.&lt;/p&gt;

&lt;p&gt;Can someone please check if the signing now works as I&apos;m not familiar with all that signing stuff.&lt;/p&gt;</comment>
                            <comment id="13879107" author="v.koroghlishvili" created="Wed, 22 Jan 2014 20:02:11 +0000"  >&lt;p&gt;I&apos;have tested and everything is well. &lt;br/&gt;
Andreas, thank you for this patch. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13879109" author="v.koroghlishvili" created="Wed, 22 Jan 2014 20:04:43 +0000"  >&lt;p&gt;I have attached fixed version document.&lt;/p&gt;</comment>
                            <comment id="13879123" author="v.koroghlishvili" created="Wed, 22 Jan 2014 20:12:52 +0000"  >&lt;p&gt;&#193;lison Fernandes&lt;br/&gt;
I&apos;have tested your issue too. As I see , everything is well.&lt;/p&gt;</comment>
                            <comment id="13879140" author="lehmi" created="Wed, 22 Jan 2014 20:23:50 +0000"  >&lt;p&gt;I merged the changes into the 1.8 branch in revision 1560498.&lt;/p&gt;

&lt;p&gt;The fix is limited to the non-sequential parser.&lt;/p&gt;

&lt;p&gt;Thanks for all the input and help!&lt;/p&gt;</comment>
                            <comment id="13879493" author="lehmi" created="Thu, 23 Jan 2014 06:39:05 +0000"  >&lt;p&gt;I&apos;m still thinking about the limitation to the non-sequential parser. Is it allowed to mix up the usage of xref tables and xref streams within a pdf?&lt;/p&gt;</comment>
                            <comment id="13879792" author="tchojecki" created="Thu, 23 Jan 2014 09:36:37 +0000"  >&lt;p&gt;We also have hybrid xref documents out there. Hope this will not break the existing function. I will test it today.&lt;/p&gt;

&lt;p&gt;Changing the parser to non-sequential would indeed solve all signing problems. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; There will be no signatures, because the incremental update does not work with the non seq parser (testet it a while ago). SCNR &lt;/p&gt;

&lt;p&gt;EDIT:&lt;br/&gt;
OK the NonSeq works for signatures &lt;b&gt;stunned&lt;/b&gt;. Doesn&apos;t mentioned that this was fixed.&lt;br/&gt;
Hybrid XRef documents still working.&lt;/p&gt;

&lt;p&gt;Thx for the patch&lt;/p&gt;</comment>
                            <comment id="13879833" author="tboehme" created="Thu, 23 Jan 2014 10:35:38 +0000"  >&lt;p&gt;For mixing up xref tables/streams see &lt;a href=&quot;http://stackoverflow.com/questions/14962151/mixing-xref-tables-and-xref-streams&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://stackoverflow.com/questions/14962151/mixing-xref-tables-and-xref-streams&lt;/a&gt; and &lt;a href=&quot;http://forums.adobe.com/thread/1034273&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://forums.adobe.com/thread/1034273&lt;/a&gt;&lt;br/&gt;
Normally you have to stay with one kind of XREF, however hybrid documents are possible in order for old parsers to parse the document via xref table - so while we have both kinds all content must be accessible by xref table in this case (no changing within xref chain).&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lehmi&quot; class=&quot;user-hover&quot; rel=&quot;lehmi&quot;&gt;lehmi&lt;/a&gt;: if I understand your patch correctly it is now up to the parser to set isXrefStream in COSDocument? This will be set by NonSeqParser. However if one uses the sequential one this property won&apos;t be set at all. So do we need to change PDFParser as well or should the boolean in COSDocument be an object with NULL for not set in which case the old behavior COSName.XREF.equals(trailer.getItem(COSName.TYPE)) is used?&lt;/p&gt;</comment>
                            <comment id="13879862" author="lehmi" created="Thu, 23 Jan 2014 11:19:14 +0000"  >&lt;p&gt;The origin issue is that PDFBox changes the kind of the trailer xref under special circumstances which leads to mixed up xref types in the origin pdf and the appended part after signing. According to &lt;a href=&quot;http://stackoverflow.com/questions/21257507/attachment-damages-singature/21260292?noredirect=1#21260292&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://stackoverflow.com/questions/21257507/attachment-damages-singature/21260292?noredirect=1#21260292&lt;/a&gt; that&apos;s not allowed and leads to the described issue.&lt;/p&gt;

&lt;p&gt;The given pdf is malformed as it contains a somehow merged trailer dictionary, so that we can&apos;t rely on the /Type value of that dictionary. My idea was to determine the xref type when the trailer xref is read. The non-sequential parser starts with reading the trailer so that it is easy to determine if it uses a xref table or a stream. The &quot;old&quot; parser on the contrary starts from the beginning, reads all objects and tries to figure out their meaning at the end and I didn&apos;t found a way to determine the trailer xref type.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tboehme&quot; class=&quot;user-hover&quot; rel=&quot;tboehme&quot;&gt;tboehme&lt;/a&gt; I agree there is gap and I already reopened the issue. But your proposal would lead to the same issue when using the old parser, as the fallback again relies on the /Type value which is wrong in the given pdf. IMO the only solution for the &quot;old&quot; parser is to find a way to detect the xref type when reading/using the first trailer similar to the non-sequential solution. Any ideas on how to do that?&lt;/p&gt;</comment>
                            <comment id="13879873" author="msahyoun" created="Thu, 23 Jan 2014 11:42:30 +0000"  >&lt;p&gt;Hi&lt;/p&gt;

&lt;p&gt;for true hybrid Xref&#8217;s i.e. a PDF contains both an Xref table and an Xref stream the Trailer contains a dictionary entry XRefStm. Details in 7.5.8.4 Compatibility with Applications That Do Not Support Compressed Reference Streams of the ISO spec.&lt;/p&gt;

&lt;p&gt;BR&lt;br/&gt;
Maruan&lt;/p&gt;</comment>
                            <comment id="13879933" author="tboehme" created="Thu, 23 Jan 2014 13:59:10 +0000"  >&lt;p&gt;We could add enum parameter xrefType to XrefTrailerResolver.XrefTrailerObj which is set while calling XrefTrailerResolver.nextXrefObj( final long startBytePos, xrefType ) (new 2nd parameter). Then we add method in XrefTrailerResolver:&lt;br/&gt;
public XREF_TYPE getXrefType() &lt;/p&gt;
{ return ( resolvedXrefTrailer == null ) ? null : resolvedXrefTrailer.xrefType;   }
&lt;p&gt;This can be called in PDFParser in method parse() after line&lt;br/&gt;
            document.addXRefTable( xrefTrailerResolver.getXrefTable() );&lt;br/&gt;
to set type in COSDocument.&lt;/p&gt;

&lt;p&gt;My previous solution was a work-around which does not change (but restores) the processing behavior for PDFParser given that this streaming approach is problematic in itself (and the usage should be discouraged) so that the fix for this very specific case with wrong dictionary entry is not worth the effort (in my opinion), However the above solution might be advantageous if one needs to know the kind of xref object later on.&lt;/p&gt;</comment>
                            <comment id="13880061" author="tchojecki" created="Thu, 23 Jan 2014 16:45:01 +0000"  >&lt;p&gt;I have attached a zip with a set of files. The files represent the signing results between the pdfbox versions 1.8.2 and 1.8.4-SNAPSHOT and two examples done with NonSeq parser.&lt;/p&gt;

&lt;p&gt;The document I used for the signatures (ToBeSigned.pdf) is valid, already signed and use a XRefStream.&lt;/p&gt;

&lt;p&gt;&lt;b&gt;Result:&lt;/b&gt;&lt;br/&gt;
NonSeq does not work at all. It copy the whole document instead of only writing affected objects.&lt;/p&gt;

&lt;p&gt;1.8.2 - has problem attaching a second signature on this kind of document. &lt;b&gt;does not work&lt;/b&gt;&lt;br/&gt;
1.8.3 - solves this problem. &lt;b&gt;work&lt;/b&gt;&lt;br/&gt;
1.8.4-SNAPSHOT - is the latest 1.8.x branch without the patch from this Issue. &lt;b&gt;work&lt;/b&gt;&lt;br/&gt;
1.8.4-SNAPSHOT_WITH_&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-1822&quot; title=&quot;Signature byte range is Invalid&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-1822&quot;&gt;&lt;del&gt;PDFBOX-1822&lt;/del&gt;&lt;/a&gt;_PATCH - is the version with the patch from this issue. &lt;b&gt;does not work&lt;/b&gt; Instead of an XRefStream a XRefTable was wrote. Make no sense in this case. &lt;/p&gt;

&lt;p&gt;The biggest problem is, all JUnit tests went well. I checked each document with the latest Adobe Reader to find the problems.&lt;/p&gt;</comment>
                            <comment id="13881308" author="lehmi" created="Fri, 24 Jan 2014 18:59:30 +0000"  >&lt;p&gt;I&apos;ve followed Timos proposal and overhauled the detection of the correct XRef type. I&apos;ve added the changes in revision 1561111.&lt;/p&gt;

&lt;p&gt;Can someone please check if it works now?&lt;/p&gt;</comment>
                            <comment id="13882369" author="lehmi" created="Sun, 26 Jan 2014 17:47:30 +0000"  >&lt;p&gt;I reverted the changes in the 1.8 branch committed in r1560498 in revision 1561523 as I want to cut a  new 1.8 bugfix release soon.&lt;/p&gt;</comment>
                            <comment id="14271944" author="lagarino" created="Fri, 9 Jan 2015 22:11:47 +0000"  >&lt;p&gt;Is there any plan to fix this issue? Still some PDF files have the error &quot;The signature byre range is invalid&quot;.&lt;/p&gt;

&lt;p&gt;Thanks.&lt;/p&gt;</comment>
                            <comment id="14318640" author="jira-bot" created="Thu, 12 Feb 2015 18:00:28 +0000"  >&lt;p&gt;Commit 1659342 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lehmi&quot; class=&quot;user-hover&quot; rel=&quot;lehmi&quot;&gt;lehmi&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1659342&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1659342&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-1822&quot; title=&quot;Signature byte range is Invalid&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-1822&quot;&gt;&lt;del&gt;PDFBOX-1822&lt;/del&gt;&lt;/a&gt;: create a valid signature&lt;/p&gt;</comment>
                            <comment id="14318649" author="lehmi" created="Thu, 12 Feb 2015 18:03:37 +0000"  >&lt;p&gt;1.8.8 already worked and with the last change 2.0.0 should work as well.&lt;/p&gt;</comment>
                            <comment id="14559288" author="abyss" created="Tue, 26 May 2015 15:55:52 +0000"  >&lt;p&gt;Unfortunately, due to &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2440&quot; title=&quot;xref stream is saved as table&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2440&quot;&gt;&lt;del&gt;PDFBOX-2440&lt;/del&gt;&lt;/a&gt; bug, this bug still persists. Scenario:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;using PDFBox open PDF containing cross-reference stream (not hybrid);&lt;/li&gt;
	&lt;li&gt;save to a new file without modification; in the new file xref stream is saved as table due to &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2440&quot; title=&quot;xref stream is saved as table&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2440&quot;&gt;&lt;del&gt;PDFBOX-2440&lt;/del&gt;&lt;/a&gt;;&lt;/li&gt;
	&lt;li&gt;sign that file with PDFBox.&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;When signed file I open with Adobe Reader, I get &quot;signature byte range invalid&quot;.&lt;br/&gt;
Used 1.8.10-SNAPSHOT.&lt;/p&gt;</comment>
                            <comment id="14559316" author="lehmi" created="Tue, 26 May 2015 16:21:04 +0000"  >&lt;p&gt;Sorry, but I didn&apos;t get your point. First of all &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2440&quot; title=&quot;xref stream is saved as table&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2440&quot;&gt;&lt;del&gt;PDFBOX-2440&lt;/del&gt;&lt;/a&gt; was fixed in trunk and not in 1.8.x.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Unfortunately, due to &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2440&quot; title=&quot;xref stream is saved as table&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2440&quot;&gt;&lt;del&gt;PDFBOX-2440&lt;/del&gt;&lt;/a&gt; bug, this bug still persists. &lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;What exactly does this mean? Are you saying that due to &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2440&quot; title=&quot;xref stream is saved as table&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2440&quot;&gt;&lt;del&gt;PDFBOX-2440&lt;/del&gt;&lt;/a&gt; you&apos;ve got a malformed pdf which can&apos;t be signed using PDFBOX?&lt;/p&gt;</comment>
                            <comment id="14559343" author="abyss" created="Tue, 26 May 2015 16:39:41 +0000"  >&lt;p&gt;Yes. When PDF is saved (using &lt;tt&gt;PDDocument#save()&lt;/tt&gt;) in step 2, I get malformed PDF with xref stream dictionary merged into trailer. When in step 3 I try to sign it, I get signature error.&lt;br/&gt;
If I sign the first PDF without intermediate save, OK.&lt;/p&gt;

&lt;p&gt;And unfortunately, I have to use 1.8x. &lt;/p&gt;</comment>
                            <comment id="14562617" author="lehmi" created="Thu, 28 May 2015 10:04:13 +0000"  >&lt;p&gt;OK, so the cause for the described problem is related to &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2440&quot; title=&quot;xref stream is saved as table&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2440&quot;&gt;&lt;del&gt;PDFBOX-2440&lt;/del&gt;&lt;/a&gt;, but not to this issue. I&apos;m going to check wether it&apos;s possible to backport the fix from &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2440&quot; title=&quot;xref stream is saved as table&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2440&quot;&gt;&lt;del&gt;PDFBOX-2440&lt;/del&gt;&lt;/a&gt; to 1.8.x&lt;/p&gt;</comment>
                            <comment id="14564405" author="abyss" created="Fri, 29 May 2015 08:23:13 +0000"  >&lt;p&gt;Yes, probably related to &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2440&quot; title=&quot;xref stream is saved as table&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2440&quot;&gt;&lt;del&gt;PDFBOX-2440&lt;/del&gt;&lt;/a&gt;. I could workaround the issue if I remove Xref related keys from the trailer before saving in step 2.&lt;/p&gt;</comment>
                            <comment id="15471281" author="tilman" created="Wed, 7 Sep 2016 17:39:29 +0000"  >&lt;p&gt;Unrelated but I&apos;m trying to reach signature users:&lt;br/&gt;
Please have a look at &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3065&quot; title=&quot;Right now PDFBOX does not permit to sign multiple files while calling an external signing service.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3065&quot;&gt;&lt;del&gt;PDFBOX-3065&lt;/del&gt;&lt;/a&gt;, this is about a different way to sign that will replace the current situation in 2.1, and in 2.0.* it will coexist. More explanation in &lt;tt&gt;PDDocument.saveIncrementalForExternalSigning&lt;/tt&gt;, see [ &lt;a href=&quot;https://svn.apache.org/r1759639&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1759639&lt;/a&gt; ].&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                            <outwardlinks description="duplicates">
                                        <issuelink>
            <issuekey id="12690005">PDFBOX-1857</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12624822" name="SignatureFileSet-PDFBOX-1.8.2_TO_1.8.4-SNAPSHOT_SEQ_AND_NONSEQ.zip" size="1937752" author="tchojecki" created="Thu, 23 Jan 2014 16:45:01 +0000"/>
                            <attachment id="12620334" name="araxis-merge - compare two document.jpg" size="400387" author="v.koroghlishvili" created="Tue, 24 Dec 2013 12:31:01 +0000"/>
                            <attachment id="12620335" name="damaged-sig.jpg" size="64199" author="v.koroghlishvili" created="Tue, 24 Dec 2013 12:31:01 +0000"/>
                            <attachment id="12620337" name="unsigned-signed.pdf" size="64614" author="v.koroghlishvili" created="Tue, 24 Dec 2013 12:31:01 +0000"/>
                            <attachment id="12620336" name="unsigned.pdf" size="25520" author="v.koroghlishvili" created="Tue, 24 Dec 2013 12:31:01 +0000"/>
                            <attachment id="12624410" name="unsigned_signed_fix.pdf" size="64833" author="v.koroghlishvili" created="Wed, 22 Jan 2014 20:04:43 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>6.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>365258</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 10 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1qyhj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>365561</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>