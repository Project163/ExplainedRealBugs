<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:12:46 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PDFBOX-5389] To set compressed on buffered image while creating a PDF</title>
                <link>https://issues.apache.org/jira/browse/PDFBOX-5389</link>
                <project id="12310760" key="PDFBOX">PDFBox</project>
                    <description>&lt;p&gt;Dear Concerned,&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Dear Concerned,&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;We need to convert images into PDF. We have many format of image type like tiff with any compression (G3, G4, LZW or Jpeg compression), JPEG, BMP, PNG. Images can be single strip or multistrip/multitiles.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;We have converted these images into buffered image and add it to pdf page but for all type of image only compression set is /flatdecode. I need to set different compression for different image format.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Kindly suggest how to set the compression while inserting image in creation mode of PDF&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Code:&lt;/p&gt;

&lt;p&gt;{&lt;/p&gt;

&lt;p&gt;PDDocument document = new PDDocument();&lt;/p&gt;

&lt;p&gt;//generated buffered image BufferedImage bim;&lt;/p&gt;

&lt;p&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; PDPage page = new PDPage(new PDRectangle((int) bim.getWidth(), (int)bim.getHeight()));&lt;/p&gt;

&lt;p&gt;&#160;&#160;&#160;&#160;&#160;&#160; &#160;&#160;&#160;&#160;&#160;&#160;&#160; document.addPage(page);&lt;/p&gt;

&lt;p&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; //Creating PDImageXObject object&#160;&lt;/p&gt;

&lt;p&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; PDImageXObject imgObj = null;&lt;/p&gt;

&lt;p&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; try &lt;/p&gt;
{

&#160;&#160;&#160;&#160;&#160;&#160;&#160; &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &#160;imgObj = LosslessFactory.createFromImage(document, bim);

&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }
&lt;p&gt; catch (IOException e) &lt;/p&gt;
{

&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; // TODO Auto-generated catch block

&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; e.printStackTrace();

&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }

&lt;p&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160; //PDPageContentStream contentStream = new PDPageContentStream(document, page, AppendMode.OVERWRITE,true,true);&lt;/p&gt;

&lt;p&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; PDPageContentStream contentStream = new PDPageContentStream(document, page);&lt;/p&gt;

&lt;p&gt;&#160;&#160;&#160;&#160;&#160;&#160; &#160;&#160;&#160;&#160;&#160;&#160;&#160; contentStream.drawImage(imgObj, 0, 0);&lt;/p&gt;

&lt;p&gt;&#160;&#160;&#160;&#160;&#160;&#160; &#160;&#160;&#160;&#160;&#160;&#160;&#160; contentStream.close();&lt;/p&gt;

&lt;p&gt;&#160;&#160;&#160;&#160;&#160;&#160; &#160;&#160;&#160;&#160;&#160;&#160;&#160; //fileForInput.close();&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&#160;&#160;&#160;&#160;&#160; &#160;&#160;&#160;&#160;&#160;&#160;&#160; document.save(outputFile + &quot;.pdf&quot;);&lt;/p&gt;

&lt;p&gt;&#160;&#160;&#160;&#160;&#160;&#160; &#160;&#160;&#160;&#160;&#160;&#160;&#160; document.close();&lt;/p&gt;

&lt;p&gt;}&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;PDFBox vesion : 2.0.19&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Regards,&lt;/p&gt;

&lt;p&gt;Komal Walia&lt;/p&gt;</description>
                <environment></environment>
        <key id="13434064">PDFBOX-5389</key>
            <summary>To set compressed on buffered image while creating a PDF</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tilman">Tilman Hausherr</assignee>
                                    <reporter username="komal.walia">Komal</reporter>
                        <labels>
                    </labels>
                <created>Wed, 16 Mar 2022 09:26:49 +0000</created>
                <updated>Thu, 29 Sep 2022 17:57:15 +0000</updated>
                            <resolved>Sun, 19 Jun 2022 07:31:55 +0000</resolved>
                                    <version>2.0.19</version>
                                    <fixVersion>2.0.27</fixVersion>
                    <fixVersion>3.0.0 PDFBox</fixVersion>
                                    <component>Documentation</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="17507791" author="tilman" created="Wed, 16 Mar 2022 18:17:45 +0000"  >&lt;p&gt;Please update to 2.0.25 and use &lt;tt&gt;PDImageXObject.createFromFile()&lt;/tt&gt; which will make better choices based on the file format.&lt;/p&gt;

&lt;p&gt;This is a how-to question, these should be asked elsewhere, see&lt;br/&gt;
&lt;a href=&quot;https://pdfbox.apache.org/support.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://pdfbox.apache.org/support.html&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17508009" author="JIRAUSER286666" created="Thu, 17 Mar 2022 07:18:54 +0000"  >&lt;p&gt;Dear Tilman,&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;I have tried the API PDImageXObject.createFromFile(inputFile, document); of PDFBOX version 2.0.25&lt;/p&gt;

&lt;p&gt;but it is giving same exceptions as in version 2.0.19:&lt;/p&gt;

&lt;p&gt;java.io.IOException: First image in tiff is not a single tile/strip&lt;br/&gt;
&#160; &#160; at org.apache.pdfbox.pdmodel.graphics.image.CCITTFactory.extractFromTiff(CCITTFactory.java:484)&lt;br/&gt;
&#160; &#160; at org.apache.pdfbox.pdmodel.graphics.image.CCITTFactory.createFromRandomAccessImpl(CCITTFactory.java:261)&lt;br/&gt;
&#160; &#160; at org.apache.pdfbox.pdmodel.graphics.image.CCITTFactory.createFromFile(CCITTFactory.java:237)&lt;br/&gt;
&#160; &#160; at org.apache.pdfbox.pdmodel.graphics.image.CCITTFactory.createFromFile(CCITTFactory.java:214)&lt;br/&gt;
&#160; &#160; at org.apache.pdfbox.pdmodel.graphics.image.PDImageXObject.createFromFileByExtension(PDImageXObject.java:256)&lt;br/&gt;
&#160; &#160; at org.apache.pdfbox.pdmodel.graphics.image.PDImageXObject.createFromFile(PDImageXObject.java:208)&lt;br/&gt;
&#160; &#160; at Drivers.convertImageToPDFUsingPDFBOX.main(convertImageToPDFUsingPDFBOX.java:112)&lt;br/&gt;
Exception in thread &quot;main&quot; java.lang.NullPointerException&lt;br/&gt;
&#160; &#160; at org.apache.pdfbox.pdmodel.PDPageContentStream.drawImage(PDPageContentStream.java:696)&lt;br/&gt;
&#160; &#160; at Drivers.convertImageToPDFUsingPDFBOX.main(convertImageToPDFUsingPDFBOX.java:121)&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Because of this exception we are using API&lt;/p&gt;

&lt;p&gt;LosslessFactory.createFromImage(); which works on all type of images and Here, I need a API to set different compressions like CCITTFAXDecode, Jpeg compression and so on&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;.&lt;/p&gt;

&lt;p&gt;Kindly suggest.&lt;/p&gt;</comment>
                            <comment id="17508016" author="tilman" created="Thu, 17 Mar 2022 07:27:51 +0000"  >&lt;p&gt;I looked on the code again, &lt;tt&gt;PDImageXObject.createFromByteArray&lt;/tt&gt; and &lt;tt&gt;PDImageXObject.createFromFileByContent&lt;/tt&gt; catch this exception and then try again with &lt;tt&gt;LosslessFactory.createFromImage&lt;/tt&gt;. So your solution here would be to use one of these. Call the first one with the result of calling &lt;tt&gt;Files.readAllBytes(path)&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;This is of course a poor user experience, we should fix the other methods.&lt;/p&gt;

&lt;p&gt;If possible, please attach such a stripped TIFF file.&lt;/p&gt;</comment>
                            <comment id="17508028" author="JIRAUSER286666" created="Thu, 17 Mar 2022 07:52:40 +0000"  >&lt;p&gt;Dear Tilman,&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;PFA the sample tiff, It is G3 compression multi strip tiff file. I need to generate CCITTFaxdecode compressed PDF for the same:&lt;/p&gt;

&lt;p&gt;Kindly suggest  &lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/13041266/13041266_1bit_singlepage_G3_out.tiff&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt; which API should we use. Not able to find any API which will set the &#160;CCITTFaxdecode compression.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Regards,&lt;/p&gt;

&lt;p&gt;Komal Walia&lt;/p&gt;</comment>
                            <comment id="17508304" author="tilman" created="Thu, 17 Mar 2022 17:09:53 +0000"  >&lt;p&gt;If you WANT to have CCITT compression, then use &lt;tt&gt;CCITTFactory.createFromImage()&lt;/tt&gt;, however this will only work if the BufferedImage you get is of TYPE_BITONAL. (I haven&apos;t tested whether it is)&lt;/p&gt;</comment>
                            <comment id="17508558" author="jira-bot" created="Fri, 18 Mar 2022 04:05:27 +0000"  >&lt;p&gt;Commit 1899020 from Tilman Hausherr in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1899020&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1899020&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-5389&quot; title=&quot;To set compressed on buffered image while creating a PDF&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-5389&quot;&gt;&lt;del&gt;PDFBOX-5389&lt;/del&gt;&lt;/a&gt;: add another fallback to PNG behavior&lt;/p&gt;</comment>
                            <comment id="17508559" author="jira-bot" created="Fri, 18 Mar 2022 04:05:31 +0000"  >&lt;p&gt;Commit 1899021 from Tilman Hausherr in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1899021&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1899021&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-5389&quot; title=&quot;To set compressed on buffered image while creating a PDF&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-5389&quot;&gt;&lt;del&gt;PDFBOX-5389&lt;/del&gt;&lt;/a&gt;: add another fallback to PNG behavior&lt;/p&gt;</comment>
                            <comment id="17508564" author="jira-bot" created="Fri, 18 Mar 2022 04:23:15 +0000"  >&lt;p&gt;Commit 1899023 from Tilman Hausherr in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1899023&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1899023&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-5389&quot; title=&quot;To set compressed on buffered image while creating a PDF&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-5389&quot;&gt;&lt;del&gt;PDFBOX-5389&lt;/del&gt;&lt;/a&gt;: add test with LZW compressed TIF that should be handled as PNG&lt;/p&gt;</comment>
                            <comment id="17508565" author="jira-bot" created="Fri, 18 Mar 2022 04:23:20 +0000"  >&lt;p&gt;Commit 1899024 from Tilman Hausherr in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1899024&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1899024&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-5389&quot; title=&quot;To set compressed on buffered image while creating a PDF&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-5389&quot;&gt;&lt;del&gt;PDFBOX-5389&lt;/del&gt;&lt;/a&gt;: add test with LZW compressed TIF that should be handled as PNG&lt;/p&gt;</comment>
                            <comment id="17556037" author="tilman" created="Sun, 19 Jun 2022 07:31:55 +0000"  >&lt;p&gt;I forgot about this one but I think all is done here. We can&apos;t handle tiled / stripped images directly.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="13041266" name="1bit_singlepage_G3_out.tiff" size="87050" author="komal.walia" created="Thu, 17 Mar 2022 07:52:17 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 20 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z10j1s:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>