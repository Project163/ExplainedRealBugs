<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 20:56:50 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PDFBOX-1268] OutOfMemory Error because of huge colors</title>
                <link>https://issues.apache.org/jira/browse/PDFBOX-1268</link>
                <project id="12310760" key="PDFBOX">PDFBox</project>
                    <description>&lt;p&gt;Hi,&lt;/p&gt;

&lt;p&gt;Am 26.03.2012 07:42, schrieb Christophe Vandeplas:&lt;/p&gt;

&lt;p&gt;    Hello List,&lt;/p&gt;


&lt;p&gt;    I&apos;m working on a PDF scanning tool and with a specific (malicious) PDF&lt;br/&gt;
    I always get OutOfMemory Errors.&lt;/p&gt;

&lt;p&gt;    The backtrace is:&lt;br/&gt;
    Exception in thread &quot;main&quot; java.lang.OutOfMemoryError: Java heap space&lt;br/&gt;
           at org.apache.pdfbox.filter.FlateFilter.decodePredictor(FlateFilter.java:218)&lt;br/&gt;
           at org.apache.pdfbox.filter.FlateFilter.decode(FlateFilter.java:170)&lt;br/&gt;
           at org.apache.pdfbox.cos.COSStream.doDecode(COSStream.java:279)&lt;br/&gt;
           at org.apache.pdfbox.cos.COSStream.doDecode(COSStream.java:221)&lt;br/&gt;
           at org.apache.pdfbox.cos.COSStream.getUnfilteredStream(COSStream.java:156)&lt;br/&gt;
           at ScanPdf.checkCOSBaseObject(ScanPdf.java:199)&lt;br/&gt;
            ...&lt;/p&gt;

&lt;p&gt;    When looking in the PDFBox code FlateFilter.java:218 is&lt;br/&gt;
    byte[] lastline = new byte&lt;span class=&quot;error&quot;&gt;&amp;#91;rowlength&amp;#93;&lt;/span&gt;;&lt;/p&gt;

&lt;p&gt;    In that contact rowlength = 1073741838   =&amp;gt;  seems rather big, no?&lt;br/&gt;
    Looking back in the code it seems that it&apos;s colors who is so big.&lt;br/&gt;
    Colors seems to be extracted from the dict in FlateFilter.java:96:&lt;br/&gt;
    colors = dict.getInt(COSName.COLORS);&lt;/p&gt;

&lt;p&gt;    The (malicious) PDF has indeed the definition :    /Colors 1073741838&lt;/p&gt;

&lt;p&gt;Hmm, that sounds quite large, but the pdf spec describes the colors value as follows:&lt;/p&gt;

&lt;p&gt;&quot;(May be used only if Predictor is greater than 1) The number of interleaved colour components per sample. Valid values are 1 to 4 (PDF 1.0) and 1 or greater (PDF 1.3). Default value: 1.&quot;&lt;/p&gt;


&lt;p&gt;    So my question is now:&lt;br/&gt;
    Is this something I need to catch in my own code, or should PDFBox be&lt;br/&gt;
    patched to catch such issues? (like the catched OutOfMemoryError in&lt;br/&gt;
    FlateFilter:124)&lt;/p&gt;

&lt;p&gt;PDFBox should handle that. Please create an issue on JIRA &lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; and attach the pdf in question.&lt;/p&gt;


&lt;p&gt;    Thanks for your expertise&lt;br/&gt;
    Christophe&lt;/p&gt;


&lt;p&gt;BR&lt;br/&gt;
Andreas Lehmk&#252;hler&lt;/p&gt;
</description>
                <environment></environment>
        <key id="12548064">PDFBOX-1268</key>
            <summary>OutOfMemory Error because of huge colors</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="cvandeplas">Christophe Vandeplas</reporter>
                        <labels>
                    </labels>
                <created>Mon, 26 Mar 2012 06:17:37 +0000</created>
                <updated>Fri, 19 Sep 2014 14:40:44 +0000</updated>
                            <resolved>Mon, 4 Aug 2014 19:38:48 +0000</resolved>
                                    <version>1.6.0</version>
                                    <fixVersion>1.8.7</fixVersion>
                    <fixVersion>2.0.0</fixVersion>
                                    <component>Parsing</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="13238136" author="cvandeplas" created="Mon, 26 Mar 2012 06:19:18 +0000"  >&lt;p&gt;File causing this issue. WARNING: file is malicious on Windows systems&lt;/p&gt;</comment>
                            <comment id="14085167" author="jahewson" created="Mon, 4 Aug 2014 19:38:48 +0000"  >&lt;p&gt;The most colors in a colorspace is a DeviceN which has an implementation limit in Acrobat of 32 colors. I&apos;ve added a sanity check for the colors as follows:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;colors = &lt;span class=&quot;code-object&quot;&gt;Math&lt;/span&gt;.min(decodeParams.getInt(COSName.COLORS, 1), 32);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14085172" author="jira-bot" created="Mon, 4 Aug 2014 19:44:13 +0000"  >&lt;p&gt;Commit 1615744 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jahewson&quot; class=&quot;user-hover&quot; rel=&quot;jahewson&quot;&gt;jahewson&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1615744&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1615744&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-1268&quot; title=&quot;OutOfMemory Error because of huge colors&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-1268&quot;&gt;&lt;del&gt;PDFBOX-1268&lt;/del&gt;&lt;/a&gt;: OutOfMemory Error because of huge colors&lt;/p&gt;</comment>
                            <comment id="14085174" author="jira-bot" created="Mon, 4 Aug 2014 19:45:20 +0000"  >&lt;p&gt;Commit 1615745 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jahewson&quot; class=&quot;user-hover&quot; rel=&quot;jahewson&quot;&gt;jahewson&lt;/a&gt; in branch &apos;pdfbox/branches/1.8&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1615745&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1615745&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-1268&quot; title=&quot;OutOfMemory Error because of huge colors&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-1268&quot;&gt;&lt;del&gt;PDFBOX-1268&lt;/del&gt;&lt;/a&gt;: OutOfMemory Error because of huge colors&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12519910" name="CVE-2009-3957 PDF 2009-09-21_RANDInfo.pdf" size="104165" author="cvandeplas" created="Mon, 26 Mar 2012 06:19:18 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>233161</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 15 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i14tpz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>236280</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>