<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:04:27 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PDFBOX-3540] Trailer Syntax error, ID is different in the first and the last trailer - for PDF with incremental updates</title>
                <link>https://issues.apache.org/jira/browse/PDFBOX-3540</link>
                <project id="12310760" key="PDFBOX">PDFBox</project>
                    <description>&lt;p&gt;As reported at the users mailing list:&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;Hello guys,&lt;/p&gt;

&lt;p&gt;I have the following problem using apache.pdfbox when validating a valid PDF/A-1 file, which is being signed twice:&lt;br/&gt;
1. The online validator confirms that the file is valid (&lt;a href=&quot;https://www.pdf-tools.com/pdf/validate-pdfa-online.aspx&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://www.pdf-tools.com/pdf/validate-pdfa-online.aspx&lt;/a&gt;)&lt;br/&gt;
2. But when I validate it using the following code:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;PreflightParser parser = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; PreflightParser(byteDatasource);
parser.parse();
PreflightDocument document = parser.getPreflightDocument();
document.validate();
result = document.getResult();
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;3. The file is linearized&lt;br/&gt;
4. I get that the file is invalid and the error description reads:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Trailer Syntax error, ID is different in the first and the last trailer&amp;lt;/i&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;According to issues &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3256&quot; title=&quot; Trailer Validation error PDF/A1-b&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3256&quot;&gt;&lt;del&gt;PDFBOX-3256&lt;/del&gt;&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2502&quot; title=&quot;false negative? 1.4.6 : Trailer Syntax error, ID is different in the first and the last trailer&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2502&quot;&gt;&lt;del&gt;PDFBOX-2502&lt;/del&gt;&lt;/a&gt; this should be fixed?&lt;/p&gt;

&lt;p&gt;Could anyone give me a tip how to go around this problem or would that be a bug?&lt;br/&gt;
The pdf file is attached.&lt;/p&gt;
&lt;hr /&gt;


&lt;p&gt;&lt;b&gt;Analysis:&lt;/b&gt;&lt;br/&gt;
The original PDF is linearized with a subsequent incremental update.&lt;br/&gt;
According to ISO 32000-1 F1&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Incremental update shall still be permitted, but the resulting PDF is no longer linearized and subsequently shall be treated as ordinary PDF. Linearizing it again may require reprocessing the entire file; see G.7, &quot;Accessing an Updated File&quot; for details.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;as the file shall no longer be treated as linearized the provision about matching  ID&apos;s as outlined in &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2502&quot; title=&quot;false negative? 1.4.6 : Trailer Syntax error, ID is different in the first and the last trailer&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2502&quot;&gt;&lt;del&gt;PDFBOX-2502&lt;/del&gt;&lt;/a&gt; no longer applies.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13014470">PDFBOX-3540</key>
            <summary>Trailer Syntax error, ID is different in the first and the last trailer - for PDF with incremental updates</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tilman">Tilman Hausherr</assignee>
                                    <reporter username="msahyoun">Maruan Sahyoun</reporter>
                        <labels>
                    </labels>
                <created>Sat, 22 Oct 2016 07:18:17 +0000</created>
                <updated>Sat, 25 Mar 2017 18:12:52 +0000</updated>
                            <resolved>Sat, 22 Oct 2016 17:13:46 +0000</resolved>
                                    <version>1.8.12</version>
                    <version>2.0.3</version>
                                    <fixVersion>2.0.4</fixVersion>
                    <fixVersion>3.0.0 PDFBox</fixVersion>
                                    <component>Preflight</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="15597824" author="tilman" created="Sat, 22 Oct 2016 13:05:00 +0000"  >&lt;p&gt;Proposed change: linearized PDFs have two trailers. Adding this check results in the users file being considered to be valid. However now the Bavaria test results are different: the file Pardes13_Rez02.pdf is now considered to be correct. Previously it was incorrect. This is an &quot;unclear&quot; file:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&amp;lt;TestCase name=&lt;span class=&quot;code-quote&quot;&gt;&apos;Pardes13_Rez02&apos;&lt;/span&gt; path=&lt;span class=&quot;code-quote&quot;&gt;&apos;unclear/Pardes13_Rez02.pdf&apos;&lt;/span&gt; expectedMessage=&lt;span class=&quot;code-quote&quot;&gt;&apos;&apos; expectedConformance=&apos;&lt;/span&gt;no&apos;&amp;gt;
	&amp;lt;Comment&amp;gt;Unclear: Linearized PDF: ID in first page and last trailer are different&amp;lt;/Comment&amp;gt;
	&amp;lt;Comment&amp;gt;Acrobat 9 does not treat the document as linearized&amp;lt;/Comment&amp;gt;
	&amp;lt;Comment&amp;gt;PDFlib opinion: the &lt;span class=&quot;code-quote&quot;&gt;&quot;same ID&quot;&lt;/span&gt; requirement should be applied even &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; the PDF tries to be linearized, not only &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; Acrobat actually treats it as linearized&amp;lt;/Comment&amp;gt;
&amp;lt;/TestCase&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;PDF Tools does not consider it to be valid, but for a different reason, &quot;A number value is larger than 2^15-1.&quot;.&lt;/p&gt;</comment>
                            <comment id="15597845" author="tilman" created="Sat, 22 Oct 2016 13:18:08 +0000"  >&lt;p&gt;VeraPDF 0.24.2 is also considering the user file to be valid, and the Pardes file to be invalid because of the number value. (Which PDFBox doesn&apos;t check)&lt;/p&gt;</comment>
                            <comment id="15598038" author="mayaangelova" created="Sat, 22 Oct 2016 15:39:00 +0000"  >&lt;p&gt;These are the used files.&lt;br/&gt;
&lt;em&gt;test_signed_twice&lt;/em&gt; caused the problem described&lt;/p&gt;</comment>
                            <comment id="15598048" author="msahyoun" created="Sat, 22 Oct 2016 15:46:14 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; thanks for handling that. I&apos;d say let&apos;s close that issue. WRT to the number I&apos;d need to check with the spec - we should deal with that in a separate issue if necessary. Acrobat treats that file as valid.&lt;/p&gt;</comment>
                            <comment id="15598057" author="tilman" created="Sat, 22 Oct 2016 15:52:12 +0000"  >&lt;p&gt;Do you mean I should make the change or should not? What I meant to do was to make a small change in preflight, that the special check for IDs is only done if linearized files have 2 trailers. The spec has this: &lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;These groups of objects shall be indexed by exactly two cross-reference table sections&lt;/p&gt;&lt;/blockquote&gt;</comment>
                            <comment id="15598122" author="msahyoun" created="Sat, 22 Oct 2016 16:41:01 +0000"  >&lt;p&gt;Yes - please do the change. Another (additional) check might be to check the length parameter of the linearization dict and compare with the file size.&lt;/p&gt;</comment>
                            <comment id="15598160" author="jira-bot" created="Sat, 22 Oct 2016 17:09:16 +0000"  >&lt;p&gt;Commit 1766217 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1766217&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1766217&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3540&quot; title=&quot;Trailer Syntax error, ID is different in the first and the last trailer - for PDF with incremental updates&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3540&quot;&gt;&lt;del&gt;PDFBOX-3540&lt;/del&gt;&lt;/a&gt;: linearized files have 2 trailers&lt;/p&gt;</comment>
                            <comment id="15598161" author="jira-bot" created="Sat, 22 Oct 2016 17:09:22 +0000"  >&lt;p&gt;Commit 1766218 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1766218&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1766218&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3540&quot; title=&quot;Trailer Syntax error, ID is different in the first and the last trailer - for PDF with incremental updates&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3540&quot;&gt;&lt;del&gt;PDFBOX-3540&lt;/del&gt;&lt;/a&gt;: linearized files have 2 trailers&lt;/p&gt;</comment>
                            <comment id="15598165" author="tilman" created="Sat, 22 Oct 2016 17:11:30 +0000"  >&lt;p&gt;Thanks for the hint about the length. I won&apos;t do it this time because I don&apos;t have an easy acccess to it. Maybe later if needed.&lt;/p&gt;</comment>
                            <comment id="15598170" author="tilman" created="Sat, 22 Oct 2016 17:13:46 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mayaangelova&quot; class=&quot;user-hover&quot; rel=&quot;mayaangelova&quot;&gt;mayaangelova&lt;/a&gt; this solves the problem you reported (thank you). You can find a new jar file here soon:&lt;br/&gt;
&lt;a href=&quot;https://repository.apache.org/content/groups/snapshots/org/apache/pdfbox/preflight/2.0.4-SNAPSHOT/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://repository.apache.org/content/groups/snapshots/org/apache/pdfbox/preflight/2.0.4-SNAPSHOT/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15598172" author="jira-bot" created="Sat, 22 Oct 2016 17:15:22 +0000"  >&lt;p&gt;Commit 1766219 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1766219&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1766219&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3540&quot; title=&quot;Trailer Syntax error, ID is different in the first and the last trailer - for PDF with incremental updates&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3540&quot;&gt;&lt;del&gt;PDFBOX-3540&lt;/del&gt;&lt;/a&gt;: clarify comment&lt;/p&gt;</comment>
                            <comment id="15598173" author="jira-bot" created="Sat, 22 Oct 2016 17:15:27 +0000"  >&lt;p&gt;Commit 1766220 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1766220&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1766220&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3540&quot; title=&quot;Trailer Syntax error, ID is different in the first and the last trailer - for PDF with incremental updates&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3540&quot;&gt;&lt;del&gt;PDFBOX-3540&lt;/del&gt;&lt;/a&gt;: clarify comment&lt;/p&gt;</comment>
                            <comment id="15599267" author="msahyoun" created="Sun, 23 Oct 2016 07:43:06 +0000"  >&lt;p&gt;I&apos;ve added &lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3541&quot; title=&quot;Use /L entry to determine if a linearized file shall be treated as such for PDF/A validation&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3541&quot;&gt;&lt;del&gt;PDFBOX-3541&lt;/del&gt;&lt;/a&gt; to track that - will try to get to it later.&lt;/p&gt;</comment>
                            <comment id="15599285" author="msahyoun" created="Sun, 23 Oct 2016 07:53:14 +0000"  >&lt;p&gt;I&apos;m currently unable where the provision of the number value is coming from. The PDF 1.4 spec has a limit of 2^31-1 for integer numbers. Will have a chat about that with some other vendors.&lt;/p&gt;</comment>
                            <comment id="15604620" author="mayaangelova" created="Tue, 25 Oct 2016 08:22:40 +0000"  >&lt;p&gt;Thank you all for your feedback and the quick fix! &lt;br/&gt;
All the best,&lt;br/&gt;
Maya&lt;/p&gt;</comment>
                            <comment id="15605319" author="mayaangelova" created="Tue, 25 Oct 2016 13:27:57 +0000"  >&lt;p&gt;Hello guys.&lt;br/&gt;
I downloaded the artifact: preflight-2.0.4-20161022.181605-85.jar.&lt;br/&gt;
When using it, I got two errors with the same file (testfile_signed_twice.pdf):&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;&quot;/XRef cross reference streams are not allowed&quot; with error code 1.4&lt;br/&gt;
and&lt;/li&gt;
	&lt;li&gt;Error on MetaData with error code 7.11.2&lt;br/&gt;
Does this make sense? Could you give me some tips or is this a further bug&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15605753" author="tilman" created="Tue, 25 Oct 2016 16:21:50 +0000"  >&lt;p&gt;Are you sure you tested the correct input file? I&apos;m asking because the &quot;twice&quot; file does not have /XRef streams.&lt;/p&gt;

&lt;p&gt;Last weekend I tested your file with the trunk, so to be sure I just retested it with 2.0.4 by downloading the preflight app at&lt;br/&gt;
&lt;a href=&quot;https://repository.apache.org/content/groups/snapshots/org/apache/pdfbox/preflight-app/2.0.4-SNAPSHOT/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://repository.apache.org/content/groups/snapshots/org/apache/pdfbox/preflight-app/2.0.4-SNAPSHOT/&lt;/a&gt;&lt;br/&gt;
and got the output &quot;the file testfile_signed_twice.pdf is a valid PDF/A-1b file&quot;.&lt;/p&gt;</comment>
                            <comment id="15605776" author="tilman" created="Tue, 25 Oct 2016 16:31:12 +0000"  >&lt;p&gt;To be REALLY sure I did it the hard way: besides the mentioned file, I also downloaded the snapshots of pdfbox, fontbox, xmpbox and also added commons-log. The code is:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;        PreflightParser parser = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; PreflightParser(&lt;span class=&quot;code-quote&quot;&gt;&quot;.......\\testfile_signed_twice.pdf&quot;&lt;/span&gt;);
        parser.parse();
        PreflightDocument document = parser.getPreflightDocument();
        document.validate();
        ValidationResult result = document.getResult();
        &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(result.isValid());
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The output is&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;true&lt;/p&gt;&lt;/blockquote&gt;</comment>
                            <comment id="15607765" author="mayaangelova" created="Wed, 26 Oct 2016 07:45:54 +0000"  >&lt;p&gt;Well, I have the file as an attachment in a mail, my tests extract the attachment, and thereafter perform the validation... I&apos;ll be able to look into it in a few hours and write the result here. Thank you for your effort!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12834808" name="Pardes13_Rez02.pdf" size="141781" author="tilman" created="Sat, 22 Oct 2016 13:01:49 +0000"/>
                            <attachment id="12834812" name="testfile_original.pdf" size="20416" author="mayaangelova" created="Sat, 22 Oct 2016 15:39:00 +0000"/>
                            <attachment id="12834813" name="testfile_signed_once.pdf" size="87194" author="mayaangelova" created="Sat, 22 Oct 2016 15:39:00 +0000"/>
                            <attachment id="12834814" name="testfile_signed_twice.pdf" size="97457" author="mayaangelova" created="Sat, 22 Oct 2016 15:39:00 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 3 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i35993:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>