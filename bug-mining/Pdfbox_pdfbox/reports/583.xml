<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 20:56:20 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PDFBOX-1872] PDMetadata.exportXMPMetadata fails when Metadata has encrypted stream</title>
                <link>https://issues.apache.org/jira/browse/PDFBOX-1872</link>
                <project id="12310760" key="PDFBOX">PDFBox</project>
                    <description>&lt;p&gt;When the Metadata is encoded with the Crypt filter, exportMetadata() fails to parse the XML. My guess is that PDDocumentCatalog.getMetadata() gives PDMetadata the raw stream, instead of the filtered one. Then PDMetadata.exportXMPMetadata() calls XMPMetadata.load(), which cannot parse the encrypted stream.  &lt;br/&gt;
While I cannot post the document (proprietary), the outline shown by PDFDebugger goes like this:&lt;br/&gt;
Root:Dictionary(Catalog)&lt;br/&gt;
+ AcroForm:Dictionary&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Metadata:Stream(Metadata:XML)&lt;/li&gt;
	&lt;li&gt;Filter:Array&lt;br/&gt;
     o &lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt; Crypt&lt;br/&gt;
  o Length:6302&lt;br/&gt;
  o Subtype:XML&lt;br/&gt;
  o Type:Metadata&lt;/li&gt;
&lt;/ul&gt;

</description>
                <environment>Not sure it matters, but Solaris (SunOS 5.10), java 1.6.0_19,</environment>
        <key id="12692395">PDFBOX-1872</key>
            <summary>PDMetadata.exportXMPMetadata fails when Metadata has encrypted stream</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="lehmi">Andreas Lehmk&#252;hler</assignee>
                                    <reporter username="brzrkr">Pat Hickey</reporter>
                        <labels>
                    </labels>
                <created>Thu, 30 Jan 2014 22:23:14 +0000</created>
                <updated>Fri, 19 Sep 2014 14:40:41 +0000</updated>
                            <resolved>Sat, 28 Jun 2014 11:48:04 +0000</resolved>
                                    <version>1.8.3</version>
                                    <fixVersion>1.8.7</fixVersion>
                    <fixVersion>2.0.0</fixVersion>
                                    <component>JempBox</component>
                    <component>PDModel</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="14040961" author="lehmi" created="Mon, 23 Jun 2014 16:56:59 +0000"  >&lt;p&gt;The &quot;trick&quot; is to check wether a pdf is encrypted and decrypt it before accessing the data. It&apos;s used in many tools and examples provided by PDFBox, e.g. &lt;a href=&quot;http://svn.apache.org/viewvc/pdfbox/trunk/examples/src/main/java/org/apache/pdfbox/examples/pdmodel/ExtractMetadata.java?view=markup&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;ExtractMetadata&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14042137" author="brzrk1@gmail.com" created="Tue, 24 Jun 2014 14:05:26 +0000"  >&lt;p&gt;Just so you&apos;ll know, the document was already decrypted.&lt;br/&gt;
Perhaps recent changes in the depth of the decryption process have fixed&lt;br/&gt;
this?&lt;/p&gt;


&lt;p&gt;On Mon, Jun 23, 2014 at 12:57 PM, Andreas Lehmk&#252;hler (JIRA) &amp;lt;jira@apache.org&lt;/p&gt;
</comment>
                            <comment id="14042269" author="lehmi" created="Tue, 24 Jun 2014 15:48:19 +0000"  >&lt;p&gt;As we didn&apos;t have any sample pdf I was just guessing. Why do you ask? Do you have a similar issue?&lt;/p&gt;</comment>
                            <comment id="14042315" author="brzrkr" created="Tue, 24 Jun 2014 16:18:23 +0000"  >&lt;p&gt;Sorry, I replied from my mailer. It was I who opened the issue in the first place. I know that the document was decrypted before an attempt was made to fetch the MetaData.  I&apos;ll see if I can find a public example...&lt;/p&gt;</comment>
                            <comment id="14042364" author="lehmi" created="Tue, 24 Jun 2014 17:00:23 +0000"  >&lt;p&gt;If you open the pdf in question with the PDFDebugger, do you see some additional values for the crypt filter?&lt;/p&gt;</comment>
                            <comment id="14042550" author="brzrkr" created="Tue, 24 Jun 2014 19:15:10 +0000"  >&lt;p&gt;The structure is as described in the (edited) first message&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(folder icon) Metadata:Stream(Metadata:XML)
	&lt;ul&gt;
		&lt;li&gt;(folder icon) Filter:Array
		&lt;ul&gt;
			&lt;li&gt;(bullet icon) [0]Crypt&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
		&lt;li&gt;(bullet icon) Length:6302&lt;/li&gt;
		&lt;li&gt;(bullet icon) Subtype: XML&lt;/li&gt;
		&lt;li&gt;(bullet icon) Type:Metadata&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;The output document (of a simple load/decrypt/write program) has the same structure, with encrypted metadata.&lt;br/&gt;
I found a public reference to the PDF, although it appears to be a later edit.&lt;br/&gt;
It exhibits the same behavior though.&lt;br/&gt;
&lt;a href=&quot;https://www.dpdhl.com/content/dam/Investors/Events/Reporting/2013/DPDHL_Annual_Report_2012.pdf&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://www.dpdhl.com/content/dam/Investors/Events/Reporting/2013/DPDHL_Annual_Report_2012.pdf&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14046825" author="lehmi" created="Sat, 28 Jun 2014 11:48:04 +0000"  >&lt;p&gt;The issue was that the metadata is &lt;b&gt;not&lt;/b&gt; encrypted and pdfbox doesn&apos;t care about that and decrypts the metadata stream which led to scrambled data.&lt;/p&gt;

&lt;p&gt;I&apos;ve fixed the issue in revisions &lt;a href=&quot;http://svn.apache.org/r1606319&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/r1606319&lt;/a&gt; (trunk) and &lt;a href=&quot;http://svn.apache.org/r1606321&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/r1606321&lt;/a&gt; (1.8 branch)&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=brzrkr&quot; class=&quot;user-hover&quot; rel=&quot;brzrkr&quot;&gt;brzrkr&lt;/a&gt; Thanks for the patient and for insisting when I closed the issue some time ago.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>370990</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 21 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1rxsv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>371295</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>