<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:06:01 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PDFBOX-3795] PDFMergeUtility error invalid stored block lengths</title>
                <link>https://issues.apache.org/jira/browse/PDFBOX-3795</link>
                <project id="12310760" key="PDFBOX">PDFBox</project>
                    <description>&lt;p&gt;PDFMergeUtility fails with a DataFormatException when trying to merge PDF documents.&lt;/p&gt;

&lt;p&gt;Caused by: java.util.zip.DataFormatException: invalid stored block lengths&lt;/p&gt;

&lt;p&gt;I have attached 3 PDF documents&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;pdf-01.pdf&lt;/li&gt;
	&lt;li&gt;pdf-02.pdf&lt;/li&gt;
	&lt;li&gt;pdf-03.pdf&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;The first two PDF documents are good. They can be merged. In fact they were used to create the third document (pdf-03.pdf).&lt;/p&gt;

&lt;p&gt;When trying to merge another PDF with the third document, the PDF merge utility throws the error.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13072995">PDFBOX-3795</key>
            <summary>PDFMergeUtility error invalid stored block lengths</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tilman">Tilman Hausherr</assignee>
                                    <reporter username="julian.cowan@ipaustralia.gov.au">Julian Cowan</reporter>
                        <labels>
                            <label>metadata</label>
                            <label>xmp</label>
                    </labels>
                <created>Thu, 18 May 2017 03:14:31 +0000</created>
                <updated>Fri, 21 Jul 2017 04:40:14 +0000</updated>
                            <resolved>Sat, 20 May 2017 15:57:18 +0000</resolved>
                                    <version>1.8.13</version>
                    <version>2.0.6</version>
                                    <fixVersion>2.0.7</fixVersion>
                    <fixVersion>3.0.0 PDFBox</fixVersion>
                                    <component>Utilities</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="16016348" author="tilman" created="Thu, 18 May 2017 19:48:23 +0000"  >&lt;p&gt;The destination file has non compressed metadata content, but has Flate filter assigned.&lt;/p&gt;

&lt;p&gt;The source files have compressed metadata. This is unusual but not forbidden. This line&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;newStream.getCOSObject().mergeInto(srcMetadata);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;transfers all attributes, including the filter. That is bad.&lt;/p&gt;</comment>
                            <comment id="16016375" author="jira-bot" created="Thu, 18 May 2017 20:06:33 +0000"  >&lt;p&gt;Commit 1795555 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1795555&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1795555&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3795&quot; title=&quot;PDFMergeUtility error invalid stored block lengths&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3795&quot;&gt;&lt;del&gt;PDFBOX-3795&lt;/del&gt;&lt;/a&gt;: remove filter copied by mergeInto&lt;/p&gt;</comment>
                            <comment id="16016376" author="jira-bot" created="Thu, 18 May 2017 20:06:37 +0000"  >&lt;p&gt;Commit 1795556 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1795556&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1795556&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3795&quot; title=&quot;PDFMergeUtility error invalid stored block lengths&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3795&quot;&gt;&lt;del&gt;PDFBOX-3795&lt;/del&gt;&lt;/a&gt;: remove filter copied by mergeInto&lt;/p&gt;</comment>
                            <comment id="16016391" author="tilman" created="Thu, 18 May 2017 20:12:25 +0000"  >&lt;p&gt;This fixes the bug, which has existed at least since 2008. I&apos;ll do more tomorrow. My current idea is to deprecate &lt;tt&gt;mergeInto&lt;/tt&gt; and remove it in 3.0, and do something local instead. It is used only for merging and the usage for a COSStream is dangerous.&lt;/p&gt;

&lt;p&gt;To repair existing &lt;b&gt;result&lt;/b&gt; files merged this way - just get the metadata object, then do this:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;document.getDocumentCatalog().getMetadata().getCOSObject().removeItem(COSName.FILTER);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="16017032" author="jira-bot" created="Fri, 19 May 2017 07:56:55 +0000"  >&lt;p&gt;Commit 1795589 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/branches/1.8&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1795589&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1795589&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3795&quot; title=&quot;PDFMergeUtility error invalid stored block lengths&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3795&quot;&gt;&lt;del&gt;PDFBOX-3795&lt;/del&gt;&lt;/a&gt;: remove filter copied by mergeInto&lt;/p&gt;</comment>
                            <comment id="16018501" author="jira-bot" created="Sat, 20 May 2017 15:30:04 +0000"  >&lt;p&gt;Commit 1795663 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1795663&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1795663&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3795&quot; title=&quot;PDFMergeUtility error invalid stored block lengths&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3795&quot;&gt;&lt;del&gt;PDFBOX-3795&lt;/del&gt;&lt;/a&gt;: deprecate/remove mergeInto due to problems&lt;/p&gt;</comment>
                            <comment id="16018502" author="jira-bot" created="Sat, 20 May 2017 15:30:10 +0000"  >&lt;p&gt;Commit 1795665 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1795665&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1795665&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3795&quot; title=&quot;PDFMergeUtility error invalid stored block lengths&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3795&quot;&gt;&lt;del&gt;PDFBOX-3795&lt;/del&gt;&lt;/a&gt;: deprecate/remove mergeInto due to problems&lt;/p&gt;</comment>
                            <comment id="16018503" author="jira-bot" created="Sat, 20 May 2017 15:30:14 +0000"  >&lt;p&gt;Commit 1795666 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/branches/1.8&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1795666&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1795666&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3795&quot; title=&quot;PDFMergeUtility error invalid stored block lengths&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3795&quot;&gt;&lt;del&gt;PDFBOX-3795&lt;/del&gt;&lt;/a&gt;: deprecate/remove mergeInto due to problems&lt;/p&gt;</comment>
                            <comment id="16018504" author="jira-bot" created="Sat, 20 May 2017 15:30:54 +0000"  >&lt;p&gt;Commit 1795668 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1795668&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1795668&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3795&quot; title=&quot;PDFMergeUtility error invalid stored block lengths&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3795&quot;&gt;&lt;del&gt;PDFBOX-3795&lt;/del&gt;&lt;/a&gt;: use private mergeInto instead of deprecated method&lt;/p&gt;</comment>
                            <comment id="16018506" author="jira-bot" created="Sat, 20 May 2017 15:31:23 +0000"  >&lt;p&gt;Commit 1795669 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1795669&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1795669&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3795&quot; title=&quot;PDFMergeUtility error invalid stored block lengths&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3795&quot;&gt;&lt;del&gt;PDFBOX-3795&lt;/del&gt;&lt;/a&gt;: use private mergeInto instead of deprecated method&lt;/p&gt;</comment>
                            <comment id="16018521" author="tilman" created="Sat, 20 May 2017 15:57:18 +0000"  >&lt;p&gt;You can and should test with a snapshot here:&lt;br/&gt;
&lt;a href=&quot;https://repository.apache.org/content/groups/snapshots/org/apache/pdfbox/pdfbox-app/2.0.7-SNAPSHOT/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://repository.apache.org/content/groups/snapshots/org/apache/pdfbox/pdfbox-app/2.0.7-SNAPSHOT/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Thanks for reporting the bug!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12868669" name="pdf-01.pdf" size="259311" author="julian.cowan@ipaustralia.gov.au" created="Thu, 18 May 2017 03:14:31 +0000"/>
                            <attachment id="12868670" name="pdf-02.pdf" size="339360" author="julian.cowan@ipaustralia.gov.au" created="Thu, 18 May 2017 03:14:31 +0000"/>
                            <attachment id="12868671" name="pdf-03.pdf" size="510503" author="julian.cowan@ipaustralia.gov.au" created="Thu, 18 May 2017 03:14:31 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 26 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3f5bz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>