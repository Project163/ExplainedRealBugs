<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:07:18 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[PDFBOX-3631] Signature interoperability issue / visible signature not visible on some viewers</title>
                <link>https://issues.apache.org/jira/browse/PDFBOX-3631</link>
                <project id="12310760" key="PDFBOX">PDFBox</project>
                    <description>&lt;p&gt;Some files if signed with PDFBox produce not visible signature in chrome, pdfium foxit. &lt;/p&gt;

&lt;p&gt;If the same file is signed on some Actobat, Foxit or itext the signature is visible.&lt;/p&gt;

&lt;p&gt;The test fle are inserted in an encrypted zip. If possible I would like to communicate the password with a private message.&lt;/p&gt;
</description>
                <environment>Java 1.8 Windows.</environment>
        <key id="13028109">PDFBOX-3631</key>
            <summary>Signature interoperability issue / visible signature not visible on some viewers</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tilman">Tilman Hausherr</assignee>
                                    <reporter username="marcom1981@gmail.com">Marco Monacelli</reporter>
                        <labels>
                    </labels>
                <created>Wed, 14 Dec 2016 14:29:58 +0000</created>
                <updated>Thu, 21 Jun 2018 20:27:58 +0000</updated>
                            <resolved>Thu, 12 Apr 2018 16:58:49 +0000</resolved>
                                    <version>2.0.3</version>
                                    <fixVersion>2.0.10</fixVersion>
                    <fixVersion>3.0.0 PDFBox</fixVersion>
                                    <component>Signing</component>
                        <due></due>
                            <votes>8</votes>
                                    <watches>10</watches>
                                                                                                                <comments>
                            <comment id="15748475" author="marcom1981@gmail.com" created="Wed, 14 Dec 2016 14:34:04 +0000"  >&lt;p&gt;in.pdf The original file.&lt;br/&gt;
in_pdfbox_2.0.3.pdf Singned PDFBox.&lt;br/&gt;
in_acrobat.pdf Acrobat Signed.&lt;br/&gt;
in_foxit.pdf Foxit Signed.&lt;/p&gt;</comment>
                            <comment id="15749480" author="tilman" created="Wed, 14 Dec 2016 21:04:24 +0000"  >&lt;p&gt;Why not create a signed file from a public PDF?&lt;/p&gt;

&lt;p&gt;Did you create your signed PDF with the CreateVisibleSignature example, or in a different way?&lt;/p&gt;</comment>
                            <comment id="15750680" author="marcom1981@gmail.com" created="Thu, 15 Dec 2016 07:42:12 +0000"  >&lt;p&gt;unfortunately we can not reproduce the input file independently. However, I proceeded to put the zip in the clear in a link that then I will remove.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://drive.google.com/file/d/0B-qB8oXqKgqSeWZMUi00UmFiMUU/view?usp=sharing&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://drive.google.com/file/d/0B-qB8oXqKgqSeWZMUi00UmFiMUU/view?usp=sharing&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Good Job&lt;/p&gt;</comment>
                            <comment id="15750747" author="tilman" created="Thu, 15 Dec 2016 08:17:26 +0000"  >&lt;p&gt;I got the zip file. But I don&apos;t have &quot;chrome, pdfium foxit&quot; installed and I&apos;m not planning to install them.&lt;/p&gt;

&lt;p&gt;Can you please clarify in which of the files the signature can be viewed and which cannot? I would look with PDFDebugger if anything is weird. I assume you mean the &quot;visible&quot; part of the signature (an &quot;@&quot; seal), right?&lt;/p&gt;</comment>
                            <comment id="15750818" author="tilman" created="Thu, 15 Dec 2016 08:54:28 +0000"  >&lt;p&gt;Some pdf viewing products have difficulties showing annotations correctly (and there&apos;s a mistake in the PDF specification, a formula is wrong sided). Here&apos;s an issue in PDF.js. Try their file with the products you mentioned.&lt;br/&gt;
&lt;a href=&quot;https://github.com/mozilla/pdf.js/issues/4743&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/mozilla/pdf.js/issues/4743&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15750872" author="marcom1981@gmail.com" created="Thu, 15 Dec 2016 09:19:22 +0000"  >&lt;p&gt;The problem starts from the input file. Input file generated by the same procedure and signed with PDFBox produce sometimes other invisible visible signatures. In the attached PDF file if signed produces visible signatures and a PDF file that if signed produces invisible signatures.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://drive.google.com/file/d/0B-qB8oXqKgqSQmtKVWtxUzE0SjA/view?usp=sharing&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://drive.google.com/file/d/0B-qB8oXqKgqSQmtKVWtxUzE0SjA/view?usp=sharing&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;If sign the file with acrobat is always visible.&lt;/p&gt;</comment>
                            <comment id="15751025" author="tilman" created="Thu, 15 Dec 2016 10:30:28 +0000"  >&lt;p&gt;I can reproduce the effect by signing and viewing them on my android mobile phone with google drive pdf viewer. The OK file has the signature, the KO file hasn&apos;t. Very weird.&lt;/p&gt;

&lt;p&gt;Things I tried&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;set bbox in correct order - no&lt;/li&gt;
	&lt;li&gt;sign uncompressed file - no&lt;/li&gt;
	&lt;li&gt;sign uncompressed file with xref table instead of XRef stream - yes!&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;So it&apos;s something related to the XRef stream.&lt;/p&gt;

&lt;p&gt;Coincidentally, a competing java product has the same problem.&lt;/p&gt;</comment>
                            <comment id="15751114" author="marcom1981@gmail.com" created="Thu, 15 Dec 2016 11:22:18 +0000"  >&lt;p&gt;Why if signed with acrobat is always visible ?&lt;/p&gt;</comment>
                            <comment id="15751308" author="marcom1981@gmail.com" created="Thu, 15 Dec 2016 13:01:31 +0000"  >&lt;p&gt;Is Possible a mistake with DecodeParms ?&lt;/p&gt;</comment>
                            <comment id="15751336" author="tilman" created="Thu, 15 Dec 2016 13:13:28 +0000"  >&lt;p&gt;I don&apos;t know. Which of the files has been signed with Acrobat? Not in_acrobat.pdf - that one has a signature, but the original document cannot be separated from it, i.e. there was no incremental save.&lt;/p&gt;</comment>
                            <comment id="15751344" author="tilman" created="Thu, 15 Dec 2016 13:15:59 +0000"  >&lt;p&gt;I doubt this, DecodeParms is used a lot elsewhere without any trouble.&lt;/p&gt;</comment>
                            <comment id="15751393" author="marcom1981@gmail.com" created="Thu, 15 Dec 2016 13:37:51 +0000"  >&lt;p&gt;I produce incremental signature with other java library &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &quot;competing java product&quot;.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://drive.google.com/file/d/0B-qB8oXqKgqSWDVCcUx2ZjZWVjQ/view?usp=sharing&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://drive.google.com/file/d/0B-qB8oXqKgqSWDVCcUx2ZjZWVjQ/view?usp=sharing&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This file like acrobat always visible.&lt;/p&gt;
</comment>
                            <comment id="15751490" author="tilman" created="Thu, 15 Dec 2016 14:19:32 +0000"  >&lt;p&gt;Thanks for the itext file. I did find a possible clue. The problem file has its original page dictionary in an object stream (ObjStm, not to confuse with XRef stream). The pdfbox signing does not create any object streams, it just creates ordinary objects, but itext does so (object streams help making the file a bit smaller).&lt;/p&gt;

&lt;p&gt;So maybe some products are overwriting their internal entries with the outdated content of the ObjStm, despite that the updated object has already been read.&lt;/p&gt;

&lt;p&gt;IMHO what we do is not forbidden, i.e. just because an object was in an object stream before doesn&apos;t mean that its updated version must also be in an object stream.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=leonardr&quot; class=&quot;user-hover&quot; rel=&quot;leonardr&quot;&gt;leonardr&lt;/a&gt; can you give a comment on this? When doing an incremental update, it is required that an updated object be in an ObjStm if the original object was in an ObjStm ?&lt;/p&gt;</comment>
                            <comment id="15751585" author="tilman" created="Thu, 15 Dec 2016 15:02:19 +0000"  >&lt;p&gt;My theory might be wrong... I just tested with a file that has an ObjStm (&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-2398&quot; title=&quot;Image transparency lost when convert to an image&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-2398&quot;&gt;&lt;del&gt;PDFBOX-2398&lt;/del&gt;&lt;/a&gt;) but I did not have any trouble viewing the file with google pdf viewer.&lt;/p&gt;

&lt;p&gt;Btw ghostscript (a very high quality non java product) has no problem viewing the KO signed files.&lt;/p&gt;</comment>
                            <comment id="15754070" author="tilman" created="Fri, 16 Dec 2016 10:34:10 +0000"  >&lt;p&gt;List of products, yes means that they display correctly:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;pdfbox: yes&lt;/li&gt;
	&lt;li&gt;jp*d*l: yes&lt;/li&gt;
	&lt;li&gt;i**pdf: no&lt;/li&gt;
	&lt;li&gt;android google pdf viewer: no&lt;/li&gt;
	&lt;li&gt;polaris viewer: yes&lt;/li&gt;
	&lt;li&gt;dropbox viewer: yes&lt;/li&gt;
	&lt;li&gt;ghostscript: yes&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="16369701" author="mkrens" created="Tue, 20 Feb 2018 04:06:54 +0000"  >&lt;p&gt;We just hit this issue and will also try to find the root issue here. Here also a file signed with pdfbox that fails. The file contains 5 signatures but only 1 is shown.&#160;&lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12911180/12911180_test_out_pdf.pdf&quot; title=&quot;test_out_pdf.pdf attached to PDFBOX-3631&quot;&gt;test_out_pdf.pdf&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;. Here the same file signed with a different product.&#160;&lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12911194/12911194_working_pdf_with_signatures.pdf&quot; title=&quot;working_pdf_with_signatures.pdf attached to PDFBOX-3631&quot;&gt;working_pdf_with_signatures.pdf&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;IMHO&#160;not a &apos;minor&apos; issue as chrome by default opens downloaded pdf&apos;s in the browser.&lt;/p&gt;</comment>
                            <comment id="16369736" author="mkrens" created="Tue, 20 Feb 2018 05:29:56 +0000"  >&lt;p&gt;I&apos;ve done some testing in various browsers / readers. Here the screenshots:&lt;/p&gt;

&lt;p&gt;chrome_rendering_incorrect.png:&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/12911189/12911189_chrome_rendering_incorrect.png&quot; height=&quot;309&quot; width=&quot;487&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;acrobat_rendering_correct.png:&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/12911190/12911190_acrobat_rendering_correct.png&quot; height=&quot;362&quot; width=&quot;569&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;libreoffice_rendering_correct.png:&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/12911186/12911186_libreoffice_rendering_correct.png&quot; height=&quot;307&quot; width=&quot;499&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;Microsoft_Edge_on_Windows_10_rendering_correct.png:&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/12911185/12911185_Microsoft_Edge_on_Windows_10_rendering_correct.png&quot; height=&quot;386&quot; width=&quot;512&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;preview_of_Preview_rendering_correct.png:&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/12911192/12911192_preview_of_Preview_rendering_correct.png&quot; height=&quot;407&quot; width=&quot;552&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;Preview_rendering_not_correct.png:&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/12911191/12911191_Preview_rendering_not_correct.png&quot; height=&quot;449&quot; width=&quot;591&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;This pdf is always rendering correct in the above cases: &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12911194/12911194_working_pdf_with_signatures.pdf&quot; title=&quot;working_pdf_with_signatures.pdf attached to PDFBOX-3631&quot;&gt;working_pdf_with_signatures.pdf&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;This pdf is signed with PDFBox and used for the screenshots: &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12911193/12911193_not_working_pdf_with_signatures.pdf&quot; title=&quot;not_working_pdf_with_signatures.pdf attached to PDFBOX-3631&quot;&gt;not_working_pdf_with_signatures.pdf&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;Note that the Preview issue might be a different one but as the other file also works in Preview this might be related.&lt;br/&gt;
 It looks like this is related the Preview issue: &lt;a href=&quot;http://www.openradar.me/34276970&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.openradar.me/34276970&lt;/a&gt; (in which case it also might be related to this issue somehow).&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="16369759" author="tilman" created="Tue, 20 Feb 2018 06:31:45 +0000"  >&lt;p&gt;Could you try signing the files with the 2.0.9 snapshot? I wonder if the problem is related to&#160;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-4011&quot; title=&quot;BBox in signature forms has wrong order&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-4011&quot;&gt;&lt;del&gt;PDFBOX-4011&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://repository.apache.org/content/groups/snapshots/org/apache/pdfbox/pdfbox-app/2.0.9-SNAPSHOT/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://repository.apache.org/content/groups/snapshots/org/apache/pdfbox/pdfbox-app/2.0.9-SNAPSHOT/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16369771" author="mkrens" created="Tue, 20 Feb 2018 07:21:16 +0000"  >&lt;p&gt;Done, same result unfortunately.&lt;/p&gt;</comment>
                            <comment id="16369894" author="mkrens" created="Tue, 20 Feb 2018 10:19:29 +0000"  >&lt;p&gt;For completeness, here 2 chromium related issues:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://bugs.chromium.org/p/chromium/issues/detail?id=52404&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://bugs.chromium.org/p/chromium/issues/detail?id=52404&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;and&#160;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://bugs.chromium.org/p/pdfium/issues/detail?id=643&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://bugs.chromium.org/p/pdfium/issues/detail?id=643&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="16369920" author="mato7d5" created="Tue, 20 Feb 2018 10:50:05 +0000"  >&lt;p&gt;After adding /DA entry into signature fields, then Chrome correctly shows all signatures. This is strange, because specifacation says the renderer should ignore /DA when rendering appearance stream.&lt;/p&gt;</comment>
                            <comment id="16370457" author="tilman" created="Tue, 20 Feb 2018 18:59:37 +0000"  >&lt;p&gt;But the &quot;good&quot; files didn&apos;t have any /DA entry either??? And yes, the /DA entry is absolutely irrelevant for signatures.&lt;/p&gt;</comment>
                            <comment id="16370483" author="mato7d5" created="Tue, 20 Feb 2018 19:16:27 +0000"  >&lt;p&gt;It seems that was our mistake with /DA. It&apos;s weird, because after adding /DA the signatures appeared in Chrome. Now it doesn&apos;t. So idea about /DA can be ignored.&lt;/p&gt;</comment>
                            <comment id="16371139" author="mato7d5" created="Wed, 21 Feb 2018 09:27:12 +0000"  >&lt;p&gt;Further investigation showed that only linearized PDF has this problem. None linearized PDF is shown correctly in Chrome. I can see 2 possible solutions:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;cancel linearization flag when digital signature is applied&lt;/li&gt;
	&lt;li&gt;fix it in Chrome (but also other viewers has similar isssue (for example Master PDF Editor).&lt;/li&gt;
&lt;/ol&gt;
</comment>
                            <comment id="16371236" author="msahyoun" created="Wed, 21 Feb 2018 11:04:37 +0000"  >&lt;p&gt;linearization is not a flag but way to write the PDF so that initial content can be viewed quicker. &lt;/p&gt;</comment>
                            <comment id="16371273" author="mato7d5" created="Wed, 21 Feb 2018 11:44:10 +0000"  >&lt;p&gt;yes, I know. I had quick idea to change /Linearized flag from 1 to 0 (without any effect of course).&lt;/p&gt;

&lt;p&gt;According to this blog &lt;a href=&quot;http://bfo.com/blog/2008/07/17/linearized_pdf/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://bfo.com/blog/2008/07/17/linearized_pdf/&lt;/a&gt; -&amp;gt; &quot;PDFs with more than one digital signature cannot be linearized.&quot;&lt;/p&gt;</comment>
                            <comment id="16415989" author="tilman" created="Tue, 27 Mar 2018 17:43:31 +0000"  >&lt;p&gt;Thanks to Gabriel Madeira Pessoa in the user mailing list&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://mail-archives.apache.org/mod_mbox/pdfbox-users/201803.mbox/%3Cbc1eac6441555f3c6f39b5dd8c2f259a%40bry.com.br%3E&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://mail-archives.apache.org/mod_mbox/pdfbox-users/201803.mbox/%3Cbc1eac6441555f3c6f39b5dd8c2f259a%40bry.com.br%3E&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;the problem may be solved soon. The cause is that the object number of the XRef stream is reused by a different object in the incremental part.&lt;/p&gt;

&lt;p&gt;We don&apos;t store the object number of the XRef stream. (COSParser.parseXrefObjStream()). This makes sense because this is recreated when doing a classic save. &lt;/p&gt;

&lt;p&gt;My first thought was to add 1 to the highest number, but this doesn&apos;t work because there is no guarantee that the object number of the XRef stream is the highest. (Seen in 007087-payment-due-p1_reduced_bc0.pdf) &lt;/p&gt;

&lt;p&gt;Analyzing the last trailer (/Index and /Size) doesn&apos;t help either, it is unclear which trailer is taken. &lt;/p&gt;

&lt;p&gt;So my current thought is to have COSParser.parseXrefObjStream() store the highest XRef object key number in the COSDocument object and check it later.&lt;/p&gt;</comment>
                            <comment id="16416114" author="jira-bot" created="Tue, 27 Mar 2018 19:22:41 +0000"  >&lt;p&gt;Commit 1827856 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1827856&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1827856&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3631&quot; title=&quot;Signature interoperability issue / visible signature not visible on some viewers&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3631&quot;&gt;&lt;del&gt;PDFBOX-3631&lt;/del&gt;&lt;/a&gt;: remember the highest XRef stream object number for incremental saving to avoid reusing it&lt;/p&gt;</comment>
                            <comment id="16416115" author="jira-bot" created="Tue, 27 Mar 2018 19:22:49 +0000"  >&lt;p&gt;Commit 1827857 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tilman&quot; class=&quot;user-hover&quot; rel=&quot;tilman&quot;&gt;tilman&lt;/a&gt; in branch &apos;pdfbox/branches/2.0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1827857&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1827857&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PDFBOX-3631&quot; title=&quot;Signature interoperability issue / visible signature not visible on some viewers&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PDFBOX-3631&quot;&gt;&lt;del&gt;PDFBOX-3631&lt;/del&gt;&lt;/a&gt;: remember the highest XRef stream object number for incremental saving to avoid reusing it&lt;/p&gt;</comment>
                            <comment id="16416204" author="tilman" created="Tue, 27 Mar 2018 20:41:56 +0000"  >&lt;p&gt;&lt;a href=&quot;https://repository.apache.org/content/groups/snapshots/org/apache/pdfbox/pdfbox-app/2.0.10-SNAPSHOT/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://repository.apache.org/content/groups/snapshots/org/apache/pdfbox/pdfbox-app/2.0.10-SNAPSHOT/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Please test and tell whether the problem goes away.&lt;/p&gt;</comment>
                            <comment id="16420457" author="marcom1981@gmail.com" created="Fri, 30 Mar 2018 12:50:34 +0000"  >&lt;p&gt;Thanks, my team start testing next week.&lt;/p&gt;</comment>
                            <comment id="16432177" author="marcom1981@gmail.com" created="Tue, 10 Apr 2018 12:19:44 +0000"  >&lt;p&gt;My team has successfully completed the tests. For now there are no anomalies.&lt;/p&gt;</comment>
                            <comment id="16433853" author="mkrens" created="Wed, 11 Apr 2018 12:39:24 +0000"  >&lt;p&gt;Same here, it looks like this fixed the issues. Thanks!&lt;/p&gt;</comment>
                            <comment id="16435929" author="tilman" created="Thu, 12 Apr 2018 16:58:49 +0000"  >&lt;p&gt;Thanks for the feedback; setting to resolved. Thanks to Gabriel Madeira Pessoa who found the solution.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12911185" name="Microsoft_Edge_on_Windows_10_rendering_correct.png" size="81716" author="mkrens" created="Tue, 20 Feb 2018 05:16:02 +0000"/>
                            <attachment id="12843239" name="PDFBOX-3631.zip" size="457475" author="marcom1981@gmail.com" created="Wed, 14 Dec 2016 14:34:04 +0000"/>
                            <attachment id="12843377" name="PDFJS-4743-signature.pdf" size="21670" author="tilman" created="Thu, 15 Dec 2016 08:54:28 +0000"/>
                            <attachment id="12911191" name="Preview_rendering_not_correct.png" size="226701" author="mkrens" created="Tue, 20 Feb 2018 05:16:06 +0000"/>
                            <attachment id="12911190" name="acrobat_rendering_correct.png" size="324030" author="mkrens" created="Tue, 20 Feb 2018 05:16:04 +0000"/>
                            <attachment id="12911189" name="chrome_rendering_incorrect.png" size="167858" author="mkrens" created="Tue, 20 Feb 2018 05:16:04 +0000"/>
                            <attachment id="12911187" name="firefox_incorrect_but_expected.png" size="363285" author="mkrens" created="Tue, 20 Feb 2018 05:16:04 +0000"/>
                            <attachment id="12916437" name="itext-doc.pdf" size="880" author="tilman" created="Tue, 27 Mar 2018 18:34:25 +0000"/>
                            <attachment id="12916443" name="itext-doc_signed-bad.pdf" size="42330" author="tilman" created="Tue, 27 Mar 2018 18:50:16 +0000"/>
                            <attachment id="12916444" name="itext-doc_signed-good.pdf" size="42334" author="tilman" created="Tue, 27 Mar 2018 18:50:16 +0000"/>
                            <attachment id="12911186" name="libreoffice_rendering_correct.png" size="406805" author="mkrens" created="Tue, 20 Feb 2018 05:16:04 +0000"/>
                            <attachment id="12911193" name="not_working_pdf_with_signatures.pdf" size="186059" author="mkrens" created="Tue, 20 Feb 2018 05:16:07 +0000"/>
                            <attachment id="12911192" name="preview_of_Preview_rendering_correct.png" size="582301" author="mkrens" created="Tue, 20 Feb 2018 05:16:08 +0000"/>
                            <attachment id="12911188" name="safari_using_preview_incorrect.png" size="188278" author="mkrens" created="Tue, 20 Feb 2018 05:16:04 +0000"/>
                            <attachment id="12911180" name="test_out_pdf.pdf" size="186059" author="mkrens" created="Tue, 20 Feb 2018 04:01:22 +0000"/>
                            <attachment id="12911194" name="working_pdf_with_signatures.pdf" size="131221" author="mkrens" created="Tue, 20 Feb 2018 05:16:07 +0000"/>
                            <attachment id="12911181" name="working_pdf_with_signatures.pdf" size="131221" author="mkrens" created="Tue, 20 Feb 2018 04:06:32 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>17.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 31 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i37len:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>