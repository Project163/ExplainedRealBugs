diff --git a/pdfbox/src/main/java/org/apache/pdfbox/multipdf/PDFMergerUtility.java b/pdfbox/src/main/java/org/apache/pdfbox/multipdf/PDFMergerUtility.java
index 81e59b4532..347fb02478 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/multipdf/PDFMergerUtility.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/multipdf/PDFMergerUtility.java
@@ -1090,6 +1090,10 @@ public class PDFMergerUtility
             PDStructureTreeRoot srcStructTree,
             PDStructureTreeRoot destStructTree) throws IOException
     {
+        if (srcStructTree == null)
+        {
+            return;
+        }
         PDNameTreeNode<PDStructureElement> srcIDTree = srcStructTree.getIDTree();
         if (srcIDTree == null)
         {
@@ -1128,6 +1132,10 @@ public class PDFMergerUtility
     static Map<String, PDStructureElement> getIDTreeAsMap(PDNameTreeNode<PDStructureElement> idTree)
             throws IOException
     {
+        if (idTree == null)
+        {
+            return new LinkedHashMap<>();
+        }
         Map<String, PDStructureElement> names = idTree.getNames();
         if (names == null)
         {
@@ -1154,6 +1162,10 @@ public class PDFMergerUtility
     static Map<Integer, COSObjectable> getNumberTreeAsMap(PDNumberTreeNode tree)
             throws IOException
     {
+        if (tree == null)
+        {
+            return new LinkedHashMap<>();
+        }
         Map<Integer, COSObjectable> numbers = tree.getNumbers();
         if (numbers == null)
         {
diff --git a/pdfbox/src/main/java/org/apache/pdfbox/multipdf/Splitter.java b/pdfbox/src/main/java/org/apache/pdfbox/multipdf/Splitter.java
index 1f7935708e..b5b6b3e2dc 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/multipdf/Splitter.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/multipdf/Splitter.java
@@ -798,6 +798,10 @@ public class Splitter
             if (annotation instanceof PDAnnotationMarkup)
             {
                 PDAnnotationPopup annotationPopup = ((PDAnnotationMarkup) annotation).getPopup();
+                if (annotationPopup == null)
+                {
+                    continue;
+                }
                 COSDictionary clonedPopupDict = annotDictMap.get(annotationPopup.getCOSObject());
                 if (clonedPopupDict != null)
                 {
