diff --git a/pdfbox/src/main/java/org/apache/pdfbox/cos/COSDocument.java b/pdfbox/src/main/java/org/apache/pdfbox/cos/COSDocument.java
index 383a5d5ff0..a93f54cae8 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/cos/COSDocument.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/cos/COSDocument.java
@@ -82,6 +82,8 @@ public class COSDocument extends COSBase implements Closeable
 
     private boolean isXRefStream;
 
+    private boolean hasHybridXRef = false;
+
     private RandomAccessStreamCache streamCache;
 
     /**
@@ -562,6 +564,24 @@ public class COSDocument extends COSBase implements Closeable
         isXRefStream = isXRefStreamValue;
     }
     
+    /**
+     * Determines if the pdf has hybrid cross references, both plain tables and streams.
+     * 
+     * @return true if the pdf has hybrid cross references
+     */
+    public boolean hasHybridXRef()
+    {
+        return hasHybridXRef;
+    }
+
+    /**
+     * Marks the pdf as document using hybrid cross references.
+     */
+    public void setHasHybridXRef()
+    {
+        hasHybridXRef = true;
+    }
+
     /**
      * Returns the {@link COSDocumentState} of this {@link COSDocument}.
      *
diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/COSParser.java b/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/COSParser.java
index 742e7097be..fcf90d6eb5 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/COSParser.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/COSParser.java
@@ -354,6 +354,7 @@ public class COSParser extends BaseParser implements ICOSParser
                         try
                         {
                             parseXrefObjStream(prev, false);
+                            document.setHasHybridXRef();
                         }
                         catch (IOException ex)
                         {
@@ -439,7 +440,15 @@ public class COSParser extends BaseParser implements ICOSParser
         COSDictionary dict = parseCOSDictionary(false);
         try (COSStream xrefStream = parseCOSStream(dict))
         {
-            parseXrefStream(xrefStream, objByteOffset, isStandalone);
+            // the cross reference stream of a hybrid xref table will be added to the existing one
+            // and we must not override the offset and the trailer
+            if ( isStandalone )
+            {
+                xrefTrailerResolver.nextXrefObj( objByteOffset, XRefType.STREAM );
+                xrefTrailerResolver.setTrailer(xrefStream);
+            }
+            PDFXrefStreamParser parser = new PDFXrefStreamParser(xrefStream, document);
+            parser.parse(xrefTrailerResolver);
         }
 
         return dict.getLong(COSName.PREV);
@@ -1763,27 +1772,6 @@ public class COSParser extends BaseParser implements ICOSParser
         return true;
     }
 
-    /**
-     * Fills XRefTrailerResolver with data of given stream.
-     * Stream must be of type XRef.
-     * @param stream the stream to be read
-     * @param objByteOffset the offset to start at
-     * @param isStandalone should be set to true if the stream is not part of a hybrid xref table
-     * @throws IOException if there is an error parsing the stream
-     */
-    private void parseXrefStream(COSStream stream, long objByteOffset, boolean isStandalone) throws IOException
-    {
-        // the cross reference stream of a hybrid xref table will be added to the existing one
-        // and we must not override the offset and the trailer
-        if ( isStandalone )
-        {
-            xrefTrailerResolver.nextXrefObj( objByteOffset, XRefType.STREAM );
-            xrefTrailerResolver.setTrailer( stream );
-        }        
-        PDFXrefStreamParser parser = new PDFXrefStreamParser(stream, document);
-        parser.parse(xrefTrailerResolver);
-    }
-
     /**
      * This will get the encryption dictionary. The document must be parsed before this is called.
      *
diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdfwriter/COSWriter.java b/pdfbox/src/main/java/org/apache/pdfbox/pdfwriter/COSWriter.java
index 509e8f702d..e92e297049 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdfwriter/COSWriter.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdfwriter/COSWriter.java
@@ -715,9 +715,9 @@ public class COSWriter implements ICOSVisitor
         trailer.accept(this);
     }
 
-    private void doWriteXRefInc(COSDocument doc, boolean hasHybridXRef) throws IOException
+    private void doWriteXRefInc(COSDocument doc) throws IOException
     {
-        if (!doc.isXRefStream() || (hasHybridXRef && incrementalUpdate))
+        if (!doc.isXRefStream() || (doc.hasHybridXRef() && incrementalUpdate))
         {
             COSDictionary trailer = doc.getTrailer();
             trailer.setLong(COSName.PREV, doc.getStartXref());
@@ -1284,18 +1284,9 @@ public class COSWriter implements ICOSVisitor
             doWriteBody(doc);
         }
 
-        // get the previous trailer
-        COSDictionary trailer = doc.getTrailer();
-        boolean hasHybridXRef = false;
-
-        if (trailer != null)
-        {
-            hasHybridXRef = trailer.getLong(COSName.XREF_STM) != -1;
-        }
-
         if(incrementalUpdate || doc.isXRefStream())
         {
-            doWriteXRefInc(doc, hasHybridXRef);
+            doWriteXRefInc(doc);
         }
         else
         {
