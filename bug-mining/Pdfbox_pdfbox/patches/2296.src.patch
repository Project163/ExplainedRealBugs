diff --git a/pdfbox/src/main/java/org/apache/pdfbox/contentstream/operator/DrawObject.java b/pdfbox/src/main/java/org/apache/pdfbox/contentstream/operator/DrawObject.java
index 24d6a1928f..8032130c59 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/contentstream/operator/DrawObject.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/contentstream/operator/DrawObject.java
@@ -16,14 +16,17 @@
  */
 package org.apache.pdfbox.contentstream.operator;
 
+import java.io.IOException;
+import java.util.List;
+import org.apache.commons.logging.Log;
+import org.apache.commons.logging.LogFactory;
+
 import org.apache.pdfbox.cos.COSBase;
 import org.apache.pdfbox.cos.COSName;
 import org.apache.pdfbox.pdmodel.graphics.PDXObject;
 import org.apache.pdfbox.pdmodel.graphics.form.PDFormXObject;
 import org.apache.pdfbox.pdmodel.graphics.form.PDTransparencyGroup;
-
-import java.io.IOException;
-import java.util.List;
+import org.apache.pdfbox.pdmodel.PDResources;
 
 /**
  * Do: Draws an XObject.
@@ -33,6 +36,8 @@ import java.util.List;
  */
 public class DrawObject extends OperatorProcessor
 {
+    private static final Log LOG = LogFactory.getLog(DrawObject.class);
+
     @Override
     public void process(Operator operator, List<COSBase> arguments) throws IOException
     {
@@ -55,14 +60,24 @@ public class DrawObject extends OperatorProcessor
         
         PDXObject xobject = context.getResources().getXObject(name);
 
-        if (xobject instanceof PDTransparencyGroup)
-        {
-            context.showTransparencyGroup((PDTransparencyGroup) xobject);
-        }
-        else if (xobject instanceof PDFormXObject)
+        if (xobject instanceof PDFormXObject)
         {
             PDFormXObject form = (PDFormXObject) xobject;
-            context.showForm(form);
+            PDResources formResources = form.getResources();
+            if (formResources != null &&
+                context.getResources().getCOSObject() == formResources.getCOSObject())
+            {
+                LOG.error("avoiding recursion with XObject '" + name.getName() + "'");
+                return;
+            }
+            if (form instanceof PDTransparencyGroup)
+            {
+                context.showTransparencyGroup((PDTransparencyGroup) form);
+            }
+            else
+            {
+                context.showForm(form);
+            }
         }
     }
 
diff --git a/pdfbox/src/main/java/org/apache/pdfbox/contentstream/operator/graphics/DrawObject.java b/pdfbox/src/main/java/org/apache/pdfbox/contentstream/operator/graphics/DrawObject.java
index d31f6921b0..0caf4a2dfc 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/contentstream/operator/graphics/DrawObject.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/contentstream/operator/graphics/DrawObject.java
@@ -18,8 +18,10 @@ package org.apache.pdfbox.contentstream.operator.graphics;
 
 import java.io.IOException;
 import java.util.List;
-import org.apache.pdfbox.contentstream.operator.MissingOperandException;
 
+import org.apache.commons.logging.Log;
+import org.apache.commons.logging.LogFactory;
+import org.apache.pdfbox.contentstream.operator.MissingOperandException;
 import org.apache.pdfbox.cos.COSBase;
 import org.apache.pdfbox.cos.COSName;
 import org.apache.pdfbox.pdmodel.MissingResourceException;
@@ -29,6 +31,7 @@ import org.apache.pdfbox.pdmodel.graphics.image.PDImageXObject;
 import org.apache.pdfbox.pdmodel.graphics.PDXObject;
 import org.apache.pdfbox.contentstream.operator.Operator;
 import org.apache.pdfbox.contentstream.operator.OperatorName;
+import org.apache.pdfbox.pdmodel.PDResources;
 
 /**
  * Do: Draws an XObject.
@@ -38,6 +41,8 @@ import org.apache.pdfbox.contentstream.operator.OperatorName;
  */
 public final class DrawObject extends GraphicsOperatorProcessor
 {
+    private static final Log LOG = LogFactory.getLog(DrawObject.class);
+
     @Override
     public void process(Operator operator, List<COSBase> operands) throws IOException
     {
@@ -62,13 +67,27 @@ public final class DrawObject extends GraphicsOperatorProcessor
             PDImageXObject image = (PDImageXObject)xobject;
             context.drawImage(image);
         }
-        else if (xobject instanceof PDTransparencyGroup)
-        {
-            getContext().showTransparencyGroup((PDTransparencyGroup) xobject);
-        }
         else if (xobject instanceof PDFormXObject)
         {
-            getContext().showForm((PDFormXObject) xobject);
+            PDFormXObject form = (PDFormXObject) xobject;
+            PDResources formResources = form.getResources();
+            if (formResources != null &&
+                context.getResources().getCOSObject() == formResources.getCOSObject())
+            {
+                //TODO a general solution should be found for recursions that go over several levels
+                // context is a PDFStreamEngine and this is the same object on every level.
+                LOG.error("avoiding recursion with XObject '" + objectName.getName() + "'");
+                return;
+            }
+
+            if (form instanceof PDTransparencyGroup)
+            {
+                context.showTransparencyGroup((PDTransparencyGroup) form);
+            }
+            else
+            {
+                context.showForm(form);
+            }
         }
     }
 
diff --git a/pdfbox/src/main/java/org/apache/pdfbox/contentstream/operator/markedcontent/DrawObject.java b/pdfbox/src/main/java/org/apache/pdfbox/contentstream/operator/markedcontent/DrawObject.java
index f823e07d50..f039eed0bc 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/contentstream/operator/markedcontent/DrawObject.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/contentstream/operator/markedcontent/DrawObject.java
@@ -16,19 +16,22 @@
  */
 package org.apache.pdfbox.contentstream.operator.markedcontent;
 
-import org.apache.pdfbox.cos.COSBase;
-import org.apache.pdfbox.cos.COSName;
-import org.apache.pdfbox.pdmodel.graphics.PDXObject;
-import org.apache.pdfbox.pdmodel.graphics.form.PDFormXObject;
-import org.apache.pdfbox.pdmodel.graphics.form.PDTransparencyGroup;
-import org.apache.pdfbox.text.PDFMarkedContentExtractor;
-
 import java.io.IOException;
 import java.util.List;
+
+import org.apache.commons.logging.Log;
+import org.apache.commons.logging.LogFactory;
 import org.apache.pdfbox.contentstream.operator.MissingOperandException;
 import org.apache.pdfbox.contentstream.operator.Operator;
 import org.apache.pdfbox.contentstream.operator.OperatorName;
 import org.apache.pdfbox.contentstream.operator.OperatorProcessor;
+import org.apache.pdfbox.cos.COSBase;
+import org.apache.pdfbox.cos.COSName;
+import org.apache.pdfbox.pdmodel.PDResources;
+import org.apache.pdfbox.pdmodel.graphics.PDXObject;
+import org.apache.pdfbox.pdmodel.graphics.form.PDFormXObject;
+import org.apache.pdfbox.pdmodel.graphics.form.PDTransparencyGroup;
+import org.apache.pdfbox.text.PDFMarkedContentExtractor;
 
 /**
  * Do: Draws an XObject.
@@ -38,6 +41,8 @@ import org.apache.pdfbox.contentstream.operator.OperatorProcessor;
  */
 public class DrawObject extends OperatorProcessor
 {
+    private static final Log LOG = LogFactory.getLog(DrawObject.class);
+
     @Override
     public void process(Operator operator, List<COSBase> arguments) throws IOException
     {
@@ -51,17 +56,27 @@ public class DrawObject extends OperatorProcessor
             return;
         }
         COSName name = (COSName) base0;
-        PDXObject xobject =  context.getResources().getXObject(name);
+        PDXObject xobject = context.getResources().getXObject(name);
         ((PDFMarkedContentExtractor) context).xobject(xobject);
 
-        if (xobject instanceof PDTransparencyGroup)
-        {
-            context.showTransparencyGroup((PDTransparencyGroup) xobject);
-        }
-        else if (xobject instanceof PDFormXObject)
+        if (xobject instanceof PDFormXObject)
         {
             PDFormXObject form = (PDFormXObject) xobject;
-            context.showForm(form);
+            PDResources formResources = form.getResources();
+            if (formResources != null && 
+                context.getResources().getCOSObject() == formResources.getCOSObject())
+            {
+                LOG.error("avoiding recursion with XObject '" + name.getName() + "'");
+                return;
+            }
+            if (form instanceof PDTransparencyGroup)
+            {
+                context.showTransparencyGroup((PDTransparencyGroup) form);
+            }
+            else
+            {
+                context.showForm(form);
+            }
         }
     }
 
