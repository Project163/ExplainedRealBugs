diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/font/PDSimpleFont.java b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/font/PDSimpleFont.java
index d15c591a26..07d5922960 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/font/PDSimpleFont.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/font/PDSimpleFont.java
@@ -141,6 +141,10 @@ public abstract class PDSimpleFont extends PDFont
                 awtFont = Font.decode(null).deriveFont(1f);
             }
             glyphs = awtFont.createGlyphVector(frc, string);
+            if (isType1Font()) 
+            {
+                glyphs = remapGlyphs(glyphs, string);
+            }
         }
         Graphics2D g2d = (Graphics2D)g;
         g2d.setRenderingHint( RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON );
@@ -546,5 +550,16 @@ public abstract class PDSimpleFont extends PDFont
         }
         return fontWidthOfSpace;
     }
-
+    
+    /**
+     * Remap glyphs.
+     * 
+     * @param glyphVector glyph vector to be remapped
+     * @param string the represented string
+     * @return the remapped glyph vector
+     */
+    protected GlyphVector remapGlyphs(GlyphVector glyphVector, String string) 
+    {
+        return glyphVector;
+    }
 }
diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/font/PDType1CFont.java b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/font/PDType1CFont.java
index 17d507f766..4255656a98 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/font/PDType1CFont.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/font/PDType1CFont.java
@@ -23,7 +23,6 @@ import java.io.ByteArrayInputStream;
 import java.io.ByteArrayOutputStream;
 import java.io.InputStream;
 import java.io.IOException;
-import java.lang.reflect.Field;
 import java.util.Arrays;
 import java.util.Collection;
 import java.util.Iterator;
@@ -87,15 +86,19 @@ public class PDType1CFont extends PDSimpleFont
 
     private PDRectangle fontBBox = null;
 
-    private static final Log log = LogFactory.getLog(PDType1CFont.class);
+    private static final Log LOG = LogFactory.getLog(PDType1CFont.class);
 
     private static final byte[] SPACE_BYTES = {(byte)32};
 
     private COSDictionary fontDict = null;
     
+    private Map<Integer, Integer> codeToGlyph = new HashMap<Integer, Integer>();
+    
     /**
      * Constructor.
+     * 
      * @param fontDictionary the corresponding dictionary
+     * @throws IOException it somethin went wrong
      */
     public PDType1CFont( COSDictionary fontDictionary ) throws IOException
     {
@@ -112,13 +115,17 @@ public class PDType1CFont extends PDSimpleFont
         String character = getCharacter(bytes, offset, length);
         if( character == null )
         {
-            log.debug("No character for code " + (bytes[offset] & 0xff) + " in " + this.cffFont.getName());
+            LOG.debug("No character for code " + (bytes[offset] & 0xff) + " in " + this.cffFont.getName());
             return null;
         }
 
         return character;
     }
     
+    /**
+     * {@inheritDoc}
+     */
+    @Override
     public int encodeToCID( byte[] bytes, int offset, int length )
     {
       if (length > 2)
@@ -136,8 +143,9 @@ public class PDType1CFont extends PDSimpleFont
     private String getCharacter( byte[] bytes, int offset, int length )
     {
         int code = encodeToCID(bytes, offset, length);
-        if (code == -1) {
-        	return null;
+        if (code == -1) 
+        {
+            return null;
         }
         return (String)this.codeToCharacter.get(code);
     }
@@ -150,7 +158,7 @@ public class PDType1CFont extends PDSimpleFont
         String name = getName(bytes, offset, length);
         if( name == null && !Arrays.equals(SPACE_BYTES, bytes) )
         {
-            log.debug("No name for code " + (bytes[offset] & 0xff) + " in " + this.cffFont.getName());
+            LOG.debug("No name for code " + (bytes[offset] & 0xff) + " in " + this.cffFont.getName());
 
             return 0;
         }
@@ -173,7 +181,7 @@ public class PDType1CFont extends PDSimpleFont
         String name = getName(bytes, offset, length);
         if( name == null )
         {
-            log.debug("No name for code " + (bytes[offset] & 0xff) + " in " + this.cffFont.getName());
+            LOG.debug("No name for code " + (bytes[offset] & 0xff) + " in " + this.cffFont.getName());
 
             return 0;
         }
@@ -218,7 +226,7 @@ public class PDType1CFont extends PDSimpleFont
             Integer code = getCode(character);
             if( code == null )
             {
-                log.debug("No code for character " + character);
+                LOG.debug("No code for character " + character);
 
                 return 0;
             }
@@ -234,6 +242,16 @@ public class PDType1CFont extends PDSimpleFont
         return (Integer)this.characterToCode.get(character);
     }
 
+    /**
+     * Returns the glyph index of the given character code.
+     * 
+     * @param code the character code
+     * @return the glyph index
+     */
+    protected Integer getGlyphIndex(int code) 
+    {
+        return codeToGlyph.get(code);
+    }
 
     /**
      * {@inheritDoc}
@@ -308,7 +326,7 @@ public class PDType1CFont extends PDSimpleFont
             }
             catch (IOException exception)
             {
-                log.error("An error occured while extracting the font metrics!", exception);
+                LOG.error("An error occured while extracting the font metrics!", exception);
             }
         }
         return fontMetric;
@@ -338,11 +356,9 @@ public class PDType1CFont extends PDSimpleFont
             this.cffFont = (CFFFont)fonts.get(0);
         }
 
-        CFFEncoding encoding = this.cffFont.getEncoding();
-        PDFEncoding pdfEncoding = new PDFEncoding(encoding);
+        PDFEncoding pdfEncoding = new PDFEncoding();
 
-        CFFCharset charset = this.cffFont.getCharset();
-        PDFCharset pdfCharset = new PDFCharset(charset);
+        PDFCharset pdfCharset = new PDFCharset();
 
         Map<String,byte[]> charStringsDict = this.cffFont.getCharStringsDict();
         Map<String,byte[]> pdfCharStringsDict = new LinkedHashMap<String,byte[]>();
@@ -369,47 +385,34 @@ public class PDType1CFont extends PDSimpleFont
             String name = (String)entry.getValue();
             if(knownNames.contains(name))
             {
+                Iterator<Map.Entry<Integer, String>> iter = codeToNameMap.entrySet().iterator();
+                while (iter.hasNext()) 
+                {
+                    Map.Entry<Integer, String> existingEntry = iter.next();
+                    if (existingEntry.getValue().equals(name)) 
+                    {
+                        iter.remove();
+                        break;
+                    }
+                }
                 codeToNameMap.put(code, name);
             }
         }
 
-        Map<String,String> nameToCharacter;
-        try
-        {
-            // TODO remove access by reflection
-            Field nameToCharacterField = Encoding.class.getDeclaredField("NAME_TO_CHARACTER");
-            nameToCharacterField.setAccessible(true);
-            nameToCharacter = (Map<String,String>)nameToCharacterField.get(null);
-        }
-        catch( Exception e )
-        {
-            throw new RuntimeException(e);
-        }
-
+        int glyphIndex = 0;
         for( Iterator<Map.Entry<Integer,String>> it = (codeToNameMap.entrySet()).iterator(); it.hasNext();)
         {
             Map.Entry<Integer,String> entry = it.next();
             Integer code = (Integer)entry.getKey();
             String name = (String)entry.getValue();
-            String uniName = "uni";
-            String character = (String)nameToCharacter.get(name);
-            if( character != null )
-            {
-                for( int j = 0; j < character.length(); j++ )
-                {
-                    uniName += hexString(character.charAt(j), 4);
-                }
-            }
-            else
-            {
-                uniName += hexString(code.intValue(), 4);
-                character = String.valueOf((char)code.intValue());
-            }
+            String uniName = "uni" + hexString(code.intValue(), 4);
+            String character = String.valueOf((char) code.intValue());
             pdfEncoding.register(code.intValue(), code.intValue());
             pdfCharset.register(code.intValue(), uniName);
-            this.codeToName.put(code, uniName);
-            this.codeToCharacter.put(code, character);
-            this.characterToCode.put(character, code);
+            codeToName.put(code, uniName);
+            codeToCharacter.put(code, character);
+            characterToCode.put(character, code);
+            codeToGlyph.put(code, glyphIndex++);
             pdfCharStringsDict.put(uniName, charStringsDict.get(name));
         }
 
@@ -477,10 +480,38 @@ public class PDType1CFont extends PDSimpleFont
             COSArray differences = (COSArray)encodingDic.getDictionaryObject(COSName.DIFFERENCES);
             if( differences != null )
             {
-                result.putAll(loadDifferences(differences));
+                Map<Integer, String> diffs = loadDifferences(differences);
+                if (baseName == null) 
+                {
+                    result.putAll(diffs);
+                } 
+                else 
+                {
+                    Set<String> knownNames = new HashSet<String>(result.values());
+                    Iterator<Map.Entry<Integer, String>> it = (diffs.entrySet()).iterator();
+                    while (it.hasNext()) 
+                    {
+                        Map.Entry<Integer, String> entry = it.next();
+                        Integer code = (Integer) entry.getKey();
+                        String name = (String) entry.getValue();
+                        if (knownNames.contains(name)) 
+                        {
+                            Iterator<Map.Entry<Integer, String>> iter = result.entrySet().iterator();
+                            while( iter.hasNext()) 
+                            {
+                                Map.Entry<Integer, String> existingEntry = iter.next();
+                                if (existingEntry.getValue().equals(name)) 
+                                {
+                                    iter.remove();
+                                    break;
+                                }
+                            }
+                        }
+                        result.put(code, name);
+                    }
+                }
             }
         }
-
         return result;
     }
 
@@ -526,7 +557,7 @@ public class PDType1CFont extends PDSimpleFont
     
     private static String hexString( int code, int length )
     {
-        String string = Integer.toHexString(code);
+        String string = Integer.toHexString(code).toUpperCase();
         while(string.length() < length)
         {
             string = ("0" + string);
@@ -591,13 +622,8 @@ public class PDType1CFont extends PDSimpleFont
     private static class PDFEncoding extends CFFEncoding
     {
 
-        private PDFEncoding( CFFEncoding parent )
+        private PDFEncoding()
         {
-            Iterator<Entry> parentEntries = parent.getEntries().iterator();
-            while(parentEntries.hasNext())
-            {
-                addEntry(parentEntries.next());
-            }
         }
 
         public boolean isFontSpecific()
@@ -613,13 +639,8 @@ public class PDType1CFont extends PDSimpleFont
      */
     private static class PDFCharset extends CFFCharset
     {
-        private PDFCharset( CFFCharset parent )
+        private PDFCharset()
         {
-            Iterator<Entry> parentEntries = parent.getEntries().iterator();
-            while(parentEntries.hasNext())
-            {
-                addEntry(parentEntries.next());
-            }
         }
 
         public boolean isFontSpecific()
diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/font/PDType1Font.java b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/font/PDType1Font.java
index 6569efabd4..93da6c1dba 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/font/PDType1Font.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/font/PDType1Font.java
@@ -18,9 +18,11 @@ package org.apache.pdfbox.pdmodel.font;
 
 import java.awt.Font;
 import java.awt.FontFormatException;
+import java.awt.font.GlyphVector;
 import java.io.BufferedReader;
 import java.io.IOException;
 import java.io.InputStreamReader;
+import java.lang.reflect.Field;
 import java.util.HashMap;
 import java.util.Map;
 import java.util.StringTokenizer;
@@ -52,7 +54,7 @@ public class PDType1Font extends PDSimpleFont
     /**
      * Log instance.
      */
-    private static final Log log = LogFactory.getLog(PDType1Font.class);
+    private static final Log LOG = LogFactory.getLog(PDType1Font.class);
 
     private PDType1CFont type1CFont = null;
     /**
@@ -163,7 +165,7 @@ public class PDType1Font extends PDSimpleFont
                 }
                 catch (IOException exception) 
                 {
-                    log.info("Can't read the embedded type1C font " + fd.getFontName() );
+                    LOG.info("Can't read the embedded type1C font " + fd.getFontName() );
                 }
             }
         }
@@ -227,11 +229,12 @@ public class PDType1Font extends PDSimpleFont
                         try 
                         {
                             // create a type1 font with the embedded data
-                            awtFont = Font.createFont( Font.TYPE1_FONT, fdDictionary.getFontFile().createInputStream() );
+                            awtFont = Font.createFont( Font.TYPE1_FONT,
+                                    fdDictionary.getFontFile().createInputStream() );
                         } 
                         catch (FontFormatException e) 
                         {
-                            log.info("Can't read the embedded type1 font " + fd.getFontName() );
+                            LOG.info("Can't read the embedded type1 font " + fd.getFontName() );
                         }
                     }
                     if (awtFont == null)
@@ -240,7 +243,7 @@ public class PDType1Font extends PDSimpleFont
                         awtFont = FontManager.getAwtFont(fd.getFontName());
                         if (awtFont == null)
                         {
-                            log.info("Can't find the specified font " + fd.getFontName() );
+                            LOG.info("Can't find the specified font " + fd.getFontName() );
                         }
                     }
                 }
@@ -250,7 +253,7 @@ public class PDType1Font extends PDSimpleFont
                     awtFont = FontManager.getAwtFont(baseFont);
                     if (awtFont == null) 
                     {
-                        log.info("Can't find the specified basefont " + baseFont );
+                        LOG.info("Can't find the specified basefont " + baseFont );
                     }
                 }
             }
@@ -258,12 +261,16 @@ public class PDType1Font extends PDSimpleFont
             {
                 // we can't find anything, so we have to use the standard font
                 awtFont = FontManager.getStandardFont();
-                log.info("Using font "+awtFont.getName()+ " instead");
+                LOG.info("Using font "+awtFont.getName()+ " instead");
             }
         }
         return awtFont;
     }
 
+    /**
+     * {@inheritDoc}
+     */
+    @Override
     protected void determineEncoding()
     {
         super.determineEncoding();
@@ -308,9 +315,12 @@ public class PDType1Font extends PDSimpleFont
                     {
                         if (extractEncoding) 
                         {
-                            if (line.startsWith("currentdict end")) {
+                            if (line.startsWith("currentdict end")) 
+                            {
                                 if (encoding != null)
+                                {
                                     setFontEncoding(encoding);
+                                }
                                 break;
                             }
                             if (line.startsWith("/Encoding")) 
@@ -337,7 +347,8 @@ public class PDType1Font extends PDSimpleFont
                                     break;
                                 }
                             }
-                            else if (line.startsWith("dup")) {
+                            else if (line.startsWith("dup")) 
+                            {
                                 StringTokenizer st = new StringTokenizer(line.replaceAll("/"," /"));
                                 // ignore the first token
                                 st.nextElement();
@@ -347,7 +358,8 @@ public class PDType1Font extends PDSimpleFont
                                     String name = st.nextToken();
                                     if(encoding == null)
                                     {
-                                        log.warn("Unable to get character encoding. Encoding defintion found without /Encoding line.");
+                                        LOG.warn("Unable to get character encoding. " +
+                                                "Encoding defintion found without /Encoding line.");
                                     }
                                     else
                                     {
@@ -359,7 +371,7 @@ public class PDType1Font extends PDSimpleFont
                                     // there are (tex?)-some fonts containing postscript code like the following, 
                                     // which has to be ignored, see PDFBOX-1481
                                     // dup dup 161 10 getinterval 0 exch putinterval ....
-                                    log.debug("Malformed encoding definition ignored (line="+line+")");
+                                    LOG.debug("Malformed encoding definition ignored (line="+line+")");
                                 }
                                 continue;
                             }
@@ -385,7 +397,7 @@ public class PDType1Font extends PDSimpleFont
                                 }
                                 catch (NumberFormatException exception)
                                 {
-                                    log.error("Can't read the fontmatrix from embedded font file!");
+                                    LOG.error("Can't read the fontmatrix from embedded font file!");
                                 }
                             }
                         }
@@ -393,7 +405,7 @@ public class PDType1Font extends PDSimpleFont
                 }
                 catch(IOException exception) 
                 {
-                    log.error("Error: Could not extract the encoding from the embedded type1 font.");
+                    LOG.error("Error: Could not extract the encoding from the embedded type1 font.");
                 }
                 finally
                 {
@@ -405,7 +417,7 @@ public class PDType1Font extends PDSimpleFont
                         }
                         catch(IOException exception) 
                         {
-                            log.error("An error occurs while closing the stream used to read the embedded type1 font.");
+                            LOG.error("An error occurs while closing the stream used to read the embedded type1 font.");
                         }
                     }
                 }
@@ -419,7 +431,7 @@ public class PDType1Font extends PDSimpleFont
     @Override
     public String encode(byte[] c, int offset, int length) throws IOException
     {
-        if (type1CFont != null && getFontEncoding() == null)
+        if (type1CFont != null)
         {
             return type1CFont.encode(c, offset, length);
         }
@@ -429,7 +441,12 @@ public class PDType1Font extends PDSimpleFont
         }
     }
     
-    public int encodeToCID( byte[] c, int offset, int length ) throws IOException {
+    /**
+     * {@inheritDoc}
+     */
+    @Override
+    public int encodeToCID( byte[] c, int offset, int length ) throws IOException 
+    {
       if (type1CFont != null && getFontEncoding() == null)
       {
           return type1CFont.encodeToCID(c, offset, length);
@@ -439,6 +456,7 @@ public class PDType1Font extends PDSimpleFont
           return super.encodeToCID(c, offset, length);
       }
     }
+    
     /**
      * {@inheritDoc}
      */
@@ -454,4 +472,45 @@ public class PDType1Font extends PDSimpleFont
             return super.getFontMatrix();
         }
     }
+    
+    /**
+     * {@inheritDoc}
+     */
+    @Override
+    protected GlyphVector remapGlyphs(GlyphVector glyphVector, String string) 
+    {
+        // this is used to fix an apparent bug with the sun jdk where the mapping of
+        // character code to glyph index done by native code is wrong; this does not happen with openjdk
+        try 
+        {
+            Field fGlyphs = glyphVector.getClass().getDeclaredField("glyphs");
+            fGlyphs.setAccessible(true);
+            int[] glyphs = (int[]) fGlyphs.get(glyphVector);
+            if (glyphs.length == 1 && glyphs[0] != 65535) 
+            {
+                return glyphVector;
+            }
+            if (type1CFont != null) 
+            {
+                Field fuserGlyphs = glyphVector.getClass().getDeclaredField("userGlyphs");
+                fuserGlyphs.setAccessible(true);
+                int[] userGlyphs = (int[]) fuserGlyphs.get(glyphVector);
+                for (int j = 0; j < glyphs.length; j++) 
+                {
+                    if (glyphs[j] == 65535) 
+                    {
+                        int c = (int) string.charAt(j);
+                        glyphs[j] = type1CFont.getGlyphIndex(c);
+                        userGlyphs[j] = type1CFont.getGlyphIndex(c);
+                    }
+                }
+            }
+        } 
+        catch (Exception e) 
+        {
+            e.printStackTrace();
+        }
+        return glyphVector;
+    }
+
 }
