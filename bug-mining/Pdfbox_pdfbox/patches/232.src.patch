diff --git a/pdfbox/src/main/java/org/apache/pdfbox/ExtractText.java b/pdfbox/src/main/java/org/apache/pdfbox/ExtractText.java
index f42bda6b6c..26702d766f 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/ExtractText.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/ExtractText.java
@@ -281,37 +281,40 @@ public class ExtractText
                     PDEmbeddedFilesNameTreeNode embeddedFiles = names.getEmbeddedFiles();
                     if (embeddedFiles != null)
                     {
-                        for (Map.Entry<String,Object> ent : embeddedFiles.getNames().entrySet()) 
-                        {
-                            if (debug)
-                            {
-                                System.err.println("Processing embedded file " + ent.getKey() + ":");
-                            }
-                            PDComplexFileSpecification spec = (PDComplexFileSpecification) ent.getValue();
-                            PDEmbeddedFile file = spec.getEmbeddedFile();
-                            if (file.getSubtype().equals("application/pdf")) 
+                        Map<String,Object> embeddedFileNames = embeddedFiles.getNames();
+                        if (embeddedFileNames != null) {
+                            for (Map.Entry<String,Object> ent : embeddedFileNames.entrySet()) 
                             {
                                 if (debug)
                                 {
-                                    System.err.println("  is PDF (size=" + file.getSize() + ")");
+                                    System.err.println("Processing embedded file " + ent.getKey() + ":");
                                 }
-                                InputStream fis = file.createInputStream();
-                                PDDocument subDoc = null;
-                                try 
-                                {
-                                    subDoc = PDDocument.load(fis);
-                                } 
-                                finally 
-                                {
-                                    fis.close();
-                                }
-                                try 
-                                {
-                                    stripper.writeText( subDoc, output );
-                                } 
-                                finally 
+                                PDComplexFileSpecification spec = (PDComplexFileSpecification) ent.getValue();
+                                PDEmbeddedFile file = spec.getEmbeddedFile();
+                                if (file.getSubtype().equals("application/pdf")) 
                                 {
-                                    subDoc.close();
+                                    if (debug)
+                                    {
+                                        System.err.println("  is PDF (size=" + file.getSize() + ")");
+                                    }
+                                    InputStream fis = file.createInputStream();
+                                    PDDocument subDoc = null;
+                                    try 
+                                    {
+                                        subDoc = PDDocument.load(fis);
+                                    } 
+                                    finally 
+                                    {
+                                        fis.close();
+                                    }
+                                    try 
+                                    {
+                                        stripper.writeText( subDoc, output );
+                                    } 
+                                    finally 
+                                    {
+                                        subDoc.close();
+                                    }
                                 }
                             } 
                         }
diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/common/PDNameTreeNode.java b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/common/PDNameTreeNode.java
index 62759c2fba..7ea2ff0542 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/common/PDNameTreeNode.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/common/PDNameTreeNode.java
@@ -175,7 +175,8 @@ public class PDNameTreeNode implements COSObjectable
      * This will return a map of names. The key will be a string, and the
      * value will depend on where this class is being used.
      *
-     * @return ordered map of cos objects
+     * @return ordered map of cos objects or <code>null</code> if dictionary
+     *         contains no 'Names' entry
      * @throws IOException If there is an error while creating the sub types.
      */
     public Map<String, Object> getNames() throws IOException
