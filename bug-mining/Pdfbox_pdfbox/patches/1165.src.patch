diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/shading/AxialShadingContext.java b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/shading/AxialShadingContext.java
index d1db491373..564d2e2df1 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/shading/AxialShadingContext.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/shading/AxialShadingContext.java
@@ -17,9 +17,9 @@
 package org.apache.pdfbox.pdmodel.graphics.shading;
 
 import java.awt.PaintContext;
+import java.awt.Rectangle;
 import java.awt.geom.AffineTransform;
 import java.awt.geom.NoninvertibleTransformException;
-import java.awt.geom.Point2D;
 import java.awt.image.ColorModel;
 import java.awt.image.Raster;
 import java.awt.image.WritableRaster;
@@ -50,7 +50,7 @@ public class AxialShadingContext extends ShadingContext implements PaintContext
     private final double x1x0;
     private final double y1y0;
     private final float d1d0;
-    private double denom;
+    private final double denom;
 
     private final int factor;
     private final int[] colorTable;
@@ -64,10 +64,11 @@ public class AxialShadingContext extends ShadingContext implements PaintContext
      * @param colorModel the color model to be used
      * @param xform transformation for user to device space
      * @param matrix the pattern matrix concatenated with that of the parent content stream
-     * @throws java.io.IOException if there is an error getting the color space or doing color conversion.
+     * @param deviceBounds the bounds of the area to paint, in device units
+     * @throws IOException if there is an error getting the color space or doing color conversion.
      */
     public AxialShadingContext(PDShadingType2 shading, ColorModel colorModel, AffineTransform xform,
-                               Matrix matrix) throws IOException
+                               Matrix matrix, Rectangle deviceBounds) throws IOException
     {
         super(shading, colorModel, xform, matrix);
         this.axialShadingType = shading;
@@ -101,7 +102,6 @@ public class AxialShadingContext extends ShadingContext implements PaintContext
         y1y0 = coords[3] - coords[1];
         d1d0 = domain[1] - domain[0];
         denom = Math.pow(x1x0, 2) + Math.pow(y1y0, 2);
-        double longestDistance = Math.sqrt(denom);
 
         try
         {
@@ -115,12 +115,11 @@ public class AxialShadingContext extends ShadingContext implements PaintContext
             LOG.error(ex, ex);
         }
 
-        // transform the distance to actual pixel space
-        // use transform, because xform.getScaleX() does not return correct scaling on 90° rotated matrix
-        Point2D point = new Point2D.Double(longestDistance, longestDistance);
-        matrix.transform(point);
-        xform.transform(point, point);
-        factor = (int) Math.max(Math.abs(point.getX()), Math.abs(point.getY()));
+        // get the number of steps
+        factor = (int) Math.max(Math.abs(deviceBounds.getWidth()),
+                                Math.abs(deviceBounds.getHeight()));
+        
+        // build the color table for the given number of steps
         colorTable = calcColorTable();
     }
 
diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/shading/AxialShadingPaint.java b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/shading/AxialShadingPaint.java
index 68c10066e2..56ae6d9ce4 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/shading/AxialShadingPaint.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/shading/AxialShadingPaint.java
@@ -64,7 +64,7 @@ public class AxialShadingPaint implements Paint
     {
         try
         {
-            return new AxialShadingContext(shading, cm, xform, matrix);
+            return new AxialShadingContext(shading, cm, xform, matrix, deviceBounds);
         }
         catch (IOException e)
         {
diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/shading/RadialShadingContext.java b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/shading/RadialShadingContext.java
index 1024fd5e44..a9df0783d6 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/shading/RadialShadingContext.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/shading/RadialShadingContext.java
@@ -17,9 +17,9 @@
 package org.apache.pdfbox.pdmodel.graphics.shading;
 
 import java.awt.PaintContext;
+import java.awt.Rectangle;
 import java.awt.geom.AffineTransform;
 import java.awt.geom.NoninvertibleTransformException;
-import java.awt.geom.Point2D;
 import java.awt.image.ColorModel;
 import java.awt.image.Raster;
 import java.awt.image.WritableRaster;
@@ -50,8 +50,6 @@ public class RadialShadingContext extends ShadingContext implements PaintContext
     private final double x1x0;
     private final double y1y0;
     private final double r1r0;
-    private final double x1x0pow2;
-    private final double y1y0pow2;
     private final double r0pow2;
     private final float d1d0;
     private final double denom;
@@ -68,10 +66,11 @@ public class RadialShadingContext extends ShadingContext implements PaintContext
      * @param colorModel the color model to be used
      * @param xform transformation for user to device space
      * @param matrix the pattern matrix concatenated with that of the parent content stream
-     * @throws java.io.IOException if there is an error getting the color space or doing color conversion.
+     * @param deviceBounds the bounds of the area to paint, in device units
+     * @throws IOException if there is an error getting the color space or doing color conversion.
      */
     public RadialShadingContext(PDShadingType3 shading, ColorModel colorModel,
-                                AffineTransform xform, Matrix matrix)
+                                AffineTransform xform, Matrix matrix, Rectangle deviceBounds)
                                 throws IOException
     {
         super(shading, colorModel, xform, matrix);
@@ -106,12 +105,9 @@ public class RadialShadingContext extends ShadingContext implements PaintContext
         x1x0 = coords[3] - coords[0];
         y1y0 = coords[4] - coords[1];
         r1r0 = coords[5] - coords[2];
-        x1x0pow2 = Math.pow(x1x0, 2);
-        y1y0pow2 = Math.pow(y1y0, 2);
         r0pow2 = Math.pow(coords[2], 2);
-        denom = x1x0pow2 + y1y0pow2 - Math.pow(r1r0, 2);
+        denom = Math.pow(x1x0, 2) + Math.pow(y1y0, 2) - Math.pow(r1r0, 2);
         d1d0 = domain[1] - domain[0];
-        double longestDistance = getLongestDistance();
 
         try
         {
@@ -125,38 +121,12 @@ public class RadialShadingContext extends ShadingContext implements PaintContext
             LOG.error(ex, ex);
         }
 
-        // transform the distance to actual pixel space
-        // use transform, because xform.getScaleX() does not return correct scaling on 90° rotated matrix
-        Point2D point = new Point2D.Double(longestDistance, longestDistance);
-        matrix.transform(point);
-        xform.transform(point, point);
-        factor = (int) Math.max(Math.abs(point.getX()), Math.abs(point.getY()));
-        colorTable = calcColorTable();
-    }
+        // get the number of steps
+        factor = (int) Math.max(Math.abs(deviceBounds.getWidth()),
+                Math.abs(deviceBounds.getHeight()));
 
-    // get the longest distance of two points which are located on these two circles
-    private double getLongestDistance()
-    {
-        double centerToCenter = Math.sqrt(x1x0pow2 + y1y0pow2);
-        double rmin, rmax;
-        if (coords[2] < coords[5])
-        {
-            rmin = coords[2];
-            rmax = coords[5];
-        }
-        else
-        {
-            rmin = coords[5];
-            rmax = coords[2];
-        }
-        if (centerToCenter + rmin <= rmax)
-        {
-            return 2 * rmax;
-        }
-        else
-        {
-            return rmin + centerToCenter + coords[5];
-        }
+        // build the color table for the given number of steps
+        colorTable = calcColorTable();
     }
 
     /**
diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/shading/RadialShadingPaint.java b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/shading/RadialShadingPaint.java
index a20d89ae6f..87dcdde81c 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/shading/RadialShadingPaint.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/shading/RadialShadingPaint.java
@@ -65,7 +65,7 @@ public class RadialShadingPaint implements Paint
     {
         try
         {
-            return new RadialShadingContext(shading, cm, xform, matrix);
+            return new RadialShadingContext(shading, cm, xform, matrix, deviceBounds);
         }
         catch (IOException e)
         {
