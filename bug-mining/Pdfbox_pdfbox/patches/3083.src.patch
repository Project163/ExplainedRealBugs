diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDEmbeddedFilesNameTreeNode.java b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDEmbeddedFilesNameTreeNode.java
index 842240b735..45a000108a 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDEmbeddedFilesNameTreeNode.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDEmbeddedFilesNameTreeNode.java
@@ -49,7 +49,7 @@ public class PDEmbeddedFilesNameTreeNode extends PDNameTreeNode<PDComplexFileSpe
     @Override
     protected PDComplexFileSpecification convertCOSToPD( COSBase base ) throws IOException
     {
-        if (!(base instanceof COSDictionary))
+        if (base != null && !(base instanceof COSDictionary))
         {
             throw new IOException("dictionary expected here, but got " + base);
         }
diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDStructureElementNameTreeNode.java b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDStructureElementNameTreeNode.java
index e7574001cf..2182aeafbc 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDStructureElementNameTreeNode.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDStructureElementNameTreeNode.java
@@ -51,7 +51,7 @@ public class PDStructureElementNameTreeNode extends PDNameTreeNode<PDStructureEl
     @Override
     protected PDStructureElement convertCOSToPD( COSBase base ) throws IOException
     {
-        if (!(base instanceof COSDictionary))
+        if (base != null && !(base instanceof COSDictionary))
         {
             throw new IOException("dictionary expected here, but got " + base);
         }
diff --git a/pdfbox/src/test/java/org/apache/pdfbox/pdmodel/common/PDIntegerNameTreeNode.java b/pdfbox/src/test/java/org/apache/pdfbox/pdmodel/common/PDIntegerNameTreeNode.java
index 27facde7ed..d5073cbbba 100644
--- a/pdfbox/src/test/java/org/apache/pdfbox/pdmodel/common/PDIntegerNameTreeNode.java
+++ b/pdfbox/src/test/java/org/apache/pdfbox/pdmodel/common/PDIntegerNameTreeNode.java
@@ -49,7 +49,7 @@ public class PDIntegerNameTreeNode extends PDNameTreeNode<COSInteger>
     @Override
     protected COSInteger convertCOSToPD(COSBase base) throws IOException
     {
-        if (!(base instanceof COSInteger))
+        if (base != null && !(base instanceof COSInteger))
         {
             throw new IOException("integer expected here, but got " + base);
         }
