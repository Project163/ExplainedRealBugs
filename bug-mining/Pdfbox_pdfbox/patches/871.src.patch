diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/BaseParser.java b/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/BaseParser.java
index 15941c2aaf..e527b5e8b9 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/BaseParser.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/BaseParser.java
@@ -250,11 +250,13 @@ public abstract class BaseParser
     private COSBase parseCOSDictionaryValue() throws IOException
     {
         COSBase retval = null;
+        long numOffset = pdfSource.getOffset();
         COSBase number = parseDirObject();
         skipSpaces();
         char next = (char)pdfSource.peek();
         if( next >= '0' && next <= '9' )
         {
+            long genOffset = pdfSource.getOffset();
             COSBase generationNumber = parseDirObject();
             skipSpaces();
             char r = (char)pdfSource.read();
@@ -262,6 +264,14 @@ public abstract class BaseParser
             {
                 throw new IOException("expected='R' actual='" + r + "' at offset " + pdfSource.getOffset());
             }
+            if (!(number instanceof COSInteger))
+            {
+                throw new IOException("expected number, actual=" + number + " at offset " + numOffset);
+            }
+            if (!(generationNumber instanceof COSInteger))
+            {
+                throw new IOException("expected number, actual=" + number + " at offset " + genOffset);
+            }
             COSObjectKey key = new COSObjectKey(((COSInteger) number).intValue(),
                     ((COSInteger) generationNumber).intValue());
             retval = document.getObjectFromPool(key);
