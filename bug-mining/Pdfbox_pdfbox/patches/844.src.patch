diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/SecurityHandler.java b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/SecurityHandler.java
index 7704b131b1..6f383ce36f 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/SecurityHandler.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/SecurityHandler.java
@@ -323,19 +323,10 @@ public abstract class SecurityHandler
                     SecretKey aesKey = new SecretKeySpec(finalKey, "AES");
                     IvParameterSpec ips = new IvParameterSpec(iv);
                     decryptCipher.init(decrypt ? Cipher.DECRYPT_MODE : Cipher.ENCRYPT_MODE, aesKey, ips);
-                    CipherInputStream cipherStream = new CipherInputStream(data, decryptCipher);
-
-                    try
-                    {
-                        byte[] buffer = new byte[4096];
-                        for (int n = 0; -1 != (n = cipherStream.read(buffer));)
-                        {
-                            output.write(buffer, 0, n);
-                        }
-                    }
-                    finally
+                    byte[] buffer = new byte[256];
+                    for (int n = 0; -1 != (n = data.read(buffer));)
                     {
-                        cipherStream.close();
+                        output.write(decryptCipher.update(buffer,0, n ));
                     }
                 }
                 catch (InvalidKeyException e)
