diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/PDFXrefStreamParser.java b/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/PDFXrefStreamParser.java
index 15ba334bbd..3c6e5e92b7 100755
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/PDFXrefStreamParser.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/PDFXrefStreamParser.java
@@ -19,6 +19,7 @@ package org.apache.pdfbox.pdfparser;
 import java.io.IOException;
 
 import java.util.ArrayList;
+import java.util.Arrays;
 import java.util.Iterator;
 import java.util.List;
 
@@ -75,6 +76,10 @@ public class PDFXrefStreamParser extends BaseParser
         {
             w[i] = wArray.getInt(i, 0);
         }
+        if (w[0] < 0 || w[1] < 0 || w[2] < 0)
+        {
+            throw new IOException("Incorrect /W array in XRef: " + Arrays.toString(w));
+        }
 
         COSArray indexArray = stream.getCOSArray(COSName.INDEX);
         if (indexArray == null)
@@ -177,5 +182,4 @@ public class PDFXrefStreamParser extends BaseParser
         }
         return value;
     }
-
-}
\ No newline at end of file
+}
