diff --git a/pdfbox/src/main/java/org/apache/pdfbox/ExtractImages.java b/pdfbox/src/main/java/org/apache/pdfbox/ExtractImages.java
index 241e7b457c..4ced8eeb4a 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/ExtractImages.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/ExtractImages.java
@@ -141,15 +141,14 @@ public class ExtractImages
                         {
                             StandardDecryptionMaterial spm = new StandardDecryptionMaterial(password);
                             document.openProtection(spm);
-                            AccessPermission ap = document.getCurrentAccessPermission();
-    
-                            if( ! ap.canExtractContent() )
-                            {
-                                throw new IOException(
-                                    "Error: You do not have permission to extract images." );
-                            }
                         }
                     }
+                    AccessPermission ap = document.getCurrentAccessPermission();
+                    if( ! ap.canExtractContent() )
+                    {
+                        throw new IOException(
+                            "Error: You do not have permission to extract images." );
+                    }
 
                     List pages = document.getDocumentCatalog().getAllPages();
                     Iterator iter = pages.iterator();
diff --git a/pdfbox/src/main/java/org/apache/pdfbox/ExtractText.java b/pdfbox/src/main/java/org/apache/pdfbox/ExtractText.java
index 7e54ecfa18..f42bda6b6c 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/ExtractText.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/ExtractText.java
@@ -213,14 +213,15 @@ public class ExtractText
                     {
                         StandardDecryptionMaterial sdm = new StandardDecryptionMaterial( password );
                         document.openProtection( sdm );
-                        AccessPermission ap = document.getCurrentAccessPermission();
-
-                        if( ! ap.canExtractContent() )
-                        {
-                            throw new IOException( "You do not have permission to extract text" );
-                        }
                     }
                 }
+                
+                AccessPermission ap = document.getCurrentAccessPermission();
+                if( ! ap.canExtractContent() )
+                {
+                    throw new IOException( "You do not have permission to extract text" );
+                }
+                
                 stopProcessing("Time for loading: ", startTime);
 
 
diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/NonSequentialPDFParser.java b/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/NonSequentialPDFParser.java
index 784aeeb966..f32c92708d 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/NonSequentialPDFParser.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/NonSequentialPDFParser.java
@@ -53,6 +53,7 @@ import org.apache.pdfbox.io.PushBackInputStream;
 import org.apache.pdfbox.io.RandomAccess;
 import org.apache.pdfbox.io.RandomAccessBuffer;
 import org.apache.pdfbox.io.RandomAccessBufferedFileInputStream;
+import org.apache.pdfbox.pdmodel.PDDocument;
 import org.apache.pdfbox.pdmodel.PDPage;
 import org.apache.pdfbox.pdmodel.encryption.AccessPermission;
 import org.apache.pdfbox.pdmodel.encryption.DecryptionMaterial;
@@ -302,10 +303,6 @@ public class NonSequentialPDFParser extends PDFParser
                 {
                     LOG.warn( "PDF file '" + pdfFile.getPath() + "' does not allow extracting content." );
                 }
-                else
-                {
-                    LOG.info( "PDF file '" + pdfFile.getPath() + "' allows content extraction." );
-                }
                   
             }
             catch ( Exception e )
@@ -621,6 +618,27 @@ public class NonSequentialPDFParser extends PDFParser
         return securityHandler;
     }
 
+    // ------------------------------------------------------------------------
+    /**
+     * This will get the PD document that was parsed.  When you are done with
+     * this document you must call close() on it to release resources.
+     *
+     * Overwriting super method was necessary in order to set security handler.
+     *
+     * @return The document at the PD layer.
+     *
+     * @throws IOException If there is an error getting the document.
+     */
+    @Override
+    public PDDocument getPDDocument() throws IOException
+    {
+        PDDocument pdDocument = super.getPDDocument();
+        if ( securityHandler != null )
+            pdDocument.setSecurityHandler( securityHandler );
+        
+        return pdDocument;
+    }
+
     // ------------------------------------------------------------------------
     /**
      * Returns the number of pages in a document.
diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDDocument.java b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDDocument.java
index 5521d69b34..fbbd29535c 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDDocument.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDDocument.java
@@ -1402,6 +1402,23 @@ public class PDDocument implements Pageable
     {
         return securityHandler;
     }
+    
+    /**
+     * Sets security handler if none is set already.
+     * 
+     * @param _sHandler  security handler to be assigned to document
+     * @return  <code>true</code> if security handler was set, <code>false</code>
+     *          otherwise (a security handler was already set)
+     */
+    public boolean setSecurityHandler( SecurityHandler _sHandler )
+    {
+        if ( securityHandler == null )
+        {
+            securityHandler = _sHandler;
+            return true;
+        }
+        return false;
+    }
 
     public boolean isAllSecurityToBeRemoved() {
         return allSecurityToBeRemoved;
