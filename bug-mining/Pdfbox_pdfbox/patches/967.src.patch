diff --git a/pdfbox/src/main/java/org/apache/pdfbox/contentstream/PDFStreamEngine.java b/pdfbox/src/main/java/org/apache/pdfbox/contentstream/PDFStreamEngine.java
index 171cf0d3f7..a0c0d5e35b 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/contentstream/PDFStreamEngine.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/contentstream/PDFStreamEngine.java
@@ -77,7 +77,7 @@ public class PDFStreamEngine
     private Matrix textMatrix;
     private Matrix textLineMatrix;
 
-    private final Stack<PDGraphicsState> graphicsStack = new Stack<PDGraphicsState>();
+    private Stack<PDGraphicsState> graphicsStack = new Stack<PDGraphicsState>();
 
     private PDResources resources;
     private PDPage currentPage;
@@ -202,7 +202,7 @@ public class PDFStreamEngine
         }
 
         PDResources parent = pushResources(group);
-        saveGraphicsState();
+        Stack<PDGraphicsState> savedStack = saveGraphicsStack();
 
         // transform the CTM using the stream's matrix
         getGraphicsState().getCurrentTransformationMatrix().concatenate(group.getMatrix());
@@ -212,7 +212,7 @@ public class PDFStreamEngine
 
         processStreamOperators(group);
 
-        restoreGraphicsState();
+        restoreGraphicsStack(savedStack);
         popResources(parent);
     }
 
@@ -232,7 +232,7 @@ public class PDFStreamEngine
         }
 
         PDResources parent = pushResources(charProc);
-        saveGraphicsState();
+        Stack<PDGraphicsState> savedStack = saveGraphicsStack();
 
         // replace the CTM with the TRM
         getGraphicsState().setCurrentTransformationMatrix(textRenderingMatrix);
@@ -254,7 +254,7 @@ public class PDFStreamEngine
         textMatrix = textMatrixOld;
         textLineMatrix = textLineMatrixOld;
 
-        restoreGraphicsState();
+        restoreGraphicsStack(savedStack);
         popResources(parent);
     }
 
@@ -268,7 +268,7 @@ public class PDFStreamEngine
             throws IOException
     {
         PDResources parent = pushResources(appearance);
-        saveGraphicsState();
+        Stack<PDGraphicsState> savedStack = saveGraphicsStack();
 
         PDRectangle bbox = appearance.getBBox();
         PDRectangle rect = annotation.getRectangle();
@@ -300,8 +300,8 @@ public class PDFStreamEngine
 
             processStreamOperators(appearance);
         }
-
-        restoreGraphicsState();
+        
+        restoreGraphicsStack(savedStack);
         popResources(parent);
     }
 
@@ -337,7 +337,7 @@ public class PDFStreamEngine
         initialMatrix = Matrix.concatenate(initialMatrix, patternMatrix);
 
         // save the original graphics state
-        saveGraphicsState();
+        Stack<PDGraphicsState> savedStack = saveGraphicsStack();
 
         // save a clean state (new clipping path, line path, etc.)
         Rectangle2D bbox = tilingPattern.getBBox().transform(patternMatrix).getBounds2D();
@@ -364,8 +364,7 @@ public class PDFStreamEngine
         processStreamOperators(tilingPattern);
 
         initialMatrix = parentMatrix;
-        restoreGraphicsState(); // restores clean state
-        restoreGraphicsState(); // restores original state
+        restoreGraphicsStack(savedStack);
         popResources(parent);
     }
 
@@ -423,7 +422,7 @@ public class PDFStreamEngine
     private void processStream(PDContentStream contentStream) throws IOException
     {
         PDResources parent = pushResources(contentStream);
-        saveGraphicsState();
+        Stack<PDGraphicsState> savedStack = saveGraphicsStack();
         Matrix parentMatrix = initialMatrix;
 
         // transform the CTM using the stream's matrix
@@ -439,7 +438,7 @@ public class PDFStreamEngine
         processStreamOperators(contentStream);
 
         initialMatrix = parentMatrix;
-        restoreGraphicsState();
+        restoreGraphicsStack(savedStack);
         popResources(parent);
     }
 
@@ -871,6 +870,25 @@ public class PDFStreamEngine
         graphicsStack.pop();
     }
 
+    /**
+     * Saves the entire graphics stack.
+     */
+    protected final Stack<PDGraphicsState> saveGraphicsStack()
+    {
+        Stack<PDGraphicsState> savedStack = graphicsStack;
+        graphicsStack = new Stack<PDGraphicsState>();
+        graphicsStack.add(savedStack.peek().clone());
+        return savedStack;
+    }
+
+    /**
+     * Restores the entire graphics stack.
+     */
+    protected final void restoreGraphicsStack(Stack<PDGraphicsState> snapshot)
+    {
+        graphicsStack = snapshot;
+    }
+    
     /**
      * @return Returns the size of the graphicsStack.
      */
