diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/pattern/PDTilingPattern.java b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/pattern/PDTilingPattern.java
index b123332126..c2d31d41dd 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/pattern/PDTilingPattern.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/pattern/PDTilingPattern.java
@@ -129,9 +129,7 @@ public class PDTilingPattern extends PDAbstractPattern implements PDContentStrea
      */
     public float getXStep()
     {
-        // ignores invalid values, see PDFBOX-1094-065514-XStep32767.pdf
-        float xStep = getCOSObject().getFloat( COSName.X_STEP, 0 );
-        return xStep >= Short.MAX_VALUE ? 0 : xStep;
+        return getCOSObject().getFloat(COSName.X_STEP, 0);
     }
 
     /**
@@ -149,9 +147,7 @@ public class PDTilingPattern extends PDAbstractPattern implements PDContentStrea
      */
     public float getYStep()
     {
-        // ignores invalid values, see PDFBOX-1094-065514-XStep32767.pdf
-        float yStep = getCOSObject().getFloat( COSName.Y_STEP, 0 );
-        return yStep >= Short.MAX_VALUE ? 0 : yStep;
+        return getCOSObject().getFloat(COSName.Y_STEP, 0);
     }
     
     public PDStream getContentStream()
diff --git a/pdfbox/src/main/java/org/apache/pdfbox/rendering/TilingPaint.java b/pdfbox/src/main/java/org/apache/pdfbox/rendering/TilingPaint.java
index 2e3b6d243c..06e6c22d90 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/rendering/TilingPaint.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/rendering/TilingPaint.java
@@ -212,11 +212,28 @@ class TilingPaint implements Paint
 
         float xScale = patternMatrix.getScalingFactorX();
         float yScale = patternMatrix.getScalingFactorY();
+        float width = xStep * xScale;
+        float height = yStep * yScale;
+
+        int MAX = 5000;
+        if (Math.abs(width * height) > MAX * MAX)
+        {
+            // PDFBOX-3653: prevent huge sizes
+            LOG.info("Pattern surface is too large, will be clipped");
+            LOG.info("width: " + width + ", height: " + height);
+            LOG.info("XStep: " + xStep + ", YStep: " + yStep);
+            LOG.info("bbox: " + pattern.getBBox());
+            LOG.info("pattern matrix: " + pattern.getMatrix());
+            LOG.info("concatenated matrix: " + patternMatrix);
+            width = Math.min(MAX, Math.abs(width)) * Math.signum(width);
+            height = Math.min(MAX, Math.abs(height)) * Math.signum(height);
+            //TODO better solution needed
+        }
 
         // returns the anchor rect with scaling applied
         PDRectangle anchor = pattern.getBBox();
         return new Rectangle2D.Float(anchor.getLowerLeftX() * xScale,
                                      anchor.getLowerLeftY() * yScale,
-                                     xStep * xScale, yStep * yScale);
+                                     width, height);
     }
 }
