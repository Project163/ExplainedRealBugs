diff --git a/pdfbox/src/main/java/org/apache/pdfbox/io/RandomAccessReadBuffer.java b/pdfbox/src/main/java/org/apache/pdfbox/io/RandomAccessReadBuffer.java
index e347502d70..f8e55b379c 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/io/RandomAccessReadBuffer.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/io/RandomAccessReadBuffer.java
@@ -105,7 +105,8 @@ public class RandomAccessReadBuffer implements RandomAccessRead
         int remainingBytes = chunkSize;
         int offset = 0;
         byte[] eofCheck = new byte[1];
-        while ((bytesRead = input.read(currentBuffer.array(), offset, remainingBytes)) > -1)
+        while (remainingBytes > 0 &&
+                (bytesRead = input.read(currentBuffer.array(), offset, remainingBytes)) > -1)
         {
             remainingBytes -= bytesRead;
             offset += bytesRead;
diff --git a/pdfbox/src/test/java/org/apache/pdfbox/io/RandomAccessReadBufferTest.java b/pdfbox/src/test/java/org/apache/pdfbox/io/RandomAccessReadBufferTest.java
index 946b18d6ea..7ef40a01d7 100644
--- a/pdfbox/src/test/java/org/apache/pdfbox/io/RandomAccessReadBufferTest.java
+++ b/pdfbox/src/test/java/org/apache/pdfbox/io/RandomAccessReadBufferTest.java
@@ -24,7 +24,10 @@ import java.io.ByteArrayInputStream;
 import java.io.ByteArrayOutputStream;
 import java.io.IOException;
 import java.io.InputStream;
+import java.io.OutputStream;
 import java.net.URL;
+import java.nio.file.Files;
+import java.nio.file.Path;
 
 import org.junit.jupiter.api.Assertions;
 
@@ -209,4 +212,27 @@ class RandomAccessReadBufferTest
             randomAccessSource.close();
         }
     }
+
+    /**
+     * PDFBOX-5158: endless loop reading a stream of a multiple of 4096 bytes from a
+     * FileInputStream. Test does not fail with a ByteArrayInputStream, so we need to create a temp
+     * file.
+     *
+     * @throws IOException
+     */
+    @Test
+    void testPDFBOX5158() throws IOException
+    {
+        Path path = Files.createTempFile("len4096", ".pdf");
+        try (OutputStream os = Files.newOutputStream(path))
+        {
+            os.write(new byte[4096]);
+        }
+        assertEquals(4096, path.toFile().length());
+        try (RandomAccessRead rar = new RandomAccessReadBuffer(Files.newInputStream(path)))
+        {
+            assertEquals(0, rar.read());
+        }
+        Files.delete(path);
+    }
 }
