diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/color/PDCalGray.java b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/color/PDCalGray.java
index ce8bc51c2b..0ffd554de8 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/color/PDCalGray.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/color/PDCalGray.java
@@ -64,7 +64,7 @@ public final class PDCalGray extends PDCalRGB
     }
 
     @Override
-    public float[] getDefaultDecode()
+    public float[] getDefaultDecode(int bitsPerComponent)
     {
         return new float[] { 0, 1 };
     }
diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/color/PDCalRGB.java b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/color/PDCalRGB.java
index bc4487d75e..573c9a8748 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/color/PDCalRGB.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/color/PDCalRGB.java
@@ -74,7 +74,7 @@ public class PDCalRGB extends PDCIEBasedColorSpace
     }
 
     @Override
-    public float[] getDefaultDecode()
+    public float[] getDefaultDecode(int bitsPerComponent)
     {
         return new float[] { 0, 1, 0, 1, 0, 1 };
     }
diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/color/PDColorSpace.java b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/color/PDColorSpace.java
index 9d955f3a0b..7008d2227c 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/color/PDColorSpace.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/color/PDColorSpace.java
@@ -169,7 +169,7 @@ public abstract class PDColorSpace implements COSObjectable
      * Returns the default decode array for this color space.
      * @return the default decode array
      */
-    public abstract float[] getDefaultDecode();
+    public abstract float[] getDefaultDecode(int bitsPerComponent);
 
     /**
      * Returns the initial color value for this color space.
diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/color/PDDeviceCMYK.java b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/color/PDDeviceCMYK.java
index c28f95bde5..44c5ca2629 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/color/PDDeviceCMYK.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/color/PDDeviceCMYK.java
@@ -99,7 +99,7 @@ public final class PDDeviceCMYK extends PDDeviceColorSpace
     }
 
     @Override
-    public float[] getDefaultDecode()
+    public float[] getDefaultDecode(int bitsPerComponent)
     {
         return new float[] { 0, 1, 0, 1, 0, 1, 0, 1 };
     }
diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/color/PDDeviceGray.java b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/color/PDDeviceGray.java
index 5c42d0fabc..35e26c266c 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/color/PDDeviceGray.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/color/PDDeviceGray.java
@@ -60,7 +60,7 @@ public final class PDDeviceGray extends PDDeviceColorSpace
     }
 
     @Override
-    public float[] getDefaultDecode()
+    public float[] getDefaultDecode(int bitsPerComponent)
     {
         return new float[] { 0, 1 };
     }
diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/color/PDDeviceN.java b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/color/PDDeviceN.java
index b4e9cb3a2a..0abaa16014 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/color/PDDeviceN.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/color/PDDeviceN.java
@@ -424,7 +424,7 @@ public class PDDeviceN extends PDSpecialColorSpace
     }
 
     @Override
-    public float[] getDefaultDecode()
+    public float[] getDefaultDecode(int bitsPerComponent)
     {
         int n = getNumberOfComponents();
         float[] decode = new float[n * 2];
diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/color/PDDeviceRGB.java b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/color/PDDeviceRGB.java
index 2fd23431ce..a6805ab0d6 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/color/PDDeviceRGB.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/color/PDDeviceRGB.java
@@ -65,7 +65,7 @@ public final class PDDeviceRGB extends PDDeviceColorSpace
     }
 
     @Override
-    public float[] getDefaultDecode()
+    public float[] getDefaultDecode(int bitsPerComponent)
     {
         return new float[] { 0, 1, 0, 1, 0, 1 };
     }
diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/color/PDICCBased.java b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/color/PDICCBased.java
index e901ccf7a8..d62edd3528 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/color/PDICCBased.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/color/PDICCBased.java
@@ -186,7 +186,7 @@ public final class PDICCBased extends PDCIEBasedColorSpace
     }
 
     @Override
-    public float[] getDefaultDecode()
+    public float[] getDefaultDecode(int bitsPerComponent)
     {
         if (awtColorSpace != null)
         {
@@ -201,7 +201,7 @@ public final class PDICCBased extends PDCIEBasedColorSpace
         }
         else
         {
-            return alternateColorSpace.getDefaultDecode();
+            return alternateColorSpace.getDefaultDecode(bitsPerComponent);
         }
     }
 
diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/color/PDIndexed.java b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/color/PDIndexed.java
index ee99a01639..34fc4eba61 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/color/PDIndexed.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/color/PDIndexed.java
@@ -90,10 +90,9 @@ public final class PDIndexed extends PDSpecialColorSpace
     }
 
     @Override
-    public float[] getDefaultDecode()
+    public float[] getDefaultDecode(int bitsPerComponent)
     {
-        int n = getNumberOfComponents();
-        return new float[] { 0, (float)Math.pow(2, n - 1) };
+        return new float[] { 0, (float)Math.pow(2, bitsPerComponent) - 1 };
     }
 
     @Override
@@ -172,7 +171,8 @@ public final class PDIndexed extends PDSpecialColorSpace
         BufferedImage rgbImage = new BufferedImage(width, height, BufferedImage.TYPE_INT_RGB);
         WritableRaster rgbRaster = rgbImage.getRaster();
 
-        float[] src = new float[1];
+        final int hival = gettHival();
+        int[] src = new int[1];
         for (int y = 0; y < height; y++)
         {
             for (int x = 0; x < width; x++)
@@ -180,10 +180,10 @@ public final class PDIndexed extends PDSpecialColorSpace
                 raster.getPixel(x, y, src);
 
                 // scale to 0..1
-                src[0] = src[0] / 255;
+                //src[0] = src[0] / 255f;
 
                 // scale to 0..hival and lookup
-                int index = Math.min(Math.round(src[0] * actualMaxIndex), actualMaxIndex);
+                int index = Math.min(src[0], actualMaxIndex);  //         ARRRRRGH WHY WONT ALTONA P9 WORK!?!?!?!
                 rgbRaster.setPixel(x, y, rgbColorTable[index]);
             }
         }
diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/color/PDJPXColorSpace.java b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/color/PDJPXColorSpace.java
index 1157c7c0f8..f1760c637b 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/color/PDJPXColorSpace.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/color/PDJPXColorSpace.java
@@ -55,7 +55,7 @@ public final class PDJPXColorSpace extends PDColorSpace
     }
 
     @Override
-    public float[] getDefaultDecode()
+    public float[] getDefaultDecode(int bitsPerComponent)
     {
         int n = getNumberOfComponents();
         float[] decode = new float[n * 2];
diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/color/PDLab.java b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/color/PDLab.java
index a2e543132d..8eba9205a0 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/color/PDLab.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/color/PDLab.java
@@ -134,7 +134,7 @@ public final class PDLab extends PDCIEBasedColorSpace
     }
 
     @Override
-    public float[] getDefaultDecode()
+    public float[] getDefaultDecode(int bitsPerComponent)
     {
         PDRange a = getARange();
         PDRange b = getARange();
diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/color/PDPattern.java b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/color/PDPattern.java
index db904ee330..68ea511db4 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/color/PDPattern.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/color/PDPattern.java
@@ -76,7 +76,7 @@ public final class PDPattern extends PDSpecialColorSpace
     }
 
     @Override
-    public float[] getDefaultDecode()
+    public float[] getDefaultDecode(int bitsPerComponent)
     {
         throw new UnsupportedOperationException();
     }
diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/color/PDSeparation.java b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/color/PDSeparation.java
index ac9d93efcd..756241a7c0 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/color/PDSeparation.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/color/PDSeparation.java
@@ -85,7 +85,7 @@ public class PDSeparation extends PDSpecialColorSpace
     }
 
     @Override
-    public float[] getDefaultDecode()
+    public float[] getDefaultDecode(int bitsPerComponent)
     {
         return new float[] { 0, 1 };
     }
diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/image/SampledImageReader.java b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/image/SampledImageReader.java
index cda8bc3063..8eb0016cdc 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/image/SampledImageReader.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/image/SampledImageReader.java
@@ -29,6 +29,7 @@ import org.apache.commons.logging.Log;
 import org.apache.commons.logging.LogFactory;
 import org.apache.pdfbox.cos.COSArray;
 import org.apache.pdfbox.pdmodel.graphics.color.PDColorSpace;
+import org.apache.pdfbox.pdmodel.graphics.color.PDIndexed;
 
 import javax.imageio.stream.ImageInputStream;
 import javax.imageio.stream.MemoryCacheImageInputStream;
@@ -131,6 +132,7 @@ final class SampledImageReader
         {
             iis = new MemoryCacheImageInputStream(pdImage.getStream().createInputStream());
             final float sampleMax = (float)Math.pow(2, bitsPerComponent) - 1f;
+            final boolean isIndexed = colorSpace instanceof PDIndexed;
 
             int padding = 0;
             if (width * numComponents * bitsPerComponent % 8 > 0)
@@ -154,11 +156,21 @@ final class SampledImageReader
                         // interpolate to domain
                         float output = dMin + (value * ((dMax - dMin) / sampleMax));
 
-                        // interpolate to TYPE_BYTE
-                        int outputByte = Math.round(((output - Math.min(dMin, dMax)) /
-                                                     Math.abs(dMax - dMin)) * 255f);
-
-                        srcColorValues[c] = (byte)outputByte;
+                        if (isIndexed)
+                        {
+                            // indexed color spaces get the raw value, because the TYPE_BYTE
+                            // below cannot be reversed by the color space without it having
+                            // knowledge of the number of bits per component
+                            srcColorValues[c] = (byte)Math.round(output);
+                        }
+                        else
+                        {
+                            // interpolate to TYPE_BYTE
+                            int outputByte = Math.round(((output - Math.min(dMin, dMax)) /
+                                    Math.abs(dMax - dMin)) * 255f);
+
+                            srcColorValues[c] = (byte)outputByte;
+                        }
                     }
 
                     raster.setDataElements(x, y, srcColorValues);
@@ -212,7 +224,7 @@ final class SampledImageReader
         // use color space default
         if (decode == null)
         {
-            return pdImage.getColorSpace().getDefaultDecode();
+            return pdImage.getColorSpace().getDefaultDecode(pdImage.getBitsPerComponent());
         }
 
         return decode;
