diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/PDFXRefStream.java b/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/PDFXRefStream.java
index 5a5f470547..e1a6ed3dc0 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/PDFXRefStream.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/PDFXRefStream.java
@@ -111,6 +111,11 @@ public class PDFXRefStream implements PDFXRef
             {
                 continue;
             }
+            // this one too, because it has already been written in COSWriter.doWriteBody()
+            if (COSName.ENCRYPT.equals(cosName))
+            {
+                continue;
+            }
             COSBase dictionaryObject = this.stream.getDictionaryObject(cosName);
             dictionaryObject.setDirect(true);
         }
