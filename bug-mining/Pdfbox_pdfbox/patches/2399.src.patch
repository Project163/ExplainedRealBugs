diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/image/PDImageXObject.java b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/image/PDImageXObject.java
index 166b234798..a10429f035 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/image/PDImageXObject.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/image/PDImageXObject.java
@@ -484,6 +484,11 @@ public final class PDImageXObject extends PDXObject implements PDImage
             // see PDF specification 1.7, 11.6.5.3 Soft-Mask Images
             matte = ((COSArray) base).toFloatArray();
             // convert to RGB
+            if (matte.length < getColorSpace().getNumberOfComponents())
+            {
+                LOG.error("Image /Matte entry not long enough for colorspace, skipped");
+                return null;
+            }
             matte = getColorSpace().toRGB(matte);
         }
         return matte;
