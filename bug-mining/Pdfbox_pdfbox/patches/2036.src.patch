diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/COSParser.java b/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/COSParser.java
index 9c3314e613..efc31f1a3a 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/COSParser.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/COSParser.java
@@ -2303,6 +2303,11 @@ public class COSParser extends BaseParser
             List<? extends COSBase> kidsList = kidsArray.toList();
             for (COSBase kid : kidsList)
             {
+                if (!(kid instanceof COSObject))
+                {
+                    kidsArray.remove(kid);
+                    continue;
+                }
                 COSObject kidObject = (COSObject) kid;
                 if (set.contains(kidObject))
                 {
