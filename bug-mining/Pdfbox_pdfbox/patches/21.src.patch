diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/PDFStreamParser.java b/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/PDFStreamParser.java
index 230fc75dab..f8a775171c 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/PDFStreamParser.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/PDFStreamParser.java
@@ -17,11 +17,12 @@
 package org.apache.pdfbox.pdfparser;
 
 import java.io.ByteArrayOutputStream;
-import java.io.InputStream;
 import java.io.IOException;
-
+import java.io.InputStream;
 import java.util.ArrayList;
+import java.util.Iterator;
 import java.util.List;
+import java.util.NoSuchElementException;
 
 import org.apache.pdfbox.cos.COSBase;
 import org.apache.pdfbox.cos.COSBoolean;
@@ -32,10 +33,9 @@ import org.apache.pdfbox.cos.COSNumber;
 import org.apache.pdfbox.cos.COSObject;
 import org.apache.pdfbox.cos.COSStream;
 import org.apache.pdfbox.io.RandomAccess;
-
 import org.apache.pdfbox.pdmodel.common.PDStream;
-import org.apache.pdfbox.util.PDFOperator;
 import org.apache.pdfbox.util.ImageParameters;
+import org.apache.pdfbox.util.PDFOperator;
 
 /**
  * This will parse a PDF byte stream and extract operands and such.
@@ -119,6 +119,68 @@ public class PDFStreamParser extends BaseParser
     {
         return streamObjects;
     }
+    
+    public void close() throws IOException
+    {
+    	pdfSource.close();
+    }
+
+    /**
+     * This will get an iterator which can be used to parse the stream
+     * one token after the other.
+     * 
+     * @return an iterator to get one token after the other
+     */
+    public Iterator<Object> getTokenIterator()
+    {
+        return new Iterator<Object>()
+        {
+			private Object	token;
+			
+			private void tryNext()
+			{
+				try {
+					if(token == null)
+					{
+						token = parseNextToken();
+					}
+				} catch (IOException e) {
+					throw new RuntimeException(e);
+				}
+			}
+
+		    /**
+		     * {@inheritDoc}
+		     */
+			public boolean hasNext() 
+			{
+				tryNext();
+				return token != null;
+			}
+
+		    /**
+		     * {@inheritDoc}
+		     */
+			public Object next() {
+				tryNext();
+				Object tmp = token;
+				if(tmp == null)
+				{
+					throw new NoSuchElementException();
+				}
+				token = null;
+				return tmp;
+			}
+
+		    /**
+		     * {@inheritDoc}
+		     */
+			public void remove() 
+			{
+				throw new UnsupportedOperationException();
+			}
+        };
+    }
 
     /**
      * This will parse the next token in the stream.
diff --git a/pdfbox/src/main/java/org/apache/pdfbox/util/PDFStreamEngine.java b/pdfbox/src/main/java/org/apache/pdfbox/util/PDFStreamEngine.java
index 0103b17cc2..79ef37abe4 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/util/PDFStreamEngine.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/util/PDFStreamEngine.java
@@ -37,6 +37,7 @@ import org.apache.pdfbox.cos.COSObject;
 import org.apache.pdfbox.cos.COSStream;
 import org.apache.pdfbox.exceptions.WrappedIOException;
 
+import org.apache.pdfbox.pdfparser.PDFStreamParser;
 import org.apache.pdfbox.pdmodel.PDPage;
 import org.apache.pdfbox.pdmodel.PDResources;
 
@@ -219,6 +220,7 @@ public class PDFStreamEngine
     public void processSubStream( PDPage aPage, PDResources resources, COSStream cosStream ) throws IOException
     {
         page = aPage;
+        PDFStreamParser parser = null;
         if( resources != null )
         {
             StreamResources sr = new StreamResources();
@@ -232,35 +234,37 @@ public class PDFStreamEngine
         try
         {
             List arguments = new ArrayList();
-            List tokens = cosStream.getStreamTokens();
-            if( tokens != null )
+            
+            parser = new PDFStreamParser( cosStream );
+            Iterator<Object> iter = parser.getTokenIterator();
+
+            while( iter.hasNext() )
             {
-                Iterator iter = tokens.iterator();
-                while( iter.hasNext() )
+                Object next = iter.next();
+                if( next instanceof COSObject )
+                {
+                    arguments.add( ((COSObject)next).getObject() );
+                }
+                else if( next instanceof PDFOperator )
+                {
+                    processOperator( (PDFOperator)next, arguments );
+                    arguments = new ArrayList();
+                }
+                else
+                {
+                    arguments.add( next );
+                }
+                if(log.isDebugEnabled())
                 {
-                    Object next = iter.next();
-                    if( next instanceof COSObject )
-                    {
-                        arguments.add( ((COSObject)next).getObject() );
-                    }
-                    else if( next instanceof PDFOperator )
-                    {
-                        processOperator( (PDFOperator)next, arguments );
-                        arguments = new ArrayList();
-                    }
-                    else
-                    {
-                        arguments.add( next );
-                    }
-                    if(log.isDebugEnabled())
-                    {
-                        log.debug("token: " + next);
-                    }
+                    log.debug("token: " + next);
                 }
             }
         }
         finally
         {
+            if (parser != null) {
+                parser.close();
+            }
             if( resources != null )
             {
                 streamResourcesStack.pop();
