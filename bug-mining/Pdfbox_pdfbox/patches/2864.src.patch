diff --git a/pdfbox/src/main/java/org/apache/pdfbox/cos/COSArray.java b/pdfbox/src/main/java/org/apache/pdfbox/cos/COSArray.java
index 0b1af34d07..0f7604567e 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/cos/COSArray.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/cos/COSArray.java
@@ -780,7 +780,6 @@ public class COSArray extends COSBase implements Iterable<COSBase>, COSUpdateInf
             }
             if (cosBase instanceof COSObject)
             {
-                indirectObjects.add(cosBaseKey);
                 // dereference object
                 cosBase = ((COSObject) cosBase).getObject();
             }
@@ -794,6 +793,11 @@ public class COSArray extends COSBase implements Iterable<COSBase>, COSUpdateInf
                 // descend to included array to collect all included indirect objects
                 ((COSArray) cosBase).getIndirectObjectKeys(indirectObjects);
             }
+            else if (cosBaseKey != null)
+            {
+                // add key for all indirect objects other than COSDictionary/COSArray
+                indirectObjects.add(cosBaseKey);
+            }
         }
     }
 
diff --git a/pdfbox/src/main/java/org/apache/pdfbox/cos/COSDictionary.java b/pdfbox/src/main/java/org/apache/pdfbox/cos/COSDictionary.java
index 1d83b7de6a..535a34a045 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/cos/COSDictionary.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/cos/COSDictionary.java
@@ -1461,7 +1461,6 @@ public class COSDictionary extends COSBase implements COSUpdateInfo
             }
             if (cosBase instanceof COSObject)
             {
-                indirectObjects.add(cosBaseKey);
                 // dereference object
                 cosBase = ((COSObject) cosBase).getObject();
             }
@@ -1475,6 +1474,11 @@ public class COSDictionary extends COSBase implements COSUpdateInfo
                 // descend to included array to collect all included indirect objects
                 ((COSArray) cosBase).getIndirectObjectKeys(indirectObjects);
             }
+            else if (cosBaseKey != null)
+            {
+                // add key for all indirect objects other than COSDictionary/COSArray
+                indirectObjects.add(cosBaseKey);
+            }
         }
     }
 
