diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/SecurityHandler.java b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/SecurityHandler.java
index bbe2d121f9..265c802a52 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/SecurityHandler.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/SecurityHandler.java
@@ -396,7 +396,7 @@ public abstract class SecurityHandler<T_POLICY extends ProtectionPolicy>
         {
             // read IV from stream
             int ivSize = (int) IOUtils.populateBuffer(data, iv);
-            if (ivSize == -1)
+            if (ivSize == 0)
             {
                 return false;
             }
