diff --git a/pdfbox/src/main/java/org/apache/pdfbox/multipdf/PDFCloneUtility.java b/pdfbox/src/main/java/org/apache/pdfbox/multipdf/PDFCloneUtility.java
index 4d9d4314c3..ff9d3fbdce 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/multipdf/PDFCloneUtility.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/multipdf/PDFCloneUtility.java
@@ -194,10 +194,17 @@ class PDFCloneUtility
           }
           else if( base instanceof COSArray )
           {
-              COSArray array = (COSArray)base;
-              for( int i=0; i<array.size(); i++ )
+              if (target instanceof COSObject)
               {
-                  ((COSArray)target).add( cloneForNewDocument( array.get( i ) ) );
+                  cloneMerge(base, ((COSObject) target).getObject());
+              }
+              else
+              {
+                  COSArray array = (COSArray) base;
+                  for (int i = 0; i < array.size(); i++)
+                  {
+                      ((COSArray) target).add(cloneForNewDocument(array.get(i)));
+                  }
               }
           }
           else if( base instanceof COSStream )
@@ -218,19 +225,26 @@ class PDFCloneUtility
           }
           else if( base instanceof COSDictionary )
           {
-              COSDictionary dic = (COSDictionary)base;
-              clonedVersion.put( base, retval );
-              for( Map.Entry<COSName, COSBase> entry : dic.entrySet() )
+              if (target instanceof COSObject)
               {
-                  COSName key = entry.getKey();
-                  COSBase value = entry.getValue();
-                  if (((COSDictionary)target).getItem(key) != null)
-                  {
-                      cloneMerge(value, ((COSDictionary)target).getItem(key));
-                  }
-                  else
+                  cloneMerge(base, ((COSObject) target).getObject());
+              }
+              else
+              {
+                  COSDictionary dic = (COSDictionary) base;
+                  clonedVersion.put(base, retval);
+                  for (Map.Entry<COSName, COSBase> entry : dic.entrySet())
                   {
-                      ((COSDictionary)target).setItem( key, cloneForNewDocument(value));
+                      COSName key = entry.getKey();
+                      COSBase value = entry.getValue();
+                      if (((COSDictionary) target).getItem(key) != null)
+                      {
+                          cloneMerge(value, ((COSDictionary) target).getItem(key));
+                      }
+                      else
+                      {
+                          ((COSDictionary) target).setItem(key, cloneForNewDocument(value));
+                      }
                   }
               }
           }
diff --git a/pdfbox/src/test/java/org/apache/pdfbox/multipdf/PDFCloneUtilityTest.java b/pdfbox/src/test/java/org/apache/pdfbox/multipdf/PDFCloneUtilityTest.java
index bc32bf862c..2cc033f4d1 100644
--- a/pdfbox/src/test/java/org/apache/pdfbox/multipdf/PDFCloneUtilityTest.java
+++ b/pdfbox/src/test/java/org/apache/pdfbox/multipdf/PDFCloneUtilityTest.java
@@ -16,6 +16,7 @@
 package org.apache.pdfbox.multipdf;
 
 import java.awt.Color;
+import java.io.ByteArrayOutputStream;
 import java.io.File;
 import java.io.IOException;
 import junit.framework.TestCase;
@@ -25,6 +26,7 @@ import org.apache.pdfbox.Loader;
 import org.apache.pdfbox.pdmodel.PDPage;
 import org.apache.pdfbox.pdmodel.PDPageContentStream;
 import org.apache.pdfbox.pdmodel.PDPageContentStream.AppendMode;
+import org.apache.pdfbox.pdmodel.graphics.optionalcontent.PDOptionalContentProperties;
 
 /**
  * Test suite for PDFCloneUtility, see PDFBOX-2052.
@@ -103,4 +105,26 @@ public class PDFCloneUtilityTest extends TestCase
         Loader.loadPDF(new File(TESTDIR + CLONEDST)).close();
         Loader.loadPDF(new File(TESTDIR + CLONEDST), (String) null).close();
     }
-}
+
+    /**
+     * PDFBOX-4814: this tests merging a direct and an indirect COSDictionary, when "target" is
+     * indirect in cloneMerge().
+     *
+     * @throws IOException
+     */
+    public void testDirectIndirect() throws IOException
+    {
+        try (PDDocument doc1 = new PDDocument())
+        {
+            doc1.addPage(new PDPage());
+            doc1.getDocumentCatalog().setOCProperties(new PDOptionalContentProperties());
+            ByteArrayOutputStream baos = new ByteArrayOutputStream();
+            doc1.save(baos);
+            try (PDDocument doc2 = Loader.loadPDF(baos.toByteArray()))
+            {
+                PDFMergerUtility merger = new PDFMergerUtility();
+                merger.appendDocument(doc2, doc1);
+            }
+        }
+    }
+}
\ No newline at end of file
