diff --git a/pdfbox/src/main/java/org/apache/pdfbox/contentstream/operator/graphics/ShadingFill.java b/pdfbox/src/main/java/org/apache/pdfbox/contentstream/operator/graphics/ShadingFill.java
index a1b3ad32e6..0ada8a57f4 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/contentstream/operator/graphics/ShadingFill.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/contentstream/operator/graphics/ShadingFill.java
@@ -45,7 +45,12 @@ public final class ShadingFill extends GraphicsOperatorProcessor
         {
             throw new MissingOperandException(operator, operands);
         }
-        getGraphicsContext().shadingFill((COSName) operands.get(0));
+        COSBase base = operands.get(0);
+        if (!(base instanceof COSName))
+        {
+            throw new MissingOperandException(operator, operands);
+        }
+        getGraphicsContext().shadingFill((COSName) base);
     }
 
     @Override
