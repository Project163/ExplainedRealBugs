diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/PDEncryption.java b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/PDEncryption.java
index 3a3c0a3d3a..d356b20633 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/PDEncryption.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/PDEncryption.java
@@ -277,6 +277,15 @@ public class PDEncryption implements COSObjectable
         if( owner != null )
         {
             o = owner.getBytes();
+            int r = getRevision();
+            if (r <= 4)
+            {
+                o = Arrays.copyOf(o, 32);
+            }
+            else if (r == 6)
+            {
+                o = Arrays.copyOf(o, 48);
+            }
         }
         return o;
     }
@@ -307,6 +316,15 @@ public class PDEncryption implements COSObjectable
         if( user != null )
         {
             u = user.getBytes();
+            int r = getRevision();
+            if (r <= 4)
+            {
+                u = Arrays.copyOf(u, 32);
+            }
+            else if (r == 6)
+            {
+                u = Arrays.copyOf(u, 48);
+            }
         }
         return u;
     }
