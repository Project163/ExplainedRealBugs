diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdfwriter/COSWriter.java b/pdfbox/src/main/java/org/apache/pdfbox/pdfwriter/COSWriter.java
index 3e1abc8317..509e8f702d 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdfwriter/COSWriter.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdfwriter/COSWriter.java
@@ -717,7 +717,14 @@ public class COSWriter implements ICOSVisitor
 
     private void doWriteXRefInc(COSDocument doc, boolean hasHybridXRef) throws IOException
     {
-        if (doc.isXRefStream() || hasHybridXRef)
+        if (!doc.isXRefStream() || (hasHybridXRef && incrementalUpdate))
+        {
+            COSDictionary trailer = doc.getTrailer();
+            trailer.setLong(COSName.PREV, doc.getStartXref());
+            doWriteXRefTable();
+            doWriteTrailer(doc);
+        }
+        else
         {
             // the file uses XrefStreams, so we need to update
             // it with an xref stream. We create a new one and fill it
@@ -748,13 +755,6 @@ public class COSWriter implements ICOSVisitor
             COSStream stream2 = pdfxRefStream.getStream();
             doWriteObject(stream2);
         }
-        else
-        {
-            COSDictionary trailer = doc.getTrailer();
-            trailer.setLong(COSName.PREV, doc.getStartXref());
-            doWriteXRefTable();
-            doWriteTrailer(doc);
-        }
     }
 
     // writes the "xref" table
