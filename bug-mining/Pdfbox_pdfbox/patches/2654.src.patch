diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDPageTree.java b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDPageTree.java
index f176983953..9b1ec8d8bc 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDPageTree.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDPageTree.java
@@ -46,6 +46,8 @@ public class PDPageTree implements COSObjectable, Iterable<PDPage>
     private final COSDictionary root;
     private final PDDocument document; // optional
 
+    private final Set<COSDictionary> pageSet = new HashSet<>();
+
     /**
      * Constructor for embedding.
      */
@@ -278,7 +280,18 @@ public class PDPageTree implements COSObjectable, Iterable<PDPage>
         {
             throw new IndexOutOfBoundsException("Index out of bounds: " + pageNum);
         }
-
+        if (pageSet.contains(node))
+        {
+            pageSet.clear();
+            throw new IllegalStateException(
+                    "Possible recursion found when searching for page " + pageNum);
+        }
+        else
+        {
+            // collect already processed pages to detect possible recursions
+            // to avoid a StackOverflowError
+            pageSet.add(node);
+        }
         if (isPageTreeNode(node))
         {
             int count = node.getInt(COSName.COUNT, 0);
@@ -324,6 +337,7 @@ public class PDPageTree implements COSObjectable, Iterable<PDPage>
         {
             if (encountered == pageNum)
             {
+                pageSet.clear();
                 return node;
             }
             else
