diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDEmbeddedFilesNameTreeNode.java b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDEmbeddedFilesNameTreeNode.java
index a7463c0bf6..46cf7544a9 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDEmbeddedFilesNameTreeNode.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDEmbeddedFilesNameTreeNode.java
@@ -50,6 +50,10 @@ public class PDEmbeddedFilesNameTreeNode extends PDNameTreeNode<PDComplexFileSpe
     @Override
     protected PDComplexFileSpecification convertCOSToPD( COSBase base ) throws IOException
     {
+        if (!(base instanceof COSDictionary))
+        {
+            throw new IOException("dictionary expected here, but got " + base);
+        }
         return new PDComplexFileSpecification( (COSDictionary)base );
     }
 
