diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/SecurityHandler.java b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/SecurityHandler.java
index b0c3b6ec11..915af3d62a 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/SecurityHandler.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/SecurityHandler.java
@@ -334,15 +334,9 @@ public abstract class SecurityHandler
                     byte[] buffer = new byte[256];
                     for (int n = 0; -1 != (n = data.read(buffer));)
                     {
-                        if (data.available() > 0)
-                        {
-                            output.write(decryptCipher.update(buffer,0, n ));
-                        }
-                        else
-                        {
-                            output.write(decryptCipher.doFinal(buffer,0, n ));
-                        }
+                        output.write(decryptCipher.update(buffer,0, n ));
                     }
+                    output.write(decryptCipher.doFinal());
                 }
                 catch (InvalidKeyException e)
                 {
