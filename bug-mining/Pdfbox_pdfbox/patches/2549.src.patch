diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdfwriter/COSWriter.java b/pdfbox/src/main/java/org/apache/pdfbox/pdfwriter/COSWriter.java
index b620b71f95..8222b402ff 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdfwriter/COSWriter.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdfwriter/COSWriter.java
@@ -1056,10 +1056,11 @@ public class COSWriter implements ICOSVisitor
     private COSObjectKey getObjectKey( COSBase obj )
     {
         COSBase actual = obj;
+        COSObjectKey key = null;
         if( actual instanceof COSObject )
         {
             actual = ((COSObject) obj).getObject();
-            COSObjectKey key = obj.getKey();
+            key = obj.getKey();
             if (key != null)
             {
                 objectKeys.put(obj, key);
@@ -1068,15 +1069,9 @@ public class COSWriter implements ICOSVisitor
         }
         // PDFBOX-4540: because objectKeys is accessible from outside, it is possible
         // that a COSObject obj is already in the objectKeys map.
-        COSObjectKey key = actual != null ? objectKeys.get(actual) : null;
-        if (key == null)
+        if (actual != null)
         {
-            key = new COSObjectKey(++number, 0);
-            objectKeys.put(obj, key);
-            if( actual != null )
-            {
-                objectKeys.put(actual, key);
-            }
+            key = objectKeys.computeIfAbsent(actual, k -> new COSObjectKey(++number, 0));
         }
         return key;
     }
