diff --git a/pdfbox/src/test/java/org/apache/pdfbox/encryption/TestSymmetricKeyEncryption.java b/pdfbox/src/test/java/org/apache/pdfbox/encryption/TestSymmetricKeyEncryption.java
index dcf50430e6..ae0373e904 100644
--- a/pdfbox/src/test/java/org/apache/pdfbox/encryption/TestSymmetricKeyEncryption.java
+++ b/pdfbox/src/test/java/org/apache/pdfbox/encryption/TestSymmetricKeyEncryption.java
@@ -210,6 +210,29 @@ public class TestSymmetricKeyEncryption extends TestCase
                 USERPASSWORD, OWNERPASSWORD, permission);
     }
 
+    /**
+     * PDFBOX-4308: test that index colorspace table string doesn't get
+     * corrupted when encrypting. This happened because the table was used by
+     * two dictionaries, and when saving one string ended up as a direct object
+     * and the other (but same java object) ended up as an indirect object.
+     * Encryption used the wrong object number and/or the object was encrypted
+     * twice.
+     *
+     * @throws IOException
+     */
+    public void testPDFBox4308() throws IOException
+    {
+        byte[] inputFileAsByteArray;
+        try (InputStream is = new FileInputStream("target/pdfs/PDFBOX-4308.pdf"))
+        {
+            inputFileAsByteArray = IOUtils.toByteArray(is);
+        }
+        int sizePriorToEncryption = inputFileAsByteArray.length;
+
+        testSymmEncrForKeySize(40, false, sizePriorToEncryption, inputFileAsByteArray,
+                USERPASSWORD, OWNERPASSWORD, permission);
+    }
+
     /**
      * Protect a document with an embedded PDF with a key and try to reopen it
      * with that key and compare.
