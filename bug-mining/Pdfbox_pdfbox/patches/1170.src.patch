diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/PDFXrefStreamParser.java b/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/PDFXrefStreamParser.java
index 748681468d..c5616a46fa 100755
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/PDFXrefStreamParser.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/PDFXrefStreamParser.java
@@ -65,7 +65,13 @@ public class PDFXrefStreamParser extends BaseParser
      */
     public void parse() throws IOException
     {
-        COSArray xrefFormat = (COSArray)stream.getDictionaryObject(COSName.W);
+        COSBase w = stream.getDictionaryObject(COSName.W);
+        if (!(w instanceof COSArray))
+        {
+            throw new IOException("/W array is missing in Xref stream");
+        }
+        COSArray xrefFormat = (COSArray) w;
+        
         COSArray indexArray = (COSArray)stream.getDictionaryObject(COSName.INDEX);
         /*
          * If Index doesn't exist, we will use the default values.
