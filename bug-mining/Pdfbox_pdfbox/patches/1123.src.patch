diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/BaseParser.java b/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/BaseParser.java
index 384b5a2ebe..82efc1f2d6 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/BaseParser.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/BaseParser.java
@@ -18,7 +18,6 @@ package org.apache.pdfbox.pdfparser;
 
 import java.io.ByteArrayOutputStream;
 import java.io.IOException;
-import java.io.InputStream;
 import java.io.OutputStream;
 
 import org.apache.commons.logging.Log;
@@ -33,9 +32,11 @@ import org.apache.pdfbox.cos.COSName;
 import org.apache.pdfbox.cos.COSNull;
 import org.apache.pdfbox.cos.COSNumber;
 import org.apache.pdfbox.cos.COSObject;
+import org.apache.pdfbox.cos.COSStream;
 import org.apache.pdfbox.cos.COSString;
 import org.apache.pdfbox.io.RandomAccessBuffer;
 import org.apache.pdfbox.io.RandomAccessRead;
+import org.apache.pdfbox.pdmodel.common.COSStreamArray;
 import org.apache.pdfbox.cos.COSObjectKey;
 
 import static org.apache.pdfbox.util.Charsets.ISO_8859_1;
@@ -154,12 +155,31 @@ public abstract class BaseParser
     /**
      * Constructor.
      *
-     * @param input The input stream to read the data from.
+     * @param stream The COS stream to read the data from.
      * @throws IOException If there is an error reading the input stream.
      */
-    public BaseParser(InputStream input) throws IOException
+    public BaseParser(COSStream stream) throws IOException
     {
-        pdfSource = new RandomAccessBuffer(input);
+        if (stream instanceof COSStreamArray)
+        {
+            // TODO don't copy input stream
+            pdfSource = new RandomAccessBuffer(stream.getUnfilteredStream());
+        }
+        else
+        {
+            pdfSource = stream.getUnfilteredRandomAccess();
+        }
+    }
+    
+    /**
+     * Constructor.
+     *
+     * @param input The random access read to read the data from.
+     * @throws IOException If there is an error reading the input stream.
+     */
+    public BaseParser(RandomAccessRead input) throws IOException
+    {
+        pdfSource = input;
     }
 
     private static boolean isHexDigit(char ch)
diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/PDFObjectStreamParser.java b/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/PDFObjectStreamParser.java
index 9b86698cae..6181072b0a 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/PDFObjectStreamParser.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/PDFObjectStreamParser.java
@@ -52,7 +52,7 @@ public class PDFObjectStreamParser extends BaseParser
      */
     public PDFObjectStreamParser(COSStream strm, COSDocument doc) throws IOException
     {
-        super(strm.getUnfilteredStream());
+        super(strm.getUnfilteredRandomAccess());
         document = doc;
         stream = strm;
     }
diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/PDFStreamParser.java b/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/PDFStreamParser.java
index 608405a9f4..99563f5f8e 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/PDFStreamParser.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/PDFStreamParser.java
@@ -18,7 +18,6 @@ package org.apache.pdfbox.pdfparser;
 
 import java.io.ByteArrayOutputStream;
 import java.io.IOException;
-import java.io.InputStream;
 import java.util.ArrayList;
 import java.util.Iterator;
 import java.util.List;
@@ -56,14 +55,15 @@ public class PDFStreamParser extends BaseParser
     private final byte[] binCharTestArr = new byte[MAX_BIN_CHAR_TEST_LENGTH];
 
     /**
-     * Constructor that takes a stream to parse.
+     * Constructor.
      *
-     * @param stream The stream to read data from.
-     * @throws IOException If there is an error reading from the stream.
+     * @param stream The stream to parse.
+     *
+     * @throws IOException If there is an error initializing the stream.
      */
-    public PDFStreamParser(InputStream stream) throws IOException
+    public PDFStreamParser( PDStream stream ) throws IOException
     {
-        super(stream);
+       this( (COSStream)stream.getCOSObject() );
     }
 
     /**
@@ -73,21 +73,21 @@ public class PDFStreamParser extends BaseParser
      *
      * @throws IOException If there is an error initializing the stream.
      */
-    public PDFStreamParser( PDStream stream ) throws IOException
+    public PDFStreamParser( COSStream stream ) throws IOException
     {
-       this( stream.createInputStream() );
+        super(stream);
     }
 
     /**
      * Constructor.
      *
-     * @param stream The stream to parse.
+     * @param input The random access read to parse.
      *
      * @throws IOException If there is an error initializing the stream.
      */
-    public PDFStreamParser( COSStream stream ) throws IOException
+    public PDFStreamParser( RandomAccessRead input ) throws IOException
     {
-       this( stream.getUnfilteredStream() );
+        super( input );
     }
 
     /**
diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/PDFXrefStreamParser.java b/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/PDFXrefStreamParser.java
index ce36fda7cb..9b186f1fa8 100755
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/PDFXrefStreamParser.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/PDFXrefStreamParser.java
@@ -52,7 +52,7 @@ public class PDFXrefStreamParser extends BaseParser
     public PDFXrefStreamParser(COSStream strm, COSDocument doc, XrefTrailerResolver resolver )
             throws IOException
     {
-        super(strm.getUnfilteredStream());
+        super(strm.getUnfilteredRandomAccess());
         document = doc;
         stream = strm;
         this.xrefTrailerResolver = resolver;
diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/interactive/form/PDAppearanceString.java b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/interactive/form/PDAppearanceString.java
index 2905ae55dc..ab87bdd430 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/interactive/form/PDAppearanceString.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/interactive/form/PDAppearanceString.java
@@ -16,13 +16,14 @@
  */
 package org.apache.pdfbox.pdmodel.interactive.form;
 
-import java.io.ByteArrayInputStream;
 import java.io.IOException;
 import java.util.List;
+
 import org.apache.pdfbox.contentstream.operator.Operator;
 import org.apache.pdfbox.cos.COSName;
 import org.apache.pdfbox.cos.COSNumber;
 import org.apache.pdfbox.cos.COSString;
+import org.apache.pdfbox.io.RandomAccessBuffer;
 import org.apache.pdfbox.pdfparser.PDFStreamParser;
 import org.apache.pdfbox.pdmodel.PDPageContentStream;
 import org.apache.pdfbox.pdmodel.PDResources;
@@ -63,8 +64,7 @@ class PDAppearanceString
             throw new IllegalArgumentException("/DR is a required entry");
         }
         
-        ByteArrayInputStream stream = new ByteArrayInputStream(defaultAppearance.getBytes());
-        PDFStreamParser parser = new PDFStreamParser(stream);
+        PDFStreamParser parser = new PDFStreamParser(new RandomAccessBuffer(defaultAppearance.getBytes()));
         parser.parse();
         tokens = parser.getTokens();
         
diff --git a/pdfbox/src/test/java/org/apache/pdfbox/pdfparser/PDFStreamParserTest.java b/pdfbox/src/test/java/org/apache/pdfbox/pdfparser/PDFStreamParserTest.java
index ffe7b357d8..866b337662 100644
--- a/pdfbox/src/test/java/org/apache/pdfbox/pdfparser/PDFStreamParserTest.java
+++ b/pdfbox/src/test/java/org/apache/pdfbox/pdfparser/PDFStreamParserTest.java
@@ -15,11 +15,14 @@
  */
 package org.apache.pdfbox.pdfparser;
 
-import java.io.ByteArrayInputStream;
 import java.io.IOException;
 import java.util.List;
+
 import junit.framework.TestCase;
+
 import org.apache.pdfbox.contentstream.operator.Operator;
+import org.apache.pdfbox.io.RandomAccessBuffer;
+
 import static org.junit.Assert.assertArrayEquals;
 
 /**
@@ -113,7 +116,7 @@ public class PDFStreamParserTest extends TestCase
     // parse string and return list of tokens
     private List<Object> parseTokenString(String s) throws IOException
     {
-        PDFStreamParser pdfStreamParser = new PDFStreamParser(new ByteArrayInputStream(s.getBytes()));
+        PDFStreamParser pdfStreamParser = new PDFStreamParser(new RandomAccessBuffer(s.getBytes()));
         pdfStreamParser.parse();
         return pdfStreamParser.getTokens();
     }
diff --git a/pdfbox/src/test/java/org/apache/pdfbox/pdmodel/TestFDF.java b/pdfbox/src/test/java/org/apache/pdfbox/pdmodel/TestFDF.java
index 6afaeb661f..be8a2d8f39 100644
--- a/pdfbox/src/test/java/org/apache/pdfbox/pdmodel/TestFDF.java
+++ b/pdfbox/src/test/java/org/apache/pdfbox/pdmodel/TestFDF.java
@@ -16,16 +16,18 @@
  */
 package org.apache.pdfbox.pdmodel;
 
-import java.io.ByteArrayInputStream;
 import java.io.File;
 import java.io.IOException;
 import java.util.List;
+
 import junit.framework.Test;
 import junit.framework.TestCase;
 import junit.framework.TestSuite;
+
 import org.apache.pdfbox.cos.COSName;
 import org.apache.pdfbox.cos.COSStream;
 import org.apache.pdfbox.cos.COSString;
+import org.apache.pdfbox.io.RandomAccessBuffer;
 import org.apache.pdfbox.pdfparser.PDFStreamParser;
 import org.apache.pdfbox.pdmodel.fdf.FDFDocument;
 import org.apache.pdfbox.pdmodel.interactive.annotation.PDAnnotationWidget;
@@ -275,8 +277,7 @@ public class TestFDF extends TestCase
         List<Object> tokens = null;
         if( string != null )
         {
-            ByteArrayInputStream stream = new ByteArrayInputStream( string.getBytes() );
-            parser = new PDFStreamParser( stream );
+            parser = new PDFStreamParser( new RandomAccessBuffer( string.getBytes() ) );
             parser.parse();
             tokens = parser.getTokens();
         }
