diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/interactive/form/AppearanceGeneratorHelper.java b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/interactive/form/AppearanceGeneratorHelper.java
index 72118821d6..7dedfcd86d 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/interactive/form/AppearanceGeneratorHelper.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/interactive/form/AppearanceGeneratorHelper.java
@@ -717,6 +717,10 @@ class AppearanceGeneratorHelper
     private void insertGeneratedCombAppearance(PDAppearanceContentStream contents, PDAppearanceStream appearanceStream,
             PDFont font, float fontSize) throws IOException
     {
+        if (value == null || value.isEmpty())
+        {
+            return;
+        }
         int maxLen = ((PDTextField) field).getMaxLen();
         int quadding = field.getQ();
         int numChars = Math.min(value.length(), maxLen);
diff --git a/pdfbox/src/test/java/org/apache/pdfbox/pdmodel/interactive/form/CombAlignmentTest.java b/pdfbox/src/test/java/org/apache/pdfbox/pdmodel/interactive/form/CombAlignmentTest.java
index 630b2c3f96..288f7fecfa 100644
--- a/pdfbox/src/test/java/org/apache/pdfbox/pdmodel/interactive/form/CombAlignmentTest.java
+++ b/pdfbox/src/test/java/org/apache/pdfbox/pdmodel/interactive/form/CombAlignmentTest.java
@@ -50,10 +50,13 @@ class CombAlignmentTest
         {
             PDAcroForm acroForm = document.getDocumentCatalog().getAcroForm();
             PDField field = acroForm.getField("PDFBoxCombLeft");
+            field.setValue("");
             field.setValue(TEST_VALUE);
             field = acroForm.getField("PDFBoxCombMiddle");
+            field.setValue("");
             field.setValue(TEST_VALUE);
             field = acroForm.getField("PDFBoxCombRight");
+            field.setValue("");
             field.setValue(TEST_VALUE);
             // compare rendering
             File file = new File(OUT_DIR, NAME_OF_PDF);
