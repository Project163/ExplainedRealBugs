diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/shading/PDShading.java b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/shading/PDShading.java
index 175d6317a5..306839d000 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/shading/PDShading.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/shading/PDShading.java
@@ -335,8 +335,8 @@ public abstract class PDShading implements COSObjectable
     /**
      * Provide the function(s) of the shading dictionary as array.
      *
-     * @return an array containing the function(s)
-     * @throws IOException if something went wrong
+     * @return an array containing the function(s).
+     * @throws IOException if we were unable to create a function.
      */
     private PDFunction[] getFunctionsArray() throws IOException
     {
@@ -348,7 +348,7 @@ public abstract class PDShading implements COSObjectable
                 functionArray = new PDFunction[1];
                 functionArray[0] = PDFunction.create(functionObject);
             }
-            else
+            else if (functionObject instanceof COSArray)
             {
                 COSArray functionCOSArray = (COSArray) functionObject;
                 int numberOfFunctions = functionCOSArray.size();
@@ -358,6 +358,10 @@ public abstract class PDShading implements COSObjectable
                     functionArray[i] = PDFunction.create(functionCOSArray.get(i));
                 }
             }
+            else
+            {
+                throw new IOException("mandatory /Function element must be a dictionary or an array");
+            }
         }
         return functionArray;
     }
