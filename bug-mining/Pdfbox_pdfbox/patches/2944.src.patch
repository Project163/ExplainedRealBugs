diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdfwriter/compress/COSWriterObjectStream.java b/pdfbox/src/main/java/org/apache/pdfbox/pdfwriter/compress/COSWriterObjectStream.java
index c0599940fc..96ee5dbe1f 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdfwriter/compress/COSWriterObjectStream.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdfwriter/compress/COSWriterObjectStream.java
@@ -25,6 +25,8 @@ import java.util.Collections;
 import java.util.List;
 import java.util.Map;
 
+import org.apache.logging.log4j.LogManager;
+import org.apache.logging.log4j.Logger;
 import org.apache.pdfbox.cos.COSArray;
 import org.apache.pdfbox.cos.COSBase;
 import org.apache.pdfbox.cos.COSBoolean;
@@ -50,6 +52,8 @@ import org.apache.pdfbox.pdfwriter.COSWriter;
  */
 public class COSWriterObjectStream
 {
+    private static final Logger LOG = LogManager.getLogger(COSWriterObjectStream.class);
+
     private final COSWriterCompressionPool compressionPool;
     private final List<COSObjectKey> preparedKeys = new ArrayList<>();
     private final List<COSBase> preparedObjects = new ArrayList<>();
@@ -185,6 +189,12 @@ public class COSWriterObjectStream
                 }
             }
             base = ((COSObject) object).getObject();
+            if (base == null)
+            {
+                LOG.debug("Can't dereference indirect object, writing COSNull instead {}", object);
+                writeCOSNull(output);
+                return;
+            }
         }
         else
         {
