diff --git a/pdfbox/src/main/java/org/apache/pdfbox/cos/COSArray.java b/pdfbox/src/main/java/org/apache/pdfbox/cos/COSArray.java
index 8fd588dd81..d07e3820d1 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/cos/COSArray.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/cos/COSArray.java
@@ -731,5 +731,69 @@ public class COSArray extends COSBase implements Iterable<COSBase>, COSUpdateInf
     {
         return updateState;
     }
-    
+
+    /**
+     * Collects all indirect objects numbers within this COSArray and all included dictionaries. It is used to avoid
+     * mixed up object numbers when importing an existing page to another pdf.
+     * 
+     * Expert use only. You might run into an endless recursion if choosing a wrong starting point.
+     * 
+     * @param indirectObjects a list of already found indirect objects.
+     * 
+     */
+    public void getIndirectObjectKeys(List<COSObjectKey> indirectObjects)
+    {
+        if (indirectObjects == null)
+        {
+            return;
+        }
+        COSObjectKey key = getKey();
+        if (key != null)
+        {
+            // avoid endless recursions
+            if (indirectObjects.contains(key))
+            {
+                return;
+            }
+            else
+            {
+                indirectObjects.add(key);
+            }
+        }
+
+        for (COSBase cosBase : objects)
+        {
+            COSObjectKey cosBaseKey = cosBase.getKey();
+            if (cosBaseKey != null && indirectObjects.contains(cosBaseKey))
+            {
+                continue;
+            }
+            if (cosBase instanceof COSObject)
+            {
+                // dereference object
+                COSBase referencedObject = ((COSObject) cosBase).getObject();
+                if (referencedObject instanceof COSDictionary)
+                {
+                    // descend to included dictionary to collect all included indirect objects
+                    ((COSDictionary) referencedObject).getIndirectObjectKeys(indirectObjects);
+                }
+                else if (referencedObject instanceof COSArray)
+                {
+                    // descend to included array to collect all included indirect objects
+                    ((COSArray) referencedObject).getIndirectObjectKeys(indirectObjects);
+                }
+            }
+            else if (cosBase instanceof COSDictionary)
+            {
+                // descend to included dictionary to collect all included indirect objects
+                ((COSDictionary) cosBase).getIndirectObjectKeys(indirectObjects);
+            }
+            else if (cosBase instanceof COSArray)
+            {
+                // descend to included array to collect all included indirect objects
+                ((COSArray) cosBase).getIndirectObjectKeys(indirectObjects);
+            }
+        }
+    }
+
 }
diff --git a/pdfbox/src/main/java/org/apache/pdfbox/cos/COSDictionary.java b/pdfbox/src/main/java/org/apache/pdfbox/cos/COSDictionary.java
index 6c2fc41271..8346993305 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/cos/COSDictionary.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/cos/COSDictionary.java
@@ -25,6 +25,7 @@ import java.util.Collection;
 import java.util.LinkedHashMap;
 import java.util.List;
 import java.util.Map;
+import java.util.Map.Entry;
 import java.util.Set;
 import java.util.function.BiConsumer;
 
@@ -1432,35 +1433,57 @@ public class COSDictionary extends COSBase implements COSUpdateInfo
      */
     public void getIndirectObjectKeys(List<COSObjectKey> indirectObjects)
     {
-        // avoid endless recursions
-        if (indirectObjects == null || (getKey() != null && indirectObjects.contains(getKey())))
+        if (indirectObjects == null)
         {
             return;
         }
-        for (COSBase cosBase : items.values())
+        COSObjectKey key = getKey();
+        if (key != null)
         {
-            COSDictionary dictionary = null;
+            // avoid endless recursions
+            if (indirectObjects.contains(key))
+            {
+                return;
+            }
+            else
+            {
+                indirectObjects.add(key);
+            }
+        }
+        for (Entry<COSName, COSBase> entry : items.entrySet())
+        {
+            COSBase cosBase = entry.getValue();
+            COSObjectKey cosBaseKey = cosBase.getKey();
+            // avoid endless recursions
+            if (COSName.PARENT.equals(entry.getKey())
+                    || (cosBaseKey != null && indirectObjects.contains(cosBaseKey)))
+            {
+                continue;
+            }
             if (cosBase instanceof COSObject)
             {
-                // add indirect object key and dereference object
-                if (cosBase.getKey() != null && !indirectObjects.contains(cosBase.getKey()))
+                // dereference object
+                COSBase referencedObject = ((COSObject) cosBase).getObject();
+                if (referencedObject instanceof COSDictionary)
+                {
+                    // descend to included dictionary to collect all included indirect objects
+                    ((COSDictionary) referencedObject).getIndirectObjectKeys(indirectObjects);
+                }
+                else if (referencedObject instanceof COSArray)
                 {
-                    indirectObjects.add(cosBase.getKey());
-                    COSBase referencedObject = ((COSObject) cosBase).getObject();
-                    if (referencedObject instanceof COSDictionary)
-                    {
-                        dictionary = (COSDictionary) referencedObject;
-                    }
+                    // descend to included array to collect all included indirect objects
+                    ((COSArray) referencedObject).getIndirectObjectKeys(indirectObjects);
                 }
             }
             else if (cosBase instanceof COSDictionary)
             {
-                dictionary = (COSDictionary) cosBase;
+                // descend to included dictionary to collect all included indirect objects
+                ((COSDictionary) cosBase).getIndirectObjectKeys(indirectObjects);
             }
-            if (dictionary != null)
+            else if (cosBase instanceof COSArray)
             {
-                // descend to included dictionary to collect all included indirect objects
-                dictionary.getIndirectObjectKeys(indirectObjects);
+                // descend to included array to collect all included indirect objects
+                ((COSArray) cosBase).getIndirectObjectKeys(indirectObjects);
             }
         }
     }
