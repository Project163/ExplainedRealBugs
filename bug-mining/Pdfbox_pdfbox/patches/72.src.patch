diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdfwriter/COSWriter.java b/pdfbox/src/main/java/org/apache/pdfbox/pdfwriter/COSWriter.java
index 3a8b50ad48..ee08f002bd 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdfwriter/COSWriter.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdfwriter/COSWriter.java
@@ -903,7 +903,7 @@ public class COSWriter implements ICOSVisitor
         {
             if(willEncrypt)
             {
-                document.getSecurityHandler().decryptStream(
+                document.getSecurityHandler().encryptStream(
                     obj,
                     currentObjectKey.getNumber(),
                     currentObjectKey.getGeneration());
diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/SecurityHandler.java b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/SecurityHandler.java
index 7d4ca64aa1..8d295c0794 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/SecurityHandler.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/SecurityHandler.java
@@ -293,6 +293,28 @@ public abstract class SecurityHandler
                                 encryptedStream,
                                 stream.createFilteredStream() );
     }
+    
+    /**
+     * This will encrypt a stream, but not the dictionary as the dictionary is
+     * encrypted by visitFromString() in COSWriter and we don't want to encrypt
+     * it twice.
+     *
+     * @param stream The stream to decrypt.
+     * @param objNum The object number.
+     * @param genNum The object generation number.
+     *
+     * @throws CryptographyException If there is an error getting the stream.
+     * @throws IOException If there is an error getting the stream data.
+     */
+    public void encryptStream( COSStream stream, long objNum, long genNum )
+        throws CryptographyException, IOException
+    {
+        InputStream encryptedStream = stream.getFilteredStream();
+        encryptData( objNum,
+                                genNum,
+                                encryptedStream,
+                                stream.createFilteredStream() );
+    }
 
     /**
      * This will decrypt a dictionary.
