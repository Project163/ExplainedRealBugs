diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/COSParser.java b/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/COSParser.java
index 6f4af3f7b6..543288c5d1 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/COSParser.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/COSParser.java
@@ -2278,8 +2278,9 @@ public class COSParser extends BaseParser
      * Check if all entries of the pages dictionary are present. Those which can't be dereferenced are removed.
      * 
      * @param root the root dictionary of the pdf
+     * @throws java.io.IOException if the page tree root is null
      */
-    protected void checkPages(COSDictionary root)
+    protected void checkPages(COSDictionary root) throws IOException
     {
         if (trailerWasRebuild && root != null)
         {
@@ -2289,6 +2290,15 @@ public class COSParser extends BaseParser
             {
                 checkPagesDictionary((COSDictionary) pages, new HashSet<COSObject>());
             }
+
+            if (pages instanceof COSObject)
+            {
+                pages = ((COSObject) pages).getObject();
+            }
+            if (pages == null || pages instanceof COSNull)
+            {
+                throw new IOException("Page tree root is null");
+            }
         }
     }
 
