diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/SecurityHandler.java b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/SecurityHandler.java
index 694c94d0a4..a2ce175ce2 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/SecurityHandler.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/SecurityHandler.java
@@ -28,10 +28,11 @@ import java.security.InvalidKeyException;
 import java.security.MessageDigest;
 import java.security.NoSuchAlgorithmException;
 import java.security.SecureRandom;
+import java.util.ArrayList;
 import java.util.Arrays;
-import java.util.HashSet;
+import java.util.HashMap;
+import java.util.List;
 import java.util.Map;
-import java.util.Set;
 
 import javax.crypto.BadPaddingException;
 import javax.crypto.Cipher;
@@ -83,7 +84,7 @@ public abstract class SecurityHandler
     /** indicates if the Metadata have to be decrypted of not. */
     private boolean decryptMetadata;
 
-    private final Set<COSBase> objects = new HashSet<>();
+    private final Map<COSBase, List<COSBase>> objects = new HashMap<>();
 
     private boolean useAES;
 
@@ -367,27 +368,47 @@ public abstract class SecurityHandler
      */
     public void decrypt(COSBase obj, long objNum, long genNum) throws IOException
     {
-        if (!objects.contains(obj))
+        // PDFBOX-4453: Originally this was just a Set. This failed in rare cases
+        // when a decrypted string was identical to an encrypted string.
+        // Because COSString.equals() checks the contents, decryption was then skipped.
+        // This solution keeps all different "equal" objects.
+        // Please do not replace this with a solution using System.identityHashCode(),
+        // because this is still a hash code and is NOT guaranteed to be unique.
+        List<COSBase> list = objects.get(obj);
+        if (list == null)
         {
-            objects.add(obj);
-
-            if (obj instanceof COSString)
-            {
-                decryptString((COSString) obj, objNum, genNum);
-            }
-            else if (obj instanceof COSStream)
-            {
-                decryptStream((COSStream) obj, objNum, genNum);
-            }
-            else if (obj instanceof COSDictionary)
-            {
-                decryptDictionary((COSDictionary) obj, objNum, genNum);
-            }
-            else if (obj instanceof COSArray)
+            list = new ArrayList<>();
+            objects.put(obj, list);
+        }
+        else
+        {
+            // check whether the exact object is in the list
+            for (COSBase base : list)
             {
-                decryptArray((COSArray) obj, objNum, genNum);
+                if (base == obj)
+                {
+                    return;
+                }
             }
         }
+        list.add(obj);
+
+        if (obj instanceof COSString)
+        {
+            decryptString((COSString) obj, objNum, genNum);
+        }
+        else if (obj instanceof COSStream)
+        {
+            decryptStream((COSStream) obj, objNum, genNum);
+        }
+        else if (obj instanceof COSDictionary)
+        {
+            decryptDictionary((COSDictionary) obj, objNum, genNum);
+        }
+        else if (obj instanceof COSArray)
+        {
+            decryptArray((COSArray) obj, objNum, genNum);
+        }
     }
 
     /**
diff --git a/pdfbox/src/test/java/org/apache/pdfbox/encryption/TestSymmetricKeyEncryption.java b/pdfbox/src/test/java/org/apache/pdfbox/encryption/TestSymmetricKeyEncryption.java
index ba2c703e0a..6af1a0df4c 100644
--- a/pdfbox/src/test/java/org/apache/pdfbox/encryption/TestSymmetricKeyEncryption.java
+++ b/pdfbox/src/test/java/org/apache/pdfbox/encryption/TestSymmetricKeyEncryption.java
@@ -272,7 +272,7 @@ public class TestSymmetricKeyEncryption extends TestCase
      * 
      * @throws IOException 
      */
-    public void t_estPDFBox4453() throws IOException
+    public void testPDFBox4453() throws IOException
     {
         final int TESTCOUNT = 1000;
         File file = new File(testResultsDir,"PDFBOX-4453.pdf");
