diff --git a/pdfbox/src/main/java/org/apache/pdfbox/util/PDFStreamEngine.java b/pdfbox/src/main/java/org/apache/pdfbox/util/PDFStreamEngine.java
index 06e4d6ed2e..baec6a0ef8 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/util/PDFStreamEngine.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/util/PDFStreamEngine.java
@@ -598,6 +598,11 @@ public class PDFStreamEngine
      */
     public Map<String,PDFont> getFonts()
     {
+        if ( streamResourcesStack.isEmpty() )
+        {
+            return Collections.emptyMap();
+        }
+        
         return streamResourcesStack.peek().getFonts();
     }
     /**
