diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/COSParser.java b/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/COSParser.java
index afce1b9402..d4ee0ccb78 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/COSParser.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/COSParser.java
@@ -2501,15 +2501,15 @@ public class COSParser extends BaseParser implements ICOSParser
         {
             return;
         }
-        COSBase trailerEncryptItem = document.getTrailer().getItem(COSName.ENCRYPT);
-        if (trailerEncryptItem == null || trailerEncryptItem instanceof COSNull)
+        COSDictionary encryptionDictionary = document.getEncryptionDictionary();
+        if (encryptionDictionary == null)
         {
             return;
         }
 
         try
         {
-            encryption = new PDEncryption(document.getEncryptionDictionary());
+            encryption = new PDEncryption(encryptionDictionary);
             DecryptionMaterial decryptionMaterial;
             if (keyStoreInputStream != null)
             {
