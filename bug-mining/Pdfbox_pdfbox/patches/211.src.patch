diff --git a/pdfbox/src/main/java/org/apache/pdfbox/io/ccitt/CCITTFaxG31DDecodeInputStream.java b/pdfbox/src/main/java/org/apache/pdfbox/io/ccitt/CCITTFaxG31DDecodeInputStream.java
index 39a965aa4e..8f3747adaf 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/io/ccitt/CCITTFaxG31DDecodeInputStream.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/io/ccitt/CCITTFaxG31DDecodeInputStream.java
@@ -225,8 +225,8 @@ public class CCITTFaxG31DDecodeInputStream extends InputStream implements CCITTF
         buildUpTerminating(BLACK_TERMINATING, BLACK_LOOKUP_TREE_ROOT, false);
         buildUpMakeUp(WHITE_MAKE_UP, WHITE_LOOKUP_TREE_ROOT);
         buildUpMakeUp(BLACK_MAKE_UP, BLACK_LOOKUP_TREE_ROOT);
-        buildUpMakeUp(LONG_MAKE_UP, WHITE_LOOKUP_TREE_ROOT);
-        buildUpMakeUp(LONG_MAKE_UP, BLACK_LOOKUP_TREE_ROOT);
+        buildUpMakeUpLong(LONG_MAKE_UP, WHITE_LOOKUP_TREE_ROOT);
+        buildUpMakeUpLong(LONG_MAKE_UP, BLACK_LOOKUP_TREE_ROOT);
         LookupTreeNode eolNode = new EndOfLineTreeNode();
         addLookupTreeNode(EOL_STARTER, WHITE_LOOKUP_TREE_ROOT, eolNode);
         addLookupTreeNode(EOL_STARTER, BLACK_LOOKUP_TREE_ROOT, eolNode);
@@ -250,6 +250,15 @@ public class CCITTFaxG31DDecodeInputStream extends InputStream implements CCITTF
         }
     }
 
+    private static void buildUpMakeUpLong(short[] codes, NonLeafLookupTreeNode root)
+    {
+        for (int len = 0, c = codes.length; len < c; len++)
+        {
+            LookupTreeNode leaf = new MakeUpTreeNode((len + 28) * 64);
+            addLookupTreeNode(codes[len], root, leaf);
+        }
+    }
+
     private static void addLookupTreeNode(short code, NonLeafLookupTreeNode root,
             LookupTreeNode leaf)
     {
