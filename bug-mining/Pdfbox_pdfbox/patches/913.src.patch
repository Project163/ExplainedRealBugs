diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/shading/AxialShadingContext.java b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/shading/AxialShadingContext.java
index 07e2094c58..e59059ff07 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/shading/AxialShadingContext.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/shading/AxialShadingContext.java
@@ -20,6 +20,7 @@ import java.awt.PaintContext;
 import java.awt.Rectangle;
 import java.awt.geom.AffineTransform;
 import java.awt.geom.NoninvertibleTransformException;
+import java.awt.geom.Point2D;
 import java.awt.image.ColorModel;
 import java.awt.image.Raster;
 import java.awt.image.WritableRaster;
@@ -118,9 +119,11 @@ public class AxialShadingContext extends ShadingContext implements PaintContext
         }
 
         // transform the distance to actual pixel space
-        double maxX = Math.abs(matrix.getScalingFactorX() * xform.getScaleX() * longestDistance);
-        double maxY = Math.abs(matrix.getScalingFactorY() * xform.getScaleY() * longestDistance);
-        factor = (int) Math.max(maxX, maxY);
+        // use transform, because xform.getScaleX() does not return correct scaling on 90Â° rotated matrix
+        Point2D point = new Point2D.Double(longestDistance, longestDistance);
+        matrix.transform(point);
+        xform.transform(point, point);
+        factor = (int) Math.max(Math.abs(point.getX()), Math.abs(point.getY()));
         colorTable = calcColorTable();
     }
 
diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/shading/RadialShadingContext.java b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/shading/RadialShadingContext.java
index 2ac5d3a8b6..eab130404a 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/shading/RadialShadingContext.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/shading/RadialShadingContext.java
@@ -20,6 +20,7 @@ import java.awt.PaintContext;
 import java.awt.Rectangle;
 import java.awt.geom.AffineTransform;
 import java.awt.geom.NoninvertibleTransformException;
+import java.awt.geom.Point2D;
 import java.awt.image.ColorModel;
 import java.awt.image.Raster;
 import java.awt.image.WritableRaster;
@@ -128,9 +129,10 @@ public class RadialShadingContext extends ShadingContext implements PaintContext
         }
 
         // transform the distance to actual pixel space
-        double maxX = Math.abs(matrix.getScalingFactorX() * xform.getScaleX() * longestDistance);
-        double maxY = Math.abs(matrix.getScalingFactorY() * xform.getScaleY() * longestDistance);
-        factor = (int) Math.max(maxX, maxY);
+        Point2D point = new Point2D.Double(longestDistance, longestDistance);
+        matrix.transform(point);
+        xform.transform(point, point);
+        factor = (int) Math.max(Math.abs(point.getX()), Math.abs(point.getY()));
         colorTable = calcColorTable();
     }
 
