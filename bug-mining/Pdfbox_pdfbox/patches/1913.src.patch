diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/optionalcontent/PDOptionalContentProperties.java b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/optionalcontent/PDOptionalContentProperties.java
index 5207084994..ac73a67d29 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/optionalcontent/PDOptionalContentProperties.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/optionalcontent/PDOptionalContentProperties.java
@@ -16,6 +16,7 @@
  */
 package org.apache.pdfbox.pdmodel.graphics.optionalcontent;
 
+import java.util.ArrayList;
 import java.util.Collection;
 
 import org.apache.pdfbox.cos.COSArray;
@@ -186,7 +187,7 @@ public class PDOptionalContentProperties implements COSObjectable
      */
     public Collection<PDOptionalContentGroup> getOptionalContentGroups()
     {
-        Collection<PDOptionalContentGroup> coll = new java.util.ArrayList<>();
+        Collection<PDOptionalContentGroup> coll = new ArrayList<>();
         COSArray ocgs = getOCGs();
         for (COSBase base : ocgs)
         {
@@ -258,19 +259,37 @@ public class PDOptionalContentProperties implements COSObjectable
      * @return true if the group is enabled
      */
     public boolean isGroupEnabled(String groupName)
+    {
+        return isGroupEnabled(getGroup(groupName));
+    }
+
+    /**
+     * Indicates whether an optional content group is enabled.
+     * @param group the group object
+     * @return true if the group is enabled
+     */
+    public boolean isGroupEnabled(PDOptionalContentGroup group)
     {
         //TODO handle Optional Content Configuration Dictionaries,
         //i.e. OCProperties/Configs
 
+        PDOptionalContentProperties.BaseState baseState = getBaseState();
+        boolean enabled = !baseState.equals(BaseState.OFF);
+        //TODO What to do with BaseState.Unchanged?
+
+        if (group == null)
+        {
+            return enabled;
+        }
+
         COSDictionary d = getD();
         COSBase base = d.getDictionaryObject(COSName.ON);
         if (base instanceof COSArray)
         {
             for (COSBase o : (COSArray) base)
             {
-                COSDictionary group = toDictionary(o);
-                String name = group.getString(COSName.NAME);
-                if (name.equals(groupName))
+                COSDictionary dictionary = toDictionary(o);
+                if (dictionary == group.getCOSObject())
                 {
                     return true;
                 }
@@ -282,18 +301,14 @@ public class PDOptionalContentProperties implements COSObjectable
         {
             for (COSBase o : (COSArray) base)
             {
-                COSDictionary group = toDictionary(o);
-                String name = group.getString(COSName.NAME);
-                if (name.equals(groupName))
+                COSDictionary dictionary = toDictionary(o);
+                if (dictionary == group.getCOSObject())
                 {
                     return false;
                 }
             }
         }
 
-        BaseState baseState = getBaseState();
-        boolean enabled = !baseState.equals(BaseState.OFF);
-        //TODO What to do with BaseState.Unchanged?
         return enabled;
     }
 
@@ -316,6 +331,17 @@ public class PDOptionalContentProperties implements COSObjectable
      * @return true if the group already had an on or off setting, false otherwise
      */
     public boolean setGroupEnabled(String groupName, boolean enable)
+    {
+        return setGroupEnabled(getGroup(groupName), enable);
+    }
+
+    /**
+     * Enables or disables an optional content group.
+     * @param group the group object
+     * @param enable true to enable, false to disable
+     * @return true if the group already had an on or off setting, false otherwise
+     */
+    public boolean setGroupEnabled(PDOptionalContentGroup group, boolean enable)
     {
         COSArray on;
         COSArray off;
@@ -347,9 +373,8 @@ public class PDOptionalContentProperties implements COSObjectable
         {
             for (COSBase o : off)
             {
-                COSDictionary group = toDictionary(o);
-                String name = group.getString(COSName.NAME);
-                if (name.equals(groupName))
+                COSDictionary groupDictionary = toDictionary(o);
+                if (groupDictionary == group.getCOSObject())
                 {
                     //enable group
                     off.remove(o);
@@ -363,9 +388,8 @@ public class PDOptionalContentProperties implements COSObjectable
         {
             for (COSBase o : on)
             {
-                COSDictionary group = toDictionary(o);
-                String name = group.getString(COSName.NAME);
-                if (name.equals(groupName))
+                COSDictionary groupDictionary = toDictionary(o);
+                if (groupDictionary == group.getCOSObject())
                 {
                     //disable group
                     on.remove(o);
@@ -377,14 +401,13 @@ public class PDOptionalContentProperties implements COSObjectable
         }
         if (!found)
         {
-            PDOptionalContentGroup ocg = getGroup(groupName);
             if (enable)
             {
-                on.add(ocg.getCOSObject());
+                on.add(group.getCOSObject());
             }
             else
             {
-                off.add(ocg.getCOSObject());
+                off.add(group.getCOSObject());
             }
         }
         return found;
diff --git a/pdfbox/src/test/java/org/apache/pdfbox/pdmodel/graphics/optionalcontent/TestOptionalContentGroups.java b/pdfbox/src/test/java/org/apache/pdfbox/pdmodel/graphics/optionalcontent/TestOptionalContentGroups.java
index 810c0eeeb4..0e0b63f130 100644
--- a/pdfbox/src/test/java/org/apache/pdfbox/pdmodel/graphics/optionalcontent/TestOptionalContentGroups.java
+++ b/pdfbox/src/test/java/org/apache/pdfbox/pdmodel/graphics/optionalcontent/TestOptionalContentGroups.java
@@ -41,7 +41,7 @@ import org.apache.pdfbox.pdmodel.graphics.optionalcontent.PDOptionalContentPrope
  */
 public class TestOptionalContentGroups extends TestCase
 {
-    private File testResultsDir = new File("target/test-output");
+    private final File testResultsDir = new File("target/test-output");
 
     @Override
     protected void setUp() throws Exception
@@ -205,4 +205,71 @@ public class TestOptionalContentGroups extends TestCase
         }
     }
 
+    public void testOCGsWithSameNameCanHaveDifferentVisibility() throws Exception
+    {
+        try (PDDocument doc = new PDDocument())
+        {
+            //Create new page
+            PDPage page = new PDPage();
+            doc.addPage(page);
+            PDResources resources = page.getResources();
+            if( resources == null )
+            {
+                resources = new PDResources();
+                page.setResources( resources );
+            }
+
+            //Prepare OCG functionality
+            PDOptionalContentProperties ocprops = new PDOptionalContentProperties();
+            doc.getDocumentCatalog().setOCProperties(ocprops);
+            //ocprops.setBaseState(BaseState.ON); //ON=default
+
+            //Create visible OCG
+            PDOptionalContentGroup visible = new PDOptionalContentGroup("layer");
+            ocprops.addGroup(visible);
+            assertTrue(ocprops.isGroupEnabled(visible));
+
+            //Create invisible OCG
+            PDOptionalContentGroup invisible = new PDOptionalContentGroup("layer");
+            ocprops.addGroup(invisible);
+            assertFalse(ocprops.setGroupEnabled(invisible, false));
+            assertFalse(ocprops.isGroupEnabled(invisible));
+
+            //Check that visible layer is still visible
+            assertTrue(ocprops.isGroupEnabled(visible));
+
+            //Setup page content stream and paint background/title
+            try (PDPageContentStream contentStream = new PDPageContentStream(doc, page, AppendMode.OVERWRITE, false))
+            {
+                PDFont font = PDType1Font.HELVETICA_BOLD;
+                contentStream.beginMarkedContent(COSName.OC, visible);
+                contentStream.beginText();
+                contentStream.setFont(font, 14);
+                contentStream.newLineAtOffset(80, 700);
+                contentStream.showText("PDF 1.5: Optional Content Groups");
+                contentStream.endText();
+                font = PDType1Font.HELVETICA;
+                contentStream.beginText();
+                contentStream.setFont(font, 12);
+                contentStream.newLineAtOffset(80, 680);
+                contentStream.showText("You should see this text, but no red text line.");
+                contentStream.endText();
+                contentStream.endMarkedContent();
+                
+                //Paint disabled layer
+                contentStream.beginMarkedContent(COSName.OC, invisible);
+                contentStream.setNonStrokingColor(Color.RED);
+                contentStream.beginText();
+                contentStream.setFont(font, 12);
+                contentStream.newLineAtOffset(80, 500);
+                contentStream.showText(
+                        "This is from a disabled layer. If you see this, that's NOT good!");
+                contentStream.endText();
+                contentStream.endMarkedContent();
+            }
+
+            File targetFile = new File(testResultsDir, "ocg-generation-same-name.pdf");
+            doc.save(targetFile.getAbsolutePath());
+        }
+    }
 }
