diff --git a/pdfbox/src/main/java/org/apache/pdfbox/cos/COSDocument.java b/pdfbox/src/main/java/org/apache/pdfbox/cos/COSDocument.java
index 283f4cd3ff..402c979c7f 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/cos/COSDocument.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/cos/COSDocument.java
@@ -250,13 +250,28 @@ public class COSDocument extends COSBase implements Closeable
      * @return This will return all objects with the specified type(s).
      */
     public List<COSObject> getObjectsByType(COSName type1, COSName type2)
+    {
+        List<COSObjectKey> originKeys = new ArrayList<COSObjectKey>(xrefTable.keySet());
+        List<COSObject> retval = getObjectsByType(originKeys, type1, type2);
+        // there might be some additional objects if the brute force parser was triggered
+        // due to a broken cross reference table/stream
+        if (originKeys.size() < xrefTable.size())
+        {
+            List<COSObjectKey> additionalKeys = new ArrayList<COSObjectKey>(xrefTable.keySet());
+            additionalKeys.removeAll(originKeys);
+            retval.addAll(getObjectsByType(additionalKeys, type1, type2));
+        }
+        return retval;
+    }
+
+    private List<COSObject> getObjectsByType(List<COSObjectKey> keys, COSName type1, COSName type2)
     {
         List<COSObject> retval = new ArrayList<>();
-        for (COSObjectKey objectKey : xrefTable.keySet())
+        for (COSObjectKey objectKey : keys)
         {
             COSObject objectFromPool = getObjectFromPool(objectKey);
             COSBase realObject = objectFromPool.getObject();
-            if( realObject instanceof COSDictionary )
+            if (realObject instanceof COSDictionary)
             {
                 COSName dictType = ((COSDictionary) realObject).getCOSName(COSName.TYPE);
                 if (type1.equals(dictType) || (type2 != null && type2.equals(dictType)))
