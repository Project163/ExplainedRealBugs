diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDResources.java b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDResources.java
index ce769fecec..9b88452702 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDResources.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDResources.java
@@ -50,7 +50,7 @@ public class PDResources implements COSObjectable
 {
     private COSDictionary resources;
     private Map<String,PDFont> fonts = null;
-    private Map<PDFont, String> fontMappings = null;
+    private Map<PDFont, String> fontMappings = new HashMap<PDFont, String>();
     private Map<String,PDColorSpace> colorspaces = null;
     private Map<String,PDXObject> xobjects = null;
     private Map<PDXObject,String> xobjectMappings = null;
@@ -200,7 +200,7 @@ public class PDResources implements COSObjectable
         }
         return fonts;
     }
-
+    
     /**
      * This will get the map of PDXObjects that are in the resource dictionary.
      * This will never return null.
@@ -512,6 +512,11 @@ public class PDResources implements COSObjectable
      * @return the font name to be used within the content stream.
      */
     public String addFont(PDFont font) 
+    {
+        return addFont(font, MapUtil.getNextUniqueKey( fonts, "F" ));
+    }
+
+    public String addFont(PDFont font, String fontKey) 
     {
         if (fonts == null) 
         {
@@ -519,17 +524,18 @@ public class PDResources implements COSObjectable
             fontMappings = reverseMap(fonts, PDFont.class);
             setFonts(fonts);
         }
+        
         String fontMapping = fontMappings.get( font );
         if( fontMapping == null )
         {
-            fontMapping = MapUtil.getNextUniqueKey( fonts, "F" );
+        		fontMapping = fontKey;
             fontMappings.put( font, fontMapping );
             fonts.put( fontMapping, font );
             addFontToDictionary(font, fontMapping);
         }
         return fontMapping;
     }
-
+    
     private void addFontToDictionary(PDFont font, String fontName)
     {
         COSDictionary fontsDictionary = (COSDictionary)resources.getDictionaryObject(COSName.FONT);
diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/interactive/form/PDAppearance.java b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/interactive/form/PDAppearance.java
index c365c54a44..4c3a9204e3 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/interactive/form/PDAppearance.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/interactive/form/PDAppearance.java
@@ -437,7 +437,7 @@ public class PDAppearance
             if( retval == null )
             {
                 retval = (PDFont)formResources.getFonts().get( fontName );
-                streamResources.getFonts().put( fontName, retval );
+                streamResources.addFont(retval, fontName);
             }
         }
         return retval;
diff --git a/pdfbox/src/main/java/org/apache/pdfbox/util/MapUtil.java b/pdfbox/src/main/java/org/apache/pdfbox/util/MapUtil.java
index 1103c17edb..75b2333f79 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/util/MapUtil.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/util/MapUtil.java
@@ -42,7 +42,7 @@ public class MapUtil
     public static final String getNextUniqueKey( Map map, String prefix )
     {
         int counter = 0;
-        while( map.get( prefix+counter ) != null )
+        while( map != null && map.get( prefix+counter ) != null )
         {
             counter++;
         }
