diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdfwriter/COSWriter.java b/pdfbox/src/main/java/org/apache/pdfbox/pdfwriter/COSWriter.java
index d376763b0f..77b7a5fdc2 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdfwriter/COSWriter.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdfwriter/COSWriter.java
@@ -1174,6 +1174,8 @@ public class COSWriter implements ICOSVisitor
      */
     public Object visitFromStream(COSStream obj) throws COSVisitorException
     {
+        InputStream input = null;
+
         try
         {
             if(willEncrypt)
@@ -1184,7 +1186,7 @@ public class COSWriter implements ICOSVisitor
                     currentObjectKey.getGeneration());
             }
 
-            InputStream input = obj.getFilteredStream();
+            input = obj.getFilteredStream();
             // set the length of the stream and write stream dictionary
             COSObject lengthObject = new COSObject( null );
 
@@ -1212,6 +1214,20 @@ public class COSWriter implements ICOSVisitor
         {
             throw new COSVisitorException(e);
         }
+        finally
+        {
+            if (input != null)
+            {
+                try
+                {
+                    input.close();
+                }
+                catch (IOException e)
+                {
+                    throw new COSVisitorException(e);
+                }
+            }
+        }
     }
 
     /**
