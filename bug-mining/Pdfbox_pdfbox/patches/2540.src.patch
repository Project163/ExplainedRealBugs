diff --git a/pdfbox/src/main/java/org/apache/pdfbox/cos/COSObjectKey.java b/pdfbox/src/main/java/org/apache/pdfbox/cos/COSObjectKey.java
index 1251d5a289..78a3ca6f9e 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/cos/COSObjectKey.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/cos/COSObjectKey.java
@@ -24,10 +24,10 @@ package org.apache.pdfbox.cos;
  */
 public final class COSObjectKey implements Comparable<COSObjectKey>
 {
-    private static final int GENERATION_OFFSET = Long.SIZE - Short.SIZE;
-    private static final long NUMBER_MASK = (long) Math.pow(2, GENERATION_OFFSET) - 1;
+    private static final int NUMBER_OFFSET = Short.SIZE;
+    private static final long GENERATION_MASK = (long) Math.pow(2, NUMBER_OFFSET) - 1;
     // combined number and generation
-    // The highest 16 bits hold the generation 0-65535
+    // The lowest 16 bits hold the generation 0-65535
     // The rest is used for the number (even though 34 bit are sufficient for 10 digits)
     private final long numberAndGeneration;
     
@@ -57,7 +57,7 @@ public final class COSObjectKey implements Comparable<COSObjectKey>
         {
             throw new IllegalArgumentException("Generation number must not be a negative value");
         }
-        numberAndGeneration = (long) gen << GENERATION_OFFSET | (num & NUMBER_MASK);
+        numberAndGeneration = num << NUMBER_OFFSET | (gen & GENERATION_MASK);
     }
 
     /**
@@ -78,7 +78,7 @@ public final class COSObjectKey implements Comparable<COSObjectKey>
      */
     public int getGeneration()
     {
-        return (int) (numberAndGeneration >>> GENERATION_OFFSET);
+        return (int) (numberAndGeneration & GENERATION_MASK);
     }
 
     /**
@@ -88,7 +88,7 @@ public final class COSObjectKey implements Comparable<COSObjectKey>
      */
     public long getNumber()
     {
-        return numberAndGeneration & NUMBER_MASK;
+        return numberAndGeneration >>> NUMBER_OFFSET;
     }
 
     /**
diff --git a/pdfbox/src/test/java/org/apache/pdfbox/cos/COSObjectKeyTest.java b/pdfbox/src/test/java/org/apache/pdfbox/cos/COSObjectKeyTest.java
index a6dae3b876..8ba5b555e7 100644
--- a/pdfbox/src/test/java/org/apache/pdfbox/cos/COSObjectKeyTest.java
+++ b/pdfbox/src/test/java/org/apache/pdfbox/cos/COSObjectKeyTest.java
@@ -17,9 +17,7 @@
 package org.apache.pdfbox.cos;
 
 import static org.junit.jupiter.api.Assertions.assertEquals;
-import static org.junit.jupiter.api.Assertions.assertFalse;
 import static org.junit.jupiter.api.Assertions.assertNotEquals;
-import static org.junit.jupiter.api.Assertions.assertTrue;
 import static org.junit.jupiter.api.Assertions.fail;
 
 import org.junit.jupiter.api.Test;
@@ -107,6 +105,22 @@ class COSObjectKeyTest
         assertEquals(123, key.getGeneration());
     }
 
+    @Test
+    void testSortingOrder()
+    {
+        // comparison is done by comparing the object numbers first
+        // if they are equal the generation numbers are taken into account
+        COSObjectKey key40 = new COSObjectKey(4, 0);
+        COSObjectKey key41 = new COSObjectKey(4, 1);
+        COSObjectKey key50 = new COSObjectKey(5, 0);
+
+        assertEquals(0, key40.compareTo(key40));
+        assertEquals(0, key41.compareTo(key41));
+        assertEquals(-1, key40.compareTo(key41));
+        assertEquals(-1, key40.compareTo(key50));
+        assertEquals(-1, key41.compareTo(key50));
+    }
+
     @Test
     void checkHashCode()
     {
