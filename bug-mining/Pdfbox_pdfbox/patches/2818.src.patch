diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/PDFXrefStreamParser.java b/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/PDFXrefStreamParser.java
index 0b7cf9c923..0d1df7751b 100755
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/PDFXrefStreamParser.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/PDFXrefStreamParser.java
@@ -181,7 +181,6 @@ public class PDFXrefStreamParser extends BaseParser
         private int currentRange = 0;
         private long currentEnd = 0;
         private long currentNumber = 0;
-        private long maxValue = 0;
 
         private ObjectNumbers(COSArray indexArray) throws IOException
         {
@@ -209,7 +208,6 @@ public class PDFXrefStreamParser extends BaseParser
                 long sizeValue = ((COSInteger) base).longValue();
                 start[counter] = startValue;
                 end[counter] = startValue + sizeValue;
-                maxValue = Math.max(maxValue, end[counter]);
                 counter++;
             }
             currentNumber = start[0];
@@ -219,20 +217,20 @@ public class PDFXrefStreamParser extends BaseParser
         @Override
         public boolean hasNext()
         {
-            return currentNumber < maxValue;
+            return currentRange < start.length || currentNumber < currentEnd;
         }
 
         @Override
         public Long next()
         {
-            if (currentNumber >= maxValue)
-            {
-                throw new NoSuchElementException();
-            }
             if (currentNumber < currentEnd)
             {
                 return currentNumber++;
             }
+            if (currentRange >= start.length - 1)
+            {
+                throw new NoSuchElementException();
+            }
             currentNumber = start[++currentRange];
             currentEnd = end[currentRange];
             return currentNumber++;
