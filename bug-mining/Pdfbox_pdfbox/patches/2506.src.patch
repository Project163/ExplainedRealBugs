diff --git a/pdfbox/src/main/java/org/apache/pdfbox/io/RandomAccessReadBuffer.java b/pdfbox/src/main/java/org/apache/pdfbox/io/RandomAccessReadBuffer.java
index f8e55b379c..aea9858139 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/io/RandomAccessReadBuffer.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/io/RandomAccessReadBuffer.java
@@ -227,7 +227,14 @@ public class RandomAccessReadBuffer implements RandomAccessRead
         int bytesRead = readRemainingBytes(b, offset, length);
         if (bytesRead == -1)
         {
-            return -1;
+            if (available() > 0)
+            {
+                bytesRead = 0;
+            }
+            else
+            {
+                return -1;
+            }
         }
         while (bytesRead < length && available() > 0)
         {
diff --git a/pdfbox/src/test/java/org/apache/pdfbox/io/RandomAccessReadBufferTest.java b/pdfbox/src/test/java/org/apache/pdfbox/io/RandomAccessReadBufferTest.java
index 7ef40a01d7..f491fbf7f5 100644
--- a/pdfbox/src/test/java/org/apache/pdfbox/io/RandomAccessReadBufferTest.java
+++ b/pdfbox/src/test/java/org/apache/pdfbox/io/RandomAccessReadBufferTest.java
@@ -235,4 +235,24 @@ class RandomAccessReadBufferTest
         }
         Files.delete(path);
     }
+    
+    /**
+     * PDFBOX-5161: failure to read bytes after reading a multiple of 4096. Construction source
+     * must be an InputStream.
+     *
+     * @throws IOException
+     */
+    @Test
+    void testPDFBOX5161() throws IOException
+    {
+        try (RandomAccessRead rar = new RandomAccessReadBuffer(new ByteArrayInputStream(new byte[4099])))
+        {
+            byte[] buf = new byte[4096];
+            int bytesRead = rar.read(buf);
+            assertEquals(4096, bytesRead);
+            bytesRead = rar.read(buf, 0, 3);
+            assertEquals(3, bytesRead);
+        }
+    }
+
 }
