diff --git a/pdfbox/src/main/java/org/apache/pdfbox/filter/DecodeResult.java b/pdfbox/src/main/java/org/apache/pdfbox/filter/DecodeResult.java
index 493c7803cd..6a906844f9 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/filter/DecodeResult.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/filter/DecodeResult.java
@@ -16,6 +16,8 @@
  */
 package org.apache.pdfbox.filter;
 
+import java.awt.image.BufferedImage;
+
 import org.apache.pdfbox.cos.COSDictionary;
 import org.apache.pdfbox.pdmodel.graphics.color.PDJPXColorSpace;
 
@@ -29,6 +31,7 @@ public final class DecodeResult
 {
     private final COSDictionary parameters;
     private PDJPXColorSpace colorSpace;
+    private BufferedImage smask;
 
     DecodeResult(COSDictionary parameters)
     {
@@ -74,4 +77,14 @@ public final class DecodeResult
     {
         this.colorSpace = colorSpace;
     }
+
+    void setJPXSMask(BufferedImage smask)
+    {
+        this.smask = smask;
+    }
+
+    public BufferedImage getJPXSMask()
+    {
+        return smask;
+    }
 }
diff --git a/pdfbox/src/main/java/org/apache/pdfbox/filter/JPXFilter.java b/pdfbox/src/main/java/org/apache/pdfbox/filter/JPXFilter.java
index 549749ca54..17b779895f 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/filter/JPXFilter.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/filter/JPXFilter.java
@@ -178,7 +178,13 @@ public final class JPXFilter extends Filter
                 else if (image.getTransparency() == Transparency.TRANSLUCENT &&
                          parameters.getInt(COSName.SMASK_IN_DATA) > 0)
                 {
-                    LOG.warn("JPEG2000 SMaskInData is not supported, returning opaque image");
+                    // PDFBOX-5657: save the soft mask in DecodeResult and use it later
+                    // we never had SMaskInData = 2, maybe more work is needed
+                    BufferedImage smask = new BufferedImage(
+                            image.getWidth(), image.getHeight(), BufferedImage.TYPE_BYTE_GRAY);
+                    smask.setData(image.getAlphaRaster());
+                    result.setJPXSMask(smask);
+                    // create opaque image
                     BufferedImage bim = new BufferedImage(
                             image.getWidth(), image.getHeight(), BufferedImage.TYPE_INT_RGB);
                     Graphics2D g2d = (Graphics2D) bim.getGraphics();
diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/image/PDImageXObject.java b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/image/PDImageXObject.java
index 9f0ce3ff7c..2c2b9d54e7 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/image/PDImageXObject.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/image/PDImageXObject.java
@@ -82,6 +82,7 @@ public final class PDImageXObject extends PDXObject implements PDImage
     private boolean hasJPXFilter = false;
     // is set to true after reading some values from a JPX-based image
     private boolean jpxValuesInitialized = false;
+    private BufferedImage jpxSMask = null;
 
     /**
      * current resource dictionary (has color spaces)
@@ -453,8 +454,15 @@ public final class PDImageXObject extends PDXObject implements PDImage
         final BufferedImage image;
         final PDImageXObject softMask = getSoftMask();
         final PDImageXObject mask = getMask();
+        if (jpxSMask != null)
+        {
+            // PDFBOX-5657: handle JPEG2000 SMaskInData
+            image = applyMask(SampledImageReader.getRGBImage(this, region, subsampling, getColorKeyMask()),
+                    jpxSMask, false, true,
+                    null);
+        }
         // soft mask (overrides explicit mask)
-        if (softMask != null)
+        else if (softMask != null)
         {
             image = applyMask(SampledImageReader.getRGBImage(this, region, subsampling, getColorKeyMask()),
                     softMask.getOpaqueImage(region, subsampling), softMask.getInterpolate(), true,
@@ -713,6 +721,7 @@ public final class PDImageXObject extends PDXObject implements PDImage
             {
                 colorSpace = decodeResult.getJPXColorSpace();
             }
+            jpxSMask = decodeResult.getJPXSMask();
             jpxValuesInitialized = true;
         }
         catch (IOException exception)
