diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/image/PDImageXObject.java b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/image/PDImageXObject.java
index b165333681..c7763ac7c9 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/image/PDImageXObject.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/image/PDImageXObject.java
@@ -422,28 +422,7 @@ public final class PDImageXObject extends PDXObject implements PDImage
         PDImageXObject softMask = getSoftMask();
         if (softMask != null)
         {
-            COSBase base = softMask.getCOSObject().getItem(COSName.MATTE);
-            float[] matte = null;
-            if (base instanceof COSArray)
-            {
-                // PDFBOX-4267: process /Matte
-                // see PDF specification 1.7, 11.6.5.3 Soft-Mask Images
-                matte = ((COSArray) base).toFloatArray();
-                if (getColorSpace().getNumberOfComponents() == 1 &&
-                    matte.length >= 1)
-                {
-                    // /DeviceGray has only one element in Matte
-                    // See file from PDFBOX-1359, page 14
-                    // Root/Pages/Kids/[2]/Kids/[2]/Resources/XObject/Im1/Resources/XObject/Im0
-                    matte = new float[] { matte[0], matte[0], matte[0] };
-                }
-                if (matte.length != 3)
-                {
-                    LOG.warn("/Matte entry " + Arrays.toString(matte) + 
-                             " for Soft-Mask may not work properly");
-                    matte = Arrays.copyOf(matte, 3);
-                }
-            }
+            float[] matte = extractMatte(softMask);
             image = applyMask(image, softMask.getOpaqueImage(), true, matte);
         }
         else
@@ -467,6 +446,33 @@ public final class PDImageXObject extends PDXObject implements PDImage
         return image;
     }
 
+    private float[] extractMatte(PDImageXObject softMask) throws IOException
+    {
+        COSBase base = softMask.getCOSObject().getItem(COSName.MATTE);
+        float[] matte = null;
+        if (base instanceof COSArray)
+        {
+            // PDFBOX-4267: process /Matte
+            // see PDF specification 1.7, 11.6.5.3 Soft-Mask Images
+            matte = ((COSArray) base).toFloatArray();
+            if (getColorSpace().getNumberOfComponents() == 1 &&
+                    matte.length >= 1)
+            {
+                // /DeviceGray has only one element in Matte
+                // See file from PDFBOX-1359, page 14
+                // Root/Pages/Kids/[2]/Kids/[2]/Resources/XObject/Im1/Resources/XObject/Im0
+                matte = new float[] { matte[0], matte[0], matte[0] };
+            }
+            if (matte.length != 3)
+            {
+                LOG.warn("/Matte entry " + Arrays.toString(matte) +
+                        " for Soft-Mask may not work properly");
+                matte = Arrays.copyOf(matte, 3);
+            }
+        }
+        return matte;
+    }
+
     /**
      * {@inheritDoc}
      * The returned images are not cached.
