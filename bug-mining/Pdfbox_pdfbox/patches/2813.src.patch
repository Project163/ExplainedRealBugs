diff --git a/pdfbox/src/main/java/org/apache/pdfbox/filter/Filter.java b/pdfbox/src/main/java/org/apache/pdfbox/filter/Filter.java
index 4b756c0a4e..2985de838e 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/filter/Filter.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/filter/Filter.java
@@ -226,6 +226,8 @@ public abstract class Filter
                 input = new RandomAccessInputStream(randomAccessWriteBuffer);
                 length = (int) randomAccessWriteBuffer.length();
             }
+            // avoid invalid values;
+            length = length <= 0 ? RandomAccessReadBuffer.DEFAULT_CHUNK_SIZE_4KB : length;
             // we don't know the size of the decoded stream, just estimate a 4 times bigger size than the encoded stream
             // use the estimated stream size as chunk size, use the default chunk size as limit to avoid to big values
             randomAccessWriteBuffer = new RandomAccessReadWriteBuffer(
