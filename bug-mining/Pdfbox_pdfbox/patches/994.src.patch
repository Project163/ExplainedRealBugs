diff --git a/pdfbox/src/main/java/org/apache/pdfbox/cos/COSBase.java b/pdfbox/src/main/java/org/apache/pdfbox/cos/COSBase.java
index 28d0944743..d0044a1af6 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/cos/COSBase.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/cos/COSBase.java
@@ -27,7 +27,6 @@ import java.io.IOException;
  */
 public abstract class COSBase implements COSObjectable
 {
-    private boolean needToBeUpdate;
     private boolean direct;
 
     /**
@@ -35,7 +34,6 @@ public abstract class COSBase implements COSObjectable
      */
     public COSBase()
     {
-      needToBeUpdate = false;
     }
 
     /**
@@ -58,11 +56,6 @@ public abstract class COSBase implements COSObjectable
      */
     public abstract Object accept(ICOSVisitor visitor) throws IOException;
     
-    public void setNeedToBeUpdate(boolean flag) 
-    {
-      needToBeUpdate = flag;
-    }
-    
     /**
      * If the state is set true, the dictionary will be written direct into the called object. 
      * This means, no indirect object will be created.
@@ -83,10 +76,4 @@ public abstract class COSBase implements COSObjectable
     {
       this.direct = direct;
     }
-    
-    public boolean isNeedToBeUpdate() 
-    {
-      return needToBeUpdate;
-    }
-
 }
diff --git a/pdfbox/src/main/java/org/apache/pdfbox/cos/COSDictionary.java b/pdfbox/src/main/java/org/apache/pdfbox/cos/COSDictionary.java
index 5d7dd2dcfd..d8c3824a66 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/cos/COSDictionary.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/cos/COSDictionary.java
@@ -35,6 +35,7 @@ import org.apache.pdfbox.util.DateConverter;
 public class COSDictionary extends COSBase
 {
     private static final String PATH_SEPARATOR = "/";
+    private boolean needToBeUpdated;
 
     /**
      * The name-value pairs of this dictionary. The pairs are kept in the order they were added to the dictionary.
@@ -1318,6 +1319,27 @@ public class COSDictionary extends COSBase
     {
         return visitor.visitFromDictionary(this);
     }
+    
+    /**
+     * Get the update state for the COSWriter.
+     * 
+     * @return the update state.
+     */
+    public boolean isNeedToBeUpdated() 
+    {
+      return needToBeUpdated;
+    }
+    
+    /**
+     * Set the update state of the dictionary for the COSWriter.
+     * 
+     * @param flag the update state.
+     */
+    public void setNeedToBeUpdated(boolean flag) 
+    {
+      needToBeUpdated = flag;
+    }
+    
 
     /**
      * This will add all of the dictionarys keys/values to this dictionary. Only called when adding keys to a trailer
diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/VisualSignatureParser.java b/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/VisualSignatureParser.java
index 53402a0dce..df6964c7a4 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/VisualSignatureParser.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/VisualSignatureParser.java
@@ -209,7 +209,10 @@ public class VisualSignatureParser extends BaseParser
                 endObjectKey = readString();
             }
             COSObject pdfObject = document.getObjectFromPool(key);
-            pb.setNeedToBeUpdate(true);
+            if (pb instanceof COSDictionary)
+            {
+                ((COSDictionary) pb).setNeedToBeUpdated(true);
+            }
             pdfObject.setObject(pb);
 
             if (!endObjectKey.equals(ENDOBJ_STRING))
diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdfwriter/COSWriter.java b/pdfbox/src/main/java/org/apache/pdfbox/pdfwriter/COSWriter.java
index a7d6085d90..e1471baed5 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdfwriter/COSWriter.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdfwriter/COSWriter.java
@@ -480,11 +480,18 @@ public class COSWriter implements ICOSVisitor, Closeable
             {
                 cosBase = keyObject.get(cosObjectKey);
             }
+
             if(actual != null && objectKeys.containsKey(actual) &&
-                    !object.isNeedToBeUpdate() && (cosBase!= null &&
-                    !cosBase.isNeedToBeUpdate()))
+                    cosBase!= null)
             {
-                return;
+                if (object instanceof COSDictionary &&
+                        cosBase instanceof COSDictionary &&
+                        !((COSDictionary) object).isNeedToBeUpdated() &&
+                        !((COSDictionary) cosBase).isNeedToBeUpdated()
+                        )
+                {
+                    return;
+                }
             }
           
             objectsToWrite.add( object );
diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDDocument.java b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDDocument.java
index e8a14ea27e..3052ad01df 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDDocument.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDDocument.java
@@ -202,7 +202,7 @@ public class PDDocument implements Closeable
 
         // Get the AcroForm from the Root-Dictionary and append the annotation
         PDAcroForm acroForm = catalog.getAcroForm();
-        catalog.getCOSObject().setNeedToBeUpdate(true);
+        catalog.getCOSObject().setNeedToBeUpdated(true);
 
         if (acroForm == null)
         {
@@ -211,7 +211,7 @@ public class PDDocument implements Closeable
         }
         else
         {
-            acroForm.getCOSObject().setNeedToBeUpdate(true);
+            acroForm.getDictionary().setNeedToBeUpdated(true);
         }
 
         // For invisible signatures, the annotation has a rectangle array with values [ 0 0 0 0 ]. This annotation is
@@ -264,7 +264,7 @@ public class PDDocument implements Closeable
                     && ((PDSignatureField) field).getCOSObject().equals(signatureField.getCOSObject()))
             {
                 checkFields = true;
-                signatureField.getCOSObject().setNeedToBeUpdate(true);
+                ((COSDictionary) signatureField.getCOSObject()).setNeedToBeUpdated(true);
                 break;
             }
         }
@@ -344,11 +344,11 @@ public class PDDocument implements Closeable
                         signatureField.getWidget().setAppearance(ap);
 
                         // read and set AcroForm DefaultResource
-                        COSBase dr = cosBaseDict.getItem(COSName.DR);
+                        COSDictionary dr = (COSDictionary) cosBaseDict.getItem(COSName.DR);
                         if (dr != null)
                         {
                             dr.setDirect(true);
-                            dr.setNeedToBeUpdate(true);
+                            dr.setNeedToBeUpdated(true);
                             acroFormDict.setItem(COSName.DR, dr);
                         }
                         sigFieldNotFound = false;
@@ -371,7 +371,7 @@ public class PDDocument implements Closeable
         {
             annotations.add(signatureField.getWidget());
         }
-        page.getCOSObject().setNeedToBeUpdate(true);
+        ((COSDictionary) page.getCOSObject()).setNeedToBeUpdated(true);
     }
 
     /**
@@ -386,7 +386,7 @@ public class PDDocument implements Closeable
             SignatureOptions options) throws IOException
     {
         PDDocumentCatalog catalog = getDocumentCatalog();
-        catalog.getCOSObject().setNeedToBeUpdate(true);
+        ((COSDictionary) catalog.getCOSObject()).setNeedToBeUpdated(true);
 
         PDAcroForm acroForm = catalog.getAcroForm();
         if (acroForm == null)
@@ -396,12 +396,12 @@ public class PDDocument implements Closeable
         }
         else
         {
-            acroForm.getCOSObject().setNeedToBeUpdate(true);
+            ((COSDictionary) acroForm.getCOSObject()).setNeedToBeUpdated(true);
         }
 
         COSDictionary acroFormDict = acroForm.getDictionary();
         acroFormDict.setDirect(true);
-        acroFormDict.setNeedToBeUpdate(true);
+        acroFormDict.setNeedToBeUpdated(true);
         if (!acroForm.isSignaturesExist())
         {
             // 1 if at least one signature field is available
@@ -413,7 +413,7 @@ public class PDDocument implements Closeable
         for (PDSignatureField sigField : sigFields)
         {
             PDSignature sigObject = sigField.getSignature();
-            sigField.getCOSObject().setNeedToBeUpdate(true);
+            ((COSDictionary) sigField.getCOSObject()).setNeedToBeUpdated(true);
 
             // Check if the field already exists
             boolean checkFields = false;
@@ -423,7 +423,7 @@ public class PDDocument implements Closeable
                         && fieldNode.getCOSObject().equals(sigField.getCOSObject()))
                 {
                     checkFields = true;
-                    sigField.getCOSObject().setNeedToBeUpdate(true);
+                    ((COSDictionary) sigField.getCOSObject()).setNeedToBeUpdated(true);
                     break;
                 }
             }
@@ -436,7 +436,7 @@ public class PDDocument implements Closeable
             // Check if we need to add a signature
             if (sigField.getSignature() != null)
             {
-                sigField.getCOSObject().setNeedToBeUpdate(true);
+                ((COSDictionary) sigField.getCOSObject()).setNeedToBeUpdated(true);
                 if (options == null)
                 {
 
diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/interactive/digitalsignature/visible/PDVisibleSigBuilder.java b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/interactive/digitalsignature/visible/PDVisibleSigBuilder.java
index 5ec54af881..98b199d3d0 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/interactive/digitalsignature/visible/PDVisibleSigBuilder.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/interactive/digitalsignature/visible/PDVisibleSigBuilder.java
@@ -374,7 +374,7 @@ public class PDVisibleSigBuilder implements PDFTemplateBuilder
                                        PDResources holderFormResources) throws IOException
     {
         COSDictionary widgetDict = signatureField.getWidget().getDictionary();
-        widgetDict.setNeedToBeUpdate(true);
+        widgetDict.setNeedToBeUpdated(true);
         widgetDict.setItem(COSName.DR, holderFormResources.getCOSObject());
 
         pdfStructure.setWidgetDictionary(widgetDict);
diff --git a/pdfbox/src/test/java/org/apache/pdfbox/cos/TestCOSBase.java b/pdfbox/src/test/java/org/apache/pdfbox/cos/TestCOSBase.java
index 4608302088..7af0854512 100644
--- a/pdfbox/src/test/java/org/apache/pdfbox/cos/TestCOSBase.java
+++ b/pdfbox/src/test/java/org/apache/pdfbox/cos/TestCOSBase.java
@@ -42,17 +42,6 @@ public abstract class TestCOSBase extends TestCase
      */
     public abstract void testAccept() throws IOException;
 
-    /**
-     * Tests isNeedToBeUpdate() and setNeedToBeUpdate() - tests the getter/setter methods.
-     */
-    public void testIsSetNeedToBeUpdate()
-    {
-        testCOSBase.setNeedToBeUpdate(true);
-        assertTrue(testCOSBase.isNeedToBeUpdate());
-        testCOSBase.setNeedToBeUpdate(false);
-        assertFalse(testCOSBase.isNeedToBeUpdate());
-    }
-
     /**
      * Tests isDirect() and setDirect() - tests the getter/setter methods.
      */
diff --git a/pdfbox/src/test/java/org/apache/pdfbox/cos/TestCOSDictionary.java b/pdfbox/src/test/java/org/apache/pdfbox/cos/TestCOSDictionary.java
new file mode 100644
index 0000000000..3b0fc999c0
--- /dev/null
+++ b/pdfbox/src/test/java/org/apache/pdfbox/cos/TestCOSDictionary.java
@@ -0,0 +1,46 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package org.apache.pdfbox.cos;
+
+import static org.junit.Assert.assertTrue;
+import static org.junit.Assert.assertFalse;
+
+import org.junit.Test;
+
+/**
+ * Test class for {@link COSDictionary}.
+ */
+public class TestCOSDictionary
+{
+    
+    /** The COSDictionary abstraction of the object being tested. */
+    protected COSDictionary testCOSDictionary = new COSDictionary();;
+    
+    /**
+     * Tests isNeedToBeUpdate() and setNeedToBeUpdate() - tests the getter/setter methods.
+     */
+    @Test
+    public void testIsSetNeedToBeUpdate()
+    {
+        testCOSDictionary.setNeedToBeUpdated(true);
+        assertTrue(testCOSDictionary.isNeedToBeUpdated());
+        testCOSDictionary.setNeedToBeUpdated(false);
+        assertFalse(testCOSDictionary.isNeedToBeUpdated());
+    }
+
+}
