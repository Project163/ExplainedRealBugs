diff --git a/pdfbox/src/main/java/org/apache/pdfbox/multipdf/Splitter.java b/pdfbox/src/main/java/org/apache/pdfbox/multipdf/Splitter.java
index 8d4f50f043..7f7a489546 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/multipdf/Splitter.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/multipdf/Splitter.java
@@ -23,7 +23,6 @@ import java.util.HashSet;
 import java.util.LinkedHashMap;
 import java.util.List;
 import java.util.Map;
-import java.util.Optional;
 import java.util.Set;
 
 import org.apache.logging.log4j.Logger;
@@ -236,14 +235,7 @@ public class Splitter
         PDNumberTreeNode dstNumberTreeNode = new PDNumberTreeNode(PDParentTreeValue.class);
         dstNumberTreeNode.setNumbers(dstNumberTreeAsMap);
         dstStructureTreeRoot.setParentTree(dstNumberTreeNode);
-
-        // get highest key + 1
-        Optional<Integer> max = dstNumberTreeAsMap.keySet().stream().max(Integer::compareTo);
-        if (max.isPresent())
-        {
-            dstStructureTreeRoot.setParentTreeNextKey(max.get() + 1);
-        }
-
+        dstStructureTreeRoot.setParentTreeNextKey(dstNumberTreeNode.getUpperLimit() + 1);
         dstStructureTreeRoot.setClassMap(srcStructureTreeRoot.getClassMap());
         cloneRoleMap(srcStructureTreeRoot, dstStructureTreeRoot);
         cloneIDTree(srcStructureTreeRoot, dstStructureTreeRoot);
