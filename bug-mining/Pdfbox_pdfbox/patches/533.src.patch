diff --git a/pdfbox/src/main/java/org/apache/pdfbox/cos/COSDocument.java b/pdfbox/src/main/java/org/apache/pdfbox/cos/COSDocument.java
index d02a16b3e5..434e7a8c36 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/cos/COSDocument.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/cos/COSDocument.java
@@ -240,17 +240,24 @@ public class COSDocument extends COSBase implements Closeable
     {
         for( COSObject object : objectPool.values() )
         {
-
             COSBase realObject = object.getObject();
             if( realObject instanceof COSDictionary )
             {
                 try
                 {
                     COSDictionary dic = (COSDictionary)realObject;
-                    COSName objectType = (COSName)dic.getItem( COSName.TYPE );
-                    if( objectType != null && objectType.equals( type ) )
+                    COSBase typeItem = dic.getItem(COSName.TYPE);
+                    if (typeItem != null && typeItem instanceof COSName)
+                    {
+                        COSName objectType = (COSName) typeItem;
+                        if (objectType.equals(type))
+                        {
+                            return object;
+                        }
+                    }
+                    else if (typeItem != null)
                     {
-                        return object;
+                        LOG.warn("Expected a /Name object after /Type, got '" + typeItem + "' instead");
                     }
                 }
                 catch (ClassCastException e)
diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdfwriter/COSWriter.java b/pdfbox/src/main/java/org/apache/pdfbox/pdfwriter/COSWriter.java
index 6284c0c7f9..72a8a685a4 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdfwriter/COSWriter.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdfwriter/COSWriter.java
@@ -516,10 +516,14 @@ public class COSWriter implements ICOSVisitor, Closeable
         if(obj instanceof COSDictionary)
         {
             COSDictionary dict = (COSDictionary)obj;
-            COSName item = (COSName)dict.getItem(COSName.TYPE);
-            if (COSName.SIG.equals(item) || COSName.DOC_TIME_STAMP.equals(item))
+            COSBase itemType = dict.getItem(COSName.TYPE);
+            if (itemType instanceof COSName)
             {
-                reachedSignature = true;
+                COSName item = (COSName) itemType;
+                if (COSName.SIG.equals(item) || COSName.DOC_TIME_STAMP.equals(item))
+                {
+                    reachedSignature = true;
+                }
             }
         }
 
