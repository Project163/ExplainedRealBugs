diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/PDFXRefStream.java b/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/PDFXRefStream.java
index 8ae7953b46..5a5f470547 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/PDFXRefStream.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/PDFXRefStream.java
@@ -77,7 +77,8 @@ public class PDFXRefStream implements PDFXRef
         {
             throw new IllegalArgumentException("size is not set in xrefstream");
         }
-        stream.setLong(COSName.SIZE, getSizeEntry());
+        // add one for object number 0
+        stream.setLong(COSName.SIZE, streamData.size() + 1);
     
         List<Long> indexEntry = getIndexEntry();
         COSArray indexAsArray = new COSArray();
@@ -212,11 +213,6 @@ public class PDFXRefStream implements PDFXRef
         return w;
     }
 
-    private long getSizeEntry()
-    {
-        return size;
-    }
-
     /**
      * Set the size of the XRef stream.
      * 
@@ -232,8 +228,11 @@ public class PDFXRefStream implements PDFXRef
         LinkedList<Long> linkedList = new LinkedList<Long>();
         Long first = null;
         Long length = null;
-
-        for ( Long objNumber : objectNumbers )
+        Set<Long> objNumbers = new TreeSet<Long>();
+        // add object number 0 to the set
+        objNumbers.add(0L);
+        objNumbers.addAll(objectNumbers);
+        for ( Long objNumber : objNumbers )
         {
             if (first == null)
             {
@@ -275,6 +274,10 @@ public class PDFXRefStream implements PDFXRef
 
     private void writeStreamData(OutputStream os, int[] w) throws IOException
     {
+        // write dummy entry for object number 0
+        writeNumber(os, ENTRY_FREE, w[0]);
+        writeNumber(os, ENTRY_FREE, w[1]);
+        writeNumber(os, 0xFFFF, w[2]);
         // iterate over all streamData and write it in the required format
         for ( Object entry : streamData.values() )
         {
