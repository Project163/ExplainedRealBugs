diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/state/PDExtendedGraphicsState.java b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/state/PDExtendedGraphicsState.java
index 61b3cf8d59..4b120e8e6b 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/state/PDExtendedGraphicsState.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/state/PDExtendedGraphicsState.java
@@ -143,7 +143,14 @@ public class PDExtendedGraphicsState implements COSObjectable
             }
             else if( key.equals( COSName.SMASK ) ) 
             {
-                gs.setSoftMask(getSoftMask());
+                PDSoftMask softmask = getSoftMask();
+                if (softmask != null)
+                {
+                    // Softmask must know the CTM at the time the ExtGState is activated. Read
+                    // https://bugs.ghostscript.com/show_bug.cgi?id=691157#c7 for a good explanation.
+                    softmask.setInitialTransformationMatrix(gs.getCurrentTransformationMatrix().clone());
+                }
+                gs.setSoftMask(softmask);
             }
             else if( key.equals( COSName.BM ) ) 
             {
diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/state/PDSoftMask.java b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/state/PDSoftMask.java
index 6b82a1f0f2..6182773b4a 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/state/PDSoftMask.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/state/PDSoftMask.java
@@ -28,6 +28,7 @@ import org.apache.pdfbox.pdmodel.common.COSObjectable;
 import org.apache.pdfbox.pdmodel.common.function.PDFunction;
 import org.apache.pdfbox.pdmodel.graphics.PDXObject;
 import org.apache.pdfbox.pdmodel.graphics.form.PDTransparencyGroup;
+import org.apache.pdfbox.util.Matrix;
 
 /**
  * Soft mask.
@@ -74,6 +75,11 @@ public final class PDSoftMask implements COSObjectable
     private COSArray backdropColor = null;
     private PDFunction transferFunction = null;
 
+    /**
+     * To allow a soft mask to know the CTM at the time of activation of the ExtGState.
+     */
+    private Matrix ctm;
+
     /**
      * Creates a new soft mask.
      *
@@ -153,4 +159,24 @@ public final class PDSoftMask implements COSObjectable
         }
         return transferFunction;
     }
+
+    /**
+     * Set the CTM that is valid at the time the ExtGState was activated.
+     *
+     * @param ctm
+     */
+    void setInitialTransformationMatrix(Matrix ctm)
+    {
+        this.ctm = ctm;
+    }
+
+    /**
+     * Returns the CTM at the time the ExtGState was activated.
+     *
+     * @return
+     */
+    public Matrix getInitialTransformationMatrix()
+    {
+        return ctm;
+    }
 }
