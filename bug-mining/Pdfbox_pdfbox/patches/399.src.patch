diff --git a/pdfbox/src/main/java/org/apache/pdfbox/cos/COSStream.java b/pdfbox/src/main/java/org/apache/pdfbox/cos/COSStream.java
index 22735a27f5..69104388d3 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/cos/COSStream.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/cos/COSStream.java
@@ -28,13 +28,10 @@ import org.apache.commons.logging.Log;
 import org.apache.commons.logging.LogFactory;
 import org.apache.pdfbox.filter.Filter;
 import org.apache.pdfbox.filter.FilterManager;
+import org.apache.pdfbox.io.*;
 import org.apache.pdfbox.pdfparser.PDFStreamParser;
 import org.apache.pdfbox.exceptions.COSVisitorException;
 import org.apache.pdfbox.io.IOUtils;
-import org.apache.pdfbox.io.RandomAccess;
-import org.apache.pdfbox.io.RandomAccessFileInputStream;
-import org.apache.pdfbox.io.RandomAccessFileOutputStream;
-
 /**
  * This class represents a stream object in a PDF document.
  *
@@ -61,6 +58,16 @@ public class COSStream extends COSDictionary
      */
     private RandomAccessFileOutputStream unFilteredStream;
 
+    private RandomAccess clone (RandomAccess file) {
+        if (file == null) {
+            return null;
+        } else if (file instanceof RandomAccessFile) {
+            return file;
+        } else {
+            return ((RandomAccessBuffer)file).clone();
+        }
+    }
+
     /**
      * Constructor.  Creates a new stream with an empty dictionary.
      *
@@ -69,7 +76,7 @@ public class COSStream extends COSDictionary
     public COSStream( RandomAccess storage )
     {
         super();
-        file = storage;
+        file = clone(storage);
     }
 
     /**
@@ -81,7 +88,7 @@ public class COSStream extends COSDictionary
     public COSStream( COSDictionary dictionary, RandomAccess storage )
     {
         super( dictionary );
-        file = storage;
+        file = clone(storage);
     }
 
     /**
diff --git a/pdfbox/src/main/java/org/apache/pdfbox/io/RandomAccessBuffer.java b/pdfbox/src/main/java/org/apache/pdfbox/io/RandomAccessBuffer.java
index ada6660afe..53c5bcc8b4 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/io/RandomAccessBuffer.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/io/RandomAccessBuffer.java
@@ -59,6 +59,30 @@ public class RandomAccessBuffer implements RandomAccess
         bufferListMaxIndex = 0;
     }
 
+    @Override
+    public RandomAccessBuffer clone() {
+        RandomAccessBuffer copy = new RandomAccessBuffer();
+
+        copy.bufferList = new ArrayList<byte[]>(bufferList.size());
+        for (byte [] buffer : bufferList) {
+            byte [] newBuffer = new byte [buffer.length];
+            System.arraycopy(buffer,0,newBuffer,0,buffer.length);
+            copy.bufferList.add(newBuffer);
+        }
+        if (currentBuffer!=null) {
+            copy.currentBuffer = copy.bufferList.get(copy.bufferList.size()-1);
+        } else {
+            copy.currentBuffer = null;
+        }
+        copy.pointer = pointer;
+        copy.currentBufferPointer = currentBufferPointer;
+        copy.size = size;
+        copy.bufferListIndex = bufferListIndex;
+        copy.bufferListMaxIndex = bufferListMaxIndex;
+
+        return copy;
+    }
+
     /**
      * {@inheritDoc}
      */
