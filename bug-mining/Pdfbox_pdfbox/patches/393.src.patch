diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDResources.java b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDResources.java
index e73bac14fc..148119af7a 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDResources.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDResources.java
@@ -245,7 +245,7 @@ public class PDResources implements COSObjectable
                     PDXObject xobject = null;
                     try
                     {
-                        xobject = PDXObject.createXObject(xobjectsDictionary.getDictionaryObject(objName));
+                        xobject = PDXObject.createXObject(xobjectsDictionary.getDictionaryObject(objName), objName.getName());
                     }
                     catch (IOException exception)
                     {
@@ -636,6 +636,38 @@ public class PDResources implements COSObjectable
         return objMapping;
     }
 
+    /**
+     * Remove the xobject with given name.
+     * 
+     * @param xobjectName the name of the xobject to be removed.
+     */
+    public void removeXObject(String xobjectName)
+    {
+        COSDictionary xobjectsDictionary = (COSDictionary) resources.getDictionaryObject(COSName.XOBJECT);
+        xobjectsDictionary.removeItem(COSName.getPDFName(xobjectName));
+        if (xobjects != null && xobjects.containsKey(xobjectName))
+        {
+        	xobjectMappings.remove(xobjects.get(xobjectName));
+        	xobjects.remove(xobjectName);
+        }
+    }
+    
+    /**
+     * Remove the font with given name.
+     * 
+     * @param fontName the name of the font to be removed.
+     */
+    public void removeFont(String fontName)
+    {
+        COSDictionary xobjectsDictionary = (COSDictionary) resources.getDictionaryObject(COSName.FONT);
+        xobjectsDictionary.removeItem(COSName.getPDFName(fontName));
+        if (fonts != null && fonts.containsKey(fontName))
+        {
+        	fontMappings.remove(fonts.get(fontName));
+        	fonts.remove(fontName);
+        }
+    }
+
     private void addXObjectToDictionary(PDXObject xobject, String xobjectName)
     {
         COSDictionary xobjectsDictionary = (COSDictionary) resources.getDictionaryObject(COSName.XOBJECT);
diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/xobject/PDXObject.java b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/xobject/PDXObject.java
index 524e4d8378..5383ae13f5 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/xobject/PDXObject.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/xobject/PDXObject.java
@@ -119,7 +119,21 @@ public abstract class PDXObject implements COSObjectable
      */
     public static PDXObject createXObject(COSBase xobject) throws IOException
     {
-        return commonXObjectCreation(xobject, false);
+        return createXObject(xobject, null);
+    }
+
+    /**
+     * Create the correct xobject from the cos base.
+     * 
+     * @param xobject The cos level xobject to create.
+     * @param xobjectName The name of the xobject, sued to detect a possible recursion
+     * 
+     * @return a pdmodel xobject
+     * @throws IOException If there is an error creating the xobject.
+     */
+    public static PDXObject createXObject(COSBase xobject, String xobjectName) throws IOException
+    {
+        return commonXObjectCreation(xobject, false, xobjectName);
     }
 
     /**
@@ -128,10 +142,12 @@ public abstract class PDXObject implements COSObjectable
      * @param xobject The cos level xobject to create.
      * @param isthumb specify if the xobject represent a Thumbnail Image (in this case, the subtype null must be
      * considered as an Image)
+     * @param xobjectName The name of the xobject, used to detect a possible recursion
+     * 
      * @return a pdmodel xobject
      * @throws IOException If there is an error creating the xobject.
      */
-    protected static PDXObject commonXObjectCreation(COSBase xobject, boolean isThumb)
+    protected static PDXObject commonXObjectCreation(COSBase xobject, boolean isThumb, String xobjectName)
     {
         PDXObject retval = null;
         if (xobject == null)
@@ -174,7 +190,7 @@ public abstract class PDXObject implements COSObjectable
             }
             else if (PDXObjectForm.SUB_TYPE.equals(subtype))
             {
-                retval = new PDXObjectForm(xstream);
+                retval = new PDXObjectForm(xstream, xobjectName);
             }
             else
             {
diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/xobject/PDXObjectForm.java b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/xobject/PDXObjectForm.java
index cec0b7eb40..7862b722a9 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/xobject/PDXObjectForm.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/xobject/PDXObjectForm.java
@@ -17,7 +17,10 @@
 package org.apache.pdfbox.pdmodel.graphics.xobject;
 
 import java.awt.geom.AffineTransform;
+import java.util.Map;
 
+import org.apache.commons.logging.Log;
+import org.apache.commons.logging.LogFactory;
 import org.apache.pdfbox.cos.COSArray;
 import org.apache.pdfbox.cos.COSDictionary;
 import org.apache.pdfbox.cos.COSFloat;
@@ -33,15 +36,22 @@ import org.apache.pdfbox.util.Matrix;
  * A form xobject.
  * 
  * @author <a href="mailto:ben@benlitchfield.com">Ben Litchfield</a>
- * @version $Revision: 1.6 $
+ * 
  */
 public class PDXObjectForm extends PDXObject
 {
+
+    /**
+     * Log instance.
+     */
+    private static final Log LOG = LogFactory.getLog(PDXObjectForm.class);
+    
     /**
      * The XObject subtype.
      */
     public static final String SUB_TYPE = "Form";
-
+    private String name = null;
+    
     /**
      * Standard constuctor.
      * 
@@ -54,14 +64,27 @@ public class PDXObjectForm extends PDXObject
     }
 
     /**
-     * Standard constuctor.
+     * Standard constructor.
      * 
      * @param formStream The XObject is passed as a COSStream.
      */
     public PDXObjectForm(COSStream formStream)
+    {
+    	this(formStream, null);
+    }
+    
+    /**
+     * Standard constructor including the name of the XObjectForm
+     * to avoid recursions.
+     * 
+     * @param formStream The XObject is passed as a COSStream.
+     * @param xobjectName The name of the XObjectForm.
+     */
+    public PDXObjectForm(COSStream formStream, String xobjectName)
     {
         super(formStream);
         getCOSStream().setName(COSName.SUBTYPE, SUB_TYPE);
+        name = xobjectName;
     }
 
     /**
@@ -71,7 +94,7 @@ public class PDXObjectForm extends PDXObject
      */
     public int getFormType()
     {
-        return getCOSStream().getInt("FormType", 1);
+        return getCOSStream().getInt(COSName.FORMTYPE, 1);
     }
 
     /**
@@ -81,7 +104,7 @@ public class PDXObjectForm extends PDXObject
      */
     public void setFormType(int formType)
     {
-        getCOSStream().setInt("FormType", formType);
+        getCOSStream().setInt(COSName.FORMTYPE, formType);
     }
 
     /**
@@ -97,6 +120,16 @@ public class PDXObjectForm extends PDXObject
         if (resources != null)
         {
             retval = new PDResources(resources);
+            // check for a recursion, see PDFBOX-1813
+            if (name != null)
+            {
+            	Map<String, PDXObject> xobjects = retval.getXObjects();
+            	if (xobjects != null && xobjects.containsKey(name))
+            	{
+            		retval.removeXObject(name);
+            		LOG.debug("Removed XObjectForm "+name+" to avoid a recursion");
+            	}
+            }
         }
         return retval;
     }
diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/xobject/PDXObjectImage.java b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/xobject/PDXObjectImage.java
index 799a74ea46..8c65698a14 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/xobject/PDXObjectImage.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/xobject/PDXObjectImage.java
@@ -99,7 +99,7 @@ public abstract class PDXObjectImage extends PDXObject
      */
     public static PDXObject createThumbnailXObject(COSBase xobject) throws IOException
     {
-        return commonXObjectCreation(xobject, true);
+        return commonXObjectCreation(xobject, true, null);
     }
 
     /**
