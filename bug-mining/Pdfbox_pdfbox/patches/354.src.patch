diff --git a/pdfbox/src/main/java/org/apache/pdfbox/cos/COSName.java b/pdfbox/src/main/java/org/apache/pdfbox/cos/COSName.java
index e6e6ceb674..f20017585e 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/cos/COSName.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/cos/COSName.java
@@ -25,40 +25,37 @@ import java.util.concurrent.ConcurrentHashMap;
 import org.apache.pdfbox.exceptions.COSVisitorException;
 import org.apache.pdfbox.persistence.util.COSHEXTable;
 
-
 /**
  * This class represents a PDF named object.
- *
+ * 
  * @author <a href="mailto:ben@benlitchfield.com">Ben Litchfield</a>
- * @version $Revision: 1.42 $
+ * 
  */
 public final class COSName extends COSBase implements Comparable<COSName>
 {
     /**
-     * Note: This is a ConcurrentHashMap because a HashMap must be synchronized if accessed by
-     * multiple threads.
+     * Note: This is a ConcurrentHashMap because a HashMap must be synchronized if accessed by multiple threads.
      */
     private static Map<String, COSName> nameMap = new ConcurrentHashMap<String, COSName>(8192);
 
     /**
-     * All common COSName values are stored in a simple HashMap. They are already defined as
-     * static constants and don't need to be synchronized for multithreaded environments.
+     * All common COSName values are stored in a simple HashMap. They are already defined as static constants and don't
+     * need to be synchronized for multithreaded environments.
      */
-    private static Map<String, COSName> commonNameMap =
-        new HashMap<String, COSName>();
+    private static Map<String, COSName> commonNameMap = new HashMap<String, COSName>();
 
     /**
      * A common COSName value.
      */
-    public static final COSName A = new COSName( "A" );
+    public static final COSName A = new COSName("A");
     /**
      * A common COSName value.
      */
-    public static final COSName AA = new COSName( "AA" );
+    public static final COSName AA = new COSName("AA");
     /**
-    * A common COSName value.
-    */
-    public static final COSName ACRO_FORM = new COSName( "AcroForm" );
+     * A common COSName value.
+     */
+    public static final COSName ACRO_FORM = new COSName("AcroForm");
     /**
      * A common COSName value.
      */
@@ -66,7 +63,7 @@ public final class COSName extends COSBase implements Comparable<COSName>
     /**
      * A common COSName value.
      */
-    public static final COSName AIS = new COSName( "AIS" );
+    public static final COSName AIS = new COSName("AIS");
     /**
      * A common COSName value.
      */
@@ -76,21 +73,21 @@ public final class COSName extends COSBase implements Comparable<COSName>
      */
     public static final COSName ALTERNATE = new COSName("Alternate");
     /**
-    * A common COSName value.
-    */
-    public static final COSName ANNOT = new COSName( "Annot" );
+     * A common COSName value.
+     */
+    public static final COSName ANNOT = new COSName("Annot");
     /**
      * A common COSName value.
      */
-    public static final COSName ANNOTS = new COSName( "Annots" );
+    public static final COSName ANNOTS = new COSName("Annots");
     /**
      * A common COSName value.
      */
-    public static final COSName ANTI_ALIAS = new COSName( "AntiAlias" );
+    public static final COSName ANTI_ALIAS = new COSName("AntiAlias");
     /**
      * A common COSName value.
      */
-    public static final COSName AP_REF = new COSName( "APRef" );
+    public static final COSName AP_REF = new COSName("APRef");
     /**
      * A common COSName value.
      */
@@ -98,19 +95,19 @@ public final class COSName extends COSBase implements Comparable<COSName>
     /**
      * A common COSName value.
      */
-    public static final COSName ART_BOX = new COSName("ArtBox" );
+    public static final COSName ART_BOX = new COSName("ArtBox");
     /**
-    * A common COSName value.
-    */
-    public static final COSName AS = new COSName( "AS" );
+     * A common COSName value.
+     */
+    public static final COSName AS = new COSName("AS");
     /**
      * A common COSName value.
      */
-    public static final COSName ASCII85_DECODE = new COSName( "ASCII85Decode" );
+    public static final COSName ASCII85_DECODE = new COSName("ASCII85Decode");
     /**
-    * A common COSName value.
-    */
-    public static final COSName ASCII85_DECODE_ABBREVIATION = new COSName( "A85" );
+     * A common COSName value.
+     */
+    public static final COSName ASCII85_DECODE_ABBREVIATION = new COSName("A85");
     /**
      * A common COSName value.
      */
@@ -118,100 +115,100 @@ public final class COSName extends COSBase implements Comparable<COSName>
     /**
      * A common COSName value.
      */
-    public static final COSName ASCENT = new COSName( "Ascent" );
+    public static final COSName ASCENT = new COSName("Ascent");
     /**
      * A common COSName value.
      */
-    public static final COSName ASCII_HEX_DECODE = new COSName( "ASCIIHexDecode" );
+    public static final COSName ASCII_HEX_DECODE = new COSName("ASCIIHexDecode");
     /**
-    * A common COSName value.
-    */
-    public static final COSName ASCII_HEX_DECODE_ABBREVIATION = new COSName( "AHx" );
+     * A common COSName value.
+     */
+    public static final COSName ASCII_HEX_DECODE_ABBREVIATION = new COSName("AHx");
 
     /**
      * A common COSName value.
      */
-    public static final COSName AP = new COSName( "AP" );
+    public static final COSName AP = new COSName("AP");
     /**
      * A common COSName value.
      */
-    public static final COSName APP = new COSName( "App" );
+    public static final COSName APP = new COSName("App");
 
     /**
      * A common COSName value.
      */
-    public static final COSName AUTHOR = new COSName( "Author" );
+    public static final COSName AUTHOR = new COSName("Author");
 
     /**
      * A common COSName value.
      */
-    public static final COSName AVG_WIDTH = new COSName( "AvgWidth" );
+    public static final COSName AVG_WIDTH = new COSName("AvgWidth");
 
     /**
      * A common COSName value.
      */
-    public static final COSName B = new COSName( "B" );
+    public static final COSName B = new COSName("B");
     /**
-    * A common COSName value.
-    */
-    public static final COSName BACKGROUND = new COSName( "Background" );
+     * A common COSName value.
+     */
+    public static final COSName BACKGROUND = new COSName("Background");
     /**
-    * A common COSName value.
-    */
-    public static final COSName BASE_ENCODING = new COSName( "BaseEncoding" );
+     * A common COSName value.
+     */
+    public static final COSName BASE_ENCODING = new COSName("BaseEncoding");
     /**
-    * A common COSName value.
-    */
-    public static final COSName BASE_FONT = new COSName( "BaseFont" );
+     * A common COSName value.
+     */
+    public static final COSName BASE_FONT = new COSName("BaseFont");
 
     /** the COSName for "BaseState". */
-    public static final COSName BASE_STATE = new COSName( "BaseState" );
+    public static final COSName BASE_STATE = new COSName("BaseState");
 
     /**
      * A common COSName value.
      */
-    public static final COSName BBOX = new COSName( "BBox" );
+    public static final COSName BBOX = new COSName("BBox");
     /**
      * A common COSName value.
      */
-    public static final COSName BLACK_IS_1 = new COSName( "BlackIs1" );
+    public static final COSName BLACK_IS_1 = new COSName("BlackIs1");
     /**
      * A common COSName value.
      */
-    public static final COSName BLACK_POINT = new COSName( "BlackPoint" );
+    public static final COSName BLACK_POINT = new COSName("BlackPoint");
 
     /**
      * A common COSName value.
      */
-    public static final COSName BLEED_BOX = new COSName("BleedBox" );
+    public static final COSName BLEED_BOX = new COSName("BleedBox");
     /**
      * A common COSName value.
      */
-    public static final COSName BITS_PER_COMPONENT = new COSName("BitsPerComponent" );
+    public static final COSName BITS_PER_COMPONENT = new COSName("BitsPerComponent");
     /**
      * A common COSName value.
      */
-    public static final COSName BITS_PER_COORDINATE = new COSName("BitsPerCoordinate" );
+    public static final COSName BITS_PER_COORDINATE = new COSName("BitsPerCoordinate");
     /**
      * A common COSName value.
      */
-    public static final COSName BITS_PER_FLAG = new COSName("BitsPerFlag" );
+    public static final COSName BITS_PER_FLAG = new COSName("BitsPerFlag");
     /**
      * A common COSName value.
      */
-    public static final COSName BITS_PER_SAMPLE = new COSName("BitsPerSample" );
+    public static final COSName BITS_PER_SAMPLE = new COSName("BitsPerSample");
     /**
      * A common COSName value.
      */
-    public static final COSName BOUNDS = new COSName("Bounds" );
+    public static final COSName BOUNDS = new COSName("Bounds");
     /**
      * A common COSName value.
      */
-    public static final COSName BPC = new COSName("BPC" );
+    public static final COSName BPC = new COSName("BPC");
     /**
-    * A common COSName value.
-    */
-    public static final COSName CATALOG = new COSName( "Catalog" );
+     * A common COSName value.
+     */
+    public static final COSName CATALOG = new COSName("Catalog");
     /**
      * A common COSName value.
      */
@@ -219,216 +216,216 @@ public final class COSName extends COSBase implements Comparable<COSName>
     /**
      * A common COSName value.
      */
-    public static final COSName C0 = new COSName( "C0" );
+    public static final COSName C0 = new COSName("C0");
     /**
      * A common COSName value.
      */
-    public static final COSName C1 = new COSName( "C1" );
+    public static final COSName C1 = new COSName("C1");
     /**
      * A common COSName value.
      */
-    public static final COSName CA = new COSName( "CA" );
+    public static final COSName CA = new COSName("CA");
     /**
      * A common COSName value.
      */
-    public static final COSName CA_NS = new COSName( "ca" );
+    public static final COSName CA_NS = new COSName("ca");
     /**
-    * A common COSName value.
-    */
-    public static final COSName CALGRAY = new COSName( "CalGray" );
+     * A common COSName value.
+     */
+    public static final COSName CALGRAY = new COSName("CalGray");
     /**
-    * A common COSName value.
-    */
-    public static final COSName CALRGB = new COSName( "CalRGB" );
+     * A common COSName value.
+     */
+    public static final COSName CALRGB = new COSName("CalRGB");
     /**
      * A common COSName value.
      */
-    public static final COSName CAP_HEIGHT = new COSName( "CapHeight" );
+    public static final COSName CAP_HEIGHT = new COSName("CapHeight");
     /**
-    * A common COSName value.
-    */
-    public static final COSName CCITTFAX_DECODE = new COSName( "CCITTFaxDecode" );
+     * A common COSName value.
+     */
+    public static final COSName CCITTFAX_DECODE = new COSName("CCITTFaxDecode");
     /**
-    * A common COSName value.
-    */
-    public static final COSName CCITTFAX_DECODE_ABBREVIATION = new COSName( "CCF" );
+     * A common COSName value.
+     */
+    public static final COSName CCITTFAX_DECODE_ABBREVIATION = new COSName("CCF");
     /**
      * A common COSName value.
      */
-    public static final COSName CENTER_WINDOW = new COSName( "CenterWindow" );
+    public static final COSName CENTER_WINDOW = new COSName("CenterWindow");
     /**
      * A common COSName value.
      */
-    public static final COSName CF = new COSName( "CF" );
+    public static final COSName CF = new COSName("CF");
     /**
      * A common COSName value.
      */
-    public static final COSName CFM = new COSName( "CFM" );
+    public static final COSName CFM = new COSName("CFM");
     /**
-    * A common COSName value.
-    */
-    public static final COSName CHAR_PROCS = new COSName( "CharProcs" );
+     * A common COSName value.
+     */
+    public static final COSName CHAR_PROCS = new COSName("CharProcs");
     /**
-    * A common COSName value.
-    */
-    public static final COSName CHAR_SET = new COSName( "CharSet" );
+     * A common COSName value.
+     */
+    public static final COSName CHAR_SET = new COSName("CharSet");
     /**
-    * A common COSName value.
-    */
-    public static final COSName CID_FONT_TYPE0 = new COSName( "CIDFontType0" );
+     * A common COSName value.
+     */
+    public static final COSName CID_FONT_TYPE0 = new COSName("CIDFontType0");
     /**
-    * A common COSName value.
-    */
-    public static final COSName CID_FONT_TYPE2 = new COSName( "CIDFontType2" );
+     * A common COSName value.
+     */
+    public static final COSName CID_FONT_TYPE2 = new COSName("CIDFontType2");
     /**
-    * A common COSName value.
-    */
-    public static final COSName CIDSYSTEMINFO = new COSName( "CIDSystemInfo" );
+     * A common COSName value.
+     */
+    public static final COSName CIDSYSTEMINFO = new COSName("CIDSystemInfo");
     /**
      * A common COSName value.
      */
-    public static final COSName CID_TO_GID_MAP = new COSName( "CIDToGIDMap" );
+    public static final COSName CID_TO_GID_MAP = new COSName("CIDToGIDMap");
     /**
      * A common COSName value.
      */
-    public static final COSName COLORANTS = new COSName( "Colorants" );
+    public static final COSName COLORANTS = new COSName("Colorants");
     /**
      * A common COSName value.
      */
-    public static final COSName COLORS = new COSName( "Colors" );
+    public static final COSName COLORS = new COSName("Colors");
     /**
      * A common COSName value.
      */
-    public static final COSName COLORSPACE = new COSName( "ColorSpace" );
+    public static final COSName COLORSPACE = new COSName("ColorSpace");
     /**
      * A common COSName value.
      */
-    public static final COSName COLUMNS = new COSName( "Columns" );
+    public static final COSName COLUMNS = new COSName("Columns");
     /**
      * A common COSName value.
      */
-    public static final COSName CONTACT_INFO = new COSName( "ContactInfo" );
+    public static final COSName CONTACT_INFO = new COSName("ContactInfo");
     /**
      * A common COSName value.
      */
-    public static final COSName CONTENTS = new COSName( "Contents" );
-     /**
-      * A common COSName value.
-      */
-    public static final COSName COORDS = new COSName( "Coords" );
+    public static final COSName CONTENTS = new COSName("Contents");
     /**
-    * A common COSName value.
-    */
-    public static final COSName COUNT = new COSName( "Count" );
+     * A common COSName value.
+     */
+    public static final COSName COORDS = new COSName("Coords");
     /**
      * A common COSName value.
      */
-    public static final COSName CLR_F = new COSName( "ClrF" );
+    public static final COSName COUNT = new COSName("Count");
     /**
      * A common COSName value.
      */
-    public static final COSName CLR_FF = new COSName( "ClrFf" );
+    public static final COSName CLR_F = new COSName("ClrF");
     /**
      * A common COSName value.
      */
-    public static final COSName CREATION_DATE = new COSName( "CreationDate" );
+    public static final COSName CLR_FF = new COSName("ClrFf");
     /**
      * A common COSName value.
      */
-    public static final COSName CREATOR = new COSName( "Creator" );
+    public static final COSName CREATION_DATE = new COSName("CreationDate");
     /**
      * A common COSName value.
      */
-    public static final COSName CROP_BOX = new COSName(  "CropBox" );
+    public static final COSName CREATOR = new COSName("Creator");
     /**
      * A common COSName value.
      */
-    public static final COSName CRYPT = new COSName( "Crypt" );
+    public static final COSName CROP_BOX = new COSName("CropBox");
     /**
      * A common COSName value.
      */
-    public static final COSName CS = new COSName(  "CS" );
+    public static final COSName CRYPT = new COSName("Crypt");
     /**
      * A common COSName value.
      */
-    public static final COSName DEFAULT = new COSName( "default" );
+    public static final COSName CS = new COSName("CS");
     /**
      * A common COSName value.
      */
-    public static final COSName D = new COSName( "D" );
+    public static final COSName DEFAULT = new COSName("default");
     /**
      * A common COSName value.
      */
-    public static final COSName DA = new COSName( "DA" );
+    public static final COSName D = new COSName("D");
     /**
      * A common COSName value.
      */
-    public static final COSName DATE = new COSName( "Date" );
+    public static final COSName DA = new COSName("DA");
     /**
      * A common COSName value.
      */
-    public static final COSName DCT_DECODE = new COSName( "DCTDecode" );
+    public static final COSName DATE = new COSName("Date");
     /**
      * A common COSName value.
      */
-    public static final COSName DCT_DECODE_ABBREVIATION = new COSName( "DCT" );
+    public static final COSName DCT_DECODE = new COSName("DCTDecode");
+    /**
+     * A common COSName value.
+     */
+    public static final COSName DCT_DECODE_ABBREVIATION = new COSName("DCT");
 
     /**
      * A common COSName value.
      */
-    public static final COSName DECODE = new COSName( "Decode" );
+    public static final COSName DECODE = new COSName("Decode");
     /**
      * A common COSName value.
      */
-    public static final COSName DECODE_PARMS = new COSName( "DecodeParms" );
+    public static final COSName DECODE_PARMS = new COSName("DecodeParms");
 
     /**
      * A common COSName value.
      */
-    public static final COSName DESCENT = new COSName(  "Descent" );
+    public static final COSName DESCENT = new COSName("Descent");
     /**
      * A common COSName value.
      */
-    public static final COSName DESCENDANT_FONTS = new COSName(  "DescendantFonts" );
+    public static final COSName DESCENDANT_FONTS = new COSName("DescendantFonts");
     /**
      * A common COSName value.
      */
-    public static final COSName DEST = new COSName(  "Dest" );
+    public static final COSName DEST = new COSName("Dest");
 
     /**
      * A common COSName value.
      */
-    public static final COSName DESTS = new COSName( "Dests" );
+    public static final COSName DESTS = new COSName("Dests");
 
     /**
      * A common COSName value.
      */
-    public static final COSName DEST_OUTPUT_PROFILE = new COSName( "DestOutputProfile" ); 
-    
+    public static final COSName DEST_OUTPUT_PROFILE = new COSName("DestOutputProfile");
+
     /**
-    * A common COSName value.
-    */
-    public static final COSName DEVICECMYK = new COSName( "DeviceCMYK" );
+     * A common COSName value.
+     */
+    public static final COSName DEVICECMYK = new COSName("DeviceCMYK");
     /**
-    * A common COSName value.
-    */
-    public static final COSName DEVICEGRAY = new COSName( "DeviceGray" );
+     * A common COSName value.
+     */
+    public static final COSName DEVICEGRAY = new COSName("DeviceGray");
     /**
-    * A common COSName value.
-    */
-    public static final COSName DEVICEN = new COSName( "DeviceN" );
+     * A common COSName value.
+     */
+    public static final COSName DEVICEN = new COSName("DeviceN");
     /**
-    * A common COSName value.
-    */
-    public static final COSName DEVICERGB = new COSName( "DeviceRGB" );
+     * A common COSName value.
+     */
+    public static final COSName DEVICERGB = new COSName("DeviceRGB");
     /**
      * A common COSName value.
      */
-    public static final COSName DIFFERENCES = new COSName( "Differences" );
+    public static final COSName DIFFERENCES = new COSName("Differences");
     /**
      * A common COSName value.
      */
-    public static final COSName DIGEST_METHOD = new COSName( "DigestMethod" );
+    public static final COSName DIGEST_METHOD = new COSName("DigestMethod");
     /**
      * Digest Method.
      */
@@ -456,55 +453,55 @@ public final class COSName extends COSBase implements Comparable<COSName>
     /**
      * A common COSName value.
      */
-    public static final COSName DIRECTION = new COSName( "Direction" );
+    public static final COSName DIRECTION = new COSName("Direction");
     /**
      * A common COSName value.
      */
-    public static final COSName DISPLAY_DOC_TITLE = new COSName( "DisplayDocTitle" );
+    public static final COSName DISPLAY_DOC_TITLE = new COSName("DisplayDocTitle");
 
     /**
      * A common COSName value.
      */
-    public static final COSName DL = new COSName( "DL" );
-    
+    public static final COSName DL = new COSName("DL");
+
     /**
      * A common COSName value.
      */
-    public static final COSName DOC_CHECKSUM = new COSName( "DocChecksum" );
+    public static final COSName DOC_CHECKSUM = new COSName("DocChecksum");
     /**
      * A common COSName value.
      */
-    public static final COSName DOC_TIME_STAMP = new COSName( "DocTimeStamp" );
+    public static final COSName DOC_TIME_STAMP = new COSName("DocTimeStamp");
 
     /**
      * A common COSName value.
      */
-    public static final COSName DOMAIN = new COSName( "Domain" );
+    public static final COSName DOMAIN = new COSName("Domain");
     /**
      * A common COSName value.
      */
-    public static final COSName DOS = new COSName( "DOS" );
+    public static final COSName DOS = new COSName("DOS");
     /**
      * A common COSName value.
      */
-    public static final COSName DP = new COSName( "DP" );
+    public static final COSName DP = new COSName("DP");
 
     /**
      * A common COSName value.
      */
-    public static final COSName DR = new COSName( "DR" );
+    public static final COSName DR = new COSName("DR");
     /**
      * A common COSName value.
      */
-    public static final COSName DUPLEX = new COSName( "Duplex" );
+    public static final COSName DUPLEX = new COSName("Duplex");
     /**
      * A common COSName value.
      */
-    public static final COSName DV = new COSName( "DV" );
+    public static final COSName DV = new COSName("DV");
     /**
      * A common COSName value.
      */
-    public static final COSName DW = new COSName( "DW" );
+    public static final COSName DW = new COSName("DW");
 
     /**
      * A common COSName value.
@@ -518,130 +515,130 @@ public final class COSName extends COSBase implements Comparable<COSName>
     /**
      * A common COSName value.
      */
-    public static final COSName EMBEDDED_FILES = new COSName( "EmbeddedFiles" );
+    public static final COSName EMBEDDED_FILES = new COSName("EmbeddedFiles");
 
     /**
      * A common COSName value.
      */
-    public static final COSName EMBEDDED_FDFS = new COSName( "EmbeddedFDFs" );
-    
+    public static final COSName EMBEDDED_FDFS = new COSName("EmbeddedFDFs");
+
     /**
      * A common COSName value.
      */
-    public static final COSName ENCODE = new COSName( "Encode" );
+    public static final COSName ENCODE = new COSName("Encode");
     /**
      * A common COSName value.
      */
-    public static final COSName ENCODING = new COSName( "Encoding" );
+    public static final COSName ENCODING = new COSName("Encoding");
     /**
      * A common COSName value.
      */
-    public static final COSName ENCODING_90MS_RKSJ_H = new COSName( "90ms-RKSJ-H" );
+    public static final COSName ENCODING_90MS_RKSJ_H = new COSName("90ms-RKSJ-H");
     /**
      * A common COSName value.
      */
-    public static final COSName ENCODING_90MS_RKSJ_V = new COSName( "90ms-RKSJ-V" );
+    public static final COSName ENCODING_90MS_RKSJ_V = new COSName("90ms-RKSJ-V");
     /**
      * A common COSName value.
      */
-    public static final COSName ENCODING_ETEN_B5_H = new COSName( "ETen?B5?H" );
+    public static final COSName ENCODING_ETEN_B5_H = new COSName("ETen?B5?H");
     /**
      * A common COSName value.
      */
-    public static final COSName ENCODING_ETEN_B5_V = new COSName( "ETen?B5?V" );
+    public static final COSName ENCODING_ETEN_B5_V = new COSName("ETen?B5?V");
 
     /**
      * A common COSName value.
      */
-    public static final COSName ENCRYPT = new COSName( "Encrypt" );
+    public static final COSName ENCRYPT = new COSName("Encrypt");
 
     /**
      * A common COSName value.
      */
-    public static final COSName ENCRYPT_META_DATA = new COSName( "EncryptMetadata" );
-    
+    public static final COSName ENCRYPT_META_DATA = new COSName("EncryptMetadata");
+
     /**
      * A common COSName value.
      */
-    public static final COSName EXT_G_STATE = new COSName( "ExtGState" );
+    public static final COSName EXT_G_STATE = new COSName("ExtGState");
 
     /**
      * A common COSName value.
      */
-    public static final COSName EXTEND = new COSName( "Extend" );
+    public static final COSName EXTEND = new COSName("Extend");
 
     /**
      * A common COSName value.
      */
-    public static final COSName EXTENDS = new COSName( "Extends" );
+    public static final COSName EXTENDS = new COSName("Extends");
 
     /**
      * A common COSName value.
      */
-    public static final COSName F = new COSName( "F" );
+    public static final COSName F = new COSName("F");
 
     /**
      * A common COSName value.
      */
-    public static final COSName F_DECODE_PARMS = new COSName( "FDecodeParms" );
+    public static final COSName F_DECODE_PARMS = new COSName("FDecodeParms");
 
     /**
      * A common COSName value.
      */
-    public static final COSName F_FILTER = new COSName( "FFilter" );
+    public static final COSName F_FILTER = new COSName("FFilter");
 
     /**
      * A common COSName value.
      */
-    public static final COSName FF = new COSName( "Ff" );
+    public static final COSName FF = new COSName("Ff");
     /**
      * A common COSName value.
      */
-    public static final COSName FIELDS = new COSName( "Fields" );
+    public static final COSName FIELDS = new COSName("Fields");
     /**
-    * A common COSName value.
-    */
-    public static final COSName FILESPEC = new COSName( "Filespec" );
+     * A common COSName value.
+     */
+    public static final COSName FILESPEC = new COSName("Filespec");
     /**
-    * A common COSName value.
-    */
-    public static final COSName FILTER = new COSName( "Filter" );
+     * A common COSName value.
+     */
+    public static final COSName FILTER = new COSName("Filter");
     /**
-    * A common COSName value.
-    */
-    public static final COSName FIRST = new COSName( "First" );
+     * A common COSName value.
+     */
+    public static final COSName FIRST = new COSName("First");
     /**
-    * A common COSName value.
-    */
-    public static final COSName FIRST_CHAR = new COSName( "FirstChar" );
+     * A common COSName value.
+     */
+    public static final COSName FIRST_CHAR = new COSName("FirstChar");
     /**
      * A common COSName value.
      */
-    public static final COSName FIT_WINDOW = new COSName( "FitWindow" );
+    public static final COSName FIT_WINDOW = new COSName("FitWindow");
     /**
-    * A common COSName value.
-    */
-    public static final COSName FL = new COSName( "FL" );
+     * A common COSName value.
+     */
+    public static final COSName FL = new COSName("FL");
     /**
      * A common COSName value.
      */
-    public static final COSName FLAGS = new COSName( "Flags" );
+    public static final COSName FLAGS = new COSName("Flags");
     /**
      * A common COSName value.
      */
-    public static final COSName FLATE_DECODE = new COSName( "FlateDecode" );
+    public static final COSName FLATE_DECODE = new COSName("FlateDecode");
     /**
-    * A common COSName value.
-    */
-    public static final COSName FLATE_DECODE_ABBREVIATION = new COSName( "Fl" );
+     * A common COSName value.
+     */
+    public static final COSName FLATE_DECODE_ABBREVIATION = new COSName("Fl");
     /**
-    * A common COSName value.
-    */
-    public static final COSName FONT = new COSName( "Font" );
+     * A common COSName value.
+     */
+    public static final COSName FONT = new COSName("Font");
     /**
      * A common COSName value.
      */
-    public static final COSName FONT_BBOX = new COSName( "FontBBox" );
+    public static final COSName FONT_BBOX = new COSName("FontBBox");
     /**
      * A common COSName value.
      */
@@ -665,78 +662,78 @@ public final class COSName extends COSBase implements Comparable<COSName>
     /**
      * A common COSName value.
      */
-    public static final COSName FONT_MATRIX = new COSName("FontMatrix" );
+    public static final COSName FONT_MATRIX = new COSName("FontMatrix");
     /**
-    * A common COSName value.
-    */
-    public static final COSName FONT_NAME = new COSName("FontName" );
+     * A common COSName value.
+     */
+    public static final COSName FONT_NAME = new COSName("FontName");
     /**
-    * A common COSName value.
-    */
-    public static final COSName FONT_STRETCH = new COSName("FontStretch" );
+     * A common COSName value.
+     */
+    public static final COSName FONT_STRETCH = new COSName("FontStretch");
     /**
      * A common COSName value.
      */
-    public static final COSName FONT_WEIGHT = new COSName("FontWeight" );
+    public static final COSName FONT_WEIGHT = new COSName("FontWeight");
     /**
-    * A common COSName value.
-    */
-    public static final COSName FORM = new COSName( "Form" );
+     * A common COSName value.
+     */
+    public static final COSName FORM = new COSName("Form");
     /**
      * A common COSName value.
      */
-    public static final COSName FORMTYPE = new COSName( "FormType" );
+    public static final COSName FORMTYPE = new COSName("FormType");
     /**
      * A common COSName value.
      */
-    public static final COSName FRM = new COSName( "FRM" );
+    public static final COSName FRM = new COSName("FRM");
     /**
      * A common COSName value.
      */
-    public static final COSName FT = new COSName( "FT" );
+    public static final COSName FT = new COSName("FT");
     /**
      * A common COSName value.
      */
-    public static final COSName FUNCTION = new COSName( "Function" );
+    public static final COSName FUNCTION = new COSName("Function");
     /**
      * A common COSName value.
      */
-    public static final COSName FUNCTION_TYPE = new COSName( "FunctionType" );
+    public static final COSName FUNCTION_TYPE = new COSName("FunctionType");
     /**
      * A common COSName value.
      */
-    public static final COSName FUNCTIONS = new COSName( "Functions" );
+    public static final COSName FUNCTIONS = new COSName("Functions");
     /**
      * A common COSName value.
      */
-    public static final COSName GAMMA = new COSName( "Gamma" );
+    public static final COSName GAMMA = new COSName("Gamma");
 
     /**
      * A common COSName value.
      */
-    public static final COSName GTS_PDFA1 = new COSName ("GTS_PDFA1");
-    
-    public static final COSName H = new COSName( "H" );
+    public static final COSName GTS_PDFA1 = new COSName("GTS_PDFA1");
+
+    public static final COSName H = new COSName("H");
     /**
-    * A common COSName value.
-    */
-    public static final COSName HEIGHT = new COSName( "Height" );
+     * A common COSName value.
+     */
+    public static final COSName HEIGHT = new COSName("Height");
     /**
      * A common COSName value.
      */
-    public static final COSName HIDE_MENUBAR = new COSName( "HideMenubar" );
+    public static final COSName HIDE_MENUBAR = new COSName("HideMenubar");
     /**
      * A common COSName value.
      */
-    public static final COSName HIDE_TOOLBAR = new COSName( "HideToolbar" );
+    public static final COSName HIDE_TOOLBAR = new COSName("HideToolbar");
     /**
      * A common COSName value.
      */
-    public static final COSName HIDE_WINDOWUI = new COSName( "HideWindowUI" );
+    public static final COSName HIDE_WINDOWUI = new COSName("HideWindowUI");
     /**
-    * A common COSName value.
-    */
-    public static final COSName ICCBASED = new COSName( "ICCBased" );
+     * A common COSName value.
+     */
+    public static final COSName ICCBASED = new COSName("ICCBased");
 
     /**
      * A common COSName value.
@@ -756,55 +753,55 @@ public final class COSName extends COSBase implements Comparable<COSName>
     /**
      * A common COSName value.
      */
-    public static final COSName IDENTITY = new COSName( "Identity" );
+    public static final COSName IDENTITY = new COSName("Identity");
     /**
-    * A common COSName value.
-    */
-    public static final COSName IDENTITY_H = new COSName( "Identity-H" );
+     * A common COSName value.
+     */
+    public static final COSName IDENTITY_H = new COSName("Identity-H");
     /**
-    * A common COSName value.
-    */
-    public static final COSName IMAGE = new COSName( "Image" );
+     * A common COSName value.
+     */
+    public static final COSName IMAGE = new COSName("Image");
     /**
      * A common COSName value.
      */
-    public static final COSName IMAGE_MASK = new COSName( "ImageMask" );
+    public static final COSName IMAGE_MASK = new COSName("ImageMask");
 
     /**
      * A common COSName value.
      */
-    public static final COSName INDEX = new COSName( "Index" );
+    public static final COSName INDEX = new COSName("Index");
 
     /**
-    * A common COSName value.
-    */
-    public static final COSName INDEXED = new COSName( "Indexed" );
+     * A common COSName value.
+     */
+    public static final COSName INDEXED = new COSName("Indexed");
     /**
      * A common COSName value.
      */
-    public static final COSName INFO = new COSName( "Info" );
+    public static final COSName INFO = new COSName("Info");
     /**
      * A common COSName value.
      */
-    public static final COSName ITALIC_ANGLE = new COSName( "ItalicAngle" );
+    public static final COSName ITALIC_ANGLE = new COSName("ItalicAngle");
 
     /**
      * A common COSName value.
      */
-    public static final COSName JAVA_SCRIPT = new COSName( "JavaScript" );
+    public static final COSName JAVA_SCRIPT = new COSName("JavaScript");
 
     /**
      * A common COSName value.
      */
-    public static final COSName JBIG2_DECODE = new COSName( "JBIG2Decode" );
+    public static final COSName JBIG2_DECODE = new COSName("JBIG2Decode");
     /**
      * A common COSName value.
      */
-    public static final COSName JBIG2_GLOBALS = new COSName( "JBIG2Globals" );
+    public static final COSName JBIG2_GLOBALS = new COSName("JBIG2Globals");
     /**
-    * A common COSName value.
-    */
-    public static final COSName JPX_DECODE = new COSName( "JPXDecode" );
+     * A common COSName value.
+     */
+    public static final COSName JPX_DECODE = new COSName("JPXDecode");
 
     /**
      * A common COSName value.
@@ -814,17 +811,17 @@ public final class COSName extends COSBase implements Comparable<COSName>
     /**
      * A common COSName value.
      */
-    public static final COSName KEYWORDS = new COSName( "Keywords" );
+    public static final COSName KEYWORDS = new COSName("Keywords");
 
     /**
      * A common COSName value.
      */
-    public static final COSName KIDS = new COSName( "Kids" );
+    public static final COSName KIDS = new COSName("Kids");
 
     /**
-    * A common COSName value.
-    */
-    public static final COSName LAB = new COSName( "Lab" );
+     * A common COSName value.
+     */
+    public static final COSName LAB = new COSName("Lab");
 
     /**
      * A common COSName value.
@@ -834,69 +831,69 @@ public final class COSName extends COSBase implements Comparable<COSName>
     /**
      * A common COSName value.
      */
-    public static final COSName LAST_CHAR = new COSName( "LastChar" );
+    public static final COSName LAST_CHAR = new COSName("LastChar");
     /**
      * A common COSName value.
      */
-    public static final COSName LAST_MODIFIED = new COSName( "LastModified" );
+    public static final COSName LAST_MODIFIED = new COSName("LastModified");
     /**
      * A common COSName value.
      */
-    public static final COSName LC = new COSName( "LC" );
+    public static final COSName LC = new COSName("LC");
     /**
      * A common COSName value.
      */
-    public static final COSName L = new COSName( "L" );
+    public static final COSName L = new COSName("L");
     /**
      * A common COSName value.
      */
-    public static final COSName LEADING = new COSName( "Leading" );
+    public static final COSName LEADING = new COSName("Leading");
     /**
-    * A common COSName value.
-    */
-    public static final COSName LEGAL_ATTESTATION = new COSName( "LegalAttestation" );
+     * A common COSName value.
+     */
+    public static final COSName LEGAL_ATTESTATION = new COSName("LegalAttestation");
     /**
-    * A common COSName value.
-    */
-    public static final COSName LENGTH = new COSName( "Length" );
+     * A common COSName value.
+     */
+    public static final COSName LENGTH = new COSName("Length");
     /**
      * A common COSName value.
      */
-    public static final COSName LENGTH1 = new COSName( "Length1" );
+    public static final COSName LENGTH1 = new COSName("Length1");
 
-    public static final COSName LENGTH2 = new COSName( "Length2" );
+    public static final COSName LENGTH2 = new COSName("Length2");
     /**
      * A common COSName value.
      */
-    public static final COSName LIMITS = new COSName( "Limits" );
+    public static final COSName LIMITS = new COSName("Limits");
     /**
      * A common COSName value.
      */
-    public static final COSName LJ = new COSName( "LJ" );
+    public static final COSName LJ = new COSName("LJ");
     /**
-    * A common COSName value.
-    */
-    public static final COSName LW = new COSName( "LW" );
+     * A common COSName value.
+     */
+    public static final COSName LW = new COSName("LW");
     /**
      * A common COSName value.
      */
-    public static final COSName LZW_DECODE = new COSName( "LZWDecode" );
+    public static final COSName LZW_DECODE = new COSName("LZWDecode");
     /**
-    * A common COSName value.
-    */
-    public static final COSName LZW_DECODE_ABBREVIATION = new COSName( "LZW" );
+     * A common COSName value.
+     */
+    public static final COSName LZW_DECODE_ABBREVIATION = new COSName("LZW");
     /**
      * A common COSName value.
      */
-    public static final COSName M = new COSName( "M" );
+    public static final COSName M = new COSName("M");
     /**
-    * A common COSName value.
-    */
-    public static final COSName MAC = new COSName( "Mac" );
+     * A common COSName value.
+     */
+    public static final COSName MAC = new COSName("Mac");
     /**
-    * A common COSName value.
-    */
-    public static final COSName MAC_ROMAN_ENCODING = new COSName( "MacRomanEncoding" );
+     * A common COSName value.
+     */
+    public static final COSName MAC_ROMAN_ENCODING = new COSName("MacRomanEncoding");
 
     /**
      * A common COSName value.
@@ -906,15 +903,15 @@ public final class COSName extends COSBase implements Comparable<COSName>
     /**
      * A common COSName value.
      */
-    public static final COSName MASK = new COSName( "Mask" );
+    public static final COSName MASK = new COSName("Mask");
     /**
      * A common COSName value.
      */
-    public static final COSName MATRIX = new COSName( "Matrix" );
+    public static final COSName MATRIX = new COSName("Matrix");
     /**
      * A common COSName value.
      */
-    public static final COSName MAX_WIDTH = new COSName( "MaxWidth" );
+    public static final COSName MAX_WIDTH = new COSName("MaxWidth");
     /**
      * A common COSName value.
      */
@@ -926,61 +923,69 @@ public final class COSName extends COSBase implements Comparable<COSName>
     /**
      * A common COSName value.
      */
-    public static final COSName MEDIA_BOX = new COSName(  "MediaBox" );
+    public static final COSName MEDIA_BOX = new COSName("MediaBox");
     /**
      * A common COSName value.
      */
-    public static final COSName METADATA = new COSName(  "Metadata" );
+    public static final COSName STRUCT_PARENT = new COSName("StructParent");
     /**
      * A common COSName value.
      */
-    public static final COSName MISSING_WIDTH = new COSName( "MissingWidth" );
+    public static final COSName STRUCT_PARENTS = new COSName("StructParents");
     /**
      * A common COSName value.
      */
-    public static final COSName ML = new COSName( "ML" );
+    public static final COSName METADATA = new COSName("Metadata");
     /**
-    * A common COSName value.
-    */
-    public static final COSName MM_TYPE1 = new COSName(  "MMType1" );
+     * A common COSName value.
+     */
+    public static final COSName MISSING_WIDTH = new COSName("MissingWidth");
+    /**
+     * A common COSName value.
+     */
+    public static final COSName ML = new COSName("ML");
     /**
      * A common COSName value.
      */
-    public static final COSName MOD_DATE = new COSName(  "ModDate" );
+    public static final COSName MM_TYPE1 = new COSName("MMType1");
     /**
-    * A common COSName value.
-    */
-    public static final COSName N = new COSName( "N" );
+     * A common COSName value.
+     */
+    public static final COSName MOD_DATE = new COSName("ModDate");
+    /**
+     * A common COSName value.
+     */
+    public static final COSName N = new COSName("N");
     /**
-    * A common COSName value.
-    */
-    public static final COSName NAME = new COSName( "Name" );
+     * A common COSName value.
+     */
+    public static final COSName NAME = new COSName("Name");
 
     /**
      * A common COSName value.
      */
-    public static final COSName NAMES = new COSName( "Names" );
+    public static final COSName NAMES = new COSName("Names");
 
     /**
      * A common COSName value.
      */
-    public static final COSName NEXT = new COSName( "Next" );
+    public static final COSName NEXT = new COSName("Next");
     /**
      * A common COSName value.
      */
-    public static final COSName NM = new COSName( "NM" );
+    public static final COSName NM = new COSName("NM");
     /**
      * A common COSName value.
      */
-    public static final COSName NON_EFONT_NO_WARN = new COSName( "NonEFontNoWarn" );
+    public static final COSName NON_EFONT_NO_WARN = new COSName("NonEFontNoWarn");
     /**
      * A common COSName value.
      */
-    public static final COSName NON_FULL_SCREEN_PAGE_MODE = new COSName( "NonFullScreenPageMode" );
+    public static final COSName NON_FULL_SCREEN_PAGE_MODE = new COSName("NonFullScreenPageMode");
     /**
      * A common COSName value.
      */
-    public static final COSName NUMS = new COSName( "Nums" );
+    public static final COSName NUMS = new COSName("Nums");
 
     /**
      * A common COSName value.
@@ -994,7 +999,7 @@ public final class COSName extends COSBase implements Comparable<COSName>
     /**
      * A common COSName value.
      */
-    public static final COSName OBJ_STM = new COSName( "ObjStm" );
+    public static final COSName OBJ_STM = new COSName("ObjStm");
 
     /** the COSName for the content group tag. */
     public static final COSName OC = new COSName("OC");
@@ -1013,23 +1018,23 @@ public final class COSName extends COSBase implements Comparable<COSName>
     /**
      * A common COSName value.
      */
-    public static final COSName OP = new COSName( "OP" );
+    public static final COSName OP = new COSName("OP");
     /**
      * A common COSName value.
      */
-    public static final COSName OP_NS = new COSName( "op" );
+    public static final COSName OP_NS = new COSName("op");
     /**
      * A common COSName value.
      */
-    public static final COSName OPM = new COSName( "OPM" );
+    public static final COSName OPM = new COSName("OPM");
     /**
      * A common COSName value.
      */
-    public static final COSName OPT = new COSName( "Opt" );
+    public static final COSName OPT = new COSName("Opt");
     /**
      * A common COSName value.
      */
-    public static final COSName OS = new COSName( "OS" );
+    public static final COSName OS = new COSName("OS");
 
     /**
      * A common COSName value.
@@ -1039,22 +1044,22 @@ public final class COSName extends COSBase implements Comparable<COSName>
     /**
      * A common COSName value.
      */
-    public static final COSName OUTPUT_INTENT = new COSName( "OutputIntent" ); 
+    public static final COSName OUTPUT_INTENT = new COSName("OutputIntent");
 
     /**
      * A common COSName value.
      */
-    public static final COSName OUTPUT_INTENTS = new COSName( "OutputIntents" ); 
+    public static final COSName OUTPUT_INTENTS = new COSName("OutputIntents");
 
     /**
      * A common COSName value.
      */
-    public static final COSName OUTPUT_CONDITION = new COSName("OutputCondition"); 
-    
+    public static final COSName OUTPUT_CONDITION = new COSName("OutputCondition");
+
     /**
      * A common COSName value.
      */
-    public static final COSName OUTPUT_CONDITION_IDENTIFIER = new COSName("OutputConditionIdentifier"); 
+    public static final COSName OUTPUT_CONDITION_IDENTIFIER = new COSName("OutputConditionIdentifier");
 
     /**
      * A common COSName value.
@@ -1062,20 +1067,20 @@ public final class COSName extends COSBase implements Comparable<COSName>
     public static final COSName OPEN_ACTION = new COSName("OpenAction");
 
     /** A common COSName value. */
-     public static final COSName ORDER = new COSName( "Order" );
+    public static final COSName ORDER = new COSName("Order");
 
     /**
      * A common COSName value.
      */
-     public static final COSName ORDERING = new COSName( "Ordering" );
+    public static final COSName ORDERING = new COSName("Ordering");
     /**
      * A common COSName value.
      */
-    public static final COSName P = new COSName( "P" );
+    public static final COSName P = new COSName("P");
     /**
      * A common COSName value.
      */
-    public static final COSName PAGE = new COSName( "Page" );
+    public static final COSName PAGE = new COSName("Page");
 
     /**
      * A common COSName value.
@@ -1093,33 +1098,37 @@ public final class COSName extends COSBase implements Comparable<COSName>
     public static final COSName PAGE_MODE = new COSName("PageMode");
 
     /**
-    * A common COSName value.
-    */
-    public static final COSName PAGES = new COSName( "Pages" );
+     * A common COSName value.
+     */
+    public static final COSName PAGES = new COSName("Pages");
     /**
-    * A common COSName value.
-    */
-    public static final COSName PAINT_TYPE = new COSName( "PaintType" );
+     * A common COSName value.
+     */
+    public static final COSName PAINT_TYPE = new COSName("PaintType");
     /**
-    * A common COSName value.
-    */
-    public static final COSName PARENT = new COSName( "Parent" );
+     * A common COSName value.
+     */
+    public static final COSName PARENT = new COSName("Parent");
+    /**
+     * A common COSName value.
+     */
+    public static final COSName PARENT_TREE = new COSName("ParentTree");
     /**
      * A common COSName value.
      */
     public static final COSName PARENT_TREE_NEXT_KEY = new COSName("ParentTreeNextKey");
     /**
-    * A common COSName value.
-    */
-    public static final COSName PATTERN = new COSName( "Pattern" );
+     * A common COSName value.
+     */
+    public static final COSName PATTERN = new COSName("Pattern");
     /**
-    * A common COSName value.
-    */
-    public static final COSName PATTERN_TYPE = new COSName( "PatternType" );
+     * A common COSName value.
+     */
+    public static final COSName PATTERN_TYPE = new COSName("PatternType");
     /**
-    * A common COSName value.
-    */
-    public static final COSName PDF_DOC_ENCODING = new COSName( "PDFDocEncoding" );
+     * A common COSName value.
+     */
+    public static final COSName PDF_DOC_ENCODING = new COSName("PDFDocEncoding");
     /**
      * A common COSName value.
      */
@@ -1127,76 +1136,76 @@ public final class COSName extends COSBase implements Comparable<COSName>
     /**
      * A common COSName value.
      */
-    public static final COSName PRE_RELEASE = new COSName( "PreRelease" );
+    public static final COSName PRE_RELEASE = new COSName("PreRelease");
     /**
      * A common COSName value.
      */
-    public static final COSName PREDICTOR = new COSName( "Predictor" );
+    public static final COSName PREDICTOR = new COSName("Predictor");
     /**
      * A common COSName value.
      */
-    public static final COSName PREV = new COSName( "Prev" );
+    public static final COSName PREV = new COSName("Prev");
 
     /**
      * A common COSName value.
      */
-    public static final COSName PRINT_AREA = new COSName( "PrintArea" );
+    public static final COSName PRINT_AREA = new COSName("PrintArea");
     /**
      * A common COSName value.
      */
-    public static final COSName PRINT_CLIP = new COSName( "PrintClip" );
+    public static final COSName PRINT_CLIP = new COSName("PrintClip");
     /**
      * A common COSName value.
      */
-    public static final COSName PRINT_SCALING = new COSName( "PrintScaling" );
-    
+    public static final COSName PRINT_SCALING = new COSName("PrintScaling");
+
     /** The COSName value for "ProcSet". */
-    public static final COSName PROC_SET = new COSName( "ProcSet" );
+    public static final COSName PROC_SET = new COSName("ProcSet");
 
     /**
      * A common COSName value.
      */
-    public static final COSName PRODUCER = new COSName( "Producer" );
+    public static final COSName PRODUCER = new COSName("Producer");
 
     /**
      * A common COSName value.
      */
-    public static final COSName PROP_BUILD = new COSName( "Prop_Build" );
+    public static final COSName PROP_BUILD = new COSName("Prop_Build");
     /** The COSName value for "Properties". */
-    public static final COSName PROPERTIES = new COSName( "Properties" );
+    public static final COSName PROPERTIES = new COSName("Properties");
 
     /**
      * A common COSName value.
      */
-    public static final COSName PUB_SEC = new COSName( "PubSec" );
+    public static final COSName PUB_SEC = new COSName("PubSec");
     /**
      * A common COSName value.
      */
-    public static final COSName Q = new COSName( "Q" );
+    public static final COSName Q = new COSName("Q");
     /**
      * A common COSName value.
      */
-    public static final COSName R = new COSName( "R" );
+    public static final COSName R = new COSName("R");
     /**
      * A common COSName value.
      */
-    public static final COSName RANGE = new COSName( "Range" );
+    public static final COSName RANGE = new COSName("Range");
     /**
      * A common COSName value.
      */
-    public static final COSName REASONS = new COSName( "Reasons" );
+    public static final COSName REASONS = new COSName("Reasons");
     /**
      * A common COSName value.
      */
-    public static final COSName RECIPIENTS = new COSName( "Recipients" );
+    public static final COSName RECIPIENTS = new COSName("Recipients");
     /**
      * A common COSName value.
      */
-    public static final COSName RECT = new COSName( "Rect" );
+    public static final COSName RECT = new COSName("Rect");
     /**
      * A common COSName value.
      */
-    public static final COSName REGISTRY = new COSName( "Registry" );
+    public static final COSName REGISTRY = new COSName("Registry");
 
     /**
      * A common COSName value.
@@ -1204,41 +1213,41 @@ public final class COSName extends COSBase implements Comparable<COSName>
     public static final COSName REGISTRY_NAME = new COSName("RegistryName");
 
     /**
-    * A common COSName value.
-    */
-    public static final COSName RESOURCES = new COSName( "Resources" );
+     * A common COSName value.
+     */
+    public static final COSName RESOURCES = new COSName("Resources");
     /**
      * A common COSName value.
      */
-    public static final COSName RI = new COSName( "RI" );
+    public static final COSName RI = new COSName("RI");
     /**
      * A common COSName value.
      */
     public static final COSName ROLE_MAP = new COSName("RoleMap");
     /**
-    * A common COSName value.
-    */
-    public static final COSName ROOT = new COSName( "Root" );
+     * A common COSName value.
+     */
+    public static final COSName ROOT = new COSName("Root");
     /**
      * A common COSName value.
      */
-    public static final COSName ROTATE = new COSName(  "Rotate" );
+    public static final COSName ROTATE = new COSName("Rotate");
     /**
      * A common COSName value.
      */
-    public static final COSName ROWS = new COSName(  "Rows" );
+    public static final COSName ROWS = new COSName("Rows");
     /**
-    * A common COSName value.
-    */
-    public static final COSName RUN_LENGTH_DECODE = new COSName( "RunLengthDecode" );
+     * A common COSName value.
+     */
+    public static final COSName RUN_LENGTH_DECODE = new COSName("RunLengthDecode");
     /**
-    * A common COSName value.
-    */
-    public static final COSName RUN_LENGTH_DECODE_ABBREVIATION = new COSName( "RL" );
+     * A common COSName value.
+     */
+    public static final COSName RUN_LENGTH_DECODE_ABBREVIATION = new COSName("RL");
     /**
      * A common COSName value.
      */
-    public static final COSName RV = new COSName( "RV" );
+    public static final COSName RV = new COSName("RV");
     /**
      * A common COSName value.
      */
@@ -1246,73 +1255,73 @@ public final class COSName extends COSBase implements Comparable<COSName>
     /**
      * A common COSName value.
      */
-    public static final COSName SA = new COSName( "SA" );
+    public static final COSName SA = new COSName("SA");
     /**
      * A common COSName value.
      */
-    public static final COSName SE = new COSName( "SE" );
+    public static final COSName SE = new COSName("SE");
     /**
      * A common COSName value.
      */
-    public static final COSName SEPARATION = new COSName( "Separation" );
+    public static final COSName SEPARATION = new COSName("Separation");
     /**
      * A common COSName value.
      */
-    public static final COSName SET_F = new COSName( "SetF" );
+    public static final COSName SET_F = new COSName("SetF");
     /**
      * A common COSName value.
      */
-    public static final COSName SET_FF = new COSName( "SetFf" );
+    public static final COSName SET_FF = new COSName("SetFf");
 
     /**
      * A common COSName value.
      */
-    public static final COSName SHADING = new COSName( "Shading" );
+    public static final COSName SHADING = new COSName("Shading");
     /**
      * A common COSName value.
      */
-    public static final COSName SHADING_TYPE = new COSName( "ShadingType" );
+    public static final COSName SHADING_TYPE = new COSName("ShadingType");
     /**
      * A common COSName value.
      */
-    public static final COSName SM = new COSName( "SM" );
+    public static final COSName SM = new COSName("SM");
     /**
      * A common COSName value.
      */
-    public static final COSName SMASK = new COSName( "SMask" );
+    public static final COSName SMASK = new COSName("SMask");
     /**
      * A common COSName value.
      */
-    public static final COSName SIZE = new COSName( "Size" );
+    public static final COSName SIZE = new COSName("Size");
 
     /**
-    * A common COSName value.
-    */
-    public static final COSName STANDARD_ENCODING = new COSName( "StandardEncoding" );
+     * A common COSName value.
+     */
+    public static final COSName STANDARD_ENCODING = new COSName("StandardEncoding");
     /**
      * A common COSName value.
      */
-    public static final COSName STATUS = new COSName( "Status" );
+    public static final COSName STATUS = new COSName("Status");
     /**
      * A common COSName value.
      */
-    public static final COSName STD_CF = new COSName( "StdCF" );
+    public static final COSName STD_CF = new COSName("StdCF");
     /**
      * A common COSName value.
      */
-    public static final COSName STEM_H = new COSName( "StemH" );
+    public static final COSName STEM_H = new COSName("StemH");
     /**
      * A common COSName value.
      */
-    public static final COSName STEM_V = new COSName( "StemV" );
+    public static final COSName STEM_V = new COSName("StemV");
     /**
      * A common COSName value.
      */
-    public static final COSName STM_F = new COSName( "StmF" );
+    public static final COSName STM_F = new COSName("StmF");
     /**
      * A common COSName value.
      */
-    public static final COSName STR_F = new COSName( "StrF" );
+    public static final COSName STR_F = new COSName("StrF");
 
     /**
      * A common COSName value.
@@ -1322,27 +1331,27 @@ public final class COSName extends COSBase implements Comparable<COSName>
     /**
      * A common COSName value.
      */
-    public static final COSName SUB_FILTER = new COSName( "SubFilter" );
+    public static final COSName SUB_FILTER = new COSName("SubFilter");
     /**
-    * A common COSName value.
-    */
-    public static final COSName SUBJ = new COSName( "Subj" );
+     * A common COSName value.
+     */
+    public static final COSName SUBJ = new COSName("Subj");
     /**
      * A common COSName value.
      */
-    public static final COSName SUBJECT = new COSName( "Subject" );
+    public static final COSName SUBJECT = new COSName("Subject");
     /**
      * A common COSName value.
      */
-    public static final COSName SUPPLEMENT = new COSName( "Supplement" );
+    public static final COSName SUPPLEMENT = new COSName("Supplement");
     /**
      * A common COSName value.
      */
-    public static final COSName SUBTYPE = new COSName( "Subtype" );
+    public static final COSName SUBTYPE = new COSName("Subtype");
     /**
      * A common COSName value.
      */
-    public static final COSName SV = new COSName( "SV" );
+    public static final COSName SV = new COSName("SV");
 
     /**
      * A common COSName value.
@@ -1362,74 +1371,74 @@ public final class COSName extends COSBase implements Comparable<COSName>
     /**
      * A common COSName value.
      */
-    public static final COSName TILING_TYPE = new COSName( "TilingType" );
+    public static final COSName TILING_TYPE = new COSName("TilingType");
     /**
      * A common COSName value.
      */
-    public static final COSName TIME_STAMP = new COSName( "TimeStamp" );
+    public static final COSName TIME_STAMP = new COSName("TimeStamp");
     /**
      * A common COSName value.
      */
-    public static final COSName TITLE = new COSName( "Title" );
+    public static final COSName TITLE = new COSName("Title");
     /**
      * A common COSName value.
      */
-    public static final COSName TK = new COSName( "TK" );
+    public static final COSName TK = new COSName("TK");
     /**
      * A common COSName value.
      */
-    public static final COSName TRAPPED = new COSName("Trapped" );
+    public static final COSName TRAPPED = new COSName("Trapped");
     /**
      * A common COSName value.
      */
-    public static final COSName TRIM_BOX = new COSName("TrimBox" );
+    public static final COSName TRIM_BOX = new COSName("TrimBox");
     /**
      * A common COSName value.
      */
-    public static final COSName TRUE_TYPE = new COSName("TrueType" );
+    public static final COSName TRUE_TYPE = new COSName("TrueType");
     /**
      * A common COSName value.
      */
-    public static final COSName TRUSTED_MODE = new COSName("TrustedMode" );
+    public static final COSName TRUSTED_MODE = new COSName("TrustedMode");
     /**
-    * A common COSName value.
-    */
-    public static final COSName TO_UNICODE = new COSName( "ToUnicode" );
+     * A common COSName value.
+     */
+    public static final COSName TO_UNICODE = new COSName("ToUnicode");
     /**
      * A common COSName value.
      */
-    public static final COSName TU = new COSName("TU" );
+    public static final COSName TU = new COSName("TU");
     /**
-    * A common COSName value.
-    */
-    public static final COSName TYPE = new COSName( "Type" );
+     * A common COSName value.
+     */
+    public static final COSName TYPE = new COSName("Type");
     /**
      * A common COSName value.
      */
-    public static final COSName TYPE0 = new COSName(  "Type0" );
+    public static final COSName TYPE0 = new COSName("Type0");
     /**
-    * A common COSName value.
-    */
-    public static final COSName TYPE1 = new COSName(  "Type1" );
+     * A common COSName value.
+     */
+    public static final COSName TYPE1 = new COSName("Type1");
     /**
-    * A common COSName value.
-    */
-    public static final COSName TYPE3 = new COSName(  "Type3" );
+     * A common COSName value.
+     */
+    public static final COSName TYPE3 = new COSName("Type3");
 
     /**
      * A common COSName value.
      */
-    public static final COSName U = new COSName( "U" );
+    public static final COSName U = new COSName("U");
     /**
      * A common COSName value.
      */
-    public static final COSName UF = new COSName( "UF" );
+    public static final COSName UF = new COSName("UF");
     /** the COSName for the "Unchanged" value. */
     public static final COSName UNCHANGED = new COSName("Unchanged");
     /**
      * A common COSName value.
      */
-    public static final COSName UNIX = new COSName( "Unix" );
+    public static final COSName UNIX = new COSName("Unix");
     /**
      * A common COSName value.
      */
@@ -1440,17 +1449,17 @@ public final class COSName extends COSBase implements Comparable<COSName>
     public static final COSName URL = new COSName("URL");
 
     /**
-    * A common COSName value.
-    */
-    public static final COSName V = new COSName( "V" );
+     * A common COSName value.
+     */
+    public static final COSName V = new COSName("V");
     /**
      * A common COSName value.
      */
-    public static final COSName VERSION = new COSName( "Version" );
+    public static final COSName VERSION = new COSName("Version");
     /**
      * A common COSName value.
      */
-    public static final COSName VERTICES_PER_ROW = new COSName( "VerticesPerRow" );
+    public static final COSName VERTICES_PER_ROW = new COSName("VerticesPerRow");
 
     /**
      * A common COSName value.
@@ -1468,58 +1477,58 @@ public final class COSName extends COSBase implements Comparable<COSName>
     /**
      * A common COSName value.
      */
-    public static final COSName W = new COSName( "W" );
+    public static final COSName W = new COSName("W");
     /**
      * A common COSName value.
      */
-    public static final COSName WIDTH = new COSName( "Width" );
+    public static final COSName WIDTH = new COSName("Width");
     /**
      * A common COSName value.
      */
-    public static final COSName WIDTHS = new COSName( "Widths" );
+    public static final COSName WIDTHS = new COSName("Widths");
     /**
-    * A common COSName value.
-    */
-    public static final COSName WIN_ANSI_ENCODING = new COSName( "WinAnsiEncoding" );
+     * A common COSName value.
+     */
+    public static final COSName WIN_ANSI_ENCODING = new COSName("WinAnsiEncoding");
     /**
      * A common COSName value.
      */
-    public static final COSName WHITE_POINT = new COSName( "WhitePoint" );
+    public static final COSName WHITE_POINT = new COSName("WhitePoint");
 
     /**
      * A common COSName value.
      */
-    public static final COSName XHEIGHT = new COSName( "XHeight" );
+    public static final COSName XHEIGHT = new COSName("XHeight");
 
     /**
      * A common COSName value.
      */
-    public static final COSName XOBJECT = new COSName( "XObject" );
+    public static final COSName XOBJECT = new COSName("XObject");
     /**
      * A common COSName value.
      */
-    public static final COSName XREF = new COSName( "XRef" );
+    public static final COSName XREF = new COSName("XRef");
 
     /**
      * A common COSName value.
      */
-    public static final COSName XREF_STM = new COSName( "XRefStm" );
+    public static final COSName XREF_STM = new COSName("XRefStm");
     /**
      * A common COSName value.
      */
-    public static final COSName X_STEP = new COSName( "XStep" );
+    public static final COSName X_STEP = new COSName("XStep");
     /**
      * A common COSName value.
      */
-    public static final COSName Y_STEP = new COSName( "YStep" );
+    public static final COSName Y_STEP = new COSName("YStep");
     /**
      * The prefix to a PDF name.
      */
-    public static final byte[] NAME_PREFIX = new byte[] { 47  }; // The / character
+    public static final byte[] NAME_PREFIX = new byte[] { 47 }; // The / character
     /**
      * The escape character for a name.
      */
-    public static final byte[] NAME_ESCAPE = new byte[] { 35  };  //The # character
+    public static final byte[] NAME_ESCAPE = new byte[] { 35 }; // The # character
 
     /**
      * A common COSName value.
@@ -1574,32 +1583,31 @@ public final class COSName extends COSBase implements Comparable<COSName>
      */
     public static final COSName SIG_FLAGS = new COSName("SigFlags");
 
-    
     private String name;
     private int hashCode;
 
     /**
      * This will get a COSName object with that name.
-     *
+     * 
      * @param aName The name of the object.
-     *
+     * 
      * @return A COSName with the specified name.
      */
-    public static final COSName getPDFName( String aName )
+    public static final COSName getPDFName(String aName)
     {
         COSName name = null;
-        if( aName != null )
+        if (aName != null)
         {
             // Is it a common COSName ??
-            name = commonNameMap.get( aName );
-            if( name == null )
+            name = commonNameMap.get(aName);
+            if (name == null)
             {
                 // It seems to be a document specific COSName
-                name = nameMap.get( aName );
-                if( name == null )
+                name = nameMap.get(aName);
+                if (name == null)
                 {
-                    //name is added to the synchronized map in the constructor
-                    name = new COSName( aName, false );
+                    // name is added to the synchronized map in the constructor
+                    name = new COSName(aName, false);
                 }
             }
         }
@@ -1607,41 +1615,39 @@ public final class COSName extends COSBase implements Comparable<COSName>
     }
 
     /**
-     * Private constructor.  This will limit the number of COSName objects.
-     * that are created.
-     *
+     * Private constructor. This will limit the number of COSName objects. that are created.
+     * 
      * @param aName The name of the COSName object.
-     * @param staticValue Indicates if the COSName object is static so that it can
-     *        be stored in the HashMap without synchronizing.
+     * @param staticValue Indicates if the COSName object is static so that it can be stored in the HashMap without
+     * synchronizing.
      */
-    private COSName( String aName, boolean staticValue )
+    private COSName(String aName, boolean staticValue)
     {
         name = aName;
-        if ( staticValue )
+        if (staticValue)
         {
-            commonNameMap.put( aName, this);
+            commonNameMap.put(aName, this);
         }
         else
         {
-            nameMap.put( aName, this );
+            nameMap.put(aName, this);
         }
         hashCode = name.hashCode();
     }
 
     /**
-     * Private constructor.  This will limit the number of COSName objects.
-     * that are created.
-     *
+     * Private constructor. This will limit the number of COSName objects. that are created.
+     * 
      * @param aName The name of the COSName object.
      */
-    private COSName( String aName )
+    private COSName(String aName)
     {
-        this( aName, true );
+        this(aName, true);
     }
 
     /**
      * This will get the name of this COSName object.
-     *
+     * 
      * @return The name of the object.
      */
     public String getName()
@@ -1660,13 +1666,13 @@ public final class COSName extends COSBase implements Comparable<COSName>
     /**
      * {@inheritDoc}
      */
-    public boolean equals( Object o )
+    public boolean equals(Object o)
     {
         boolean retval = this == o;
-        if( !retval && o instanceof COSName )
+        if (!retval && o instanceof COSName)
         {
-            COSName other = (COSName)o;
-            retval = name == other.name || name.equals( other.name );
+            COSName other = (COSName) o;
+            retval = name == other.name || name.equals(other.name);
         }
         return retval;
     }
@@ -1684,47 +1690,38 @@ public final class COSName extends COSBase implements Comparable<COSName>
      */
     public int compareTo(COSName other)
     {
-        return this.name.compareTo( other.name );
+        return this.name.compareTo(other.name);
     }
 
-
-
     /**
      * visitor pattern double dispatch method.
-     *
+     * 
      * @param visitor The object to notify when visiting this object.
      * @return any object, depending on the visitor implementation, or null
      * @throws COSVisitorException If an error occurs while visiting this object.
      */
-    public Object accept(ICOSVisitor  visitor) throws COSVisitorException
+    public Object accept(ICOSVisitor visitor) throws COSVisitorException
     {
         return visitor.visitFromName(this);
     }
 
     /**
      * This will output this string as a PDF object.
-     *
+     * 
      * @param output The stream to write to.
      * @throws IOException If there is an error writing to the stream.
      */
-    public void writePDF( OutputStream output ) throws IOException
+    public void writePDF(OutputStream output) throws IOException
     {
         output.write(NAME_PREFIX);
         byte[] bytes = getName().getBytes("ISO-8859-1");
-        for (int i = 0; i < bytes.length;i++)
+        for (int i = 0; i < bytes.length; i++)
         {
-            int current = ((bytes[i]+256)%256);
-
-            if(current <= 32 || current >= 127 ||
-               current == '(' ||
-               current == ')' ||
-               current == '[' ||
-               current == ']' ||
-               current == '/' ||
-               current == '%' ||
-               current == '<' ||
-               current == '>' ||
-               current == NAME_ESCAPE[0] )
+            int current = ((bytes[i] + 256) % 256);
+
+            if (current <= 32 || current >= 127 || current == '(' || current == ')' || current == '[' || current == ']'
+                    || current == '/' || current == '%' || current == '<' || current == '>'
+                    || current == NAME_ESCAPE[0])
             {
                 output.write(NAME_ESCAPE);
                 output.write(COSHEXTable.TABLE[current]);
@@ -1736,15 +1733,13 @@ public final class COSName extends COSBase implements Comparable<COSName>
         }
     }
 
-     /**
-      * Not usually needed except if resources need to be reclaimed in a ong
-      * running process.
-      * Patch provided by flester@GMail.com
-      * incorporated 5/23/08, Danielwilson@users.SourceForge.net
-      */
-     public static synchronized void clearResources()
-     {
-         // Clear them all
-         nameMap.clear();
-     }
+    /**
+     * Not usually needed except if resources need to be reclaimed in a long running process. Patch provided by
+     * flester@GMail.com incorporated 5/23/08, Danielwilson@users.SourceForge.net
+     */
+    public static synchronized void clearResources()
+    {
+        // Clear them all
+        nameMap.clear();
+    }
 }
diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDPage.java b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDPage.java
index 1c68356257..0e44bba4a3 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDPage.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDPage.java
@@ -255,6 +255,26 @@ public class PDPage implements COSObjectable
         }
     }
 
+    /**
+     * This will get the key of this Page in the structural parent tree.
+     * 
+     * @return the integer key of the page's entry in the structural parent tree
+     */
+    public int getStructParents()
+    {
+        return page.getInt(COSName.STRUCT_PARENTS, 0);
+    }
+
+    /**
+     * This will set the key for this page in the structural parent tree.
+     * 
+     * @param structParents The new key for this page.
+     */
+    public void setStructParents(int structParents)
+    {
+        page.setInt(COSName.STRUCT_PARENTS, structParents);
+    }
+
     /**
      * A rectangle, expressed in default user space units, defining the boundaries of the physical medium on which the
      * page is intended to be displayed or printed
diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/documentinterchange/logicalstructure/PDStructureTreeRoot.java b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/documentinterchange/logicalstructure/PDStructureTreeRoot.java
index 762e04e019..0545b9afaa 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/documentinterchange/logicalstructure/PDStructureTreeRoot.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/documentinterchange/logicalstructure/PDStructureTreeRoot.java
@@ -20,28 +20,29 @@ import java.io.IOException;
 import java.util.Hashtable;
 import java.util.Map;
 
+import org.apache.pdfbox.cos.COSArray;
 import org.apache.pdfbox.cos.COSBase;
 import org.apache.pdfbox.cos.COSDictionary;
 import org.apache.pdfbox.cos.COSName;
 import org.apache.pdfbox.pdmodel.common.COSDictionaryMap;
 import org.apache.pdfbox.pdmodel.common.PDNameTreeNode;
+import org.apache.pdfbox.pdmodel.common.PDNumberTreeNode;
 
 /**
  * A root of a structure tree.
- *
- * @author <a href="mailto:ben@benlitchfield.com">Ben Litchfield</a>,
- *  <a href="mailto:Johannes%20Koch%20%3Ckoch@apache.org%3E">Johannes Koch</a>
- * @version $Revision: 1.2 $
+ * 
+ * @author <a href="mailto:ben@benlitchfield.com">Ben Litchfield</a>, <a
+ * href="mailto:Johannes%20Koch%20%3Ckoch@apache.org%3E">Johannes Koch</a>
+ * 
  */
 public class PDStructureTreeRoot extends PDStructureNode
 {
 
-    public static final String TYPE = "StructTreeRoot";
-
+    private static final String TYPE = "StructTreeRoot";
 
     /**
      * Default Constructor.
-     *
+     * 
      */
     public PDStructureTreeRoot()
     {
@@ -50,14 +51,60 @@ public class PDStructureTreeRoot extends PDStructureNode
 
     /**
      * Constructor for an existing structure element.
-     *
+     * 
      * @param dic The existing dictionary.
      */
-    public PDStructureTreeRoot( COSDictionary dic )
+    public PDStructureTreeRoot(COSDictionary dic)
     {
         super(dic);
     }
 
+    /**
+     * Returns the K array entry.
+     * 
+     * @return the K array entry
+     */
+    public COSArray getKArray()
+    {
+        COSBase k = this.getCOSDictionary().getDictionaryObject(COSName.K);
+        if (k != null)
+        {
+            if (k instanceof COSDictionary)
+            {
+                COSDictionary kdict = (COSDictionary) k;
+                k = kdict.getDictionaryObject(COSName.K);
+                if (k instanceof COSArray)
+                {
+                    return (COSArray) k;
+                }
+            }
+            else
+            {
+                return (COSArray) k;
+            }
+        }
+        return null;
+    }
+
+    /**
+     * Returns the K entry.
+     * 
+     * @return the K entry
+     */
+    public COSBase getK()
+    {
+        return this.getCOSDictionary().getDictionaryObject(COSName.K);
+    }
+
+    /**
+     * Sets the K entry.
+     * 
+     * @param k the K value
+     */
+    public void setK(COSBase k)
+    {
+        this.getCOSDictionary().setItem(COSName.K, k);
+    }
 
     /**
      * Returns the ID tree.
@@ -66,8 +113,7 @@ public class PDStructureTreeRoot extends PDStructureNode
      */
     public PDNameTreeNode getIDTree()
     {
-        COSDictionary idTreeDic = (COSDictionary) this.getCOSDictionary()
-            .getDictionaryObject(COSName.ID_TREE);
+        COSDictionary idTreeDic = (COSDictionary) this.getCOSDictionary().getDictionaryObject(COSName.ID_TREE);
         if (idTreeDic != null)
         {
             return new PDNameTreeNode(idTreeDic, PDStructureElement.class);
@@ -85,6 +131,31 @@ public class PDStructureTreeRoot extends PDStructureNode
         this.getCOSDictionary().setItem(COSName.ID_TREE, idTree);
     }
 
+    /**
+     * Returns the parent tree.
+     * 
+     * @return the parent tree
+     */
+    public PDNumberTreeNode getParentTree()
+    {
+        COSDictionary parentTreeDic = (COSDictionary) this.getCOSDictionary().getDictionaryObject(COSName.PARENT_TREE);
+        if (parentTreeDic != null)
+        {
+            return new PDNumberTreeNode(parentTreeDic, COSBase.class);
+        }
+        return null;
+    }
+
+    /**
+     * Sets the parent tree.
+     * 
+     * @param parentTree the parent tree
+     */
+    public void setParentTree(PDNumberTreeNode parentTree)
+    {
+        this.getCOSDictionary().setItem(COSName.PARENT_TREE, parentTree);
+    }
+
     /**
      * Returns the next key in the parent tree.
      * 
@@ -95,6 +166,16 @@ public class PDStructureTreeRoot extends PDStructureNode
         return this.getCOSDictionary().getInt(COSName.PARENT_TREE_NEXT_KEY);
     }
 
+    /**
+     * Sets the next key in the parent tree.
+     * 
+     * @param parentTreeNextkey the next key in the parent tree.
+     */
+    public void setParentTreeNextKey(int parentTreeNextkey)
+    {
+        this.getCOSDictionary().setInt(COSName.PARENT_TREE_NEXT_KEY, parentTreeNextkey);
+    }
+
     /**
      * Returns the role map.
      * 
diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/xobject/PDXObject.java b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/xobject/PDXObject.java
index 95764120be..524e4d8378 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/xobject/PDXObject.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/xobject/PDXObject.java
@@ -24,7 +24,6 @@ import org.apache.commons.logging.LogFactory;
 import org.apache.pdfbox.cos.COSBase;
 import org.apache.pdfbox.cos.COSName;
 import org.apache.pdfbox.cos.COSStream;
-
 import org.apache.pdfbox.pdmodel.PDDocument;
 import org.apache.pdfbox.pdmodel.common.COSObjectable;
 import org.apache.pdfbox.pdmodel.common.PDMetadata;
@@ -32,15 +31,14 @@ import org.apache.pdfbox.pdmodel.common.PDStream;
 
 /**
  * The base class for all XObjects in the PDF document.
- *
+ * 
  * @author <a href="mailto:ben@benlitchfield.com">Ben Litchfield</a>
  * @author mathiak
  * @author Marcel Kammer
- * @version $Revision: 1.14 $
  */
 public abstract class PDXObject implements COSObjectable
 {
-    
+
     /**
      * Log instance.
      */
@@ -50,40 +48,40 @@ public abstract class PDXObject implements COSObjectable
 
     /**
      * Standard constructor.
-     *
+     * 
      * @param xobj The XObject dictionary.
      */
     public PDXObject(COSStream xobj)
     {
-        xobject = new PDStream( xobj );
-        xobject.getStream().setName( COSName.TYPE, "XObject" );
+        xobject = new PDStream(xobj);
+        getCOSStream().setItem(COSName.TYPE, COSName.XOBJECT);
     }
 
     /**
      * Standard constuctor.
-     *
+     * 
      * @param xobj The XObject dictionary.
      */
     public PDXObject(PDStream xobj)
     {
         xobject = xobj;
-        xobject.getStream().setName( COSName.TYPE, "XObject" );
+        getCOSStream().setItem(COSName.TYPE, COSName.XOBJECT);
     }
 
     /**
      * Standard constuctor.
-     *
+     * 
      * @param doc The doc to store the object contents.
      */
     public PDXObject(PDDocument doc)
     {
         xobject = new PDStream(doc);
-        xobject.getStream().setName( COSName.TYPE, "XObject" );
+        getCOSStream().setItem(COSName.TYPE, COSName.XOBJECT);
     }
 
     /**
      * Returns the stream.
-     *
+     * 
      * {@inheritDoc}
      */
     public COSBase getCOSObject()
@@ -93,6 +91,7 @@ public abstract class PDXObject implements COSObjectable
 
     /**
      * Returns the stream.
+     * 
      * @return The stream for this object.
      */
     public COSStream getCOSStream()
@@ -102,6 +101,7 @@ public abstract class PDXObject implements COSObjectable
 
     /**
      * Returns the stream.
+     * 
      * @return The stream for this object.
      */
     public PDStream getPDStream()
@@ -111,103 +111,125 @@ public abstract class PDXObject implements COSObjectable
 
     /**
      * Create the correct xobject from the cos base.
-     *
+     * 
      * @param xobject The cos level xobject to create.
-     *
+     * 
      * @return a pdmodel xobject
      * @throws IOException If there is an error creating the xobject.
      */
-    public static PDXObject createXObject( COSBase xobject ) throws IOException
+    public static PDXObject createXObject(COSBase xobject) throws IOException
     {
-        PDXObject retval = commonXObjectCreation(xobject, false);
-        return retval;
+        return commonXObjectCreation(xobject, false);
     }
 
     /**
      * Create the correct xobject from the cos base.
-     *
+     * 
      * @param xobject The cos level xobject to create.
-     * @param isthumb specify if the xobject represent a Thumbnail Image (in this case, the subtype null must be considered as an Image)
+     * @param isthumb specify if the xobject represent a Thumbnail Image (in this case, the subtype null must be
+     * considered as an Image)
      * @return a pdmodel xobject
      * @throws IOException If there is an error creating the xobject.
      */
     protected static PDXObject commonXObjectCreation(COSBase xobject, boolean isThumb)
     {
         PDXObject retval = null;
-        if( xobject == null )
+        if (xobject == null)
         {
             retval = null;
         }
-        else if( xobject instanceof COSStream )
+        else if (xobject instanceof COSStream)
         {
-            COSStream xstream = (COSStream)xobject;
-            String subtype = xstream.getNameAsString( COSName.SUBTYPE );
+            COSStream xstream = (COSStream) xobject;
+            String subtype = xstream.getNameAsString(COSName.SUBTYPE);
             // according to the PDF Reference : a thumbnail subtype must be Image if it is not null
-            if( PDXObjectImage.SUB_TYPE.equals( subtype ) || (subtype == null && isThumb))
+            if (PDXObjectImage.SUB_TYPE.equals(subtype) || (subtype == null && isThumb))
             {
-                PDStream image = new PDStream( xstream );
+                PDStream image = new PDStream(xstream);
                 // See if filters are DCT or JPX otherwise treat as Bitmap-like
                 // There might be a problem with several filters, but that's ToDo until
                 // I find an example
                 List<COSName> filters = image.getFilters();
-                if( filters != null && filters.contains( COSName.DCT_DECODE ) )
+                if (filters != null && filters.contains(COSName.DCT_DECODE))
                 {
                     return new PDJpeg(image);
                 }
-                else if ( filters != null && filters.contains( COSName.CCITTFAX_DECODE ) )
+                else if (filters != null && filters.contains(COSName.CCITTFAX_DECODE))
                 {
                     return new PDCcitt(image);
                 }
-                else if( filters != null && filters.contains(COSName.JPX_DECODE))
+                else if (filters != null && filters.contains(COSName.JPX_DECODE))
                 {
-                    //throw new IOException( "JPXDecode has not been implemented for images" );
-                    //JPX Decode is not really supported right now, but if we are just doing
-                    //text extraction then we don't want to throw an exception, so for now
-                    //just return a PDPixelMap, which will break later on if it is
-                    //actually used, but for text extraction it is not used.
-                    return new PDPixelMap( image );
+                    // throw new IOException( "JPXDecode has not been implemented for images" );
+                    // JPX Decode is not really supported right now, but if we are just doing
+                    // text extraction then we don't want to throw an exception, so for now
+                    // just return a PDPixelMap, which will break later on if it is
+                    // actually used, but for text extraction it is not used.
+                    return new PDPixelMap(image);
                 }
                 else
                 {
                     retval = new PDPixelMap(image);
                 }
             }
-            else if( PDXObjectForm.SUB_TYPE.equals( subtype ) )
+            else if (PDXObjectForm.SUB_TYPE.equals(subtype))
             {
-                retval = new PDXObjectForm( xstream );
+                retval = new PDXObjectForm(xstream);
             }
             else
             {
-                LOG.warn( "Skipping unknown XObject subtype '" + subtype + "'" );
+                LOG.warn("Skipping unknown XObject subtype '" + subtype + "'");
             }
         }
         return retval;
     }
 
     /**
-     * Get the metadata that is part of the document catalog.  This will
-     * return null if there is no meta data for this object.
-     *
+     * Get the metadata that is part of the document catalog. This will return null if there is no meta data for this
+     * object.
+     * 
      * @return The metadata for this object.
      */
     public PDMetadata getMetadata()
     {
         PDMetadata retval = null;
-        COSStream mdStream = (COSStream)xobject.getStream().getDictionaryObject( COSName.METADATA );
-        if( mdStream != null )
+        COSStream mdStream = (COSStream) getCOSStream().getDictionaryObject(COSName.METADATA);
+        if (mdStream != null)
         {
-            retval = new PDMetadata( mdStream );
+            retval = new PDMetadata(mdStream);
         }
         return retval;
     }
 
     /**
-     * Set the metadata for this object.  This can be null.
-     *
+     * Set the metadata for this object. This can be null.
+     * 
      * @param meta The meta data for this object.
      */
-    public void setMetadata( PDMetadata meta )
+    public void setMetadata(PDMetadata meta)
     {
-        xobject.getStream().setItem( COSName.METADATA, meta );
+        getCOSStream().setItem(COSName.METADATA, meta);
     }
+
+    /**
+     * This will get the key of this XObject in the structural parent tree. Required if the form XObject is a structural
+     * content item.
+     * 
+     * @return the integer key of the XObject's entry in the structural parent tree
+     */
+    public int getStructParent()
+    {
+        return getCOSStream().getInt(COSName.STRUCT_PARENT, 0);
+    }
+
+    /**
+     * This will set the key for this XObject in the structural parent tree.
+     * 
+     * @param structParent The new key for this XObject.
+     */
+    public void setStructParent(int structParent)
+    {
+        getCOSStream().setInt(COSName.STRUCT_PARENT, structParent);
+    }
+
 }
diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/xobject/PDXObjectForm.java b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/xobject/PDXObjectForm.java
index 5886fb0656..cec0b7eb40 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/xobject/PDXObjectForm.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/xobject/PDXObjectForm.java
@@ -31,7 +31,7 @@ import org.apache.pdfbox.util.Matrix;
 
 /**
  * A form xobject.
- *
+ * 
  * @author <a href="mailto:ben@benlitchfield.com">Ben Litchfield</a>
  * @version $Revision: 1.6 $
  */
@@ -44,120 +44,118 @@ public class PDXObjectForm extends PDXObject
 
     /**
      * Standard constuctor.
-     *
+     * 
      * @param formStream The XObject is passed as a COSStream.
      */
     public PDXObjectForm(PDStream formStream)
     {
-        super( formStream );
-        getCOSStream().setName( COSName.SUBTYPE, SUB_TYPE );
+        super(formStream);
+        getCOSStream().setName(COSName.SUBTYPE, SUB_TYPE);
     }
 
     /**
      * Standard constuctor.
-     *
+     * 
      * @param formStream The XObject is passed as a COSStream.
      */
     public PDXObjectForm(COSStream formStream)
     {
-        super( formStream );
-        getCOSStream().setName( COSName.SUBTYPE, SUB_TYPE );
+        super(formStream);
+        getCOSStream().setName(COSName.SUBTYPE, SUB_TYPE);
     }
 
     /**
      * This will get the form type, currently 1 is the only form type.
-     *
+     * 
      * @return The form type.
      */
     public int getFormType()
     {
-        return getCOSStream().getInt( "FormType",1 );
+        return getCOSStream().getInt("FormType", 1);
     }
 
     /**
      * Set the form type.
-     *
+     * 
      * @param formType The new form type.
      */
-    public void setFormType( int formType )
+    public void setFormType(int formType)
     {
-        getCOSStream().setInt( "FormType", formType );
+        getCOSStream().setInt("FormType", formType);
     }
 
     /**
-     * This will get the resources at this page and not look up the hierarchy.
-     * This attribute is inheritable, and findResources() should probably used.
-     * This will return null if no resources are available at this level.
-     *
+     * This will get the resources at this page and not look up the hierarchy. This attribute is inheritable, and
+     * findResources() should probably used. This will return null if no resources are available at this level.
+     * 
      * @return The resources at this level in the hierarchy.
      */
     public PDResources getResources()
     {
         PDResources retval = null;
-        COSDictionary resources = (COSDictionary)getCOSStream().getDictionaryObject( COSName.RESOURCES );
-        if( resources != null )
+        COSDictionary resources = (COSDictionary) getCOSStream().getDictionaryObject(COSName.RESOURCES);
+        if (resources != null)
         {
-            retval = new PDResources( resources );
+            retval = new PDResources(resources);
         }
         return retval;
     }
 
     /**
      * This will set the resources for this page.
-     *
+     * 
      * @param resources The new resources for this page.
      */
-    public void setResources( PDResources resources )
+    public void setResources(PDResources resources)
     {
-        getCOSStream().setItem( COSName.RESOURCES, resources );
+        getCOSStream().setItem(COSName.RESOURCES, resources);
     }
 
     /**
-     * An array of four numbers in the form coordinate system (see
-     * below), giving the coordinates of the left, bottom, right, and top edges,
-     * respectively, of the form XObject's bounding box. These boundaries are used
-     * to clip the form XObject and to determine its size for caching.
-     *
+     * An array of four numbers in the form coordinate system (see below), giving the coordinates of the left, bottom,
+     * right, and top edges, respectively, of the form XObject's bounding box. These boundaries are used to clip the
+     * form XObject and to determine its size for caching.
+     * 
      * @return The BBox of the form.
      */
     public PDRectangle getBBox()
     {
         PDRectangle retval = null;
-        COSArray array = (COSArray)getCOSStream().getDictionaryObject( COSName.BBOX );
-        if( array != null )
+        COSArray array = (COSArray) getCOSStream().getDictionaryObject(COSName.BBOX);
+        if (array != null)
         {
-            retval = new PDRectangle( array );
+            retval = new PDRectangle(array);
         }
         return retval;
     }
 
     /**
      * This will set the BBox (bounding box) for this form.
-     *
+     * 
      * @param bbox The new BBox for this form.
      */
     public void setBBox(PDRectangle bbox)
     {
-        if( bbox == null )
+        if (bbox == null)
         {
-            getCOSStream().removeItem( COSName.BBOX );
+            getCOSStream().removeItem(COSName.BBOX);
         }
         else
         {
-            getCOSStream().setItem( COSName.BBOX, bbox.getCOSArray() );
+            getCOSStream().setItem(COSName.BBOX, bbox.getCOSArray());
         }
     }
 
     /**
-     * This will get the optional Matrix of an XObjectForm.
-     * It maps the form space into the user space
+     * This will get the optional Matrix of an XObjectForm. It maps the form space into the user space
+     * 
      * @return the form matrix
      */
     public Matrix getMatrix()
     {
         Matrix retval = null;
-        COSArray array = (COSArray)getCOSStream().getDictionaryObject( COSName.MATRIX );
-        if( array != null )
+        COSArray array = (COSArray) getCOSStream().getDictionaryObject(COSName.MATRIX);
+        if (array != null)
         {
             retval = new Matrix();
             retval.setValue(0, 0, ((COSNumber) array.get(0)).floatValue());
@@ -172,6 +170,7 @@ public class PDXObjectForm extends PDXObject
 
     /**
      * Sets the optional Matrix entry for the form XObject.
+     * 
      * @param transform the transformation matrix
      */
     public void setMatrix(AffineTransform transform)
@@ -181,9 +180,30 @@ public class PDXObjectForm extends PDXObject
         transform.getMatrix(values);
         for (double v : values)
         {
-            matrix.add(new COSFloat((float)v));
+            matrix.add(new COSFloat((float) v));
         }
         getCOSStream().setItem(COSName.MATRIX, matrix);
     }
 
+    /**
+     * This will get the key of this XObjectForm in the structural parent tree. Required if the form XObject contains
+     * marked-content sequences that are structural content items.
+     * 
+     * @return the integer key of the XObjectForm's entry in the structural parent tree
+     */
+    public int getStructParents()
+    {
+        return getCOSStream().getInt(COSName.STRUCT_PARENTS, 0);
+    }
+
+    /**
+     * This will set the key for this XObjectForm in the structural parent tree.
+     * 
+     * @param structParent The new key for this XObjectForm.
+     */
+    public void setStructParents(int structParent)
+    {
+        getCOSStream().setInt(COSName.STRUCT_PARENTS, structParent);
+    }
+
 }
diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/interactive/annotation/PDAnnotation.java b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/interactive/annotation/PDAnnotation.java
index ca3b5c0824..9f5e51c668 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/interactive/annotation/PDAnnotation.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/interactive/annotation/PDAnnotation.java
@@ -21,28 +21,27 @@ import java.io.IOException;
 import org.apache.commons.logging.Log;
 import org.apache.commons.logging.LogFactory;
 import org.apache.pdfbox.cos.COSArray;
+import org.apache.pdfbox.cos.COSBase;
 import org.apache.pdfbox.cos.COSDictionary;
 import org.apache.pdfbox.cos.COSName;
-
 import org.apache.pdfbox.pdmodel.PDPage;
 import org.apache.pdfbox.pdmodel.common.COSObjectable;
 import org.apache.pdfbox.pdmodel.common.PDRectangle;
 import org.apache.pdfbox.pdmodel.graphics.color.PDGamma;
 import org.apache.pdfbox.util.BitFlagHelper;
-import org.apache.pdfbox.cos.COSBase;
 
 /**
  * This class represents a PDF annotation.
- *
+ * 
  * @author <a href="mailto:ben@benlitchfield.com">Ben Litchfield</a>
- * @version $Revision: 1.16 $
+ * 
  */
 public abstract class PDAnnotation implements COSObjectable
 {
     /**
      * Log instance.
      */
-    private static final Log log = LogFactory.getLog(PDAnnotation.class);
+    private static final Log LOG = LogFactory.getLog(PDAnnotation.class);
 
     /**
      * An annotation flag.
@@ -81,88 +80,86 @@ public abstract class PDAnnotation implements COSObjectable
      */
     public static final int FLAG_TOGGLE_NO_VIEW = 1 << 8;
 
-
-
     private COSDictionary dictionary;
 
     /**
      * Create the correct annotation from the base COS object.
-     *
+     * 
      * @param base The COS object that is the annotation.
      * @return The correctly typed annotation object.
      * @throws IOException If there is an error while creating the annotation.
      */
-    // TODO not yet implemented: 
-    // Movie, Screen, PrinterMark, TrapNet, Watermark, 3D, Redact
-    public static PDAnnotation createAnnotation( COSBase base ) throws IOException
+    public static PDAnnotation createAnnotation(COSBase base) throws IOException
     {
         PDAnnotation annot = null;
-        if( base instanceof COSDictionary )
+        if (base instanceof COSDictionary)
         {
-            COSDictionary annotDic = (COSDictionary)base;
-            String subtype = annotDic.getNameAsString( COSName.SUBTYPE );
-            if( PDAnnotationFileAttachment.SUB_TYPE.equals(subtype) )
+            COSDictionary annotDic = (COSDictionary) base;
+            String subtype = annotDic.getNameAsString(COSName.SUBTYPE);
+            if (PDAnnotationFileAttachment.SUB_TYPE.equals(subtype))
             {
-                annot = new PDAnnotationFileAttachment( annotDic );
+                annot = new PDAnnotationFileAttachment(annotDic);
             }
-            else if( PDAnnotationLine.SUB_TYPE.equals(subtype) )
+            else if (PDAnnotationLine.SUB_TYPE.equals(subtype))
             {
-                annot = new PDAnnotationLine( annotDic );
+                annot = new PDAnnotationLine(annotDic);
             }
-            else if( PDAnnotationLink.SUB_TYPE.equals(subtype) )
+            else if (PDAnnotationLink.SUB_TYPE.equals(subtype))
             {
                 annot = new PDAnnotationLink(annotDic);
             }
-            else if( PDAnnotationPopup.SUB_TYPE.equals(subtype) )
+            else if (PDAnnotationPopup.SUB_TYPE.equals(subtype))
             {
                 annot = new PDAnnotationPopup(annotDic);
             }
-            else if( PDAnnotationRubberStamp.SUB_TYPE.equals(subtype) )
+            else if (PDAnnotationRubberStamp.SUB_TYPE.equals(subtype))
             {
                 annot = new PDAnnotationRubberStamp(annotDic);
             }
-            else if( PDAnnotationSquareCircle.SUB_TYPE_SQUARE.equals(subtype) ||
-                    PDAnnotationSquareCircle.SUB_TYPE_CIRCLE.equals(subtype) )
+            else if (PDAnnotationSquareCircle.SUB_TYPE_SQUARE.equals(subtype)
+                    || PDAnnotationSquareCircle.SUB_TYPE_CIRCLE.equals(subtype))
             {
-                annot = new PDAnnotationSquareCircle( annotDic );
+                annot = new PDAnnotationSquareCircle(annotDic);
             }
-            else if( PDAnnotationText.SUB_TYPE.equals(subtype) )
+            else if (PDAnnotationText.SUB_TYPE.equals(subtype))
             {
-                annot = new PDAnnotationText( annotDic);
+                annot = new PDAnnotationText(annotDic);
             }
-            else if( PDAnnotationTextMarkup.SUB_TYPE_HIGHLIGHT.equals(subtype) ||
-                    PDAnnotationTextMarkup.SUB_TYPE_UNDERLINE.equals(subtype) ||
-                    PDAnnotationTextMarkup.SUB_TYPE_SQUIGGLY.equals(subtype) ||
-                    PDAnnotationTextMarkup.SUB_TYPE_STRIKEOUT.equals(subtype) )
+            else if (PDAnnotationTextMarkup.SUB_TYPE_HIGHLIGHT.equals(subtype)
+                    || PDAnnotationTextMarkup.SUB_TYPE_UNDERLINE.equals(subtype)
+                    || PDAnnotationTextMarkup.SUB_TYPE_SQUIGGLY.equals(subtype)
+                    || PDAnnotationTextMarkup.SUB_TYPE_STRIKEOUT.equals(subtype))
             {
-                annot = new PDAnnotationTextMarkup( annotDic );
+                annot = new PDAnnotationTextMarkup(annotDic);
             }
-            else if( PDAnnotationLink.SUB_TYPE.equals(subtype) )
+            else if (PDAnnotationLink.SUB_TYPE.equals(subtype))
             {
-                annot = new PDAnnotationLink( annotDic );
+                annot = new PDAnnotationLink(annotDic);
             }
-            else if( PDAnnotationWidget.SUB_TYPE.equals(subtype) )
+            else if (PDAnnotationWidget.SUB_TYPE.equals(subtype))
             {
-               annot = new PDAnnotationWidget( annotDic );
+                annot = new PDAnnotationWidget(annotDic);
             }
-            else if( PDAnnotationMarkup.SUB_TYPE_FREETEXT.equals(subtype) ||
-                    PDAnnotationMarkup.SUB_TYPE_POLYGON.equals(subtype) ||
-                    PDAnnotationMarkup.SUB_TYPE_POLYLINE.equals(subtype) ||
-                    PDAnnotationMarkup.SUB_TYPE_CARET.equals(subtype) ||
-                    PDAnnotationMarkup.SUB_TYPE_INK.equals(subtype) ||
-                    PDAnnotationMarkup.SUB_TYPE_SOUND.equals(subtype) )
+            else if (PDAnnotationMarkup.SUB_TYPE_FREETEXT.equals(subtype)
+                    || PDAnnotationMarkup.SUB_TYPE_POLYGON.equals(subtype)
+                    || PDAnnotationMarkup.SUB_TYPE_POLYLINE.equals(subtype)
+                    || PDAnnotationMarkup.SUB_TYPE_CARET.equals(subtype)
+                    || PDAnnotationMarkup.SUB_TYPE_INK.equals(subtype)
+                    || PDAnnotationMarkup.SUB_TYPE_SOUND.equals(subtype))
             {
-                annot = new PDAnnotationMarkup( annotDic );
+                annot = new PDAnnotationMarkup(annotDic);
             }
             else
             {
-                annot = new PDAnnotationUnknown( annotDic );
-                log.debug("Unknown or unsupported annotation subtype "+subtype);
+                // TODO not yet implemented:
+                // Movie, Screen, PrinterMark, TrapNet, Watermark, 3D, Redact
+                annot = new PDAnnotationUnknown(annotDic);
+                LOG.debug("Unknown or unsupported annotation subtype " + subtype);
             }
         }
         else
         {
-            throw new IOException( "Error: Unknown annotation type " + base );
+            throw new IOException("Error: Unknown annotation type " + base);
         }
 
         return annot;
@@ -174,21 +171,22 @@ public abstract class PDAnnotation implements COSObjectable
     public PDAnnotation()
     {
         dictionary = new COSDictionary();
-        dictionary.setItem( COSName.TYPE, COSName.ANNOT );
+        dictionary.setItem(COSName.TYPE, COSName.ANNOT);
     }
 
     /**
      * Constructor.
-     *
+     * 
      * @param dict The annotations dictionary.
      */
-    public PDAnnotation( COSDictionary dict )
+    public PDAnnotation(COSDictionary dict)
     {
         dictionary = dict;
     }
 
     /**
      * returns the dictionary.
+     * 
      * @return the dictionary
      */
     public COSDictionary getDictionary()
@@ -197,57 +195,56 @@ public abstract class PDAnnotation implements COSObjectable
     }
 
     /**
-     * The annotation rectangle, defining the location of the annotation
-     * on the page in default user space units.  This is usually required and should
-     * not return null on valid PDF documents.  But where this is a parent form field
-     * with children, such as radio button collections then the rectangle will be null.
-     *
+     * The annotation rectangle, defining the location of the annotation on the page in default user space units. This
+     * is usually required and should not return null on valid PDF documents. But where this is a parent form field with
+     * children, such as radio button collections then the rectangle will be null.
+     * 
      * @return The Rect value of this annotation.
      */
     public PDRectangle getRectangle()
     {
-        COSArray rectArray = (COSArray)dictionary.getDictionaryObject( COSName.RECT );
+        COSArray rectArray = (COSArray) dictionary.getDictionaryObject(COSName.RECT);
         PDRectangle rectangle = null;
-        if( rectArray != null )
+        if (rectArray != null)
         {
-            rectangle = new PDRectangle( rectArray );
+            rectangle = new PDRectangle(rectArray);
         }
         return rectangle;
     }
 
     /**
      * This will set the rectangle for this annotation.
-     *
+     * 
      * @param rectangle The new rectangle values.
      */
-    public void setRectangle( PDRectangle rectangle )
+    public void setRectangle(PDRectangle rectangle)
     {
-        dictionary.setItem( COSName.RECT, rectangle.getCOSArray() );
+        dictionary.setItem(COSName.RECT, rectangle.getCOSArray());
     }
 
-   /**
+    /**
      * This will get the flags for this field.
-     *
+     * 
      * @return flags The set of flags.
      */
     public int getAnnotationFlags()
     {
-        return getDictionary().getInt( COSName.F, 0 );
+        return getDictionary().getInt(COSName.F, 0);
     }
 
     /**
      * This will set the flags for this field.
-     *
+     * 
      * @param flags The new flags.
      */
-    public void setAnnotationFlags( int flags )
+    public void setAnnotationFlags(int flags)
     {
-        getDictionary().setInt( COSName.F, flags );
+        getDictionary().setInt(COSName.F, flags);
     }
 
     /**
      * Interface method for COSObjectable.
-     *
+     * 
      * @return This object as a standard COS object.
      */
     public COSBase getCOSObject()
@@ -257,14 +254,14 @@ public abstract class PDAnnotation implements COSObjectable
 
     /**
      * This will get the name of the current appearance stream if any.
-     *
+     * 
      * @return The name of the appearance stream.
      */
     public String getAppearanceStream()
     {
         String retval = null;
-        COSName name = (COSName)getDictionary().getDictionaryObject( COSName.AS );
-        if( name != null )
+        COSName name = (COSName) getDictionary().getDictionaryObject(COSName.AS);
+        if (name != null)
         {
             retval = name.getName();
         }
@@ -273,236 +270,235 @@ public abstract class PDAnnotation implements COSObjectable
 
     /**
      * This will set the annotations appearance stream name.
-     *
+     * 
      * @param as The name of the appearance stream.
      */
-    public void setAppearanceStream( String as )
+    public void setAppearanceStream(String as)
     {
-        if( as == null )
+        if (as == null)
         {
-            getDictionary().removeItem( COSName.AS );
+            getDictionary().removeItem(COSName.AS);
         }
         else
         {
-            getDictionary().setItem( COSName.AS, COSName.getPDFName( as ) );
+            getDictionary().setItem(COSName.AS, COSName.getPDFName(as));
         }
     }
 
     /**
-     * This will get the appearance dictionary associated with this annotation.
-     * This may return null.
-     *
+     * This will get the appearance dictionary associated with this annotation. This may return null.
+     * 
      * @return This annotations appearance.
      */
     public PDAppearanceDictionary getAppearance()
     {
         PDAppearanceDictionary ap = null;
-        COSDictionary apDic = (COSDictionary)dictionary.getDictionaryObject( COSName.AP );
-        if( apDic != null )
+        COSDictionary apDic = (COSDictionary) dictionary.getDictionaryObject(COSName.AP);
+        if (apDic != null)
         {
-            ap = new PDAppearanceDictionary( apDic );
+            ap = new PDAppearanceDictionary(apDic);
         }
         return ap;
     }
 
     /**
      * This will set the appearance associated with this annotation.
-     *
+     * 
      * @param appearance The appearance dictionary for this annotation.
      */
-    public void setAppearance( PDAppearanceDictionary appearance )
+    public void setAppearance(PDAppearanceDictionary appearance)
     {
         COSDictionary ap = null;
-        if( appearance != null )
+        if (appearance != null)
         {
             ap = appearance.getDictionary();
         }
-        dictionary.setItem( COSName.AP, ap );
+        dictionary.setItem(COSName.AP, ap);
     }
 
     /**
      * Get the invisible flag.
-     *
+     * 
      * @return The invisible flag.
      */
     public boolean isInvisible()
     {
-        return BitFlagHelper.getFlag( getDictionary(), COSName.F, FLAG_INVISIBLE );
+        return BitFlagHelper.getFlag(getDictionary(), COSName.F, FLAG_INVISIBLE);
     }
 
     /**
      * Set the invisible flag.
-     *
+     * 
      * @param invisible The new invisible flag.
      */
-    public void setInvisible( boolean invisible )
+    public void setInvisible(boolean invisible)
     {
-        BitFlagHelper.setFlag( getDictionary(), COSName.F, FLAG_INVISIBLE, invisible );
+        BitFlagHelper.setFlag(getDictionary(), COSName.F, FLAG_INVISIBLE, invisible);
     }
 
     /**
      * Get the hidden flag.
-     *
+     * 
      * @return The hidden flag.
      */
     public boolean isHidden()
     {
-        return BitFlagHelper.getFlag( getDictionary(), COSName.F, FLAG_HIDDEN );
+        return BitFlagHelper.getFlag(getDictionary(), COSName.F, FLAG_HIDDEN);
     }
 
     /**
      * Set the hidden flag.
-     *
+     * 
      * @param hidden The new hidden flag.
      */
-    public void setHidden( boolean hidden )
+    public void setHidden(boolean hidden)
     {
-        BitFlagHelper.setFlag( getDictionary(), COSName.F, FLAG_HIDDEN, hidden );
+        BitFlagHelper.setFlag(getDictionary(), COSName.F, FLAG_HIDDEN, hidden);
     }
 
     /**
      * Get the printed flag.
-     *
+     * 
      * @return The printed flag.
      */
     public boolean isPrinted()
     {
-        return BitFlagHelper.getFlag( getDictionary(), COSName.F, FLAG_PRINTED );
+        return BitFlagHelper.getFlag(getDictionary(), COSName.F, FLAG_PRINTED);
     }
 
     /**
      * Set the printed flag.
-     *
+     * 
      * @param printed The new printed flag.
      */
-    public void setPrinted( boolean printed )
+    public void setPrinted(boolean printed)
     {
-        BitFlagHelper.setFlag( getDictionary(), COSName.F, FLAG_PRINTED, printed );
+        BitFlagHelper.setFlag(getDictionary(), COSName.F, FLAG_PRINTED, printed);
     }
 
     /**
      * Get the noZoom flag.
-     *
+     * 
      * @return The noZoom flag.
      */
     public boolean isNoZoom()
     {
-        return BitFlagHelper.getFlag( getDictionary(), COSName.F, FLAG_NO_ZOOM );
+        return BitFlagHelper.getFlag(getDictionary(), COSName.F, FLAG_NO_ZOOM);
     }
 
     /**
      * Set the noZoom flag.
-     *
+     * 
      * @param noZoom The new noZoom flag.
      */
-    public void setNoZoom( boolean noZoom )
+    public void setNoZoom(boolean noZoom)
     {
-        BitFlagHelper.setFlag( getDictionary(), COSName.F, FLAG_NO_ZOOM, noZoom );
+        BitFlagHelper.setFlag(getDictionary(), COSName.F, FLAG_NO_ZOOM, noZoom);
     }
 
     /**
      * Get the noRotate flag.
-     *
+     * 
      * @return The noRotate flag.
      */
     public boolean isNoRotate()
     {
-        return BitFlagHelper.getFlag( getDictionary(), COSName.F, FLAG_NO_ROTATE );
+        return BitFlagHelper.getFlag(getDictionary(), COSName.F, FLAG_NO_ROTATE);
     }
 
     /**
      * Set the noRotate flag.
-     *
+     * 
      * @param noRotate The new noRotate flag.
      */
-    public void setNoRotate( boolean noRotate )
+    public void setNoRotate(boolean noRotate)
     {
-        BitFlagHelper.setFlag( getDictionary(), COSName.F, FLAG_NO_ROTATE, noRotate );
+        BitFlagHelper.setFlag(getDictionary(), COSName.F, FLAG_NO_ROTATE, noRotate);
     }
 
     /**
      * Get the noView flag.
-     *
+     * 
      * @return The noView flag.
      */
     public boolean isNoView()
     {
-        return BitFlagHelper.getFlag( getDictionary(), COSName.F, FLAG_NO_VIEW );
+        return BitFlagHelper.getFlag(getDictionary(), COSName.F, FLAG_NO_VIEW);
     }
 
     /**
      * Set the noView flag.
-     *
+     * 
      * @param noView The new noView flag.
      */
-    public void setNoView( boolean noView )
+    public void setNoView(boolean noView)
     {
-        BitFlagHelper.setFlag( getDictionary(), COSName.F, FLAG_NO_VIEW, noView );
+        BitFlagHelper.setFlag(getDictionary(), COSName.F, FLAG_NO_VIEW, noView);
     }
 
     /**
      * Get the readOnly flag.
-     *
+     * 
      * @return The readOnly flag.
      */
     public boolean isReadOnly()
     {
-        return BitFlagHelper.getFlag( getDictionary(), COSName.F, FLAG_READ_ONLY );
+        return BitFlagHelper.getFlag(getDictionary(), COSName.F, FLAG_READ_ONLY);
     }
 
     /**
      * Set the readOnly flag.
-     *
+     * 
      * @param readOnly The new readOnly flag.
      */
-    public void setReadOnly( boolean readOnly )
+    public void setReadOnly(boolean readOnly)
     {
-        BitFlagHelper.setFlag( getDictionary(), COSName.F, FLAG_READ_ONLY, readOnly );
+        BitFlagHelper.setFlag(getDictionary(), COSName.F, FLAG_READ_ONLY, readOnly);
     }
 
     /**
      * Get the locked flag.
-     *
+     * 
      * @return The locked flag.
      */
     public boolean isLocked()
     {
-        return BitFlagHelper.getFlag( getDictionary(), COSName.F, FLAG_LOCKED );
+        return BitFlagHelper.getFlag(getDictionary(), COSName.F, FLAG_LOCKED);
     }
 
     /**
      * Set the locked flag.
-     *
+     * 
      * @param locked The new locked flag.
      */
-    public void setLocked( boolean locked )
+    public void setLocked(boolean locked)
     {
-        BitFlagHelper.setFlag( getDictionary(), COSName.F, FLAG_LOCKED, locked );
+        BitFlagHelper.setFlag(getDictionary(), COSName.F, FLAG_LOCKED, locked);
     }
 
     /**
      * Get the toggleNoView flag.
-     *
+     * 
      * @return The toggleNoView flag.
      */
     public boolean isToggleNoView()
     {
-        return BitFlagHelper.getFlag( getDictionary(), COSName.F, FLAG_TOGGLE_NO_VIEW );
+        return BitFlagHelper.getFlag(getDictionary(), COSName.F, FLAG_TOGGLE_NO_VIEW);
     }
 
     /**
      * Set the toggleNoView flag.
-     *
+     * 
      * @param toggleNoView The new toggleNoView flag.
      */
-    public void setToggleNoView( boolean toggleNoView )
+    public void setToggleNoView(boolean toggleNoView)
     {
-        BitFlagHelper.setFlag( getDictionary(), COSName.F, FLAG_TOGGLE_NO_VIEW, toggleNoView );
+        BitFlagHelper.setFlag(getDictionary(), COSName.F, FLAG_TOGGLE_NO_VIEW, toggleNoView);
     }
 
     /**
      * Get the "contents" of the field.
-     *
+     * 
      * @return the value of the contents.
      */
     public String getContents()
@@ -512,93 +508,105 @@ public abstract class PDAnnotation implements COSObjectable
 
     /**
      * Set the "contents" of the field.
-     *
+     * 
      * @param value the value of the contents.
      */
-    public void setContents( String value)
+    public void setContents(String value)
     {
         dictionary.setString(COSName.CONTENTS, value);
     }
 
     /**
      * This will retrieve the date and time the annotation was modified.
-     *
+     * 
      * @return the modified date/time (often in date format, but can be an arbitary string).
      */
     public String getModifiedDate()
     {
-        return getDictionary().getString( COSName.M );
+        return getDictionary().getString(COSName.M);
     }
 
     /**
      * This will set the the date and time the annotation was modified.
-     *
-     * @param m
-     *            the date and time the annotation was created.
+     * 
+     * @param m the date and time the annotation was created.
      */
-    public void setModifiedDate( String m )
+    public void setModifiedDate(String m)
     {
-        getDictionary().setString( COSName.M, m );
+        getDictionary().setString(COSName.M, m);
     }
 
     /**
-     * This will get the name, a string intended to uniquely identify each annotation
-     * within a page. Not to be confused with some annotations Name entry which
-     * impact the default image drawn for them.
-     *
+     * This will get the name, a string intended to uniquely identify each annotation within a page. Not to be confused
+     * with some annotations Name entry which impact the default image drawn for them.
+     * 
      * @return The identifying name for the Annotation.
      */
     public String getAnnotationName()
     {
-        return getDictionary().getString( COSName.NM );
+        return getDictionary().getString(COSName.NM);
     }
 
     /**
-     * This will set the name, a string intended to uniquely identify each annotation
-     * within a page. Not to be confused with some annotations Name entry which
-     * impact the default image drawn for them.
-     *
+     * This will set the name, a string intended to uniquely identify each annotation within a page. Not to be confused
+     * with some annotations Name entry which impact the default image drawn for them.
+     * 
      * @param nm The identifying name for the annotation.
      */
-    public void setAnnotationName( String nm )
+    public void setAnnotationName(String nm)
+    {
+        getDictionary().setString(COSName.NM, nm);
+    }
+
+    /**
+     * This will get the key of this annotation in the structural parent tree.
+     * 
+     * @return the integer key of the annotation's entry in the structural parent tree
+     */
+    public int getStructParent()
+    {
+        return getDictionary().getInt(COSName.STRUCT_PARENT, 0);
+    }
+
+    /**
+     * This will set the key for this annotation in the structural parent tree.
+     * 
+     * @param structParent The new key for this annotation.
+     */
+    public void setStructParent(int structParent)
     {
-        getDictionary().setString( COSName.NM, nm );
+        getDictionary().setInt(COSName.STRUCT_PARENT, structParent);
     }
 
     /**
-     * This will set the colour used in drawing various elements.
-     * As of PDF 1.6 these are : Background of icon when closed
-     *                           Title bar of popup window
-     *                           Border of a link annotation
-     *
+     * This will set the colour used in drawing various elements. As of PDF 1.6 these are : Background of icon when
+     * closed Title bar of popup window Border of a link annotation
+     * 
      * Colour is in DeviceRGB colourspace
-     *
-     * @param c
-     *            colour in the DeviceRGB colourspace
-     *
+     * 
+     * @param c colour in the DeviceRGB colourspace
+     * 
      */
-    public void setColour( PDGamma c )
+    public void setColour(PDGamma c)
     {
-        getDictionary().setItem( COSName.C, c );
+        getDictionary().setItem(COSName.C, c);
     }
 
     /**
-     * This will retrieve the colour used in drawing various elements.
-     * As of PDF 1.6 these are : Background of icon when closed
-     *                           Title bar of popup window
-     *                           Border of a link annotation
-     *
+     * This will retrieve the colour used in drawing various elements. As of PDF 1.6 these are : Background of icon when
+     * closed Title bar of popup window Border of a link annotation
+     * 
      * Colour is in DeviceRGB colourspace
-     *
+     * 
      * @return PDGamma object representing the colour
-     *
+     * 
      */
     public PDGamma getColour()
     {
-        COSArray c = (COSArray) getDictionary().getItem(COSName.C );
+        COSArray c = (COSArray) getDictionary().getItem(COSName.C);
         if (c != null)
         {
-            return new PDGamma( c );
+            return new PDGamma(c);
         }
         else
         {
@@ -606,7 +614,7 @@ public abstract class PDAnnotation implements COSObjectable
         }
     }
 
-    /** 
+    /**
      * This will retrieve the subtype of the annotation.
      * 
      * @return the subtype
@@ -625,7 +633,7 @@ public abstract class PDAnnotation implements COSObjectable
     {
         this.getDictionary().setItem(COSName.P, page);
     }
-    
+
     /**
      * This will retrieve the corresponding page of this annotation.
      * 
diff --git a/pdfbox/src/main/java/org/apache/pdfbox/util/PDFMergerUtility.java b/pdfbox/src/main/java/org/apache/pdfbox/util/PDFMergerUtility.java
index c11fd8179c..d06d165444 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/util/PDFMergerUtility.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/util/PDFMergerUtility.java
@@ -22,15 +22,18 @@ import java.io.IOException;
 import java.io.InputStream;
 import java.io.OutputStream;
 import java.util.ArrayList;
+import java.util.HashMap;
 import java.util.Iterator;
 import java.util.List;
 
 import org.apache.pdfbox.cos.COSArray;
+import org.apache.pdfbox.cos.COSBase;
 import org.apache.pdfbox.cos.COSDictionary;
 import org.apache.pdfbox.cos.COSInteger;
 import org.apache.pdfbox.cos.COSName;
 import org.apache.pdfbox.cos.COSNumber;
 import org.apache.pdfbox.cos.COSStream;
+import org.apache.pdfbox.cos.COSString;
 import org.apache.pdfbox.exceptions.COSVisitorException;
 import org.apache.pdfbox.pdmodel.PDDocument;
 import org.apache.pdfbox.pdmodel.PDDocumentCatalog;
@@ -38,7 +41,11 @@ import org.apache.pdfbox.pdmodel.PDDocumentInformation;
 import org.apache.pdfbox.pdmodel.PDDocumentNameDictionary;
 import org.apache.pdfbox.pdmodel.PDPage;
 import org.apache.pdfbox.pdmodel.common.COSArrayList;
+import org.apache.pdfbox.pdmodel.common.PDNumberTreeNode;
 import org.apache.pdfbox.pdmodel.common.PDStream;
+import org.apache.pdfbox.pdmodel.documentinterchange.logicalstructure.PDMarkInfo;
+import org.apache.pdfbox.pdmodel.documentinterchange.logicalstructure.PDStructureTreeRoot;
+import org.apache.pdfbox.pdmodel.interactive.annotation.PDAnnotation;
 import org.apache.pdfbox.pdmodel.interactive.documentnavigation.outline.PDDocumentOutline;
 import org.apache.pdfbox.pdmodel.interactive.documentnavigation.outline.PDOutlineItem;
 import org.apache.pdfbox.pdmodel.interactive.form.PDAcroForm;
@@ -46,14 +53,14 @@ import org.apache.pdfbox.pdmodel.interactive.form.PDField;
 import org.apache.pdfbox.pdmodel.interactive.form.PDFieldFactory;
 
 /**
- * This class will take a list of pdf documents and merge them, saving the result
- * in a new document.
- *
+ * This class will take a list of pdf documents and merge them, saving the result in a new document.
+ * 
  * @author <a href="mailto:ben@benlitchfield.com">Ben Litchfield</a>
- * @version $Revision: 1.3 $
+ * 
  */
 public class PDFMergerUtility
 {
+    private static final String STRUCTURETYPE_DOCUMENT = "Document";
 
     private List<InputStream> sources;
     private String destinationFileName;
@@ -70,6 +77,7 @@ public class PDFMergerUtility
 
     /**
      * Get the name of the destination file.
+     * 
      * @return Returns the destination.
      */
     public String getDestinationFileName()
@@ -79,8 +87,8 @@ public class PDFMergerUtility
 
     /**
      * Set the name of the destination file.
-     * @param destination
-     *            The destination to set.
+     * 
+     * @param destination The destination to set.
      */
     public void setDestinationFileName(String destination)
     {
@@ -89,6 +97,7 @@ public class PDFMergerUtility
 
     /**
      * Get the destination OutputStream.
+     * 
      * @return Returns the destination OutputStream.
      */
     public OutputStream getDestinationStream()
@@ -98,6 +107,7 @@ public class PDFMergerUtility
 
     /**
      * Set the destination OutputStream.
+     * 
      * @param destStream The destination to set.
      */
     public void setDestinationStream(OutputStream destStream)
@@ -107,7 +117,7 @@ public class PDFMergerUtility
 
     /**
      * Add a source file to the list of files to merge.
-     *
+     * 
      * @param source Full path and file name of source document.
      */
     public void addSource(String source)
@@ -116,7 +126,7 @@ public class PDFMergerUtility
         {
             sources.add(new FileInputStream(new File(source)));
         }
-        catch(Exception e)
+        catch (Exception e)
         {
             throw new RuntimeException(e);
         }
@@ -124,7 +134,7 @@ public class PDFMergerUtility
 
     /**
      * Add a source file to the list of files to merge.
-     *
+     * 
      * @param source File representing source document
      */
     public void addSource(File source)
@@ -133,7 +143,7 @@ public class PDFMergerUtility
         {
             sources.add(new FileInputStream(source));
         }
-        catch(Exception e)
+        catch (Exception e)
         {
             throw new RuntimeException(e);
         }
@@ -141,7 +151,7 @@ public class PDFMergerUtility
 
     /**
      * Add a source to the list of documents to merge.
-     *
+     * 
      * @param source InputStream representing source document
      */
     public void addSource(InputStream source)
@@ -151,17 +161,17 @@ public class PDFMergerUtility
 
     /**
      * Add a list of sources to the list of documents to merge.
-     *
+     * 
      * @param sourcesList List of InputStream objects representing source documents
      */
     public void addSources(List<InputStream> sourcesList)
     {
-        this.sources.addAll(sourcesList);
+        sources.addAll(sourcesList);
     }
 
     /**
      * Merge the list of source documents, saving the result in the destination file.
-     *
+     * 
      * @throws IOException If there is an error saving the document.
      * @throws COSVisitorException If an error occurs while saving the destination file.
      */
@@ -187,7 +197,7 @@ public class PDFMergerUtility
                     tobeclosed.add(source);
                     appendDocument(destination, source);
                 }
-                if(destinationStream == null)
+                if (destinationStream == null)
                 {
                     destination.save(destinationFileName);
                 }
@@ -210,52 +220,51 @@ public class PDFMergerUtility
         }
     }
 
-
     /**
      * append all pages from source to destination.
-     *
+     * 
      * @param destination the document to receive the pages
      * @param source the document originating the new pages
-     *
+     * 
      * @throws IOException If there is an error accessing data from either document.
      */
     public void appendDocument(PDDocument destination, PDDocument source) throws IOException
     {
-        if( destination.isEncrypted() )
+        if (destination.isEncrypted())
         {
-            throw new IOException( "Error: destination PDF is encrypted, can't append encrypted PDF documents." );
+            throw new IOException("Error: destination PDF is encrypted, can't append encrypted PDF documents.");
         }
-        if( source.isEncrypted() )
+        if (source.isEncrypted())
         {
-            throw new IOException( "Error: source PDF is encrypted, can't append encrypted PDF documents." );
+            throw new IOException("Error: source PDF is encrypted, can't append encrypted PDF documents.");
         }
         PDDocumentInformation destInfo = destination.getDocumentInformation();
         PDDocumentInformation srcInfo = source.getDocumentInformation();
-        destInfo.getDictionary().mergeInto( srcInfo.getDictionary() );
+        destInfo.getDictionary().mergeInto(srcInfo.getDictionary());
 
         PDDocumentCatalog destCatalog = destination.getDocumentCatalog();
         PDDocumentCatalog srcCatalog = source.getDocumentCatalog();
 
         // use the highest version number for the resulting pdf
-        float destVersion = destination.getDocument().getVersion(); 
-        float srcVersion = source.getDocument().getVersion(); 
+        float destVersion = destination.getDocument().getVersion();
+        float srcVersion = source.getDocument().getVersion();
 
         if (destVersion < srcVersion)
         {
             destination.getDocument().setVersion(srcVersion);
         }
-            
-        if( destCatalog.getOpenAction() == null )
+
+        if (destCatalog.getOpenAction() == null)
         {
-            destCatalog.setOpenAction( srcCatalog.getOpenAction() );
+            destCatalog.setOpenAction(srcCatalog.getOpenAction());
         }
 
-        // maybe there are some shared resources for all pages 
-        COSDictionary srcPages = (COSDictionary)srcCatalog.getCOSDictionary().getDictionaryObject( COSName.PAGES );
-        COSDictionary srcResources = (COSDictionary)srcPages.getDictionaryObject( COSName.RESOURCES );
-        COSDictionary destPages = (COSDictionary)destCatalog.getCOSDictionary().getDictionaryObject( COSName.PAGES );
-        COSDictionary destResources = (COSDictionary)destPages.getDictionaryObject( COSName.RESOURCES );
-        if (srcResources != null) 
+        // maybe there are some shared resources for all pages
+        COSDictionary srcPages = (COSDictionary) srcCatalog.getCOSDictionary().getDictionaryObject(COSName.PAGES);
+        COSDictionary srcResources = (COSDictionary) srcPages.getDictionaryObject(COSName.RESOURCES);
+        COSDictionary destPages = (COSDictionary) destCatalog.getCOSDictionary().getDictionaryObject(COSName.PAGES);
+        COSDictionary destResources = (COSDictionary) destPages.getDictionaryObject(COSName.RESOURCES);
+        if (srcResources != null)
         {
             if (destResources != null)
             {
@@ -266,56 +275,54 @@ public class PDFMergerUtility
                 destPages.setItem(COSName.RESOURCES, srcResources);
             }
         }
-        
+
         PDFCloneUtility cloner = new PDFCloneUtility(destination);
 
         try
         {
             PDAcroForm destAcroForm = destCatalog.getAcroForm();
             PDAcroForm srcAcroForm = srcCatalog.getAcroForm();
-            if( destAcroForm == null )
+            if (destAcroForm == null)
             {
-                cloner.cloneForNewDocument( srcAcroForm );
-                destCatalog.setAcroForm( srcAcroForm );
+                cloner.cloneForNewDocument(srcAcroForm);
+                destCatalog.setAcroForm(srcAcroForm);
             }
             else
             {
-                if( srcAcroForm != null )
+                if (srcAcroForm != null)
                 {
                     mergeAcroForm(cloner, destAcroForm, srcAcroForm);
                 }
             }
         }
-        catch(Exception e)
+        catch (Exception e)
         {
             // if we are not ignoring exceptions, we'll re-throw this
-            if(!ignoreAcroFormErrors)
+            if (!ignoreAcroFormErrors)
             {
-                throw (IOException)e;
+                throw (IOException) e;
             }
         }
 
-        COSArray destThreads = (COSArray)destCatalog.getCOSDictionary().getDictionaryObject(
-                COSName.THREADS);
-        COSArray srcThreads = (COSArray)cloner.cloneForNewDocument(
-                destCatalog.getCOSDictionary().getDictionaryObject( COSName.THREADS ));
-        if( destThreads == null )
+        COSArray destThreads = (COSArray) destCatalog.getCOSDictionary().getDictionaryObject(COSName.THREADS);
+        COSArray srcThreads = (COSArray) cloner.cloneForNewDocument(destCatalog.getCOSDictionary().getDictionaryObject(
+                COSName.THREADS));
+        if (destThreads == null)
         {
-            destCatalog.getCOSDictionary().setItem( COSName.THREADS, srcThreads );
+            destCatalog.getCOSDictionary().setItem(COSName.THREADS, srcThreads);
         }
         else
         {
-            destThreads.addAll( srcThreads );
+            destThreads.addAll(srcThreads);
         }
 
         PDDocumentNameDictionary destNames = destCatalog.getNames();
         PDDocumentNameDictionary srcNames = srcCatalog.getNames();
-        if( srcNames != null )
+        if (srcNames != null)
         {
-            if( destNames == null )
+            if (destNames == null)
             {
-                destCatalog.getCOSDictionary().setItem( COSName.NAMES,
-                        cloner.cloneForNewDocument( srcNames ) );
+                destCatalog.getCOSDictionary().setItem(COSName.NAMES, cloner.cloneForNewDocument(srcNames));
             }
             else
             {
@@ -326,142 +333,336 @@ public class PDFMergerUtility
 
         PDDocumentOutline destOutline = destCatalog.getDocumentOutline();
         PDDocumentOutline srcOutline = srcCatalog.getDocumentOutline();
-        if( srcOutline != null )
+        if (srcOutline != null)
         {
-            if( destOutline == null )
+            if (destOutline == null)
             {
-                PDDocumentOutline cloned =
-                    new PDDocumentOutline( (COSDictionary)cloner.cloneForNewDocument( srcOutline ) );
-                destCatalog.setDocumentOutline( cloned );
+                PDDocumentOutline cloned = new PDDocumentOutline((COSDictionary) cloner.cloneForNewDocument(srcOutline));
+                destCatalog.setDocumentOutline(cloned);
             }
             else
             {
                 PDOutlineItem first = srcOutline.getFirstChild();
-                if(first != null)
+                if (first != null)
                 {
-                    PDOutlineItem clonedFirst = new PDOutlineItem(
-                            (COSDictionary)cloner.cloneForNewDocument( first ));
-                    destOutline.appendChild( clonedFirst );
+                    PDOutlineItem clonedFirst = new PDOutlineItem((COSDictionary) cloner.cloneForNewDocument(first));
+                    destOutline.appendChild(clonedFirst);
                 }
             }
         }
 
         String destPageMode = destCatalog.getPageMode();
         String srcPageMode = srcCatalog.getPageMode();
-        if( destPageMode == null )
+        if (destPageMode == null)
         {
-            destCatalog.setPageMode( srcPageMode );
+            destCatalog.setPageMode(srcPageMode);
         }
 
-        COSDictionary destLabels = (COSDictionary)destCatalog.getCOSDictionary().getDictionaryObject(
-                COSName.PAGE_LABELS);
-        COSDictionary srcLabels = (COSDictionary)srcCatalog.getCOSDictionary().getDictionaryObject(
+        COSDictionary destLabels = (COSDictionary) destCatalog.getCOSDictionary().getDictionaryObject(
                 COSName.PAGE_LABELS);
-        if( srcLabels != null )
+        COSDictionary srcLabels = (COSDictionary) srcCatalog.getCOSDictionary()
+                .getDictionaryObject(COSName.PAGE_LABELS);
+        if (srcLabels != null)
         {
             int destPageCount = destination.getNumberOfPages();
             COSArray destNums = null;
-            if( destLabels == null )
+            if (destLabels == null)
             {
                 destLabels = new COSDictionary();
                 destNums = new COSArray();
-                destLabels.setItem( COSName.NUMS, destNums );
-                destCatalog.getCOSDictionary().setItem( COSName.PAGE_LABELS, destLabels );
+                destLabels.setItem(COSName.NUMS, destNums);
+                destCatalog.getCOSDictionary().setItem(COSName.PAGE_LABELS, destLabels);
             }
             else
             {
-                destNums = (COSArray)destLabels.getDictionaryObject( COSName.NUMS );
+                destNums = (COSArray) destLabels.getDictionaryObject(COSName.NUMS);
             }
-            COSArray srcNums = (COSArray)srcLabels.getDictionaryObject( COSName.NUMS );
+            COSArray srcNums = (COSArray) srcLabels.getDictionaryObject(COSName.NUMS);
             if (srcNums != null)
             {
-                for( int i=0; i<srcNums.size(); i+=2 )
+                for (int i = 0; i < srcNums.size(); i += 2)
                 {
-                    COSNumber labelIndex = (COSNumber)srcNums.getObject( i );
+                    COSNumber labelIndex = (COSNumber) srcNums.getObject(i);
                     long labelIndexValue = labelIndex.intValue();
-                    destNums.add( COSInteger.get( labelIndexValue + destPageCount ) );
-                    destNums.add( cloner.cloneForNewDocument( srcNums.getObject( i+1 ) ) );
+                    destNums.add(COSInteger.get(labelIndexValue + destPageCount));
+                    destNums.add(cloner.cloneForNewDocument(srcNums.getObject(i + 1)));
                 }
             }
         }
 
-        COSStream destMetadata = (COSStream)destCatalog.getCOSDictionary().getDictionaryObject( COSName.METADATA );
-        COSStream srcMetadata = (COSStream)srcCatalog.getCOSDictionary().getDictionaryObject( COSName.METADATA );
-        if( destMetadata == null && srcMetadata != null )
+        COSStream destMetadata = (COSStream) destCatalog.getCOSDictionary().getDictionaryObject(COSName.METADATA);
+        COSStream srcMetadata = (COSStream) srcCatalog.getCOSDictionary().getDictionaryObject(COSName.METADATA);
+        if (destMetadata == null && srcMetadata != null)
         {
-            PDStream newStream = new PDStream( destination, srcMetadata.getUnfilteredStream(), false );
-            newStream.getStream().mergeInto( srcMetadata );
+            PDStream newStream = new PDStream(destination, srcMetadata.getUnfilteredStream(), false);
+            newStream.getStream().mergeInto(srcMetadata);
             newStream.addCompression();
-            destCatalog.getCOSDictionary().setItem( COSName.METADATA, newStream );
+            destCatalog.getCOSDictionary().setItem(COSName.METADATA, newStream);
         }
 
-        //finally append the pages
+        // merge logical structure hierarchy if logical structure information is available in both source pdf and
+        // destination pdf
+        boolean mergeStructTree = false;
+        int destParentTreeNextKey = -1;
+        COSDictionary destParentTreeDict = null;
+        COSDictionary srcParentTreeDict = null;
+        COSArray destNumbersArray = null;
+        COSArray srcNumbersArray = null;
+        PDMarkInfo destMark = destCatalog.getMarkInfo();
+        PDStructureTreeRoot destStructTree = destCatalog.getStructureTreeRoot();
+        PDMarkInfo srcMark = srcCatalog.getMarkInfo();
+        PDStructureTreeRoot srcStructTree = srcCatalog.getStructureTreeRoot();
+        if (destStructTree != null)
+        {
+            PDNumberTreeNode destParentTree = destStructTree.getParentTree();
+            destParentTreeNextKey = destStructTree.getParentTreeNextKey();
+            if (destParentTree != null)
+            {
+                destParentTreeDict = destParentTree.getCOSDictionary();
+                destNumbersArray = (COSArray) destParentTreeDict.getDictionaryObject(COSName.NUMS);
+                if (destNumbersArray != null)
+                {
+                    if (destParentTreeNextKey < 0)
+                    {
+                        destParentTreeNextKey = destNumbersArray.size() / 2;
+                    }
+                    if (destParentTreeNextKey > 0)
+                    {
+                        if (srcStructTree != null)
+                        {
+                            PDNumberTreeNode srcParentTree = srcStructTree.getParentTree();
+                            if (srcParentTree != null)
+                            {
+                                srcParentTreeDict = srcParentTree.getCOSDictionary();
+                                srcNumbersArray = (COSArray) srcParentTreeDict.getDictionaryObject(COSName.NUMS);
+                                if (srcNumbersArray != null)
+                                {
+                                    mergeStructTree = true;
+                                }
+                            }
+                        }
+                    }
+                }
+            }
+            if (destMark != null && destMark.isMarked() && !mergeStructTree)
+            {
+                destMark.setMarked(false);
+            }
+            if (!mergeStructTree)
+            {
+                destCatalog.setStructureTreeRoot(null);
+            }
+        }
+
+        // finally append the pages
         List<PDPage> pages = srcCatalog.getAllPages();
         Iterator<PDPage> pageIter = pages.iterator();
-        while( pageIter.hasNext() )
+        HashMap<COSDictionary, COSDictionary> objMapping = new HashMap<COSDictionary, COSDictionary>();
+        while (pageIter.hasNext())
         {
             PDPage page = pageIter.next();
-            PDPage newPage =
-                new PDPage( (COSDictionary)cloner.cloneForNewDocument( page.getCOSDictionary() ) );
-            newPage.setCropBox( page.findCropBox() );
-            newPage.setMediaBox( page.findMediaBox() );
-            newPage.setRotation( page.findRotation() );
-            destination.addPage( newPage );
+            PDPage newPage = new PDPage((COSDictionary) cloner.cloneForNewDocument(page.getCOSDictionary()));
+            newPage.setCropBox(page.findCropBox());
+            newPage.setMediaBox(page.findMediaBox());
+            newPage.setRotation(page.findRotation());
+            if (mergeStructTree)
+            {
+                updateStructParentEntries(newPage, destParentTreeNextKey);
+                objMapping.put(page.getCOSDictionary(), newPage.getCOSDictionary());
+                List<PDAnnotation> oldAnnots = page.getAnnotations();
+                List<PDAnnotation> newAnnots = newPage.getAnnotations();
+                for (int i = 0; i < oldAnnots.size(); i++)
+                {
+                    objMapping.put(oldAnnots.get(i).getDictionary(), newAnnots.get(i).getDictionary());
+                }
+                // TODO update mapping for XObjects
+            }
+            destination.addPage(newPage);
+        }
+        if (mergeStructTree)
+        {
+            updatePageReferences(srcNumbersArray, objMapping);
+            for (int i = 0; i < srcNumbersArray.size() / 2; i++)
+            {
+                destNumbersArray.add(COSInteger.get(destParentTreeNextKey + i));
+                destNumbersArray.add(srcNumbersArray.getObject(i * 2 + 1));
+            }
+            destParentTreeNextKey += srcNumbersArray.size() / 2;
+            destParentTreeDict.setItem(COSName.NUMS, destNumbersArray);
+            PDNumberTreeNode newParentTreeNode = new PDNumberTreeNode(destParentTreeDict, COSBase.class);
+            destStructTree.setParentTree(newParentTreeNode);
+            destStructTree.setParentTreeNextKey(destParentTreeNextKey);
+
+            COSDictionary kDictLevel0 = new COSDictionary();
+            COSArray newKArray = new COSArray();
+            COSArray destKArray = destStructTree.getKArray();
+            COSArray srcKArray = srcStructTree.getKArray();
+            if (destKArray != null && srcKArray != null)
+            {
+                updateParentEntry(destKArray, kDictLevel0);
+                newKArray.addAll(destKArray);
+                if (mergeStructTree)
+                {
+                    updateParentEntry(srcKArray, kDictLevel0);
+                }
+                newKArray.addAll(srcKArray);
+            }
+            kDictLevel0.setItem(COSName.K, newKArray);
+            kDictLevel0.setItem(COSName.P, destStructTree);
+            kDictLevel0.setItem(COSName.S, new COSString(STRUCTURETYPE_DOCUMENT));
+            destStructTree.setK(kDictLevel0);
         }
     }
 
-
     private int nextFieldNum = 1;
 
     /**
-     * Merge the contents of the source form into the destination form
-     * for the destination file.
-     *
+     * Merge the contents of the source form into the destination form for the destination file.
+     * 
      * @param cloner the object cloner for the destination document
      * @param destAcroForm the destination form
      * @param srcAcroForm the source form
      * @throws IOException If an error occurs while adding the field.
      */
     private void mergeAcroForm(PDFCloneUtility cloner, PDAcroForm destAcroForm, PDAcroForm srcAcroForm)
-        throws IOException
+            throws IOException
     {
         List destFields = destAcroForm.getFields();
         List srcFields = srcAcroForm.getFields();
-        if( srcFields != null )
+        if (srcFields != null)
         {
-            if( destFields == null )
+            if (destFields == null)
             {
                 destFields = new COSArrayList();
-                destAcroForm.setFields( destFields );
+                destAcroForm.setFields(destFields);
             }
             Iterator srcFieldsIterator = srcFields.iterator();
             while (srcFieldsIterator.hasNext())
             {
-                PDField srcField = (PDField)srcFieldsIterator.next();
-                PDField destField =
-                    PDFieldFactory.createField(
-                        destAcroForm,
-                        (COSDictionary)cloner.cloneForNewDocument(srcField.getDictionary() ));
+                PDField srcField = (PDField) srcFieldsIterator.next();
+                PDField destField = PDFieldFactory.createField(destAcroForm,
+                        (COSDictionary) cloner.cloneForNewDocument(srcField.getDictionary()));
                 // if the form already has a field with this name then we need to rename this field
                 // to prevent merge conflicts.
-                if ( destAcroForm.getField(destField.getFullyQualifiedName()) != null )
+                if (destAcroForm.getField(destField.getFullyQualifiedName()) != null)
                 {
-                    destField.setPartialName("dummyFieldName"+(nextFieldNum++));
+                    destField.setPartialName("dummyFieldName" + (nextFieldNum++));
                 }
                 destFields.add(destField);
             }
         }
     }
 
+    /**
+     * Indicates if acroform errors are ignored or not.
+     * 
+     * @return true if acroform errors are ignored
+     */
     public boolean isIgnoreAcroFormErrors()
     {
         return ignoreAcroFormErrors;
     }
 
-    public void setIgnoreAcroFormErrors(boolean ignoreAcroFormErrors)
+    /**
+     * Set to true to ignore acroform errors.
+     * 
+     * @param ignoreAcroFormErrorsValue true if acroform errors should be ignored
+     */
+    public void setIgnoreAcroFormErrors(boolean ignoreAcroFormErrorsValue)
+    {
+        ignoreAcroFormErrors = ignoreAcroFormErrorsValue;
+    }
+
+    /**
+     * Update the Pg and Obj references to the new (merged) page.
+     * 
+     * @param parentTreeEntry
+     * @param objMapping mapping between old and new references
+     */
+    private void updatePageReferences(COSDictionary parentTreeEntry, HashMap<COSDictionary, COSDictionary> objMapping)
+    {
+        COSBase page = parentTreeEntry.getDictionaryObject(COSName.PG);
+        if (page instanceof COSDictionary)
+        {
+            if (objMapping.containsKey(page))
+            {
+                parentTreeEntry.setItem(COSName.PG, objMapping.get(page));
+            }
+        }
+        COSBase obj = parentTreeEntry.getDictionaryObject(COSName.OBJ);
+        if (obj instanceof COSDictionary)
+        {
+            if (objMapping.containsKey(obj))
+            {
+                parentTreeEntry.setItem(COSName.OBJ, objMapping.get(obj));
+            }
+        }
+        COSBase kSubEntry = parentTreeEntry.getDictionaryObject(COSName.K);
+        if (kSubEntry instanceof COSArray)
+        {
+            updatePageReferences((COSArray) kSubEntry, objMapping);
+        }
+        else if (kSubEntry instanceof COSDictionary)
+        {
+            updatePageReferences((COSDictionary) kSubEntry, objMapping);
+        }
+    }
+
+    private void updatePageReferences(COSArray parentTreeEntry, HashMap<COSDictionary, COSDictionary> objMapping)
+    {
+        for (int i = 0; i < parentTreeEntry.size(); i++)
+        {
+            COSBase subEntry = parentTreeEntry.getObject(i);
+            if (subEntry instanceof COSArray)
+            {
+                updatePageReferences((COSArray) subEntry, objMapping);
+            }
+            else if (subEntry instanceof COSDictionary)
+            {
+                updatePageReferences((COSDictionary) subEntry, objMapping);
+            }
+        }
+    }
+
+    /**
+     * Update the P reference to the new parent dictionary.
+     * 
+     * @param kArray the kids array
+     * @param newParent the new parent
+     */
+    private void updateParentEntry(COSArray kArray, COSDictionary newParent)
     {
-        this.ignoreAcroFormErrors = ignoreAcroFormErrors;
+        for (int i = 0; i < kArray.size(); i++)
+        {
+            COSBase subEntry = kArray.getObject(i);
+            if (subEntry instanceof COSDictionary)
+            {
+                COSDictionary dictEntry = (COSDictionary) subEntry;
+                if (dictEntry.getDictionaryObject(COSName.P) != null)
+                {
+                    dictEntry.setItem(COSName.P, newParent);
+                }
+            }
+        }
     }
 
+    /**
+     * Update the StructParents and StructParent values in a PDPage.
+     * 
+     * @param page the new page
+     * @param structParentOffset the offset which should be applied
+     */
+    private void updateStructParentEntries(PDPage page, int structParentOffset) throws IOException
+    {
+        page.setStructParents(page.getStructParents() + structParentOffset);
+        List<PDAnnotation> annots = page.getAnnotations();
+        List<PDAnnotation> newannots = new ArrayList<PDAnnotation>();
+        for (PDAnnotation annot : annots)
+        {
+            annot.setStructParent(annot.getStructParent() + structParentOffset);
+            newannots.add(annot);
+        }
+        page.setAnnotations(newannots);
+    }
 
 }
