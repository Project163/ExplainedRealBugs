diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdfwriter/COSWriter.java b/pdfbox/src/main/java/org/apache/pdfbox/pdfwriter/COSWriter.java
index f17c0a3ca7..f0c10a5575 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdfwriter/COSWriter.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdfwriter/COSWriter.java
@@ -918,8 +918,15 @@ public class COSWriter implements ICOSVisitor
                 COSBase current = i.next();
                 if( current instanceof COSDictionary )
                 {
-                    addObjectToWrite( current );
-                    writeReference( current );
+                	if (current.isDirect())
+                	{
+                		visitFromDictionary((COSDictionary)current);
+                	}
+                	else
+                	{
+                		addObjectToWrite( current );
+                		writeReference( current );
+                	}
                 }
                 else if( current instanceof COSObject )
                 {
