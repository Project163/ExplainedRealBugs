diff --git a/pdfbox/src/main/java/org/apache/pdfbox/rendering/PageDrawer.java b/pdfbox/src/main/java/org/apache/pdfbox/rendering/PageDrawer.java
index 9a8e656605..3244ad0893 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/rendering/PageDrawer.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/rendering/PageDrawer.java
@@ -678,12 +678,29 @@ public class PageDrawer extends PDFGraphicsStreamEngine
         }
 
         PDLineDashPattern dashPattern = state.getLineDashPattern();
+        // PDFBOX-5168: show an all-zero dash array line invisible like Adobe does
+        // must do it here because getDashArray() sets minimum width because of JVM bugs
+        float[] dashArray = dashPattern.getDashArray();
+        if (dashArray.length > 0)
+        {
+            boolean allZero = true;
+            for (int i = 0; i < dashArray.length; ++i)
+            {
+                if (dashArray[i] != 0)
+                {
+                    allZero = false;
+                    break;
+                }
+            }
+            if (allZero)
+            {
+                return (Shape p) -> new Area();
+            }
+        }
         float phaseStart = dashPattern.getPhase();
-        float[] dashArray = getDashArray(dashPattern);
+        dashArray = getDashArray(dashPattern);
         phaseStart = transformWidth(phaseStart);
-        boolean allZero = true;
 
-        // empty dash array is illegal
         // avoid also infinite and NaN values (PDFBOX-3360)
         if (dashArray.length == 0 || Float.isInfinite(phaseStart) || Float.isNaN(phaseStart))
         {
@@ -693,22 +710,11 @@ public class PageDrawer extends PDFGraphicsStreamEngine
         {
             for (int i = 0; i < dashArray.length; ++i)
             {
-                float dash = dashArray[i];
-                if (Float.isInfinite(dash) || Float.isNaN(dash))
+                if (Float.isInfinite(dashArray[i]) || Float.isNaN(dashArray[i]))
                 {
                     dashArray = null;
-                    allZero = false;
                     break;
                 }
-                if (dash != 0)
-                {
-                    allZero = false;
-                }
-            }
-            if (allZero)
-            {
-                // PDFBOX-5168: make it invisible like Adobe
-                return (Shape p) -> new Area();
             }
         }
         int lineCap = Math.min(2, Math.max(0, state.getLineCap())); // legal values 0..2
