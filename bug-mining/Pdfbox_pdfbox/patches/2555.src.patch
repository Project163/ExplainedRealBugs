diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdfwriter/compress/COSWriterObjectStream.java b/pdfbox/src/main/java/org/apache/pdfbox/pdfwriter/compress/COSWriterObjectStream.java
index 5b590f0988..6f0a1eaad4 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdfwriter/compress/COSWriterObjectStream.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdfwriter/compress/COSWriterObjectStream.java
@@ -183,6 +183,12 @@ public class COSWriterObjectStream
                 : (COSBase) object;
         if (base == null)
         {
+            // the object reference can't be dereferenced
+            // be lenient and write the reference nevertheless
+            if (!topLevel && object instanceof COSObject)
+            {
+                writeObjectReference(output, ((COSObject) object).getKey());
+            }
             return;
         }
         if (!topLevel && this.compressionPool.contains(base))
