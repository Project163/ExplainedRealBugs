diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdfwriter/compress/COSObjectPool.java b/pdfbox/src/main/java/org/apache/pdfbox/pdfwriter/compress/COSObjectPool.java
index 18671d56fc..d0e1244547 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdfwriter/compress/COSObjectPool.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdfwriter/compress/COSObjectPool.java
@@ -58,7 +58,11 @@ public class COSObjectPool
      */
     public COSObjectKey put(COSObjectKey key, COSBase object)
     {
-        if (object == null || contains(object))
+        // to avoid to mixup indirect COSInteger objects holding the same value we have to check
+        // if the given key is the same than the key which is stored for the "same" base object wihtin the object pool
+        // the same is always true for COSFloat, COSBoolean and COSName and under certain circumstances for the remainig
+        // types as well
+        if (object == null || (contains(object) && getKey(object).equals(key)))
         {
             return null;
         }
diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdfwriter/compress/COSWriterCompressionPool.java b/pdfbox/src/main/java/org/apache/pdfbox/pdfwriter/compress/COSWriterCompressionPool.java
index b54675ac14..7a1ec9aaf7 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdfwriter/compress/COSWriterCompressionPool.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdfwriter/compress/COSWriterCompressionPool.java
@@ -98,7 +98,13 @@ public class COSWriterCompressionPool
         // Drop hollow objects.
         COSBase base = element.getCurrentObject();
         base = base instanceof COSObject ? ((COSObject) base).getObject() : base;
-        if (base == null || objectPool.contains(base))
+        // to avoid to mixup indirect COSInteger objects holding the same value we have to check
+        // if the given key is the same than the key which is stored for the "same" base object wihtin the object pool
+        // the same is always true for COSFloat, COSBoolean and COSName and under certain circumstances for the remainig
+        // types as well
+        if (base == null //
+                || (key != null && objectPool.contains(key)) //
+                || (key == null && objectPool.contains(base)))
         {
             return base;
         }
