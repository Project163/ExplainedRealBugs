diff --git a/pdfbox/src/main/java/org/apache/pdfbox/io/RandomAccessBufferedFileInputStream.java b/pdfbox/src/main/java/org/apache/pdfbox/io/RandomAccessBufferedFileInputStream.java
index e9a8576e18..0334957a31 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/io/RandomAccessBufferedFileInputStream.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/io/RandomAccessBufferedFileInputStream.java
@@ -17,6 +17,8 @@
 package org.apache.pdfbox.io;
 
 import java.io.File;
+import java.io.FileNotFoundException;
+import java.io.FileOutputStream;
 import java.io.IOException;
 import java.io.InputStream;
 import java.io.RandomAccessFile;
@@ -36,11 +38,16 @@ import java.util.Map;
 public class RandomAccessBufferedFileInputStream
 extends InputStream implements RandomAccessRead
 {
+    /**
+     * The prefix for the temp file being used. 
+     */
+    private static final String TMP_FILE_PREFIX = "tmpPDFBox";
 
     private int pageSizeShift = 12;
     private int pageSize = 1 << pageSizeShift;
     private long pageOffsetMask = -1L << pageSizeShift;
     private int maxCachedPages = 1000;
+    private File tempFile;
 
     private byte[] lastRemovedCachePage = null;
 
@@ -71,13 +78,58 @@ extends InputStream implements RandomAccessRead
     private long fileOffset = 0;
     private boolean isClosed;
     
-    /** Create input stream instance for given file. */
-    public RandomAccessBufferedFileInputStream( File file ) throws IOException 
+    /** 
+     * Create a random access input stream instance for the given file.
+     *
+     * @param the file to be read
+     * @exception if the given file can't be found
+     */
+    public RandomAccessBufferedFileInputStream( File file ) throws FileNotFoundException 
     {
         raFile = new RandomAccessFile(file, "r");
         fileLength = file.length();
+    }
+
+    /** 
+     * Create a random access input stream for the given input stream 
+     * by copying the data to a temporary file.
+     * 
+     * @param the input stream to be read
+     * @exception if something went wrong while creating the temporary file
+     */
+    public RandomAccessBufferedFileInputStream( InputStream input ) throws IOException 
+    {
+        tempFile = createTmpFile(input);
+        fileLength = tempFile.length();
+        raFile = new RandomAccessFile(tempFile, "r");
+    }
+
+    private File createTmpFile(InputStream input) throws IOException
+    {
+        FileOutputStream fos = null;
+        try
+        {
+            File tmpFile = File.createTempFile(TMP_FILE_PREFIX, ".pdf");
+            fos = new FileOutputStream(tmpFile);
+            IOUtils.copy(input, fos);
+            return tmpFile;
+        }
+        finally
+        {
+            IOUtils.closeQuietly(input);
+            IOUtils.closeQuietly(fos);
+        }
+    }
 
-        seek(0);
+    /**
+     * Remove the temporary file. A temporary file is created if this class is instantiated with an InputStream
+     */
+    private void deleteTempFile()
+    {
+        if (tempFile != null)
+        {
+            tempFile.delete();
+        }
     }
 
     /** Returns offset in file at which next byte would be read. */
@@ -238,6 +290,7 @@ extends InputStream implements RandomAccessRead
     public void close() throws IOException
     {
         raFile.close();
+        deleteTempFile();
         pageCache.clear();
         isClosed = true;
     }
diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/PDFParser.java b/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/PDFParser.java
index b118798dcf..96408e9b93 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/PDFParser.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/PDFParser.java
@@ -31,7 +31,6 @@ import org.apache.pdfbox.cos.COSNull;
 import org.apache.pdfbox.cos.COSObject;
 import org.apache.pdfbox.io.IOUtils;
 import org.apache.pdfbox.io.RandomAccessBufferedFileInputStream;
-import org.apache.pdfbox.io.RandomAccessFile;
 import org.apache.pdfbox.pdmodel.PDDocument;
 import org.apache.pdfbox.pdmodel.encryption.AccessPermission;
 import org.apache.pdfbox.pdmodel.encryption.DecryptionMaterial;
@@ -49,8 +48,6 @@ public class PDFParser extends COSParser
 
     private AccessPermission accessPermission;
 
-    private File tempPDFFile;
-
     /**
      * Constructs parser for given file using memory buffer.
      * 
@@ -252,9 +249,7 @@ public class PDFParser extends COSParser
     {
         if (useScratchFiles)
         {
-            tempPDFFile = createTmpFile(input);
-            fileLen = tempPDFFile.length();
-            pdfSource = new RandomAccessBufferedFileInputStream(tempPDFFile);
+            pdfSource = new RandomAccessBufferedFileInputStream(input);
         }
         else
         {
@@ -361,7 +356,6 @@ public class PDFParser extends COSParser
         {
             IOUtils.closeQuietly(pdfSource);
             IOUtils.closeQuietly(keyStoreInputStream);
-            deleteTempFile();
     
             if (exceptionOccurred && document != null)
             {
@@ -371,27 +365,6 @@ public class PDFParser extends COSParser
         }
     }
 
-    /**
-     * Remove the temporary file. A temporary file is created if this class is instantiated with an InputStream
-     */
-    private void deleteTempFile()
-    {
-        if (tempPDFFile != null)
-        {
-            try
-            {
-                if (!tempPDFFile.delete())
-                {
-                    LOG.warn("Temporary file '" + tempPDFFile.getName() + "' can't be deleted");
-                }
-            }
-            catch (SecurityException e)
-            {
-                LOG.warn("Temporary file '" + tempPDFFile.getName() + "' can't be deleted", e);
-            }
-        }
-    }
-
     /**
      * Prepare for decryption.
      * 
