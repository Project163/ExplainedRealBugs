diff --git a/pdfbox/src/main/java/org/apache/pdfbox/util/operator/GRestore.java b/pdfbox/src/main/java/org/apache/pdfbox/util/operator/GRestore.java
index 896ace9aa6..f42162bcd4 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/util/operator/GRestore.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/util/operator/GRestore.java
@@ -18,24 +18,40 @@ package org.apache.pdfbox.util.operator;
 
 import java.util.List;
 
+import org.apache.commons.logging.Log;
+import org.apache.commons.logging.LogFactory;
 import org.apache.pdfbox.cos.COSBase;
 import org.apache.pdfbox.pdmodel.graphics.PDGraphicsState;
 import org.apache.pdfbox.util.PDFOperator;
 
 /**
- *
+ * Process the Q operator.
+ * 
  * @author Huault : huault@free.fr
- * @version $Revision: 1.4 $
+ * 
  */
 public class GRestore extends OperatorProcessor
 {
+	
+    /**
+     * Log instance.
+     */
+    private static final Log LOG = LogFactory.getLog(GRestore.class);
+
     /**
-     * process : Q : Restore graphics state.
-     * @param operator The operator that is being executed.
-     * @param arguments List
+     * {@inheritDoc}
      */
     public void process(PDFOperator operator, List<COSBase> arguments)
     {
-        context.setGraphicsState( (PDGraphicsState)context.getGraphicsStack().pop() );
+    	if (context.getGraphicsStack().size() > 0)
+    	{
+    		context.setGraphicsState( (PDGraphicsState)context.getGraphicsStack().pop() );
+    	}
+    	else
+    	{
+    		// this shouldn't happen but it does, see PDFBOX-161
+    		// TODO make this self healing mechanism optional for preflight??
+    		LOG.debug("GRestore: no graphics state left to be restored.");
+    	}
     }
 }
