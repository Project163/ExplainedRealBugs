diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/COSParser.java b/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/COSParser.java
index 03c2c57c3d..f46695ce96 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/COSParser.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/COSParser.java
@@ -1421,6 +1421,9 @@ public class COSParser extends BaseParser
             bfSearchCOSObjectKeyOffsets = new HashMap<>();
             long originOffset = source.getPosition();
             long currentOffset = MINIMUM_SEARCH_OFFSET;
+            long lastObjectId = Long.MIN_VALUE;
+            int lastGenID = Integer.MIN_VALUE;
+            long lastObjOffset = Long.MIN_VALUE;
             String objString = " obj";
             char[] string = objString.toCharArray();
             do
@@ -1452,9 +1455,17 @@ public class COSParser extends BaseParser
                             if (objectIDFound)
                             {
                                 source.read();
-                                long objectID = readObjectNumber();
-                                bfSearchCOSObjectKeyOffsets.put(new COSObjectKey(objectID, genID),
-                                        tempOffset + 1);
+                                long objectId = readObjectNumber();
+                                if (lastObjOffset > 0)
+                                {
+                                    // add the former object ID only if there was a subsequent object ID
+                                    bfSearchCOSObjectKeyOffsets
+                                            .put(new COSObjectKey(lastObjectId, lastGenID),
+                                                    lastObjOffset);
+                                }
+                                lastObjectId = objectId;
+                                lastGenID = genID;
+                                lastObjOffset = tempOffset + 1;
                             }
                         }
                     }
@@ -1462,6 +1473,13 @@ public class COSParser extends BaseParser
                 currentOffset++;
             }
             while (currentOffset < lastEOFMarker && !source.isEOF());
+            if (lastEOFMarker < Long.MAX_VALUE && lastObjOffset > 0)
+            {
+                // if the pdf wasn't cut off in the middle the last object id has to added here
+                // so that it can't get lost as there isn't any subsequent object id
+                bfSearchCOSObjectKeyOffsets.put(new COSObjectKey(lastObjectId, lastGenID),
+                        lastObjOffset);
+            }
             // reestablish origin position
             source.seek(originOffset);
         }
