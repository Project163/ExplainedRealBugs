diff --git a/pdfbox/src/main/java/org/apache/pdfbox/io/RandomAccessReadBuffer.java b/pdfbox/src/main/java/org/apache/pdfbox/io/RandomAccessReadBuffer.java
index 8dccd03e8c..6a8221deda 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/io/RandomAccessReadBuffer.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/io/RandomAccessReadBuffer.java
@@ -102,10 +102,11 @@ public class RandomAccessReadBuffer implements RandomAccessRead
     {
         this();
         int bytesRead = 0;
+        int remainingBytes = chunkSize;
+        int offset = 0;
+        byte[] eofCheck = new byte[1];
         while (true)
         {
-            int remainingBytes = chunkSize;
-            int offset = 0;
             while (remainingBytes > 0
                     && (bytesRead = input.read(currentBuffer.array(), offset, remainingBytes)) > -1)
             {
@@ -113,9 +114,12 @@ public class RandomAccessReadBuffer implements RandomAccessRead
                 offset += bytesRead;
             }
             size += offset;
-            if (remainingBytes == 0 && input.available() > 0)
+            if (remainingBytes == 0 && input.read(eofCheck) > 0)
             {
                 expandBuffer();
+                currentBuffer.put(eofCheck);
+                offset = 1;
+                remainingBytes = chunkSize - 1;
             }
             else
             {
diff --git a/pdfbox/src/test/java/org/apache/pdfbox/io/RandomAccessReadBufferTest.java b/pdfbox/src/test/java/org/apache/pdfbox/io/RandomAccessReadBufferTest.java
index a2fb966223..946b18d6ea 100644
--- a/pdfbox/src/test/java/org/apache/pdfbox/io/RandomAccessReadBufferTest.java
+++ b/pdfbox/src/test/java/org/apache/pdfbox/io/RandomAccessReadBufferTest.java
@@ -23,6 +23,9 @@ import static org.junit.jupiter.api.Assertions.assertTrue;
 import java.io.ByteArrayInputStream;
 import java.io.ByteArrayOutputStream;
 import java.io.IOException;
+import java.io.InputStream;
+import java.net.URL;
+
 import org.junit.jupiter.api.Assertions;
 
 import org.junit.jupiter.api.Test;
@@ -193,4 +196,17 @@ class RandomAccessReadBufferTest
             assertEquals(3, view.getPosition());
         }
     }
+
+    @Test
+    void testPDFBOX5111() throws IOException
+    {
+        try (InputStream is = new URL(
+                "https://issues.apache.org/jira/secure/attachment/13017227/stringwidth.pdf")
+                        .openStream())
+        {
+            RandomAccessReadBuffer randomAccessSource = new RandomAccessReadBuffer(is);
+            assertEquals(34060, randomAccessSource.length());
+            randomAccessSource.close();
+        }
+    }
 }
