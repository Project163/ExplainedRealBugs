diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdfwriter/COSWriter.java b/pdfbox/src/main/java/org/apache/pdfbox/pdfwriter/COSWriter.java
index f6da43010e..bf74598e58 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdfwriter/COSWriter.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdfwriter/COSWriter.java
@@ -511,8 +511,7 @@ public class COSWriter implements ICOSVisitor, Closeable
                 cosBase = keyObject.get(cosObjectKey);
             }
             if (actual != null && objectKeys.containsKey(actual) 
-                    && object instanceof COSUpdateInfo && !((COSUpdateInfo)object).isNeedToBeUpdated() 
-                    && cosBase instanceof COSUpdateInfo && !((COSUpdateInfo)cosBase).isNeedToBeUpdated() )
+                    && !isNeedToBeUpdated(object) && !isNeedToBeUpdated(cosBase))
             {
                 return;
             }
@@ -525,6 +524,20 @@ public class COSWriter implements ICOSVisitor, Closeable
         }
     }
 
+    /**
+     * Convenience method, so that we get false for types that can't be updated.
+     * @param base
+     * @return 
+     */
+    private boolean isNeedToBeUpdated(COSBase base)
+    {
+        if (base instanceof COSUpdateInfo)
+        {
+            return ((COSUpdateInfo) base).isNeedToBeUpdated();
+        }
+        return false;
+    }
+
     /**
      * This will write a COS object.
      *
