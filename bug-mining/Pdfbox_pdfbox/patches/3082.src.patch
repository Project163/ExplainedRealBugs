diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDStructureElementNameTreeNode.java b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDStructureElementNameTreeNode.java
index d4520e7e7d..e7574001cf 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDStructureElementNameTreeNode.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDStructureElementNameTreeNode.java
@@ -51,6 +51,10 @@ public class PDStructureElementNameTreeNode extends PDNameTreeNode<PDStructureEl
     @Override
     protected PDStructureElement convertCOSToPD( COSBase base ) throws IOException
     {
+        if (!(base instanceof COSDictionary))
+        {
+            throw new IOException("dictionary expected here, but got " + base);
+        }
         return new PDStructureElement((COSDictionary)base);
     }
 
diff --git a/pdfbox/src/test/java/org/apache/pdfbox/pdmodel/common/PDIntegerNameTreeNode.java b/pdfbox/src/test/java/org/apache/pdfbox/pdmodel/common/PDIntegerNameTreeNode.java
index 786f9383b8..c8072ffb55 100644
--- a/pdfbox/src/test/java/org/apache/pdfbox/pdmodel/common/PDIntegerNameTreeNode.java
+++ b/pdfbox/src/test/java/org/apache/pdfbox/pdmodel/common/PDIntegerNameTreeNode.java
@@ -50,6 +50,10 @@ public class PDIntegerNameTreeNode extends PDNameTreeNode<COSInteger>
     @Override
     protected COSInteger convertCOSToPD(COSBase base) throws IOException
     {
+        if (!(base instanceof COSInteger))
+        {
+            throw new IOException("integer expected here, but got " + base);
+        }
         return (COSInteger)base;
     }
 
