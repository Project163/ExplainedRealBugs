diff --git a/pdfbox/src/main/java/org/apache/pdfbox/cos/COSObject.java b/pdfbox/src/main/java/org/apache/pdfbox/cos/COSObject.java
index 53b1101fdd..adb1b8b336 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/cos/COSObject.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/cos/COSObject.java
@@ -148,7 +148,7 @@ public class COSObject extends COSBase implements COSUpdateInfo
     @Override
     public String toString()
     {
-    	return "COSObject{" + getKey() + "}";
+        return "COSObject{" + getKey() + "}";
     }
 
     /**
diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/COSParser.java b/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/COSParser.java
index b4be7ed7be..679f25288f 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/COSParser.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/COSParser.java
@@ -910,11 +910,11 @@ public class COSParser extends BaseParser implements ICOSParser
 
     protected BruteForceParser getBruteForceParser() throws IOException
     {
-    	if (bruteForceParser == null)
-    	{
+        if (bruteForceParser == null)
+        {
             bruteForceParser = new BruteForceParser(document, this);
         }
-    	return bruteForceParser;
+        return bruteForceParser;
     }
     
     /**
diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/fdf/FDFAnnotation.java b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/fdf/FDFAnnotation.java
index 76f38be31b..2a72415fe1 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/fdf/FDFAnnotation.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/fdf/FDFAnnotation.java
@@ -967,16 +967,16 @@ public abstract class FDFAnnotation implements COSObjectable
             }
             else if (child instanceof CDATASection)
             {
-            	sb.append("<![CDATA[").append(((CDATASection) child).getData()).append("]]>");
+                sb.append("<![CDATA[").append(((CDATASection) child).getData()).append("]]>");
             }
             else if (child instanceof Text)
             {
-            	String cdata = ((Text) child).getData();
-            	if (cdata!=null)
-            	{
-            		cdata = cdata.replace("&", "&amp;").replace("<", "&lt;");
-            	}
-            	sb.append(cdata);
+                String cdata = ((Text) child).getData();
+                if (cdata!=null)
+                {
+                    cdata = cdata.replace("&", "&amp;").replace("<", "&lt;");
+                }
+                sb.append(cdata);
             }
         }
         if (root)
@@ -992,7 +992,7 @@ public abstract class FDFAnnotation implements COSObjectable
             String attributeNodeValue = attribute.getNodeValue();
             if (attributeNodeValue!=null)
             {
-            	attributeNodeValue = attributeNodeValue.replace("\"", "&quot;");
+                attributeNodeValue = attributeNodeValue.replace("\"", "&quot;");
             }
             builder.append(String.format(" %s=\"%s\"", attribute.getNodeName(),
                     attributeNodeValue));
diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/blend/BlendMode.java b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/blend/BlendMode.java
index 7d4caea9b3..98dfaebeb2 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/blend/BlendMode.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/blend/BlendMode.java
@@ -200,8 +200,8 @@ public class BlendMode
      */
     private BlendMode(COSName name, BlendChannelFunction blendChannel, BlendFunction blend)
     {
-    	this.name = name;
-    	this.blendChannel = blendChannel;
+        this.name = name;
+        this.blendChannel = blendChannel;
         this.blend = blend;
         isSeparable = blendChannel != null;
     }
@@ -213,7 +213,7 @@ public class BlendMode
      */
     public COSName getCOSName()
     {
-    	return name;
+        return name;
     }
 
     /**
@@ -264,15 +264,15 @@ public class BlendMode
             COSArray cosBlendModeArray = (COSArray) cosBlendMode;
             for (int i = 0; i < cosBlendModeArray.size(); i++)
             {
-            	COSBase cosBase = cosBlendModeArray.getObject(i);
-            	if (cosBase instanceof COSName)
-            	{
+                COSBase cosBase = cosBlendModeArray.getObject(i);
+                if (cosBase instanceof COSName)
+                {
                     result = BLEND_MODES.get(cosBase);
                     if (result != null)
                     {
                         break;
                     }
-            	}
+                }
             }
         }
         return result != null ? result : BlendMode.NORMAL;
diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/color/PDICCBased.java b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/color/PDICCBased.java
index 743f8185c2..132748fba6 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/color/PDICCBased.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/color/PDICCBased.java
@@ -262,7 +262,7 @@ public final class PDICCBased extends PDCIEBasedColorSpace
             if (profileData[ICC_Profile.icHdrRenderingIntent] == ICC_Profile.icPerceptual)
             {
                 LOG.warn("ICC profile is Perceptual, ignoring, treating as Display class");
-            	intToBigEndian(ICC_Profile.icSigDisplayClass, profileData, ICC_Profile.icHdrDeviceClass);
+                intToBigEndian(ICC_Profile.icSigDisplayClass, profileData, ICC_Profile.icHdrDeviceClass);
                 return ICC_Profile.getInstance(profileData);
             }
         }
diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/shading/PDShadingType4.java b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/shading/PDShadingType4.java
index 33c7c836f8..091a7af83b 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/shading/PDShadingType4.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/shading/PDShadingType4.java
@@ -91,7 +91,7 @@ public class PDShadingType4 extends PDTriangleBasedShadingType
     List<ShadedTriangle> collectTriangles(AffineTransform xform, Matrix matrix)
             throws IOException
     {
-    	int bitsPerFlag = getBitsPerFlag();
+        int bitsPerFlag = getBitsPerFlag();
         COSDictionary dict = getCOSObject();
         if (!(dict instanceof COSStream))
         {
diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/shading/Patch.java b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/shading/Patch.java
index 1377b05fe8..4bd27656c8 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/shading/Patch.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/shading/Patch.java
@@ -229,4 +229,14 @@ abstract class Patch
     {
         return Math.abs(p0.getX() - p1.getX()) < 0.001 && Math.abs(p0.getY() - p1.getY()) < 0.001;
     }
+
+    static Point2D[] clonedPoint2DArray(Point2D[] input)
+    {
+        Point2D[] cloned = new Point2D[input.length];
+        for (int i = 0; i < input.length; ++i)
+        {
+            cloned[i] = (Point2D) input[i].clone();
+        }
+        return cloned;
+    }
 }
diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/interactive/PlainTextFormatter.java b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/interactive/PlainTextFormatter.java
index d4db0efe3e..3e41fe2ec7 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/interactive/PlainTextFormatter.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/interactive/PlainTextFormatter.java
@@ -146,7 +146,7 @@ public class PlainTextFormatter
         if (textContent != null && !textContent.getParagraphs().isEmpty())
         {
             boolean isFirstParagraph = true;
-        	for (Paragraph paragraph : textContent.getParagraphs())
+            for (Paragraph paragraph : textContent.getParagraphs())
             {
                 if (wrapLines)
                 {
diff --git a/pdfbox/src/test/java/org/apache/pdfbox/pdmodel/interactive/form/ControlCharacterTest.java b/pdfbox/src/test/java/org/apache/pdfbox/pdmodel/interactive/form/ControlCharacterTest.java
index 3133c40a2d..e93ea27451 100644
--- a/pdfbox/src/test/java/org/apache/pdfbox/pdmodel/interactive/form/ControlCharacterTest.java
+++ b/pdfbox/src/test/java/org/apache/pdfbox/pdmodel/interactive/form/ControlCharacterTest.java
@@ -92,7 +92,7 @@ class ControlCharacterTest
     void characterTAB() throws IOException
     {
         PDField field = acroForm.getField("pdfbox-tab");
-    	field.setValue("TAB\tTAB");
+        field.setValue("TAB\tTAB");
 
         List<String> pdfboxValues = getStringsFromStream(field);
         pdfboxValues.forEach(token -> assertEquals("TAB", token));
@@ -131,12 +131,12 @@ class ControlCharacterTest
     
     private List<String> getStringsFromStream(PDField field) throws IOException
     {
-    	PDAnnotationWidget widget = field.getWidgets().get(0);
+        PDAnnotationWidget widget = field.getWidgets().get(0);
         PDFStreamParser parser = new PDFStreamParser(
                 widget.getNormalAppearanceStream());
-    	
+        
         List<Object> tokens = parser.parse();
-    	
+        
         // TODO: improve the string output to better match
         // trimming as Acrobat adds spaces to strings
         // where we don't
diff --git a/pdfbox/src/test/java/org/apache/pdfbox/pdmodel/interactive/form/MultilineFieldsTest.java b/pdfbox/src/test/java/org/apache/pdfbox/pdmodel/interactive/form/MultilineFieldsTest.java
index 08a4c05e54..3673b60f09 100644
--- a/pdfbox/src/test/java/org/apache/pdfbox/pdmodel/interactive/form/MultilineFieldsTest.java
+++ b/pdfbox/src/test/java/org/apache/pdfbox/pdmodel/interactive/form/MultilineFieldsTest.java
@@ -162,15 +162,15 @@ class MultilineFieldsTest
 
     private float getFontSizeFromAppearanceStream(PDField field) throws IOException
     {
-    	PDAnnotationWidget widget = field.getWidgets().get(0);
+        PDAnnotationWidget widget = field.getWidgets().get(0);
         PDFStreamParser parser = new PDFStreamParser(widget.getNormalAppearanceStream());
-    	
-    	Object token = parser.parseNextToken();
-    	    	
-    	while (token != null)
-    	{
+        
+        Object token = parser.parseNextToken();
+                
+        while (token != null)
+        {
             if (token instanceof COSName && ((COSName) token).getName().equals("Helv"))
-    		{
+            {
                 token = parser.parseNextToken();
                 if (token instanceof COSNumber)
                 {
@@ -184,17 +184,17 @@ class MultilineFieldsTest
 
     private List<String> getTextLinesFromAppearanceStream(PDField field) throws IOException
     {
-    	PDAnnotationWidget widget = field.getWidgets().get(0);
+        PDAnnotationWidget widget = field.getWidgets().get(0);
         PDFStreamParser parser = new PDFStreamParser(widget.getNormalAppearanceStream());
-    	
+        
         Object token = parser.parseNextToken();
         
         List<String> lines = new ArrayList<>();
-    	    	
-    	while (token != null)
-    	{
+                
+        while (token != null)
+        {
             if (token instanceof COSString)
-    		{
+            {
                 lines.add(((COSString) token).getString());
             }
             token = parser.parseNextToken();
diff --git a/pdfbox/src/test/java/org/apache/pdfbox/pdmodel/interactive/form/PlainTextTest.java b/pdfbox/src/test/java/org/apache/pdfbox/pdmodel/interactive/form/PlainTextTest.java
index 3de5d85b3f..ad5faf1794 100644
--- a/pdfbox/src/test/java/org/apache/pdfbox/pdmodel/interactive/form/PlainTextTest.java
+++ b/pdfbox/src/test/java/org/apache/pdfbox/pdmodel/interactive/form/PlainTextTest.java
@@ -33,43 +33,43 @@ class PlainTextTest
     @Test
     void characterCR()
     {
-    	PlainText text = new PlainText("CR\rCR");
-    	assertEquals(2,text.getParagraphs().size());
+        PlainText text = new PlainText("CR\rCR");
+        assertEquals(2,text.getParagraphs().size());
     }
 
     @Test
     void characterLF()
     {
-    	PlainText text = new PlainText("LF\nLF");
-    	assertEquals(2,text.getParagraphs().size());
+        PlainText text = new PlainText("LF\nLF");
+        assertEquals(2,text.getParagraphs().size());
     }
     
     @Test
     void characterCRLF()
     {
-    	PlainText text = new PlainText("CRLF\r\nCRLF");
-    	assertEquals(2,text.getParagraphs().size());
+        PlainText text = new PlainText("CRLF\r\nCRLF");
+        assertEquals(2,text.getParagraphs().size());
     }
 
     @Test
     void characterLFCR()
     {
-    	PlainText text = new PlainText("LFCR\n\rLFCR");
-    	assertEquals(3,text.getParagraphs().size());
+        PlainText text = new PlainText("LFCR\n\rLFCR");
+        assertEquals(3,text.getParagraphs().size());
     }
     
     @Test
     void characterUnicodeLinebreak()
     {
-    	PlainText text = new PlainText("linebreak\u2028linebreak");
-    	assertEquals(2,text.getParagraphs().size());
+        PlainText text = new PlainText("linebreak\u2028linebreak");
+        assertEquals(2,text.getParagraphs().size());
     }
     
     @Test
     void characterUnicodeParagraphbreak()
     {
-    	PlainText text = new PlainText("paragraphbreak\u2029paragraphbreak");
-    	assertEquals(2,text.getParagraphs().size());
+        PlainText text = new PlainText("paragraphbreak\u2029paragraphbreak");
+        assertEquals(2,text.getParagraphs().size());
     }
 
 }
