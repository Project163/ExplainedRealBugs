diff --git a/pdfbox/src/main/java/org/apache/pdfbox/util/QuickSort.java b/pdfbox/src/main/java/org/apache/pdfbox/util/QuickSort.java
index 61051b94dc..7b3527354c 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/util/QuickSort.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/util/QuickSort.java
@@ -16,13 +16,16 @@
  */
 package org.apache.pdfbox.util;
 
+import java.util.ArrayDeque;
 import java.util.Comparator;
+import java.util.Deque;
 import java.util.List;
 
 /**
  * see http://de.wikipedia.org/wiki/Quicksort.
  * 
  * @author Uwe Pachler
+ * @author Manuel Aristaran
  */
 public final class QuickSort
 {
@@ -53,7 +56,7 @@ public final class QuickSort
         {
             return;
         }
-        quicksort(list, cmp, 0, size - 1);
+        quicksort(list, cmp);
     }
 
     /**
@@ -66,49 +69,65 @@ public final class QuickSort
         sort(list, (Comparator<T>) OBJCOMP);
     }
 
-    private static <T> void quicksort(List<T> list, Comparator<T> cmp, int left, int right)
+    private static <T> void quicksort(List<T> list, Comparator<T> cmp)
     {
-        if (left < right)
+        Deque<Integer> stack = new ArrayDeque<Integer>();
+        stack.push(0);
+        stack.push(list.size());
+        while (!stack.isEmpty())
         {
-            int splitter = split(list, cmp, left, right);
-            quicksort(list, cmp, left, splitter - 1);
-            quicksort(list, cmp, splitter + 1, right);
+            int right = stack.pop();
+            int left = stack.pop();
+            if (right - left < 2)
+            {
+                continue;
+            }
+            int p = left + ((right - left) / 2);
+            p = partition(list, cmp, p, left, right);
+
+            stack.push(p + 1);
+            stack.push(right);
+
+            stack.push(left);
+            stack.push(p);
         }
     }
 
-    private static <T> void swap(List<T> list, int i, int j)
+    private static <T> int partition(List<T> list, Comparator<T> cmp, int p, int start, int end)
     {
-        T tmp = list.get(i);
-        list.set(i, list.get(j));
-        list.set(j, tmp);
-    }
+        int l = start;
+        int h = end - 2;
+        T piv = list.get(p);
+        swap(list, p, end - 1);
 
-    private static <T> int split(List<T> list, Comparator<T> cmp, int left, int right)
-    {
-        int i = left;
-        int j = right - 1;
-        T pivot = list.get(right);
-        do
+        while (l < h)
         {
-            while (cmp.compare(list.get(i), pivot) <= 0 && i < right)
+            if (cmp.compare(list.get(l), piv) <= 0)
             {
-                ++i;
+                l++;
             }
-            while (cmp.compare(pivot, list.get(j)) <= 0 && j > left)
+            else if (cmp.compare(piv, list.get(h)) <= 0)
             {
-                --j;
+                h--;
             }
-            if (i < j)
+            else
             {
-                swap(list, i, j);
+                swap(list, l, h);
             }
         }
-        while (i < j);
-
-        if (cmp.compare(pivot, list.get(i)) < 0)
+        int idx = h;
+        if (cmp.compare(list.get(h), piv) < 0)
         {
-            swap(list, i, right);
+            idx++;
         }
-        return i;
+        swap(list, end - 1, idx);
+        return idx;
+    }
+
+    private static <T> void swap(List<T> list, int i, int j)
+    {
+        T tmp = list.get(i);
+        list.set(i, list.get(j));
+        list.set(j, tmp);
     }
 }
