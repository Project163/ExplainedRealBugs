diff --git a/pdfbox/src/main/java/org/apache/pdfbox/multipdf/PDFCloneUtility.java b/pdfbox/src/main/java/org/apache/pdfbox/multipdf/PDFCloneUtility.java
index b5f5f6e049..2a0e5382e3 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/multipdf/PDFCloneUtility.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/multipdf/PDFCloneUtility.java
@@ -115,7 +115,9 @@ class PDFCloneUtility
               COSArray array = (COSArray)base;
               for( int i=0; i<array.size(); i++ )
               {
-                  newArray.add( cloneForNewDocument( array.get( i ) ) );
+                  COSBase value = array.get(i);
+                  checkForRecursion((COSBase) base, value);
+                  newArray.add(cloneForNewDocument(value));
               }
               retval = newArray;
           }
@@ -131,7 +133,9 @@ class PDFCloneUtility
               clonedVersion.put( base, stream );
               for( Map.Entry<COSName, COSBase> entry :  originalStream.entrySet() )
               {
-                  stream.setItem(entry.getKey(), cloneForNewDocument(entry.getValue()));
+                  COSBase value = entry.getValue();
+                  checkForRecursion((COSBase) base, value);
+                  stream.setItem(entry.getKey(), cloneForNewDocument(value));
               }
               retval = stream;
           }
@@ -142,9 +146,9 @@ class PDFCloneUtility
               clonedVersion.put( base, retval );
               for( Map.Entry<COSName, COSBase> entry : dic.entrySet() )
               {
-                  ((COSDictionary)retval).setItem(
-                          entry.getKey(),
-                          cloneForNewDocument(entry.getValue()));
+                  COSBase value = entry.getValue();
+                  checkForRecursion((COSBase) base, value);
+                  ((COSDictionary) retval).setItem(entry.getKey(), cloneForNewDocument(value));
               }
           }
           else
@@ -255,4 +259,23 @@ class PDFCloneUtility
           clonedVersion.put( base, retval );
           clonedValues.add(retval);
       }
+
+    /**
+     * Check whether an element (of an array or a dictionary) points to its parent.
+     *
+     * @param parent COSArray or COSDictionary
+     * @param value an element
+     * @throws IOException if value is an object reference to the parent
+     */
+    private void checkForRecursion(COSBase parent, COSBase value) throws IOException
+    {
+        if (value instanceof COSObject)
+        {
+            COSBase actual = ((COSObject) value).getObject();
+            if (actual == parent)
+            {
+                throw new IOException("Loop within object " + value);
+            }
+        }
+    }
 }
