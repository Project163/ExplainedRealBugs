diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDDocument.java b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDDocument.java
index 1d3fe90b08..4abc5ebd0d 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDDocument.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDDocument.java
@@ -850,7 +850,6 @@ public class PDDocument implements Closeable
     {
         StandardDecryptionMaterial m = new StandardDecryptionMaterial(password);
         openProtection(m);
-        document.dereferenceObjectStreams();
     }
 
     /**
@@ -1397,6 +1396,7 @@ public class PDDocument implements Closeable
             getEncryption().getSecurityHandler().decryptDocument(this, decryptionMaterial);
             document.dereferenceObjectStreams();
             document.setEncryptionDictionary(null);
+            getDocumentCatalog();
         }
         else
         {
