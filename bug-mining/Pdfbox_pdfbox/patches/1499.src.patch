diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/font/PDCIDFontType2.java b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/font/PDCIDFontType2.java
index fbb7f6a790..25529636cb 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/font/PDCIDFontType2.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/font/PDCIDFontType2.java
@@ -27,6 +27,7 @@ import org.apache.fontbox.cff.Type2CharString;
 import org.apache.fontbox.cmap.CMap;
 import org.apache.fontbox.ttf.CmapSubtable;
 import org.apache.fontbox.ttf.GlyphData;
+import org.apache.fontbox.ttf.GlyphTable;
 import org.apache.fontbox.ttf.OTFParser;
 import org.apache.fontbox.ttf.OpenTypeFont;
 import org.apache.fontbox.ttf.TrueTypeFont;
@@ -438,7 +439,12 @@ public class PDCIDFontType2 extends PDCIDFont
         else
         {
             int gid = codeToGID(code);
-            GlyphData glyph = ttf.getGlyph().getGlyph(gid);
+            GlyphTable glyphTable = ttf.getGlyph();
+            if (glyphTable == null)
+            {
+                return new GeneralPath();
+            }
+            GlyphData glyph = glyphTable.getGlyph(gid);
             if (glyph != null)
             {
                 return glyph.getPath();
diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/font/PDTrueTypeFont.java b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/font/PDTrueTypeFont.java
index cf86ff62ed..066fb518d4 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/font/PDTrueTypeFont.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/font/PDTrueTypeFont.java
@@ -29,6 +29,7 @@ import org.apache.fontbox.FontBoxFont;
 import org.apache.fontbox.ttf.CmapSubtable;
 import org.apache.fontbox.ttf.CmapTable;
 import org.apache.fontbox.ttf.GlyphData;
+import org.apache.fontbox.ttf.GlyphTable;
 import org.apache.fontbox.ttf.PostScriptTable;
 import org.apache.fontbox.ttf.TTFParser;
 import org.apache.fontbox.ttf.TrueTypeFont;
@@ -350,7 +351,12 @@ public class PDTrueTypeFont extends PDSimpleFont implements PDVectorFont
     public float getHeight(int code) throws IOException
     {
         int gid = codeToGID(code);
-        GlyphData glyph = ttf.getGlyph().getGlyph(gid);
+        GlyphTable glyphTable = ttf.getGlyph();
+        if (glyphTable == null)
+        {
+            return 0;
+        }
+        GlyphData glyph = glyphTable.getGlyph(gid);
         if (glyph != null)
         {
             return glyph.getBoundingBox().getHeight();
@@ -442,7 +448,12 @@ public class PDTrueTypeFont extends PDSimpleFont implements PDVectorFont
     public GeneralPath getPath(int code) throws IOException
     {
         int gid = codeToGID(code);
-        GlyphData glyph = ttf.getGlyph().getGlyph(gid);
+        GlyphTable glyphTable = ttf.getGlyph();
+        if (glyphTable == null)
+        {
+            return new GeneralPath();
+        }
+        GlyphData glyph = glyphTable.getGlyph(gid);
         
         // some glyphs have no outlines (e.g. space, table, newline)
         if (glyph == null)
@@ -482,7 +493,12 @@ public class PDTrueTypeFont extends PDSimpleFont implements PDVectorFont
             return new GeneralPath();
         }
         
-        GlyphData glyph = ttf.getGlyph().getGlyph(gid);
+        GlyphTable glyphTable = ttf.getGlyph();
+        if (glyphTable == null)
+        {
+            return new GeneralPath();
+        }
+        GlyphData glyph = glyphTable.getGlyph(gid);
         if (glyph != null)
         {
             return glyph.getPath();
