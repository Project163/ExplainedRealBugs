diff --git a/pdfbox/src/main/java/org/apache/pdfbox/cos/COSArray.java b/pdfbox/src/main/java/org/apache/pdfbox/cos/COSArray.java
index 4774d73572..2c649abfcc 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/cos/COSArray.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/cos/COSArray.java
@@ -780,6 +780,7 @@ public class COSArray extends COSBase implements Iterable<COSBase>, COSUpdateInf
             }
             if (cosBase instanceof COSObject)
             {
+                indirectObjects.add(cosBaseKey);
                 // dereference object
                 COSBase referencedObject = ((COSObject) cosBase).getObject();
                 if (referencedObject instanceof COSDictionary)
diff --git a/pdfbox/src/main/java/org/apache/pdfbox/cos/COSDictionary.java b/pdfbox/src/main/java/org/apache/pdfbox/cos/COSDictionary.java
index 5f005c79df..35f53cf39f 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/cos/COSDictionary.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/cos/COSDictionary.java
@@ -1461,6 +1461,7 @@ public class COSDictionary extends COSBase implements COSUpdateInfo
             }
             if (cosBase instanceof COSObject)
             {
+                indirectObjects.add(cosBaseKey);
                 // dereference object
                 COSBase referencedObject = ((COSObject) cosBase).getObject();
                 if (referencedObject instanceof COSDictionary)
