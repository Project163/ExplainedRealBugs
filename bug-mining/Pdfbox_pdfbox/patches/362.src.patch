diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/BaseParser.java b/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/BaseParser.java
index b772501aa7..0130d7111e 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/BaseParser.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/BaseParser.java
@@ -47,7 +47,7 @@ import org.apache.pdfbox.persistence.util.COSObjectKey;
  * PDFParser and the COSStreamParser.
  *
  * @author <a href="mailto:ben@benlitchfield.com">Ben Litchfield</a>
- * @version $Revision: 1.61 $
+ * 
  */
 public abstract class BaseParser
 {
@@ -371,6 +371,7 @@ public abstract class BaseParser
                 }
                 else
                 {
+                    value.setDirect(true);
                     obj.setItem( key, value );
                 }
             }
diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdfwriter/COSWriter.java b/pdfbox/src/main/java/org/apache/pdfbox/pdfwriter/COSWriter.java
index c843a8c277..f17c0a3ca7 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdfwriter/COSWriter.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdfwriter/COSWriter.java
@@ -71,7 +71,7 @@ import org.apache.pdfbox.util.StringUtil;
  *
  * @author Michael Traut
  * @author <a href="mailto:ben@benlitchfield.com">Ben Litchfield</a>
- * @version $Revision: 1.36 $
+ * 
  */
 public class COSWriter implements ICOSVisitor
 {
@@ -1054,7 +1054,15 @@ public class COSWriter implements ICOSVisitor
                         }
                         else
                         {
-                            subValue.accept( this );
+                            if (subValue.isDirect())
+                            {
+                                subValue.accept( this );                                
+                            } 
+                            else 
+                            {
+                                addObjectToWrite( subValue );
+                                writeReference( subValue );                                                  
+                            }
                         }
                     }
                     else
