diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
index 0d7fc6da18..d0f5643771 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -177,11 +177,21 @@ public final class StandardSecurityHandler extends SecurityHandler<StandardProte
                 {
                     dicLength = 128 / 8;
                     setAES(true);
+                    if (stdCryptFilterDictionary.getCOSObject().containsKey(COSName.LENGTH))
+                    {
+                        // PDFBOX-5345
+                        dicLength = stdCryptFilterDictionary.getLength();
+                    }
                 }
                 if (COSName.AESV3.equals(cryptFilterMethod))
                 {
                     dicLength = 256 / 8;
                     setAES(true);
+                    if (stdCryptFilterDictionary.getCOSObject().containsKey(COSName.LENGTH))
+                    {
+                        // PDFBOX-5345
+                        dicLength = stdCryptFilterDictionary.getLength();
+                    }
                 }
             }
         }
