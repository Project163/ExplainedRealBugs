diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/interactive/form/PDButton.java b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/interactive/form/PDButton.java
index 3e5b4b4bdf..738f81d7ae 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/interactive/form/PDButton.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/interactive/form/PDButton.java
@@ -375,22 +375,28 @@ public abstract class PDButton extends PDTerminalField
             throw new IllegalArgumentException("The number of options doesn't match the number of widgets");
         }
         
-        // the value is the index of the matching option
-        int optionsIndex = options.indexOf(value);
-        getCOSObject().setName(COSName.V, String.valueOf(optionsIndex));
-
-        
-        // update the appearance state (AS)
-        for (int i = 0; i < widgets.size(); i++)
+        if (value.equals(COSName.Off.getName()))
         {
-            PDAnnotationWidget widget = widgets.get(i);
-            if (value.compareTo(options.get(i)) == 0)
-            {
-                widget.getCOSObject().setName(COSName.AS, String.valueOf(i));
-            }
-            else 
+            updateByValue(value);
+        }
+        else
+        {     
+            // the value is the index of the matching option
+            int optionsIndex = options.indexOf(value);
+            getCOSObject().setName(COSName.V, String.valueOf(optionsIndex));    
+            
+            // update the appearance state (AS)
+            for (int i = 0; i < widgets.size(); i++)
             {
-                widget.getCOSObject().setItem(COSName.AS, COSName.Off);
+                PDAnnotationWidget widget = widgets.get(i);
+                if (value.compareTo(options.get(i)) == 0)
+                {
+                    widget.getCOSObject().setName(COSName.AS, String.valueOf(i));
+                }
+                else 
+                {
+                    widget.getCOSObject().setItem(COSName.AS, COSName.Off);
+                }
             }
         }
     }
diff --git a/pdfbox/src/test/java/org/apache/pdfbox/pdmodel/interactive/form/PDButtonTest.java b/pdfbox/src/test/java/org/apache/pdfbox/pdmodel/interactive/form/PDButtonTest.java
index 3d6982d701..58425174e0 100644
--- a/pdfbox/src/test/java/org/apache/pdfbox/pdmodel/interactive/form/PDButtonTest.java
+++ b/pdfbox/src/test/java/org/apache/pdfbox/pdmodel/interactive/form/PDButtonTest.java
@@ -20,16 +20,22 @@ import static org.junit.Assert.assertEquals;
 import static org.junit.Assert.assertFalse;
 import static org.junit.Assert.assertNotNull;
 import static org.junit.Assert.assertTrue;
+import static org.junit.Assert.fail;
 
 import java.io.File;
 import java.io.IOException;
+import java.io.InputStream;
+import java.net.URL;
 
 import org.apache.pdfbox.cos.COSName;
 import org.apache.pdfbox.pdmodel.PDDocument;
+import org.apache.pdfbox.pdmodel.interactive.annotation.PDAnnotationWidget;
+
 import org.junit.After;
 import org.junit.Before;
 import org.junit.Test;
 
+
 /**
  * Test for the PDButton class.
  *
@@ -90,6 +96,56 @@ public class PDButtonTest
         assertTrue(buttonField.isRadioButton());
         assertFalse(buttonField.isPushButton());
     }
+    
+    @Test
+    /**
+     * PDFBOX-3656
+     * 
+     * Test a radio button with options.
+     * This was causing an ArrayIndexOutOfBoundsException when trying to set to "Off", as this
+     * wasn't treated to be a valid option.
+     * 
+     * @throws IOException
+     */
+    public void testRadioButtonWithOptions()
+    {
+        URL url;
+        PDDocument pdfDocument = null;
+        
+        try
+        {
+            url = new URL("https://issues.apache.org/jira/secure/attachment/12848122/SF1199AEG%20%28Complete%29.pdf");
+            InputStream is = url.openStream();
+            
+            pdfDocument = PDDocument.load(is);
+            
+            PDRadioButton radioButton = (PDRadioButton) pdfDocument.getDocumentCatalog().getAcroForm().getField("Checking/Savings");
+            radioButton.setValue("Off");
+            for (PDAnnotationWidget widget : radioButton.getWidgets())
+            {
+                assertEquals("The widget should be set to Off", COSName.Off, widget.getCOSObject().getItem(COSName.AS));
+            }
+            
+        }
+        catch (IOException e)
+        {
+            fail("Unexpected IOException " + e.getMessage());
+        }
+        finally
+        {
+            if (pdfDocument != null)
+            {
+                try
+                {
+                    pdfDocument.close();
+                }
+                catch (IOException e)
+                {
+                    e.printStackTrace();
+                }
+            }
+        }
+    }
         
     @Test
     public void retrieveAcrobatCheckBoxProperties() throws IOException
