diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/BruteForceParser.java b/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/BruteForceParser.java
index 163ed1c115..e1c28fd37f 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/BruteForceParser.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/BruteForceParser.java
@@ -807,7 +807,7 @@ public class BruteForceParser extends COSParser
         trailerResolver.reset();
         // use the found objects to rebuild the trailer resolver
         trailerResolver.nextXrefObj(0, XRefType.TABLE);
-        bfSearchCOSObjectKeyOffsets.forEach(xrefTrailerResolver::setXRef);
+        bfSearchCOSObjectKeyOffsets.forEach(trailerResolver::setXRef);
         trailerResolver.setStartxref(0);
         COSDictionary trailer = trailerResolver.getTrailer();
         document.setTrailer(trailer);
diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/COSParser.java b/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/COSParser.java
index ce8e38be34..eb8a4bac30 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/COSParser.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/COSParser.java
@@ -251,8 +251,15 @@ public class COSParser extends BaseParser implements ICOSParser
         }
         if (rebuildTrailer)
         {
-            trailer = getBruteForceParser().rebuildTrailer(xrefTrailerResolver, securityHandler);
+            trailer = getBruteForceParser().rebuildTrailer(xrefTrailerResolver, null);
             trailerWasRebuild = true;
+            // transfer encryption information from BruteForceParser
+            encryption = getBruteForceParser().getEncryption();
+            if (encryption != null)
+            {
+                securityHandler = encryption.getSecurityHandler();
+                accessPermission = securityHandler.getCurrentAccessPermission();
+            }
         }
         else
         {
