diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/COSParser.java b/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/COSParser.java
index 0dfc21c829..b39591d119 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/COSParser.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/COSParser.java
@@ -50,6 +50,7 @@ import org.apache.pdfbox.pdmodel.encryption.AccessPermission;
 import org.apache.pdfbox.pdmodel.encryption.DecryptionMaterial;
 import org.apache.pdfbox.pdmodel.encryption.InvalidPasswordException;
 import org.apache.pdfbox.pdmodel.encryption.PDEncryption;
+import org.apache.pdfbox.pdmodel.encryption.ProtectionPolicy;
 import org.apache.pdfbox.pdmodel.encryption.PublicKeyDecryptionMaterial;
 import org.apache.pdfbox.pdmodel.encryption.SecurityHandler;
 import org.apache.pdfbox.pdmodel.encryption.StandardDecryptionMaterial;
@@ -142,7 +143,7 @@ public class COSParser extends BaseParser implements ICOSParser
     /**
      * The security handler.
      */
-    protected SecurityHandler securityHandler = null;
+    protected SecurityHandler<? extends ProtectionPolicy> securityHandler = null;
 
     /**
      *  how many trailing bytes to read for EOF marker.
diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdfwriter/COSWriter.java b/pdfbox/src/main/java/org/apache/pdfbox/pdfwriter/COSWriter.java
index 29d58918fa..f6da43010e 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdfwriter/COSWriter.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdfwriter/COSWriter.java
@@ -62,6 +62,7 @@ import org.apache.pdfbox.io.RandomAccessInputStream;
 import org.apache.pdfbox.io.RandomAccessRead;
 import org.apache.pdfbox.pdfparser.PDFXRefStream;
 import org.apache.pdfbox.pdmodel.PDDocument;
+import org.apache.pdfbox.pdmodel.encryption.ProtectionPolicy;
 import org.apache.pdfbox.pdmodel.encryption.SecurityHandler;
 import org.apache.pdfbox.pdmodel.fdf.FDFDocument;
 import org.apache.pdfbox.pdmodel.interactive.digitalsignature.COSFilterInputStream;
@@ -1342,7 +1343,8 @@ public class COSWriter implements ICOSVisitor, Closeable
             {
                 if (!incrementalUpdate)
                 {
-                    SecurityHandler securityHandler = pdDocument.getEncryption().getSecurityHandler();
+                    SecurityHandler<? extends ProtectionPolicy> securityHandler =
+                            pdDocument.getEncryption().getSecurityHandler();
                     if (!securityHandler.hasProtectionPolicy())
                     {
                         throw new IllegalStateException("PDF contains an encryption dictionary, please remove it with "
diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDDocument.java b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDDocument.java
index debe9b7ebc..53941e9596 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDDocument.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDDocument.java
@@ -1166,7 +1166,8 @@ public class PDDocument implements Closeable
             encryption = new PDEncryption();
         }
 
-        SecurityHandler securityHandler = SecurityHandlerFactory.INSTANCE.newSecurityHandlerForPolicy(policy);
+        SecurityHandler<? extends ProtectionPolicy> securityHandler =
+                SecurityHandlerFactory.INSTANCE.newSecurityHandlerForPolicy(policy);
         if (securityHandler == null)
         {
             throw new IOException("No security handler for policy " + policy);
diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/PDEncryption.java b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/PDEncryption.java
index 3679933d46..90ab560c3d 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/PDEncryption.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/PDEncryption.java
@@ -77,7 +77,7 @@ public class PDEncryption implements COSObjectable
     public static final int DEFAULT_VERSION = VERSION0_UNDOCUMENTED_UNSUPPORTED;
 
     private final COSDictionary dictionary;
-    private SecurityHandler securityHandler;
+    private SecurityHandler<? extends ProtectionPolicy> securityHandler;
 
     /**
      * creates a new empty encryption dictionary.
@@ -102,7 +102,7 @@ public class PDEncryption implements COSObjectable
      * @return a security handler instance
      * @throws IOException if there is no security handler available which matches the Filter
      */
-    public SecurityHandler getSecurityHandler() throws IOException
+    public SecurityHandler<? extends ProtectionPolicy> getSecurityHandler() throws IOException
     {
         if (securityHandler == null)
         {
@@ -115,7 +115,7 @@ public class PDEncryption implements COSObjectable
      * Sets the security handler used in this encryption dictionary
      * @param securityHandler new security handler
      */
-    public void setSecurityHandler(SecurityHandler securityHandler)
+    public void setSecurityHandler(SecurityHandler<? extends ProtectionPolicy> securityHandler)
     {
         this.securityHandler = securityHandler;
         // TODO set Filter (currently this is done by the security handlers)
diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/SecurityHandlerFactory.java b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/SecurityHandlerFactory.java
index 5a38a9afd2..f1367ecf56 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/SecurityHandlerFactory.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/SecurityHandlerFactory.java
@@ -81,7 +81,7 @@ public final class SecurityHandlerFactory
      * @param policy the protection policy for which to create a security handler
      * @return a new SecurityHandler instance, or null if none is available
      */
-    public SecurityHandler newSecurityHandlerForPolicy(ProtectionPolicy policy)
+    public SecurityHandler<? extends ProtectionPolicy> newSecurityHandlerForPolicy(ProtectionPolicy policy)
     {
         Class<? extends SecurityHandler> handlerClass = policyToHandler.get(policy.getClass());
         if (handlerClass == null)
@@ -99,7 +99,7 @@ public final class SecurityHandlerFactory
      * @param name the Filter name from the PDF encryption dictionary
      * @return a new SecurityHandler instance, or null if none is available
      */
-    public SecurityHandler newSecurityHandlerForFilter(String name)
+    public SecurityHandler<? extends ProtectionPolicy> newSecurityHandlerForFilter(String name)
     {
         Class<? extends SecurityHandler> handlerClass = nameToHandler.get(name);
         if (handlerClass == null)
@@ -119,7 +119,7 @@ public final class SecurityHandlerFactory
      * @param args array of objects to be passed as arguments to the constructor call.
      * @return a new SecurityHandler instance, or null if none is available.
      */
-    private SecurityHandler newSecurityHandler(Class<? extends SecurityHandler> handlerClass, 
+    private SecurityHandler<? extends ProtectionPolicy> newSecurityHandler(Class<? extends SecurityHandler> handlerClass, 
             Class<?>[] argsClasses, Object[] args)
     {
         try
