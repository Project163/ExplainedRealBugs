diff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/optionalcontent/PDOptionalContentProperties.java b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/optionalcontent/PDOptionalContentProperties.java
index bb62f56bad..48846c8736 100644
--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/optionalcontent/PDOptionalContentProperties.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/graphics/optionalcontent/PDOptionalContentProperties.java
@@ -149,6 +149,10 @@ public class PDOptionalContentProperties implements COSObjectable
         for (COSBase o : ocgs)
         {
             COSDictionary ocg = toDictionary(o);
+            if (ocg == null)
+            {
+                continue;
+            }
             String groupName = ocg.getString(COSName.NAME);
             if (groupName.equals(name))
             {
@@ -268,6 +272,10 @@ public class PDOptionalContentProperties implements COSObjectable
         for (COSBase o : ocgs)
         {
             COSDictionary ocg = toDictionary(o);
+            if (ocg == null)
+            {
+                continue;
+            }
             String name = ocg.getString(COSName.NAME);
             if (groupName.equals(name) && isGroupEnabled(new PDOptionalContentGroup(ocg)))
             {
@@ -328,14 +336,20 @@ public class PDOptionalContentProperties implements COSObjectable
 
     private COSDictionary toDictionary(COSBase o)
     {
+        COSBase base;
         if (o instanceof COSObject)
         {
-            return (COSDictionary)((COSObject)o).getObject();
+            base = ((COSObject) o).getObject();
         }
         else
         {
-            return (COSDictionary)o;
+            base = o;
         }
+        if (base instanceof COSDictionary)
+        {
+            return (COSDictionary) base;
+        }
+        return null;
     }
 
     /**
@@ -353,6 +367,10 @@ public class PDOptionalContentProperties implements COSObjectable
         for (COSBase o : ocgs)
         {
             COSDictionary ocg = toDictionary(o);
+            if (ocg == null)
+            {
+                continue;
+            }
             String name = ocg.getString(COSName.NAME);
             if (groupName.equals(name) && setGroupEnabled(new PDOptionalContentGroup(ocg), enable))
             {
