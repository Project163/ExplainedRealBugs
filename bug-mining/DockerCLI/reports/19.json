{"url":"https://api.github.com/repos/docker/cli/issues/3889","repository_url":"https://api.github.com/repos/docker/cli","labels_url":"https://api.github.com/repos/docker/cli/issues/3889/labels{/name}","comments_url":"https://api.github.com/repos/docker/cli/issues/3889/comments","events_url":"https://api.github.com/repos/docker/cli/issues/3889/events","html_url":"https://github.com/docker/cli/issues/3889","id":1467924757,"node_id":"I_kwDOBT74_c5XfsEV","number":3889,"title":"Bash completion slows down bash login sessions","user":{"login":"hoxu","id":43341,"node_id":"MDQ6VXNlcjQzMzQx","avatar_url":"https://avatars.githubusercontent.com/u/43341?v=4","gravatar_id":"","url":"https://api.github.com/users/hoxu","html_url":"https://github.com/hoxu","followers_url":"https://api.github.com/users/hoxu/followers","following_url":"https://api.github.com/users/hoxu/following{/other_user}","gists_url":"https://api.github.com/users/hoxu/gists{/gist_id}","starred_url":"https://api.github.com/users/hoxu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hoxu/subscriptions","organizations_url":"https://api.github.com/users/hoxu/orgs","repos_url":"https://api.github.com/users/hoxu/repos","events_url":"https://api.github.com/users/hoxu/events{/privacy}","received_events_url":"https://api.github.com/users/hoxu/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":1013603055,"node_id":"MDU6TGFiZWwxMDEzNjAzMDU1","url":"https://api.github.com/repos/docker/cli/labels/area/completion","name":"area/completion","color":"fef2c0","default":false,"description":""},{"id":4283348835,"node_id":"LA_kwDOBT74_c7_Trdj","url":"https://api.github.com/repos/docker/cli/labels/area/performance","name":"area/performance","color":"fef2c0","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":8,"created_at":"2022-11-29T10:10:14Z","updated_at":"2025-04-24T00:38:59Z","closed_at":"2025-04-24T00:38:58Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"  - [x] I have tried with the latest version of Docker Desktop\r\n  - [x] I have tried disabling enabled experimental features\r\n  - [ ] I have uploaded Diagnostics\r\n  - Diagnostics ID:\r\n\r\n### Expected behavior\r\n\r\n`bash_completion.d/docker` should be fast to execute. It probably should not make any `docker` calls until actually needed.\r\n\r\n### Actual behavior\r\n\r\nExecuting the bash completion script causes a noticeable pause when opening new bash sessions.\r\n\r\nThe slowest part is a call to `docker`:\r\n```\r\n+++ [[ -r /usr/local/etc/bash_completion.d/docker ]]\r\n+++ . /usr/local/etc/bash_completion.d/docker\r\n+++++ shopt -p extglob\r\n++++ __docker_previous_extglob_setting='shopt -s extglob'\r\n++++ shopt -s extglob\r\n+++++ docker info --format '{{range .ClientInfo.Plugins}}{{if eq .Name \"compose\"}}{{.Path}}{{end}}{{end}}'\r\n```\r\n\r\nThis seems to be:\r\n\r\n```\r\nCOMPOSE_PLUGIN_PATH=$(docker info --format '{{range .ClientInfo.Plugins}}{{if eq .Name \"compose\"}}{{.Path}}{{end}}{{end}}')\r\n```\r\n\r\n```\r\n$ time docker info --format '{{range .ClientInfo.Plugins}}{{if eq .Name \"compose\"}}{{.Path}}{{end}}{{end}}'\r\n/usr/local/lib/docker/cli-plugins/docker-compose\r\n\r\nreal    0m2.538s\r\nuser    0m0.142s\r\nsys     0m0.085s\r\n```\r\n\r\n### Information\r\n  - macOS Version:\r\n  - Intel chip or Apple chip:\r\n  - Docker Desktop Version: 4.14.1 (91661)\r\n\r\n### Output of `/Applications/Docker.app/Contents/MacOS/com.docker.diagnose check`\r\n\r\nN/A\r\n\r\n### Steps to reproduce the behavior\r\n\r\nOpen a new bash login session.\r\n\r\nTo visually see what is taking up time:\r\n\r\n```\r\nbash -lx\r\n```","closed_by":{"login":"thaJeztah","id":1804568,"node_id":"MDQ6VXNlcjE4MDQ1Njg=","avatar_url":"https://avatars.githubusercontent.com/u/1804568?v=4","gravatar_id":"","url":"https://api.github.com/users/thaJeztah","html_url":"https://github.com/thaJeztah","followers_url":"https://api.github.com/users/thaJeztah/followers","following_url":"https://api.github.com/users/thaJeztah/following{/other_user}","gists_url":"https://api.github.com/users/thaJeztah/gists{/gist_id}","starred_url":"https://api.github.com/users/thaJeztah/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/thaJeztah/subscriptions","organizations_url":"https://api.github.com/users/thaJeztah/orgs","repos_url":"https://api.github.com/users/thaJeztah/repos","events_url":"https://api.github.com/users/thaJeztah/events{/privacy}","received_events_url":"https://api.github.com/users/thaJeztah/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/docker/cli/issues/3889/reactions","total_count":3,"+1":3,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/docker/cli/issues/3889/timeline","performed_via_github_app":null,"state_reason":"completed"}