{"url":"https://api.github.com/repos/docker/cli/issues/1113","repository_url":"https://api.github.com/repos/docker/cli","labels_url":"https://api.github.com/repos/docker/cli/issues/1113/labels{/name}","comments_url":"https://api.github.com/repos/docker/cli/issues/1113/comments","events_url":"https://api.github.com/repos/docker/cli/issues/1113/events","html_url":"https://github.com/docker/cli/issues/1113","id":329863960,"node_id":"MDU6SXNzdWUzMjk4NjM5NjA=","number":1113,"title":"Segfault on --help with --tlsverify if no ca certificate is present","user":{"login":"pvanagtmaal","id":5946464,"node_id":"MDQ6VXNlcjU5NDY0NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/5946464?v=4","gravatar_id":"","url":"https://api.github.com/users/pvanagtmaal","html_url":"https://github.com/pvanagtmaal","followers_url":"https://api.github.com/users/pvanagtmaal/followers","following_url":"https://api.github.com/users/pvanagtmaal/following{/other_user}","gists_url":"https://api.github.com/users/pvanagtmaal/gists{/gist_id}","starred_url":"https://api.github.com/users/pvanagtmaal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvanagtmaal/subscriptions","organizations_url":"https://api.github.com/users/pvanagtmaal/orgs","repos_url":"https://api.github.com/users/pvanagtmaal/repos","events_url":"https://api.github.com/users/pvanagtmaal/events{/privacy}","received_events_url":"https://api.github.com/users/pvanagtmaal/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":585916035,"node_id":"MDU6TGFiZWw1ODU5MTYwMzU=","url":"https://api.github.com/repos/docker/cli/labels/kind/bug","name":"kind/bug","color":"FF8C94","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2018-06-06T13:18:47Z","updated_at":"2018-06-08T15:05:22Z","closed_at":"2018-06-08T15:05:22Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"BUG REPORT INFORMATION\r\n---------------------------------------------------\r\n\r\n**Description**\r\n\r\nDocker segfaults when trying to list view the helptext (`--help`) when using tls verification without a CA certificate.\r\n\r\n**Steps to reproduce the issue:**\r\n1. Make sure there is no ca.pem in `$HOME/.docker/`\r\n2. Execute `docker --tlsverify --help`\r\n\r\n**Describe the results you received:**\r\n\r\n```docker --tlsverify --help\r\npanic: runtime error: invalid memory address or nil pointer dereference\r\n[signal SIGSEGV: segmentation violation code=0x1 addr=0x60 pc=0x8d8605]\r\n\r\ngoroutine 1 [running]:\r\ngithub.com/docker/cli/vendor/github.com/docker/docker/client.(*Client).ClientVersion(0x0, 0x2507800, 0x0)\r\n\t/go/src/github.com/docker/cli/vendor/github.com/docker/docker/client/client.go:321 +0x5\r\nmain.areSubcommandsSupported(0xc42058a240, 0x24dc060, 0xc420101b80, 0x24ca720, 0xc4204b9440)\r\n\t/go/src/github.com/docker/cli/cmd/docker/docker.go:309 +0x60\r\nmain.isSupported(0xc42058a240, 0x24dc060, 0xc420101b80, 0x7ffe6135d7d0, 0x24ba280)\r\n\t/go/src/github.com/docker/cli/cmd/docker/docker.go:260 +0x43\r\nmain.setHelpFunc.func1(0xc42058a240, 0xc4200100a0, 0x2, 0x2)\r\n\t/go/src/github.com/docker/cli/cmd/docker/docker.go:90 +0x72\r\ngithub.com/docker/cli/vendor/github.com/spf13/cobra.(*Command).ExecuteC(0xc42058a240, 0xc420455470, 0xc420455410, 0xc42000e200)\r\n\t/go/src/github.com/docker/cli/vendor/github.com/spf13/cobra/command.go:790 +0x5bb\r\ngithub.com/docker/cli/vendor/github.com/spf13/cobra.(*Command).Execute(0xc42058a240, 0xc42058a240, 0x24cef20)\r\n\t/go/src/github.com/docker/cli/vendor/github.com/spf13/cobra/command.go:738 +0x2b\r\nmain.main()\r\n\t/go/src/github.com/docker/cli/cmd/docker/docker.go:162 +0xd0\r\n```\r\n\r\n**Describe the results you expected:**\r\nThe same warning you get when executing for example `docker --tlsverify info` without a ca.pem in `$HOME/.docker/`: `could not read CA certificate \"$HOME/.docker/ca.pem\": open $HOME/.docker/ca.pem: no such file or directory`\r\n\r\n**Additional information you deem important (e.g. issue happens only occasionally):**\r\nTested on both Arch Linux and Debian Stretch\r\n\r\n**Output of `docker version`:**\r\nArch Linux:\r\n\r\n```\r\nClient:\r\n Version:      18.05.0-ce\r\n API version:  1.37\r\n Go version:   go1.10.2\r\n Git commit:   f150324782\r\n Built:        Wed May 16 22:27:45 2018\r\n OS/Arch:      linux/amd64\r\n Experimental: false\r\n Orchestrator: swarm\r\n\r\nServer:\r\n Engine:\r\n  Version:      18.05.0-ce\r\n  API version:  1.37 (minimum version 1.12)\r\n  Go version:   go1.10.2\r\n  Git commit:   f150324782\r\n  Built:        Wed May 16 22:28:17 2018\r\n  OS/Arch:      linux/amd64\r\n  Experimental: false\r\n\r\n```\r\n\r\nDebian Stretch:\r\n\r\n```\r\nClient:\r\n Version:      18.03.1-ce\r\n API version:  1.37\r\n Go version:   go1.9.5\r\n Git commit:   9ee9f40\r\n Built:        Thu Apr 26 07:17:14 2018\r\n OS/Arch:      linux/amd64\r\n Experimental: false\r\n Orchestrator: swarm\r\n\r\nServer:\r\n Engine:\r\n  Version:      18.03.1-ce\r\n  API version:  1.37 (minimum version 1.12)\r\n  Go version:   go1.9.5\r\n  Git commit:   9ee9f40\r\n  Built:        Thu Apr 26 07:15:24 2018\r\n  OS/Arch:      linux/amd64\r\n  Experimental: false\r\n```\r\n\r\n**Output of `docker info`:**\r\n\r\nArch Linux:\r\n\r\n```\r\nContainers: 0\r\n Running: 0\r\n Paused: 0\r\n Stopped: 0\r\nImages: 33\r\nServer Version: 18.05.0-ce\r\nStorage Driver: overlay2\r\n Backing Filesystem: extfs\r\n Supports d_type: true\r\n Native Overlay Diff: false\r\nLogging Driver: json-file\r\nCgroup Driver: cgroupfs\r\nPlugins:\r\n Volume: local\r\n Network: bridge host macvlan null overlay\r\n Log: awslogs fluentd gcplogs gelf journald json-file logentries splunk syslog\r\nSwarm: inactive\r\nRuntimes: runc\r\nDefault Runtime: runc\r\nInit Binary: docker-init\r\ncontainerd version: 773c489c9c1b21a6d78b5c538cd395416ec50f88\r\nrunc version: 4fc53a81fb7c994640722ac585fa9ca548971871\r\ninit version: 949e6fa\r\nSecurity Options:\r\n seccomp\r\n  Profile: default\r\nKernel Version: 4.16.13-1-ARCH\r\nOperating System: Arch Linux\r\nOSType: linux\r\nArchitecture: x86_64\r\nCPUs: 4\r\nTotal Memory: 7.698GiB\r\nName: <left out>\r\nID: DHWN:5OLZ:O6NU:FBTD:3XTA:PI2N:E3ON:N4NT:AI2Z:BSSV:JJS3:ETLW\r\nDocker Root Dir: /var/lib/docker\r\nDebug Mode (client): false\r\nDebug Mode (server): false\r\nRegistry: https://index.docker.io/v1/\r\nLabels:\r\nExperimental: false\r\nInsecure Registries:\r\n 127.0.0.0/8\r\nLive Restore Enabled: false\r\n```\r\n\r\nDebian Stretch:\r\n\r\n```\r\nContainers: 0\r\n Running: 0\r\n Paused: 0\r\n Stopped: 0\r\nImages: 0\r\nServer Version: 18.03.1-ce\r\nStorage Driver: overlay2\r\n Backing Filesystem: extfs\r\n Supports d_type: true\r\n Native Overlay Diff: true\r\nLogging Driver: json-file\r\nCgroup Driver: cgroupfs\r\nPlugins:\r\n Volume: local\r\n Network: bridge host macvlan null overlay\r\n Log: awslogs fluentd gcplogs gelf journald json-file logentries splunk syslog\r\nSwarm: inactive\r\nRuntimes: runc\r\nDefault Runtime: runc\r\nInit Binary: docker-init\r\ncontainerd version: 773c489c9c1b21a6d78b5c538cd395416ec50f88\r\nrunc version: 4fc53a81fb7c994640722ac585fa9ca548971871\r\ninit version: 949e6fa\r\nSecurity Options:\r\n seccomp\r\n  Profile: default\r\nKernel Version: 4.9.0-6-amd64\r\nOperating System: Debian GNU/Linux 9 (stretch)\r\nOSType: linux\r\nArchitecture: x86_64\r\nCPUs: 1\r\nTotal Memory: 996.4MiB\r\nName: <left out>\r\nID: ABAF:EW3C:EAZP:LFMA:2KRF:4L2P:42U2:6TWF:ZN2D:NVQZ:SHVA:UH75\r\nDocker Root Dir: /var/lib/docker\r\nDebug Mode (client): false\r\nDebug Mode (server): false\r\nRegistry: https://index.docker.io/v1/\r\nLabels:\r\nExperimental: false\r\nInsecure Registries:\r\n 127.0.0.0/8\r\nLive Restore Enabled: false\r\n\r\nWARNING: No swap limit support\r\n```\r\n\r\n**Additional environment details (AWS, VirtualBox, physical, etc.):**\r\nArch Linux on a physical device\r\nDebian Stretch on a VPS\r\n","closed_by":{"login":"vdemeester","id":6508,"node_id":"MDQ6VXNlcjY1MDg=","avatar_url":"https://avatars.githubusercontent.com/u/6508?v=4","gravatar_id":"","url":"https://api.github.com/users/vdemeester","html_url":"https://github.com/vdemeester","followers_url":"https://api.github.com/users/vdemeester/followers","following_url":"https://api.github.com/users/vdemeester/following{/other_user}","gists_url":"https://api.github.com/users/vdemeester/gists{/gist_id}","starred_url":"https://api.github.com/users/vdemeester/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vdemeester/subscriptions","organizations_url":"https://api.github.com/users/vdemeester/orgs","repos_url":"https://api.github.com/users/vdemeester/repos","events_url":"https://api.github.com/users/vdemeester/events{/privacy}","received_events_url":"https://api.github.com/users/vdemeester/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/docker/cli/issues/1113/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/docker/cli/issues/1113/timeline","performed_via_github_app":null,"state_reason":"completed"}