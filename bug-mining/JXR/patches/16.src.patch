diff --git a/maven-jxr-plugin/pom.xml b/maven-jxr-plugin/pom.xml
index bbc3ede..8fea94f 100644
--- a/maven-jxr-plugin/pom.xml
+++ b/maven-jxr-plugin/pom.xml
@@ -47,12 +47,14 @@ under the License.
   </developers>
 
   <properties>
-    <mavenVersion>2.0.6</mavenVersion>
-    <sitePluginVersion>2.0.1</sitePluginVersion>
+    <mavenVersion>2.0.9</mavenVersion>
+    <sitePluginVersion>2.2</sitePluginVersion>
+    <doxia-sitetoolsVersion>1.2</doxia-sitetoolsVersion>
+    <doxiaVersion>1.2</doxiaVersion>
   </properties>
 
   <prerequisites>
-    <maven>2.0.6</maven>
+    <maven>${mavenVersion}</maven>
   </prerequisites>
 
   <distributionManagement>
@@ -62,23 +64,26 @@ under the License.
     </site>
   </distributionManagement>
 
-  <build> 
-    <pluginManagement>
-      <plugins>
-        <plugin>
-          <artifactId>maven-site-plugin</artifactId>
-          <configuration>
-            <stagingSiteURL>scp://people.apache.org/www/maven.apache.org/plugins/${project.artifactId}-${project.version}</stagingSiteURL>
-          </configuration>
-        </plugin>
-      </plugins>
-    </pluginManagement>
+  <build>
+ <pluginManagement>
+  <plugins>
+   <plugin>
+    <artifactId>maven-surefire-plugin</artifactId>
+    <configuration>
+     <forkMode>always</forkMode>
+    </configuration>
+   </plugin>
+   <plugin>
+    <artifactId>maven-site-plugin</artifactId>
+    <version>${sitePluginVersion}</version>
+   </plugin>
+  </plugins>
+ </pluginManagement>
 
     <plugins>
       <plugin>
         <groupId>org.apache.maven.plugins</groupId>
         <artifactId>maven-plugin-plugin</artifactId>
-        <version>2.6</version>
         <executions>
           <execution>
             <id>generated-helpmojo</id>
@@ -92,6 +97,11 @@ under the License.
   </build>
 
   <dependencies>
+    <dependency>
+      <groupId>org.apache.velocity</groupId>
+      <artifactId>velocity</artifactId>
+      <version>1.5</version>
+    </dependency>
     <dependency>
       <groupId>org.apache.maven</groupId>
       <artifactId>maven-jxr</artifactId>
@@ -124,9 +134,8 @@ under the License.
     <dependency>
       <groupId>org.apache.maven.reporting</groupId>
       <artifactId>maven-reporting-impl</artifactId>
-      <version>2.0.2</version>
+      <version>2.1</version>
     </dependency>
-
     <dependency>
       <groupId>org.apache.maven.wagon</groupId>
       <artifactId>wagon-provider-api</artifactId>
@@ -135,12 +144,17 @@ under the License.
     <dependency>
       <groupId>org.apache.maven.doxia</groupId>
       <artifactId>doxia-site-renderer</artifactId>
-      <version>1.0-alpha-7</version>
+      <version>${doxia-sitetoolsVersion}</version>
+    </dependency>
+    <dependency>
+      <groupId>org.apache.maven.doxia</groupId>
+      <artifactId>doxia-sink-api</artifactId>
+      <version>1.2</version>
     </dependency>
     <dependency>
       <groupId>org.codehaus.plexus</groupId>
       <artifactId>plexus-utils</artifactId>
-      <version>1.5.1</version>
+      <version>1.5.8</version>
     </dependency>
     <dependency>
       <groupId>xml-apis</groupId>
@@ -171,7 +185,6 @@ under the License.
       <plugin>
         <groupId>org.apache.maven.plugins</groupId>
         <artifactId>maven-plugin-plugin</artifactId>
-        <version>2.6</version>
       </plugin>
     </plugins>
   </reporting>
diff --git a/maven-jxr-plugin/src/main/java/org/apache/maven/plugin/jxr/AbstractJxrReport.java b/maven-jxr-plugin/src/main/java/org/apache/maven/plugin/jxr/AbstractJxrReport.java
index 608331e..23384e6 100644
--- a/maven-jxr-plugin/src/main/java/org/apache/maven/plugin/jxr/AbstractJxrReport.java
+++ b/maven-jxr-plugin/src/main/java/org/apache/maven/plugin/jxr/AbstractJxrReport.java
@@ -290,9 +290,16 @@ public abstract class AbstractJxrReport
         {
             jxr.setIncludes( (String[]) includes.toArray( new String[0] ) );
         }
-
-        jxr.xref( sourceDirs, templateDir, windowTitle, docTitle, getBottomText( project.getInceptionYear(), project
-            .getOrganization() ) );
+        
+        // avoid winding up using Velocity in two class loaders.
+        ClassLoader savedTccl = Thread.currentThread().getContextClassLoader();
+        try {
+            Thread.currentThread().setContextClassLoader( getClass().getClassLoader() );
+            jxr.xref( sourceDirs, templateDir, windowTitle, docTitle, getBottomText( project.getInceptionYear(), project
+                                                                                     .getOrganization() ) );
+        } finally {
+            Thread.currentThread().setContextClassLoader( savedTccl );
+        }
 
         // and finally copy the stylesheet
         copyRequiredResources( destinationDirectory );
diff --git a/maven-jxr/pom.xml b/maven-jxr/pom.xml
index 3e7a5a2..d8b7349 100644
--- a/maven-jxr/pom.xml
+++ b/maven-jxr/pom.xml
@@ -1,4 +1,5 @@
-<?xml version="1.0" encoding="UTF-8"?>
+<?Xmlb
+ version="1.0" encoding="UTF-8"?>
 
 <!--
 Licensed to the Apache Software Foundation (ASF) under one
@@ -108,25 +109,25 @@ under the License.
       <scope>test</scope>
     </dependency>
     <dependency>
-      <groupId>commons-collections</groupId>
-      <artifactId>commons-collections</artifactId>
-      <version>3.1</version>
-      <scope>runtime</scope>
+      <groupId>org.codehaus.plexus</groupId>
+      <artifactId>plexus-utils</artifactId>
+      <version>1.5.8</version>
     </dependency>
+
     <dependency>
-      <groupId>oro</groupId>
-      <artifactId>oro</artifactId>
-      <version>2.0.7</version>
+      <groupId>org.apache.velocity</groupId>
+      <artifactId>velocity</artifactId>
+      <version>1.5</version>
     </dependency>
     <dependency>
-      <groupId>org.codehaus.plexus</groupId>
-      <artifactId>plexus-utils</artifactId>
-      <version>1.5.1</version>
+    	<groupId>commons-io</groupId>
+    	<artifactId>commons-io</artifactId>
+    	<version>2.0.1</version>
     </dependency>
     <dependency>
-      <groupId>velocity</groupId>
-      <artifactId>velocity</artifactId>
-      <version>1.4</version>
+    	<groupId>commons-lang</groupId>
+    	<artifactId>commons-lang</artifactId>
+    	<version>2.6</version>
     </dependency>
   </dependencies>
 </project>
diff --git a/maven-jxr/src/main/java/org/apache/maven/jxr/DirectoryIndexer.java b/maven-jxr/src/main/java/org/apache/maven/jxr/DirectoryIndexer.java
index fb60acc..3dc5e60 100644
--- a/maven-jxr/src/main/java/org/apache/maven/jxr/DirectoryIndexer.java
+++ b/maven-jxr/src/main/java/org/apache/maven/jxr/DirectoryIndexer.java
@@ -19,6 +19,7 @@ package org.apache.maven.jxr;
  * under the License.
  */
 
+import org.apache.commons.io.IOUtils;
 import org.apache.maven.jxr.pacman.ClassType;
 import org.apache.maven.jxr.pacman.PackageManager;
 import org.apache.maven.jxr.pacman.PackageType;
@@ -28,7 +29,6 @@ import org.apache.oro.text.perl.Perl5Util;
 import org.apache.velocity.Template;
 import org.apache.velocity.VelocityContext;
 import org.apache.velocity.app.VelocityEngine;
-import org.codehaus.plexus.util.IOUtil;
 
 import java.io.File;
 import java.io.FileWriter;
@@ -317,7 +317,7 @@ public class DirectoryIndexer
         }
         finally
         {
-            IOUtil.close( writer );
+            IOUtils.closeQuietly( writer );
         }
     }
 
diff --git a/maven-jxr/src/main/java/org/apache/maven/jxr/JavaCodeTransform.java b/maven-jxr/src/main/java/org/apache/maven/jxr/JavaCodeTransform.java
index 64053e0..1c0b227 100644
--- a/maven-jxr/src/main/java/org/apache/maven/jxr/JavaCodeTransform.java
+++ b/maven-jxr/src/main/java/org/apache/maven/jxr/JavaCodeTransform.java
@@ -30,6 +30,7 @@ package org.apache.maven.jxr;
  * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
  */
 
+import org.apache.commons.lang.StringUtils;
 import org.apache.maven.jxr.pacman.ClassType;
 import org.apache.maven.jxr.pacman.FileManager;
 import org.apache.maven.jxr.pacman.ImportType;
@@ -38,7 +39,6 @@ import org.apache.maven.jxr.pacman.PackageManager;
 import org.apache.maven.jxr.pacman.PackageType;
 import org.apache.maven.jxr.util.SimpleWordTokenizer;
 import org.apache.maven.jxr.util.StringEntry;
-import org.codehaus.plexus.util.StringUtils;
 
 import java.io.BufferedReader;
 import java.io.File;
diff --git a/pom.xml b/pom.xml
index 9ecc0cc..66ad549 100644
--- a/pom.xml
+++ b/pom.xml
@@ -25,7 +25,7 @@ under the License.
   <parent>
     <groupId>org.apache.maven</groupId>
     <artifactId>maven-parent</artifactId>
-    <version>16</version>
+    <version>20</version>
     <relativePath>../pom/maven/pom.xml</relativePath>
   </parent>
 
@@ -55,6 +55,16 @@ under the License.
     <module>maven-jxr-plugin</module>
   </modules>
 
+  <dependencyManagement>
+    <dependencies>
+      <dependency>
+	<groupId>junit</groupId>
+	<artifactId>junit</artifactId>
+	<version>4.8.2</version>
+      </dependency>
+    </dependencies>
+  </dependencyManagement>
+
   <build>
     <pluginManagement>
       <plugins>
@@ -67,55 +77,4 @@ under the License.
       </plugins>
     </pluginManagement>
   </build>
-  
-  <dependencyManagement>
-    <dependencies>
-      <dependency>
-        <groupId>junit</groupId>
-        <artifactId>junit</artifactId>
-        <version>3.8.2</version>
-        <scope>test</scope>
-      </dependency>    
-    </dependencies>
-  </dependencyManagement>
-  
-  <profiles>
-    <profile>
-      <id>m2e</id>
-      <properties>
-        <m2BuildDirectory>target</m2BuildDirectory>
-      </properties>
-      <activation>
-        <property>
-          <name>m2e.version</name>
-        </property>
-      </activation>
-      <build>
-        <directory>${m2BuildDirectory}</directory>
-        <plugins>
-          <plugin>
-            <groupId>org.maven.ide.eclipse</groupId>
-            <artifactId>lifecycle-mapping</artifactId>
-            <version>0.10.0</version>
-            <configuration>
-              <mappingId>customizable</mappingId>
-              <configurators>
-                <configurator id="org.maven.ide.eclipse.jdt.javaConfigurator" />
-                <configurator id="org.maven.ide.eclipse.plexus.annotations.plexusConfigurator" />
-              </configurators>
-              <mojoExecutions>
-                <mojoExecution>org.apache.maven.plugins:maven-resources-plugin::</mojoExecution>
-              </mojoExecutions>
-            </configuration>
-          </plugin>
-          <plugin>
-            <groupId>org.apache.maven.plugins</groupId>
-            <artifactId>maven-resources-plugin</artifactId>
-            <version>2.4.3</version>
-          </plugin>
-        </plugins>
-      </build>
-    </profile>  
-  </profiles>  
-  
 </project>
