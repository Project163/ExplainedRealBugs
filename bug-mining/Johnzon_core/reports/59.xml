<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 20:01:54 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[JOHNZON-274] Out-of-path values get removed when removing one with same name&amp;level</title>
                <link>https://issues.apache.org/jira/browse/JOHNZON-274</link>
                <project id="12315523" key="JOHNZON">Johnzon</project>
                    <description>&lt;p&gt;Hi All,&lt;/p&gt;

&lt;p&gt;I&apos;m new to Apache and open-source projects in general. So please bear with me.&lt;/p&gt;

&lt;p&gt;This one looks like a bug:&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;JsonPatchTest {
...
    @Test
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void testReplacingObjectAttribute() {        JsonObject object = Json.createObjectBuilder()
                .add(&lt;span class=&quot;code-quote&quot;&gt;&quot;foo&quot;&lt;/span&gt;, Json.createObjectBuilder()
                    .add(&lt;span class=&quot;code-quote&quot;&gt;&quot;baz&quot;&lt;/span&gt;, &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; JsonStringImpl(&lt;span class=&quot;code-quote&quot;&gt;&quot;1&quot;&lt;/span&gt;)))
                .add(&lt;span class=&quot;code-quote&quot;&gt;&quot;bar&quot;&lt;/span&gt;, Json.createObjectBuilder()
                    .add(&lt;span class=&quot;code-quote&quot;&gt;&quot;baz&quot;&lt;/span&gt;, &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; JsonStringImpl(&lt;span class=&quot;code-quote&quot;&gt;&quot;2&quot;&lt;/span&gt;)))
                .build();        JsonPatchImpl patch = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; JsonPatchImpl(PROVIDER, &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; JsonPatchImpl.PatchValue(PROVIDER, JsonPatch.Operation.REPLACE,
                                                                             &lt;span class=&quot;code-quote&quot;&gt;&quot;/bar/baz&quot;&lt;/span&gt;,
                                                                             &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;,
                                                                             &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; JsonStringImpl(&lt;span class=&quot;code-quote&quot;&gt;&quot;3&quot;&lt;/span&gt;)));        JsonObject patched = patch.apply(object);
        assertNotNull(patched);
        assertNotSame(object, patched);        JsonObject o = patched.getJsonObject(&lt;span class=&quot;code-quote&quot;&gt;&quot;foo&quot;&lt;/span&gt;);
        assertNotNull(o);
        assertEquals(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; JsonStringImpl(&lt;span class=&quot;code-quote&quot;&gt;&quot;1&quot;&lt;/span&gt;), o.getJsonString(&lt;span class=&quot;code-quote&quot;&gt;&quot;baz&quot;&lt;/span&gt;));
        o = patched.getJsonObject(&lt;span class=&quot;code-quote&quot;&gt;&quot;bar&quot;&lt;/span&gt;);
        assertNotNull(o);
        assertEquals(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; JsonStringImpl(&lt;span class=&quot;code-quote&quot;&gt;&quot;3&quot;&lt;/span&gt;), o.getJsonString(&lt;span class=&quot;code-quote&quot;&gt;&quot;baz&quot;&lt;/span&gt;)); &lt;span class=&quot;code-comment&quot;&gt;// fails here        assertEquals(&lt;span class=&quot;code-quote&quot;&gt;&quot;{\&quot;&lt;/span&gt;foo\&lt;span class=&quot;code-quote&quot;&gt;&quot;:{\&quot;&lt;/span&gt;baz\&lt;span class=&quot;code-quote&quot;&gt;&quot;:\&quot;&lt;/span&gt;1\&lt;span class=&quot;code-quote&quot;&gt;&quot;},\&quot;&lt;/span&gt;bar\&lt;span class=&quot;code-quote&quot;&gt;&quot;:{\&quot;&lt;/span&gt;baz\&lt;span class=&quot;code-quote&quot;&gt;&quot;:\&quot;&lt;/span&gt;3\&lt;span class=&quot;code-quote&quot;&gt;&quot;}}&quot;&lt;/span&gt;, toJsonString(patched));
&lt;/span&gt;    }    @Test
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void testReplacingArrayElementAttribute() {        JsonObject object = Json.createObjectBuilder()
                .add(&lt;span class=&quot;code-quote&quot;&gt;&quot;foo&quot;&lt;/span&gt;, Json.createArrayBuilder()
                    .add(Json.createObjectBuilder().add(&lt;span class=&quot;code-quote&quot;&gt;&quot;bar&quot;&lt;/span&gt;, &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; JsonStringImpl(&lt;span class=&quot;code-quote&quot;&gt;&quot;1&quot;&lt;/span&gt;)))
                    .add(Json.createObjectBuilder().add(&lt;span class=&quot;code-quote&quot;&gt;&quot;bar&quot;&lt;/span&gt;, &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; JsonStringImpl(&lt;span class=&quot;code-quote&quot;&gt;&quot;2&quot;&lt;/span&gt;))))
                                .build();        JsonPatchImpl patch = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; JsonPatchImpl(PROVIDER, &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; JsonPatchImpl.PatchValue(PROVIDER, JsonPatch.Operation.REPLACE,
                                                                             &lt;span class=&quot;code-quote&quot;&gt;&quot;/foo/1/bar&quot;&lt;/span&gt;,
                                                                             &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;,
                                                                             &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; JsonStringImpl(&lt;span class=&quot;code-quote&quot;&gt;&quot;3&quot;&lt;/span&gt;)));        JsonObject patched = patch.apply(object);
        assertNotNull(patched);
        assertNotSame(object, patched);        JsonArray array = patched.getJsonArray(&lt;span class=&quot;code-quote&quot;&gt;&quot;foo&quot;&lt;/span&gt;);
        assertNotNull(array);
        assertNotSame(object.getJsonArray(&lt;span class=&quot;code-quote&quot;&gt;&quot;foo&quot;&lt;/span&gt;), array);
        assertEquals(2, array.size());
        assertEquals(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; JsonStringImpl(&lt;span class=&quot;code-quote&quot;&gt;&quot;3&quot;&lt;/span&gt;), array.getJsonObject(1).getJsonString(&lt;span class=&quot;code-quote&quot;&gt;&quot;bar&quot;&lt;/span&gt;));
        assertEquals(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; JsonStringImpl(&lt;span class=&quot;code-quote&quot;&gt;&quot;1&quot;&lt;/span&gt;), array.getJsonObject(0).getJsonString(&lt;span class=&quot;code-quote&quot;&gt;&quot;bar&quot;&lt;/span&gt;)); &lt;span class=&quot;code-comment&quot;&gt;// fails here        assertEquals(&lt;span class=&quot;code-quote&quot;&gt;&quot;{\&quot;&lt;/span&gt;foo\&lt;span class=&quot;code-quote&quot;&gt;&quot;:[{\&quot;&lt;/span&gt;bar\&lt;span class=&quot;code-quote&quot;&gt;&quot;:\&quot;&lt;/span&gt;1\&lt;span class=&quot;code-quote&quot;&gt;&quot;},{\&quot;&lt;/span&gt;bar\&lt;span class=&quot;code-quote&quot;&gt;&quot;:\&quot;&lt;/span&gt;3\&lt;span class=&quot;code-quote&quot;&gt;&quot;}]}&quot;&lt;/span&gt;, toJsonString(patched));
&lt;/span&gt;    }
...
}&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Basically I&apos;m trying to do this:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
{ &lt;span class=&quot;code-quote&quot;&gt;&quot;action&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;replace&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;path&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;/bar/baz&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;value&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;3&quot;&lt;/span&gt;}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;to this:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
{&lt;span class=&quot;code-quote&quot;&gt;&quot;foo&quot;&lt;/span&gt;:{&lt;span class=&quot;code-quote&quot;&gt;&quot;baz&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;1&quot;&lt;/span&gt;},&lt;span class=&quot;code-quote&quot;&gt;&quot;bar&quot;&lt;/span&gt;:{&lt;span class=&quot;code-quote&quot;&gt;&quot;baz&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;2&quot;&lt;/span&gt;}}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;and I get&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
{&lt;span class=&quot;code-quote&quot;&gt;&quot;foo&quot;&lt;/span&gt;:{&lt;span class=&quot;code-quote&quot;&gt;&quot;baz&quot;&lt;/span&gt;:&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;},&lt;span class=&quot;code-quote&quot;&gt;&quot;bar&quot;&lt;/span&gt;:{&lt;span class=&quot;code-quote&quot;&gt;&quot;baz&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;3&quot;&lt;/span&gt;}}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;instead of&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
{&lt;span class=&quot;code-quote&quot;&gt;&quot;foo&quot;&lt;/span&gt;:{&lt;span class=&quot;code-quote&quot;&gt;&quot;baz&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;1&quot;&lt;/span&gt;},&lt;span class=&quot;code-quote&quot;&gt;&quot;bar&quot;&lt;/span&gt;:{&lt;span class=&quot;code-quote&quot;&gt;&quot;baz&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;3&quot;&lt;/span&gt;}}&#160;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&#160;Similarly when I do&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
{ &lt;span class=&quot;code-quote&quot;&gt;&quot;action&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;replace&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;path&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;/foo/1/bar&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;value&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;3&quot;&lt;/span&gt;}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;to this:&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
{&lt;span class=&quot;code-quote&quot;&gt;&quot;foo&quot;&lt;/span&gt;:[{&lt;span class=&quot;code-quote&quot;&gt;&quot;bar&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;1&quot;&lt;/span&gt;},{&lt;span class=&quot;code-quote&quot;&gt;&quot;bar&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;2&quot;&lt;/span&gt;}]}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;and I get&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
{&lt;span class=&quot;code-quote&quot;&gt;&quot;foo&quot;&lt;/span&gt;:[{&lt;span class=&quot;code-quote&quot;&gt;&quot;bar&quot;&lt;/span&gt;:&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;},{&lt;span class=&quot;code-quote&quot;&gt;&quot;bar&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;3&quot;&lt;/span&gt;}]}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;instead of&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
{&lt;span class=&quot;code-quote&quot;&gt;&quot;foo&quot;&lt;/span&gt;:[{&lt;span class=&quot;code-quote&quot;&gt;&quot;bar&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;1&quot;&lt;/span&gt;},{&lt;span class=&quot;code-quote&quot;&gt;&quot;bar&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;3&quot;&lt;/span&gt;}]}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;The problem seems &lt;a href=&quot;https://github.com/stohu/johnzon/commit/515d363b8c55f0ba0835bda18f58dd545c0eb637&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;to be in&lt;/a&gt; the removing method in JsonPointerImpl. The enclosed patch passed all the tests.&lt;/p&gt;

&lt;p&gt;&#160;(based on commit&#160; 515d363b8c55f0ba0835bda18f58dd545c0eb637 on master)&lt;/p&gt;</description>
                <environment></environment>
        <key id="13255502">JOHNZON-274</key>
            <summary>Out-of-path values get removed when removing one with same name&amp;level</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="romain.manni-bucau">Romain Manni-Bucau</assignee>
                                    <reporter username="stohu">Jeffrey Hu</reporter>
                        <labels>
                    </labels>
                <created>Sun, 8 Sep 2019 15:28:36 +0000</created>
                <updated>Sun, 8 Sep 2019 16:15:37 +0000</updated>
                            <resolved>Sun, 8 Sep 2019 16:15:37 +0000</resolved>
                                                    <fixVersion>1.2.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="16925201" author="romain.manni-bucau" created="Sun, 8 Sep 2019 16:15:37 +0000"  >&lt;p&gt;Thanks a lot Jeffrey for the report, master should be good now&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12979777" name="0001-fix-when-JsonPatch-removing-JsonObjects-not-on-the-p.patch" size="7462" author="stohu" created="Sun, 8 Sep 2019 15:23:49 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 9 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z06fvs:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>