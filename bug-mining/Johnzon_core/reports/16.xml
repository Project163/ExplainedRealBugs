<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 20:01:36 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[JOHNZON-124] JsonArrayImpl should not override equals method</title>
                <link>https://issues.apache.org/jira/browse/JOHNZON-124</link>
                <project id="12315523" key="JOHNZON">Johnzon</project>
                    <description>&lt;p&gt;According to javadoc the equals method of JsonArray should be inherited from List.  The javadoc of java.util.List.equals(Object o) says:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Compares the specified object with this list for equality. Returns true if and only if the specified object is also a list, both lists have the same size, and all corresponding pairs of elements in the two lists are equal. (Two elements e1 and e2 are equal if (e1==null ? e2==null : e1.equals(e2)).) In other words, two lists are defined to be equal if they contain the same elements in the same order. This definition ensures that the equals method works properly across different implementations of the List interface.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;The following code:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;JsonReader reader = Json.createReader(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; StringReader(&lt;span class=&quot;code-quote&quot;&gt;&quot;[&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;]&quot;&lt;/span&gt;));
	    JsonArray jsonArray = reader.readArray();
    	List&amp;lt;JsonValue&amp;gt; actList = jsonArray;
    	
    	List&amp;lt;JsonValue&amp;gt; list = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ArrayList&amp;lt;JsonValue&amp;gt;();
     	list.add(JsonValue.TRUE);
    	&lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(actList.equals(list));
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;should return true instead of false.&lt;/p&gt;

&lt;p&gt;One fix will be just to remove the equals method from JsonArrayImpl and then the AbstractList&amp;lt;E&amp;gt;.equals(Object paramObject) will be used.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13077584">JOHNZON-124</key>
            <summary>JsonArrayImpl should not override equals method</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="2">Won&apos;t Fix</resolution>
                                        <assignee username="romain.manni-bucau">Romain Manni-Bucau</assignee>
                                    <reporter username="kal0ian">Kaloyan Spiridonov</reporter>
                        <labels>
                    </labels>
                <created>Tue, 6 Jun 2017 07:45:38 +0000</created>
                <updated>Tue, 29 Aug 2017 11:11:55 +0000</updated>
                            <resolved>Tue, 29 Aug 2017 11:11:55 +0000</resolved>
                                    <version>1.0.0</version>
                                    <fixVersion>1.1.2</fixVersion>
                                    <component>Core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="16038337" author="romain.manni-bucau" created="Tue, 6 Jun 2017 08:06:58 +0000"  >&lt;p&gt;The equals implementation is now portable but still checks JsonArray type since otherwise it breaks the equals contract and it is compatible with the spec wording (this means your test will not work until you use a JsonArray as list which is &quot;required&quot; by the spec to have an array).&lt;/p&gt;</comment>
                            <comment id="16038428" author="kal0ian" created="Tue, 6 Jun 2017 09:10:11 +0000"  >&lt;p&gt;With the current implementation list equals implementation is broken &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;	&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void main(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] args) {
		JsonReader reader = Json.createReader(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; StringReader(&lt;span class=&quot;code-quote&quot;&gt;&quot;[&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;]&quot;&lt;/span&gt;));
	    JsonArray jsonArray = reader.readArray();
    	
    	List&amp;lt;JsonValue&amp;gt; list = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ArrayList&amp;lt;JsonValue&amp;gt;();
     	list.add(JsonValue.TRUE);
     	
    	&lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(jsonArray.equals(list));
    	&lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(list.equals(jsonArray));
	}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Expected output:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Actual output:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;
&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;According to the equals contract it must be transitive.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt; In other words, two lists are defined to be equal if they contain the same elements in the same order. This definition ensures that the equals method works properly across different implementations of the List interface.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;In other words, the equality does not depend on the type of the list.&lt;/p&gt;</comment>
                            <comment id="16038443" author="romain.manni-bucau" created="Tue, 6 Jun 2017 09:21:30 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kal0ian&quot; class=&quot;user-hover&quot; rel=&quot;kal0ian&quot;&gt;kal0ian&lt;/a&gt; we respect that, the list &quot;reference&quot; is cause JsonArray is a list (&lt;a href=&quot;http://docs.oracle.com/javaee/7/api/javax/json/JsonArray.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://docs.oracle.com/javaee/7/api/javax/json/JsonArray.html&lt;/a&gt;) but equals should also enforce you don&apos;t have an element of another type and is symmetric so IMHO expectations are:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;list.equals(jsonArray) == &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;
jsonArray.equals(list) == &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;
jsonArrayRI.equals(jsonArrayJohnzon) == &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
jsonArrayJohnzon.equals(jsonArrayRI) == &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Also being said there is no way in the spec to get a List&amp;lt;JsonValue&amp;gt; I&apos;m not sure it is a concern.&lt;/p&gt;</comment>
                            <comment id="16038493" author="kal0ian" created="Tue, 6 Jun 2017 09:51:06 +0000"  >&lt;p&gt;Your expectation is not correct, because list.equals(jsonArray) with the current implementation returns true while jsonArray.equals(list) returns false. Hence the current implementation violates the commutativity rule for equals.&lt;/p&gt;</comment>
                            <comment id="16038499" author="romain.manni-bucau" created="Tue, 6 Jun 2017 09:52:54 +0000"  >&lt;p&gt;this is valid, list being a super type it equals jsonArray but jsonArray being a child type it doesnt equals a list. like dog.equals(animal) is false but animal.equals(dog) can be true.&lt;/p&gt;</comment>
                            <comment id="16038661" author="kal0ian" created="Tue, 6 Jun 2017 11:23:52 +0000"  >&lt;p&gt;I understand your point of view, what confuses me is this part of the spec: &lt;br/&gt;
&lt;a href=&quot;http://docs.oracle.com/javaee/7/api/javax/json/JsonArray.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://docs.oracle.com/javaee/7/api/javax/json/JsonArray.html&lt;/a&gt; - The equals method is inherited from java.util.List&lt;br/&gt;
From my point of view it is the same case as comparing LinkedList and ArrayList.&lt;br/&gt;
What do I miss here? Maybe there are json specific scenarios that require that behaviour?&lt;/p&gt;</comment>
                            <comment id="16038683" author="romain.manni-bucau" created="Tue, 6 Jun 2017 11:38:10 +0000"  >&lt;p&gt;I think both point of views are valid. Now in json-p space you can&apos;t get a list so I&apos;m not sure it is sane to support it since JsonArray &lt;b&gt;API&lt;/b&gt; can be enhanced to support operations breaking the list equals. More concretely what would mean &quot;a json array is equal to a list of json value&quot;?&lt;/p&gt;

&lt;p&gt;List#equals doesn&apos;t accept Collection which are not list so JsonArray can&apos;t accept plain List IMO.&lt;/p&gt;</comment>
                            <comment id="16145122" author="struberg" created="Tue, 29 Aug 2017 11:11:55 +0000"  >&lt;p&gt;After re-evaluating I also think the current behaviour is fine.&lt;/p&gt;

&lt;p&gt;Txs for the report in any case, Kaloyan!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 11 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3fwvb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>