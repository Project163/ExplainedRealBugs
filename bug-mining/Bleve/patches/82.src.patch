diff --git a/index/upside_down/upside_down.go b/index/upside_down/upside_down.go
index e0fd7d6c..0f2892e1 100644
--- a/index/upside_down/upside_down.go
+++ b/index/upside_down/upside_down.go
@@ -427,6 +427,9 @@ func (udc *UpsideDownCouch) mergeOldAndNew(backIndexRow *BackIndexRow, rows []in
 	for _, row := range rows {
 		switch row := row.(type) {
 		case *TermFrequencyRow:
+			if row.KeySize() > len(keyBuf) {
+				keyBuf = make([]byte, row.KeySize())
+			}
 			keySize, _ := row.KeyTo(keyBuf)
 			if _, ok := existingTermKeys[string(keyBuf[:keySize])]; ok {
 				updateRows = append(updateRows, row)
@@ -435,6 +438,9 @@ func (udc *UpsideDownCouch) mergeOldAndNew(backIndexRow *BackIndexRow, rows []in
 				addRows = append(addRows, row)
 			}
 		case *StoredRow:
+			if row.KeySize() > len(keyBuf) {
+				keyBuf = make([]byte, row.KeySize())
+			}
 			keySize, _ := row.KeyTo(keyBuf)
 			if _, ok := existingStoredKeys[string(keyBuf[:keySize])]; ok {
 				updateRows = append(updateRows, row)
diff --git a/index/upside_down/upside_down_test.go b/index/upside_down/upside_down_test.go
index d4a3efd1..15fbb3e5 100644
--- a/index/upside_down/upside_down_test.go
+++ b/index/upside_down/upside_down_test.go
@@ -1283,3 +1283,43 @@ func TestConcurrentUpdate(t *testing.T) {
 		t.Errorf("expected single field, found %d", len(doc.Fields))
 	}
 }
+
+func TestLargeField(t *testing.T) {
+	defer func() {
+		err := DestroyTest()
+		if err != nil {
+			t.Fatal(err)
+		}
+	}()
+
+	analysisQueue := index.NewAnalysisQueue(1)
+	idx, err := NewUpsideDownCouch(boltdb.Name, boltTestConfig, analysisQueue)
+	if err != nil {
+		t.Fatal(err)
+	}
+	err = idx.Open()
+	if err != nil {
+		t.Errorf("error opening index: %v", err)
+	}
+	defer func() {
+		err := idx.Close()
+		if err != nil {
+			t.Fatal(err)
+		}
+	}()
+
+	largeFieldValue := make([]byte, 0)
+	for len(largeFieldValue) < RowBufferSize {
+		largeFieldValue = append(largeFieldValue, bleveWikiArticle1K...)
+	}
+	t.Logf("large field size: %d", len(largeFieldValue))
+
+	d := document.NewDocument("large")
+	f := document.NewTextFieldWithIndexingOptions("desc", nil, largeFieldValue, document.IndexField|document.StoreField)
+	d.AddField(f)
+
+	err = idx.Update(d)
+	if err != nil {
+		t.Fatal(err)
+	}
+}
