diff --git a/index/store/boltdb/writer.go b/index/store/boltdb/writer.go
index ec6b951f..0a70bfff 100644
--- a/index/store/boltdb/writer.go
+++ b/index/store/boltdb/writer.go
@@ -33,7 +33,7 @@ func (w *Writer) NewBatch() store.KVBatch {
 }
 
 func (w *Writer) Close() error {
-	w.store.writer.Unlock()
+	defer w.store.writer.Unlock()
 	return w.tx.Commit()
 }
 
diff --git a/index/upside_down/upside_down.go b/index/upside_down/upside_down.go
index acaa423a..13a88823 100644
--- a/index/upside_down/upside_down.go
+++ b/index/upside_down/upside_down.go
@@ -645,16 +645,12 @@ func (udc *UpsideDownCouch) Batch(batch *index.Batch) (err error) {
 	if err != nil {
 		return
 	}
-	defer func() {
-		if cerr := kvwriter.Close(); err == nil && cerr != nil {
-			err = cerr
-		}
-	}()
 
 	// first lookup all the back index rows
 	var backIndexRows map[string]*BackIndexRow
 	backIndexRows, err = udc.backIndexRowsForBatch(kvwriter, batch)
 	if err != nil {
+		_ = kvwriter.Close()
 		return
 	}
 
@@ -692,7 +688,15 @@ func (udc *UpsideDownCouch) Batch(batch *index.Batch) (err error) {
 	}
 
 	err = udc.batchRows(kvwriter, addRows, updateRows, deleteRows)
+	if err != nil {
+		_ = kvwriter.Close()
+		atomic.AddUint64(&udc.stats.errors, 1)
+		return
+	}
+
+	err = kvwriter.Close()
 	atomic.AddUint64(&udc.stats.indexTime, uint64(time.Since(indexStart)))
+
 	if err == nil {
 		udc.m.Lock()
 		udc.docCount += docsAdded
