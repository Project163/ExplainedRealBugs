{"url":"https://api.github.com/repos/blevesearch/bleve/issues/360","repository_url":"https://api.github.com/repos/blevesearch/bleve","labels_url":"https://api.github.com/repos/blevesearch/bleve/issues/360/labels{/name}","comments_url":"https://api.github.com/repos/blevesearch/bleve/issues/360/comments","events_url":"https://api.github.com/repos/blevesearch/bleve/issues/360/events","html_url":"https://github.com/blevesearch/bleve/issues/360","id":142172274,"node_id":"MDU6SXNzdWUxNDIxNzIyNzQ=","number":360,"title":"concurrent map write found while running tests","user":{"login":"mschoch","id":298143,"node_id":"MDQ6VXNlcjI5ODE0Mw==","avatar_url":"https://avatars.githubusercontent.com/u/298143?v=4","gravatar_id":"","url":"https://api.github.com/users/mschoch","html_url":"https://github.com/mschoch","followers_url":"https://api.github.com/users/mschoch/followers","following_url":"https://api.github.com/users/mschoch/following{/other_user}","gists_url":"https://api.github.com/users/mschoch/gists{/gist_id}","starred_url":"https://api.github.com/users/mschoch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mschoch/subscriptions","organizations_url":"https://api.github.com/users/mschoch/orgs","repos_url":"https://api.github.com/users/mschoch/repos","events_url":"https://api.github.com/users/mschoch/events{/privacy}","received_events_url":"https://api.github.com/users/mschoch/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2016-03-20T15:05:09Z","updated_at":"2016-04-08T19:32:58Z","closed_at":"2016-04-08T19:32:58Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"```\n=== RUN   TestBatchCrashBug195\nfatal error: concurrent map read and map write\n\ngoroutine 45 [running]:\nruntime.throw(0x6a16a0, 0x21)\n    /Users/mschoch/Documents/research/gosrc/src/runtime/panic.go:530 +0x90 fp=0xc820108888 sp=0xc820108870\nruntime.mapaccessK(0x48e680, 0xc820143740, 0xc820070b28, 0x61f7d8, 0x5)\n    /Users/mschoch/Documents/research/gosrc/src/runtime/hashmap.go:389 +0x5a fp=0xc8201088d0 sp=0xc820108888\nruntime.mapiternext(0xc820108cf0)\n    /Users/mschoch/Documents/research/gosrc/src/runtime/hashmap.go:774 +0x63e fp=0xc820108960 sp=0xc8201088d0\ngithub.com/blevesearch/bleve/index/upside_down.(*UpsideDownCouch).Batch(0xc82007c280, 0xc820149bb0, 0x0, 0x0)\n    /Users/mschoch/go/src/github.com/blevesearch/bleve/index/upside_down/upside_down.go:798 +0x184 fp=0xc820108ea8 sp=0xc820108960\ngithub.com/blevesearch/bleve.(*indexImpl).Batch(0xc820052310, 0xc82015a420, 0x0, 0x0)\n    /Users/mschoch/go/src/github.com/blevesearch/bleve/index_impl.go:319 +0x122 fp=0xc820108f10 sp=0xc820108ea8\ngithub.com/blevesearch/bleve.TestBatchCrashBug195.func2(0xc82018f8c0, 0xa791f8, 0xc820052310, 0xc82015a420, 0xc820080480)\n    /Users/mschoch/go/src/github.com/blevesearch/bleve/index_race_test.go:55 +0x71 fp=0xc820108f88 sp=0xc820108f10\nruntime.goexit()\n    /Users/mschoch/Documents/research/gosrc/src/runtime/asm_amd64.s:1998 +0x1 fp=0xc820108f90 sp=0xc820108f88\ncreated by github.com/blevesearch/bleve.TestBatchCrashBug195\n    /Users/mschoch/go/src/github.com/blevesearch/bleve/index_race_test.go:59 +0x5bc\n\ngoroutine 1 [chan receive]:\ntesting.RunTests(0x729460, 0x923e40, 0x3a, 0x3a, 0xa78901)\n    /Users/mschoch/Documents/research/gosrc/src/testing/testing.go:583 +0x8d2\ntesting.(*M).Run(0xc82004fef8, 0xd)\n    /Users/mschoch/Documents/research/gosrc/src/testing/testing.go:515 +0x81\ngithub.com/blevesearch/bleve.TestMain(0xc82004fef8)\n    /Users/mschoch/go/src/github.com/blevesearch/bleve/examples_test.go:30 +0xa8\nmain.main()\n    github.com/blevesearch/bleve/_test/_testmain.go:220 +0x114\n\ngoroutine 17 [syscall, locked to thread]:\nruntime.goexit()\n    /Users/mschoch/Documents/research/gosrc/src/runtime/asm_amd64.s:1998 +0x1\n\ngoroutine 5 [select]:\ngithub.com/blevesearch/bleve/index.AnalysisWorker(0xc82005c2a0, 0xc82005c300)\n    /Users/mschoch/go/src/github.com/blevesearch/bleve/index/analysis.go:70 +0x14e\ncreated by github.com/blevesearch/bleve/index.NewAnalysisQueue\n    /Users/mschoch/go/src/github.com/blevesearch/bleve/index/analysis.go:62 +0xf2\n\ngoroutine 6 [select]:\ngithub.com/blevesearch/bleve/index.AnalysisWorker(0xc82005c2a0, 0xc82005c300)\n    /Users/mschoch/go/src/github.com/blevesearch/bleve/index/analysis.go:70 +0x14e\ncreated by github.com/blevesearch/bleve/index.NewAnalysisQueue\n    /Users/mschoch/go/src/github.com/blevesearch/bleve/index/analysis.go:62 +0xf2\n\ngoroutine 7 [select]:\ngithub.com/blevesearch/bleve/index.AnalysisWorker(0xc82005c2a0, 0xc82005c300)\n    /Users/mschoch/go/src/github.com/blevesearch/bleve/index/analysis.go:70 +0x14e\ncreated by github.com/blevesearch/bleve/index.NewAnalysisQueue\n    /Users/mschoch/go/src/github.com/blevesearch/bleve/index/analysis.go:62 +0xf2\n\ngoroutine 8 [select]:\ngithub.com/blevesearch/bleve/index.AnalysisWorker(0xc82005c2a0, 0xc82005c300)\n    /Users/mschoch/go/src/github.com/blevesearch/bleve/index/analysis.go:70 +0x14e\ncreated by github.com/blevesearch/bleve/index.NewAnalysisQueue\n    /Users/mschoch/go/src/github.com/blevesearch/bleve/index/analysis.go:62 +0xf2\n\ngoroutine 44 [runnable]:\ngithub.com/blevesearch/bleve/document.NewCompositeFieldWithIndexingOptions(0x61fca8, 0x4, 0x1, 0xc820051b78, 0x0, 0x0, 0x943c18, 0x0, 0x0, 0x5, ...)\n    /Users/mschoch/go/src/github.com/blevesearch/bleve/document/field_composite.go:38 +0x87\ngithub.com/blevesearch/bleve.(*IndexMapping).mapDocument(0xc820080510, 0xc8201a7f90, 0x49fb80, 0xc8201a4a70, 0x0, 0x0)\n    /Users/mschoch/go/src/github.com/blevesearch/bleve/mapping_index.go:426 +0x54e\ngithub.com/blevesearch/bleve.(*Batch).Index(0xc82015a420, 0xc8201a4a50, 0x3, 0x49fb80, 0xc8201a4a70, 0x0, 0x0)\n    /Users/mschoch/go/src/github.com/blevesearch/bleve/index.go:38 +0x266\ngithub.com/blevesearch/bleve.TestBatchCrashBug195(0xc820080480)\n    /Users/mschoch/go/src/github.com/blevesearch/bleve/index_race_test.go:63 +0x859\ntesting.tRunner(0xc820080480, 0x923f60)\n    /Users/mschoch/Documents/research/gosrc/src/testing/testing.go:473 +0x98\ncreated by testing.RunTests\n    /Users/mschoch/Documents/research/gosrc/src/testing/testing.go:582 +0x892\n\ngoroutine 41 [sleep]:\ntime.Sleep(0x2faf080)\n    /Users/mschoch/Documents/research/gosrc/src/runtime/time.go:59 +0xf9\ngithub.com/blevesearch/bleve.TestIndexAliasMultipleLayer.func2(0xc820012d20, 0x0, 0x0)\n    /Users/mschoch/go/src/github.com/blevesearch/bleve/index_alias_impl_test.go:1057 +0x2c\ngithub.com/blevesearch/bleve.(*stubIndex).SearchInContext(0xc8200e0500, 0xf00030, 0xc820104660, 0xc820012d20, 0xc8200f219c, 0x0, 0x0)\n    /Users/mschoch/go/src/github.com/blevesearch/bleve/index_alias_impl_test.go:1191 +0x45\ngithub.com/blevesearch/bleve.wrapSearch(0xf00030, 0xc820104660, 0xa78a58, 0xc8200e0500, 0xc820012d20, 0x729a18)\n    /Users/mschoch/go/src/github.com/blevesearch/bleve/index_alias_impl.go:489 +0xfa\ngithub.com/blevesearch/bleve.wrapSearchTimeout.func1(0xc82005c8a0, 0xf00030, 0xc820104660, 0xa78a58, 0xc8200e0500, 0xc820012d20)\n    /Users/mschoch/go/src/github.com/blevesearch/bleve/index_alias_impl.go:495 +0x49\ncreated by github.com/blevesearch/bleve.wrapSearchTimeout\n    /Users/mschoch/go/src/github.com/blevesearch/bleve/index_alias_impl.go:495 +0xa3\n\ngoroutine 32 [chan send]:\ngithub.com/blevesearch/bleve.wrapSearchTimeout.func1(0xc8200e4480, 0xf00030, 0xc8200e43c0, 0xa78a58, 0xc8200e0200, 0xc8200fe4b0)\n    /Users/mschoch/go/src/github.com/blevesearch/bleve/index_alias_impl.go:495 +0x77\ncreated by github.com/blevesearch/bleve.wrapSearchTimeout\n    /Users/mschoch/go/src/github.com/blevesearch/bleve/index_alias_impl.go:495 +0xa3\n\ngoroutine 97 [sleep]:\ntime.Sleep(0x2faf080)\n    /Users/mschoch/Documents/research/gosrc/src/runtime/time.go:59 +0xf9\ngithub.com/blevesearch/bleve.TestIndexAliasMultipleLayer.func1(0xc8200feaf0, 0x0, 0x0)\n    /Users/mschoch/go/src/github.com/blevesearch/bleve/index_alias_impl_test.go:1033 +0x2c\ngithub.com/blevesearch/bleve.(*stubIndex).SearchInContext(0xc8200e04c0, 0xf00030, 0xc820104660, 0xc8200feaf0, 0x180001, 0x0, 0x0)\n    /Users/mschoch/go/src/github.com/blevesearch/bleve/index_alias_impl_test.go:1191 +0x45\ngithub.com/blevesearch/bleve.wrapSearch(0xf00030, 0xc820104660, 0xa78a58, 0xc8200e04c0, 0xc8200feaf0, 0x729a18)\n    /Users/mschoch/go/src/github.com/blevesearch/bleve/index_alias_impl.go:489 +0xfa\ngithub.com/blevesearch/bleve.wrapSearchTimeout.func1(0xc8200e49c0, 0xf00030, 0xc820104660, 0xa78a58, 0xc8200e04c0, 0xc8200feaf0)\n    /Users/mschoch/go/src/github.com/blevesearch/bleve/index_alias_impl.go:495 +0x49\ncreated by github.com/blevesearch/bleve.wrapSearchTimeout\n    /Users/mschoch/go/src/github.com/blevesearch/bleve/index_alias_impl.go:495 +0xa3\n\ngoroutine 37 [chan send]:\ngithub.com/blevesearch/bleve.wrapSearchTimeout.func1(0xc82005c7e0, 0xf00030, 0xc8200e47e0, 0xa78a58, 0xc8200c8500, 0xc8200fea50)\n    /Users/mschoch/go/src/github.com/blevesearch/bleve/index_alias_impl.go:495 +0x77\ncreated by github.com/blevesearch/bleve.wrapSearchTimeout\n    /Users/mschoch/go/src/github.com/blevesearch/bleve/index_alias_impl.go:495 +0xa3\n\ngoroutine 33 [chan send]:\ngithub.com/blevesearch/bleve.wrapSearchTimeout.func1(0xc8200e44e0, 0xf00030, 0xc8200e43c0, 0xa78a58, 0xc8200e0240, 0xc8200fe500)\n    /Users/mschoch/go/src/github.com/blevesearch/bleve/index_alias_impl.go:495 +0x77\ncreated by github.com/blevesearch/bleve.wrapSearchTimeout\n    /Users/mschoch/go/src/github.com/blevesearch/bleve/index_alias_impl.go:495 +0xa3\n\ngoroutine 86 [chan send]:\ngithub.com/blevesearch/bleve.wrapSearchTimeout.func1(0xc8200e46c0, 0xf00030, 0xc8200e45a0, 0xa78a58, 0xc8200e0240, 0xc8200fe5f0)\n    /Users/mschoch/go/src/github.com/blevesearch/bleve/index_alias_impl.go:495 +0x77\ncreated by github.com/blevesearch/bleve.wrapSearchTimeout\n    /Users/mschoch/go/src/github.com/blevesearch/bleve/index_alias_impl.go:495 +0xa3\n\ngoroutine 85 [chan send]:\ngithub.com/blevesearch/bleve.wrapSearchTimeout.func1(0xc8200e4660, 0xf00030, 0xc8200e45a0, 0xa78a58, 0xc8200e0200, 0xc8200fe5a0)\n    /Users/mschoch/go/src/github.com/blevesearch/bleve/index_alias_impl.go:495 +0x77\ncreated by github.com/blevesearch/bleve.wrapSearchTimeout\n    /Users/mschoch/go/src/github.com/blevesearch/bleve/index_alias_impl.go:495 +0xa3\nFAIL    github.com/blevesearch/bleve    0.137s\n```\n","closed_by":{"login":"mschoch","id":298143,"node_id":"MDQ6VXNlcjI5ODE0Mw==","avatar_url":"https://avatars.githubusercontent.com/u/298143?v=4","gravatar_id":"","url":"https://api.github.com/users/mschoch","html_url":"https://github.com/mschoch","followers_url":"https://api.github.com/users/mschoch/followers","following_url":"https://api.github.com/users/mschoch/following{/other_user}","gists_url":"https://api.github.com/users/mschoch/gists{/gist_id}","starred_url":"https://api.github.com/users/mschoch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mschoch/subscriptions","organizations_url":"https://api.github.com/users/mschoch/orgs","repos_url":"https://api.github.com/users/mschoch/repos","events_url":"https://api.github.com/users/mschoch/events{/privacy}","received_events_url":"https://api.github.com/users/mschoch/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/blevesearch/bleve/issues/360/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/blevesearch/bleve/issues/360/timeline","performed_via_github_app":null,"state_reason":"completed"}