diff --git a/maven-project/src/main/java/org/apache/maven/project/DefaultMavenProjectBuilder.java b/maven-project/src/main/java/org/apache/maven/project/DefaultMavenProjectBuilder.java
index bc7ba36f3..54cf05b22 100644
--- a/maven-project/src/main/java/org/apache/maven/project/DefaultMavenProjectBuilder.java
+++ b/maven-project/src/main/java/org/apache/maven/project/DefaultMavenProjectBuilder.java
@@ -741,8 +741,6 @@ public class DefaultMavenProjectBuilder
             }
         }
 
-        Model originalModel = ModelUtils.cloneModel( model );
-
         MavenProject project = null;
         try
         {
@@ -754,11 +752,6 @@ public class DefaultMavenProjectBuilder
             throw new ProjectBuildingException( projectId, e.getMessage(), e );
         }
 
-        project.setOriginalModel( originalModel );
-
-        rawProjectCache.put( createCacheKey( project.getGroupId(), project.getArtifactId(), project.getVersion() ),
-                             new MavenProject( project ) );
-
         // we don't have to force the collision exception for superModel here, it's already been done in getSuperModel()
         MavenProject previousProject = superProject;
 
@@ -1034,6 +1027,9 @@ public class DefaultMavenProjectBuilder
                                           boolean strict )
         throws ProjectBuildingException, InvalidRepositoryException
     {
+        Model originalModel = ModelUtils.cloneModel( model );
+
+
         if ( !model.getRepositories().isEmpty() )
         {
             List respositories = buildArtifactRepositories( model );
@@ -1089,7 +1085,8 @@ public class DefaultMavenProjectBuilder
         MavenProject project = new MavenProject( model );
 
         project.setActiveProfiles( activeProfiles );
-
+        project.setOriginalModel( originalModel );
+        
         lineage.addFirst( project );
 
         Parent parentModel = model.getParent();
@@ -1289,6 +1286,8 @@ public class DefaultMavenProjectBuilder
             project.setParentArtifact( parentArtifact );
         }
 
+        rawProjectCache.put( createCacheKey( project.getGroupId(), project.getArtifactId(), project.getVersion() ), new MavenProject( project ) );
+
         return project;
     }
 
diff --git a/maven-project/src/test/java/org/apache/maven/project/DefaultMavenProjectBuilderTest.java b/maven-project/src/test/java/org/apache/maven/project/DefaultMavenProjectBuilderTest.java
index 6c0c0ddee..85405a80b 100644
--- a/maven-project/src/test/java/org/apache/maven/project/DefaultMavenProjectBuilderTest.java
+++ b/maven-project/src/test/java/org/apache/maven/project/DefaultMavenProjectBuilderTest.java
@@ -32,26 +32,21 @@ import org.apache.maven.model.Profile;
 import org.apache.maven.model.Repository;
 import org.apache.maven.profiles.DefaultProfileManager;
 import org.apache.maven.profiles.ProfileManager;
-import org.codehaus.plexus.PlexusTestCase;
 import org.codehaus.plexus.util.FileUtils;
 
 public class DefaultMavenProjectBuilderTest
-    extends PlexusTestCase
+    extends AbstractMavenProjectTestCase
 {
 
     private List filesToDelete = new ArrayList();
 
     private File localRepoDir;
 
-    private DefaultMavenProjectBuilder projectBuilder;
-
     public void setUp()
         throws Exception
     {
         super.setUp();
 
-        projectBuilder = (DefaultMavenProjectBuilder) lookup( MavenProjectBuilder.ROLE );
-        
         localRepoDir = new File( System.getProperty( "java.io.tmpdir" ), "local-repo." + System.currentTimeMillis() );
         localRepoDir.mkdirs();
 
@@ -150,6 +145,22 @@ public class DefaultMavenProjectBuilderTest
                       ( (Repository) repositories.get( 0 ) ).getId() );
     }
 
+    /**
+     * Check that we can build ok from the middle pom of a (parent,child,grandchild) heirarchy
+     * @throws Exception 
+     */
+    public void testBuildFromMiddlePom() throws Exception
+    {
+        File f1 = getTestFile( "src/test/resources/projects/grandchild-check/child/pom.xml");
+        File f2 = getTestFile( "src/test/resources/projects/grandchild-check/child/grandchild/pom.xml");
+
+        getProject( f1 );
+        
+        // it's the building of the grandchild project, having already cached the child project
+        // (but not the parent project), which causes the problem.
+        getProject( f2 );
+    }
+    
     protected ArtifactRepository getLocalRepository()
         throws Exception
     {
diff --git a/maven-project/src/test/resources/projects/grandchild-check/child/grandchild/pom.xml b/maven-project/src/test/resources/projects/grandchild-check/child/grandchild/pom.xml
new file mode 100644
index 000000000..56bed2c93
--- /dev/null
+++ b/maven-project/src/test/resources/projects/grandchild-check/child/grandchild/pom.xml
@@ -0,0 +1,10 @@
+<project>
+	<modelVersion>4.0.0</modelVersion>
+	<parent>
+	<groupId>grandchildtest</groupId>
+	<artifactId>child</artifactId>
+	<version>1</version>
+	</parent>
+	<artifactId>grandchild</artifactId>
+
+</project>
diff --git a/maven-project/src/test/resources/projects/grandchild-check/child/pom.xml b/maven-project/src/test/resources/projects/grandchild-check/child/pom.xml
new file mode 100644
index 000000000..0858c6d14
--- /dev/null
+++ b/maven-project/src/test/resources/projects/grandchild-check/child/pom.xml
@@ -0,0 +1,13 @@
+<project>
+	<modelVersion>4.0.0</modelVersion>
+	<parent>
+	<groupId>grandchildtest</groupId>
+	<artifactId>root-pom</artifactId>
+	<version>1</version>
+	</parent>
+	<artifactId>child</artifactId>
+	<packaging>pom</packaging>
+  <modules>
+    <module>grandchild</module>
+  </modules>
+</project>
diff --git a/maven-project/src/test/resources/projects/grandchild-check/pom.xml b/maven-project/src/test/resources/projects/grandchild-check/pom.xml
new file mode 100644
index 000000000..3b1ebd0ea
--- /dev/null
+++ b/maven-project/src/test/resources/projects/grandchild-check/pom.xml
@@ -0,0 +1,7 @@
+<project>
+	<modelVersion>4.0.0</modelVersion>
+	<groupId>grandchildtest</groupId>
+	<artifactId>root-pom</artifactId>
+	<version>1</version>
+	<packaging>pom</packaging>
+</project>
