diff --git a/maven-project/src/main/java/org/apache/maven/project/artifact/MavenMetadataSource.java b/maven-project/src/main/java/org/apache/maven/project/artifact/MavenMetadataSource.java
index 9091376aa..d1751126b 100644
--- a/maven-project/src/main/java/org/apache/maven/project/artifact/MavenMetadataSource.java
+++ b/maven-project/src/main/java/org/apache/maven/project/artifact/MavenMetadataSource.java
@@ -20,6 +20,7 @@ import org.apache.maven.artifact.Artifact;
 import org.apache.maven.artifact.factory.ArtifactFactory;
 import org.apache.maven.artifact.metadata.ArtifactMetadataRetrievalException;
 import org.apache.maven.artifact.metadata.ArtifactMetadataSource;
+import org.apache.maven.artifact.metadata.ResolutionGroup;
 import org.apache.maven.artifact.repository.ArtifactRepository;
 import org.apache.maven.artifact.resolver.ArtifactResolver;
 import org.apache.maven.artifact.resolver.filter.AndArtifactFilter;
@@ -27,7 +28,6 @@ import org.apache.maven.artifact.resolver.filter.ArtifactFilter;
 import org.apache.maven.artifact.resolver.filter.ExcludesArtifactFilter;
 import org.apache.maven.model.Dependency;
 import org.apache.maven.model.Exclusion;
-import org.apache.maven.model.io.xpp3.MavenXpp3Reader;
 import org.apache.maven.project.MavenProject;
 import org.apache.maven.project.MavenProjectBuilder;
 import org.apache.maven.project.ProjectBuildingException;
@@ -47,24 +47,17 @@ public class MavenMetadataSource
 {
     private MavenProjectBuilder mavenProjectBuilder;
 
-    private ArtifactResolver artifactResolver;
-
     private ArtifactFactory artifactFactory;
 
-    /**
-     * @todo remove.
-     */
-    private MavenXpp3Reader reader = new MavenXpp3Reader();
-
+    // TODO: Remove resolver from params list.
     public MavenMetadataSource( ArtifactResolver artifactResolver, MavenProjectBuilder projectBuilder,
                                 ArtifactFactory artifactFactory )
     {
-        this.artifactResolver = artifactResolver;
         this.mavenProjectBuilder = projectBuilder;
         this.artifactFactory = artifactFactory;
     }
 
-    public Set retrieve( Artifact artifact, ArtifactRepository localRepository, List remoteRepositories )
+    public ResolutionGroup retrieve( Artifact artifact, ArtifactRepository localRepository, List remoteRepositories )
         throws ArtifactMetadataRetrievalException
     {
         // TODO: only metadata is really needed - resolve as metadata
@@ -82,12 +75,15 @@ public class MavenMetadataSource
                                                                       localRepository );
             dependencies = p.getDependencies();
             artifact.setDownloadUrl( pomArtifact.getDownloadUrl() );
+            
+            Set artifacts = createArtifacts( artifactFactory, dependencies, artifact.getScope(), artifact.getDependencyFilter() );
+            
+            return new ResolutionGroup( artifacts, p.getRemoteArtifactRepositories() );
         }
         catch ( ProjectBuildingException e )
         {
             throw new ArtifactMetadataRetrievalException( "Unable to read the metadata file", e );
         }
-        return createArtifacts( artifactFactory, dependencies, artifact.getScope(), artifact.getDependencyFilter() );
     }
 
     public static Set createArtifacts( ArtifactFactory artifactFactory, List dependencies, String inheritedScope,
diff --git a/maven-project/src/test/java/org/apache/maven/project/MavenProjectTestCase.java b/maven-project/src/test/java/org/apache/maven/project/MavenProjectTestCase.java
index 936aad2e4..7c6e38dd5 100644
--- a/maven-project/src/test/java/org/apache/maven/project/MavenProjectTestCase.java
+++ b/maven-project/src/test/java/org/apache/maven/project/MavenProjectTestCase.java
@@ -18,6 +18,7 @@ package org.apache.maven.project;
 
 import org.apache.maven.artifact.factory.ArtifactFactory;
 import org.apache.maven.artifact.repository.ArtifactRepository;
+import org.apache.maven.artifact.repository.ArtifactRepositoryFactory;
 import org.apache.maven.artifact.repository.DefaultArtifactRepository;
 import org.apache.maven.artifact.repository.layout.ArtifactRepositoryLayout;
 import org.codehaus.plexus.PlexusTestCase;
@@ -38,6 +39,8 @@ public abstract class MavenProjectTestCase
 
     private ArtifactFactory artifactFactory;
 
+    private ArtifactRepositoryFactory artifactRepositoryFactory;
+
     protected void setUp()
         throws Exception
     {
@@ -45,6 +48,7 @@ public abstract class MavenProjectTestCase
 
         projectBuilder = (MavenProjectBuilder) lookup( MavenProjectBuilder.ROLE );
         artifactFactory = (ArtifactFactory) lookup( ArtifactFactory.ROLE );
+        artifactRepositoryFactory = (ArtifactRepositoryFactory) lookup( ArtifactRepositoryFactory.ROLE );
     }
 
     // ----------------------------------------------------------------------
@@ -100,7 +104,7 @@ public abstract class MavenProjectTestCase
         throws Exception
     {
         return projectBuilder.buildWithDependencies( pom, getLocalRepository(),
-                                                     new ProjectClasspathArtifactResolver.Source( artifactFactory ),
+                                                     new ProjectClasspathArtifactResolver.Source( artifactFactory, artifactRepositoryFactory, getContainer() ),
                                                      Collections.EMPTY_LIST );
     }
 
diff --git a/maven-project/src/test/java/org/apache/maven/project/ProjectClasspathArtifactResolver.java b/maven-project/src/test/java/org/apache/maven/project/ProjectClasspathArtifactResolver.java
index 1b3a4b9e0..a5d318df4 100644
--- a/maven-project/src/test/java/org/apache/maven/project/ProjectClasspathArtifactResolver.java
+++ b/maven-project/src/test/java/org/apache/maven/project/ProjectClasspathArtifactResolver.java
@@ -20,7 +20,9 @@ import org.apache.maven.artifact.Artifact;
 import org.apache.maven.artifact.factory.ArtifactFactory;
 import org.apache.maven.artifact.metadata.ArtifactMetadataRetrievalException;
 import org.apache.maven.artifact.metadata.ArtifactMetadataSource;
+import org.apache.maven.artifact.metadata.ResolutionGroup;
 import org.apache.maven.artifact.repository.ArtifactRepository;
+import org.apache.maven.artifact.repository.ArtifactRepositoryFactory;
 import org.apache.maven.artifact.resolver.ArtifactResolutionException;
 import org.apache.maven.artifact.resolver.ArtifactResolutionResult;
 import org.apache.maven.artifact.resolver.DefaultArtifactResolver;
@@ -28,6 +30,11 @@ import org.apache.maven.artifact.resolver.filter.ArtifactFilter;
 import org.apache.maven.model.Dependency;
 import org.apache.maven.model.Model;
 import org.apache.maven.model.io.xpp3.MavenXpp3Reader;
+import org.codehaus.plexus.PlexusConstants;
+import org.codehaus.plexus.PlexusContainer;
+import org.codehaus.plexus.context.Context;
+import org.codehaus.plexus.context.ContextException;
+import org.codehaus.plexus.personality.plexus.lifecycle.phase.Contextualizable;
 import org.codehaus.plexus.util.IOUtil;
 import org.codehaus.plexus.util.xml.pull.XmlPullParserException;
 
@@ -41,18 +48,26 @@ import java.util.Set;
 
 public class ProjectClasspathArtifactResolver
     extends DefaultArtifactResolver
+    implements Contextualizable
 {
+    private ArtifactRepositoryFactory repositoryFactory;
+    private PlexusContainer container;
+
     public static class Source
         implements ArtifactMetadataSource
     {
         private ArtifactFactory artifactFactory;
+        private final ArtifactRepositoryFactory repositoryFactory;
+        private final PlexusContainer container;
 
-        public Source( ArtifactFactory artifactFactory )
+        public Source( ArtifactFactory artifactFactory, ArtifactRepositoryFactory repositoryFactory, PlexusContainer container )
         {
             this.artifactFactory = artifactFactory;
+            this.repositoryFactory = repositoryFactory;
+            this.container = container;
         }
 
-        public Set retrieve( Artifact artifact, ArtifactRepository localRepository, List remoteRepositories )
+        public ResolutionGroup retrieve( Artifact artifact, ArtifactRepository localRepository, List remoteRepositories )
             throws ArtifactMetadataRetrievalException
         {
             Model model = null;
@@ -86,7 +101,20 @@ public class ProjectClasspathArtifactResolver
             {
                 IOUtil.close( r );
             }
-            return createArtifacts( model.getDependencies(), artifact.getScope() );
+            
+            Set artifacts = createArtifacts( model.getDependencies(), artifact.getScope() );
+            
+            List artifactRepositories;
+            try
+            {
+                artifactRepositories = ProjectUtils.buildArtifactRepositories( model.getRepositories(), repositoryFactory, container );
+            }
+            catch ( ProjectBuildingException e )
+            {
+                throw new ArtifactMetadataRetrievalException( e );
+            }
+            
+            return new ResolutionGroup( artifacts, artifactRepositories );
         }
 
         protected Set createArtifacts( List dependencies, String inheritedScope )
@@ -108,7 +136,7 @@ public class ProjectClasspathArtifactResolver
             return projectArtifacts;
         }
     }
-
+    
     public void resolve( Artifact artifact, List remoteRepositories, ArtifactRepository localRepository )
         throws ArtifactResolutionException
     {
@@ -121,7 +149,7 @@ public class ProjectClasspathArtifactResolver
         throws ArtifactResolutionException
     {
         return super.resolveTransitively( artifacts, originatingArtifact, localRepository, remoteRepositories,
-                                          new Source( artifactFactory ), filter );
+                                          new Source( artifactFactory, repositoryFactory, container ), filter );
     }
 
     public ArtifactResolutionResult resolveTransitively( Set artifacts, Artifact originatingArtifact,
@@ -130,7 +158,13 @@ public class ProjectClasspathArtifactResolver
         throws ArtifactResolutionException
     {
         return super.resolveTransitively( artifacts, originatingArtifact, remoteRepositories, localRepository,
-                                          new Source( artifactFactory ) );
+                                          new Source( artifactFactory, repositoryFactory, container ) );
+    }
+
+    public void contextualize( Context context )
+        throws ContextException
+    {
+        this.container = (PlexusContainer) context.get( PlexusConstants.PLEXUS_KEY );
     }
 
 }
\ No newline at end of file
diff --git a/maven-project/src/test/resources/org/apache/maven/project/ProjectClasspathTest.xml b/maven-project/src/test/resources/org/apache/maven/project/ProjectClasspathTest.xml
index ee33a26b0..161a3de9b 100644
--- a/maven-project/src/test/resources/org/apache/maven/project/ProjectClasspathTest.xml
+++ b/maven-project/src/test/resources/org/apache/maven/project/ProjectClasspathTest.xml
@@ -24,6 +24,9 @@
         <requirement>
           <role>org.apache.maven.artifact.factory.ArtifactFactory</role>
         </requirement>
+        <requirement>
+          <role>org.apache.maven.artifact.repository.ArtifactRepositoryFactory</role>
+        </requirement>
         <requirement>
           <role>org.apache.maven.artifact.resolver.ArtifactCollector</role>
         </requirement>
