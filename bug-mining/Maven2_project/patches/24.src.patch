diff --git a/maven-project/pom.xml b/maven-project/pom.xml
index e2bb092d9..4601fc40f 100755
--- a/maven-project/pom.xml
+++ b/maven-project/pom.xml
@@ -18,6 +18,11 @@
       <artifactId>maven-model</artifactId>
       <version>2.0-beta-1-SNAPSHOT</version>
     </dependency>
+    <dependency>
+      <groupId>org.apache.maven</groupId>
+      <artifactId>maven-profile</artifactId>
+      <version>2.0-beta-1-SNAPSHOT</version>
+    </dependency>
     <dependency>
       <groupId>org.apache.maven</groupId>
       <artifactId>maven-artifact</artifactId>
diff --git a/maven-project/src/main/java/org/apache/maven/profiles/AlwaysOnActivation.java b/maven-project/src/main/java/org/apache/maven/profiles/AlwaysOnActivation.java
deleted file mode 100644
index f089998af..000000000
--- a/maven-project/src/main/java/org/apache/maven/profiles/AlwaysOnActivation.java
+++ /dev/null
@@ -1,25 +0,0 @@
-package org.apache.maven.profiles;
-
-import org.apache.maven.model.Activation;
-
-/*
- * Copyright 2001-2005 The Apache Software Foundation.
- *
- * Licensed under the Apache License, Version 2.0 (the "License");
- * you may not use this file except in compliance with the License.
- * You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-
-public class AlwaysOnActivation
-    extends Activation
-{
-
-}
diff --git a/maven-project/src/main/java/org/apache/maven/profiles/DefaultProfileManager.java b/maven-project/src/main/java/org/apache/maven/profiles/DefaultProfileManager.java
new file mode 100644
index 000000000..afa732c5a
--- /dev/null
+++ b/maven-project/src/main/java/org/apache/maven/profiles/DefaultProfileManager.java
@@ -0,0 +1,214 @@
+package org.apache.maven.profiles;
+
+import org.apache.maven.model.Profile;
+import org.apache.maven.profiles.activation.ProfileActivationException;
+import org.apache.maven.profiles.activation.ProfileActivator;
+import org.codehaus.plexus.PlexusContainer;
+import org.codehaus.plexus.component.repository.exception.ComponentLifecycleException;
+import org.codehaus.plexus.component.repository.exception.ComponentLookupException;
+
+import java.util.ArrayList;
+import java.util.HashMap;
+import java.util.HashSet;
+import java.util.Iterator;
+import java.util.List;
+import java.util.Map;
+import java.util.Set;
+import java.util.Map.Entry;
+
+/*
+ * Copyright 2001-2005 The Apache Software Foundation.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+public class DefaultProfileManager implements ProfileManager
+{
+    private PlexusContainer container;
+
+    private Set activatedIds = new HashSet();
+    private Set deactivatedIds = new HashSet();
+    
+    private Map profilesById = new HashMap();
+    
+    public DefaultProfileManager( PlexusContainer container )
+    {
+        this.container = container;
+    }
+    
+    public DefaultProfileManager( ProfileManager globals, PlexusContainer container )
+    {
+        this.container = container;
+        
+        this.activatedIds.addAll( globals.getActivatedIds() );
+        this.deactivatedIds.addAll( globals.getDeactivatedIds() );
+        this.profilesById.putAll( globals.getProfilesById() );
+    }
+    
+    public Set getActivatedIds()
+    {
+        return activatedIds;
+    }
+    
+    public Set getDeactivatedIds()
+    {
+        return deactivatedIds;
+    }
+    
+    public Map getProfilesById()
+    {
+        return profilesById;
+    }
+    
+    /* (non-Javadoc)
+     * @see org.apache.maven.profiles.ProfileManager#addProfile(org.apache.maven.model.Profile)
+     */
+    public void addProfile( Profile profile )
+    {
+        String profileId = profile.getId();
+        
+        Profile existing = (Profile) profilesById.get( profileId );
+        if ( existing != null )
+        {
+            container.getLogger().warn(
+                                        "Overriding profile: \'" + profileId + "\' (source: " + existing.getSource()
+                                            + ") with new instance from source: " + profile.getSource() );
+        }
+        
+        profilesById.put( profile.getId(), profile );
+    }
+    
+    /* (non-Javadoc)
+     * @see org.apache.maven.profiles.ProfileManager#explicitlyActivate(java.lang.String)
+     */
+    public void explicitlyActivate( String profileId )
+    {
+        container.getLogger().debug( "Profile with id: \'" + profileId + "\' has been explicitly activated." );
+        
+        activatedIds.add( profileId );
+    }
+    
+    /* (non-Javadoc)
+     * @see org.apache.maven.profiles.ProfileManager#explicitlyActivate(java.util.List)
+     */
+    public void explicitlyActivate( List profileIds )
+    {
+        for ( Iterator it = profileIds.iterator(); it.hasNext(); )
+        {
+            String profileId = (String) it.next();
+            
+            explicitlyActivate( profileId );
+        }
+    }
+    
+    /* (non-Javadoc)
+     * @see org.apache.maven.profiles.ProfileManager#explicitlyDeactivate(java.lang.String)
+     */
+    public void explicitlyDeactivate( String profileId )
+    {
+        container.getLogger().debug( "Profile with id: \'" + profileId + "\' has been explicitly deactivated." );
+        
+        deactivatedIds.add( profileId );
+    }
+    
+    /* (non-Javadoc)
+     * @see org.apache.maven.profiles.ProfileManager#explicitlyDeactivate(java.util.List)
+     */
+    public void explicitlyDeactivate( List profileIds )
+    {
+        for ( Iterator it = profileIds.iterator(); it.hasNext(); )
+        {
+            String profileId = (String) it.next();
+            
+            explicitlyDeactivate( profileId );
+        }
+    }
+    
+    /* (non-Javadoc)
+     * @see org.apache.maven.profiles.ProfileManager#getActiveProfiles()
+     */
+    public List getActiveProfiles() throws ProfileActivationException
+    {
+        List active = new ArrayList( profilesById.size() );
+        
+        for ( Iterator it = profilesById.entrySet().iterator(); it.hasNext(); )
+        {
+            Map.Entry entry = (Entry) it.next();
+            
+            String profileId = (String) entry.getKey();
+            Profile profile = (Profile) entry.getValue();
+            
+            if ( activatedIds.contains( profileId ) )
+            {
+                active.add( profile );
+            }
+            else if ( !deactivatedIds.contains( profileId ) && isActive( profile ) )
+            {
+                active.add( profile );
+            }
+        }
+        
+        return active;
+    }
+    
+    private boolean isActive( Profile profile )
+        throws ProfileActivationException
+    {
+        List activators = null;
+        try
+        {
+            activators = container.lookupList( ProfileActivator.ROLE );
+
+            for ( Iterator activatorIterator = activators.iterator(); activatorIterator.hasNext(); )
+            {
+                ProfileActivator activator = (ProfileActivator) activatorIterator.next();
+
+                if ( activator.canDetermineActivation( profile ) )
+                {
+                    return activator.isActive( profile );
+                }
+            }
+            
+            return false;
+        }
+        catch ( ComponentLookupException e )
+        {
+            throw new ProfileActivationException( "Cannot retrieve list of profile activators.", e );
+        }
+        finally
+        {
+            try
+            {
+                container.releaseAll( activators );
+            }
+            catch ( ComponentLifecycleException e )
+            {
+                container.getLogger().debug( "Error releasing profile activators - ignoring.", e );
+            }
+        }
+    }
+
+    /* (non-Javadoc)
+     * @see org.apache.maven.profiles.ProfileManager#addProfiles(java.util.List)
+     */
+    public void addProfiles( List profiles )
+    {
+        for ( Iterator it = profiles.iterator(); it.hasNext(); )
+        {
+            Profile profile = (Profile) it.next();
+            
+            addProfile( profile );
+        }
+    }
+    
+}
diff --git a/maven-project/src/main/java/org/apache/maven/profiles/ProfileManager.java b/maven-project/src/main/java/org/apache/maven/profiles/ProfileManager.java
new file mode 100644
index 000000000..aa8ec1fd6
--- /dev/null
+++ b/maven-project/src/main/java/org/apache/maven/profiles/ProfileManager.java
@@ -0,0 +1,34 @@
+package org.apache.maven.profiles;
+
+import org.apache.maven.model.Profile;
+import org.apache.maven.profiles.activation.ProfileActivationException;
+
+import java.util.List;
+import java.util.Map;
+import java.util.Set;
+
+public interface ProfileManager
+{
+
+    void addProfile( Profile profile );
+
+    void explicitlyActivate( String profileId );
+
+    void explicitlyActivate( List profileIds );
+
+    void explicitlyDeactivate( String profileId );
+
+    void explicitlyDeactivate( List profileIds );
+
+    List getActiveProfiles()
+        throws ProfileActivationException;
+
+    void addProfiles( List profiles );
+
+    public Set getActivatedIds();
+    
+    public Set getDeactivatedIds();
+    
+    public Map getProfilesById();
+    
+}
\ No newline at end of file
diff --git a/maven-project/src/main/java/org/apache/maven/profiles/activation/DetectedProfileActivator.java b/maven-project/src/main/java/org/apache/maven/profiles/activation/DetectedProfileActivator.java
index b2cadf7a1..a52b5ba65 100644
--- a/maven-project/src/main/java/org/apache/maven/profiles/activation/DetectedProfileActivator.java
+++ b/maven-project/src/main/java/org/apache/maven/profiles/activation/DetectedProfileActivator.java
@@ -23,7 +23,7 @@ public abstract class DetectedProfileActivator
 {
     public boolean canDetermineActivation( Profile profile )
     {
-        return !ProfileActivationUtils.profilesWereExplicitlyGiven() && canDetectActivation( profile );
+        return canDetectActivation( profile );
     }
 
     protected abstract boolean canDetectActivation( Profile profile );
diff --git a/maven-project/src/main/java/org/apache/maven/profiles/activation/ExplicitListingProfileActivator.java b/maven-project/src/main/java/org/apache/maven/profiles/activation/ExplicitListingProfileActivator.java
deleted file mode 100644
index 128fa8ed5..000000000
--- a/maven-project/src/main/java/org/apache/maven/profiles/activation/ExplicitListingProfileActivator.java
+++ /dev/null
@@ -1,34 +0,0 @@
-package org.apache.maven.profiles.activation;
-
-import org.apache.maven.model.Profile;
-
-/*
- * Copyright 2001-2005 The Apache Software Foundation.
- *
- * Licensed under the Apache License, Version 2.0 (the "License");
- * you may not use this file except in compliance with the License.
- * You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-
-public class ExplicitListingProfileActivator
-    implements ProfileActivator
-{
-    public boolean canDetermineActivation( Profile profile )
-    {
-        return ProfileActivationUtils.profilesWereExplicitlyGiven();
-    }
-
-    public boolean isActive( Profile profile )
-    {
-        return ProfileActivationUtils.getExplicitProfileList().contains( profile.getId() );
-    }
-
-}
diff --git a/maven-project/src/main/java/org/apache/maven/profiles/activation/ProfileActivationCalculator.java b/maven-project/src/main/java/org/apache/maven/profiles/activation/ProfileActivationCalculator.java
deleted file mode 100644
index 9dde6c515..000000000
--- a/maven-project/src/main/java/org/apache/maven/profiles/activation/ProfileActivationCalculator.java
+++ /dev/null
@@ -1,105 +0,0 @@
-package org.apache.maven.profiles.activation;
-
-import org.apache.maven.model.Activation;
-import org.apache.maven.model.Profile;
-import org.apache.maven.project.ProjectBuildingException;
-import org.codehaus.plexus.PlexusConstants;
-import org.codehaus.plexus.PlexusContainer;
-import org.codehaus.plexus.component.repository.exception.ComponentLifecycleException;
-import org.codehaus.plexus.component.repository.exception.ComponentLookupException;
-import org.codehaus.plexus.context.Context;
-import org.codehaus.plexus.context.ContextException;
-import org.codehaus.plexus.logging.AbstractLogEnabled;
-import org.codehaus.plexus.personality.plexus.lifecycle.phase.Contextualizable;
-
-import java.util.ArrayList;
-import java.util.Iterator;
-import java.util.List;
-
-/*
- * Copyright 2001-2005 The Apache Software Foundation.
- *
- * Licensed under the Apache License, Version 2.0 (the "License");
- * you may not use this file except in compliance with the License.
- * You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-
-public class ProfileActivationCalculator
-    extends AbstractLogEnabled
-    implements Contextualizable
-{
-    public static final String ROLE = ProfileActivationCalculator.class.getName();
-
-    private PlexusContainer container;
-
-    public List calculateActiveProfiles( List profiles )
-        throws ProjectBuildingException
-    {
-        List activators = null;
-        try
-        {
-            activators = container.lookupList( ProfileActivator.ROLE );
-
-            List active = new ArrayList( profiles.size() );
-
-            for ( Iterator it = profiles.iterator(); it.hasNext(); )
-            {
-                Profile profile = (Profile) it.next();
-
-                boolean isActive = true;
-
-                Activation activation = profile.getActivation();
-
-                activatorLoop:
-                for ( Iterator activatorIterator = activators.iterator(); activatorIterator.hasNext(); )
-                {
-                    ProfileActivator activator = (ProfileActivator) activatorIterator.next();
-
-                    if ( activator.canDetermineActivation( profile ) )
-                    {
-                        if ( activator.isActive( profile ) )
-                        {
-                            active.add( profile );
-                        }
-                        else
-                        {
-                            break activatorLoop;
-                        }
-                    }
-                }
-            }
-
-            return active;
-        }
-        catch ( ComponentLookupException e )
-        {
-            throw new ProjectBuildingException( "Cannot retrieve list of profile activators.", e );
-        }
-        finally
-        {
-            try
-            {
-                container.releaseAll( activators );
-            }
-            catch ( ComponentLifecycleException e )
-            {
-                getLogger().debug( "Error releasing profile activators - ignoring.", e );
-            }
-        }
-    }
-
-    public void contextualize( Context context )
-        throws ContextException
-    {
-        this.container = (PlexusContainer) context.get( PlexusConstants.PLEXUS_KEY );
-    }
-
-}
diff --git a/maven-project/src/main/java/org/apache/maven/profiles/activation/ProfileActivationException.java b/maven-project/src/main/java/org/apache/maven/profiles/activation/ProfileActivationException.java
new file mode 100644
index 000000000..b8755e65f
--- /dev/null
+++ b/maven-project/src/main/java/org/apache/maven/profiles/activation/ProfileActivationException.java
@@ -0,0 +1,17 @@
+package org.apache.maven.profiles.activation;
+
+public class ProfileActivationException
+    extends Exception
+{
+
+    public ProfileActivationException( String message, Throwable cause )
+    {
+        super( message, cause );
+    }
+
+    public ProfileActivationException( String message )
+    {
+        super( message );
+    }
+
+}
diff --git a/maven-project/src/main/java/org/apache/maven/profiles/activation/ProfileActivationUtils.java b/maven-project/src/main/java/org/apache/maven/profiles/activation/ProfileActivationUtils.java
deleted file mode 100644
index 58c39f0b2..000000000
--- a/maven-project/src/main/java/org/apache/maven/profiles/activation/ProfileActivationUtils.java
+++ /dev/null
@@ -1,67 +0,0 @@
-package org.apache.maven.profiles.activation;
-
-import org.codehaus.plexus.util.StringUtils;
-
-import java.util.ArrayList;
-import java.util.List;
-import java.util.StringTokenizer;
-
-/*
- * Copyright 2001-2005 The Apache Software Foundation.
- *
- * Licensed under the Apache License, Version 2.0 (the "License");
- * you may not use this file except in compliance with the License.
- * You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-
-public final class ProfileActivationUtils
-{
-    public static final String ACTIVE_PROFILE_IDS = "org.apache.maven.ActiveProfiles";
-
-    private static List profileList;
-
-    private ProfileActivationUtils()
-    {
-    }
-
-    public static boolean profilesWereExplicitlyGiven()
-    {
-        return StringUtils.isNotEmpty( System.getProperty( ACTIVE_PROFILE_IDS ) );
-    }
-
-    public static List getExplicitProfileList()
-    {
-        if ( !profilesWereExplicitlyGiven() )
-        {
-            return null;
-        }
-
-        if ( profileList == null )
-        {
-            profileList = new ArrayList();
-
-            StringTokenizer profileTokens = new StringTokenizer( System.getProperty( ACTIVE_PROFILE_IDS ), "," );
-
-            while ( profileTokens.hasMoreTokens() )
-            {
-                String token = profileTokens.nextToken().trim();
-
-                if ( StringUtils.isNotEmpty( token ) )
-                {
-                    profileList.add( token );
-                }
-            }
-        }
-
-        return profileList;
-    }
-
-}
diff --git a/maven-project/src/main/java/org/apache/maven/project/DefaultMavenProjectBuilder.java b/maven-project/src/main/java/org/apache/maven/project/DefaultMavenProjectBuilder.java
index 2a310a116..46c2623d3 100644
--- a/maven-project/src/main/java/org/apache/maven/project/DefaultMavenProjectBuilder.java
+++ b/maven-project/src/main/java/org/apache/maven/project/DefaultMavenProjectBuilder.java
@@ -40,7 +40,12 @@ import org.apache.maven.model.Profile;
 import org.apache.maven.model.ReportPlugin;
 import org.apache.maven.model.Repository;
 import org.apache.maven.model.io.xpp3.MavenXpp3Reader;
-import org.apache.maven.profiles.activation.ProfileActivationCalculator;
+import org.apache.maven.profiles.DefaultProfileManager;
+import org.apache.maven.profiles.MavenProfilesBuilder;
+import org.apache.maven.profiles.ProfileManager;
+import org.apache.maven.profiles.ProfilesConversionUtils;
+import org.apache.maven.profiles.ProfilesRoot;
+import org.apache.maven.profiles.activation.ProfileActivationException;
 import org.apache.maven.project.inheritance.ModelInheritanceAssembler;
 import org.apache.maven.project.injection.ModelDefaultsInjector;
 import org.apache.maven.project.injection.ProfileInjector;
@@ -90,6 +95,8 @@ public class DefaultMavenProjectBuilder
     // TODO: remove
     private PlexusContainer container;
 
+    protected MavenProfilesBuilder profilesBuilder;
+
     protected ArtifactResolver artifactResolver;
 
     protected ArtifactMetadataSource artifactMetadataSource;
@@ -113,8 +120,6 @@ public class DefaultMavenProjectBuilder
 
     private ArtifactRepositoryFactory artifactRepositoryFactory;
 
-    private ProfileActivationCalculator profileActivationCalculator;
-
     private final Map modelCache = new HashMap();
 
     public static final String MAVEN_MODEL_VERSION = "4.0.0";
@@ -133,11 +138,10 @@ public class DefaultMavenProjectBuilder
     /**
      * @todo move to metadatasource itself?
      */
-    public MavenProject buildWithDependencies( File projectDescriptor, ArtifactRepository localRepository,
-                                               List externalProfiles )
+    public MavenProject buildWithDependencies( File projectDescriptor, ArtifactRepository localRepository, ProfileManager profileManager )
         throws ProjectBuildingException, ArtifactResolutionException
     {
-        MavenProject project = buildFromSourceFile( projectDescriptor, localRepository, externalProfiles );
+        MavenProject project = buildFromSourceFile( projectDescriptor, localRepository, profileManager );
 
         // ----------------------------------------------------------------------
         // Typically when the project builder is being used from maven proper
@@ -224,14 +228,13 @@ public class DefaultMavenProjectBuilder
         return map;
     }
 
-    public MavenProject build( File projectDescriptor, ArtifactRepository localRepository, List externalProfiles )
+    public MavenProject build( File projectDescriptor, ArtifactRepository localRepository, ProfileManager profileManager )
         throws ProjectBuildingException
     {
-        return buildFromSourceFile( projectDescriptor, localRepository, externalProfiles );
+        return buildFromSourceFile( projectDescriptor, localRepository, profileManager );
     }
 
-    private MavenProject buildFromSourceFile( File projectDescriptor, ArtifactRepository localRepository,
-                                              List externalProfiles )
+    private MavenProject buildFromSourceFile( File projectDescriptor, ArtifactRepository localRepository, ProfileManager profileManager )
         throws ProjectBuildingException
     {
         Model model = readModel( projectDescriptor );
@@ -240,8 +243,7 @@ public class DefaultMavenProjectBuilder
         modelCache.put( createCacheKey( model.getGroupId(), model.getArtifactId(), model.getVersion() ), model );
 
         MavenProject project = build( projectDescriptor.getAbsolutePath(), model, localRepository,
-                                      Collections.EMPTY_LIST, externalProfiles,
-                                      projectDescriptor.getAbsoluteFile().getParentFile() );
+                                      Collections.EMPTY_LIST, projectDescriptor.getAbsoluteFile().getParentFile(), profileManager );
 
         if ( project.getDistributionManagement() != null && project.getDistributionManagement().getStatus() != null )
         {
@@ -277,7 +279,7 @@ public class DefaultMavenProjectBuilder
         Model model = findModelFromRepository( artifact, remoteArtifactRepositories, localRepository );
 
         return build( "Artifact [" + artifact.getId() + "]", model, localRepository, remoteArtifactRepositories,
-                      Collections.EMPTY_LIST, null );
+                      null, null );
     }
 
     private Model findModelFromRepository( Artifact artifact, List remoteArtifactRepositories,
@@ -387,7 +389,7 @@ public class DefaultMavenProjectBuilder
     }
 
     private MavenProject build( String pomLocation, Model model, ArtifactRepository localRepository,
-                                List parentSearchRepositories, List externalProfiles, File projectDir )
+                                List parentSearchRepositories, File projectDir, ProfileManager profileManager )
         throws ProjectBuildingException
     {
         Model superModel = getSuperModel();
@@ -401,7 +403,24 @@ public class DefaultMavenProjectBuilder
                                                                                           artifactRepositoryFactory,
                                                                                           container ) );
 
-        for ( Iterator i = externalProfiles.iterator(); i.hasNext(); )
+        List activeExternalProfiles;
+        try
+        {
+            if ( profileManager != null )
+            {
+                activeExternalProfiles = profileManager.getActiveProfiles();
+            }
+            else
+            {
+                activeExternalProfiles = Collections.EMPTY_LIST;
+            }
+        }
+        catch ( ProfileActivationException e )
+        {
+            throw new ProjectBuildingException( "Failed to calculate active external profiles.", e );
+        }
+        
+        for ( Iterator i = activeExternalProfiles.iterator(); i.hasNext(); )
         {
             Profile externalProfile = (Profile) i.next();
 
@@ -419,8 +438,8 @@ public class DefaultMavenProjectBuilder
 
         Model originalModel = ModelUtils.cloneModel( model );
 
-        MavenProject project = assembleLineage( model, lineage, localRepository, externalProfiles, projectDir,
-                                                parentSearchRepositories, aggregatedRemoteWagonRepositories );
+        MavenProject project = assembleLineage( model, lineage, localRepository, projectDir, parentSearchRepositories,
+                                                aggregatedRemoteWagonRepositories );
 
         project.setOriginalModel( originalModel );
 
@@ -440,8 +459,7 @@ public class DefaultMavenProjectBuilder
 
         try
         {
-            project = processProjectLogic( pomLocation, project, new ArrayList( aggregatedRemoteWagonRepositories ),
-                                           externalProfiles );
+            project = processProjectLogic( pomLocation, project, new ArrayList( aggregatedRemoteWagonRepositories ), profileManager );
         }
         catch ( ModelInterpolationException e )
         {
@@ -460,8 +478,7 @@ public class DefaultMavenProjectBuilder
      * the resolved source roots, etc for the parent - that occurs for the parent when it is constructed independently
      * and projects are not cached or reused
      */
-    private MavenProject processProjectLogic( String pomLocation, MavenProject project, List remoteRepositories,
-                                              List externalProfiles )
+    private MavenProject processProjectLogic( String pomLocation, MavenProject project, List remoteRepositories, ProfileManager profileMgr )
         throws ProjectBuildingException, ModelInterpolationException
     {
         Model model = project.getModel();
@@ -471,26 +488,26 @@ public class DefaultMavenProjectBuilder
         {
             modelCache.put( key, model );
         }
-
-        List activeProfiles = new ArrayList( externalProfiles );
-
-        List activePomProfiles = profileActivationCalculator.calculateActiveProfiles( model.getProfiles() );
-
-        activeProfiles.addAll( activePomProfiles );
-
-        Properties profileProperties = new Properties();
-
-        for ( Iterator it = activeProfiles.iterator(); it.hasNext(); )
+        
+        Properties profileProperties = project.getProfileProperties();
+        
+        if ( profileProperties == null )
         {
-            Profile profile = (Profile) it.next();
-
-            profileInjector.inject( profile, model );
-
-            profileProperties.putAll( profile.getProperties() );
+            profileProperties = new Properties();
         }
+        
+        List activeProfiles = project.getActiveProfiles();
+        
+        if ( activeProfiles == null )
+        {
+            activeProfiles = new ArrayList();
+        }
+        
+        List injectedProfiles = injectActiveProfiles( profileMgr, model, profileProperties );
+        
+        activeProfiles.addAll( injectedProfiles );
 
         // TODO: Clean this up...we're using this to 'jump' the interpolation step for model properties not expressed in XML.
-
         model = modelInterpolator.interpolate( model );
 
         // interpolation is before injection, because interpolation is off-limits in the injected variables
@@ -507,13 +524,14 @@ public class DefaultMavenProjectBuilder
         //=======================================================================
         project = new MavenProject( model );
 
-        project.addProfileProperties( profileProperties );
-
+        project.setOriginalModel( originalModel );
+        
         project.setActiveProfiles( activeProfiles );
         
-        project.setOriginalModel( originalModel );
+        project.addProfileProperties( profileProperties );
+        
+        project.assembleProfilePropertiesInheritance();
         
-
         // TODO: maybe not strictly correct, while we should enfore that packaging has a type handler of the same id, we don't
         Artifact projectArtifact = artifactFactory.createBuildArtifact( project.getGroupId(), project.getArtifactId(),
                                                                         project.getVersion(), project.getPackaging() );
@@ -569,7 +587,7 @@ public class DefaultMavenProjectBuilder
      * @noinspection CollectionDeclaredAsConcreteClass
      */
     private MavenProject assembleLineage( Model model, LinkedList lineage, ArtifactRepository localRepository,
-                                          List externalProfiles, File projectDir, List parentSearchRepositories,
+                                          File projectDir, List parentSearchRepositories,
                                           Set aggregatedRemoteWagonRepositories )
         throws ProjectBuildingException
     {
@@ -589,8 +607,31 @@ public class DefaultMavenProjectBuilder
             }
         }
 
+        ProfileManager profileManager = new DefaultProfileManager( container );
+        
+        List activeProfiles;
+        
+        Properties profileProperties = new Properties();
+
+        try
+        {
+            profileManager.addProfiles( model.getProfiles() );
+            
+            loadProjectExternalProfiles( profileManager, projectDir );
+            
+            activeProfiles = injectActiveProfiles( profileManager, model, profileProperties );
+        }
+        catch ( ProfileActivationException e )
+        {
+            throw new ProjectBuildingException( "Failed to activate local (project-level) build profiles.", e );
+        }
+
         MavenProject project = new MavenProject( model );
 
+        project.addProfileProperties( profileProperties );
+
+        project.setActiveProfiles( activeProfiles );
+        
         lineage.addFirst( project );
 
         Parent parentModel = model.getParent();
@@ -686,8 +727,8 @@ public class DefaultMavenProjectBuilder
                 model = findModelFromRepository( parentArtifact, remoteRepositories, localRepository );
             }
 
-            MavenProject parent = assembleLineage( model, lineage, localRepository, externalProfiles, parentProjectDir,
-                                                   parentSearchRepositories, aggregatedRemoteWagonRepositories );
+            MavenProject parent = assembleLineage( model, lineage, localRepository, parentProjectDir, parentSearchRepositories, 
+                                                   aggregatedRemoteWagonRepositories );
 
             project.setParent( parent );
 
@@ -697,6 +738,69 @@ public class DefaultMavenProjectBuilder
         return project;
     }
 
+    private List injectActiveProfiles( ProfileManager profileManager, Model model, Properties profileProperties ) 
+        throws ProjectBuildingException
+    {
+        List activeProfiles;
+        
+        if ( profileManager != null )
+        {
+            try
+            {
+                activeProfiles = profileManager.getActiveProfiles();
+            }
+            catch ( ProfileActivationException e )
+            {
+                throw new ProjectBuildingException( "Failed to calculate active build profiles.", e );
+            }
+
+            for ( Iterator it = activeProfiles.iterator(); it.hasNext(); )
+            {
+                Profile profile = (Profile) it.next();
+
+                profileInjector.inject( profile, model );
+
+                profileProperties.putAll( profile.getProperties() );
+            }
+        }
+        else
+        {
+            activeProfiles = Collections.EMPTY_LIST;
+        }
+        
+        return activeProfiles;
+    }
+
+    private void loadProjectExternalProfiles( ProfileManager profileManager, File projectDir )
+        throws ProfileActivationException
+    {
+        if ( projectDir != null )
+        {
+            try
+            {
+                ProfilesRoot root = profilesBuilder.buildProfiles( projectDir );
+
+                if ( root != null )
+                {
+                    for ( Iterator it = root.getProfiles().iterator(); it.hasNext(); )
+                    {
+                        org.apache.maven.profiles.Profile rawProfile = (org.apache.maven.profiles.Profile) it.next();
+
+                        profileManager.addProfile( ProfilesConversionUtils.convertFromProfileXmlProfile( rawProfile ) );
+                    }
+                }
+            }
+            catch ( IOException e )
+            {
+                throw new ProfileActivationException( "Cannot read profiles.xml resource from directory: " + projectDir, e );
+            }
+            catch ( XmlPullParserException e )
+            {
+                throw new ProfileActivationException( "Cannot parse profiles.xml resource from directory: " + projectDir, e );
+            }
+        }
+    }
+
     private Model readModel( File file )
         throws ProjectBuildingException
     {
@@ -885,7 +989,7 @@ public class DefaultMavenProjectBuilder
         return extensionArtifacts;
     }
 
-    public MavenProject buildStandaloneSuperProject( ArtifactRepository localRepository, List externalProfiles )
+    public MavenProject buildStandaloneSuperProject( ArtifactRepository localRepository )
         throws ProjectBuildingException
     {
         Model superModel = getSuperModel();
@@ -907,7 +1011,7 @@ public class DefaultMavenProjectBuilder
             List remoteRepositories = ProjectUtils.buildArtifactRepositories( superModel.getRepositories(),
                                                                               artifactRepositoryFactory, container );
 
-            project = processProjectLogic( "<Super-POM>", project, remoteRepositories, externalProfiles );
+            project = processProjectLogic( "<Super-POM>", project, remoteRepositories, null );
 
             return project;
         }
diff --git a/maven-project/src/main/java/org/apache/maven/project/MavenProject.java b/maven-project/src/main/java/org/apache/maven/project/MavenProject.java
index dd6670e7f..223ae964d 100644
--- a/maven-project/src/main/java/org/apache/maven/project/MavenProject.java
+++ b/maven-project/src/main/java/org/apache/maven/project/MavenProject.java
@@ -61,6 +61,7 @@ import java.util.List;
 import java.util.Map;
 import java.util.Properties;
 import java.util.Set;
+import java.util.Stack;
 
 /**
  * The concern of the project is provide runtime values based on the model. <p/>
@@ -1309,5 +1310,32 @@ public class MavenProject
     {
         return groupId + ":" + artifactId;
     }
+
+    public void assembleProfilePropertiesInheritance()
+    {
+        Stack propertyStack = new Stack();
+        
+        MavenProject current = this;
+        while( current != null )
+        {
+            Properties toAdd = current.profileProperties;
+            
+            if ( toAdd != null && !toAdd.isEmpty() )
+            {
+                propertyStack.push( toAdd );
+            }
+            
+            current = current.getParent();
+        }
+        
+        Properties newProfilesProperties = new Properties();
+        
+        while( !propertyStack.isEmpty() )
+        {
+            newProfilesProperties.putAll( (Properties) propertyStack.pop() );
+        }
+        
+        this.profileProperties = newProfilesProperties;
+    }
     
 }
diff --git a/maven-project/src/main/java/org/apache/maven/project/MavenProjectBuilder.java b/maven-project/src/main/java/org/apache/maven/project/MavenProjectBuilder.java
index 2d8fbc27a..f6f43374c 100644
--- a/maven-project/src/main/java/org/apache/maven/project/MavenProjectBuilder.java
+++ b/maven-project/src/main/java/org/apache/maven/project/MavenProjectBuilder.java
@@ -19,6 +19,7 @@ package org.apache.maven.project;
 import org.apache.maven.artifact.Artifact;
 import org.apache.maven.artifact.repository.ArtifactRepository;
 import org.apache.maven.artifact.resolver.ArtifactResolutionException;
+import org.apache.maven.profiles.ProfileManager;
 
 import java.io.File;
 import java.util.List;
@@ -33,10 +34,10 @@ public interface MavenProjectBuilder
 
     String STANDALONE_SUPERPOM_VERSION = "2.0";
 
-    MavenProject build( File project, ArtifactRepository localRepository, List profiles )
+    MavenProject build( File project, ArtifactRepository localRepository, ProfileManager globalProfileManager )
         throws ProjectBuildingException;
 
-    MavenProject buildWithDependencies( File project, ArtifactRepository localRepository, List externalProfiles )
+    MavenProject buildWithDependencies( File project, ArtifactRepository localRepository, ProfileManager globalProfileManager )
         throws ProjectBuildingException, ArtifactResolutionException;
 
     /**
@@ -52,6 +53,6 @@ public interface MavenProjectBuilder
                                       ArtifactRepository localRepository )
         throws ProjectBuildingException;
 
-    MavenProject buildStandaloneSuperProject( ArtifactRepository localRepository, List externalProfiles )
+    MavenProject buildStandaloneSuperProject( ArtifactRepository localRepository )
         throws ProjectBuildingException;
 }
diff --git a/maven-project/src/main/resources/META-INF/plexus/components.xml b/maven-project/src/main/resources/META-INF/plexus/components.xml
index 077274bed..30ceb99b0 100644
--- a/maven-project/src/main/resources/META-INF/plexus/components.xml
+++ b/maven-project/src/main/resources/META-INF/plexus/components.xml
@@ -36,6 +36,9 @@
       <role>org.apache.maven.project.MavenProjectBuilder</role>
       <implementation>org.apache.maven.project.DefaultMavenProjectBuilder</implementation>
       <requirements>
+        <requirement>
+          <role>org.apache.maven.profiles.MavenProfilesBuilder</role>
+        </requirement>
         <requirement>
           <role>org.apache.maven.project.injection.ProfileInjector</role>
         </requirement>
@@ -63,20 +66,8 @@
         <requirement>
           <role>org.apache.maven.artifact.repository.ArtifactRepositoryFactory</role>
         </requirement>
-        <requirement>
-          <role>org.apache.maven.profiles.activation.ProfileActivationCalculator</role>
-        </requirement>
       </requirements>
     </component>
-<!--
-     |
-     |
-     |
-     -->
-    <component>
-      <role>org.apache.maven.profiles.activation.ProfileActivationCalculator</role>
-      <implementation>org.apache.maven.profiles.activation.ProfileActivationCalculator</implementation>
-    </component>
 <!--
      |
      |
@@ -107,16 +98,6 @@
       <role-hint>system-property</role-hint>
       <implementation>org.apache.maven.profiles.activation.SystemPropertyProfileActivator</implementation>
     </component>
-<!--
-     |
-     |
-     |
-     -->
-    <component>
-      <role>org.apache.maven.profiles.activation.ProfileActivator</role>
-      <role-hint>explicit-listing</role-hint>
-      <implementation>org.apache.maven.profiles.activation.ExplicitListingProfileActivator</implementation>
-    </component>
 <!--
      |
      |
diff --git a/maven-project/src/main/resources/org/apache/maven/project/pom-4.0.0.xml b/maven-project/src/main/resources/org/apache/maven/project/pom-4.0.0.xml
index 819d1202e..21a788e56 100644
--- a/maven-project/src/main/resources/org/apache/maven/project/pom-4.0.0.xml
+++ b/maven-project/src/main/resources/org/apache/maven/project/pom-4.0.0.xml
@@ -46,5 +46,37 @@
       </testResource>
     </testResources>
   </build>
+  
+  <profiles>
+    <profile>
+      <id>release-profile</id>
+      
+      <activation>
+        <property>
+          <name>performRelease</name>
+        </property>
+      </activation>
+      
+      <build>
+        <plugins>
+          <plugin>
+            <inherit>true</inherit>
+            <groupId>org.apache.maven.plugins</groupId>
+            <artifactId>maven-source-plugin</artifactId>
+          </plugin>
+          <plugin>
+            <inherit>true</inherit>
+            <groupId>org.apache.maven.plugins</groupId>
+            <artifactId>maven-deploy-plugin</artifactId>
+            
+            <configuration>
+              <updateReleaseInfo>true</updateReleaseInfo>
+            </configuration>
+          </plugin>
+        </plugins>
+      </build>
+    </profile>
+  </profiles>
+  
 </project>
     <!-- END SNIPPET: superpom -->
diff --git a/maven-project/src/test/java/org/apache/maven/project/MavenProjectTestCase.java b/maven-project/src/test/java/org/apache/maven/project/MavenProjectTestCase.java
index e5bdb69cc..566c559cd 100644
--- a/maven-project/src/test/java/org/apache/maven/project/MavenProjectTestCase.java
+++ b/maven-project/src/test/java/org/apache/maven/project/MavenProjectTestCase.java
@@ -20,12 +20,10 @@ import org.apache.maven.artifact.repository.ArtifactRepository;
 import org.apache.maven.artifact.repository.DefaultArtifactRepository;
 import org.apache.maven.artifact.repository.layout.ArtifactRepositoryLayout;
 import org.codehaus.plexus.PlexusTestCase;
-import org.codehaus.plexus.component.repository.exception.ComponentLookupException;
 
 import java.io.File;
 import java.io.FileNotFoundException;
 import java.net.URL;
-import java.util.Collections;
 
 /**
  * @author <a href="mailto:jason@maven.org">Jason van Zyl </a>
@@ -104,13 +102,13 @@ public abstract class MavenProjectTestCase
     protected MavenProject getProjectWithDependencies( File pom )
         throws Exception
     {
-        return projectBuilder.buildWithDependencies( pom, getLocalRepository(), Collections.EMPTY_LIST );
+        return projectBuilder.buildWithDependencies( pom, getLocalRepository(), null );
     }
 
     protected MavenProject getProject( File pom )
         throws Exception
     {
-        return projectBuilder.build( pom, getLocalRepository(), Collections.EMPTY_LIST );
+        return projectBuilder.build( pom, getLocalRepository(), null );
     }
 
 }
diff --git a/maven-project/src/test/resources/org/apache/maven/project/ProjectClasspathTest.xml b/maven-project/src/test/resources/org/apache/maven/project/ProjectClasspathTest.xml
index a301024f9..7b83dbfcd 100644
--- a/maven-project/src/test/resources/org/apache/maven/project/ProjectClasspathTest.xml
+++ b/maven-project/src/test/resources/org/apache/maven/project/ProjectClasspathTest.xml
@@ -37,6 +37,9 @@
       <role-hint>test</role-hint>
       <implementation>org.apache.maven.project.TestProjectBuilder</implementation>
       <requirements>
+        <requirement>
+          <role>org.apache.maven.profiles.MavenProfilesBuilder</role>
+        </requirement>
         <requirement>
           <role>org.apache.maven.project.injection.ModelDefaultsInjector</role>
         </requirement>
@@ -61,9 +64,6 @@
         <requirement>
           <role>org.apache.maven.artifact.repository.ArtifactRepositoryFactory</role>
         </requirement>
-        <requirement>
-          <role>org.apache.maven.profiles.activation.ProfileActivationCalculator</role>
-        </requirement>
       </requirements>
     </component>
   </components>
