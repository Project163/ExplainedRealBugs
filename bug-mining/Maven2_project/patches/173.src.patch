diff --git a/maven-project/src/main/java/org/apache/maven/project/DefaultMavenProjectBuilder.java b/maven-project/src/main/java/org/apache/maven/project/DefaultMavenProjectBuilder.java
index 46811b5d3..ea5bdaea6 100644
--- a/maven-project/src/main/java/org/apache/maven/project/DefaultMavenProjectBuilder.java
+++ b/maven-project/src/main/java/org/apache/maven/project/DefaultMavenProjectBuilder.java
@@ -78,7 +78,9 @@ import org.apache.maven.profiles.ProfileManager;
 import org.apache.maven.profiles.ProfilesConversionUtils;
 import org.apache.maven.profiles.ProfilesRoot;
 import org.apache.maven.profiles.activation.ProfileActivationException;
+import org.apache.maven.project.artifact.ArtifactWithProject;
 import org.apache.maven.project.artifact.InvalidDependencyVersionException;
+import org.apache.maven.project.artifact.ProjectArtifactFactory;
 import org.apache.maven.project.inheritance.ModelInheritanceAssembler;
 import org.apache.maven.project.injection.ModelDefaultsInjector;
 import org.apache.maven.project.injection.ProfileInjector;
@@ -151,7 +153,7 @@ public class DefaultMavenProjectBuilder
 
     protected ArtifactMetadataSource artifactMetadataSource;
 
-    private ArtifactFactory artifactFactory;
+    private ProjectArtifactFactory artifactFactory;
 
     private ModelInheritanceAssembler modelInheritanceAssembler;
 
@@ -1021,10 +1023,10 @@ public class DefaultMavenProjectBuilder
         project.setActiveProfiles( activeProfiles );
 
         // TODO: maybe not strictly correct, while we should enfore that packaging has a type handler of the same id, we don't
-        Artifact projectArtifact = artifactFactory.createBuildArtifact( project.getGroupId(), project.getArtifactId(),
-                                                                        project.getVersion(), project.getPackaging() );
-
+        Artifact projectArtifact = artifactFactory.create( project );
+        
         project.setArtifact( projectArtifact );
+        project.setProjectBuilderConfiguration( config );
 
         project.setPluginArtifactRepositories( ProjectUtils.buildArtifactRepositories( model.getPluginRepositories(),
                                                                                        artifactRepositoryFactory,
diff --git a/maven-project/src/main/java/org/apache/maven/project/MavenProject.java b/maven-project/src/main/java/org/apache/maven/project/MavenProject.java
index 0db3f9b20..4aba275fb 100644
--- a/maven-project/src/main/java/org/apache/maven/project/MavenProject.java
+++ b/maven-project/src/main/java/org/apache/maven/project/MavenProject.java
@@ -155,6 +155,8 @@ public class MavenProject
     
     private Logger logger;
     
+    private ProjectBuilderConfiguration projectBuilderConfiguration;
+    
     public MavenProject()
     {
         Model model = new Model();
@@ -2094,4 +2096,21 @@ public class MavenProject
         this.logger = logger;
     }
 
+    /**
+     * Retrieve the {@link ProjectBuilderConfiguration} instance used to construct this MavenProject instance.
+     */
+    public ProjectBuilderConfiguration getProjectBuilderConfiguration()
+    {
+        return projectBuilderConfiguration;
+    }
+
+    /**
+     * Set the {@link ProjectBuilderConfiguration} instance used to construct this MavenProject instance.
+     * @param projectBuilderConfiguration
+     */
+    public void setProjectBuilderConfiguration( ProjectBuilderConfiguration projectBuilderConfiguration )
+    {
+        this.projectBuilderConfiguration = projectBuilderConfiguration;
+    }
+
 }
diff --git a/maven-project/src/main/java/org/apache/maven/project/artifact/ActiveProjectArtifact.java b/maven-project/src/main/java/org/apache/maven/project/artifact/ActiveProjectArtifact.java
index 7e4f0bd92..c4ca97ae5 100644
--- a/maven-project/src/main/java/org/apache/maven/project/artifact/ActiveProjectArtifact.java
+++ b/maven-project/src/main/java/org/apache/maven/project/artifact/ActiveProjectArtifact.java
@@ -399,4 +399,9 @@ public class ActiveProjectArtifact
 
         return true;
     }
+
+    public ArtifactMetadata getMetadata( Class metadataClass )
+    {
+        return artifact.getMetadata( metadataClass );
+    }
 }
diff --git a/maven-project/src/main/java/org/apache/maven/project/artifact/ArtifactWithProject.java b/maven-project/src/main/java/org/apache/maven/project/artifact/ArtifactWithProject.java
new file mode 100644
index 000000000..b17ed54eb
--- /dev/null
+++ b/maven-project/src/main/java/org/apache/maven/project/artifact/ArtifactWithProject.java
@@ -0,0 +1,55 @@
+package org.apache.maven.project.artifact;
+
+import org.apache.maven.artifact.Artifact;
+import org.apache.maven.artifact.DefaultArtifact;
+import org.apache.maven.artifact.handler.ArtifactHandler;
+import org.apache.maven.artifact.versioning.VersionRange;
+import org.apache.maven.project.MavenProject;
+
+import java.util.Collection;
+import java.util.Iterator;
+
+public class ArtifactWithProject
+    extends DefaultArtifact
+{
+
+    private final MavenProject project;
+
+    public ArtifactWithProject( MavenProject project, String type, String classifier,
+                                ArtifactHandler artifactHandler, boolean optional )
+    {
+        super( project.getGroupId(), project.getArtifactId(), VersionRange.createFromVersion( project.getVersion() ),
+               null, type, classifier, artifactHandler, optional );
+        
+        this.project = project;
+    }
+
+    public MavenProject getProject()
+    {
+        return project;
+    }
+
+    public ProjectArtifactMetadata getProjectArtifactMetadata()
+    {
+        return getProjectArtifactMetadata( this );
+    }
+
+    public static ProjectArtifactMetadata getProjectArtifactMetadata( Artifact artifact )
+    {
+        Collection metadataList = artifact.getMetadataList();
+        if ( metadataList != null )
+        {
+            for ( Iterator it = metadataList.iterator(); it.hasNext(); )
+            {
+                Object metadata = it.next();
+                if ( metadata instanceof ProjectArtifactMetadata )
+                {
+                    return (ProjectArtifactMetadata) metadata;
+                }
+            }
+        }
+
+        return null;
+    }
+
+}
diff --git a/maven-project/src/main/java/org/apache/maven/project/artifact/ProjectArtifactFactory.java b/maven-project/src/main/java/org/apache/maven/project/artifact/ProjectArtifactFactory.java
new file mode 100644
index 000000000..857243b1f
--- /dev/null
+++ b/maven-project/src/main/java/org/apache/maven/project/artifact/ProjectArtifactFactory.java
@@ -0,0 +1,25 @@
+package org.apache.maven.project.artifact;
+
+import org.apache.maven.artifact.factory.DefaultArtifactFactory;
+import org.apache.maven.artifact.handler.ArtifactHandler;
+import org.apache.maven.project.MavenProject;
+
+public class ProjectArtifactFactory
+    extends DefaultArtifactFactory
+{
+    
+    public ArtifactWithProject create( MavenProject project )
+    {
+        ArtifactHandler handler = getArtifactHandlerManager().getArtifactHandler( project.getPackaging() );
+
+        return new ArtifactWithProject( project, project.getPackaging(), null, handler, false );
+    }
+
+    public ArtifactWithProject create( MavenProject project, String type, String classifier, boolean optional )
+    {
+        ArtifactHandler handler = getArtifactHandlerManager().getArtifactHandler( type );
+
+        return new ArtifactWithProject( project, type, classifier, handler, optional );
+    }
+
+}
diff --git a/maven-project/src/main/java/org/apache/maven/project/artifact/ProjectArtifactMetadata.java b/maven-project/src/main/java/org/apache/maven/project/artifact/ProjectArtifactMetadata.java
index a567b0948..0909183fa 100644
--- a/maven-project/src/main/java/org/apache/maven/project/artifact/ProjectArtifactMetadata.java
+++ b/maven-project/src/main/java/org/apache/maven/project/artifact/ProjectArtifactMetadata.java
@@ -38,7 +38,11 @@ import org.codehaus.plexus.util.FileUtils;
 public class ProjectArtifactMetadata
     extends AbstractArtifactMetadata
 {
-    private final File file;
+    private File originalFile;
+    
+    private File transformedFile;
+    
+    private boolean versionExpressionsResolved = false;
 
     public ProjectArtifactMetadata( Artifact artifact )
     {
@@ -49,7 +53,7 @@ public class ProjectArtifactMetadata
                                     File file )
     {
         super( artifact );
-        this.file = file;
+        this.originalFile = file;
     }
 
     public String getRemoteFilename()
@@ -71,6 +75,12 @@ public class ProjectArtifactMetadata
                                         ArtifactRepository remoteRepository )
         throws RepositoryMetadataStoreException
     {
+        File f = transformedFile == null ? originalFile : transformedFile;
+        if ( f == null )
+        {
+            return;
+        }
+        
         File destination = new File( localRepository.getBasedir(),
                                      localRepository.pathOfLocalRepositoryMetadata( this, remoteRepository ) );
 
@@ -83,7 +93,7 @@ public class ProjectArtifactMetadata
 
         try
         {
-            FileUtils.copyFile( file, destination );
+            FileUtils.copyFile( f, destination );
         }
         catch ( IOException e )
         {
@@ -114,9 +124,29 @@ public class ProjectArtifactMetadata
     public void merge( ArtifactMetadata metadata )
     {
         ProjectArtifactMetadata m = (ProjectArtifactMetadata) metadata;
-        if ( !m.file.equals( file ) )
+        if ( !m.originalFile.equals( originalFile ) )
         {
             throw new IllegalStateException( "Cannot add two different pieces of metadata for: " + getKey() );
         }
     }
+
+    public boolean isVersionExpressionsResolved()
+    {
+        return versionExpressionsResolved;
+    }
+
+    public void setVersionExpressionsResolved( boolean versionExpressionsResolved )
+    {
+        this.versionExpressionsResolved = versionExpressionsResolved;
+    }
+    
+    public void setFile( File file )
+    {
+        this.transformedFile = file;
+    }
+
+    public File getFile()
+    {
+        return transformedFile == null ? originalFile : transformedFile;
+    }
 }
diff --git a/maven-project/src/main/java/org/apache/maven/project/artifact/VersionExpressionTransformation.java b/maven-project/src/main/java/org/apache/maven/project/artifact/VersionExpressionTransformation.java
new file mode 100644
index 000000000..e2622791a
--- /dev/null
+++ b/maven-project/src/main/java/org/apache/maven/project/artifact/VersionExpressionTransformation.java
@@ -0,0 +1,396 @@
+package org.apache.maven.project.artifact;
+
+import org.apache.maven.artifact.Artifact;
+import org.apache.maven.artifact.deployer.ArtifactDeploymentException;
+import org.apache.maven.artifact.installer.ArtifactInstallationException;
+import org.apache.maven.artifact.repository.ArtifactRepository;
+import org.apache.maven.artifact.resolver.ArtifactNotFoundException;
+import org.apache.maven.artifact.resolver.ArtifactResolutionException;
+import org.apache.maven.artifact.transform.ArtifactTransformation;
+import org.apache.maven.model.Dependency;
+import org.apache.maven.model.Model;
+import org.apache.maven.model.Plugin;
+import org.apache.maven.model.ReportPlugin;
+import org.apache.maven.model.io.xpp3.MavenXpp3Reader;
+import org.apache.maven.model.io.xpp3.MavenXpp3Writer;
+import org.apache.maven.project.DefaultProjectBuilderConfiguration;
+import org.apache.maven.project.MavenProject;
+import org.apache.maven.project.ProjectBuilderConfiguration;
+import org.apache.maven.project.interpolation.ModelInterpolationException;
+import org.apache.maven.project.interpolation.StringSearchModelInterpolator;
+import org.codehaus.plexus.interpolation.InterpolationException;
+import org.codehaus.plexus.interpolation.InterpolationPostProcessor;
+import org.codehaus.plexus.interpolation.Interpolator;
+import org.codehaus.plexus.interpolation.ValueSource;
+import org.codehaus.plexus.interpolation.object.FieldBasedObjectInterpolator;
+import org.codehaus.plexus.personality.plexus.lifecycle.phase.Initializable;
+import org.codehaus.plexus.personality.plexus.lifecycle.phase.InitializationException;
+import org.codehaus.plexus.util.IOUtil;
+import org.codehaus.plexus.util.xml.pull.XmlPullParserException;
+
+import java.io.File;
+import java.io.FileReader;
+import java.io.FileWriter;
+import java.io.IOException;
+import java.io.Reader;
+import java.io.Writer;
+import java.lang.reflect.Field;
+import java.util.ArrayList;
+import java.util.HashSet;
+import java.util.Iterator;
+import java.util.List;
+import java.util.Set;
+
+public class VersionExpressionTransformation
+    extends StringSearchModelInterpolator
+    implements Initializable, ArtifactTransformation
+{
+
+    private static Set BLACKLISTED_FIELD_NAMES;
+    
+    private static final Set WHITELISTED_FIELD_NAMES;
+    
+    static
+    {
+        Set whitelist = new HashSet();
+        
+        whitelist.add( "version" );
+        whitelist.add( "dependencies" );
+        whitelist.add( "build" );
+        whitelist.add( "plugins" );
+        whitelist.add( "reporting" );
+        whitelist.add( "parent" );
+        
+        WHITELISTED_FIELD_NAMES = whitelist;
+    }
+
+    public void transformForDeployment( Artifact artifact, ArtifactRepository remoteRepository,
+                                        ArtifactRepository localRepository )
+        throws ArtifactDeploymentException
+    {
+        ProjectArtifactMetadata metadata = ArtifactWithProject.getProjectArtifactMetadata( artifact );
+        File pomFile;
+        boolean pomArtifact = false;
+        if ( "pom".equals( artifact.getType() ) )
+        {
+            System.out.println( "On Deploy: Using artifact file for POM: " + artifact );
+            pomFile = artifact.getFile();
+            pomArtifact = true;
+        }
+        // FIXME: We can't be this smart (yet) since the deployment step transforms from the 
+        // original POM once again and re-installs over the top of the install step.
+//        else if ( metadata == null || metadata.isVersionExpressionsResolved() )
+//        {
+//            return;
+//        }
+        else if ( metadata != null )
+        {
+            pomFile = metadata.getFile();
+        }
+        else
+        {
+            return;
+        }
+
+        try
+        {
+            File outFile = transformVersions( pomFile, artifact, localRepository );
+            
+            if ( pomArtifact )
+            {
+                // FIXME: We need a way to mark a POM artifact as resolved WRT version expressions, so we don't reprocess...
+                artifact.setFile( outFile );
+            }
+            else
+            {
+                metadata.setFile( outFile );
+                metadata.setVersionExpressionsResolved( true );
+            }
+        }
+        catch ( IOException e )
+        {
+            throw new ArtifactDeploymentException( "Failed to read or write POM for version transformation.", e );
+        }
+        catch ( XmlPullParserException e )
+        {
+            throw new ArtifactDeploymentException(
+                                                   "Failed to parse POM for version transformation. Error was in file: "
+                                                       + pomFile + ", at line: " + e.getLineNumber() + ", column: "
+                                                       + e.getColumnNumber(), e );
+        }
+        catch ( ModelInterpolationException e )
+        {
+            throw new ArtifactDeploymentException( "Failed to interpolate POM versions.", e );
+        }
+    }
+
+    public void transformForInstall( Artifact artifact, ArtifactRepository localRepository )
+        throws ArtifactInstallationException
+    {
+        ProjectArtifactMetadata metadata = (ProjectArtifactMetadata) artifact.getMetadata( ProjectArtifactMetadata.class );
+        File pomFile;
+        boolean pomArtifact = false;
+        if ( "pom".equals( artifact.getType() ) )
+        {
+            System.out.println( "On Install: Using artifact file for POM: " + artifact );
+            pomFile = artifact.getFile();
+            pomArtifact = true;
+        }
+        // FIXME: We can't be this smart (yet) since the deployment step transforms from the 
+        // original POM once again and re-installs over the top of the install step.
+//        else if ( metadata == null || metadata.isVersionExpressionsResolved() )
+//        {
+//            return;
+//        }
+        else if ( metadata != null )
+        {
+            pomFile = metadata.getFile();
+        }
+        else
+        {
+            return;
+        }
+
+        try
+        {
+            File outFile = transformVersions( pomFile, artifact, localRepository );
+            
+            if ( pomArtifact )
+            {
+                // FIXME: We need a way to mark a POM artifact as resolved WRT version expressions, so we don't reprocess...
+                artifact.setFile( outFile );
+            }
+            else
+            {
+                metadata.setFile( outFile );
+                metadata.setVersionExpressionsResolved( true );
+            }
+        }
+        catch ( IOException e )
+        {
+            throw new ArtifactInstallationException( "Failed to read or write POM for version transformation.", e );
+        }
+        catch ( XmlPullParserException e )
+        {
+            throw new ArtifactInstallationException(
+                                                     "Failed to parse POM for version transformation. Error was in file: "
+                                                         + pomFile + ", at line: " + e.getLineNumber() + ", column: "
+                                                         + e.getColumnNumber(), e );
+        }
+        catch ( ModelInterpolationException e )
+        {
+            throw new ArtifactInstallationException( "Failed to interpolate POM versions.", e );
+        }
+    }
+
+    public void transformForResolve( Artifact artifact, List remoteRepositories, ArtifactRepository localRepository )
+        throws ArtifactResolutionException, ArtifactNotFoundException
+    {
+        return;
+    }
+
+    protected File transformVersions( File pomFile, Artifact artifact, ArtifactRepository localRepository )
+        throws IOException, XmlPullParserException, ModelInterpolationException
+    {
+        ProjectBuilderConfiguration pbConfig;
+        File projectDir;
+        File outputFile;
+        if ( artifact instanceof ArtifactWithProject )
+        {
+            MavenProject project = ( (ArtifactWithProject) artifact ).getProject();
+
+            projectDir = project.getBasedir();
+            pbConfig = project.getProjectBuilderConfiguration();
+            outputFile = new File( project.getBuild().getDirectory(), "pom-transformed.xml" );
+        }
+        else
+        {
+            getLogger().info(
+                              "Artifact: " + artifact
+                                  + " does not have project-builder metadata (ProjectBuilderConfiguration) associated with it.\n"
+                                  + "Cannot access CLI properties for version transformation." );
+            
+            pbConfig = new DefaultProjectBuilderConfiguration().setLocalRepository( localRepository );
+            projectDir = pomFile.getAbsoluteFile().getParentFile();
+            outputFile = new File( projectDir, "target/pom-transformed.xml" );
+        }
+
+        Reader reader = null;
+        Model model;
+        try
+        {
+            reader = new FileReader( pomFile );
+            model = new MavenXpp3Reader().read( reader );
+        }
+        finally
+        {
+            IOUtil.close( reader );
+        }
+        
+        interpolateVersions( model, projectDir, pbConfig );
+        
+        Writer writer = null;
+        try
+        {
+            outputFile.getParentFile().mkdirs();
+            
+            writer = new FileWriter( outputFile );
+            
+            new MavenXpp3Writer().write( writer, model );
+        }
+        finally
+        {
+            IOUtil.close( writer );
+        }
+        
+        return outputFile;
+    }
+
+    protected void interpolateVersions( Model model, File projectDir, ProjectBuilderConfiguration config )
+        throws ModelInterpolationException
+    {
+        boolean debugEnabled = getLogger().isDebugEnabled();
+
+        Interpolator interpolator = getInterpolator();
+
+        List valueSources = createValueSources( model, projectDir, config );
+        List postProcessors = createPostProcessors( model, projectDir, config );
+
+        synchronized ( this )
+        {
+            for ( Iterator it = valueSources.iterator(); it.hasNext(); )
+            {
+                ValueSource vs = (ValueSource) it.next();
+                interpolator.addValueSource( vs );
+            }
+
+            for ( Iterator it = postProcessors.iterator(); it.hasNext(); )
+            {
+                InterpolationPostProcessor postProcessor = (InterpolationPostProcessor) it.next();
+
+                interpolator.addPostProcessor( postProcessor );
+            }
+
+            try
+            {
+                FieldBasedObjectInterpolator objInterpolator =
+                    new FieldBasedObjectInterpolator( BLACKLISTED_FIELD_NAMES,
+                                                      FieldBasedObjectInterpolator.DEFAULT_BLACKLISTED_PACKAGE_PREFIXES );
+
+                try
+                {
+                    objInterpolator.interpolate( model, getInterpolator(), getRecursionInterceptor() );
+                }
+                catch ( InterpolationException e )
+                {
+                    throw new ModelInterpolationException( e.getMessage(), e );
+                }
+
+                if ( debugEnabled )
+                {
+                    List feedback = new ArrayList();
+                    if ( objInterpolator.hasWarnings() )
+                    {
+                        feedback.addAll( objInterpolator.getWarnings() );
+                    }
+
+                    List internalFeedback = interpolator.getFeedback();
+                    if ( internalFeedback != null && !internalFeedback.isEmpty() )
+                    {
+                        feedback.addAll( internalFeedback );
+                    }
+
+                    if ( feedback != null && !feedback.isEmpty() )
+                    {
+                        getLogger().debug( "Maven encountered the following problems while transforming POM versions:" );
+
+                        Object last = null;
+                        for ( Iterator it = feedback.iterator(); it.hasNext(); )
+                        {
+                            Object next = it.next();
+
+                            if ( next instanceof Throwable )
+                            {
+                                if ( last == null )
+                                {
+                                    getLogger().debug( "", ( (Throwable) next ) );
+                                }
+                                else
+                                {
+                                    getLogger().debug( String.valueOf( last ), ( (Throwable) next ) );
+                                }
+                            }
+                            else
+                            {
+                                if ( last != null )
+                                {
+                                    getLogger().debug( String.valueOf( last ) );
+                                }
+
+                                last = next;
+                            }
+                        }
+
+                        if ( last != null )
+                        {
+                            getLogger().debug( String.valueOf( last ) );
+                        }
+                    }
+                }
+
+                interpolator.clearFeedback();
+            }
+            finally
+            {
+                for ( Iterator iterator = valueSources.iterator(); iterator.hasNext(); )
+                {
+                    ValueSource vs = (ValueSource) iterator.next();
+                    interpolator.removeValuesSource( vs );
+                }
+
+                for ( Iterator iterator = postProcessors.iterator(); iterator.hasNext(); )
+                {
+                    InterpolationPostProcessor postProcessor = (InterpolationPostProcessor) iterator.next();
+                    interpolator.removePostProcessor( postProcessor );
+                }
+
+                getInterpolator().clearAnswers();
+            }
+        }
+
+        // if ( error != null )
+        // {
+        // throw error;
+        // }
+    }
+
+    public void initialize()
+        throws InitializationException
+    {
+        super.initialize();
+        
+        synchronized ( VersionExpressionTransformation.class )
+        {
+            if ( BLACKLISTED_FIELD_NAMES == null )
+            {
+                Set fieldNames = new HashSet();
+
+                Class[] classes = { Model.class, Dependency.class, Plugin.class, ReportPlugin.class };
+                for ( int i = 0; i < classes.length; i++ )
+                {
+                    Field[] fields = classes[i].getDeclaredFields();
+                    for ( int j = 0; j < fields.length; j++ )
+                    {
+                        if ( !WHITELISTED_FIELD_NAMES.contains( fields[j].getName() ) )
+                        {
+                            fieldNames.add( fields[j].getName() );
+                        }
+                    }
+                }
+
+                BLACKLISTED_FIELD_NAMES = fieldNames;
+            }
+        }
+    }
+
+}
diff --git a/maven-project/src/main/java/org/apache/maven/project/interpolation/AbstractStringBasedModelInterpolator.java b/maven-project/src/main/java/org/apache/maven/project/interpolation/AbstractStringBasedModelInterpolator.java
index 05891f66c..3422a2148 100644
--- a/maven-project/src/main/java/org/apache/maven/project/interpolation/AbstractStringBasedModelInterpolator.java
+++ b/maven-project/src/main/java/org/apache/maven/project/interpolation/AbstractStringBasedModelInterpolator.java
@@ -378,9 +378,19 @@ public abstract class AbstractStringBasedModelInterpolator
         return result;
     }
     
+    protected RecursionInterceptor getRecursionInterceptor()
+    {
+        return recursionInterceptor;
+    }
+
+    protected void setRecursionInterceptor( RecursionInterceptor recursionInterceptor )
+    {
+        this.recursionInterceptor = recursionInterceptor;
+    }
+
     protected abstract Interpolator createInterpolator();
 
-    public final void initialize()
+    public void initialize()
         throws InitializationException
     {
         interpolator = createInterpolator();
diff --git a/maven-project/src/main/resources/META-INF/plexus/components.xml b/maven-project/src/main/resources/META-INF/plexus/components.xml
index 58759d1a0..af9f68fa5 100644
--- a/maven-project/src/main/resources/META-INF/plexus/components.xml
+++ b/maven-project/src/main/resources/META-INF/plexus/components.xml
@@ -19,6 +19,16 @@ under the License.
 
 <component-set>
   <components>
+    <component>
+      <role>org.apache.maven.project.artifact.ProjectArtifactFactory</role>
+      <role-hint>maven-project</role-hint>
+      <implementation>org.apache.maven.project.artifact.ProjectArtifactFactory</implementation>
+      <requirements>
+        <requirement>
+          <role>org.apache.maven.artifact.handler.manager.ArtifactHandlerManager</role>
+        </requirement>
+      </requirements>
+    </component>
 <!--
      |
      |
@@ -33,6 +43,21 @@ under the License.
         </requirement>
       </requirements>
     </component>
+<!--
+     |
+     |
+     |
+     -->
+    <component>
+      <role>org.apache.maven.artifact.transform.ArtifactTransformation</role>
+      <role-hint>version-expression</role-hint>
+      <implementation>org.apache.maven.project.artifact.VersionExpressionTransformation</implementation>
+      <requirements>
+        <requirement>
+          <role>org.apache.maven.project.path.PathTranslator</role>
+        </requirement>
+      </requirements>
+    </component>
 <!--
      |
      |
@@ -96,7 +121,8 @@ under the License.
           <role>org.apache.maven.project.path.PathTranslator</role>
         </requirement>
         <requirement>
-          <role>org.apache.maven.artifact.factory.ArtifactFactory</role>
+          <role>org.apache.maven.project.artifact.ProjectArtifactFactory</role>
+	      <role-hint>maven-project</role-hint>
         </requirement>
         <requirement>
           <role>org.apache.maven.artifact.resolver.ArtifactResolver</role>
diff --git a/maven-project/src/test/java/org/apache/maven/project/artifact/VersionExpressionTransformationTest.java b/maven-project/src/test/java/org/apache/maven/project/artifact/VersionExpressionTransformationTest.java
new file mode 100644
index 000000000..dcefdf35e
--- /dev/null
+++ b/maven-project/src/test/java/org/apache/maven/project/artifact/VersionExpressionTransformationTest.java
@@ -0,0 +1,661 @@
+package org.apache.maven.project.artifact;
+
+import org.apache.maven.artifact.Artifact;
+import org.apache.maven.artifact.DefaultArtifact;
+import org.apache.maven.artifact.deployer.ArtifactDeploymentException;
+import org.apache.maven.artifact.handler.DefaultArtifactHandler;
+import org.apache.maven.artifact.installer.ArtifactInstallationException;
+import org.apache.maven.artifact.repository.ArtifactRepository;
+import org.apache.maven.artifact.repository.DefaultArtifactRepository;
+import org.apache.maven.artifact.repository.layout.DefaultRepositoryLayout;
+import org.apache.maven.artifact.resolver.ArtifactNotFoundException;
+import org.apache.maven.artifact.resolver.ArtifactResolutionException;
+import org.apache.maven.artifact.transform.ArtifactTransformation;
+import org.apache.maven.artifact.versioning.VersionRange;
+import org.apache.maven.model.Build;
+import org.apache.maven.model.Dependency;
+import org.apache.maven.model.DependencyManagement;
+import org.apache.maven.model.Model;
+import org.apache.maven.model.Plugin;
+import org.apache.maven.model.PluginManagement;
+import org.apache.maven.model.ReportPlugin;
+import org.apache.maven.model.Reporting;
+import org.apache.maven.model.Scm;
+import org.apache.maven.model.io.xpp3.MavenXpp3Reader;
+import org.apache.maven.model.io.xpp3.MavenXpp3Writer;
+import org.apache.maven.project.DefaultProjectBuilderConfiguration;
+import org.apache.maven.project.MavenProject;
+import org.apache.maven.project.ProjectBuilderConfiguration;
+import org.apache.maven.project.interpolation.ModelInterpolationException;
+import org.codehaus.plexus.PlexusTestCase;
+import org.codehaus.plexus.util.FileUtils;
+import org.codehaus.plexus.util.IOUtil;
+import org.codehaus.plexus.util.xml.pull.XmlPullParserException;
+
+import java.io.File;
+import java.io.FileReader;
+import java.io.FileWriter;
+import java.io.IOException;
+import java.util.Collections;
+import java.util.Properties;
+
+public class VersionExpressionTransformationTest
+    extends PlexusTestCase
+{
+
+    private static final String VERSION = "blah";
+
+    private VersionExpressionTransformation transformation;
+
+    public void setUp()
+        throws Exception
+    {
+        super.setUp();
+
+        transformation =
+            (VersionExpressionTransformation) lookup( ArtifactTransformation.class.getName(), "version-expression" );
+    }
+
+    public void testTransformForResolve_DoNothing()
+        throws IOException, XmlPullParserException, ArtifactResolutionException, ArtifactNotFoundException
+    {
+        Model model = buildTestModel();
+
+        File pomDir = File.createTempFile( "VersionExpressionTransformationTest.", ".tmp.dir" );
+        pomDir.delete();
+        pomDir.mkdirs();
+        try
+        {
+            File pomFile = new File( pomDir, "pom.xml" );
+            pomFile.deleteOnExit();
+
+            FileWriter writer = null;
+            try
+            {
+                writer = new FileWriter( pomFile );
+                new MavenXpp3Writer().write( writer, model );
+            }
+            finally
+            {
+                IOUtil.close( writer );
+            }
+
+            Artifact a =
+                new DefaultArtifact( "group", "artifact", VersionRange.createFromVersion( "1" ), null, "jar", null,
+                                     new DefaultArtifactHandler( "jar" ), false );
+            ProjectArtifactMetadata pam = new ProjectArtifactMetadata( a, pomFile );
+
+            a.addMetadata( pam );
+
+            transformation.transformForResolve( a, Collections.EMPTY_LIST, null );
+
+            assertFalse( pam.isVersionExpressionsResolved() );
+            assertEquals( pomFile, pam.getFile() );
+
+            assertFalse( new File( pomDir, "target/pom-transformed.xml" ).exists() );
+
+            FileReader reader = null;
+            try
+            {
+                reader = new FileReader( pomFile );
+                model = new MavenXpp3Reader().read( reader );
+            }
+            finally
+            {
+                IOUtil.close( reader );
+            }
+
+            assertEquals( "${testVersion}", model.getVersion() );
+        }
+        finally
+        {
+            FileUtils.forceDelete( pomDir );
+        }
+    }
+
+    public void testTransformForInstall_TransformBasedOnModelProperties()
+        throws IOException, ArtifactInstallationException, XmlPullParserException
+    {
+        Model model = buildTestModel();
+
+        File pomDir = File.createTempFile( "VersionExpressionTransformationTest.", ".tmp.dir" );
+        pomDir.delete();
+        pomDir.mkdirs();
+        try
+        {
+            File pomFile = new File( pomDir, "pom.xml" );
+            pomFile.deleteOnExit();
+
+            FileWriter writer = null;
+            try
+            {
+                writer = new FileWriter( pomFile );
+                new MavenXpp3Writer().write( writer, model );
+            }
+            finally
+            {
+                IOUtil.close( writer );
+            }
+
+            Artifact a =
+                new DefaultArtifact( "group", "artifact", VersionRange.createFromVersion( "1" ), null, "jar", null,
+                                     new DefaultArtifactHandler( "jar" ), false );
+
+            ProjectArtifactMetadata pam = new ProjectArtifactMetadata( a, pomFile );
+
+            a.addMetadata( pam );
+
+            transformation.transformForInstall( a, null );
+
+            File transformedFile = new File( pomDir, "target/pom-transformed.xml" );
+
+            assertTrue( transformedFile.exists() );
+            assertEquals( transformedFile, pam.getFile() );
+
+            FileReader reader = null;
+            try
+            {
+                reader = new FileReader( pam.getFile() );
+                model = new MavenXpp3Reader().read( reader );
+            }
+            finally
+            {
+                IOUtil.close( reader );
+            }
+
+            assertTransformedVersions( model );
+        }
+        finally
+        {
+            FileUtils.forceDelete( pomDir );
+        }
+    }
+
+    public void testTransformForDeploy_TransformBasedOnModelProperties()
+        throws IOException, XmlPullParserException, ArtifactDeploymentException
+    {
+        Model model = buildTestModel();
+
+        File pomDir = File.createTempFile( "VersionExpressionTransformationTest.", ".tmp.dir" );
+        pomDir.delete();
+        pomDir.mkdirs();
+        try
+        {
+            File pomFile = new File( pomDir, "pom.xml" );
+            pomFile.deleteOnExit();
+
+            FileWriter writer = null;
+            try
+            {
+                writer = new FileWriter( pomFile );
+                new MavenXpp3Writer().write( writer, model );
+            }
+            finally
+            {
+                IOUtil.close( writer );
+            }
+
+            Artifact a =
+                new DefaultArtifact( "group", "artifact", VersionRange.createFromVersion( "1" ), null, "jar", null,
+                                     new DefaultArtifactHandler( "jar" ), false );
+
+            ProjectArtifactMetadata pam = new ProjectArtifactMetadata( a, pomFile );
+
+            a.addMetadata( pam );
+
+            transformation.transformForDeployment( a, null, null );
+
+            File transformedFile = new File( pomDir, "target/pom-transformed.xml" );
+
+            assertTrue( transformedFile.exists() );
+            assertEquals( transformedFile, pam.getFile() );
+
+            FileReader reader = null;
+            try
+            {
+                reader = new FileReader( pam.getFile() );
+                model = new MavenXpp3Reader().read( reader );
+            }
+            finally
+            {
+                IOUtil.close( reader );
+            }
+
+            assertTransformedVersions( model );
+        }
+        finally
+        {
+            FileUtils.forceDelete( pomDir );
+        }
+    }
+
+    // FIXME: We can't be this smart (yet) since the deployment step transforms from the 
+    // original POM once again and re-installs over the top of the install step.
+//    public void testTransformForInstall_SkipIfProjectArtifactMetadataResolvedFlagIsSet()
+//        throws IOException, ArtifactInstallationException, XmlPullParserException
+//    {
+//        Model model = buildTestModel();
+//
+//        File pomDir = File.createTempFile( "VersionExpressionTransformationTest.", ".tmp.dir" );
+//        pomDir.delete();
+//        pomDir.mkdirs();
+//        try
+//        {
+//            File pomFile = new File( pomDir, "pom.xml" );
+//            pomFile.deleteOnExit();
+//
+//            FileWriter writer = null;
+//            try
+//            {
+//                writer = new FileWriter( pomFile );
+//                new MavenXpp3Writer().write( writer, model );
+//            }
+//            finally
+//            {
+//                IOUtil.close( writer );
+//            }
+//
+//            Artifact a =
+//                new DefaultArtifact( "group", "artifact", VersionRange.createFromVersion( "1" ), null, "jar", null,
+//                                     new DefaultArtifactHandler( "jar" ), false );
+//            ProjectArtifactMetadata pam = new ProjectArtifactMetadata( a, pomFile );
+//            pam.setVersionExpressionsResolved( true );
+//
+//            a.addMetadata( pam );
+//
+//            transformation.transformForInstall( a, null );
+//
+//            assertEquals( pomFile, pam.getFile() );
+//
+//            assertFalse( new File( pomDir, "target/pom-transformed.xml" ).exists() );
+//
+//            FileReader reader = null;
+//            try
+//            {
+//                reader = new FileReader( pomFile );
+//                model = new MavenXpp3Reader().read( reader );
+//            }
+//            finally
+//            {
+//                IOUtil.close( reader );
+//            }
+//
+//            assertEquals( "${testVersion}", model.getVersion() );
+//        }
+//        finally
+//        {
+//            FileUtils.forceDelete( pomDir );
+//        }
+//    }
+
+    // FIXME: We can't be this smart (yet) since the deployment step transforms from the 
+    // original POM once again and re-installs over the top of the install step.
+//    public void testTransformForDeploy_SkipIfProjectArtifactMetadataResolvedFlagIsSet()
+//        throws IOException, XmlPullParserException, ArtifactDeploymentException
+//    {
+//        Model model = buildTestModel();
+//
+//        File pomDir = File.createTempFile( "VersionExpressionTransformationTest.", ".tmp.dir" );
+//        pomDir.delete();
+//        pomDir.mkdirs();
+//        try
+//        {
+//            File pomFile = new File( pomDir, "pom.xml" );
+//            pomFile.deleteOnExit();
+//
+//            FileWriter writer = null;
+//            try
+//            {
+//                writer = new FileWriter( pomFile );
+//                new MavenXpp3Writer().write( writer, model );
+//            }
+//            finally
+//            {
+//                IOUtil.close( writer );
+//            }
+//
+//            Artifact a =
+//                new DefaultArtifact( "group", "artifact", VersionRange.createFromVersion( "1" ), null, "jar", null,
+//                                     new DefaultArtifactHandler( "jar" ), false );
+//            ProjectArtifactMetadata pam = new ProjectArtifactMetadata( a, pomFile );
+//            pam.setVersionExpressionsResolved( true );
+//
+//            a.addMetadata( pam );
+//
+//            transformation.transformForDeployment( a, null, null );
+//
+//            assertEquals( pomFile, pam.getFile() );
+//
+//            assertFalse( new File( pomDir, "target/pom-transformed.xml" ).exists() );
+//
+//            FileReader reader = null;
+//            try
+//            {
+//                reader = new FileReader( pomFile );
+//                model = new MavenXpp3Reader().read( reader );
+//            }
+//            finally
+//            {
+//                IOUtil.close( reader );
+//            }
+//
+//            assertEquals( "${testVersion}", model.getVersion() );
+//        }
+//        finally
+//        {
+//            FileUtils.forceDelete( pomDir );
+//        }
+//    }
+
+    public void testTransformVersion_ShouldInterpolate_VanillaArtifact_ModelProperties()
+        throws IOException, XmlPullParserException, ModelInterpolationException
+    {
+        Model model = buildTestModel();
+
+        model = runTransformVersion_VanillaArtifact( model );
+
+        assertTransformedVersions( model );
+    }
+
+    public void testTransformVersion_ShouldInterpolate_ArtifactWithProject_ModelProperties()
+        throws IOException, XmlPullParserException, ModelInterpolationException
+    {
+        Model model = buildTestModel();
+
+        model = runTransformVersion_ArtifactWithProject( model, new DefaultProjectBuilderConfiguration() );
+
+        assertTransformedVersions( model );
+    }
+
+    public void testTransformVersion_ShouldInterpolate_ArtifactWithProject_CLIProperties()
+        throws IOException, XmlPullParserException, ModelInterpolationException
+    {
+        Model model = buildTestModel();
+
+        Properties props = model.getProperties();
+        model.setProperties( new Properties() );
+
+        model =
+            runTransformVersion_ArtifactWithProject(
+                                                     model,
+                                                     new DefaultProjectBuilderConfiguration().setExecutionProperties( props ) );
+
+        assertTransformedVersions( model );
+    }
+
+    private Model runTransformVersion_VanillaArtifact( Model model )
+        throws IOException, XmlPullParserException, ModelInterpolationException
+    {
+        File projectDir = File.createTempFile( "VersionExpressionTransformationTest.project.", ".tmp.dir" );
+        projectDir.delete();
+        projectDir.mkdirs();
+
+        File repoDir = File.createTempFile( "VersionExpressionTransformationTest.repo.", ".tmp.dir" );
+        repoDir.delete();
+        repoDir.mkdirs();
+
+        try
+        {
+            File pomFile = new File( projectDir, "pom.xml" );
+            FileWriter writer = null;
+            try
+            {
+                writer = new FileWriter( pomFile );
+                new MavenXpp3Writer().write( writer, model );
+            }
+            finally
+            {
+                IOUtil.close( writer );
+            }
+
+            model.getBuild().setOutputDirectory( new File( projectDir, "target" ).getAbsolutePath() );
+
+            Artifact a =
+                new DefaultArtifact( model.getGroupId(), model.getArtifactId(), VersionRange.createFromVersion( "1" ),
+                                     null, "jar", null, new DefaultArtifactHandler( "jar" ) );
+
+            ArtifactRepository localRepository =
+                new DefaultArtifactRepository( "local", repoDir.getAbsolutePath(), new DefaultRepositoryLayout() );
+
+            transformation.transformVersions( pomFile, a, localRepository );
+
+            FileReader reader = null;
+            try
+            {
+                reader = new FileReader( new File( projectDir, "target/pom-transformed.xml" ) );
+
+                model = new MavenXpp3Reader().read( reader );
+            }
+            finally
+            {
+                IOUtil.close( reader );
+            }
+        }
+        finally
+        {
+            FileUtils.forceDelete( projectDir );
+            FileUtils.forceDelete( repoDir );
+        }
+
+        return model;
+    }
+
+    private Model runTransformVersion_ArtifactWithProject( Model model, ProjectBuilderConfiguration pbConfig )
+        throws IOException, XmlPullParserException, ModelInterpolationException
+    {
+        File projectDir = File.createTempFile( "VersionExpressionTransformationTest.project.", ".tmp.dir" );
+        projectDir.delete();
+        projectDir.mkdirs();
+
+        File repoDir = File.createTempFile( "VersionExpressionTransformationTest.repo.", ".tmp.dir" );
+        repoDir.delete();
+        repoDir.mkdirs();
+
+        try
+        {
+            File pomFile = new File( projectDir, "pom.xml" );
+            FileWriter writer = null;
+            try
+            {
+                writer = new FileWriter( pomFile );
+                new MavenXpp3Writer().write( writer, model );
+            }
+            finally
+            {
+                IOUtil.close( writer );
+            }
+
+            model.getBuild().setDirectory( new File( projectDir, "target" ).getAbsolutePath() );
+
+            MavenProject project = new MavenProject( model );
+            project.setFile( pomFile );
+            project.setBasedir( projectDir );
+            project.setProjectBuilderConfiguration( pbConfig );
+
+            ArtifactWithProject a =
+                new ArtifactWithProject( project, "jar", null, new DefaultArtifactHandler( "jar" ), false );
+
+            ArtifactRepository localRepository =
+                new DefaultArtifactRepository( "local", repoDir.getAbsolutePath(), new DefaultRepositoryLayout() );
+
+            transformation.transformVersions( pomFile, a, localRepository );
+
+            FileReader reader = null;
+            try
+            {
+                reader = new FileReader( new File( project.getBuild().getDirectory(), "pom-transformed.xml" ) );
+
+                model = new MavenXpp3Reader().read( reader );
+            }
+            finally
+            {
+                IOUtil.close( reader );
+            }
+        }
+        finally
+        {
+            FileUtils.forceDelete( projectDir );
+            FileUtils.forceDelete( repoDir );
+        }
+
+        return model;
+    }
+
+    public void testInterpolate_ShouldNotInterpolateNonVersionFields()
+        throws ModelInterpolationException
+    {
+        Model model = buildTestModel();
+
+        Scm scm = new Scm();
+        scm.setUrl( "http://${testVersion}" );
+
+        model.setScm( scm );
+
+        File projectDir = new File( "." ).getAbsoluteFile();
+
+        transformation.interpolateVersions( model, projectDir, new DefaultProjectBuilderConfiguration() );
+
+        // /project/scm/url
+        assertFalse( model.getScm().getUrl().indexOf( VERSION ) > -1 );
+    }
+
+    public void testInterpolate_ShouldInterpolateAllVersionsUsingPOMProperties()
+        throws ModelInterpolationException
+    {
+        Model model = buildTestModel();
+        File projectDir = new File( "." ).getAbsoluteFile();
+
+        transformation.interpolateVersions( model, projectDir, new DefaultProjectBuilderConfiguration() );
+
+        assertTransformedVersions( model );
+    }
+
+    private void assertTransformedVersions( Model model )
+    {
+        // /project/version
+        assertEquals( VERSION, model.getVersion() );
+
+        // /project/dependenices/dependency/version
+        Dependency dep = (Dependency) model.getDependencies().get( 0 );
+        assertEquals( VERSION, dep.getVersion() );
+
+        // /project/dependencyManagement/dependenices/dependency/version
+        dep = (Dependency) model.getDependencyManagement().getDependencies().get( 0 );
+        assertEquals( VERSION, dep.getVersion() );
+
+        // /project/build/plugins/plugin/version
+        Plugin plugin = (Plugin) model.getBuild().getPlugins().get( 0 );
+        assertEquals( VERSION, plugin.getVersion() );
+
+        // /project/build/plugins/plugin/dependencies/dependency/version
+        dep = (Dependency) plugin.getDependencies().get( 0 );
+        assertEquals( VERSION, dep.getVersion() );
+
+        // /project/build/pluginManagement/plugins/plugin/version
+        plugin = (Plugin) model.getBuild().getPluginManagement().getPlugins().get( 0 );
+        assertEquals( VERSION, plugin.getVersion() );
+
+        // /project/build/pluginManagement/plugins/plugin/dependencies/dependency/version
+        dep = (Dependency) plugin.getDependencies().get( 0 );
+        assertEquals( VERSION, dep.getVersion() );
+
+        // /project/reporting/plugins/plugin/version
+        ReportPlugin rplugin = (ReportPlugin) model.getReporting().getPlugins().get( 0 );
+        assertEquals( VERSION, rplugin.getVersion() );
+    }
+
+    public void testInterpolate_ShouldInterpolateAllVersionsUsingCLIProperties()
+        throws ModelInterpolationException
+    {
+        Model model = buildTestModel();
+        File projectDir = new File( "." ).getAbsoluteFile();
+
+        Properties props = model.getProperties();
+        model.setProperties( new Properties() );
+
+        transformation.interpolateVersions( model, projectDir,
+                                            new DefaultProjectBuilderConfiguration().setExecutionProperties( props ) );
+
+        assertTransformedVersions( model );
+    }
+
+    public Model buildTestModel()
+    {
+        Model model = new Model();
+
+        model.setGroupId( "group.id" );
+        model.setArtifactId( "artifact-id" );
+        model.setPackaging( "jar" );
+
+        String expression = "${testVersion}";
+
+        Properties props = new Properties();
+        props.setProperty( "testVersion", VERSION );
+
+        model.setProperties( props );
+
+        model.setVersion( expression );
+
+        Dependency dep = new Dependency();
+        dep.setGroupId( "group.id" );
+        dep.setArtifactId( "artifact-id" );
+        dep.setVersion( expression );
+
+        model.addDependency( dep );
+
+        dep = new Dependency();
+        dep.setGroupId( "managed.group.id" );
+        dep.setArtifactId( "managed-artifact-id" );
+        dep.setVersion( expression );
+
+        DependencyManagement dmgmt = new DependencyManagement();
+        dmgmt.addDependency( dep );
+
+        model.setDependencyManagement( dmgmt );
+
+        Build build = new Build();
+        model.setBuild( build );
+
+        Plugin plugin = new Plugin();
+        plugin.setGroupId( "plugin.group" );
+        plugin.setArtifactId( "plugin-artifact" );
+        plugin.setVersion( expression );
+
+        dep = new Dependency();
+        dep.setGroupId( "plugin.dep.group" );
+        dep.setArtifactId( "plugin-dep-artifact" );
+        dep.setVersion( expression );
+        plugin.addDependency( dep );
+
+        build.addPlugin( plugin );
+
+        plugin = new Plugin();
+        plugin.setGroupId( "plugin.other.group" );
+        plugin.setArtifactId( "plugin-other-artifact" );
+        plugin.setVersion( expression );
+
+        dep = new Dependency();
+        dep.setGroupId( "plugin.dep.other.group" );
+        dep.setArtifactId( "plugin-dep-other-artifact" );
+        dep.setVersion( expression );
+        plugin.addDependency( dep );
+
+        PluginManagement pmgmt = new PluginManagement();
+        pmgmt.addPlugin( plugin );
+
+        build.setPluginManagement( pmgmt );
+
+        ReportPlugin rplugin = new ReportPlugin();
+        rplugin.setGroupId( "report.group" );
+        rplugin.setArtifactId( "report-artifact" );
+        rplugin.setVersion( expression );
+
+        Reporting reporting = new Reporting();
+        reporting.addPlugin( rplugin );
+
+        model.setReporting( reporting );
+
+        return model;
+    }
+
+}
diff --git a/maven-project/src/test/resources/org/apache/maven/project/ProjectClasspathTest.xml b/maven-project/src/test/resources/org/apache/maven/project/ProjectClasspathTest.xml
index 56d9b6043..099ef670a 100644
--- a/maven-project/src/test/resources/org/apache/maven/project/ProjectClasspathTest.xml
+++ b/maven-project/src/test/resources/org/apache/maven/project/ProjectClasspathTest.xml
@@ -84,7 +84,8 @@ under the License.
           <role>org.apache.maven.project.path.PathTranslator</role>
         </requirement>
         <requirement>
-          <role>org.apache.maven.artifact.factory.ArtifactFactory</role>
+          <role>org.apache.maven.project.artifact.ProjectArtifactFactory</role>
+          <role-hint>maven-project</role-hint>
         </requirement>
         <requirement>
           <role>org.apache.maven.artifact.resolver.ArtifactResolver</role>
diff --git a/maven-project/src/test/resources/org/apache/maven/project/canonical/CanonicalProjectBuilderTest.xml b/maven-project/src/test/resources/org/apache/maven/project/canonical/CanonicalProjectBuilderTest.xml
index 56d9b6043..099ef670a 100644
--- a/maven-project/src/test/resources/org/apache/maven/project/canonical/CanonicalProjectBuilderTest.xml
+++ b/maven-project/src/test/resources/org/apache/maven/project/canonical/CanonicalProjectBuilderTest.xml
@@ -84,7 +84,8 @@ under the License.
           <role>org.apache.maven.project.path.PathTranslator</role>
         </requirement>
         <requirement>
-          <role>org.apache.maven.artifact.factory.ArtifactFactory</role>
+          <role>org.apache.maven.project.artifact.ProjectArtifactFactory</role>
+          <role-hint>maven-project</role-hint>
         </requirement>
         <requirement>
           <role>org.apache.maven.artifact.resolver.ArtifactResolver</role>
