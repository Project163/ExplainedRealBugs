diff --git a/maven-project/src/main/java/org/apache/maven/project/DefaultMavenProjectBuilder.java b/maven-project/src/main/java/org/apache/maven/project/DefaultMavenProjectBuilder.java
index 878b33bc5..c8f24e34f 100644
--- a/maven-project/src/main/java/org/apache/maven/project/DefaultMavenProjectBuilder.java
+++ b/maven-project/src/main/java/org/apache/maven/project/DefaultMavenProjectBuilder.java
@@ -238,6 +238,17 @@ public class DefaultMavenProjectBuilder
                                              ArtifactRepository localRepository,
                                              boolean allowStubModel )
         throws ProjectBuildingException
+    {
+        ProjectBuilderConfiguration config = new DefaultProjectBuilderConfiguration().setLocalRepository( localRepository );
+        
+        return buildFromRepository( artifact, remoteArtifactRepositories, config, allowStubModel );
+    }
+
+    public MavenProject buildFromRepository( Artifact artifact,
+                                             List remoteArtifactRepositories,
+                                             ProjectBuilderConfiguration config,
+                                             boolean allowStubModel )
+        throws ProjectBuildingException
     {
         String cacheKey = createCacheKey( artifact.getGroupId(), artifact.getArtifactId(), artifact.getVersion() );
 
@@ -248,9 +259,7 @@ public class DefaultMavenProjectBuilder
             return project;
         }
 
-        Model model = findModelFromRepository( artifact, remoteArtifactRepositories, localRepository, allowStubModel );
-
-        ProjectBuilderConfiguration config = new DefaultProjectBuilderConfiguration().setLocalRepository( localRepository );
+        Model model = findModelFromRepository( artifact, remoteArtifactRepositories, config, allowStubModel );
 
         return buildInternal( "Artifact [" + artifact + "]", model, config, remoteArtifactRepositories,
                               null, false );
@@ -526,7 +535,7 @@ public class DefaultMavenProjectBuilder
 
     private Model findModelFromRepository( Artifact artifact,
                                            List remoteArtifactRepositories,
-                                           ArtifactRepository localRepository,
+                                           ProjectBuilderConfiguration config,
                                            boolean allowStubModel )
         throws ProjectBuildingException
     {
@@ -555,7 +564,7 @@ public class DefaultMavenProjectBuilder
 
         try
         {
-            artifactResolver.resolve( projectArtifact, remoteArtifactRepositories, localRepository );
+            artifactResolver.resolve( projectArtifact, remoteArtifactRepositories, config.getLocalRepository() );
 
             File file = projectArtifact.getFile();
 
@@ -574,7 +583,7 @@ public class DefaultMavenProjectBuilder
                 status = ArtifactStatus.valueOf( distributionManagement.getStatus() );
             }
 
-            checkStatusAndUpdate( projectArtifact, status, file, remoteArtifactRepositories, localRepository );
+            checkStatusAndUpdate( projectArtifact, status, file, remoteArtifactRepositories, config.getLocalRepository() );
 
             // TODO: this is gross. Would like to give it the whole model, but maven-artifact shouldn't depend on that
             // Can a maven-core implementation of the Artifact interface store it, and be used in the exceptions?
@@ -859,6 +868,7 @@ public class DefaultMavenProjectBuilder
 
         // only add the super repository if it wasn't overridden by a profile or project
         List repositories = new ArrayList( aggregatedRemoteWagonRepositories );
+        repositories.addAll( parentSearchRepositories );
 
         List superRepositories = buildArtifactRepositories( superModel );
 
@@ -996,7 +1006,7 @@ public class DefaultMavenProjectBuilder
         // MNG-3482: Make sure depMgmt is interpolated before merging.
         if ( !isSuperPom )
         {
-            mergeManagedDependencies( model, config.getLocalRepository(), remoteRepositories );
+            mergeManagedDependencies( model, config, remoteRepositories );
         }
 
         // interpolation is before injection, because interpolation is off-limits in the injected variables
@@ -1389,7 +1399,7 @@ public class DefaultMavenProjectBuilder
 
                 try
                 {
-                    model = findModelFromRepository( parentArtifact, remoteRepositories, config.getLocalRepository(), false );
+                    model = findModelFromRepository( parentArtifact, remoteRepositories, config, false );
                 }
                 catch ( ProjectBuildingException e )
                 {
@@ -1422,7 +1432,7 @@ public class DefaultMavenProjectBuilder
         return project;
     }
 
-    private void mergeManagedDependencies(Model model, ArtifactRepository localRepository, List parentSearchRepositories)
+    private void mergeManagedDependencies(Model model, ProjectBuilderConfiguration config, List parentSearchRepositories)
         throws ProjectBuildingException
     {
         DependencyManagement modelDepMgmt = model.getDependencyManagement();
@@ -1453,7 +1463,7 @@ public class DefaultMavenProjectBuilder
                     {
                         Artifact artifact = artifactFactory.createProjectArtifact( dep.getGroupId(), dep.getArtifactId(),
                                                                                   dep.getVersion(), dep.getScope() );
-                        MavenProject project = buildFromRepository(artifact, parentSearchRepositories, localRepository, false);
+                        MavenProject project = buildFromRepository(artifact, parentSearchRepositories, config, false);
 
                         DependencyManagement depMgmt = project.getDependencyManagement();
 
diff --git a/maven-project/src/main/java/org/apache/maven/project/DefaultProjectBuilderConfiguration.java b/maven-project/src/main/java/org/apache/maven/project/DefaultProjectBuilderConfiguration.java
index 77fb4b773..6940b0186 100644
--- a/maven-project/src/main/java/org/apache/maven/project/DefaultProjectBuilderConfiguration.java
+++ b/maven-project/src/main/java/org/apache/maven/project/DefaultProjectBuilderConfiguration.java
@@ -1,5 +1,6 @@
 package org.apache.maven.project;
 
+import org.apache.maven.artifact.metadata.ArtifactMetadataSource;
 import org.apache.maven.artifact.repository.ArtifactRepository;
 import org.apache.maven.profiles.ProfileManager;
 
@@ -20,6 +21,8 @@ public class DefaultProjectBuilderConfiguration
 
     private Date buildStartTime;
 
+    private ArtifactMetadataSource metadataSource;
+
     public DefaultProjectBuilderConfiguration()
     {
     }
@@ -84,4 +87,15 @@ public class DefaultProjectBuilderConfiguration
         return this;
     }
 
+    public ProjectBuilderConfiguration setMetadataSource( ArtifactMetadataSource metadataSource )
+    {
+        this.metadataSource = metadataSource;
+        return this;
+    }
+    
+    public ArtifactMetadataSource getMetadataSource()
+    {
+        return metadataSource;
+    }
+
 }
diff --git a/maven-project/src/main/java/org/apache/maven/project/MavenProjectBuilder.java b/maven-project/src/main/java/org/apache/maven/project/MavenProjectBuilder.java
index e398ae999..bb29b172e 100644
--- a/maven-project/src/main/java/org/apache/maven/project/MavenProjectBuilder.java
+++ b/maven-project/src/main/java/org/apache/maven/project/MavenProjectBuilder.java
@@ -90,6 +90,22 @@ public interface MavenProjectBuilder
                                       ArtifactRepository localRepository, boolean allowStubModel )
         throws ProjectBuildingException;
 
+    /**
+     * Build the artifact using the local repository and profile manager from the project-builder 
+     * configuration, resolving it if necessary.
+     *
+     * @param artifact the artifact description
+     * @param configuration The {@link ProjectBuilderConfiguration} instance containing local 
+     *                      repository, profile manager, etc.
+     * @param remoteArtifactRepositories the remote repository list
+     * @param allowStubModel return a stub if the POM is not found
+     * @return the built project
+     * @throws ProjectBuildingException
+     */
+    MavenProject buildFromRepository( Artifact artifact, List remoteArtifactRepositories,
+                                      ProjectBuilderConfiguration configuration, boolean allowStubModel )
+        throws ProjectBuildingException;
+
     /**
      * @deprecated Use {@link MavenProjectBuilder#buildStandaloneSuperProject(ProjectBuilderConfiguration)} instead.
      */
diff --git a/maven-project/src/main/java/org/apache/maven/project/ProjectBuilderConfiguration.java b/maven-project/src/main/java/org/apache/maven/project/ProjectBuilderConfiguration.java
index f8ce413a6..f190ad7f6 100644
--- a/maven-project/src/main/java/org/apache/maven/project/ProjectBuilderConfiguration.java
+++ b/maven-project/src/main/java/org/apache/maven/project/ProjectBuilderConfiguration.java
@@ -1,5 +1,6 @@
 package org.apache.maven.project;
 
+import org.apache.maven.artifact.metadata.ArtifactMetadataSource;
 import org.apache.maven.artifact.repository.ArtifactRepository;
 import org.apache.maven.profiles.ProfileManager;
 
@@ -29,4 +30,8 @@ public interface ProjectBuilderConfiguration
 
     ProjectBuilderConfiguration setBuildStartTime( Date buildStartTime );
 
+    ProjectBuilderConfiguration setMetadataSource( ArtifactMetadataSource mms );
+    
+    ArtifactMetadataSource getMetadataSource();
+
 }
diff --git a/maven-project/src/main/java/org/apache/maven/project/artifact/MavenMetadataSource.java b/maven-project/src/main/java/org/apache/maven/project/artifact/MavenMetadataSource.java
index f765795d9..4ab0f0789 100644
--- a/maven-project/src/main/java/org/apache/maven/project/artifact/MavenMetadataSource.java
+++ b/maven-project/src/main/java/org/apache/maven/project/artifact/MavenMetadataSource.java
@@ -53,6 +53,7 @@ import org.apache.maven.project.DefaultProjectBuilderConfiguration;
 import org.apache.maven.project.InvalidProjectModelException;
 import org.apache.maven.project.MavenProject;
 import org.apache.maven.project.MavenProjectBuilder;
+import org.apache.maven.project.ProjectBuilderConfiguration;
 import org.apache.maven.project.ProjectBuildingException;
 import org.apache.maven.project.validation.ModelValidationResult;
 import org.codehaus.plexus.logging.AbstractLogEnabled;
@@ -78,8 +79,29 @@ public class MavenMetadataSource
     // lazily instantiated and cached.
     private MavenProject superProject;
     
-    private Set warnedPoms = new HashSet();
-
+    // cache
+    private final Set<String> warnedPoms;
+    
+    // per-session information
+    private ProjectBuilderConfiguration projectBuilderConfig;
+    
+    public MavenMetadataSource()
+    {
+        warnedPoms = new HashSet<String>();
+    }
+    
+    public MavenMetadataSource( MavenMetadataSource mms, ProjectBuilderConfiguration configuration )
+    {
+        mavenProjectBuilder = mms.mavenProjectBuilder;
+        artifactFactory = mms.artifactFactory;
+        repositoryMetadataManager = mms.repositoryMetadataManager;
+        superProject = mms.superProject;
+        warnedPoms = mms.warnedPoms;
+        
+        projectBuilderConfig = configuration;
+        projectBuilderConfig.setMetadataSource( this );
+    }
+    
     /**
      * Resolve all relocations in the POM for this artifact, and return the new artifact coordinate.
      */
@@ -143,6 +165,12 @@ public class MavenMetadataSource
         throws ArtifactMetadataRetrievalException
     {
         MavenProject project = null;
+        
+        ProjectBuilderConfiguration config = projectBuilderConfig;
+        if ( config == null )
+        {
+            config = new DefaultProjectBuilderConfiguration().setLocalRepository( localRepository );
+        }
 
         Artifact pomArtifact;
         boolean done = false;
@@ -160,7 +188,7 @@ public class MavenMetadataSource
             {
                 try
                 {
-                    project = mavenProjectBuilder.buildFromRepository( pomArtifact, remoteRepositories, localRepository,
+                    project = mavenProjectBuilder.buildFromRepository( pomArtifact, remoteRepositories, config,
                                                                        true );
                 }
                 catch ( InvalidProjectModelException e )
@@ -352,11 +380,17 @@ public class MavenMetadataSource
     private List aggregateRepositoryLists( List remoteRepositories, List remoteArtifactRepositories )
         throws ArtifactMetadataRetrievalException
     {
+        ProjectBuilderConfiguration config = projectBuilderConfig;
+        if ( config == null )
+        {
+            config = new DefaultProjectBuilderConfiguration();
+        }
+        
         if ( superProject == null )
         {
             try
             {
-                superProject = mavenProjectBuilder.buildStandaloneSuperProject( new DefaultProjectBuilderConfiguration() );
+                superProject = mavenProjectBuilder.buildStandaloneSuperProject( config );
             }
             catch ( ProjectBuildingException e )
             {
