<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:46:54 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[STORM-1515] LocalState corruption after hard reboot on Windows</title>
                <link>https://issues.apache.org/jira/browse/STORM-1515</link>
                <project id="12314820" key="STORM">Apache Storm</project>
                    <description>&lt;p&gt;After a hard reboot on windows I&apos;m seeing &lt;tt&gt;LocalState&lt;/tt&gt; files for the supervisor that contain a few hundred NULs, resulting in a &lt;tt&gt;StreamCorruptedException&lt;/tt&gt; on deserialization and the supervisor failing to start.&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;2016-01-27T17:04:10.848-0700 b.s.d.supervisor [INFO] Starting supervisor with id 45b27917-4ca0-4d96-8727-914909e3ac47 at host jtorbiak-ws.nj.invidi.com
2016-01-27T17:04:11.673-0700 b.s.event [ERROR] Error when processing event
java.lang.RuntimeException: java.io.StreamCorruptedException: invalid stream header: 00000000
        at backtype.storm.serialization.DefaultSerializationDelegate.deserialize(DefaultSerializationDelegate.java:56) ~[storm-core-0.9.4.jar:0.9.4]
        at backtype.storm.utils.Utils.deserialize(Utils.java:89) ~[storm-core-0.9.4.jar:0.9.4]
        at backtype.storm.utils.LocalState.deserializeLatestVersion(LocalState.java:65) ~[storm-core-0.9.4.jar:0.9.4]
        at backtype.storm.utils.LocalState.snapshot(LocalState.java:47) ~[storm-core-0.9.4.jar:0.9.4]
        at backtype.storm.utils.LocalState.get(LocalState.java:72) ~[storm-core-0.9.4.jar:0.9.4]
        at backtype.storm.daemon.supervisor$sync_processes.invoke(supervisor.clj:234) ~[storm-core-0.9.4.jar:0.9.4]
        at clojure.lang.AFn.applyToHelper(AFn.java:161) [clojure-1.5.1.jar:na]
        at clojure.lang.AFn.applyTo(AFn.java:151) [clojure-1.5.1.jar:na]
        at clojure.core$apply.invoke(core.clj:619) ~[clojure-1.5.1.jar:na]
        at clojure.core$partial$fn__4190.doInvoke(core.clj:2396) ~[clojure-1.5.1.jar:na]
        at clojure.lang.RestFn.invoke(RestFn.java:397) ~[clojure-1.5.1.jar:na]
        at backtype.storm.event$event_manager$fn__2809.invoke(event.clj:40) ~[storm-core-0.9.4.jar:0.9.4]
        at clojure.lang.AFn.run(AFn.java:24) [clojure-1.5.1.jar:na]
        at java.lang.Thread.run(Thread.java:745) [na:1.8.0_45]
Caused by: java.io.StreamCorruptedException: invalid stream header: 00000000
        at java.io.ObjectInputStream.readStreamHeader(ObjectInputStream.java:806) ~[na:1.8.0_45]
        at java.io.ObjectInputStream.&amp;lt;init&amp;gt;(ObjectInputStream.java:299) ~[na:1.8.0_45]
        at backtype.storm.serialization.DefaultSerializationDelegate.deserialize(DefaultSerializationDelegate.java:51) ~[storm-core-0.9.4.jar:0.9.4]
        ... 13 common frames omitted
2016-01-27T17:04:11.674-0700 b.s.util [ERROR] Halting process: (&quot;Error when processing an event&quot;)
java.lang.RuntimeException: (&quot;Error when processing an event&quot;)
        at backtype.storm.util$exit_process_BANG_.doInvoke(util.clj:325) [storm-core-0.9.4.jar:0.9.4]
        at clojure.lang.RestFn.invoke(RestFn.java:423) [clojure-1.5.1.jar:na]
        at backtype.storm.event$event_manager$fn__2809.invoke(event.clj:48) [storm-core-0.9.4.jar:0.9.4]
        at clojure.lang.AFn.run(AFn.java:24) [clojure-1.5.1.jar:na]
        at java.lang.Thread.run(Thread.java:745) [na:1.8.0_45]
2016-01-27T17:04:11.695-0700 b.s.d.supervisor [INFO] Shutting down supervisor 45b27917-4ca0-4d96-8727-914909e3ac47
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This is very similar to &lt;a href=&quot;https://issues.apache.org/jira/browse/STORM-307&quot; title=&quot;After host crash, supervisor is unable to restart itself&quot; class=&quot;issue-link&quot; data-issue-key=&quot;STORM-307&quot;&gt;&lt;del&gt;STORM-307&lt;/del&gt;&lt;/a&gt;, except the &lt;tt&gt;LocalState&lt;/tt&gt; files contain NULs instead of being empty. I&apos;m guessing this corruption type is specific to Windows.&lt;/p&gt;</description>
                <environment>Windows Server 2012</environment>
        <key id="12935806">STORM-1515</key>
            <summary>LocalState corruption after hard reboot on Windows</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="frison">Tim Frison</assignee>
                                    <reporter username="torbiak">Jordan Torbiak</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Tue, 2 Feb 2016 00:47:17 +0000</created>
                <updated>Sun, 26 Jan 2025 09:18:52 +0000</updated>
                            <resolved>Wed, 4 Sep 2019 17:23:41 +0000</resolved>
                                    <version>0.10.0</version>
                    <version>0.9.4</version>
                                    <fixVersion>2.1.0</fixVersion>
                                    <component>storm-core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="10800">3h</timespent>
                                <comments>
                            <comment id="15129184" author="githubbot" created="Tue, 2 Feb 2016 22:24:27 +0000"  >&lt;p&gt;GitHub user torbiak opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/storm/pull/1067&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/storm/pull/1067&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/STORM-1515&quot; title=&quot;LocalState corruption after hard reboot on Windows&quot; class=&quot;issue-link&quot; data-issue-key=&quot;STORM-1515&quot;&gt;&lt;del&gt;STORM-1515&lt;/del&gt;&lt;/a&gt;: Reset LocalState if corrupted after a hard reboot on Windows&lt;/p&gt;

&lt;p&gt;    On Windows LocalState IO requests interrupted by a hard reboot can&lt;br/&gt;
    result in a file full of NULs, similar to the empty-file corruption seen in &lt;a href=&quot;https://issues.apache.org/jira/browse/STORM-307&quot; title=&quot;After host crash, supervisor is unable to restart itself&quot; class=&quot;issue-link&quot; data-issue-key=&quot;STORM-307&quot;&gt;&lt;del&gt;STORM-307&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;    I&apos;ve fixed this for 0.9.x first since I haven&apos;t upgraded to 0.10 yet. The fix for 0.10 will be slightly different due to the move to Thrift for LocalState serialization.&lt;/p&gt;

&lt;p&gt;    It might be desirable to catch EOFException instead of checking serialized.length, since it could cover more cases of corruption, like a partially-written serialization stream.&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/torbiak/storm&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/torbiak/storm&lt;/a&gt; 0.9.x-branch&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/storm/pull/1067.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/storm/pull/1067.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #1067&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 69c90bdda052e68c18a2ecfe43c34999869aa144&lt;br/&gt;
Author: Jordan Torbiak &amp;lt;jtorbiak@invidi.com&amp;gt;&lt;br/&gt;
Date:   2016-02-02T01:48:53Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/STORM-1515&quot; title=&quot;LocalState corruption after hard reboot on Windows&quot; class=&quot;issue-link&quot; data-issue-key=&quot;STORM-1515&quot;&gt;&lt;del&gt;STORM-1515&lt;/del&gt;&lt;/a&gt;: Reset LocalState if corrupted after a hard reboot on Windows&lt;/p&gt;

&lt;p&gt;    On Windows LocalState IO requests interrupted by a hard reboot can&lt;br/&gt;
    result in a file full of NULs, similar to the empty-file corruption seen&lt;br/&gt;
    in &lt;a href=&quot;https://issues.apache.org/jira/browse/STORM-307&quot; title=&quot;After host crash, supervisor is unable to restart itself&quot; class=&quot;issue-link&quot; data-issue-key=&quot;STORM-307&quot;&gt;&lt;del&gt;STORM-307&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15135280" author="githubbot" created="Fri, 5 Feb 2016 23:45:12 +0000"  >&lt;p&gt;Github user frison commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/storm/pull/1067#issuecomment-180625941&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/storm/pull/1067#issuecomment-180625941&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    I see no way that CI failed because of this commit.&lt;/p&gt;</comment>
                            <comment id="15141553" author="githubbot" created="Wed, 10 Feb 2016 20:00:23 +0000"  >&lt;p&gt;Github user revans2 commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/storm/pull/1067#issuecomment-182554149&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/storm/pull/1067#issuecomment-182554149&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    The change looks fine to me, but we need to pull this into master, 1.x-branch and 0.10.x-branch before we can pull it into 0.9.x-branch.&lt;/p&gt;</comment>
                            <comment id="15547026" author="torbiak" created="Tue, 4 Oct 2016 23:27:40 +0000"  >&lt;p&gt;I won&apos;t be able to work on it anytime soon.&lt;/p&gt;

</comment>
                            <comment id="17918541" author="githubbot" created="Sun, 26 Jan 2025 09:18:52 +0000"  >&lt;p&gt;For your information, &lt;a href=&quot;https://issues.apache.org/jira/projects/STORM/issues/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;all STORM issues&lt;/a&gt;  have been transferred to Github: &lt;a href=&quot;https://github.com/apache/storm/issues/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/storm/issues/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Here is the direct link to this issue in Github: &lt;a href=&quot;https://github.com/apache/storm/issues//5350&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/storm/issues//5350&lt;/a&gt;&lt;br/&gt;
And here is the link to a search for related issues: &lt;a href=&quot;https://github.com/apache/storm/issues/?q=%22STORM-1515%22&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/storm/issues/?q=%22STORM-1515%22&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;(Note: this is an automated bulk comment)&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[no_permission]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            40 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2s9lb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>