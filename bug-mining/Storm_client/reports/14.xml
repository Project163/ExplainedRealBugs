<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:46:15 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[STORM-1642] NullPointerException when deserialize</title>
                <link>https://issues.apache.org/jira/browse/STORM-1642</link>
                <project id="12314820" key="STORM">Apache Storm</project>
                    <description>&lt;p&gt;Hi:&lt;br/&gt;
I&apos;ve encountered the following NPE when storm tries to deserialize. I did not use OutputCollector concurrently in my code.  The only object we are passing between bolts are a thrift object, and we have written a serializer for it. I&apos;ve attached the code of serializer and please help to check whether there are any potential bugs there.&lt;/p&gt;

&lt;p&gt;2016-03-04 17:17:43.583 b.s.util &lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; Async loop died!&lt;br/&gt;
java.lang.RuntimeException: java.lang.NullPointerException&lt;br/&gt;
        at backtype.storm.utils.DisruptorQueue.consumeBatchToCursor(DisruptorQueue.java:135) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;storm-core-0.10.0.jar:0.10.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at backtype.storm.utils.DisruptorQueue.consumeBatchWhenAvailable(DisruptorQueue.java:106) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;storm-core-0.10.0.jar:0.10.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at backtype.storm.disruptor$consume_batch_when_available.invoke(disruptor.clj:80) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;storm-core-0.10.0.jar:0.10.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at backtype.storm.daemon.executor$fn_&lt;em&gt;5694$fn&lt;/em&gt;&lt;em&gt;5707$fn&lt;/em&gt;_5758.invoke(executor.clj:819) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;storm-core-0.10.0.jar:0.10.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at backtype.storm.util$async_loop$fn__545.invoke(util.clj:479) &lt;span class=&quot;error&quot;&gt;&amp;#91;storm-core-0.10.0.jar:0.10.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at clojure.lang.AFn.run(AFn.java:22) &lt;span class=&quot;error&quot;&gt;&amp;#91;clojure-1.6.0.jar:?&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at java.lang.Thread.run(Thread.java:745) &lt;span class=&quot;error&quot;&gt;&amp;#91;?:1.8.0_60&amp;#93;&lt;/span&gt;&lt;br/&gt;
Caused by: java.lang.NullPointerException&lt;br/&gt;
        at com.esotericsoftware.kryo.io.Input.setBuffer(Input.java:57) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;kryo-2.21.jar:?&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at backtype.storm.serialization.KryoTupleDeserializer.deserialize(KryoTupleDeserializer.java:47) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;storm-core-0.10.0.jar:0.10.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at backtype.storm.daemon.executor$mk_task_receiver$fn__5615.invoke(executor.clj:433) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;storm-core-0.10.0.jar:0.10.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at backtype.storm.disruptor$clojure_handler$reify__5189.onEvent(disruptor.clj:58) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;storm-core-0.10.0.jar:0.10.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at backtype.storm.utils.DisruptorQueue.consumeBatchToCursor(DisruptorQueue.java:132) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;storm-core-0.10.0.jar:0.10.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
        ... 6 more&lt;br/&gt;
2016-03-04 17:17:43.584 b.s.d.executor &lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt;&lt;br/&gt;
java.lang.RuntimeException: java.lang.NullPointerException&lt;br/&gt;
        at backtype.storm.utils.DisruptorQueue.consumeBatchToCursor(DisruptorQueue.java:135) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;storm-core-0.10.0.jar:0.10.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at backtype.storm.utils.DisruptorQueue.consumeBatchWhenAvailable(DisruptorQueue.java:106) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;storm-core-0.10.0.jar:0.10.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at backtype.storm.disruptor$consume_batch_when_available.invoke(disruptor.clj:80) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;storm-core-0.10.0.jar:0.10.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at backtype.storm.daemon.executor$fn_&lt;em&gt;5694$fn&lt;/em&gt;&lt;em&gt;5707$fn&lt;/em&gt;_5758.invoke(executor.clj:819) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;storm-core-0.10.0.jar:0.10.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at backtype.storm.util$async_loop$fn__545.invoke(util.clj:479) &lt;span class=&quot;error&quot;&gt;&amp;#91;storm-core-0.10.0.jar:0.10.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at clojure.lang.AFn.run(AFn.java:22) &lt;span class=&quot;error&quot;&gt;&amp;#91;clojure-1.6.0.jar:?&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at java.lang.Thread.run(Thread.java:745) &lt;span class=&quot;error&quot;&gt;&amp;#91;?:1.8.0_60&amp;#93;&lt;/span&gt;&lt;br/&gt;
Caused by: java.lang.NullPointerException&lt;br/&gt;
        at com.esotericsoftware.kryo.io.Input.setBuffer(Input.java:57) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;kryo-2.21.jar:?&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at backtype.storm.serialization.KryoTupleDeserializer.deserialize(KryoTupleDeserializer.java:47) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;storm-core-0.10.0.jar:0.10.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at backtype.storm.daemon.executor$mk_task_receiver$fn__5615.invoke(executor.clj:433) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;storm-core-0.10.0.jar:0.10.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at backtype.storm.disruptor$clojure_handler$reify__5189.onEvent(disruptor.clj:58) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;storm-core-0.10.0.jar:0.10.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at backtype.storm.utils.DisruptorQueue.consumeBatchToCursor(DisruptorQueue.java:132) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;storm-core-0.10.0.jar:0.10.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
        ... 6 more&lt;br/&gt;
2016-03-04 17:17:43.648 b.s.util &lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; Halting process: (&quot;Worker died&quot;)&lt;br/&gt;
java.lang.RuntimeException: (&quot;Worker died&quot;)&lt;br/&gt;
        at backtype.storm.util$exit_process_BANG_.doInvoke(util.clj:336) &lt;span class=&quot;error&quot;&gt;&amp;#91;storm-core-0.10.0.jar:0.10.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at clojure.lang.RestFn.invoke(RestFn.java:423) &lt;span class=&quot;error&quot;&gt;&amp;#91;clojure-1.6.0.jar:?&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at backtype.storm.daemon.worker$fn_&lt;em&gt;7188$fn&lt;/em&gt;_7189.invoke(worker.clj:536) &lt;span class=&quot;error&quot;&gt;&amp;#91;storm-core-0.10.0.jar:0.10.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at backtype.storm.daemon.executor$mk_executor_data$fn_&lt;em&gt;5523$fn&lt;/em&gt;_5524.invoke(executor.clj:261) &lt;span class=&quot;error&quot;&gt;&amp;#91;storm-core-0.10.0.jar:0.10.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at backtype.storm.util$async_loop$fn__545.invoke(util.clj:489) &lt;span class=&quot;error&quot;&gt;&amp;#91;storm-core-0.10.0.jar:0.10.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at clojure.lang.AFn.run(AFn.java:22) &lt;span class=&quot;error&quot;&gt;&amp;#91;clojure-1.6.0.jar:?&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at java.lang.Thread.run(Thread.java:745) &lt;span class=&quot;error&quot;&gt;&amp;#91;?:1.8.0_60&amp;#93;&lt;/span&gt;&lt;/p&gt;</description>
                <environment>jdk 8</environment>
        <key id="12951958">STORM-1642</key>
            <summary>NullPointerException when deserialize</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="gmenon">Govind Menon</assignee>
                                    <reporter username="liurenjie1024">Renjie Liu</reporter>
                        <labels>
                    </labels>
                <created>Mon, 21 Mar 2016 07:34:06 +0000</created>
                <updated>Sun, 26 Jan 2025 09:19:30 +0000</updated>
                            <resolved>Mon, 12 Jun 2017 00:49:38 +0000</resolved>
                                    <version>0.10.0</version>
                                    <fixVersion>2.0.0</fixVersion>
                                    <component>storm-core</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>4</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="9000">2.5h</timespent>
                                <comments>
                            <comment id="15204372" author="revans2" created="Mon, 21 Mar 2016 14:45:48 +0000"  >&lt;p&gt;Is this 100% reproducible?  The NPE is happening because the buffer passed into the &lt;tt&gt;KryoTupleDeserializer&lt;/tt&gt; and in turn into &lt;tt&gt;Input&lt;/tt&gt; is null.  This means that the msg placed into a batch had to be null.  With the version fo disruptor that we have in 0.10 it is possible that you emitted sent a null, but I don&apos;t know for sure.&lt;/p&gt;

&lt;p&gt;I don&apos;t see your attached code like you mentioned though.&lt;/p&gt;
</comment>
                            <comment id="15210474" author="liurenjie1024" created="Thu, 24 Mar 2016 16:10:45 +0000"  >&lt;p&gt;I do not know how to reproduce this NPE but it just happens several hours or several days. I&apos;ve went through storm&apos;s code and I don&apos;t think it&apos;s possible for the msg to be null since the MessageDecoder only returns null when length of payload is zero but it&apos;s impossible since the payload   contains like source component id, source task id, etc. This means that even if I emit a null the payload can not be null.&lt;/p&gt;</comment>
                            <comment id="15227907" author="liurenjie1024" created="Wed, 6 Apr 2016 07:57:07 +0000"  >&lt;p&gt;It turns out that this is caused by messages sent from machines outside storm cluster. When storm receives a TaskMessage that can not be deserialized, the worker will be shutdown. I&apos;ll propose a patch to fix this issue.&lt;/p&gt;</comment>
                            <comment id="15229632" author="githubbot" created="Thu, 7 Apr 2016 03:54:13 +0000"  >&lt;p&gt;GitHub user liurenjie1024 opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/storm/pull/1316&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/storm/pull/1316&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/STORM-1642&quot; title=&quot;NullPointerException when deserialize&quot; class=&quot;issue-link&quot; data-issue-key=&quot;STORM-1642&quot;&gt;&lt;del&gt;STORM-1642&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    This patch aims to fix bug &lt;a href=&quot;https://issues.apache.org/jira/browse/STORM-1642&quot; title=&quot;NullPointerException when deserialize&quot; class=&quot;issue-link&quot; data-issue-key=&quot;STORM-1642&quot;&gt;&lt;del&gt;STORM-1642&lt;/del&gt;&lt;/a&gt;.  When we failed to deserialize a tuple, we should skip this tuple and print a log rather than just shutdown the work.&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/MediaV/storm&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/MediaV/storm&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/STORM-1642&quot; title=&quot;NullPointerException when deserialize&quot; class=&quot;issue-link&quot; data-issue-key=&quot;STORM-1642&quot;&gt;&lt;del&gt;STORM-1642&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/storm/pull/1316.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/storm/pull/1316.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #1316&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit fff27f37be6beb54a67f45071259aa2fb83614e4&lt;br/&gt;
Author: liurenjie1024 &amp;lt;liurenjie2008@gmail.com&amp;gt;&lt;br/&gt;
Date:   2016-04-06T10:51:00Z&lt;/p&gt;

&lt;p&gt;    Bug fix&lt;/p&gt;

&lt;p&gt;commit fbfcd8ce31410849f233d617881dc82bed8b9fbd&lt;br/&gt;
Author: liurenjie1024 &amp;lt;liurenjie2008@gmail.com&amp;gt;&lt;br/&gt;
Date:   2016-04-07T02:19:01Z&lt;/p&gt;

&lt;p&gt;    fix build break&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15229708" author="githubbot" created="Thu, 7 Apr 2016 05:19:52 +0000"  >&lt;p&gt;Github user abhishekagarwal87 commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/storm/pull/1316#issuecomment-206701464&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/storm/pull/1316#issuecomment-206701464&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    How was deserialization failure resulting in NPE? Other than that, deserialization failure is the problem with an application itself which application should correct by registering correct serializer/deserializer. storm framework should not skip such tuples on its own. &lt;/p&gt;</comment>
                            <comment id="15229773" author="githubbot" created="Thu, 7 Apr 2016 06:28:45 +0000"  >&lt;p&gt;Github user liurenjie1024 commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/storm/pull/1316#issuecomment-206713335&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/storm/pull/1316#issuecomment-206713335&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    As I have mentioned in bug report, the reason why NPE happens is that storm is vulnerable to fraud message from  processes outside the cluster. To reproduce the NPE, you just need to send a message &lt;span class=&quot;error&quot;&gt;&amp;#91;taskid 0&amp;#93;&lt;/span&gt; to &lt;span class=&quot;error&quot;&gt;&amp;#91;host&amp;#93;&lt;/span&gt;:&lt;span class=&quot;error&quot;&gt;&amp;#91;port&amp;#93;&lt;/span&gt; from anywhere, where taskid is id of one of the tasks running on &lt;span class=&quot;error&quot;&gt;&amp;#91;host&amp;#93;&lt;/span&gt;:&lt;span class=&quot;error&quot;&gt;&amp;#91;port&amp;#93;&lt;/span&gt;. In this case, storm will return a TaskMessage with payload set to null to the deserializer. &lt;br/&gt;
    Storm does not check whether the task message is from processes within the cluster, so deserialization may fail. I  think storm should skip the fruad task message rather than shutdowning the worker when deserialization failed.&lt;/p&gt;</comment>
                            <comment id="15229815" author="githubbot" created="Thu, 7 Apr 2016 07:05:11 +0000"  >&lt;p&gt;Github user abhishekagarwal87 commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/storm/pull/1316#issuecomment-206724794&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/storm/pull/1316#issuecomment-206724794&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    I can&apos;t think of a reason of why would such a message be sent to storm from outside the cluster. Ideally only cluster machines and daemons should have access to the worker ports. Or if it indeeds needs to be solved, then a better method would be to ignore the zero length payload and not add `new TaskMessage(task, null)`.  Before you make any change, let&apos;s wait for comments from someone who is more familiar with this part of code. &lt;/p&gt;</comment>
                            <comment id="15229831" author="githubbot" created="Thu, 7 Apr 2016 07:20:54 +0000"  >&lt;p&gt;Github user liurenjie1024 commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/storm/pull/1316#issuecomment-206732733&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/storm/pull/1316#issuecomment-206732733&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    The reason why such a message is sent is that our security team is scanning all the ports listened on each server and tries to detect potential weakness.&lt;br/&gt;
    At first thought I just wanted to ignore messages with zero payload, but I think ignoring messages failed to be deserialized would be more robust. I think this also matches storm&apos;s design since it throws away messages whose target task id is not in the worker and this patch is just a complement.&lt;/p&gt;</comment>
                            <comment id="15231214" author="githubbot" created="Thu, 7 Apr 2016 22:16:09 +0000"  >&lt;p&gt;Github user knusbaum commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/storm/pull/1316#discussion_r58954552&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/storm/pull/1316#discussion_r58954552&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: storm-core/src/clj/backtype/storm/daemon/executor.clj &amp;#8212;&lt;br/&gt;
    @@ -431,13 +431,14 @@&lt;br/&gt;
           (fn &lt;span class=&quot;error&quot;&gt;&amp;#91;tuple-batch sequence-id end-of-batch?&amp;#93;&lt;/span&gt;&lt;br/&gt;
             (fast-list-iter [&lt;span class=&quot;error&quot;&gt;&amp;#91;task-id msg&amp;#93;&lt;/span&gt; tuple-batch]&lt;br/&gt;
               (let &lt;span class=&quot;error&quot;&gt;&amp;#91;^TupleImpl tuple (if (instance? Tuple msg) msg (.deserialize deserializer msg))&amp;#93;&lt;/span&gt;&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;(when debug? (log-message &quot;Processing received message FOR &quot; task-id &quot; TUPLE: &quot; tuple))&lt;/li&gt;
	&lt;li&gt;(if task-id&lt;/li&gt;
	&lt;li&gt;(tuple-action-fn task-id tuple)&lt;/li&gt;
	&lt;li&gt;;; null task ids are broadcast tuples&lt;/li&gt;
	&lt;li&gt;(fast-list-iter &lt;span class=&quot;error&quot;&gt;&amp;#91;task-id task-ids&amp;#93;&lt;/span&gt;&lt;br/&gt;
    +            (if tuple&lt;br/&gt;
    +              ((when debug? (log-message &quot;Processing received message FOR &quot; task-id &quot; TUPLE: &quot; tuple))&lt;br/&gt;
    +              (if task-id&lt;br/&gt;
                     (tuple-action-fn task-id tuple)&lt;/li&gt;
	&lt;li&gt;))&lt;br/&gt;
    +                ;; null task ids are broadcast tuples&lt;br/&gt;
    +                (fast-list-iter &lt;span class=&quot;error&quot;&gt;&amp;#91;task-id task-ids&amp;#93;&lt;/span&gt;&lt;br/&gt;
    +                  (tuple-action-fn task-id tuple)&lt;br/&gt;
    +                  ))))
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    Lots of parenthetical and formatting problems here.&lt;/p&gt;</comment>
                            <comment id="15232806" author="githubbot" created="Fri, 8 Apr 2016 19:53:24 +0000"  >&lt;p&gt;Github user knusbaum commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/storm/pull/1316#issuecomment-207576535&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/storm/pull/1316#issuecomment-207576535&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Why not no both? I don&apos;t see any reason to propagate `TaskMessage`s with null payloads, but I agree we should be dropping tuples that failed to deserialize in the iterator. &lt;/p&gt;

&lt;p&gt;    This is very much on the critical path, so someone else might want to weigh in.&lt;/p&gt;</comment>
                            <comment id="15233193" author="githubbot" created="Sat, 9 Apr 2016 00:19:00 +0000"  >&lt;p&gt;Github user liurenjie1024 commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/storm/pull/1316#issuecomment-207660738&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/storm/pull/1316#issuecomment-207660738&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    NPE is just a special case of deserialization failure, right?&lt;/p&gt;</comment>
                            <comment id="15233261" author="githubbot" created="Sat, 9 Apr 2016 01:21:25 +0000"  >&lt;p&gt;Github user knusbaum commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/storm/pull/1316#issuecomment-207676736&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/storm/pull/1316#issuecomment-207676736&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    What do you mean?&lt;/p&gt;

&lt;p&gt;    If you mean null payloads are a special case, I disagree. In fact, it&apos;s not a failure at all. We received a null message, so we can perform a NOP as soon as possible.&lt;/p&gt;</comment>
                            <comment id="15233279" author="githubbot" created="Sat, 9 Apr 2016 01:37:05 +0000"  >&lt;p&gt;Github user liurenjie1024 commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/storm/pull/1316#issuecomment-207678155&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/storm/pull/1316#issuecomment-207678155&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Yes, I agree with you that we should drop a task message with null payload as soon as possible, and I&apos;ll push another commit to drop task messages with null payload.&lt;/p&gt;</comment>
                            <comment id="15385661" author="githubbot" created="Wed, 20 Jul 2016 10:46:45 +0000"  >&lt;p&gt;Github user gzm55 commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/storm/pull/1316#discussion_r71503230&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/storm/pull/1316#discussion_r71503230&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: storm-core/src/jvm/backtype/storm/messaging/netty/MessageBatch.java &amp;#8212;&lt;br/&gt;
    @@ -112,6 +115,9 @@ private void writeTaskMessage(ChannelBufferOutputStream bout, TaskMessage messag&lt;br/&gt;
                 throw new RuntimeException(&quot;Task ID should not exceed &quot;+Short.MAX_VALUE);&lt;/p&gt;

&lt;p&gt;             bout.writeShort((short)task_id);&lt;br/&gt;
    +        if (payload_len == 0) {&lt;br/&gt;
    +            LOG.warn(&quot;Zero length payload to task {}.&quot;, (short)task_id);&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    is this a debugging log? should remove them? &lt;/p&gt;</comment>
                            <comment id="15467112" author="kailas" created="Tue, 6 Sep 2016 10:53:25 +0000"  >&lt;p&gt;Hello All,&lt;br/&gt;
I am using storm version 1.0.0 and I am still facing the same exception. Can anyone please confirm whether this issue still present in this version. Also what is the possible impact of this issue. Will it automatically get resolved on retry,&lt;/p&gt;

&lt;p&gt;java.lang.NullPointerException&lt;br/&gt;
	at com.esotericsoftware.kryo.io.Input.setBuffer(Input.java:81) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;kryo-3.0.3.jar:?&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.apache.storm.serialization.KryoTupleDeserializer.deserialize(KryoTupleDeserializer.java:44) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;storm-core-1.0.0.jar:1.0.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.apache.storm.messaging.DeserializingConnectionCallback.recv(DeserializingConnectionCallback.java:56) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;storm-core-1.0.0.jar:1.0.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.apache.storm.messaging.netty.Server.enqueue(Server.java:133) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;storm-core-1.0.0.jar:1.0.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.apache.storm.messaging.netty.Server.received(Server.java:254) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;storm-core-1.0.0.jar:1.0.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.apache.storm.messaging.netty.StormServerHandler.messageReceived(StormServerHandler.java:61) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;storm-core-1.0.0.jar:1.0.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.apache.storm.shade.org.jboss.netty.channel.SimpleChannelUpstreamHandler.handleUpstream(SimpleChannelUpstreamHandler.java:70) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;storm-core-1.0.0.jar:1.0.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.apache.storm.shade.org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:564) &lt;span class=&quot;error&quot;&gt;&amp;#91;storm-core-1.0.0.jar:1.0.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.apache.storm.shade.org.jboss.netty.channel.DefaultChannelPipeline$DefaultChannelHandlerContext.sendUpstream(DefaultChannelPipeline.java:791) &lt;span class=&quot;error&quot;&gt;&amp;#91;storm-core-1.0.0.jar:1.0.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.apache.storm.shade.org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:296) &lt;span class=&quot;error&quot;&gt;&amp;#91;storm-core-1.0.0.jar:1.0.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.apache.storm.shade.org.jboss.netty.handler.codec.frame.FrameDecoder.unfoldAndFireMessageReceived(FrameDecoder.java:462) &lt;span class=&quot;error&quot;&gt;&amp;#91;storm-core-1.0.0.jar:1.0.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.apache.storm.shade.org.jboss.netty.handler.codec.frame.FrameDecoder.callDecode(FrameDecoder.java:443) &lt;span class=&quot;error&quot;&gt;&amp;#91;storm-core-1.0.0.jar:1.0.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.apache.storm.shade.org.jboss.netty.handler.codec.frame.FrameDecoder.messageReceived(FrameDecoder.java:310) &lt;span class=&quot;error&quot;&gt;&amp;#91;storm-core-1.0.0.jar:1.0.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.apache.storm.shade.org.jboss.netty.channel.SimpleChannelUpstreamHandler.handleUpstream(SimpleChannelUpstreamHandler.java:70) &lt;span class=&quot;error&quot;&gt;&amp;#91;storm-core-1.0.0.jar:1.0.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.apache.storm.shade.org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:564) &lt;span class=&quot;error&quot;&gt;&amp;#91;storm-core-1.0.0.jar:1.0.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.apache.storm.shade.org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:559) &lt;span class=&quot;error&quot;&gt;&amp;#91;storm-core-1.0.0.jar:1.0.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.apache.storm.shade.org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:268) &lt;span class=&quot;error&quot;&gt;&amp;#91;storm-core-1.0.0.jar:1.0.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.apache.storm.shade.org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:255) &lt;span class=&quot;error&quot;&gt;&amp;#91;storm-core-1.0.0.jar:1.0.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.apache.storm.shade.org.jboss.netty.channel.socket.nio.NioWorker.read(NioWorker.java:88) &lt;span class=&quot;error&quot;&gt;&amp;#91;storm-core-1.0.0.jar:1.0.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.apache.storm.shade.org.jboss.netty.channel.socket.nio.AbstractNioWorker.process(AbstractNioWorker.java:108) &lt;span class=&quot;error&quot;&gt;&amp;#91;storm-core-1.0.0.jar:1.0.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.apache.storm.shade.org.jboss.netty.channel.socket.nio.AbstractNioSelector.run(AbstractNioSelector.java:318) &lt;span class=&quot;error&quot;&gt;&amp;#91;storm-core-1.0.0.jar:1.0.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.apache.storm.shade.org.jboss.netty.channel.socket.nio.AbstractNioWorker.run(AbstractNioWorker.java:89) &lt;span class=&quot;error&quot;&gt;&amp;#91;storm-core-1.0.0.jar:1.0.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.apache.storm.shade.org.jboss.netty.channel.socket.nio.NioWorker.run(NioWorker.java:178) &lt;span class=&quot;error&quot;&gt;&amp;#91;storm-core-1.0.0.jar:1.0.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.apache.storm.shade.org.jboss.netty.util.ThreadRenamingRunnable.run(ThreadRenamingRunnable.java:108) &lt;span class=&quot;error&quot;&gt;&amp;#91;storm-core-1.0.0.jar:1.0.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.apache.storm.shade.org.jboss.netty.util.internal.DeadLockProofWorker$1.run(DeadLockProofWorker.java:42) &lt;span class=&quot;error&quot;&gt;&amp;#91;storm-core-1.0.0.jar:1.0.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) &lt;span class=&quot;error&quot;&gt;&amp;#91;?:1.8.0_77&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) &lt;span class=&quot;error&quot;&gt;&amp;#91;?:1.8.0_77&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at java.lang.Thread.run(Thread.java:745) &lt;span class=&quot;error&quot;&gt;&amp;#91;?:1.8.0_77&amp;#93;&lt;/span&gt;&lt;/p&gt;</comment>
                            <comment id="15467776" author="liurenjie1024" created="Tue, 6 Sep 2016 16:07:02 +0000"  >&lt;p&gt;I&apos;ve proposed a patch for this issue but the PMC does not accept that.&lt;/p&gt;</comment>
                            <comment id="17918668" author="githubbot" created="Sun, 26 Jan 2025 09:19:30 +0000"  >&lt;p&gt;For your information, &lt;a href=&quot;https://issues.apache.org/jira/projects/STORM/issues/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;all STORM issues&lt;/a&gt;  have been transferred to Github: &lt;a href=&quot;https://github.com/apache/storm/issues/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/storm/issues/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Here is the direct link to this issue in Github: &lt;a href=&quot;https://github.com/apache/storm/issues//5477&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/storm/issues//5477&lt;/a&gt;&lt;br/&gt;
And here is the link to a search for related issues: &lt;a href=&quot;https://github.com/apache/storm/issues/?q=%22STORM-1642%22&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/storm/issues/?q=%22STORM-1642%22&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;(Note: this is an automated bulk comment)&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[no_permission]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            40 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2uxzj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>