diff --git a/storm-client/src/jvm/org/apache/storm/messaging/IConnection.java b/storm-client/src/jvm/org/apache/storm/messaging/IConnection.java
index 7042dc331..5d097d7d6 100644
--- a/storm-client/src/jvm/org/apache/storm/messaging/IConnection.java
+++ b/storm-client/src/jvm/org/apache/storm/messaging/IConnection.java
@@ -55,6 +55,12 @@ public interface IConnection {
      * @return a Load for each of the tasks it knows about.
      */
     public Map<Integer, Load> getLoad(Collection<Integer> tasks);
+    
+    /**
+     * Get the port for this connection
+     * @return The port this connection is using
+     */
+    public int getPort();
 
     /**
      * close this connection
diff --git a/storm-client/src/jvm/org/apache/storm/messaging/IContext.java b/storm-client/src/jvm/org/apache/storm/messaging/IContext.java
index 97148ce06..c5c226128 100644
--- a/storm-client/src/jvm/org/apache/storm/messaging/IContext.java
+++ b/storm-client/src/jvm/org/apache/storm/messaging/IContext.java
@@ -36,7 +36,7 @@ public interface IContext {
     public void prepare(Map<String, Object> topoConf);
     
     /**
-     * This method is invoked when a worker is unload a messaging plugin
+     * This method is invoked when a worker is unloading a messaging plugin
      */
     public void term();
 
diff --git a/storm-client/src/jvm/org/apache/storm/messaging/local/Context.java b/storm-client/src/jvm/org/apache/storm/messaging/local/Context.java
index 06318b8ba..23e934a08 100644
--- a/storm-client/src/jvm/org/apache/storm/messaging/local/Context.java
+++ b/storm-client/src/jvm/org/apache/storm/messaging/local/Context.java
@@ -45,6 +45,11 @@ public class Context implements IContext {
     private static class LocalServer implements IConnection {
         volatile IConnectionCallback _cb;
         final ConcurrentHashMap<Integer, Double> _load = new ConcurrentHashMap<>();
+        final int port;
+        
+        public LocalServer(int port) {
+            this.port = port;
+        }
 
         @Override
         public void registerRecv(IConnectionCallback cb) {
@@ -77,6 +82,11 @@ public class Context implements IContext {
         public void sendLoadMetrics(Map<Integer, Double> taskToLoad) {
             _load.putAll(taskToLoad);
         }
+
+        @Override
+        public int getPort() {
+            return port;
+        }
  
         @Override
         public void close() {
@@ -168,6 +178,11 @@ public class Context implements IContext {
         public void sendLoadMetrics(Map<Integer, Double> taskToLoad) {
             _server.sendLoadMetrics(taskToLoad);
         }
+
+        @Override
+        public int getPort() {
+            return _server.getPort();
+        }
  
         @Override
         public void close() {
@@ -185,7 +200,7 @@ public class Context implements IContext {
         String key = nodeId + "-" + port;
         LocalServer ret = _registry.get(key);
         if (ret == null) {
-            ret = new LocalServer();
+            ret = new LocalServer(port);
             LocalServer tmp = _registry.putIfAbsent(key, ret);
             if (tmp != null) {
                 ret = tmp;
diff --git a/storm-client/src/jvm/org/apache/storm/messaging/netty/Client.java b/storm-client/src/jvm/org/apache/storm/messaging/netty/Client.java
index 52fdda8ec..dd07d602f 100644
--- a/storm-client/src/jvm/org/apache/storm/messaging/netty/Client.java
+++ b/storm-client/src/jvm/org/apache/storm/messaging/netty/Client.java
@@ -414,6 +414,11 @@ public class Client extends ConnectionWithStatus implements IStatefulObject, ISa
         return false;
     }
 
+    @Override
+    public int getPort() {
+        return dstAddress.getPort();
+    }
+    
     /**
      * Gracefully close this client.
      */
diff --git a/storm-client/src/jvm/org/apache/storm/messaging/netty/Context.java b/storm-client/src/jvm/org/apache/storm/messaging/netty/Context.java
index 10ffc83dd..486cd030e 100644
--- a/storm-client/src/jvm/org/apache/storm/messaging/netty/Context.java
+++ b/storm-client/src/jvm/org/apache/storm/messaging/netty/Context.java
@@ -65,7 +65,7 @@ public class Context implements IContext {
      */
     public synchronized IConnection bind(String storm_id, int port) {
         IConnection server = new Server(topoConf, port);
-        connections.put(key(storm_id, port), server);
+        connections.put(key(storm_id, server.getPort()), server);
         return server;
     }
 
@@ -80,7 +80,7 @@ public class Context implements IContext {
         }
         IConnection client =  new Client(topoConf, clientChannelFactory, 
                 clientScheduleService, host, port, this);
-        connections.put(key(host, port), client);
+        connections.put(key(host, client.getPort()), client);
         return client;
     }
 
diff --git a/storm-client/src/jvm/org/apache/storm/messaging/netty/Server.java b/storm-client/src/jvm/org/apache/storm/messaging/netty/Server.java
index 376006fb2..91ef702fd 100644
--- a/storm-client/src/jvm/org/apache/storm/messaging/netty/Server.java
+++ b/storm-client/src/jvm/org/apache/storm/messaging/netty/Server.java
@@ -64,6 +64,7 @@ class Server extends ConnectionWithStatus implements IStatefulObject, ISaslServe
     List<TaskMessage> closeMessage = Arrays.asList(new TaskMessage(-1, null));
     private KryoValuesSerializer _ser;
     private IConnectionCallback _cb = null; 
+    private final int boundPort;
     
     @SuppressWarnings("rawtypes")
     Server(Map<String, Object> topoConf, int port) {
@@ -100,6 +101,7 @@ class Server extends ConnectionWithStatus implements IStatefulObject, ISaslServe
 
         // Bind and start to accept incoming connections.
         Channel channel = bootstrap.bind(new InetSocketAddress(port));
+        boundPort = ((InetSocketAddress)channel.getLocalAddress()).getPort();
         allChannels.add(channel);
     }
     
@@ -156,6 +158,11 @@ class Server extends ConnectionWithStatus implements IStatefulObject, ISaslServe
         allChannels.remove(channel);
     }
 
+    @Override
+    public int getPort() {
+        return boundPort;
+    }
+    
     /**
      * close all channels, and release resources
      */
diff --git a/storm-client/src/jvm/org/apache/storm/utils/Utils.java b/storm-client/src/jvm/org/apache/storm/utils/Utils.java
index 45bd12309..bc1426fc2 100644
--- a/storm-client/src/jvm/org/apache/storm/utils/Utils.java
+++ b/storm-client/src/jvm/org/apache/storm/utils/Utils.java
@@ -1166,18 +1166,30 @@ public class Utils {
         return null;
     }
 
-    public static int getAvailablePort(int prefferedPort) {
+    /**
+     * Gets an available port. Consider if it is possible to pass port 0 to the
+     * server instead of using this method, since there is no guarantee that the
+     * port returned by this method will remain free.
+     *
+     * @param preferredPort
+     * @return The preferred port if available, or a random available port
+     */
+    public static int getAvailablePort(int preferredPort) {
         int localPort = -1;
-        try(ServerSocket socket = new ServerSocket(prefferedPort)) {
+        try(ServerSocket socket = new ServerSocket(preferredPort)) {
             localPort = socket.getLocalPort();
         } catch(IOException exp) {
-            if (prefferedPort > 0) {
+            if (preferredPort > 0) {
                 return getAvailablePort(0);
             }
         }
         return localPort;
     }
 
+    /**
+     * Shortcut to calling {@link #getAvailablePort(int) } with 0 as the preferred port
+     * @return A random available port
+     */
     public static int getAvailablePort() {
         return getAvailablePort(0);
     }
