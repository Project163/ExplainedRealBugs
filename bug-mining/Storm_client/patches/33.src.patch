diff --git a/storm-client/src/jvm/org/apache/storm/daemon/worker/LogConfigManager.java b/storm-client/src/jvm/org/apache/storm/daemon/worker/LogConfigManager.java
index 00fccf9a3..c900580ad 100644
--- a/storm-client/src/jvm/org/apache/storm/daemon/worker/LogConfigManager.java
+++ b/storm-client/src/jvm/org/apache/storm/daemon/worker/LogConfigManager.java
@@ -111,6 +111,9 @@ public class LogConfigManager {
     // also called from processLogConfigChange
     public void resetLogLevels() {
         TreeMap<String, LogLevel> latestLogLevelMap = latestLogConfig.get();
+
+        LOG.debug("Resetting log levels: Latest log config is {}", latestLogLevelMap);
+
         LoggerContext loggerContext = (LoggerContext) LogManager.getContext(false);
 
         for (String loggerName : latestLogLevelMap.descendingKeySet()) {
@@ -120,12 +123,12 @@ public class LogConfigManager {
             if (timeout < Time.currentTimeMillis()) {
                 LOG.info("{}: Resetting level to {}", loggerName, resetLogLevel);
                 setLoggerLevel(loggerContext, loggerName, resetLogLevel);
+                latestLogConfig.getAndUpdate(input -> {
+                    TreeMap<String, LogLevel> result = new TreeMap<>(input);
+                    result.remove(loggerName);
+                    return result;
+                });
             }
-            latestLogConfig.getAndUpdate(input -> {
-                TreeMap<String, LogLevel> result = new TreeMap<>(input);
-                result.remove(loggerName);
-                return result;
-            });
         }
         loggerContext.updateLoggers();
     }
diff --git a/storm-client/test/jvm/org/apache/storm/daemon/worker/LogConfigManagerTest.java b/storm-client/test/jvm/org/apache/storm/daemon/worker/LogConfigManagerTest.java
index 95491a44f..e8259e0a4 100644
--- a/storm-client/test/jvm/org/apache/storm/daemon/worker/LogConfigManagerTest.java
+++ b/storm-client/test/jvm/org/apache/storm/daemon/worker/LogConfigManagerTest.java
@@ -20,6 +20,7 @@ package org.apache.storm.daemon.worker;
 import static org.junit.Assert.*;
 import static org.mockito.Mockito.*;
 
+import java.util.Collections;
 import java.util.TreeMap;
 import java.util.concurrent.atomic.AtomicReference;
 
@@ -132,6 +133,47 @@ public class LogConfigManagerTest {
             verify(underTest).setLoggerLevel(anyObject(), eq(LogManager.ROOT_LOGGER_NAME), eq("WARN"));
         }
     }
+
+    @Test
+    public void testLogResetProperlyResetLogLevelAfterTimeout() throws InterruptedException {
+        try (SimulatedTime t = new SimulatedTime()){
+            long inThirtySeconds = Time.currentTimeMillis() + 30_000;
+            TreeMap<String, LogLevel> config = new TreeMap<>();
+            config.put(LogManager.ROOT_LOGGER_NAME, ll("DEBUG", "WARN", inThirtySeconds));
+            AtomicReference<TreeMap<String, LogLevel>> atomConf = new AtomicReference<>(config);
+
+            LogConfigManager underTest = spy(new LogConfigManagerUnderTest(atomConf));
+
+            TreeMap<String, LogLevel> expected = new TreeMap<>();
+            LogLevel logLevel = new LogLevel(LogLevelAction.UPDATE);
+            logLevel.set_target_log_level("DEBUG");
+            logLevel.set_reset_log_level("WARN");
+            logLevel.set_reset_log_level_timeout_epoch(30_000);
+            expected.put(LogManager.ROOT_LOGGER_NAME, logLevel);
+
+            underTest.resetLogLevels();
+            assertEquals(expected, atomConf.get());
+            verify(underTest, never()).setLoggerLevel(anyObject(), eq(LogManager.ROOT_LOGGER_NAME), anyString());
+
+            // 11 seconds passed by, not timing out
+            Time.advanceTimeSecs(11);
+            underTest.resetLogLevels();
+            assertEquals(expected, atomConf.get());
+            verify(underTest, never()).setLoggerLevel(anyObject(), eq(LogManager.ROOT_LOGGER_NAME), anyString());
+
+            // 22 seconds passed by, still not timing out
+            Time.advanceTimeSecs(11);
+            underTest.resetLogLevels();
+            assertEquals(expected, atomConf.get());
+            verify(underTest, never()).setLoggerLevel(anyObject(), eq(LogManager.ROOT_LOGGER_NAME), anyString());
+
+            // 33 seconds passed by, timed out
+            Time.advanceTimeSecs(11);
+            underTest.resetLogLevels();
+            assertEquals(new TreeMap<>(), atomConf.get());
+            verify(underTest).setLoggerLevel(anyObject(), eq(LogManager.ROOT_LOGGER_NAME), eq("WARN"));
+        }
+    }
     
     @Test
     public void testLogResetsNamedLoggersWithPastTimeout() {
