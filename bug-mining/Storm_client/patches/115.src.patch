diff --git a/storm-client/src/jvm/org/apache/storm/daemon/worker/Worker.java b/storm-client/src/jvm/org/apache/storm/daemon/worker/Worker.java
index e950c0513..175a91ade 100644
--- a/storm-client/src/jvm/org/apache/storm/daemon/worker/Worker.java
+++ b/storm-client/src/jvm/org/apache/storm/daemon/worker/Worker.java
@@ -14,6 +14,7 @@ package org.apache.storm.daemon.worker;
 
 import java.io.File;
 import java.io.IOException;
+import java.net.UnknownHostException;
 import java.nio.charset.Charset;
 import java.security.PrivilegedExceptionAction;
 import java.util.ArrayList;
@@ -22,6 +23,7 @@ import java.util.HashMap;
 import java.util.List;
 import java.util.Map;
 import java.util.concurrent.atomic.AtomicReference;
+import java.util.function.Supplier;
 import java.util.regex.Matcher;
 import java.util.regex.Pattern;
 import java.util.stream.Collectors;
@@ -45,6 +47,7 @@ import org.apache.storm.generated.ExecutorInfo;
 import org.apache.storm.generated.ExecutorStats;
 import org.apache.storm.generated.LSWorkerHeartbeat;
 import org.apache.storm.generated.LogConfig;
+import org.apache.storm.generated.Supervisor;
 import org.apache.storm.generated.SupervisorWorkerHeartbeat;
 import org.apache.storm.messaging.IConnection;
 import org.apache.storm.messaging.IContext;
@@ -61,6 +64,7 @@ import org.apache.storm.utils.LocalState;
 import org.apache.storm.utils.NimbusClient;
 import org.apache.storm.utils.ObjectReader;
 import org.apache.storm.utils.SupervisorClient;
+import org.apache.storm.utils.SupervisorIfaceFactory;
 import org.apache.storm.utils.Time;
 import org.apache.storm.utils.Utils;
 import org.slf4j.Logger;
@@ -87,6 +91,7 @@ public class Worker implements Shutdownable, DaemonCommon {
     private AtomicReference<Credentials> credentialsAtom;
     private Subject subject;
     private Collection<IAutoCredentials> autoCreds;
+    private final Supplier<SupervisorIfaceFactory> supervisorIfaceSupplier;
 
 
     /**
@@ -103,7 +108,7 @@ public class Worker implements Shutdownable, DaemonCommon {
      */
 
     public Worker(Map<String, Object> conf, IContext context, String topologyId, String assignmentId,
-                  int supervisorPort, int port, String workerId) {
+                  int supervisorPort, int port, String workerId, Supplier<SupervisorIfaceFactory> supervisorIfaceSupplier) {
         this.conf = conf;
         this.context = context;
         this.topologyId = topologyId;
@@ -113,6 +118,7 @@ public class Worker implements Shutdownable, DaemonCommon {
         this.workerId = workerId;
         this.logConfigManager = new LogConfigManager();
         this.metricRegistry = new StormMetricRegistry();
+        this.supervisorIfaceSupplier = supervisorIfaceSupplier;
     }
 
     public static void main(String[] args) throws Exception {
@@ -125,8 +131,16 @@ public class Worker implements Shutdownable, DaemonCommon {
         Map<String, Object> conf = ConfigUtils.readStormConfig();
         Utils.setupDefaultUncaughtExceptionHandler();
         StormCommon.validateDistributedMode(conf);
-        Worker worker = new Worker(conf, null, stormId, assignmentId, Integer.parseInt(supervisorPort),
-                                   Integer.parseInt(portStr), workerId);
+        int supervisorPortInt = Integer.parseInt(supervisorPort);
+        Supplier<SupervisorIfaceFactory> supervisorIfaceSuppler = () -> {
+            try {
+                return SupervisorClient.getConfiguredClient(conf, Utils.hostname(), supervisorPortInt);
+            } catch (UnknownHostException e) {
+                throw Utils.wrapInRuntime(e);
+            }
+        };
+        Worker worker = new Worker(conf, null, stormId, assignmentId, supervisorPortInt,
+                                   Integer.parseInt(portStr), workerId, supervisorIfaceSuppler);
         worker.start();
         int workerShutdownSleepSecs = ObjectReader.getInt(conf.get(Config.SUPERVISOR_WORKER_SHUTDOWN_SLEEP_SECS));
         LOG.info("Adding shutdown hook with kill in {} secs", workerShutdownSleepSecs);
@@ -172,7 +186,7 @@ public class Worker implements Shutdownable, DaemonCommon {
     private Object loadWorker(Map<String, Object> topologyConf, IStateStorage stateStorage, IStormClusterState stormClusterState,
                               Map<String, String> initCreds, Credentials initialCredentials)
         throws Exception {
-        workerState = new WorkerState(conf, context, topologyId, assignmentId, supervisorPort, port, workerId,
+        workerState = new WorkerState(conf, context, topologyId, assignmentId, supervisorIfaceSupplier, port, workerId,
                                       topologyConf, stateStorage, stormClusterState, autoCreds, metricRegistry);
 
         // Heartbeat here so that worker process dies if this fails
@@ -425,8 +439,8 @@ public class Worker implements Shutdownable, DaemonCommon {
         SupervisorWorkerHeartbeat workerHeartbeat = new SupervisorWorkerHeartbeat(lsWorkerHeartbeat.get_topology_id(),
                                                                                   lsWorkerHeartbeat.get_executors(),
                                                                                   lsWorkerHeartbeat.get_time_secs());
-        try (SupervisorClient client = SupervisorClient.getConfiguredClient(conf, Utils.hostname(), supervisorPort)) {
-            client.getClient().sendSupervisorWorkerHeartbeat(workerHeartbeat);
+        try (SupervisorIfaceFactory fac = supervisorIfaceSupplier.get()) {
+            fac.getIface().sendSupervisorWorkerHeartbeat(workerHeartbeat);
         } catch (Exception tr1) {
             //If any error/exception thrown, report directly to nimbus.
             LOG.warn("Exception when send heartbeat to local supervisor", tr1.getMessage());
diff --git a/storm-client/src/jvm/org/apache/storm/daemon/worker/WorkerState.java b/storm-client/src/jvm/org/apache/storm/daemon/worker/WorkerState.java
index 2aa96a96a..913261d24 100644
--- a/storm-client/src/jvm/org/apache/storm/daemon/worker/WorkerState.java
+++ b/storm-client/src/jvm/org/apache/storm/daemon/worker/WorkerState.java
@@ -69,6 +69,7 @@ import org.apache.storm.serialization.ITupleSerializer;
 import org.apache.storm.serialization.KryoTupleSerializer;
 import org.apache.storm.shade.com.google.common.collect.ImmutableMap;
 import org.apache.storm.shade.com.google.common.collect.Sets;
+import org.apache.storm.shade.org.apache.commons.lang.Validate;
 import org.apache.storm.task.WorkerTopologyContext;
 import org.apache.storm.tuple.AddressedTuple;
 import org.apache.storm.tuple.Fields;
@@ -76,6 +77,7 @@ import org.apache.storm.utils.ConfigUtils;
 import org.apache.storm.utils.JCQueue;
 import org.apache.storm.utils.ObjectReader;
 import org.apache.storm.utils.SupervisorClient;
+import org.apache.storm.utils.SupervisorIfaceFactory;
 import org.apache.storm.utils.ThriftTopologyUtils;
 import org.apache.storm.utils.Utils;
 import org.apache.storm.utils.Utils.SmartThread;
@@ -92,7 +94,7 @@ public class WorkerState {
     final IConnection receiver;
     final String topologyId;
     final String assignmentId;
-    final int supervisorPort;
+    private final Supplier<SupervisorIfaceFactory> supervisorIfaceSupplier;
     final int port;
     final String workerId;
     final IStateStorage stateStorage;
@@ -151,18 +153,18 @@ public class WorkerState {
     private final StormMetricRegistry metricRegistry;
 
     public WorkerState(Map<String, Object> conf, IContext mqContext, String topologyId, String assignmentId,
-                       int supervisorPort, int port, String workerId, Map<String, Object> topologyConf, IStateStorage stateStorage,
+                       Supplier<SupervisorIfaceFactory> supervisorIfaceSupplier, int port, String workerId, Map<String, Object> topologyConf, IStateStorage stateStorage,
                        IStormClusterState stormClusterState, Collection<IAutoCredentials> autoCredentials,
                        StormMetricRegistry metricRegistry) throws IOException,
         InvalidTopologyException {
         this.metricRegistry = metricRegistry;
         this.autoCredentials = autoCredentials;
         this.conf = conf;
+        this.supervisorIfaceSupplier = supervisorIfaceSupplier;
         this.localExecutors = new HashSet<>(readWorkerExecutors(stormClusterState, topologyId, assignmentId, port));
         this.mqContext = (null != mqContext) ? mqContext : TransportFactory.makeContext(topologyConf);
         this.topologyId = topologyId;
         this.assignmentId = assignmentId;
-        this.supervisorPort = supervisorPort;
         this.port = port;
         this.workerId = workerId;
         this.stateStorage = stateStorage;
@@ -370,9 +372,14 @@ public class WorkerState {
     public SmartThread makeTransferThread() {
         return workerTransfer.makeTransferThread();
     }
-
+    
     public void refreshConnections() {
-        Assignment assignment = getLocalAssignment(conf, stormClusterState, topologyId);
+        Assignment assignment = null;
+        try {
+            assignment = getLocalAssignment(stormClusterState, topologyId);
+        } catch (Exception e) {
+            LOG.warn("Failed to read assignment. This should only happen when topology is shutting down.", e);
+        }
 
         Set<NodeInfo> neededConnections = new HashSet<>();
         Map<Integer, NodeInfo> newTaskToNodePort = new HashMap<>();
@@ -393,6 +400,7 @@ public class WorkerState {
         Set<NodeInfo> newConnections = Sets.difference(neededConnections, currentConnections);
         Set<NodeInfo> removeConnections = Sets.difference(currentConnections, neededConnections);
 
+        Map<String, String> nodeHost = assignment != null ? assignment.get_node_host() : null;
         // Add new connections atomically
         cachedNodeToPortSocket.getAndUpdate(prev -> {
             Map<NodeInfo, IConnection> next = new HashMap<>(prev);
@@ -400,7 +408,8 @@ public class WorkerState {
                 next.put(nodeInfo,
                          mqContext.connect(
                              topologyId,
-                             assignment.get_node_host().get(nodeInfo.get_node()),    // Host
+                             //nodeHost is not null here, as newConnections is only non-empty if assignment was not null above.
+                             nodeHost.get(nodeInfo.get_node()),    // Host
                              nodeInfo.get_port().iterator().next().intValue(),       // Port
                              workerTransfer.getRemoteBackPressureStatus()));
             }
@@ -625,7 +634,8 @@ public class WorkerState {
         LOG.info("Reading assignments");
         List<List<Long>> executorsAssignedToThisWorker = new ArrayList<>();
         executorsAssignedToThisWorker.add(Constants.SYSTEM_EXECUTOR_ID);
-        Map<List<Long>, NodeInfo> executorToNodePort = getLocalAssignment(conf, stormClusterState, topologyId).get_executor_node_port();
+        Map<List<Long>, NodeInfo> executorToNodePort = 
+            getLocalAssignment(stormClusterState, topologyId).get_executor_node_port();
         for (Map.Entry<List<Long>, NodeInfo> entry : executorToNodePort.entrySet()) {
             NodeInfo nodeInfo = entry.getValue();
             if (nodeInfo.get_node().equals(assignmentId) && nodeInfo.get_port().iterator().next() == port) {
@@ -635,18 +645,17 @@ public class WorkerState {
         return executorsAssignedToThisWorker;
     }
 
-    private Assignment getLocalAssignment(Map<String, Object> conf, IStormClusterState stormClusterState, String topologyId) {
-        if (!ConfigUtils.isLocalMode(conf)) {
-            try (SupervisorClient supervisorClient = SupervisorClient.getConfiguredClient(conf, Utils.hostname(),
-                                                                                          supervisorPort)) {
-                Assignment assignment = supervisorClient.getClient().getLocalAssignmentForStorm(topologyId);
-                return assignment;
-            } catch (Throwable tr1) {
+    private Assignment getLocalAssignment(IStormClusterState stormClusterState, String topologyId) {
+        try (SupervisorIfaceFactory fac = supervisorIfaceSupplier.get()) {
+            return fac.getIface().getLocalAssignmentForStorm(topologyId);
+        } catch (Throwable e) {
                 //if any error/exception thrown, fetch it from zookeeper
-                return stormClusterState.remoteAssignmentInfo(topologyId, null);
+            Assignment assignment = stormClusterState.remoteAssignmentInfo(topologyId, null);
+            if (assignment == null) {
+                throw new RuntimeException("Failed to read worker assignment."
+                    + " Supervisor client threw exception, and assignment in Zookeeper was null", e);
             }
-        } else {
-            return stormClusterState.remoteAssignmentInfo(topologyId, null);
+            return assignment;
         }
     }
 
@@ -666,7 +675,7 @@ public class WorkerState {
         for (List<Long> executor : executors) {
             int port = this.getPort();
             receiveQueueMap.put(executor, new JCQueue("receive-queue" + executor.toString(),
-                recvQueueSize, overflowLimit, recvBatchSize, backPressureWaitStrategy,
+                                                      recvQueueSize, overflowLimit, recvBatchSize, backPressureWaitStrategy,
                 this.getTopologyId(), Constants.SYSTEM_COMPONENT_ID, -1, this.getPort(), metricRegistry));
 
         }
diff --git a/storm-client/src/jvm/org/apache/storm/security/auth/workertoken/WorkerTokenAuthorizer.java b/storm-client/src/jvm/org/apache/storm/security/auth/workertoken/WorkerTokenAuthorizer.java
index f3212215f..c225e2742 100644
--- a/storm-client/src/jvm/org/apache/storm/security/auth/workertoken/WorkerTokenAuthorizer.java
+++ b/storm-client/src/jvm/org/apache/storm/security/auth/workertoken/WorkerTokenAuthorizer.java
@@ -152,4 +152,4 @@ public class WorkerTokenAuthorizer implements PasswordProvider, Closeable {
             state.disconnect();
         }
     }
-}
\ No newline at end of file
+}
diff --git a/storm-client/src/jvm/org/apache/storm/utils/SupervisorClient.java b/storm-client/src/jvm/org/apache/storm/utils/SupervisorClient.java
index 23647776d..64d5aceff 100644
--- a/storm-client/src/jvm/org/apache/storm/utils/SupervisorClient.java
+++ b/storm-client/src/jvm/org/apache/storm/utils/SupervisorClient.java
@@ -28,7 +28,7 @@ import org.slf4j.LoggerFactory;
  * <li>nimbus -> supervisor: assign assignments for a node.</li>
  * </ul>
  */
-public class SupervisorClient extends ThriftClient {
+public class SupervisorClient extends ThriftClient implements SupervisorIfaceFactory {
     private static final Logger LOG = LoggerFactory.getLogger(SupervisorClient.class);
     private Supervisor.Client client;
 
@@ -76,7 +76,8 @@ public class SupervisorClient extends ThriftClient {
         }
     }
 
-    public Supervisor.Client getClient() {
+    @Override
+    public Supervisor.Client getIface() {
         return client;
     }
 }
diff --git a/storm-client/src/jvm/org/apache/storm/utils/SupervisorIfaceFactory.java b/storm-client/src/jvm/org/apache/storm/utils/SupervisorIfaceFactory.java
new file mode 100644
index 000000000..eddfa7332
--- /dev/null
+++ b/storm-client/src/jvm/org/apache/storm/utils/SupervisorIfaceFactory.java
@@ -0,0 +1,30 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package org.apache.storm.utils;
+
+import java.io.Closeable;
+
+public interface SupervisorIfaceFactory extends Closeable {
+
+    org.apache.storm.generated.Supervisor.Iface getIface();
+
+    @Override
+    default void close() {
+    }
+}
