diff --git a/okhttp-tests/src/test/java/com/squareup/okhttp/internal/spdy/HpackDraft05Test.java b/okhttp-tests/src/test/java/com/squareup/okhttp/internal/spdy/HpackDraft05Test.java
index 383ae4e43..d86db867c 100644
--- a/okhttp-tests/src/test/java/com/squareup/okhttp/internal/spdy/HpackDraft05Test.java
+++ b/okhttp-tests/src/test/java/com/squareup/okhttp/internal/spdy/HpackDraft05Test.java
@@ -16,6 +16,7 @@
 package com.squareup.okhttp.internal.spdy;
 
 import java.io.IOException;
+import java.util.Arrays;
 import java.util.List;
 import okio.ByteString;
 import okio.OkBuffer;
@@ -39,6 +40,27 @@ public class HpackDraft05Test {
     hpackWriter = new HpackDraft05.Writer(bytesOut);
   }
 
+  /**
+   * Variable-length quantity special cases strings which are longer than 127
+   * bytes.  Values such as cookies can be 4KiB, and should be possible to send.
+   *
+   * <p> http://tools.ietf.org/html/draft-ietf-httpbis-header-compression-05#section-4.1.2
+   */
+  @Test public void largeHeaderValue() throws IOException {
+    char[] value = new char[4096];
+    Arrays.fill(value, '!');
+    List<Header> headerBlock = headerEntries("cookie", new String(value));
+
+    hpackWriter.writeHeaders(headerBlock);
+    bytesIn.write(bytesOut, bytesOut.size());
+    hpackReader.readHeaders();
+    hpackReader.emitReferenceSet();
+
+    assertEquals(0, hpackReader.headerCount);
+
+    assertEquals(headerBlock, hpackReader.getAndReset());
+  }
+
   /**
    * HPACK has a max header table size, which can be smaller than the max header message.
    * Ensure the larger header content is not lost.
diff --git a/okhttp/src/main/java/com/squareup/okhttp/internal/spdy/HpackDraft05.java b/okhttp/src/main/java/com/squareup/okhttp/internal/spdy/HpackDraft05.java
index 0f51db6c3..f1257116d 100644
--- a/okhttp/src/main/java/com/squareup/okhttp/internal/spdy/HpackDraft05.java
+++ b/okhttp/src/main/java/com/squareup/okhttp/internal/spdy/HpackDraft05.java
@@ -363,13 +363,8 @@ final class HpackDraft05 {
      */
     ByteString readByteString(boolean asciiLowercase) throws IOException {
       int firstByte = readByte();
-      int length = readInt(firstByte, PREFIX_8_BITS);
-
-      boolean huffmanDecode = false;
-      if ((length & 0x80) == 0x80) { // 1NNNNNNN
-        length &= ~0x80;
-        huffmanDecode = true;
-      }
+      boolean huffmanDecode = (firstByte & 0x80) == 0x80; // 1NNNNNNN
+      int length = readInt(firstByte, PREFIX_7_BITS);
 
       ByteString byteString = source.readByteString(length);
 
@@ -444,7 +439,7 @@ final class HpackDraft05 {
     }
 
     void writeByteString(ByteString data) throws IOException {
-      writeInt(data.size(), PREFIX_8_BITS, 0);
+      writeInt(data.size(), PREFIX_7_BITS, 0);
       out.write(data);
     }
   }
