{"url":"https://api.github.com/repos/libgdx/libgdx/issues/2713","repository_url":"https://api.github.com/repos/libgdx/libgdx","labels_url":"https://api.github.com/repos/libgdx/libgdx/issues/2713/labels{/name}","comments_url":"https://api.github.com/repos/libgdx/libgdx/issues/2713/comments","events_url":"https://api.github.com/repos/libgdx/libgdx/issues/2713/events","html_url":"https://github.com/libgdx/libgdx/issues/2713","id":53419417,"node_id":"MDU6SXNzdWU1MzQxOTQxNw==","number":2713,"title":"ScrollPane layout problem with ontop scrollbars and content smaller than scrollpane area","user":{"login":"vbousquet","id":2796036,"node_id":"MDQ6VXNlcjI3OTYwMzY=","avatar_url":"https://avatars.githubusercontent.com/u/2796036?v=4","gravatar_id":"","url":"https://api.github.com/users/vbousquet","html_url":"https://github.com/vbousquet","followers_url":"https://api.github.com/users/vbousquet/followers","following_url":"https://api.github.com/users/vbousquet/following{/other_user}","gists_url":"https://api.github.com/users/vbousquet/gists{/gist_id}","starred_url":"https://api.github.com/users/vbousquet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vbousquet/subscriptions","organizations_url":"https://api.github.com/users/vbousquet/orgs","repos_url":"https://api.github.com/users/vbousquet/repos","events_url":"https://api.github.com/users/vbousquet/events{/privacy}","received_events_url":"https://api.github.com/users/vbousquet/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2015-01-05T17:15:47Z","updated_at":"2015-01-05T21:17:37Z","closed_at":"2015-01-05T21:08:27Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"When using on top scroll bar for a scroll pane with a content widget smaller than the display area, the layout seems incorrect to me since the content widget won't get extended to the complete scrollpane area (this is a followup to PR #2709).\n\nIf we take, the [ScrollPaneScrollBarsTest](https://github.com/libgdx/libgdx/blob/master/tests/gdx-tests/src/com/badlogic/gdx/tests/ScrollPaneScrollBarsTest.java) test and just change the displayed text by a rect (to clearly see the bounds) with this simple modification ;\n\n``` java\n// vertOnlyLeftTable.add(new Label(\"VERT-ONLY-LEFT\", skin));\n// vertOnlyRightTable.add(new Label(\"VERT-ONLY-RIGHT\", skin));\nvertOnlyLeftTable.add(new Image(skin.getDrawable(\"default-rect\"))).height(20).expandX().fill();\nvertOnlyRightTable.add(new Image(skin.getDrawable(\"default-rect\"))).height(20).expandX().fill();\n```\n\nYou get the following result :\n![2015-01-05 17_34_34-scrollpanescrollbarstest](https://cloud.githubusercontent.com/assets/2796036/5616073/47926256-9501-11e4-8b8a-978516219378.png)\n\nand when scrolling:\n![2015-01-05 17_35_14-scrollpanescrollbarstest](https://cloud.githubusercontent.com/assets/2796036/5616076/50114384-9501-11e4-9cce-99d35a1ee9d8.png)\n\nI would think that the correct behavior would be to have the content widget expands to the complete scrollpane area.\n\nLooking at the code, this seems to be due to the fact that the size of the widget is set after adjusting the display area of the content pane:\n\n``` java\n        if (fade) {\n            // Make sure widget is drawn under fading scrollbars.\n            if (scrollX) areaHeight -= scrollbarHeight;\n            if (scrollY) areaWidth -= scrollbarWidth;\n        } else {\n            if (scrollbarsOnTop) {\n                // Make sure widget is drawn under non-fading scrollbars.\n                if (scrollX) widgetAreaBounds.height += scrollbarHeight;\n                if (scrollY) widgetAreaBounds.width += scrollbarWidth;\n            } else {\n                // Offset widget area y for horizontal scrollbar at bottom.\n                if (scrollX && hScrollOnBottom) widgetAreaBounds.y += scrollbarHeight;\n                // Offset widget area x for vertical scrollbar at left.\n                if (scrollY && !vScrollOnRight) widgetAreaBounds.x += scrollbarWidth;\n            }\n        }\n\n        // If the widget is smaller than the available space, make it take up the available space.\n        widgetWidth = disableX ? areaWidth : Math.max(areaWidth, widgetWidth);\n        widgetHeight = disableY ? areaHeight : Math.max(areaHeight, widgetHeight);\n```\n\nA way to make it better would be to extend the size of the content widget when scrollbars are on top before adjusting the size of the display area (if you agree, I will prepare a proper PR):\n\n``` java\n        if (scrollbarsOnTop) {\n            // If the widget is smaller than the available space, make it take up the available space.\n            widgetWidth = disableX ? areaWidth : Math.max(areaWidth, widgetWidth);\n            widgetHeight = disableY ? areaHeight : Math.max(areaHeight, widgetHeight);\n\n            if (fade) {\n                // Make sure widget is drawn under fading scrollbars.\n                if (scrollX) areaHeight -= scrollbarHeight;\n                if (scrollY) areaWidth -= scrollbarWidth;\n            } else {\n                // Make sure widget is drawn under non-fading scrollbars.\n                if (scrollX) widgetAreaBounds.height += scrollbarHeight;\n                if (scrollY) widgetAreaBounds.width += scrollbarWidth;\n            }\n        } else {\n            if (fade) {\n                // Make sure widget is drawn under fading scrollbars.\n                if (scrollX) areaHeight -= scrollbarHeight;\n                if (scrollY) areaWidth -= scrollbarWidth;\n            } \n            // Offset widget area y for horizontal scrollbar at bottom.\n            if (scrollX && hScrollOnBottom) widgetAreaBounds.y += scrollbarHeight;\n            // Offset widget area x for vertical scrollbar at left.\n            if (scrollY && !vScrollOnRight) widgetAreaBounds.x += scrollbarWidth;\n\n            // If the widget is smaller than the available space, make it take up the available space.\n            widgetWidth = disableX ? areaWidth : Math.max(areaWidth, widgetWidth);\n            widgetHeight = disableY ? areaHeight : Math.max(areaHeight, widgetHeight);\n        }\n```\n\nUsing this little modification, I made the following test situations ;\n- content smaller/bigger than scrollpane, ontop = true, fade = true, => Ok\n- content smaller/bigger than scrollpane, ontop = true, fade = false, => Ok\n- content smaller/bigger than scrollpane, ontop = false, fade = false, => Ok\n- content smaller/bigger than scrollpane, ontop = false, fade = true, => somewhat wrong (view area clipped where the scrollbar would be) => but is there any use case for this ?\n\nWhat do you think ?\n\nNB : On a side note, I think there is a tiny little bug in [ScrollPaneScrollBarsTest](https://github.com/libgdx/libgdx/blob/master/tests/gdx-tests/src/com/badlogic/gdx/tests/ScrollPaneScrollBarsTest.java), the initial state of scrollpane flags are not set. You need to add this at the end of the constructor to get correct result (I will do a proper PR when discussion is ok):\n\n``` java\n        for (ScrollPane pane : scrollPanes) {\n            pane.setFadeScrollBars(doFade);\n            pane.setScrollbarsOnTop(doOnTop);\n        }\n```\n","closed_by":{"login":"NathanSweet","id":434010,"node_id":"MDQ6VXNlcjQzNDAxMA==","avatar_url":"https://avatars.githubusercontent.com/u/434010?v=4","gravatar_id":"","url":"https://api.github.com/users/NathanSweet","html_url":"https://github.com/NathanSweet","followers_url":"https://api.github.com/users/NathanSweet/followers","following_url":"https://api.github.com/users/NathanSweet/following{/other_user}","gists_url":"https://api.github.com/users/NathanSweet/gists{/gist_id}","starred_url":"https://api.github.com/users/NathanSweet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/NathanSweet/subscriptions","organizations_url":"https://api.github.com/users/NathanSweet/orgs","repos_url":"https://api.github.com/users/NathanSweet/repos","events_url":"https://api.github.com/users/NathanSweet/events{/privacy}","received_events_url":"https://api.github.com/users/NathanSweet/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/libgdx/libgdx/issues/2713/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/libgdx/libgdx/issues/2713/timeline","performed_via_github_app":null,"state_reason":"completed"}