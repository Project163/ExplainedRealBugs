{"url":"https://api.github.com/repos/libgdx/libgdx/issues/5059","repository_url":"https://api.github.com/repos/libgdx/libgdx","labels_url":"https://api.github.com/repos/libgdx/libgdx/issues/5059/labels{/name}","comments_url":"https://api.github.com/repos/libgdx/libgdx/issues/5059/comments","events_url":"https://api.github.com/repos/libgdx/libgdx/issues/5059/events","html_url":"https://github.com/libgdx/libgdx/issues/5059","id":289375202,"node_id":"MDU6SXNzdWUyODkzNzUyMDI=","number":5059,"title":"[Android] Sound issue","user":{"login":"Peter-Warlock","id":11406464,"node_id":"MDQ6VXNlcjExNDA2NDY0","avatar_url":"https://avatars.githubusercontent.com/u/11406464?v=4","gravatar_id":"","url":"https://api.github.com/users/Peter-Warlock","html_url":"https://github.com/Peter-Warlock","followers_url":"https://api.github.com/users/Peter-Warlock/followers","following_url":"https://api.github.com/users/Peter-Warlock/following{/other_user}","gists_url":"https://api.github.com/users/Peter-Warlock/gists{/gist_id}","starred_url":"https://api.github.com/users/Peter-Warlock/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Peter-Warlock/subscriptions","organizations_url":"https://api.github.com/users/Peter-Warlock/orgs","repos_url":"https://api.github.com/users/Peter-Warlock/repos","events_url":"https://api.github.com/users/Peter-Warlock/events{/privacy}","received_events_url":"https://api.github.com/users/Peter-Warlock/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2018-01-17T18:56:17Z","updated_at":"2018-02-17T16:06:12Z","closed_at":"2018-02-17T16:06:12Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"#### Issue details\r\nOn my Android 7.0 smartphone some sounds are gone at play mission time. Usually it happened on looped \"engine\" sound. But also gone other random sounds like shot, explosion, collision and so on. On Android 4.4 all works fine. I solved this problem by writing my own AndroidSound class that use new way to initialize SoundPool. And also increase priority for looping sounds. \r\nI think it should be applied for all, so I suggest you to fix this:\r\n\r\n**gdx.backends.android.AndroidAudio.java constructor must be updated by this way:**\r\n```\r\npublic AndroidAudio (Context context, AndroidApplicationConfiguration config) {\r\n      if (!config.disableAudio) {\r\n         if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.LOLLIPOP) {\r\n            AudioAttributes audioAttrib = new AudioAttributes.Builder()\r\n                  .setUsage(AudioAttributes.USAGE_GAME)\r\n                  .setContentType(AudioAttributes.CONTENT_TYPE_SONIFICATION)\r\n                  .build();\r\n            soundPool = new SoundPool.Builder().setAudioAttributes(audioAttrib).setMaxStreams(config.maxSimultaneousSounds).build();\r\n         }else {\r\n            soundPool = new SoundPool(config.maxSimultaneousSounds, AudioManager.STREAM_MUSIC, 0);// srcQuality: the sample-rate converter quality. Currently has no effect. Use 0 for the default.\r\n         }\r\n         manager = (AudioManager)context.getSystemService(Context.AUDIO_SERVICE);\r\n         if (context instanceof Activity) {\r\n            ((Activity)context).setVolumeControlStream(AudioManager.STREAM_MUSIC);\r\n         }\r\n      } else {\r\n         soundPool = null;\r\n         manager = null;\r\n      }\r\n   }\r\n```\r\nAlso, I recommend increase sound priority in loop(...) methods. Right now it's equal 1 and it's the same as used in play(...) methods. But looped sound usually must play until game logic didn't stop it. So, it can not be removed by SoundPool inner sound manager. Therefor priority in loop(...) method must be greater then used in play(...) \r\n**gdx.backends.android.AndroidSound.java \r\n-public long loop (float volume) and\r\n-public long loop (float volume, float pitch, float pan) \r\nrecommend to update priority from 1 to something greater, for example 3:**\r\n`int streamId = soundPool.play(soundId, leftVolume, rightVolume, 3, -1, pitch); // set priority greater(3) then used in play method(1)`\r\n\r\n#### Version of LibGDX and/or relevant dependencies\r\n1.9.8\r\n\r\n#### Please select the affected platforms\r\n- [x] Android\r\n","closed_by":{"login":"Tom-Ski","id":4346114,"node_id":"MDQ6VXNlcjQzNDYxMTQ=","avatar_url":"https://avatars.githubusercontent.com/u/4346114?v=4","gravatar_id":"","url":"https://api.github.com/users/Tom-Ski","html_url":"https://github.com/Tom-Ski","followers_url":"https://api.github.com/users/Tom-Ski/followers","following_url":"https://api.github.com/users/Tom-Ski/following{/other_user}","gists_url":"https://api.github.com/users/Tom-Ski/gists{/gist_id}","starred_url":"https://api.github.com/users/Tom-Ski/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Tom-Ski/subscriptions","organizations_url":"https://api.github.com/users/Tom-Ski/orgs","repos_url":"https://api.github.com/users/Tom-Ski/repos","events_url":"https://api.github.com/users/Tom-Ski/events{/privacy}","received_events_url":"https://api.github.com/users/Tom-Ski/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/libgdx/libgdx/issues/5059/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/libgdx/libgdx/issues/5059/timeline","performed_via_github_app":null,"state_reason":"completed"}