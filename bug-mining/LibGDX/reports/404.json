{"url":"https://api.github.com/repos/libgdx/libgdx/issues/3842","repository_url":"https://api.github.com/repos/libgdx/libgdx","labels_url":"https://api.github.com/repos/libgdx/libgdx/issues/3842/labels{/name}","comments_url":"https://api.github.com/repos/libgdx/libgdx/issues/3842/comments","events_url":"https://api.github.com/repos/libgdx/libgdx/issues/3842/events","html_url":"https://github.com/libgdx/libgdx/issues/3842","id":133476069,"node_id":"MDU6SXNzdWUxMzM0NzYwNjk=","number":3842,"title":"GWT BufferUtils.copy() fails","user":{"login":"intrigus","id":10353467,"node_id":"MDQ6VXNlcjEwMzUzNDY3","avatar_url":"https://avatars.githubusercontent.com/u/10353467?v=4","gravatar_id":"","url":"https://api.github.com/users/intrigus","html_url":"https://github.com/intrigus","followers_url":"https://api.github.com/users/intrigus/followers","following_url":"https://api.github.com/users/intrigus/following{/other_user}","gists_url":"https://api.github.com/users/intrigus/gists{/gist_id}","starred_url":"https://api.github.com/users/intrigus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/intrigus/subscriptions","organizations_url":"https://api.github.com/users/intrigus/orgs","repos_url":"https://api.github.com/users/intrigus/repos","events_url":"https://api.github.com/users/intrigus/events{/privacy}","received_events_url":"https://api.github.com/users/intrigus/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":67383148,"node_id":"MDU6TGFiZWw2NzM4MzE0OA==","url":"https://api.github.com/repos/libgdx/libgdx/labels/gwt","name":"gwt","color":"0052cc","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2016-02-13T21:38:20Z","updated_at":"2017-01-12T21:34:55Z","closed_at":"2017-01-12T21:34:55Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"`BufferUtils.copy (byte[] src, int srcOffset, Buffer dst, int numElements)`works fine on Desktop, but fails on GWT.\r\n\r\nHow to reproduce:\r\n1. Run this test on Desktop and on GWT\r\n\r\n``` java\r\n\r\npackage com.badlogic.gdx.tests.gwt;\r\n\r\nimport java.lang.reflect.InvocationTargetException;\r\nimport java.lang.reflect.Method;\r\nimport java.nio.Buffer;\r\nimport java.nio.ByteBuffer;\r\n\r\nimport com.badlogic.gdx.Application.ApplicationType;\r\nimport com.badlogic.gdx.Gdx;\r\nimport com.badlogic.gdx.tests.utils.GdxTest;\r\nimport com.badlogic.gdx.utils.BufferUtils;\r\nimport com.badlogic.gdx.utils.GdxRuntimeException;\r\nimport com.badlogic.gdx.utils.reflect.ClassReflection;\r\n\r\npublic class BufferUtilsIssueTest extends GdxTest {\r\n\r\n// Needed to make the test work on gwt _and_ desktop\r\n\tprivate ByteBuffer getTestBuffer (int size) {\r\n\t\tif (Gdx.app.getType().equals(ApplicationType.WebGL)) {\r\n\t\t\treturn BufferUtils.newByteBuffer(size);\r\n\t\t} else {\r\n\t\t\tcom.badlogic.gdx.utils.reflect.Method bufferMethod = null;\r\n\t\t\ttry {\r\n\t\t\t\tbufferMethod = ClassReflection.getMethod(BufferUtils.class, \"newUnsafeByteBuffer\", int.class);\r\n\t\t\t\treturn (ByteBuffer)bufferMethod.invoke(null, size);\r\n\t\t\t} catch (Exception e) { // Who cares!\r\n\t\t\t\te.printStackTrace();\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn null;\r\n\t}\r\n\r\n\t@Override\r\n\tpublic void create () {\r\n\t\tfinal ByteBuffer newByteBuffer = getTestBuffer(10);\r\n\t\tfinal byte[] src = new byte[] {1, 2, 3, 4, 5, 6, 7, 8, 9, 10};\r\n\t\tBufferUtils.copy(src, 0, newByteBuffer, 2);\r\n\t\tBufferUtils.copy(src, 2, newByteBuffer, 4);\r\n\t}\r\n}\r\n```\r\n\r\nI get the following stack trace on GWT:\r\n\r\n``` javascript\r\nThrowable.java:121 Uncaught Error: java.nio.BufferOverflowException\r\n    at P3k_g$.BQd_g$ [as createError_0_g$] (Throwable.java:121)\r\n    at P3k_g$.LQd_g$ [as initializeBackingError_0_g$] (Throwable.java:113)\r\n    at P3k_g$.sQd_g$ (Throwable.java:61)\r\n    at P3k_g$.YQd_g$ (Exception.java:25)\r\n    at P3k_g$.eRd_g$ (RuntimeException.java:25)\r\n    at P3k_g$ (BufferOverflowException.java:31)\r\n    at P8k_g$.d9k_g$ [as put_17_g$] (DirectReadWriteByteBuffer.java:132)\r\n    at ZNd_g$ (BufferUtils.java:75)\r\n    at qan_g$.ran_g$ [as create_0_g$] (BufferUtilsIssueTest.java:39)\r\n    at BHd_g$.CHd_g$ [as clicked_0_g$] (GwtTestWrapper.java:155)\r\n    at BHd_g$.UMc_g$ [as touchUp_3_g$] (ClickListener.java:89)\r\n    at BHd_g$.pBc_g$ [as handle_3_g$] (InputListener.java:58)\r\n    at ABc_g$.CCc_g$ [as touchUp_1_g$] (Stage.java:353)\r\n    at cc_g$.tc_g$ [as touchUp_1_g$] (InputMultiplexer.java:96)\r\n    at Fu_g$.ov_g$ [as handleEvent_0_g$] (GwtInput.java:564)\r\n    at HTMLDocument.<anonymous> (GwtInput.java:405)\r\n```","closed_by":{"login":"Tom-Ski","id":4346114,"node_id":"MDQ6VXNlcjQzNDYxMTQ=","avatar_url":"https://avatars.githubusercontent.com/u/4346114?v=4","gravatar_id":"","url":"https://api.github.com/users/Tom-Ski","html_url":"https://github.com/Tom-Ski","followers_url":"https://api.github.com/users/Tom-Ski/followers","following_url":"https://api.github.com/users/Tom-Ski/following{/other_user}","gists_url":"https://api.github.com/users/Tom-Ski/gists{/gist_id}","starred_url":"https://api.github.com/users/Tom-Ski/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Tom-Ski/subscriptions","organizations_url":"https://api.github.com/users/Tom-Ski/orgs","repos_url":"https://api.github.com/users/Tom-Ski/repos","events_url":"https://api.github.com/users/Tom-Ski/events{/privacy}","received_events_url":"https://api.github.com/users/Tom-Ski/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/libgdx/libgdx/issues/3842/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/libgdx/libgdx/issues/3842/timeline","performed_via_github_app":null,"state_reason":"completed"}