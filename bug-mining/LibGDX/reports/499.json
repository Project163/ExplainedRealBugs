{"url":"https://api.github.com/repos/libgdx/libgdx/issues/5854","repository_url":"https://api.github.com/repos/libgdx/libgdx","labels_url":"https://api.github.com/repos/libgdx/libgdx/issues/5854/labels{/name}","comments_url":"https://api.github.com/repos/libgdx/libgdx/issues/5854/comments","events_url":"https://api.github.com/repos/libgdx/libgdx/issues/5854/events","html_url":"https://github.com/libgdx/libgdx/issues/5854","id":530452351,"node_id":"MDU6SXNzdWU1MzA0NTIzNTE=","number":5854,"title":"Stage.stageToScreenCoordinates returns incorrect value with y offset in viewport","user":{"login":"jusw85","id":3406652,"node_id":"MDQ6VXNlcjM0MDY2NTI=","avatar_url":"https://avatars.githubusercontent.com/u/3406652?v=4","gravatar_id":"","url":"https://api.github.com/users/jusw85","html_url":"https://github.com/jusw85","followers_url":"https://api.github.com/users/jusw85/followers","following_url":"https://api.github.com/users/jusw85/following{/other_user}","gists_url":"https://api.github.com/users/jusw85/gists{/gist_id}","starred_url":"https://api.github.com/users/jusw85/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jusw85/subscriptions","organizations_url":"https://api.github.com/users/jusw85/orgs","repos_url":"https://api.github.com/users/jusw85/repos","events_url":"https://api.github.com/users/jusw85/events{/privacy}","received_events_url":"https://api.github.com/users/jusw85/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":8,"created_at":"2019-11-29T18:06:41Z","updated_at":"2020-02-29T22:11:41Z","closed_at":"2020-02-29T22:10:50Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"#### Issue details\r\nStage.stageToScreenCoordinates returns incorrect value with y offset in viewport\r\n\r\n#### Reproduction steps/code\r\n\r\nCreate a 100x100 window.\r\nSetup a stage with a viewport in the top quarter of the window i.e. width 100, height 25, y=75\r\nstage.stageToScreenCoordinates returns incorrect values.\r\n\r\n   ```\r\n public void create() {\r\n        Viewport viewport = new Viewport() {\r\n            @Override\r\n            public void update(int screenWidth, int screenHeight, boolean centerCamera) {\r\n                assert screenWidth == 100 && screenHeight == 100;\r\n                setScreenBounds(0, 75, 100, 25);\r\n                setWorldSize(100, 25);\r\n                apply(centerCamera);\r\n            }\r\n        };\r\n        viewport.setCamera(new OrthographicCamera());\r\n        Stage stage = new Stage(viewport);\r\n\r\n        Vector2 tmpvec = new Vector2();\r\n\r\n        tmpvec.set(0, 0);\r\n        stage.getViewport().project(tmpvec);\r\n        System.out.println(tmpvec); // prints (0, 75), correct so far\r\n\r\n        tmpvec.set(0, 0);\r\n        stage.stageToScreenCoordinates(tmpvec);\r\n        System.out.println(tmpvec); // prints (0, -50), should be (0, 25)\r\n    }\r\n```\r\n\r\nDue to the following line in Stage:\r\n\r\nhttps://github.com/libgdx/libgdx/blob/c0c1f515df54092cb47717f43f022db02cf7e328/gdx/src/com/badlogic/gdx/scenes/scene2d/Stage.java#L738\r\n\r\nAfter getting the result of camera.project (in absolute screen coordinates with origin at bottom left), it converts to top left origin using viewport.screenHeight instead of actual window height.\r\n\r\n#### Version of LibGDX and/or relevant dependencies\r\n1.9.10\r\n","closed_by":{"login":"NathanSweet","id":434010,"node_id":"MDQ6VXNlcjQzNDAxMA==","avatar_url":"https://avatars.githubusercontent.com/u/434010?v=4","gravatar_id":"","url":"https://api.github.com/users/NathanSweet","html_url":"https://github.com/NathanSweet","followers_url":"https://api.github.com/users/NathanSweet/followers","following_url":"https://api.github.com/users/NathanSweet/following{/other_user}","gists_url":"https://api.github.com/users/NathanSweet/gists{/gist_id}","starred_url":"https://api.github.com/users/NathanSweet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/NathanSweet/subscriptions","organizations_url":"https://api.github.com/users/NathanSweet/orgs","repos_url":"https://api.github.com/users/NathanSweet/repos","events_url":"https://api.github.com/users/NathanSweet/events{/privacy}","received_events_url":"https://api.github.com/users/NathanSweet/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/libgdx/libgdx/issues/5854/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/libgdx/libgdx/issues/5854/timeline","performed_via_github_app":null,"state_reason":"completed"}