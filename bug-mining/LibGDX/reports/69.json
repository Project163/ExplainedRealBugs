{"url":"https://api.github.com/repos/libgdx/libgdx/issues/1657","repository_url":"https://api.github.com/repos/libgdx/libgdx","labels_url":"https://api.github.com/repos/libgdx/libgdx/issues/1657/labels{/name}","comments_url":"https://api.github.com/repos/libgdx/libgdx/issues/1657/comments","events_url":"https://api.github.com/repos/libgdx/libgdx/issues/1657/events","html_url":"https://github.com/libgdx/libgdx/issues/1657","id":31049043,"node_id":"MDU6SXNzdWUzMTA0OTA0Mw==","number":1657,"title":"Vector2 and Vector3 isCollinear method using wrong vector calculation","user":{"login":"bernaps","id":3292435,"node_id":"MDQ6VXNlcjMyOTI0MzU=","avatar_url":"https://avatars.githubusercontent.com/u/3292435?v=4","gravatar_id":"","url":"https://api.github.com/users/bernaps","html_url":"https://github.com/bernaps","followers_url":"https://api.github.com/users/bernaps/followers","following_url":"https://api.github.com/users/bernaps/following{/other_user}","gists_url":"https://api.github.com/users/bernaps/gists{/gist_id}","starred_url":"https://api.github.com/users/bernaps/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bernaps/subscriptions","organizations_url":"https://api.github.com/users/bernaps/orgs","repos_url":"https://api.github.com/users/bernaps/repos","events_url":"https://api.github.com/users/bernaps/events{/privacy}","received_events_url":"https://api.github.com/users/bernaps/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":11336982,"node_id":"MDU6TGFiZWwxMTMzNjk4Mg==","url":"https://api.github.com/repos/libgdx/libgdx/labels/enhancement","name":"enhancement","color":"84b6eb","default":true,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":8,"created_at":"2014-04-08T07:35:54Z","updated_at":"2014-04-15T19:24:34Z","closed_at":"2014-04-15T19:24:34Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"Vector2 and Vector3 method of calculating Collinearity is using dot product instead of the cross product.\n\nSee code below that can show simple bug and also correct implementation to use to fix the issue.\n\ncurrent isCollinear is verifying if two vectors are perpendicular not collinear.\n\nWhat version of libgdx are you using? If not using the master git\nbranch, please try that before filing a bug.\n\nLatest nightbuilt\n\nPlease provide any additional information below.\n\nTest code here shows that collinear of same vector is false (bug) similar test are calculated\nfirst true/false is current Vector implementation, Second is fixed Code.\n\nVector2 (+1.0,+2.0) (+1.0,+2.0) are Collinear: false true **\\* BUG ***\nVector2 (+1.0,+2.0) (-1.0,-2.0) are Collinear: false true **\\* BUG ***\nVector2 (+1.0,+2.0) (+2.0,+4.0) are Collinear: false true **\\* BUG ***\nVector2 (+1.0,+2.0) (+200.0,+400.0) are Collinear: false true **\\* BUG ***\nVector2 (+1.0,+2.0) (+1.0,+3.0) are Collinear: false false OK\n\nVector3 (+1.0,+2.0,+3.0) (+1.0,+2.0,+3.0) are Collinear: false true **\\* BUG ***\nVector3 (+1.0,+2.0,+3.0) (-1.0,-2.0,-3.0) are Collinear: false true **\\* BUG ***\nVector3 (+1.0,+2.0,+3.0) (+2.0,+4.0,+6.0) are Collinear: false true **\\* BUG ***\nVector3 (+1.0,+2.0,+3.0) (+200.0,+400.0,+600.0) are Collinear: false true **\\* BUG ***\nVector3 (+1.0,+2.0,+3.0) (+1.0,+2.0,+4.0) are Collinear: false false OK\n\n---\n## bugVectorCollinear.java\n\nimport java.text.DecimalFormat;\n\nimport com.badlogic.gdx.math.Vector2;\nimport com.badlogic.gdx.math.Vector3;\n\npublic class bugVectorCollinear {\n        private final static DecimalFormat dfmt = new DecimalFormat(\"+###,###,##0.0;-###,###,##0.0\");\n        private final static float epsilon = 0.00000000001f;\n\n```\n    public static void main(String[] args) {\n            boolean resultBug;\n            boolean result;\n\n            // Test isCollinear Vector2\n            Vector2 v1 = new Vector2(1, 2);\n            Vector2 v2 = new Vector2(1, 2);\n\n            // true\n            resultBug = v1.isCollinear(v2, epsilon);\n            result = isCollinear(v1, v2, epsilon);\n            display(v1, v2, resultBug, result);\n\n            // True\n            v2.set(-1, -2);\n            resultBug = v1.isCollinear(v2, epsilon);\n            result = isCollinear(v1, v2, epsilon);\n            display(v1, v2, resultBug, result);\n\n            // True\n            v2.set(2, 4);\n            resultBug = v1.isCollinear(v2, epsilon);\n            result = isCollinear(v1, v2, epsilon);\n            display(v1, v2, resultBug, result);\n\n            // True\n            v2.set(200, 400);\n            resultBug = v1.isCollinear(v2, epsilon);\n            result = isCollinear(v1, v2, epsilon);\n            display(v1, v2, resultBug, result);\n\n            // False\n            v2.set(1, 3);\n            resultBug = v1.isCollinear(v2, epsilon);\n            result = isCollinear(v1, v2, epsilon);\n            display(v1, v2, resultBug, result);\n\n            // Test Vector3\n            // Test isCollinear Vector3\n            Vector3 v31 = new Vector3(1, 2, 3);\n            Vector3 v32 = new Vector3(1, 2, 3);\n\n            // true\n            resultBug = v31.isCollinear(v32, epsilon);\n            result = isCollinear(v31, v32, epsilon);\n            display(v31, v32, resultBug, result);\n\n            // True\n            v32.set(-1, -2, -3);\n            resultBug = v31.isCollinear(v32, epsilon);\n            result = isCollinear(v31, v32, epsilon);\n            display(v31, v32, resultBug, result);\n\n            // True\n            v32.set(2, 4, 6);\n            resultBug = v31.isCollinear(v32, epsilon);\n            result = isCollinear(v31, v32, epsilon);\n            display(v31, v32, resultBug, result);\n\n            // True\n            v32.set(200, 400, 600);\n            resultBug = v31.isCollinear(v32, epsilon);\n            result = isCollinear(v31, v32, epsilon);\n            display(v31, v32, resultBug, result);\n\n            // False\n            v32.set(1, 2, 4);\n            resultBug = v31.isCollinear(v32, epsilon);\n            result = isCollinear(v31, v32, epsilon);\n            display(v31, v32, resultBug, result);\n    }\n\n    public static String format(Vector2 v) {\n            return \"(\" + dfmt.format(v.x) + \",\" + dfmt.format(v.y) + \")\";\n\n    }\n\n    public static String format(Vector3 v) {\n            return \"(\" + dfmt.format(v.x) + \",\" + dfmt.format(v.y) + \",\" + dfmt.format(v.z) + \")\";\n\n    }\n\n    public static void display(Vector2 v1, Vector2 v2, boolean bug, boolean fixed) {\n            System.out.println(\"Vector2 \" + format(v1) + \" \" + format(v2) + \" are Collinear: \" + bug + \" \" + fixed + (fixed != bug ? \" *** BUG ***\" : \" OK\"));\n\n    }\n\n    public static void display(Vector3 v1, Vector3 v2, boolean bug, boolean fixed) {\n            System.out.println(\"Vector3 \" + format(v1) + \" \" + format(v2) + \" are Collinear: \" + bug + \" \" + fixed + (fixed != bug ? \" *** BUG ***\" : \" OK\"));\n\n    }\n\n    /**\n     * Correct implementation of isCollinear\n     * \n     * \n     * @param v1\n     * @param v2\n     * @param epsilon\n     * @return\n     */\n    public static boolean isCollinear(Vector3 v1, Vector3 v2, float epsilon) {\n            Vector3 v1copy = v1.cpy();\n\n            v1copy = v1copy.crs(v2);\n            return v1copy.len() <= epsilon;\n    }\n\n    public static boolean isCollinear(Vector3 v1, Vector3 v2) {\n            return isCollinear(v1, v2, 0f);\n    }\n\n    /**\n     * Correct implementation of isCollinear Vector2\n     * \n     * Calculate area of three points p1: (0,0,0) p2:vector1 p3: vector2\n     * \n     * Area of a triangle is [ p1.x * (P2.y - p3.y) + p2.x * (p3.y - p1.y) + p3.x * (p1.y - p2.y) ] / 2\n     * Since p0(x,y,z) are always zeroes we can simplify\n     * [0 * (P2.y - p3.y) + p2.x * (p3.y - 0) + p3.x * (0 - p2.y) ] / 2\n     * [0 * (P2.y - p3.y) + p2.x * (p3.y - 0) + p3.x * (0 - p2.y) ] / 2\n     * [p2.x * p3.y + p3.x * -p2.y]/2\n     * \n     * since we expect 0 no need to divide by 2\n     * \n     * [p2.x * p3.y + p3.x * -p2.y] == 0 means collinearity\n     * \n     * \n     * @param v1\n     * @param v2\n     * @param epsilon\n     *            error level (e.g. 0.000000001) to account for rounding errors in java.\n     * @return\n     */\n    public static boolean isCollinear(Vector2 v1, Vector2 v2, float epsilon) {\n\n            return Math.abs(v1.x * v2.y + v2.x * -v1.y) <= epsilon;\n    }\n\n    public static boolean isCollinear(Vector2 v1, Vector2 v2) {\n            return isCollinear(v1, v2, 0f);\n    }\n```\n\n}\n","closed_by":{"login":"badlogic","id":514052,"node_id":"MDQ6VXNlcjUxNDA1Mg==","avatar_url":"https://avatars.githubusercontent.com/u/514052?v=4","gravatar_id":"","url":"https://api.github.com/users/badlogic","html_url":"https://github.com/badlogic","followers_url":"https://api.github.com/users/badlogic/followers","following_url":"https://api.github.com/users/badlogic/following{/other_user}","gists_url":"https://api.github.com/users/badlogic/gists{/gist_id}","starred_url":"https://api.github.com/users/badlogic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/badlogic/subscriptions","organizations_url":"https://api.github.com/users/badlogic/orgs","repos_url":"https://api.github.com/users/badlogic/repos","events_url":"https://api.github.com/users/badlogic/events{/privacy}","received_events_url":"https://api.github.com/users/badlogic/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/libgdx/libgdx/issues/1657/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/libgdx/libgdx/issues/1657/timeline","performed_via_github_app":null,"state_reason":"completed"}