{"url":"https://api.github.com/repos/libgdx/libgdx/issues/2052","repository_url":"https://api.github.com/repos/libgdx/libgdx","labels_url":"https://api.github.com/repos/libgdx/libgdx/issues/2052/labels{/name}","comments_url":"https://api.github.com/repos/libgdx/libgdx/issues/2052/comments","events_url":"https://api.github.com/repos/libgdx/libgdx/issues/2052/events","html_url":"https://github.com/libgdx/libgdx/issues/2052","id":36812171,"node_id":"MDU6SXNzdWUzNjgxMjE3MQ==","number":2052,"title":"offset var in writesamples() of AudioDevice in Lwjgl","user":{"login":"gysi","id":1576445,"node_id":"MDQ6VXNlcjE1NzY0NDU=","avatar_url":"https://avatars.githubusercontent.com/u/1576445?v=4","gravatar_id":"","url":"https://api.github.com/users/gysi","html_url":"https://github.com/gysi","followers_url":"https://api.github.com/users/gysi/followers","following_url":"https://api.github.com/users/gysi/following{/other_user}","gists_url":"https://api.github.com/users/gysi/gists{/gist_id}","starred_url":"https://api.github.com/users/gysi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gysi/subscriptions","organizations_url":"https://api.github.com/users/gysi/orgs","repos_url":"https://api.github.com/users/gysi/repos","events_url":"https://api.github.com/users/gysi/events{/privacy}","received_events_url":"https://api.github.com/users/gysi/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2014-06-30T16:09:28Z","updated_at":"2014-07-05T16:08:51Z","closed_at":"2014-07-05T16:08:51Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"# Description\n\nI want to record the input of the mic and simultaneously play and visualize the amplitude. \nThe visualization period is 2 seconds. \nBut because recording and playing are blocking operations I try to record and play in little 100 sample junks. \nThese junks should be pasted in the 2 seconds array for the visualization. For this purpose I wanted to use the offsets in read & writesamples to walk through the 2 seconds array.\nBut for some reason the writesamples function only seems to work when the offset is set to 0 (see workaround-solution in the code example)\n# Code example:\n\n``` java\nimport com.badlogic.gdx.ApplicationListener;\nimport com.badlogic.gdx.Gdx;\nimport com.badlogic.gdx.audio.AudioDevice;\nimport com.badlogic.gdx.audio.AudioRecorder;\nimport com.badlogic.gdx.backends.lwjgl.LwjglApplication;\nimport com.badlogic.gdx.backends.lwjgl.LwjglApplicationConfiguration;\n\n/**\n * Live visualization of 2 seconds recorded audio (loop)\n * @author gysi\n *\n */\npublic class NBugTest implements ApplicationListener {\n    public static final String TAG = NBugTest.class.getSimpleName();\n    private short[] recArray = new short[44100 * 2]; // 2 secs of recorded Audio for visualization\n    private int pointer = 0;\n    AudioTestRunnable audioTestRunnable;\n    Thread audioTestThread;\n\n    class AudioTestRunnable implements Runnable{\n        AudioDevice audioDevice;\n        AudioRecorder audioRecorder;\n        private boolean stop = false;\n\n        public AudioTestRunnable(){\n            audioDevice = Gdx.app.getAudio().newAudioDevice(44100, true);\n            audioRecorder = Gdx.app.getAudio().newAudioRecorder(44100, true);\n            audioDevice.setVolume(1f);\n        }\n\n        @Override\n        public void run() {\n            while(!stop){\n                int numsamples = 100; // samples to be read per tick\n                short[] helpArray = new short[100]; // helper array for implementation that works\n                while(!stop){\n                    if(pointer + numsamples >= recArray.length){\n                        pointer = 0;\n                    }\n\n                    // --------This implementation doesn't work\n                    Gdx.app.log(TAG, \"recording\");\n                    audioRecorder.read(recArray, pointer, numsamples);\n\n                    Gdx.app.log(TAG, \"playing\");\n                    audioDevice.writeSamples(recArray, pointer, numsamples);\n                    // --------\n\n\n                    // --------This implementation works\n//                  Gdx.app.log(TAG, \"recording\");\n//                  audioRecorder.read(helpArray, 0, helpArray.length);\n//                  \n//                  Gdx.app.log(TAG, \"playing\");\n//                  audioDevice.writeSamples(helpArray, 0, helpArray.length);\n//                  \n//                  for(int i = 0; i < helpArray.length; i++){\n//                      recArray[i+pointer] = helpArray[i];\n//                  }\n                    // --------\n\n\n                    pointer = pointer + numsamples;  \n                    Gdx.app.log(TAG, pointer + \"\");\n                }\n            }\n        }\n\n        public void stop(){\n            stop = true;\n        }\n    }\n\n    @Override\n    public void create() {\n        audioTestRunnable = new AudioTestRunnable();\n        audioTestThread = new Thread(audioTestRunnable);\n        audioTestThread.start();\n    }\n\n    @Override\n    public void resize(int width, int height) {\n    }\n\n    @Override\n    public void render() {\n        // visualising recArray     \n    }\n\n    @Override\n    public void pause() {\n    }\n\n    @Override\n    public void resume() {\n    }\n\n    @Override\n    public void dispose() {\n        audioTestRunnable.stop();\n        try {\n            audioTestThread.join();\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        }\n    }\n\n    public static void main (String[] arg) {\n        LwjglApplicationConfiguration config = new LwjglApplicationConfiguration();\n        new LwjglApplication(new NBugTest(), config);\n    }\n}\n```\n","closed_by":{"login":"badlogic","id":514052,"node_id":"MDQ6VXNlcjUxNDA1Mg==","avatar_url":"https://avatars.githubusercontent.com/u/514052?v=4","gravatar_id":"","url":"https://api.github.com/users/badlogic","html_url":"https://github.com/badlogic","followers_url":"https://api.github.com/users/badlogic/followers","following_url":"https://api.github.com/users/badlogic/following{/other_user}","gists_url":"https://api.github.com/users/badlogic/gists{/gist_id}","starred_url":"https://api.github.com/users/badlogic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/badlogic/subscriptions","organizations_url":"https://api.github.com/users/badlogic/orgs","repos_url":"https://api.github.com/users/badlogic/repos","events_url":"https://api.github.com/users/badlogic/events{/privacy}","received_events_url":"https://api.github.com/users/badlogic/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/libgdx/libgdx/issues/2052/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/libgdx/libgdx/issues/2052/timeline","performed_via_github_app":null,"state_reason":"completed"}