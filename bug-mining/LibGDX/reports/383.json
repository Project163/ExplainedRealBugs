{"url":"https://api.github.com/repos/libgdx/libgdx/issues/4264","repository_url":"https://api.github.com/repos/libgdx/libgdx","labels_url":"https://api.github.com/repos/libgdx/libgdx/issues/4264/labels{/name}","comments_url":"https://api.github.com/repos/libgdx/libgdx/issues/4264/comments","events_url":"https://api.github.com/repos/libgdx/libgdx/issues/4264/events","html_url":"https://github.com/libgdx/libgdx/issues/4264","id":172344574,"node_id":"MDU6SXNzdWUxNzIzNDQ1NzQ=","number":4264,"title":"Errors while using remove() on utility collections' Iterator","user":{"login":"Xemiru","id":1240058,"node_id":"MDQ6VXNlcjEyNDAwNTg=","avatar_url":"https://avatars.githubusercontent.com/u/1240058?v=4","gravatar_id":"","url":"https://api.github.com/users/Xemiru","html_url":"https://github.com/Xemiru","followers_url":"https://api.github.com/users/Xemiru/followers","following_url":"https://api.github.com/users/Xemiru/following{/other_user}","gists_url":"https://api.github.com/users/Xemiru/gists{/gist_id}","starred_url":"https://api.github.com/users/Xemiru/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Xemiru/subscriptions","organizations_url":"https://api.github.com/users/Xemiru/orgs","repos_url":"https://api.github.com/users/Xemiru/repos","events_url":"https://api.github.com/users/Xemiru/events{/privacy}","received_events_url":"https://api.github.com/users/Xemiru/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2016-08-21T22:16:26Z","updated_at":"2016-11-25T00:58:08Z","closed_at":"2016-11-25T00:58:08Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"#### Issue details\n\nThe issue addressed by ff6f7ca68a92c286ba22fdcb6f0fe444aff91f66 still occurs with other iterators. This has been tested only with the `OrderedMap$Value` iterator, though it is likely that it occurs with other iterators. It seems to occur due to `remove()` not updating the `hasNext` flag.\n#### Reproduction steps/code\n\nSimply iterating over values and attempting to remove them can cause this issue. Note, that it seems to be inconsistent, and may take a few runs in order to produce an error.\n\n``` java\nimport com.badlogic.gdx.utils.OrderedMap;\n\nimport java.util.Iterator;\n\npublic class Program {\n\n    public static void main(String[] args) {\n        OrderedMap<Integer, Object> map = new OrderedMap<>();\n        for (int i = 0; i < 16; i++) {\n            map.put(i, new Object());\n        }\n\n        Iterator<Object> iter = map.values();\n        while (iter.hasNext()) {\n            iter.next();\n            System.out.println(\"removed\");\n            iter.remove();\n        }\n    }\n}\n```\n\nThe above code sometimes resolves to something like this output.\n\n```\nremoved\nremoved\nremoved\nremoved\nremoved\nremoved\nremoved\nremoved\nException in thread \"main\" java.lang.IndexOutOfBoundsException: index can't be >= size: 8 >= 8\n    at com.badlogic.gdx.utils.Array.get(Array.java:127)\n    at com.badlogic.gdx.utils.OrderedMap$OrderedMapValues.next(OrderedMap.java:228)\n    at Program.main(Program.java:19)\n```\n#### Version of LibGDX and/or relevant dependencies\n\nSupposedly on v1.9.3. The relevant class had not been updated until 15 days ago, so this might not even matter.\n#### Stacktrace\n\n```\n[14:51:49,569] ERROR LWJGL Application    Undertailor: Uncaught exception. Program will close.\njava.lang.IndexOutOfBoundsException: index can't be >= size: 5 >= 5\n    at com.badlogic.gdx.utils.Array.get(Array.java:127)\n    at com.badlogic.gdx.utils.OrderedMap$OrderedMapValues.next(OrderedMap.java:228)\n    at me.scarlet.undertailor.engine.ui.UIController.process(UIController.java:129)\n    at me.scarlet.undertailor.engine.Environment.process(Environment.java:104)\n    at me.scarlet.undertailor.engine.EnvironmentManager.process(EnvironmentManager.java:111)\n    at me.scarlet.undertailor.Undertailor.render(Undertailor.java:220)\n    at com.badlogic.gdx.backends.lwjgl.LwjglApplication.mainLoop(LwjglApplication.java:223)\n    at com.badlogic.gdx.backends.lwjgl.LwjglApplication$1.run(LwjglApplication.java:124)\n```\n#### Please select the affected platforms\n\nAny platform where classes from the `com.badlogic.gdx.utils` package can be accessed and used, presumably all platforms.\n","closed_by":{"login":"NathanSweet","id":434010,"node_id":"MDQ6VXNlcjQzNDAxMA==","avatar_url":"https://avatars.githubusercontent.com/u/434010?v=4","gravatar_id":"","url":"https://api.github.com/users/NathanSweet","html_url":"https://github.com/NathanSweet","followers_url":"https://api.github.com/users/NathanSweet/followers","following_url":"https://api.github.com/users/NathanSweet/following{/other_user}","gists_url":"https://api.github.com/users/NathanSweet/gists{/gist_id}","starred_url":"https://api.github.com/users/NathanSweet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/NathanSweet/subscriptions","organizations_url":"https://api.github.com/users/NathanSweet/orgs","repos_url":"https://api.github.com/users/NathanSweet/repos","events_url":"https://api.github.com/users/NathanSweet/events{/privacy}","received_events_url":"https://api.github.com/users/NathanSweet/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/libgdx/libgdx/issues/4264/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/libgdx/libgdx/issues/4264/timeline","performed_via_github_app":null,"state_reason":"completed"}