diff --git a/gdx/src/com/badlogic/gdx/graphics/g2d/BitmapFont.java b/gdx/src/com/badlogic/gdx/graphics/g2d/BitmapFont.java
index cebb2ba1a..cc1cb0e1c 100644
--- a/gdx/src/com/badlogic/gdx/graphics/g2d/BitmapFont.java
+++ b/gdx/src/com/badlogic/gdx/graphics/g2d/BitmapFont.java
@@ -743,13 +743,16 @@ public class BitmapFont implements Disposable {
 				if (glyph == null) continue;
 				glyphs.add(glyph);
 
-				if (lastGlyph != null) xAdvances.add((lastGlyph.xadvance + lastGlyph.getKerning(ch)) * scaleX);
+				if (lastGlyph == null)
+					xAdvances.add(-glyph.xoffset * scaleX); // First glyph.
+				else
+					xAdvances.add((lastGlyph.xadvance + lastGlyph.getKerning(ch)) * scaleX);
 				lastGlyph = glyph;
 
 				// "[[" is an escaped left square bracket, skip second character.
 				if (markupEnabled && ch == '[' && start < end && str.charAt(start) == '[') start++;
 			}
-			if (lastGlyph != null) xAdvances.add(lastGlyph.xadvance * scaleX);
+			if (lastGlyph != null) xAdvances.add((lastGlyph.xoffset + lastGlyph.width) * scaleX);
 		}
 
 		/** Returns the first valid glyph index to use to wrap to the next line, starting at the specified start index and moving
diff --git a/gdx/src/com/badlogic/gdx/graphics/g2d/BitmapFontCache.java b/gdx/src/com/badlogic/gdx/graphics/g2d/BitmapFontCache.java
index 9e7846212..6bf596ad2 100644
--- a/gdx/src/com/badlogic/gdx/graphics/g2d/BitmapFontCache.java
+++ b/gdx/src/com/badlogic/gdx/graphics/g2d/BitmapFontCache.java
@@ -375,8 +375,8 @@ public class BitmapFontCache {
 			float gx = x + run.x, gy = y + run.y;
 			for (int ii = 0, nn = glyphs.size; ii < nn; ii++) {
 				Glyph glyph = glyphs.get(ii);
-				addGlyph(glyph, gx, gy, color);
 				gx += xAdvances.get(ii);
+				addGlyph(glyph, gx, gy, color);
 			}
 		}
 
diff --git a/gdx/src/com/badlogic/gdx/graphics/g2d/GlyphLayout.java b/gdx/src/com/badlogic/gdx/graphics/g2d/GlyphLayout.java
index b25f78609..1ce9ebb07 100644
--- a/gdx/src/com/badlogic/gdx/graphics/g2d/GlyphLayout.java
+++ b/gdx/src/com/badlogic/gdx/graphics/g2d/GlyphLayout.java
@@ -76,7 +76,8 @@ public class GlyphLayout implements Poolable {
 	 *           specified truncate string are placed at the end. Empty string can be used to truncate without adding glyphs. */
 	public void setText (BitmapFont font, CharSequence str, int start, int end, Color color, float targetWidth, int halign,
 		boolean wrap, String truncate) {
-		if (targetWidth == 0) wrap = false; // Avoid wrapping every character to it's own line/run, which is very inefficient.
+		if (targetWidth <= font.data.spaceWidth) // Avoid wrapping every character to it's own line/run, which is very inefficient.
+			wrap = false;
 		if (truncate != null) wrap = true; // Causes truncate code to run, doesn't actually cause wrapping.
 
 		BitmapFontData fontData = font.data;
@@ -124,50 +125,55 @@ public class GlyphLayout implements Poolable {
 			}
 
 			if (runEnd != -1) {
-				// Store the run that has ended.
-				GlyphRun run = glyphRunPool.obtain();
-				runs.add(run);
-				run.color.set(color);
-				run.x = x;
-				run.y = y;
-				fontData.getGlyphs(run, str, runStart, runEnd);
-
-				// Compute the run width, wrap if necessary, and position the run.
-				FloatArray xAdvances = run.xAdvances;
-				for (int i = 0, n = xAdvances.size; i < n; i++) {
-					float xAdvance = xAdvances.get(i);
-					x += xAdvance;
-					// Don't wrap if the glyph would fit with just its width (no x-advance or kerning).
-					if (wrap && x > targetWidth && i > 0 && x - (xAdvance - run.glyphs.get(i).width) > targetWidth) {
-						if (truncate != null) {
-							truncate(fontData, run, targetWidth, truncate, i, glyphRunPool);
-							break outer;
-						}
-
-						GlyphRun next = glyphRunPool.obtain();
-						runs.add(next);
-						wrap(fontData, run, next, Math.max(1, fontData.getWrapIndex(run.glyphs, i)), i);
+				if (runEnd != runStart) { // Can happen when a color tag is at text start.
+					// Store the run that has ended.
+					GlyphRun run = glyphRunPool.obtain();
+					runs.add(run);
+					run.color.set(color);
+					run.x = x;
+					run.y = y;
+					fontData.getGlyphs(run, str, runStart, runEnd);
+
+					// Compute the run width, wrap if necessary, and position the run.
+					FloatArray xAdvances = run.xAdvances;
+					for (int i = 0, n = xAdvances.size; i < n; i++) {
+						float xAdvance = xAdvances.get(i);
+						x += xAdvance;
+
+						// Don't wrap if the glyph would fit with just its width (no x-advance or kerning).
+						if (wrap && x > targetWidth && i > 1 && x - xAdvance //
+							+ (run.glyphs.get(i - 1).xoffset + run.glyphs.get(i - 1).width) * fontData.scaleX > targetWidth) {
+
+							if (truncate != null) {
+								truncate(fontData, run, targetWidth, truncate, i, glyphRunPool);
+								break outer;
+							}
+
+							GlyphRun next = glyphRunPool.obtain();
+							runs.add(next);
+							wrap(fontData, run, next, Math.max(1, fontData.getWrapIndex(run.glyphs, i - 1)), i);
+
+							// Start the loop over with the new run on the next line.
+							width = Math.max(width, run.width);
+							x = 0;
+							y += fontData.down;
+							lines++;
+							next.x = 0;
+							next.y = y;
+							i = -1;
+							n = next.xAdvances.size;
+							xAdvances = next.xAdvances;
+							run = next;
+						} else
+							run.width += xAdvance;
+					}
 
-						// Start the loop over with the new run on the next line.
-						width = Math.max(width, run.width);
+					if (newline) {
+						width = Math.max(width, x);
 						x = 0;
 						y += fontData.down;
 						lines++;
-						next.x = 0;
-						next.y = y;
-						i = -1;
-						n = next.xAdvances.size;
-						xAdvances = next.xAdvances;
-						run = next;
-					} else
-						run.width += xAdvance;
-				}
-
-				if (newline) {
-					width = Math.max(width, x);
-					x = 0;
-					y += fontData.down;
-					lines++;
+					}
 				}
 
 				runStart = start;
@@ -210,29 +216,82 @@ public class GlyphLayout implements Poolable {
 	private void truncate (BitmapFontData fontData, GlyphRun run, float targetWidth, String truncate, int widthIndex,
 		Pool<GlyphRun> glyphRunPool) {
 
+		// Determine truncate string size.
 		GlyphRun truncateRun = glyphRunPool.obtain();
 		fontData.getGlyphs(truncateRun, truncate, 0, truncate.length());
-
-		// Truncate glyphs to make room.
-		float truncateWidth = targetWidth;
-		int n = truncateRun.glyphs.size;
-		for (int i = 0; i < n; i++)
-			truncateWidth -= truncateRun.xAdvances.get(i);
-		while (run.width > truncateWidth) {
-			widthIndex--;
-			run.width -= run.xAdvances.get(widthIndex);
+		float truncateWidth = 0;
+		for (int i = 1, n = truncateRun.xAdvances.size; i < n; i++)
+			truncateWidth += truncateRun.xAdvances.get(i);
+		targetWidth -= truncateWidth;
+
+		// Determine visible glyphs.
+		run.width = 0;
+		int count = 0;
+		while (true) {
+			float xAdvance = run.xAdvances.get(count);
+			if (run.width + xAdvance > targetWidth) break;
+			run.width += xAdvance;
+			count++;
 		}
-		run.glyphs.truncate(widthIndex);
-		run.xAdvances.truncate(widthIndex);
 
 		// Append truncate glyphs.
+		run.xAdvances.truncate(count);
+		if (count > 1) {
+			run.glyphs.truncate(count - 1);
+			adjustLastGlyph(fontData, run);
+			run.xAdvances.addAll(truncateRun.xAdvances, 1, truncateRun.xAdvances.size - 1);
+		} else {
+			run.glyphs.clear();
+			run.xAdvances.clear();
+			run.xAdvances.addAll(truncateRun.xAdvances);
+			run.width += truncateRun.xAdvances.get(0);
+		}
 		run.glyphs.addAll(truncateRun.glyphs);
-		run.xAdvances.addAll(truncateRun.xAdvances);
 		run.width += truncateWidth;
 
 		glyphRunPool.free(truncateRun);
 	}
 
+	private void wrap (BitmapFontData fontData, GlyphRun first, GlyphRun second, int wrapIndex, int widthIndex) {
+		second.color.set(first.color);
+
+		// Copy wrapped glyphs and xAdvances.
+		second.glyphs.addAll(first.glyphs, wrapIndex, first.glyphs.size - wrapIndex);
+		second.xAdvances.add(-second.glyphs.first().xoffset * fontData.scaleX);
+		second.xAdvances.addAll(first.xAdvances, wrapIndex + 1, first.xAdvances.size - (wrapIndex + 1));
+
+		// Increase first run width up to the wrap index.
+		while (widthIndex < wrapIndex)
+			first.width += first.xAdvances.get(widthIndex++);
+
+		// Reduce first run width by the wrapped glyphs that have contributed to the width.
+		while (widthIndex > wrapIndex + 1)
+			first.width -= first.xAdvances.get(--widthIndex);
+
+		// Eat whitespace at end of first run.
+		for (; wrapIndex > 0; wrapIndex--) {
+			if (fontData.isWhitespace((char)first.glyphs.get(wrapIndex - 1).id)) {
+				first.width -= first.xAdvances.get(wrapIndex);
+				continue;
+			}
+			break;
+		}
+
+		// Truncate wrapped glyphs from first run.
+		first.glyphs.truncate(wrapIndex);
+		first.xAdvances.truncate(wrapIndex + 1);
+		adjustLastGlyph(fontData, first);
+	}
+
+	/** Adjusts the last glyph xadvance to use its width. */
+	private void adjustLastGlyph (BitmapFontData fontData, GlyphRun run) {
+		Glyph last = run.glyphs.peek();
+		if (fontData.isWhitespace((char)last.id)) return; // Can happen when doing truncate.
+		float width = (last.xoffset + last.width) * fontData.scaleX;
+		run.width += width - run.xAdvances.peek();
+		run.xAdvances.set(run.xAdvances.size - 1, width);
+	}
+
 	private int parseColorMarkup (CharSequence str, int start, int end, Pool<Color> colorPool) {
 		if (start == end) return -1; // String ended with "[".
 		switch (str.charAt(start)) {
@@ -280,34 +339,6 @@ public class GlyphLayout implements Poolable {
 		return -1; // Unclosed color tag.
 	}
 
-	private void wrap (BitmapFontData fontData, GlyphRun first, GlyphRun second, int wrapIndex, int widthIndex) {
-		second.color.set(first.color);
-
-		// Reduce first run width by wrapped glyphs.
-		while (widthIndex-- > wrapIndex)
-			first.width -= first.xAdvances.get(widthIndex);
-
-		// Wrap glyphs and xAdvances.
-		second.glyphs.addAll(first.glyphs, wrapIndex, first.glyphs.size - wrapIndex);
-		second.xAdvances.addAll(first.xAdvances, wrapIndex, first.xAdvances.size - wrapIndex);
-		first.glyphs.truncate(wrapIndex);
-		first.xAdvances.truncate(wrapIndex);
-
-		// Eat whitespace at end of first run.
-		for (int i = wrapIndex - 1; i >= 0; i--) {
-			char ch = (char)first.glyphs.get(i).id;
-			if (fontData.isWhitespace(ch)) {
-				first.width -= first.xAdvances.get(i);
-				continue;
-			}
-			if (i > 0) {
-				first.glyphs.truncate(i + 1);
-				first.xAdvances.truncate(i + 1);
-			}
-			break;
-		}
-	}
-
 	public void reset () {
 		Pools.get(GlyphRun.class).freeAll(runs);
 		runs.clear();
@@ -331,7 +362,9 @@ public class GlyphLayout implements Poolable {
 	 * @author Nathan Sweet */
 	static public class GlyphRun implements Poolable {
 		public final Array<Glyph> glyphs = new Array();
-		public final FloatArray xAdvances = new FloatArray(); // X advance relative to previous glyph.
+		/** Contains glyphs.size+1 entries: First entry is X offset relative to the drawing position. Subsequent entries are the X
+		 * advance relative to previous glyph position. Last entry is the width of the last glyph. */
+		public final FloatArray xAdvances = new FloatArray();
 		public float x, y, width;
 		public final Color color = new Color();
 
diff --git a/gdx/src/com/badlogic/gdx/scenes/scene2d/ui/TextField.java b/gdx/src/com/badlogic/gdx/scenes/scene2d/ui/TextField.java
index ad9cea266..7f5dba701 100644
--- a/gdx/src/com/badlogic/gdx/scenes/scene2d/ui/TextField.java
+++ b/gdx/src/com/badlogic/gdx/scenes/scene2d/ui/TextField.java
@@ -23,6 +23,7 @@ import com.badlogic.gdx.graphics.Color;
 import com.badlogic.gdx.graphics.g2d.Batch;
 import com.badlogic.gdx.graphics.g2d.BitmapFont;
 import com.badlogic.gdx.graphics.g2d.BitmapFont.BitmapFontData;
+import com.badlogic.gdx.graphics.g2d.BitmapFont.Glyph;
 import com.badlogic.gdx.graphics.g2d.GlyphLayout;
 import com.badlogic.gdx.graphics.g2d.GlyphLayout.GlyphRun;
 import com.badlogic.gdx.math.MathUtils;
@@ -98,6 +99,7 @@ public class TextField extends Widget implements Disableable {
 	private StringBuilder passwordBuffer;
 	private char passwordCharacter = BULLET;
 
+	private float fontOffset;
 	protected float textHeight, textOffset;
 	float renderOffset;
 	private int visibleTextStart, visibleTextEnd;
@@ -330,7 +332,7 @@ public class TextField extends Widget implements Disableable {
 
 	/** Draws selection rectangle **/
 	protected void drawSelection (Drawable selection, Batch batch, BitmapFont font, float x, float y) {
-		selection.draw(batch, x + selectionX + renderOffset, y - textHeight - font.getDescent(), selectionWidth,
+		selection.draw(batch, x + selectionX + renderOffset + fontOffset - 1, y - textHeight - font.getDescent(), selectionWidth,
 			textHeight + font.getDescent() / 2);
 	}
 
@@ -339,8 +341,8 @@ public class TextField extends Widget implements Disableable {
 	}
 
 	protected void drawCursor (Drawable cursorPatch, Batch batch, BitmapFont font, float x, float y) {
-		cursorPatch.draw(batch, x + textOffset + glyphPositions.get(cursor) - glyphPositions.items[visibleTextStart] - 1, y
-			- textHeight - font.getDescent(), cursorPatch.getMinWidth(), textHeight + font.getDescent() / 2);
+		cursorPatch.draw(batch, x + textOffset + glyphPositions.get(cursor) - glyphPositions.items[visibleTextStart] + fontOffset
+			- 1, y - textHeight - font.getDescent(), cursorPatch.getMinWidth(), textHeight + font.getDescent() / 2);
 	}
 
 	void updateDisplayText () {
@@ -373,8 +375,10 @@ public class TextField extends Widget implements Disableable {
 		float x = 0;
 		if (layout.runs.size > 0) {
 			GlyphRun run = layout.runs.first();
+			Array<Glyph> glyphs = run.glyphs;
 			FloatArray xAdvances = run.xAdvances;
-			for (int i = 0, n = xAdvances.size; i < n; i++) {
+			fontOffset = xAdvances.first();
+			for (int i = 1, n = xAdvances.size; i < n; i++) {
 				glyphPositions.add(x);
 				x += xAdvances.get(i);
 			}
diff --git a/tests/gdx-tests-lwjgl/src/com/badlogic/gdx/tests/lwjgl/LwjglDebugStarter.java b/tests/gdx-tests-lwjgl/src/com/badlogic/gdx/tests/lwjgl/LwjglDebugStarter.java
index f1ee87873..77cf23006 100644
--- a/tests/gdx-tests-lwjgl/src/com/badlogic/gdx/tests/lwjgl/LwjglDebugStarter.java
+++ b/tests/gdx-tests-lwjgl/src/com/badlogic/gdx/tests/lwjgl/LwjglDebugStarter.java
@@ -34,7 +34,7 @@ public class LwjglDebugStarter {
 //		new SharedLibraryLoader("../../extensions/gdx-controllers/gdx-controllers-desktop/libs/gdx-controllers-desktop-natives.jar").load("gdx-controllers-desktop");
 //		new SharedLibraryLoader("../../gdx/libs/gdx-natives.jar").load("gdx");
 
-		GdxTest test = new FreeTypeIncrementalTest();		
+		GdxTest test = new BitmapFontTest();		
 		LwjglApplicationConfiguration config = new LwjglApplicationConfiguration();
 		config.r = config.g = config.b = config.a = 8;
 //		config.width = 320;
diff --git a/tests/gdx-tests/src/com/badlogic/gdx/tests/BitmapFontTest.java b/tests/gdx-tests/src/com/badlogic/gdx/tests/BitmapFontTest.java
index d6acc7fe4..29a20833e 100644
--- a/tests/gdx-tests/src/com/badlogic/gdx/tests/BitmapFontTest.java
+++ b/tests/gdx-tests/src/com/badlogic/gdx/tests/BitmapFontTest.java
@@ -23,6 +23,7 @@ import com.badlogic.gdx.graphics.GL20;
 import com.badlogic.gdx.graphics.g2d.BitmapFont;
 import com.badlogic.gdx.graphics.g2d.BitmapFontCache;
 import com.badlogic.gdx.graphics.g2d.GlyphLayout;
+import com.badlogic.gdx.graphics.g2d.GlyphLayout.GlyphRun;
 import com.badlogic.gdx.graphics.g2d.SpriteBatch;
 import com.badlogic.gdx.graphics.glutils.ShapeRenderer;
 import com.badlogic.gdx.graphics.glutils.ShapeRenderer.ShapeType;
@@ -40,6 +41,7 @@ public class BitmapFontTest extends GdxTest {
 	private BitmapFont font;
 	private ShapeRenderer renderer;
 	private BitmapFont multiPageFont;
+	private GlyphLayout layout;
 
 	@Override
 	public void create () {
@@ -72,6 +74,8 @@ public class BitmapFontTest extends GdxTest {
 		window.setPosition(400, 200);
 		window.pack();
 		stage.addActor(window);
+
+		layout = new GlyphLayout();
 	}
 
 	@Override
@@ -80,11 +84,39 @@ public class BitmapFontTest extends GdxTest {
 
 		int viewHeight = Gdx.graphics.getHeight();
 
-		Gdx.gl.glClearColor(1, 1, 1, 1);
+		Gdx.gl.glClearColor(0, 0, 0, 1);
 		Gdx.gl.glClear(GL20.GL_COLOR_BUFFER_BIT);
+
+		// Render lines and wrapped text.
+		font.getData().setScale(3f);
+		renderer.begin(ShapeRenderer.ShapeType.Line);
+		renderer.setColor(0, 1, 0, 1);
+		float w = Gdx.input.getX();
+		// w = 255;
+		renderer.rect(10, 10, w, 500);
+		renderer.end();
+
+		spriteBatch.begin();
+		String text = "your new";
+		layout.setText(font, text, 0, text.length(), font.getColor(), w, Align.center, true, null);
+		float meowy = (500 / 2 + layout.height / 2 + 5);
+		font.draw(spriteBatch, layout, 10, 10 + meowy);
+		spriteBatch.end();
+
+		renderer.begin(ShapeRenderer.ShapeType.Line);
+		renderer.setColor(0, 1, 0, 1);
+		for (int i = 0, n = layout.runs.size; i < n; i++) {
+			GlyphRun r = layout.runs.get(i);
+			renderer.rect(10 + r.x, 10 + meowy + r.y, r.width, -font.getLineHeight());
+		}
+		renderer.end();
+		font.getData().setScale(1f);
+		if (true) return;
+		//
+
 		spriteBatch.begin();
 
-		String text = "Sphinx of black quartz, judge my vow.";
+		text = "Sphinx of black quartz, judge my vow.";
 		font.setColor(Color.RED);
 
 		float x = 100, y = 20;
