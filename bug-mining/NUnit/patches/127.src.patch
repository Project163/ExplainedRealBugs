diff --git a/src/NUnitFramework/framework/Api/NUnitTestAssemblyRunner.cs b/src/NUnitFramework/framework/Api/NUnitTestAssemblyRunner.cs
index 097f3c157..a9e004103 100644
--- a/src/NUnitFramework/framework/Api/NUnitTestAssemblyRunner.cs
+++ b/src/NUnitFramework/framework/Api/NUnitTestAssemblyRunner.cs
@@ -158,6 +158,7 @@ namespace NUnit.Framework.Api
                 Randomizer.InitialSeed = (int)settings[PackageSettings.RandomSeed];
 
             return LoadedTest = _builder.Build(assemblyName, settings);
+
         }
 
         /// <summary>
diff --git a/src/NUnitFramework/framework/Internal/TestExecutionContext.cs b/src/NUnitFramework/framework/Internal/TestExecutionContext.cs
index af53b3381..55bbd8706 100644
--- a/src/NUnitFramework/framework/Internal/TestExecutionContext.cs
+++ b/src/NUnitFramework/framework/Internal/TestExecutionContext.cs
@@ -165,46 +165,76 @@ namespace NUnit.Framework.Internal
 
         #region Static Singleton Instance
 
-        /// <summary>
-        /// The current context, head of the list of saved contexts.
-        /// </summary>
+        // NOTE: We use different implementations for various platforms
+
+        // If a user creates a thread then the current context
+        // will be null. This also happens when the compiler
+        // automatically creates threads for async methods.
+        // We create a new context, which is automatically
+        // populated with values taken from the current thread.
+
 #if SILVERLIGHT || PORTABLE
+        // In the Silverlight and portable builds, we use a ThreadStatic
+        // field to hold the current TestExecutionContext.
+
         [ThreadStatic]
-        private static TestExecutionContext current;
-#elif NETCF
-        private static LocalDataStoreSlot slotContext = Thread.AllocateDataSlot();
-#else
-        private static readonly string CONTEXT_KEY = "NUnit.Framework.TestContext";
-#endif
+        private static TestExecutionContext _currentContext;
 
         /// <summary>
-        /// Gets the current context.
+        /// Gets and sets the current context.
         /// </summary>
-        /// <value>The current context.</value>
         public static TestExecutionContext CurrentContext
         {
             get
             {
-                // If a user creates a thread then the current context
-                // will be null. This also happens when the compiler
-                // automatically creates threads for async methods.
-                // We create a new context, which is automatically
-                // populated with _values taken from the current thread.
-#if SILVERLIGHT || PORTABLE
-                if (current == null)
-                    current = new TestExecutionContext();
+               if (_currentContext == null)
+                    _currentContext = new TestExecutionContext();
 
-                return current;
+                return _currentContext;
+            }
+            private set
+            {
+                _currentContext = value;
+            }
+        }
 #elif NETCF
-                var current = (TestExecutionContext)Thread.GetData(slotContext);
+        // In the compact framework build, we use a LocalStoreDataSlot
+
+        private static LocalDataStoreSlot contextSlot = Thread.AllocateDataSlot();
+        
+        /// <summary>
+        /// Gets and sets the current context.
+        /// </summary>
+        public static TestExecutionContext CurrentContext
+        {
+            get
+            {
+                var current = (TestExecutionContext)Thread.GetData(contextSlot);
                 if (current == null)
                 {
                     current = new TestExecutionContext();
-                    Thread.SetData(slotContext, current);
+                    Thread.SetData(contextSlot, current);
                 }
 
                 return current;
+            }
+            private set
+            {
+                Thread.SetData(contextSlot, value);
+            }
+        }
 #else
+        // In all other builds, we use the CallContext
+
+        private static readonly string CONTEXT_KEY = "NUnit.Framework.TestContext";
+
+        /// <summary>
+        /// Gets and sets the current context.
+        /// </summary>
+        public static TestExecutionContext CurrentContext
+        {
+            get
+            {
                 var context = GetTestExecutionContext();
                 if (context == null) // This can happen on Mono
                 {
@@ -213,25 +243,16 @@ namespace NUnit.Framework.Internal
                 }
 
                 return context;
-#endif
             }
-
             private set
             {
-#if SILVERLIGHT || PORTABLE
-                current = value;
-#elif NETCF
-                Thread.SetData(slotContext, value);
-#else
                 if (value == null)
                     CallContext.FreeNamedDataSlot(CONTEXT_KEY);
                 else
                     CallContext.SetData(CONTEXT_KEY, value);
-#endif
             }
         }
 
-#if !SILVERLIGHT && !NETCF && !PORTABLE
         /// <summary>
         /// Get the current context or return null if none is found.
         /// </summary>
diff --git a/src/NUnitFramework/framework/TestContext.cs b/src/NUnitFramework/framework/TestContext.cs
index d54902d7f..d08a62797 100644
--- a/src/NUnitFramework/framework/TestContext.cs
+++ b/src/NUnitFramework/framework/TestContext.cs
@@ -23,6 +23,7 @@
 
 using System;
 using System.IO;
+using System.Reflection;
 using NUnit.Framework.Constraints;
 using NUnit.Framework.Interfaces;
 using NUnit.Framework.Internal;
@@ -104,7 +105,16 @@ namespace NUnit.Framework
         /// </summary>
         public string TestDirectory
         {
-            get { return AssemblyHelper.GetDirectoryName(_testExecutionContext.CurrentTest.TypeInfo.Assembly); }
+            get
+            {
+                Test test = _testExecutionContext.CurrentTest;
+                if (test != null)
+                    return AssemblyHelper.GetDirectoryName(test.TypeInfo.Assembly);
+
+                // Test is null, we may be loading tests rather than executing.
+                // Assume that calling assembly is the test assembly.
+                return AssemblyHelper.GetDirectoryName(Assembly.GetCallingAssembly());
+            }
         }
 #endif
 
diff --git a/src/NUnitFramework/tests/TestContextTests.cs b/src/NUnitFramework/tests/TestContextTests.cs
index 719277d1b..b62f5cd5b 100644
--- a/src/NUnitFramework/tests/TestContextTests.cs
+++ b/src/NUnitFramework/tests/TestContextTests.cs
@@ -22,6 +22,7 @@
 // ***********************************************************************
 
 using System.IO;
+using System.Collections.Generic;
 using NUnit.Framework.Interfaces;
 using NUnit.TestData.TestContextData;
 using NUnit.TestUtilities;
@@ -55,6 +56,17 @@ namespace NUnit.Framework.Tests
         {
             Assert.That(_testDirectory, Is.Not.Null);
         }
+
+        [TestCaseSource("MySource")]
+        public void TestCaseSourceCanAccessTestDirectory(string testDirectory)
+        {
+            Assert.That(testDirectory, Is.EqualTo(_testDirectory));
+        }
+
+        static IEnumerable<string> MySource()
+        {
+            yield return TestContext.CurrentContext.TestDirectory;
+        }
 #endif
 
         [Test]
