diff --git a/src/NUnitFramework/framework/Interfaces/TestOutput.cs b/src/NUnitFramework/framework/Interfaces/TestOutput.cs
index 4ff8daa67..355234b90 100644
--- a/src/NUnitFramework/framework/Interfaces/TestOutput.cs
+++ b/src/NUnitFramework/framework/Interfaces/TestOutput.cs
@@ -37,11 +37,13 @@ namespace NUnit.Framework.Interfaces
         /// </summary>
         /// <param name="text">Text to be output</param>
         /// <param name="stream">Name of the stream or channel to which the text should be written</param>
+        /// <param name="testId">Id of the test that produced the output</param>
         /// <param name="testName">FullName of test that produced the output</param>
-		public TestOutput(string text, string stream, string testName)
+        public TestOutput(string text, string stream, string testId, string testName)
         {
             Text = text;
             Stream = stream;
+            TestId = testId;
             TestName = testName;
         }
 
@@ -69,6 +71,11 @@ namespace NUnit.Framework.Interfaces
         /// </summary>
         public string TestName { get; private set; }
 
+        /// <summary>
+        /// Get the id of the test that created the output
+        /// </summary>
+        public string TestId { get; private set; }
+
         /// <summary>
         /// Convert the TestOutput object to an XML string
         /// </summary>
@@ -77,6 +84,9 @@ namespace NUnit.Framework.Interfaces
             TNode tnode = new TNode("test-output", Text, true);
 
             tnode.AddAttribute("stream", Stream);
+            if (TestId != null)
+                tnode.AddAttribute("testid", TestId);
+
             if (TestName != null)
                 tnode.AddAttribute("testname", TestName);
 
diff --git a/src/NUnitFramework/framework/Internal/Execution/EventListenerTextWriter.cs b/src/NUnitFramework/framework/Internal/Execution/EventListenerTextWriter.cs
index cbf57b167..b4186cf92 100644
--- a/src/NUnitFramework/framework/Internal/Execution/EventListenerTextWriter.cs
+++ b/src/NUnitFramework/framework/Internal/Execution/EventListenerTextWriter.cs
@@ -68,10 +68,14 @@ namespace NUnit.Framework.Internal.Execution
             if (context == null || context.Listener == null)
                 return false;
 
-            string testName = context.CurrentTest != null
-                ? context.CurrentTest.FullName
-                : null;
-            context.Listener.TestOutput(new TestOutput(text, _streamName, testName));
+            string testName = null;
+            string testId = null;
+            if (context.CurrentTest != null)
+            {
+                testName = context.CurrentTest.FullName;
+                testId = context.CurrentTest.Id;
+            }
+            context.Listener.TestOutput(new TestOutput(text, _streamName, testId, testName));
             return true;
         }
 
diff --git a/src/NUnitFramework/nunitlite.tests/TextUITests.cs b/src/NUnitFramework/nunitlite.tests/TextUITests.cs
index 1b5d84a80..8edf74551 100644
--- a/src/NUnitFramework/nunitlite.tests/TextUITests.cs
+++ b/src/NUnitFramework/nunitlite.tests/TextUITests.cs
@@ -251,46 +251,46 @@ namespace NUnitLite.Tests
 #pragma warning disable 414
         static TestCaseData[] ImmediateOutputData = new[] {
             new TestCaseData("Off",
-                new [] { new TestOutput("OUTPUT\n", "", "SomeMethod") },
+                new [] { new TestOutput("OUTPUT\n", "", null, "SomeMethod") },
                 "OUTPUT\n"),
             new TestCaseData("On",
-                new [] { new TestOutput("OUTPUT\n", "", "SomeMethod") },
+                new [] { new TestOutput("OUTPUT\n", "", null, "SomeMethod") },
                 "=> SomeMethod\nOUTPUT\n"),
             new TestCaseData("All",
-                new [] { new TestOutput("OUTPUT\n", "", "SomeMethod") },
+                new [] { new TestOutput("OUTPUT\n", "", null, "SomeMethod") },
                 "=> SomeMethod\nOUTPUT\n"),
             new TestCaseData("Before",
-                new [] { new TestOutput("OUTPUT\n", "", "SomeMethod") },
+                new [] { new TestOutput("OUTPUT\n", "", null, "SomeMethod") },
                 "=> SomeMethod\nOUTPUT\n"),
             new TestCaseData("After",
-                new [] { new TestOutput("OUTPUT\n", "", "SomeMethod") },
+                new [] { new TestOutput("OUTPUT\n", "", null, "SomeMethod") },
                 "=> SomeMethod\nOUTPUT\n"),
             new TestCaseData("Off",
-                new [] { new TestOutput("OUTPUT", "", "SomeMethod") },
+                new [] { new TestOutput("OUTPUT", "", null, "SomeMethod") },
                 "OUTPUT"),
             new TestCaseData("On",
-                new [] { new TestOutput("OUTPUT", "", "SomeMethod") },
+                new [] { new TestOutput("OUTPUT", "", null, "SomeMethod") },
                 "=> SomeMethod\nOUTPUT"),
             new TestCaseData("All",
-                new [] { new TestOutput("OUTPUT", "", "SomeMethod") },
+                new [] { new TestOutput("OUTPUT", "", null, "SomeMethod") },
                 "=> SomeMethod\nOUTPUT"),
             new TestCaseData("Before",
-                new [] { new TestOutput("OUTPUT", "", "SomeMethod") },
+                new [] { new TestOutput("OUTPUT", "", null, "SomeMethod") },
                 "=> SomeMethod\nOUTPUT"),
             new TestCaseData("After",
-                new [] { new TestOutput("OUTPUT", "", "SomeMethod") },
+                new [] { new TestOutput("OUTPUT", "", null, "SomeMethod") },
                 "=> SomeMethod\nOUTPUT"),
             new TestCaseData("On",
-                new [] { new TestOutput("A", "", "T1"), new TestOutput("B", "", "T1"), new TestOutput("C", "", "T1") },
+                new [] { new TestOutput("A", "", null, "T1"), new TestOutput("B", "", null, "T1"), new TestOutput("C", "", null, "T1") },
                 "=> T1\nABC"),
             new TestCaseData("On",
-                new [] { new TestOutput("A", "", "T1"), new TestOutput("B", "", "T1"), new TestOutput("C", "", "T1"), new TestOutput("\n", "", "T1") },
+                new [] { new TestOutput("A", "", null, "T1"), new TestOutput("B", "", null, "T1"), new TestOutput("C", "", null, "T1"), new TestOutput("\n", "", null, "T1") },
                 "=> T1\nABC\n"),
             new TestCaseData("On",
-                new [] { new TestOutput("Hello\n", "", "EN"), new TestOutput("Ciao!\n", "", "IT"), new TestOutput("World!\n", "", "EN") },
+                new [] { new TestOutput("Hello\n", "", null, "EN"), new TestOutput("Ciao!\n", "", null, "IT"), new TestOutput("World!\n", "", null, "EN") },
                 "=> EN\nHello\n=> IT\nCiao!\n=> EN\nWorld!\n"),
             new TestCaseData("On",
-                new [] { new TestOutput("Hello", "", "EN"), new TestOutput("Ciao!", "", "IT"), new TestOutput("World!", "", "EN") },
+                new [] { new TestOutput("Hello", "", null, "EN"), new TestOutput("Ciao!", "", null, "IT"), new TestOutput("World!", "", null, "EN") },
                 "=> EN\nHello\n=> IT\nCiao!\n=> EN\nWorld!"),
         };
 #pragma warning restore 414
@@ -337,7 +337,7 @@ namespace NUnitLite.Tests
             var textUI = CreateTextUI(labels);
 
             textUI.TestStarted(test);
-            textUI.TestOutput(new TestOutput("IMMEDIATE OUTPUT\n", "", test.FullName));
+            textUI.TestOutput(new TestOutput("IMMEDIATE OUTPUT\n", "", null, test.FullName));
             result.OutWriter.WriteLine("NORMAL OUTPUT");
             textUI.TestFinished(result);
 
@@ -454,10 +454,10 @@ namespace NUnitLite.Tests
             var textUI = CreateTextUI(labels);
 
             textUI.TestStarted(test1);
-            textUI.TestOutput(new TestOutput("Immediate output from first test\n", "", test1.FullName));
+            textUI.TestOutput(new TestOutput("Immediate output from first test\n", "", null, test1.FullName));
             textUI.TestStarted(test2);
-            textUI.TestOutput(new TestOutput("Another immediate output from first test\n", "", test1.FullName));
-            textUI.TestOutput(new TestOutput("Immediate output from second test\n", "", test2.FullName));
+            textUI.TestOutput(new TestOutput("Another immediate output from first test\n", "", null, test1.FullName));
+            textUI.TestOutput(new TestOutput("Immediate output from second test\n", "", null, test2.FullName));
             result1.OutWriter.WriteLine("OUTPUT1");
             textUI.TestFinished(result1);
             result2.OutWriter.WriteLine("OUTPUT2");
@@ -527,10 +527,10 @@ namespace NUnitLite.Tests
             var textUI = CreateTextUI(labels);
 
             textUI.TestStarted(test1);
-            textUI.TestOutput(new TestOutput("Immediate output from first test\n", "", test1.FullName));
+            textUI.TestOutput(new TestOutput("Immediate output from first test\n", "", null, test1.FullName));
             textUI.TestStarted(test2);
-            textUI.TestOutput(new TestOutput("Another immediate output from first test\n", "", test1.FullName));
-            textUI.TestOutput(new TestOutput("Immediate output from second test\n", "", test2.FullName));
+            textUI.TestOutput(new TestOutput("Another immediate output from first test\n", "", null, test1.FullName));
+            textUI.TestOutput(new TestOutput("Immediate output from second test\n", "", null, test2.FullName));
             result2.OutWriter.WriteLine("OUTPUT2");
             textUI.TestFinished(result2);
             result1.OutWriter.WriteLine("OUTPUT1");
@@ -539,6 +539,28 @@ namespace NUnitLite.Tests
             Assert.That(Report, Is.EqualTo(expected));
         }
 
+        [TestCase("text", "stream", "testId", "testName")]
+        [TestCase("text", "stream", null, "testName")]
+        [TestCase("text", "stream", "testId", null)]
+        public void TestOutputToXml_IncludeAttributesInProperFormatting(string text, string stream, string testId, string testName)
+        {
+            var testOutput = new TestOutput(text, stream, testId, testName);
+            var expected = new StringBuilder();
+            expected.AppendFormat("<test-output stream=\"{0}\"", stream);
+
+            if (testId != null)
+            {
+                expected.AppendFormat(" testid=\"{0}\"", testId);
+            }
+
+            if (testName != null)
+            {
+                expected.AppendFormat(" testname=\"{0}\"", testName);
+            }
+
+            expected.AppendFormat("><![CDATA[{0}]]></test-output>", text);
+            Assert.That(testOutput.ToXml(), Is.EqualTo(expected.ToString()));
+        }
         #region Private Properties and Methods
 
         private void MyFakeMethod() { }
