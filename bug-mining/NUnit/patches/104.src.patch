diff --git a/src/Common/nunit/TestSelectionParser.cs b/src/Common/nunit/TestSelectionParser.cs
index 1f5ba8a89..0408e2ea1 100644
--- a/src/Common/nunit/TestSelectionParser.cs
+++ b/src/Common/nunit/TestSelectionParser.cs
@@ -159,30 +159,43 @@ namespace NUnit.Common
 
         private static string EmitFilterElement(Token lhs, Token op, Token rhs)
         {
+            string fmt = null;
+
             if (op == EQ_OP1 || op == EQ_OP2)
-                return string.Format("<{0}>{1}</{0}>", lhs.Text, rhs.Text);
+                fmt = "<{0}>{1}</{0}>";
             else if (op == NE_OP)
-                return string.Format("<not><{0}>{1}</{0}></not>", lhs.Text, rhs.Text);
+                fmt = "<not><{0}>{1}</{0}></not>";
             else if (op == MATCH_OP)
-                return string.Format("<{0} re='1'>{1}</{0}>", lhs.Text, rhs.Text);
+                fmt = "<{0} re='1'>{1}</{0}>";
             else if (op == NOMATCH_OP)
-                return string.Format("<not><{0} re='1'>{1}</{0}></not>", lhs.Text, rhs.Text);
+                fmt = "<not><{0} re='1'>{1}</{0}></not>";
             else
-                return string.Format("<{0} op='{1}'>{2}</{0}>", lhs.Text, op.Text, rhs.Text);
+                fmt = "<{0} op='" + op.Text + "'>{1}</{0}>";
+
+            return EmitElement(fmt, lhs, rhs);
         }
 
         private static string EmitPropertyElement(Token lhs, Token op, Token rhs)
         {
+            string fmt = null;
+
             if (op == EQ_OP1 || op == EQ_OP2)
-                return string.Format("<prop name='{0}'>{1}</prop>", lhs.Text, rhs.Text);
+                fmt = "<prop name='{0}'>{1}</prop>";
             else if (op == NE_OP)
-                return string.Format("<not><prop name='{0}'>{1}</prop></not>", lhs.Text, rhs.Text);
+                fmt = "<not><prop name='{0}'>{1}</prop></not>";
             else if (op == MATCH_OP)
-                return string.Format("<prop name='{0}' re='1'>{1}</prop>", lhs.Text, rhs.Text);
+                fmt = "<prop name='{0}' re='1'>{1}</prop>";
             else if (op == NOMATCH_OP)
-                return string.Format("<not><prop name='{0}' re='1'>{1}</prop></not>", lhs.Text, rhs.Text);
+                fmt = "<not><prop name='{0}' re='1'>{1}</prop></not>";
             else
-                return string.Format("<prop name='{0}' op='{1}'>{2}</prop>", lhs.Text, op.Text, rhs.Text);
+                fmt = "<prop name='{0}' op='" + op.Text + "'>{1}</prop>";
+
+            return EmitElement(fmt, lhs, rhs);
+        }
+
+        private static string EmitElement(string fmt, Token lhs, Token rhs)
+        {
+            return string.Format(fmt, lhs.Text, XmlEscape(rhs.Text));
         }
 
         private string ParseExpressionInParentheses()
@@ -249,5 +262,15 @@ namespace NUnit.Common
         {
             return _tokenizer.NextToken();
         }
+
+        private static string XmlEscape(string text)
+        {
+            return text
+                .Replace("&", "&amp;")
+                .Replace("\"", "&quot;")
+                .Replace("<", "&lt;")
+                .Replace(">", "&gt;")
+                .Replace("'", "&apos;");
+        }
     }
 }
diff --git a/src/Common/tests/TestSelectionParserTests.cs b/src/Common/tests/TestSelectionParserTests.cs
index 5ab59d155..4167d17fb 100644
--- a/src/Common/tests/TestSelectionParserTests.cs
+++ b/src/Common/tests/TestSelectionParserTests.cs
@@ -24,6 +24,7 @@
 using System;
 using System.Collections.Generic;
 using System.Text;
+using System.Xml;
 using NUnit.Framework;
 
 #if NUNIT_ENGINE
@@ -56,6 +57,10 @@ namespace NUnit.Common.Tests
         [TestCase("method=TestMethod", "<method>TestMethod</method>")]
         [TestCase("method=Test1||method=Test2||method=Test3", "<or><method>Test1</method><method>Test2</method><method>Test3</method></or>")]
         [TestCase("test='My.Test.Fixture.Method(42)'", "<test>My.Test.Fixture.Method(42)</test>")]
+        [TestCase("test='My.Test.Fixture.Method(\"xyz\")'", "<test>My.Test.Fixture.Method(&quot;xyz&quot;)</test>")]
+        [TestCase("test='My.Test.Fixture.Method(\"abc\\'s\")'", "<test>My.Test.Fixture.Method(&quot;abc&apos;s&quot;)</test>")]
+        [TestCase("test='My.Test.Fixture.Method(\"x&y&z\")'", "<test>My.Test.Fixture.Method(&quot;x&amp;y&amp;z&quot;)</test>")]
+        [TestCase("test='My.Test.Fixture.Method(\"<xyz>\")'", "<test>My.Test.Fixture.Method(&quot;&lt;xyz&gt;&quot;)</test>")]
         [TestCase("cat==Urgent && test=='My.Tests'", "<and><cat>Urgent</cat><test>My.Tests</test></and>")]
         [TestCase("cat==Urgent and test=='My.Tests'", "<and><cat>Urgent</cat><test>My.Tests</test></and>")]
         [TestCase("cat==Urgent || test=='My.Tests'", "<or><cat>Urgent</cat><test>My.Tests</test></or>")]
@@ -67,6 +72,9 @@ namespace NUnit.Common.Tests
         public void TestParser(string input, string output)
         {
             Assert.That(_parser.Parse(input), Is.EqualTo(output));
+
+            XmlDocument doc = new XmlDocument();
+            Assert.DoesNotThrow(() => doc.LoadXml(output));
         }
 
         [TestCase(null, typeof(ArgumentNullException))]
diff --git a/src/NUnitEngine/nunit.engine.tests/Drivers/NUnit3FrameworkDriverTests.cs b/src/NUnitEngine/nunit.engine.tests/Drivers/NUnit3FrameworkDriverTests.cs
index 8495b724f..1c8457a61 100644
--- a/src/NUnitEngine/nunit.engine.tests/Drivers/NUnit3FrameworkDriverTests.cs
+++ b/src/NUnitEngine/nunit.engine.tests/Drivers/NUnit3FrameworkDriverTests.cs
@@ -41,6 +41,7 @@ namespace NUnit.Engine.Drivers.Tests
         private const string LOAD_MESSAGE = "Method called without calling Load first";
 
         private IDictionary<string, object> _settings = new Dictionary<string, object>();
+
         private NUnit3FrameworkDriver _driver;
         private string _mockAssemblyPath;
 
diff --git a/src/NUnitEngine/nunit.engine.tests/Services/TestFilterBuilderTests.cs b/src/NUnitEngine/nunit.engine.tests/Services/TestFilterBuilderTests.cs
index d69c7a8d3..4c685fee8 100644
--- a/src/NUnitEngine/nunit.engine.tests/Services/TestFilterBuilderTests.cs
+++ b/src/NUnitEngine/nunit.engine.tests/Services/TestFilterBuilderTests.cs
@@ -55,6 +55,16 @@ namespace NUnit.Engine.Services.Tests
                 "<filter><test>My.Test.Name</test></filter>"));
         }
 
+        [Test]
+        public void OneTestSelected_XmlEscape()
+        {
+            builder.AddTest("My.Test.Name<T>(\"abc\")");
+            TestFilter filter = builder.GetFilter();
+
+            Assert.That(filter.Text, Is.EqualTo(
+                "<filter><test>My.Test.Name&lt;T&gt;(&quot;abc&quot;)</test></filter>"));
+        }
+
         [Test]
         public void ThreeTestsSelected()
         {
@@ -76,6 +86,16 @@ namespace NUnit.Engine.Services.Tests
             Assert.That(filter.Text, Is.EqualTo("<filter><cat>Dummy</cat></filter>"));
         }
 
+        [Test]
+        public void WhereClause_XmlEscape()
+        {
+            builder.SelectWhere("test=='My.Test.Name<T>(\"abc\")'");
+            TestFilter filter = builder.GetFilter();
+
+            Assert.That(filter.Text, Is.EqualTo(
+                "<filter><test>My.Test.Name&lt;T&gt;(&quot;abc&quot;)</test></filter>"));
+        }
+
         [Test]
         public void OneTestAndWhereClause()
         {
diff --git a/src/NUnitEngine/nunit.engine.tests/Services/TestFilteringTests.cs b/src/NUnitEngine/nunit.engine.tests/Services/TestFilteringTests.cs
new file mode 100644
index 000000000..fb4f7af85
--- /dev/null
+++ b/src/NUnitEngine/nunit.engine.tests/Services/TestFilteringTests.cs
@@ -0,0 +1,105 @@
+ï»¿// ***********************************************************************
+// Copyright (c) 2011 Charlie Poole
+//
+// Permission is hereby granted, free of charge, to any person obtaining
+// a copy of this software and associated documentation files (the
+// "Software"), to deal in the Software without restriction, including
+// without limitation the rights to use, copy, modify, merge, publish,
+// distribute, sublicense, and/or sell copies of the Software, and to
+// permit persons to whom the Software is furnished to do so, subject to
+// the following conditions:
+// 
+// The above copyright notice and this permission notice shall be
+// included in all copies or substantial portions of the Software.
+// 
+// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
+// EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
+// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
+// NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
+// LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
+// OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
+// WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
+// ***********************************************************************
+
+using System;
+using System.Collections.Generic;
+using System.Text;
+using NUnit.Framework;
+using NUnit.Tests.Assemblies;
+
+namespace NUnit.Engine.Services.Tests
+{
+    using Drivers;
+
+    public class TestFilteringTests
+    {
+        private const string MOCK_ASSEMBLY = "mock-nunit-assembly.exe";
+
+        private NUnit3FrameworkDriver _driver;
+
+        [SetUp]
+        public void LoadAssembly()
+        {
+            var mockAssemblyPath = System.IO.Path.Combine(TestContext.CurrentContext.TestDirectory, MOCK_ASSEMBLY);
+            _driver = new NUnit3FrameworkDriver(AppDomain.CurrentDomain);
+            _driver.Load(mockAssemblyPath, new Dictionary<string, object>());
+        }
+
+        [TestCase("<filter/>", MockAssembly.Tests)]
+        [TestCase("<filter><test>NUnit.Tests.Assemblies.MockTestFixture</test></filter>", MockTestFixture.Tests)]
+        [TestCase("<filter><test>NUnit.Tests.Assemblies.MockTestFixture.MockTest4</test></filter>", 1)]
+        [TestCase("<filter><test>NUnit.Tests.TestNameEscaping.MustBeEscaped(&quot;&lt; left bracket&quot;)</test></filter>", 1)]
+        [TestCase("<filter><test>NUnit.Tests.TestNameEscaping.MustBeEscaped(&quot;&gt; right bracket&quot;)</test></filter>", 1)]
+        [TestCase("<filter><test>NUnit.Tests.TestNameEscaping.MustBeEscaped(&quot;'single quote'&quot;)</test></filter>", 1)]
+        [TestCase("<filter><test>NUnit.Tests.TestNameEscaping.MustBeEscaped(&quot;\\&quot;double quote\\&quot;&quot;)</test></filter>", 1)]
+        [TestCase("<filter><test>NUnit.Tests.TestNameEscaping.MustBeEscaped(&quot;&amp;amp&quot;)</test></filter>", 1)]
+
+        [TestCase("<filter><class>NUnit.Tests.Assemblies.MockTestFixture</class></filter>", MockTestFixture.Tests)]
+
+        [TestCase("<filter><name>MockTest4</name></filter>", 1)]
+        [TestCase("<filter><name>MockTestFixture</name></filter>", MockTestFixture.Tests + NUnit.Tests.TestAssembly.MockTestFixture.Tests)]
+        [TestCase("<filter><method>MockTest4</method></filter>", 1)]
+        [TestCase("<filter><cat>FixtureCategory</cat></filter>", MockTestFixture.Tests)]
+        public void UsingXml(string filter, int count)
+        {
+            Assert.That(_driver.CountTestCases(filter), Is.EqualTo(count));
+        }
+
+        [TestCase("NUnit.Tests.Assemblies.MockTestFixture", MockTestFixture.Tests, TestName = "{m}_MockTestFixture")]
+        [TestCase("NUnit.Tests.Assemblies.MockTestFixture.MockTest4", 1, TestName = "{m}_MockTest4")]
+        [TestCase("NUnit.Tests.TestNameEscaping.MustBeEscaped(\"< left bracket\")", 1, TestName = "{m}_left_bracket")]
+        [TestCase("NUnit.Tests.TestNameEscaping.MustBeEscaped(\"> right bracket\")", 1, TestName = "{m}_right_bracket")]
+        [TestCase("NUnit.Tests.TestNameEscaping.MustBeEscaped(\"'single quote'\")", 1, TestName = "{m}_single_quote")]
+        [TestCase("NUnit.Tests.TestNameEscaping.MustBeEscaped(\"\\\"double quote\\\"\")", 1, TestName = "{m}_double_quote")]
+        [TestCase("NUnit.Tests.TestNameEscaping.MustBeEscaped(\"&amp\")", 1, TestName = "{m}_ampersand")]
+        public void UsingTestFilterBuilderAddTest(string testName, int count)
+        {
+            var builder = new TestFilterBuilder();
+            builder.AddTest(testName);
+
+            Assert.That(_driver.CountTestCases(builder.GetFilter().Text), Is.EqualTo(count));
+
+        }
+
+        [TestCase("test==NUnit.Tests.Assemblies.MockTestFixture", MockTestFixture.Tests, TestName = "{m}_MockTestFixture")]
+        [TestCase("test==NUnit.Tests.Assemblies.MockTestFixture.MockTest4", 1, TestName = "{m}_MockTest4")]
+        [TestCase("test=='NUnit.Tests.TestNameEscaping.MustBeEscaped(\"< left bracket\")'", 1, TestName = "{m}_left_bracket")]
+        [TestCase("test=='NUnit.Tests.TestNameEscaping.MustBeEscaped(\"> right bracket\")'", 1, TestName = "{m}_right_bracket")]
+        [TestCase("test==/NUnit.Tests.TestNameEscaping.MustBeEscaped(\"'single quote'\")/", 1, TestName = "{m}_single_quote")]
+        [TestCase("test==/NUnit.Tests.TestNameEscaping.MustBeEscaped(\"\\\\\"double quote\\\\\"\")/", 1, TestName = "{m}_double_quote")]
+        [TestCase("test==/NUnit.Tests.TestNameEscaping.MustBeEscaped(\"&amp\")/", 1, TestName = "{m}_ampersand")]
+        [TestCase("class==NUnit.Tests.Assemblies.MockTestFixture", MockTestFixture.Tests)]
+        [TestCase("name==MockTest4", 1)]
+        [TestCase("name==MockTestFixture", MockTestFixture.Tests + NUnit.Tests.TestAssembly.MockTestFixture.Tests)]
+        [TestCase("method==MockTest4", 1)]
+        [TestCase("cat==FixtureCategory", MockTestFixture.Tests)]
+        public void UsingTestFilterBuilderSelectWhere(string expression, int count)
+        {
+            var builder = new TestFilterBuilder();
+            builder.SelectWhere(expression);
+
+            Assert.That(_driver.CountTestCases(builder.GetFilter().Text), Is.EqualTo(count));
+
+        }
+    }
+}
diff --git a/src/NUnitEngine/nunit.engine.tests/nunit.engine.tests.csproj b/src/NUnitEngine/nunit.engine.tests/nunit.engine.tests.csproj
index 3b47a0234..0edc545b5 100644
--- a/src/NUnitEngine/nunit.engine.tests/nunit.engine.tests.csproj
+++ b/src/NUnitEngine/nunit.engine.tests/nunit.engine.tests.csproj
@@ -70,9 +70,9 @@
     <Compile Include="Api\TestFilterTests.cs" />
     <Compile Include="Api\TestPackageTests.cs" />
     <Compile Include="AsyncTestEngineResultTests.cs" />
+    <Compile Include="Drivers\NUnit3FrameworkDriverTests.cs" />
     <Compile Include="Properties\AssemblyInfo.cs" />
     <Compile Include="Drivers\NotRunnableFrameworkDriverTests.cs" />
-    <Compile Include="Drivers\NUnit3FrameworkDriverTests.cs" />
     <Compile Include="Internal\PathUtilTests.cs" />
     <Compile Include="Internal\ServerUtilityTests.cs" />
     <Compile Include="Internal\SettingsGroupTests.cs" />
@@ -103,6 +103,7 @@
     <Compile Include="Services\DefaultTestRunnerFactoryTests.cs" />
     <Compile Include="Services\ServiceDependencyTests.cs" />
     <Compile Include="Services\TestFilterBuilderTests.cs" />
+    <Compile Include="Services\TestFilteringTests.cs" />
     <Compile Include="TempResourceFile.cs" />
     <Compile Include="TestEngineResultTests.cs" />
   </ItemGroup>
diff --git a/src/NUnitEngine/nunit.engine/Services/TestFilterBuilder.cs b/src/NUnitEngine/nunit.engine/Services/TestFilterBuilder.cs
index 79e271bd0..2f8f8e39a 100644
--- a/src/NUnitEngine/nunit.engine/Services/TestFilterBuilder.cs
+++ b/src/NUnitEngine/nunit.engine/Services/TestFilterBuilder.cs
@@ -64,7 +64,7 @@ namespace NUnit.Engine
                 if (_testList.Count > 1)
                     filter.Append("<or>");
                 foreach (string test in _testList)
-                    filter.AppendFormat("<test>{0}</test>", test);
+                    filter.AppendFormat("<test>{0}</test>", XmlEscape(test));
                 if (_testList.Count > 1)
                     filter.Append("</or>");
             }
@@ -77,5 +77,15 @@ namespace NUnit.Engine
 
             return new TestFilter(filter.ToString());
         }
+
+        private static string XmlEscape(string text)
+        {
+            return text
+                .Replace("&", "&amp;")
+                .Replace("\"", "&quot;")
+                .Replace("<", "&lt;")
+                .Replace(">", "&gt;")
+                .Replace("'", "&apos;");
+        }
     }
 }
diff --git a/src/NUnitFramework/framework/Internal/TestNameGenerator.cs b/src/NUnitFramework/framework/Internal/TestNameGenerator.cs
index da426b214..5e950351d 100644
--- a/src/NUnitFramework/framework/Internal/TestNameGenerator.cs
+++ b/src/NUnitFramework/framework/Internal/TestNameGenerator.cs
@@ -302,7 +302,7 @@ namespace NUnit.Framework.Internal
                     sb.Append("\"");
                     foreach (char c in str)
                     {
-                        sb.Append(EscapeControlChar(c));
+                        sb.Append(EscapeCharInString(c));
                         if (tooLong && sb.Length > limit)
                         {
                             sb.Append(THREE_DOTS);
@@ -314,7 +314,7 @@ namespace NUnit.Framework.Internal
                 }
                 else if (arg is char)
                 {
-                    display = "\'" + EscapeControlChar((char)arg) + "\'";
+                    display = "\'" + EscapeSingleChar((char)arg) + "\'";
                 }
                 else if (arg is int)
                 {
@@ -362,14 +362,26 @@ namespace NUnit.Framework.Internal
                 return display;
             }
 
+            private static string EscapeSingleChar(char c)
+            {
+                if (c == '\'')
+                    return "\\\'";
+
+                return EscapeControlChar(c);
+            }
+
+            private static string EscapeCharInString(char c)
+            {
+                if (c == '"')
+                    return "\\\"";
+
+                return EscapeControlChar(c);
+            }
+            
             private static string EscapeControlChar(char c)
             {
                 switch (c)
                 {
-                    case '\'':
-                        return "\\\'";
-                    case '\"':
-                        return "\\\"";
                     case '\\':
                         return "\\\\";
                     case '\0':
