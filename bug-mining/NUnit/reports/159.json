{"url":"https://api.github.com/repos/nunit/nunit/issues/2146","repository_url":"https://api.github.com/repos/nunit/nunit","labels_url":"https://api.github.com/repos/nunit/nunit/issues/2146/labels{/name}","comments_url":"https://api.github.com/repos/nunit/nunit/issues/2146/comments","events_url":"https://api.github.com/repos/nunit/nunit/issues/2146/events","html_url":"https://github.com/nunit/nunit/issues/2146","id":226493148,"node_id":"MDU6SXNzdWUyMjY0OTMxNDg=","number":2146,"title":"Assert.That with a Throws constraint does not provide as much info as Assert.Throws","user":{"login":"a-ctor","id":5082673,"node_id":"MDQ6VXNlcjUwODI2NzM=","avatar_url":"https://avatars.githubusercontent.com/u/5082673?v=4","gravatar_id":"","url":"https://api.github.com/users/a-ctor","html_url":"https://github.com/a-ctor","followers_url":"https://api.github.com/users/a-ctor/followers","following_url":"https://api.github.com/users/a-ctor/following{/other_user}","gists_url":"https://api.github.com/users/a-ctor/gists{/gist_id}","starred_url":"https://api.github.com/users/a-ctor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/a-ctor/subscriptions","organizations_url":"https://api.github.com/users/a-ctor/orgs","repos_url":"https://api.github.com/users/a-ctor/repos","events_url":"https://api.github.com/users/a-ctor/events{/privacy}","received_events_url":"https://api.github.com/users/a-ctor/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":61608514,"node_id":"MDU6TGFiZWw2MTYwODUxNA==","url":"https://api.github.com/repos/nunit/nunit/labels/is:bug","name":"is:bug","color":"fc2929","default":false,"description":null},{"id":61616795,"node_id":"MDU6TGFiZWw2MTYxNjc5NQ==","url":"https://api.github.com/repos/nunit/nunit/labels/closed:done","name":"closed:done","color":"0e8a16","default":false,"description":null},{"id":61616865,"node_id":"MDU6TGFiZWw2MTYxNjg2NQ==","url":"https://api.github.com/repos/nunit/nunit/labels/pri:normal","name":"pri:normal","color":"fbca04","default":false,"description":null},{"id":62115649,"node_id":"MDU6TGFiZWw2MjExNTY0OQ==","url":"https://api.github.com/repos/nunit/nunit/labels/good%20first%20issue","name":"good first issue","color":"0052cc","default":true,"description":null}],"state":"closed","locked":false,"assignee":{"login":"mikkelbu","id":1007631,"node_id":"MDQ6VXNlcjEwMDc2MzE=","avatar_url":"https://avatars.githubusercontent.com/u/1007631?v=4","gravatar_id":"","url":"https://api.github.com/users/mikkelbu","html_url":"https://github.com/mikkelbu","followers_url":"https://api.github.com/users/mikkelbu/followers","following_url":"https://api.github.com/users/mikkelbu/following{/other_user}","gists_url":"https://api.github.com/users/mikkelbu/gists{/gist_id}","starred_url":"https://api.github.com/users/mikkelbu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mikkelbu/subscriptions","organizations_url":"https://api.github.com/users/mikkelbu/orgs","repos_url":"https://api.github.com/users/mikkelbu/repos","events_url":"https://api.github.com/users/mikkelbu/events{/privacy}","received_events_url":"https://api.github.com/users/mikkelbu/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"mikkelbu","id":1007631,"node_id":"MDQ6VXNlcjEwMDc2MzE=","avatar_url":"https://avatars.githubusercontent.com/u/1007631?v=4","gravatar_id":"","url":"https://api.github.com/users/mikkelbu","html_url":"https://github.com/mikkelbu","followers_url":"https://api.github.com/users/mikkelbu/followers","following_url":"https://api.github.com/users/mikkelbu/following{/other_user}","gists_url":"https://api.github.com/users/mikkelbu/gists{/gist_id}","starred_url":"https://api.github.com/users/mikkelbu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mikkelbu/subscriptions","organizations_url":"https://api.github.com/users/mikkelbu/orgs","repos_url":"https://api.github.com/users/mikkelbu/repos","events_url":"https://api.github.com/users/mikkelbu/events{/privacy}","received_events_url":"https://api.github.com/users/mikkelbu/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":{"url":"https://api.github.com/repos/nunit/nunit/milestones/35","html_url":"https://github.com/nunit/nunit/milestone/35","labels_url":"https://api.github.com/repos/nunit/nunit/milestones/35/labels","id":3176302,"node_id":"MDk6TWlsZXN0b25lMzE3NjMwMg==","number":35,"title":"3.11","description":"","creator":{"login":"rprouse","id":493828,"node_id":"MDQ6VXNlcjQ5MzgyOA==","avatar_url":"https://avatars.githubusercontent.com/u/493828?v=4","gravatar_id":"","url":"https://api.github.com/users/rprouse","html_url":"https://github.com/rprouse","followers_url":"https://api.github.com/users/rprouse/followers","following_url":"https://api.github.com/users/rprouse/following{/other_user}","gists_url":"https://api.github.com/users/rprouse/gists{/gist_id}","starred_url":"https://api.github.com/users/rprouse/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rprouse/subscriptions","organizations_url":"https://api.github.com/users/rprouse/orgs","repos_url":"https://api.github.com/users/rprouse/repos","events_url":"https://api.github.com/users/rprouse/events{/privacy}","received_events_url":"https://api.github.com/users/rprouse/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":57,"state":"closed","created_at":"2018-03-10T20:54:10Z","updated_at":"2018-11-23T01:22:07Z","due_on":"2018-09-28T07:00:00Z","closed_at":"2018-10-07T01:26:57Z"},"comments":19,"created_at":"2017-05-05T07:23:34Z","updated_at":"2018-05-31T20:37:22Z","closed_at":"2018-05-31T20:35:49Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"When using `Assert.Throws` and an unexpected exception is thrown nunit provides information about the unexpected exception. \r\n\r\n```csharp\r\n[Test]\r\npublic void UnexpectedExceptionWithInfo()\r\n{\r\n  Assert.Throws<IOException>(() =>\r\n  {\r\n    throw new FormatException(\"This is a format exception.\");\r\n  });\r\n}\r\n```\r\n\r\nThis test expects an `IOException` to be thrown but instead a `FormatException` is thrown. This provides the following output:\r\n\r\n```\r\n Expected: <System.IO.IOException>\r\n  But was:  <System.FormatException: This is a format exception.\r\n   at Testit.Tests.<>c.<UnexpectedExceptionWithInfo>b__0_0() in Program.cs:line 23\r\n   at NUnit.Framework.Assert.Throws(IResolveConstraint expression, TestDelegate code, String message, Object[] args)>\r\n\r\nat Testit.Tests.UnexpectedExceptionWithInfo() in Program.cs:line 21\r\n```\r\n\r\nIt is providing information about the unexpected `FormatException` (message + stack trace). The problem is that in our codebase we are using `Assert.That` with a `Throws.TypeOf<>` constraint like this:\r\n\r\n```\r\n[Test]\r\npublic void UnexpectedExceptionWithoutInfo()\r\n{\r\n  Assert.That(() =>\r\n  {\r\n    throw new FormatException(\"This is a format exception.\");\r\n  }, Throws.TypeOf<IOException>());\r\n}\r\n```\r\n\r\nBut when this example encounters the unexpected `FormatException` the following is output:\r\n\r\n```\r\n  Expected: <System.IO.IOException>\r\n  But was:  <System.FormatException>\r\n\r\nat Testit.Tests.UnexpectedExceptionWithoutInfo() in Program.cs:line 30\r\n```\r\n\r\nNote here that the information about the unexpected exception (message + stack trace) is gone. But exactly those two exception details would be relavant for debugging the failed test.\r\n\r\nIs this behaiviour intended? And if yes are there easy ways to fix this issue?\r\n\r\nMy current workaround is to use a `ThrowsConstraint` with an `ExceptionTypeConstraint` as base constraint: \r\n\r\n```\r\n[Test]\r\npublic void UnexpectedExceptionFixedInfo()\r\n{\r\n  Assert.That(() =>\r\n  {\r\n    throw new FormatException(\"This is a format exception.\");\r\n  }, new ThrowsConstraint(new ExceptionTypeConstraint(typeof(IOException))));\r\n}\r\n```","closed_by":{"login":"mikkelbu","id":1007631,"node_id":"MDQ6VXNlcjEwMDc2MzE=","avatar_url":"https://avatars.githubusercontent.com/u/1007631?v=4","gravatar_id":"","url":"https://api.github.com/users/mikkelbu","html_url":"https://github.com/mikkelbu","followers_url":"https://api.github.com/users/mikkelbu/followers","following_url":"https://api.github.com/users/mikkelbu/following{/other_user}","gists_url":"https://api.github.com/users/mikkelbu/gists{/gist_id}","starred_url":"https://api.github.com/users/mikkelbu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mikkelbu/subscriptions","organizations_url":"https://api.github.com/users/mikkelbu/orgs","repos_url":"https://api.github.com/users/mikkelbu/repos","events_url":"https://api.github.com/users/mikkelbu/events{/privacy}","received_events_url":"https://api.github.com/users/mikkelbu/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/nunit/nunit/issues/2146/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/nunit/nunit/issues/2146/timeline","performed_via_github_app":null,"state_reason":"completed"}