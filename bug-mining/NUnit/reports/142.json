{"url":"https://api.github.com/repos/nunit/nunit/issues/2454","repository_url":"https://api.github.com/repos/nunit/nunit","labels_url":"https://api.github.com/repos/nunit/nunit/issues/2454/labels{/name}","comments_url":"https://api.github.com/repos/nunit/nunit/issues/2454/comments","events_url":"https://api.github.com/repos/nunit/nunit/issues/2454/events","html_url":"https://github.com/nunit/nunit/issues/2454","id":259778725,"node_id":"MDU6SXNzdWUyNTk3Nzg3MjU=","number":2454,"title":"SetUpFixture not respecting NonParallelizable tag on TestFixtures.","user":{"login":"woodylaurence","id":12712303,"node_id":"MDQ6VXNlcjEyNzEyMzAz","avatar_url":"https://avatars.githubusercontent.com/u/12712303?v=4","gravatar_id":"","url":"https://api.github.com/users/woodylaurence","html_url":"https://github.com/woodylaurence","followers_url":"https://api.github.com/users/woodylaurence/followers","following_url":"https://api.github.com/users/woodylaurence/following{/other_user}","gists_url":"https://api.github.com/users/woodylaurence/gists{/gist_id}","starred_url":"https://api.github.com/users/woodylaurence/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/woodylaurence/subscriptions","organizations_url":"https://api.github.com/users/woodylaurence/orgs","repos_url":"https://api.github.com/users/woodylaurence/repos","events_url":"https://api.github.com/users/woodylaurence/events{/privacy}","received_events_url":"https://api.github.com/users/woodylaurence/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":61608514,"node_id":"MDU6TGFiZWw2MTYwODUxNA==","url":"https://api.github.com/repos/nunit/nunit/labels/is:bug","name":"is:bug","color":"fc2929","default":false,"description":null},{"id":61616795,"node_id":"MDU6TGFiZWw2MTYxNjc5NQ==","url":"https://api.github.com/repos/nunit/nunit/labels/closed:done","name":"closed:done","color":"0e8a16","default":false,"description":null},{"id":61616828,"node_id":"MDU6TGFiZWw2MTYxNjgyOA==","url":"https://api.github.com/repos/nunit/nunit/labels/pri:high","name":"pri:high","color":"eb6420","default":false,"description":null}],"state":"closed","locked":false,"assignee":{"login":"CharliePoole","id":2678661,"node_id":"MDQ6VXNlcjI2Nzg2NjE=","avatar_url":"https://avatars.githubusercontent.com/u/2678661?v=4","gravatar_id":"","url":"https://api.github.com/users/CharliePoole","html_url":"https://github.com/CharliePoole","followers_url":"https://api.github.com/users/CharliePoole/followers","following_url":"https://api.github.com/users/CharliePoole/following{/other_user}","gists_url":"https://api.github.com/users/CharliePoole/gists{/gist_id}","starred_url":"https://api.github.com/users/CharliePoole/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CharliePoole/subscriptions","organizations_url":"https://api.github.com/users/CharliePoole/orgs","repos_url":"https://api.github.com/users/CharliePoole/repos","events_url":"https://api.github.com/users/CharliePoole/events{/privacy}","received_events_url":"https://api.github.com/users/CharliePoole/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"CharliePoole","id":2678661,"node_id":"MDQ6VXNlcjI2Nzg2NjE=","avatar_url":"https://avatars.githubusercontent.com/u/2678661?v=4","gravatar_id":"","url":"https://api.github.com/users/CharliePoole","html_url":"https://github.com/CharliePoole","followers_url":"https://api.github.com/users/CharliePoole/followers","following_url":"https://api.github.com/users/CharliePoole/following{/other_user}","gists_url":"https://api.github.com/users/CharliePoole/gists{/gist_id}","starred_url":"https://api.github.com/users/CharliePoole/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CharliePoole/subscriptions","organizations_url":"https://api.github.com/users/CharliePoole/orgs","repos_url":"https://api.github.com/users/CharliePoole/repos","events_url":"https://api.github.com/users/CharliePoole/events{/privacy}","received_events_url":"https://api.github.com/users/CharliePoole/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":{"url":"https://api.github.com/repos/nunit/nunit/milestones/32","html_url":"https://github.com/nunit/nunit/milestone/32","labels_url":"https://api.github.com/repos/nunit/nunit/milestones/32/labels","id":2714609,"node_id":"MDk6TWlsZXN0b25lMjcxNDYwOQ==","number":32,"title":"3.9","description":"","creator":{"login":"rprouse","id":493828,"node_id":"MDQ6VXNlcjQ5MzgyOA==","avatar_url":"https://avatars.githubusercontent.com/u/493828?v=4","gravatar_id":"","url":"https://api.github.com/users/rprouse","html_url":"https://github.com/rprouse","followers_url":"https://api.github.com/users/rprouse/followers","following_url":"https://api.github.com/users/rprouse/following{/other_user}","gists_url":"https://api.github.com/users/rprouse/gists{/gist_id}","starred_url":"https://api.github.com/users/rprouse/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rprouse/subscriptions","organizations_url":"https://api.github.com/users/rprouse/orgs","repos_url":"https://api.github.com/users/rprouse/repos","events_url":"https://api.github.com/users/rprouse/events{/privacy}","received_events_url":"https://api.github.com/users/rprouse/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":54,"state":"closed","created_at":"2017-08-22T00:20:38Z","updated_at":"2018-01-13T23:51:17Z","due_on":"2017-11-30T08:00:00Z","closed_at":"2017-11-11T12:53:40Z"},"comments":12,"created_at":"2017-09-22T10:57:50Z","updated_at":"2017-11-03T23:15:37Z","closed_at":"2017-09-27T12:29:07Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"It seems since version 3.8.0, the inclusion of a SetUpFixture causes issues when trying to run multiple fixtures marked as parallelizable but some fixtures marked as non-parallelizable.\r\n\r\nI have parallelism set at the assembly level with the following in my AssemblyInfo.cs:\r\n`[assembly: Parallelizable(ParallelScope.Fixtures)]`\r\n\r\nHere's my test setup:\r\n```\r\nnamespace Tests\r\n{\r\n\t[SetUpFixture]\r\n\tpublic class TestsSetUpFixture\r\n\t{\r\n\r\n\t}\r\n\r\n\t[TestFixture]\r\n\tpublic class TestFixture1\r\n\t{\r\n\t\t[Test]\r\n\t\tpublic void TestFixture1_Test()\r\n\t\t{\r\n\t\t\tThread.Sleep(1000);\r\n\t\t}\r\n\t}\r\n\r\n\t[TestFixture]\r\n\t[NonParallelizable]\r\n\tpublic class TestFixture2\r\n\t{\r\n\t\t[Test]\r\n\t\tpublic void TestFixture2_Test()\r\n\t\t{\r\n\t\t\tThread.Sleep(1000);\r\n\t\t}\r\n\t}\r\n\r\n\t[TestFixture]\r\n\tpublic class TestFixture3\r\n\t{\r\n\t\t[Test]\r\n\t\tpublic void TestFixture3_Test()\r\n\t\t{\r\n\t\t\tThread.Sleep(1000);\r\n\t\t}\r\n\t}\r\n}\r\n```\r\n\r\nAll three test fixtures get run in parallel, I would expect 1 and 3 to run in parallel whilst 2 is run separately. This is the behaviour when running under version 3.7.1, however upgrading to 3.8 causes them all to run in parallel (the same is also true under 3.8.1).\r\n\r\nWe get the same problem if you remove the parallelism setting from AssemblyInfo and instead mark TestFixture1 and TestFixture3 as [Parallelizable(ParallelScope.Self)].\r\n\r\nAs work around, for now,  you can change the ParallelScope in AssemblyInfo to Children instead of Fixtures and the behaviour returns to what is expected where all TestFixture 2 waits for the other 2 fixtures to finish executing. If you have more than 1 test in a fixture  you do end up with tests within fixtures running in parallel; this can be further fixed by adding the ParallelScope.Self above the fixtures which need to run in parallel.","closed_by":{"login":"CharliePoole","id":2678661,"node_id":"MDQ6VXNlcjI2Nzg2NjE=","avatar_url":"https://avatars.githubusercontent.com/u/2678661?v=4","gravatar_id":"","url":"https://api.github.com/users/CharliePoole","html_url":"https://github.com/CharliePoole","followers_url":"https://api.github.com/users/CharliePoole/followers","following_url":"https://api.github.com/users/CharliePoole/following{/other_user}","gists_url":"https://api.github.com/users/CharliePoole/gists{/gist_id}","starred_url":"https://api.github.com/users/CharliePoole/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CharliePoole/subscriptions","organizations_url":"https://api.github.com/users/CharliePoole/orgs","repos_url":"https://api.github.com/users/CharliePoole/repos","events_url":"https://api.github.com/users/CharliePoole/events{/privacy}","received_events_url":"https://api.github.com/users/CharliePoole/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/nunit/nunit/issues/2454/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/nunit/nunit/issues/2454/timeline","performed_via_github_app":null,"state_reason":"completed"}