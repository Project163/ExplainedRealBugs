{"url":"https://api.github.com/repos/etcd-io/etcd/issues/10747","repository_url":"https://api.github.com/repos/etcd-io/etcd","labels_url":"https://api.github.com/repos/etcd-io/etcd/issues/10747/labels{/name}","comments_url":"https://api.github.com/repos/etcd-io/etcd/issues/10747/comments","events_url":"https://api.github.com/repos/etcd-io/etcd/issues/10747/events","html_url":"https://github.com/etcd-io/etcd/issues/10747","id":446743597,"node_id":"MDU6SXNzdWU0NDY3NDM1OTc=","number":10747,"title":"ETCD_CONFIG_FILE env variable is ignored","user":{"login":"weavage","id":21956767,"node_id":"MDQ6VXNlcjIxOTU2NzY3","avatar_url":"https://avatars.githubusercontent.com/u/21956767?v=4","gravatar_id":"","url":"https://api.github.com/users/weavage","html_url":"https://github.com/weavage","followers_url":"https://api.github.com/users/weavage/followers","following_url":"https://api.github.com/users/weavage/following{/other_user}","gists_url":"https://api.github.com/users/weavage/gists{/gist_id}","starred_url":"https://api.github.com/users/weavage/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/weavage/subscriptions","organizations_url":"https://api.github.com/users/weavage/orgs","repos_url":"https://api.github.com/users/weavage/repos","events_url":"https://api.github.com/users/weavage/events{/privacy}","received_events_url":"https://api.github.com/users/weavage/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":46697272,"node_id":"MDU6TGFiZWw0NjY5NzI3Mg==","url":"https://api.github.com/repos/etcd-io/etcd/labels/type/bug","name":"type/bug","color":"d61552","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":7,"created_at":"2019-05-21T17:42:04Z","updated_at":"2023-08-10T22:06:11Z","closed_at":"2019-06-08T04:32:36Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"etcd v3.3\r\n\r\netcd appears to recognize and then promptly ignore the **ETCD_CONFIG_FILE** environment variable. Passing the **--config-file** flag seems to work properly. As an example, create a super simplistic config file at _/etc/etcd/etcd.conf.yaml_ containing only \r\n`data-dir: /var/lib/etcd`\r\n\r\nSetting **ETCD_CONFIG_FILE=/etc/etcd/etcd.conf.yaml** and trying to start etcd returns something similar to the following:\r\n```\r\n2019-05-21 17:32:51.695776 I | pkg/flags: recognized and used environment variable ETCD_CONFIG_FILE=/etc/etcd/etcd.conf.yaml  \r\n2019-05-21 17:32:51.695920 I | etcdmain: etcd Version: 3.3.13  \r\n2019-05-21 17:32:51.695929 I | etcdmain: Git SHA: 98d3084  \r\n2019-05-21 17:32:51.695936 I | etcdmain: Go Version: go1.10.8  \r\n2019-05-21 17:32:51.695942 I | etcdmain: Go OS/Arch: linux/amd64  \r\n2019-05-21 17:32:51.695949 I | etcdmain: setting maximum number of CPUs to 40, total number of available CPUs is 40  \r\n2019-05-21 17:32:51.695960 W | etcdmain: no data-dir provided, using default data-dir ./default.etcd  \r\n2019-05-21 17:32:51.696439 I | embed: listening for peers on http://localhost:2380  \r\n2019-05-21 17:32:51.696555 I | embed: listening for client requests on localhost:2379  \r\n2019-05-21 17:32:51.696650 C | etcdmain: cannot access data directory: mkdir default.etcd: permission denied  \r\n```\r\n\r\nHowever, starting etcd with the **--config-file /etc/etcd/etcd.conf.yaml** works properly:\r\n```\r\n2019-05-21 17:33:57.303742 I | etcdmain: Loading server configuration from \"/etc/etcd/etcd.conf.yaml\"\r\n2019-05-21 17:33:57.305112 I | etcdmain: etcd Version: 3.3.13\r\n2019-05-21 17:33:57.305124 I | etcdmain: Git SHA: 98d3084\r\n2019-05-21 17:33:57.305128 I | etcdmain: Go Version: go1.10.8\r\n2019-05-21 17:33:57.305131 I | etcdmain: Go OS/Arch: linux/amd64\r\n2019-05-21 17:33:57.305136 I | etcdmain: setting maximum number of CPUs to 40, total number of available CPUs is 40\r\n2019-05-21 17:33:57.306523 N | etcdmain: the server is already initialized as member before, starting as etcd member...\r\n2019-05-21 17:33:57.306815 I | embed: listening for peers on http://localhost:2380\r\n2019-05-21 17:33:57.306916 I | embed: listening for client requests on localhost:2379\r\n2019-05-21 17:33:57.325706 I | etcdserver: name = default\r\n2019-05-21 17:33:57.325736 I | etcdserver: data dir = /var/lib/etcd\r\n2019-05-21 17:33:57.325751 I | etcdserver: member dir = /var/lib/etcd/member\r\n2019-05-21 17:33:57.325760 I | etcdserver: heartbeat = 100ms\r\n2019-05-21 17:33:57.325772 I | etcdserver: election = 1000ms\r\n2019-05-21 17:33:57.325782 I | etcdserver: snapshot count = 100000\r\n2019-05-21 17:33:57.325803 I | etcdserver: advertise client URLs = http://localhost:2379\r\n2019-05-21 17:33:57.335837 I | etcdserver: restarting member 8e9e05c52164694d in cluster cdf818194e3a8c32 at commit index 4\r\n2019-05-21 17:33:57.335910 I | raft: 8e9e05c52164694d became follower at term 2\r\n2019-05-21 17:33:57.335955 I | raft: newRaft 8e9e05c52164694d [peers: [], term: 2, commit: 4, applied: 0, lastindex: 4, lastterm: 2]\r\n2019-05-21 17:33:57.340926 W | auth: simple token is not cryptographically signed\r\n2019-05-21 17:33:57.342299 I | etcdserver: starting server... [version: 3.3.13, cluster version: to_be_decided]\r\n2019-05-21 17:33:57.344222 I | etcdserver/membership: added member 8e9e05c52164694d [http://localhost:2380] to cluster cdf818194e3a8c32\r\n2019-05-21 17:33:57.344395 N | etcdserver/membership: set the initial cluster version to 3.3\r\n2019-05-21 17:33:57.344492 I | etcdserver/api: enabled capabilities for version 3.3\r\n2019-05-21 17:33:58.738818 I | raft: 8e9e05c52164694d is starting a new election at term 2\r\n2019-05-21 17:33:58.738866 I | raft: 8e9e05c52164694d became candidate at term 3\r\n2019-05-21 17:33:58.738916 I | raft: 8e9e05c52164694d received MsgVoteResp from 8e9e05c52164694d at term 3\r\n2019-05-21 17:33:58.738945 I | raft: 8e9e05c52164694d became leader at term 3\r\n2019-05-21 17:33:58.738960 I | raft: raft.node: 8e9e05c52164694d elected leader 8e9e05c52164694d at term 3\r\n2019-05-21 17:33:58.741399 I | etcdserver: published {Name:default ClientURLs:[http://localhost:2379]} to cluster cdf818194e3a8c32\r\n2019-05-21 17:33:58.743342 I | embed: ready to serve client requests\r\n2019-05-21 17:33:58.744298 N | embed: serving insecure client requests on 127.0.0.1:2379, this is strongly discouraged!\r\n```","closed_by":{"login":"xiang90","id":4479947,"node_id":"MDQ6VXNlcjQ0Nzk5NDc=","avatar_url":"https://avatars.githubusercontent.com/u/4479947?v=4","gravatar_id":"","url":"https://api.github.com/users/xiang90","html_url":"https://github.com/xiang90","followers_url":"https://api.github.com/users/xiang90/followers","following_url":"https://api.github.com/users/xiang90/following{/other_user}","gists_url":"https://api.github.com/users/xiang90/gists{/gist_id}","starred_url":"https://api.github.com/users/xiang90/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xiang90/subscriptions","organizations_url":"https://api.github.com/users/xiang90/orgs","repos_url":"https://api.github.com/users/xiang90/repos","events_url":"https://api.github.com/users/xiang90/events{/privacy}","received_events_url":"https://api.github.com/users/xiang90/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/etcd-io/etcd/issues/10747/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/etcd-io/etcd/issues/10747/timeline","performed_via_github_app":null,"state_reason":"completed"}