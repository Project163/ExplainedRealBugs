{"url":"https://api.github.com/repos/etcd-io/etcd/issues/11013","repository_url":"https://api.github.com/repos/etcd-io/etcd","labels_url":"https://api.github.com/repos/etcd-io/etcd/issues/11013/labels{/name}","comments_url":"https://api.github.com/repos/etcd-io/etcd/issues/11013/comments","events_url":"https://api.github.com/repos/etcd-io/etcd/issues/11013/events","html_url":"https://github.com/etcd-io/etcd/issues/11013","id":479044454,"node_id":"MDU6SXNzdWU0NzkwNDQ0NTQ=","number":11013,"title":"ValidateClusterAndAssignIDs() fails due to sorting URLs lexicographically before comparison","user":{"login":"dbavatar","id":14057304,"node_id":"MDQ6VXNlcjE0MDU3MzA0","avatar_url":"https://avatars.githubusercontent.com/u/14057304?v=4","gravatar_id":"","url":"https://api.github.com/users/dbavatar","html_url":"https://github.com/dbavatar","followers_url":"https://api.github.com/users/dbavatar/followers","following_url":"https://api.github.com/users/dbavatar/following{/other_user}","gists_url":"https://api.github.com/users/dbavatar/gists{/gist_id}","starred_url":"https://api.github.com/users/dbavatar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dbavatar/subscriptions","organizations_url":"https://api.github.com/users/dbavatar/orgs","repos_url":"https://api.github.com/users/dbavatar/repos","events_url":"https://api.github.com/users/dbavatar/events{/privacy}","received_events_url":"https://api.github.com/users/dbavatar/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2019-08-09T15:27:59Z","updated_at":"2019-09-14T00:42:39Z","closed_at":"2019-09-14T00:42:39Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"In order to validate peer urls, the current code first sorts existing and local members lexicographically BEFORE attempting to compare their resolved IP addresses. This leads to weird behavior where changing the hostname (say due to unique pod identifiers) can cause the sort order to change, leading to random validation failure for no obvious reason.\r\n\r\nThe correct behavior would be to resolve URLs to IP addresses before sort+compare, or less efficiently try to compare every possible combination of URLs until there are none left.\r\n\r\n","closed_by":{"login":"xiang90","id":4479947,"node_id":"MDQ6VXNlcjQ0Nzk5NDc=","avatar_url":"https://avatars.githubusercontent.com/u/4479947?v=4","gravatar_id":"","url":"https://api.github.com/users/xiang90","html_url":"https://github.com/xiang90","followers_url":"https://api.github.com/users/xiang90/followers","following_url":"https://api.github.com/users/xiang90/following{/other_user}","gists_url":"https://api.github.com/users/xiang90/gists{/gist_id}","starred_url":"https://api.github.com/users/xiang90/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xiang90/subscriptions","organizations_url":"https://api.github.com/users/xiang90/orgs","repos_url":"https://api.github.com/users/xiang90/repos","events_url":"https://api.github.com/users/xiang90/events{/privacy}","received_events_url":"https://api.github.com/users/xiang90/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/etcd-io/etcd/issues/11013/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/etcd-io/etcd/issues/11013/timeline","performed_via_github_app":null,"state_reason":"completed"}