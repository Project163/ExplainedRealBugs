diff --git a/fixtures/bugs/1214/fixture-1214-2.yaml b/fixtures/bugs/1214/fixture-1214-2.yaml
new file mode 100644
index 00000000..2ea8dda6
--- /dev/null
+++ b/fixtures/bugs/1214/fixture-1214-2.yaml
@@ -0,0 +1,17 @@
+swagger: '2.0'
+
+info:
+  version: "1.0.0"
+  title: ordering security requirements
+  description: verify that generated code keeps a stable order of security requirements
+produces:
+  - application/json
+consumes:
+  - application/json
+paths:
+  /nosec:
+    get:
+      operationId: nosecOp
+      description: no description
+      responses:
+        default:
diff --git a/fixtures/bugs/1214/fixture-1214.yaml b/fixtures/bugs/1214/fixture-1214.yaml
new file mode 100644
index 00000000..a3605873
--- /dev/null
+++ b/fixtures/bugs/1214/fixture-1214.yaml
@@ -0,0 +1,76 @@
+swagger: '2.0'
+
+info:
+  version: "1.0.0"
+  title: ordering security requirements
+  description: verify that generated code keeps a stable order of security requirements
+produces:
+  - application/json
+consumes:
+  - application/json
+securityDefinitions:
+  A:
+    type: basic
+  B:
+    type: apiKey
+    name: K1
+    in: header
+  C:
+    type: apiKey
+    name: K2
+    in: query
+  D: 
+    type: apiKey
+    name: K3
+    in: query
+  E:
+    type: oauth2
+    authorizationUrl: https://fake.example.com/authorize
+    tokenUrl: https://fake.example.com/token
+    flow: accessCode
+    scopes: 
+      s0: ''
+      s1: '' 
+      s2: ''   
+      s3: '' 
+      s4: '' 
+      s5: '' 
+      s6: '' 
+      s7: '' 
+      s8: '' 
+      s9: '' 
+security:
+  - A: []
+    B: []
+    E: [s0, s1,s2,s3,s4]
+  - C: []
+    D: []
+    E: [s5, s6,s7,s8,s9]
+paths:
+  /asec:
+    get:
+      operationId: asecOp
+      description: no description
+      responses:
+        default:
+          description: Generic Out
+  /bsec:
+    get:
+      security:
+        - A: []
+          E: [s0, s1,s2,s3,s4]
+        - D: []
+          E: [s5, s6,s7,s8,s9]
+      operationId: bsecOp
+      description: no description
+      responses:
+        default:
+          description: Generic Out
+  /csec:
+    get:
+      security: []
+      operationId: csecOp
+      description: no description
+      responses:
+        default:
+          description: Generic Out
diff --git a/generator/bindata.go b/generator/bindata.go
index a1869297..0d7c2dc4 100644
--- a/generator/bindata.go
+++ b/generator/bindata.go
@@ -376,7 +376,7 @@ func templatesServerBuilderGotmpl() (*asset, error) {
 	return a, nil
 }
 
-var _templatesServerConfigureapiGotmpl = []byte("\x1f\x8b\x08\x00\x00\x00\x00\x00\x00\xff\xc4\x58\x4b\x6f\x1b\xb7\xf6\x5f\xff\xf5\x29\x0e\x06\xf9\x03\x52\x20\x8d\x80\x2e\x03\x78\xe1\xeb\xa4\xa9\x71\x93\x5a\xa8\x8c\xdb\x45\xd1\x05\xc5\x39\x1a\xf1\x9a\x43\xb2\x24\x27\xb6\x3a\x98\xef\x7e\x71\x48\xce\xcb\x92\x1c\x27\x59\x74\x25\x0d\xcf\x93\x3f\x9e\x17\xb9\x5e\xc3\xfd\x41\x38\xd8\x0b\x89\x20\x1c\x38\xb6\x47\xf0\x1a\xb0\x10\x3e\x87\x3b\xc5\x11\x84\x07\x7c\x12\xce\x3b\xfa\xf7\x28\xa4\x04\xa5\x3d\xec\x10\xf4\x17\xb4\x8f\x56\x78\x8f\x6a\x36\x9b\x35\x0d\x88\x3d\xe4\x37\xda\x1c\xad\x28\x0f\x1e\x56\x6d\xbb\x5e\x43\xd3\x00\xd7\x55\x85\xca\x3f\xa3\x35\x0d\xa0\x2a\xa0\x6d\x67\xb3\x99\x61\xfc\x81\x95\x48\xcc\xf9\xf5\xe6\x76\x93\x3e\x89\x26\x2a\xa3\xad\x87\xf9\x0c\x20\xe3\xf6\x68\xbc\x5e\x7b\xe9\x32\xfa\x54\xe8\xd7\x07\xef\x4d\xf8\x90\xba\xcc\x66\x33\x00\xb4\x56\x5b\x07\x59\x29\xfc\xa1\xde\xe5\x5c\x57\xeb\x52\xaf\xb4\x41\xc5\x8c\x58\x47\x2a\x09\xd8\x5a\x79\x51\xe1\x25\xc6\x44\x26\xce\x4a\x14\x85\xc4\x47\x66\xbf\xc6\xbc\x1e\x38\x49\xce\x21\xaf\xad\xf0\xc7\xaf\x49\x75\x7c\x24\x53\x5a\xc6\x71\x5f\xcb\x89\x8c\x3f\x4a\xb4\xbb\x75\x47\x0b\xdb\x2d\xb5\x64\xaa\xcc\xb5\x2d\xd7\x4f\x6b\x02\x82\x6b\xe5\xf1\xc9\x07\x0c\x9a\xc6\x32\x55\x22\xe4\xef\x71\xcf\x6a\xe9\x6f\x03\x86\x8e\x30\x37\x56\x28\xbf\x87\xec\xff\xff\xca\x20\x6f\xdb\xc0\x8c\xaa\x48\xff\xa2\xd8\x9b\x07\x3c\x2e\xe1\xcd\x17\x26\x6b\x84\x77\x57\x90\x8f\xe4\x89\xd6\xb6\x74\x50\x63\x4d\x91\x77\xa2\x6e\x41\x01\xf1\xa6\x3b\x58\xd2\x32\x3e\xd5\xa6\x81\x47\xe1\x0f\x90\x7f\x44\x75\x67\xbc\xa3\xc5\xf5\xba\xd4\xef\x4a\x54\x68\x99\x47\x70\x8f\xac\x2c\xd1\xc2\xb0\x80\xf6\x0b\x5a\x58\xad\x3c\xb3\x25\xfa\x10\x2b\xf7\xe1\xef\x86\xf9\x03\xb4\x2d\xac\x56\x8a\x55\x31\x88\x7e\xa5\x3f\x61\xc9\x19\xe4\x61\x69\x6b\x90\x27\xce\x59\xd3\xac\x42\xb0\x4e\x62\x2d\x06\xb0\xc2\xc9\x72\xa6\x0d\x99\x17\x5a\xb9\x2c\x2a\x64\x46\xac\x2e\xc6\x6b\x1f\xd4\x43\x74\x77\xb6\x3e\xeb\x02\xe5\x39\x6b\x13\x42\x56\xd1\x57\x67\x2b\x7c\x4c\xac\x9d\x6a\xb9\x64\x6f\x1b\xf0\x3a\x67\x70\x4a\xc9\x2c\x3a\xcf\x8c\xc8\x22\x5c\x81\x36\x31\x79\x46\xd1\x25\x9b\x37\x52\xa0\xf2\xe7\x6c\x4e\x29\x19\x0f\x9f\x69\x97\xf1\x63\x62\xf3\x8c\xa2\x4b\x36\xef\xb1\x32\x92\x79\x7c\x2f\x6c\x54\xe7\xd3\xc2\xaa\x10\x36\x46\xc9\x84\x63\xaa\x21\x25\xca\x5d\x7f\xca\x51\x47\x7f\xea\x41\xc1\x25\xa9\x7b\x56\x26\x7e\x4f\xff\xce\xb2\x92\x8b\x1b\x2b\x14\x17\x86\xc9\xc8\x6c\xfa\x4f\x92\x18\x13\x4f\x45\x53\x06\x6f\xf9\x01\xab\x29\xa2\x53\x4a\x16\x0a\x61\xd4\x5f\x44\xca\xca\x45\x12\x19\x39\xa3\xe6\x1c\x9e\x69\x5f\x21\xc8\xdc\x28\x04\x2f\x6e\x4d\x5b\x98\x53\x37\xc8\x6f\x15\x97\x75\x81\x41\x72\x31\x5d\xfb\x0f\x93\xa2\x60\x5e\xdb\x45\xca\xc8\x07\x61\xa2\x5a\xf7\x55\x7d\xbf\x30\x55\x48\xb4\xcf\x34\x6e\x98\x65\x15\x7a\xb4\x0e\x9e\x51\x7e\x43\x67\xb4\x72\xe8\xc6\xb6\x86\x14\x3e\xb1\x37\x96\xdd\xd6\x26\xb4\x9a\x41\xd0\xc5\x95\x17\xa5\x3e\x33\xa1\xa2\x08\x3e\x85\x85\x55\xc5\x84\x3a\x3d\xc8\x0f\x91\x4a\x55\x68\xca\x4e\x05\xea\xcc\xb9\xd7\x95\x79\xcf\x3c\x4b\x27\x5a\x57\x66\x55\x30\xcf\x4e\x19\x7f\x17\xfe\x70\x13\x6b\x7f\xe4\xa5\xba\xba\x4a\xdd\x60\xcc\xde\xfd\xdb\xd7\x8a\x03\xd7\x6a\x2f\xca\xda\xe2\xcf\x92\x95\x6e\xce\x8c\x80\xb7\x4d\xd3\x95\xe8\xb6\xcd\xa9\xc0\x33\xc7\x99\x14\x7f\x63\x5f\x4e\xaf\x37\xb7\x0b\x68\x66\x00\xeb\x35\x30\x23\xf2\x1b\x5d\x55\x4c\x15\x9f\x84\xc2\x3b\x13\x00\xfe\x68\x75\x6d\x1c\x5c\xc1\x1f\x7f\x52\x01\xbf\xc4\xd1\x40\x9e\xe7\xd0\xce\xda\xd9\x33\x77\xae\x37\xb7\xdf\xe4\x0c\x45\x7d\x9e\x82\xa4\xf3\xac\x57\x06\xfe\x80\xe4\x27\x1c\xd0\xe2\x0c\x82\xcb\xa1\x98\x7d\xa0\x29\x00\xae\xd2\xac\x30\x5a\x9b\x45\x0d\x5b\xf4\x70\xd4\xb5\x05\x5e\x3b\xaf\x2b\x90\x3a\xb4\xa2\x90\x78\x58\x60\x91\x43\xca\x27\xd0\x2a\x4c\x4d\x52\x97\x21\x8f\xfd\x3e\x2a\xf8\xf0\x64\x90\x7b\x2c\x40\x28\x8f\x76\xcf\x38\x02\xed\x73\xee\xbc\x15\xaa\x5c\xd2\xee\x7b\x4a\xd3\x2e\x82\x50\x27\xc9\x2a\x23\xf1\xdd\x00\xf2\xa7\x68\xfc\x6a\x6c\x24\xf4\xd9\x2e\x5b\x6f\xb4\x72\x75\x85\xae\xaf\x0e\xd4\xaf\x25\xd2\xc8\x15\x4b\x58\xdb\x92\x9e\xb3\x20\x26\x59\x52\x4f\x29\x7e\x22\x18\x1b\xba\x74\xf8\x3a\x1d\x69\xa4\xe9\x5c\xb2\x3f\xd3\xa6\xc3\xce\x2d\x08\x9d\xff\x86\xac\x40\xbb\x84\xd4\xc1\xc7\x10\xc4\xb3\x08\x47\x08\x60\xd1\xd7\x56\x75\xc7\xf3\xab\xf6\xbd\x5f\x58\xcc\xb3\xa6\x09\x96\xdb\x96\x4e\x3a\x5a\x3e\x30\x17\x92\xf2\x88\x34\x98\xa2\x02\x31\x08\x64\x04\x6f\xbb\x18\x8f\x39\xc3\xbf\x0e\xc3\x8d\xd5\x45\xcd\xbf\x0f\xc3\x24\xfb\x43\x18\x8e\x74\x74\x18\x76\x4b\x03\x86\x8f\x84\xe1\xef\x56\x78\xc2\x90\xaa\xc1\x8f\x23\x68\x3a\xbb\xdf\x8d\x60\x02\x70\x9b\x86\xd8\xf7\xb8\x17\x4a\x84\x4c\x4f\x0c\x01\x4c\xf7\x2f\xe6\x04\xbf\xae\xfd\x21\xac\xae\xd7\x70\x6d\x8c\x14\xe8\xe0\xf1\x80\x2a\x24\x2a\x11\xb5\x15\x7f\x47\xd8\x0e\x21\x54\xc2\x8d\x04\x7d\x9c\x15\x89\x29\xa8\x81\xd8\xd8\x52\x46\x4f\xf1\xbc\x7d\x4f\xa5\xa1\xf6\x07\xb8\x8a\x29\x57\x3b\xb4\xd0\xe5\x9d\x61\xce\xa5\x8f\x05\xcc\x83\x6f\xb4\xe9\x39\xe0\x5f\xe3\x46\x9c\x8d\x70\xcd\x60\xd1\xb6\x6f\x47\xfd\x72\xe0\x6b\xdb\x65\x44\x78\x31\x45\x5d\x09\xb9\xbc\x04\xfd\x2e\x6c\x80\x91\x83\xe4\x40\x72\x78\xf1\x0a\xfc\x07\xdc\x3b\x4c\xaf\x37\xb7\xff\xc6\xe3\x8b\xa0\x66\xa3\x61\x38\x8b\xd3\x9c\xae\x2d\x0f\xb3\x71\xc4\xf6\x75\x28\x7a\xfd\x80\xea\x9f\x45\x8e\x0a\xf9\x03\x1e\x23\x76\x63\xe8\x86\x68\xde\x5b\x5d\xd1\x67\xdc\x23\x85\x37\x0d\x0a\xf0\xc7\x08\x84\x3f\xbf\x0b\xe9\x3b\xc2\xe2\xa7\x80\xf2\x37\x82\xb5\x04\xc7\xb5\x41\x47\x0d\xf1\x9f\x44\x4f\x13\x6c\x3f\xc1\x0e\x99\x45\x7b\x8a\xe1\xb7\x80\xf2\xec\x5f\xbc\x6b\x9c\xcf\xfe\x33\xbd\x94\xa5\x34\x7f\xb1\x9f\x76\x57\xe2\xbc\x2b\x0a\x58\xcc\x17\x17\x5b\x6b\x57\x31\x7b\x66\xfb\x62\x43\xbd\xde\xdc\x0e\x9c\x70\x75\xd1\xd8\x99\x2a\x37\x5c\x13\xba\x5a\x9e\x86\xf1\xee\xa6\xd2\x5d\x78\xc3\x55\x7b\x08\x91\xcd\xb0\x9a\xe2\xea\x4c\x0f\xe8\xc6\x18\x6a\x23\x5f\x1b\x7e\x12\xef\xd0\x1b\x52\xd7\x9a\x4e\x83\xdc\x3f\x41\x9a\x04\xf3\xb4\xba\x84\x3e\xa4\x42\x72\xb8\x57\x18\x0b\xe3\xb6\x8b\x27\x3d\x60\x44\x51\x38\xbe\xc9\xfc\x68\x4c\x27\x68\x16\xa3\xf7\x96\x3c\x8e\xf3\x05\x3e\x6b\x6b\x23\x8e\x93\x38\x1f\x5d\xdc\x5e\x38\x9b\xd3\x23\xc9\x27\x07\x96\x0a\xca\x2b\xba\xe2\x28\x50\xc6\x23\xa6\xdd\x1e\x6a\x5f\xe8\x47\xd5\x15\x85\x05\x34\x94\x45\xb3\x7e\x13\x0e\x7d\x6d\x3e\x4a\xbd\x63\xf2\x73\xbf\x9f\x79\xaf\x60\x1e\xe8\x03\xc5\x2d\x16\x34\x2e\x87\xf7\x3a\x84\xfb\x4f\xdb\x7e\xce\x8d\xdb\xdd\xe1\x5e\x5b\x84\x5f\xee\xef\x37\xdb\xee\xad\xc4\x79\x66\xbd\xcb\x9f\xcd\xd8\xf7\x9f\xb6\x73\x2f\xdd\x4d\xf8\x86\xb7\x5e\xba\x3c\xfe\xef\x67\xfb\xcf\xec\x01\x81\x49\x09\x0a\x39\x3a\xc7\xec\x11\xf8\x81\x32\xc0\x81\xd7\xa1\xaf\x9c\xda\xa7\x19\x3b\x4f\x1e\x5e\x3b\x70\x5a\x2b\x60\xae\xf3\x44\x38\x08\x85\x21\xc0\x5b\xc0\xae\xf6\x01\x57\x5b\x2b\xc2\x76\x09\x3e\xbc\x41\xd6\x8a\x07\x5d\xe1\x91\x71\x87\xc0\x99\x94\x58\xe4\xa4\xf2\x76\x4f\x55\x24\xd4\x0b\xf2\xa1\xd2\x85\xd8\x1f\x81\x25\x27\x96\xe0\x3c\xed\xbe\xb3\xa6\x9c\x67\x8a\x87\x87\x4c\xe7\xb5\x01\x41\xc3\x66\x21\xbe\x88\xa2\x66\x52\x1e\x41\xb2\x30\x43\x05\xab\xc2\x85\x1d\x19\xc9\x38\xe6\xb3\xfe\x3d\xb4\xf3\x85\x33\x35\xb8\x02\x55\x2d\xbd\x30\x12\x81\x0a\x8e\x5b\x42\x81\x06\x55\x21\x54\x09\x3a\x36\x5c\x55\x57\x3b\xb4\xa0\xf7\xc1\x17\x22\xc4\x61\xc5\x05\xd5\xe9\x46\x1e\x5f\xd6\xba\x5d\xd2\x80\xc3\x38\xd7\x96\xf4\xc8\xe3\xbb\x74\x97\x5f\xc6\x5f\x97\xd1\xa5\x38\xab\x95\x78\xca\x9e\x1d\x64\x0c\xb4\xb9\x83\xb7\xdd\xd3\x60\x8a\xbd\x65\x32\xb4\x04\x56\x14\xb6\x6f\xdb\xcd\x28\x80\x46\x8f\x9a\xd3\x73\xa4\xbd\x6b\x1b\xf6\x72\x48\x05\x09\x9f\x90\xd7\x9e\xba\x0a\x89\x3a\x84\x42\x87\xd3\x63\xc6\xc8\x63\x17\x11\xe9\xbd\x2e\xff\xaf\xd3\x0a\x0a\xcd\x6b\xca\x92\xfc\x8c\xb9\xa8\x0d\x1d\xb0\xbd\x47\x0b\x56\xd7\x9e\x60\xa2\x90\x48\x31\x4c\x2d\x02\x95\x17\x3c\x78\xb4\x84\x9d\x88\x10\x33\x55\x10\x74\xa2\x08\xeb\x11\x8c\xe7\x59\x32\xef\x9c\x1e\xdf\x0c\x4f\xee\x89\xff\x97\x72\x30\x31\xbf\x06\x97\x03\x33\x06\x95\xeb\x7d\x54\x47\x7f\x08\xfd\x3d\x04\xd1\x48\x8c\x49\xa7\x03\x34\x22\xa6\x4b\x17\x07\x2f\x83\xb4\xd5\x7d\x34\x32\x28\xb5\x2e\x62\x40\x92\x02\x23\xeb\x12\x84\x02\x06\x86\x29\xc1\xa3\xd3\xa4\x71\x30\xba\x0c\x57\xd4\x0e\xa3\x0a\xbd\x15\xdc\x8d\x00\x3a\x29\x33\xdf\x89\xd2\xff\x02\x00\x00\xff\xff\xb5\x5b\x70\xa4\x2e\x18\x00\x00")
+var _templatesServerConfigureapiGotmpl = []byte("\x1f\x8b\x08\x00\x00\x00\x00\x00\x00\xff\xc4\x58\x4b\x8f\xdb\x38\x12\x3e\xaf\x7f\x45\x41\xc8\x02\x76\x60\xcb\xc0\x1e\x03\xf4\xa1\xb7\x93\xc9\x18\x9b\x4c\x1b\xe3\xc6\xce\x61\x30\x07\x9a\x2a\xcb\xdc\xa6\x48\x0e\x49\xa5\xdb\x23\xe8\xbf\x2f\x8a\xa4\x64\xc9\x8f\x4e\x27\x39\xcc\xc9\x26\x59\xcf\x8f\xf5\xa2\x96\x4b\x78\xd8\x0b\x07\x3b\x21\x11\x84\x03\xc7\x76\x08\x5e\x03\x16\xc2\xe7\x70\xaf\x38\x82\xf0\x80\xcf\xc2\x79\x47\xff\x9e\x84\x94\xa0\xb4\x87\x2d\x82\xfe\x82\xf6\xc9\x0a\xef\x51\x4d\x26\x93\xa6\x01\xb1\x83\xfc\x4e\x9b\x83\x15\xe5\xde\xc3\xa2\x6d\x97\x4b\x68\x1a\xe0\xba\xaa\x50\xf9\x93\xb3\xa6\x01\x54\x05\xb4\xed\x64\x32\x31\x8c\x3f\xb2\x12\x89\x38\xbf\x5d\xaf\xd6\x69\x49\x67\xa2\x32\xda\x7a\x98\x4e\x00\x32\x6e\x0f\xc6\xeb\xa5\x97\x2e\xa3\xa5\x42\xbf\xdc\x7b\x6f\xc2\x42\xea\x32\x9b\x4c\x00\xd0\x5a\x6d\x1d\x64\xa5\xf0\xfb\x7a\x9b\x73\x5d\x2d\x4b\xbd\xd0\x06\x15\x33\x62\x19\x4f\x89\xc1\xd6\xca\x8b\x0a\xaf\x11\xa6\x63\xa2\xac\x44\x51\x48\x7c\x62\xf6\x6b\xc4\xcb\x23\x25\xf1\x39\xe4\xb5\x15\xfe\xf0\x35\xae\x8e\x8e\x78\x4a\xcb\x38\xee\x6a\x39\xe2\xf1\x07\x89\x76\xbb\xec\xce\x82\xbb\xa5\x96\x4c\x95\xb9\xb6\xe5\xf2\x79\x49\x40\x70\xad\x3c\x3e\xfb\x80\x41\xd3\x58\xa6\x4a\x84\xfc\x3d\xee\x58\x2d\xfd\x2a\x60\xe8\x08\x73\x63\x85\xf2\x3b\xc8\xfe\xf9\x67\x06\x79\xdb\x06\x62\x54\x45\xfa\x17\xd9\xde\x3c\xe2\x61\x0e\x6f\xbe\x30\x59\x23\xbc\xbb\x81\x7c\xc0\x4f\x67\x6d\x4b\x17\x35\x94\x14\x69\x47\xe2\x66\x14\x10\x6f\xba\x8b\x25\x29\xc3\x5b\x6d\x1a\x78\x12\x7e\x0f\xf9\x47\x54\xf7\xc6\x3b\xda\x5c\x2e\x4b\xfd\xae\x44\x85\x96\x79\x04\xf7\xc4\xca\x12\x2d\x1c\x37\xd0\x7e\x41\x0b\x8b\x85\x67\xb6\x44\x1f\x62\xe5\x21\xfc\x5d\x33\xbf\x87\xb6\x85\xc5\x42\xb1\x2a\x06\xd1\x2f\xf4\x27\x6c\x39\x83\x3c\x6c\x6d\x0c\xf2\x44\x39\x69\x9a\x45\x08\xd6\x51\xac\xc5\x00\x56\x38\xda\xce\xb4\x21\xf5\x42\x2b\x97\x45\x81\xcc\x88\xc5\xd5\x78\xed\x83\xfa\x18\xdd\x9d\xae\xcf\xba\x40\x79\x49\xdb\xe8\x20\xab\x68\xd5\xe9\x0a\x8b\x91\xb6\x73\x29\xd7\xf4\x6d\x02\x5e\x97\x14\x8e\x4f\x32\x8b\xce\x33\x23\xb2\x08\x57\x38\x1b\xa9\xbc\x20\xe8\x9a\xce\x3b\x29\x50\xf9\x4b\x3a\xc7\x27\x19\x0f\xcb\xe4\x65\x5c\x8c\x74\x5e\x10\x74\x4d\xe7\x03\x56\x46\x32\x8f\xef\x85\x8d\xe2\x7c\xda\x58\x14\xc2\xc6\x28\x19\x51\x8c\x25\xa4\x44\xb9\xef\x6f\x39\xca\xe8\x6f\x3d\x08\xb8\xc6\xf5\xc0\xca\x44\xef\xe9\xdf\x45\x52\x32\x71\x6d\x85\xe2\xc2\x30\x19\x89\x4d\xbf\x24\x8e\xe1\xe1\x39\x6b\xca\xe0\x0d\xdf\x63\x35\x46\x74\x7c\x92\x85\x42\x18\xe5\x17\xf1\x64\xe1\xe2\x11\x29\xb9\x20\xe6\x12\x9e\xc9\xaf\x10\x64\x6e\x10\x82\x57\x5d\xd3\x16\xa6\xd4\x0d\xf2\x95\xe2\xb2\x2e\x30\x70\xce\xc6\x7b\xff\x65\x52\x14\xcc\x6b\x3b\x4b\x19\xf9\x28\x4c\x14\xeb\xbe\x2a\xef\x67\xa6\x0a\x89\xf6\x44\xe2\x9a\x59\x56\xa1\x47\xeb\xe0\xe4\xe4\x57\x74\x46\x2b\x87\x6e\xa8\xeb\x98\xc2\x67\xfa\x86\xbc\x9b\xda\x84\x56\x73\x64\x74\x71\xe7\x45\xae\xcf\x4c\xa8\xc8\x82\xcf\x61\x63\x51\x31\xa1\xce\x2f\xf2\x43\x3c\xa5\x2a\x34\x26\xa7\x02\x75\xe1\xde\xeb\xca\xbc\x67\x9e\xa5\x1b\xad\x2b\xb3\x28\x98\x67\xe7\x84\xbf\x09\xbf\xbf\x8b\xb5\x3f\xd2\x52\x5d\x5d\xa4\x6e\x30\x24\xef\xfe\xed\x6a\xc5\x81\x6b\xb5\x13\x65\x6d\xf1\x27\xc9\x4a\x37\x65\x46\xc0\xdb\xa6\xe9\x4a\x74\xdb\xe6\x54\xe0\x99\xe3\x4c\x8a\xbf\xb0\x2f\xa7\xb7\xeb\xd5\x0c\x9a\x09\xc0\x72\x09\xcc\x88\xfc\x4e\x57\x15\x53\xc5\x27\xa1\xf0\xde\x04\x80\x3f\x5a\x5d\x1b\x07\x37\xf0\xfb\x1f\x54\xc0\xaf\x51\x34\x90\xe7\x39\xb4\x93\x76\x72\x62\xce\xed\x7a\xf5\x4d\xc6\x50\xd4\xe7\x29\x48\x3a\xcb\x7a\x61\xe0\xf7\x48\x76\xc2\x1e\x2d\x4e\x20\x98\x1c\x8a\xd9\x07\x9a\x02\xe0\x26\xcd\x0a\x83\xbd\x49\x94\xb0\x41\x0f\x07\x5d\x5b\xe0\xb5\xf3\xba\x02\xa9\x43\x2b\x0a\x89\x87\x05\x16\x39\xa4\x7c\x02\xad\xc2\xd4\x24\x75\x19\xf2\xd8\xef\xa2\x80\x0f\xcf\x06\xb9\xc7\x02\x84\xf2\x68\x77\x8c\x23\x90\x9f\x53\xe7\xad\x50\xe5\x9c\xbc\xef\x4f\x9a\x76\x16\x98\x3a\x4e\x56\x19\x89\xef\x8e\x20\x7f\x8a\xca\x6f\x86\x4a\x42\x9f\xed\xb2\xf5\x4e\x2b\x57\x57\xe8\xfa\xea\x40\xfd\x5a\x22\x8d\x5c\xb1\x84\xb5\x2d\xc9\xb9\x08\x62\xe2\x25\xf1\x94\xe2\x67\x8c\xb1\xa1\x4b\x87\xaf\x93\x91\x46\x9a\xce\x24\xfb\x13\x39\x1d\x3c\xb7\x20\x74\xfe\x2b\xb2\x02\xed\x1c\x52\x07\x1f\x42\x10\xef\x22\x5c\x21\x80\x45\x5f\x5b\xd5\x5d\xcf\x2f\xda\xf7\x76\x61\x31\xcd\x9a\x26\x68\x6e\x5b\xba\xe9\xa8\x79\xcf\x5c\x48\xca\x03\xd2\x60\x8a\x0a\xc4\x91\x21\x23\x78\xdb\xd9\x70\xcc\x39\xfe\xeb\x30\x5c\x5b\x5d\xd4\xfc\xfb\x30\x4c\xbc\x3f\x84\xe1\x40\x46\x87\x61\xb7\x75\xc4\xf0\x89\x30\xfc\xcd\x0a\x4f\x18\x52\x35\xf8\x71\x04\x4d\xa7\xf7\x87\x11\xdc\xa4\x29\xf6\x3d\xee\x84\x12\x5d\x2b\x0d\xc6\x74\xa5\x6a\xe5\xfe\xcd\x9c\xe0\xb7\x75\x1c\xc2\x42\x84\xdf\x1a\x23\x05\x3a\x78\xda\xa3\x0a\xf9\x4a\xa7\xda\x8a\xbf\x22\x7a\xfb\x10\x31\xe1\x61\x82\x3e\x8e\x8c\x44\x14\xe4\x40\xec\x6f\x29\xb1\xc7\xb0\xae\xde\x53\x85\x20\x45\x37\x31\xf3\x6a\x87\x16\xba\xf4\x33\xcc\xb9\xb4\x98\xc1\xb4\x69\x52\x49\x9f\x02\xfe\x39\xec\xc7\xd9\x00\xde\x0c\x66\x6d\xfb\x76\xd0\x36\x8f\x74\x6d\x3b\x8f\x40\xcf\xc6\xe0\x2b\x21\xe7\xd7\x6e\x60\x1b\x1c\x60\x64\x20\x19\x90\x0c\x9e\xbd\xe2\x1a\x7a\x44\x29\xa2\x12\xac\xb7\xeb\xd5\x7f\xf0\xf0\x32\xae\xd9\x60\x2c\xce\xe2\x5c\xa7\x6b\xcb\xc3\x94\x1c\xe1\x7d\x1d\x90\x5e\x3f\xa2\xfa\x7b\xc1\xa3\x92\xfe\x88\x87\x08\xdf\x10\xbd\x63\x5c\xef\xac\xae\x68\x19\x7d\xa4\x40\xa7\x91\x01\x7e\x1f\x80\xf0\xc7\x77\x82\x7d\x4f\x68\xfc\x2b\x02\xfd\x8d\x78\xcd\xc1\x71\x6d\xd0\x51\x77\xfc\x3b\x01\xd4\x2c\xb8\xb0\x45\x66\xd1\x9e\xc3\xf8\x2d\xb8\xc4\x99\xe2\xc2\x22\x3e\x41\x2e\xd6\x84\xcb\x4d\x96\xa5\xc4\x7f\xb1\xd1\x76\x6f\xe5\xbc\x2b\x13\x58\x4c\x67\x57\x7b\x6e\x57\x4a\x7b\x62\xfb\x62\xa7\xbd\x5d\xaf\x8e\x94\x70\x73\x55\xd9\x89\xaf\x67\x4f\x88\xae\xce\xa7\x41\xbd\x7b\xc5\x74\x8f\xe1\xf0\x0c\x3f\x46\xcc\xfa\xb8\x1b\xaa\xea\xc5\xfe\xd0\x8d\x38\xd4\x62\xbe\x36\x18\x25\xda\x63\xdf\x48\x1d\x6d\x3c\x29\x72\xff\x0c\x69\x4a\xcc\xd3\xee\x1c\xfa\x08\x0b\xe9\xe2\x5e\xa1\x2c\x8c\xe2\x2e\xf8\x3a\x80\x89\x82\x72\xf8\xca\xf9\xd1\x10\x4f\xd0\xcc\x06\xdf\x62\xf2\x38\xea\x17\x78\xd2\xf2\x06\x14\x67\x61\x3f\x78\xd4\xbd\x70\x37\xe7\x57\x92\x8f\x2e\x2c\x95\x98\x57\x74\xcc\x41\xab\x1c\x8e\x9f\x76\xb3\xaf\x7d\xa1\x9f\x54\x57\x23\x66\xd0\x50\x52\x4d\x7a\x27\x1c\xfa\xda\x7c\x94\x7a\xcb\xe4\xe7\xde\x9f\x69\x2f\x60\x1a\xce\x8f\x27\x6e\x36\xa3\x51\x3a\x7c\xcb\x43\x78\xf8\xb4\xe9\x67\xe0\xe8\xee\x16\x77\xda\x22\xfc\xfc\xf0\xb0\xde\x74\xdf\x51\x9c\x67\xd6\xbb\xfc\x64\xfe\x7e\xf8\xb4\x99\x7a\xe9\xee\xc2\x1a\xde\x7a\xe9\xf2\xf8\xbf\x9f\xfb\x3f\xb3\x47\x04\x26\x25\x28\xe4\xe8\x1c\xb3\x07\xe0\x7b\xca\x00\x07\x5e\x87\x4e\x73\xae\x9f\xe6\xef\x3c\x59\x78\xeb\xc0\x69\xad\x80\xb9\xce\x12\xe1\x20\x54\x87\x00\x6f\x01\xdb\xda\x07\x5c\x6d\xad\x08\xdb\x39\xf8\xf0\x7d\xb2\x56\x3c\xc8\x0a\x1f\x20\xb7\x08\x9c\x49\x89\x45\x4e\x22\x57\x3b\x2a\x24\xa1\x64\x90\x0d\x95\x2e\xc4\xee\x00\x2c\x19\x31\x07\xe7\xc9\xfb\x4e\x9b\x72\x9e\x29\x1e\x3e\x72\x3a\xaf\x0d\x08\x1a\x44\x0b\xf1\x45\x14\x35\x93\xf2\x00\x92\x85\xf9\x2a\x68\x15\x2e\x78\x64\x24\xe3\x98\x4f\xfa\x6f\xa5\x9d\x2d\x9c\xa9\xa3\x29\x50\xd5\xd2\x0b\x23\x11\xa8\xe6\xb8\x39\x14\x68\x50\x15\x42\x95\xa0\x63\x0b\x56\x75\xb5\x45\x0b\x7a\x17\x6c\xa1\x83\x38\xc1\xb8\x20\x3a\xbd\xd6\xe3\x57\xb7\xce\x4b\x9a\x7a\x18\xe7\xda\x92\x1c\x79\x78\x97\xde\xf9\xf3\xf8\xeb\x32\x7a\x30\x67\xb5\x12\xcf\xd9\xc9\x45\xc6\x40\x9b\x3a\x78\xdb\x7d\x36\x4c\xb1\x37\x4f\x8a\xe6\xc0\x8a\xc2\xf6\x8d\xbc\x19\x04\xd0\xe0\x83\xe7\xf8\x1e\xc9\x77\x6d\x83\x2f\xfb\x54\x90\xf0\x19\x79\xed\xa9\xc9\x10\xab\x43\x28\x74\xb8\x3d\x66\x8c\x3c\x74\x11\x91\xbe\xe5\xe5\xff\x73\x5a\x41\xa1\x79\x4d\x59\x92\x5f\x50\x17\xa5\xa1\x03\xb6\xf3\x68\xc1\xea\xda\x13\x4c\x14\x12\x29\x86\xa9\x4b\xa0\xf2\x82\x07\x8b\xe6\xb0\x15\x11\x62\xa6\x0a\x82\x4e\x14\x61\x3f\x82\x71\x9a\x25\xd3\xce\xe8\xe1\xab\xf1\xec\x0d\xf9\x8f\x94\x83\x89\xf8\x35\xb8\xec\x99\x31\xa8\x5c\x6f\xa3\x3a\xf8\x7d\x68\xf7\x21\x88\x06\x6c\x4c\x3a\x1d\xa0\x11\x31\x5d\xba\x38\x78\x19\xa4\x8d\xee\xa3\x91\x41\xa9\x75\x11\x03\x92\x04\x18\x59\x97\x20\x14\x30\x30\x4c\x09\x1e\x8d\x26\x89\x47\xa5\xf3\xf0\x7c\xed\x30\xaa\xd0\x5b\xc1\xdd\x00\xa0\xb3\x32\xf3\x9d\x28\xfd\x3f\x00\x00\xff\xff\xe4\xf9\x38\x6b\x4a\x18\x00\x00")
 
 func templatesServerConfigureapiGotmplBytes() ([]byte, error) {
 	return bindataRead(
@@ -391,7 +391,7 @@ func templatesServerConfigureapiGotmpl() (*asset, error) {
 		return nil, err
 	}
 
-	info := bindataFileInfo{name: "templates/server/configureapi.gotmpl", size: 6190, mode: os.FileMode(420), modTime: time.Unix(1482416923, 0)}
+	info := bindataFileInfo{name: "templates/server/configureapi.gotmpl", size: 6218, mode: os.FileMode(420), modTime: time.Unix(1482416923, 0)}
 	a := &asset{bytes: bytes, info: info}
 	return a, nil
 }
diff --git a/generator/operation.go b/generator/operation.go
index fb5fe574..86618223 100644
--- a/generator/operation.go
+++ b/generator/operation.go
@@ -416,9 +416,8 @@ func (b *codeGenOpBuilder) MakeOperation() (GenOperation, error) {
 		defaultResponse = &gr
 	}
 
-	prin := b.Principal
-	if prin == "" {
-		prin = iface
+	if b.Principal == "" {
+		b.Principal = iface
 	}
 
 	var extra GenSchemaList
@@ -503,9 +502,9 @@ func (b *codeGenOpBuilder) MakeOperation() (GenOperation, error) {
 		HasBodyParams:        hasBodyParams,
 		HasStreamingResponse: hasStreamingResponse,
 		Authorized:           b.Authed,
-		Security:             b.Security,
-		SecurityDefinitions:  b.SecurityDefinitions,
-		Principal:            prin,
+		Security:             b.makeSecurityRequirements(receiver),
+		SecurityDefinitions:  b.makeSecuritySchemes(receiver),
+		Principal:            b.Principal,
 		Responses:            responses,
 		DefaultResponse:      defaultResponse,
 		SuccessResponse:      successResponse,
@@ -1080,3 +1079,36 @@ func (b *codeGenOpBuilder) setBodyParamValidation(p *GenParameter) {
 	}
 
 }
+
+// makeSecuritySchemes produces a sorted list of security schemes for this operation
+func (b *codeGenOpBuilder) makeSecuritySchemes(receiver string) GenSecuritySchemes {
+	return gatherSecuritySchemes(b.SecurityDefinitions, b.Name, b.Principal, receiver)
+}
+
+// makeSecurityRequirements produces a sorted list of security requirements for this operation.
+// As for current, these requirements are not used by codegen (sec. requirement is determined at runtime).
+// We keep the order of the slice from the original spec, but sort the inner slice which comes from a map,
+// as well as the map of scopes.
+func (b *codeGenOpBuilder) makeSecurityRequirements(receiver string) []GenSecurityRequirements {
+	if b.Security == nil {
+		// nil (default requirement) is different than [] (no requirement)
+		return nil
+	}
+
+	securityRequirements := make([]GenSecurityRequirements, 0, len(b.Security))
+	for _, req := range b.Security {
+		jointReq := make(GenSecurityRequirements, 0, len(req))
+		for _, j := range req {
+			scopes := j.Scopes
+			sort.Strings(scopes)
+			jointReq = append(jointReq, GenSecurityRequirement{
+				Name:   j.Name,
+				Scopes: scopes,
+			})
+		}
+		// sort joint requirements (come from a map in spec)
+		sort.Sort(jointReq)
+		securityRequirements = append(securityRequirements, jointReq)
+	}
+	return securityRequirements
+}
diff --git a/generator/operation_test.go b/generator/operation_test.go
index fc7fc080..4b77fd51 100644
--- a/generator/operation_test.go
+++ b/generator/operation_test.go
@@ -811,3 +811,194 @@ func TestGenClientIssue890_ValidationTrueFlattenFalse(t *testing.T) {
 	// same here: now if flatten doesn't resume, expand takes over
 	assert.NoError(t, GenerateClient("foo", nil, nil, &opts))
 }
+
+// This tests that securityDefinitions generate stable code
+func TestBuilder_Issue1214(t *testing.T) {
+	const any = `(.|\n)+`
+	log.SetOutput(ioutil.Discard)
+	defer log.SetOutput(os.Stdout)
+	dr, _ := os.Getwd()
+	opts := &GenOpts{
+		Spec:              filepath.FromSlash("../fixtures/bugs/1214/fixture-1214.yaml"),
+		IncludeModel:      true,
+		IncludeValidator:  true,
+		IncludeHandler:    true,
+		IncludeParameters: true,
+		IncludeResponses:  true,
+		IncludeMain:       true,
+		APIPackage:        "restapi",
+		ModelPackage:      "model",
+		ServerPackage:     "server",
+		ClientPackage:     "client",
+		Target:            dr,
+		IsClient:          false,
+	}
+	err := opts.EnsureDefaults()
+	assert.NoError(t, err)
+	appGen, err := newAppGenerator("fixture-1214", nil, nil, opts)
+	if assert.NoError(t, err) {
+		op, err := appGen.makeCodegenApp()
+		if assert.NoError(t, err) {
+			for i := 0; i < 5; i++ {
+				buf := bytes.NewBuffer(nil)
+				ert := templates.MustGet("serverConfigureapi").Execute(buf, op)
+				if assert.NoError(t, ert) {
+					ff, erf := appGen.GenOpts.LanguageOpts.FormatContent("fixture_1214_configure_api.go", buf.Bytes())
+					if assert.NoError(t, erf) {
+						res := string(ff)
+						assertRegexpInCode(t, any+
+							`api\.AAuth = func\(user string, pass string\)`+any+
+							`api\.BAuth = func\(token string\)`+any+
+							`api\.CAuth = func\(token string\)`+any+
+							`api\.DAuth = func\(token string\)`+any+
+							`api\.EAuth = func\(token string, scopes \[\]string\)`+any, res)
+					} else {
+						fmt.Println(buf.String())
+						break
+					}
+				} else {
+					break
+				}
+				buf = bytes.NewBuffer(nil)
+				err = templates.MustGet("serverBuilder").Execute(buf, op)
+				if assert.NoError(t, err) {
+					ff, err := appGen.GenOpts.LanguageOpts.FormatContent("fixture_1214_server.go", buf.Bytes())
+					if assert.NoError(t, err) {
+						res := string(ff)
+						assertRegexpInCode(t, any+
+							`AAuth: func\(user string, pass string\) \(interface{}, error\) {`+any+
+							`BAuth: func\(token string\) \(interface{}, error\) {`+any+
+							`CAuth: func\(token string\) \(interface{}, error\) {`+any+
+							`DAuth: func\(token string\) \(interface{}, error\) {`+any+
+							`EAuth: func\(token string, scopes \[\]string\) \(interface{}, error\) {`+any+
+
+							`AAuth func\(string, string\) \(interface{}, error\)`+any+
+							`BAuth func\(string\) \(interface{}, error\)`+any+
+							`CAuth func\(string\) \(interface{}, error\)`+any+
+							`DAuth func\(string\) \(interface{}, error\)`+any+
+							`EAuth func\(string, \[\]string\) \(interface{}, error\)`+any+
+
+							`if o\.AAuth == nil {`+any+
+							`unregistered = append\(unregistered, "AAuth"\)`+any+
+							`if o\.BAuth == nil {`+any+
+							`unregistered = append\(unregistered, "K1Auth"\)`+any+
+							`if o\.CAuth == nil {`+any+
+							`unregistered = append\(unregistered, "K2Auth"\)`+any+
+							`if o\.DAuth == nil {`+any+
+							`unregistered = append\(unregistered, "K3Auth"\)`+any+
+							`if o\.EAuth == nil {`+any+
+							`unregistered = append\(unregistered, "EAuth"\)`+any+
+
+							`case "A":`+any+
+							`case "B":`+any+
+							`case "C":`+any+
+							`case "D":`+any+
+							`case "E":`+any, res)
+					} else {
+						fmt.Println(buf.String())
+						break
+					}
+				} else {
+					break
+				}
+			}
+		}
+	}
+}
+
+func TestGenSecurityRequirements(t *testing.T) {
+	for i := 0; i < 5; i++ {
+		operation := "asecOp"
+		b, err := opBuilder(operation, "../fixtures/bugs/1214/fixture-1214.yaml")
+		if !assert.NoError(t, err) {
+			t.FailNow()
+			return
+		}
+		b.Security = b.Analyzed.SecurityRequirementsFor(&b.Operation)
+		genRequirements := b.makeSecurityRequirements("o")
+		assert.Len(t, genRequirements, 2)
+		assert.Equal(t, []GenSecurityRequirements{
+			GenSecurityRequirements{
+				GenSecurityRequirement{
+					Name:   "A",
+					Scopes: []string{},
+				},
+				GenSecurityRequirement{
+					Name:   "B",
+					Scopes: []string{},
+				},
+				GenSecurityRequirement{
+					Name:   "E",
+					Scopes: []string{"s0", "s1", "s2", "s3", "s4"},
+				},
+			},
+			GenSecurityRequirements{
+				GenSecurityRequirement{
+					Name:   "C",
+					Scopes: []string{},
+				},
+				GenSecurityRequirement{
+					Name:   "D",
+					Scopes: []string{},
+				},
+				GenSecurityRequirement{
+					Name:   "E",
+					Scopes: []string{"s5", "s6", "s7", "s8", "s9"},
+				},
+			},
+		}, genRequirements)
+
+		operation = "bsecOp"
+		b, err = opBuilder(operation, "../fixtures/bugs/1214/fixture-1214.yaml")
+		if !assert.NoError(t, err) {
+			t.FailNow()
+			return
+		}
+		b.Security = b.Analyzed.SecurityRequirementsFor(&b.Operation)
+		genRequirements = b.makeSecurityRequirements("o")
+		assert.Len(t, genRequirements, 2)
+		assert.Equal(t, []GenSecurityRequirements{
+			GenSecurityRequirements{
+				GenSecurityRequirement{
+					Name:   "A",
+					Scopes: []string{},
+				},
+				GenSecurityRequirement{
+					Name:   "E",
+					Scopes: []string{"s0", "s1", "s2", "s3", "s4"},
+				},
+			},
+			GenSecurityRequirements{
+				GenSecurityRequirement{
+					Name:   "D",
+					Scopes: []string{},
+				},
+				GenSecurityRequirement{
+					Name:   "E",
+					Scopes: []string{"s5", "s6", "s7", "s8", "s9"},
+				},
+			},
+		}, genRequirements)
+	}
+
+	operation := "csecOp"
+	b, err := opBuilder(operation, "../fixtures/bugs/1214/fixture-1214.yaml")
+	if !assert.NoError(t, err) {
+		t.FailNow()
+		return
+	}
+	b.Security = b.Analyzed.SecurityRequirementsFor(&b.Operation)
+	genRequirements := b.makeSecurityRequirements("o")
+	assert.NotNil(t, genRequirements)
+	assert.Len(t, genRequirements, 0)
+
+	operation = "nosecOp"
+	b, err = opBuilder(operation, "../fixtures/bugs/1214/fixture-1214-2.yaml")
+	if !assert.NoError(t, err) {
+		t.FailNow()
+		return
+	}
+	b.Security = b.Analyzed.SecurityRequirementsFor(&b.Operation)
+	genRequirements = b.makeSecurityRequirements("o")
+	assert.Nil(t, genRequirements)
+}
diff --git a/generator/shared.go b/generator/shared.go
index 79904339..18759205 100644
--- a/generator/shared.go
+++ b/generator/shared.go
@@ -956,3 +956,40 @@ func validateAndFlattenSpec(opts *GenOpts, specDoc *loads.Document) (*loads.Docu
 
 	return specDoc, nil
 }
+
+// gatherSecuritySchemes produces a sorted representation from a map of spec security schemes
+func gatherSecuritySchemes(securitySchemes map[string]spec.SecurityScheme, appName, principal, receiver string) (security GenSecuritySchemes) {
+	for scheme, req := range securitySchemes {
+		isOAuth2 := strings.ToLower(req.Type) == "oauth2"
+		var scopes []string
+		if isOAuth2 {
+			for k := range req.Scopes {
+				scopes = append(scopes, k)
+			}
+		}
+		sort.Strings(scopes)
+
+		security = append(security, GenSecurityScheme{
+			AppName:      appName,
+			ID:           scheme,
+			ReceiverName: receiver,
+			Name:         req.Name,
+			IsBasicAuth:  strings.ToLower(req.Type) == "basic",
+			IsAPIKeyAuth: strings.ToLower(req.Type) == "apikey",
+			IsOAuth2:     isOAuth2,
+			Scopes:       scopes,
+			Principal:    principal,
+			Source:       req.In,
+			// from original spec
+			Description:      req.Description,
+			Type:             strings.ToLower(req.Type),
+			In:               req.In,
+			Flow:             req.Flow,
+			AuthorizationURL: req.AuthorizationURL,
+			TokenURL:         req.TokenURL,
+			Extensions:       req.Extensions,
+		})
+	}
+	sort.Sort(security)
+	return
+}
diff --git a/generator/structs.go b/generator/structs.go
index e7d4af9d..4fc5bd53 100644
--- a/generator/structs.go
+++ b/generator/structs.go
@@ -8,7 +8,6 @@ import (
 	"strconv"
 	"strings"
 
-	"github.com/go-openapi/analysis"
 	"github.com/go-openapi/spec"
 )
 
@@ -428,8 +427,8 @@ type GenOperation struct {
 	ExtraSchemas   []GenSchema
 
 	Authorized          bool
-	Security            [][]analysis.SecurityRequirement
-	SecurityDefinitions map[string]spec.SecurityScheme
+	Security            []GenSecurityRequirements
+	SecurityDefinitions GenSecuritySchemes
 	Principal           string
 
 	SuccessResponse  *GenResponse
@@ -490,14 +489,17 @@ type GenApp struct {
 	ExtraSchemes        []string
 	Consumes            GenSerGroups
 	Produces            GenSerGroups
-	SecurityDefinitions []GenSecurityScheme
+	SecurityDefinitions GenSecuritySchemes
 	Models              []GenDefinition
 	Operations          GenOperations
 	OperationGroups     GenOperationGroups
 	SwaggerJSON         string
-	// this is important for when the generated server adds routes
-	// ideally this should be removed after we code-generate the router instead of relying on runtime
-	// CAUTION: Could be problematic for big specs (might consume large amounts of memory)
+	// Embedded specs: this is important for when the generated server adds routes.
+	// NOTE: there is a distinct advantage to having this in runtime rather than generated code.
+	// We are noti ever going to generate the router.
+	// If embedding spec is an issue (e.g. memory usage), this can be excluded with the --exclude-spec
+	// generation option. Alternative methods to serve spec (e.g. from disk, ...) may be implemented by
+	// adding a middleware to the generated API.
 	FlatSwaggerJSON string
 	ExcludeSpec     bool
 	WithContext     bool
@@ -561,13 +563,6 @@ type GenSerializer struct {
 	Implementation string
 }
 
-// GenSecuritySchemes sorted representation of serializers
-type GenSecuritySchemes []GenSecurityScheme
-
-func (g GenSecuritySchemes) Len() int           { return len(g) }
-func (g GenSecuritySchemes) Swap(i, j int)      { g[i], g[j] = g[j], g[i] }
-func (g GenSecuritySchemes) Less(i, j int) bool { return g[i].Name < g[j].Name }
-
 // GenSecurityScheme represents a security scheme for code generation
 type GenSecurityScheme struct {
 	AppName      string
@@ -580,4 +575,35 @@ type GenSecurityScheme struct {
 	Scopes       []string
 	Source       string
 	Principal    string
+	// from spec.SecurityScheme
+	Description      string
+	Type             string
+	In               string
+	Flow             string
+	AuthorizationURL string
+	TokenURL         string
+	Extensions       map[string]interface{}
+}
+
+// GenSecuritySchemes sorted representation of serializers
+type GenSecuritySchemes []GenSecurityScheme
+
+func (g GenSecuritySchemes) Len() int           { return len(g) }
+func (g GenSecuritySchemes) Swap(i, j int)      { g[i], g[j] = g[j], g[i] }
+func (g GenSecuritySchemes) Less(i, j int) bool { return g[i].ID < g[j].ID }
+
+// GenSecurityRequirement represents a security requirement for an operation
+type GenSecurityRequirement struct {
+	Name   string
+	Scopes []string
 }
+
+// GenSecurityRequirements represents a compounded security requirement specification.
+// In a []GenSecurityRequirements complete requirements specification,
+// outer elements are interpreted as optional requirements (OR), and
+// inner elements are interpreted as jointly required (AND).
+type GenSecurityRequirements []GenSecurityRequirement
+
+func (g GenSecurityRequirements) Len() int           { return len(g) }
+func (g GenSecurityRequirements) Swap(i, j int)      { g[i], g[j] = g[j], g[i] }
+func (g GenSecurityRequirements) Less(i, j int) bool { return g[i].Name < g[j].Name }
diff --git a/generator/support.go b/generator/support.go
index 66b0be43..5705f32b 100644
--- a/generator/support.go
+++ b/generator/support.go
@@ -469,38 +469,17 @@ func (a *appGenerator) makeProduces() (produces GenSerGroups, producesJSON bool)
 	return
 }
 
-func (a *appGenerator) makeSecuritySchemes() (security GenSecuritySchemes) {
-
-	prin := a.Principal
-	if prin == "" {
-		prin = "interface{}"
+func (a *appGenerator) makeSecuritySchemes() GenSecuritySchemes {
+	if a.Principal == "" {
+		a.Principal = "interface{}"
 	}
+	requiredSecuritySchemes := make(map[string]spec.SecurityScheme, len(a.Analyzed.RequiredSecuritySchemes()))
 	for _, scheme := range a.Analyzed.RequiredSecuritySchemes() {
-		if req, ok := a.SpecDoc.Spec().SecurityDefinitions[scheme]; ok {
-			isOAuth2 := strings.ToLower(req.Type) == "oauth2"
-			var scopes []string
-			if isOAuth2 {
-				for k := range req.Scopes {
-					scopes = append(scopes, k)
-				}
-			}
-
-			security = append(security, GenSecurityScheme{
-				AppName:      a.Name,
-				ID:           scheme,
-				ReceiverName: a.Receiver,
-				Name:         req.Name,
-				IsBasicAuth:  strings.ToLower(req.Type) == "basic",
-				IsAPIKeyAuth: strings.ToLower(req.Type) == "apikey",
-				IsOAuth2:     isOAuth2,
-				Scopes:       scopes,
-				Principal:    prin,
-				Source:       req.In,
-			})
+		if req, ok := a.SpecDoc.Spec().SecurityDefinitions[scheme]; ok && req != nil {
+			requiredSecuritySchemes[scheme] = *req
 		}
 	}
-	sort.Sort(security)
-	return
+	return gatherSecuritySchemes(requiredSecuritySchemes, a.Name, a.Principal, a.Receiver)
 }
 
 func (a *appGenerator) makeCodegenApp() (GenApp, error) {
@@ -517,10 +496,6 @@ func (a *appGenerator) makeCodegenApp() (GenApp, error) {
 	produces, _ := a.makeProduces()
 	sort.Sort(consumes)
 	sort.Sort(produces)
-	prin := a.Principal
-	if prin == "" {
-		prin = "interface{}"
-	}
 	security := a.makeSecuritySchemes()
 	baseImport := a.GenOpts.LanguageOpts.baseImport(a.Target)
 	var imports map[string]string
@@ -532,7 +507,6 @@ func (a *appGenerator) makeCodegenApp() (GenApp, error) {
 			imports = make(map[string]string)
 		}
 		imports[a.ModelsPackage] = filepath.ToSlash(filepath.Join(baseImport, manglePackageName(a.GenOpts, a.GenOpts.ModelPackage, "models")))
-		// importPath = filepath.ToSlash(filepath.Join(baseImport, a.ModelsPackage))
 	}
 	if importPath != "" {
 		defaultImports = append(defaultImports, importPath)
@@ -564,9 +538,10 @@ func (a *appGenerator) makeCodegenApp() (GenApp, error) {
 		o := opp.Op
 		o.Tags = pruneEmpty(o.Tags)
 		o.ID = on
+
 		var bldr codeGenOpBuilder
 		bldr.ModelsPackage = a.ModelsPackage
-		bldr.Principal = prin
+		bldr.Principal = a.Principal
 		bldr.Target = a.Target
 		bldr.DefaultImports = defaultImports
 		bldr.Imports = imports
@@ -702,7 +677,7 @@ func (a *appGenerator) makeCodegenApp() (GenApp, error) {
 		Models:              genMods,
 		Operations:          genOps,
 		OperationGroups:     opGroups,
-		Principal:           prin,
+		Principal:           a.Principal,
 		SwaggerJSON:         generateReadableSpec(jsonb),
 		FlatSwaggerJSON:     generateReadableSpec(flatjsonb),
 		ExcludeSpec:         a.GenOpts != nil && a.GenOpts.ExcludeSpec,
diff --git a/generator/templates/server/configureapi.gotmpl b/generator/templates/server/configureapi.gotmpl
index 11631367..a3ff978c 100644
--- a/generator/templates/server/configureapi.gotmpl
+++ b/generator/templates/server/configureapi.gotmpl
@@ -69,30 +69,31 @@ func configureAPI(api *{{.Package}}.{{ pascalize .Name }}API) http.Handler {
     return errors.NotImplemented("{{.Name}} producer has not yet been implemented")
   }){{end}}
   {{end}}
-  {{range .SecurityDefinitions}}
-  {{if .IsBasicAuth}}
+  {{ range .SecurityDefinitions }}
+    {{- if .IsBasicAuth }}
   // Applies when the Authorization header is set with the Basic scheme
   api.{{ pascalize .ID }}Auth = func(user string, pass string) ({{if not ( eq .Principal "interface{}" )}}*{{ end }}{{.Principal}}, error) {
     return nil, errors.NotImplemented("basic auth  ({{ .ID }}) has not yet been implemented")
   }
-  {{end}}{{if .IsAPIKeyAuth}}
+    {{- else if .IsAPIKeyAuth }}
   // Applies when the "{{ .Name }}" {{ .Source }} is set
   api.{{ pascalize .ID }}Auth = func(token string) ({{if not ( eq .Principal "interface{}" )}}*{{ end }}{{.Principal}}, error) {
     return nil, errors.NotImplemented("api key auth ({{ .ID }}) {{.Name}} from {{.Source}} param [{{ .Name }}] has not yet been implemented")
   }
-  {{end}}{{if .IsOAuth2}}
+    {{- else if .IsOAuth2 }}
   api.{{ pascalize .ID }}Auth = func(token string, scopes []string) ({{if not ( eq .Principal "interface{}" )}}*{{ end }}{{.Principal}}, error) {
     return nil, errors.NotImplemented("oauth2 bearer auth ({{ .ID }}) has not yet been implemented")
   }
-  {{end}}
-  {{end}}
-  {{if .SecurityDefinitions}}
+    {{- end }}
+  {{- end }}
+  {{- if .SecurityDefinitions }}
+
   // Set your custom authorizer if needed. Default one is security.Authorized()
   // Expected interface runtime.Authorizer
   //
   // Example:
   // api.APIAuthorizer = security.Authorized()
-  {{end}}
+  {{- end }}
   {{range .Operations}}api.{{if ne .Package $package}}{{pascalize .Package}}{{end}}{{ pascalize .Name }}Handler = {{.Package}}.{{ pascalize .Name }}HandlerFunc(func({{ if .WithContext }}ctx context.Context, {{ end }}params {{.Package}}.{{ pascalize .Name }}Params{{if .Authorized}}, principal {{if not ( eq .Principal "interface{}" )}}*{{ end }}{{.Principal}}{{end}}) middleware.Responder {
     return middleware.NotImplemented("operation {{if ne .Package $package}}{{ .Package}}{{end}}.{{pascalize .Name}} has not yet been implemented")
   })
