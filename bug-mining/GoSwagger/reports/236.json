{"url":"https://api.github.com/repos/go-swagger/go-swagger/issues/1683","repository_url":"https://api.github.com/repos/go-swagger/go-swagger","labels_url":"https://api.github.com/repos/go-swagger/go-swagger/issues/1683/labels{/name}","comments_url":"https://api.github.com/repos/go-swagger/go-swagger/issues/1683/comments","events_url":"https://api.github.com/repos/go-swagger/go-swagger/issues/1683/events","html_url":"https://github.com/go-swagger/go-swagger/issues/1683","id":357648132,"node_id":"MDU6SXNzdWUzNTc2NDgxMzI=","number":1683,"title":"Client wont compile with a route tagged \"test\" ","user":{"login":"mmmguitar","id":31597525,"node_id":"MDQ6VXNlcjMxNTk3NTI1","avatar_url":"https://avatars.githubusercontent.com/u/31597525?v=4","gravatar_id":"","url":"https://api.github.com/users/mmmguitar","html_url":"https://github.com/mmmguitar","followers_url":"https://api.github.com/users/mmmguitar/followers","following_url":"https://api.github.com/users/mmmguitar/following{/other_user}","gists_url":"https://api.github.com/users/mmmguitar/gists{/gist_id}","starred_url":"https://api.github.com/users/mmmguitar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mmmguitar/subscriptions","organizations_url":"https://api.github.com/users/mmmguitar/orgs","repos_url":"https://api.github.com/users/mmmguitar/repos","events_url":"https://api.github.com/users/mmmguitar/events{/privacy}","received_events_url":"https://api.github.com/users/mmmguitar/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":148436504,"node_id":"MDU6TGFiZWwxNDg0MzY1MDQ=","url":"https://api.github.com/repos/go-swagger/go-swagger/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":493024330,"node_id":"MDU6TGFiZWw0OTMwMjQzMzA=","url":"https://api.github.com/repos/go-swagger/go-swagger/labels/generator","name":"generator","color":"bfdadc","default":false,"description":null},{"id":770973794,"node_id":"MDU6TGFiZWw3NzA5NzM3OTQ=","url":"https://api.github.com/repos/go-swagger/go-swagger/labels/generate%20client","name":"generate client","color":"72e0ad","default":false,"description":null},{"id":975136500,"node_id":"MDU6TGFiZWw5NzUxMzY1MDA=","url":"https://api.github.com/repos/go-swagger/go-swagger/labels/pending%20PR","name":"pending PR","color":"7ff47f","default":false,"description":""}],"state":"closed","locked":false,"assignee":{"login":"fredbi","id":14262513,"node_id":"MDQ6VXNlcjE0MjYyNTEz","avatar_url":"https://avatars.githubusercontent.com/u/14262513?v=4","gravatar_id":"","url":"https://api.github.com/users/fredbi","html_url":"https://github.com/fredbi","followers_url":"https://api.github.com/users/fredbi/followers","following_url":"https://api.github.com/users/fredbi/following{/other_user}","gists_url":"https://api.github.com/users/fredbi/gists{/gist_id}","starred_url":"https://api.github.com/users/fredbi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fredbi/subscriptions","organizations_url":"https://api.github.com/users/fredbi/orgs","repos_url":"https://api.github.com/users/fredbi/repos","events_url":"https://api.github.com/users/fredbi/events{/privacy}","received_events_url":"https://api.github.com/users/fredbi/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"fredbi","id":14262513,"node_id":"MDQ6VXNlcjE0MjYyNTEz","avatar_url":"https://avatars.githubusercontent.com/u/14262513?v=4","gravatar_id":"","url":"https://api.github.com/users/fredbi","html_url":"https://github.com/fredbi","followers_url":"https://api.github.com/users/fredbi/followers","following_url":"https://api.github.com/users/fredbi/following{/other_user}","gists_url":"https://api.github.com/users/fredbi/gists{/gist_id}","starred_url":"https://api.github.com/users/fredbi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fredbi/subscriptions","organizations_url":"https://api.github.com/users/fredbi/orgs","repos_url":"https://api.github.com/users/fredbi/repos","events_url":"https://api.github.com/users/fredbi/events{/privacy}","received_events_url":"https://api.github.com/users/fredbi/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":null,"comments":1,"created_at":"2018-09-06T13:10:51Z","updated_at":"2018-11-19T01:38:11Z","closed_at":"2018-11-19T01:38:11Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"## Problem statement\r\n\r\nHave a swagger with a route tagged \"test\", it can generate the client but it wont compile.  The basic client file generated contains a struct referencing a package test_swagger which does not exist.\r\n\r\nAfter a little digging it seems the template generation uses formatting function called snakize which changes the name (protection against reserved words) but not all formatting functions do this or use is inconsistent.\r\n\r\nSee here, this is the line that fails to compile for \"test\":\r\n\r\nhttps://github.com/go-swagger/go-swagger/blob/master/generator/templates/client/facade.gotmpl#L120\r\n\r\nThis seems to boil down to a MangleFileName func which goes to a LanguageOpts fileNameFunc and there is a comment /code that does some special reserved word protection where it will append \"_swagger\" on to it\r\n\r\n - https://github.com/go-swagger/go-swagger/blob/master/generator/shared.go#L83\r\n - https://github.com/go-swagger/go-swagger/blob/master/generator/shared.go#L168\r\n\r\nSo it seems this struct is having that package manipulated / matched the reserved word but other usages are not, neither is the import which is why the struct package is not found / failing to compile.\r\n\r\nAn example of a place using .Name directly.\r\nhttps://github.com/go-swagger/go-swagger/blob/master/generator/templates/client/facade.gotmpl#L73\r\n\r\nThe other thing I noticed for the client operations it generates a folder in its name, which is \"client/test\" -- i.e. it doesn't attempt to do the _swagger.  So either snakize and some of the formatting functions are being a little over zealous or the _swagger notion is missing from a few places including the folder creations.  Thats when I entered a rabbit hole.\r\n\r\nI also found this ticket:\r\n\r\nhttps://github.com/go-swagger/go-swagger/issues/1157\r\n\r\nWhich also seems to have some inconsistency related to use of formatting functions.\r\n\r\nThe simple workaround is to tag the route as something a little more specific / not use a reserved word.\r\n\r\n## Swagger specification\r\n\r\n```\r\n  /my/route/:\r\n    get:\r\n      operationId: getSomeData\r\n      summary: Gets some data\r\n      tags: [test]\r\n```\r\n\r\n## Steps to reproduce\r\n\r\nGenerate a client with a swagger file that contains a route tagged with \"test\", will generate but shouldnt compile.\r\n\r\n## Environment\r\nswagger version: 0.16.0  \r\ngo version: 1.10.3  \r\nOS:   Linux Mint 18\r\n","closed_by":{"login":"casualjim","id":456109,"node_id":"MDQ6VXNlcjQ1NjEwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/456109?v=4","gravatar_id":"","url":"https://api.github.com/users/casualjim","html_url":"https://github.com/casualjim","followers_url":"https://api.github.com/users/casualjim/followers","following_url":"https://api.github.com/users/casualjim/following{/other_user}","gists_url":"https://api.github.com/users/casualjim/gists{/gist_id}","starred_url":"https://api.github.com/users/casualjim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/casualjim/subscriptions","organizations_url":"https://api.github.com/users/casualjim/orgs","repos_url":"https://api.github.com/users/casualjim/repos","events_url":"https://api.github.com/users/casualjim/events{/privacy}","received_events_url":"https://api.github.com/users/casualjim/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/go-swagger/go-swagger/issues/1683/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/go-swagger/go-swagger/issues/1683/timeline","performed_via_github_app":null,"state_reason":"completed"}