{"url":"https://api.github.com/repos/go-swagger/go-swagger/issues/1816","repository_url":"https://api.github.com/repos/go-swagger/go-swagger","labels_url":"https://api.github.com/repos/go-swagger/go-swagger/issues/1816/labels{/name}","comments_url":"https://api.github.com/repos/go-swagger/go-swagger/issues/1816/comments","events_url":"https://api.github.com/repos/go-swagger/go-swagger/issues/1816/events","html_url":"https://github.com/go-swagger/go-swagger/issues/1816","id":384575656,"node_id":"MDU6SXNzdWUzODQ1NzU2NTY=","number":1816,"title":"generated embedded_spec.go removing refs","user":{"login":"kenjones-cisco","id":7967510,"node_id":"MDQ6VXNlcjc5Njc1MTA=","avatar_url":"https://avatars.githubusercontent.com/u/7967510?v=4","gravatar_id":"","url":"https://api.github.com/users/kenjones-cisco","html_url":"https://github.com/kenjones-cisco","followers_url":"https://api.github.com/users/kenjones-cisco/followers","following_url":"https://api.github.com/users/kenjones-cisco/following{/other_user}","gists_url":"https://api.github.com/users/kenjones-cisco/gists{/gist_id}","starred_url":"https://api.github.com/users/kenjones-cisco/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kenjones-cisco/subscriptions","organizations_url":"https://api.github.com/users/kenjones-cisco/orgs","repos_url":"https://api.github.com/users/kenjones-cisco/repos","events_url":"https://api.github.com/users/kenjones-cisco/events{/privacy}","received_events_url":"https://api.github.com/users/kenjones-cisco/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":148436504,"node_id":"MDU6TGFiZWwxNDg0MzY1MDQ=","url":"https://api.github.com/repos/go-swagger/go-swagger/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":975136500,"node_id":"MDU6TGFiZWw5NzUxMzY1MDA=","url":"https://api.github.com/repos/go-swagger/go-swagger/labels/pending%20PR","name":"pending PR","color":"7ff47f","default":false,"description":""}],"state":"closed","locked":false,"assignee":{"login":"fredbi","id":14262513,"node_id":"MDQ6VXNlcjE0MjYyNTEz","avatar_url":"https://avatars.githubusercontent.com/u/14262513?v=4","gravatar_id":"","url":"https://api.github.com/users/fredbi","html_url":"https://github.com/fredbi","followers_url":"https://api.github.com/users/fredbi/followers","following_url":"https://api.github.com/users/fredbi/following{/other_user}","gists_url":"https://api.github.com/users/fredbi/gists{/gist_id}","starred_url":"https://api.github.com/users/fredbi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fredbi/subscriptions","organizations_url":"https://api.github.com/users/fredbi/orgs","repos_url":"https://api.github.com/users/fredbi/repos","events_url":"https://api.github.com/users/fredbi/events{/privacy}","received_events_url":"https://api.github.com/users/fredbi/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"fredbi","id":14262513,"node_id":"MDQ6VXNlcjE0MjYyNTEz","avatar_url":"https://avatars.githubusercontent.com/u/14262513?v=4","gravatar_id":"","url":"https://api.github.com/users/fredbi","html_url":"https://github.com/fredbi","followers_url":"https://api.github.com/users/fredbi/followers","following_url":"https://api.github.com/users/fredbi/following{/other_user}","gists_url":"https://api.github.com/users/fredbi/gists{/gist_id}","starred_url":"https://api.github.com/users/fredbi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fredbi/subscriptions","organizations_url":"https://api.github.com/users/fredbi/orgs","repos_url":"https://api.github.com/users/fredbi/repos","events_url":"https://api.github.com/users/fredbi/events{/privacy}","received_events_url":"https://api.github.com/users/fredbi/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":null,"comments":5,"created_at":"2018-11-27T01:04:19Z","updated_at":"2018-11-29T16:21:12Z","closed_at":"2018-11-29T16:21:12Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"## Problem statement\r\n\r\nStarting around the end of the week of 11/16 when generating code, I'm noticing that the embedded_spec.go is no longer include the ref paths, they are being set to `#`.\r\n\r\nExamples:\r\n\r\n```\r\n           \"400\": {\r\n-            \"$ref\": \"#/responses/400\"\r\n+            \"$ref\": \"#\"\r\n           },\r\n           \"401\": {\r\n-            \"$ref\": \"#/responses/401\"\r\n+            \"$ref\": \"#\"\r\n           },\r\n           \"403\": {\r\n-            \"$ref\": \"#/responses/403\"\r\n+            \"$ref\": \"#\"\r\n           },\r\n           \"404\": {\r\n-            \"$ref\": \"#/responses/404\"\r\n+            \"$ref\": \"#\"\r\n           },\r\n           \"default\": {\r\n-            \"$ref\": \"#/responses/500\"\r\n+            \"$ref\": \"#\"\r\n           }\r\n         },\r\n\r\n             \"schema\": {\r\n               \"type\": \"array\",\r\n               \"items\": {\r\n-                \"$ref\": \"#/definitions/service_view\"\r\n+                \"$ref\": \"#\"\r\n               }\r\n             },\r\n\r\n           \"200\": {\r\n             \"description\": \"Service\",\r\n             \"schema\": {\r\n-              \"$ref\": \"#/definitions/service_view\"\r\n+              \"$ref\": \"#\"\r\n             },\r\n\r\n             \"schema\": {\r\n               \"type\": \"array\",\r\n               \"items\": {\r\n-                \"$ref\": \"#/definitions/unit_view\"\r\n+                \"$ref\": \"#\"\r\n               }\r\n             },\r\n\r\n           \"200\": {\r\n             \"description\": \"Service Unit\",\r\n             \"schema\": {\r\n-              \"$ref\": \"#/definitions/unit_view\"\r\n+              \"$ref\": \"#\"\r\n             },\r\n\r\n       \"properties\": {\r\n         \"audit\": {\r\n-          \"$ref\": \"#/definitions/audit\"\r\n+          \"$ref\": \"#\"\r\n         },\r\n\r\n           \"type\": \"object\",\r\n           \"title\": \"Service Unit Quotas\",\r\n           \"additionalProperties\": {\r\n-            \"$ref\": \"#/definitions/quota\"\r\n+            \"$ref\": \"#\"\r\n           }\r\n\r\n     \"400\": {\r\n       \"description\": \"Invalid Request Error. Check error message in the response body for details.\\n\",\r\n       \"schema\": {\r\n-        \"$ref\": \"#/definitions/error\"\r\n+        \"$ref\": \"#\"\r\n       },\r\n\r\n```\r\n\r\n## Swagger specification\r\n\r\n```\r\nswagger: '2.0'\r\ninfo:\r\n  version: \"1.0.0\"\r\n  title: Service Manager\r\n\r\nschemes:\r\n  - http\r\n\r\nproduces:\r\n  - application/vnd.cia.v1+json\r\n\r\ntags:\r\n  - name: services\r\n\r\nbasePath: /v1\r\n\r\npaths:\r\n  /services:\r\n    parameters:\r\n      - name: \"X-Request-Id\"\r\n        in: \"header\"\r\n        description: Unique identifier associated with request\r\n        required: true\r\n        type: string\r\n        format: uuid\r\n    get:\r\n      tags: [services]\r\n      operationId: searchServices\r\n      summary: Search for Services\r\n      description: |\r\n        To apply filter criteria use the following approach:\r\n\r\n        `?<field><operator><value>`\r\n\r\n        Example: `?name=Test`\r\n\r\n      parameters:\r\n        - name: name\r\n          in: query\r\n          description: Search records by name\r\n          required: false\r\n          type: string\r\n          minLength: 3\r\n        - name: version\r\n          in: query\r\n          description: Search records by version\r\n          required: false\r\n          type: string\r\n          minLength: 3\r\n        - name: location\r\n          in: query\r\n          description: Search records by location\r\n          required: false\r\n          type: string\r\n          minLength: 3\r\n        - name: region\r\n          in: query\r\n          description: Search records by region\r\n          required: false\r\n          type: string\r\n          minLength: 3\r\n      responses:\r\n        200:\r\n          description: List of Services\r\n          headers:\r\n            X-Request-Id:\r\n              description: Unique identifier associated with request\r\n              type: string\r\n              format: uuid\r\n          schema:\r\n            type: array\r\n            items:\r\n              $ref: \"#/definitions/service_view\"\r\n        400:\r\n          $ref: \"#/responses/400\"\r\n        401:\r\n          $ref: '#/responses/401'\r\n        403:\r\n          $ref: '#/responses/403'\r\n        default:\r\n          $ref: '#/responses/500'\r\n\r\n  /services/{serviceId}:\r\n    parameters:\r\n      - name: serviceId\r\n        description: Unique identifier for Service\r\n        in: path\r\n        required: true\r\n        type: string\r\n        format: uuid\r\n      - name: \"X-Request-Id\"\r\n        in: \"header\"\r\n        description: Unique identifier associated with request\r\n        required: true\r\n        type: string\r\n        format: uuid\r\n    get:\r\n      tags: [services]\r\n      operationId: viewService\r\n      summary: View Service\r\n      description: View Service\r\n      responses:\r\n        200:\r\n          description: Service\r\n          headers:\r\n            X-Request-Id:\r\n              description: Unique identifier associated with request\r\n              type: string\r\n              format: uuid\r\n          schema:\r\n            $ref: \"#/definitions/service_view\"\r\n        400:\r\n          $ref: \"#/responses/400\"\r\n        401:\r\n          $ref: '#/responses/401'\r\n        403:\r\n          $ref: '#/responses/403'\r\n        404:\r\n          $ref: '#/responses/404'\r\n        default:\r\n          $ref: '#/responses/500'\r\n\r\n  /services/{serviceId}/units:\r\n    parameters:\r\n      - name: serviceId\r\n        description: Unique identifier for Service\r\n        in: path\r\n        required: true\r\n        type: string\r\n        format: uuid\r\n      - name: \"X-Request-Id\"\r\n        in: \"header\"\r\n        description: Unique identifier associated with request\r\n        required: true\r\n        type: string\r\n        format: uuid\r\n    get:\r\n      tags: [services]\r\n      operationId: searchUnits\r\n      summary: Search for Service Units\r\n      description: |\r\n        To apply filter criteria use the following approach:\r\n\r\n        `?<field><operator><value>`\r\n\r\n        Example: `?name=Test`\r\n\r\n      parameters:\r\n        - name: name\r\n          in: query\r\n          description: Search records by name\r\n          required: false\r\n          type: string\r\n          minLength: 3\r\n        - name: type\r\n          in: query\r\n          description: Search records by type\r\n          required: false\r\n          type: string\r\n          minLength: 3\r\n      responses:\r\n        200:\r\n          description: List of Service Units\r\n          headers:\r\n            X-Request-Id:\r\n              description: Unique identifier associated with request\r\n              type: string\r\n              format: uuid\r\n          schema:\r\n            type: array\r\n            items:\r\n              $ref: \"#/definitions/unit_view\"\r\n        400:\r\n          $ref: \"#/responses/400\"\r\n        401:\r\n          $ref: '#/responses/401'\r\n        403:\r\n          $ref: '#/responses/403'\r\n        404:\r\n          $ref: '#/responses/404'\r\n        default:\r\n          $ref: '#/responses/500'\r\n\r\n\r\n  /services/{serviceId}/units/{unitId}:\r\n    parameters:\r\n      - name: serviceId\r\n        description: Unique identifier for Service\r\n        in: path\r\n        required: true\r\n        type: string\r\n        format: uuid\r\n      - name: unitId\r\n        description: Unique identifier for Service Unit\r\n        in: path\r\n        required: true\r\n        type: string\r\n        format: uuid\r\n      - name: \"X-Request-Id\"\r\n        in: \"header\"\r\n        description: Unique identifier associated with request\r\n        required: true\r\n        type: string\r\n        format: uuid\r\n    get:\r\n      tags: [services]\r\n      operationId: viewUnit\r\n      summary: View Service Unit\r\n      description: View Service Unit\r\n      responses:\r\n        200:\r\n          description: Service Unit\r\n          headers:\r\n            X-Request-Id:\r\n              description: Unique identifier associated with request\r\n              type: string\r\n              format: uuid\r\n          schema:\r\n            $ref: \"#/definitions/unit_view\"\r\n        400:\r\n          $ref: \"#/responses/400\"\r\n        401:\r\n          $ref: '#/responses/401'\r\n        403:\r\n          $ref: '#/responses/403'\r\n        404:\r\n          $ref: '#/responses/404'\r\n        default:\r\n          $ref: '#/responses/500'\r\n\r\ndefinitions:\r\n\r\n  service_view:\r\n    title: Service View\r\n    description: An order-able Service defined in Service Catalog.\r\n    type: object\r\n    properties:\r\n      id:\r\n        title: Service Identifier\r\n        description: unique identifier for the service\r\n        type: string\r\n        format: uuid\r\n        example: 3377f6e7-dd55-4639-bc54-65646fde2adc\r\n      name:\r\n        title: Service Name\r\n        description: name for the service\r\n        type: string\r\n        example: OpenStack Service\r\n      version:\r\n        title: Service Version\r\n        description: labeled variant of the service\r\n        type: string\r\n        example: Newton\r\n      tenant_id:\r\n        title: Service Providers Tenant\r\n        description: The Tenant identifier for the Tenant providing the service\r\n        type: string\r\n        format: uuid\r\n        example: 3377f6e7-dd55-4639-bc54-65646fde2adc\r\n      location:\r\n        title: Service Location\r\n        description: location of the service\r\n        type: string\r\n        example: ALLN\r\n      region:\r\n        title: Service Region\r\n        description: region of the service\r\n        type: string\r\n        example: US-EAST\r\n      status:\r\n        title: Service Status\r\n        description: status of the service\r\n        type: string\r\n        enum: [CREATING, ACTIVE, UPDATING, DELETING, INACTIVE, DELETED, FAILED]\r\n        example: ACTIVE\r\n      tags:\r\n        title: Service Tags\r\n        description: tags to identify service properties\r\n        type: array\r\n        items:\r\n          type: string\r\n        x-omitempty: true\r\n        example: [LA, ALPHA]\r\n      metadata:\r\n        title: Service Metadata\r\n        description: metadata of the service\r\n        type: object\r\n        additionalProperties:\r\n          type: string\r\n      audit:\r\n        $ref: \"#/definitions/audit\"\r\n\r\n  unit_view:\r\n    title: Service Unit View\r\n    description: A Service Unit for the Location defined in Service Catalog.\r\n    type: object\r\n    properties:\r\n      id:\r\n        title: Service Unit Identifier\r\n        description: unique identifier for the service unit\r\n        type: string\r\n        format: uuid\r\n        example: 3377f6e7-dd55-4639-bc54-65646fde2adc\r\n      name:\r\n        title: Service Unit Name\r\n        description: name for the service unit\r\n        type: string\r\n        example: Example Service Unit\r\n      type:\r\n        title: Service Unit Type\r\n        description: type of the service unit\r\n        type: string\r\n        example: VCPU\r\n      description:\r\n        title: Service Unit Description\r\n        description: summary describing the service unit\r\n        type: string\r\n        example: Long description about the service unit\r\n      cost:\r\n        title: Service Unit Cost\r\n        description: cost for the service unit\r\n        type: number\r\n        format: double\r\n        example: 0.02\r\n      period:\r\n        title: Service Unit Cost Period\r\n        description: cost period for the service unit\r\n        type: string\r\n        enum: [FLAT, HOURLY, MONTHLY]\r\n        example: HOURLY\r\n      cost_algorithm:\r\n        title: Service Unit Consumption Cost Algorithm\r\n        description: consumption cost algorithm for the service unit\r\n        type: string\r\n        enum: [SIMPLE_SUM, DAILY_MAX_AVG]\r\n        example: SIMPLE_SUM\r\n      quotas:\r\n        title: Service Unit Quotas\r\n        description: quotas defined for the service unit\r\n        type: object\r\n        additionalProperties:\r\n          $ref: '#/definitions/quota'\r\n      activated_at:\r\n         title: Service Unit Cost Activation Timestamp\r\n         description: >\r\n             service unit activation date (inclusive) as YYYY-MM-DD with respect to the billing period\r\n             always as the start of the billing period\r\n         type: string\r\n         example: 2018-02-01\r\n      deactivated_at:\r\n         title: Service Unit Cost Deactivation Timestamp\r\n         description: >\r\n             service unit deactivation date (exclusive) as YYYY-MM-DD with respect to the billing period\r\n             - omitted if empty or the end of the billing period\r\n         type: string\r\n         example: 2018-03-01\r\n      audit:\r\n        $ref: \"#/definitions/audit\"\r\n\r\n  quota:\r\n     title: Service Unit Quota\r\n     description: quota details with values\r\n     type: object\r\n     properties:\r\n       min:\r\n         title: Minimum quota value\r\n         type: number\r\n         format: double\r\n         minimum: 0.0\r\n         example: 1.0\r\n       max:\r\n         title: Maximum quota value\r\n         type: number\r\n         format: double\r\n         minimum: 0.0\r\n         example: 1.0\r\n       default:\r\n         title: Default quota value\r\n         type: number\r\n         format: double\r\n         minimum: 0.0\r\n         example: 1.0\r\n\r\n  audit:\r\n    title: Audit\r\n    description: Audit trail details\r\n    type: object\r\n    properties:\r\n      created_at:\r\n        title: Created At\r\n        description: timestamp when the record was created\r\n        type: string\r\n        format: date-time\r\n        readOnly: true\r\n      created_by:\r\n        title: Created By\r\n        description: entity that created the record\r\n        type: string\r\n        readOnly: true\r\n      updated_at:\r\n        title: Updated At\r\n        description: timestamp when the record was updated\r\n        type: string\r\n        format: date-time\r\n        readOnly: true\r\n      updated_by:\r\n        title: Updated By\r\n        description: entity that updated the record\r\n        type: string\r\n        readOnly: true\r\n\r\n  error:\r\n    title: Error\r\n    description: |\r\n      An error provides information about why the request failed.\r\n    type: object\r\n    required:\r\n      - code\r\n      - message\r\n    properties:\r\n      code:\r\n        title: Code\r\n        description: |\r\n            Code identifies a specific type of error.\r\n        type: string\r\n      message:\r\n        title: Message\r\n        description: |\r\n          The message provides details about the failure.\r\n        type: string\r\n\r\nresponses:\r\n  400:\r\n    description: |\r\n      Invalid Request Error. Check error message in the response body for details.\r\n    examples:\r\n      application/json:\r\n        code: EXAMPLE-001\r\n        message: Missing required attribute 'name'.\r\n    headers:\r\n      X-Request-Id:\r\n        description: Unique identifier associated with request\r\n        type: string\r\n        format: uuid\r\n    schema:\r\n      $ref: \"#/definitions/error\"\r\n  401:\r\n    description: |\r\n      Authentication Failure\r\n    examples:\r\n      application/json:\r\n        code: EXAMPLE-002\r\n        message: Authentication failed bad password.\r\n    headers:\r\n      X-Request-Id:\r\n        description: Unique identifier associated with request\r\n        type: string\r\n        format: uuid\r\n    schema:\r\n      $ref: \"#/definitions/error\"\r\n  402:\r\n    description: |\r\n      Insufficient Funds\r\n    examples:\r\n      application/json:\r\n        code: EXAMPLE-003\r\n        message: Insufficient Funds to cover the cost of resource.\r\n    headers:\r\n      X-Request-Id:\r\n        description: Unique identifier associated with request\r\n        type: string\r\n        format: uuid\r\n    schema:\r\n      $ref: \"#/definitions/error\"\r\n  403:\r\n    description: |\r\n      Authorization Failure\r\n    examples:\r\n      application/json:\r\n        code: EXAMPLE-004\r\n        message: Not authorized to perform action.\r\n    headers:\r\n      X-Request-Id:\r\n        description: Unique identifier associated with request\r\n        type: string\r\n        format: uuid\r\n    schema:\r\n      $ref: \"#/definitions/error\"\r\n  404:\r\n    description: |\r\n      Resource not found\r\n    examples:\r\n      application/json:\r\n        code: EXAMPLE-005\r\n        message: Resource <id> does not exist.\r\n    headers:\r\n      X-Request-Id:\r\n        description: Unique identifier associated with request\r\n        type: string\r\n        format: uuid\r\n    schema:\r\n      $ref: \"#/definitions/error\"\r\n  409:\r\n    description: |\r\n      Conflict\r\n    examples:\r\n      application/json:\r\n        code: EXAMPLE-006\r\n        message: Resource already exists.\r\n    headers:\r\n      X-Request-Id:\r\n        description: Unique identifier associated with request\r\n        type: string\r\n        format: uuid\r\n    schema:\r\n      $ref: \"#/definitions/error\"\r\n  422:\r\n    description: |\r\n      Unprocessable Entity Failure\r\n    examples:\r\n      application/json:\r\n        code: EXAMPLE-007\r\n        message: Resource is not able to be updated.\r\n    headers:\r\n      X-Request-Id:\r\n        description: Unique identifier associated with request\r\n        type: string\r\n        format: uuid\r\n    schema:\r\n      $ref: \"#/definitions/error\"\r\n  500:\r\n    description: |\r\n      Internal Server Error. Check error entity in the response body for details.\r\n    examples:\r\n      application/json:\r\n        code: EXAMPLE-009\r\n        message: Internal server error.\r\n    headers:\r\n      X-Request-Id:\r\n        description: Unique identifier associated with request\r\n        type: string\r\n        format: uuid\r\n    schema:\r\n      $ref: \"#/definitions/error\"\r\n  503:\r\n    description: |\r\n      Service Unavailable\r\n    examples:\r\n      application/json:\r\n        code: EXAMPLE-010\r\n        message: Service Unavailable.\r\n    headers:\r\n      X-Request-Id:\r\n        description: Unique identifier associated with request\r\n        type: string\r\n        format: uuid\r\n    schema:\r\n      $ref: \"#/definitions/error\"\r\n```\r\n\r\n## Steps to reproduce\r\n\r\n```\r\nswagger generate server -A manager -a ops -f api.yml\r\n```\r\n\r\n## Environment\r\nswagger version: master  \r\ngo version: 1.11.1  \r\nOS: alpine\r\n\r\n\r\n","closed_by":{"login":"casualjim","id":456109,"node_id":"MDQ6VXNlcjQ1NjEwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/456109?v=4","gravatar_id":"","url":"https://api.github.com/users/casualjim","html_url":"https://github.com/casualjim","followers_url":"https://api.github.com/users/casualjim/followers","following_url":"https://api.github.com/users/casualjim/following{/other_user}","gists_url":"https://api.github.com/users/casualjim/gists{/gist_id}","starred_url":"https://api.github.com/users/casualjim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/casualjim/subscriptions","organizations_url":"https://api.github.com/users/casualjim/orgs","repos_url":"https://api.github.com/users/casualjim/repos","events_url":"https://api.github.com/users/casualjim/events{/privacy}","received_events_url":"https://api.github.com/users/casualjim/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/go-swagger/go-swagger/issues/1816/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/go-swagger/go-swagger/issues/1816/timeline","performed_via_github_app":null,"state_reason":"completed"}