{"url":"https://api.github.com/repos/go-swagger/go-swagger/issues/132","repository_url":"https://api.github.com/repos/go-swagger/go-swagger","labels_url":"https://api.github.com/repos/go-swagger/go-swagger/issues/132/labels{/name}","comments_url":"https://api.github.com/repos/go-swagger/go-swagger/issues/132/comments","events_url":"https://api.github.com/repos/go-swagger/go-swagger/issues/132/events","html_url":"https://github.com/go-swagger/go-swagger/issues/132","id":118431580,"node_id":"MDU6SXNzdWUxMTg0MzE1ODA=","number":132,"title":"models: missing optional fields must not be rejected by validators and must have a distinguishable zero value","user":{"login":"dolmen","id":129536,"node_id":"MDQ6VXNlcjEyOTUzNg==","avatar_url":"https://avatars.githubusercontent.com/u/129536?v=4","gravatar_id":"","url":"https://api.github.com/users/dolmen","html_url":"https://github.com/dolmen","followers_url":"https://api.github.com/users/dolmen/followers","following_url":"https://api.github.com/users/dolmen/following{/other_user}","gists_url":"https://api.github.com/users/dolmen/gists{/gist_id}","starred_url":"https://api.github.com/users/dolmen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dolmen/subscriptions","organizations_url":"https://api.github.com/users/dolmen/orgs","repos_url":"https://api.github.com/users/dolmen/repos","events_url":"https://api.github.com/users/dolmen/events{/privacy}","received_events_url":"https://api.github.com/users/dolmen/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":148436504,"node_id":"MDU6TGFiZWwxNDg0MzY1MDQ=","url":"https://api.github.com/repos/go-swagger/go-swagger/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/go-swagger/go-swagger/milestones/1","html_url":"https://github.com/go-swagger/go-swagger/milestone/1","labels_url":"https://api.github.com/repos/go-swagger/go-swagger/milestones/1/labels","id":1161275,"node_id":"MDk6TWlsZXN0b25lMTE2MTI3NQ==","number":1,"title":"Minimal first release","description":"This first release is focussed on getting a baseline in functionality set.\r\n\r\nIt should however promise API stability to support the entire planned feature set:\r\n\r\nBaseline functionality: \r\n\r\n* validate a spec, including extended validations\r\n* generate a client from a spec\r\n* generate a spec through go code analysis\r\n* generate a server from a spec\r\n\r\nAPI stability:\r\n\r\n* serialization format agnostic\r\n* transport agnostic, this should be a matter of config\r\n* validation for client and server ","creator":{"login":"casualjim","id":456109,"node_id":"MDQ6VXNlcjQ1NjEwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/456109?v=4","gravatar_id":"","url":"https://api.github.com/users/casualjim","html_url":"https://github.com/casualjim","followers_url":"https://api.github.com/users/casualjim/followers","following_url":"https://api.github.com/users/casualjim/following{/other_user}","gists_url":"https://api.github.com/users/casualjim/gists{/gist_id}","starred_url":"https://api.github.com/users/casualjim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/casualjim/subscriptions","organizations_url":"https://api.github.com/users/casualjim/orgs","repos_url":"https://api.github.com/users/casualjim/repos","events_url":"https://api.github.com/users/casualjim/events{/privacy}","received_events_url":"https://api.github.com/users/casualjim/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":61,"state":"closed","created_at":"2015-06-12T03:22:12Z","updated_at":"2016-01-04T02:34:41Z","due_on":"2016-01-10T08:00:00Z","closed_at":"2016-01-04T02:34:41Z"},"comments":2,"created_at":"2015-11-23T17:33:22Z","updated_at":"2016-01-07T16:14:39Z","closed_at":"2015-12-25T05:03:36Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"The model and its `validate` method generated by `swagger generate models` should properly handle optional properties (properties not mentionned as `required`).\n\nCurrently optional properties that are not filled are rejected if they do not match a valid value.\n\nInstead, the zero value should be used to detect if the property has not been set. If the zero value of the property is a valid value for the property, the type of the property in the generated model should be a pointer in order to allow `nil`. For example, for a `string` property that has `minLength >= 1`, the empty string (\"\") can be used to distinguish a case where the property is not set, so a `string` type is ok. If `minLength == 0`, `*string` should be used.\n\nHere is a (failing) test case:\n\n``` go\n// Dump this in a `models/pet_test.go` file with petstore.json (from Swagger), then:\n//   cd models; go generate; go test -v\npackage models\n\n//go:generate swagger generate model -t .. -m models -n Pet -f ../petstore.json\n//go:generate swagger generate model -t .. -m models -n Category -f ../petstore.json\n//go:generate swagger generate model -t .. -m models -n Tag -f ../petstore.json\n\nimport (\n    \"encoding/json\"\n    \"github.com/go-swagger/go-swagger/strfmt\"\n    \"testing\"\n)\n\nfunc TestValidateOptionalFields(t *testing.T) {\n    // Only name and photoUrls are required\n    in := []byte(`{\"name\":\"\",\"photoUrls\":[]}`)\n    var pet Pet\n    if err := json.Unmarshal(in, &pet); err != nil {\n        t.FailNow()\n    }\n\n    validators := strfmt.NewFormats()\n\n    if err := pet.Validate(validators); err != nil {\n        t.Log(err)\n        t.FailNow()\n    }\n}\n```\n\nOutput:\n\n```\n=== RUN   TestValidateOptionalFields\n--- FAIL: TestValidateOptionalFields (0.00s)\n    pet_test.go:24: validation failure list:\n        status in body should be one of [available pending sold]\nFAIL\nexit status 1\nFAIL    github.com/dolmen/go-swagger-petstore/models    0.128s\n```\n\nThe `status` property is not marked as required in petstore.json `Pet`. The empty string is not a valid value for the enum, so the empty string should be accepted as _unset_ value.\n","closed_by":{"login":"casualjim","id":456109,"node_id":"MDQ6VXNlcjQ1NjEwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/456109?v=4","gravatar_id":"","url":"https://api.github.com/users/casualjim","html_url":"https://github.com/casualjim","followers_url":"https://api.github.com/users/casualjim/followers","following_url":"https://api.github.com/users/casualjim/following{/other_user}","gists_url":"https://api.github.com/users/casualjim/gists{/gist_id}","starred_url":"https://api.github.com/users/casualjim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/casualjim/subscriptions","organizations_url":"https://api.github.com/users/casualjim/orgs","repos_url":"https://api.github.com/users/casualjim/repos","events_url":"https://api.github.com/users/casualjim/events{/privacy}","received_events_url":"https://api.github.com/users/casualjim/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/go-swagger/go-swagger/issues/132/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/go-swagger/go-swagger/issues/132/timeline","performed_via_github_app":null,"state_reason":"completed"}