<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:31:21 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SCXML-8] [scxml] External Digester does not addCustomActions</title>
                <link>https://issues.apache.org/jira/browse/SCXML-8</link>
                <project id="12310492" key="SCXML">Commons SCXML</project>
                    <description>&lt;p&gt;I was not sure where to put my test-case. So attaching it here.&lt;/p&gt;

&lt;p&gt;/*&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Copyright 2006 The Apache Software Foundation.&lt;br/&gt;
 *&lt;/li&gt;
	&lt;li&gt;Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);&lt;/li&gt;
	&lt;li&gt;you may not use this file except in compliance with the License.&lt;/li&gt;
	&lt;li&gt;You may obtain a copy of the License at&lt;br/&gt;
 *&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
 *&lt;/li&gt;
	&lt;li&gt;Unless required by applicable law or agreed to in writing, software&lt;/li&gt;
	&lt;li&gt;distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;/li&gt;
	&lt;li&gt;WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;/li&gt;
	&lt;li&gt;See the License for the specific language governing permissions and&lt;/li&gt;
	&lt;li&gt;limitations under the License.&lt;br/&gt;
 */&lt;br/&gt;
package org.apache.commons.scxml.model;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;import java.net.URL;&lt;/p&gt;

&lt;p&gt;import junit.framework.Test;&lt;br/&gt;
import junit.framework.TestCase;&lt;br/&gt;
import junit.framework.TestSuite;&lt;/p&gt;

&lt;p&gt;import org.apache.commons.digester.Digester;&lt;br/&gt;
import org.apache.commons.scxml.Context;&lt;br/&gt;
import org.apache.commons.scxml.Evaluator;&lt;br/&gt;
import org.apache.commons.scxml.SCXMLExecutor;&lt;br/&gt;
import org.apache.commons.scxml.SCXMLTestHelper;&lt;br/&gt;
import org.apache.commons.scxml.env.jexl.JexlContext;&lt;br/&gt;
import org.apache.commons.scxml.env.jexl.JexlEvaluator;&lt;br/&gt;
import org.apache.commons.scxml.io.SCXMLDigester;&lt;br/&gt;
import org.apache.commons.scxml.model.SCXML;&lt;br/&gt;
import org.apache.commons.scxml.model.State;&lt;/p&gt;

&lt;p&gt;public class ExternalCustomActionTest extends TestCase {&lt;/p&gt;

&lt;p&gt;    public ExternalCustomActionTest(String testName) &lt;/p&gt;
{
        super(testName);
    }

&lt;p&gt;    public static Test suite() &lt;/p&gt;
{
        return new TestSuite(ExternalCustomActionTest.class);
    }

&lt;p&gt;    public static void main(String args[]) {&lt;br/&gt;
        String[] testCaseName = &lt;/p&gt;
{ ExternalCustomActionTest.class.getName()}
&lt;p&gt;;&lt;br/&gt;
        junit.textui.TestRunner.main(testCaseName);&lt;br/&gt;
    }&lt;/p&gt;

&lt;p&gt;    private URL externalhello01, custom01;&lt;br/&gt;
    private Digester digester;&lt;br/&gt;
    private SCXMLExecutor exec;&lt;/p&gt;

&lt;p&gt;    /**&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Set up instance variables required by this test case.&lt;br/&gt;
     */&lt;br/&gt;
    public void setUp() 
{
        externalhello01 = this.getClass().getClassLoader().
            getResource(&quot;org/apache/commons/scxml/external-hello-world.xml&quot;);
        custom01 = this.getClass().getClassLoader().
            getResource(&quot;org/apache/commons/scxml/custom-hello-world.xml&quot;);
    }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    /**&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Tear down instance variables required by this test case.&lt;br/&gt;
     */&lt;br/&gt;
    public void tearDown() 
{
    	externalhello01 = custom01 = null;
        digester = null;
        exec = null;
    }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    // Hello World example using the SCXML &amp;lt;log&amp;gt; action&lt;br/&gt;
    public void testHelloWorld() {&lt;br/&gt;
        // (1) Get Digester with &quot;default&quot; rules for parsing SCXML documents&lt;br/&gt;
        digester = SCXMLDigester.newInstance(null, null);&lt;br/&gt;
        // (2) Register the &quot;custom&quot; action(s)&lt;br/&gt;
        SCXMLDigester.addCustomAction(digester,&lt;br/&gt;
            &quot;http://my.custom-actions.domain/CUSTOM&quot;, &quot;hello&quot;, Hello.class);&lt;br/&gt;
        // (3) Parse the SCXML document containing the custom action(s)&lt;br/&gt;
        SCXML scxml = null;&lt;br/&gt;
        try &lt;/p&gt;
{
            scxml = (SCXML) digester.parse(externalhello01.toString());
        }
&lt;p&gt; catch (Exception e) &lt;/p&gt;
{
        	e.printStackTrace();
            fail(e.getMessage());
        }&lt;br/&gt;
        // (4) Wire up the object model for the SCXMLExecutor&lt;br/&gt;
        SCXMLDigester.updateSCXML(scxml);&lt;br/&gt;
        // (5) Get a SCXMLExecutor&lt;br/&gt;
        Context context = new JexlContext();&lt;br/&gt;
        Evaluator evaluator = new JexlEvaluator();&lt;br/&gt;
        exec = SCXMLTestHelper.getExecutor(scxml, context, evaluator);&lt;br/&gt;
        // (6) Single, final state&lt;br/&gt;
        assertEquals(&quot;external-hello&quot;, ((State) exec.getCurrentStatus().getStates().&lt;br/&gt;
                iterator().next()).getId());&lt;br/&gt;
        assertEquals (&quot;external world&quot;, context.get(&quot;custom&quot;));&lt;br/&gt;
    }&lt;br/&gt;
&lt;br/&gt;
    // Hello World example using a custom &amp;lt;hello&amp;gt; action&lt;br/&gt;
    public void testCustomActionHelloWorld() {&lt;br/&gt;
        // (1) Get Digester with &quot;default&quot; rules for parsing SCXML documents&lt;br/&gt;
        digester = SCXMLDigester.newInstance(null, null);&lt;br/&gt;
        // (2) Register the &quot;custom&quot; action(s)&lt;br/&gt;
        SCXMLDigester.addCustomAction(digester,&lt;br/&gt;
            &quot;http://my.custom-actions.domain/CUSTOM&quot;, &quot;hello&quot;, Hello.class);&lt;br/&gt;
        // (3) Parse the SCXML document containing the custom action(s)&lt;br/&gt;
        SCXML scxml = null;&lt;br/&gt;
        try {
            scxml = (SCXML) digester.parse(custom01.toString());
        } catch (Exception e) {        	e.printStackTrace();            fail(e.getMessage());        }
&lt;p&gt;        // (4) Wire up the object model for the SCXMLExecutor&lt;br/&gt;
        SCXMLDigester.updateSCXML(scxml);&lt;br/&gt;
        // (5) Get a SCXMLExecutor&lt;br/&gt;
        Context context = new JexlContext();&lt;br/&gt;
        Evaluator evaluator = new JexlEvaluator();&lt;br/&gt;
        exec = SCXMLTestHelper.getExecutor(scxml, context, evaluator);&lt;br/&gt;
        // (6) Fire events, proceed as usual&lt;br/&gt;
        assertEquals(&quot;external-hello&quot;, ((State) exec.getCurrentStatus().getStates().&lt;br/&gt;
                iterator().next()).getId());&lt;br/&gt;
        assertEquals (&quot;external world&quot;, context.get(&quot;custom&quot;));&lt;br/&gt;
    }&lt;br/&gt;
}&lt;/p&gt;

&lt;p&gt;&amp;lt;?xml version=&quot;1.0&quot;?&amp;gt;&lt;br/&gt;
&amp;lt;scxml xmlns=&quot;http://www.w3.org/2005/07/SCXML&quot;&lt;br/&gt;
       xmlns:my=&quot;http://my.custom-actions.domain/CUSTOM&quot;&lt;br/&gt;
       version=&quot;1.0&quot;&lt;br/&gt;
       initialstate=&quot;external-hello&quot;&amp;gt;&lt;/p&gt;

&lt;p&gt;    &amp;lt;state id=&quot;external-hello&quot;&amp;gt;&lt;br/&gt;
        &amp;lt;onentry&amp;gt;&lt;br/&gt;
            &amp;lt;my:hello name=&quot;external world&quot;/&amp;gt;&lt;br/&gt;
        &amp;lt;/onentry&amp;gt;&lt;br/&gt;
    &amp;lt;/state&amp;gt;&lt;/p&gt;

&lt;p&gt;&amp;lt;/scxml&amp;gt;&lt;/p&gt;



&lt;p&gt;&amp;lt;?xml version=&quot;1.0&quot;?&amp;gt;&lt;br/&gt;
&amp;lt;scxml xmlns=&quot;http://www.w3.org/2005/07/SCXML&quot;&lt;br/&gt;
       xmlns:my=&quot;http://my.custom-actions.domain/CUSTOM&quot;&lt;br/&gt;
       version=&quot;1.0&quot;&lt;br/&gt;
       initialstate=&quot;custom&quot;&amp;gt;&lt;br/&gt;
	&amp;lt;datamodel/&amp;gt;&lt;br/&gt;
    &amp;lt;state id=&quot;custom&quot; final=&quot;true&quot;&lt;br/&gt;
src=&quot;test/org/apache/commons/scxml/external-hello-world.xml&quot;/&amp;gt;&lt;br/&gt;
&amp;lt;/scxml&amp;gt;&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: other&lt;br/&gt;
Platform: Other&lt;/p&gt;</environment>
        <key id="12343071">SCXML-8</key>
            <summary>[scxml] External Digester does not addCustomActions</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="fasihullah.askiri@gmail.com">Fasihullah</reporter>
                        <labels>
                    </labels>
                <created>Wed, 10 May 2006 00:33:38 +0000</created>
                <updated>Thu, 3 Jan 2008 19:46:48 +0000</updated>
                            <resolved>Thu, 18 May 2006 09:22:40 +0000</resolved>
                                                    <fixVersion>0.5</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12411863" author="rahul@apache.org" created="Wed, 10 May 2006 04:53:48 +0000"  >&lt;p&gt;Indeed, the approach to adding custom actions after calling newInstance() on &lt;br/&gt;
the digester does not address the case where the external documents pulled in &lt;br/&gt;
contain custom actions. It seems best to take this opportunity to refactor a &lt;br/&gt;
couple of related bits in the SCXMLDigester related to custom action parsing.&lt;/p&gt;

&lt;p&gt;Thanks for reporting this, I&apos;ll take a look later tonight.&lt;/p&gt;
</comment>
                            <comment id="12411864" author="fasihullah.askiri@gmail.com" created="Wed, 10 May 2006 05:50:29 +0000"  >&lt;p&gt;I think that this approach is &quot;weird&quot; if nothing else &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;br/&gt;
I guess a cleaner approach would be to go the Xalan way, either have an entity&lt;br/&gt;
resolver to find out the mapping or support java: namespace,&lt;br/&gt;
the second would be a lot more easier/intuitive to use.&lt;br/&gt;
in my example I would have used&lt;br/&gt;
xmlns:hello=&quot;java://com.mycompany.customactions.Hello&quot;&lt;br/&gt;
instead of the &lt;br/&gt;
xmlns:hello=&quot;http://some.bakar.com/HELLO&quot;&lt;br/&gt;
Which does not serve any purpose at all!!&lt;br/&gt;
hello:sayhi would call Hello.sayhi&lt;/p&gt;

&lt;p&gt;However, doing this would mean a lot of change, also, it will mean that the old&lt;br/&gt;
code where ppl implemented SayHi.class to say a hi will be deprecated (Though&lt;br/&gt;
not broken, they should still be able to do what they do, only the java:&lt;br/&gt;
namespace can have this semantic)&lt;/p&gt;

&lt;p&gt;Anyways, this was just my thought. &lt;br/&gt;
(In reply to comment #1)&lt;br/&gt;
&amp;gt; Indeed, the approach to adding custom actions after calling newInstance() on &lt;br/&gt;
&amp;gt; the digester does not address the case where the external documents pulled in &lt;br/&gt;
&amp;gt; contain custom actions. It seems best to take this opportunity to refactor a &lt;br/&gt;
&amp;gt; couple of related bits in the SCXMLDigester related to custom action parsing.&lt;br/&gt;
&amp;gt; &lt;br/&gt;
&amp;gt; Thanks for reporting this, I&apos;ll take a look later tonight.&lt;br/&gt;
&amp;gt; &lt;br/&gt;
&amp;gt; &lt;/p&gt;
</comment>
                            <comment id="12411865" author="rahul@apache.org" created="Thu, 11 May 2006 03:04:34 +0000"  >&lt;p&gt;That will definitely be a larger change for the users, but also conceptually, &lt;br/&gt;
since the custom actions are meant to be in other XML namespaces, the approach &lt;br/&gt;
used is similar to how Mozilla does XTF for its plugins (you define a backing &lt;br/&gt;
bean for each element in the namespace). If we take the POJO approach, then it &lt;br/&gt;
does imply higher reflection overheads (at runtime, reflection is our bread-n-&lt;br/&gt;
butter at parsing time) and is probably strange as an XML namespace. After &lt;br/&gt;
all, the actions are called custom actions since their utility and &lt;br/&gt;
implementation preferences are subjective.&lt;/p&gt;

&lt;p&gt;As a library, Commons SCXML provides opportunities to customize most of its &lt;br/&gt;
internals, be it parsing, custom actions or engine semantics. Together, these &lt;br/&gt;
should allow users to build atop with their ideas (and the useful ones can &lt;br/&gt;
hopefully come back in to Commons SCXML). There is only so much that will come &lt;br/&gt;
out of the box, especially for the first release. I have some cleanup done &lt;br/&gt;
that fixes this issue about not parsing custom actions in &quot;src&apos;ed in&quot; &lt;br/&gt;
documents, but the repository seems down ATM.&lt;/p&gt;</comment>
                            <comment id="12412281" author="rahul@apache.org" created="Thu, 18 May 2006 09:22:40 +0000"  >&lt;p&gt;Fixed in r407424, should appear in 05182006 nightlies.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>39534</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>172665</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            19 years, 28 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0zyvz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>207954</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>