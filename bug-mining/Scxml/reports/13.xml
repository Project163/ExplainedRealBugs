<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:31:26 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SCXML-52] Error on resolving conflicting transitions for compound states</title>
                <link>https://issues.apache.org/jira/browse/SCXML-52</link>
                <project id="12310492" key="SCXML">Commons SCXML</project>
                    <description>&lt;p&gt;There seems to be a problem on the resolution of conflicting transitions for compound states. See the following scxml document:&lt;/p&gt;

&lt;p&gt;&amp;lt;scxml xmlns=&quot;http://www.w3.org/2005/07/scxml&quot; version=&quot;1.0&quot; initialstate=&quot;s1&quot;&amp;gt;&lt;br/&gt;
    &amp;lt;datamodel&amp;gt;&lt;br/&gt;
        &amp;lt;data name=&quot;x&quot;/&amp;gt;&lt;br/&gt;
    &amp;lt;/datamodel&amp;gt;&lt;/p&gt;

&lt;p&gt;    &amp;lt;state id=&quot;s1&quot;&amp;gt;&lt;br/&gt;
        &amp;lt;initial&amp;gt;&lt;br/&gt;
            &amp;lt;transition target=&quot;s11&quot;/&amp;gt;&lt;br/&gt;
        &amp;lt;/initial&amp;gt;&lt;/p&gt;

&lt;p&gt;        &amp;lt;transition event=&quot;event_1&quot;&amp;gt;&lt;br/&gt;
            &amp;lt;assign name=&quot;x&quot;  expr=&quot;&apos;s1&apos;&quot;/&amp;gt;&lt;br/&gt;
        &amp;lt;/transition&amp;gt;&lt;/p&gt;

&lt;p&gt;       &amp;lt;transition event=&quot;event_2&quot; target=&quot;s1&quot;&amp;gt;&lt;br/&gt;
            &amp;lt;assign name=&quot;x&quot;  expr=&quot;&apos;s1&apos;&quot;/&amp;gt;&lt;br/&gt;
        &amp;lt;/transition&amp;gt;&lt;/p&gt;

&lt;p&gt;        &amp;lt;state id=&quot;s11&quot;&amp;gt;&lt;br/&gt;
            &amp;lt;transition event=&quot;event_1&quot;&amp;gt;&lt;br/&gt;
                       &amp;lt;assign name=&quot;x&quot;  expr=&quot;&apos;s11&apos;&quot;/&amp;gt;&lt;br/&gt;
            &amp;lt;/transition&amp;gt;&lt;br/&gt;
           &amp;lt;transition event=&quot;event_2&quot; target=&quot;s11&quot;&amp;gt;&lt;br/&gt;
                       &amp;lt;assign name=&quot;x&quot;  expr=&quot;&apos;s11&apos;&quot;/&amp;gt;&lt;br/&gt;
            &amp;lt;/transition&amp;gt;&lt;br/&gt;
        &amp;lt;/state&amp;gt;&lt;br/&gt;
    &amp;lt;/state&amp;gt;&lt;/p&gt;

&lt;p&gt;    &amp;lt;state id=&quot;s2&quot; final=&quot;true&quot; /&amp;gt;&lt;br/&gt;
&amp;lt;/scxml&amp;gt;&lt;/p&gt;

&lt;p&gt;The state machine enters a compound state s1 which contains another state s11 as its intitial state. Both states have transitions on event_1 and event_2. Note that event_1 has no target, whereas event_2 has a target towards the same state.&lt;/p&gt;

&lt;p&gt;For event_2 everything works as expected, i.e. only the transition on state s11 is executed and therefor s11 is reentered (I have a listener in my environment and can monitor this). &lt;/p&gt;

&lt;p&gt;The error occurs at event_1. On event_1 both transitions of s1 &lt;em&gt;and&lt;/em&gt; s11 are executed - but only once. After this, the state machine gets stuck (in particular the currentStates-List is empty). Any subsequent event will not cause any further action.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12374864">SCXML-52</key>
            <summary>Error on resolving conflicting transitions for compound states</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="ingmar">Ingmar Kliche</reporter>
                        <labels>
                    </labels>
                <created>Fri, 27 Jul 2007 21:24:00 +0000</created>
                <updated>Thu, 3 Jan 2008 19:46:53 +0000</updated>
                            <resolved>Fri, 30 Nov 2007 23:48:25 +0000</resolved>
                                    <version>0.6</version>
                                    <fixVersion>0.7</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12516103" author="ingmar" created="Fri, 27 Jul 2007 21:26:20 +0000"  >&lt;p&gt;Here is a short test case:&lt;/p&gt;

&lt;p&gt;// Uses SCXMLParser (latest WD)&lt;br/&gt;
public void testSCXMLExecutorTransitions05Sample() {&lt;br/&gt;
        SCXML scxml = SCXMLTestHelper.parse(transitions05);&lt;br/&gt;
        assertNotNull(scxml);&lt;br/&gt;
        exec = SCXMLTestHelper.getExecutor(scxml);&lt;br/&gt;
        assertNotNull(exec);&lt;br/&gt;
        try &lt;/p&gt;
{
            Set currentStates = SCXMLTestHelper.fireEvent(exec, &quot;event_2&quot;);
            assertEquals(1, currentStates.size());

            currentStates = SCXMLTestHelper.fireEvent(exec, &quot;event_1&quot;);
            assertEquals(1, currentStates.size());

        }
&lt;p&gt; catch (Exception e) &lt;/p&gt;
{
            fail(e.getMessage());
        }
&lt;p&gt;    }&lt;/p&gt;

&lt;p&gt;Don&apos;t know if this is the right way to test it, but at least it shows that for event_1 the state machine is not in one state anymore (the list is empty).&lt;/p&gt;</comment>
                            <comment id="12516105" author="rahul@apache.org" created="Fri, 27 Jul 2007 21:45:20 +0000"  >&lt;p&gt;Thanks for the test case. I won&apos;t have any dev time this weekend, but will try to look at this next week.&lt;/p&gt;</comment>
                            <comment id="12517127" author="rahul@apache.org" created="Thu, 2 Aug 2007 02:37:13 +0000"  >&lt;p&gt;Fixed in trunk: &lt;a href=&quot;http://svn.apache.org/viewvc?view=rev&amp;amp;rev=561998&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?view=rev&amp;amp;rev=561998&lt;/a&gt; (also added a simplified version of your test case to the test suite).&lt;/p&gt;</comment>
                            <comment id="12519985" author="ingmar" created="Wed, 15 Aug 2007 14:51:04 +0000"  >&lt;p&gt;Unfortunately this fix introduced another bug. Now transitions in different regions of a parallel state machine are also discarded. Here is an example:&lt;/p&gt;

&lt;p&gt;&amp;lt;scxml version=&quot;1.0&quot; xmlns=&quot;http://www.w3.org/2005/07/scxml&quot; initialstate=&quot;main&quot; id=&quot;test&quot;&amp;gt;&lt;/p&gt;

&lt;p&gt;&amp;lt;state id = &quot;main&quot;&amp;gt;&lt;br/&gt;
	&amp;lt;parallel id =&quot;para&quot;&amp;gt;&lt;br/&gt;
		&amp;lt;state id=&quot;s1&quot;&amp;gt;&lt;br/&gt;
			&amp;lt;initial&amp;gt;&lt;br/&gt;
				&amp;lt;transition target=&quot;s11&quot;/&amp;gt;&lt;br/&gt;
			&amp;lt;/initial&amp;gt;&lt;br/&gt;
			&amp;lt;state id=&quot;s11&quot;&amp;gt;&lt;br/&gt;
				&amp;lt;transition event=&quot;event1&quot; target=&quot;s12&quot;/&amp;gt;&lt;br/&gt;
			&amp;lt;/state&amp;gt;&lt;br/&gt;
			&amp;lt;state id=&quot;s12&quot;&amp;gt;&lt;br/&gt;
			&amp;lt;/state&amp;gt;&lt;br/&gt;
		&amp;lt;/state&amp;gt;&lt;br/&gt;
		&amp;lt;state id=&quot;s2&quot;&amp;gt;&lt;br/&gt;
			&amp;lt;initial&amp;gt;&lt;br/&gt;
				&amp;lt;transition target=&quot;s21&quot;/&amp;gt;&lt;br/&gt;
			&amp;lt;/initial&amp;gt;&lt;br/&gt;
			&amp;lt;state id=&quot;s21&quot;&amp;gt;&lt;br/&gt;
				&amp;lt;transition event=&quot;event1&quot; target=&quot;s22&quot;/&amp;gt;&lt;br/&gt;
			&amp;lt;/state&amp;gt;&lt;br/&gt;
			&amp;lt;state id=&quot;s22&quot;&amp;gt;&lt;br/&gt;
			&amp;lt;/state&amp;gt;&lt;br/&gt;
		&amp;lt;/state&amp;gt;&lt;br/&gt;
	&amp;lt;/parallel&amp;gt;&lt;br/&gt;
&amp;lt;/state&amp;gt;&lt;br/&gt;
&amp;lt;/scxml&amp;gt;&lt;/p&gt;

&lt;p&gt;On triggering event &quot;event1&quot; one would expect that two transistions are executed. But only one will be taken.&lt;/p&gt;

&lt;p&gt;Here is a test case:&lt;/p&gt;

&lt;p&gt;    public void testTieBreaker05() {&lt;br/&gt;
        exec = SCXMLTestHelper.getExecutor(tiebreaker05);&lt;br/&gt;
        assertNotNull(exec);&lt;/p&gt;

&lt;p&gt;        Set currentStates = exec.getCurrentStatus().getStates();&lt;br/&gt;
        assertEquals(2, currentStates.size());&lt;br/&gt;
        String id = ((State)currentStates.iterator().next()).getId();&lt;br/&gt;
        Iterator iter = currentStates.iterator();&lt;/p&gt;

&lt;p&gt;        while (iter.hasNext()) &lt;/p&gt;
{
        	id = ((State)iter.next()).getId();
        	assertTrue(id.equals(&quot;s11&quot;) || id.equals(&quot;s21&quot;));
        }

&lt;p&gt;        currentStates = SCXMLTestHelper.fireEvent(exec, &quot;event1&quot;);&lt;br/&gt;
        assertEquals(2, currentStates.size());&lt;br/&gt;
        id = ((State)currentStates.iterator().next()).getId();&lt;br/&gt;
        iter = currentStates.iterator();&lt;/p&gt;

&lt;p&gt;        while (iter.hasNext()) &lt;/p&gt;
{
        	id = ((State)iter.next()).getId();
        	assertTrue(id.equals(&quot;s12&quot;) || id.equals(&quot;s22&quot;));
        }
&lt;p&gt;    }&lt;/p&gt;

&lt;p&gt;It shows that the the sub state machine remains in state s21 (i.e. only the transition s11 --&amp;gt; s12 is taken)&lt;/p&gt;

</comment>
                            <comment id="12520107" author="rahul@apache.org" created="Wed, 15 Aug 2007 21:49:02 +0000"  >&lt;p&gt;I remember thinking about this and intended to get clarification from the WG. I will post back once I do (probably a week, give and take).&lt;/p&gt;</comment>
                            <comment id="12521205" author="rahul@apache.org" created="Mon, 20 Aug 2007 19:22:25 +0000"  >&lt;p&gt;This has been fixed in trunk, and a test case added. If you are in a position to try a latest build, please do so, thanks.&lt;/p&gt;</comment>
                            <comment id="12521367" author="ingmar" created="Tue, 21 Aug 2007 09:09:33 +0000"  >&lt;p&gt;Hi Rahul,&lt;/p&gt;

&lt;p&gt;there is still an issue on a more complex use case with your fixed version.&lt;br/&gt;
Do you want me to send the test case to JIRA or shall I send it to you&lt;br/&gt;
directly?&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Ingmar.&lt;/li&gt;
&lt;/ul&gt;


</comment>
                            <comment id="12521370" author="ingmar" created="Tue, 21 Aug 2007 09:21:31 +0000"  >&lt;p&gt;Here is a use case which still not works:&lt;/p&gt;

&lt;p&gt;&amp;lt;?xml version=&quot;1.0&quot;?&amp;gt;&lt;br/&gt;
&amp;lt;scxml version=&quot;1.0&quot; xmlns=&quot;http://www.w3.org/2005/07/scxml&quot;&lt;br/&gt;
initialstate=&quot;main&quot; id=&quot;test&quot;&amp;gt;&lt;/p&gt;

&lt;p&gt; &amp;lt;datemodel&amp;gt;&lt;br/&gt;
  &amp;lt;data id=&quot;foo&quot; expr=&quot;&apos;1&apos;&quot;/&amp;gt;&lt;br/&gt;
  &amp;lt;data id=&quot;bar&quot; expr=&quot;&apos;1&apos;&quot;/&amp;gt;&lt;br/&gt;
 &amp;lt;/datemodel&amp;gt;&lt;br/&gt;
 &amp;lt;state id = &quot;main&quot;&amp;gt;&lt;br/&gt;
  &amp;lt;parallel id =&quot;parallel&quot;&amp;gt;&lt;br/&gt;
   &amp;lt;state id=&quot;s1&quot;&amp;gt;&lt;br/&gt;
    &amp;lt;initial&amp;gt;&lt;br/&gt;
     &amp;lt;transition target=&quot;s11&quot;/&amp;gt;&lt;br/&gt;
    &amp;lt;/initial&amp;gt;&lt;br/&gt;
    &amp;lt;state id=&quot;s11&quot;&amp;gt;&lt;br/&gt;
     &amp;lt;transition event=&quot;event1&quot;&amp;gt;&lt;br/&gt;
      &amp;lt;send event=&quot;interal_event1&quot;/&amp;gt;&lt;br/&gt;
      &amp;lt;send event=&quot;interal_event2&quot;/&amp;gt;&lt;br/&gt;
     &amp;lt;/transition&amp;gt;&lt;br/&gt;
     &amp;lt;transition event=&quot;event2&quot; cond=&quot;foo == 2 and bar == 2&quot; target=&quot;s12&quot;/&amp;gt;&lt;br/&gt;
    &amp;lt;/state&amp;gt;&lt;br/&gt;
    &amp;lt;state id=&quot;s12&quot;/&amp;gt;&lt;br/&gt;
   &amp;lt;/state&amp;gt;&lt;br/&gt;
   &amp;lt;state id=&quot;s2&quot;&amp;gt;&lt;br/&gt;
    &amp;lt;transition event=&quot;interal_event1&quot;&amp;gt;&lt;br/&gt;
     &amp;lt;assign name=&quot;foo&quot; expr=&quot;&apos;2&apos;&quot;/&amp;gt;&lt;br/&gt;
    &amp;lt;/transition&amp;gt;&lt;br/&gt;
    &amp;lt;transition event=&quot;interal_event2&quot;&amp;gt;&lt;br/&gt;
     &amp;lt;assign name=&quot;bar&quot; expr=&quot;&apos;2&apos;&quot;/&amp;gt;&lt;br/&gt;
    &amp;lt;/transition&amp;gt;&lt;br/&gt;
   &amp;lt;/state&amp;gt;&lt;br/&gt;
  &amp;lt;/parallel&amp;gt;&lt;br/&gt;
 &amp;lt;/state&amp;gt;&lt;br/&gt;
&amp;lt;/scxml&amp;gt;&lt;/p&gt;

&lt;p&gt;On event1 the state machine generates two internal events. While executing&lt;br/&gt;
the two internal events, the second transition on &quot;internal_event2&quot; gets&lt;br/&gt;
removed - which is not correct.&lt;/p&gt;
</comment>
                            <comment id="12521861" author="rahul@apache.org" created="Wed, 22 Aug 2007 17:21:35 +0000"  >&lt;p&gt;This is a combination of two things:&lt;/p&gt;

&lt;p&gt;1) Document order priority &amp;#8211; so on entering s1 below, T1 wins:&lt;/p&gt;

&lt;p&gt;  &amp;lt;state id=&quot;s1&quot;&amp;gt;&lt;br/&gt;
    &amp;lt;onentry&amp;gt;&lt;br/&gt;
      &amp;lt;send event=&quot;interal_event1&quot;/&amp;gt;&lt;br/&gt;
    &amp;lt;/onentry&amp;gt;&lt;br/&gt;
    &amp;lt;transition event=&quot;interal_event1&quot;/&amp;gt; &amp;lt;!-- T1 --&amp;gt;&lt;br/&gt;
    &amp;lt;transition event=&quot;interal_event1&quot;/&amp;gt; &amp;lt;!-- T2 --&amp;gt;&lt;br/&gt;
  &amp;lt;/state&amp;gt;&lt;/p&gt;

&lt;p&gt;2) Commons SCXML processes all &quot;generated&quot; events (includes implicit events and &amp;lt;send&amp;gt; usages such as above etc.) in the same subsequent microstep. Therefore, both transitions in your example become candidate transitions and the first in document order wins.&lt;/p&gt;

&lt;p&gt;Behavior in (2) is open to interpretation of the spec ATM, but interim, you may be able to &quot;chain&quot; your transitions to tease apart the two internal_events into their own microsteps, i.e.&lt;/p&gt;

&lt;p&gt;  &amp;lt;state id=&quot;s1&quot;&amp;gt;&lt;br/&gt;
    &amp;lt;onentry&amp;gt;&lt;br/&gt;
      &amp;lt;send event=&quot;interal_event1&quot;/&amp;gt;&lt;br/&gt;
    &amp;lt;/onentry&amp;gt;&lt;br/&gt;
    &amp;lt;transition event=&quot;interal_event1&quot;&amp;gt; &amp;lt;!-- T1 --&amp;gt;&lt;br/&gt;
      &amp;lt;send event=&quot;internal_event2&quot;/&amp;gt;&lt;br/&gt;
    &amp;lt;/transition&amp;gt;&lt;br/&gt;
    &amp;lt;transition event=&quot;interal_event2&quot;/&amp;gt; &amp;lt;!-- T2 --&amp;gt;&lt;br/&gt;
  &amp;lt;/state&amp;gt;&lt;/p&gt;

&lt;p&gt;I understand such chaining may not be possible across the board.&lt;/p&gt;</comment>
                            <comment id="12547340" author="rahul@apache.org" created="Fri, 30 Nov 2007 23:48:25 +0000"  >&lt;p&gt;Resolving since the initial issue recorded here has been fixed.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>172708</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            18 years ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0zz67:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>208000</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>