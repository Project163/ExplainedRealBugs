<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:32:06 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SCXML-206] Specification mismatch: event-less transitions are triggered by named events</title>
                <link>https://issues.apache.org/jira/browse/SCXML-206</link>
                <project id="12310492" key="SCXML">Commons SCXML</project>
                    <description>&lt;p&gt;The SCXML 2 specification indicates the following in section 3.13&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;A transition is enabled by NULL in atomic state S if a) T lacks an &apos;event&apos; attribute b) T&apos;s source state is S or an ancestor of S c) T lacks an &apos;cond&apos; attribute or its &apos;cond&apos; attribute evaluates to &quot;true&quot;. (Note that such a transition can never be enabled by any named event.)&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;The last aspect that event-less conditions can never be triggered by a named event is currently violated by the trunk implementation.&lt;/p&gt;

&lt;p&gt;Imagine the following example document:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-xml&quot;&gt;&amp;lt;scxml xmlns=&lt;span class=&quot;code-quote&quot;&gt;&quot;http://www.w3.org/2005/07/scxml&quot;&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;xmlns:rsb&lt;/span&gt;=&lt;span class=&quot;code-quote&quot;&gt;&quot;http://opensource.cit-ec.de/rsb&quot;&lt;/span&gt;
	version=&lt;span class=&quot;code-quote&quot;&gt;&quot;1.0&quot;&lt;/span&gt; initial=&lt;span class=&quot;code-quote&quot;&gt;&quot;Start&quot;&lt;/span&gt; name=&lt;span class=&quot;code-quote&quot;&gt;&quot;CustomActionSequential&quot;&lt;/span&gt;&amp;gt;
	&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;state id=&lt;span class=&quot;code-quote&quot;&gt;&quot;Start&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;onentry&amp;gt;&lt;/span&gt;
			&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;log expr=&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-quote&quot;&gt;&apos;Starting onentry of state Start&apos;&lt;/span&gt;&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/log&amp;gt;&lt;/span&gt;
			&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;send event=&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-quote&quot;&gt;&apos;test&apos;&lt;/span&gt;&quot;&lt;/span&gt; delay=&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-quote&quot;&gt;&apos;100ms&apos;&lt;/span&gt;&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/send&amp;gt;&lt;/span&gt;
			&amp;lt;rsb:generic rsb:class=&lt;span class=&quot;code-quote&quot;&gt;&quot;rsb.scxml.LongRunningAction&quot;&lt;/span&gt;
				name=&lt;span class=&quot;code-quote&quot;&gt;&quot;first&quot;&lt;/span&gt;&amp;gt;&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/rsb:generic&amp;gt;&lt;/span&gt;
			&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;log expr=&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-quote&quot;&gt;&apos;Finished onentry of state Start&apos;&lt;/span&gt;&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/log&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/onentry&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;onexit&amp;gt;&lt;/span&gt;
			&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;log expr=&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-quote&quot;&gt;&apos;onexit of state Start&apos;&lt;/span&gt;&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/log&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/onexit&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;transition target=&lt;span class=&quot;code-quote&quot;&gt;&quot;End&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/transition&amp;gt;&lt;/span&gt;
	&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/state&amp;gt;&lt;/span&gt;
	&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;final id=&lt;span class=&quot;code-quote&quot;&gt;&quot;End&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;onentry&amp;gt;&lt;/span&gt;
			&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;log expr=&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-quote&quot;&gt;&apos;onentry of state End&apos;&lt;/span&gt;&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/log&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/onentry&amp;gt;&lt;/span&gt;
	&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/final&amp;gt;&lt;/span&gt;
&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/scxml&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The rsb:generic action is simply a custom action that wastes some processing time by sleeping 1 second.&lt;/p&gt;

&lt;p&gt;The logging output that you get when executing this is the following:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Aug 29, 2014 11:04:26 AM org.apache.commons.scxml2.model.Log execute
INFO: null: Starting onentry of state Start
Aug 29, 2014 11:04:26 AM org.apache.commons.scxml2.model.Log execute
INFO: null: onexit of state Start
Aug 29, 2014 11:04:26 AM org.apache.commons.scxml2.model.Log execute
INFO: null: onentry of state End
Aug 29, 2014 11:04:27 AM org.apache.commons.scxml2.model.Log execute
INFO: null: Finished onentry of state Start
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;As you can see, the named event raised by the send action has triggered the transition since the outputs are not in the expected sequential order. This should not happen according to the specification.&lt;/p&gt;

&lt;p&gt;On the other hand, if you do not send an event at all, the state machine gets stuck. This confirms that the transition was actually really triggered by the sent event. Moreover, it also sounds like a specification mismatch to me. The respective quote from the specification is:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;After checking the state configuration, the Processor must select the optimal transition set enabled by NULL in the current configuration. If the set is not empty, it must execute it as a microstep.&lt;/p&gt;&lt;/blockquote&gt;</description>
                <environment></environment>
        <key id="12737753">SCXML-206</key>
            <summary>Specification mismatch: event-less transitions are triggered by named events</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ate">Ate Douma</assignee>
                                    <reporter username="languitar">Johannes Wienke</reporter>
                        <labels>
                    </labels>
                <created>Fri, 29 Aug 2014 09:15:57 +0000</created>
                <updated>Sun, 7 Sep 2014 19:56:13 +0000</updated>
                            <resolved>Sun, 7 Sep 2014 19:56:13 +0000</resolved>
                                    <version>2.0</version>
                                    <fixVersion>2.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="14125019" author="adouma" created="Sun, 7 Sep 2014 19:34:21 +0000"  >&lt;p&gt;Hi Johannes,&lt;/p&gt;

&lt;p&gt;I finally had time to look into this and indeed found some issues/bugs with the current implementation.&lt;br/&gt;
However, not exactly in the way you describe them.&lt;/p&gt;

&lt;p&gt;The crux of the problem is that currently the SCXMLExecutor incorrectly is re-entering its own execution state when using send.&lt;br/&gt;
I&apos;m assuming here you are using the current SimpleScheduler or derivate class.&lt;/p&gt;

&lt;p&gt;Part of the refactoring for the Milestone 1 has been to introduce the internal and external event queues to manage the event processing more appropriately according to the specification.&lt;br/&gt;
That work however is not completed yet. The completion of the external IO Processor work I planned for &lt;a href=&quot;http://commons.apache.org/proper/commons-scxml/roadmap.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Milestone 3&lt;/a&gt;.&lt;br/&gt;
What I overlooked though was to at least not have the SimpleScheduler directly trigger events on the SCXMLExecutor (which in addition also was synchronized before), it should now merely &lt;em&gt;&lt;b&gt;add&lt;/b&gt;&lt;/em&gt; events to the queue. So, instead of calling SCXMLExecutor#triggerEvent it should be calling SCXMLExecutor#addEvent.&lt;br/&gt;
Because of this, you&apos;re now seeing re-entrant execution of a single SCXML state machine, which obviously messes up the internal state.&lt;br/&gt;
This is also the cause for &lt;a href=&quot;https://issues.apache.org/jira/browse/SCXML-207&quot; title=&quot;Race condition in transition notification for SCXMLListeners&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SCXML-207&quot;&gt;&lt;del&gt;SCXML-207&lt;/del&gt;&lt;/a&gt;. &lt;/p&gt;

&lt;p&gt;I&apos;ll commit a fix for the triggerEvent invocation of SimpleScheduler shortly.&lt;/p&gt;

&lt;p&gt;Then while testing my fix, I also discovered a new bug in SCXMLSemanticsImpl#matchTransition which didn&apos;t initially cause the problems you saw, but with my fix in SimpleScheduler would lead to a similar error. Nice &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;br/&gt;
So I&apos;ll fix that that at the same time.&lt;/p&gt;

&lt;p&gt;However I could not reproduce your problem with the state machine getting stuck if no event is send at all, neither before nor after applying my fixes.&lt;br/&gt;
In this regard the specification is IMO pretty clear: enabled event-less transitions must be executed if no other events are left to be processed.&lt;br/&gt;
(which may trigger new events and thus lead to further subsequent event processing)&lt;/p&gt;</comment>
                            <comment id="14125032" author="adouma" created="Sun, 7 Sep 2014 19:56:13 +0000"  >&lt;p&gt;I&apos;ve applied the above mentioned fixes.&lt;br/&gt;
Please test and report if this now works for your scenario(s).&lt;br/&gt;
Note however that full compliance with the specification is not yet intended: there are definitely other limitations and mismatches in the current event IO processing (both internal and external) which will be dealt with later (Milestone 3 or maybe earlier).&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 10 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1zh8n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>