<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:31:49 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SCXML-91] Test case bugs</title>
                <link>https://issues.apache.org/jira/browse/SCXML-91</link>
                <project id="12310492" key="SCXML">Commons SCXML</project>
                    <description>&lt;p&gt;Test cases are difficult to debug if they fail.&lt;/p&gt;

&lt;p&gt;This is because many test cases catch Exception, and don&apos;t report it fully.&lt;br/&gt;
Test cases should only catch a (specific) Exception if the test is expected to generate one, and should otherwise throw the Exception.&lt;/p&gt;

&lt;p&gt;Several test cases report problems to System.out or System.err and carry on processing.&lt;br/&gt;
For example, serialisation errors are largely ignored, and SCXMLTestHelper#testExecutorSerializability() ignores IO errors.&lt;/p&gt;

&lt;p&gt;Testing generates a lot of output, some of which appears to be errors (e.g. stack traces) yet the test passes.&lt;br/&gt;
Ideally tests should suppress output stack traces which are expected during testing.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12409177">SCXML-91</key>
            <summary>Test case bugs</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="sebb">Sebb</reporter>
                        <labels>
                    </labels>
                <created>Tue, 25 Nov 2008 10:02:46 +0000</created>
                <updated>Sun, 16 Feb 2014 01:12:49 +0000</updated>
                            <resolved>Wed, 7 Jan 2009 20:47:45 +0000</resolved>
                                    <version>0.9</version>
                                    <fixVersion>0.10</fixVersion>
                    <fixVersion>2.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12650720" author="rahul@apache.org" created="Tue, 25 Nov 2008 20:20:40 +0000"  >&lt;p&gt;You&apos;ve mentioned three separable items, and I will respond in order:&lt;/p&gt;

&lt;p&gt;1) As mentioned on the dev list, we should fix the bit about catching exceptions only when expected for the particular test. I&apos;m setting a fix version of v0.10 on this issue for that.&lt;/p&gt;

&lt;p&gt;2) Regarding the System.err error reporting, especially for serialization failures, I contend that its doing its job. It is not a fatal error from the PoV of library code, its more like a configuration error if serialization is needed. The purpose is to draw attention of the person running the build by spewing to console, which it does well I think.&lt;/p&gt;

&lt;p&gt;3) The testing output is desired (more in &lt;a href=&quot;https://issues.apache.org/jira/browse/SCXML-92&quot; title=&quot;Incorrect log level for entry/exit trace etc&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SCXML-92&quot;&gt;&lt;del&gt;SCXML-92&lt;/del&gt;&lt;/a&gt; later) and the stack traces are unavoidable. Some time ago, Commons introduced code in various places that both logs an exception and rethrows it. We now know that it is not the best practice, but ofcourse legacy persists until someone does something about it. Here is a pointer to the particular traces we see in the Commons SCXML build (in this case, they are from Commons Digester):&lt;/p&gt;

&lt;p&gt;  &lt;a href=&quot;http://commons.apache.org/digester/xref/org/apache/commons/digester/Digester.html#1455&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://commons.apache.org/digester/xref/org/apache/commons/digester/Digester.html#1455&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;(above URL may become outdated over time since it refers to a line number in source code)&lt;/p&gt;</comment>
                            <comment id="12650962" author="sebb@apache.org" created="Wed, 26 Nov 2008 11:32:10 +0000"  >&lt;p&gt;1) OK&lt;/p&gt;

&lt;p&gt;2) There is so much output generated that it is possible to overlook the serialisation errors.&lt;br/&gt;
Also, a lot of this output is expected; it&apos;s tedious scanning through all of it.&lt;/p&gt;

&lt;p&gt;Perhaps a work-round would be to add a single test to check the serialisability of a known problematic class and report that as a failure.&lt;/p&gt;

&lt;p&gt;SCXMLTestHelper#testExecutorSerializability() should not ignore I/O errors.&lt;/p&gt;

&lt;p&gt;3) OK, I discovered this myself later.&lt;/p&gt;</comment>
                            <comment id="12651125" author="rahul@apache.org" created="Wed, 26 Nov 2008 19:51:50 +0000"  >&lt;p&gt;Regarding (2):&lt;/p&gt;

&lt;p&gt;As I mentioned, the copious output suits my style (of running one test at a time when digging into details) so I&apos;m in favor of retaining it.&lt;/p&gt;

&lt;p&gt;I mentioned on the dev list in the RC thread why the DOM serialization shouldn&apos;t be a test failure.&lt;/p&gt;

&lt;p&gt;Agree on the I/O errors (though we do print the trace IIRC).&lt;/p&gt;</comment>
                            <comment id="12651203" author="sebb@apache.org" created="Thu, 27 Nov 2008 00:46:23 +0000"  >&lt;p&gt;I would prefer to see minimal output when things are working well (Unix mindset perhaps, or maybe I&apos;m lazy) and be able to switch on additional trace only if required.&lt;br/&gt;
This would be easy enough to do by changing the default to debug level.&lt;/p&gt;</comment>
                            <comment id="12654005" author="sebb@apache.org" created="Sat, 6 Dec 2008 00:50:09 +0000"  >&lt;p&gt;Fixed item 2) I/O errors:&lt;/p&gt;

&lt;p&gt;Trunk:&lt;/p&gt;

&lt;p&gt;URL: &lt;a href=&quot;http://svn.apache.org/viewvc?rev=723933&amp;amp;view=rev&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?rev=723933&amp;amp;view=rev&lt;/a&gt;&lt;br/&gt;
Log:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/SCXML-91&quot; title=&quot;Test case bugs&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SCXML-91&quot;&gt;&lt;del&gt;SCXML-91&lt;/del&gt;&lt;/a&gt; - SCXMLTestHelper#testExecutorSerializability() should not ignore I/O errors.&lt;/p&gt;

&lt;p&gt;J6 branch:&lt;/p&gt;

&lt;p&gt;URL: &lt;a href=&quot;http://svn.apache.org/viewvc?rev=723934&amp;amp;view=rev&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?rev=723934&amp;amp;view=rev&lt;/a&gt;&lt;br/&gt;
Log:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/SCXML-91&quot; title=&quot;Test case bugs&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SCXML-91&quot;&gt;&lt;del&gt;SCXML-91&lt;/del&gt;&lt;/a&gt; - SCXMLTestHelper#testExecutorSerializability() should not ignore I/O errors.&lt;/p&gt;

&lt;p&gt;Changing the method to throw the errors would require lots of other changes.&lt;/p&gt;</comment>
                            <comment id="12654295" author="rahul@apache.org" created="Mon, 8 Dec 2008 04:08:57 +0000"  >&lt;p&gt;OK, so thats that for (2) and (3). Did you have anything else in mind for (1)?&lt;/p&gt;</comment>
                            <comment id="12654658" author="sebb@apache.org" created="Tue, 9 Dec 2008 00:12:52 +0000"  >&lt;p&gt;As to 1), what I had in mind was to change code of the form:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void testInvoke01Sample() {
        &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
            SCXML scxml = SCXMLParser.parse(invoke01,
                &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; SimpleErrorHandler());
            exec = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; SCXMLExecutor(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; JexlEvaluator(), &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; SimpleDispatcher(),
                &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; SimpleErrorReporter());
            assertNotNull(exec);
            exec.setRootContext(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; JexlContext());
            exec.setStateMachine(scxml);
            exec.registerInvokerClass(&lt;span class=&quot;code-quote&quot;&gt;&quot;scxml&quot;&lt;/span&gt;, SimpleSCXMLInvoker.class);
            exec.go();
            Set&amp;lt;TransitionTarget&amp;gt; currentStates = exec.getCurrentStatus().getStates();
            assertEquals(1, currentStates.size());
            assertEquals(&lt;span class=&quot;code-quote&quot;&gt;&quot;invoker&quot;&lt;/span&gt;, currentStates.iterator().next().getId());
        } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (Exception e) {
            e.printStackTrace();
            fail(e.getMessage());
        }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;to&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void testInvoke01Sample() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {
        SCXML scxml = SCXMLParser.parse(invoke01,
            &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; SimpleErrorHandler());
        exec = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; SCXMLExecutor(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; JexlEvaluator(), &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; SimpleDispatcher(),
            &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; SimpleErrorReporter());
        assertNotNull(exec);
        exec.setRootContext(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; JexlContext());
        exec.setStateMachine(scxml);
        exec.registerInvokerClass(&lt;span class=&quot;code-quote&quot;&gt;&quot;scxml&quot;&lt;/span&gt;, SimpleSCXMLInvoker.class);
        exec.go();
        Set&amp;lt;TransitionTarget&amp;gt; currentStates = exec.getCurrentStatus().getStates();
        assertEquals(1, currentStates.size());
        assertEquals(&lt;span class=&quot;code-quote&quot;&gt;&quot;invoker&quot;&lt;/span&gt;, currentStates.iterator().next().getId());
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt; 

&lt;p&gt;As to 2), I still think it would be sensible to report at least one test failure if the test environment does not allow all the tests to be completed successfully.&lt;/p&gt;</comment>
                            <comment id="12654665" author="rahul@apache.org" created="Tue, 9 Dec 2008 00:27:14 +0000"  >&lt;p&gt;Please go ahead with any changes for (1) such as in the comment above.&lt;/p&gt;

&lt;p&gt;As to (2), I&apos;m afraid we&apos;re going around in circles and nothing new has been said since the thread on dev@.&lt;/p&gt;</comment>
                            <comment id="12660430" author="sebb@apache.org" created="Sat, 3 Jan 2009 00:41:38 +0000"  >&lt;p&gt;Patches for 1) applied to trunk and J6&lt;/p&gt;</comment>
                            <comment id="12660442" author="rahul@apache.org" created="Sat, 3 Jan 2009 04:55:24 +0000"  >&lt;p&gt;Thanks, if you&apos;re happy with the changes for (1), I think we can resolve this issue now.&lt;/p&gt;</comment>
                            <comment id="12660460" author="sebb@apache.org" created="Sat, 3 Jan 2009 11:47:12 +0000"  >&lt;p&gt;SCXMLTestHelper still contains quite a few catch blocks that merely call fail().&lt;/p&gt;

&lt;p&gt;These still need looking at to see if they can be replaced by throws clauses.&lt;/p&gt;</comment>
                            <comment id="12660740" author="sebb@apache.org" created="Mon, 5 Jan 2009 12:53:31 +0000"  >&lt;p&gt;SCXMLTestHelper has now been updated in J6 to throw Exceptions:&lt;/p&gt;

&lt;p&gt;URL: &lt;a href=&quot;http://svn.apache.org/viewvc?rev=731386&amp;amp;view=rev&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?rev=731386&amp;amp;view=rev&lt;/a&gt;&lt;br/&gt;
Log:&lt;br/&gt;
Prepare for changes to SCXMLTestHelper&lt;/p&gt;

&lt;p&gt;URL: &lt;a href=&quot;http://svn.apache.org/viewvc?rev=731387&amp;amp;view=rev&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?rev=731387&amp;amp;view=rev&lt;/a&gt;&lt;br/&gt;
Log:&lt;br/&gt;
Remove try/catch blocks for Exceptions that are not expected in testing&lt;/p&gt;

&lt;p&gt;In trunk, the same changes have been made, except that DOM serialisation errors are allowed through&lt;br/&gt;
(which is closer to what I would like to see):&lt;/p&gt;

&lt;p&gt;URL: &lt;a href=&quot;http://svn.apache.org/viewvc?rev=731393&amp;amp;view=rev&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?rev=731393&amp;amp;view=rev&lt;/a&gt;&lt;br/&gt;
Log:&lt;br/&gt;
Prepare for changes to SCXMLTestHelper&lt;/p&gt;

&lt;p&gt;URL: &lt;a href=&quot;http://svn.apache.org/viewvc?rev=731543&amp;amp;view=rev&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?rev=731543&amp;amp;view=rev&lt;/a&gt;&lt;br/&gt;
Log:&lt;br/&gt;
Remove try/catch blocks for Exceptions that are not expected in testing&lt;br/&gt;
Improve non-serialisable check so it only allows DOM elements to fail&lt;/p&gt;</comment>
                            <comment id="12660887" author="rahul@apache.org" created="Mon, 5 Jan 2009 20:05:57 +0000"  >&lt;p&gt;Pasting some comments from the dev list in JIRA as well:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Comment #1:&lt;br/&gt;
The idea (verifying if the NSE is actually due to the DOM implementation) is good.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;I think this implementation (r731543) is fragile since:&lt;br/&gt;
(a) It relies on an exception message&lt;br/&gt;
(b) It only accounts for crimson, but in theory the package name could be anything (by virtue of the Java endorsed standards override mechanism)&lt;/p&gt;

&lt;p&gt;Lets retain the NSE catch blocks as before. Other changes look good.&lt;/p&gt;


&lt;ul&gt;
	&lt;li&gt;Comment #2:&lt;br/&gt;
WRT the directory creation, if you&apos;d rather have the build fail if creation fails, there would ideally be a nice message stating the problem (rather than a generic x failures and y errors kind of thing) and additonally, there&apos;d be a build time switch that allows folks to say &quot;we don&apos;t care about serialization&quot; which would cause the build to succeed (this could also help the NSE catches you are looking at eliminating &amp;#8211; all NSEs could then cause tests to error out by default). So maybe the approach of providing such a switch helps both cases we&apos;re discussing.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12661381" author="rahul@apache.org" created="Tue, 6 Jan 2009 23:53:23 +0000"  >&lt;p&gt;Summarizing the dev list discussion (hopefully the crimson check will not require any more maintenance):&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;sebb wrote:&lt;br/&gt;
&amp;gt; but I think NSEs which are not caused by&lt;br/&gt;
&amp;gt; the faulty Sun 1.4 DOM should cause failures.&lt;br/&gt;
&amp;gt;&lt;br/&gt;
&amp;lt;snap/&amp;gt;&lt;/p&gt;

&lt;p&gt;OK, so what you added to trunk does that. I guess we can retain the crimson check as-is and keep refining it as and when it breaks with other obscure JDKs and configurations you and I haven&apos;t tested on.&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;Looks like the major items on this issue are addressed?&lt;/p&gt;</comment>
                            <comment id="12661406" author="sebb@apache.org" created="Wed, 7 Jan 2009 01:53:18 +0000"  >&lt;p&gt;Yes, I think the test output is a lot easier to follow, and hopefully more bugs will be caught as fewer errors are ignored.&lt;/p&gt;

&lt;p&gt;One minor tweak which might be worth considering would be to output messages to show which warning and error messages are expected, for example to print a message to say that the 2 stack traces are expected.&lt;/p&gt;</comment>
                            <comment id="12661453" author="rahul@apache.org" created="Wed, 7 Jan 2009 05:44:09 +0000"  >&lt;p&gt;My way of saying the exceptions are expected is to have the string &apos;404&apos; in the URLs that aren&apos;t meant to be found &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; (if folks read the exception messages in the trace)&lt;/p&gt;

&lt;p&gt;If you want to further improve any messages, please go ahead.&lt;/p&gt;</comment>
                            <comment id="12661684" author="sebb@apache.org" created="Wed, 7 Jan 2009 19:49:29 +0000"  >&lt;p&gt;I&apos;ve just realised that the stack dumps are part of the log message, so changing the log level to fatal (rather than warn) will eliminate these, and also eliminate the remaining non-essential output.&lt;/p&gt;

&lt;p&gt;I think that&apos;s the neatest solution overall - agreed?&lt;/p&gt;</comment>
                            <comment id="12661688" author="rahul@apache.org" created="Wed, 7 Jan 2009 20:03:34 +0000"  >&lt;p&gt;Sounds good.&lt;/p&gt;</comment>
                            <comment id="12661702" author="sebb@apache.org" created="Wed, 7 Jan 2009 20:47:45 +0000"  >&lt;p&gt;I think this can now finally be resolved!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>172747</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            16 years, 46 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0zxev:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>207715</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>