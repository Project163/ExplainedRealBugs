<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 20:19:20 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[MDEPLOY-193] deployAtEnd does not deploy artifacts for multi-module project with build extensions</title>
                <link>https://issues.apache.org/jira/browse/MDEPLOY-193</link>
                <project id="12317228" key="MDEPLOY">Maven Deploy Plugin (Moved to GitHub Issues)</project>
                    <description>&lt;p&gt;The deploy plugin shows the same behaviour as described in &lt;a href=&quot;https://issues.apache.org/jira/browse/MINSTALL-102&quot; title=&quot;installAtEnd does not install artifacts for multi-module with packaging maven-archetype&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MINSTALL-102&quot;&gt;&lt;del&gt;MINSTALL-102&lt;/del&gt;&lt;/a&gt;. &lt;/p&gt;

&lt;p&gt;We noticed that multimodule projects do not deploy any artifacts if there are modules with packagings that add build extensions (e.g. atlassian-plugin, aar = axis archives).&lt;/p&gt;

&lt;p&gt;This issue is here for better visibility as discussed in &lt;a href=&quot;https://issues.apache.org/jira/browse/MINSTALL-102&quot; title=&quot;installAtEnd does not install artifacts for multi-module with packaging maven-archetype&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MINSTALL-102&quot;&gt;&lt;del&gt;MINSTALL-102&lt;/del&gt;&lt;/a&gt;. &lt;br/&gt;
Please find attached testcase there.&lt;/p&gt;</description>
                <environment>windows 7 / sles 11&lt;br/&gt;
maven 3.0.5&lt;br/&gt;
java 7u45</environment>
        <key id="12801171">MDEPLOY-193</key>
            <summary>deployAtEnd does not deploy artifacts for multi-module project with build extensions</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="cstamas">Tamas Cservenak</assignee>
                                    <reporter username="joerg.sesterhenn">J&#246;rg Sesterhenn</reporter>
                        <labels>
                    </labels>
                <created>Mon, 1 Dec 2014 09:04:04 +0000</created>
                <updated>Thu, 12 Jun 2025 11:14:38 +0000</updated>
                            <resolved>Sun, 3 Jul 2022 18:38:42 +0000</resolved>
                                    <version>2.8.2</version>
                                    <fixVersion>3.0.0</fixVersion>
                                    <component>deploy:deploy</component>
                        <due></due>
                            <votes>20</votes>
                                    <watches>30</watches>
                                                                                                                <comments>
                            <comment id="14940958" author="bob_h" created="Fri, 2 Oct 2015 09:32:11 +0000"  >&lt;p&gt;Attached a project, which generate the issue,&lt;br/&gt;
run mvn deploy -Pjar,war,osgi&lt;/p&gt;

&lt;p&gt;The build is SUCCESSFULL but nothing has been deployed (the worst case).&lt;/p&gt;</comment>
                            <comment id="14942631" author="rfscholte" created="Sun, 4 Oct 2015 10:37:19 +0000"  >&lt;p&gt;&lt;tt&gt;deployAtEnd&lt;/tt&gt; is an experimental feature (I added that comment too late). It works for most projects, but not all. Hence it is not active by default. Once &lt;a href=&quot;https://issues.apache.org/jira/browse/MNG-5666&quot; title=&quot;Divide lifecycle in prePhases, phases and postPhases&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MNG-5666&quot;&gt;&lt;del&gt;MNG-5666&lt;/del&gt;&lt;/a&gt; is implemented no-one needs this option anymore. &lt;br/&gt;
I&apos;m pretty sure this can&apos;t be resolved within the maven-deploy-plugin itself, it&apos;s already stretched to its limits.&lt;/p&gt;</comment>
                            <comment id="16207644" author="j.joslet" created="Tue, 17 Oct 2017 13:33:56 +0000"  >&lt;p&gt;I issue this problem today and found a workaround.&lt;/p&gt;

&lt;p&gt;The maven-deploy-plugin records its state in static variables. One for stacking deploy requests (&lt;tt&gt;deployRequests&lt;/tt&gt;) and another one for counting ready project (&lt;tt&gt;readyProjectsCounter&lt;/tt&gt;). When the problem occurs, there is more than one static variable used to count ready projects. This happens when there is more than one classloader that loads the deploy plugin&apos;s classes. This leads to multiple class instances and multiple static variable instances. Some module count on one instance and others modules on another one.&lt;/p&gt;

&lt;p&gt;The result is that the deploy plugin never flush its pending deploy requests since no counter is equal to the number of project in the reactor.&lt;/p&gt;

&lt;p&gt;As mentionned in the following documentation : &lt;a href=&quot;https://svn.apache.org/repos/infra/websites/production/maven/content/reference/maven-classloading.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/repos/infra/websites/production/maven/content/reference/maven-classloading.html&lt;/a&gt; :&lt;br/&gt;
&lt;cite&gt;For projects that use build extensions, plugin classloaders are wired to project classloaders. This gives plugin code access to both Maven API packages and packages exported by the project build extensions. Maven will create one and only one classloader for each unique plugin+dependencies+build-extensions combination.&lt;/cite&gt;&lt;/p&gt;

&lt;p&gt;and&lt;/p&gt;

&lt;p&gt;&lt;cite&gt;Maven guarantees there will be one and only one project classloader for each unique set of project build extensions and the same classloader will be used by all projects that have the set of build extensions.&lt;/cite&gt;&lt;/p&gt;

&lt;p&gt;The workaround is to declare all extension plugins, with all their extra &lt;tt&gt;&amp;lt;dependencies&amp;gt;&lt;/tt&gt;, in the parent project. This assures that the same classloader is used for loading plugin in all modules.&lt;/p&gt;</comment>
                            <comment id="16208090" author="jbochenski" created="Tue, 17 Oct 2017 18:25:08 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=j.joslet&quot; class=&quot;user-hover&quot; rel=&quot;j.joslet&quot;&gt;j.joslet&lt;/a&gt; great job,  I wish you could upvote comments on JIRA (sorry for spam)&lt;/p&gt;</comment>
                            <comment id="16344980" author="robseidel" created="Tue, 30 Jan 2018 12:31:03 +0000"  >&lt;p&gt;Chas Honton has a solution for this by using session user properties and he already created a pull request&#160;&lt;a href=&quot;https://github.com/apache/maven-deploy-plugin/pull/1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/maven-deploy-plugin/pull/1&lt;/a&gt;.&#160;&lt;/p&gt;

&lt;p&gt;Another guy analyzed the problem (&lt;a href=&quot;http://dev.eclipse.org/mhonarc/lists/aether-users/msg00387.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://dev.eclipse.org/mhonarc/lists/aether-users/msg00387.html&lt;/a&gt;):&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;tt&gt;Also, your analysis suggests a bug in the maven-deploy-plugin in that it relies on the erroneous assumption that a single class loader is used per plugin through out a multi-module build.&lt;/tt&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;&#160;All the issues&#160;193, 200, 224, 225, 226 are related to each other.&lt;/p&gt;</comment>
                            <comment id="17561920" author="hudson" created="Sun, 3 Jul 2022 18:26:01 +0000"  >&lt;p&gt;Build succeeded in Jenkins: Maven &#187; Maven TLP &#187; maven-deploy-plugin &#187; master #9&lt;/p&gt;

&lt;p&gt;See &lt;a href=&quot;https://ci-maven.apache.org/job/Maven/job/maven-box/job/maven-deploy-plugin/job/master/9/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://ci-maven.apache.org/job/Maven/job/maven-box/job/maven-deploy-plugin/job/master/9/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17965711" author="olamy" created="Thu, 12 Jun 2025 11:14:38 +0000"  >&lt;p&gt;This project has moved from Jira to GitHub Issues. This issue was migrated to &lt;a href=&quot;https://github.com/apache/maven-deploy-plugin/issues/524&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;apache/maven-deploy-plugin#524&lt;/a&gt;. &lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13119513">MDEPLOY-226</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12801158">MDEPLOY-157</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12875368">MDEPLOY-201</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="12310260">
                    <name>Related</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12801172">MDEPLOY-176</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12764750" name="deployAtEndFailure.zip" size="10810" author="bob_H" created="Fri, 2 Oct 2015 09:32:11 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[no_permission]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            21 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i29ydj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12312220" key="com.atlassian.jira.plugin.system.customfieldtypes:radiobuttons">
                        <customfieldname>Testcase included</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="11060"><![CDATA[Yes]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>