diff --git a/pom.xml b/pom.xml
index 4216dbf..b25a5f6 100644
--- a/pom.xml
+++ b/pom.xml
@@ -84,4 +84,71 @@ under the License.
       </plugin>
     </plugins>
   </build>
+  <profiles>
+    <profile>
+      <id>integration-tests</id>
+      <activation>
+        <property>
+          <name>skipTests</name>
+          <value>!true</value>
+        </property>
+      </activation>
+      <build>
+        <plugins>
+          <plugin>
+            <groupId>org.apache.maven.plugins</groupId>
+            <artifactId>maven-install-plugin</artifactId>
+            <version>2.2</version>
+            <executions>
+              <execution>
+                <id>integration-test</id>
+                <phase>pre-integration-test</phase>
+                <goals>
+                  <goal>install-file</goal>
+                </goals>
+                <configuration>
+                  <file>${project.build.directory}/${project.build.finalName}.jar</file>
+                  <groupId>${project.groupId}</groupId>
+                  <artifactId>${project.artifactId}</artifactId>
+                  <version>${project.version}</version>
+                  <packaging>${project.packaging}</packaging>
+                  <pomFile>${basedir}/pom.xml</pomFile>
+                  <createChecksum>true</createChecksum>
+                  <localRepositoryPath>${project.build.directory}/local-repo</localRepositoryPath>
+                  <localRepositoryId>it-local-repo</localRepositoryId>
+                </configuration>
+              </execution>
+            </executions>
+          </plugin>
+          <plugin>
+            <groupId>org.apache.maven.plugins</groupId>
+            <artifactId>maven-invoker-plugin</artifactId>
+            <version>1.1</version>
+            <configuration>
+              <projectsDirectory>src/it</projectsDirectory>
+              <pomIncludes>
+                <pomInclude>**/**/pom.xml</pomInclude>
+              </pomIncludes>
+              <postBuildHookScript>verify.bsh</postBuildHookScript>
+              <localRepositoryPath>${basedir}/target/local-repo</localRepositoryPath>
+              <cloneProjectsTo>${project.build.directory}/its</cloneProjectsTo>
+              <goals>
+                <goal>clean</goal>
+                <goal>package</goal>
+              </goals>
+            </configuration>
+            <executions>
+              <execution>
+                <id>integration-test</id>
+                <phase>integration-test</phase>
+                <goals>
+                  <goal>run</goal>
+                </goals>
+              </execution>
+            </executions>
+          </plugin>
+        </plugins>
+      </build>
+    </profile>
+  </profiles>  
 </project>
diff --git a/src/it/mdeploy-45-test/goals.txt b/src/it/mdeploy-45-test/goals.txt
new file mode 100755
index 0000000..292bba2
--- /dev/null
+++ b/src/it/mdeploy-45-test/goals.txt
@@ -0,0 +1 @@
+clean deploy
\ No newline at end of file
diff --git a/src/it/mdeploy-45-test/pom.xml b/src/it/mdeploy-45-test/pom.xml
new file mode 100755
index 0000000..78fcac9
--- /dev/null
+++ b/src/it/mdeploy-45-test/pom.xml
@@ -0,0 +1,48 @@
+<project xmlns="http://maven.apache.org/POM/4.0.0"
+		xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
+		xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
+	<modelVersion>4.0.0</modelVersion>
+	<groupId>org.codehaus.jira.testprojects</groupId>
+	<artifactId>mdeploy45-webui</artifactId>
+	<name>sample web project with classified artifact output</name>
+	<url>http://jira.codehaus.org/browse/MDEPLOY-45</url>
+	<version>0.1-SNAPSHOT</version>
+	<packaging>war</packaging>
+	<properties>
+	 <mdp45.artifact.classifier>mdp45</mdp45.artifact.classifier>
+	</properties>
+	<build>
+		<plugins>
+			<plugin>
+				<artifactId>maven-deploy-plugin</artifactId>
+        <!--version>@pom.version@</version-->
+        <version>2.4-SNAPSHOT</version>
+				<configuration>
+			    <!-- because i don't know your distribution management, deployments will be written to ${basedir}/target -->
+					<altDeploymentRepository>mine::default::file://${basedir}/target</altDeploymentRepository>
+				</configuration>
+			</plugin>
+			<plugin>
+				<artifactId>maven-war-plugin</artifactId>
+        <!--version>2.1-alpha-2-SNAPSHOT</version-->
+        <version>2.0.2</version>
+				<configuration>
+				 <!-- this will cause an error  -->
+					<classifier>${mdp45.artifact.classifier}</classifier>
+				</configuration>
+			</plugin>
+		</plugins>
+	</build>
+	<distributionManagement>
+		<repository>
+			<id>repo1</id>
+			<name>Maven Central Repository</name>
+			<url>scp://foo.org/m2/release</url>
+		</repository>
+		<snapshotRepository>
+			<id>repo1</id>
+			<name>Maven Central Repository</name>
+			<url>scp://foo.org/m2/snapshot</url>
+		</snapshotRepository>
+	</distributionManagement>
+</project>
diff --git a/src/it/mdeploy-45-test/src/main/resources/foo.txt b/src/it/mdeploy-45-test/src/main/resources/foo.txt
new file mode 100644
index 0000000..5559e0d
--- /dev/null
+++ b/src/it/mdeploy-45-test/src/main/resources/foo.txt
@@ -0,0 +1,2 @@
+nothing to see here
+
diff --git a/src/it/mdeploy-45-test/src/main/webapp/WEB-INF/web.xml b/src/it/mdeploy-45-test/src/main/webapp/WEB-INF/web.xml
new file mode 100755
index 0000000..16b2391
--- /dev/null
+++ b/src/it/mdeploy-45-test/src/main/webapp/WEB-INF/web.xml
@@ -0,0 +1,8 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!DOCTYPE web-app PUBLIC "-//Sun Microsystems, Inc.//DTD Web Application 2.3//EN" "http://java.sun.com/dtd/web-app_2_3.dtd">
+<web-app>
+	<display-name>mdeploy-45-test</display-name>
+	<welcome-file-list>
+		<welcome-file>index.html</welcome-file>
+	</welcome-file-list>
+</web-app>
diff --git a/src/it/mdeploy-45-test/src/main/webapp/index.html b/src/it/mdeploy-45-test/src/main/webapp/index.html
new file mode 100755
index 0000000..70a8702
--- /dev/null
+++ b/src/it/mdeploy-45-test/src/main/webapp/index.html
@@ -0,0 +1,7 @@
+<html>
+<head>
+</head>
+<body>
+<span style="font-size: 72pt">MDEPLOY-45 Test Web Application</span>
+</body>
+</html>
diff --git a/src/it/mdeploy-45-test/verify.bsh b/src/it/mdeploy-45-test/verify.bsh
new file mode 100755
index 0000000..0492cde
--- /dev/null
+++ b/src/it/mdeploy-45-test/verify.bsh
@@ -0,0 +1,51 @@
+
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ *
+ *   http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing,
+ * software distributed under the License is distributed on an
+ * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+ * KIND, either express or implied.  See the License for the
+ * specific language governing permissions and limitations
+ * under the License.
+ */
+
+import java.io.*;
+import java.util.*;
+import java.util.jar.*;
+import org.codehaus.plexus.util.*;
+
+boolean result = true;
+
+try
+{
+    File target = new File( basedir, "target" );
+    if ( !target.exists() || !target.isDirectory() )
+    {
+        System.err.println( "target file is missing or not a directory." );
+        return false;
+    }
+    
+    File deployedFile = new File ( target, "org/codehaus/jira/testprojects/mdeploy45-webui/0.1-SNAPSHOT/mdeploy45-webui-0.1-SNAPSHOT-mdp45.war" );
+    if ( !deployedFile.exists() || deployedFile.isDirectory() )
+    {
+        System.err.println( "deployedFile file is missing or a directory." );
+        return false;
+    }    
+        
+}
+catch( Throwable e )
+{
+    e.printStackTrace();
+    result = false;
+}
+
+return result;
diff --git a/src/main/java/org/apache/maven/plugin/deploy/DeployMojo.java b/src/main/java/org/apache/maven/plugin/deploy/DeployMojo.java
index 07c507c..822d303 100644
--- a/src/main/java/org/apache/maven/plugin/deploy/DeployMojo.java
+++ b/src/main/java/org/apache/maven/plugin/deploy/DeployMojo.java
@@ -167,12 +167,20 @@ public class DeployMojo
             else
             {
                 File file = artifact.getFile();
-                if ( file == null )
+
+                if ( file != null && !file.isDirectory() )
+                {
+                    getDeployer().deploy( file, artifact, repo, getLocalRepository() );
+                }
+                else if ( !attachedArtifacts.isEmpty() )
+                {
+                    getLog().info( "No primary artifact to deploy, deploy attached artifacts instead." );
+                }
+                else
                 {
                     throw new MojoExecutionException(
                                                       "The packaging for this project did not assign a file to the build artifact" );
                 }
-                getDeployer().deploy( file, artifact, repo, getLocalRepository() );
             }
 
             for ( Iterator i = attachedArtifacts.iterator(); i.hasNext(); )
