{"url":"https://api.github.com/repos/gabime/spdlog/issues/2512","repository_url":"https://api.github.com/repos/gabime/spdlog","labels_url":"https://api.github.com/repos/gabime/spdlog/issues/2512/labels{/name}","comments_url":"https://api.github.com/repos/gabime/spdlog/issues/2512/comments","events_url":"https://api.github.com/repos/gabime/spdlog/issues/2512/events","html_url":"https://github.com/gabime/spdlog/issues/2512","id":1410055041,"node_id":"I_kwDOAY1ReM5UC7uB","number":2512,"title":"compile error on Windows with external fmtlib and MSVC 17.3.6","user":{"login":"YunchengLiu","id":40971483,"node_id":"MDQ6VXNlcjQwOTcxNDgz","avatar_url":"https://avatars.githubusercontent.com/u/40971483?v=4","gravatar_id":"","url":"https://api.github.com/users/YunchengLiu","html_url":"https://github.com/YunchengLiu","followers_url":"https://api.github.com/users/YunchengLiu/followers","following_url":"https://api.github.com/users/YunchengLiu/following{/other_user}","gists_url":"https://api.github.com/users/YunchengLiu/gists{/gist_id}","starred_url":"https://api.github.com/users/YunchengLiu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/YunchengLiu/subscriptions","organizations_url":"https://api.github.com/users/YunchengLiu/orgs","repos_url":"https://api.github.com/users/YunchengLiu/repos","events_url":"https://api.github.com/users/YunchengLiu/events{/privacy}","received_events_url":"https://api.github.com/users/YunchengLiu/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2022-10-15T05:40:04Z","updated_at":"2022-10-19T23:11:23Z","closed_at":"2022-10-19T23:11:23Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"Thanks a lot for this excellent library, helped me a lot.\r\nBut I encountered a sudden problem. \r\nOn Windows platform, after enabling wchar_t and external fmtlib support in spdlog, when compiling with C++20 option in MSVC 17.3.6, fmt throws a compilation error. \r\n\r\nspdlog ( 1.10.0#1) and fmtlib (9.1.0) are all installed via vcpkg(x64-windows) with lasted port comfigurations.\r\n\r\nMessage as follows:\r\n\r\n```\r\nError C7595: \"fmt:: v9:: basic_format_string<wchar_t, const tm&>:: basic_format_string\": The call to an instant function is not a constant expression.\r\n```\r\nThe wrong location is:\r\nhttps://github.com/gabime/spdlog/blob/d011332616464bd0c84817d6255bf5910b7803e9/include/spdlog/sinks/daily_file_sink.h#L81\r\n\r\nI saw the comments here, but I still tried to modify it to `fmt::runtime` , it compiles successfully at this time, it seems that the comments here are a bit outdated? Has the new version of MSVC resolved the contradiction between wchar_t and fmt?\r\n\r\nI tried to reproduce the above problem externally with the following minimal code. On my local PC, the following code using MSVC 17.3.6 will throw the same error (not modified to `fmt::runtime` ).\r\n\r\n```c++\r\n\r\n#define SPDLOG_WCHAR_FILENAMES\r\n#define SPDLOG_FMT_EXTERNAL\r\n#include <fmt/format.h>\r\n#include <spdlog/spdlog.h>\r\n#include <spdlog/sinks/daily_file_sink.h>\r\n\r\nint main(){\r\n\r\n    auto logger = spdlog::daily_logger_mt(\"daily_logger\", L\"logs/daily.txt\", 2, 30);\r\n\r\n    logger->info(\"{} world\", \"hello\");\r\n\r\n}\r\n\r\n```\r\n\r\nSince I don't know about other platforms and the specific requirements for compiler versions, I would like to ask if it is possible to modify this to `fmt::runtime` to solve the problem? ","closed_by":{"login":"gabime","id":6052198,"node_id":"MDQ6VXNlcjYwNTIxOTg=","avatar_url":"https://avatars.githubusercontent.com/u/6052198?v=4","gravatar_id":"","url":"https://api.github.com/users/gabime","html_url":"https://github.com/gabime","followers_url":"https://api.github.com/users/gabime/followers","following_url":"https://api.github.com/users/gabime/following{/other_user}","gists_url":"https://api.github.com/users/gabime/gists{/gist_id}","starred_url":"https://api.github.com/users/gabime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gabime/subscriptions","organizations_url":"https://api.github.com/users/gabime/orgs","repos_url":"https://api.github.com/users/gabime/repos","events_url":"https://api.github.com/users/gabime/events{/privacy}","received_events_url":"https://api.github.com/users/gabime/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/gabime/spdlog/issues/2512/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/gabime/spdlog/issues/2512/timeline","performed_via_github_app":null,"state_reason":"completed"}