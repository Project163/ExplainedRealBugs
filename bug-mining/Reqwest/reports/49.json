{"url":"https://api.github.com/repos/seanmonstar/reqwest/issues/717","repository_url":"https://api.github.com/repos/seanmonstar/reqwest","labels_url":"https://api.github.com/repos/seanmonstar/reqwest/issues/717/labels{/name}","comments_url":"https://api.github.com/repos/seanmonstar/reqwest/issues/717/comments","events_url":"https://api.github.com/repos/seanmonstar/reqwest/issues/717/events","html_url":"https://github.com/seanmonstar/reqwest/issues/717","id":527156501,"node_id":"MDU6SXNzdWU1MjcxNTY1MDE=","number":717,"title":"over eager loop detection","user":{"login":"jrandall","id":458361,"node_id":"MDQ6VXNlcjQ1ODM2MQ==","avatar_url":"https://avatars.githubusercontent.com/u/458361?v=4","gravatar_id":"","url":"https://api.github.com/users/jrandall","html_url":"https://github.com/jrandall","followers_url":"https://api.github.com/users/jrandall/followers","following_url":"https://api.github.com/users/jrandall/following{/other_user}","gists_url":"https://api.github.com/users/jrandall/gists{/gist_id}","starred_url":"https://api.github.com/users/jrandall/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jrandall/subscriptions","organizations_url":"https://api.github.com/users/jrandall/orgs","repos_url":"https://api.github.com/users/jrandall/repos","events_url":"https://api.github.com/users/jrandall/events{/privacy}","received_events_url":"https://api.github.com/users/jrandall/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2019-11-22T12:01:27Z","updated_at":"2019-12-16T23:57:10Z","closed_at":"2019-12-16T23:57:10Z","author_association":"NONE","active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"If an HTTP server redirects back to itself, the reqwest client appears to detect a loop immediately on the first redirect. It is a somewhat common pattern for a page to do something like set a cookie and then redirect back to itself to ensure that the cookie has, in fact, been set. \r\n\r\nTo fix this, the loop detection code could remain simple but defer detecting the loop until the same URL is redirected to twice in a row (this would assume that a server does not repeatedly redirect back to itself while changing state, but that probably occurs a lot less often). \r\n\r\nAlternatively, the loop detection code could operate on the full set of headers being sent in the new request rather than just on the URL (i.e. it would consider what cookies have been set etc). This would be a more general solution and could possibly be easier to implement as you only need to consider the current request and the next request that is being generated by the redirect handler. ","closed_by":{"login":"seanmonstar","id":51479,"node_id":"MDQ6VXNlcjUxNDc5","avatar_url":"https://avatars.githubusercontent.com/u/51479?v=4","gravatar_id":"","url":"https://api.github.com/users/seanmonstar","html_url":"https://github.com/seanmonstar","followers_url":"https://api.github.com/users/seanmonstar/followers","following_url":"https://api.github.com/users/seanmonstar/following{/other_user}","gists_url":"https://api.github.com/users/seanmonstar/gists{/gist_id}","starred_url":"https://api.github.com/users/seanmonstar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/seanmonstar/subscriptions","organizations_url":"https://api.github.com/users/seanmonstar/orgs","repos_url":"https://api.github.com/users/seanmonstar/repos","events_url":"https://api.github.com/users/seanmonstar/events{/privacy}","received_events_url":"https://api.github.com/users/seanmonstar/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/seanmonstar/reqwest/issues/717/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/seanmonstar/reqwest/issues/717/timeline","performed_via_github_app":null,"state_reason":"completed"}