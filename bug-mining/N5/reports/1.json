{"url":"https://api.github.com/repos/saalfeldlab/n5/issues/63","repository_url":"https://api.github.com/repos/saalfeldlab/n5","labels_url":"https://api.github.com/repos/saalfeldlab/n5/issues/63/labels{/name}","comments_url":"https://api.github.com/repos/saalfeldlab/n5/issues/63/comments","events_url":"https://api.github.com/repos/saalfeldlab/n5/issues/63/events","html_url":"https://github.com/saalfeldlab/n5/issues/63","id":574172174,"node_id":"MDU6SXNzdWU1NzQxNzIxNzQ=","number":63,"title":"DirectoryNotEmptyException in remove() on network file system","user":{"login":"igorpisarev","id":6253116,"node_id":"MDQ6VXNlcjYyNTMxMTY=","avatar_url":"https://avatars.githubusercontent.com/u/6253116?v=4","gravatar_id":"","url":"https://api.github.com/users/igorpisarev","html_url":"https://github.com/igorpisarev","followers_url":"https://api.github.com/users/igorpisarev/followers","following_url":"https://api.github.com/users/igorpisarev/following{/other_user}","gists_url":"https://api.github.com/users/igorpisarev/gists{/gist_id}","starred_url":"https://api.github.com/users/igorpisarev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/igorpisarev/subscriptions","organizations_url":"https://api.github.com/users/igorpisarev/orgs","repos_url":"https://api.github.com/users/igorpisarev/repos","events_url":"https://api.github.com/users/igorpisarev/events{/privacy}","received_events_url":"https://api.github.com/users/igorpisarev/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2020-03-02T18:47:11Z","updated_at":"2020-03-02T19:21:41Z","closed_at":"2020-03-02T19:21:41Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"I sometimes get the following exception when running N5 tests on my workstation:\r\n```\r\nTesting lz4 uint8\r\njava.nio.file.DirectoryNotEmptyException: /groups/saalfeld/home/pisarevi/tmp/n5-test/test/group/dataset/0/0\r\n\tat sun.nio.fs.UnixFileSystemProvider.implDelete(UnixFileSystemProvider.java:242)\r\n\tat sun.nio.fs.AbstractFileSystemProvider.delete(AbstractFileSystemProvider.java:103)\r\n\tat java.nio.file.Files.delete(Files.java:1126)\r\n\tat org.janelia.saalfeldlab.n5.N5FSWriter.lambda$remove$0(N5FSWriter.java:159)\r\n\tat java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:184)\r\n\tat java.util.ArrayList.forEach(ArrayList.java:1257)\r\n\tat java.util.stream.SortedOps$RefSortingSink.end(SortedOps.java:390)\r\n\tat java.util.stream.Sink$ChainedReference.end(Sink.java:258)\r\n\tat java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)\r\n\tat java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)\r\n\tat java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)\r\n\tat java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)\r\n\tat java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)\r\n\tat java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)\r\n\tat org.janelia.saalfeldlab.n5.N5FSWriter.remove(N5FSWriter.java:150)\r\n\tat org.janelia.saalfeldlab.n5.AbstractN5Test.testWriteReadByteBlock(AbstractN5Test.java:171)\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n\tat java.lang.reflect.Method.invoke(Method.java:498)\r\n\tat org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50)\r\n\tat org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)\r\n\tat org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47)\r\n\tat org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)\r\n\tat org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)\r\n\tat org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:325)\r\n\tat org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:78)\r\n\tat org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:57)\r\n\tat org.junit.runners.ParentRunner$3.run(ParentRunner.java:290)\r\n\tat org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:71)\r\n\tat org.junit.runners.ParentRunner.runChildren(ParentRunner.java:288)\r\n\tat org.junit.runners.ParentRunner.access$000(ParentRunner.java:58)\r\n\tat org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:268)\r\n\tat org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)\r\n\tat org.junit.runners.ParentRunner.run(ParentRunner.java:363)\r\n\tat org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)\r\n[ERROR] Tests run: 16, Failures: 1, Errors: 0, Skipped: 0, Time elapsed: 8.308 s <<< FAILURE! - in org.janelia.saalfeldlab.n5.N5FSTest\r\n[ERROR] testWriteReadByteBlock(org.janelia.saalfeldlab.n5.N5FSTest)  Time elapsed: 0.455 s  <<< FAILURE!\r\njava.lang.AssertionError\r\n```\r\n\r\nIt's quite rare and most of the time the tests succeed, but it's more likely to occur in n5-spark tests, and the error is identical: https://github.com/saalfeldlab/n5-spark/issues/13\r\n\r\nIt seems that it happens only on the network file system. I've never seen this when building on a laptop where test files are written and deleted from a local drive.","closed_by":{"login":"igorpisarev","id":6253116,"node_id":"MDQ6VXNlcjYyNTMxMTY=","avatar_url":"https://avatars.githubusercontent.com/u/6253116?v=4","gravatar_id":"","url":"https://api.github.com/users/igorpisarev","html_url":"https://github.com/igorpisarev","followers_url":"https://api.github.com/users/igorpisarev/followers","following_url":"https://api.github.com/users/igorpisarev/following{/other_user}","gists_url":"https://api.github.com/users/igorpisarev/gists{/gist_id}","starred_url":"https://api.github.com/users/igorpisarev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/igorpisarev/subscriptions","organizations_url":"https://api.github.com/users/igorpisarev/orgs","repos_url":"https://api.github.com/users/igorpisarev/repos","events_url":"https://api.github.com/users/igorpisarev/events{/privacy}","received_events_url":"https://api.github.com/users/igorpisarev/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/saalfeldlab/n5/issues/63/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/saalfeldlab/n5/issues/63/timeline","performed_via_github_app":null,"state_reason":"completed"}