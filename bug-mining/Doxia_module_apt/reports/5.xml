<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 17:53:22 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[DOXIA-222] XhtmlBaseParser swallows significant whitespace</title>
                <link>https://issues.apache.org/jira/browse/DOXIA-222</link>
                <project id="12317230" key="DOXIA">Maven Doxia (Moved to GitHub Issues)</project>
                    <description>&lt;p&gt;The current head discards whitespace which is intended to seperate words.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12801660">DOXIA-222</key>
            <summary>XhtmlBaseParser swallows significant whitespace</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ltheussl">Lukas Theussl</assignee>
                                    <reporter username="bentmann">Benjamin Bentmann</reporter>
                        <labels>
                    </labels>
                <created>Sun, 17 Feb 2008 07:46:19 +0000</created>
                <updated>Tue, 15 Jul 2025 09:59:40 +0000</updated>
                            <resolved>Fri, 22 Feb 2008 07:44:05 +0000</resolved>
                                    <version>1.1</version>
                                    <fixVersion>1.1</fixVersion>
                                    <component>Core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="14431339" author="ltheussl" created="Sun, 17 Feb 2008 09:39:31 +0000"  >&lt;p&gt;This patch breaks the identity tests in xdoc and xhtml modules as there are many more text events emitted by the parser now. Need to clarify if this should be fixed in the tests or in the corresponding sinks. Generally, we should add a XhtmlBaseParser/SinkTest.&lt;/p&gt;</comment>
                            <comment id="14431484" author="bentmann" created="Sun, 17 Feb 2008 10:17:14 +0000"  >&lt;p&gt;To clarify the use case: The inputs&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-xml&quot;&gt;&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;b&amp;gt;&lt;/span&gt;word&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/b&amp;gt;&lt;/span&gt; &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;i&amp;gt;&lt;/span&gt;word&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/i&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;and&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-xml&quot;&gt;&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;b&amp;gt;&lt;/span&gt;word&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/b&amp;gt;&lt;/span&gt;
&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;i&amp;gt;&lt;/span&gt;word&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/i&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;should render as given. The unpatched parser discards&lt;br/&gt;
a) text blocks that consist only of whitespace as in the first example&lt;br/&gt;
b) trailing newlines as in the second example&lt;/p&gt;</comment>
                            <comment id="14431451" author="ltheussl" created="Sun, 17 Feb 2008 10:47:14 +0000"  >&lt;p&gt;I agree that this needs to be fixed, only keep the identity tests intact.&lt;/p&gt;</comment>
                            <comment id="14431398" author="bentmann" created="Sun, 17 Feb 2008 18:25:57 +0000"  >&lt;p&gt;I think the tests themselves are alright, the sinks would need adjustment to match the altered parser behaviour. For example, I temporarily removed the EOL writes in &lt;tt&gt;AbstractXmlSink.writeStartTag()&lt;/tt&gt; and &lt;tt&gt;AbstractXmlSink.writeEndTag()&lt;/tt&gt; and the XDoc/XHTML tests passed (Docbook kept failing but that seems to be another issue, I watched it sinking &quot;Tablecaption&quot; instead of &quot;Table caption&quot; ...)&lt;/p&gt;

&lt;p&gt;Ignorable or significant whitespace, that&apos;s the whole question here. Unless the &lt;tt&gt;XhtmlBaseParser&lt;/tt&gt; can validate the input with a DTD/XSD, it can only report all whitespace as significant. As a consequence, a sink should not emit any whitespace that is intended to be ignored (as done now for some pretty printing) because the parser would erroneously classify it as significant later on.&lt;/p&gt;

&lt;p&gt;If the pretty printing should be kept, a parser like XdocParser could track the element hierarchy to manually maintain a flag whether the currently parsed element has mixed content or just element content. &lt;tt&gt;XhtmlBaseParser.handleText()&lt;/tt&gt; could then evaluate this flag to decide how to deal with whitespace.&lt;/p&gt;</comment>
                            <comment id="14431436" author="ltheussl" created="Mon, 18 Feb 2008 04:46:00 +0000"  >&lt;p&gt;For your first paragraph see &lt;a href=&quot;https://issues.apache.org/jira/browse/DOXIA-189&quot; title=&quot;newline added after every closing tag&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DOXIA-189&quot;&gt;&lt;del&gt;DOXIA-189&lt;/del&gt;&lt;/a&gt; and the discussion that ensued on the dev list: &lt;a href=&quot;http://tinyurl.com/2f48m8&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://tinyurl.com/2f48m8&lt;/a&gt; .&lt;/p&gt;

&lt;p&gt;IMO the doxia core sinks are not supposed to be pretty printers, pretty printing should be done by a low-level end-user sink,eg the SiteRenderingSink. At least we need to decouple the pretty printing in order to be able to test (the docbook tests fail because the linebreaker inserts a newline which is later deleted in the test).&lt;/p&gt;</comment>
                            <comment id="14431371" author="bentmann" created="Mon, 18 Feb 2008 17:43:13 +0000"  >&lt;blockquote&gt;&lt;p&gt;see &lt;a href=&quot;https://issues.apache.org/jira/browse/DOXIA-189&quot; title=&quot;newline added after every closing tag&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DOXIA-189&quot;&gt;&lt;del&gt;DOXIA-189&lt;/del&gt;&lt;/a&gt; and the discussion that ensued on the dev list: &lt;a href=&quot;http://tinyurl.com/2f48m8&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://tinyurl.com/2f48m8&lt;/a&gt;.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I agree with you that &lt;tt&gt;AbstractXmlSink&lt;/tt&gt; should not do any pretty printing by itself because XML is just too low-level and pretty printing requires knowledge about the exact semantics of the output format. For this reason, &lt;tt&gt;AbstractXmlSink.writeStartTag()&lt;/tt&gt; should not emit an eol for &quot;simple&quot; tags because an inline element can in general not know whether its surrounding block element supports ignorable whitespace such that the current heuristic may cause errors sooner or later.&lt;/p&gt;

&lt;p&gt;Being a user, I consider human-friendly sink output a nice to have feature and hence have no arguments against abstract sinks that provide means for their subclasses to add ignorable whitespace to the output. However, as a matter of design, I suggest to decouple pretty printing and actual content output from one other in the sink methods. I.e. instead of offering both &lt;tt&gt;writeEndTag()&lt;/tt&gt; and &lt;tt&gt;writeEndTagWithoutEOL()&lt;/tt&gt; discard the former one and rename the later one to &lt;tt&gt;writeEndTag()&lt;/tt&gt; such that this method does really what it name suggests to readers, write the end tag but no more. Writing the EOL (and maybe some indent?) would then be provided by a dedicated method, say &lt;tt&gt;writeEOL()&lt;/tt&gt;. Subclasses that want to pretty print would invoke &lt;tt&gt;writeEndTag()&lt;/tt&gt; and &lt;tt&gt;writeEOL()&lt;/tt&gt; explicitly, again leading to better understandable/maintainable code IMHO.&lt;/p&gt;

&lt;p&gt;As for the parsing site: In concern of robustness, I believe it is a desirable feature of AbstractXmlParser and all its subclasses if their output does not differ regardless whether the underlying XML parser is equipped with a DTD/XSD when parsing or not (i.e. whether ignorable whitespace may be reported). This could be realized by&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;have all doxia XML parsers assume their underlying XML parser cannot detect ignorable whitespace but reports it as PCDATA&lt;/li&gt;
	&lt;li&gt;add a boolean flag to AbstractXmlParser that subclasses like &lt;tt&gt;XdocParser&lt;/tt&gt; can use to control whether the currently parsed element has mixed content or not&lt;/li&gt;
	&lt;li&gt;move &lt;tt&gt;handleText()&lt;/tt&gt; from &lt;tt&gt;AbstractXhtmlParser&lt;/tt&gt; up to &lt;tt&gt;AbstractXmlParser&lt;/tt&gt; and have it appropriately trim the text if the ignorableWhitespace flag is set&lt;/li&gt;
&lt;/ol&gt;
</comment>
                            <comment id="14431399" author="ltheussl" created="Fri, 22 Feb 2008 07:44:05 +0000"  >&lt;p&gt;Fixed in r630198 with a couple of necessary adjustments in various tests.&lt;/p&gt;

&lt;p&gt;For your parsing comments I suggest you open a separate issue for discussion.&lt;/p&gt;

&lt;p&gt;Thanks!&lt;/p&gt;</comment>
                            <comment id="18006111" author="sparsick" created="Tue, 15 Jul 2025 09:59:40 +0000"  >&lt;p&gt;This project has moved from Jira to GitHub Issues. This issue was migrated to &lt;a href=&quot;https://github.com/apache/maven-doxia/issues/766&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;apache/maven-doxia#766&lt;/a&gt;. &lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310260">
                    <name>Related</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12801678">DOXIA-225</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12801369">DOXIA-405</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12715575" name="significant-whitespace.patch" size="1714" author="bentmann" created="Sun, 17 Feb 2008 07:46:19 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[no_permission]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310250" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10430"><![CDATA[Patch]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            16 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2a0xb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>