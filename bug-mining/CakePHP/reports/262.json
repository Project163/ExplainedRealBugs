{"url":"https://api.github.com/repos/cakephp/cakephp/issues/17025","repository_url":"https://api.github.com/repos/cakephp/cakephp","labels_url":"https://api.github.com/repos/cakephp/cakephp/issues/17025/labels{/name}","comments_url":"https://api.github.com/repos/cakephp/cakephp/issues/17025/comments","events_url":"https://api.github.com/repos/cakephp/cakephp/issues/17025/events","html_url":"https://github.com/cakephp/cakephp/issues/17025","id":1593635533,"node_id":"I_kwDOAAoEbs5e_PLN","number":17025,"title":"Plugin ErrorController not called when inside prefix routing","user":{"login":"ishanvyas22","id":17404636,"node_id":"MDQ6VXNlcjE3NDA0NjM2","avatar_url":"https://avatars.githubusercontent.com/u/17404636?v=4","gravatar_id":"","url":"https://api.github.com/users/ishanvyas22","html_url":"https://github.com/ishanvyas22","followers_url":"https://api.github.com/users/ishanvyas22/followers","following_url":"https://api.github.com/users/ishanvyas22/following{/other_user}","gists_url":"https://api.github.com/users/ishanvyas22/gists{/gist_id}","starred_url":"https://api.github.com/users/ishanvyas22/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ishanvyas22/subscriptions","organizations_url":"https://api.github.com/users/ishanvyas22/orgs","repos_url":"https://api.github.com/users/ishanvyas22/repos","events_url":"https://api.github.com/users/ishanvyas22/events{/privacy}","received_events_url":"https://api.github.com/users/ishanvyas22/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":60504144,"node_id":"MDU6TGFiZWw2MDUwNDE0NA==","url":"https://api.github.com/repos/cakephp/cakephp/labels/enhancement","name":"enhancement","color":"bfe5bf","default":true,"description":""},{"id":60505665,"node_id":"MDU6TGFiZWw2MDUwNTY2NQ==","url":"https://api.github.com/repos/cakephp/cakephp/labels/errorhandler","name":"errorhandler","color":"FFFFFF","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/cakephp/cakephp/milestones/279","html_url":"https://github.com/cakephp/cakephp/milestone/279","labels_url":"https://api.github.com/repos/cakephp/cakephp/milestones/279/labels","id":8056001,"node_id":"MI_kwDOAAoEbs4AeuzB","number":279,"title":"4.5.0","description":"4.5.0 can introduce new features and deprecations to be removed in 5.x. 4.5.0 will receive feature backports from 5.x where the core team or community think they will help future upgrade paths or don't rely on breaking changes. Community contributions are always welcome.","creator":{"login":"markstory","id":24086,"node_id":"MDQ6VXNlcjI0MDg2","avatar_url":"https://avatars.githubusercontent.com/u/24086?v=4","gravatar_id":"","url":"https://api.github.com/users/markstory","html_url":"https://github.com/markstory","followers_url":"https://api.github.com/users/markstory/followers","following_url":"https://api.github.com/users/markstory/following{/other_user}","gists_url":"https://api.github.com/users/markstory/gists{/gist_id}","starred_url":"https://api.github.com/users/markstory/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/markstory/subscriptions","organizations_url":"https://api.github.com/users/markstory/orgs","repos_url":"https://api.github.com/users/markstory/repos","events_url":"https://api.github.com/users/markstory/events{/privacy}","received_events_url":"https://api.github.com/users/markstory/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":132,"state":"closed","created_at":"2022-06-07T03:20:01Z","updated_at":"2023-10-15T03:00:10Z","due_on":null,"closed_at":"2023-10-15T03:00:10Z"},"comments":1,"created_at":"2023-02-21T15:01:58Z","updated_at":"2023-03-25T14:49:35Z","closed_at":"2023-03-25T14:49:35Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Description\r\n\r\n## Current behavior\r\nWe want to render specific template when error is thrown from the plugin. For that we have `ErrorController` inside main plugin namespace(let's call it `Company\\Plugin\\Controller`), so it would be `Company\\Plugin1\\Controller\\ErrorController`. \r\n\r\nNow when we throw exception from prefix route's controller i.e. `Company\\Plugin\\Controller\\Prefix1\\FooController` or `Company\\Plugin\\Controller\\Prefix2\\BarController`, it doesn't take plugin's `Company\\Plugin1\\Controller\\ErrorController` into account. But, it calls core's controller(`App\\Controller\\ErrorController`).\r\n\r\nUpon digging into `ControllerFactory`, it tries to find `Company\\Plugin\\Controller\\Prefix1\\ErrorController`.\r\n```php\r\n// inside Cake\\Controller\\ControllerFactory\r\npublic function getControllerClass(ServerRequest $request): ?string\r\n{\r\n    ...\r\n\r\n    // here in $namespace: Controller/Prefix1 (or Controller/Prefix2)\r\n    return App::className($pluginPath . $controller, $namespace, 'Controller');\r\n}\r\n```\r\n\r\n## Expected behavior\r\nPlugin's ErrorController(`Company\\Plugin1\\Controller\\ErrorController` in our example) should be called.\r\n\r\n### CakePHP Version\r\n\r\n4.3.11\r\n\r\n### PHP Version\r\n\r\n_No response_","closed_by":{"login":"ADmad","id":142658,"node_id":"MDQ6VXNlcjE0MjY1OA==","avatar_url":"https://avatars.githubusercontent.com/u/142658?v=4","gravatar_id":"","url":"https://api.github.com/users/ADmad","html_url":"https://github.com/ADmad","followers_url":"https://api.github.com/users/ADmad/followers","following_url":"https://api.github.com/users/ADmad/following{/other_user}","gists_url":"https://api.github.com/users/ADmad/gists{/gist_id}","starred_url":"https://api.github.com/users/ADmad/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ADmad/subscriptions","organizations_url":"https://api.github.com/users/ADmad/orgs","repos_url":"https://api.github.com/users/ADmad/repos","events_url":"https://api.github.com/users/ADmad/events{/privacy}","received_events_url":"https://api.github.com/users/ADmad/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/cakephp/cakephp/issues/17025/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/cakephp/cakephp/issues/17025/timeline","performed_via_github_app":null,"state_reason":"completed"}