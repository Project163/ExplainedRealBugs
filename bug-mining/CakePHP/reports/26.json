{"url":"https://api.github.com/repos/cakephp/cakephp/issues/11084","repository_url":"https://api.github.com/repos/cakephp/cakephp","labels_url":"https://api.github.com/repos/cakephp/cakephp/issues/11084/labels{/name}","comments_url":"https://api.github.com/repos/cakephp/cakephp/issues/11084/comments","events_url":"https://api.github.com/repos/cakephp/cakephp/issues/11084/events","html_url":"https://github.com/cakephp/cakephp/issues/11084","id":252390156,"node_id":"MDU6SXNzdWUyNTIzOTAxNTY=","number":11084,"title":"Manipulating Response in View Classes is not possible","user":{"login":"vonboth","id":2707967,"node_id":"MDQ6VXNlcjI3MDc5Njc=","avatar_url":"https://avatars.githubusercontent.com/u/2707967?v=4","gravatar_id":"","url":"https://api.github.com/users/vonboth","html_url":"https://github.com/vonboth","followers_url":"https://api.github.com/users/vonboth/followers","following_url":"https://api.github.com/users/vonboth/following{/other_user}","gists_url":"https://api.github.com/users/vonboth/gists{/gist_id}","starred_url":"https://api.github.com/users/vonboth/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vonboth/subscriptions","organizations_url":"https://api.github.com/users/vonboth/orgs","repos_url":"https://api.github.com/users/vonboth/repos","events_url":"https://api.github.com/users/vonboth/events{/privacy}","received_events_url":"https://api.github.com/users/vonboth/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":60504544,"node_id":"MDU6TGFiZWw2MDUwNDU0NA==","url":"https://api.github.com/repos/cakephp/cakephp/labels/defect","name":"defect","color":"e50f2c","default":false,"description":""},{"id":366710687,"node_id":"MDU6TGFiZWwzNjY3MTA2ODc=","url":"https://api.github.com/repos/cakephp/cakephp/labels/http","name":"http","color":"ffffff","default":false,"description":null}],"state":"closed","locked":false,"assignee":{"login":"markstory","id":24086,"node_id":"MDQ6VXNlcjI0MDg2","avatar_url":"https://avatars.githubusercontent.com/u/24086?v=4","gravatar_id":"","url":"https://api.github.com/users/markstory","html_url":"https://github.com/markstory","followers_url":"https://api.github.com/users/markstory/followers","following_url":"https://api.github.com/users/markstory/following{/other_user}","gists_url":"https://api.github.com/users/markstory/gists{/gist_id}","starred_url":"https://api.github.com/users/markstory/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/markstory/subscriptions","organizations_url":"https://api.github.com/users/markstory/orgs","repos_url":"https://api.github.com/users/markstory/repos","events_url":"https://api.github.com/users/markstory/events{/privacy}","received_events_url":"https://api.github.com/users/markstory/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"markstory","id":24086,"node_id":"MDQ6VXNlcjI0MDg2","avatar_url":"https://avatars.githubusercontent.com/u/24086?v=4","gravatar_id":"","url":"https://api.github.com/users/markstory","html_url":"https://github.com/markstory","followers_url":"https://api.github.com/users/markstory/followers","following_url":"https://api.github.com/users/markstory/following{/other_user}","gists_url":"https://api.github.com/users/markstory/gists{/gist_id}","starred_url":"https://api.github.com/users/markstory/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/markstory/subscriptions","organizations_url":"https://api.github.com/users/markstory/orgs","repos_url":"https://api.github.com/users/markstory/repos","events_url":"https://api.github.com/users/markstory/events{/privacy}","received_events_url":"https://api.github.com/users/markstory/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":{"url":"https://api.github.com/repos/cakephp/cakephp/milestones/143","html_url":"https://github.com/cakephp/cakephp/milestone/143","labels_url":"https://api.github.com/repos/cakephp/cakephp/milestones/143/labels","id":2710600,"node_id":"MDk6TWlsZXN0b25lMjcxMDYwMA==","number":143,"title":"3.5.1","description":"Bugfixes for 3.5.x","creator":{"login":"markstory","id":24086,"node_id":"MDQ6VXNlcjI0MDg2","avatar_url":"https://avatars.githubusercontent.com/u/24086?v=4","gravatar_id":"","url":"https://api.github.com/users/markstory","html_url":"https://github.com/markstory","followers_url":"https://api.github.com/users/markstory/followers","following_url":"https://api.github.com/users/markstory/following{/other_user}","gists_url":"https://api.github.com/users/markstory/gists{/gist_id}","starred_url":"https://api.github.com/users/markstory/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/markstory/subscriptions","organizations_url":"https://api.github.com/users/markstory/orgs","repos_url":"https://api.github.com/users/markstory/repos","events_url":"https://api.github.com/users/markstory/events{/privacy}","received_events_url":"https://api.github.com/users/markstory/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":36,"state":"closed","created_at":"2017-08-19T01:40:27Z","updated_at":"2017-08-29T01:37:56Z","due_on":"2017-08-28T07:00:00Z","closed_at":"2017-08-29T01:37:56Z"},"comments":1,"created_at":"2017-08-23T19:25:57Z","updated_at":"2017-08-24T04:13:38Z","closed_at":"2017-08-24T04:13:37Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"This is a (multiple allowed):\r\n\r\n* [x] bug\r\n* [ ] enhancement\r\n* [ ] feature-discussion (RFC)\r\n\r\n* CakePHP Version: 3.5\r\n* Platform and Target: XAMP on Linux, CakePHP 3.5.0\r\n\r\n### What you did\r\nTrying to manipulate the Response object with the new 'with...' functions in a View class.\r\n(e.g. AjaxView)\r\n\r\n### What happened\r\nChanged in a View class (e.g. default App\\AjaxView)  the $this->response object.\r\ne.g.\r\n$this->response = $this->response->withStatus(401) will not update the Response object in the Controller class\r\n\r\n### What you expected to happen\r\nThe response object to be changed\r\n\r\n### Explanations\r\nThe with...-functions return a clone of the Response object which has been passed from Controller class.\r\nSetting $this->response in a View class will change the property $this->response in the View class but will not update the Response object in the Controller class.\r\n\r\nI believe it is because the object is cloned and is therefore a copy of the original one.\r\nSo when you step up from View back to Controller $this->response in the Controller remain unchanged.\r\n\r\nThe only way to change the Response is to do it directly in the controller, before rendering.\r\nChanging it inside View classes won't work with the 'with....-functions'\r\n\r\nDon't know if this is intention and I'm missing something or don't understand this fully.\r\n\r\nIf one want's to update the Controller then $this->response inside the View class has to be transfered back into the Controller class, e.g. in Controller->render\r\n```\r\n623 $this->View = $this->createView();\r\n624 $rendered = $this->View->render($view, $layout);\r\n625 $this->response = $this->View->response;\r\n626 $this->response->body($rendered);\r\n```","closed_by":{"login":"markstory","id":24086,"node_id":"MDQ6VXNlcjI0MDg2","avatar_url":"https://avatars.githubusercontent.com/u/24086?v=4","gravatar_id":"","url":"https://api.github.com/users/markstory","html_url":"https://github.com/markstory","followers_url":"https://api.github.com/users/markstory/followers","following_url":"https://api.github.com/users/markstory/following{/other_user}","gists_url":"https://api.github.com/users/markstory/gists{/gist_id}","starred_url":"https://api.github.com/users/markstory/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/markstory/subscriptions","organizations_url":"https://api.github.com/users/markstory/orgs","repos_url":"https://api.github.com/users/markstory/repos","events_url":"https://api.github.com/users/markstory/events{/privacy}","received_events_url":"https://api.github.com/users/markstory/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/cakephp/cakephp/issues/11084/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/cakephp/cakephp/issues/11084/timeline","performed_via_github_app":null,"state_reason":"completed"}