diff --git a/src/View/Helper.php b/src/View/Helper.php
index 21b4d1639c..26e5de3766 100644
--- a/src/View/Helper.php
+++ b/src/View/Helper.php
@@ -135,35 +135,21 @@ class Helper implements EventListenerInterface
      * @param string $okCode Code to be executed after user chose 'OK'
      * @param string $cancelCode Code to be executed after user chose 'Cancel'
      * @param array $options Array of options
-     * @return string onclick JS code
+     * @return array{message: string, js: string} Array containing message and Javascript code.
      */
-    protected function _confirm(string $message, string $okCode, string $cancelCode = '', array $options = []): string
+    protected function _confirm(string $message, string $okCode, string $cancelCode, array $options = []): array
     {
-        $message = $this->_cleanConfirmMessage($message);
-        $confirm = "if (confirm({$message})) { {$okCode} } {$cancelCode}";
+        /** @var string $message */
+        $message = h($message);
+        $js = "if (confirm(this.dataset.confirmMessage)) { {$okCode} } {$cancelCode}";
         // We cannot change the key here in 3.x, but the behavior is inverted in this case
         $escape = isset($options['escape']) && $options['escape'] === false;
         if ($escape) {
-            /** @var string $confirm */
-            $confirm = h($confirm);
+            /** @var string $js */
+            $js = h($js);
         }
 
-        return $confirm;
-    }
-
-    /**
-     * Returns a string read to be used in confirm()
-     *
-     * @param string|null $message The message to clean
-     * @return string
-     */
-    protected function _cleanConfirmMessage(?string $message): string
-    {
-        if ($message === null) {
-            return '';
-        }
-
-        return str_replace('\\\n', '\n', json_encode($message));
+        return compact('message', 'js');
     }
 
     /**
diff --git a/src/View/Helper/FormHelper.php b/src/View/Helper/FormHelper.php
index b12cbf30d8..8442f04cc3 100644
--- a/src/View/Helper/FormHelper.php
+++ b/src/View/Helper/FormHelper.php
@@ -1738,7 +1738,12 @@ class FormHelper extends Helper
         $confirmMessage = $options['confirm'];
         unset($options['confirm']);
         if ($confirmMessage) {
-            $options['onclick'] = $this->_confirm($confirmMessage, 'return true;', 'return false;', $options);
+            $confirm = $this->_confirm($confirmMessage, 'return true;', 'return false;', $options);
+            $options['data-confirm-message'] = $confirm['message'];
+            $options['onclick'] = $this->templater()->format('confirmJs', [
+                'confirmMessage' => $confirm['message'],
+                'confirm' => $confirm['js'],
+            ]);
         }
 
         return $this->widget('button', $options);
@@ -1885,15 +1890,17 @@ class FormHelper extends Helper
         $onClick = 'document.' . $formName . '.submit();';
         if ($confirmMessage) {
             $confirm = $this->_confirm($confirmMessage, $onClick, '', $options);
+            $onClick = $confirm['js'] . 'event.returnValue = false; return false;';
+            $onClick = $this->templater()->format('confirmJs', [
+                'confirmMessage' => $confirm['message'],
+                'formName' => $formName,
+                'confirm' => $onClick,
+            ]);
+            $options['data-confirm-message'] = $confirm['message'];
         } else {
-            $confirm = $onClick . ' ';
+            $onClick .= ' event.returnValue = false; return false;';
         }
-        $confirm .= 'event.returnValue = false; return false;';
-        $options['onclick'] = $this->templater()->format('confirmJs', [
-            'confirmMessage' => $this->_cleanConfirmMessage($confirmMessage),
-            'formName' => $formName,
-            'confirm' => $confirm,
-        ]);
+        $options['onclick'] = $onClick;
 
         $out .= $this->Html->link($title, $url, $options);
 
diff --git a/src/View/Helper/HtmlHelper.php b/src/View/Helper/HtmlHelper.php
index 324602df12..b7afb8bd72 100644
--- a/src/View/Helper/HtmlHelper.php
+++ b/src/View/Helper/HtmlHelper.php
@@ -325,9 +325,10 @@ class HtmlHelper extends Helper
         }
         if ($confirmMessage) {
             $confirm = $this->_confirm($confirmMessage, 'return true;', 'return false;', $options);
+            $options['data-confirm-message'] = $confirm['message'];
             $options['onclick'] = $templater->format('confirmJs', [
-                'confirmMessage' => $this->_cleanConfirmMessage($confirmMessage),
-                'confirm' => $confirm,
+                'confirmMessage' => $confirm['message'],
+                'confirm' => $confirm['js'],
             ]);
         }
 
diff --git a/tests/TestCase/View/Helper/FormHelperTest.php b/tests/TestCase/View/Helper/FormHelperTest.php
index cd1da399c2..e9445e86fb 100644
--- a/tests/TestCase/View/Helper/FormHelperTest.php
+++ b/tests/TestCase/View/Helper/FormHelperTest.php
@@ -6584,7 +6584,11 @@ class FormHelperTest extends TestCase
     public function testButtonWithConfirm()
     {
         $result = $this->Form->button('Hi', ['confirm' => 'Confirm me!']);
-        $expected = ['button' => ['type' => 'submit', 'onclick' => 'if (confirm(&quot;Confirm me!&quot;)) { return true; } return false;'], 'Hi', '/button'];
+        $expected = ['button' => [
+            'type' => 'submit',
+            'data-confirm-message' => 'Confirm me!',
+            'onclick' => 'if (confirm(this.dataset.confirmMessage)) { return true; } return false;',
+        ], 'Hi', '/button'];
         $this->assertHtml($expected, $result);
     }
 
@@ -6793,7 +6797,11 @@ class FormHelperTest extends TestCase
             ],
             'input' => ['type' => 'hidden', 'name' => '_method', 'value' => 'POST'],
             '/form',
-            'a' => ['href' => '#', 'onclick' => 'preg:/if \(confirm\(&quot;Confirm\?&quot;\)\) \{ document\.post_\w+\.submit\(\); \} event\.returnValue = false; return false;/'],
+            'a' => [
+                'href' => '#',
+                'data-confirm-message' => 'Confirm?',
+                'onclick' => 'preg:/if \(confirm\(this.dataset.confirmMessage\)\) \{ document\.post_\w+\.submit\(\); \} event\.returnValue = false; return false;/',
+            ],
             'Delete',
             '/a',
         ];
@@ -6811,13 +6819,17 @@ class FormHelperTest extends TestCase
             ],
             'input' => ['type' => 'hidden', 'name' => '_method', 'value' => 'POST'],
             '/form',
-            'a' => ['href' => '#', 'onclick' => "preg:/if \(confirm\(&quot;&#039;Confirm&#039;\\\\nthis \\\&quot;deletion\\\&quot;\?&quot;\)\) \{ document\.post_\w+\.submit\(\); \} event\.returnValue = false; return false;/"],
+            'a' => [
+                'href' => '#',
+                'data-confirm-message' => "&#039;Confirm&#039;\nthis &quot;deletion&quot;?",
+                'onclick' => "preg:/if \(confirm\(this.dataset.confirmMessage\)\) \{ document\.post_\w+\.submit\(\); \} event\.returnValue = false; return false;/",
+            ],
             'Delete',
             '/a',
         ];
         $this->assertHtml($expected, $result);
 
-        $this->Form->setTemplates(['confirmJs' => 'if (confirm({{confirmMessage}})) { $(\'form[name="{{formName}}"]\').submit();};']);
+        $this->Form->setTemplates(['confirmJs' => 'if (confirm(this.dataset.confirmMessage)) { $(\'form[name="{{formName}}"]\').submit();};']);
         $result = $this->Form->postLink(
             'Delete',
             '/posts/delete/1',
@@ -6830,7 +6842,11 @@ class FormHelperTest extends TestCase
             ],
             'input' => ['type' => 'hidden', 'name' => '_method', 'value' => 'POST'],
             '/form',
-            'a' => ['href' => '#', 'onclick' => 'preg:/if \(confirm\("Confirm this deletion\?"\)\) \{ \$\(\'form\[name="post_\w+"\]\'\)\.submit\(\);\};/'],
+            'a' => [
+                'href' => '#',
+                'data-confirm-message' => 'Confirm this deletion?',
+                'onclick' => 'preg:/if \(confirm\(this.dataset.confirmMessage\)\) \{ \$\(\'form\[name="post_\w+"\]\'\)\.submit\(\);\};/',
+            ],
             'Delete',
             '/a',
         ];
diff --git a/tests/TestCase/View/Helper/HtmlHelperTest.php b/tests/TestCase/View/Helper/HtmlHelperTest.php
index 957e389faf..3adf459bac 100644
--- a/tests/TestCase/View/Helper/HtmlHelperTest.php
+++ b/tests/TestCase/View/Helper/HtmlHelperTest.php
@@ -147,16 +147,24 @@ class HtmlHelperTest extends TestCase
 
         $result = $this->Html->link('Home', '/home', ['confirm' => 'Are you sure you want to do this?']);
         $expected = [
-            'a' => ['href' => '/home', 'onclick' => 'if (confirm(&quot;Are you sure you want to do this?&quot;)) { return true; } return false;'],
+            'a' => [
+                'href' => '/home',
+                'data-confirm-message' => 'Are you sure you want to do this?',
+                'onclick' => 'if (confirm(this.dataset.confirmMessage)) { return true; } return false;',
+            ],
             'Home',
             '/a',
         ];
         $this->assertHtml($expected, $result);
 
-        $this->Html->setTemplates(['confirmJs' => 'if (confirm({{confirmMessage}})) { window.location="/";};']);
+        $this->Html->setTemplates(['confirmJs' => 'if (confirm(this.dataset.confirmMessage)) { window.location="/";};']);
         $result = $this->Html->link('Home', '/home', ['confirm' => 'Are you sure you want to do this?']);
         $expected = [
-            'a' => ['href' => '/home', 'onclick' => 'preg:/if \(confirm\(&quot;Are you sure you want to do this\?&quot;\)\) \{ window\.location=&quot;\/&quot;;\};/'],
+            'a' => [
+                'href' => '/home',
+                'data-confirm-message' => 'Are you sure you want to do this?',
+                'onclick' => 'preg:/if \(confirm\(this.dataset.confirmMessage\)\) \{ window\.location=&quot;\/&quot;;\};/',
+            ],
             'Home',
             '/a',
         ];
@@ -166,7 +174,11 @@ class HtmlHelperTest extends TestCase
 
         $result = $this->Html->link('Home', '/home', ['escape' => false, 'confirm' => 'Confirm\'s "nightmares"']);
         $expected = [
-            'a' => ['href' => '/home', 'onclick' => 'if (confirm(&quot;Confirm&#039;s \&quot;nightmares\&quot;&quot;)) { return true; } return false;'],
+            'a' => [
+                'href' => '/home',
+                'data-confirm-message' => 'Confirm&#039;s &quot;nightmares&quot;',
+                'onclick' => 'if (confirm(this.dataset.confirmMessage)) { return true; } return false;',
+            ],
             'Home',
             '/a',
         ];
