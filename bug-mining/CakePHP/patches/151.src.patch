diff --git a/src/Http/ServerRequestFactory.php b/src/Http/ServerRequestFactory.php
index 27265b261f..35291732bc 100644
--- a/src/Http/ServerRequestFactory.php
+++ b/src/Http/ServerRequestFactory.php
@@ -49,6 +49,7 @@ abstract class ServerRequestFactory implements ServerRequestFactoryInterface
      * @param array $body $_POST superglobal
      * @param array $cookies $_COOKIE superglobal
      * @param array $files $_FILES superglobal
+     * @param string $input php://input Used to stub request streams in testing.
      * @return \Cake\Http\ServerRequest
      * @throws \InvalidArgumentException for invalid file values
      */
@@ -57,7 +58,8 @@ abstract class ServerRequestFactory implements ServerRequestFactoryInterface
         ?array $query = null,
         ?array $body = null,
         ?array $cookies = null,
-        ?array $files = null
+        ?array $files = null,
+        ?string $input = null
     ): ServerRequest {
         $server = normalizeServer($server ?: $_SERVER);
         $uri = static::createUri($server);
@@ -79,6 +81,7 @@ abstract class ServerRequestFactory implements ServerRequestFactoryInterface
             'base' => $uri->base,
             'session' => $session,
             'mergeFilesAsObjects' => Configure::read('App.uploadedFilesAsObjects', true),
+            'input' => $input,
         ]);
 
         return $request;
diff --git a/src/TestSuite/IntegrationTestTrait.php b/src/TestSuite/IntegrationTestTrait.php
index 4c375743f2..e964e29466 100644
--- a/src/TestSuite/IntegrationTestTrait.php
+++ b/src/TestSuite/IntegrationTestTrait.php
@@ -592,19 +592,6 @@ trait IntegrationTestTrait
         }
 
         parse_str($query, $queryData);
-        $props = [
-            'url' => $url,
-            'session' => $session,
-            'query' => $queryData,
-            'files' => [],
-        ];
-        if (is_string($data)) {
-            $props['input'] = $data;
-        } else {
-            $data = $this->_addTokens($tokenUrl, $data);
-            $props['post'] = $this->_castToString($data);
-        }
-        $props['cookies'] = $this->_cookie;
 
         $env = [
             'REQUEST_METHOD' => $method,
@@ -627,7 +614,28 @@ trait IntegrationTestTrait
             }
             unset($this->_request['headers']);
         }
-        $props['environment'] = $env;
+        $props = [
+            'url' => $url,
+            'session' => $session,
+            'query' => $queryData,
+            'files' => [],
+            'environment' => $env,
+        ];
+
+        if (is_string($data)) {
+            $props['input'] = $data;
+        } elseif (
+            is_array($data) &&
+            isset($props['environment']['CONTENT_TYPE']) &&
+            $props['environment']['CONTENT_TYPE'] === 'application/x-www-form-urlencoded'
+        ) {
+            $props['input'] = http_build_query($data);
+        } else {
+            $data = $this->_addTokens($tokenUrl, $data);
+            $props['post'] = $this->_castToString($data);
+        }
+
+        $props['cookies'] = $this->_cookie;
         $props = Hash::merge($props, $this->_request);
 
         return $props;
diff --git a/src/TestSuite/MiddlewareDispatcher.php b/src/TestSuite/MiddlewareDispatcher.php
index 0ca639271b..2d92b1edd5 100644
--- a/src/TestSuite/MiddlewareDispatcher.php
+++ b/src/TestSuite/MiddlewareDispatcher.php
@@ -162,17 +162,11 @@ class MiddlewareDispatcher
             $spec['query'],
             $spec['post'],
             $spec['cookies'],
-            $spec['files']
+            $spec['files'],
+            $spec['input'] ?? null
         );
         $request = $request->withAttribute('session', $spec['session']);
 
-        if (isset($spec['input'])) {
-            $stream = new Stream('php://memory', 'rw');
-            $stream->write($spec['input']);
-            $stream->rewind();
-            $request = $request->withBody($stream);
-        }
-
         return $request;
     }
 
diff --git a/tests/TestCase/TestSuite/IntegrationTestTraitTest.php b/tests/TestCase/TestSuite/IntegrationTestTraitTest.php
index 75cbd78bb1..5a442e90ef 100644
--- a/tests/TestCase/TestSuite/IntegrationTestTraitTest.php
+++ b/tests/TestCase/TestSuite/IntegrationTestTraitTest.php
@@ -467,6 +467,24 @@ class IntegrationTestTraitTest extends TestCase
         $this->assertHeader('X-Middleware', 'true');
     }
 
+    /**
+     * Test that the PSR7 requests receive put data
+     *
+     * @return void
+     */
+    public function testPutDataFormUrlEncoded()
+    {
+        $this->configRequest([
+            'headers' => [
+                'Content-Type' => 'application/x-www-form-urlencoded',
+            ],
+        ]);
+        $this->put('/request_action/post_pass', ['title' => 'value']);
+        $this->assertResponseOk();
+        $data = json_decode('' . $this->_response->getBody());
+        $this->assertSame('value', $data->title);
+    }
+
     /**
      * Test that the uploaded files are passed correctly to the request
      *
