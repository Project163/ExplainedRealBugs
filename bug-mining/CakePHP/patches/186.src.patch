diff --git a/src/ORM/Association/BelongsToMany.php b/src/ORM/Association/BelongsToMany.php
index 37056fae6b..7f2394b1b7 100644
--- a/src/ORM/Association/BelongsToMany.php
+++ b/src/ORM/Association/BelongsToMany.php
@@ -1091,8 +1091,9 @@ class BelongsToMany extends Association
      */
     protected function _appendJunctionJoin(Query $query, ?array $conditions = null): Query
     {
+        $junctionTable = $this->junction();
         if ($conditions === null) {
-            $belongsTo = $this->junction()->getAssociation($this->getTarget()->getAlias());
+            $belongsTo = $junctionTable->getAssociation($this->getTarget()->getAlias());
             $conditions = $belongsTo->_joinCondition([
                 'foreignKey' => $this->getTargetForeignKey(),
             ]);
@@ -1104,15 +1105,14 @@ class BelongsToMany extends Association
         $joins = $query->clause('join');
         $matching = [
             $name => [
-                'table' => $this->junction()->getTable(),
+                'table' => $junctionTable->getTable(),
                 'conditions' => $conditions,
                 'type' => Query::JOIN_TYPE_INNER,
             ],
         ];
 
-        $assoc = $this->getTarget()->getAssociation($name);
         $query
-            ->addDefaultTypes($assoc->getTarget())
+            ->addDefaultTypes($junctionTable)
             ->join($matching + $joins, [], true);
 
         return $query;
@@ -1195,14 +1195,21 @@ class BelongsToMany extends Association
 
                 // Find existing rows so that we can diff with new entities.
                 // Only hydrate primary/foreign key columns to save time.
-                $existing = $this->find()
+                // Attach joins first to ensure where conditions have correct
+                // column types set.
+                $existing = $this->_appendJunctionJoin($this->find())
                     ->select($keys)
                     ->where(array_combine($prefixedForeignKey, $primaryValue));
-                $existing = $this->_appendJunctionJoin($existing);
+
+                // Because we're aliasing key fields to look like they are not
+                // from joined table we need to overwrite the type map as the junction
+                // table can have a surrogate primary key that doesn't share a type
+                // with the target table.
+                $junctionTypes = array_intersect_key($junction->getSchema()->typeMap(), $keys);
+                $existing->getSelectTypeMap()->setTypes($junctionTypes);
 
                 $jointEntities = $this->_collectJointEntities($sourceEntity, $targetEntities);
                 $inserts = $this->_diffLinks($existing, $jointEntities, $targetEntities, $options);
-
                 if ($inserts === false) {
                     return false;
                 }
diff --git a/tests/Fixture/BinaryUuiditemsBinaryUuidtagsFixture.php b/tests/Fixture/BinaryUuiditemsBinaryUuidtagsFixture.php
new file mode 100644
index 0000000000..8162e1c881
--- /dev/null
+++ b/tests/Fixture/BinaryUuiditemsBinaryUuidtagsFixture.php
@@ -0,0 +1,48 @@
+<?php
+/**
+ * CakePHP(tm) : Rapid Development Framework (https://cakephp.org)
+ * Copyright (c) Cake Software Foundation, Inc. (https://cakefoundation.org)
+ *
+ * Licensed under The MIT License
+ * For full copyright and license information, please see the LICENSE.txt
+ * Redistributions of files must retain the above copyright notice
+ *
+ * @copyright     Copyright (c) Cake Software Foundation, Inc. (https://cakefoundation.org)
+ * @link          https://cakephp.org CakePHP(tm) Project
+ * @since         4.1.8
+ * @license       https://opensource.org/licenses/mit-license.php MIT License
+ */
+namespace Cake\Test\Fixture;
+
+use Cake\TestSuite\Fixture\TestFixture;
+
+/**
+ * BinaryUuiditemsBinaryUuidtagsFixture
+ */
+class BinaryUuiditemsBinaryUuidtagsFixture extends TestFixture
+{
+    /**
+     * fields property
+     *
+     * @var array
+     */
+    public $fields = [
+        'id' => ['type' => 'integer'],
+        'binary_uuiditem_id' => ['type' => 'binaryuuid', 'null' => false],
+        'binary_uuidtag_id' => ['type' => 'binaryuuid', 'null' => false],
+        '_constraints' => [
+            'primary' => ['type' => 'primary', 'columns' => ['id']],
+            'unique_item_tag' => [
+                'type' => 'unique',
+                'columns' => ['binary_uuiditem_id', 'binary_uuidtag_id']
+            ]
+        ],
+    ];
+
+    /**
+     * records property
+     *
+     * @var array
+     */
+    public $records = [];
+}
diff --git a/tests/Fixture/BinaryUuidtagsFixture.php b/tests/Fixture/BinaryUuidtagsFixture.php
new file mode 100644
index 0000000000..d04ded9321
--- /dev/null
+++ b/tests/Fixture/BinaryUuidtagsFixture.php
@@ -0,0 +1,44 @@
+<?php
+/**
+ * CakePHP(tm) : Rapid Development Framework (https://cakephp.org)
+ * Copyright (c) Cake Software Foundation, Inc. (https://cakefoundation.org)
+ *
+ * Licensed under The MIT License
+ * For full copyright and license information, please see the LICENSE.txt
+ * Redistributions of files must retain the above copyright notice
+ *
+ * @copyright     Copyright (c) Cake Software Foundation, Inc. (https://cakefoundation.org)
+ * @link          https://cakephp.org CakePHP(tm) Project
+ * @since         4.1.8
+ * @license       https://opensource.org/licenses/mit-license.php MIT License
+ */
+namespace Cake\Test\Fixture;
+
+use Cake\TestSuite\Fixture\TestFixture;
+
+/**
+ * BinaryUuidtagsFixture
+ */
+class BinaryUuidtagsFixture extends TestFixture
+{
+    /**
+     * fields property
+     *
+     * @var array
+     */
+    public $fields = [
+        'id' => ['type' => 'binaryuuid'],
+        'name' => ['type' => 'string', 'null' => false],
+        '_constraints' => ['primary' => ['type' => 'primary', 'columns' => ['id']]],
+    ];
+
+    /**
+     * records property
+     *
+     * @var array
+     */
+    public $records = [
+        ['id' => '481fc6d0-b920-43e0-a40d-111111111111', 'name' => 'Defect'],
+        ['id' => '48298a29-81c0-4c26-a7fb-222222222222', 'name' => 'Enhancement'],
+    ];
+}
diff --git a/tests/TestCase/ORM/Association/BelongsToManyTest.php b/tests/TestCase/ORM/Association/BelongsToManyTest.php
index e34f739b11..9505797d93 100644
--- a/tests/TestCase/ORM/Association/BelongsToManyTest.php
+++ b/tests/TestCase/ORM/Association/BelongsToManyTest.php
@@ -41,7 +41,15 @@ class BelongsToManyTest extends TestCase
      *
      * @var array
      */
-    protected $fixtures = ['core.Articles', 'core.SpecialTags', 'core.ArticlesTags', 'core.Tags'];
+    protected $fixtures = [
+        'core.Articles',
+        'core.SpecialTags',
+        'core.ArticlesTags',
+        'core.Tags',
+        'core.BinaryUuiditems',
+        'core.BinaryUuidtags',
+        'core.BinaryUuiditemsBinaryUuidtags',
+    ];
 
     /**
      * Set up
@@ -995,6 +1003,43 @@ class BelongsToManyTest extends TestCase
         $this->assertSame('tag1', $entity->tags[0]->name);
     }
 
+    /**
+     * Tests that replaceLinks will delete entities not present in the passed,
+     * array, maintain those are already persisted and were passed and also
+     * insert the rest.
+     *
+     * @return void
+     */
+    public function testReplaceLinkBinaryUuid()
+    {
+        $items = $this->getTableLocator()->get('BinaryUuiditems');
+        $tags = $this->getTableLocator()->get('BinaryUuidtags');
+
+        $items->belongsToMany('BinaryUuidtags', [
+            'sourceTable' => $items,
+            'targetTable' => $tags,
+        ]);
+        $itemId = '481fc6d0-b920-43e0-a40d-6d1740cf8569';
+        $item = $items->get($itemId);
+
+        // 1=existing, 2=new tag
+        $item->binary_uuidtags = [
+            new Entity(['id' => '481fc6d0-b920-43e0-a40d-111111111111'], ['markNew' => false]),
+            new Entity(['name' => 'net new']),
+        ];
+        $item->name = 'Updated';
+        $items->saveOrFail($item);
+
+        $refresh = $items->get($itemId, ['contain' => 'BinaryUuidtags']);
+        $this->assertCount(2, $refresh->binary_uuidtags, 'Two tags should exist');
+
+        $refresh->binary_uuidtags = [$refresh->binary_uuidtags[0]];
+        $items->save($refresh);
+
+        $refresh = $items->get($itemId, ['contain' => 'BinaryUuidtags']);
+        $this->assertCount(1, $refresh->binary_uuidtags, 'One tag should remain');
+    }
+
     /**
      * Provider for empty values
      *
