diff --git a/composer.json b/composer.json
index e3c4fb476c..7f60977028 100644
--- a/composer.json
+++ b/composer.json
@@ -61,7 +61,7 @@
         "http-interop/http-factory-tests": "^2.0",
         "mikey179/vfsstream": "^1.6.10",
         "mockery/mockery": "^1.6",
-        "paragonie/csp-builder": "^2.3",
+        "paragonie/csp-builder": "^2.3 || ^3.0",
         "phpunit/phpunit": "^10.1.0"
     },
     "suggest": {
diff --git a/src/Command/CacheClearGroupCommand.php b/src/Command/CacheClearGroupCommand.php
index ed735b13d3..66790edb48 100644
--- a/src/Command/CacheClearGroupCommand.php
+++ b/src/Command/CacheClearGroupCommand.php
@@ -98,7 +98,7 @@ class CacheClearGroupCommand extends Command
                 ));
                 $this->abort();
             } else {
-                $io->success(sprintf('Group "%s" was cleared.', $group));
+                $io->success(sprintf('Cache "%s" was cleared.', $groupConfig));
             }
         }
 
diff --git a/src/Command/I18nExtractCommand.php b/src/Command/I18nExtractCommand.php
index 6de4f95d3d..435f2a47fb 100644
--- a/src/Command/I18nExtractCommand.php
+++ b/src/Command/I18nExtractCommand.php
@@ -135,7 +135,7 @@ class I18nExtractCommand extends Command
         /** @psalm-suppress UndefinedConstant */
         $defaultPaths = array_merge(
             [APP],
-            App::path('templates'),
+            array_values(App::path('templates')),
             ['D'] // This is required to break the loop below
         );
         $defaultPathIndex = 0;
@@ -219,7 +219,7 @@ class I18nExtractCommand extends Command
                 . 'locales' . DIRECTORY_SEPARATOR;
         } else {
             $message = "What is the path you would like to output?\n[Q]uit";
-            $localePaths = App::path('locales');
+            $localePaths = array_values(App::path('locales'));
             if (!$localePaths) {
                 $localePaths[] = ROOT . 'resources' . DIRECTORY_SEPARATOR . 'locales';
             }
diff --git a/src/Command/I18nInitCommand.php b/src/Command/I18nInitCommand.php
index 6fcbbc8785..2206789159 100644
--- a/src/Command/I18nInitCommand.php
+++ b/src/Command/I18nInitCommand.php
@@ -57,7 +57,7 @@ class I18nInitCommand extends Command
             return static::CODE_ERROR;
         }
 
-        $paths = App::path('locales');
+        $paths = array_values(App::path('locales'));
         if ($args->hasOption('plugin')) {
             $plugin = Inflector::camelize((string)$args->getOption('plugin'));
             $paths = [Plugin::path($plugin) . 'resources' . DIRECTORY_SEPARATOR . 'locales' . DIRECTORY_SEPARATOR];
diff --git a/src/Core/functions.php b/src/Core/functions.php
index 76c9ef0c33..730e89a282 100644
--- a/src/Core/functions.php
+++ b/src/Core/functions.php
@@ -94,7 +94,7 @@ if (!function_exists('Cake\Core\pluginSplit')) {
                 $parts[0] .= '.';
             }
 
-            /** @psalm-var array{string, string}*/
+            /** @psalm-var array{string, string} */
             return $parts;
         }
 
diff --git a/src/Database/Connection.php b/src/Database/Connection.php
index c97f09e206..787026a03f 100644
--- a/src/Database/Connection.php
+++ b/src/Database/Connection.php
@@ -2,16 +2,16 @@
 declare(strict_types=1);
 
 /**
- * CakePHP(tm) : Rapid Development Framework (https://cakephp.org)
- * Copyright (c) Cake Software Foundation, Inc. (https://cakefoundation.org)
- *
- * Licensed under The MIT License
- * For full copyright and license information, please see the LICENSE.txt
- * Redistributions of files must retain the above copyright notice.
- *
- * @copyright     Copyright (c) Cake Software Foundation, Inc. (https://cakefoundation.org)
- * @link          https://cakephp.org CakePHP(tm) Project
- * @since         3.0.0
+* CakePHP(tm) : Rapid Development Framework (https://cakephp.org)
+* Copyright (c) Cake Software Foundation, Inc. (https://cakefoundation.org)
+*
+* Licensed under The MIT License
+* For full copyright and license information, please see the LICENSE.txt
+* Redistributions of files must retain the above copyright notice.
+*
+* @copyright     Copyright (c) Cake Software Foundation, Inc. (https://cakefoundation.org)
+* @link          https://cakephp.org CakePHP(tm) Project
+* @since         3.0.0
  * @license       https://opensource.org/licenses/mit-license.php MIT License
  */
 namespace Cake\Database;
diff --git a/src/Database/Type/DateTimeType.php b/src/Database/Type/DateTimeType.php
index 7a309ab8f3..220baffc10 100644
--- a/src/Database/Type/DateTimeType.php
+++ b/src/Database/Type/DateTimeType.php
@@ -16,6 +16,7 @@ declare(strict_types=1);
  */
 namespace Cake\Database\Type;
 
+use Cake\Chronos\ChronosDate;
 use Cake\Database\Driver;
 use Cake\Database\Exception\DatabaseException;
 use Cake\I18n\DateTime;
@@ -290,8 +291,12 @@ class DateTimeType extends BaseType implements BatchCastingInterface
                 $value = clone $value;
             }
 
+            /** @var \Datetime|\DateTimeImmutable $value */
             return $value->setTimezone($this->defaultTimezone);
         }
+        if ($value instanceof ChronosDate) {
+            return $value->toNative();
+        }
 
         $class = $this->_className;
         try {
diff --git a/src/Error/Debugger.php b/src/Error/Debugger.php
index 9aed1ee2da..f5eec290b0 100644
--- a/src/Error/Debugger.php
+++ b/src/Error/Debugger.php
@@ -514,9 +514,6 @@ class Debugger
      */
     protected static function _highlight(string $str): string
     {
-        if (function_exists('hphp_log') || function_exists('hphp_gettid')) {
-            return htmlentities($str);
-        }
         $added = false;
         if (!str_contains($str, '<?php')) {
             $added = true;
@@ -525,7 +522,7 @@ class Debugger
         $highlight = highlight_string($str, true);
         if ($added) {
             $highlight = str_replace(
-                ['&lt;?php&nbsp;<br/>', '&lt;?php&nbsp;<br />'],
+                ['&lt;?php&nbsp;<br/>', '&lt;?php&nbsp;<br />', '&lt;?php '],
                 '',
                 $highlight
             );
diff --git a/src/Error/ExceptionTrap.php b/src/Error/ExceptionTrap.php
index 16c4e7ce1a..def6ff9ae9 100644
--- a/src/Error/ExceptionTrap.php
+++ b/src/Error/ExceptionTrap.php
@@ -229,11 +229,14 @@ class ExceptionTrap
 
         try {
             $event = $this->dispatchEvent('Exception.beforeRender', ['exception' => $exception, 'request' => $request]);
+            if ($event->isStopped()) {
+                return;
+            }
             $exception = $event->getData('exception');
             assert($exception instanceof Throwable);
 
             $renderer = $this->renderer($exception, $request);
-            $renderer->write($event->getResult() ?? $renderer->render());
+            $renderer->write($event->getResult() ?: $renderer->render());
         } catch (Throwable $exception) {
             $this->logInternalError($exception);
         }
diff --git a/src/I18n/MessagesFileLoader.php b/src/I18n/MessagesFileLoader.php
index 44348ac9f1..25d130817b 100644
--- a/src/I18n/MessagesFileLoader.php
+++ b/src/I18n/MessagesFileLoader.php
@@ -163,13 +163,6 @@ class MessagesFileLoader
 
         $searchPaths = [];
 
-        if ($this->_plugin && Plugin::isLoaded($this->_plugin)) {
-            $basePath = App::path('locales', $this->_plugin)[0];
-            foreach ($folders as $folder) {
-                $searchPaths[] = $basePath . $folder . DIRECTORY_SEPARATOR;
-            }
-        }
-
         $localePaths = App::path('locales');
         if (empty($localePaths) && defined('APP')) {
             $localePaths[] = ROOT . 'resources' . DIRECTORY_SEPARATOR . 'locales' . DIRECTORY_SEPARATOR;
@@ -180,6 +173,13 @@ class MessagesFileLoader
             }
         }
 
+        if ($this->_plugin && Plugin::isLoaded($this->_plugin)) {
+            $basePath = App::path('locales', $this->_plugin)[0];
+            foreach ($folders as $folder) {
+                $searchPaths[] = $basePath . $folder . DIRECTORY_SEPARATOR;
+            }
+        }
+
         return $searchPaths;
     }
 
diff --git a/src/TestSuite/Constraint/Response/CookieEquals.php b/src/TestSuite/Constraint/Response/CookieEquals.php
index 36ad0e7a9e..ecacf02fe5 100644
--- a/src/TestSuite/Constraint/Response/CookieEquals.php
+++ b/src/TestSuite/Constraint/Response/CookieEquals.php
@@ -57,7 +57,7 @@ class CookieEquals extends ResponseBase
      */
     public function matches($other): bool
     {
-        $cookie = $this->response->getCookie($this->cookieName);
+        $cookie = $this->readCookie($this->cookieName);
 
         return $cookie !== null && $cookie['value'] === $other;
     }
diff --git a/src/TestSuite/Constraint/Response/CookieSet.php b/src/TestSuite/Constraint/Response/CookieSet.php
index 1ac4c7ed4b..202f66a3ab 100644
--- a/src/TestSuite/Constraint/Response/CookieSet.php
+++ b/src/TestSuite/Constraint/Response/CookieSet.php
@@ -38,7 +38,7 @@ class CookieSet extends ResponseBase
      */
     public function matches($other): bool
     {
-        $cookie = $this->response->getCookie($other);
+        $cookie = $this->readCookie($other);
 
         return $cookie !== null && $cookie['value'] !== '';
     }
diff --git a/src/TestSuite/Constraint/Response/ResponseBase.php b/src/TestSuite/Constraint/Response/ResponseBase.php
index 07d8235136..7c06e6d03e 100644
--- a/src/TestSuite/Constraint/Response/ResponseBase.php
+++ b/src/TestSuite/Constraint/Response/ResponseBase.php
@@ -15,6 +15,7 @@ declare(strict_types=1);
  */
 namespace Cake\TestSuite\Constraint\Response;
 
+use Cake\Http\Cookie\CookieCollection;
 use PHPUnit\Framework\AssertionFailedError;
 use PHPUnit\Framework\Constraint\Constraint;
 use Psr\Http\Message\ResponseInterface;
@@ -54,4 +55,24 @@ abstract class ResponseBase extends Constraint
     {
         return (string)$this->response->getBody();
     }
+
+    /**
+     * Read a cookie from either the response cookie collection,
+     * or headers
+     *
+     * @param string $name The name of the cookie you want to read.
+     * @return array|null Null if the cookie does not exist, array with `value` as the only key.
+     */
+    protected function readCookie(string $name): ?array
+    {
+        if (method_exists($this->response, 'getCookie')) {
+            return $this->response->getCookie($name);
+        }
+        $cookies = CookieCollection::createFromHeader($this->response->getHeader('Set-Cookie'));
+        if (!$cookies->has($name)) {
+            return null;
+        }
+
+        return $cookies->get($name)->toArray();
+    }
 }
diff --git a/src/View/Helper/FormHelper.php b/src/View/Helper/FormHelper.php
index a23ac42cca..931841702b 100644
--- a/src/View/Helper/FormHelper.php
+++ b/src/View/Helper/FormHelper.php
@@ -1363,7 +1363,8 @@ class FormHelper extends Helper
         /** @var \BackedEnum $case */
         foreach ($enumClass::cases() as $case) {
             $hasLabel = $case instanceof EnumLabelInterface || method_exists($case, 'label');
-            $values[$case->value] = $hasLabel ? $case->label() : $case->name;
+            $values[$case->value] = $hasLabel ? $case->label()
+                : Inflector::humanize(mb_strtolower($case->name));
         }
 
         return $values;
diff --git a/templates/layout/dev_error.php b/templates/layout/dev_error.php
index 1bcbe5c3d0..2f7eeffb8b 100644
--- a/templates/layout/dev_error.php
+++ b/templates/layout/dev_error.php
@@ -292,6 +292,12 @@ use function Cake\Core\h;
     .excerpt-line {
         padding: 0;
     }
+    /* php 8.3 adds pre around highlighted code */
+    .code-highlight > pre,
+    .excerpt-line > pre {
+        padding: 0;
+        background: none;
+    }
     .excerpt-line > code {
         padding-left: 4px;
     }
diff --git a/tests/TestCase/Command/I18nCommandTest.php b/tests/TestCase/Command/I18nCommandTest.php
index 0032bef519..ef4a824db7 100644
--- a/tests/TestCase/Command/I18nCommandTest.php
+++ b/tests/TestCase/Command/I18nCommandTest.php
@@ -17,6 +17,7 @@ declare(strict_types=1);
 namespace Cake\Test\TestCase\Command;
 
 use Cake\Console\TestSuite\ConsoleIntegrationTestTrait;
+use Cake\Core\Configure;
 use Cake\TestSuite\TestCase;
 
 /**
@@ -75,10 +76,41 @@ class I18nCommandTest extends TestCase
         if (file_exists($deDir . 'default.po')) {
             unlink($deDir . 'default.po');
         }
+        if (file_exists($deDir . 'cake.po')) {
+            unlink($deDir . 'cake.po');
+        }
+
+        $this->exec('i18n init --verbose', [
+            'de_DE',
+            $this->localeDir,
+        ]);
+
+        $this->assertExitSuccess();
+        $this->assertOutputContains('Generated 2 PO files');
+        $this->assertFileExists($deDir . 'default.po');
+        $this->assertFileExists($deDir . 'cake.po');
+    }
+
+    /**
+     * Tests that init() creates the PO files from POT files when App.path.locales contains an associative array
+     */
+    public function testInitWithAssociativePaths(): void
+    {
+        $deDir = $this->localeDir . 'de_DE' . DS;
+        if (!is_dir($deDir)) {
+            mkdir($deDir, 0770, true);
+        }
+        file_put_contents($this->localeDir . 'default.pot', 'Testing POT file.');
+        file_put_contents($this->localeDir . 'cake.pot', 'Testing POT file.');
         if (file_exists($deDir . 'default.po')) {
+            unlink($deDir . 'default.po');
+        }
+        if (file_exists($deDir . 'cake.po')) {
             unlink($deDir . 'cake.po');
         }
 
+        Configure::write('App.paths.locales', ['customKey' => TEST_APP . 'resources' . DS . 'locales' . DS]);
+
         $this->exec('i18n init --verbose', [
             'de_DE',
             $this->localeDir,
diff --git a/tests/TestCase/Command/I18nExtractCommandTest.php b/tests/TestCase/Command/I18nExtractCommandTest.php
index 30380bab1a..0b42c18993 100644
--- a/tests/TestCase/Command/I18nExtractCommandTest.php
+++ b/tests/TestCase/Command/I18nExtractCommandTest.php
@@ -391,4 +391,36 @@ class I18nExtractCommandTest extends TestCase
         $expected = '#: ./tests/test_app/templates/Pages/extract.php:';
         $this->assertStringContainsString($expected, $result);
     }
+
+    /**
+     * Test with associative arrays in App.path.locales and App.path.templates.
+     */
+    public function testExtractWithAssociativePaths(): void
+    {
+        Configure::write('App.paths', [
+            'plugins' => ['customKey' => TEST_APP . 'Plugin' . DS],
+            'templates' => ['customKey' => TEST_APP . 'templates' . DS],
+            'locales' => ['customKey' => TEST_APP . 'resources' . DS . 'locales' . DS],
+        ]);
+
+        $this->exec(
+            'i18n extract ' .
+            '--merge=no ' .
+            '--extract-core=no ',
+            [
+                // Sending two empty inputs so \Cake\Command\I18nExtractCommand::_getPaths()
+                // loops through all paths
+                '',
+                '',
+                'D',
+                $this->path . DS,
+            ]
+        );
+        $this->assertExitSuccess();
+        $this->assertFileExists($this->path . DS . 'default.pot');
+        $result = file_get_contents($this->path . DS . 'default.pot');
+
+        $expected = '#: ./tests/test_app/templates/Pages/extract.php:';
+        $this->assertStringContainsString($expected, $result);
+    }
 }
diff --git a/tests/TestCase/Database/Schema/SqliteSchemaTest.php b/tests/TestCase/Database/Schema/SqliteSchemaTest.php
index d49fa29def..2425bc128f 100644
--- a/tests/TestCase/Database/Schema/SqliteSchemaTest.php
+++ b/tests/TestCase/Database/Schema/SqliteSchemaTest.php
@@ -32,6 +32,23 @@ class SqliteSchemaTest extends TestCase
 {
     protected PDO $pdo;
 
+    public function tearDown(): void
+    {
+        parent::tearDown();
+
+        /** @var \Cake\Database\Connection $connection */
+        $connection = ConnectionManager::get('test');
+        if ($connection->getDriver() instanceof Sqlite) {
+            $connection->execute('DROP VIEW IF EXISTS view_schema_articles');
+            $connection->execute('DROP TABLE IF EXISTS schema_articles');
+            $connection->execute('DROP TABLE IF EXISTS schema_authors');
+            $connection->execute('DROP TABLE IF EXISTS schema_no_rowid_pk');
+            $connection->execute('DROP TABLE IF EXISTS schema_unique_constraint_variations');
+            $connection->execute('DROP TABLE IF EXISTS schema_foreign_key_variations');
+            $connection->execute('DROP TABLE IF EXISTS schema_composite');
+        }
+    }
+
     /**
      * Helper method for skipping tests that need a real connection.
      */
diff --git a/tests/TestCase/Database/Type/DateTimeTypeTest.php b/tests/TestCase/Database/Type/DateTimeTypeTest.php
index f1d0491834..00bfb9d277 100644
--- a/tests/TestCase/Database/Type/DateTimeTypeTest.php
+++ b/tests/TestCase/Database/Type/DateTimeTypeTest.php
@@ -16,6 +16,7 @@ declare(strict_types=1);
  */
 namespace Cake\Test\TestCase\Database\Type;
 
+use Cake\Chronos\ChronosDate;
 use Cake\Database\Type\DateTimeType;
 use Cake\I18n\DateTime;
 use Cake\TestSuite\TestCase;
@@ -409,4 +410,17 @@ class DateTimeTypeTest extends TestCase
         $result = $this->type->marshal('13 Oct, 2013 01:54pm');
         $this->assertEquals($expected, $result);
     }
+
+    /**
+     * Test marshaling date into datetime type
+     */
+    public function testMarshalDateWithTimezone(): void
+    {
+        date_default_timezone_set('Europe/Vienna');
+        $value = new ChronosDate('2023-04-26');
+
+        $result = $this->type->marshal($value);
+        $this->assertEquals($value->format('Y-m-d'), $result->format('Y-m-d'));
+        $this->assertEquals('Europe/Vienna', $result->getTimezone()->getName());
+    }
 }
diff --git a/tests/TestCase/Error/ExceptionTrapTest.php b/tests/TestCase/Error/ExceptionTrapTest.php
index d0ef11dcb7..e9307127a6 100644
--- a/tests/TestCase/Error/ExceptionTrapTest.php
+++ b/tests/TestCase/Error/ExceptionTrapTest.php
@@ -270,7 +270,6 @@ class ExceptionTrapTest extends TestCase
         $trap->getEventManager()->on('Exception.beforeRender', function ($event, Throwable $error) {
             $this->assertEquals(100, $error->getCode());
             $this->assertStringContainsString('nope', $error->getMessage());
-            $event->stopPropagation();
         });
         $error = new InvalidArgumentException('nope', 100);
 
@@ -281,6 +280,23 @@ class ExceptionTrapTest extends TestCase
         $this->assertNotEmpty($out);
     }
 
+    public function testBeforeRenderEventAborted(): void
+    {
+        $trap = new ExceptionTrap(['exceptionRenderer' => TextExceptionRenderer::class]);
+        $trap->getEventManager()->on('Exception.beforeRender', function ($event, Throwable $error, ?ServerRequest $req) {
+            $this->assertEquals(100, $error->getCode());
+            $this->assertStringContainsString('nope', $error->getMessage());
+            $event->stopPropagation();
+        });
+        $error = new InvalidArgumentException('nope', 100);
+
+        ob_start();
+        $trap->handleException($error);
+        $out = ob_get_clean();
+
+        $this->assertSame('', $out);
+    }
+
     public function testBeforeRenderEventExceptionChanged(): void
     {
         $trap = new ExceptionTrap(['exceptionRenderer' => TextExceptionRenderer::class]);
diff --git a/tests/TestCase/I18n/I18nTest.php b/tests/TestCase/I18n/I18nTest.php
index 8c8a547069..d49b2aa18a 100644
--- a/tests/TestCase/I18n/I18nTest.php
+++ b/tests/TestCase/I18n/I18nTest.php
@@ -191,12 +191,26 @@ class I18nTest extends TestCase
     {
         $this->loadPlugins([
             'TestTheme' => [],
+            'TestPluginTwo' => [],
         ]);
+
         $translator = I18n::getTranslator('test_theme');
         $this->assertSame(
             'translated',
             $translator->translate('A Message')
         );
+
+        $translator = I18n::getTranslator('test_plugin_two');
+        $this->assertSame(
+            'Test Message (from app)',
+            $translator->translate('Test Message')
+        );
+
+        $translator = I18n::getTranslator('test_plugin_two.custom');
+        $this->assertSame(
+            'Test Custom (from test plugin two)',
+            $translator->translate('Test Custom')
+        );
     }
 
     /**
diff --git a/tests/TestCase/I18n/MessagesFileLoaderTest.php b/tests/TestCase/I18n/MessagesFileLoaderTest.php
index bba1e0dfc0..fdd86ee966 100644
--- a/tests/TestCase/I18n/MessagesFileLoaderTest.php
+++ b/tests/TestCase/I18n/MessagesFileLoaderTest.php
@@ -25,29 +25,6 @@ use Cake\TestSuite\TestCase;
  */
 class MessagesFileLoaderTest extends TestCase
 {
-    /**
-     * @var string[]
-     */
-    protected $localePaths;
-
-    /**
-     * Set Up
-     */
-    public function setUp(): void
-    {
-        parent::setUp();
-        $this->localePaths = Configure::read('App.paths.locales');
-    }
-
-    /**
-     * Tear down method
-     */
-    public function tearDown(): void
-    {
-        parent::tearDown();
-        Configure::write('App.paths.locales', $this->localePaths);
-    }
-
     /**
      * test reading file from custom locale folder
      */
@@ -91,4 +68,45 @@ class MessagesFileLoaderTest extends TestCase
         $result = $loader->translationsFolders();
         $this->assertCount(4, $result);
     }
+
+    /**
+     * Testing MessagesFileLoader::translationsFolder array sequence
+     */
+    public function testTranslationFoldersSequence(): void
+    {
+        $this->loadPlugins([
+            'TestPluginTwo' => [],
+        ]);
+        $loader = new MessagesFileLoader('test_plugin_two', 'en');
+
+        $expected = [
+            ROOT . DS . 'tests' . DS . 'test_app' . DS . 'resources' . DS . 'locales' . DS . 'en_' . DS,
+            ROOT . DS . 'tests' . DS . 'test_app' . DS . 'resources' . DS . 'locales' . DS . 'en' . DS,
+            ROOT . DS . 'tests' . DS . 'test_app' . DS . 'Plugin' . DS . 'TestPluginTwo' . DS . 'resources' . DS . 'locales' . DS . 'en_' . DS,
+            ROOT . DS . 'tests' . DS . 'test_app' . DS . 'Plugin' . DS . 'TestPluginTwo' . DS . 'resources' . DS . 'locales' . DS . 'en' . DS,
+        ];
+        $result = $loader->translationsFolders();
+        $this->assertEquals($expected, $result);
+    }
+
+    /**
+     * Testing plugin override from app
+     */
+    public function testAppOverridesPlugin(): void
+    {
+        $this->loadPlugins([
+            'TestPlugin' => [],
+            'TestPluginTwo' => [],
+        ]);
+
+        $loader = new MessagesFileLoader('test_plugin', 'en');
+        $package = $loader();
+        $messages = $package->getMessages();
+        $this->assertSame('Plural Rule 1 (from plugin)', $messages['Plural Rule 1']['_context']['']);
+
+        $loader = new MessagesFileLoader('test_plugin_two', 'en');
+        $package = $loader();
+        $messages = $package->getMessages();
+        $this->assertSame('Test Message (from app)', $messages['Test Message']['_context']['']);
+    }
 }
diff --git a/tests/TestCase/TestSuite/IntegrationTestTraitTest.php b/tests/TestCase/TestSuite/IntegrationTestTraitTest.php
index f8d6d5d67a..55cc083926 100644
--- a/tests/TestCase/TestSuite/IntegrationTestTraitTest.php
+++ b/tests/TestCase/TestSuite/IntegrationTestTraitTest.php
@@ -741,7 +741,10 @@ class IntegrationTestTraitTest extends TestCase
     public function testAssertCookieNotSet(): void
     {
         $this->cookie('test', 'value');
-        $this->get('/cookie_component_test/remove_cookie/test');
+        $this->get('/posts/index');
+        $this->assertCookieNotSet('test');
+
+        $this->get('/posts/redirectWithCookie');
         $this->assertCookieNotSet('test');
     }
 
@@ -774,6 +777,9 @@ class IntegrationTestTraitTest extends TestCase
     {
         $this->get('/posts/secretCookie');
         $this->assertCookieIsSet('secrets');
+
+        $this->get('/posts/redirectWithCookie');
+        $this->assertCookieIsSet('remember');
     }
 
     /**
diff --git a/tests/TestCase/Utility/XmlTest.php b/tests/TestCase/Utility/XmlTest.php
index c0e4bf95ea..5eff47fc01 100644
--- a/tests/TestCase/Utility/XmlTest.php
+++ b/tests/TestCase/Utility/XmlTest.php
@@ -34,30 +34,15 @@ use TypeError;
  */
 class XmlTest extends TestCase
 {
-    /**
-     * @var string
-     */
-    protected $appEncoding;
-
     /**
      * setUp method
      */
     public function setUp(): void
     {
         parent::setUp();
-        $this->appEncoding = Configure::read('App.encoding');
         Configure::write('App.encoding', 'UTF-8');
     }
 
-    /**
-     * tearDown method
-     */
-    public function tearDown(): void
-    {
-        parent::tearDown();
-        Configure::write('App.encoding', $this->appEncoding);
-    }
-
     public function testExceptionChainingForInvalidInput(): void
     {
         try {
diff --git a/tests/TestCase/Validation/ValidationTest.php b/tests/TestCase/Validation/ValidationTest.php
index 967d15cc89..52c43695cf 100644
--- a/tests/TestCase/Validation/ValidationTest.php
+++ b/tests/TestCase/Validation/ValidationTest.php
@@ -41,27 +41,12 @@ require_once __DIR__ . '/stubs.php';
  */
 class ValidationTest extends TestCase
 {
-    /**
-     * @var string
-     */
-    protected $_appEncoding;
-
-    /**
-     * setUp method
-     */
-    public function setUp(): void
-    {
-        parent::setUp();
-        $this->_appEncoding = Configure::read('App.encoding');
-    }
-
     /**
      * tearDown method
      */
     public function tearDown(): void
     {
         parent::tearDown();
-        Configure::write('App.encoding', $this->_appEncoding);
         I18n::setLocale(I18n::getDefaultLocale());
     }
 
diff --git a/tests/TestCase/View/Helper/FormHelperTest.php b/tests/TestCase/View/Helper/FormHelperTest.php
index 743e4c499e..64a59859d3 100644
--- a/tests/TestCase/View/Helper/FormHelperTest.php
+++ b/tests/TestCase/View/Helper/FormHelperTest.php
@@ -3637,10 +3637,10 @@ class FormHelperTest extends TestCase
             '/label',
             'select' => ['name' => 'published', 'id' => 'published'],
             ['option' => ['value' => 'Y']],
-            'PUBLISHED',
+            'Published',
             '/option',
             ['option' => ['value' => 'N', 'selected' => 'selected']],
-            'UNPUBLISHED',
+            'Unpublished',
             '/option',
             '/select',
             '/div',
@@ -4787,11 +4787,11 @@ class FormHelperTest extends TestCase
                 'input' => ['type' => 'hidden', 'name' => 'published', 'value' => '', 'id' => 'published'],
                 ['label' => ['for' => 'published-y']],
                 ['input' => ['type' => 'radio', 'name' => 'published', 'value' => 'Y', 'id' => 'published-y']],
-                'PUBLISHED',
+                'Published',
                 '/label',
                 ['label' => ['for' => 'published-n']],
                 ['input' => ['type' => 'radio', 'name' => 'published', 'value' => 'N', 'id' => 'published-n', 'checked' => 'checked']],
-                'UNPUBLISHED',
+                'Unpublished',
                 '/label',
             '/div',
         ];
diff --git a/tests/TestCase/View/Helper/NumberHelperTest.php b/tests/TestCase/View/Helper/NumberHelperTest.php
index 223b031121..eac5318be3 100644
--- a/tests/TestCase/View/Helper/NumberHelperTest.php
+++ b/tests/TestCase/View/Helper/NumberHelperTest.php
@@ -32,11 +32,6 @@ class NumberHelperTest extends TestCase
      */
     protected $View;
 
-    /**
-     * @var string
-     */
-    protected $appNamespace;
-
     /**
      * setUp method
      */
diff --git a/tests/TestCase/View/Helper/TextHelperTest.php b/tests/TestCase/View/Helper/TextHelperTest.php
index 3ee122f68a..4fe44e70f5 100644
--- a/tests/TestCase/View/Helper/TextHelperTest.php
+++ b/tests/TestCase/View/Helper/TextHelperTest.php
@@ -16,7 +16,6 @@ declare(strict_types=1);
  */
 namespace Cake\Test\TestCase\View\Helper;
 
-use Cake\Core\Configure;
 use Cake\TestSuite\TestCase;
 use Cake\View\Helper\TextHelper;
 use Cake\View\View;
@@ -36,11 +35,6 @@ class TextHelperTest extends TestCase
      */
     protected $View;
 
-    /**
-     * @var string
-     */
-    protected $appNamespace;
-
     /**
      * setUp method
      */
@@ -49,8 +43,6 @@ class TextHelperTest extends TestCase
         parent::setUp();
         $this->View = new View();
         $this->Text = new TextHelper($this->View);
-
-        $this->appNamespace = Configure::read('App.namespace');
         static::setAppNamespace();
     }
 
@@ -60,7 +52,6 @@ class TextHelperTest extends TestCase
     public function tearDown(): void
     {
         unset($this->Text, $this->View);
-        static::setAppNamespace($this->appNamespace);
         parent::tearDown();
     }
 
diff --git a/tests/test_app/Plugin/TestPlugin/src/I18n/TestPluginEngine.php b/tests/test_app/Plugin/TestPlugin/src/I18n/TestPluginEngine.php
new file mode 100644
index 0000000000..ae48c31031
--- /dev/null
+++ b/tests/test_app/Plugin/TestPlugin/src/I18n/TestPluginEngine.php
@@ -0,0 +1,8 @@
+<?php
+declare(strict_types=1);
+
+namespace TestPlugin\I18n;
+
+class TestPluginEngine
+{
+}
diff --git a/tests/test_app/Plugin/TestPluginTwo/resources/locales/en/custom.po b/tests/test_app/Plugin/TestPluginTwo/resources/locales/en/custom.po
new file mode 100644
index 0000000000..2114e1f40d
--- /dev/null
+++ b/tests/test_app/Plugin/TestPluginTwo/resources/locales/en/custom.po
@@ -0,0 +1,2 @@
+msgid "Test Custom"
+msgstr "Test Custom (from test plugin two)"
\ No newline at end of file
diff --git a/tests/test_app/Plugin/TestPluginTwo/resources/locales/en/test_plugin_two.po b/tests/test_app/Plugin/TestPluginTwo/resources/locales/en/test_plugin_two.po
new file mode 100644
index 0000000000..0e346243e6
--- /dev/null
+++ b/tests/test_app/Plugin/TestPluginTwo/resources/locales/en/test_plugin_two.po
@@ -0,0 +1,2 @@
+msgid "Test Message"
+msgstr "Test Message (from test plugin two)"
\ No newline at end of file
diff --git a/tests/test_app/TestApp/Controller/PostsController.php b/tests/test_app/TestApp/Controller/PostsController.php
index 903ff32f4b..f067d773ab 100644
--- a/tests/test_app/TestApp/Controller/PostsController.php
+++ b/tests/test_app/TestApp/Controller/PostsController.php
@@ -18,6 +18,7 @@ namespace TestApp\Controller;
 
 use Cake\Event\EventInterface;
 use Cake\Http\Cookie\Cookie;
+use Cake\Http\Exception\RedirectException;
 use Cake\View\JsonView;
 use OutOfBoundsException;
 use RuntimeException;
@@ -194,6 +195,21 @@ class PostsController extends AppController
             ->withStringBody('ok');
     }
 
+    public function redirectWithCookie()
+    {
+        $cookies = [
+            Cookie::create('remember', '1'),
+            Cookie::create('expired', '')->withExpired(),
+        ];
+        $values = [];
+        foreach ($cookies as $cookie) {
+            $values[] = $cookie->toHeaderValue();
+        }
+        $headers = ['Set-Cookie' => $values];
+
+        throw new RedirectException('/posts', 302, $headers);
+    }
+
     /**
      * @return \Cake\Http\Response
      */
diff --git a/tests/test_app/TestApp/I18n/TestAppI18nEngine.php b/tests/test_app/TestApp/I18n/TestAppI18nEngine.php
new file mode 100644
index 0000000000..67f0d44edc
--- /dev/null
+++ b/tests/test_app/TestApp/I18n/TestAppI18nEngine.php
@@ -0,0 +1,8 @@
+<?php
+declare(strict_types=1);
+
+namespace TestApp\I18n;
+
+class TestAppI18nEngine
+{
+}
diff --git a/tests/test_app/resources/locales/en/test_plugin_two.po b/tests/test_app/resources/locales/en/test_plugin_two.po
new file mode 100644
index 0000000000..38d8334c7f
--- /dev/null
+++ b/tests/test_app/resources/locales/en/test_plugin_two.po
@@ -0,0 +1,2 @@
+msgid "Test Message"
+msgstr "Test Message (from app)"
\ No newline at end of file
