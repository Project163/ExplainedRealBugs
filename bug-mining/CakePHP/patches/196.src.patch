diff --git a/src/Http/Middleware/CspMiddleware.php b/src/Http/Middleware/CspMiddleware.php
index 8ce975d083..4c8c165d1a 100644
--- a/src/Http/Middleware/CspMiddleware.php
+++ b/src/Http/Middleware/CspMiddleware.php
@@ -56,7 +56,7 @@ class CspMiddleware implements MiddlewareInterface
     }
 
     /**
-     * Serve assets if the path matches one.
+     * Add nonces to the request and apply the CSP header to the response.
      *
      * @param \Psr\Http\Message\ServerRequestInterface $request The request.
      * @param \Psr\Http\Server\RequestHandlerInterface $handler The request handler.
@@ -64,6 +64,10 @@ class CspMiddleware implements MiddlewareInterface
      */
     public function process(ServerRequestInterface $request, RequestHandlerInterface $handler): ResponseInterface
     {
+        $request = $request
+            ->withAttribute('cspScriptNonce', $this->csp->nonce('script-src'))
+            ->withAttribute('cspStyleNonce', $this->csp->nonce('style-src'));
+
         $response = $handler->handle($request);
 
         // phpcs:ignore SlevomatCodingStandard.Commenting.InlineDocCommentDeclaration.InvalidFormat
diff --git a/src/View/Helper/HtmlHelper.php b/src/View/Helper/HtmlHelper.php
index 0899622206..a7b0e77c61 100644
--- a/src/View/Helper/HtmlHelper.php
+++ b/src/View/Helper/HtmlHelper.php
@@ -363,6 +363,10 @@ class HtmlHelper extends Helper
      * - `rel` Defaults to 'stylesheet'. If equal to 'import' the stylesheet will be imported.
      * - `fullBase` If true the URL will get a full address for the css file.
      *
+     * All other options will be treated as HTML attributes. If the request contains a
+     * `cspStyleNonce` attribute, that value will be applied as the `nonce` attribute on the
+     * generated HTML.
+     *
      * @param string|string[] $path The name of a CSS style sheet or an array containing names of
      *   CSS stylesheets. If `$path` is prefixed with '/', the path will be relative to the webroot
      *   of your application. Otherwise, the path will be relative to your CSS path, usually webroot/css.
@@ -398,8 +402,12 @@ class HtmlHelper extends Helper
         }
         unset($options['once']);
         $this->_includedAssets[__METHOD__][$path] = true;
-        $templater = $this->templater();
+        $nonce = $this->_View->getRequest()->getAttribute('cspStyleNonce');
+        if (!isset($options['nonce']) && $nonce) {
+            $options['nonce'] = $nonce;
+        }
 
+        $templater = $this->templater();
         if ($options['rel'] === 'import') {
             $out = $templater->format('style', [
                 'attrs' => $templater->formatAttributes($options, ['rel', 'block']),
@@ -459,6 +467,10 @@ class HtmlHelper extends Helper
      * - `plugin` False value will prevent parsing path as a plugin
      * - `fullBase` If true the url will get a full address for the script file.
      *
+     * All other options will be added as attributes to the generated script tag.
+     * If the current request has a `cspScriptNonce` attribute, that value will
+     * be inserted as a `nonce` attribute on the script tag.
+     *
      * @param string|string[] $url String or array of javascript files to include
      * @param array $options Array of options, and html attributes see above.
      * @return string|null String of `<script />` tags or null if block is specified in options
@@ -491,6 +503,11 @@ class HtmlHelper extends Helper
         }
         $this->_includedAssets[__METHOD__][$url] = true;
 
+        $nonce = $this->_View->getRequest()->getAttribute('cspScriptNonce');
+        if (!isset($options['nonce']) && $nonce) {
+            $options['nonce'] = $nonce;
+        }
+
         $out = $this->formatTemplate('javascriptlink', [
             'url' => $url,
             'attrs' => $this->templater()->formatAttributes($options, ['block', 'once']),
@@ -524,6 +541,10 @@ class HtmlHelper extends Helper
     public function scriptBlock(string $script, array $options = []): ?string
     {
         $options += ['block' => null];
+        $nonce = $this->_View->getRequest()->getAttribute('cspScriptNonce');
+        if (!isset($options['nonce']) && $nonce) {
+            $options['nonce'] = $nonce;
+        }
 
         $out = $this->formatTemplate('javascriptblock', [
             'attrs' => $this->templater()->formatAttributes($options, ['block']),
diff --git a/tests/TestCase/Http/Middleware/CspMiddlewareTest.php b/tests/TestCase/Http/Middleware/CspMiddlewareTest.php
index 896741dadf..82653e950f 100644
--- a/tests/TestCase/Http/Middleware/CspMiddlewareTest.php
+++ b/tests/TestCase/Http/Middleware/CspMiddlewareTest.php
@@ -42,11 +42,11 @@ class CspMiddlewareTest extends TestCase
     }
 
     /**
-     * testInvoke
+     * test process adding headers
      *
      * @return void
      */
-    public function testProcess()
+    public function testProcessAddHeaders()
     {
         $request = new ServerRequest();
 
@@ -62,13 +62,57 @@ class CspMiddlewareTest extends TestCase
         ]);
 
         $response = $middleware->process($request, $this->_getRequestHandler());
-        $headers = $response->getHeaders();
+        $policy = $response->getHeaderLine('Content-Security-Policy');
         $expected = [
-            'script-src \'self\' https://www.google-analytics.com; ',
+            'script-src \'self\' https://www.google-analytics.com',
         ];
 
-        $this->assertNotEmpty($headers['Content-Security-Policy']);
-        $this->assertEquals($expected, $headers['Content-Security-Policy']);
+        $this->assertNotEmpty($policy);
+        foreach ($expected as $match) {
+            $this->assertStringContainsString($match, $policy);
+        }
+    }
+
+    /**
+     * test process adding request attributes for nonces
+     *
+     * @return void
+     */
+    public function testProcessAddNonceAttributes()
+    {
+        $request = new ServerRequest();
+
+        $middleware = new CspMiddleware([
+            'script-src' => [
+                'self' => true,
+                'unsafe-inline' => false,
+                'unsafe-eval' => false,
+            ],
+            'style-src' => [
+                'self' => true,
+                'unsafe-inline' => false,
+                'unsafe-eval' => false,
+            ]
+        ]);
+
+        $handler = new TestRequestHandler(function ($request) {
+            $this->assertNotEmpty($request->getAttribute('cspScriptNonce'));
+            $this->assertNotEmpty($request->getAttribute('cspStyleNonce'));
+
+            return new Response();
+        });
+
+        $response = $middleware->process($request, $handler);
+        $policy = $response->getHeaderLine('Content-Security-Policy');
+        $expected = [
+            "script-src 'self' 'nonce-",
+            "style-src 'self' 'nonce-",
+        ];
+
+        $this->assertNotEmpty($policy);
+        foreach ($expected as $match) {
+            $this->assertStringContainsString($match, $policy);
+        }
     }
 
     /**
@@ -95,12 +139,14 @@ class CspMiddlewareTest extends TestCase
         $middleware = new CspMiddleware($cspBuilder);
 
         $response = $middleware->process($request, $this->_getRequestHandler());
-        $headers = $response->getHeaders();
+        $policy = $response->getHeaderLine('Content-Security-Policy');
         $expected = [
-            'script-src \'self\' https://www.google-analytics.com; ',
+            'script-src \'self\' https://www.google-analytics.com',
         ];
 
-        $this->assertNotEmpty($headers['Content-Security-Policy']);
-        $this->assertEquals($expected, $headers['Content-Security-Policy']);
+        $this->assertNotEmpty($policy);
+        foreach ($expected as $match) {
+            $this->assertStringContainsString($match, $policy);
+        }
     }
 }
diff --git a/tests/TestCase/View/Helper/HtmlHelperTest.php b/tests/TestCase/View/Helper/HtmlHelperTest.php
index d525412fed..58a6552905 100644
--- a/tests/TestCase/View/Helper/HtmlHelperTest.php
+++ b/tests/TestCase/View/Helper/HtmlHelperTest.php
@@ -686,6 +686,24 @@ class HtmlHelperTest extends TestCase
         $this->assertHtml($expected, $result);
     }
 
+     /**
+      * Test that css() includes CSP nonces if available.
+      *
+      * @return void
+      */
+     public function testCssWithCspNonce()
+     {
+        $nonce = 'r@nd0mV4lue';
+        $request = $this->View->getRequest()->withAttribute('cspStyleNonce', $nonce);
+        $this->View->setRequest($request);
+
+        $result = $this->Html->css('app');
+        $expected = [
+            'link' => ['rel' => 'stylesheet', 'href' => 'css/app.css', 'nonce' => $nonce],
+        ];
+        $this->assertHtml($expected, $result);
+     }
+
     /**
      * Test css() with once option.
      *
@@ -1036,6 +1054,26 @@ class HtmlHelperTest extends TestCase
         $this->assertHtml($expected, $result);
     }
 
+    /**
+     * Test that content-security-policy nonces are applied if the request attribute
+     * is present.
+     *
+     * @return void
+     */
+    public function testScriptCspNonce()
+    {
+        $nonce = 'r@ndomV4lue';
+        $request = $this->View->getRequest()
+            ->withAttribute('cspScriptNonce', $nonce);
+        $this->View->setRequest($request);
+
+        $result = $this->Html->script('app.js', ['defer' => true, 'encoding' => 'utf-8']);
+        $expected = [
+            'script' => ['src' => 'js/app.js', 'defer' => 'defer', 'encoding' => 'utf-8', 'nonce' => $nonce],
+        ];
+        $this->assertHtml($expected, $result);
+    }
+
     /**
      * test that plugin scripts added with uses() are only ever included once.
      * test script tag generation with plugin syntax
@@ -1230,6 +1268,27 @@ class HtmlHelperTest extends TestCase
         $this->assertHtml($expected, $result);
     }
 
+    /**
+     * Ensure that scriptBlock() uses CSP nonces.
+     *
+     * @return void
+     */
+    public function testScriptBlockCspNonce()
+    {
+        $nonce = 'r@ndomV4lue';
+        $request = $this->View->getRequest()
+            ->withAttribute('cspScriptNonce', $nonce);
+        $this->View->setRequest($request);
+
+        $result = $this->Html->scriptBlock('window.foo = 2;');
+        $expected = [
+            'script' => ['nonce' => $nonce],
+            'window.foo = 2;',
+            '/script'
+        ];
+        $this->assertHtml($expected, $result);
+    }
+
     /**
      * test script tag output buffering when using scriptStart() and scriptEnd();
      *
