diff --git a/src/Utility/Hash.php b/src/Utility/Hash.php
index 0ee2e61df6..2fdfb0879f 100644
--- a/src/Utility/Hash.php
+++ b/src/Utility/Hash.php
@@ -1146,8 +1146,8 @@ class Hash
         foreach ($compare as $key => $value) {
             if (!array_key_exists($key, $data)) {
                 $data[$key] = $value;
-            } elseif (is_array($value)) {
-                $data[$key] = static::mergeDiff($data[$key], $compare[$key]);
+            } elseif (is_array($value) && is_array($data[$key])) {
+                $data[$key] = static::mergeDiff($data[$key], $value);
             }
         }
 
diff --git a/tests/TestCase/Utility/HashTest.php b/tests/TestCase/Utility/HashTest.php
index 59f120bd52..0efe21a91c 100644
--- a/tests/TestCase/Utility/HashTest.php
+++ b/tests/TestCase/Utility/HashTest.php
@@ -3231,6 +3231,20 @@ class HashTest extends TestCase
         $this->assertSame($result, $first + $second);
     }
 
+    /**
+     * Test mergeDiff() with scalar elements.
+     *
+     * @return void
+     */
+    public function testMergeDiffWithScalarValue()
+    {
+        $result = Hash::mergeDiff(['a' => 'value'], ['a' => ['value']]);
+        $this->assertSame(['a' => 'value'], $result);
+
+        $result = Hash::mergeDiff(['a' => ['value']], ['a' => 'value']);
+        $this->assertSame(['a' => ['value']], $result);
+    }
+
     /**
      * Tests Hash::expand
      *
