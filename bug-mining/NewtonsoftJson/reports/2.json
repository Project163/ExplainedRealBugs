{"url":"https://api.github.com/repos/JamesNK/Newtonsoft.Json/issues/726","repository_url":"https://api.github.com/repos/JamesNK/Newtonsoft.Json","labels_url":"https://api.github.com/repos/JamesNK/Newtonsoft.Json/issues/726/labels{/name}","comments_url":"https://api.github.com/repos/JamesNK/Newtonsoft.Json/issues/726/comments","events_url":"https://api.github.com/repos/JamesNK/Newtonsoft.Json/issues/726/events","html_url":"https://github.com/JamesNK/Newtonsoft.Json/issues/726","id":119189052,"node_id":"MDU6SXNzdWUxMTkxODkwNTI=","number":726,"title":"Duplicate properties in DefaultContractResolver under mono with generic base classes","user":{"login":"dmitryvk","id":120884,"node_id":"MDQ6VXNlcjEyMDg4NA==","avatar_url":"https://avatars.githubusercontent.com/u/120884?v=4","gravatar_id":"","url":"https://api.github.com/users/dmitryvk","html_url":"https://github.com/dmitryvk","followers_url":"https://api.github.com/users/dmitryvk/followers","following_url":"https://api.github.com/users/dmitryvk/following{/other_user}","gists_url":"https://api.github.com/users/dmitryvk/gists{/gist_id}","starred_url":"https://api.github.com/users/dmitryvk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dmitryvk/subscriptions","organizations_url":"https://api.github.com/users/dmitryvk/orgs","repos_url":"https://api.github.com/users/dmitryvk/repos","events_url":"https://api.github.com/users/dmitryvk/events{/privacy}","received_events_url":"https://api.github.com/users/dmitryvk/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2015-11-27T12:31:38Z","updated_at":"2015-11-28T06:51:33Z","closed_at":"2015-11-28T06:51:33Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"I'm running mono 4.2.1 and json.net master\nThis program:\n\n```\nusing System;\nusing Newtonsoft.Json;\nclass MainClass\n{\n  public static void Main(string[] args)\n  {\n    var j = JsonConvert.SerializeObject(new C3());\n    Console.WriteLine(j);\n  }\n}\npublic class C1<O, T> { public virtual T Data { get; set; } }\npublic class C2<O> : C1<O, string> { public override string Data { get; set; } }\npublic class C3 : C2<int> { }\n```\n\nruns fine on .NET and prints\n\n```\n{\"Data\":null}\n```\n\nHovewer, on mono it crashes:\n\n```\nUnhandled Exception:\nNewtonsoft.Json.JsonSerializationException: A member with the name 'Data' already exists on 'C3'. Use the JsonPropertyAttribute to specify another name.\n  at Newtonsoft.Json.Serialization.JsonPropertyCollection.AddProperty (Newtonsoft.Json.Serialization.JsonProperty property) [0x00121] in /home/vm-alpha/msrc/Newtonsoft.Json/Src/Newtonsoft.Json/Serialization/JsonPropertyCollection.cs:112 \n  at Newtonsoft.Json.Serialization.DefaultContractResolver.CreateProperties (System.Type type, MemberSerialization memberSerialization) [0x00096] in /home/vm-alpha/msrc/Newtonsoft.Json/Src/Newtonsoft.Json/Serialization/DefaultContractResolver.cs:1191 \n  at Newtonsoft.Json.Serialization.DefaultContractResolver.CreateObjectContract (System.Type objectType) [0x0003b] in /home/vm-alpha/msrc/Newtonsoft.Json/Src/Newtonsoft.Json/Serialization/DefaultContractResolver.cs:372 \n  at Newtonsoft.Json.Serialization.DefaultContractResolver.CreateContract (System.Type objectType) [0x00161] in /home/vm-alpha/msrc/Newtonsoft.Json/Src/Newtonsoft.Json/Serialization/DefaultContractResolver.cs:1077 \n  at Newtonsoft.Json.Serialization.DefaultContractResolver.ResolveContract (System.Type type) [0x0004b] in /home/vm-alpha/msrc/Newtonsoft.Json/Src/Newtonsoft.Json/Serialization/DefaultContractResolver.cs:241 \n  at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.GetContractSafe (System.Object value) [0x0001f] in /home/vm-alpha/msrc/Newtonsoft.Json/Src/Newtonsoft.Json/Serialization/JsonSerializerInternalWriter.cs:117 \n  at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize (Newtonsoft.Json.JsonWriter jsonWriter, System.Object value, System.Type objectType) [0x00050] in /home/vm-alpha/msrc/Newtonsoft.Json/Src/Newtonsoft.Json/Serialization/JsonSerializerInternalWriter.cs:68 \n  at Newtonsoft.Json.JsonSerializer.SerializeInternal (Newtonsoft.Json.JsonWriter jsonWriter, System.Object value, System.Type objectType) [0x002c6] in /home/vm-alpha/msrc/Newtonsoft.Json/Src/Newtonsoft.Json/JsonSerializer.cs:947 \n  at Newtonsoft.Json.JsonSerializer.Serialize (Newtonsoft.Json.JsonWriter jsonWriter, System.Object value, System.Type objectType) [0x00005] in /home/vm-alpha/msrc/Newtonsoft.Json/Src/Newtonsoft.Json/JsonSerializer.cs:858 \n  at Newtonsoft.Json.JsonConvert.SerializeObjectInternal (System.Object value, System.Type type, Newtonsoft.Json.JsonSerializer jsonSerializer) [0x00027] in /home/vm-alpha/msrc/Newtonsoft.Json/Src/Newtonsoft.Json/JsonConvert.cs:641 \n  at Newtonsoft.Json.JsonConvert.SerializeObject (System.Object value, System.Type type, Newtonsoft.Json.JsonSerializerSettings settings) [0x0000b] in /home/vm-alpha/msrc/Newtonsoft.Json/Src/Newtonsoft.Json/JsonConvert.cs:594 \n  at Newtonsoft.Json.JsonConvert.SerializeObject (System.Object value) [0x00004] in /home/vm-alpha/msrc/Newtonsoft.Json/Src/Newtonsoft.Json/JsonConvert.cs:515 \n  at MainClass.Main (System.String[] args) [0x00006] in /home/vm-alpha/msrc/test1/test1/Program.cs:7 \n[ERROR] FATAL UNHANDLED EXCEPTION: Newtonsoft.Json.JsonSerializationException: A member with the name 'Data' already exists on 'C3'. Use the JsonPropertyAttribute to specify another name.\n  at Newtonsoft.Json.Serialization.JsonPropertyCollection.AddProperty (Newtonsoft.Json.Serialization.JsonProperty property) [0x00121] in /home/vm-alpha/msrc/Newtonsoft.Json/Src/Newtonsoft.Json/Serialization/JsonPropertyCollection.cs:112 \n  at Newtonsoft.Json.Serialization.DefaultContractResolver.CreateProperties (System.Type type, MemberSerialization memberSerialization) [0x00096] in /home/vm-alpha/msrc/Newtonsoft.Json/Src/Newtonsoft.Json/Serialization/DefaultContractResolver.cs:1191 \n  at Newtonsoft.Json.Serialization.DefaultContractResolver.CreateObjectContract (System.Type objectType) [0x0003b] in /home/vm-alpha/msrc/Newtonsoft.Json/Src/Newtonsoft.Json/Serialization/DefaultContractResolver.cs:372 \n  at Newtonsoft.Json.Serialization.DefaultContractResolver.CreateContract (System.Type objectType) [0x00161] in /home/vm-alpha/msrc/Newtonsoft.Json/Src/Newtonsoft.Json/Serialization/DefaultContractResolver.cs:1077 \n  at Newtonsoft.Json.Serialization.DefaultContractResolver.ResolveContract (System.Type type) [0x0004b] in /home/vm-alpha/msrc/Newtonsoft.Json/Src/Newtonsoft.Json/Serialization/DefaultContractResolver.cs:241 \n  at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.GetContractSafe (System.Object value) [0x0001f] in /home/vm-alpha/msrc/Newtonsoft.Json/Src/Newtonsoft.Json/Serialization/JsonSerializerInternalWriter.cs:117 \n  at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize (Newtonsoft.Json.JsonWriter jsonWriter, System.Object value, System.Type objectType) [0x00050] in /home/vm-alpha/msrc/Newtonsoft.Json/Src/Newtonsoft.Json/Serialization/JsonSerializerInternalWriter.cs:68 \n  at Newtonsoft.Json.JsonSerializer.SerializeInternal (Newtonsoft.Json.JsonWriter jsonWriter, System.Object value, System.Type objectType) [0x002c6] in /home/vm-alpha/msrc/Newtonsoft.Json/Src/Newtonsoft.Json/JsonSerializer.cs:947 \n  at Newtonsoft.Json.JsonSerializer.Serialize (Newtonsoft.Json.JsonWriter jsonWriter, System.Object value, System.Type objectType) [0x00005] in /home/vm-alpha/msrc/Newtonsoft.Json/Src/Newtonsoft.Json/JsonSerializer.cs:858 \n  at Newtonsoft.Json.JsonConvert.SerializeObjectInternal (System.Object value, System.Type type, Newtonsoft.Json.JsonSerializer jsonSerializer) [0x00027] in /home/vm-alpha/msrc/Newtonsoft.Json/Src/Newtonsoft.Json/JsonConvert.cs:641 \n  at Newtonsoft.Json.JsonConvert.SerializeObject (System.Object value, System.Type type, Newtonsoft.Json.JsonSerializerSettings settings) [0x0000b] in /home/vm-alpha/msrc/Newtonsoft.Json/Src/Newtonsoft.Json/JsonConvert.cs:594 \n  at Newtonsoft.Json.JsonConvert.SerializeObject (System.Object value) [0x00004] in /home/vm-alpha/msrc/Newtonsoft.Json/Src/Newtonsoft.Json/JsonConvert.cs:515 \n  at MainClass.Main (System.String[] args) [0x00006] in /home/vm-alpha/msrc/test1/test1/Program.cs:7 \n```\n\nI've tracked down this behavior to the method MethodInfo.GetBaseDefinition() which returns different results in mono and .net (https://bugzilla.xamarin.com/show_bug.cgi?id=36305): when method is initially declared in generic base class, GetBaseDefition() will sometimes return MethodInfo whose DeclaringType is not a base class of initial class.\n\nPull request will follow.\n","closed_by":{"login":"JamesNK","id":303201,"node_id":"MDQ6VXNlcjMwMzIwMQ==","avatar_url":"https://avatars.githubusercontent.com/u/303201?v=4","gravatar_id":"","url":"https://api.github.com/users/JamesNK","html_url":"https://github.com/JamesNK","followers_url":"https://api.github.com/users/JamesNK/followers","following_url":"https://api.github.com/users/JamesNK/following{/other_user}","gists_url":"https://api.github.com/users/JamesNK/gists{/gist_id}","starred_url":"https://api.github.com/users/JamesNK/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JamesNK/subscriptions","organizations_url":"https://api.github.com/users/JamesNK/orgs","repos_url":"https://api.github.com/users/JamesNK/repos","events_url":"https://api.github.com/users/JamesNK/events{/privacy}","received_events_url":"https://api.github.com/users/JamesNK/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/JamesNK/Newtonsoft.Json/issues/726/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/JamesNK/Newtonsoft.Json/issues/726/timeline","performed_via_github_app":null,"state_reason":"completed"}