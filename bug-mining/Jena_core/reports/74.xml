<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 19:57:41 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[JENA-1066] Node_Factory.createLiteralByValue creates malformed literals from BigDecimal values</title>
                <link>https://issues.apache.org/jira/browse/JENA-1066</link>
                <project id="12311220" key="JENA">Apache Jena</project>
                    <description>&lt;p&gt;I&apos;ve been working with some numeric data and have run into some problems when using:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    Node_Factory.createLiteralByValue(&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; value, RDFDatatype dtype) 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;when value is a &lt;tt&gt;BigDecimal&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;Jena ultimately uses &lt;tt&gt;BigDecimal.toString()&lt;/tt&gt; to generate lexical forms for well-formed-ness checking and to provide results for &lt;tt&gt;.getLexicalForm()&lt;/tt&gt; on the resulting &lt;tt&gt;Node_Literal&lt;/tt&gt;. Unfortunately Java 1.5 changed the behaviour of &lt;tt&gt;BigDecimal.toString()&lt;/tt&gt; and added &lt;tt&gt;BigDecimal.toPlainString()&lt;/tt&gt; which it describes as an analog of the java 1.4 &lt;tt&gt;BigDecimal.toString()&lt;/tt&gt; and which specifically does not use exponential notation in its output. &lt;tt&gt;xsd:decimal&lt;/tt&gt; lexicalforms do not allow exponential notation&lt;/p&gt;

&lt;p&gt;I&apos;ll attached small java program that illustrates the problem. The cases where a dud literal form (i.e. as a literal in exponent from) are fair enough.&lt;/p&gt;

&lt;p&gt;I&apos;ve also locally created a fix that special cases instances of &lt;tt&gt;BigDecimal&lt;/tt&gt; in a couple of places. Patch file to be attached.&lt;/p&gt;

&lt;p&gt;With the fix applied the literals arising from &lt;tt&gt;Node_Factory.createLiteralByValue&lt;/tt&gt; calls with a &lt;tt&gt;BigDecimal&lt;/tt&gt; value are wellformed.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12912229">JENA-1066</key>
            <summary>Node_Factory.createLiteralByValue creates malformed literals from BigDecimal values</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="andy">Andy Seaborne</assignee>
                                    <reporter username="skw@lilac-cottage.org.uk">Stuart Williams</reporter>
                        <labels>
                    </labels>
                <created>Wed, 11 Nov 2015 17:40:24 +0000</created>
                <updated>Sat, 12 Dec 2015 17:46:22 +0000</updated>
                            <resolved>Wed, 11 Nov 2015 22:22:54 +0000</resolved>
                                    <version>Jena 2.13.0</version>
                    <version>Jena 3.0.0</version>
                                    <fixVersion>Jena 3.0.1</fixVersion>
                                    <component>Core</component>
                    <component>Datatypes</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="15000815" author="andy.seaborne" created="Wed, 11 Nov 2015 18:08:11 +0000"  >&lt;p&gt;Agreed. &lt;tt&gt;BigDecimal.toPlainString&lt;/tt&gt; is needed for XSD.  ARQ, in &lt;tt&gt;NodeValue&lt;/tt&gt;, uses &lt;tt&gt;toPlainString&lt;/tt&gt; in &lt;tt&gt;org.apache.jena.sparql.util.Util&lt;/tt&gt; where &lt;tt&gt;Double&lt;/tt&gt; and &lt;tt&gt;Float&lt;/tt&gt; are also covered. XSD uses &lt;tt&gt;INF&lt;/tt&gt;, Java uses &lt;tt&gt;Infinity&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;A consistent style with elsewhere (e.g. &lt;tt&gt;XSDhexBinary&lt;/tt&gt;) is to implement &lt;tt&gt;XSDBaseNumericType.unparse&lt;/tt&gt;.&lt;/p&gt;</comment>
                            <comment id="15001041" author="jira-bot" created="Wed, 11 Nov 2015 20:32:03 +0000"  >&lt;p&gt;Commit 2aaa1b67bd363b0d0d96e570f4f73b1fc6424e22 in jena&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=andy.seaborne&quot; class=&quot;user-hover&quot; rel=&quot;andy.seaborne&quot;&gt;andy.seaborne&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=jena.git;h=2aaa1b6&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=jena.git;h=2aaa1b6&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/JENA-1066&quot; title=&quot;Node_Factory.createLiteralByValue creates malformed literals from BigDecimal values&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JENA-1066&quot;&gt;&lt;del&gt;JENA-1066&lt;/del&gt;&lt;/a&gt; : Use BigDecimal.toPlainString.&lt;/p&gt;

&lt;p&gt;Also, Float-&amp;gt;string and Double-&amp;gt;string to use &quot;INF&quot; not Java &quot;Infinity&quot;.&lt;/p&gt;</comment>
                            <comment id="15001252" author="skw@lilac-cottage.org.uk" created="Wed, 11 Nov 2015 22:33:17 +0000"  >&lt;p&gt;Well that went well... many thanks Andy.&lt;/p&gt;</comment>
                            <comment id="15054481" author="andy.seaborne" created="Sat, 12 Dec 2015 17:46:22 +0000"  >&lt;p&gt;Jena 3.0.1 released.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12771800" name="BigDecimalTestCase.java" size="1579" author="skw@lilac-cottage.org.uk" created="Wed, 11 Nov 2015 17:43:03 +0000"/>
                            <attachment id="12771801" name="git-diff.txt" size="1420" author="skw@lilac-cottage.org.uk" created="Wed, 11 Nov 2015 17:43:03 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 49 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2o9av:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>