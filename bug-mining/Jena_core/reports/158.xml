<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 19:58:18 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[JENA-2055] handle properly the denied access generated by jena-permission security evaluator</title>
                <link>https://issues.apache.org/jira/browse/JENA-2055</link>
                <project id="12311220" key="JENA">Apache Jena</project>
                    <description>&lt;p&gt;When the dataset is secured with &lt;a href=&quot;https://jena.apache.org/documentation/permissions/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;jena permission&lt;/a&gt; , and some access is denied, an exception is thrown from the SecuredGraph.&lt;/p&gt;

&lt;p&gt;This exception is not catched in SPARQLQueryProcessor, which results in a 500 error returned to the HTTP client.&lt;/p&gt;

&lt;p&gt;exception OperationDeniedException should return a 403, not a 500.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;attached is the patch !&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;2021-02-21 03:10:26&amp;#93;&lt;/span&gt; Fuseki WARN &lt;span class=&quot;error&quot;&gt;&amp;#91;3&amp;#93;&lt;/span&gt; RC = 500 : Model permissions violation:&lt;br/&gt;
 org.apache.jena.shared.ReadDeniedException: Model permissions violation:&lt;br/&gt;
 at org.apache.jena.permissions.impl.SecuredItemImpl.checkRead(SecuredItemImpl.java:683) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;jena-permissions-3.17.0.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.apache.jena.permissions.graph.impl.SecuredGraphImpl.find(SecuredGraphImpl.java:154) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;jena-permissions-3.17.0.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;?:1.8.0_275&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;?:1.8.0_275&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;?:1.8.0_275&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at java.lang.reflect.Method.invoke(Method.java:498) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;?:1.8.0_275&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.apache.jena.permissions.impl.SecuredItemInvoker.invoke(SecuredItemInvoker.java:120) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;jena-permissions-3.17.0.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at com.sun.proxy.$Proxy18.find(Unknown Source) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;?:?&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.apache.jena.sparql.graph.GraphUnionRead.graphBaseFind(GraphUnionRead.java:104) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.apache.jena.graph.impl.GraphBase.find(GraphBase.java:244) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.apache.jena.graph.impl.GraphBase.graphBaseFind(GraphBase.java:261) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.apache.jena.graph.impl.GraphBase.find(GraphBase.java:258) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.apache.jena.graph.impl.WrappedGraph.find(WrappedGraph.java:100) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.apache.jena.sparql.engine.iterator.QueryIterTriplePattern$TripleMapper.&amp;lt;init&amp;gt;(QueryIterTriplePattern.java:83) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.apache.jena.sparql.engine.iterator.QueryIterTriplePattern.nextStage(QueryIterTriplePattern.java:52) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.apache.jena.sparql.engine.iterator.QueryIterRepeatApply.makeNextStage(QueryIterRepeatApply.java:108) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.apache.jena.sparql.engine.iterator.QueryIterRepeatApply.hasNextBinding(QueryIterRepeatApply.java:65) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.apache.jena.sparql.engine.iterator.QueryIteratorBase.hasNext(QueryIteratorBase.java:114) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.apache.jena.sparql.engine.iterator.QueryIterBlockTriplesStar.hasNextBinding(QueryIterBlockTriplesStar.java:54) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.apache.jena.sparql.engine.iterator.QueryIteratorBase.hasNext(QueryIteratorBase.java:114) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.apache.jena.sparql.engine.iterator.QueryIterConvert.hasNextBinding(QueryIterConvert.java:58) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.apache.jena.sparql.engine.iterator.QueryIteratorBase.hasNext(QueryIteratorBase.java:114) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.apache.jena.sparql.engine.iterator.QueryIteratorWrapper.hasNextBinding(QueryIteratorWrapper.java:38) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.apache.jena.sparql.engine.iterator.QueryIteratorBase.hasNext(QueryIteratorBase.java:114) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.apache.jena.sparql.engine.iterator.QueryIteratorWrapper.hasNextBinding(QueryIteratorWrapper.java:38) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.apache.jena.sparql.engine.iterator.QueryIteratorBase.hasNext(QueryIteratorBase.java:114) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.apache.jena.sparql.engine.ResultSetStream.hasNext(ResultSetStream.java:74) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.apache.jena.sparql.engine.ResultSetCheckCondition.hasNext(ResultSetCheckCondition.java:55) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.apache.jena.fuseki.servlets.SPARQLQueryProcessor.executeQuery(SPARQLQueryProcessor.java:324) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.apache.jena.fuseki.servlets.SPARQLQueryProcessor.execute(SPARQLQueryProcessor.java:273) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.apache.jena.fuseki.servlets.SPARQLQueryProcessor.executeWithParameter(SPARQLQueryProcessor.java:222) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.apache.jena.fuseki.servlets.SPARQLQueryProcessor.execute(SPARQLQueryProcessor.java:207) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.apache.jena.fuseki.servlets.ActionService.executeLifecycle(ActionService.java:58) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.apache.jena.fuseki.servlets.SPARQLQueryProcessor.execPost(SPARQLQueryProcessor.java:83) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.apache.jena.fuseki.servlets.ActionProcessor.process(ActionProcessor.java:34) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.apache.jena.fuseki.servlets.ActionBase.process(ActionBase.java:55) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.apache.jena.fuseki.servlets.ActionExecLib.execAction(ActionExecLib.java:106) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.apache.jena.fuseki.server.Dispatcher.dispatchAction(Dispatcher.java:118) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.apache.jena.fuseki.server.Dispatcher.process(Dispatcher.java:110) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.apache.jena.fuseki.server.Dispatcher.dispatch(Dispatcher.java:96) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.apache.jena.fuseki.servlets.FusekiFilter.doFilter(FusekiFilter.java:51) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1601) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:61) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:108) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:137) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:125) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:66) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:108) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:137) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:125) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:66) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:108) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:137) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:125) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:66) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:450) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.apache.shiro.web.servlet.AbstractShiroFilter$1.call(AbstractShiroFilter.java:365) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:90) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:83) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:387) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:362) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:125) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1601) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.apache.jena.fuseki.servlets.CrossOriginFilter.handle(CrossOriginFilter.java:284) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.apache.jena.fuseki.servlets.CrossOriginFilter.doFilter(CrossOriginFilter.java:247) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:201) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1601) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:548) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:602) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:235) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1612) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1434) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:501) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1582) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1349) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.eclipse.jetty.server.handler.gzip.GzipHandler.handle(GzipHandler.java:716) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.eclipse.jetty.server.Server.handle(Server.java:516) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:383) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:556) &lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:375) &lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:273) &lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311) &lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) &lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104) &lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:336) &lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:313) &lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:171) &lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:129) &lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:375) &lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:773) &lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.run(QueuedThreadPool.java:905) &lt;span class=&quot;error&quot;&gt;&amp;#91;fuseki-server.jar:3.17.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at java.lang.Thread.run(Thread.java:748) &lt;span class=&quot;error&quot;&gt;&amp;#91;?:1.8.0_275&amp;#93;&lt;/span&gt;&lt;br/&gt;
 &lt;span class=&quot;error&quot;&gt;&amp;#91;2021-02-21 03:10:26&amp;#93;&lt;/span&gt; Fuseki INFO &lt;span class=&quot;error&quot;&gt;&amp;#91;3&amp;#93;&lt;/span&gt; 500 Server Error (18 ms)&lt;/p&gt;</description>
                <environment>&lt;p&gt;jena-fuseki 3.17.0&lt;/p&gt;

&lt;p&gt;openjdk version &quot;1.8.0_275&quot;&lt;/p&gt;</environment>
        <key id="13359854">JENA-2055</key>
            <summary>handle properly the denied access generated by jena-permission security evaluator</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="andy">Andy Seaborne</assignee>
                                    <reporter username="infoplp">info parlepeuple</reporter>
                        <labels>
                            <label>fuseki2</label>
                            <label>permission</label>
                    </labels>
                <created>Sun, 21 Feb 2021 01:59:26 +0000</created>
                <updated>Thu, 1 Apr 2021 09:21:46 +0000</updated>
                            <resolved>Mon, 1 Mar 2021 10:49:30 +0000</resolved>
                                    <version>Jena 3.17.0</version>
                                    <fixVersion>Jena 4.0.0</fixVersion>
                                    <component>Fuseki</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="17287906" author="andy.seaborne" created="Sun, 21 Feb 2021 10:38:36 +0000"  >&lt;p&gt;Thank for the patch!&lt;/p&gt;

&lt;p&gt;There are other routes that can cause the same situation - accessing the protected data with graph store protocol or SPARQL Update. These are all be handled once if the &lt;tt&gt;OperationDeniedException&lt;/tt&gt; exception is caught in the main loop of request processing: &lt;a href=&quot;https://github.com/apache/jena/blob/b2d3991615d6ee87f89397b8dd13944487650fce/jena-fuseki2/jena-fuseki-core/src/main/java/org/apache/jena/fuseki/servlets/ActionExecLib.java#L115&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;ActionExecLib.java#L115&lt;/a&gt;&#160;with a general message &quot;Request forbidden&quot;.&lt;/p&gt;

&lt;p&gt;If you want per operation error strings, there&apos;ll need to catch in each operation operation, but I don&apos;t see that is useful in any way and a blunt &quot;You can&apos;t do that&quot; is fine. There ought to be handling in the main loop anyway to be robust to new operations being added.&lt;/p&gt;</comment>
                            <comment id="17288091" author="infoplp" created="Sun, 21 Feb 2021 21:39:21 +0000"  >&lt;p&gt;Thanks for your comment!&lt;/p&gt;

&lt;p&gt;I am new to Jena... I didn&apos;t know exactly where to put the catch. ActionExecLib looks like the perfect place.&lt;/p&gt;

&lt;p&gt;Please find attached a new patch that reflects your suggestion. I tested it with my setup and it works as expected. I even get the detail exception message &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;Looking forward to have this in next release.&lt;/p&gt;</comment>
                            <comment id="17291374" author="infoplp" created="Fri, 26 Feb 2021 04:09:34 +0000"  >&lt;p&gt;Is the patch ok ?&lt;/p&gt;</comment>
                            <comment id="17291626" author="andy.seaborne" created="Fri, 26 Feb 2021 12:52:34 +0000"  >&lt;p&gt;yes - it&apos;s in the right place.&lt;/p&gt;

&lt;p&gt;I haven&apos;t understood the processing of &quot;ActionErrorException&quot; yet. I thought it would be a matter of catching &quot;OperationDeniedException&quot;. However, the processing flow is complicated and my assumption is from memory so I need to switch context and investigate.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17292246" author="andy.seaborne" created="Sat, 27 Feb 2021 22:08:10 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=infoplp&quot; class=&quot;user-hover&quot; rel=&quot;infoplp&quot;&gt;infoplp&lt;/a&gt; - what operation are you using to test the patch?&lt;/p&gt;

&lt;p&gt;I replaced query execution with &quot;throw new AccessDeniedException&quot; and get a stacktrace like in the description.&lt;/p&gt;

&lt;p&gt;There is no ActionErrorException; it gets caught by the general catch-Throwable, hence 500.&lt;/p&gt;

&lt;p&gt;The patch intercepts ActionErrorException.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Is this because you are testing with a different operation?&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17292317" author="infoplp" created="Sun, 28 Feb 2021 06:42:58 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=andy&quot; class=&quot;user-hover&quot; rel=&quot;andy&quot;&gt;andy&lt;/a&gt; thank you for looking into this issue.&lt;/p&gt;

&lt;p&gt;I can confirm that the patch works for me, with this test environment:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;compile the class ShiroEvaluator.java&lt;/li&gt;
	&lt;li&gt;in order to compile it, use the provided pom.xml and run `mvn package`&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;make the resulting jar available to fuseki (in the extra folder) and add also 2 other jars in that folder : `jena-permissions-3.17.0.jar` `commons-collections4-4.4.jar` (you can download those jars from maven.org.&lt;/li&gt;
	&lt;li&gt;setup a dataset in fuseki with the attached file `localData.ttl`&lt;/li&gt;
	&lt;li&gt;put some data in localData&lt;/li&gt;
	&lt;li&gt;query the sparql endpoint with thise queries :&lt;br/&gt;
```&lt;br/&gt;
&lt;font color=&quot;#a31515&quot;&gt;SELECT ?subject ?predicate ?object WHERE { ?subject ?predicate ?object };&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;#a31515&quot;&gt;INSERT DATA { &amp;lt;&lt;a href=&quot;https://test/1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://test/1&lt;/a&gt;&amp;gt; &amp;lt;&lt;a href=&quot;http://test/ns/property1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://test/ns/property1&lt;/a&gt;&amp;gt; &quot;ok&quot;};&lt;/font&gt;&lt;br/&gt;
```&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="17292407" author="andy.seaborne" created="Sun, 28 Feb 2021 13:52:57 +0000"  >&lt;p&gt;Th SELECT one has a syntax error (trailing &quot;;&quot;) which causes ActionErrorException. This is unrelated to jena-permissions.&lt;/p&gt;

&lt;p&gt;Sending the &lt;tt&gt;SELECT&lt;/tt&gt; query, I get the stacktrace in the description - no ActionErrorException involved - it&apos;s caught by the &quot;catch (Throwable)&quot;.&lt;/p&gt;

&lt;p&gt;Sending the &quot;INSERT&quot; does give ActionErrorException but a different stacktrace. The update is different because an update can be streamed so parsing and execution are mixed. There will need to be a change to SPARQL_Update to expose the &lt;tt&gt;OperationDeniedException&lt;/tt&gt;. This is probably a situation in other operations as well because GSP mixes request checking and request execution as well.&lt;/p&gt;

&lt;p&gt;I&apos;ll prepare a pull request.&lt;/p&gt;
</comment>
                            <comment id="17292456" author="andy.seaborne" created="Sun, 28 Feb 2021 17:54:28 +0000"  >&lt;p&gt;&lt;a href=&quot;https://github.com/apache/jena/pull/932&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/jena/pull/932&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17292710" author="infoplp" created="Mon, 1 Mar 2021 08:11:13 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=andy&quot; class=&quot;user-hover&quot; rel=&quot;andy&quot;&gt;andy&lt;/a&gt; thanks for this commit. I just tested it. It fixes everything for us, thank you !&lt;/p&gt;

&lt;p&gt;We have a slightly different configuration here than what i sent you in attachments, with a named graphed configured in the dataset, in addition to the defaultGraph. And in the ShiroEvaluator, we return true when the defaultGraph is queries, and false when the named graph is queried.&lt;br/&gt;
For those 2 different kinds&#160; of SELECT, the behaviour is different:&lt;/p&gt;

&lt;p&gt;This one will result in a 403. all good !&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;  SELECT ?s ?p ?o WHERE { GRAPH &amp;lt;http://namedgraph/&amp;gt; { ?s ?p ?o } }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The following one will result in a 200, with some triples returned, and then an abrupt string saying &quot;Model permissions violation: &lt;a href=&quot;http://securednamedgraph/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://securednamedgraph/&lt;/a&gt;&quot;, which renders the JSON invalid. Jena starts to produce an output for the defaultGraph, with a 200 status code, and a stream of results is being sent already back to the client, and then, abruptly, when the engine bumps into some forbidden access for the named graph, the Exception is catched and a 403 status code is logged on Jena&apos;s side. The http response we get on the client side is still 200 because a 200 status code was already sent before the exception occurs. Before your fix, the body of the response contained some triples, and then the string mentioned above (it breaks JSON syntax obviously). Now it contains the triples, and no string (because you didn&apos;t make the status text bubble up). But the jSON is still malformed, because it ends abruptly on the last triple that was found, and there is no closing of the JSON (at least we would need this : &quot;] } }&quot; for a proper ending of the JSON) This is not a problem for us, as we never do this kind of query. And I can totally understand that JENA cannot do much better since it already started to stream some results, and only afterwards bumps into some permissions violation. &lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;    SELECT * { { ?s ?p ?o } UNION { GRAPH ?g { ?s ?p ?o } } }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;End of the body output (without your fix):&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;{&#183;
 &quot;s&quot;: { &quot;type&quot;: &quot;uri&quot; , &quot;value&quot;: &quot;http://localhost:3000/resources/603b54786ded3ceb12024fcf&quot; } ,
 &quot;p&quot;: { &quot;type&quot;: &quot;uri&quot; , &quot;value&quot;: &quot;http://localhost:3000/predicate#p1&quot; } ,
 &quot;o&quot;: { &quot;type&quot;: &quot;literal&quot; , &quot;value&quot;: &quot;myValue&quot; }
 }Model permissions violation: http://securedNamedGraph
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;End of the body output (with your fix):&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;{&#183;
 &quot;s&quot;: { &quot;type&quot;: &quot;uri&quot; , &quot;value&quot;: &quot;http://localhost:3000/resources/603b54786ded3ceb12024fcf&quot; } ,
 &quot;p&quot;: { &quot;type&quot;: &quot;uri&quot; , &quot;value&quot;: &quot;http://localhost:3000/predicate#p1&quot; } ,
 &quot;o&quot;: { &quot;type&quot;: &quot;literal&quot; , &quot;value&quot;: &quot;myValue&quot; }
 }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Stacktrace for this case (without your fix, so you know where it happens) :&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.jena.shared.ReadDeniedException: Model permissions violation: http://securedNamedGraph
at org.apache.jena.permissions.impl.SecuredItemImpl.checkRead(SecuredItemImpl.java:683) ~[jena-permissions-3.17.0.jar:3.17.0]
at org.apache.jena.permissions.graph.impl.SecuredGraphImpl.find(SecuredGraphImpl.java:143) ~[jena-permissions-3.17.0.jar:3.17.0]
at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:64) ~[?:?]
at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
at java.lang.reflect.Method.invoke(Method.java:564) ~[?:?]
at org.apache.jena.permissions.impl.SecuredItemInvoker.invoke(SecuredItemInvoker.java:120) ~[jena-permissions-3.17.0.jar:3.17.0]
at com.sun.proxy.$Proxy18.find(Unknown Source) ~[?:?]
at org.apache.jena.sparql.engine.iterator.QueryIterTriplePattern$TripleMapper.&amp;lt;init&amp;gt;(QueryIterTriplePattern.java:83) ~[fuseki-server.jar:3.17.0]
at org.apache.jena.sparql.engine.iterator.QueryIterTriplePattern.nextStage(QueryIterTriplePattern.java:52) ~[fuseki-server.jar:3.17.0]
at org.apache.jena.sparql.engine.iterator.QueryIterRepeatApply.makeNextStage(QueryIterRepeatApply.java:108) ~[fuseki-server.jar:3.17.0]
at org.apache.jena.sparql.engine.iterator.QueryIterRepeatApply.hasNextBinding(QueryIterRepeatApply.java:65) ~[fuseki-server.jar:3.17.0]
at org.apache.jena.sparql.engine.iterator.QueryIteratorBase.hasNext(QueryIteratorBase.java:114) ~[fuseki-server.jar:3.17.0]
at org.apache.jena.sparql.engine.iterator.QueryIterBlockTriplesStar.hasNextBinding(QueryIterBlockTriplesStar.java:54) ~[fuseki-server.jar:3.17.0]
at org.apache.jena.sparql.engine.iterator.QueryIteratorBase.hasNext(QueryIteratorBase.java:114) ~[fuseki-server.jar:3.17.0]
at org.apache.jena.sparql.engine.iterator.QueryIterProcessBinding.hasNextBinding(QueryIterProcessBinding.java:66) ~[fuseki-server.jar:3.17.0]
at org.apache.jena.sparql.engine.iterator.QueryIteratorBase.hasNext(QueryIteratorBase.java:114) ~[fuseki-server.jar:3.17.0]
at org.apache.jena.sparql.engine.main.iterator.QueryIterGraph$QueryIterGraphInner.hasNextBinding(QueryIterGraph.java:121) ~[fuseki-server.jar:3.17.0]
at org.apache.jena.sparql.engine.iterator.QueryIteratorBase.hasNext(QueryIteratorBase.java:114) ~[fuseki-server.jar:3.17.0]
at org.apache.jena.sparql.engine.iterator.QueryIterRepeatApply.hasNextBinding(QueryIterRepeatApply.java:74) ~[fuseki-server.jar:3.17.0]
at org.apache.jena.sparql.engine.iterator.QueryIteratorBase.hasNext(QueryIteratorBase.java:114) ~[fuseki-server.jar:3.17.0]
at org.apache.jena.sparql.engine.iterator.QueryIterConcat.hasNextBinding(QueryIterConcat.java:82) ~[fuseki-server.jar:3.17.0]
at org.apache.jena.sparql.engine.iterator.QueryIteratorBase.hasNext(QueryIteratorBase.java:114) ~[fuseki-server.jar:3.17.0]
at org.apache.jena.sparql.engine.iterator.QueryIterRepeatApply.hasNextBinding(QueryIterRepeatApply.java:74) ~[fuseki-server.jar:3.17.0]
at org.apache.jena.sparql.engine.iterator.QueryIteratorBase.hasNext(QueryIteratorBase.java:114) ~[fuseki-server.jar:3.17.0]
at org.apache.jena.sparql.engine.iterator.QueryIteratorWrapper.hasNextBinding(QueryIteratorWrapper.java:38) ~[fuseki-server.jar:3.17.0]
at org.apache.jena.sparql.engine.iterator.QueryIteratorBase.hasNext(QueryIteratorBase.java:114) ~[fuseki-server.jar:3.17.0]
at org.apache.jena.sparql.engine.iterator.QueryIteratorWrapper.hasNextBinding(QueryIteratorWrapper.java:38) ~[fuseki-server.jar:3.17.0]
at org.apache.jena.sparql.engine.iterator.QueryIteratorBase.hasNext(QueryIteratorBase.java:114) ~[fuseki-server.jar:3.17.0]
at org.apache.jena.sparql.engine.ResultSetStream.hasNext(ResultSetStream.java:74) ~[fuseki-server.jar:3.17.0]
at org.apache.jena.sparql.engine.ResultSetCheckCondition.hasNext(ResultSetCheckCondition.java:55) ~[fuseki-server.jar:3.17.0]
at org.apache.jena.riot.resultset.rw.ResultSetWriterJSON$ResultSetWriterTableJSON.writeRows(ResultSetWriterJSON.java:143) ~[fuseki-server.jar:3.17.0]
at org.apache.jena.riot.resultset.rw.ResultSetWriterJSON$ResultSetWriterTableJSON.write(ResultSetWriterJSON.java:130) ~[fuseki-server.jar:3.17.0]
at org.apache.jena.riot.resultset.rw.ResultSetWriterJSON$ResultSetWriterTableJSON.access$100(ResultSetWriterJSON.java:98) ~[fuseki-server.jar:3.17.0]
at org.apache.jena.riot.resultset.rw.ResultSetWriterJSON.write(ResultSetWriterJSON.java:89) ~[fuseki-server.jar:3.17.0]
at org.apache.jena.riot.resultset.rw.ResultsWriter.write(ResultsWriter.java:127) ~[fuseki-server.jar:3.17.0]
at org.apache.jena.riot.resultset.rw.ResultsWriter.write(ResultsWriter.java:97) ~[fuseki-server.jar:3.17.0]
at org.apache.jena.fuseki.servlets.ResponseResultSet.lambda$generalOutput$1(ResponseResultSet.java:209) ~[fuseki-server.jar:3.17.0]
at org.apache.jena.fuseki.servlets.ResponseResultSet.output(ResponseResultSet.java:225) ~[fuseki-server.jar:3.17.0]
at org.apache.jena.fuseki.servlets.ResponseResultSet.generalOutput(ResponseResultSet.java:215) ~[fuseki-server.jar:3.17.0]
at org.apache.jena.fuseki.servlets.ResponseResultSet.doResponseResultSet$(ResponseResultSet.java:176) ~[fuseki-server.jar:3.17.0]
at org.apache.jena.fuseki.servlets.ResponseResultSet.doResponseResultSet(ResponseResultSet.java:85) ~[fuseki-server.jar:3.17.0]
at org.apache.jena.fuseki.servlets.SPARQLQueryProcessor.sendResults(SPARQLQueryProcessor.java:392) ~[fuseki-server.jar:3.17.0]
at org.apache.jena.fuseki.servlets.SPARQLQueryProcessor.execute(SPARQLQueryProcessor.java:275) ~[fuseki-server.jar:3.17.0]
at org.apache.jena.fuseki.servlets.SPARQLQueryProcessor.executeWithParameter(SPARQLQueryProcessor.java:222) ~[fuseki-server.jar:3.17.0]
at org.apache.jena.fuseki.servlets.SPARQLQueryProcessor.execute(SPARQLQueryProcessor.java:207) ~[fuseki-server.jar:3.17.0]
at org.apache.jena.fuseki.servlets.ActionService.executeLifecycle(ActionService.java:58) ~[fuseki-server.jar:3.17.0]
at org.apache.jena.fuseki.servlets.SPARQLQueryProcessor.execPost(SPARQLQueryProcessor.java:83) ~[fuseki-server.jar:3.17.0]
at org.apache.jena.fuseki.servlets.ActionProcessor.process(ActionProcessor.java:34) ~[fuseki-server.jar:3.17.0]
at org.apache.jena.fuseki.servlets.ActionBase.process(ActionBase.java:55) ~[fuseki-server.jar:3.17.0]
at org.apache.jena.fuseki.servlets.ActionExecLib.execAction(ActionExecLib.java:106) ~[fuseki-server.jar:3.17.0]
at org.apache.jena.fuseki.server.Dispatcher.dispatchAction(Dispatcher.java:118) ~[fuseki-server.jar:3.17.0]
at org.apache.jena.fuseki.server.Dispatcher.process(Dispatcher.java:110) ~[fuseki-server.jar:3.17.0]
at org.apache.jena.fuseki.server.Dispatcher.dispatch(Dispatcher.java:96) ~[fuseki-server.jar:3.17.0]
at org.apache.jena.fuseki.servlets.FusekiFilter.doFilter(FusekiFilter.java:51) ~[fuseki-server.jar:3.17.0]
at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193) ~[fuseki-server.jar:3.17.0]
at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1601) ~[fuseki-server.jar:3.17.0]
at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:61) ~[fuseki-server.jar:3.17.0]
at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:108) ~[fuseki-server.jar:3.17.0]
at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:137) ~[fuseki-server.jar:3.17.0]
at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:125) ~[fuseki-server.jar:3.17.0]
at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:66) ~[fuseki-server.jar:3.17.0]
at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:108) ~[fuseki-server.jar:3.17.0]
at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:137) ~[fuseki-server.jar:3.17.0]
at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:125) ~[fuseki-server.jar:3.17.0]
at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:66) ~[fuseki-server.jar:3.17.0]
at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:108) ~[fuseki-server.jar:3.17.0]
at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:137) ~[fuseki-server.jar:3.17.0]
at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:125) ~[fuseki-server.jar:3.17.0]
at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:66) ~[fuseki-server.jar:3.17.0]
at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:450) ~[fuseki-server.jar:3.17.0]
at org.apache.shiro.web.servlet.AbstractShiroFilter$1.call(AbstractShiroFilter.java:365) ~[fuseki-server.jar:3.17.0]
at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:90) ~[fuseki-server.jar:3.17.0]
at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:83) ~[fuseki-server.jar:3.17.0]
at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:387) ~[fuseki-server.jar:3.17.0]
at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:362) ~[fuseki-server.jar:3.17.0]
at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:125) ~[fuseki-server.jar:3.17.0]
at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193) ~[fuseki-server.jar:3.17.0]
at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1601) ~[fuseki-server.jar:3.17.0]
at org.apache.jena.fuseki.servlets.CrossOriginFilter.handle(CrossOriginFilter.java:284) ~[fuseki-server.jar:3.17.0]
at org.apache.jena.fuseki.servlets.CrossOriginFilter.doFilter(CrossOriginFilter.java:247) ~[fuseki-server.jar:3.17.0]
at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:201) ~[fuseki-server.jar:3.17.0]
at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1601) ~[fuseki-server.jar:3.17.0]
at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:548) ~[fuseki-server.jar:3.17.0]
at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143) ~[fuseki-server.jar:3.17.0]
at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:602) ~[fuseki-server.jar:3.17.0]
at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127) ~[fuseki-server.jar:3.17.0]
at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:235) ~[fuseki-server.jar:3.17.0]
at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1612) ~[fuseki-server.jar:3.17.0]
at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[fuseki-server.jar:3.17.0]
at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1434) ~[fuseki-server.jar:3.17.0]
at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188) ~[fuseki-server.jar:3.17.0]
at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:501) ~[fuseki-server.jar:3.17.0]
at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1582) ~[fuseki-server.jar:3.17.0]
at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186) ~[fuseki-server.jar:3.17.0]
at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1349) ~[fuseki-server.jar:3.17.0]
at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141) ~[fuseki-server.jar:3.17.0]
at org.eclipse.jetty.server.handler.gzip.GzipHandler.handle(GzipHandler.java:716) ~[fuseki-server.jar:3.17.0]
at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127) ~[fuseki-server.jar:3.17.0]
at org.eclipse.jetty.server.Server.handle(Server.java:516) ~[fuseki-server.jar:3.17.0]
at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:383) ~[fuseki-server.jar:3.17.0]
at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:556) ~[fuseki-server.jar:3.17.0]
at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:375) ~[fuseki-server.jar:3.17.0]
at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:273) ~[fuseki-server.jar:3.17.0]
at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311) ~[fuseki-server.jar:3.17.0]
at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) ~[fuseki-server.jar:3.17.0]
at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104) ~[fuseki-server.jar:3.17.0]
at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:336) ~[fuseki-server.jar:3.17.0]
at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:313) ~[fuseki-server.jar:3.17.0]
at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:171) ~[fuseki-server.jar:3.17.0]
at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.produce(EatWhatYouKill.java:135) ~[fuseki-server.jar:3.17.0]
at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:773) [fuseki-server.jar:3.17.0]
at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.run(QueuedThreadPool.java:905) [fuseki-server.jar:3.17.0]
at java.lang.Thread.run(Thread.java:832) [?:?]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17292805" author="jira-bot" created="Mon, 1 Mar 2021 10:28:01 +0000"  >&lt;p&gt;Commit 1b8165dbbae667e0e66a1ae0bcd726c730fbadb0 in jena&apos;s branch refs/heads/main from Andy Seaborne&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=jena.git;h=1b8165d&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=jena.git;h=1b8165d&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/JENA-2055&quot; title=&quot;handle properly the denied access generated by jena-permission security evaluator&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JENA-2055&quot;&gt;&lt;del&gt;JENA-2055&lt;/del&gt;&lt;/a&gt;: Catch OperationDeniedException and respond 403&lt;/p&gt;</comment>
                            <comment id="17292806" author="jira-bot" created="Mon, 1 Mar 2021 10:28:03 +0000"  >&lt;p&gt;Commit e502f0d28d4f1e78f6d9ba3a060755229a288ce0 in jena&apos;s branch refs/heads/main from Andy Seaborne&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=jena.git;h=e502f0d&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=jena.git;h=e502f0d&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;Merge pull request #932 from afs/jena2055-403&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/JENA-2055&quot; title=&quot;handle properly the denied access generated by jena-permission security evaluator&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JENA-2055&quot;&gt;&lt;del&gt;JENA-2055&lt;/del&gt;&lt;/a&gt;: Catch OperationDeniedException and respond 403&lt;/p&gt;</comment>
                            <comment id="17292814" author="andy.seaborne" created="Mon, 1 Mar 2021 10:54:56 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=infoplp&quot; class=&quot;user-hover&quot; rel=&quot;infoplp&quot;&gt;infoplp&lt;/a&gt;&#160;- this fix (applied to main) works for me.&lt;/p&gt;

&lt;p&gt;I tested all operations (query, update, GSP read, GSP read-write, file upload) with a setup including your example.&lt;/p&gt;

&lt;p&gt;If you get a chance to try it, that would be great.&lt;/p&gt;

&lt;p&gt;(Ideally,&#160; we need away to put such tests into the build but at the moment, the dependency relationships means we need a second &quot;integration&quot; module. Waiting for that would put a significantly longer lead time on a fix.)&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17292851" author="infoplp" created="Mon, 1 Mar 2021 12:05:48 +0000"  >&lt;p&gt;Yes &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=andy&quot; class=&quot;user-hover&quot; rel=&quot;andy&quot;&gt;andy&lt;/a&gt; i tested it this morning and it works perfectly for us ! thank you !&lt;/p&gt;

&lt;p&gt;Did you read my previous comment that I wrote this morning about a smaller issue related to malformed JSON when a permission exception occurs in the middle of a QueryIterator iteration.&lt;/p&gt;</comment>
                            <comment id="17292857" author="rvesse" created="Mon, 1 Mar 2021 12:27:19 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=infoplp&quot; class=&quot;user-hover&quot; rel=&quot;infoplp&quot;&gt;infoplp&lt;/a&gt; Unfortunately there is unlikely to be anything further that can be done to resolve that second case you are noting.  ARQ is by design a streaming query engine i.e. it always aims to do the minimum amount of work possible to provide the next query solution.  This has a lot of performance benefits especially wrt. keeping memory consumption down.&lt;/p&gt;

&lt;p&gt;When Fuseki processes a query it passes off the query to ARQ and starts directly streaming the results back to the client.&lt;/p&gt;

&lt;p&gt;Therefore if ARQ starts evaluating the query and produces some results to which a user is permitted access prior to encountering a permissions error then the HTTP response is already partially written so it&apos;s not possible at that point to change the HTTP response headers.  So all ARQ can do is dump the error message to the existing response (likely making it invalid data per your comment).&lt;/p&gt;</comment>
                            <comment id="17292858" author="andy.seaborne" created="Mon, 1 Mar 2021 12:27:40 +0000"  >&lt;p&gt;Thanks for testing.&lt;/p&gt;

&lt;p&gt;As for the other comment - different issue, specifically its related to jena-permissions itself. Please open a new ticket.&lt;/p&gt;

&lt;p&gt;I have reformatted it to be more readable using {noformat} blocks e.g. stacktraces and JSON.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17292860" author="infoplp" created="Mon, 1 Mar 2021 12:30:25 +0000"  >&lt;p&gt;The difference between the 2 queries and their behaviour is because :&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;we have 2 graphs. they both have data. One is accessible, the other one is protected by the security evaluator.&lt;/li&gt;
	&lt;li&gt;for the first query, we specifically ask to query on the protected graph. so Jena gets the exception at the beginning of the query, and is able to return a 403.&lt;/li&gt;
	&lt;li&gt;the second query is a UNION. it starts by searching on the unprotected graph (defaultGRaph) and gets some tuples to return, so it sends them back to the client. Later on, while continuing to process the UNION, it goes to the protected graph, and gets an exception.&lt;/li&gt;
	&lt;li&gt;at this moment, it is too late to change the HTTP status code. which is fine. some data was returned to the client. But at least, the exception should let jena to finish properly to handle the response and send the closing characters of the JSON output. otherwise, the JSON is malformed, left in the middle of processing.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="17292862" author="andy.seaborne" created="Mon, 1 Mar 2021 12:33:12 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rvesse&quot; class=&quot;user-hover&quot; rel=&quot;rvesse&quot;&gt;rvesse&lt;/a&gt;&#160;- yes!&lt;/p&gt;

&lt;p&gt;Maybe the use case is to make denied access invisible for query.&lt;/p&gt;

&lt;p&gt;This is what &lt;tt&gt;jena-fuseki-access&lt;/tt&gt;&#160;does (graph level access control only). It presents a view of the data, rather than deny access.&lt;/p&gt;

&lt;p&gt;Something for &lt;tt&gt;jena-permissions&lt;/tt&gt;&#160;to consider. Fuseki can&apos;t create that the &quot;permissions-view&quot; effect over the basic &quot;permissions-deny&quot; mechanism.&lt;/p&gt;</comment>
                            <comment id="17292906" author="claudenw" created="Mon, 1 Mar 2021 14:21:49 +0000"  >&lt;p&gt;I have two items to bring up here:&lt;/p&gt;

&lt;p&gt;&lt;b&gt;One &#8211; The record code for OperationDeniedException&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;I think there is a problem with the original solution.&#160; If the problem is that authentication is required the system returns a 403 (forbidden) rather than a 401 (unauthorized).&#160; The issue in in the patch at the line that reads:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; ( ex.getCause() != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; &amp;amp;&amp;amp; ex.getCause() &lt;span class=&quot;code-keyword&quot;&gt;instanceof&lt;/span&gt; OperationDeniedException )&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The code that follows should distinguish between the AccessDenied and the AuthenticationRequired exceptions.&#160; I think that CannotCreate should proibably go with AccessDenied.&lt;/p&gt;

&lt;p&gt;&lt;b&gt;Two &#8211; The permissions issue in UNION&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;The work around for this problem&#160; is to modify the SecurityEvaluator.&lt;/p&gt;

&lt;p&gt;Background:&lt;/p&gt;

&lt;p&gt;The system verifies that the user has access to the graph, if not it throws the ReadDeniedException.&#160; However, if the user has access to the graph then the system will look at each triple and verify access.&#160; So if the SecurityEvaluator returns true for graph access and then false for every triple the system will work.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;The solution is probably to change the find() methods so that hey call canRead() rather than checkRead() and if canRead() returns false then return an empty iterator..&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17292918" author="infoplp" created="Mon, 1 Mar 2021 14:38:15 +0000"  >&lt;p&gt;About the 2nd problem (UNION), ok, i can create an issue for jena-permission.&lt;/p&gt;

&lt;p&gt;About the 1st problem, it is true that the common parent of all exceptions is AccessDeniedException and that OperationDeniedException is probably too generic as it includes also AuthenticationRequiredException which has nothing to do with our case.&lt;/p&gt;</comment>
                            <comment id="17292935" author="andy.seaborne" created="Mon, 1 Mar 2021 15:02:15 +0000"  >&lt;p&gt;oaj.shared.AuthenticationRequiredException is never thrown in jena code so 401&#160;&lt;/p&gt;

&lt;p&gt;Isn&apos;t 401 properly handled before the execution starts? Normally, that&apos;s in the servlet filter stack&#160;for request-based security and is part of HTTP request handling.&lt;/p&gt;

&lt;p&gt;If you want the right HTTP response, it&apos;ll need executing the whole query then sending the result which is doable but not what happens at the moment. It is better pushed into the permission machinery somehow or it impacts everyone.&lt;/p&gt;

&lt;p&gt;The UNION problem is oen case where the query does work work, then touches another graph. Even&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;It doesn&apos;t look like the&#160;SecuredQueryEngine is used.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="13020841" name="0001-handle-properly-the-denied-access-generated-by-jena.patch" size="2939" author="infoplp" created="Mon, 22 Feb 2021 02:33:54 +0000"/>
                            <attachment id="13021325" name="ShiroEvaluator.java" size="2621" author="infoplp" created="Sun, 28 Feb 2021 06:42:47 +0000"/>
                            <attachment id="13021326" name="localData.ttl" size="1981" author="infoplp" created="Sun, 28 Feb 2021 06:42:47 +0000"/>
                            <attachment id="13021324" name="pom.xml" size="3319" author="infoplp" created="Sun, 28 Feb 2021 06:42:47 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310250" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10430"><![CDATA[Patch]]></customfieldvalue>
    <customfieldvalue key="10431"><![CDATA[Important]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 36 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0nw0g:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>