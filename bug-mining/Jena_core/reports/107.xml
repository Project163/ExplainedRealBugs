<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 19:57:55 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[JENA-1370] Exponent values </title>
                <link>https://issues.apache.org/jira/browse/JENA-1370</link>
                <project id="12311220" key="JENA">Apache Jena</project>
                    <description>&lt;p&gt;The equality between float values appears to be not working as I expected.&lt;br/&gt;
Example code: &lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;  @Test
  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void testDeltaSimple() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {
    Graph oldGraph = GraphFactory.createGraphMem();
    Graph newGraph = GraphFactory.createGraphMem();

    &lt;span class=&quot;code-comment&quot;&gt;// oldGraph:
&lt;/span&gt;    &lt;span class=&quot;code-comment&quot;&gt;// &amp;lt;http://example.com/subject&amp;gt; &amp;lt;http://example.com/property&amp;gt; -1.700000e+00 ;
&lt;/span&gt;    &lt;span class=&quot;code-comment&quot;&gt;// newGraph: 
&lt;/span&gt;    &lt;span class=&quot;code-comment&quot;&gt;// &amp;lt;http://example.com/subject&amp;gt; &amp;lt;http://example.com/property&amp;gt; -1.7E0 ;
&lt;/span&gt;    RDFDataMgr.read(oldGraph, &lt;span class=&quot;code-quote&quot;&gt;&quot;oldGraph.ttl&quot;&lt;/span&gt;);
    RDFDataMgr.read(newGraph, &lt;span class=&quot;code-quote&quot;&gt;&quot;newGraph.ttl&quot;&lt;/span&gt;);


    Delta delta = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Delta(oldGraph);
    delta.clear();
    GraphUtil.addInto(delta, newGraph);
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!delta.isIsomorphicWith(oldGraph)) {
      &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.err.println(&lt;span class=&quot;code-quote&quot;&gt;&quot;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++&quot;&lt;/span&gt;);
      RDFDataMgr.write(&lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.err, delta.getAdditions(), Lang.TURTLE);
      &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.err.println(&lt;span class=&quot;code-quote&quot;&gt;&quot;-------------------------------------------------------------------------------------&quot;&lt;/span&gt;);
      RDFDataMgr.write(&lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.err, delta.getDeletions(), Lang.TURTLE);
      fail(&lt;span class=&quot;code-quote&quot;&gt;&quot;!!!!!!!!!!!!!!!!!!!!!! RDF not equal&quot;&lt;/span&gt;);
    }
  }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Result:&lt;/p&gt;


&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
-------------------------------------------------------------------------------------
&amp;lt;http://example.com/subject&amp;gt;
        &amp;lt;http://example.com/property&amp;gt;  -1.700000e+00 .

java.lang.AssertionError: !!!!!!!!!!!!!!!!!!!!!! RDF not equal

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;If I start with an empty graph for oldGraph, the new double value is properly added.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Java 1.8, Ubuntu Linux (xenial)&lt;/p&gt;</environment>
        <key id="13084851">JENA-1370</key>
            <summary>Exponent values </summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="andy">Andy Seaborne</assignee>
                                    <reporter username="osmosisch">Daan Reid</reporter>
                        <labels>
                    </labels>
                <created>Wed, 5 Jul 2017 14:02:33 +0000</created>
                <updated>Fri, 21 Jul 2017 09:29:24 +0000</updated>
                            <resolved>Fri, 14 Jul 2017 17:20:45 +0000</resolved>
                                    <version>Jena 3.2.0</version>
                                    <fixVersion>Jena 3.4.0</fixVersion>
                                    <component>Jena</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="16076324" author="andy.seaborne" created="Thu, 6 Jul 2017 10:29:58 +0000"  >&lt;p&gt;See also &lt;a href=&quot;https://issues.apache.org/jira/browse/JENA-1303&quot; title=&quot;Starting 0 in XSDnonNegativeInteger is badly interpreted&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JENA-1303&quot;&gt;&lt;del&gt;JENA-1303&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;&quot;-1.700000e+00&quot;&amp;#94;&amp;#94;xsd:double&lt;/tt&gt; and &lt;tt&gt;&quot;-1.7E0&quot;&amp;#94;&amp;#94;xsd:double&lt;/tt&gt; are different RDF terms representing the same value.&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;isIsomorphicWith&lt;/tt&gt; compares by RDF term, not by values.&lt;/p&gt;

&lt;p&gt;A related example is a graph &lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;:s :p -1.700000e+00 .
:s :p -1.7E0 .
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;has two triples so has a different triple count to &lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;:s :p -1.7E0 .
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;There is a general, and slower (for large graphs), matcher in &lt;tt&gt;IsoMatcher&lt;/tt&gt;. You can take that code and provide &lt;tt&gt;NodeUtils.sameValue`&lt;/tt&gt;. Unfortunately, the necessary call is private in the current release but the code is open source.  It will be public in 3.4.0.&lt;/p&gt;

&lt;p&gt;Where value comparison is important, canonicalising the terms on input gives consistent behaviour. &lt;tt&gt;RDFParser&lt;/tt&gt; has the ability to add a &quot;canonicalize literals&quot; step.&lt;/p&gt;</comment>
                            <comment id="16077751" author="osmosisch" created="Fri, 7 Jul 2017 07:41:17 +0000"  >&lt;p&gt;Hi Andy, thank you for the response.&lt;/p&gt;

&lt;p&gt;I have several followup questions if you don&apos;t mind.&lt;/p&gt;

&lt;p&gt;My issue was not so much with the isomorphism as with the `Delta` - if the two triples are not seen as equal I would expect an addition as well as a a deletion in the resulting delta. Instead, there is only a deletion, meaning that the resulting graph into which I&apos;ve added the `newGraph.ttl`  content has zero triples in it in the end. So there&apos;s some inconsistency in the Delta class it seems.&lt;br/&gt;
Is it possible to influence this Delta behaviour somehow?&lt;/p&gt;

&lt;p&gt;Thanks!&lt;/p&gt;</comment>
                            <comment id="16078294" author="andy.seaborne" created="Fri, 7 Jul 2017 16:04:42 +0000"  >&lt;p&gt;Hi Daan, You may get on better asking on users@jena to reach a wider audience.&lt;/p&gt;

&lt;p&gt;Checking, it looks like Delta use a &quot;contains&quot; check which is value sensitive for memory graphs.&lt;/p&gt;

&lt;p&gt;But not all graphs - &lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;        Graph oldGraph = DatasetGraphFactory.createTxnMem().getDefaultGraph();
        Graph newGraph = DatasetGraphFactory.createTxnMem().getDefaultGraph();
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;There is a certain amount of inconsistency arising from competing requirements.  Value processing &lt;em&gt;and&lt;/em&gt; also preserving the original form, which amounts to having triple counts reflect terms, leads to an over-constrained design space.  I&apos;m not sure what the right answer is.&lt;/p&gt;</comment>
                            <comment id="16078354" author="osmosisch" created="Fri, 7 Jul 2017 16:32:11 +0000"  >&lt;p&gt;OK, I&apos;ll take it there. Thanks! &lt;/p&gt;</comment>
                            <comment id="16080052" author="osmosisch" created="Mon, 10 Jul 2017 09:16:40 +0000"  >&lt;p&gt;Several followup remarks (the users list seems to be quiet on this subject):&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;We use a TDB database. According to the &lt;a href=&quot;https://jena.apache.org/documentation/tdb/value_canonicalization.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;documentation&lt;/a&gt; `decimal` literals should be canonicalised. If this is extended to `double` values our problem would be solved. Would this be a good feature request or is there something about doubles that prevents canonicalisation?&lt;/li&gt;
	&lt;li&gt;The inconsistency is located in the fact that `GraphTripleStoreBase.contains()` checks by values, but `GraphTripleStoreBase.delete()` defers to `NodeToTriplesMapMem.remove()` which compares lexically. I believe this should be homogenised, or at least be made configurable.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="16080068" author="andy.seaborne" created="Mon, 10 Jul 2017 09:36:27 +0000"  >&lt;blockquote&gt;&lt;p&gt;he users list seems to be quiet on this subject&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;That was over a weekend. Your message to the users list was sent Friday at 21:29 +0200 (CEST). Now it is Monday morning.&lt;/p&gt;

&lt;p&gt;Re: TDB&lt;/p&gt;

&lt;p&gt;Doubles can not be canonicalized in TDB1 without a disk-format change, and hence having to reload data, and &lt;br/&gt;
because there are only 56 bits of space for the value.&lt;/p&gt;

&lt;p&gt;(In TDB2, not in the Jena release, the design allows for double canonicalized to 62 bits of precision. Whether that is an acceptable trade-off has yet to be decided.)&lt;/p&gt;</comment>
                            <comment id="16082518" author="osmosisch" created="Tue, 11 Jul 2017 17:01:53 +0000"  >&lt;p&gt;OK, that&apos;s clear. Apologies for acting impatient.&lt;/p&gt;</comment>
                            <comment id="16085876" author="githubbot" created="Thu, 13 Jul 2017 15:27:00 +0000"  >&lt;p&gt;GitHub user afs opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/jena/pull/270&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/jena/pull/270&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/JENA-1370&quot; title=&quot;Exponent values &quot; class=&quot;issue-link&quot; data-issue-key=&quot;JENA-1370&quot;&gt;&lt;del&gt;JENA-1370&lt;/del&gt;&lt;/a&gt;: Provide term-only GraphPlain. Use GraphPlain for Delta graph&lt;/p&gt;



&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/afs/jena&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/afs/jena&lt;/a&gt; plain-graph&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/jena/pull/270.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/jena/pull/270.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #270&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 54d74a723d5371d740c623aef52933d785b2492b&lt;br/&gt;
Author: Andy Seaborne &amp;lt;andy@apache.org&amp;gt;&lt;br/&gt;
Date:   2017-07-13T14:43:42Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/JENA-1370&quot; title=&quot;Exponent values &quot; class=&quot;issue-link&quot; data-issue-key=&quot;JENA-1370&quot;&gt;&lt;del&gt;JENA-1370&lt;/del&gt;&lt;/a&gt;: Provide term-only GraphPlain. Use GraphPlain for Delta graph&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="16087596" author="jira-bot" created="Fri, 14 Jul 2017 17:07:54 +0000"  >&lt;p&gt;Commit 54d74a723d5371d740c623aef52933d785b2492b in jena&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=andy.seaborne&quot; class=&quot;user-hover&quot; rel=&quot;andy.seaborne&quot;&gt;andy.seaborne&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=jena.git;h=54d74a7&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=jena.git;h=54d74a7&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/JENA-1370&quot; title=&quot;Exponent values &quot; class=&quot;issue-link&quot; data-issue-key=&quot;JENA-1370&quot;&gt;&lt;del&gt;JENA-1370&lt;/del&gt;&lt;/a&gt;: Provide term-only GraphPlain. Use GraphPlain for Delta graph&lt;/p&gt;</comment>
                            <comment id="16087598" author="jira-bot" created="Fri, 14 Jul 2017 17:07:56 +0000"  >&lt;p&gt;Commit e80f6fa4e3a1d3c9bc8ebc4a4710e6402024b0ee in jena&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=andy.seaborne&quot; class=&quot;user-hover&quot; rel=&quot;andy.seaborne&quot;&gt;andy.seaborne&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=jena.git;h=e80f6fa&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=jena.git;h=e80f6fa&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/JENA-1370&quot; title=&quot;Exponent values &quot; class=&quot;issue-link&quot; data-issue-key=&quot;JENA-1370&quot;&gt;&lt;del&gt;JENA-1370&lt;/del&gt;&lt;/a&gt;: Merge commit &apos;refs/pull/270/head&apos; of github.com:apache/jena&lt;/p&gt;

&lt;p&gt;This closes #270.&lt;/p&gt;</comment>
                            <comment id="16087599" author="githubbot" created="Fri, 14 Jul 2017 17:08:08 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/jena/pull/270&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/jena/pull/270&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16087620" author="andy.seaborne" created="Fri, 14 Jul 2017 17:20:28 +0000"  >&lt;p&gt;See tests &lt;tt&gt;TestDelta.testTerms*&lt;/tt&gt; for what is changed. &lt;tt&gt;Delta&lt;/tt&gt; works purely on term comparison via an adapter class &lt;tt&gt;PlainGraph&lt;/tt&gt;.&lt;/p&gt;</comment>
                            <comment id="16087644" author="osmosisch" created="Fri, 14 Jul 2017 17:29:48 +0000"  >&lt;p&gt;Great work! Thanks. I assume this&apos;ll be in 3.4.0? Looking forward to the release.&lt;/p&gt;</comment>
                            <comment id="16096019" author="andy.seaborne" created="Fri, 21 Jul 2017 09:29:24 +0000"  >&lt;p&gt;Closed on Jena 3.4.0 release.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 17 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3h4sf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>