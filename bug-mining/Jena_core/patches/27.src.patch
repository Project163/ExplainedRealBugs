diff --git a/jena-core/src/main/java/com/hp/hpl/jena/datatypes/xsd/XSDDatatype.java b/jena-core/src/main/java/com/hp/hpl/jena/datatypes/xsd/XSDDatatype.java
index 7b9a9e9d0e..c406d47925 100644
--- a/jena-core/src/main/java/com/hp/hpl/jena/datatypes/xsd/XSDDatatype.java
+++ b/jena-core/src/main/java/com/hp/hpl/jena/datatypes/xsd/XSDDatatype.java
@@ -519,9 +519,12 @@ public class XSDDatatype extends BaseDatatype {
     private XSTypeDefinition getFoundingType() {
         XSTypeDefinition founding = typeDeclaration;
         XSTypeDefinition parent = founding.getBaseType();
+        if ( parent == null )
+            // it is xsd:anySimpleType
+            return founding;
         while (parent.getBaseType() != null) {
             founding = parent;
-            parent = founding.getBaseType();
+            parent = parent.getBaseType();
         }
         return founding;
     }
diff --git a/jena-core/src/test/java/com/hp/hpl/jena/graph/test/TestTypedLiterals.java b/jena-core/src/test/java/com/hp/hpl/jena/graph/test/TestTypedLiterals.java
index 5e35816e29..3cad99f591 100644
--- a/jena-core/src/test/java/com/hp/hpl/jena/graph/test/TestTypedLiterals.java
+++ b/jena-core/src/test/java/com/hp/hpl/jena/graph/test/TestTypedLiterals.java
@@ -818,7 +818,20 @@ public class TestTypedLiterals extends TestCase {
        assertTrue( ! XSDDatatype.XSDfloat.isValidValue(new Integer("2")));
        assertTrue( ! XSDDatatype.XSDfloat.isValidValue(new Double("2.3")));
     }
+
+    // These should not be used in data but we test they don't crash anything.
+    public void testIsValidLiteral1()
+    {
+        Literal lit = m.createTypedLiteral("100", XSDDatatype.XSD+"#anyType") ;
+        assertFalse(XSDDatatype.XSDinteger.isValidLiteral(lit.asNode().getLiteral()));
+    }
+    public void testIsValidLiteral2()
+    {
+        Literal lit = m.createTypedLiteral("100", XSDDatatype.XSD+"#anySimpleType") ;
+        assertFalse(XSDDatatype.XSDinteger.isValidLiteral(lit.asNode().getLiteral()));
+    }
     
+
     private static byte[] data = new byte[]{12, 42, 99};
     
     /**
