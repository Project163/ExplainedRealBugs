diff --git a/jena-core/src/main/java/org/apache/jena/irix/IRIProviderJDK.java b/jena-core/src/main/java/org/apache/jena/irix/IRIProviderJDK.java
index 2fa8e327ae..c871ff2883 100644
--- a/jena-core/src/main/java/org/apache/jena/irix/IRIProviderJDK.java
+++ b/jena-core/src/main/java/org/apache/jena/irix/IRIProviderJDK.java
@@ -73,14 +73,17 @@ public class IRIProviderJDK implements IRIProvider {
             // Accept empty host for file:
             if ( javaURI.getScheme() == null )
                 return false;
-            if ( !javaURI.getScheme().equals("file") ) {
-                // file:/// is OK.
-                if ( javaURI.getHost() == null )
-                    return false;
-            }
             return true;
         }
 
+        @Override
+        public boolean hasScheme(String scheme) {
+            String iriScheme = javaURI.getScheme();
+            if ( iriScheme == null )
+                return false;
+            return iriScheme.startsWith(scheme);
+        }
+
         @Override
         public IRIx resolve(String other) {
             return exec(()->{
diff --git a/jena-core/src/main/java/org/apache/jena/irix/IRIProviderJenaIRI.java b/jena-core/src/main/java/org/apache/jena/irix/IRIProviderJenaIRI.java
index c045077538..0f4a93db9d 100644
--- a/jena-core/src/main/java/org/apache/jena/irix/IRIProviderJenaIRI.java
+++ b/jena-core/src/main/java/org/apache/jena/irix/IRIProviderJenaIRI.java
@@ -29,9 +29,10 @@ import org.apache.jena.iri.impl.PatternCompiler;
  */
 public class IRIProviderJenaIRI implements IRIProvider {
 
-    // jena-iri.IRI.create is silent.
-    // jena-iri.IRI.construct throws errors.
-    // jena-iri.IRI.resolve is the same as create
+    // Notes:
+    // jena-iri:IRI.create is silent.
+    // jena-iri:IRI.construct throws errors.
+    // jena-iri:IRI.resolve is the same as create
 
     public IRIProviderJenaIRI() { }
 
@@ -57,12 +58,20 @@ public class IRIProviderJenaIRI implements IRIProvider {
         public boolean isReference() {
             if ( jenaIRI.isRootless() )
                 return true;
+
             // isHierarchical.
-            return jenaIRI.getScheme() != null && jenaIRI.getRawHost() != null;
+            return jenaIRI.getScheme() != null;
                     // Unnecessary There is always a path even if it's "".
                     /* && iri.getRawPath() != null*/
         }
 
+        @Override
+        public boolean hasScheme(String scheme) {
+            if ( jenaIRI.getScheme() == null )
+                return false;
+            return jenaIRI.getScheme().startsWith(scheme);
+        }
+
         @Override
         public IRIx resolve(String other) {
             IRI iri2 = jenaIRI.resolve(other);
@@ -189,7 +198,6 @@ public class IRIProviderJenaIRI implements IRIProvider {
 
     private static final IRIFactory iriFactoryInst = new IRIFactory();
     static {
-        // These two are from IRIFactory.iriImplementation() ...
         iriFactoryInst.useSpecificationIRI(true);
         iriFactoryInst.useSchemeSpecificRules("*", true);
 
@@ -208,7 +216,6 @@ public class IRIProviderJenaIRI implements IRIProvider {
         setErrorWarning(iriFactoryInst, ViolationCodes.UNREGISTERED_IANA_SCHEME, false, false);
         setErrorWarning(iriFactoryInst, ViolationCodes.NON_INITIAL_DOT_SEGMENT, false, false);
 
-        // Warnings.
         setErrorWarning(iriFactoryInst, ViolationCodes.LOWERCASE_PREFERRED, false, true);
         setErrorWarning(iriFactoryInst, ViolationCodes.REQUIRED_COMPONENT_MISSING, true, true);
 
diff --git a/jena-core/src/main/java/org/apache/jena/irix/IRIx.java b/jena-core/src/main/java/org/apache/jena/irix/IRIx.java
index ecec4e3182..f81a4e8413 100644
--- a/jena-core/src/main/java/org/apache/jena/irix/IRIx.java
+++ b/jena-core/src/main/java/org/apache/jena/irix/IRIx.java
@@ -89,6 +89,13 @@ public abstract class IRIx {
      */
     public abstract boolean isRelative();
 
+    /**
+     * Test whether the IRI has the given scheme name.
+     * <p>
+     * The scheme name should be lowercase.
+     */
+    public abstract boolean hasScheme(String scheme);
+
     /**
      * An <em>RDF Reference</em> is an URI which has scheme.
      * If it is hierarchical, it should a non-empty host authority,
diff --git a/jena-core/src/test/java/org/apache/jena/irix/TestIRIx.java b/jena-core/src/test/java/org/apache/jena/irix/TestIRIx.java
index d7fab7eb00..4c855566f8 100644
--- a/jena-core/src/test/java/org/apache/jena/irix/TestIRIx.java
+++ b/jena-core/src/test/java/org/apache/jena/irix/TestIRIx.java
@@ -102,10 +102,6 @@ public class TestIRIx {
 
     @Test public void uri_06()      { test("http://1.2.3.4/abc"); }
 
-    @Test(expected=IRIException.class)
-    // Bad hex code: Breaks RFC 3986 grammar.
-    public void bad_01() { parse("http://h/ab%XXcd"); }
-
     // ---- Compliance with HTTP RFC7230. https://tools.ietf.org/html/rfc7230#section-2.7
     @Test(expected=IRIException.class)
     public void http_01() { parse("http:"); }
@@ -212,10 +208,22 @@ public class TestIRIx {
 
     @Test public void relative_http_08() { relative("http://example/dir1/dir2/path", "http://example/otherDir/abcd", null); }
 
+    @Test public void relative_http_09() { relative("http://example/path", "http://example/path", ""); }
+
+    @Test public void relative_http_10() { relative("http://example/path", "http://example/path#", "#"); }
+
     @Test public void relative_file_01() { relative("file:///dir/", "file:///dir/abcd", "abcd"); }
 
     @Test public void relative_file_02() { relative("file:///", "file:///dir/abcd", "dir/abcd"); }
 
+    // ---- Things expected.
+
+    @Test public void misc_01()     { reference("wm:/abc", true); }
+
+    @Test(expected=IRIException.class)
+    // Bad hex code: Breaks RFC 3986 grammar.
+    public void misc_02()           { parse("http://h/ab%XXcd"); }
+
     private void relative(String baseUriStr, String otherStr, String expected) {
         IRIx base = IRIx.create(baseUriStr);
         IRIx relInput = IRIx.create(otherStr);
@@ -230,6 +238,11 @@ public class TestIRIx {
     }
 
     // Create - is it suitable for an RDF reference?
+    private void reference(String uriStr) {
+        IRIx iri = IRIx.create(uriStr);
+        assertTrue("IRI = "+uriStr, iri.isReference());
+    }
+
     private void reference(String uriStr, boolean expected) {
         IRIx iri = IRIx.create(uriStr);
         assertEquals("IRI = "+uriStr, expected, iri.isReference());
