{"url":"https://api.github.com/repos/helix-editor/helix/issues/3090","repository_url":"https://api.github.com/repos/helix-editor/helix","labels_url":"https://api.github.com/repos/helix-editor/helix/issues/3090/labels{/name}","comments_url":"https://api.github.com/repos/helix-editor/helix/issues/3090/comments","events_url":"https://api.github.com/repos/helix-editor/helix/issues/3090/events","html_url":"https://github.com/helix-editor/helix/issues/3090","id":1307181141,"node_id":"I_kwDOD__WI85N6gBV","number":3090,"title":"Crash when switching to window that was in insert mode and switched away from by mouse.","user":{"login":"cessen","id":1579058,"node_id":"MDQ6VXNlcjE1NzkwNTg=","avatar_url":"https://avatars.githubusercontent.com/u/1579058?v=4","gravatar_id":"","url":"https://api.github.com/users/cessen","html_url":"https://github.com/cessen","followers_url":"https://api.github.com/users/cessen/followers","following_url":"https://api.github.com/users/cessen/following{/other_user}","gists_url":"https://api.github.com/users/cessen/gists{/gist_id}","starred_url":"https://api.github.com/users/cessen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cessen/subscriptions","organizations_url":"https://api.github.com/users/cessen/orgs","repos_url":"https://api.github.com/users/cessen/repos","events_url":"https://api.github.com/users/cessen/events{/privacy}","received_events_url":"https://api.github.com/users/cessen/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":2101491828,"node_id":"MDU6TGFiZWwyMTAxNDkxODI4","url":"https://api.github.com/repos/helix-editor/helix/labels/C-bug","name":"C-bug","color":"C5DEF5","default":false,"description":"Category: This is a bug"},{"id":3077942508,"node_id":"MDU6TGFiZWwzMDc3OTQyNTA4","url":"https://api.github.com/repos/helix-editor/helix/labels/A-helix-term","name":"A-helix-term","color":"FBCA04","default":false,"description":"Area: Helix term improvements"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":7,"created_at":"2022-07-17T18:52:27Z","updated_at":"2024-01-28T12:56:45Z","closed_at":"2022-08-23T05:08:41Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Summary\n\nIf you have two sub-windows open in Helix with different files, enter insert mode on one of them, switch to the other sub-window via mouse support, and then switch back to the first with keybindings, Helix crashes with the following backtrace:\r\n\r\n```\r\nthread 'main' panicked at 'not implemented', helix-term/src/ui/editor.rs:1292:34\r\nstack backtrace:\r\n   0: rust_begin_unwind\r\n             at /rustc/fe5b13d681f25ee6474be29d748c65adcd91f69e/library/std/src/panicking.rs:584:5\r\n   1: core::panicking::panic_fmt\r\n             at /rustc/fe5b13d681f25ee6474be29d748c65adcd91f69e/library/core/src/panicking.rs:143:14\r\n   2: core::panicking::panic\r\n             at /rustc/fe5b13d681f25ee6474be29d748c65adcd91f69e/library/core/src/panicking.rs:48:5\r\n   3: <helix_term::ui::editor::EditorView as helix_term::compositor::Component>::handle_event\r\n             at /home/cessen/Projects/helix/helix-term/src/ui/editor.rs:1292:34\r\n   4: helix_term::compositor::Compositor::handle_event\r\n             at /home/cessen/Projects/helix/helix-term/src/compositor.rs:147:19\r\n   5: helix_term::application::Application::handle_terminal_events\r\n             at /home/cessen/Projects/helix/helix-term/src/application.rs:387:32\r\n   6: helix_term::application::Application::event_loop::{{closure}}\r\n             at /home/cessen/Projects/helix/helix-term/src/application.rs:236:21\r\n   7: <core::future::from_generator::GenFuture<T> as core::future::future::Future>::poll\r\n             at /rustc/fe5b13d681f25ee6474be29d748c65adcd91f69e/library/core/src/future/mod.rs:91:19\r\n   8: helix_term::application::Application::run::{{closure}}\r\n             at /home/cessen/Projects/helix/helix-term/src/application.rs:758:26\r\n   9: <core::future::from_generator::GenFuture<T> as core::future::future::Future>::poll\r\n             at /rustc/fe5b13d681f25ee6474be29d748c65adcd91f69e/library/core/src/future/mod.rs:91:19\r\n  10: hx::main_impl::{{closure}}\r\n             at /home/cessen/Projects/helix/helix-term/src/main.rs:116:30\r\n  11: <core::future::from_generator::GenFuture<T> as core::future::future::Future>::poll\r\n             at /rustc/fe5b13d681f25ee6474be29d748c65adcd91f69e/library/core/src/future/mod.rs:91:19\r\n  12: tokio::park::thread::CachedParkThread::block_on::{{closure}}\r\n             at /home/cessen/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.19.2/src/park/thread.rs:263:54\r\n  13: tokio::coop::with_budget::{{closure}}\r\n             at /home/cessen/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.19.2/src/coop.rs:102:9\r\n  14: std::thread::local::LocalKey<T>::try_with\r\n             at /rustc/fe5b13d681f25ee6474be29d748c65adcd91f69e/library/std/src/thread/local.rs:442:16\r\n  15: std::thread::local::LocalKey<T>::with\r\n             at /rustc/fe5b13d681f25ee6474be29d748c65adcd91f69e/library/std/src/thread/local.rs:418:9\r\n  16: tokio::coop::with_budget\r\n             at /home/cessen/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.19.2/src/coop.rs:95:5\r\n  17: tokio::coop::budget\r\n             at /home/cessen/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.19.2/src/coop.rs:72:5\r\n  18: tokio::park::thread::CachedParkThread::block_on\r\n             at /home/cessen/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.19.2/src/park/thread.rs:263:31\r\n  19: tokio::runtime::enter::Enter::block_on\r\n             at /home/cessen/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.19.2/src/runtime/enter.rs:151:13\r\n  20: tokio::runtime::thread_pool::ThreadPool::block_on\r\n             at /home/cessen/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.19.2/src/runtime/thread_pool/mod.rs:90:9\r\n  21: tokio::runtime::Runtime::block_on\r\n             at /home/cessen/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.19.2/src/runtime/mod.rs:482:43\r\n  22: hx::main_impl\r\n             at /home/cessen/Projects/helix/helix-term/src/main.rs:118:5\r\n  23: hx::main\r\n             at /home/cessen/Projects/helix/helix-term/src/main.rs:35:21\r\n  24: core::ops::function::FnOnce::call_once\r\n             at /rustc/fe5b13d681f25ee6474be29d748c65adcd91f69e/library/core/src/ops/function.rs:227:5\r\nnote: Some details are omitted, run with `RUST_BACKTRACE=full` for a verbose backtrace.\r\n```\n\n### Reproduction Steps\n\nCausing the crash is easy and reliable:\r\n\r\n1. Open Helix.\r\n2. Split the view into two windows (e.g. `space w v`).\r\n3. Load a *different* file into each window.\r\n4. Enter insert mode (`i`) on the first window.\r\n5. Click on the second window with the mouse.\r\n6. Switch back to the first window with keybindings (e.g. space w w).\r\n\r\nNote: it's important that the files in each window be *different* files.  Loading the same file or having the scratch buffer in both doesn't cause the a crash.\n\n### Helix log\n\n_No response_\n\n### Platform\n\nLinux (NixOS 22.05)\n\n### Terminal Emulator\n\nxfce4-terminal\n\n### Helix Version\n\nDescovered on `helix 22.05 (27609f50)`, confirmed to still be present on latest master `ad15e7b5e8918e1521683c7f5c63d77e00c58023`","closed_by":{"login":"archseer","id":1372918,"node_id":"MDQ6VXNlcjEzNzI5MTg=","avatar_url":"https://avatars.githubusercontent.com/u/1372918?v=4","gravatar_id":"","url":"https://api.github.com/users/archseer","html_url":"https://github.com/archseer","followers_url":"https://api.github.com/users/archseer/followers","following_url":"https://api.github.com/users/archseer/following{/other_user}","gists_url":"https://api.github.com/users/archseer/gists{/gist_id}","starred_url":"https://api.github.com/users/archseer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/archseer/subscriptions","organizations_url":"https://api.github.com/users/archseer/orgs","repos_url":"https://api.github.com/users/archseer/repos","events_url":"https://api.github.com/users/archseer/events{/privacy}","received_events_url":"https://api.github.com/users/archseer/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/helix-editor/helix/issues/3090/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/helix-editor/helix/issues/3090/timeline","performed_via_github_app":null,"state_reason":"completed"}