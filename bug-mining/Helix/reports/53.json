{"url":"https://api.github.com/repos/helix-editor/helix/issues/12732","repository_url":"https://api.github.com/repos/helix-editor/helix","labels_url":"https://api.github.com/repos/helix-editor/helix/issues/12732/labels{/name}","comments_url":"https://api.github.com/repos/helix-editor/helix/issues/12732/comments","events_url":"https://api.github.com/repos/helix-editor/helix/issues/12732/events","html_url":"https://github.com/helix-editor/helix/issues/12732","id":2821273837,"node_id":"I_kwDOD__WI86oKTjt","number":12732,"title":"Goto definition fails if any language server responds unsuccessfully","user":{"login":"junglerobba","id":18437660,"node_id":"MDQ6VXNlcjE4NDM3NjYw","avatar_url":"https://avatars.githubusercontent.com/u/18437660?v=4","gravatar_id":"","url":"https://api.github.com/users/junglerobba","html_url":"https://github.com/junglerobba","followers_url":"https://api.github.com/users/junglerobba/followers","following_url":"https://api.github.com/users/junglerobba/following{/other_user}","gists_url":"https://api.github.com/users/junglerobba/gists{/gist_id}","starred_url":"https://api.github.com/users/junglerobba/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/junglerobba/subscriptions","organizations_url":"https://api.github.com/users/junglerobba/orgs","repos_url":"https://api.github.com/users/junglerobba/repos","events_url":"https://api.github.com/users/junglerobba/events{/privacy}","received_events_url":"https://api.github.com/users/junglerobba/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":2101491828,"node_id":"MDU6TGFiZWwyMTAxNDkxODI4","url":"https://api.github.com/repos/helix-editor/helix/labels/C-bug","name":"C-bug","color":"C5DEF5","default":false,"description":"Category: This is a bug"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2025-01-30T16:27:09Z","updated_at":"2025-05-20T10:32:38Z","closed_at":"2025-01-30T16:59:14Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Summary\n\nintroduced with f7394d53fda5af90c07e4833465b535e536eb16c\n\nThis might be a bug to report to the angular language server instead, but it could still be a general issue.\n\n\nMaybe invalid responses should be ignored here instead, since otherwise they will make valid responses from other servers fail as well? Or the angular language server might just be at fault, but this makes goto definition way more fragile if people have multiple servers configured where any of them might sometimes fail to respond.\n\n### Reproduction Steps\n\n - Install typescript-language-server and angular-language-server and configure them in helix:\n`languages.toml` (relevant part):\n```toml\n[[language]]\nname = \"typescript\"\nlanguage-servers = [\"typescript-language-server\", \"angular\", \"vscode-eslint-language-server\"]\n```\n - create any typescript file:\ne.g. `main.ts`\n```ts\nexport class Test {}\n\nconst test = new Test();\n```\n - move the cursor over Test on line 3 and goto definition\nResult:\n - helix will show the error `data did not match any variant of untagged enum GotoDefinitionResponse`\nExpected result:\n - the cursor should jump to `Test` in line 1\n\nThis is because the angular language server will respond to the request as well, but it responds with null:\n```\n2025-01-30T17:21:49.959 helix_lsp::transport [INFO] typescript-language-server -> {\"jsonrpc\":\"2.0\",\"method\":\"textDocument/definition\",\"params\":{\"position\":{\"character\":18,\"line\":2},\"textDocument\":{\"uri\":\"file:///Users/junglerobba/dev/angular-flake-demo/main.ts\"}},\"id\":35}\n2025-01-30T17:21:49.959 helix_lsp::transport [INFO] angular -> {\"jsonrpc\":\"2.0\",\"method\":\"textDocument/definition\",\"params\":{\"position\":{\"character\":18,\"line\":2},\"textDocument\":{\"uri\":\"file:///Users/junglerobba/dev/angular-flake-demo/main.ts\"}},\"id\":18}\n2025-01-30T17:21:49.959 helix_view::document [DEBUG] id 1 modified - last saved: 1, current: 1\n2025-01-30T17:21:49.961 helix_lsp::transport [INFO] angular <- {\"jsonrpc\":\"2.0\",\"id\":18,\"result\":null}\n2025-01-30T17:21:49.961 helix_lsp::transport [INFO] angular <- null\n2025-01-30T17:21:49.962 helix_lsp::transport [INFO] typescript-language-server <- {\"jsonrpc\":\"2.0\",\"id\":35,\"result\":[{\"uri\":\"file:///Users/junglerobba/dev/angular-flake-demo/main.ts\",\"range\":{\"start\":{\"line\":0,\"character\":13},\"end\":{\"line\":0,\"character\":17}}}]}\n2025-01-30T17:21:49.962 helix_lsp::transport [INFO] typescript-language-server <- [{\"range\":{\"end\":{\"character\":17,\"line\":0},\"start\":{\"character\":13,\"line\":0}},\"uri\":\"file:///Users/junglerobba/dev/angular-flake-demo/main.ts\"}]\n```\n\n### Helix log\n\n<details><summary>~/.cache/helix/helix.log</summary>\n\n```\nplease provide a copy of `~/.cache/helix/helix.log` here if possible, you may need to redact some of the lines\n```\n\n</details>\n\n\n### Platform\n\nmacOS\n\n### Terminal Emulator\n\nalacritty\n\n### Installation Method\n\nflake / source\n\n### Helix Version\n\nf7394d5","closed_by":{"login":"the-mikedavis","id":21230295,"node_id":"MDQ6VXNlcjIxMjMwMjk1","avatar_url":"https://avatars.githubusercontent.com/u/21230295?v=4","gravatar_id":"","url":"https://api.github.com/users/the-mikedavis","html_url":"https://github.com/the-mikedavis","followers_url":"https://api.github.com/users/the-mikedavis/followers","following_url":"https://api.github.com/users/the-mikedavis/following{/other_user}","gists_url":"https://api.github.com/users/the-mikedavis/gists{/gist_id}","starred_url":"https://api.github.com/users/the-mikedavis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/the-mikedavis/subscriptions","organizations_url":"https://api.github.com/users/the-mikedavis/orgs","repos_url":"https://api.github.com/users/the-mikedavis/repos","events_url":"https://api.github.com/users/the-mikedavis/events{/privacy}","received_events_url":"https://api.github.com/users/the-mikedavis/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/helix-editor/helix/issues/12732/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/helix-editor/helix/issues/12732/timeline","performed_via_github_app":null,"state_reason":"completed"}