<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:13:23 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[VALIDATOR-467] URL validator fails if path starts with double slash and has underscores</title>
                <link>https://issues.apache.org/jira/browse/VALIDATOR-467</link>
                <project id="12310494" key="VALIDATOR">Commons Validator</project>
                    <description>&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.commons.validator.routines.UrlValidator;
...
&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] schemes = {&lt;span class=&quot;code-quote&quot;&gt;&quot;http&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;https&quot;&lt;/span&gt;};
&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; UrlValidator urlValidator = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; UrlValidator(schemes,
        UrlValidator.ALLOW_LOCAL_URLS + UrlValidator.ALLOW_2_SLASHES);
...
urlValidator.isValid(&lt;span class=&quot;code-quote&quot;&gt;&quot;https:&lt;span class=&quot;code-comment&quot;&gt;//example.com//some_path/path/&quot;&lt;/span&gt;)&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This returns &lt;tt&gt;false&lt;/tt&gt;. However such URL is valid if authority is not &lt;tt&gt;null&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;The reason it returns &lt;tt&gt;false&lt;/tt&gt; is this code in the validator:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/commons-validator/blob/a3771313c9f1833abf32c7c294ad1de4810e532d/src/main/java/org/apache/commons/validator/routines/UrlValidator.java#L452-L461&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/commons-validator/blob/a3771313c9f1833abf32c7c294ad1de4810e532d/src/main/java/org/apache/commons/validator/routines/UrlValidator.java#L452-L461&lt;/a&gt;&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
        &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
            URI uri = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; URI(&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;,&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;,path,&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;);
            &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; norm = uri.normalize().getPath();
            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (norm.startsWith(&lt;span class=&quot;code-quote&quot;&gt;&quot;/../&quot;&lt;/span&gt;) &lt;span class=&quot;code-comment&quot;&gt;// Trying to go via the parent dir 
&lt;/span&gt;             || norm.equals(&lt;span class=&quot;code-quote&quot;&gt;&quot;/..&quot;&lt;/span&gt;)) {   &lt;span class=&quot;code-comment&quot;&gt;// Trying to go to the parent dir
&lt;/span&gt;                &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;;
            }
        } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (URISyntaxException e) {
            &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;;
        }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;As far as I understand &lt;tt&gt;URI uri = new URI(null,null,path,null);&lt;/tt&gt; throws &lt;tt&gt;URISyntaxException&lt;/tt&gt; if authority is &lt;tt&gt;null&lt;/tt&gt; and path starts with &lt;tt&gt;//&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;I tried running &lt;tt&gt;new URI(null, &quot;example.com&quot;, path, null);&lt;/tt&gt; and it worked.&lt;/p&gt;

&lt;p&gt;I didn&apos;t read RFC but from some googling around I got the following:&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;//some_path&lt;/tt&gt; is invalid if authority is null&lt;br/&gt;
&lt;tt&gt;//some_path&lt;/tt&gt; is valid if authority is not null&lt;/p&gt;

&lt;p&gt;&lt;b&gt;Update:&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;Another thing I noticed while testing is that the following actually passes the validation &#8211; &lt;tt&gt;&quot;https://example.com//test&quot;&lt;/tt&gt;&lt;br/&gt;
And that &lt;tt&gt;&quot;https://example.com//test_test&quot;&lt;/tt&gt; fails the validation but &lt;tt&gt;URISyntaxException&lt;/tt&gt; is thrown due to &lt;tt&gt;Illegal character in hostname&lt;/tt&gt; and not due to &lt;tt&gt;//&lt;/tt&gt; at the start.&lt;/p&gt;

&lt;p&gt;So my original theory behind the failure looks incorrect now, however I still consider this bug as a valid one.&lt;/p&gt;

&lt;p&gt;I guess better description would be &quot;URL validator incorrectly uses URI uri = new URI(null,null,path,null); check. Due to these nulls in arguments path is validated as a hostname&quot;.&lt;br/&gt;
And the simplest URL to test is &lt;tt&gt;&lt;a href=&quot;https://example.com//test_double_slash_and_underscore&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://example.com//test_double_slash_and_underscore&lt;/a&gt;&lt;/tt&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13307819">VALIDATOR-467</key>
            <summary>URL validator fails if path starts with double slash and has underscores</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="ilarionov">Ivan Larionov</reporter>
                        <labels>
                    </labels>
                <created>Wed, 27 May 2020 18:19:31 +0000</created>
                <updated>Sat, 8 Aug 2020 11:55:51 +0000</updated>
                            <resolved>Fri, 19 Jun 2020 21:09:10 +0000</resolved>
                                    <version>1.6</version>
                                    <fixVersion>1.7</fixVersion>
                                    <component>Routines</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="17140833" author="sebb@apache.org" created="Fri, 19 Jun 2020 21:09:10 +0000"  >&lt;p&gt;Good catch&lt;/p&gt;

&lt;p&gt;Fixed with &lt;font color=&quot;#222222&quot;&gt;e9bda17e9a27e4e8d1b951854baf83&lt;/font&gt;&lt;font color=&quot;#222222&quot;&gt;8f0075619f&lt;/font&gt;&lt;/p&gt;</comment>
                            <comment id="17166648" author="ilarionov" created="Tue, 28 Jul 2020 19:18:19 +0000"  >&lt;p&gt;This bug was a huge blocker for us. I&apos;m glad it was fixed pretty fast, but are there any plans for a new release of &lt;tt&gt;commons-validator&lt;/tt&gt;?&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="13103758">VALIDATOR-429</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 15 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0f8dk:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>