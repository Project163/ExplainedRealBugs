{"url":"https://api.github.com/repos/playframework/playframework/issues/8108","repository_url":"https://api.github.com/repos/playframework/playframework","labels_url":"https://api.github.com/repos/playframework/playframework/issues/8108/labels{/name}","comments_url":"https://api.github.com/repos/playframework/playframework/issues/8108/comments","events_url":"https://api.github.com/repos/playframework/playframework/issues/8108/events","html_url":"https://github.com/playframework/playframework/issues/8108","id":283349976,"node_id":"MDU6SXNzdWUyODMzNDk5NzY=","number":8108,"title":"[2.5.x, 2.6.x] AbstractCorsPolicy does not correctly check Origin header for the sake of ServeForbiddenOrigins","user":{"login":"eliothxchan","id":6380199,"node_id":"MDQ6VXNlcjYzODAxOTk=","avatar_url":"https://avatars.githubusercontent.com/u/6380199?v=4","gravatar_id":"","url":"https://api.github.com/users/eliothxchan","html_url":"https://github.com/eliothxchan","followers_url":"https://api.github.com/users/eliothxchan/followers","following_url":"https://api.github.com/users/eliothxchan/following{/other_user}","gists_url":"https://api.github.com/users/eliothxchan/gists{/gist_id}","starred_url":"https://api.github.com/users/eliothxchan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eliothxchan/subscriptions","organizations_url":"https://api.github.com/users/eliothxchan/orgs","repos_url":"https://api.github.com/users/eliothxchan/repos","events_url":"https://api.github.com/users/eliothxchan/events{/privacy}","received_events_url":"https://api.github.com/users/eliothxchan/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":6,"created_at":"2017-12-19T19:53:17Z","updated_at":"2018-05-01T17:21:22Z","closed_at":"2018-01-03T22:33:40Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Play Version (2.5.x)\r\n\r\n### API (Scala)\r\n\r\n### Operating System (MacOS 10.12.6)\r\n\r\n### JDK\r\n\r\nJava(TM) SE Runtime Environment (build 1.8.0_151-b12)\r\nJava HotSpot(TM) 64-Bit Server VM (build 25.151-b12, mixed mode)\r\n\r\n### Notes\r\n\r\nHi all. Not a super experienced developer here, but I've been trying to get some CORS stuff working on Play 2.5.18 and it's not looking like it's supposed to. So I took a lot at AbstractCorsPolicy. On lines 50-53 there's the following comment within the case where the Origin header is empty or malformed (`case (Some(originHeader), _) if originHeader.isEmpty || !isValidOrigin(originHeader) =>`):\r\n\r\n>If the value of the Origin header is not a case-sensitive match for any of the values in list of origins, do not set any additional headers and terminate this set of steps.\r\n\r\nHowever, given how serveForbiddenOrigins is described, should there not also be a check if the given header is not present in the `allowedOrigins` list? `isValidOrigin(originHeader)` only checks for the construction of the URI, and doesn't take a look at the `allowedOrigins` list whatsoever.\r\n\r\nIn the Play docs, the serveForbiddenOrigins flag is described as such:\r\n\r\n>enable/disable serving requests with origins not in whitelist as non-CORS requests (by default they are forbidden)\r\n\r\nBut in the actual functionality, it's simply allowing empty or malformed Origins to be served as non-CORS requests, rather than serving any non-whitelisted Origins as non-CORS requests.\r\n\r\nPlease let me know if I'm missing something obvious here.\r\n\r\nThanks,\r\nEliot","closed_by":{"login":"gmethvin","id":171663,"node_id":"MDQ6VXNlcjE3MTY2Mw==","avatar_url":"https://avatars.githubusercontent.com/u/171663?v=4","gravatar_id":"","url":"https://api.github.com/users/gmethvin","html_url":"https://github.com/gmethvin","followers_url":"https://api.github.com/users/gmethvin/followers","following_url":"https://api.github.com/users/gmethvin/following{/other_user}","gists_url":"https://api.github.com/users/gmethvin/gists{/gist_id}","starred_url":"https://api.github.com/users/gmethvin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gmethvin/subscriptions","organizations_url":"https://api.github.com/users/gmethvin/orgs","repos_url":"https://api.github.com/users/gmethvin/repos","events_url":"https://api.github.com/users/gmethvin/events{/privacy}","received_events_url":"https://api.github.com/users/gmethvin/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/playframework/playframework/issues/8108/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/playframework/playframework/issues/8108/timeline","performed_via_github_app":null,"state_reason":"completed"}