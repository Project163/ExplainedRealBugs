{"url":"https://api.github.com/repos/chalk/chalk/issues/585","repository_url":"https://api.github.com/repos/chalk/chalk","labels_url":"https://api.github.com/repos/chalk/chalk/issues/585/labels{/name}","comments_url":"https://api.github.com/repos/chalk/chalk/issues/585/comments","events_url":"https://api.github.com/repos/chalk/chalk/issues/585/events","html_url":"https://github.com/chalk/chalk/issues/585","id":1537916595,"node_id":"I_kwDOALTlW85bqr6z","number":585,"title":"add \"sideEffects\" field to package.json","user":{"login":"CEbbinghaus","id":31423391,"node_id":"MDQ6VXNlcjMxNDIzMzkx","avatar_url":"https://avatars.githubusercontent.com/u/31423391?v=4","gravatar_id":"","url":"https://api.github.com/users/CEbbinghaus","html_url":"https://github.com/CEbbinghaus","followers_url":"https://api.github.com/users/CEbbinghaus/followers","following_url":"https://api.github.com/users/CEbbinghaus/following{/other_user}","gists_url":"https://api.github.com/users/CEbbinghaus/gists{/gist_id}","starred_url":"https://api.github.com/users/CEbbinghaus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CEbbinghaus/subscriptions","organizations_url":"https://api.github.com/users/CEbbinghaus/orgs","repos_url":"https://api.github.com/users/CEbbinghaus/repos","events_url":"https://api.github.com/users/CEbbinghaus/events{/privacy}","received_events_url":"https://api.github.com/users/CEbbinghaus/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2023-01-18T12:25:37Z","updated_at":"2023-06-29T10:53:28Z","closed_at":"2023-06-29T10:53:28Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"So I have started having problems with chalk, especially in regard to bundling. I am in the unfortunate situation of having a nodejs runtime but no ability to add dependencies so I have been resorting to bundling my app with all dependencies within a single js file. Now because of how chalk handles its dependency on `supports-color` when it bundles chalk (erroneously), it also bundles the node version of `supports-color` which uses 2 **require** statements. Since none of the functions within the file importing chalk are used it seems that the reason chalk is being bundled at all is because it cannot be proven to be side effect free and therefore gets bundled whenever it is `import`ed regardless of it is used or not. \r\n\r\nThe simple solution is to add a `\"sideEffect\": false` property to the package.json which marks the entire package as side effect free and means that any import statements can be shaken out of the tree.\r\n\r\n","closed_by":{"login":"sindresorhus","id":170270,"node_id":"MDQ6VXNlcjE3MDI3MA==","avatar_url":"https://avatars.githubusercontent.com/u/170270?v=4","gravatar_id":"","url":"https://api.github.com/users/sindresorhus","html_url":"https://github.com/sindresorhus","followers_url":"https://api.github.com/users/sindresorhus/followers","following_url":"https://api.github.com/users/sindresorhus/following{/other_user}","gists_url":"https://api.github.com/users/sindresorhus/gists{/gist_id}","starred_url":"https://api.github.com/users/sindresorhus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sindresorhus/subscriptions","organizations_url":"https://api.github.com/users/sindresorhus/orgs","repos_url":"https://api.github.com/users/sindresorhus/repos","events_url":"https://api.github.com/users/sindresorhus/events{/privacy}","received_events_url":"https://api.github.com/users/sindresorhus/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/chalk/chalk/issues/585/reactions","total_count":6,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":6},"timeline_url":"https://api.github.com/repos/chalk/chalk/issues/585/timeline","performed_via_github_app":null,"state_reason":"completed"}