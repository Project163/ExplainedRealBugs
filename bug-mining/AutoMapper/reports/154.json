{"url":"https://api.github.com/repos/LuckyPennySoftware/AutoMapper/issues/1518","repository_url":"https://api.github.com/repos/LuckyPennySoftware/AutoMapper","labels_url":"https://api.github.com/repos/LuckyPennySoftware/AutoMapper/issues/1518/labels{/name}","comments_url":"https://api.github.com/repos/LuckyPennySoftware/AutoMapper/issues/1518/comments","events_url":"https://api.github.com/repos/LuckyPennySoftware/AutoMapper/issues/1518/events","html_url":"https://github.com/LuckyPennySoftware/AutoMapper/issues/1518","id":165352405,"node_id":"MDU6SXNzdWUxNjUzNTI0MDU=","number":1518,"title":"Index was outside the bounds of the array.","user":{"login":"niemyjski","id":1020579,"node_id":"MDQ6VXNlcjEwMjA1Nzk=","avatar_url":"https://avatars.githubusercontent.com/u/1020579?v=4","gravatar_id":"","url":"https://api.github.com/users/niemyjski","html_url":"https://github.com/niemyjski","followers_url":"https://api.github.com/users/niemyjski/followers","following_url":"https://api.github.com/users/niemyjski/following{/other_user}","gists_url":"https://api.github.com/users/niemyjski/gists{/gist_id}","starred_url":"https://api.github.com/users/niemyjski/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/niemyjski/subscriptions","organizations_url":"https://api.github.com/users/niemyjski/orgs","repos_url":"https://api.github.com/users/niemyjski/repos","events_url":"https://api.github.com/users/niemyjski/events{/privacy}","received_events_url":"https://api.github.com/users/niemyjski/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":92629237,"node_id":"MDU6TGFiZWw5MjYyOTIzNw==","url":"https://api.github.com/repos/LuckyPennySoftware/AutoMapper/labels/Bug","name":"Bug","color":"e11d21","default":false,"description":null}],"state":"closed","locked":true,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/LuckyPennySoftware/AutoMapper/milestones/21","html_url":"https://github.com/LuckyPennySoftware/AutoMapper/milestone/21","labels_url":"https://api.github.com/repos/LuckyPennySoftware/AutoMapper/milestones/21/labels","id":1851937,"node_id":"MDk6TWlsZXN0b25lMTg1MTkzNw==","number":21,"title":"5.1.0","description":"","creator":{"login":"jbogard","id":104498,"node_id":"MDQ6VXNlcjEwNDQ5OA==","avatar_url":"https://avatars.githubusercontent.com/u/104498?v=4","gravatar_id":"","url":"https://api.github.com/users/jbogard","html_url":"https://github.com/jbogard","followers_url":"https://api.github.com/users/jbogard/followers","following_url":"https://api.github.com/users/jbogard/following{/other_user}","gists_url":"https://api.github.com/users/jbogard/gists{/gist_id}","starred_url":"https://api.github.com/users/jbogard/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jbogard/subscriptions","organizations_url":"https://api.github.com/users/jbogard/orgs","repos_url":"https://api.github.com/users/jbogard/repos","events_url":"https://api.github.com/users/jbogard/events{/privacy}","received_events_url":"https://api.github.com/users/jbogard/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":57,"state":"closed","created_at":"2016-06-28T03:41:49Z","updated_at":"2016-08-12T16:22:05Z","due_on":null,"closed_at":"2016-08-12T16:22:05Z"},"comments":15,"created_at":"2016-07-13T15:36:36Z","updated_at":"2019-05-07T11:15:53Z","closed_at":"2016-07-13T21:17:22Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":"resolved","sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"I'm still investigating this issue but I wanted to log it and get the ball rolling...\n\n``` csharp\n            container.RegisterSingleton<IMapper>(() => {\n                var profiles = container.GetAllInstances<Profile>();\n                var config = new MapperConfiguration(cfg => {\n                    cfg.ConstructServicesUsing(container.GetInstance);\n\n                    foreach (var profile in profiles)\n                        cfg.AddProfile(profile);\n                }); // blows up here..\n                return config.CreateMapper();\n            });\n```\n\nI only have one mapping and this seems to be created okay..\n\n``` csharp\n\n        public class ApiMappings : Profile {\n            public ApiMappings() {\n                CreateMap<UserDescription, EventUserDescription>();\n\n                CreateMap<NewOrganization, Organization>();\n                CreateMap<Organization, ViewOrganization>().AfterMap((o, vo) => {\n                    vo.IsOverHourlyLimit = o.IsOverHourlyLimit();\n                    vo.IsOverMonthlyLimit = o.IsOverMonthlyLimit();\n                });\n\n                CreateMap<StripeInvoice, InvoiceGridModel>().AfterMap((si, igm) => igm.Id = igm.Id.Substring(3));\n\n                CreateMap<NewProject, Project>();\n                CreateMap<Project, ViewProject>();\n\n                CreateMap<NewToken, Token>().ForMember(m => m.Type, m => m.Ignore());\n                CreateMap<Token, ViewToken>();\n\n                CreateMap<User, ViewUser>();\n\n                CreateMap<NewWebHook, WebHook>();\n            }\n        }\n```\n\n```\nSystem.IndexOutOfRangeException occurred\n  HResult=-2146233080\n  Message=Index was outside the bounds of the array.\n  Source=AutoMapper\n  StackTrace:\n       at AutoMapper.Mappers.CollectionMapperExtensions.MapKeyPairValueExpr(TypeMapRegistry typeMapRegistry, IConfigurationProvider configurationProvider, PropertyMap propertyMap, Type sourceType, Type destType, ParameterExpression itemParam, Expression contextParam)\n  InnerException: \n```\n\n```\nAutoMapper.dll!AutoMapper.Mappers.CollectionMapperExtensions.MapKeyPairValueExpr(AutoMapper.TypeMapRegistry typeMapRegistry = {AutoMapper.TypeMapRegistry}, AutoMapper.IConfigurationProvider configurationProvider = {AutoMapper.MapperConfiguration}, AutoMapper.PropertyMap propertyMap = \"Data\", System.Type sourceType = {Name = \"DataDictionary\" FullName = \"Exceptionless.Core.Models.DataDictionary\"}, System.Type destType = {Name = \"DataDictionary\" FullName = \"Exceptionless.Core.Models.DataDictionary\"}, System.Linq.Expressions.ParameterExpression itemParam = {System.Linq.Expressions.TypedParameterExpression}, System.Linq.Expressions.Expression contextParam = {System.Linq.Expressions.TypedParameterExpression})    Unknown\n    AutoMapper.dll!AutoMapper.Mappers.CollectionMapperExtensions.MapCollectionExpression(AutoMapper.TypeMapRegistry typeMapRegistry = {AutoMapper.TypeMapRegistry}, AutoMapper.IConfigurationProvider configurationProvider = {AutoMapper.MapperConfiguration}, AutoMapper.PropertyMap propertyMap = \"Data\", System.Linq.Expressions.Expression sourceExpression = {System.Linq.Expressions.FullConditionalExpression}, System.Linq.Expressions.Expression destExpression = {System.Linq.Expressions.DefaultExpression}, System.Linq.Expressions.Expression contextExpression = {System.Linq.Expressions.TypedParameterExpression}, System.Func<System.Linq.Expressions.Expression, System.Linq.Expressions.Expression> conditionalExpression = {Method = {System.Reflection.RuntimeMethodInfo}}, System.Type ifInterfaceType = {Name = \"Dictionary`2\" FullName = \"System.Collections.Generic.Dictionary`2\"}, AutoMapper.Mappers.CollectionMapperExtensions.MapItem mapItem = {Method = {System.Reflection.RuntimeMethodInfo}}) Unknown\n    AutoMapper.dll!AutoMapper.Mappers.DictionaryMapper.MapExpression(AutoMapper.TypeMapRegistry typeMapRegistry = {AutoMapper.TypeMapRegistry}, AutoMapper.IConfigurationProvider configurationProvider = {AutoMapper.MapperConfiguration}, AutoMapper.PropertyMap propertyMap = \"Data\", System.Linq.Expressions.Expression sourceExpression = {System.Linq.Expressions.FullConditionalExpression}, System.Linq.Expressions.Expression destExpression = {System.Linq.Expressions.DefaultExpression}, System.Linq.Expressions.Expression contextExpression = {System.Linq.Expressions.TypedParameterExpression}) Unknown\n    AutoMapper.dll!AutoMapper.Execution.TypeMapPlanBuilder.CreatePropertyMapFunc(AutoMapper.PropertyMap propertyMap = \"Data\", AutoMapper.IConfigurationProvider configurationProvider = {AutoMapper.MapperConfiguration}, AutoMapper.TypeMapRegistry typeMapRegistry = {AutoMapper.TypeMapRegistry}, System.Linq.Expressions.ParameterExpression srcParam = {System.Linq.Expressions.TypedParameterExpression}, System.Linq.Expressions.ParameterExpression destParam = {System.Linq.Expressions.TypedParameterExpression}, System.Linq.Expressions.ParameterExpression ctxtParam = {System.Linq.Expressions.TypedParameterExpression}) Unknown\n    AutoMapper.dll!AutoMapper.Execution.TypeMapPlanBuilder.TryPropertyMap(AutoMapper.PropertyMap pm = \"Data\", AutoMapper.IConfigurationProvider configurationProvider = {AutoMapper.MapperConfiguration}, AutoMapper.TypeMapRegistry registry = {AutoMapper.TypeMapRegistry}, System.Linq.Expressions.ParameterExpression srcParam = {System.Linq.Expressions.TypedParameterExpression}, System.Linq.Expressions.ParameterExpression destParam = {System.Linq.Expressions.TypedParameterExpression}, System.Linq.Expressions.ParameterExpression ctxtParam = {System.Linq.Expressions.TypedParameterExpression})    Unknown\n    AutoMapper.dll!AutoMapper.Execution.TypeMapPlanBuilder.CreateAssignmentFunc(AutoMapper.TypeMap typeMap = \"UserDescription\" -> \"EventUserDescription\", AutoMapper.IConfigurationProvider configurationProvider = {AutoMapper.MapperConfiguration}, AutoMapper.TypeMapRegistry registry = {AutoMapper.TypeMapRegistry}, System.Linq.Expressions.ParameterExpression srcParam = {System.Linq.Expressions.TypedParameterExpression}, System.Linq.Expressions.ParameterExpression destParam = {System.Linq.Expressions.TypedParameterExpression}, System.Linq.Expressions.ParameterExpression ctxtParam = {System.Linq.Expressions.TypedParameterExpression}, System.Linq.Expressions.Expression destinationFunc = {System.Linq.Expressions.AssignBinaryExpression}, System.Linq.Expressions.ParameterExpression destination = {System.Linq.Expressions.TypedParameterExpression}, bool constructorMapping = false)  Unknown\n    AutoMapper.dll!AutoMapper.Execution.TypeMapPlanBuilder.BuildMapperFunc(AutoMapper.TypeMap typeMap = \"UserDescription\" -> \"EventUserDescription\", AutoMapper.IConfigurationProvider configurationProvider = {AutoMapper.MapperConfiguration}, AutoMapper.TypeMapRegistry typeMapRegistry = {AutoMapper.TypeMapRegistry}) Unknown\n    AutoMapper.dll!AutoMapper.TypeMap.Seal(AutoMapper.TypeMapRegistry typeMapRegistry = {AutoMapper.TypeMapRegistry}, AutoMapper.IConfigurationProvider configurationProvider = {AutoMapper.MapperConfiguration})   Unknown\n    AutoMapper.dll!AutoMapper.MapperConfiguration.Seal(AutoMapper.IConfiguration configuration = {AutoMapper.Configuration.MapperConfigurationExpression})  Unknown\n    AutoMapper.dll!AutoMapper.MapperConfiguration.MapperConfiguration(AutoMapper.Configuration.MapperConfigurationExpression configurationExpression = {AutoMapper.Configuration.MapperConfigurationExpression}, System.Collections.Generic.IEnumerable<AutoMapper.IObjectMapper> mappers = Count = 26) Unknown\n    AutoMapper.dll!AutoMapper.MapperConfiguration.MapperConfiguration(System.Action<AutoMapper.IMapperConfigurationExpression> configure = {Method = {System.Reflection.RuntimeMethodInfo}}, System.Collections.Generic.IEnumerable<AutoMapper.IObjectMapper> mappers = Count = 26) Unknown\n    AutoMapper.dll!AutoMapper.MapperConfiguration.MapperConfiguration(System.Action<AutoMapper.IMapperConfigurationExpression> configure = {Method = {System.Reflection.RuntimeMethodInfo}})    Unknown\n```\n","closed_by":{"login":"jbogard","id":104498,"node_id":"MDQ6VXNlcjEwNDQ5OA==","avatar_url":"https://avatars.githubusercontent.com/u/104498?v=4","gravatar_id":"","url":"https://api.github.com/users/jbogard","html_url":"https://github.com/jbogard","followers_url":"https://api.github.com/users/jbogard/followers","following_url":"https://api.github.com/users/jbogard/following{/other_user}","gists_url":"https://api.github.com/users/jbogard/gists{/gist_id}","starred_url":"https://api.github.com/users/jbogard/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jbogard/subscriptions","organizations_url":"https://api.github.com/users/jbogard/orgs","repos_url":"https://api.github.com/users/jbogard/repos","events_url":"https://api.github.com/users/jbogard/events{/privacy}","received_events_url":"https://api.github.com/users/jbogard/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/LuckyPennySoftware/AutoMapper/issues/1518/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/LuckyPennySoftware/AutoMapper/issues/1518/timeline","performed_via_github_app":null,"state_reason":"completed"}