{"url":"https://api.github.com/repos/LuckyPennySoftware/AutoMapper/issues/557","repository_url":"https://api.github.com/repos/LuckyPennySoftware/AutoMapper","labels_url":"https://api.github.com/repos/LuckyPennySoftware/AutoMapper/issues/557/labels{/name}","comments_url":"https://api.github.com/repos/LuckyPennySoftware/AutoMapper/issues/557/comments","events_url":"https://api.github.com/repos/LuckyPennySoftware/AutoMapper/issues/557/events","html_url":"https://github.com/LuckyPennySoftware/AutoMapper/issues/557","id":37655770,"node_id":"MDU6SXNzdWUzNzY1NTc3MA==","number":557,"title":"Behaviour changed in 3.2.1, DestinationValue not null when no Destination object passed","user":{"login":"wwwlicious","id":908801,"node_id":"MDQ6VXNlcjkwODgwMQ==","avatar_url":"https://avatars.githubusercontent.com/u/908801?v=4","gravatar_id":"","url":"https://api.github.com/users/wwwlicious","html_url":"https://github.com/wwwlicious","followers_url":"https://api.github.com/users/wwwlicious/followers","following_url":"https://api.github.com/users/wwwlicious/following{/other_user}","gists_url":"https://api.github.com/users/wwwlicious/gists{/gist_id}","starred_url":"https://api.github.com/users/wwwlicious/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wwwlicious/subscriptions","organizations_url":"https://api.github.com/users/wwwlicious/orgs","repos_url":"https://api.github.com/users/wwwlicious/repos","events_url":"https://api.github.com/users/wwwlicious/events{/privacy}","received_events_url":"https://api.github.com/users/wwwlicious/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":92629237,"node_id":"MDU6TGFiZWw5MjYyOTIzNw==","url":"https://api.github.com/repos/LuckyPennySoftware/AutoMapper/labels/Bug","name":"Bug","color":"e11d21","default":false,"description":null}],"state":"closed","locked":true,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/LuckyPennySoftware/AutoMapper/milestones/11","html_url":"https://github.com/LuckyPennySoftware/AutoMapper/milestone/11","labels_url":"https://api.github.com/repos/LuckyPennySoftware/AutoMapper/milestones/11/labels","id":900207,"node_id":"MDk6TWlsZXN0b25lOTAwMjA3","number":11,"title":"4.0.0","description":"New config model\r\nDeleting the Formatters completely\r\netc","creator":{"login":"jbogard","id":104498,"node_id":"MDQ6VXNlcjEwNDQ5OA==","avatar_url":"https://avatars.githubusercontent.com/u/104498?v=4","gravatar_id":"","url":"https://api.github.com/users/jbogard","html_url":"https://github.com/jbogard","followers_url":"https://api.github.com/users/jbogard/followers","following_url":"https://api.github.com/users/jbogard/following{/other_user}","gists_url":"https://api.github.com/users/jbogard/gists{/gist_id}","starred_url":"https://api.github.com/users/jbogard/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jbogard/subscriptions","organizations_url":"https://api.github.com/users/jbogard/orgs","repos_url":"https://api.github.com/users/jbogard/repos","events_url":"https://api.github.com/users/jbogard/events{/privacy}","received_events_url":"https://api.github.com/users/jbogard/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":77,"state":"closed","created_at":"2014-12-11T09:25:43Z","updated_at":"2015-08-05T18:25:13Z","due_on":null,"closed_at":"2015-08-05T18:25:13Z"},"comments":4,"created_at":"2014-07-11T12:27:55Z","updated_at":"2019-05-08T03:51:58Z","closed_at":"2015-07-20T01:40:10Z","author_association":"NONE","type":null,"active_lock_reason":"resolved","sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"The following ValueResolver worked in 3.1.1 but does not in 3.2.1.\n\nBelow is the code and our tests, they both used to pass, now only the second one passes. \n\nThe Context.DestinationValue in the resolver used to be null when no destination object was supplied to the mapping, now it is not null and defaulting to the int type default of 0.\n\nthe value resolver \n\n```\npublic class IgnoreExistingValueResolver : IValueResolver\n{\n    public ResolutionResult Resolve(ResolutionResult source)\n    {\n        // no previous object passed in, we should map\n        if (source.Context.DestinationValue != null)\n        {\n            source.ShouldIgnore = true;\n        }\n        return source;\n    }\n}\n```\n\nsample map\n\n```\nMapper.CreateMap<TestSource, TestDestination>().ForMember(\n            dest => dest.Id, opt => opt.ResolveUsing<IgnoreExistingValueResolver>().FromMember(src => src.Id));\n```\n\nThe tests\n\n```\n    [Fact]\n    public void CanMapInsertType()\n    {\n        var source = new TestSource { Id = 1 };\n        var insert = Mapper.Map<TestSource, TestDestination>(source);\n\n        Assert.NotNull(insert);\n        Assert.Equal(1, insert.Id);\n    }\n\n    [Fact]\n    public void CanMapUpdateType()\n    {\n        var source = new TestSource { Id = 2 };\n        var update = new TestDestination { Id = 1 };\n\n        Mapper.Map(source, update);\n\n        Assert.Equal(1, update.Id);\n    }\n```\n","closed_by":{"login":"jbogard","id":104498,"node_id":"MDQ6VXNlcjEwNDQ5OA==","avatar_url":"https://avatars.githubusercontent.com/u/104498?v=4","gravatar_id":"","url":"https://api.github.com/users/jbogard","html_url":"https://github.com/jbogard","followers_url":"https://api.github.com/users/jbogard/followers","following_url":"https://api.github.com/users/jbogard/following{/other_user}","gists_url":"https://api.github.com/users/jbogard/gists{/gist_id}","starred_url":"https://api.github.com/users/jbogard/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jbogard/subscriptions","organizations_url":"https://api.github.com/users/jbogard/orgs","repos_url":"https://api.github.com/users/jbogard/repos","events_url":"https://api.github.com/users/jbogard/events{/privacy}","received_events_url":"https://api.github.com/users/jbogard/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/LuckyPennySoftware/AutoMapper/issues/557/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/LuckyPennySoftware/AutoMapper/issues/557/timeline","performed_via_github_app":null,"state_reason":"completed"}