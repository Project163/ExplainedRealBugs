<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 18:32:54 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[JCRVLT-278] Root path ACEs removed due to JCRVLT-227 </title>
                <link>https://issues.apache.org/jira/browse/JCRVLT-278</link>
                <project id="12314920" key="JCRVLT">Jackrabbit FileVault</project>
                    <description>&lt;p&gt;With Apache SCD, we use FileVault for syncing content among instances.&lt;br/&gt;
We noticed that due to the change in &lt;a href=&quot;https://issues.apache.org/jira/browse/JCRVLT-227&quot; title=&quot;Import fail if user does not have access to the root path&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JCRVLT-227&quot;&gt;&lt;del&gt;JCRVLT-227&lt;/del&gt;&lt;/a&gt;, the root ACEs are removed upon sync.&lt;/p&gt;

&lt;p&gt;I created an IT test that covers the use case in &lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/tmaret/jackrabbit-filevault/tree/JCRVLT-278&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/tmaret/jackrabbit-filevault/tree/JCRVLT-278&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;The test passes in a jackrabbit-filevault code base anterior to &lt;a href=&quot;https://issues.apache.org/jira/browse/JCRVLT-227&quot; title=&quot;Import fail if user does not have access to the root path&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JCRVLT-227&quot;&gt;&lt;del&gt;JCRVLT-227&lt;/del&gt;&lt;/a&gt; and fails in a jackrabbit-filevault code base that contains &lt;a href=&quot;https://issues.apache.org/jira/browse/JCRVLT-227&quot; title=&quot;Import fail if user does not have access to the root path&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JCRVLT-227&quot;&gt;&lt;del&gt;JCRVLT-227&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13140424">JCRVLT-278</key>
            <summary>Root path ACEs removed due to JCRVLT-227 </summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="8">Not A Problem</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="marett">Timothee Maret</reporter>
                        <labels>
                    </labels>
                <created>Fri, 23 Feb 2018 08:19:14 +0000</created>
                <updated>Wed, 25 Jul 2018 07:01:15 +0000</updated>
                            <resolved>Mon, 26 Feb 2018 09:02:01 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="16375192" author="tripod" created="Sat, 24 Feb 2018 01:15:46 +0000"  >&lt;p&gt;I think the problem is rather, that before the root node wasn&apos;t exported at all. but now it is included. you should remove the &lt;br/&gt;
properties filter on &apos;/&apos; in your test.&lt;/p&gt;</comment>
                            <comment id="16375472" author="marett" created="Sat, 24 Feb 2018 10:28:04 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tripod&quot; class=&quot;user-hover&quot; rel=&quot;tripod&quot;&gt;tripod&lt;/a&gt; for looking at this! I have removed the properties filter on &lt;tt&gt;/&lt;/tt&gt; in the test and pushed in the same branch. The test outcome remains the same though.&lt;br/&gt;
Do I understand correctly that the current behaviour (exported root) is expected ? If so, we could change our ACL handling to merge ACLs.&lt;/p&gt;</comment>
                            <comment id="16376348" author="tripod" created="Mon, 26 Feb 2018 02:55:21 +0000"  >&lt;p&gt;I looked at the test. even with exporting/importing with an admin session, the test fails. it doesn&apos;t create the user node due to:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;[main] ERROR org.apache.jackrabbit.vault.fs.io.Importer - E /home/users/N/Ny/NySLfDXR9t8LaRxZi6-zs/rep:policy (java.lang.IllegalStateException: Parent node not found.)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;looking at the package filter:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;&amp;lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&amp;gt;
&amp;lt;workspaceFilter version=&quot;1.0&quot;&amp;gt;
    &amp;lt;filter root=&quot;/home/users/N/Ny/NySLfDXR9t8LaRxZi6-zs&quot;&amp;gt;
        &amp;lt;include pattern=&quot;/home/users/N/Ny/NySLfDXR9t8LaRxZi6-zs&quot;/&amp;gt;
    &amp;lt;/filter&amp;gt;
    &amp;lt;filter root=&quot;/home/users/N/Ny/NySLfDXR9t8LaRxZi6-zs/profile&quot;&amp;gt;
        &amp;lt;include pattern=&quot;/home/users/N/Ny/NySLfDXR9t8LaRxZi6-zs/profile&quot;/&amp;gt;
    &amp;lt;/filter&amp;gt;
    &amp;lt;filter root=&quot;/home/users/N/Ny/NySLfDXR9t8LaRxZi6-zs/rep:policy&quot;/&amp;gt;
&amp;lt;/workspaceFilter&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;it seems that it tries to import the ACL before the user node is created.&lt;br/&gt;
looking at the generated package, it seems that the user node is not properly exported, even with the admin session it does not contain the correct nodetype or properties.&lt;/p&gt;

&lt;p&gt;using a very simple filter, like:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;&amp;lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&amp;gt;
&amp;lt;workspaceFilter version=&quot;1.0&quot;&amp;gt;
    &amp;lt;filter root=&quot;/home/users/e/ed/edWOEVHkblKQpq5JLBUEA&quot;/&amp;gt;
&amp;lt;/workspaceFilter&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;makes the test succeed. even with the user session.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=marett&quot; class=&quot;user-hover&quot; rel=&quot;marett&quot;&gt;marett&lt;/a&gt; is there a reason why you don&apos;t export the entire user node?&lt;/p&gt;
</comment>
                            <comment id="16376554" author="marett" created="Mon, 26 Feb 2018 09:02:01 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tripod&quot; class=&quot;user-hover&quot; rel=&quot;tripod&quot;&gt;tripod&lt;/a&gt; for looking at this. The code that computes the filters receives the paths individually, thus the need to aggregate them into a coherent filter. It could indeed be possible to compute better filters and indeed, when using a single root filter, the issue reproduces only when the property filter on the root node is present.&lt;/p&gt;

&lt;p&gt;Even though there has been a change of behaviour in &lt;a href=&quot;https://issues.apache.org/jira/browse/JCRVLT-227&quot; title=&quot;Import fail if user does not have access to the root path&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JCRVLT-227&quot;&gt;&lt;del&gt;JCRVLT-227&lt;/del&gt;&lt;/a&gt;, I believe we have a satisfying way to deal with the new behaviour, thus resolving the issue.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13164688">SLING-7714</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 37 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3qidj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>