<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 18:32:56 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[JCRVLT-292] Order of ACLs are altered on installation of content packages</title>
                <link>https://issues.apache.org/jira/browse/JCRVLT-292</link>
                <project id="12314920" key="JCRVLT">Jackrabbit FileVault</project>
                    <description>&lt;p&gt;When installing a content package with AccessControlHandling &lt;em&gt;overwrite&lt;/em&gt; access control entries contained in a given list are grouped by principal and ultimately imported with a different order that originally defined in the package.&lt;/p&gt;

&lt;p&gt;This alters the effective permissions for those {{Subject}}s that contain the principals for which the ACEs got imported.&lt;/p&gt;

&lt;p&gt;Example:&lt;br/&gt;
1. grant group1 read at /testroot&lt;br/&gt;
2. deny group2 read at specific subset of items within the tree defined by /testroot&lt;br/&gt;
3. grant group1 read/write at  specific subset of items within the tree defined by /testroot&lt;/p&gt;

&lt;p&gt;The ACL resulting from the package import will contain the entries in the following order: 1, 3, 2.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13162569">JCRVLT-292</key>
            <summary>Order of ACLs are altered on installation of content packages</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="angela">Angela Schreiber</reporter>
                        <labels>
                    </labels>
                <created>Tue, 29 May 2018 12:24:13 +0000</created>
                <updated>Thu, 9 Aug 2018 09:32:17 +0000</updated>
                            <resolved>Wed, 20 Jun 2018 02:07:55 +0000</resolved>
                                                    <fixVersion>3.2</fixVersion>
                                    <component>Packaging</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="16493662" author="anchela" created="Tue, 29 May 2018 15:07:02 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tripod&quot; class=&quot;user-hover&quot; rel=&quot;tripod&quot;&gt;tripod&lt;/a&gt;, attached an IT illustrating the issue and a proposed patch of &lt;tt&gt;JackrabbitACLImporter&lt;/tt&gt;. The test fails without the patch but passes with the fix in place... however see &lt;a href=&quot;https://issues.apache.org/jira/browse/JCRVLT-293&quot; title=&quot;Failing tests when building vault-core with -Doak=true&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JCRVLT-293&quot;&gt;&lt;del&gt;JCRVLT-293&lt;/del&gt;&lt;/a&gt; for other test failure, which I am not entirely sure how to weight them.&lt;/p&gt;

&lt;p&gt;While I think the proposed fix actually introduces a backwards compatibility issue, the fix doesn&apos;t seem to cause other tests to fail. I would feel a lot more comfortable with the proposed fix, if there was a bigger test coverage (both IT and unit tests) that would help me understand if the behaviour today was actually intended or if we are really looking at a bug (or improvement) here.&lt;/p&gt;</comment>
                            <comment id="16493680" author="anchela" created="Tue, 29 May 2018 15:13:21 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tripod&quot; class=&quot;user-hover&quot; rel=&quot;tripod&quot;&gt;tripod&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stillalex&quot; class=&quot;user-hover&quot; rel=&quot;stillalex&quot;&gt;stillalex&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=reschke&quot; class=&quot;user-hover&quot; rel=&quot;reschke&quot;&gt;reschke&lt;/a&gt;, I would very much appreciate if you could review the proposed change.&lt;/p&gt;</comment>
                            <comment id="16494871" author="alex.parvulescu" created="Wed, 30 May 2018 08:25:08 +0000"  >&lt;p&gt;I really can&apos;t contribute to the implications of the patch, but I think the patch looks good and addresses the stated issue.&lt;/p&gt;

&lt;p&gt;Seems to me the original code used a &lt;tt&gt;LinkedHashMap&lt;/tt&gt; which guarantees iteration of keys based on insertion order, so relative order of principals is kept, unless there&apos;s a double (another entry on the same principal) in which case some entry could be moved close to the initial location of the principal. which is the entire point of this issue, so if this is a corner case or a design decision only the author can clarify.&lt;/p&gt;

&lt;p&gt;One nitpick is that leaving the map in there might cause even more confusion in the future, as it looks after the patch a simple Set could be used to determine if a given principal exists or not.&lt;br/&gt;
Also, pre-patch the number of &lt;tt&gt;getPrincipal(principalName)&lt;/tt&gt; was proportional with the number of principals, now it is proportional to the number of ACEs, but I&apos;m really not sure if this is an issue or not, it would probably make more sense to move it up to the JackrabbitACLImporter as a principal cache or something similar.&lt;/p&gt;

&lt;p&gt;Finally, is there any way in which we can hide this behind a feature flag / setting. I don&apos;t know this code well enough to say if there&apos;s support for this kind of configs.&lt;/p&gt;</comment>
                            <comment id="16495053" author="anchela" created="Wed, 30 May 2018 11:39:22 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stillalex&quot; class=&quot;user-hover&quot; rel=&quot;stillalex&quot;&gt;stillalex&lt;/a&gt;, thanks a lot for the review, very much appreciated. maybe i can get rid of the &lt;tt&gt;LinkedHashMap&lt;/tt&gt; altogether.... also in think the principal lookup can be dropped as it anyway falls back to a innerclass principal in case it&apos;s not known to the &lt;tt&gt;PrincipalManager&lt;/tt&gt;. ultimately the access control management implementation is in charge of validating and potentially rejecting invalid/unknown principals. will attach an updated patch as soon as i managed to incorporate the feedback and my conclusions.&lt;/p&gt;</comment>
                            <comment id="16495066" author="anchela" created="Wed, 30 May 2018 11:49:18 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stillalex&quot; class=&quot;user-hover&quot; rel=&quot;stillalex&quot;&gt;stillalex&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=reschke&quot; class=&quot;user-hover&quot; rel=&quot;reschke&quot;&gt;reschke&lt;/a&gt;, slightly simplified patch...  to be honest it somehow worries me that no tests start failing with my changes. as a next step i will take another look at existing tests and see what could be done with moderate effort.&lt;/p&gt;</comment>
                            <comment id="16496192" author="anchela" created="Thu, 31 May 2018 07:08:15 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stillalex&quot; class=&quot;user-hover&quot; rel=&quot;stillalex&quot;&gt;stillalex&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=reschke&quot; class=&quot;user-hover&quot; rel=&quot;reschke&quot;&gt;reschke&lt;/a&gt;, I have been thinking about this issue over and over again. I don&apos;t feel comfortable to push this patch without having proper test coverage in place.&lt;/p&gt;

&lt;p&gt;Therefore I created a new container for the test coverage and created specific subtasks for the security related parts, marking the one for access control import as blocking this issue.&lt;/p&gt;</comment>
                            <comment id="16517701" author="tripod" created="Wed, 20 Jun 2018 02:07:55 +0000"  >&lt;p&gt;thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=anchela&quot; class=&quot;user-hover&quot; rel=&quot;anchela&quot;&gt;anchela&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;fixed in r1833885&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                                                <inwardlinks description="is blocked by">
                                        <issuelink>
            <issuekey id="13163076">JCRVLT-296</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13162570">JCRVLT-293</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12925737" name="JCRVLT-292-2.patch" size="20185" author="angela" created="Wed, 30 May 2018 11:47:17 +0000"/>
                            <attachment id="12925556" name="JCRVLT-292.patch" size="18792" author="angela" created="Tue, 29 May 2018 15:02:47 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 21 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3u99j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>