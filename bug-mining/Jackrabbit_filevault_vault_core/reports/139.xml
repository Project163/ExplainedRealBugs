<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 18:33:32 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[JCRVLT-557] Breaking change in behavior for implict nodetype calculation</title>
                <link>https://issues.apache.org/jira/browse/JCRVLT-557</link>
                <project id="12314920" key="JCRVLT">Jackrabbit FileVault</project>
                    <description>&lt;p&gt;During extensive validation of backward compatiblity of droping in head (3.5.1-SNAPSHOT) over 3.4.0 led to detection of a breaking behavioral change.&lt;/p&gt;

&lt;p&gt;The simplified case looks like this:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;a node is already present as nt:unstructured&lt;/li&gt;
	&lt;li&gt;a package is being installed with an the filter root not having a .content.xml&lt;/li&gt;
	&lt;li&gt;the child node of this node would be nt:unstructured&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Experienced outcome in 3.4.0: all 3 nodes would be of nt:unstructured&lt;br/&gt;
Behavior in 3.5.1-SNAPSHOT: ConstraintViolationExceptionas no matching NodeTypeDefinition is found for the child node (indicating that the parent wasn&apos;t created as nt:unstrructureed)&lt;/p&gt;

&lt;p&gt;The original case is slightly more complex where the substructure is deeper with some excludes and an &quot;implicit&quot; node (not covered by the filter due to the exclude would fail to create with the same ConstraintViolationException.&lt;/p&gt;

&lt;p&gt;My current assumption is that solving the provided testcase (will create IT for the PR) would also solve the more complex scenario - if necessary I can add a secondary test case closer to the real-world failure.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13398896">JCRVLT-557</key>
            <summary>Breaking change in behavior for implict nodetype calculation</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="kwin">Konrad Windszus</assignee>
                                    <reporter username="dsuess">Dominik S&#252;&#223;</reporter>
                        <labels>
                    </labels>
                <created>Thu, 2 Sep 2021 09:00:00 +0000</created>
                <updated>Mon, 8 Nov 2021 13:56:43 +0000</updated>
                            <resolved>Thu, 4 Nov 2021 06:46:50 +0000</resolved>
                                    <version>3.4.4</version>
                                    <fixVersion>3.5.6</fixVersion>
                                    <component>vlt</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="17408698" author="dsuess" created="Thu, 2 Sep 2021 09:06:27 +0000"  >&lt;p&gt;Failing scenario covered in &lt;a href=&quot;https://github.com/apache/jackrabbit-filevault/pull/164&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/jackrabbit-filevault/pull/164&lt;/a&gt; - as indicated this is a boiled down scenario of a more complex package with includes and excludes containing the minimum to provoke the same fail scenario. With the real packge I could observe on 3.4.0 that the substructures would be created as nt:unstructured making the structures valid while the package definition itself doesn&apos;t enforce a valid structure in itself - yet people were relying on this implicit detection to work as it did which makes this a breaking behavioral change.&lt;/p&gt;</comment>
                            <comment id="17408701" author="kwin" created="Thu, 2 Sep 2021 09:15:34 +0000"  >&lt;p&gt;The change is deliberate as I outlined in &lt;a href=&quot;https://github.com/apache/jackrabbit-filevault/pull/164#discussion_r700901453&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/jackrabbit-filevault/pull/164#discussion_r700901453&lt;/a&gt;. IMHO the package is just corrupt and therefore should lead to an exception when being installed! &lt;/p&gt;</comment>
                            <comment id="17408730" author="dsuess" created="Thu, 2 Sep 2021 10:48:39 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kwin&quot; class=&quot;user-hover&quot; rel=&quot;kwin&quot;&gt;kwin&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tripod&quot; class=&quot;user-hover&quot; rel=&quot;tripod&quot;&gt;tripod&lt;/a&gt; - this is problematic as this is a breaking change - the packages may not be owned and controlled by the operator of the system and this breaks backward compatiblity (which means we can&apos;t drop in the new version without previously working packages starting to fail. An option I could see is to introduce an install option that allows to toggle the corresponding behavior - for consumers that would be failing the toggle could be set (legacy behavior) IF they are failing until they have fixed this. We could add some logging to detect and log warns in case of this toggle being set so we can provide proper feedback to consumers that have such packages around. (cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cziegeler&quot; class=&quot;user-hover&quot; rel=&quot;cziegeler&quot;&gt;cziegeler&lt;/a&gt;)&lt;/p&gt;</comment>
                            <comment id="17408741" author="kwin" created="Thu, 2 Sep 2021 11:16:57 +0000"  >&lt;p&gt;Almost every bug fix could lead to issues for consumers relying on the faulty behavior. IMHO such a package was never created through the exporter but necessarily was manually created. I don&#8217;t see the need to support such faulty manually created packages&lt;/p&gt;</comment>
                            <comment id="17408797" author="dsuess" created="Thu, 2 Sep 2021 12:47:18 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kwin&quot; class=&quot;user-hover&quot; rel=&quot;kwin&quot;&gt;kwin&lt;/a&gt; I would not be creating this ticket if this wouldn&apos;t block adoption, it may be that you don&apos;t have a need but we as a platform provider have a strong need for backwards compatibility - it is a real issue and if we as a consumer want to migrate we need a solution that&apos;s not all or nothing - we cannon adopt a new version and rely on an unknown amount of consumers fixing ahead - this is why I propose some middle ground solution for a slow introduction instead of straight revert. &lt;/p&gt;
</comment>
                            <comment id="17408814" author="kwin" created="Thu, 2 Sep 2021 13:15:41 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dsuess&quot; class=&quot;user-hover&quot; rel=&quot;dsuess&quot;&gt;dsuess&lt;/a&gt; Feel free to propose a PR, if you feel the need for such a toggle.&lt;/p&gt;</comment>
                            <comment id="17408829" author="dsuess" created="Thu, 2 Sep 2021 13:35:26 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kwin&quot; class=&quot;user-hover&quot; rel=&quot;kwin&quot;&gt;kwin&lt;/a&gt; sure - just for confirmation, the change was &lt;a href=&quot;https://github.com/apache/jackrabbit-filevault/pull/72/files&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/jackrabbit-filevault/pull/72/files&lt;/a&gt; correct?&lt;/p&gt;</comment>
                            <comment id="17408845" author="kwin" created="Thu, 2 Sep 2021 13:49:52 +0000"  >&lt;p&gt;Yes, &lt;a href=&quot;https://github.com/apache/jackrabbit-filevault/pull/72/files&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/jackrabbit-filevault/pull/72/files&lt;/a&gt; contributed the bugfix.&lt;/p&gt;</comment>
                            <comment id="17430542" author="reschke" created="Tue, 19 Oct 2021 13:20:44 +0000"  >&lt;p&gt;So, summarizing: the plan would be to keep the current behavior, but allow a configuration to restore backwards compatibilty, right?&lt;/p&gt;</comment>
                            <comment id="17434234" author="reschke" created="Tue, 26 Oct 2021 09:56:01 +0000"  >&lt;p&gt;Work in progress: &lt;a href=&quot;https://github.com/apache/jackrabbit-filevault/tree/bugfix/JCRVLT-557-conf-implicit-nt-calc&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/jackrabbit-filevault/tree/bugfix/JCRVLT-557-conf-implicit-nt-calc&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17437347" author="reschke" created="Tue, 2 Nov 2021 13:08:58 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kwin&quot; class=&quot;user-hover&quot; rel=&quot;kwin&quot;&gt;kwin&lt;/a&gt; - PR in &lt;a href=&quot;https://github.com/apache/jackrabbit-filevault/pull/175&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/jackrabbit-filevault/pull/175&lt;/a&gt; - feedback appreciated&lt;/p&gt;</comment>
                            <comment id="17438489" author="reschke" created="Thu, 4 Nov 2021 05:31:35 +0000"  >&lt;p&gt;Fixed in &lt;a href=&quot;https://github.com/apache/jackrabbit-filevault/commit/13e60fb99d7643dbe76900952850a072bcb2b6ef&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/jackrabbit-filevault/commit/13e60fb99d7643dbe76900952850a072bcb2b6ef&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13025831">JCRVLT-142</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13287483">JCRVLT-415</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 1 week, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0uj6o:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>