<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 18:32:58 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[JCRVLT-305] DefaultWorkspaceFilter.add(nodeFilters) does not include properties</title>
                <link>https://issues.apache.org/jira/browse/JCRVLT-305</link>
                <project id="12314920" key="JCRVLT">Jackrabbit FileVault</project>
                    <description>&lt;p&gt;The add method should only add the filter set to nodeFilterSets, otherwise an include pattern for nodes will reject all properties.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void add(PathFilterSet set) {
        nodesFilterSets.add(set);
        propsFilterSets.add(set);
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://github.com/apache/jackrabbit-filevault/blob/9eb53d36adfb7695a44075c72ca7ff0cedafabcc/vault-core/src/main/java/org/apache/jackrabbit/vault/fs/config/DefaultWorkspaceFilter.java#L102&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/jackrabbit-filevault/blob/9eb53d36adfb7695a44075c72ca7ff0cedafabcc/vault-core/src/main/java/org/apache/jackrabbit/vault/fs/config/DefaultWorkspaceFilter.java#L102&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13165875">JCRVLT-305</key>
            <summary>DefaultWorkspaceFilter.add(nodeFilters) does not include properties</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="mpetria">Marius Petria</reporter>
                        <labels>
                    </labels>
                <created>Wed, 13 Jun 2018 15:59:00 +0000</created>
                <updated>Thu, 9 Aug 2018 09:32:17 +0000</updated>
                            <resolved>Thu, 21 Jun 2018 02:35:41 +0000</resolved>
                                                    <fixVersion>3.2</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="16511362" author="mpetria" created="Wed, 13 Jun 2018 16:01:40 +0000"  >&lt;p&gt;Tests that show the broken behavior in &lt;a href=&quot;https://github.com/apache/jackrabbit-filevault/pull/28&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/jackrabbit-filevault/pull/28&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16515347" author="tripod" created="Mon, 18 Jun 2018 04:47:01 +0000"  >&lt;p&gt;hmmm, I see the problem. with the introduction of the property filters, it is not easily possible to export just the node itself.&lt;br/&gt;
the filter:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;&amp;lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&amp;gt;
&amp;lt;workspaceFilter version=&quot;1.0&quot;&amp;gt;
    &amp;lt;filter root=&quot;/tmp&quot;&amp;gt;
        &amp;lt;include pattern=&quot;/tmp&quot;/&amp;gt;
    &amp;lt;/filter&amp;gt;
&amp;lt;/workspaceFilter&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;should work as before, i.e. include the node itself and all its properties.&lt;/p&gt;

&lt;p&gt;similar as:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;&amp;lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&amp;gt;
&amp;lt;workspaceFilter version=&quot;1.0&quot;&amp;gt;
    &amp;lt;filter root=&quot;/tmp&quot;&amp;gt;
        &amp;lt;exclude pattern=&quot;/tmp/.*&quot;/&amp;gt;
    &amp;lt;/filter&amp;gt;
&amp;lt;/workspaceFilter&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

</comment>
                            <comment id="16515353" author="tripod" created="Mon, 18 Jun 2018 05:07:18 +0000"  >&lt;p&gt;btw, the following works:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
        PathFilterSet nodes = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; PathFilterSet(&lt;span class=&quot;code-quote&quot;&gt;&quot;/tmp&quot;&lt;/span&gt;);
        nodes.addInclude(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; DefaultPathFilter(&lt;span class=&quot;code-quote&quot;&gt;&quot;/tmp&quot;&lt;/span&gt;));

        PathFilterSet props = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; PathFilterSet(&lt;span class=&quot;code-quote&quot;&gt;&quot;/tmp&quot;&lt;/span&gt;);

        DefaultWorkspaceFilter filter = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; DefaultWorkspaceFilter();
        filter.add(nodes, props);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="16515363" author="mpetria" created="Mon, 18 Jun 2018 05:34:31 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tripod&quot; class=&quot;user-hover&quot; rel=&quot;tripod&quot;&gt;tripod&lt;/a&gt; you are right, using the filter.add(nodes, props) exports only the node and its properties but there are 2 problems with that:&lt;br/&gt;
 1. filter.add(nodes) should behave as filter.add(nodes, props) with props having a empty list of entries (see test filterRelativePropertiesSingleSet_NotDeep_no_propertyFilter_addNodes in &lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;). Maybe the code should look like:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void add(PathFilterSet set) {
        nodesFilterSets.add(set);
        propsFilterSets.add(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; PathFilterSet(set.getRoot()));
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;2. The example with filter.add(nodes, props) produces an incomplete filter.xml file - no include clause (see test filterRelativePropertiesSingleSet_NotDeep_no_propertyFilter_sourceCheck in &lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;). This is because the generateSource iterates only over property filters when the xml is generated.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&amp;lt;?xml version=&lt;span class=&quot;code-quote&quot;&gt;&quot;1.0&quot;&lt;/span&gt; encoding=&lt;span class=&quot;code-quote&quot;&gt;&quot;UTF-8&quot;&lt;/span&gt;?&amp;gt;
&amp;lt;workspaceFilter version=&lt;span class=&quot;code-quote&quot;&gt;&quot;1.0&quot;&lt;/span&gt;&amp;gt;
    &amp;lt;filter root=&lt;span class=&quot;code-quote&quot;&gt;&quot;/tmp&quot;&lt;/span&gt;/&amp;gt;
&amp;lt;/workspaceFilter&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://github.com/apache/jackrabbit-filevault/pull/28/files#diff-427da2ed13e27d4de628819d62b0d5a1R267&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/jackrabbit-filevault/pull/28/files#diff-427da2ed13e27d4de628819d62b0d5a1R267&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16518137" author="mpetria" created="Wed, 20 Jun 2018 13:36:10 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tripod&quot; class=&quot;user-hover&quot; rel=&quot;tripod&quot;&gt;tripod&lt;/a&gt; as I said in my previous comment the following code produces a filter.xml that does not contains any include clause (and also any exclude clause). It will just contain&#160;&lt;tt&gt;&amp;lt;filter root=&quot;/tmp&quot;/&amp;gt;&lt;/tt&gt;. Does this lack of patterns affect the import in any way?&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
        PathFilterSet nodes = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; PathFilterSet(&lt;span class=&quot;code-quote&quot;&gt;&quot;/tmp&quot;&lt;/span&gt;);
        nodes.addInclude(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; DefaultPathFilter(&lt;span class=&quot;code-quote&quot;&gt;&quot;/tmp&quot;&lt;/span&gt;));

        PathFilterSet props = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; PathFilterSet(&lt;span class=&quot;code-quote&quot;&gt;&quot;/tmp&quot;&lt;/span&gt;);

        DefaultWorkspaceFilter filter = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; DefaultWorkspaceFilter();
        filter.add(nodes, props);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I added some more test to &lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; that show that if a path is fist included and then excluded by another pattern the last matching pattern is not used (as described in documentation: the last matching element determines if the path is included or not). I think the problem is that filter.xml in generateSource uses only the propFilterSet hence now pattern from the nodes are added to the filter.xml.&lt;/p&gt;


&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://github.com/apache/jackrabbit-filevault/compare/trunk...mpetria:issue/JCRVLT-305?expand=1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/jackrabbit-filevault/compare/trunk...mpetria:issue/JCRVLT-305?expand=1&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16518823" author="tripod" created="Thu, 21 Jun 2018 02:35:41 +0000"  >&lt;p&gt;fixed in r1833972&lt;/p&gt;</comment>
                            <comment id="16519343" author="mpetria" created="Thu, 21 Jun 2018 13:07:24 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tripod&quot; class=&quot;user-hover&quot; rel=&quot;tripod&quot;&gt;tripod&lt;/a&gt; thanks for the fix. Just a clarifying question. It looks that patterns only apply to subnodes of the root. For example the following filter will still install the root node even if it has an exclude all clause, right? I tested and that is the case but wanted to confirm the intent.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&amp;lt;?xml version=&lt;span class=&quot;code-quote&quot;&gt;&quot;1.0&quot;&lt;/span&gt; encoding=&lt;span class=&quot;code-quote&quot;&gt;&quot;UTF-8&quot;&lt;/span&gt;?&amp;gt;
&amp;lt;workspaceFilter version=&lt;span class=&quot;code-quote&quot;&gt;&quot;1.0&quot;&lt;/span&gt;&amp;gt;
    &amp;lt;filter root=&lt;span class=&quot;code-quote&quot;&gt;&quot;/tmp&quot;&lt;/span&gt;&amp;gt;
        &amp;lt;exclude pattern=&lt;span class=&quot;code-quote&quot;&gt;&quot;.*&quot;&lt;/span&gt;/&amp;gt;
    &amp;lt;/filter&amp;gt;
&amp;lt;/workspaceFilter&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="16519351" author="tripod" created="Thu, 21 Jun 2018 13:15:26 +0000"  >&lt;p&gt;no, your example should not install anything.&lt;/p&gt;</comment>
                            <comment id="16519362" author="mpetria" created="Thu, 21 Jun 2018 13:24:18 +0000"  >&lt;p&gt;I tested with the following test on current trunk and some versions back to 3.1.30 and it fails on all.&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://github.com/apache/jackrabbit-filevault/compare/trunk...mpetria:issue/JCRVLT-305-1?expand=1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/jackrabbit-filevault/compare/trunk...mpetria:issue/JCRVLT-305-1?expand=1&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16519882" author="tripod" created="Fri, 22 Jun 2018 00:52:30 +0000"  >&lt;p&gt;thanks for testing. so I guess, this was always like this....let&apos;s not break it then &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                            <outwardlinks description="blocks">
                                        <issuelink>
            <issuekey id="13164688">SLING-7714</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 21 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3utn3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>