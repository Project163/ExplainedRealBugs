<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 18:33:26 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[JCRVLT-543] DocViewSAXImporter failing on protected properties for new Nodes</title>
                <link>https://issues.apache.org/jira/browse/JCRVLT-543</link>
                <project id="12314920" key="JCRVLT">Jackrabbit FileVault</project>
                    <description>&lt;p&gt;Starting with &lt;a href=&quot;https://github.com/apache/jackrabbit-filevault/commit/5f3b1d363da7bcf3c285a0bdbb394254ca3e57d1#diff-96c973bf61e1d3ae0fde08f6c35da64d983623ac50ce2f6af682828d4963a7dbR1166&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/jackrabbit-filevault/commit/5f3b1d363da7bcf3c285a0bdbb394254ca3e57d1#diff-96c973bf61e1d3ae0fde08f6c35da64d983623ac50ce2f6af682828d4963a7dbR1166&lt;/a&gt; the behavior for relaxed handling of protected properties is no longer working on newly created nodes. New nodes do not pass a VersioningState causing the Exception to be rethrown at *&lt;a href=&quot;https://github.com/apache/jackrabbit-filevault/blob/2381d35b1ba4eb2785f3d632b8501983899ce980/vault-core/src/main/java/org/apache/jackrabbit/vault/fs/impl/io/DocViewSAXImporter.java#L1166*&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/jackrabbit-filevault/blob/2381d35b1ba4eb2785f3d632b8501983899ce980/vault-core/src/main/java/org/apache/jackrabbit/vault/fs/impl/io/DocViewSAXImporter.java#L1166*&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This specifically affects System generated properties in case of packages that got generated by building a package from a System.&lt;/p&gt;

&lt;p&gt;// cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kwin&quot; class=&quot;user-hover&quot; rel=&quot;kwin&quot;&gt;kwin&lt;/a&gt; as commiter of patch introducing the regeression&lt;/p&gt;</description>
                <environment></environment>
        <key id="13386260">JCRVLT-543</key>
            <summary>DocViewSAXImporter failing on protected properties for new Nodes</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="kwin">Konrad Windszus</assignee>
                                    <reporter username="dsuess">Dominik S&#252;&#223;</reporter>
                        <labels>
                    </labels>
                <created>Mon, 28 Jun 2021 12:41:04 +0000</created>
                <updated>Wed, 13 Jul 2022 14:47:35 +0000</updated>
                            <resolved>Wed, 30 Jun 2021 07:48:28 +0000</resolved>
                                    <version>3.5.0</version>
                                    <fixVersion>3.5.4</fixVersion>
                                    <component>vlt</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="17370592" author="kwin" created="Mon, 28 Jun 2021 13:38:16 +0000"  >&lt;p&gt;Most protected properties should already be skipped by this guard: &lt;a href=&quot;https://github.com/apache/jackrabbit-filevault/blob/2381d35b1ba4eb2785f3d632b8501983899ce980/vault-core/src/main/java/org/apache/jackrabbit/vault/fs/impl/io/DocViewSAXImporter.java#L1160&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/jackrabbit-filevault/blob/2381d35b1ba4eb2785f3d632b8501983899ce980/vault-core/src/main/java/org/apache/jackrabbit/vault/fs/impl/io/DocViewSAXImporter.java#L1160&lt;/a&gt;&lt;br/&gt;
Can you come up with a failing IT? Which specific property have you tested with?&lt;/p&gt;</comment>
                            <comment id="17371259" author="kwin" created="Tue, 29 Jun 2021 09:27:05 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dsuess&quot; class=&quot;user-hover&quot; rel=&quot;dsuess&quot;&gt;dsuess&lt;/a&gt; Can you check &lt;a href=&quot;https://github.com/apache/jackrabbit-filevault/pull/154?&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/jackrabbit-filevault/pull/154?&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17371865" author="kwin" created="Wed, 30 Jun 2021 07:48:29 +0000"  >&lt;p&gt;Fixed in &lt;a href=&quot;https://github.com/apache/jackrabbit-filevault/commit/4590f8f71b01e51fe2faaec26f86fa5af2a5c8e8&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/jackrabbit-filevault/commit/4590f8f71b01e51fe2faaec26f86fa5af2a5c8e8&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="17379163" author="dsuess" created="Mon, 12 Jul 2021 12:12:05 +0000"  >&lt;p&gt;I&apos;m still checking the exact conditions to create a dervied issue. Something seems to be off with this as I currently get&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
 *ERROR* [OsgiInstallerImpl] com.adobe.granite.installer.factory.packages.impl.PackageTransformer Error &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; processing install task of adobe/granite:com.adobe.granite.contexthub.content:1.2.2.
org.apache.jackrabbit.vault.packaging.PackageException: javax.jcr.RepositoryException: Some errors occurred &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; installing packages. Please check the logs &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; details. First exception is logged as cause.
	at org.apache.jackrabbit.vault.packaging.impl.ZipVaultPackage.extract(ZipVaultPackage.java:282) [org.apache.jackrabbit.vault:3.5.1.SNAPSHOT]
	at org.apache.jackrabbit.vault.packaging.impl.JcrPackageImpl.extract(JcrPackageImpl.java:397) [org.apache.jackrabbit.vault:3.5.1.SNAPSHOT]
	at org.apache.jackrabbit.vault.packaging.impl.JcrPackageImpl.extract(JcrPackageImpl.java:356) [org.apache.jackrabbit.vault:3.5.1.SNAPSHOT]
	at org.apache.jackrabbit.vault.packaging.impl.JcrPackageImpl.extract(JcrPackageImpl.java:342) [org.apache.jackrabbit.vault:3.5.1.SNAPSHOT]
	at com.adobe.granite.installer.factory.packages.impl.PackageTransformer$InstallPackageTask.execute(PackageTransformer.java:346) [com.adobe.granite.installer.factory.packages:1.0.18]
	at org.apache.sling.installer.core.impl.OsgiInstallerImpl.doExecuteTasks(OsgiInstallerImpl.java:918)
	at org.apache.sling.installer.core.impl.OsgiInstallerImpl.executeTasks(OsgiInstallerImpl.java:755)
	at org.apache.sling.installer.core.impl.OsgiInstallerImpl.run(OsgiInstallerImpl.java:304)
	at java.base/java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:834)
Caused by: javax.jcr.RepositoryException: Some errors occurred &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; installing packages. Please check the logs &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; details. First exception is logged as cause.
	at org.apache.jackrabbit.vault.fs.io.Importer.run(Importer.java:508) [org.apache.jackrabbit.vault:3.5.1.SNAPSHOT]
	at org.apache.jackrabbit.vault.packaging.impl.ZipVaultPackage.extract(ZipVaultPackage.java:277) [org.apache.jackrabbit.vault:3.5.1.SNAPSHOT]
	... 8 common frames omitted
Caused by: javax.jcr.nodetype.ConstraintViolationException: Item is &lt;span class=&quot;code-keyword&quot;&gt;protected&lt;/span&gt;.
	at org.apache.jackrabbit.oak.jcr.session.ItemImpl$ItemWriteOperation.checkPreconditions(ItemImpl.java:98) [org.apache.jackrabbit.oak-jcr:1.39.0.R1889746]
	at org.apache.jackrabbit.oak.jcr.session.PropertyImpl$4.checkPreconditions(PropertyImpl.java:116) [org.apache.jackrabbit.oak-jcr:1.39.0.R1889746]
	at org.apache.jackrabbit.oak.jcr.delegate.SessionDelegate.prePerform(SessionDelegate.java:629) [org.apache.jackrabbit.oak-jcr:1.39.0.R1889746]
	at org.apache.jackrabbit.oak.jcr.delegate.SessionDelegate.performVoid(SessionDelegate.java:272) [org.apache.jackrabbit.oak-jcr:1.39.0.R1889746]
	at org.apache.jackrabbit.oak.jcr.session.PropertyImpl.remove(PropertyImpl.java:113) [org.apache.jackrabbit.oak-jcr:1.39.0.R1889746]
	at org.apache.jackrabbit.vault.util.DocViewProperty.apply(DocViewProperty.java:472) [org.apache.jackrabbit.vault:3.5.1.SNAPSHOT]
	at org.apache.jackrabbit.vault.fs.impl.io.DocViewSAXImporter.setUnprotectedProperties(DocViewSAXImporter.java:1167) [org.apache.jackrabbit.vault:3.5.1.SNAPSHOT]
	at org.apache.jackrabbit.vault.fs.impl.io.DocViewSAXImporter.createNewNode(DocViewSAXImporter.java:1084) [org.apache.jackrabbit.vault:3.5.1.SNAPSHOT]
	at org.apache.jackrabbit.vault.fs.impl.io.DocViewSAXImporter.addNode(DocViewSAXImporter.java:903) [org.apache.jackrabbit.vault:3.5.1.SNAPSHOT]
	at org.apache.jackrabbit.vault.fs.impl.io.DocViewSAXImporter.startElement(DocViewSAXImporter.java:687) [org.apache.jackrabbit.vault:3.5.1.SNAPSHOT]
	at java.xml/com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.startElement(AbstractSAXParser.java:510)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;noticable that this is being invoked in&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/jackrabbit-filevault/blob/c612dda36895d379ec57f6d2834158ea513f2967/vault-core/src/main/java/org/apache/jackrabbit/vault/fs/impl/io/DocViewSAXImporter.java#L1167&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/jackrabbit-filevault/blob/c612dda36895d379ec57f6d2834158ea513f2967/vault-core/src/main/java/org/apache/jackrabbit/vault/fs/impl/io/DocViewSAXImporter.java#L1167&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;where the protected property jcr:mixinTypes should cause be ignored afaict.&lt;br/&gt;
P.S. I wonder if the check as implemented only considers the primaryType but ignores policies coming from the mixintypes themselves.&lt;/p&gt;</comment>
                            <comment id="17379821" author="kwin" created="Tue, 13 Jul 2021 10:46:33 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dsuess&quot; class=&quot;user-hover&quot; rel=&quot;dsuess&quot;&gt;dsuess&lt;/a&gt; This is not enough information for me to provide a fix. Please give more details like package structure and repository state prior installation.&lt;/p&gt;</comment>
                            <comment id="17379835" author="dsuess" created="Tue, 13 Jul 2021 11:14:48 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kwin&quot; class=&quot;user-hover&quot; rel=&quot;kwin&quot;&gt;kwin&lt;/a&gt; - sorry for the delay, I have to fit this in my current duties which force me to react adhoc on notfications. I#ll get back to this the next gap I&apos;ll find.&lt;/p&gt;</comment>
                            <comment id="17405401" author="kwin" created="Thu, 26 Aug 2021 18:17:36 +0000"  >&lt;p&gt;I would like to do a new release soon. If I don&#8217;t get further input I assume everything is fixed now. More than two month passed since the last comment.&lt;/p&gt;</comment>
                            <comment id="17405406" author="dsuess" created="Thu, 26 Aug 2021 18:23:11 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kwin&quot; class=&quot;user-hover&quot; rel=&quot;kwin&quot;&gt;kwin&lt;/a&gt; sorry there was vacation, oncall duty and sicktime. There is a remaining issue which is that mixins that are already present are handled as unprotected properties and the installation tries to set them. Even though the right mixin was set ahead this fails with the according error about protected properties ( although it would be noop). &lt;/p&gt;</comment>
                            <comment id="17405410" author="kwin" created="Thu, 26 Aug 2021 18:34:09 +0000"  >&lt;p&gt;Please create a new issue with a test case or at least a package attached, otherwise I can&#8217;t do anything.&lt;/p&gt;</comment>
                            <comment id="17405413" author="dsuess" created="Thu, 26 Aug 2021 18:37:28 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kwin&quot; class=&quot;user-hover&quot; rel=&quot;kwin&quot;&gt;kwin&lt;/a&gt; yep - that was just interrupted but is due tomorrow. Just wanted to share as this seems to be caused by the changef handling of identifying protected properties and should be fixed before releasing. &lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 11 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0sdao:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>