diff --git a/vault-core/src/main/java/org/apache/jackrabbit/vault/packaging/Dependency.java b/vault-core/src/main/java/org/apache/jackrabbit/vault/packaging/Dependency.java
index 0f95f1b2..1c77c207 100644
--- a/vault-core/src/main/java/org/apache/jackrabbit/vault/packaging/Dependency.java
+++ b/vault-core/src/main/java/org/apache/jackrabbit/vault/packaging/Dependency.java
@@ -20,6 +20,9 @@ package org.apache.jackrabbit.vault.packaging;
 import java.util.ArrayList;
 import java.util.List;
 
+import javax.annotation.Nonnull;
+import javax.annotation.Nullable;
+
 /**
  * Implements a package dependency reference.
  * @since 2.0
@@ -57,7 +60,7 @@ public class Dependency {
      * @param name name
      * @param range version range
      */
-    public Dependency(String groupId, String name, VersionRange range) {
+    public Dependency(@Nonnull String groupId, @Nonnull String name, @Nullable VersionRange range) {
         if (groupId.startsWith(PackageId.ETC_PACKAGES_PREFIX)) {
             groupId = groupId.substring(PackageId.ETC_PACKAGES_PREFIX.length());
         }
@@ -81,7 +84,7 @@ public class Dependency {
      * Creates a new dependency to the specified package id
      * @param id package id.
      */
-    public Dependency(PackageId id) {
+    public Dependency(@Nonnull PackageId id) {
         this(id.getGroup(), id.getName(), new VersionRange(id.getVersion()));
     }
 
@@ -90,6 +93,7 @@ public class Dependency {
      * @return the group id
      * @since 2.4
      */
+    @Nonnull
     public String getGroup() {
         return groupId;
     }
@@ -98,6 +102,7 @@ public class Dependency {
      * Returns the name of the dependency
      * @return the name
      */
+    @Nonnull
     public String getName() {
         return name;
     }
@@ -106,6 +111,7 @@ public class Dependency {
      * Returns the version range
      * @return the version range
      */
+    @Nonnull
     public VersionRange getRange() {
         return range;
     }
@@ -117,6 +123,7 @@ public class Dependency {
      * @deprecated As of 3.1.42, the storage location is implementation details.
      */
     @Deprecated
+    @Nonnull
     public String getPath() {
         StringBuilder b = new StringBuilder();
         if (groupId.length() > 0) {
@@ -137,7 +144,7 @@ public class Dependency {
      * @param id the package id
      * @return {@code true} if matches
      */
-    public boolean matches(PackageId id) {
+    public boolean matches(@Nonnull PackageId id) {
         return groupId.equals(id.getGroup())
                 && name.equals(id.getName())
                 && range.isInRange(id.getVersion());
@@ -149,7 +156,8 @@ public class Dependency {
      * @param str the string
      * @return the dependency
      */
-    public static Dependency fromString(String str) {
+    @Nullable
+    public static Dependency fromString(@Nullable String str) {
         if (str == null || str.length() == 0) {
             return null;
         }
@@ -198,8 +206,9 @@ public class Dependency {
      * @param str serialized string
      * @return array of dependency references
      */
-    public static Dependency[] parse(String str) {
-        List<Dependency> deps = new ArrayList<Dependency>();
+    @Nonnull
+    public static Dependency[] parse(@Nonnull String str) {
+        List<Dependency> deps = new ArrayList<>();
         boolean inRange = false;
         int start = 0;
         boolean wasSeg = false;
@@ -220,7 +229,10 @@ public class Dependency {
             wasSeg = c == ':';
         }
         if (start < str.length()) {
-            deps.add(Dependency.fromString(str.substring(start)));
+            Dependency dep = Dependency.fromString(str.substring(start));
+            if (dep != null) {
+                deps.add(dep);
+            }
         }
         return deps.toArray(new Dependency[deps.size()]);
     }
@@ -230,12 +242,16 @@ public class Dependency {
      * @param str the strings
      * @return the dependencies
      */
-    public static Dependency[] fromString(String ... str) {
-        Dependency[] ret = new Dependency[str.length];
-        for (int i=0; i<str.length;i++) {
-            ret[i] = Dependency.fromString(str[i]);
+    @Nonnull
+    public static Dependency[] fromString(@Nonnull String ... str) {
+        List<Dependency> deps = new ArrayList<>(str.length);
+        for (String s : str) {
+            Dependency dep = Dependency.fromString(s);
+            if (dep != null) {
+                deps.add(dep);
+            }
         }
-        return ret;
+        return deps.toArray(new Dependency[deps.size()]);
     }
 
     /**
@@ -243,23 +259,27 @@ public class Dependency {
      * @param deps the dependencies
      * @return the strings
      */
-    public static String toString(Dependency ... deps) {
+    @Nonnull
+    public static String toString(@Nonnull Dependency ... deps) {
         String delim = "";
         StringBuilder b = new StringBuilder();
         for (Dependency dep: deps) {
-            b.append(delim).append(dep);
-            delim=",";
+            if (dep != null) {
+                b.append(delim).append(dep);
+                delim=",";
+            }
         }
         return b.toString();
     }
 
     @Override
+    @Nonnull
     public String toString() {
         return str;
     }
 
     @Override
-    public boolean equals(Object obj) {
+    public boolean equals(@Nullable Object obj) {
         return this == obj ||
                 obj instanceof Dependency && str.equals(obj.toString());
     }
diff --git a/vault-core/src/main/java/org/apache/jackrabbit/vault/packaging/impl/JcrPackageDefinitionImpl.java b/vault-core/src/main/java/org/apache/jackrabbit/vault/packaging/impl/JcrPackageDefinitionImpl.java
index e7da3fc4..b77d1c3c 100644
--- a/vault-core/src/main/java/org/apache/jackrabbit/vault/packaging/impl/JcrPackageDefinitionImpl.java
+++ b/vault-core/src/main/java/org/apache/jackrabbit/vault/packaging/impl/JcrPackageDefinitionImpl.java
@@ -315,10 +315,16 @@ public class JcrPackageDefinitionImpl implements JcrPackageDefinition {
                 List<Dependency> deps = new LinkedList<Dependency>();
                 if (p.getDefinition().isMultiple()) {
                     for (Value v: p.getValues()) {
-                        deps.add(Dependency.fromString(v.getString()));
+                        Dependency dep = Dependency.fromString(v.getString());
+                        if (dep != null) {
+                            deps.add(dep);
+                        }
                     }
                 } else {
-                    deps.add(Dependency.fromString(p.getString()));
+                    Dependency dep = Dependency.fromString(p.getString());
+                    if (dep != null) {
+                        deps.add(dep);
+                    }
                 }
                 return deps.toArray(new Dependency[deps.size()]);
             }
@@ -333,12 +339,14 @@ public class JcrPackageDefinitionImpl implements JcrPackageDefinition {
      */
     public void setDependencies(@Nonnull Dependency[] dependencies, boolean autoSave) {
         try {
-            final Value[] values = new Value[dependencies.length];
+            final List<Value> values = new ArrayList<>(dependencies.length);
             final ValueFactory fac = defNode.getSession().getValueFactory();
-            for (int i=0; i<dependencies.length; i++) {
-                values[i] = fac.createValue(dependencies[i].toString());
+            for (Dependency d: dependencies) {
+                if (d != null) {
+                    values.add(fac.createValue(d.toString()));
+                }
             }
-            defNode.setProperty(PN_DEPENDENCIES, values);
+            defNode.setProperty(PN_DEPENDENCIES, values.toArray(new Value[values.size()]));
             if (autoSave) {
                 defNode.getSession().save();
             }
@@ -428,12 +436,13 @@ public class JcrPackageDefinitionImpl implements JcrPackageDefinition {
                 defNode.getProperty(PN_DEPENDENCIES).remove();
             }
             if (deps != null) {
-                Dependency[] d = Dependency.parse(deps);
-                String[] ds = new String[d.length];
-                for (int i=0; i<ds.length; i++) {
-                    ds[i] = d[i].toString();
+                List<String> ds = new ArrayList<>();
+                for (Dependency d: Dependency.parse(deps)) {
+                    if (d != null) {
+                        ds.add(d.toString());
+                    }
                 }
-                defNode.setProperty(PN_DEPENDENCIES, ds);
+                defNode.setProperty(PN_DEPENDENCIES, ds.toArray(new String[ds.size()]));
             }
             defNode.setProperty(PN_DESCRIPTION, props.getProperty(VaultPackage.NAME_DESCRIPTION));
             defNode.setProperty(PN_REQUIRES_ROOT, Boolean.valueOf(props.getProperty(VaultPackage.NAME_REQUIRES_ROOT, "false")));
diff --git a/vault-core/src/main/java/org/apache/jackrabbit/vault/packaging/package-info.java b/vault-core/src/main/java/org/apache/jackrabbit/vault/packaging/package-info.java
index 1631ca4e..cbc32538 100644
--- a/vault-core/src/main/java/org/apache/jackrabbit/vault/packaging/package-info.java
+++ b/vault-core/src/main/java/org/apache/jackrabbit/vault/packaging/package-info.java
@@ -15,7 +15,7 @@
  * limitations under the License.
  */
 
-@Version("2.6.0")
+@Version("2.6.1")
 package org.apache.jackrabbit.vault.packaging;
 
 import org.osgi.annotation.versioning.Version;
\ No newline at end of file
diff --git a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/TestPackageInstall.java b/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/TestPackageInstall.java
index eb7fbc42..1bdd4af9 100644
--- a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/TestPackageInstall.java
+++ b/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/TestPackageInstall.java
@@ -33,6 +33,7 @@ import javax.jcr.PropertyType;
 import javax.jcr.RepositoryException;
 import javax.jcr.Session;
 import javax.jcr.SimpleCredentials;
+import javax.jcr.Value;
 import javax.jcr.nodetype.NodeType;
 
 import org.apache.commons.io.FileUtils;
@@ -44,6 +45,7 @@ import org.apache.jackrabbit.vault.fs.config.ConfigurationException;
 import org.apache.jackrabbit.vault.fs.io.ImportOptions;
 import org.apache.jackrabbit.vault.fs.io.Importer;
 import org.apache.jackrabbit.vault.fs.io.ZipArchive;
+import org.apache.jackrabbit.vault.packaging.Dependency;
 import org.apache.jackrabbit.vault.packaging.InstallContext;
 import org.apache.jackrabbit.vault.packaging.JcrPackage;
 import org.apache.jackrabbit.vault.packaging.PackageException;
@@ -54,6 +56,7 @@ import org.junit.Assume;
 import org.junit.Ignore;
 import org.junit.Test;
 
+import static org.apache.jackrabbit.vault.packaging.JcrPackageDefinition.PN_DEPENDENCIES;
 import static org.junit.Assert.assertEquals;
 import static org.junit.Assert.assertNotNull;
 import static org.junit.Assert.assertTrue;
@@ -594,6 +597,41 @@ public class TestPackageInstall extends IntegrationTestBase {
         assertProperty("/testroot/a/jcr:isCheckedOut", "false");
     }
 
+    /**
+     * Installs a package with invalid dependency strings. see JCRVLT-265
+     */
+    @Test
+    public void testInvalidDependenciesInProperties() throws RepositoryException, IOException, PackageException {
+        JcrPackage pack = packMgr.upload(getStream("testpackages/null-dependency-test.zip"), false);
+        assertNotNull(pack);
+        for (Dependency dep: pack.getDefinition().getDependencies()) {
+            assertNotNull("dependency element", dep);
+        }
+    }
+
+    /**
+     * Creates a package definition with invalid dependencies. see JCRVLT-265
+     */
+    @Test
+    public void testInvalidDependenciesInDefinition() throws RepositoryException, IOException, PackageException {
+        JcrPackage pack = packMgr.upload(getStream("testpackages/null-dependency-test.zip"), false);
+        assertNotNull(pack);
+        Dependency[] deps = {new Dependency(TMP_PACKAGE_ID), null};
+        pack.getDefinition().setDependencies(deps, true);
+        for (Dependency dep: pack.getDefinition().getDependencies()) {
+            assertNotNull("dependency element", dep);
+        }
+
+        Value[] values = {admin.getValueFactory().createValue("")};
+        pack.getDefNode().setProperty(PN_DEPENDENCIES, values);
+        admin.save();
+
+        pack = packMgr.open(pack.getDefinition().getId());
+        for (Dependency dep: pack.getDefinition().getDependencies()) {
+            assertNotNull("dependency element", dep);
+        }
+    }
+
     /**
      * Tests if package installation works w/o RW access to / and /tmp.
      * this currently fails, due to the creation of the snapshot.
diff --git a/vault-core/src/test/resources/org/apache/jackrabbit/vault/packaging/integration/testpackages/null-dependency-test.zip b/vault-core/src/test/resources/org/apache/jackrabbit/vault/packaging/integration/testpackages/null-dependency-test.zip
new file mode 100644
index 00000000..51e868a5
Binary files /dev/null and b/vault-core/src/test/resources/org/apache/jackrabbit/vault/packaging/integration/testpackages/null-dependency-test.zip differ
