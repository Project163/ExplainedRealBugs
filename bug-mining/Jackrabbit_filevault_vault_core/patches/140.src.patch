diff --git a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/ImportIT.java b/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/ImportIT.java
index 285c4186..bc8b2a8c 100644
--- a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/ImportIT.java
+++ b/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/ImportIT.java
@@ -29,6 +29,7 @@ import javax.jcr.RepositoryException;
 import javax.jcr.Session;
 import javax.jcr.SimpleCredentials;
 import javax.jcr.nodetype.ConstraintViolationException;
+import javax.jcr.nodetype.NodeType;
 
 import org.apache.jackrabbit.api.JackrabbitSession;
 import org.apache.jackrabbit.api.security.user.User;
@@ -44,6 +45,7 @@ import org.apache.jackrabbit.vault.fs.io.Importer;
 import org.apache.jackrabbit.vault.fs.io.JcrArchive;
 import org.apache.jackrabbit.vault.fs.io.ZipArchive;
 import org.apache.jackrabbit.vault.packaging.PackageException;
+import org.apache.jackrabbit.vault.util.JcrConstants;
 import org.codehaus.plexus.util.ExceptionUtils;
 import org.junit.Assert;
 import org.junit.Assume;
@@ -382,4 +384,41 @@ public class ImportIT extends IntegrationTestBase {
         }
     }
 
+    @Test
+    // JCRVLT-557
+    public void testKeepNodeTypeForFolderAggregate() throws IOException, RepositoryException, ConfigurationException {
+        // create nodes which are covered by a folder aggregate with type nt:unstructured
+        Node rootNode = admin.getRootNode();
+        Node testrootNode = rootNode.addNode("testroot", NodeType.NT_UNSTRUCTURED);
+        testrootNode.addNode("myfolder", NodeType.NT_UNSTRUCTURED);
+        admin.save();
+        // first try a regular installation (which should fail)
+        ImportOptions opts = getDefaultOptions();
+        Importer importer = new Importer(opts);
+        try (Archive archive = getFileArchive("/test-packages/test_nt_unstructured_below_folder_aggregate.zip")) {
+            archive.open(true);
+            importer.run(archive, rootNode);
+           // admin.save();
+            Assert.fail("Installing the package should fail as it tries to install an nt:unstructured node below an nt:folder node");
+        } catch (RepositoryException e) {
+            // expected
+        }
+        admin.refresh(false);
+        // restore type of /testroot/myfolder
+        testrootNode.getNode("myfolder").setPrimaryType(JcrConstants.NT_UNSTRUCTURED/*NodeType.NT_UNSTRUCTURED*/); // TODO: somehow expanded names do not work in Oak (see https://issues.apache.org/jira/browse/OAK-9616)
+        admin.save();
+        // don't overwrite node types for folder aggregates (i.e. keep nt:unstructured instead of converting to nt:folder)
+        opts.setOverwritePrimaryTypesOfFolders(false);
+        importer = new Importer(opts);
+        // now installation should succeed
+        try (Archive archive = getFileArchive("/test-packages/test_nt_unstructured_below_folder_aggregate.zip")) {
+            archive.open(true);
+            importer.run(archive, rootNode);
+        }
+        admin.save();
+        // Checking for node types
+        // Behavior in 3.4.0: myfolder's node type covered by package folder aggregate is not touched
+        assertNodeHasPrimaryType("/testroot/myfolder", JcrConstants.NT_UNSTRUCTURED);
+        assertNodeHasPrimaryType("/testroot/myfolder/mychild", JcrConstants.NT_UNSTRUCTURED);
+    }
 }
\ No newline at end of file
diff --git a/vault-core/src/test/resources/test-packages/test_nt_unstructured_below_folder_aggregate.zip/META-INF/vault/filter.xml b/vault-core/src/test/resources/test-packages/test_nt_unstructured_below_folder_aggregate.zip/META-INF/vault/filter.xml
new file mode 100644
index 00000000..c94973e8
--- /dev/null
+++ b/vault-core/src/test/resources/test-packages/test_nt_unstructured_below_folder_aggregate.zip/META-INF/vault/filter.xml
@@ -0,0 +1,4 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<workspaceFilter version="1.0">
+    <filter root="/testroot/myfolder"/>
+</workspaceFilter>
\ No newline at end of file
diff --git a/vault-core/src/test/resources/test-packages/test_nt_unstructured_below_folder_aggregate.zip/META-INF/vault/properties.xml b/vault-core/src/test/resources/test-packages/test_nt_unstructured_below_folder_aggregate.zip/META-INF/vault/properties.xml
new file mode 100644
index 00000000..b5979b69
--- /dev/null
+++ b/vault-core/src/test/resources/test-packages/test_nt_unstructured_below_folder_aggregate.zip/META-INF/vault/properties.xml
@@ -0,0 +1,18 @@
+<?xml version="1.0" encoding="utf-8" standalone="no"?>
+<!DOCTYPE properties SYSTEM "http://java.sun.com/dtd/properties.dtd">
+<properties>
+<comment>FileVault Test Implicit Definitions</comment>
+<entry key="createdBy">admin</entry>
+<entry key="name">implicit-definition-test</entry>
+<entry key="lastModified">2011-11-15T09:45:14.664+01:00</entry>
+<entry key="lastModifiedBy">admin</entry>
+<entry key="created">2011-11-15T09:45:14.685+01:00</entry>
+<entry key="buildCount">1</entry>
+<entry key="version"/>
+<entry key="dependencies"/>
+<entry key="packageFormatVersion">2</entry>
+<entry key="description"/>
+<entry key="lastWrapped">2011-11-15T09:45:14.664+01:00</entry>
+<entry key="group"/>
+<entry key="lastWrappedBy">admin</entry>
+</properties>
diff --git a/vault-core/src/test/resources/test-packages/test_nt_unstructured_below_folder_aggregate.zip/jcr_root/testroot/myfolder/mychild/.content.xml b/vault-core/src/test/resources/test-packages/test_nt_unstructured_below_folder_aggregate.zip/jcr_root/testroot/myfolder/mychild/.content.xml
new file mode 100644
index 00000000..d1ff8989
--- /dev/null
+++ b/vault-core/src/test/resources/test-packages/test_nt_unstructured_below_folder_aggregate.zip/jcr_root/testroot/myfolder/mychild/.content.xml
@@ -0,0 +1,4 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:rep="internal" xmlns:my="http://jackrabbit.apache.org/filevault/testing"
+    jcr:primaryType="nt:unstructured">
+</jcr:root>
