diff --git a/vault-core/src/main/java/org/apache/jackrabbit/vault/packaging/impl/AdminPermissionChecker.java b/vault-core/src/main/java/org/apache/jackrabbit/vault/packaging/impl/AdminPermissionChecker.java
index 6605e3c5..457ed7f5 100644
--- a/vault-core/src/main/java/org/apache/jackrabbit/vault/packaging/impl/AdminPermissionChecker.java
+++ b/vault-core/src/main/java/org/apache/jackrabbit/vault/packaging/impl/AdminPermissionChecker.java
@@ -47,22 +47,27 @@ public class AdminPermissionChecker {
      */
     public static boolean hasAdministrativePermissions(Session session) throws RepositoryException {
         String userId = session.getUserID();
-        boolean isAdministrator = ADMIN_USER.equals(userId) || SYSTEM_USER.equals(userId);
-        boolean isJackrabbitSession = session instanceof JackrabbitSession;
-        if (!isAdministrator) {
-            if (isJackrabbitSession) {
-                JackrabbitSession jackrabbitSession = (JackrabbitSession) session;
-                Authorizable authorizable = jackrabbitSession.getUserManager().getAuthorizable(userId);
-                Iterator<Group> groupIterator = authorizable.memberOf();
-                while (groupIterator.hasNext()) {
-                    if (ADMINISTRATORS_GROUP.equals(groupIterator.next().getID())) {
-                        isAdministrator = true;
-                        break;
-                    }
-                }
-            } else
-                log.warn("could not evaluate group permissions but just user name");
+        if (ADMIN_USER.equals(userId) || SYSTEM_USER.equals(userId)) {
+            return true;
         }
-        return isAdministrator;
+        if (!(session instanceof JackrabbitSession)) {
+            log.warn("could not evaluate group permissions but just user name");
+            return false;
+        }
+
+        JackrabbitSession jackrabbitSession = (JackrabbitSession) session;
+        Authorizable authorizable = jackrabbitSession.getUserManager().getAuthorizable(userId);
+        if (authorizable == null) {
+            return false;
+        }
+
+        Iterator<Group> groupIterator = authorizable.memberOf();
+        while (groupIterator.hasNext()) {
+            if (ADMINISTRATORS_GROUP.equals(groupIterator.next().getID())) {
+                return true;
+            }
+        }
+
+        return false;
     }
 }
diff --git a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/impl/AdminPermissionCheckerTest.java b/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/impl/AdminPermissionCheckerTest.java
index 0b5dc060..05cab4a5 100644
--- a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/impl/AdminPermissionCheckerTest.java
+++ b/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/impl/AdminPermissionCheckerTest.java
@@ -30,6 +30,7 @@ import org.junit.After;
 import org.junit.Test;
 
 import static org.junit.Assert.assertFalse;
+import static org.junit.Assert.assertNull;
 import static org.junit.Assert.assertTrue;
 
 /**
@@ -58,10 +59,11 @@ public class AdminPermissionCheckerTest extends IntegrationTestBase {
     public void testNotAdminUser() throws Exception {
         JackrabbitSession jackrabbitSession = (JackrabbitSession) admin;
         Authorizable vip = jackrabbitSession.getUserManager().getAuthorizable(TEST_USER);
-        if (vip == null) {
-            jackrabbitSession.getUserManager().createUser(TEST_USER, TEST_USER);
-        }
+        assertNull("test user must not exist", vip);
+
+        jackrabbitSession.getUserManager().createUser(TEST_USER, TEST_USER);
         admin.save();
+
         Session session = repository.login(new SimpleCredentials(TEST_USER, TEST_USER.toCharArray()));
         try {
             assertFalse(
