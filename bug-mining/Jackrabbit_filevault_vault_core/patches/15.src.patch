diff --git a/vault-core/src/main/java/org/apache/jackrabbit/vault/packaging/impl/JcrPackageImpl.java b/vault-core/src/main/java/org/apache/jackrabbit/vault/packaging/impl/JcrPackageImpl.java
index df59da42..db0ebd15 100644
--- a/vault-core/src/main/java/org/apache/jackrabbit/vault/packaging/impl/JcrPackageImpl.java
+++ b/vault-core/src/main/java/org/apache/jackrabbit/vault/packaging/impl/JcrPackageImpl.java
@@ -590,7 +590,7 @@ public class JcrPackageImpl implements JcrPackage {
             opts.getListener().onMessage(ProgressTrackerListener.Mode.TEXT, "Uninstalling package from snapshot " + snap.getDefinition().getId(), "");
         }
         Session s = getNode().getSession();
-        // check for recursive unininstall
+        // check for recursive uninstall
         if (!opts.isNonRecursive()) {
             Node defNode = snap.getDefNode();
             LinkedList<PackageId> subPackages = new LinkedList<PackageId>();
@@ -606,7 +606,11 @@ public class JcrPackageImpl implements JcrPackage {
                 for (PackageId id: subPackages) {
                     JcrPackage pack = packMgr.open(id);
                     if (pack != null) {
-                        pack.uninstall(opts);
+                        if (pack.getSnapshot() == null) {
+                            log.warn("Unable to uninstall sub package {}. Snapshot missing.", id);
+                        } else {
+                            pack.uninstall(opts);
+                        }
                     }
                 }
 
diff --git a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/TestSubPackages.java b/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/TestSubPackages.java
index 450da601..c4b2fd40 100644
--- a/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/TestSubPackages.java
+++ b/vault-core/src/test/java/org/apache/jackrabbit/vault/packaging/integration/TestSubPackages.java
@@ -207,5 +207,35 @@ public class TestSubPackages extends IntegrationTestBase {
 
     }
 
+    /**
+     * Uninstalls a package that contains sub packages where a snapshot of a sub package was deleted
+     */
+    @Test
+    public void testUninstallMissingSnapshot() throws RepositoryException, IOException, PackageException {
+        JcrPackage pack = packMgr.upload(getStream("testpackages/subtest.zip"), false);
+        assertNotNull(pack);
+
+        // install
+        ImportOptions opts = getDefaultOptions();
+        opts.setNonRecursive(false);
+        pack.install(opts);
+
+        assertNodeExists("/tmp/a");
+        assertNodeExists("/tmp/b");
+
+        admin.getNode("/etc/packages/my_packages/.snapshot/sub_a.zip").remove();
+        admin.save();
+
+        // uninstall
+        opts.setNonRecursive(false);
+        pack.uninstall(opts);
+
+        assertNodeMissing("/etc/packages/my_packages/sub_a.zip");
+        assertNodeMissing("/etc/packages/my_packages/sub_b.zip");
+        assertNodeExists("/tmp/a");
+        assertNodeMissing("/tmp/b");
+
+    }
+
 
 }
\ No newline at end of file
